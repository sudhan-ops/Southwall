function FL(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var Oue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function qL(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var Rv={exports:{}},uh={},Lv={exports:{}},Jt={};var HT;function xq(){if(HT)return Jt;HT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function x(H){return H===null||typeof H!="object"?null:(H=p&&H[p]||H["@@iterator"],typeof H=="function"?H:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function j(H,Q,ne){this.props=H,this.context=Q,this.refs=w,this.updater=ne||v}j.prototype.isReactComponent={},j.prototype.setState=function(H,Q){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,Q,"setState")},j.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function T(){}T.prototype=j.prototype;function P(H,Q,ne){this.props=H,this.context=Q,this.refs=w,this.updater=ne||v}var E=P.prototype=new T;E.constructor=P,_(E,j.prototype),E.isPureReactComponent=!0;var M=Array.isArray,O=Object.prototype.hasOwnProperty,I={current:null},q={key:!0,ref:!0,__self:!0,__source:!0};function F(H,Q,ne){var de,ce={},pe=null,ie=null;if(Q!=null)for(de in Q.ref!==void 0&&(ie=Q.ref),Q.key!==void 0&&(pe=""+Q.key),Q)O.call(Q,de)&&!q.hasOwnProperty(de)&&(ce[de]=Q[de]);var xe=arguments.length-2;if(xe===1)ce.children=ne;else if(1<xe){for(var Ce=Array(xe),ve=0;ve<xe;ve++)Ce[ve]=arguments[ve+2];ce.children=Ce}if(H&&H.defaultProps)for(de in xe=H.defaultProps,xe)ce[de]===void 0&&(ce[de]=xe[de]);return{$$typeof:n,type:H,key:pe,ref:ie,props:ce,_owner:I.current}}function B(H,Q){return{$$typeof:n,type:H.type,key:Q,ref:H.ref,props:H.props,_owner:H._owner}}function U(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function W(H){var Q={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ne){return Q[ne]})}var $=/\/+/g;function se(H,Q){return typeof H=="object"&&H!==null&&H.key!=null?W(""+H.key):Q.toString(36)}function Y(H,Q,ne,de,ce){var pe=typeof H;(pe==="undefined"||pe==="boolean")&&(H=null);var ie=!1;if(H===null)ie=!0;else switch(pe){case"string":case"number":ie=!0;break;case"object":switch(H.$$typeof){case n:case e:ie=!0}}if(ie)return ie=H,ce=ce(ie),H=de===""?"."+se(ie,0):de,M(ce)?(ne="",H!=null&&(ne=H.replace($,"$&/")+"/"),Y(ce,Q,ne,"",function(ve){return ve})):ce!=null&&(U(ce)&&(ce=B(ce,ne+(!ce.key||ie&&ie.key===ce.key?"":(""+ce.key).replace($,"$&/")+"/")+H)),Q.push(ce)),1;if(ie=0,de=de===""?".":de+":",M(H))for(var xe=0;xe<H.length;xe++){pe=H[xe];var Ce=de+se(pe,xe);ie+=Y(pe,Q,ne,Ce,ce)}else if(Ce=x(H),typeof Ce=="function")for(H=Ce.call(H),xe=0;!(pe=H.next()).done;)pe=pe.value,Ce=de+se(pe,xe++),ie+=Y(pe,Q,ne,Ce,ce);else if(pe==="object")throw Q=String(H),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return ie}function ae(H,Q,ne){if(H==null)return H;var de=[],ce=0;return Y(H,de,"","",function(pe){return Q.call(ne,pe,ce++)}),de}function J(H){if(H._status===-1){var Q=H._result;Q=Q(),Q.then(function(ne){(H._status===0||H._status===-1)&&(H._status=1,H._result=ne)},function(ne){(H._status===0||H._status===-1)&&(H._status=2,H._result=ne)}),H._status===-1&&(H._status=0,H._result=Q)}if(H._status===1)return H._result.default;throw H._result}var ee={current:null},X={transition:null},Z={ReactCurrentDispatcher:ee,ReactCurrentBatchConfig:X,ReactCurrentOwner:I};function oe(){throw Error("act(...) is not supported in production builds of React.")}return Jt.Children={map:ae,forEach:function(H,Q,ne){ae(H,function(){Q.apply(this,arguments)},ne)},count:function(H){var Q=0;return ae(H,function(){Q++}),Q},toArray:function(H){return ae(H,function(Q){return Q})||[]},only:function(H){if(!U(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Jt.Component=j,Jt.Fragment=t,Jt.Profiler=s,Jt.PureComponent=P,Jt.StrictMode=r,Jt.Suspense=c,Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,Jt.act=oe,Jt.cloneElement=function(H,Q,ne){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var de=_({},H.props),ce=H.key,pe=H.ref,ie=H._owner;if(Q!=null){if(Q.ref!==void 0&&(pe=Q.ref,ie=I.current),Q.key!==void 0&&(ce=""+Q.key),H.type&&H.type.defaultProps)var xe=H.type.defaultProps;for(Ce in Q)O.call(Q,Ce)&&!q.hasOwnProperty(Ce)&&(de[Ce]=Q[Ce]===void 0&&xe!==void 0?xe[Ce]:Q[Ce])}var Ce=arguments.length-2;if(Ce===1)de.children=ne;else if(1<Ce){xe=Array(Ce);for(var ve=0;ve<Ce;ve++)xe[ve]=arguments[ve+2];de.children=xe}return{$$typeof:n,type:H.type,key:ce,ref:pe,props:de,_owner:ie}},Jt.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:a,_context:H},H.Consumer=H},Jt.createElement=F,Jt.createFactory=function(H){var Q=F.bind(null,H);return Q.type=H,Q},Jt.createRef=function(){return{current:null}},Jt.forwardRef=function(H){return{$$typeof:l,render:H}},Jt.isValidElement=U,Jt.lazy=function(H){return{$$typeof:h,_payload:{_status:-1,_result:H},_init:J}},Jt.memo=function(H,Q){return{$$typeof:d,type:H,compare:Q===void 0?null:Q}},Jt.startTransition=function(H){var Q=X.transition;X.transition={};try{H()}finally{X.transition=Q}},Jt.unstable_act=oe,Jt.useCallback=function(H,Q){return ee.current.useCallback(H,Q)},Jt.useContext=function(H){return ee.current.useContext(H)},Jt.useDebugValue=function(){},Jt.useDeferredValue=function(H){return ee.current.useDeferredValue(H)},Jt.useEffect=function(H,Q){return ee.current.useEffect(H,Q)},Jt.useId=function(){return ee.current.useId()},Jt.useImperativeHandle=function(H,Q,ne){return ee.current.useImperativeHandle(H,Q,ne)},Jt.useInsertionEffect=function(H,Q){return ee.current.useInsertionEffect(H,Q)},Jt.useLayoutEffect=function(H,Q){return ee.current.useLayoutEffect(H,Q)},Jt.useMemo=function(H,Q){return ee.current.useMemo(H,Q)},Jt.useReducer=function(H,Q,ne){return ee.current.useReducer(H,Q,ne)},Jt.useRef=function(H){return ee.current.useRef(H)},Jt.useState=function(H){return ee.current.useState(H)},Jt.useSyncExternalStore=function(H,Q,ne){return ee.current.useSyncExternalStore(H,Q,ne)},Jt.useTransition=function(){return ee.current.useTransition()},Jt.version="18.3.1",Jt}var YT;function Ys(){return YT||(YT=1,Lv.exports=xq()),Lv.exports}var GT;function yq(){if(GT)return uh;GT=1;var n=Ys(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(l,c,d){var h,p={},x=null,v=null;d!==void 0&&(x=""+d),c.key!==void 0&&(x=""+c.key),c.ref!==void 0&&(v=c.ref);for(h in c)r.call(c,h)&&!a.hasOwnProperty(h)&&(p[h]=c[h]);if(l&&l.defaultProps)for(h in c=l.defaultProps,c)p[h]===void 0&&(p[h]=c[h]);return{$$typeof:e,type:l,key:x,ref:v,props:p,_owner:s.current}}return uh.Fragment=t,uh.jsx=o,uh.jsxs=o,uh}var ZT;function zL(){return ZT||(ZT=1,Rv.exports=yq()),Rv.exports}var i=zL(),D=Ys();const ot=mu(D),vq=FL({__proto__:null,default:ot},[D]);var jp={},Fv={exports:{}},Fs={},qv={exports:{}},zv={};var KT;function bq(){return KT||(KT=1,(function(n){function e(X,Z){var oe=X.length;X.push(Z);e:for(;0<oe;){var H=oe-1>>>1,Q=X[H];if(0<s(Q,Z))X[H]=Z,X[oe]=Q,oe=H;else break e}}function t(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var Z=X[0],oe=X.pop();if(oe!==Z){X[0]=oe;e:for(var H=0,Q=X.length,ne=Q>>>1;H<ne;){var de=2*(H+1)-1,ce=X[de],pe=de+1,ie=X[pe];if(0>s(ce,oe))pe<Q&&0>s(ie,ce)?(X[H]=ie,X[pe]=oe,H=pe):(X[H]=ce,X[de]=oe,H=de);else if(pe<Q&&0>s(ie,oe))X[H]=ie,X[pe]=oe,H=pe;else break e}}return Z}function s(X,Z){var oe=X.sortIndex-Z.sortIndex;return oe!==0?oe:X.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,p=null,x=3,v=!1,_=!1,w=!1,j=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(X){for(var Z=t(d);Z!==null;){if(Z.callback===null)r(d);else if(Z.startTime<=X)r(d),Z.sortIndex=Z.expirationTime,e(c,Z);else break;Z=t(d)}}function M(X){if(w=!1,E(X),!_)if(t(c)!==null)_=!0,J(O);else{var Z=t(d);Z!==null&&ee(M,Z.startTime-X)}}function O(X,Z){_=!1,w&&(w=!1,T(F),F=-1),v=!0;var oe=x;try{for(E(Z),p=t(c);p!==null&&(!(p.expirationTime>Z)||X&&!W());){var H=p.callback;if(typeof H=="function"){p.callback=null,x=p.priorityLevel;var Q=H(p.expirationTime<=Z);Z=n.unstable_now(),typeof Q=="function"?p.callback=Q:p===t(c)&&r(c),E(Z)}else r(c);p=t(c)}if(p!==null)var ne=!0;else{var de=t(d);de!==null&&ee(M,de.startTime-Z),ne=!1}return ne}finally{p=null,x=oe,v=!1}}var I=!1,q=null,F=-1,B=5,U=-1;function W(){return!(n.unstable_now()-U<B)}function $(){if(q!==null){var X=n.unstable_now();U=X;var Z=!0;try{Z=q(!0,X)}finally{Z?se():(I=!1,q=null)}}else I=!1}var se;if(typeof P=="function")se=function(){P($)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ae=Y.port2;Y.port1.onmessage=$,se=function(){ae.postMessage(null)}}else se=function(){j($,0)};function J(X){q=X,I||(I=!0,se())}function ee(X,Z){F=j(function(){X(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_continueExecution=function(){_||v||(_=!0,J(O))},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(X){switch(x){case 1:case 2:case 3:var Z=3;break;default:Z=x}var oe=x;x=Z;try{return X()}finally{x=oe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(X,Z){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var oe=x;x=X;try{return Z()}finally{x=oe}},n.unstable_scheduleCallback=function(X,Z,oe){var H=n.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?H+oe:H):oe=H,X){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=oe+Q,X={id:h++,callback:Z,priorityLevel:X,startTime:oe,expirationTime:Q,sortIndex:-1},oe>H?(X.sortIndex=oe,e(d,X),t(c)===null&&X===t(d)&&(w?(T(F),F=-1):w=!0,ee(M,oe-H))):(X.sortIndex=Q,e(c,X),_||v||(_=!0,J(O))),X},n.unstable_shouldYield=W,n.unstable_wrapCallback=function(X){var Z=x;return function(){var oe=x;x=Z;try{return X.apply(this,arguments)}finally{x=oe}}}})(zv)),zv}var JT;function _q(){return JT||(JT=1,qv.exports=bq()),qv.exports}var QT;function wq(){if(QT)return Fs;QT=1;var n=Ys(),e=_q();function t(u){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+u,b=1;b<arguments.length;b++)m+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+u+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(u,m){o(u,m),o(u+"Capture",m)}function o(u,m){for(s[u]=m,u=0;u<m.length;u++)r.add(m[u])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function x(u){return c.call(p,u)?!0:c.call(h,u)?!1:d.test(u)?p[u]=!0:(h[u]=!0,!1)}function v(u,m,b,k){if(b!==null&&b.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return k?!1:b!==null?!b.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function _(u,m,b,k){if(m===null||typeof m>"u"||v(u,m,b,k))return!0;if(k)return!1;if(b!==null)switch(b.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function w(u,m,b,k,R,z,G){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=k,this.attributeNamespace=R,this.mustUseProperty=b,this.propertyName=u,this.type=m,this.sanitizeURL=z,this.removeEmptyString=G}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){j[u]=new w(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var m=u[0];j[m]=new w(m,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){j[u]=new w(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){j[u]=new w(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){j[u]=new w(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){j[u]=new w(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){j[u]=new w(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){j[u]=new w(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){j[u]=new w(u,5,!1,u.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function P(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var m=u.replace(T,P);j[m]=new w(m,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var m=u.replace(T,P);j[m]=new w(m,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var m=u.replace(T,P);j[m]=new w(m,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){j[u]=new w(u,1,!1,u.toLowerCase(),null,!1,!1)}),j.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){j[u]=new w(u,1,!1,u.toLowerCase(),null,!0,!0)});function E(u,m,b,k){var R=j.hasOwnProperty(m)?j[m]:null;(R!==null?R.type!==0:k||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(_(m,b,R,k)&&(b=null),k||R===null?x(m)&&(b===null?u.removeAttribute(m):u.setAttribute(m,""+b)):R.mustUseProperty?u[R.propertyName]=b===null?R.type===3?!1:"":b:(m=R.attributeName,k=R.attributeNamespace,b===null?u.removeAttribute(m):(R=R.type,b=R===3||R===4&&b===!0?"":""+b,k?u.setAttributeNS(k,m,b):u.setAttribute(m,b))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),I=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),W=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),ee=Symbol.for("react.offscreen"),X=Symbol.iterator;function Z(u){return u===null||typeof u!="object"?null:(u=X&&u[X]||u["@@iterator"],typeof u=="function"?u:null)}var oe=Object.assign,H;function Q(u){if(H===void 0)try{throw Error()}catch(b){var m=b.stack.trim().match(/\n( *(at )?)/);H=m&&m[1]||""}return`
`+H+u}var ne=!1;function de(u,m){if(!u||ne)return"";ne=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(Ee){var k=Ee}Reflect.construct(u,[],m)}else{try{m.call()}catch(Ee){k=Ee}u.call(m.prototype)}else{try{throw Error()}catch(Ee){k=Ee}u()}}catch(Ee){if(Ee&&k&&typeof Ee.stack=="string"){for(var R=Ee.stack.split(`
`),z=k.stack.split(`
`),G=R.length-1,fe=z.length-1;1<=G&&0<=fe&&R[G]!==z[fe];)fe--;for(;1<=G&&0<=fe;G--,fe--)if(R[G]!==z[fe]){if(G!==1||fe!==1)do if(G--,fe--,0>fe||R[G]!==z[fe]){var me=`
`+R[G].replace(" at new "," at ");return u.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",u.displayName)),me}while(1<=G&&0<=fe);break}}}finally{ne=!1,Error.prepareStackTrace=b}return(u=u?u.displayName||u.name:"")?Q(u):""}function ce(u){switch(u.tag){case 5:return Q(u.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return u=de(u.type,!1),u;case 11:return u=de(u.type.render,!1),u;case 1:return u=de(u.type,!0),u;default:return""}}function pe(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case q:return"Fragment";case I:return"Portal";case B:return"Profiler";case F:return"StrictMode";case se:return"Suspense";case Y:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case W:return(u.displayName||"Context")+".Consumer";case U:return(u._context.displayName||"Context")+".Provider";case $:var m=u.render;return u=u.displayName,u||(u=m.displayName||m.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case ae:return m=u.displayName||null,m!==null?m:pe(u.type)||"Memo";case J:m=u._payload,u=u._init;try{return pe(u(m))}catch{}}return null}function ie(u){var m=u.type;switch(u.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=m.render,u=u.displayName||u.name||"",m.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(m);case 8:return m===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function xe(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function Ce(u){var m=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function ve(u){var m=Ce(u)?"checked":"value",b=Object.getOwnPropertyDescriptor(u.constructor.prototype,m),k=""+u[m];if(!u.hasOwnProperty(m)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var R=b.get,z=b.set;return Object.defineProperty(u,m,{configurable:!0,get:function(){return R.call(this)},set:function(G){k=""+G,z.call(this,G)}}),Object.defineProperty(u,m,{enumerable:b.enumerable}),{getValue:function(){return k},setValue:function(G){k=""+G},stopTracking:function(){u._valueTracker=null,delete u[m]}}}}function Oe(u){u._valueTracker||(u._valueTracker=ve(u))}function Pe(u){if(!u)return!1;var m=u._valueTracker;if(!m)return!0;var b=m.getValue(),k="";return u&&(k=Ce(u)?u.checked?"true":"false":u.value),u=k,u!==b?(m.setValue(u),!0):!1}function Ie(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Fe(u,m){var b=m.checked;return oe({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??u._wrapperState.initialChecked})}function _e(u,m){var b=m.defaultValue==null?"":m.defaultValue,k=m.checked!=null?m.checked:m.defaultChecked;b=xe(m.value!=null?m.value:b),u._wrapperState={initialChecked:k,initialValue:b,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function Ne(u,m){m=m.checked,m!=null&&E(u,"checked",m,!1)}function Ue(u,m){Ne(u,m);var b=xe(m.value),k=m.type;if(b!=null)k==="number"?(b===0&&u.value===""||u.value!=b)&&(u.value=""+b):u.value!==""+b&&(u.value=""+b);else if(k==="submit"||k==="reset"){u.removeAttribute("value");return}m.hasOwnProperty("value")?qe(u,m.type,b):m.hasOwnProperty("defaultValue")&&qe(u,m.type,xe(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(u.defaultChecked=!!m.defaultChecked)}function Be(u,m,b){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var k=m.type;if(!(k!=="submit"&&k!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+u._wrapperState.initialValue,b||m===u.value||(u.value=m),u.defaultValue=m}b=u.name,b!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,b!==""&&(u.name=b)}function qe(u,m,b){(m!=="number"||Ie(u.ownerDocument)!==u)&&(b==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+b&&(u.defaultValue=""+b))}var te=Array.isArray;function le(u,m,b,k){if(u=u.options,m){m={};for(var R=0;R<b.length;R++)m["$"+b[R]]=!0;for(b=0;b<u.length;b++)R=m.hasOwnProperty("$"+u[b].value),u[b].selected!==R&&(u[b].selected=R),R&&k&&(u[b].defaultSelected=!0)}else{for(b=""+xe(b),m=null,R=0;R<u.length;R++){if(u[R].value===b){u[R].selected=!0,k&&(u[R].defaultSelected=!0);return}m!==null||u[R].disabled||(m=u[R])}m!==null&&(m.selected=!0)}}function ye(u,m){if(m.dangerouslySetInnerHTML!=null)throw Error(t(91));return oe({},m,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Ve(u,m){var b=m.value;if(b==null){if(b=m.children,m=m.defaultValue,b!=null){if(m!=null)throw Error(t(92));if(te(b)){if(1<b.length)throw Error(t(93));b=b[0]}m=b}m==null&&(m=""),b=m}u._wrapperState={initialValue:xe(b)}}function ze(u,m){var b=xe(m.value),k=xe(m.defaultValue);b!=null&&(b=""+b,b!==u.value&&(u.value=b),m.defaultValue==null&&u.defaultValue!==b&&(u.defaultValue=b)),k!=null&&(u.defaultValue=""+k)}function Le(u){var m=u.textContent;m===u._wrapperState.initialValue&&m!==""&&m!==null&&(u.value=m)}function rt(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xe(u,m){return u==null||u==="http://www.w3.org/1999/xhtml"?rt(m):u==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var tt,qt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,b,k,R){MSApp.execUnsafeLocalFunction(function(){return u(m,b,k,R)})}:u})(function(u,m){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=m;else{for(tt=tt||document.createElement("div"),tt.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=tt.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;m.firstChild;)u.appendChild(m.firstChild)}});function bt(u,m){if(m){var b=u.firstChild;if(b&&b===u.lastChild&&b.nodeType===3){b.nodeValue=m;return}}u.textContent=m}var Dt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xt=["Webkit","ms","Moz","O"];Object.keys(Dt).forEach(function(u){Xt.forEach(function(m){m=m+u.charAt(0).toUpperCase()+u.substring(1),Dt[m]=Dt[u]})});function en(u,m,b){return m==null||typeof m=="boolean"||m===""?"":b||typeof m!="number"||m===0||Dt.hasOwnProperty(u)&&Dt[u]?(""+m).trim():m+"px"}function Yt(u,m){u=u.style;for(var b in m)if(m.hasOwnProperty(b)){var k=b.indexOf("--")===0,R=en(b,m[b],k);b==="float"&&(b="cssFloat"),k?u.setProperty(b,R):u[b]=R}}var Ut=oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rn(u,m){if(m){if(Ut[u]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(t(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(t(61))}if(m.style!=null&&typeof m.style!="object")throw Error(t(62))}}function Nn(u,m){if(u.indexOf("-")===-1)return typeof m.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var an=null;function rr(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Hn=null,lt=null,Vn=null;function br(u){if(u=el(u)){if(typeof Hn!="function")throw Error(t(280));var m=u.stateNode;m&&(m=Cu(m),Hn(u.stateNode,u.type,m))}}function vn(u){lt?Vn?Vn.push(u):Vn=[u]:lt=u}function ds(){if(lt){var u=lt,m=Vn;if(Vn=lt=null,br(u),m)for(u=0;u<m.length;u++)br(m[u])}}function Zs(u,m){return u(m)}function Yr(){}var Qi=!1;function Ra(u,m,b){if(Qi)return u(m,b);Qi=!0;try{return Zs(u,m,b)}finally{Qi=!1,(lt!==null||Vn!==null)&&(Yr(),ds())}}function Xi(u,m){var b=u.stateNode;if(b===null)return null;var k=Cu(b);if(k===null)return null;b=k[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(u=u.type,k=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!k;break e;default:u=!1}if(u)return null;if(b&&typeof b!="function")throw Error(t(231,m,typeof b));return b}var ko=!1;if(l)try{var ea={};Object.defineProperty(ea,"passive",{get:function(){ko=!0}}),window.addEventListener("test",ea,ea),window.removeEventListener("test",ea,ea)}catch{ko=!1}function ad(u,m,b,k,R,z,G,fe,me){var Ee=Array.prototype.slice.call(arguments,3);try{m.apply(b,Ee)}catch(Ge){this.onError(Ge)}}var dr=!1,dt=null,ta=!1,La=null,El={onError:function(u){dr=!0,dt=u}};function Ol(u,m,b,k,R,z,G,fe,me){dr=!1,dt=null,ad.apply(El,arguments)}function Po(u,m,b,k,R,z,G,fe,me){if(Ol.apply(this,arguments),dr){if(dr){var Ee=dt;dr=!1,dt=null}else throw Error(t(198));ta||(ta=!0,La=Ee)}}function Ts(u){var m=u,b=u;if(u.alternate)for(;m.return;)m=m.return;else{u=m;do m=u,(m.flags&4098)!==0&&(b=m.return),u=m.return;while(u)}return m.tag===3?b:null}function Ks(u){if(u.tag===13){var m=u.memoizedState;if(m===null&&(u=u.alternate,u!==null&&(m=u.memoizedState)),m!==null)return m.dehydrated}return null}function Mo(u){if(Ts(u)!==u)throw Error(t(188))}function od(u){var m=u.alternate;if(!m){if(m=Ts(u),m===null)throw Error(t(188));return m!==u?null:u}for(var b=u,k=m;;){var R=b.return;if(R===null)break;var z=R.alternate;if(z===null){if(k=R.return,k!==null){b=k;continue}break}if(R.child===z.child){for(z=R.child;z;){if(z===b)return Mo(R),u;if(z===k)return Mo(R),m;z=z.sibling}throw Error(t(188))}if(b.return!==k.return)b=R,k=z;else{for(var G=!1,fe=R.child;fe;){if(fe===b){G=!0,b=R,k=z;break}if(fe===k){G=!0,k=R,b=z;break}fe=fe.sibling}if(!G){for(fe=z.child;fe;){if(fe===b){G=!0,b=z,k=R;break}if(fe===k){G=!0,k=z,b=R;break}fe=fe.sibling}if(!G)throw Error(t(189))}}if(b.alternate!==k)throw Error(t(190))}if(b.tag!==3)throw Error(t(188));return b.stateNode.current===b?u:m}function Il(u){return u=od(u),u!==null?Al(u):null}function Al(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var m=Al(u);if(m!==null)return m;u=u.sibling}return null}var Rl=e.unstable_scheduleCallback,Do=e.unstable_cancelCallback,ld=e.unstable_shouldYield,Fa=e.unstable_requestPaint,Cn=e.unstable_now,cd=e.unstable_getCurrentPriorityLevel,Eo=e.unstable_ImmediatePriority,Ll=e.unstable_UserBlockingPriority,qa=e.unstable_NormalPriority,Oo=e.unstable_LowPriority,vi=e.unstable_IdlePriority,na=null,Ar=null;function ra(u){if(Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(na,u,void 0,(u.current.flags&128)===128)}catch{}}var Et=Math.clz32?Math.clz32:bi,bn=Math.log,za=Math.LN2;function bi(u){return u>>>=0,u===0?32:31-(bn(u)/za|0)|0}var us=64,_i=4194304;function Mt(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function gn(u,m){var b=u.pendingLanes;if(b===0)return 0;var k=0,R=u.suspendedLanes,z=u.pingedLanes,G=b&268435455;if(G!==0){var fe=G&~R;fe!==0?k=Mt(fe):(z&=G,z!==0&&(k=Mt(z)))}else G=b&~R,G!==0?k=Mt(G):z!==0&&(k=Mt(z));if(k===0)return 0;if(m!==0&&m!==k&&(m&R)===0&&(R=k&-k,z=m&-m,R>=z||R===16&&(z&4194240)!==0))return m;if((k&4)!==0&&(k|=b&16),m=u.entangledLanes,m!==0)for(u=u.entanglements,m&=k;0<m;)b=31-Et(m),R=1<<b,k|=u[b],m&=~R;return k}function Io(u,m){switch(u){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ua(u,m){for(var b=u.suspendedLanes,k=u.pingedLanes,R=u.expirationTimes,z=u.pendingLanes;0<z;){var G=31-Et(z),fe=1<<G,me=R[G];me===-1?((fe&b)===0||(fe&k)!==0)&&(R[G]=Io(fe,m)):me<=m&&(u.expiredLanes|=fe),z&=~fe}}function ur(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function Fl(){var u=us;return us<<=1,(us&4194240)===0&&(us=64),u}function wi(u){for(var m=[],b=0;31>b;b++)m.push(u);return m}function Rr(u,m,b){u.pendingLanes|=m,m!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,m=31-Et(m),u[m]=b}function En(u,m){var b=u.pendingLanes&~m;u.pendingLanes=m,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=m,u.mutableReadLanes&=m,u.entangledLanes&=m,m=u.entanglements;var k=u.eventTimes;for(u=u.expirationTimes;0<b;){var R=31-Et(b),z=1<<R;m[R]=0,k[R]=-1,u[R]=-1,b&=~z}}function fs(u,m){var b=u.entangledLanes|=m;for(u=u.entanglements;b;){var k=31-Et(b),R=1<<k;R&m|u[k]&m&&(u[k]|=m),b&=~R}}var Kt=0;function ji(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Va,Js,Ba,Wa,sa,ia=!1,Ni=[],Lr=null,hs=null,Gr=null,aa=new Map,Ct=new Map,Yn=[],ln="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ao(u,m){switch(u){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":hs=null;break;case"mouseover":case"mouseout":Gr=null;break;case"pointerover":case"pointerout":aa.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ct.delete(m.pointerId)}}function Qs(u,m,b,k,R,z){return u===null||u.nativeEvent!==z?(u={blockedOn:m,domEventName:b,eventSystemFlags:k,nativeEvent:z,targetContainers:[R]},m!==null&&(m=el(m),m!==null&&Js(m)),u):(u.eventSystemFlags|=k,m=u.targetContainers,R!==null&&m.indexOf(R)===-1&&m.push(R),u)}function Ro(u,m,b,k,R){switch(m){case"focusin":return Lr=Qs(Lr,u,m,b,k,R),!0;case"dragenter":return hs=Qs(hs,u,m,b,k,R),!0;case"mouseover":return Gr=Qs(Gr,u,m,b,k,R),!0;case"pointerover":var z=R.pointerId;return aa.set(z,Qs(aa.get(z)||null,u,m,b,k,R)),!0;case"gotpointercapture":return z=R.pointerId,Ct.set(z,Qs(Ct.get(z)||null,u,m,b,k,R)),!0}return!1}function $a(u){var m=Xo(u.target);if(m!==null){var b=Ts(m);if(b!==null){if(m=b.tag,m===13){if(m=Ks(b),m!==null){u.blockedOn=m,sa(u.priority,function(){Ba(b)});return}}else if(m===3&&b.stateNode.current.memoizedState.isDehydrated){u.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Zr(u){if(u.blockedOn!==null)return!1;for(var m=u.targetContainers;0<m.length;){var b=Ga(u.domEventName,u.eventSystemFlags,m[0],u.nativeEvent);if(b===null){b=u.nativeEvent;var k=new b.constructor(b.type,b);an=k,b.target.dispatchEvent(k),an=null}else return m=el(b),m!==null&&Js(m),u.blockedOn=b,!1;m.shift()}return!0}function Ha(u,m,b){Zr(u)&&b.delete(m)}function oa(){ia=!1,Lr!==null&&Zr(Lr)&&(Lr=null),hs!==null&&Zr(hs)&&(hs=null),Gr!==null&&Zr(Gr)&&(Gr=null),aa.forEach(Ha),Ct.forEach(Ha)}function Tn(u,m){u.blockedOn===m&&(u.blockedOn=null,ia||(ia=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,oa)))}function Fr(u){function m(R){return Tn(R,u)}if(0<Ni.length){Tn(Ni[0],u);for(var b=1;b<Ni.length;b++){var k=Ni[b];k.blockedOn===u&&(k.blockedOn=null)}}for(Lr!==null&&Tn(Lr,u),hs!==null&&Tn(hs,u),Gr!==null&&Tn(Gr,u),aa.forEach(m),Ct.forEach(m),b=0;b<Yn.length;b++)k=Yn[b],k.blockedOn===u&&(k.blockedOn=null);for(;0<Yn.length&&(b=Yn[0],b.blockedOn===null);)$a(b),b.blockedOn===null&&Yn.shift()}var Xs=M.ReactCurrentBatchConfig,la=!0;function dd(u,m,b,k){var R=Kt,z=Xs.transition;Xs.transition=null;try{Kt=1,ca(u,m,b,k)}finally{Kt=R,Xs.transition=z}}function ql(u,m,b,k){var R=Kt,z=Xs.transition;Xs.transition=null;try{Kt=4,ca(u,m,b,k)}finally{Kt=R,Xs.transition=z}}function ca(u,m,b,k){if(la){var R=Ga(u,m,b,k);if(R===null)f(u,m,k,Ya,b),Ao(u,k);else if(Ro(R,u,m,b,k))k.stopPropagation();else if(Ao(u,k),m&4&&-1<ln.indexOf(u)){for(;R!==null;){var z=el(R);if(z!==null&&Va(z),z=Ga(u,m,b,k),z===null&&f(u,m,k,Ya,b),z===R)break;R=z}R!==null&&k.stopPropagation()}else f(u,m,k,null,b)}}var Ya=null;function Ga(u,m,b,k){if(Ya=null,u=rr(k),u=Xo(u),u!==null)if(m=Ts(u),m===null)u=null;else if(b=m.tag,b===13){if(u=Ks(m),u!==null)return u;u=null}else if(b===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;u=null}else m!==u&&(u=null);return Ya=u,null}function Ht(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cd()){case Eo:return 1;case Ll:return 4;case qa:case Oo:return 16;case vi:return 536870912;default:return 16}default:return 16}}var ks=null,_r=null,Ps=null;function Lo(){if(Ps)return Ps;var u,m=_r,b=m.length,k,R="value"in ks?ks.value:ks.textContent,z=R.length;for(u=0;u<b&&m[u]===R[u];u++);var G=b-u;for(k=1;k<=G&&m[b-k]===R[z-k];k++);return Ps=R.slice(u,1<k?1-k:void 0)}function Za(u){var m=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&m===13&&(u=13)):u=m,u===10&&(u=13),32<=u||u===13?u:0}function Si(){return!0}function zl(){return!1}function fr(u){function m(b,k,R,z,G){this._reactName=b,this._targetInst=R,this.type=k,this.nativeEvent=z,this.target=G,this.currentTarget=null;for(var fe in u)u.hasOwnProperty(fe)&&(b=u[fe],this[fe]=b?b(z):z[fe]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?Si:zl,this.isPropagationStopped=zl,this}return oe(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=Si)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=Si)},persist:function(){},isPersistent:Si}),m}var Ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fo=fr(Ci),ei=oe({},Ci,{view:0,detail:0}),ud=fr(ei),Mr,qo,Ti,qr=oe({},ei,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ni,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Ti&&(Ti&&u.type==="mousemove"?(Mr=u.screenX-Ti.screenX,qo=u.screenY-Ti.screenY):qo=Mr=0,Ti=u),Mr)},movementY:function(u){return"movementY"in u?u.movementY:qo}}),zo=fr(qr),Ul=oe({},qr,{dataTransfer:0}),Uo=fr(Ul),fd=oe({},ei,{relatedTarget:0}),Ka=fr(fd),Vl=oe({},Ci,{animationName:0,elapsedTime:0,pseudoElement:0}),hd=fr(Vl),md=oe({},Ci,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),Vo=fr(md),pd=oe({},Ci,{data:0}),Bo=fr(pd),Bl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ja={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ti={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gd(u){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(u):(u=ti[u])?!!m[u]:!1}function ni(){return gd}var Dr=oe({},ei,{key:function(u){if(u.key){var m=Bl[u.key]||u.key;if(m!=="Unidentified")return m}return u.type==="keypress"?(u=Za(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?Ja[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ni,charCode:function(u){return u.type==="keypress"?Za(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Za(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Wl=fr(Dr),$l=oe({},qr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hl=fr($l),Wo=oe({},ei,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ni}),$o=fr(Wo),xd=oe({},Ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),yd=fr(xd),Yl=oe({},qr,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),vd=fr(Yl),zr=[9,13,27,32],Ms=l&&"CompositionEvent"in window,da=null;l&&"documentMode"in document&&(da=document.documentMode);var ms=l&&"TextEvent"in window&&!da,Gl=l&&(!Ms||da&&8<da&&11>=da),ri=" ",Zl=!1;function ki(u,m){switch(u){case"keyup":return zr.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ho(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var ps=!1;function bd(u,m){switch(u){case"compositionend":return Ho(m);case"keypress":return m.which!==32?null:(Zl=!0,ri);case"textInput":return u=m.data,u===ri&&Zl?null:u;default:return null}}function Ds(u,m){if(ps)return u==="compositionend"||!Ms&&ki(u,m)?(u=Lo(),Ps=_r=ks=null,ps=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Gl&&m.locale!=="ko"?null:m.data;default:return null}}var Qa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kl(u){var m=u&&u.nodeName&&u.nodeName.toLowerCase();return m==="input"?!!Qa[u.type]:m==="textarea"}function Xa(u,m,b,k){vn(k),m=C(m,"onChange"),0<m.length&&(b=new Fo("onChange","change",null,b,k),u.push({event:b,listeners:m}))}var ua=null,wr=null;function _d(u){Gf(u,0)}function gs(u){var m=tl(u);if(Pe(m))return u}function wd(u,m){if(u==="change")return m}var Kr=!1;if(l){var Pi;if(l){var eo="oninput"in document;if(!eo){var to=document.createElement("div");to.setAttribute("oninput","return;"),eo=typeof to.oninput=="function"}Pi=eo}else Pi=!1;Kr=Pi&&(!document.documentMode||9<document.documentMode)}function fa(){ua&&(ua.detachEvent("onpropertychange",no),wr=ua=null)}function no(u){if(u.propertyName==="value"&&gs(wr)){var m=[];Xa(m,wr,u,rr(u)),Ra(_d,m)}}function ro(u,m,b){u==="focusin"?(fa(),ua=m,wr=b,ua.attachEvent("onpropertychange",no)):u==="focusout"&&fa()}function Mi(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return gs(wr)}function so(u,m){if(u==="click")return gs(m)}function Yo(u,m){if(u==="input"||u==="change")return gs(m)}function Jl(u,m){return u===m&&(u!==0||1/u===1/m)||u!==u&&m!==m}var Ur=typeof Object.is=="function"?Object.is:Jl;function Es(u,m){if(Ur(u,m))return!0;if(typeof u!="object"||u===null||typeof m!="object"||m===null)return!1;var b=Object.keys(u),k=Object.keys(m);if(b.length!==k.length)return!1;for(k=0;k<b.length;k++){var R=b[k];if(!c.call(m,R)||!Ur(u[R],m[R]))return!1}return!0}function Ql(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function Go(u,m){var b=Ql(u);u=0;for(var k;b;){if(b.nodeType===3){if(k=u+b.textContent.length,u<=m&&k>=m)return{node:b,offset:m-u};u=k}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=Ql(b)}}function Xl(u,m){return u&&m?u===m?!0:u&&u.nodeType===3?!1:m&&m.nodeType===3?Xl(u,m.parentNode):"contains"in u?u.contains(m):u.compareDocumentPosition?!!(u.compareDocumentPosition(m)&16):!1:!1}function Zo(){for(var u=window,m=Ie();m instanceof u.HTMLIFrameElement;){try{var b=typeof m.contentWindow.location.href=="string"}catch{b=!1}if(b)u=m.contentWindow;else break;m=Ie(u.document)}return m}function Ko(u){var m=u&&u.nodeName&&u.nodeName.toLowerCase();return m&&(m==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||m==="textarea"||u.contentEditable==="true")}function g(u){var m=Zo(),b=u.focusedElem,k=u.selectionRange;if(m!==b&&b&&b.ownerDocument&&Xl(b.ownerDocument.documentElement,b)){if(k!==null&&Ko(b)){if(m=k.start,u=k.end,u===void 0&&(u=m),"selectionStart"in b)b.selectionStart=m,b.selectionEnd=Math.min(u,b.value.length);else if(u=(m=b.ownerDocument||document)&&m.defaultView||window,u.getSelection){u=u.getSelection();var R=b.textContent.length,z=Math.min(k.start,R);k=k.end===void 0?z:Math.min(k.end,R),!u.extend&&z>k&&(R=k,k=z,z=R),R=Go(b,z);var G=Go(b,k);R&&G&&(u.rangeCount!==1||u.anchorNode!==R.node||u.anchorOffset!==R.offset||u.focusNode!==G.node||u.focusOffset!==G.offset)&&(m=m.createRange(),m.setStart(R.node,R.offset),u.removeAllRanges(),z>k?(u.addRange(m),u.extend(G.node,G.offset)):(m.setEnd(G.node,G.offset),u.addRange(m)))}}for(m=[],u=b;u=u.parentNode;)u.nodeType===1&&m.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<m.length;b++)u=m[b],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var ju=l&&"documentMode"in document&&11>=document.documentMode,ec=null,tc=null,jd=null,Nu=!1;function Em(u,m,b){var k=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;Nu||ec==null||ec!==Ie(k)||(k=ec,"selectionStart"in k&&Ko(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),jd&&Es(jd,k)||(jd=k,k=C(tc,"onSelect"),0<k.length&&(m=new Fo("onSelect","select",null,m,b),u.push({event:m,listeners:k}),m.target=ec)))}function io(u,m){var b={};return b[u.toLowerCase()]=m.toLowerCase(),b["Webkit"+u]="webkit"+m,b["Moz"+u]="moz"+m,b}var nc={animationend:io("Animation","AnimationEnd"),animationiteration:io("Animation","AnimationIteration"),animationstart:io("Animation","AnimationStart"),transitionend:io("Transition","TransitionEnd")},ao={},Wf={};l&&(Wf=document.createElement("div").style,"AnimationEvent"in window||(delete nc.animationend.animation,delete nc.animationiteration.animation,delete nc.animationstart.animation),"TransitionEvent"in window||delete nc.transitionend.transition);function Nd(u){if(ao[u])return ao[u];if(!nc[u])return u;var m=nc[u],b;for(b in m)if(m.hasOwnProperty(b)&&b in Wf)return ao[u]=m[b];return u}var Om=Nd("animationend"),Di=Nd("animationiteration"),$f=Nd("animationstart"),Hf=Nd("transitionend"),rc=new Map,Im="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function si(u,m){rc.set(u,m),a(m,[u])}for(var Jo=0;Jo<Im.length;Jo++){var Su=Im[Jo],Am=Su.toLowerCase(),My=Su[0].toUpperCase()+Su.slice(1);si(Am,"on"+My)}si(Om,"onAnimationEnd"),si(Di,"onAnimationIteration"),si($f,"onAnimationStart"),si("dblclick","onDoubleClick"),si("focusin","onFocus"),si("focusout","onBlur"),si(Hf,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rm=new Set("cancel close invalid load scroll toggle".split(" ").concat(sc));function Yf(u,m,b){var k=u.type||"unknown-event";u.currentTarget=b,Po(k,m,void 0,u),u.currentTarget=null}function Gf(u,m){m=(m&4)!==0;for(var b=0;b<u.length;b++){var k=u[b],R=k.event;k=k.listeners;e:{var z=void 0;if(m)for(var G=k.length-1;0<=G;G--){var fe=k[G],me=fe.instance,Ee=fe.currentTarget;if(fe=fe.listener,me!==z&&R.isPropagationStopped())break e;Yf(R,fe,Ee),z=me}else for(G=0;G<k.length;G++){if(fe=k[G],me=fe.instance,Ee=fe.currentTarget,fe=fe.listener,me!==z&&R.isPropagationStopped())break e;Yf(R,fe,Ee),z=me}}}if(ta)throw u=La,ta=!1,La=null,u}function Sn(u,m){var b=m[lc];b===void 0&&(b=m[lc]=new Set);var k=u+"__bubble";b.has(k)||(Lm(m,u,2,!1),b.add(k))}function Zf(u,m,b){var k=0;m&&(k|=4),Lm(b,u,k,m)}var Sd="_reactListening"+Math.random().toString(36).slice(2);function ic(u){if(!u[Sd]){u[Sd]=!0,r.forEach(function(b){b!=="selectionchange"&&(Rm.has(b)||Zf(b,!1,u),Zf(b,!0,u))});var m=u.nodeType===9?u:u.ownerDocument;m===null||m[Sd]||(m[Sd]=!0,Zf("selectionchange",!1,m))}}function Lm(u,m,b,k){switch(Ht(m)){case 1:var R=dd;break;case 4:R=ql;break;default:R=ca}b=R.bind(null,m,b,u),R=void 0,!ko||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(R=!0),k?R!==void 0?u.addEventListener(m,b,{capture:!0,passive:R}):u.addEventListener(m,b,!0):R!==void 0?u.addEventListener(m,b,{passive:R}):u.addEventListener(m,b,!1)}function f(u,m,b,k,R){var z=k;if((m&1)===0&&(m&2)===0&&k!==null)e:for(;;){if(k===null)return;var G=k.tag;if(G===3||G===4){var fe=k.stateNode.containerInfo;if(fe===R||fe.nodeType===8&&fe.parentNode===R)break;if(G===4)for(G=k.return;G!==null;){var me=G.tag;if((me===3||me===4)&&(me=G.stateNode.containerInfo,me===R||me.nodeType===8&&me.parentNode===R))return;G=G.return}for(;fe!==null;){if(G=Xo(fe),G===null)return;if(me=G.tag,me===5||me===6){k=z=G;continue e}fe=fe.parentNode}}k=k.return}Ra(function(){var Ee=z,Ge=rr(b),Ze=[];e:{var Ye=rc.get(u);if(Ye!==void 0){var at=Fo,ut=u;switch(u){case"keypress":if(Za(b)===0)break e;case"keydown":case"keyup":at=Wl;break;case"focusin":ut="focus",at=Ka;break;case"focusout":ut="blur",at=Ka;break;case"beforeblur":case"afterblur":at=Ka;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=zo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=Uo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=$o;break;case Om:case Di:case $f:at=hd;break;case Hf:at=yd;break;case"scroll":at=ud;break;case"wheel":at=vd;break;case"copy":case"cut":case"paste":at=Vo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=Hl}var mt=(m&4)!==0,sr=!mt&&u==="scroll",Te=mt?Ye!==null?Ye+"Capture":null:Ye;mt=[];for(var be=Ee,ke;be!==null;){ke=be;var Je=ke.stateNode;if(ke.tag===5&&Je!==null&&(ke=Je,Te!==null&&(Je=Xi(be,Te),Je!=null&&mt.push(y(be,Je,ke)))),sr)break;be=be.return}0<mt.length&&(Ye=new at(Ye,ut,null,b,Ge),Ze.push({event:Ye,listeners:mt}))}}if((m&7)===0){e:{if(Ye=u==="mouseover"||u==="pointerover",at=u==="mouseout"||u==="pointerout",Ye&&b!==an&&(ut=b.relatedTarget||b.fromElement)&&(Xo(ut)||ut[xn]))break e;if((at||Ye)&&(Ye=Ge.window===Ge?Ge:(Ye=Ge.ownerDocument)?Ye.defaultView||Ye.parentWindow:window,at?(ut=b.relatedTarget||b.toElement,at=Ee,ut=ut?Xo(ut):null,ut!==null&&(sr=Ts(ut),ut!==sr||ut.tag!==5&&ut.tag!==6)&&(ut=null)):(at=null,ut=Ee),at!==ut)){if(mt=zo,Je="onMouseLeave",Te="onMouseEnter",be="mouse",(u==="pointerout"||u==="pointerover")&&(mt=Hl,Je="onPointerLeave",Te="onPointerEnter",be="pointer"),sr=at==null?Ye:tl(at),ke=ut==null?Ye:tl(ut),Ye=new mt(Je,be+"leave",at,b,Ge),Ye.target=sr,Ye.relatedTarget=ke,Je=null,Xo(Ge)===Ee&&(mt=new mt(Te,be+"enter",ut,b,Ge),mt.target=ke,mt.relatedTarget=sr,Je=mt),sr=Je,at&&ut)t:{for(mt=at,Te=ut,be=0,ke=mt;ke;ke=A(ke))be++;for(ke=0,Je=Te;Je;Je=A(Je))ke++;for(;0<be-ke;)mt=A(mt),be--;for(;0<ke-be;)Te=A(Te),ke--;for(;be--;){if(mt===Te||Te!==null&&mt===Te.alternate)break t;mt=A(mt),Te=A(Te)}mt=null}else mt=null;at!==null&&V(Ze,Ye,at,mt,!1),ut!==null&&sr!==null&&V(Ze,sr,ut,mt,!0)}}e:{if(Ye=Ee?tl(Ee):window,at=Ye.nodeName&&Ye.nodeName.toLowerCase(),at==="select"||at==="input"&&Ye.type==="file")var pt=wd;else if(Kl(Ye))if(Kr)pt=Yo;else{pt=Mi;var Tt=ro}else(at=Ye.nodeName)&&at.toLowerCase()==="input"&&(Ye.type==="checkbox"||Ye.type==="radio")&&(pt=so);if(pt&&(pt=pt(u,Ee))){Xa(Ze,pt,b,Ge);break e}Tt&&Tt(u,Ye,Ee),u==="focusout"&&(Tt=Ye._wrapperState)&&Tt.controlled&&Ye.type==="number"&&qe(Ye,"number",Ye.value)}switch(Tt=Ee?tl(Ee):window,u){case"focusin":(Kl(Tt)||Tt.contentEditable==="true")&&(ec=Tt,tc=Ee,jd=null);break;case"focusout":jd=tc=ec=null;break;case"mousedown":Nu=!0;break;case"contextmenu":case"mouseup":case"dragend":Nu=!1,Em(Ze,b,Ge);break;case"selectionchange":if(ju)break;case"keydown":case"keyup":Em(Ze,b,Ge)}var kt;if(Ms)e:{switch(u){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else ps?ki(u,b)&&(At="onCompositionEnd"):u==="keydown"&&b.keyCode===229&&(At="onCompositionStart");At&&(Gl&&b.locale!=="ko"&&(ps||At!=="onCompositionStart"?At==="onCompositionEnd"&&ps&&(kt=Lo()):(ks=Ge,_r="value"in ks?ks.value:ks.textContent,ps=!0)),Tt=C(Ee,At),0<Tt.length&&(At=new Bo(At,u,null,b,Ge),Ze.push({event:At,listeners:Tt}),kt?At.data=kt:(kt=Ho(b),kt!==null&&(At.data=kt)))),(kt=ms?bd(u,b):Ds(u,b))&&(Ee=C(Ee,"onBeforeInput"),0<Ee.length&&(Ge=new Bo("onBeforeInput","beforeinput",null,b,Ge),Ze.push({event:Ge,listeners:Ee}),Ge.data=kt))}Gf(Ze,m)})}function y(u,m,b){return{instance:u,listener:m,currentTarget:b}}function C(u,m){for(var b=m+"Capture",k=[];u!==null;){var R=u,z=R.stateNode;R.tag===5&&z!==null&&(R=z,z=Xi(u,b),z!=null&&k.unshift(y(u,z,R)),z=Xi(u,m),z!=null&&k.push(y(u,z,R))),u=u.return}return k}function A(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function V(u,m,b,k,R){for(var z=m._reactName,G=[];b!==null&&b!==k;){var fe=b,me=fe.alternate,Ee=fe.stateNode;if(me!==null&&me===k)break;fe.tag===5&&Ee!==null&&(fe=Ee,R?(me=Xi(b,z),me!=null&&G.unshift(y(b,me,fe))):R||(me=Xi(b,z),me!=null&&G.push(y(b,me,fe)))),b=b.return}G.length!==0&&u.push({event:m,listeners:G})}var K=/\r\n?/g,he=/\u0000|\uFFFD/g;function Se(u){return(typeof u=="string"?u:""+u).replace(K,`
`).replace(he,"")}function De(u,m,b){if(m=Se(m),Se(u)!==m&&b)throw Error(t(425))}function We(){}var st=null,Nt=null;function $t(u,m){return u==="textarea"||u==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var jr=typeof setTimeout=="function"?setTimeout:void 0,hr=typeof clearTimeout=="function"?clearTimeout:void 0,xs=typeof Promise=="function"?Promise:void 0,Jr=typeof queueMicrotask=="function"?queueMicrotask:typeof xs<"u"?function(u){return xs.resolve(null).then(u).catch(ac)}:jr;function ac(u){setTimeout(function(){throw u})}function Kf(u,m){var b=m,k=0;do{var R=b.nextSibling;if(u.removeChild(b),R&&R.nodeType===8)if(b=R.data,b==="/$"){if(k===0){u.removeChild(R),Fr(m);return}k--}else b!=="$"&&b!=="$?"&&b!=="$!"||k++;b=R}while(b);Fr(m)}function oo(u){for(;u!=null;u=u.nextSibling){var m=u.nodeType;if(m===1||m===3)break;if(m===8){if(m=u.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return u}function Fm(u){u=u.previousSibling;for(var m=0;u;){if(u.nodeType===8){var b=u.data;if(b==="$"||b==="$!"||b==="$?"){if(m===0)return u;m--}else b==="/$"&&m++}u=u.previousSibling}return null}var Qo=Math.random().toString(36).slice(2),Ei="__reactFiber$"+Qo,oc="__reactProps$"+Qo,xn="__reactContainer$"+Qo,lc="__reactEvents$"+Qo,Dy="__reactListeners$"+Qo,Ey="__reactHandles$"+Qo;function Xo(u){var m=u[Ei];if(m)return m;for(var b=u.parentNode;b;){if(m=b[xn]||b[Ei]){if(b=m.alternate,m.child!==null||b!==null&&b.child!==null)for(u=Fm(u);u!==null;){if(b=u[Ei])return b;u=Fm(u)}return m}u=b,b=u.parentNode}return null}function el(u){return u=u[Ei]||u[xn],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function tl(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function Cu(u){return u[oc]||null}var Oy=[],Tu=-1;function cc(u){return{current:u}}function Ln(u){0>Tu||(u.current=Oy[Tu],Oy[Tu]=null,Tu--)}function On(u,m){Tu++,Oy[Tu]=u.current,u.current=m}var dc={},Qr=cc(dc),Os=cc(!1),Cd=dc;function ku(u,m){var b=u.type.contextTypes;if(!b)return dc;var k=u.stateNode;if(k&&k.__reactInternalMemoizedUnmaskedChildContext===m)return k.__reactInternalMemoizedMaskedChildContext;var R={},z;for(z in b)R[z]=m[z];return k&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=m,u.__reactInternalMemoizedMaskedChildContext=R),R}function Is(u){return u=u.childContextTypes,u!=null}function qm(){Ln(Os),Ln(Qr)}function m1(u,m,b){if(Qr.current!==dc)throw Error(t(168));On(Qr,m),On(Os,b)}function p1(u,m,b){var k=u.stateNode;if(m=m.childContextTypes,typeof k.getChildContext!="function")return b;k=k.getChildContext();for(var R in k)if(!(R in m))throw Error(t(108,ie(u)||"Unknown",R));return oe({},b,k)}function zm(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||dc,Cd=Qr.current,On(Qr,u),On(Os,Os.current),!0}function g1(u,m,b){var k=u.stateNode;if(!k)throw Error(t(169));b?(u=p1(u,m,Cd),k.__reactInternalMemoizedMergedChildContext=u,Ln(Os),Ln(Qr),On(Qr,u)):Ln(Os),On(Os,b)}var nl=null,Um=!1,Iy=!1;function x1(u){nl===null?nl=[u]:nl.push(u)}function R6(u){Um=!0,x1(u)}function uc(){if(!Iy&&nl!==null){Iy=!0;var u=0,m=Kt;try{var b=nl;for(Kt=1;u<b.length;u++){var k=b[u];do k=k(!0);while(k!==null)}nl=null,Um=!1}catch(R){throw nl!==null&&(nl=nl.slice(u+1)),Rl(Eo,uc),R}finally{Kt=m,Iy=!1}}return null}var Pu=[],Mu=0,Vm=null,Bm=0,Oi=[],Ii=0,Td=null,rl=1,sl="";function kd(u,m){Pu[Mu++]=Bm,Pu[Mu++]=Vm,Vm=u,Bm=m}function y1(u,m,b){Oi[Ii++]=rl,Oi[Ii++]=sl,Oi[Ii++]=Td,Td=u;var k=rl;u=sl;var R=32-Et(k)-1;k&=~(1<<R),b+=1;var z=32-Et(m)+R;if(30<z){var G=R-R%5;z=(k&(1<<G)-1).toString(32),k>>=G,R-=G,rl=1<<32-Et(m)+R|b<<R|k,sl=z+u}else rl=1<<z|b<<R|k,sl=u}function Ay(u){u.return!==null&&(kd(u,1),y1(u,1,0))}function Ry(u){for(;u===Vm;)Vm=Pu[--Mu],Pu[Mu]=null,Bm=Pu[--Mu],Pu[Mu]=null;for(;u===Td;)Td=Oi[--Ii],Oi[Ii]=null,sl=Oi[--Ii],Oi[Ii]=null,rl=Oi[--Ii],Oi[Ii]=null}var ii=null,ai=null,Bn=!1,ha=null;function v1(u,m){var b=Fi(5,null,null,0);b.elementType="DELETED",b.stateNode=m,b.return=u,m=u.deletions,m===null?(u.deletions=[b],u.flags|=16):m.push(b)}function b1(u,m){switch(u.tag){case 5:var b=u.type;return m=m.nodeType!==1||b.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(u.stateNode=m,ii=u,ai=oo(m.firstChild),!0):!1;case 6:return m=u.pendingProps===""||m.nodeType!==3?null:m,m!==null?(u.stateNode=m,ii=u,ai=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(b=Td!==null?{id:rl,overflow:sl}:null,u.memoizedState={dehydrated:m,treeContext:b,retryLane:1073741824},b=Fi(18,null,null,0),b.stateNode=m,b.return=u,u.child=b,ii=u,ai=null,!0):!1;default:return!1}}function Ly(u){return(u.mode&1)!==0&&(u.flags&128)===0}function Fy(u){if(Bn){var m=ai;if(m){var b=m;if(!b1(u,m)){if(Ly(u))throw Error(t(418));m=oo(b.nextSibling);var k=ii;m&&b1(u,m)?v1(k,b):(u.flags=u.flags&-4097|2,Bn=!1,ii=u)}}else{if(Ly(u))throw Error(t(418));u.flags=u.flags&-4097|2,Bn=!1,ii=u}}}function _1(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;ii=u}function Wm(u){if(u!==ii)return!1;if(!Bn)return _1(u),Bn=!0,!1;var m;if((m=u.tag!==3)&&!(m=u.tag!==5)&&(m=u.type,m=m!=="head"&&m!=="body"&&!$t(u.type,u.memoizedProps)),m&&(m=ai)){if(Ly(u))throw w1(),Error(t(418));for(;m;)v1(u,m),m=oo(m.nextSibling)}if(_1(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,m=0;u;){if(u.nodeType===8){var b=u.data;if(b==="/$"){if(m===0){ai=oo(u.nextSibling);break e}m--}else b!=="$"&&b!=="$!"&&b!=="$?"||m++}u=u.nextSibling}ai=null}}else ai=ii?oo(u.stateNode.nextSibling):null;return!0}function w1(){for(var u=ai;u;)u=oo(u.nextSibling)}function Du(){ai=ii=null,Bn=!1}function qy(u){ha===null?ha=[u]:ha.push(u)}var L6=M.ReactCurrentBatchConfig;function Jf(u,m,b){if(u=b.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(t(309));var k=b.stateNode}if(!k)throw Error(t(147,u));var R=k,z=""+u;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===z?m.ref:(m=function(G){var fe=R.refs;G===null?delete fe[z]:fe[z]=G},m._stringRef=z,m)}if(typeof u!="string")throw Error(t(284));if(!b._owner)throw Error(t(290,u))}return u}function $m(u,m){throw u=Object.prototype.toString.call(m),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":u))}function j1(u){var m=u._init;return m(u._payload)}function N1(u){function m(Te,be){if(u){var ke=Te.deletions;ke===null?(Te.deletions=[be],Te.flags|=16):ke.push(be)}}function b(Te,be){if(!u)return null;for(;be!==null;)m(Te,be),be=be.sibling;return null}function k(Te,be){for(Te=new Map;be!==null;)be.key!==null?Te.set(be.key,be):Te.set(be.index,be),be=be.sibling;return Te}function R(Te,be){return Te=vc(Te,be),Te.index=0,Te.sibling=null,Te}function z(Te,be,ke){return Te.index=ke,u?(ke=Te.alternate,ke!==null?(ke=ke.index,ke<be?(Te.flags|=2,be):ke):(Te.flags|=2,be)):(Te.flags|=1048576,be)}function G(Te){return u&&Te.alternate===null&&(Te.flags|=2),Te}function fe(Te,be,ke,Je){return be===null||be.tag!==6?(be=Mv(ke,Te.mode,Je),be.return=Te,be):(be=R(be,ke),be.return=Te,be)}function me(Te,be,ke,Je){var pt=ke.type;return pt===q?Ge(Te,be,ke.props.children,Je,ke.key):be!==null&&(be.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===J&&j1(pt)===be.type)?(Je=R(be,ke.props),Je.ref=Jf(Te,be,ke),Je.return=Te,Je):(Je=pp(ke.type,ke.key,ke.props,null,Te.mode,Je),Je.ref=Jf(Te,be,ke),Je.return=Te,Je)}function Ee(Te,be,ke,Je){return be===null||be.tag!==4||be.stateNode.containerInfo!==ke.containerInfo||be.stateNode.implementation!==ke.implementation?(be=Dv(ke,Te.mode,Je),be.return=Te,be):(be=R(be,ke.children||[]),be.return=Te,be)}function Ge(Te,be,ke,Je,pt){return be===null||be.tag!==7?(be=Rd(ke,Te.mode,Je,pt),be.return=Te,be):(be=R(be,ke),be.return=Te,be)}function Ze(Te,be,ke){if(typeof be=="string"&&be!==""||typeof be=="number")return be=Mv(""+be,Te.mode,ke),be.return=Te,be;if(typeof be=="object"&&be!==null){switch(be.$$typeof){case O:return ke=pp(be.type,be.key,be.props,null,Te.mode,ke),ke.ref=Jf(Te,null,be),ke.return=Te,ke;case I:return be=Dv(be,Te.mode,ke),be.return=Te,be;case J:var Je=be._init;return Ze(Te,Je(be._payload),ke)}if(te(be)||Z(be))return be=Rd(be,Te.mode,ke,null),be.return=Te,be;$m(Te,be)}return null}function Ye(Te,be,ke,Je){var pt=be!==null?be.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number")return pt!==null?null:fe(Te,be,""+ke,Je);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case O:return ke.key===pt?me(Te,be,ke,Je):null;case I:return ke.key===pt?Ee(Te,be,ke,Je):null;case J:return pt=ke._init,Ye(Te,be,pt(ke._payload),Je)}if(te(ke)||Z(ke))return pt!==null?null:Ge(Te,be,ke,Je,null);$m(Te,ke)}return null}function at(Te,be,ke,Je,pt){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return Te=Te.get(ke)||null,fe(be,Te,""+Je,pt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case O:return Te=Te.get(Je.key===null?ke:Je.key)||null,me(be,Te,Je,pt);case I:return Te=Te.get(Je.key===null?ke:Je.key)||null,Ee(be,Te,Je,pt);case J:var Tt=Je._init;return at(Te,be,ke,Tt(Je._payload),pt)}if(te(Je)||Z(Je))return Te=Te.get(ke)||null,Ge(be,Te,Je,pt,null);$m(be,Je)}return null}function ut(Te,be,ke,Je){for(var pt=null,Tt=null,kt=be,At=be=0,Ir=null;kt!==null&&At<ke.length;At++){kt.index>At?(Ir=kt,kt=null):Ir=kt.sibling;var cn=Ye(Te,kt,ke[At],Je);if(cn===null){kt===null&&(kt=Ir);break}u&&kt&&cn.alternate===null&&m(Te,kt),be=z(cn,be,At),Tt===null?pt=cn:Tt.sibling=cn,Tt=cn,kt=Ir}if(At===ke.length)return b(Te,kt),Bn&&kd(Te,At),pt;if(kt===null){for(;At<ke.length;At++)kt=Ze(Te,ke[At],Je),kt!==null&&(be=z(kt,be,At),Tt===null?pt=kt:Tt.sibling=kt,Tt=kt);return Bn&&kd(Te,At),pt}for(kt=k(Te,kt);At<ke.length;At++)Ir=at(kt,Te,At,ke[At],Je),Ir!==null&&(u&&Ir.alternate!==null&&kt.delete(Ir.key===null?At:Ir.key),be=z(Ir,be,At),Tt===null?pt=Ir:Tt.sibling=Ir,Tt=Ir);return u&&kt.forEach(function(bc){return m(Te,bc)}),Bn&&kd(Te,At),pt}function mt(Te,be,ke,Je){var pt=Z(ke);if(typeof pt!="function")throw Error(t(150));if(ke=pt.call(ke),ke==null)throw Error(t(151));for(var Tt=pt=null,kt=be,At=be=0,Ir=null,cn=ke.next();kt!==null&&!cn.done;At++,cn=ke.next()){kt.index>At?(Ir=kt,kt=null):Ir=kt.sibling;var bc=Ye(Te,kt,cn.value,Je);if(bc===null){kt===null&&(kt=Ir);break}u&&kt&&bc.alternate===null&&m(Te,kt),be=z(bc,be,At),Tt===null?pt=bc:Tt.sibling=bc,Tt=bc,kt=Ir}if(cn.done)return b(Te,kt),Bn&&kd(Te,At),pt;if(kt===null){for(;!cn.done;At++,cn=ke.next())cn=Ze(Te,cn.value,Je),cn!==null&&(be=z(cn,be,At),Tt===null?pt=cn:Tt.sibling=cn,Tt=cn);return Bn&&kd(Te,At),pt}for(kt=k(Te,kt);!cn.done;At++,cn=ke.next())cn=at(kt,Te,At,cn.value,Je),cn!==null&&(u&&cn.alternate!==null&&kt.delete(cn.key===null?At:cn.key),be=z(cn,be,At),Tt===null?pt=cn:Tt.sibling=cn,Tt=cn);return u&&kt.forEach(function(gq){return m(Te,gq)}),Bn&&kd(Te,At),pt}function sr(Te,be,ke,Je){if(typeof ke=="object"&&ke!==null&&ke.type===q&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case O:e:{for(var pt=ke.key,Tt=be;Tt!==null;){if(Tt.key===pt){if(pt=ke.type,pt===q){if(Tt.tag===7){b(Te,Tt.sibling),be=R(Tt,ke.props.children),be.return=Te,Te=be;break e}}else if(Tt.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===J&&j1(pt)===Tt.type){b(Te,Tt.sibling),be=R(Tt,ke.props),be.ref=Jf(Te,Tt,ke),be.return=Te,Te=be;break e}b(Te,Tt);break}else m(Te,Tt);Tt=Tt.sibling}ke.type===q?(be=Rd(ke.props.children,Te.mode,Je,ke.key),be.return=Te,Te=be):(Je=pp(ke.type,ke.key,ke.props,null,Te.mode,Je),Je.ref=Jf(Te,be,ke),Je.return=Te,Te=Je)}return G(Te);case I:e:{for(Tt=ke.key;be!==null;){if(be.key===Tt)if(be.tag===4&&be.stateNode.containerInfo===ke.containerInfo&&be.stateNode.implementation===ke.implementation){b(Te,be.sibling),be=R(be,ke.children||[]),be.return=Te,Te=be;break e}else{b(Te,be);break}else m(Te,be);be=be.sibling}be=Dv(ke,Te.mode,Je),be.return=Te,Te=be}return G(Te);case J:return Tt=ke._init,sr(Te,be,Tt(ke._payload),Je)}if(te(ke))return ut(Te,be,ke,Je);if(Z(ke))return mt(Te,be,ke,Je);$m(Te,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"?(ke=""+ke,be!==null&&be.tag===6?(b(Te,be.sibling),be=R(be,ke),be.return=Te,Te=be):(b(Te,be),be=Mv(ke,Te.mode,Je),be.return=Te,Te=be),G(Te)):b(Te,be)}return sr}var Eu=N1(!0),S1=N1(!1),Hm=cc(null),Ym=null,Ou=null,zy=null;function Uy(){zy=Ou=Ym=null}function Vy(u){var m=Hm.current;Ln(Hm),u._currentValue=m}function By(u,m,b){for(;u!==null;){var k=u.alternate;if((u.childLanes&m)!==m?(u.childLanes|=m,k!==null&&(k.childLanes|=m)):k!==null&&(k.childLanes&m)!==m&&(k.childLanes|=m),u===b)break;u=u.return}}function Iu(u,m){Ym=u,zy=Ou=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&m)!==0&&(As=!0),u.firstContext=null)}function Ai(u){var m=u._currentValue;if(zy!==u)if(u={context:u,memoizedValue:m,next:null},Ou===null){if(Ym===null)throw Error(t(308));Ou=u,Ym.dependencies={lanes:0,firstContext:u}}else Ou=Ou.next=u;return m}var Pd=null;function Wy(u){Pd===null?Pd=[u]:Pd.push(u)}function C1(u,m,b,k){var R=m.interleaved;return R===null?(b.next=b,Wy(m)):(b.next=R.next,R.next=b),m.interleaved=b,il(u,k)}function il(u,m){u.lanes|=m;var b=u.alternate;for(b!==null&&(b.lanes|=m),b=u,u=u.return;u!==null;)u.childLanes|=m,b=u.alternate,b!==null&&(b.childLanes|=m),b=u,u=u.return;return b.tag===3?b.stateNode:null}var fc=!1;function $y(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function T1(u,m){u=u.updateQueue,m.updateQueue===u&&(m.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function al(u,m){return{eventTime:u,lane:m,tag:0,payload:null,callback:null,next:null}}function hc(u,m,b){var k=u.updateQueue;if(k===null)return null;if(k=k.shared,(on&2)!==0){var R=k.pending;return R===null?m.next=m:(m.next=R.next,R.next=m),k.pending=m,il(u,b)}return R=k.interleaved,R===null?(m.next=m,Wy(k)):(m.next=R.next,R.next=m),k.interleaved=m,il(u,b)}function Gm(u,m,b){if(m=m.updateQueue,m!==null&&(m=m.shared,(b&4194240)!==0)){var k=m.lanes;k&=u.pendingLanes,b|=k,m.lanes=b,fs(u,b)}}function k1(u,m){var b=u.updateQueue,k=u.alternate;if(k!==null&&(k=k.updateQueue,b===k)){var R=null,z=null;if(b=b.firstBaseUpdate,b!==null){do{var G={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};z===null?R=z=G:z=z.next=G,b=b.next}while(b!==null);z===null?R=z=m:z=z.next=m}else R=z=m;b={baseState:k.baseState,firstBaseUpdate:R,lastBaseUpdate:z,shared:k.shared,effects:k.effects},u.updateQueue=b;return}u=b.lastBaseUpdate,u===null?b.firstBaseUpdate=m:u.next=m,b.lastBaseUpdate=m}function Zm(u,m,b,k){var R=u.updateQueue;fc=!1;var z=R.firstBaseUpdate,G=R.lastBaseUpdate,fe=R.shared.pending;if(fe!==null){R.shared.pending=null;var me=fe,Ee=me.next;me.next=null,G===null?z=Ee:G.next=Ee,G=me;var Ge=u.alternate;Ge!==null&&(Ge=Ge.updateQueue,fe=Ge.lastBaseUpdate,fe!==G&&(fe===null?Ge.firstBaseUpdate=Ee:fe.next=Ee,Ge.lastBaseUpdate=me))}if(z!==null){var Ze=R.baseState;G=0,Ge=Ee=me=null,fe=z;do{var Ye=fe.lane,at=fe.eventTime;if((k&Ye)===Ye){Ge!==null&&(Ge=Ge.next={eventTime:at,lane:0,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null});e:{var ut=u,mt=fe;switch(Ye=m,at=b,mt.tag){case 1:if(ut=mt.payload,typeof ut=="function"){Ze=ut.call(at,Ze,Ye);break e}Ze=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=mt.payload,Ye=typeof ut=="function"?ut.call(at,Ze,Ye):ut,Ye==null)break e;Ze=oe({},Ze,Ye);break e;case 2:fc=!0}}fe.callback!==null&&fe.lane!==0&&(u.flags|=64,Ye=R.effects,Ye===null?R.effects=[fe]:Ye.push(fe))}else at={eventTime:at,lane:Ye,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},Ge===null?(Ee=Ge=at,me=Ze):Ge=Ge.next=at,G|=Ye;if(fe=fe.next,fe===null){if(fe=R.shared.pending,fe===null)break;Ye=fe,fe=Ye.next,Ye.next=null,R.lastBaseUpdate=Ye,R.shared.pending=null}}while(!0);if(Ge===null&&(me=Ze),R.baseState=me,R.firstBaseUpdate=Ee,R.lastBaseUpdate=Ge,m=R.shared.interleaved,m!==null){R=m;do G|=R.lane,R=R.next;while(R!==m)}else z===null&&(R.shared.lanes=0);Ed|=G,u.lanes=G,u.memoizedState=Ze}}function P1(u,m,b){if(u=m.effects,m.effects=null,u!==null)for(m=0;m<u.length;m++){var k=u[m],R=k.callback;if(R!==null){if(k.callback=null,k=b,typeof R!="function")throw Error(t(191,R));R.call(k)}}}var Qf={},lo=cc(Qf),Xf=cc(Qf),eh=cc(Qf);function Md(u){if(u===Qf)throw Error(t(174));return u}function Hy(u,m){switch(On(eh,m),On(Xf,u),On(lo,Qf),u=m.nodeType,u){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:Xe(null,"");break;default:u=u===8?m.parentNode:m,m=u.namespaceURI||null,u=u.tagName,m=Xe(m,u)}Ln(lo),On(lo,m)}function Au(){Ln(lo),Ln(Xf),Ln(eh)}function M1(u){Md(eh.current);var m=Md(lo.current),b=Xe(m,u.type);m!==b&&(On(Xf,u),On(lo,b))}function Yy(u){Xf.current===u&&(Ln(lo),Ln(Xf))}var Gn=cc(0);function Km(u){for(var m=u;m!==null;){if(m.tag===13){var b=m.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===u)break;for(;m.sibling===null;){if(m.return===null||m.return===u)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var Gy=[];function Zy(){for(var u=0;u<Gy.length;u++)Gy[u]._workInProgressVersionPrimary=null;Gy.length=0}var Jm=M.ReactCurrentDispatcher,Ky=M.ReactCurrentBatchConfig,Dd=0,Zn=null,Nr=null,Er=null,Qm=!1,th=!1,nh=0,F6=0;function Xr(){throw Error(t(321))}function Jy(u,m){if(m===null)return!1;for(var b=0;b<m.length&&b<u.length;b++)if(!Ur(u[b],m[b]))return!1;return!0}function Qy(u,m,b,k,R,z){if(Dd=z,Zn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,Jm.current=u===null||u.memoizedState===null?V6:B6,u=b(k,R),th){z=0;do{if(th=!1,nh=0,25<=z)throw Error(t(301));z+=1,Er=Nr=null,m.updateQueue=null,Jm.current=W6,u=b(k,R)}while(th)}if(Jm.current=tp,m=Nr!==null&&Nr.next!==null,Dd=0,Er=Nr=Zn=null,Qm=!1,m)throw Error(t(300));return u}function Xy(){var u=nh!==0;return nh=0,u}function co(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Er===null?Zn.memoizedState=Er=u:Er=Er.next=u,Er}function Ri(){if(Nr===null){var u=Zn.alternate;u=u!==null?u.memoizedState:null}else u=Nr.next;var m=Er===null?Zn.memoizedState:Er.next;if(m!==null)Er=m,Nr=u;else{if(u===null)throw Error(t(310));Nr=u,u={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},Er===null?Zn.memoizedState=Er=u:Er=Er.next=u}return Er}function rh(u,m){return typeof m=="function"?m(u):m}function ev(u){var m=Ri(),b=m.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=u;var k=Nr,R=k.baseQueue,z=b.pending;if(z!==null){if(R!==null){var G=R.next;R.next=z.next,z.next=G}k.baseQueue=R=z,b.pending=null}if(R!==null){z=R.next,k=k.baseState;var fe=G=null,me=null,Ee=z;do{var Ge=Ee.lane;if((Dd&Ge)===Ge)me!==null&&(me=me.next={lane:0,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),k=Ee.hasEagerState?Ee.eagerState:u(k,Ee.action);else{var Ze={lane:Ge,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null};me===null?(fe=me=Ze,G=k):me=me.next=Ze,Zn.lanes|=Ge,Ed|=Ge}Ee=Ee.next}while(Ee!==null&&Ee!==z);me===null?G=k:me.next=fe,Ur(k,m.memoizedState)||(As=!0),m.memoizedState=k,m.baseState=G,m.baseQueue=me,b.lastRenderedState=k}if(u=b.interleaved,u!==null){R=u;do z=R.lane,Zn.lanes|=z,Ed|=z,R=R.next;while(R!==u)}else R===null&&(b.lanes=0);return[m.memoizedState,b.dispatch]}function tv(u){var m=Ri(),b=m.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=u;var k=b.dispatch,R=b.pending,z=m.memoizedState;if(R!==null){b.pending=null;var G=R=R.next;do z=u(z,G.action),G=G.next;while(G!==R);Ur(z,m.memoizedState)||(As=!0),m.memoizedState=z,m.baseQueue===null&&(m.baseState=z),b.lastRenderedState=z}return[z,k]}function D1(){}function E1(u,m){var b=Zn,k=Ri(),R=m(),z=!Ur(k.memoizedState,R);if(z&&(k.memoizedState=R,As=!0),k=k.queue,nv(A1.bind(null,b,k,u),[u]),k.getSnapshot!==m||z||Er!==null&&Er.memoizedState.tag&1){if(b.flags|=2048,sh(9,I1.bind(null,b,k,R,m),void 0,null),Or===null)throw Error(t(349));(Dd&30)!==0||O1(b,m,R)}return R}function O1(u,m,b){u.flags|=16384,u={getSnapshot:m,value:b},m=Zn.updateQueue,m===null?(m={lastEffect:null,stores:null},Zn.updateQueue=m,m.stores=[u]):(b=m.stores,b===null?m.stores=[u]:b.push(u))}function I1(u,m,b,k){m.value=b,m.getSnapshot=k,R1(m)&&L1(u)}function A1(u,m,b){return b(function(){R1(m)&&L1(u)})}function R1(u){var m=u.getSnapshot;u=u.value;try{var b=m();return!Ur(u,b)}catch{return!0}}function L1(u){var m=il(u,1);m!==null&&xa(m,u,1,-1)}function F1(u){var m=co();return typeof u=="function"&&(u=u()),m.memoizedState=m.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rh,lastRenderedState:u},m.queue=u,u=u.dispatch=U6.bind(null,Zn,u),[m.memoizedState,u]}function sh(u,m,b,k){return u={tag:u,create:m,destroy:b,deps:k,next:null},m=Zn.updateQueue,m===null?(m={lastEffect:null,stores:null},Zn.updateQueue=m,m.lastEffect=u.next=u):(b=m.lastEffect,b===null?m.lastEffect=u.next=u:(k=b.next,b.next=u,u.next=k,m.lastEffect=u)),u}function q1(){return Ri().memoizedState}function Xm(u,m,b,k){var R=co();Zn.flags|=u,R.memoizedState=sh(1|m,b,void 0,k===void 0?null:k)}function ep(u,m,b,k){var R=Ri();k=k===void 0?null:k;var z=void 0;if(Nr!==null){var G=Nr.memoizedState;if(z=G.destroy,k!==null&&Jy(k,G.deps)){R.memoizedState=sh(m,b,z,k);return}}Zn.flags|=u,R.memoizedState=sh(1|m,b,z,k)}function z1(u,m){return Xm(8390656,8,u,m)}function nv(u,m){return ep(2048,8,u,m)}function U1(u,m){return ep(4,2,u,m)}function V1(u,m){return ep(4,4,u,m)}function B1(u,m){if(typeof m=="function")return u=u(),m(u),function(){m(null)};if(m!=null)return u=u(),m.current=u,function(){m.current=null}}function W1(u,m,b){return b=b!=null?b.concat([u]):null,ep(4,4,B1.bind(null,m,u),b)}function rv(){}function $1(u,m){var b=Ri();m=m===void 0?null:m;var k=b.memoizedState;return k!==null&&m!==null&&Jy(m,k[1])?k[0]:(b.memoizedState=[u,m],u)}function H1(u,m){var b=Ri();m=m===void 0?null:m;var k=b.memoizedState;return k!==null&&m!==null&&Jy(m,k[1])?k[0]:(u=u(),b.memoizedState=[u,m],u)}function Y1(u,m,b){return(Dd&21)===0?(u.baseState&&(u.baseState=!1,As=!0),u.memoizedState=b):(Ur(b,m)||(b=Fl(),Zn.lanes|=b,Ed|=b,u.baseState=!0),m)}function q6(u,m){var b=Kt;Kt=b!==0&&4>b?b:4,u(!0);var k=Ky.transition;Ky.transition={};try{u(!1),m()}finally{Kt=b,Ky.transition=k}}function G1(){return Ri().memoizedState}function z6(u,m,b){var k=xc(u);if(b={lane:k,action:b,hasEagerState:!1,eagerState:null,next:null},Z1(u))K1(m,b);else if(b=C1(u,m,b,k),b!==null){var R=vs();xa(b,u,k,R),J1(b,m,k)}}function U6(u,m,b){var k=xc(u),R={lane:k,action:b,hasEagerState:!1,eagerState:null,next:null};if(Z1(u))K1(m,R);else{var z=u.alternate;if(u.lanes===0&&(z===null||z.lanes===0)&&(z=m.lastRenderedReducer,z!==null))try{var G=m.lastRenderedState,fe=z(G,b);if(R.hasEagerState=!0,R.eagerState=fe,Ur(fe,G)){var me=m.interleaved;me===null?(R.next=R,Wy(m)):(R.next=me.next,me.next=R),m.interleaved=R;return}}catch{}finally{}b=C1(u,m,R,k),b!==null&&(R=vs(),xa(b,u,k,R),J1(b,m,k))}}function Z1(u){var m=u.alternate;return u===Zn||m!==null&&m===Zn}function K1(u,m){th=Qm=!0;var b=u.pending;b===null?m.next=m:(m.next=b.next,b.next=m),u.pending=m}function J1(u,m,b){if((b&4194240)!==0){var k=m.lanes;k&=u.pendingLanes,b|=k,m.lanes=b,fs(u,b)}}var tp={readContext:Ai,useCallback:Xr,useContext:Xr,useEffect:Xr,useImperativeHandle:Xr,useInsertionEffect:Xr,useLayoutEffect:Xr,useMemo:Xr,useReducer:Xr,useRef:Xr,useState:Xr,useDebugValue:Xr,useDeferredValue:Xr,useTransition:Xr,useMutableSource:Xr,useSyncExternalStore:Xr,useId:Xr,unstable_isNewReconciler:!1},V6={readContext:Ai,useCallback:function(u,m){return co().memoizedState=[u,m===void 0?null:m],u},useContext:Ai,useEffect:z1,useImperativeHandle:function(u,m,b){return b=b!=null?b.concat([u]):null,Xm(4194308,4,B1.bind(null,m,u),b)},useLayoutEffect:function(u,m){return Xm(4194308,4,u,m)},useInsertionEffect:function(u,m){return Xm(4,2,u,m)},useMemo:function(u,m){var b=co();return m=m===void 0?null:m,u=u(),b.memoizedState=[u,m],u},useReducer:function(u,m,b){var k=co();return m=b!==void 0?b(m):m,k.memoizedState=k.baseState=m,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:m},k.queue=u,u=u.dispatch=z6.bind(null,Zn,u),[k.memoizedState,u]},useRef:function(u){var m=co();return u={current:u},m.memoizedState=u},useState:F1,useDebugValue:rv,useDeferredValue:function(u){return co().memoizedState=u},useTransition:function(){var u=F1(!1),m=u[0];return u=q6.bind(null,u[1]),co().memoizedState=u,[m,u]},useMutableSource:function(){},useSyncExternalStore:function(u,m,b){var k=Zn,R=co();if(Bn){if(b===void 0)throw Error(t(407));b=b()}else{if(b=m(),Or===null)throw Error(t(349));(Dd&30)!==0||O1(k,m,b)}R.memoizedState=b;var z={value:b,getSnapshot:m};return R.queue=z,z1(A1.bind(null,k,z,u),[u]),k.flags|=2048,sh(9,I1.bind(null,k,z,b,m),void 0,null),b},useId:function(){var u=co(),m=Or.identifierPrefix;if(Bn){var b=sl,k=rl;b=(k&~(1<<32-Et(k)-1)).toString(32)+b,m=":"+m+"R"+b,b=nh++,0<b&&(m+="H"+b.toString(32)),m+=":"}else b=F6++,m=":"+m+"r"+b.toString(32)+":";return u.memoizedState=m},unstable_isNewReconciler:!1},B6={readContext:Ai,useCallback:$1,useContext:Ai,useEffect:nv,useImperativeHandle:W1,useInsertionEffect:U1,useLayoutEffect:V1,useMemo:H1,useReducer:ev,useRef:q1,useState:function(){return ev(rh)},useDebugValue:rv,useDeferredValue:function(u){var m=Ri();return Y1(m,Nr.memoizedState,u)},useTransition:function(){var u=ev(rh)[0],m=Ri().memoizedState;return[u,m]},useMutableSource:D1,useSyncExternalStore:E1,useId:G1,unstable_isNewReconciler:!1},W6={readContext:Ai,useCallback:$1,useContext:Ai,useEffect:nv,useImperativeHandle:W1,useInsertionEffect:U1,useLayoutEffect:V1,useMemo:H1,useReducer:tv,useRef:q1,useState:function(){return tv(rh)},useDebugValue:rv,useDeferredValue:function(u){var m=Ri();return Nr===null?m.memoizedState=u:Y1(m,Nr.memoizedState,u)},useTransition:function(){var u=tv(rh)[0],m=Ri().memoizedState;return[u,m]},useMutableSource:D1,useSyncExternalStore:E1,useId:G1,unstable_isNewReconciler:!1};function ma(u,m){if(u&&u.defaultProps){m=oe({},m),u=u.defaultProps;for(var b in u)m[b]===void 0&&(m[b]=u[b]);return m}return m}function sv(u,m,b,k){m=u.memoizedState,b=b(k,m),b=b==null?m:oe({},m,b),u.memoizedState=b,u.lanes===0&&(u.updateQueue.baseState=b)}var np={isMounted:function(u){return(u=u._reactInternals)?Ts(u)===u:!1},enqueueSetState:function(u,m,b){u=u._reactInternals;var k=vs(),R=xc(u),z=al(k,R);z.payload=m,b!=null&&(z.callback=b),m=hc(u,z,R),m!==null&&(xa(m,u,R,k),Gm(m,u,R))},enqueueReplaceState:function(u,m,b){u=u._reactInternals;var k=vs(),R=xc(u),z=al(k,R);z.tag=1,z.payload=m,b!=null&&(z.callback=b),m=hc(u,z,R),m!==null&&(xa(m,u,R,k),Gm(m,u,R))},enqueueForceUpdate:function(u,m){u=u._reactInternals;var b=vs(),k=xc(u),R=al(b,k);R.tag=2,m!=null&&(R.callback=m),m=hc(u,R,k),m!==null&&(xa(m,u,k,b),Gm(m,u,k))}};function Q1(u,m,b,k,R,z,G){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(k,z,G):m.prototype&&m.prototype.isPureReactComponent?!Es(b,k)||!Es(R,z):!0}function X1(u,m,b){var k=!1,R=dc,z=m.contextType;return typeof z=="object"&&z!==null?z=Ai(z):(R=Is(m)?Cd:Qr.current,k=m.contextTypes,z=(k=k!=null)?ku(u,R):dc),m=new m(b,z),u.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=np,u.stateNode=m,m._reactInternals=u,k&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=R,u.__reactInternalMemoizedMaskedChildContext=z),m}function eT(u,m,b,k){u=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(b,k),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(b,k),m.state!==u&&np.enqueueReplaceState(m,m.state,null)}function iv(u,m,b,k){var R=u.stateNode;R.props=b,R.state=u.memoizedState,R.refs={},$y(u);var z=m.contextType;typeof z=="object"&&z!==null?R.context=Ai(z):(z=Is(m)?Cd:Qr.current,R.context=ku(u,z)),R.state=u.memoizedState,z=m.getDerivedStateFromProps,typeof z=="function"&&(sv(u,m,z,b),R.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(m=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),m!==R.state&&np.enqueueReplaceState(R,R.state,null),Zm(u,b,R,k),R.state=u.memoizedState),typeof R.componentDidMount=="function"&&(u.flags|=4194308)}function Ru(u,m){try{var b="",k=m;do b+=ce(k),k=k.return;while(k);var R=b}catch(z){R=`
Error generating stack: `+z.message+`
`+z.stack}return{value:u,source:m,stack:R,digest:null}}function av(u,m,b){return{value:u,source:null,stack:b??null,digest:m??null}}function ov(u,m){try{console.error(m.value)}catch(b){setTimeout(function(){throw b})}}var $6=typeof WeakMap=="function"?WeakMap:Map;function tT(u,m,b){b=al(-1,b),b.tag=3,b.payload={element:null};var k=m.value;return b.callback=function(){cp||(cp=!0,wv=k),ov(u,m)},b}function nT(u,m,b){b=al(-1,b),b.tag=3;var k=u.type.getDerivedStateFromError;if(typeof k=="function"){var R=m.value;b.payload=function(){return k(R)},b.callback=function(){ov(u,m)}}var z=u.stateNode;return z!==null&&typeof z.componentDidCatch=="function"&&(b.callback=function(){ov(u,m),typeof k!="function"&&(pc===null?pc=new Set([this]):pc.add(this));var G=m.stack;this.componentDidCatch(m.value,{componentStack:G!==null?G:""})}),b}function rT(u,m,b){var k=u.pingCache;if(k===null){k=u.pingCache=new $6;var R=new Set;k.set(m,R)}else R=k.get(m),R===void 0&&(R=new Set,k.set(m,R));R.has(b)||(R.add(b),u=iq.bind(null,u,m,b),m.then(u,u))}function sT(u){do{var m;if((m=u.tag===13)&&(m=u.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return u;u=u.return}while(u!==null);return null}function iT(u,m,b,k,R){return(u.mode&1)===0?(u===m?u.flags|=65536:(u.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(m=al(-1,1),m.tag=2,hc(b,m,1))),b.lanes|=1),u):(u.flags|=65536,u.lanes=R,u)}var H6=M.ReactCurrentOwner,As=!1;function ys(u,m,b,k){m.child=u===null?S1(m,null,b,k):Eu(m,u.child,b,k)}function aT(u,m,b,k,R){b=b.render;var z=m.ref;return Iu(m,R),k=Qy(u,m,b,k,z,R),b=Xy(),u!==null&&!As?(m.updateQueue=u.updateQueue,m.flags&=-2053,u.lanes&=~R,ol(u,m,R)):(Bn&&b&&Ay(m),m.flags|=1,ys(u,m,k,R),m.child)}function oT(u,m,b,k,R){if(u===null){var z=b.type;return typeof z=="function"&&!Pv(z)&&z.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(m.tag=15,m.type=z,lT(u,m,z,k,R)):(u=pp(b.type,null,k,m,m.mode,R),u.ref=m.ref,u.return=m,m.child=u)}if(z=u.child,(u.lanes&R)===0){var G=z.memoizedProps;if(b=b.compare,b=b!==null?b:Es,b(G,k)&&u.ref===m.ref)return ol(u,m,R)}return m.flags|=1,u=vc(z,k),u.ref=m.ref,u.return=m,m.child=u}function lT(u,m,b,k,R){if(u!==null){var z=u.memoizedProps;if(Es(z,k)&&u.ref===m.ref)if(As=!1,m.pendingProps=k=z,(u.lanes&R)!==0)(u.flags&131072)!==0&&(As=!0);else return m.lanes=u.lanes,ol(u,m,R)}return lv(u,m,b,k,R)}function cT(u,m,b){var k=m.pendingProps,R=k.children,z=u!==null?u.memoizedState:null;if(k.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},On(Fu,oi),oi|=b;else{if((b&1073741824)===0)return u=z!==null?z.baseLanes|b:b,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:u,cachePool:null,transitions:null},m.updateQueue=null,On(Fu,oi),oi|=u,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},k=z!==null?z.baseLanes:b,On(Fu,oi),oi|=k}else z!==null?(k=z.baseLanes|b,m.memoizedState=null):k=b,On(Fu,oi),oi|=k;return ys(u,m,R,b),m.child}function dT(u,m){var b=m.ref;(u===null&&b!==null||u!==null&&u.ref!==b)&&(m.flags|=512,m.flags|=2097152)}function lv(u,m,b,k,R){var z=Is(b)?Cd:Qr.current;return z=ku(m,z),Iu(m,R),b=Qy(u,m,b,k,z,R),k=Xy(),u!==null&&!As?(m.updateQueue=u.updateQueue,m.flags&=-2053,u.lanes&=~R,ol(u,m,R)):(Bn&&k&&Ay(m),m.flags|=1,ys(u,m,b,R),m.child)}function uT(u,m,b,k,R){if(Is(b)){var z=!0;zm(m)}else z=!1;if(Iu(m,R),m.stateNode===null)sp(u,m),X1(m,b,k),iv(m,b,k,R),k=!0;else if(u===null){var G=m.stateNode,fe=m.memoizedProps;G.props=fe;var me=G.context,Ee=b.contextType;typeof Ee=="object"&&Ee!==null?Ee=Ai(Ee):(Ee=Is(b)?Cd:Qr.current,Ee=ku(m,Ee));var Ge=b.getDerivedStateFromProps,Ze=typeof Ge=="function"||typeof G.getSnapshotBeforeUpdate=="function";Ze||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(fe!==k||me!==Ee)&&eT(m,G,k,Ee),fc=!1;var Ye=m.memoizedState;G.state=Ye,Zm(m,k,G,R),me=m.memoizedState,fe!==k||Ye!==me||Os.current||fc?(typeof Ge=="function"&&(sv(m,b,Ge,k),me=m.memoizedState),(fe=fc||Q1(m,b,fe,k,Ye,me,Ee))?(Ze||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(m.flags|=4194308)):(typeof G.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=k,m.memoizedState=me),G.props=k,G.state=me,G.context=Ee,k=fe):(typeof G.componentDidMount=="function"&&(m.flags|=4194308),k=!1)}else{G=m.stateNode,T1(u,m),fe=m.memoizedProps,Ee=m.type===m.elementType?fe:ma(m.type,fe),G.props=Ee,Ze=m.pendingProps,Ye=G.context,me=b.contextType,typeof me=="object"&&me!==null?me=Ai(me):(me=Is(b)?Cd:Qr.current,me=ku(m,me));var at=b.getDerivedStateFromProps;(Ge=typeof at=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(fe!==Ze||Ye!==me)&&eT(m,G,k,me),fc=!1,Ye=m.memoizedState,G.state=Ye,Zm(m,k,G,R);var ut=m.memoizedState;fe!==Ze||Ye!==ut||Os.current||fc?(typeof at=="function"&&(sv(m,b,at,k),ut=m.memoizedState),(Ee=fc||Q1(m,b,Ee,k,Ye,ut,me)||!1)?(Ge||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(k,ut,me),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(k,ut,me)),typeof G.componentDidUpdate=="function"&&(m.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof G.componentDidUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=1024),m.memoizedProps=k,m.memoizedState=ut),G.props=k,G.state=ut,G.context=me,k=Ee):(typeof G.componentDidUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=1024),k=!1)}return cv(u,m,b,k,z,R)}function cv(u,m,b,k,R,z){dT(u,m);var G=(m.flags&128)!==0;if(!k&&!G)return R&&g1(m,b,!1),ol(u,m,z);k=m.stateNode,H6.current=m;var fe=G&&typeof b.getDerivedStateFromError!="function"?null:k.render();return m.flags|=1,u!==null&&G?(m.child=Eu(m,u.child,null,z),m.child=Eu(m,null,fe,z)):ys(u,m,fe,z),m.memoizedState=k.state,R&&g1(m,b,!0),m.child}function fT(u){var m=u.stateNode;m.pendingContext?m1(u,m.pendingContext,m.pendingContext!==m.context):m.context&&m1(u,m.context,!1),Hy(u,m.containerInfo)}function hT(u,m,b,k,R){return Du(),qy(R),m.flags|=256,ys(u,m,b,k),m.child}var dv={dehydrated:null,treeContext:null,retryLane:0};function uv(u){return{baseLanes:u,cachePool:null,transitions:null}}function mT(u,m,b){var k=m.pendingProps,R=Gn.current,z=!1,G=(m.flags&128)!==0,fe;if((fe=G)||(fe=u!==null&&u.memoizedState===null?!1:(R&2)!==0),fe?(z=!0,m.flags&=-129):(u===null||u.memoizedState!==null)&&(R|=1),On(Gn,R&1),u===null)return Fy(m),u=m.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((m.mode&1)===0?m.lanes=1:u.data==="$!"?m.lanes=8:m.lanes=1073741824,null):(G=k.children,u=k.fallback,z?(k=m.mode,z=m.child,G={mode:"hidden",children:G},(k&1)===0&&z!==null?(z.childLanes=0,z.pendingProps=G):z=gp(G,k,0,null),u=Rd(u,k,b,null),z.return=m,u.return=m,z.sibling=u,m.child=z,m.child.memoizedState=uv(b),m.memoizedState=dv,u):fv(m,G));if(R=u.memoizedState,R!==null&&(fe=R.dehydrated,fe!==null))return Y6(u,m,G,k,fe,R,b);if(z){z=k.fallback,G=m.mode,R=u.child,fe=R.sibling;var me={mode:"hidden",children:k.children};return(G&1)===0&&m.child!==R?(k=m.child,k.childLanes=0,k.pendingProps=me,m.deletions=null):(k=vc(R,me),k.subtreeFlags=R.subtreeFlags&14680064),fe!==null?z=vc(fe,z):(z=Rd(z,G,b,null),z.flags|=2),z.return=m,k.return=m,k.sibling=z,m.child=k,k=z,z=m.child,G=u.child.memoizedState,G=G===null?uv(b):{baseLanes:G.baseLanes|b,cachePool:null,transitions:G.transitions},z.memoizedState=G,z.childLanes=u.childLanes&~b,m.memoizedState=dv,k}return z=u.child,u=z.sibling,k=vc(z,{mode:"visible",children:k.children}),(m.mode&1)===0&&(k.lanes=b),k.return=m,k.sibling=null,u!==null&&(b=m.deletions,b===null?(m.deletions=[u],m.flags|=16):b.push(u)),m.child=k,m.memoizedState=null,k}function fv(u,m){return m=gp({mode:"visible",children:m},u.mode,0,null),m.return=u,u.child=m}function rp(u,m,b,k){return k!==null&&qy(k),Eu(m,u.child,null,b),u=fv(m,m.pendingProps.children),u.flags|=2,m.memoizedState=null,u}function Y6(u,m,b,k,R,z,G){if(b)return m.flags&256?(m.flags&=-257,k=av(Error(t(422))),rp(u,m,G,k)):m.memoizedState!==null?(m.child=u.child,m.flags|=128,null):(z=k.fallback,R=m.mode,k=gp({mode:"visible",children:k.children},R,0,null),z=Rd(z,R,G,null),z.flags|=2,k.return=m,z.return=m,k.sibling=z,m.child=k,(m.mode&1)!==0&&Eu(m,u.child,null,G),m.child.memoizedState=uv(G),m.memoizedState=dv,z);if((m.mode&1)===0)return rp(u,m,G,null);if(R.data==="$!"){if(k=R.nextSibling&&R.nextSibling.dataset,k)var fe=k.dgst;return k=fe,z=Error(t(419)),k=av(z,k,void 0),rp(u,m,G,k)}if(fe=(G&u.childLanes)!==0,As||fe){if(k=Or,k!==null){switch(G&-G){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(k.suspendedLanes|G))!==0?0:R,R!==0&&R!==z.retryLane&&(z.retryLane=R,il(u,R),xa(k,u,R,-1))}return kv(),k=av(Error(t(421))),rp(u,m,G,k)}return R.data==="$?"?(m.flags|=128,m.child=u.child,m=aq.bind(null,u),R._reactRetry=m,null):(u=z.treeContext,ai=oo(R.nextSibling),ii=m,Bn=!0,ha=null,u!==null&&(Oi[Ii++]=rl,Oi[Ii++]=sl,Oi[Ii++]=Td,rl=u.id,sl=u.overflow,Td=m),m=fv(m,k.children),m.flags|=4096,m)}function pT(u,m,b){u.lanes|=m;var k=u.alternate;k!==null&&(k.lanes|=m),By(u.return,m,b)}function hv(u,m,b,k,R){var z=u.memoizedState;z===null?u.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:k,tail:b,tailMode:R}:(z.isBackwards=m,z.rendering=null,z.renderingStartTime=0,z.last=k,z.tail=b,z.tailMode=R)}function gT(u,m,b){var k=m.pendingProps,R=k.revealOrder,z=k.tail;if(ys(u,m,k.children,b),k=Gn.current,(k&2)!==0)k=k&1|2,m.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=m.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&pT(u,b,m);else if(u.tag===19)pT(u,b,m);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===m)break e;for(;u.sibling===null;){if(u.return===null||u.return===m)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}k&=1}if(On(Gn,k),(m.mode&1)===0)m.memoizedState=null;else switch(R){case"forwards":for(b=m.child,R=null;b!==null;)u=b.alternate,u!==null&&Km(u)===null&&(R=b),b=b.sibling;b=R,b===null?(R=m.child,m.child=null):(R=b.sibling,b.sibling=null),hv(m,!1,R,b,z);break;case"backwards":for(b=null,R=m.child,m.child=null;R!==null;){if(u=R.alternate,u!==null&&Km(u)===null){m.child=R;break}u=R.sibling,R.sibling=b,b=R,R=u}hv(m,!0,b,null,z);break;case"together":hv(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function sp(u,m){(m.mode&1)===0&&u!==null&&(u.alternate=null,m.alternate=null,m.flags|=2)}function ol(u,m,b){if(u!==null&&(m.dependencies=u.dependencies),Ed|=m.lanes,(b&m.childLanes)===0)return null;if(u!==null&&m.child!==u.child)throw Error(t(153));if(m.child!==null){for(u=m.child,b=vc(u,u.pendingProps),m.child=b,b.return=m;u.sibling!==null;)u=u.sibling,b=b.sibling=vc(u,u.pendingProps),b.return=m;b.sibling=null}return m.child}function G6(u,m,b){switch(m.tag){case 3:fT(m),Du();break;case 5:M1(m);break;case 1:Is(m.type)&&zm(m);break;case 4:Hy(m,m.stateNode.containerInfo);break;case 10:var k=m.type._context,R=m.memoizedProps.value;On(Hm,k._currentValue),k._currentValue=R;break;case 13:if(k=m.memoizedState,k!==null)return k.dehydrated!==null?(On(Gn,Gn.current&1),m.flags|=128,null):(b&m.child.childLanes)!==0?mT(u,m,b):(On(Gn,Gn.current&1),u=ol(u,m,b),u!==null?u.sibling:null);On(Gn,Gn.current&1);break;case 19:if(k=(b&m.childLanes)!==0,(u.flags&128)!==0){if(k)return gT(u,m,b);m.flags|=128}if(R=m.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),On(Gn,Gn.current),k)break;return null;case 22:case 23:return m.lanes=0,cT(u,m,b)}return ol(u,m,b)}var xT,mv,yT,vT;xT=function(u,m){for(var b=m.child;b!==null;){if(b.tag===5||b.tag===6)u.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===m)break;for(;b.sibling===null;){if(b.return===null||b.return===m)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},mv=function(){},yT=function(u,m,b,k){var R=u.memoizedProps;if(R!==k){u=m.stateNode,Md(lo.current);var z=null;switch(b){case"input":R=Fe(u,R),k=Fe(u,k),z=[];break;case"select":R=oe({},R,{value:void 0}),k=oe({},k,{value:void 0}),z=[];break;case"textarea":R=ye(u,R),k=ye(u,k),z=[];break;default:typeof R.onClick!="function"&&typeof k.onClick=="function"&&(u.onclick=We)}Rn(b,k);var G;b=null;for(Ee in R)if(!k.hasOwnProperty(Ee)&&R.hasOwnProperty(Ee)&&R[Ee]!=null)if(Ee==="style"){var fe=R[Ee];for(G in fe)fe.hasOwnProperty(G)&&(b||(b={}),b[G]="")}else Ee!=="dangerouslySetInnerHTML"&&Ee!=="children"&&Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&Ee!=="autoFocus"&&(s.hasOwnProperty(Ee)?z||(z=[]):(z=z||[]).push(Ee,null));for(Ee in k){var me=k[Ee];if(fe=R?.[Ee],k.hasOwnProperty(Ee)&&me!==fe&&(me!=null||fe!=null))if(Ee==="style")if(fe){for(G in fe)!fe.hasOwnProperty(G)||me&&me.hasOwnProperty(G)||(b||(b={}),b[G]="");for(G in me)me.hasOwnProperty(G)&&fe[G]!==me[G]&&(b||(b={}),b[G]=me[G])}else b||(z||(z=[]),z.push(Ee,b)),b=me;else Ee==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,fe=fe?fe.__html:void 0,me!=null&&fe!==me&&(z=z||[]).push(Ee,me)):Ee==="children"?typeof me!="string"&&typeof me!="number"||(z=z||[]).push(Ee,""+me):Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&(s.hasOwnProperty(Ee)?(me!=null&&Ee==="onScroll"&&Sn("scroll",u),z||fe===me||(z=[])):(z=z||[]).push(Ee,me))}b&&(z=z||[]).push("style",b);var Ee=z;(m.updateQueue=Ee)&&(m.flags|=4)}},vT=function(u,m,b,k){b!==k&&(m.flags|=4)};function ih(u,m){if(!Bn)switch(u.tailMode){case"hidden":m=u.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?u.tail=null:b.sibling=null;break;case"collapsed":b=u.tail;for(var k=null;b!==null;)b.alternate!==null&&(k=b),b=b.sibling;k===null?m||u.tail===null?u.tail=null:u.tail.sibling=null:k.sibling=null}}function es(u){var m=u.alternate!==null&&u.alternate.child===u.child,b=0,k=0;if(m)for(var R=u.child;R!==null;)b|=R.lanes|R.childLanes,k|=R.subtreeFlags&14680064,k|=R.flags&14680064,R.return=u,R=R.sibling;else for(R=u.child;R!==null;)b|=R.lanes|R.childLanes,k|=R.subtreeFlags,k|=R.flags,R.return=u,R=R.sibling;return u.subtreeFlags|=k,u.childLanes=b,m}function Z6(u,m,b){var k=m.pendingProps;switch(Ry(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return es(m),null;case 1:return Is(m.type)&&qm(),es(m),null;case 3:return k=m.stateNode,Au(),Ln(Os),Ln(Qr),Zy(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(u===null||u.child===null)&&(Wm(m)?m.flags|=4:u===null||u.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,ha!==null&&(Sv(ha),ha=null))),mv(u,m),es(m),null;case 5:Yy(m);var R=Md(eh.current);if(b=m.type,u!==null&&m.stateNode!=null)yT(u,m,b,k,R),u.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!k){if(m.stateNode===null)throw Error(t(166));return es(m),null}if(u=Md(lo.current),Wm(m)){k=m.stateNode,b=m.type;var z=m.memoizedProps;switch(k[Ei]=m,k[oc]=z,u=(m.mode&1)!==0,b){case"dialog":Sn("cancel",k),Sn("close",k);break;case"iframe":case"object":case"embed":Sn("load",k);break;case"video":case"audio":for(R=0;R<sc.length;R++)Sn(sc[R],k);break;case"source":Sn("error",k);break;case"img":case"image":case"link":Sn("error",k),Sn("load",k);break;case"details":Sn("toggle",k);break;case"input":_e(k,z),Sn("invalid",k);break;case"select":k._wrapperState={wasMultiple:!!z.multiple},Sn("invalid",k);break;case"textarea":Ve(k,z),Sn("invalid",k)}Rn(b,z),R=null;for(var G in z)if(z.hasOwnProperty(G)){var fe=z[G];G==="children"?typeof fe=="string"?k.textContent!==fe&&(z.suppressHydrationWarning!==!0&&De(k.textContent,fe,u),R=["children",fe]):typeof fe=="number"&&k.textContent!==""+fe&&(z.suppressHydrationWarning!==!0&&De(k.textContent,fe,u),R=["children",""+fe]):s.hasOwnProperty(G)&&fe!=null&&G==="onScroll"&&Sn("scroll",k)}switch(b){case"input":Oe(k),Be(k,z,!0);break;case"textarea":Oe(k),Le(k);break;case"select":case"option":break;default:typeof z.onClick=="function"&&(k.onclick=We)}k=R,m.updateQueue=k,k!==null&&(m.flags|=4)}else{G=R.nodeType===9?R:R.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=rt(b)),u==="http://www.w3.org/1999/xhtml"?b==="script"?(u=G.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof k.is=="string"?u=G.createElement(b,{is:k.is}):(u=G.createElement(b),b==="select"&&(G=u,k.multiple?G.multiple=!0:k.size&&(G.size=k.size))):u=G.createElementNS(u,b),u[Ei]=m,u[oc]=k,xT(u,m,!1,!1),m.stateNode=u;e:{switch(G=Nn(b,k),b){case"dialog":Sn("cancel",u),Sn("close",u),R=k;break;case"iframe":case"object":case"embed":Sn("load",u),R=k;break;case"video":case"audio":for(R=0;R<sc.length;R++)Sn(sc[R],u);R=k;break;case"source":Sn("error",u),R=k;break;case"img":case"image":case"link":Sn("error",u),Sn("load",u),R=k;break;case"details":Sn("toggle",u),R=k;break;case"input":_e(u,k),R=Fe(u,k),Sn("invalid",u);break;case"option":R=k;break;case"select":u._wrapperState={wasMultiple:!!k.multiple},R=oe({},k,{value:void 0}),Sn("invalid",u);break;case"textarea":Ve(u,k),R=ye(u,k),Sn("invalid",u);break;default:R=k}Rn(b,R),fe=R;for(z in fe)if(fe.hasOwnProperty(z)){var me=fe[z];z==="style"?Yt(u,me):z==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,me!=null&&qt(u,me)):z==="children"?typeof me=="string"?(b!=="textarea"||me!=="")&&bt(u,me):typeof me=="number"&&bt(u,""+me):z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&z!=="autoFocus"&&(s.hasOwnProperty(z)?me!=null&&z==="onScroll"&&Sn("scroll",u):me!=null&&E(u,z,me,G))}switch(b){case"input":Oe(u),Be(u,k,!1);break;case"textarea":Oe(u),Le(u);break;case"option":k.value!=null&&u.setAttribute("value",""+xe(k.value));break;case"select":u.multiple=!!k.multiple,z=k.value,z!=null?le(u,!!k.multiple,z,!1):k.defaultValue!=null&&le(u,!!k.multiple,k.defaultValue,!0);break;default:typeof R.onClick=="function"&&(u.onclick=We)}switch(b){case"button":case"input":case"select":case"textarea":k=!!k.autoFocus;break e;case"img":k=!0;break e;default:k=!1}}k&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return es(m),null;case 6:if(u&&m.stateNode!=null)vT(u,m,u.memoizedProps,k);else{if(typeof k!="string"&&m.stateNode===null)throw Error(t(166));if(b=Md(eh.current),Md(lo.current),Wm(m)){if(k=m.stateNode,b=m.memoizedProps,k[Ei]=m,(z=k.nodeValue!==b)&&(u=ii,u!==null))switch(u.tag){case 3:De(k.nodeValue,b,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&De(k.nodeValue,b,(u.mode&1)!==0)}z&&(m.flags|=4)}else k=(b.nodeType===9?b:b.ownerDocument).createTextNode(k),k[Ei]=m,m.stateNode=k}return es(m),null;case 13:if(Ln(Gn),k=m.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(Bn&&ai!==null&&(m.mode&1)!==0&&(m.flags&128)===0)w1(),Du(),m.flags|=98560,z=!1;else if(z=Wm(m),k!==null&&k.dehydrated!==null){if(u===null){if(!z)throw Error(t(318));if(z=m.memoizedState,z=z!==null?z.dehydrated:null,!z)throw Error(t(317));z[Ei]=m}else Du(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;es(m),z=!1}else ha!==null&&(Sv(ha),ha=null),z=!0;if(!z)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=b,m):(k=k!==null,k!==(u!==null&&u.memoizedState!==null)&&k&&(m.child.flags|=8192,(m.mode&1)!==0&&(u===null||(Gn.current&1)!==0?Sr===0&&(Sr=3):kv())),m.updateQueue!==null&&(m.flags|=4),es(m),null);case 4:return Au(),mv(u,m),u===null&&ic(m.stateNode.containerInfo),es(m),null;case 10:return Vy(m.type._context),es(m),null;case 17:return Is(m.type)&&qm(),es(m),null;case 19:if(Ln(Gn),z=m.memoizedState,z===null)return es(m),null;if(k=(m.flags&128)!==0,G=z.rendering,G===null)if(k)ih(z,!1);else{if(Sr!==0||u!==null&&(u.flags&128)!==0)for(u=m.child;u!==null;){if(G=Km(u),G!==null){for(m.flags|=128,ih(z,!1),k=G.updateQueue,k!==null&&(m.updateQueue=k,m.flags|=4),m.subtreeFlags=0,k=b,b=m.child;b!==null;)z=b,u=k,z.flags&=14680066,G=z.alternate,G===null?(z.childLanes=0,z.lanes=u,z.child=null,z.subtreeFlags=0,z.memoizedProps=null,z.memoizedState=null,z.updateQueue=null,z.dependencies=null,z.stateNode=null):(z.childLanes=G.childLanes,z.lanes=G.lanes,z.child=G.child,z.subtreeFlags=0,z.deletions=null,z.memoizedProps=G.memoizedProps,z.memoizedState=G.memoizedState,z.updateQueue=G.updateQueue,z.type=G.type,u=G.dependencies,z.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),b=b.sibling;return On(Gn,Gn.current&1|2),m.child}u=u.sibling}z.tail!==null&&Cn()>qu&&(m.flags|=128,k=!0,ih(z,!1),m.lanes=4194304)}else{if(!k)if(u=Km(G),u!==null){if(m.flags|=128,k=!0,b=u.updateQueue,b!==null&&(m.updateQueue=b,m.flags|=4),ih(z,!0),z.tail===null&&z.tailMode==="hidden"&&!G.alternate&&!Bn)return es(m),null}else 2*Cn()-z.renderingStartTime>qu&&b!==1073741824&&(m.flags|=128,k=!0,ih(z,!1),m.lanes=4194304);z.isBackwards?(G.sibling=m.child,m.child=G):(b=z.last,b!==null?b.sibling=G:m.child=G,z.last=G)}return z.tail!==null?(m=z.tail,z.rendering=m,z.tail=m.sibling,z.renderingStartTime=Cn(),m.sibling=null,b=Gn.current,On(Gn,k?b&1|2:b&1),m):(es(m),null);case 22:case 23:return Tv(),k=m.memoizedState!==null,u!==null&&u.memoizedState!==null!==k&&(m.flags|=8192),k&&(m.mode&1)!==0?(oi&1073741824)!==0&&(es(m),m.subtreeFlags&6&&(m.flags|=8192)):es(m),null;case 24:return null;case 25:return null}throw Error(t(156,m.tag))}function K6(u,m){switch(Ry(m),m.tag){case 1:return Is(m.type)&&qm(),u=m.flags,u&65536?(m.flags=u&-65537|128,m):null;case 3:return Au(),Ln(Os),Ln(Qr),Zy(),u=m.flags,(u&65536)!==0&&(u&128)===0?(m.flags=u&-65537|128,m):null;case 5:return Yy(m),null;case 13:if(Ln(Gn),u=m.memoizedState,u!==null&&u.dehydrated!==null){if(m.alternate===null)throw Error(t(340));Du()}return u=m.flags,u&65536?(m.flags=u&-65537|128,m):null;case 19:return Ln(Gn),null;case 4:return Au(),null;case 10:return Vy(m.type._context),null;case 22:case 23:return Tv(),null;case 24:return null;default:return null}}var ip=!1,ts=!1,J6=typeof WeakSet=="function"?WeakSet:Set,ct=null;function Lu(u,m){var b=u.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(k){tr(u,m,k)}else b.current=null}function pv(u,m,b){try{b()}catch(k){tr(u,m,k)}}var bT=!1;function Q6(u,m){if(st=la,u=Zo(),Ko(u)){if("selectionStart"in u)var b={start:u.selectionStart,end:u.selectionEnd};else e:{b=(b=u.ownerDocument)&&b.defaultView||window;var k=b.getSelection&&b.getSelection();if(k&&k.rangeCount!==0){b=k.anchorNode;var R=k.anchorOffset,z=k.focusNode;k=k.focusOffset;try{b.nodeType,z.nodeType}catch{b=null;break e}var G=0,fe=-1,me=-1,Ee=0,Ge=0,Ze=u,Ye=null;t:for(;;){for(var at;Ze!==b||R!==0&&Ze.nodeType!==3||(fe=G+R),Ze!==z||k!==0&&Ze.nodeType!==3||(me=G+k),Ze.nodeType===3&&(G+=Ze.nodeValue.length),(at=Ze.firstChild)!==null;)Ye=Ze,Ze=at;for(;;){if(Ze===u)break t;if(Ye===b&&++Ee===R&&(fe=G),Ye===z&&++Ge===k&&(me=G),(at=Ze.nextSibling)!==null)break;Ze=Ye,Ye=Ze.parentNode}Ze=at}b=fe===-1||me===-1?null:{start:fe,end:me}}else b=null}b=b||{start:0,end:0}}else b=null;for(Nt={focusedElem:u,selectionRange:b},la=!1,ct=m;ct!==null;)if(m=ct,u=m.child,(m.subtreeFlags&1028)!==0&&u!==null)u.return=m,ct=u;else for(;ct!==null;){m=ct;try{var ut=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(ut!==null){var mt=ut.memoizedProps,sr=ut.memoizedState,Te=m.stateNode,be=Te.getSnapshotBeforeUpdate(m.elementType===m.type?mt:ma(m.type,mt),sr);Te.__reactInternalSnapshotBeforeUpdate=be}break;case 3:var ke=m.stateNode.containerInfo;ke.nodeType===1?ke.textContent="":ke.nodeType===9&&ke.documentElement&&ke.removeChild(ke.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Je){tr(m,m.return,Je)}if(u=m.sibling,u!==null){u.return=m.return,ct=u;break}ct=m.return}return ut=bT,bT=!1,ut}function ah(u,m,b){var k=m.updateQueue;if(k=k!==null?k.lastEffect:null,k!==null){var R=k=k.next;do{if((R.tag&u)===u){var z=R.destroy;R.destroy=void 0,z!==void 0&&pv(m,b,z)}R=R.next}while(R!==k)}}function ap(u,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var b=m=m.next;do{if((b.tag&u)===u){var k=b.create;b.destroy=k()}b=b.next}while(b!==m)}}function gv(u){var m=u.ref;if(m!==null){var b=u.stateNode;switch(u.tag){case 5:u=b;break;default:u=b}typeof m=="function"?m(u):m.current=u}}function _T(u){var m=u.alternate;m!==null&&(u.alternate=null,_T(m)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(m=u.stateNode,m!==null&&(delete m[Ei],delete m[oc],delete m[lc],delete m[Dy],delete m[Ey])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function wT(u){return u.tag===5||u.tag===3||u.tag===4}function jT(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||wT(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function xv(u,m,b){var k=u.tag;if(k===5||k===6)u=u.stateNode,m?b.nodeType===8?b.parentNode.insertBefore(u,m):b.insertBefore(u,m):(b.nodeType===8?(m=b.parentNode,m.insertBefore(u,b)):(m=b,m.appendChild(u)),b=b._reactRootContainer,b!=null||m.onclick!==null||(m.onclick=We));else if(k!==4&&(u=u.child,u!==null))for(xv(u,m,b),u=u.sibling;u!==null;)xv(u,m,b),u=u.sibling}function yv(u,m,b){var k=u.tag;if(k===5||k===6)u=u.stateNode,m?b.insertBefore(u,m):b.appendChild(u);else if(k!==4&&(u=u.child,u!==null))for(yv(u,m,b),u=u.sibling;u!==null;)yv(u,m,b),u=u.sibling}var Vr=null,pa=!1;function mc(u,m,b){for(b=b.child;b!==null;)NT(u,m,b),b=b.sibling}function NT(u,m,b){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(na,b)}catch{}switch(b.tag){case 5:ts||Lu(b,m);case 6:var k=Vr,R=pa;Vr=null,mc(u,m,b),Vr=k,pa=R,Vr!==null&&(pa?(u=Vr,b=b.stateNode,u.nodeType===8?u.parentNode.removeChild(b):u.removeChild(b)):Vr.removeChild(b.stateNode));break;case 18:Vr!==null&&(pa?(u=Vr,b=b.stateNode,u.nodeType===8?Kf(u.parentNode,b):u.nodeType===1&&Kf(u,b),Fr(u)):Kf(Vr,b.stateNode));break;case 4:k=Vr,R=pa,Vr=b.stateNode.containerInfo,pa=!0,mc(u,m,b),Vr=k,pa=R;break;case 0:case 11:case 14:case 15:if(!ts&&(k=b.updateQueue,k!==null&&(k=k.lastEffect,k!==null))){R=k=k.next;do{var z=R,G=z.destroy;z=z.tag,G!==void 0&&((z&2)!==0||(z&4)!==0)&&pv(b,m,G),R=R.next}while(R!==k)}mc(u,m,b);break;case 1:if(!ts&&(Lu(b,m),k=b.stateNode,typeof k.componentWillUnmount=="function"))try{k.props=b.memoizedProps,k.state=b.memoizedState,k.componentWillUnmount()}catch(fe){tr(b,m,fe)}mc(u,m,b);break;case 21:mc(u,m,b);break;case 22:b.mode&1?(ts=(k=ts)||b.memoizedState!==null,mc(u,m,b),ts=k):mc(u,m,b);break;default:mc(u,m,b)}}function ST(u){var m=u.updateQueue;if(m!==null){u.updateQueue=null;var b=u.stateNode;b===null&&(b=u.stateNode=new J6),m.forEach(function(k){var R=oq.bind(null,u,k);b.has(k)||(b.add(k),k.then(R,R))})}}function ga(u,m){var b=m.deletions;if(b!==null)for(var k=0;k<b.length;k++){var R=b[k];try{var z=u,G=m,fe=G;e:for(;fe!==null;){switch(fe.tag){case 5:Vr=fe.stateNode,pa=!1;break e;case 3:Vr=fe.stateNode.containerInfo,pa=!0;break e;case 4:Vr=fe.stateNode.containerInfo,pa=!0;break e}fe=fe.return}if(Vr===null)throw Error(t(160));NT(z,G,R),Vr=null,pa=!1;var me=R.alternate;me!==null&&(me.return=null),R.return=null}catch(Ee){tr(R,m,Ee)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)CT(m,u),m=m.sibling}function CT(u,m){var b=u.alternate,k=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(ga(m,u),uo(u),k&4){try{ah(3,u,u.return),ap(3,u)}catch(mt){tr(u,u.return,mt)}try{ah(5,u,u.return)}catch(mt){tr(u,u.return,mt)}}break;case 1:ga(m,u),uo(u),k&512&&b!==null&&Lu(b,b.return);break;case 5:if(ga(m,u),uo(u),k&512&&b!==null&&Lu(b,b.return),u.flags&32){var R=u.stateNode;try{bt(R,"")}catch(mt){tr(u,u.return,mt)}}if(k&4&&(R=u.stateNode,R!=null)){var z=u.memoizedProps,G=b!==null?b.memoizedProps:z,fe=u.type,me=u.updateQueue;if(u.updateQueue=null,me!==null)try{fe==="input"&&z.type==="radio"&&z.name!=null&&Ne(R,z),Nn(fe,G);var Ee=Nn(fe,z);for(G=0;G<me.length;G+=2){var Ge=me[G],Ze=me[G+1];Ge==="style"?Yt(R,Ze):Ge==="dangerouslySetInnerHTML"?qt(R,Ze):Ge==="children"?bt(R,Ze):E(R,Ge,Ze,Ee)}switch(fe){case"input":Ue(R,z);break;case"textarea":ze(R,z);break;case"select":var Ye=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!z.multiple;var at=z.value;at!=null?le(R,!!z.multiple,at,!1):Ye!==!!z.multiple&&(z.defaultValue!=null?le(R,!!z.multiple,z.defaultValue,!0):le(R,!!z.multiple,z.multiple?[]:"",!1))}R[oc]=z}catch(mt){tr(u,u.return,mt)}}break;case 6:if(ga(m,u),uo(u),k&4){if(u.stateNode===null)throw Error(t(162));R=u.stateNode,z=u.memoizedProps;try{R.nodeValue=z}catch(mt){tr(u,u.return,mt)}}break;case 3:if(ga(m,u),uo(u),k&4&&b!==null&&b.memoizedState.isDehydrated)try{Fr(m.containerInfo)}catch(mt){tr(u,u.return,mt)}break;case 4:ga(m,u),uo(u);break;case 13:ga(m,u),uo(u),R=u.child,R.flags&8192&&(z=R.memoizedState!==null,R.stateNode.isHidden=z,!z||R.alternate!==null&&R.alternate.memoizedState!==null||(_v=Cn())),k&4&&ST(u);break;case 22:if(Ge=b!==null&&b.memoizedState!==null,u.mode&1?(ts=(Ee=ts)||Ge,ga(m,u),ts=Ee):ga(m,u),uo(u),k&8192){if(Ee=u.memoizedState!==null,(u.stateNode.isHidden=Ee)&&!Ge&&(u.mode&1)!==0)for(ct=u,Ge=u.child;Ge!==null;){for(Ze=ct=Ge;ct!==null;){switch(Ye=ct,at=Ye.child,Ye.tag){case 0:case 11:case 14:case 15:ah(4,Ye,Ye.return);break;case 1:Lu(Ye,Ye.return);var ut=Ye.stateNode;if(typeof ut.componentWillUnmount=="function"){k=Ye,b=Ye.return;try{m=k,ut.props=m.memoizedProps,ut.state=m.memoizedState,ut.componentWillUnmount()}catch(mt){tr(k,b,mt)}}break;case 5:Lu(Ye,Ye.return);break;case 22:if(Ye.memoizedState!==null){PT(Ze);continue}}at!==null?(at.return=Ye,ct=at):PT(Ze)}Ge=Ge.sibling}e:for(Ge=null,Ze=u;;){if(Ze.tag===5){if(Ge===null){Ge=Ze;try{R=Ze.stateNode,Ee?(z=R.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none"):(fe=Ze.stateNode,me=Ze.memoizedProps.style,G=me!=null&&me.hasOwnProperty("display")?me.display:null,fe.style.display=en("display",G))}catch(mt){tr(u,u.return,mt)}}}else if(Ze.tag===6){if(Ge===null)try{Ze.stateNode.nodeValue=Ee?"":Ze.memoizedProps}catch(mt){tr(u,u.return,mt)}}else if((Ze.tag!==22&&Ze.tag!==23||Ze.memoizedState===null||Ze===u)&&Ze.child!==null){Ze.child.return=Ze,Ze=Ze.child;continue}if(Ze===u)break e;for(;Ze.sibling===null;){if(Ze.return===null||Ze.return===u)break e;Ge===Ze&&(Ge=null),Ze=Ze.return}Ge===Ze&&(Ge=null),Ze.sibling.return=Ze.return,Ze=Ze.sibling}}break;case 19:ga(m,u),uo(u),k&4&&ST(u);break;case 21:break;default:ga(m,u),uo(u)}}function uo(u){var m=u.flags;if(m&2){try{e:{for(var b=u.return;b!==null;){if(wT(b)){var k=b;break e}b=b.return}throw Error(t(160))}switch(k.tag){case 5:var R=k.stateNode;k.flags&32&&(bt(R,""),k.flags&=-33);var z=jT(u);yv(u,z,R);break;case 3:case 4:var G=k.stateNode.containerInfo,fe=jT(u);xv(u,fe,G);break;default:throw Error(t(161))}}catch(me){tr(u,u.return,me)}u.flags&=-3}m&4096&&(u.flags&=-4097)}function X6(u,m,b){ct=u,TT(u)}function TT(u,m,b){for(var k=(u.mode&1)!==0;ct!==null;){var R=ct,z=R.child;if(R.tag===22&&k){var G=R.memoizedState!==null||ip;if(!G){var fe=R.alternate,me=fe!==null&&fe.memoizedState!==null||ts;fe=ip;var Ee=ts;if(ip=G,(ts=me)&&!Ee)for(ct=R;ct!==null;)G=ct,me=G.child,G.tag===22&&G.memoizedState!==null?MT(R):me!==null?(me.return=G,ct=me):MT(R);for(;z!==null;)ct=z,TT(z),z=z.sibling;ct=R,ip=fe,ts=Ee}kT(u)}else(R.subtreeFlags&8772)!==0&&z!==null?(z.return=R,ct=z):kT(u)}}function kT(u){for(;ct!==null;){var m=ct;if((m.flags&8772)!==0){var b=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:ts||ap(5,m);break;case 1:var k=m.stateNode;if(m.flags&4&&!ts)if(b===null)k.componentDidMount();else{var R=m.elementType===m.type?b.memoizedProps:ma(m.type,b.memoizedProps);k.componentDidUpdate(R,b.memoizedState,k.__reactInternalSnapshotBeforeUpdate)}var z=m.updateQueue;z!==null&&P1(m,z,k);break;case 3:var G=m.updateQueue;if(G!==null){if(b=null,m.child!==null)switch(m.child.tag){case 5:b=m.child.stateNode;break;case 1:b=m.child.stateNode}P1(m,G,b)}break;case 5:var fe=m.stateNode;if(b===null&&m.flags&4){b=fe;var me=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":me.autoFocus&&b.focus();break;case"img":me.src&&(b.src=me.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var Ee=m.alternate;if(Ee!==null){var Ge=Ee.memoizedState;if(Ge!==null){var Ze=Ge.dehydrated;Ze!==null&&Fr(Ze)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ts||m.flags&512&&gv(m)}catch(Ye){tr(m,m.return,Ye)}}if(m===u){ct=null;break}if(b=m.sibling,b!==null){b.return=m.return,ct=b;break}ct=m.return}}function PT(u){for(;ct!==null;){var m=ct;if(m===u){ct=null;break}var b=m.sibling;if(b!==null){b.return=m.return,ct=b;break}ct=m.return}}function MT(u){for(;ct!==null;){var m=ct;try{switch(m.tag){case 0:case 11:case 15:var b=m.return;try{ap(4,m)}catch(me){tr(m,b,me)}break;case 1:var k=m.stateNode;if(typeof k.componentDidMount=="function"){var R=m.return;try{k.componentDidMount()}catch(me){tr(m,R,me)}}var z=m.return;try{gv(m)}catch(me){tr(m,z,me)}break;case 5:var G=m.return;try{gv(m)}catch(me){tr(m,G,me)}}}catch(me){tr(m,m.return,me)}if(m===u){ct=null;break}var fe=m.sibling;if(fe!==null){fe.return=m.return,ct=fe;break}ct=m.return}}var eq=Math.ceil,op=M.ReactCurrentDispatcher,vv=M.ReactCurrentOwner,Li=M.ReactCurrentBatchConfig,on=0,Or=null,mr=null,Br=0,oi=0,Fu=cc(0),Sr=0,oh=null,Ed=0,lp=0,bv=0,lh=null,Rs=null,_v=0,qu=1/0,ll=null,cp=!1,wv=null,pc=null,dp=!1,gc=null,up=0,ch=0,jv=null,fp=-1,hp=0;function vs(){return(on&6)!==0?Cn():fp!==-1?fp:fp=Cn()}function xc(u){return(u.mode&1)===0?1:(on&2)!==0&&Br!==0?Br&-Br:L6.transition!==null?(hp===0&&(hp=Fl()),hp):(u=Kt,u!==0||(u=window.event,u=u===void 0?16:Ht(u.type)),u)}function xa(u,m,b,k){if(50<ch)throw ch=0,jv=null,Error(t(185));Rr(u,b,k),((on&2)===0||u!==Or)&&(u===Or&&((on&2)===0&&(lp|=b),Sr===4&&yc(u,Br)),Ls(u,k),b===1&&on===0&&(m.mode&1)===0&&(qu=Cn()+500,Um&&uc()))}function Ls(u,m){var b=u.callbackNode;Ua(u,m);var k=gn(u,u===Or?Br:0);if(k===0)b!==null&&Do(b),u.callbackNode=null,u.callbackPriority=0;else if(m=k&-k,u.callbackPriority!==m){if(b!=null&&Do(b),m===1)u.tag===0?R6(ET.bind(null,u)):x1(ET.bind(null,u)),Jr(function(){(on&6)===0&&uc()}),b=null;else{switch(ji(k)){case 1:b=Eo;break;case 4:b=Ll;break;case 16:b=qa;break;case 536870912:b=vi;break;default:b=qa}b=zT(b,DT.bind(null,u))}u.callbackPriority=m,u.callbackNode=b}}function DT(u,m){if(fp=-1,hp=0,(on&6)!==0)throw Error(t(327));var b=u.callbackNode;if(zu()&&u.callbackNode!==b)return null;var k=gn(u,u===Or?Br:0);if(k===0)return null;if((k&30)!==0||(k&u.expiredLanes)!==0||m)m=mp(u,k);else{m=k;var R=on;on|=2;var z=IT();(Or!==u||Br!==m)&&(ll=null,qu=Cn()+500,Id(u,m));do try{rq();break}catch(fe){OT(u,fe)}while(!0);Uy(),op.current=z,on=R,mr!==null?m=0:(Or=null,Br=0,m=Sr)}if(m!==0){if(m===2&&(R=ur(u),R!==0&&(k=R,m=Nv(u,R))),m===1)throw b=oh,Id(u,0),yc(u,k),Ls(u,Cn()),b;if(m===6)yc(u,k);else{if(R=u.current.alternate,(k&30)===0&&!tq(R)&&(m=mp(u,k),m===2&&(z=ur(u),z!==0&&(k=z,m=Nv(u,z))),m===1))throw b=oh,Id(u,0),yc(u,k),Ls(u,Cn()),b;switch(u.finishedWork=R,u.finishedLanes=k,m){case 0:case 1:throw Error(t(345));case 2:Ad(u,Rs,ll);break;case 3:if(yc(u,k),(k&130023424)===k&&(m=_v+500-Cn(),10<m)){if(gn(u,0)!==0)break;if(R=u.suspendedLanes,(R&k)!==k){vs(),u.pingedLanes|=u.suspendedLanes&R;break}u.timeoutHandle=jr(Ad.bind(null,u,Rs,ll),m);break}Ad(u,Rs,ll);break;case 4:if(yc(u,k),(k&4194240)===k)break;for(m=u.eventTimes,R=-1;0<k;){var G=31-Et(k);z=1<<G,G=m[G],G>R&&(R=G),k&=~z}if(k=R,k=Cn()-k,k=(120>k?120:480>k?480:1080>k?1080:1920>k?1920:3e3>k?3e3:4320>k?4320:1960*eq(k/1960))-k,10<k){u.timeoutHandle=jr(Ad.bind(null,u,Rs,ll),k);break}Ad(u,Rs,ll);break;case 5:Ad(u,Rs,ll);break;default:throw Error(t(329))}}}return Ls(u,Cn()),u.callbackNode===b?DT.bind(null,u):null}function Nv(u,m){var b=lh;return u.current.memoizedState.isDehydrated&&(Id(u,m).flags|=256),u=mp(u,m),u!==2&&(m=Rs,Rs=b,m!==null&&Sv(m)),u}function Sv(u){Rs===null?Rs=u:Rs.push.apply(Rs,u)}function tq(u){for(var m=u;;){if(m.flags&16384){var b=m.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var k=0;k<b.length;k++){var R=b[k],z=R.getSnapshot;R=R.value;try{if(!Ur(z(),R))return!1}catch{return!1}}}if(b=m.child,m.subtreeFlags&16384&&b!==null)b.return=m,m=b;else{if(m===u)break;for(;m.sibling===null;){if(m.return===null||m.return===u)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function yc(u,m){for(m&=~bv,m&=~lp,u.suspendedLanes|=m,u.pingedLanes&=~m,u=u.expirationTimes;0<m;){var b=31-Et(m),k=1<<b;u[b]=-1,m&=~k}}function ET(u){if((on&6)!==0)throw Error(t(327));zu();var m=gn(u,0);if((m&1)===0)return Ls(u,Cn()),null;var b=mp(u,m);if(u.tag!==0&&b===2){var k=ur(u);k!==0&&(m=k,b=Nv(u,k))}if(b===1)throw b=oh,Id(u,0),yc(u,m),Ls(u,Cn()),b;if(b===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=m,Ad(u,Rs,ll),Ls(u,Cn()),null}function Cv(u,m){var b=on;on|=1;try{return u(m)}finally{on=b,on===0&&(qu=Cn()+500,Um&&uc())}}function Od(u){gc!==null&&gc.tag===0&&(on&6)===0&&zu();var m=on;on|=1;var b=Li.transition,k=Kt;try{if(Li.transition=null,Kt=1,u)return u()}finally{Kt=k,Li.transition=b,on=m,(on&6)===0&&uc()}}function Tv(){oi=Fu.current,Ln(Fu)}function Id(u,m){u.finishedWork=null,u.finishedLanes=0;var b=u.timeoutHandle;if(b!==-1&&(u.timeoutHandle=-1,hr(b)),mr!==null)for(b=mr.return;b!==null;){var k=b;switch(Ry(k),k.tag){case 1:k=k.type.childContextTypes,k!=null&&qm();break;case 3:Au(),Ln(Os),Ln(Qr),Zy();break;case 5:Yy(k);break;case 4:Au();break;case 13:Ln(Gn);break;case 19:Ln(Gn);break;case 10:Vy(k.type._context);break;case 22:case 23:Tv()}b=b.return}if(Or=u,mr=u=vc(u.current,null),Br=oi=m,Sr=0,oh=null,bv=lp=Ed=0,Rs=lh=null,Pd!==null){for(m=0;m<Pd.length;m++)if(b=Pd[m],k=b.interleaved,k!==null){b.interleaved=null;var R=k.next,z=b.pending;if(z!==null){var G=z.next;z.next=R,k.next=G}b.pending=k}Pd=null}return u}function OT(u,m){do{var b=mr;try{if(Uy(),Jm.current=tp,Qm){for(var k=Zn.memoizedState;k!==null;){var R=k.queue;R!==null&&(R.pending=null),k=k.next}Qm=!1}if(Dd=0,Er=Nr=Zn=null,th=!1,nh=0,vv.current=null,b===null||b.return===null){Sr=1,oh=m,mr=null;break}e:{var z=u,G=b.return,fe=b,me=m;if(m=Br,fe.flags|=32768,me!==null&&typeof me=="object"&&typeof me.then=="function"){var Ee=me,Ge=fe,Ze=Ge.tag;if((Ge.mode&1)===0&&(Ze===0||Ze===11||Ze===15)){var Ye=Ge.alternate;Ye?(Ge.updateQueue=Ye.updateQueue,Ge.memoizedState=Ye.memoizedState,Ge.lanes=Ye.lanes):(Ge.updateQueue=null,Ge.memoizedState=null)}var at=sT(G);if(at!==null){at.flags&=-257,iT(at,G,fe,z,m),at.mode&1&&rT(z,Ee,m),m=at,me=Ee;var ut=m.updateQueue;if(ut===null){var mt=new Set;mt.add(me),m.updateQueue=mt}else ut.add(me);break e}else{if((m&1)===0){rT(z,Ee,m),kv();break e}me=Error(t(426))}}else if(Bn&&fe.mode&1){var sr=sT(G);if(sr!==null){(sr.flags&65536)===0&&(sr.flags|=256),iT(sr,G,fe,z,m),qy(Ru(me,fe));break e}}z=me=Ru(me,fe),Sr!==4&&(Sr=2),lh===null?lh=[z]:lh.push(z),z=G;do{switch(z.tag){case 3:z.flags|=65536,m&=-m,z.lanes|=m;var Te=tT(z,me,m);k1(z,Te);break e;case 1:fe=me;var be=z.type,ke=z.stateNode;if((z.flags&128)===0&&(typeof be.getDerivedStateFromError=="function"||ke!==null&&typeof ke.componentDidCatch=="function"&&(pc===null||!pc.has(ke)))){z.flags|=65536,m&=-m,z.lanes|=m;var Je=nT(z,fe,m);k1(z,Je);break e}}z=z.return}while(z!==null)}RT(b)}catch(pt){m=pt,mr===b&&b!==null&&(mr=b=b.return);continue}break}while(!0)}function IT(){var u=op.current;return op.current=tp,u===null?tp:u}function kv(){(Sr===0||Sr===3||Sr===2)&&(Sr=4),Or===null||(Ed&268435455)===0&&(lp&268435455)===0||yc(Or,Br)}function mp(u,m){var b=on;on|=2;var k=IT();(Or!==u||Br!==m)&&(ll=null,Id(u,m));do try{nq();break}catch(R){OT(u,R)}while(!0);if(Uy(),on=b,op.current=k,mr!==null)throw Error(t(261));return Or=null,Br=0,Sr}function nq(){for(;mr!==null;)AT(mr)}function rq(){for(;mr!==null&&!ld();)AT(mr)}function AT(u){var m=qT(u.alternate,u,oi);u.memoizedProps=u.pendingProps,m===null?RT(u):mr=m,vv.current=null}function RT(u){var m=u;do{var b=m.alternate;if(u=m.return,(m.flags&32768)===0){if(b=Z6(b,m,oi),b!==null){mr=b;return}}else{if(b=K6(b,m),b!==null){b.flags&=32767,mr=b;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{Sr=6,mr=null;return}}if(m=m.sibling,m!==null){mr=m;return}mr=m=u}while(m!==null);Sr===0&&(Sr=5)}function Ad(u,m,b){var k=Kt,R=Li.transition;try{Li.transition=null,Kt=1,sq(u,m,b,k)}finally{Li.transition=R,Kt=k}return null}function sq(u,m,b,k){do zu();while(gc!==null);if((on&6)!==0)throw Error(t(327));b=u.finishedWork;var R=u.finishedLanes;if(b===null)return null;if(u.finishedWork=null,u.finishedLanes=0,b===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var z=b.lanes|b.childLanes;if(En(u,z),u===Or&&(mr=Or=null,Br=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||dp||(dp=!0,zT(qa,function(){return zu(),null})),z=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||z){z=Li.transition,Li.transition=null;var G=Kt;Kt=1;var fe=on;on|=4,vv.current=null,Q6(u,b),CT(b,u),g(Nt),la=!!st,Nt=st=null,u.current=b,X6(b),Fa(),on=fe,Kt=G,Li.transition=z}else u.current=b;if(dp&&(dp=!1,gc=u,up=R),z=u.pendingLanes,z===0&&(pc=null),ra(b.stateNode),Ls(u,Cn()),m!==null)for(k=u.onRecoverableError,b=0;b<m.length;b++)R=m[b],k(R.value,{componentStack:R.stack,digest:R.digest});if(cp)throw cp=!1,u=wv,wv=null,u;return(up&1)!==0&&u.tag!==0&&zu(),z=u.pendingLanes,(z&1)!==0?u===jv?ch++:(ch=0,jv=u):ch=0,uc(),null}function zu(){if(gc!==null){var u=ji(up),m=Li.transition,b=Kt;try{if(Li.transition=null,Kt=16>u?16:u,gc===null)var k=!1;else{if(u=gc,gc=null,up=0,(on&6)!==0)throw Error(t(331));var R=on;for(on|=4,ct=u.current;ct!==null;){var z=ct,G=z.child;if((ct.flags&16)!==0){var fe=z.deletions;if(fe!==null){for(var me=0;me<fe.length;me++){var Ee=fe[me];for(ct=Ee;ct!==null;){var Ge=ct;switch(Ge.tag){case 0:case 11:case 15:ah(8,Ge,z)}var Ze=Ge.child;if(Ze!==null)Ze.return=Ge,ct=Ze;else for(;ct!==null;){Ge=ct;var Ye=Ge.sibling,at=Ge.return;if(_T(Ge),Ge===Ee){ct=null;break}if(Ye!==null){Ye.return=at,ct=Ye;break}ct=at}}}var ut=z.alternate;if(ut!==null){var mt=ut.child;if(mt!==null){ut.child=null;do{var sr=mt.sibling;mt.sibling=null,mt=sr}while(mt!==null)}}ct=z}}if((z.subtreeFlags&2064)!==0&&G!==null)G.return=z,ct=G;else e:for(;ct!==null;){if(z=ct,(z.flags&2048)!==0)switch(z.tag){case 0:case 11:case 15:ah(9,z,z.return)}var Te=z.sibling;if(Te!==null){Te.return=z.return,ct=Te;break e}ct=z.return}}var be=u.current;for(ct=be;ct!==null;){G=ct;var ke=G.child;if((G.subtreeFlags&2064)!==0&&ke!==null)ke.return=G,ct=ke;else e:for(G=be;ct!==null;){if(fe=ct,(fe.flags&2048)!==0)try{switch(fe.tag){case 0:case 11:case 15:ap(9,fe)}}catch(pt){tr(fe,fe.return,pt)}if(fe===G){ct=null;break e}var Je=fe.sibling;if(Je!==null){Je.return=fe.return,ct=Je;break e}ct=fe.return}}if(on=R,uc(),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(na,u)}catch{}k=!0}return k}finally{Kt=b,Li.transition=m}}return!1}function LT(u,m,b){m=Ru(b,m),m=tT(u,m,1),u=hc(u,m,1),m=vs(),u!==null&&(Rr(u,1,m),Ls(u,m))}function tr(u,m,b){if(u.tag===3)LT(u,u,b);else for(;m!==null;){if(m.tag===3){LT(m,u,b);break}else if(m.tag===1){var k=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(pc===null||!pc.has(k))){u=Ru(b,u),u=nT(m,u,1),m=hc(m,u,1),u=vs(),m!==null&&(Rr(m,1,u),Ls(m,u));break}}m=m.return}}function iq(u,m,b){var k=u.pingCache;k!==null&&k.delete(m),m=vs(),u.pingedLanes|=u.suspendedLanes&b,Or===u&&(Br&b)===b&&(Sr===4||Sr===3&&(Br&130023424)===Br&&500>Cn()-_v?Id(u,0):bv|=b),Ls(u,m)}function FT(u,m){m===0&&((u.mode&1)===0?m=1:(m=_i,_i<<=1,(_i&130023424)===0&&(_i=4194304)));var b=vs();u=il(u,m),u!==null&&(Rr(u,m,b),Ls(u,b))}function aq(u){var m=u.memoizedState,b=0;m!==null&&(b=m.retryLane),FT(u,b)}function oq(u,m){var b=0;switch(u.tag){case 13:var k=u.stateNode,R=u.memoizedState;R!==null&&(b=R.retryLane);break;case 19:k=u.stateNode;break;default:throw Error(t(314))}k!==null&&k.delete(m),FT(u,b)}var qT;qT=function(u,m,b){if(u!==null)if(u.memoizedProps!==m.pendingProps||Os.current)As=!0;else{if((u.lanes&b)===0&&(m.flags&128)===0)return As=!1,G6(u,m,b);As=(u.flags&131072)!==0}else As=!1,Bn&&(m.flags&1048576)!==0&&y1(m,Bm,m.index);switch(m.lanes=0,m.tag){case 2:var k=m.type;sp(u,m),u=m.pendingProps;var R=ku(m,Qr.current);Iu(m,b),R=Qy(null,m,k,u,R,b);var z=Xy();return m.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,Is(k)?(z=!0,zm(m)):z=!1,m.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,$y(m),R.updater=np,m.stateNode=R,R._reactInternals=m,iv(m,k,u,b),m=cv(null,m,k,!0,z,b)):(m.tag=0,Bn&&z&&Ay(m),ys(null,m,R,b),m=m.child),m;case 16:k=m.elementType;e:{switch(sp(u,m),u=m.pendingProps,R=k._init,k=R(k._payload),m.type=k,R=m.tag=cq(k),u=ma(k,u),R){case 0:m=lv(null,m,k,u,b);break e;case 1:m=uT(null,m,k,u,b);break e;case 11:m=aT(null,m,k,u,b);break e;case 14:m=oT(null,m,k,ma(k.type,u),b);break e}throw Error(t(306,k,""))}return m;case 0:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ma(k,R),lv(u,m,k,R,b);case 1:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ma(k,R),uT(u,m,k,R,b);case 3:e:{if(fT(m),u===null)throw Error(t(387));k=m.pendingProps,z=m.memoizedState,R=z.element,T1(u,m),Zm(m,k,null,b);var G=m.memoizedState;if(k=G.element,z.isDehydrated)if(z={element:k,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},m.updateQueue.baseState=z,m.memoizedState=z,m.flags&256){R=Ru(Error(t(423)),m),m=hT(u,m,k,b,R);break e}else if(k!==R){R=Ru(Error(t(424)),m),m=hT(u,m,k,b,R);break e}else for(ai=oo(m.stateNode.containerInfo.firstChild),ii=m,Bn=!0,ha=null,b=S1(m,null,k,b),m.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Du(),k===R){m=ol(u,m,b);break e}ys(u,m,k,b)}m=m.child}return m;case 5:return M1(m),u===null&&Fy(m),k=m.type,R=m.pendingProps,z=u!==null?u.memoizedProps:null,G=R.children,$t(k,R)?G=null:z!==null&&$t(k,z)&&(m.flags|=32),dT(u,m),ys(u,m,G,b),m.child;case 6:return u===null&&Fy(m),null;case 13:return mT(u,m,b);case 4:return Hy(m,m.stateNode.containerInfo),k=m.pendingProps,u===null?m.child=Eu(m,null,k,b):ys(u,m,k,b),m.child;case 11:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ma(k,R),aT(u,m,k,R,b);case 7:return ys(u,m,m.pendingProps,b),m.child;case 8:return ys(u,m,m.pendingProps.children,b),m.child;case 12:return ys(u,m,m.pendingProps.children,b),m.child;case 10:e:{if(k=m.type._context,R=m.pendingProps,z=m.memoizedProps,G=R.value,On(Hm,k._currentValue),k._currentValue=G,z!==null)if(Ur(z.value,G)){if(z.children===R.children&&!Os.current){m=ol(u,m,b);break e}}else for(z=m.child,z!==null&&(z.return=m);z!==null;){var fe=z.dependencies;if(fe!==null){G=z.child;for(var me=fe.firstContext;me!==null;){if(me.context===k){if(z.tag===1){me=al(-1,b&-b),me.tag=2;var Ee=z.updateQueue;if(Ee!==null){Ee=Ee.shared;var Ge=Ee.pending;Ge===null?me.next=me:(me.next=Ge.next,Ge.next=me),Ee.pending=me}}z.lanes|=b,me=z.alternate,me!==null&&(me.lanes|=b),By(z.return,b,m),fe.lanes|=b;break}me=me.next}}else if(z.tag===10)G=z.type===m.type?null:z.child;else if(z.tag===18){if(G=z.return,G===null)throw Error(t(341));G.lanes|=b,fe=G.alternate,fe!==null&&(fe.lanes|=b),By(G,b,m),G=z.sibling}else G=z.child;if(G!==null)G.return=z;else for(G=z;G!==null;){if(G===m){G=null;break}if(z=G.sibling,z!==null){z.return=G.return,G=z;break}G=G.return}z=G}ys(u,m,R.children,b),m=m.child}return m;case 9:return R=m.type,k=m.pendingProps.children,Iu(m,b),R=Ai(R),k=k(R),m.flags|=1,ys(u,m,k,b),m.child;case 14:return k=m.type,R=ma(k,m.pendingProps),R=ma(k.type,R),oT(u,m,k,R,b);case 15:return lT(u,m,m.type,m.pendingProps,b);case 17:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ma(k,R),sp(u,m),m.tag=1,Is(k)?(u=!0,zm(m)):u=!1,Iu(m,b),X1(m,k,R),iv(m,k,R,b),cv(null,m,k,!0,u,b);case 19:return gT(u,m,b);case 22:return cT(u,m,b)}throw Error(t(156,m.tag))};function zT(u,m){return Rl(u,m)}function lq(u,m,b,k){this.tag=u,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fi(u,m,b,k){return new lq(u,m,b,k)}function Pv(u){return u=u.prototype,!(!u||!u.isReactComponent)}function cq(u){if(typeof u=="function")return Pv(u)?1:0;if(u!=null){if(u=u.$$typeof,u===$)return 11;if(u===ae)return 14}return 2}function vc(u,m){var b=u.alternate;return b===null?(b=Fi(u.tag,m,u.key,u.mode),b.elementType=u.elementType,b.type=u.type,b.stateNode=u.stateNode,b.alternate=u,u.alternate=b):(b.pendingProps=m,b.type=u.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=u.flags&14680064,b.childLanes=u.childLanes,b.lanes=u.lanes,b.child=u.child,b.memoizedProps=u.memoizedProps,b.memoizedState=u.memoizedState,b.updateQueue=u.updateQueue,m=u.dependencies,b.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},b.sibling=u.sibling,b.index=u.index,b.ref=u.ref,b}function pp(u,m,b,k,R,z){var G=2;if(k=u,typeof u=="function")Pv(u)&&(G=1);else if(typeof u=="string")G=5;else e:switch(u){case q:return Rd(b.children,R,z,m);case F:G=8,R|=8;break;case B:return u=Fi(12,b,m,R|2),u.elementType=B,u.lanes=z,u;case se:return u=Fi(13,b,m,R),u.elementType=se,u.lanes=z,u;case Y:return u=Fi(19,b,m,R),u.elementType=Y,u.lanes=z,u;case ee:return gp(b,R,z,m);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case U:G=10;break e;case W:G=9;break e;case $:G=11;break e;case ae:G=14;break e;case J:G=16,k=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return m=Fi(G,b,m,R),m.elementType=u,m.type=k,m.lanes=z,m}function Rd(u,m,b,k){return u=Fi(7,u,k,m),u.lanes=b,u}function gp(u,m,b,k){return u=Fi(22,u,k,m),u.elementType=ee,u.lanes=b,u.stateNode={isHidden:!1},u}function Mv(u,m,b){return u=Fi(6,u,null,m),u.lanes=b,u}function Dv(u,m,b){return m=Fi(4,u.children!==null?u.children:[],u.key,m),m.lanes=b,m.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},m}function dq(u,m,b,k,R){this.tag=m,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wi(0),this.expirationTimes=wi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wi(0),this.identifierPrefix=k,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function Ev(u,m,b,k,R,z,G,fe,me){return u=new dq(u,m,b,fe,me),m===1?(m=1,z===!0&&(m|=8)):m=0,z=Fi(3,null,null,m),u.current=z,z.stateNode=u,z.memoizedState={element:k,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},$y(z),u}function uq(u,m,b){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:k==null?null:""+k,children:u,containerInfo:m,implementation:b}}function UT(u){if(!u)return dc;u=u._reactInternals;e:{if(Ts(u)!==u||u.tag!==1)throw Error(t(170));var m=u;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(Is(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(t(171))}if(u.tag===1){var b=u.type;if(Is(b))return p1(u,b,m)}return m}function VT(u,m,b,k,R,z,G,fe,me){return u=Ev(b,k,!0,u,R,z,G,fe,me),u.context=UT(null),b=u.current,k=vs(),R=xc(b),z=al(k,R),z.callback=m??null,hc(b,z,R),u.current.lanes=R,Rr(u,R,k),Ls(u,k),u}function xp(u,m,b,k){var R=m.current,z=vs(),G=xc(R);return b=UT(b),m.context===null?m.context=b:m.pendingContext=b,m=al(z,G),m.payload={element:u},k=k===void 0?null:k,k!==null&&(m.callback=k),u=hc(R,m,G),u!==null&&(xa(u,R,G,z),Gm(u,R,G)),G}function yp(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function BT(u,m){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var b=u.retryLane;u.retryLane=b!==0&&b<m?b:m}}function Ov(u,m){BT(u,m),(u=u.alternate)&&BT(u,m)}function fq(){return null}var WT=typeof reportError=="function"?reportError:function(u){console.error(u)};function Iv(u){this._internalRoot=u}vp.prototype.render=Iv.prototype.render=function(u){var m=this._internalRoot;if(m===null)throw Error(t(409));xp(u,m,null,null)},vp.prototype.unmount=Iv.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var m=u.containerInfo;Od(function(){xp(null,u,null,null)}),m[xn]=null}};function vp(u){this._internalRoot=u}vp.prototype.unstable_scheduleHydration=function(u){if(u){var m=Wa();u={blockedOn:null,target:u,priority:m};for(var b=0;b<Yn.length&&m!==0&&m<Yn[b].priority;b++);Yn.splice(b,0,u),b===0&&$a(u)}};function Av(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function bp(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function $T(){}function hq(u,m,b,k,R){if(R){if(typeof k=="function"){var z=k;k=function(){var Ee=yp(G);z.call(Ee)}}var G=VT(m,k,u,0,null,!1,!1,"",$T);return u._reactRootContainer=G,u[xn]=G.current,ic(u.nodeType===8?u.parentNode:u),Od(),G}for(;R=u.lastChild;)u.removeChild(R);if(typeof k=="function"){var fe=k;k=function(){var Ee=yp(me);fe.call(Ee)}}var me=Ev(u,0,!1,null,null,!1,!1,"",$T);return u._reactRootContainer=me,u[xn]=me.current,ic(u.nodeType===8?u.parentNode:u),Od(function(){xp(m,me,b,k)}),me}function _p(u,m,b,k,R){var z=b._reactRootContainer;if(z){var G=z;if(typeof R=="function"){var fe=R;R=function(){var me=yp(G);fe.call(me)}}xp(m,G,u,R)}else G=hq(b,m,u,R,k);return yp(G)}Va=function(u){switch(u.tag){case 3:var m=u.stateNode;if(m.current.memoizedState.isDehydrated){var b=Mt(m.pendingLanes);b!==0&&(fs(m,b|1),Ls(m,Cn()),(on&6)===0&&(qu=Cn()+500,uc()))}break;case 13:Od(function(){var k=il(u,1);if(k!==null){var R=vs();xa(k,u,1,R)}}),Ov(u,1)}},Js=function(u){if(u.tag===13){var m=il(u,134217728);if(m!==null){var b=vs();xa(m,u,134217728,b)}Ov(u,134217728)}},Ba=function(u){if(u.tag===13){var m=xc(u),b=il(u,m);if(b!==null){var k=vs();xa(b,u,m,k)}Ov(u,m)}},Wa=function(){return Kt},sa=function(u,m){var b=Kt;try{return Kt=u,m()}finally{Kt=b}},Hn=function(u,m,b){switch(m){case"input":if(Ue(u,b),m=b.name,b.type==="radio"&&m!=null){for(b=u;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<b.length;m++){var k=b[m];if(k!==u&&k.form===u.form){var R=Cu(k);if(!R)throw Error(t(90));Pe(k),Ue(k,R)}}}break;case"textarea":ze(u,b);break;case"select":m=b.value,m!=null&&le(u,!!b.multiple,m,!1)}},Zs=Cv,Yr=Od;var mq={usingClientEntryPoint:!1,Events:[el,tl,Cu,vn,ds,Cv]},dh={findFiberByHostInstance:Xo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pq={bundleType:dh.bundleType,version:dh.version,rendererPackageName:dh.rendererPackageName,rendererConfig:dh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Il(u),u===null?null:u.stateNode},findFiberByHostInstance:dh.findFiberByHostInstance||fq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wp.isDisabled&&wp.supportsFiber)try{na=wp.inject(pq),Ar=wp}catch{}}return Fs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mq,Fs.createPortal=function(u,m){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Av(m))throw Error(t(200));return uq(u,m,null,b)},Fs.createRoot=function(u,m){if(!Av(u))throw Error(t(299));var b=!1,k="",R=WT;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(k=m.identifierPrefix),m.onRecoverableError!==void 0&&(R=m.onRecoverableError)),m=Ev(u,1,!1,null,null,b,!1,k,R),u[xn]=m.current,ic(u.nodeType===8?u.parentNode:u),new Iv(m)},Fs.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var m=u._reactInternals;if(m===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Il(m),u=u===null?null:u.stateNode,u},Fs.flushSync=function(u){return Od(u)},Fs.hydrate=function(u,m,b){if(!bp(m))throw Error(t(200));return _p(null,u,m,!0,b)},Fs.hydrateRoot=function(u,m,b){if(!Av(u))throw Error(t(405));var k=b!=null&&b.hydratedSources||null,R=!1,z="",G=WT;if(b!=null&&(b.unstable_strictMode===!0&&(R=!0),b.identifierPrefix!==void 0&&(z=b.identifierPrefix),b.onRecoverableError!==void 0&&(G=b.onRecoverableError)),m=VT(m,null,u,1,b??null,R,!1,z,G),u[xn]=m.current,ic(u),k)for(u=0;u<k.length;u++)b=k[u],R=b._getVersion,R=R(b._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[b,R]:m.mutableSourceEagerHydrationData.push(b,R);return new vp(m)},Fs.render=function(u,m,b){if(!bp(m))throw Error(t(200));return _p(null,u,m,!1,b)},Fs.unmountComponentAtNode=function(u){if(!bp(u))throw Error(t(40));return u._reactRootContainer?(Od(function(){_p(null,null,u,!1,function(){u._reactRootContainer=null,u[xn]=null})}),!0):!1},Fs.unstable_batchedUpdates=Cv,Fs.unstable_renderSubtreeIntoContainer=function(u,m,b,k){if(!bp(b))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return _p(u,m,b,!1,k)},Fs.version="18.3.1-next-f1338f8080-20240426",Fs}var XT;function UL(){if(XT)return Fv.exports;XT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Fv.exports=wq(),Fv.exports}var ek;function jq(){if(ek)return jp;ek=1;var n=UL();return jp.createRoot=n.createRoot,jp.hydrateRoot=n.hydrateRoot,jp}var Nq=jq();const Sq=mu(Nq);var VL=UL();function Qh(){return Qh=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Qh.apply(this,arguments)}var Ec;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Ec||(Ec={}));const tk="popstate";function Cq(n){n===void 0&&(n={});function e(s,a){let{pathname:o="/",search:l="",hash:c=""}=pu(s.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),EN("",{pathname:o,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,d=c.indexOf("#");l=d===-1?c:c.slice(0,d)}return l+"#"+(typeof a=="string"?a:lx(a))}function r(s,a){zx(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(a)+")")}return kq(e,t,r,n)}function er(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function zx(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Tq(){return Math.random().toString(36).substr(2,8)}function nk(n,e){return{usr:n.state,key:n.key,idx:e}}function EN(n,e,t,r){return t===void 0&&(t=null),Qh({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?pu(e):e,{state:t,key:e&&e.key||r||Tq()})}function lx(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function pu(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function kq(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:a=!1}=r,o=s.history,l=Ec.Pop,c=null,d=h();d==null&&(d=0,o.replaceState(Qh({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function p(){l=Ec.Pop;let j=h(),T=j==null?null:j-d;d=j,c&&c({action:l,location:w.location,delta:T})}function x(j,T){l=Ec.Push;let P=EN(w.location,j,T);t&&t(P,j),d=h()+1;let E=nk(P,d),M=w.createHref(P);try{o.pushState(E,"",M)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(M)}a&&c&&c({action:l,location:w.location,delta:1})}function v(j,T){l=Ec.Replace;let P=EN(w.location,j,T);t&&t(P,j),d=h();let E=nk(P,d),M=w.createHref(P);o.replaceState(E,"",M),a&&c&&c({action:l,location:w.location,delta:0})}function _(j){let T=s.location.origin!=="null"?s.location.origin:s.location.href,P=typeof j=="string"?j:lx(j);return P=P.replace(/ $/,"%20"),er(T,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,T)}let w={get action(){return l},get location(){return n(s,o)},listen(j){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(tk,p),c=j,()=>{s.removeEventListener(tk,p),c=null}},createHref(j){return e(s,j)},createURL:_,encodeLocation(j){let T=_(j);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:x,replace:v,go(j){return o.go(j)}};return w}var rk;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(rk||(rk={}));function Pq(n,e,t){return t===void 0&&(t="/"),Mq(n,e,t)}function Mq(n,e,t,r){let s=typeof e=="string"?pu(e):e,a=pf(s.pathname||"/",t);if(a==null)return null;let o=BL(n);Dq(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=Vq(a);l=zq(o[c],d)}return l}function BL(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(er(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=Lc([r,c.relativePath]),h=t.concat(c);a.children&&a.children.length>0&&(er(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),BL(a.children,e,h,d)),!(a.path==null&&!a.index)&&e.push({path:d,score:Fq(d,a.index),routesMeta:h})};return n.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,o);else for(let c of WL(a.path))s(a,o,c)}),e}function WL(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let o=WL(r.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function Dq(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:qq(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Eq=/^:[\w-]+$/,Oq=3,Iq=2,Aq=1,Rq=10,Lq=-2,sk=n=>n==="*";function Fq(n,e){let t=n.split("/"),r=t.length;return t.some(sk)&&(r+=Lq),e&&(r+=Iq),t.filter(s=>!sk(s)).reduce((s,a)=>s+(Eq.test(a)?Oq:a===""?Aq:Rq),r)}function qq(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function zq(n,e,t){let{routesMeta:r}=n,s={},a="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=ON({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),x=c.route;if(!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:Lc([a,p.pathname]),pathnameBase:Yq(Lc([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=Lc([a,p.pathnameBase]))}return o}function ON(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Uq(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,h,p)=>{let{paramName:x,isOptional:v}=h;if(x==="*"){let w=l[p]||"";o=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const _=l[p];return v&&!_?d[x]=void 0:d[x]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function Uq(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),zx(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Vq(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zx(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function pf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const Bq=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Wq=n=>Bq.test(n);function $q(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?pu(n):n,a;if(t)if(Wq(t))a=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),zx(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+t))}t.startsWith("/")?a=ik(t.substring(1),"/"):a=ik(t,e)}else a=e;return{pathname:a,search:Gq(r),hash:Zq(s)}}function ik(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Uv(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Hq(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function GS(n,e){let t=Hq(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function ZS(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=pu(n):(s=Qh({},n),er(!s.pathname||!s.pathname.includes("?"),Uv("?","pathname","search",s)),er(!s.pathname||!s.pathname.includes("#"),Uv("#","pathname","hash",s)),er(!s.search||!s.search.includes("#"),Uv("#","search","hash",s)));let a=n===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),p-=1;s.pathname=x.join("/")}l=p>=0?e[p]:"/"}let c=$q(s,l),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const Lc=n=>n.join("/").replace(/\/\/+/g,"/"),Yq=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Gq=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Zq=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Kq(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const $L=["post","put","patch","delete"];new Set($L);const Jq=["get",...$L];new Set(Jq);function Xh(){return Xh=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Xh.apply(this,arguments)}const Ux=D.createContext(null),HL=D.createContext(null),kl=D.createContext(null),Vx=D.createContext(null),Co=D.createContext({outlet:null,matches:[],isDataRoute:!1}),YL=D.createContext(null);function Qq(n,e){let{relative:t}=e===void 0?{}:e;Of()||er(!1);let{basename:r,navigator:s}=D.useContext(kl),{hash:a,pathname:o,search:l}=Bx(n,{relative:t}),c=o;return r!=="/"&&(c=o==="/"?r:Lc([r,o])),s.createHref({pathname:c,search:l,hash:a})}function Of(){return D.useContext(Vx)!=null}function cs(){return Of()||er(!1),D.useContext(Vx).location}function GL(n){D.useContext(kl).static||D.useLayoutEffect(n)}function St(){let{isDataRoute:n}=D.useContext(Co);return n?fz():Xq()}function Xq(){Of()||er(!1);let n=D.useContext(Ux),{basename:e,future:t,navigator:r}=D.useContext(kl),{matches:s}=D.useContext(Co),{pathname:a}=cs(),o=JSON.stringify(GS(s,t.v7_relativeSplatPath)),l=D.useRef(!1);return GL(()=>{l.current=!0}),D.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let p=ZS(d,JSON.parse(o),a,h.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Lc([e,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[e,r,o,a,n])}const ZL=D.createContext(null);function yi(){return D.useContext(ZL)}function ez(n){let e=D.useContext(Co).outlet;return e&&D.createElement(ZL.Provider,{value:n},e)}function If(){let{matches:n}=D.useContext(Co),e=n[n.length-1];return e?e.params:{}}function Bx(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=D.useContext(kl),{matches:s}=D.useContext(Co),{pathname:a}=cs(),o=JSON.stringify(GS(s,r.v7_relativeSplatPath));return D.useMemo(()=>ZS(n,JSON.parse(o),a,t==="path"),[n,o,a,t])}function tz(n,e){return nz(n,e)}function nz(n,e,t,r){Of()||er(!1);let{navigator:s}=D.useContext(kl),{matches:a}=D.useContext(Co),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=cs(),h;if(e){var p;let j=typeof e=="string"?pu(e):e;c==="/"||(p=j.pathname)!=null&&p.startsWith(c)||er(!1),h=j}else h=d;let x=h.pathname||"/",v=x;if(c!=="/"){let j=c.replace(/^\//,"").split("/");v="/"+x.replace(/^\//,"").split("/").slice(j.length).join("/")}let _=Pq(n,{pathname:v}),w=oz(_&&_.map(j=>Object.assign({},j,{params:Object.assign({},l,j.params),pathname:Lc([c,s.encodeLocation?s.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?c:Lc([c,s.encodeLocation?s.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),a,t,r);return e&&w?D.createElement(Vx.Provider,{value:{location:Xh({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Ec.Pop}},w):w}function rz(){let n=uz(),e=Kq(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},e),t?D.createElement("pre",{style:s},t):null,null)}const sz=D.createElement(rz,null);class iz extends D.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?D.createElement(Co.Provider,{value:this.props.routeContext},D.createElement(YL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function az(n){let{routeContext:e,match:t,children:r}=n,s=D.useContext(Ux);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),D.createElement(Co.Provider,{value:e},r)}function oz(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var a;if(!t)return null;if(t.errors)n=t.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,l=(s=t)==null?void 0:s.errors;if(l!=null){let h=o.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);h>=0||er(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,d=-1;if(t&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:x,errors:v}=t,_=p.route.loader&&x[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||_){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,p,x)=>{let v,_=!1,w=null,j=null;t&&(v=l&&p.route.id?l[p.route.id]:void 0,w=p.route.errorElement||sz,c&&(d<0&&x===0?(hz("route-fallback"),_=!0,j=null):d===x&&(_=!0,j=p.route.hydrateFallbackElement||null)));let T=e.concat(o.slice(0,x+1)),P=()=>{let E;return v?E=w:_?E=j:p.route.Component?E=D.createElement(p.route.Component,null):p.route.element?E=p.route.element:E=h,D.createElement(az,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:t!=null},children:E})};return t&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?D.createElement(iz,{location:t.location,revalidation:t.revalidation,component:w,error:v,children:P(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):P()},null)}var KL=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(KL||{}),JL=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(JL||{});function lz(n){let e=D.useContext(Ux);return e||er(!1),e}function cz(n){let e=D.useContext(HL);return e||er(!1),e}function dz(n){let e=D.useContext(Co);return e||er(!1),e}function QL(n){let e=dz(),t=e.matches[e.matches.length-1];return t.route.id||er(!1),t.route.id}function uz(){var n;let e=D.useContext(YL),t=cz(),r=QL();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function fz(){let{router:n}=lz(KL.UseNavigateStable),e=QL(JL.UseNavigateStable),t=D.useRef(!1);return GL(()=>{t.current=!0}),D.useCallback(function(s,a){a===void 0&&(a={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,Xh({fromRouteId:e},a)))},[n,e])}const ak={};function hz(n,e,t){ak[n]||(ak[n]=!0)}function mz(n,e){n?.v7_startTransition,n?.v7_relativeSplatPath}function yl(n){let{to:e,replace:t,state:r,relative:s}=n;Of()||er(!1);let{future:a,static:o}=D.useContext(kl),{matches:l}=D.useContext(Co),{pathname:c}=cs(),d=St(),h=ZS(e,GS(l,a.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(h);return D.useEffect(()=>d(JSON.parse(p),{replace:t,state:r,relative:s}),[d,p,s,t,r]),null}function gf(n){return ez(n.context)}function He(n){er(!1)}function pz(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Ec.Pop,navigator:a,static:o=!1,future:l}=n;Of()&&er(!1);let c=e.replace(/^\/*/,"/"),d=D.useMemo(()=>({basename:c,navigator:a,static:o,future:Xh({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof r=="string"&&(r=pu(r));let{pathname:h="/",search:p="",hash:x="",state:v=null,key:_="default"}=r,w=D.useMemo(()=>{let j=pf(h,c);return j==null?null:{location:{pathname:j,search:p,hash:x,state:v,key:_},navigationType:s}},[c,h,p,x,v,_,s]);return w==null?null:D.createElement(kl.Provider,{value:d},D.createElement(Vx.Provider,{children:t,value:w}))}function gz(n){let{children:e,location:t}=n;return tz(IN(e),t)}new Promise(()=>{});function IN(n,e){e===void 0&&(e=[]);let t=[];return D.Children.forEach(n,(r,s)=>{if(!D.isValidElement(r))return;let a=[...e,s];if(r.type===D.Fragment){t.push.apply(t,IN(r.props.children,a));return}r.type!==He&&er(!1),!r.props.index||!r.props.children||er(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=IN(r.props.children,a)),t.push(o)}),t}function cx(){return cx=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},cx.apply(this,arguments)}function XL(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,a;for(a=0;a<r.length;a++)s=r[a],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function xz(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function yz(n,e){return n.button===0&&(!e||e==="_self")&&!xz(n)}function AN(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(s=>[t,s]):[[t,r]])},[]))}function vz(n,e){let t=AN(n);return e&&e.forEach((r,s)=>{t.has(s)||e.getAll(s).forEach(a=>{t.append(s,a)})}),t}const bz=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],_z=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],wz="6";try{window.__reactRouterVersion=wz}catch{}const jz=D.createContext({isTransitioning:!1}),Nz="startTransition",ok=vq[Nz];function Sz(n){let{basename:e,children:t,future:r,window:s}=n,a=D.useRef();a.current==null&&(a.current=Cq({window:s,v5Compat:!0}));let o=a.current,[l,c]=D.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=D.useCallback(p=>{d&&ok?ok(()=>c(p)):c(p)},[c,d]);return D.useLayoutEffect(()=>o.listen(h),[o,h]),D.useEffect(()=>mz(r),[r]),D.createElement(pz,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:r})}const Cz=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Tz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pa=D.forwardRef(function(e,t){let{onClick:r,relative:s,reloadDocument:a,replace:o,state:l,target:c,to:d,preventScrollReset:h,viewTransition:p}=e,x=XL(e,bz),{basename:v}=D.useContext(kl),_,w=!1;if(typeof d=="string"&&Tz.test(d)&&(_=d,Cz))try{let E=new URL(window.location.href),M=d.startsWith("//")?new URL(E.protocol+d):new URL(d),O=pf(M.pathname,v);M.origin===E.origin&&O!=null?d=O+M.search+M.hash:w=!0}catch{}let j=Qq(d,{relative:s}),T=Pz(d,{replace:o,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:p});function P(E){r&&r(E),E.defaultPrevented||T(E)}return D.createElement("a",cx({},x,{href:_||j,onClick:w||a?r:P,ref:t,target:c}))}),e4=D.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:s=!1,className:a="",end:o=!1,style:l,to:c,viewTransition:d,children:h}=e,p=XL(e,_z),x=Bx(c,{relative:p.relative}),v=cs(),_=D.useContext(HL),{navigator:w,basename:j}=D.useContext(kl),T=_!=null&&Mz(x)&&d===!0,P=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,E=v.pathname,M=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;s||(E=E.toLowerCase(),M=M?M.toLowerCase():null,P=P.toLowerCase()),M&&j&&(M=pf(M,j)||M);const O=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let I=E===P||!o&&E.startsWith(P)&&E.charAt(O)==="/",q=M!=null&&(M===P||!o&&M.startsWith(P)&&M.charAt(P.length)==="/"),F={isActive:I,isPending:q,isTransitioning:T},B=I?r:void 0,U;typeof a=="function"?U=a(F):U=[a,I?"active":null,q?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let W=typeof l=="function"?l(F):l;return D.createElement(Pa,cx({},p,{"aria-current":B,className:U,ref:t,style:W,to:c,viewTransition:d}),typeof h=="function"?h(F):h)});var RN;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(RN||(RN={}));var lk;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(lk||(lk={}));function kz(n){let e=D.useContext(Ux);return e||er(!1),e}function Pz(n,e){let{target:t,replace:r,state:s,preventScrollReset:a,relative:o,viewTransition:l}=e===void 0?{}:e,c=St(),d=cs(),h=Bx(n,{relative:o});return D.useCallback(p=>{if(yz(p,t)){p.preventDefault();let x=r!==void 0?r:lx(d)===lx(h);c(n,{replace:x,state:s,preventScrollReset:a,relative:o,viewTransition:l})}},[d,c,h,r,s,t,n,a,o,l])}function t4(n){let e=D.useRef(AN(n)),t=D.useRef(!1),r=cs(),s=D.useMemo(()=>vz(r.search,t.current?null:e.current),[r.search]),a=St(),o=D.useCallback((l,c)=>{const d=AN(typeof l=="function"?l(s):l);t.current=!0,a("?"+d,c)},[a,s]);return[s,o]}function Mz(n,e){e===void 0&&(e={});let t=D.useContext(jz);t==null&&er(!1);let{basename:r}=kz(RN.useViewTransitionState),s=Bx(n,{relative:e.relative});if(!t.isTransitioning)return!1;let a=pf(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=pf(t.nextLocation.pathname,r)||t.nextLocation.pathname;return ON(s.pathname,o)!=null||ON(s.pathname,a)!=null}const Dz={},ck=n=>{let e;const t=new Set,r=(h,p)=>{const x=typeof h=="function"?h(e):h;if(!Object.is(x,e)){const v=e;e=p??(typeof x!="object"||x===null)?x:Object.assign({},e,x),t.forEach(_=>_(e,v))}},s=()=>e,c={setState:r,getState:s,getInitialState:()=>d,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(Dz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=n(r,s,c);return c},Ez=n=>n?ck(n):ck;var Vv={exports:{}},Bv={},Wv={exports:{}},$v={};var dk;function Oz(){if(dk)return $v;dk=1;var n=Ys();function e(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,a=n.useLayoutEffect,o=n.useDebugValue;function l(p,x){var v=x(),_=r({inst:{value:v,getSnapshot:x}}),w=_[0].inst,j=_[1];return a(function(){w.value=v,w.getSnapshot=x,c(w)&&j({inst:w})},[p,v,x]),s(function(){return c(w)&&j({inst:w}),p(function(){c(w)&&j({inst:w})})},[p]),o(v),v}function c(p){var x=p.getSnapshot;p=p.value;try{var v=x();return!t(p,v)}catch{return!0}}function d(p,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return $v.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,$v}var uk;function Iz(){return uk||(uk=1,Wv.exports=Oz()),Wv.exports}var fk;function Az(){if(fk)return Bv;fk=1;var n=Ys(),e=Iz();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,a=n.useRef,o=n.useEffect,l=n.useMemo,c=n.useDebugValue;return Bv.useSyncExternalStoreWithSelector=function(d,h,p,x,v){var _=a(null);if(_.current===null){var w={hasValue:!1,value:null};_.current=w}else w=_.current;_=l(function(){function T(I){if(!P){if(P=!0,E=I,I=x(I),v!==void 0&&w.hasValue){var q=w.value;if(v(q,I))return M=q}return M=I}if(q=M,r(E,I))return q;var F=x(I);return v!==void 0&&v(q,F)?(E=I,q):(E=I,M=F)}var P=!1,E,M,O=p===void 0?null:p;return[function(){return T(h())},O===null?void 0:function(){return T(O())}]},[h,p,x,v]);var j=s(d,_[0],_[1]);return o(function(){w.hasValue=!0,w.value=j},[j]),c(j),j},Bv}var hk;function Rz(){return hk||(hk=1,Vv.exports=Az()),Vv.exports}var Lz=Rz();const Fz=mu(Lz),n4={},{useDebugValue:qz}=ot,{useSyncExternalStoreWithSelector:zz}=Fz;let mk=!1;const Uz=n=>n;function Vz(n,e=Uz,t){(n4?"production":void 0)!=="production"&&t&&!mk&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),mk=!0);const r=zz(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return qz(r),r}const pk=n=>{(n4?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?Ez(n):n,t=(r,s)=>Vz(e,r,s);return Object.assign(t,e),t},Ia=n=>n?pk(n):pk;var LN=function(n,e){return LN=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},LN(n,e)};function KS(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");LN(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var pr=function(){return pr=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},pr.apply(this,arguments)};function Af(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function r4(n,e,t,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var l=n.length-1;l>=0;l--)(o=n[l])&&(a=(s<3?o(a):s>3?o(e,t,a):o(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a}function s4(n,e){return function(t,r){e(t,r,n)}}function i4(n,e,t,r,s,a){function o(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var l=r.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&n?r.static?n:n.prototype:null,h=e||(d?Object.getOwnPropertyDescriptor(d,r.name):{}),p,x=!1,v=t.length-1;v>=0;v--){var _={};for(var w in r)_[w]=w==="access"?{}:r[w];for(var w in r.access)_.access[w]=r.access[w];_.addInitializer=function(T){if(x)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(T||null))};var j=(0,t[v])(l==="accessor"?{get:h.get,set:h.set}:h[c],_);if(l==="accessor"){if(j===void 0)continue;if(j===null||typeof j!="object")throw new TypeError("Object expected");(p=o(j.get))&&(h.get=p),(p=o(j.set))&&(h.set=p),(p=o(j.init))&&s.unshift(p)}else(p=o(j))&&(l==="field"?s.unshift(p):h[c]=p)}d&&Object.defineProperty(d,r.name,h),x=!0}function a4(n,e,t){for(var r=arguments.length>2,s=0;s<e.length;s++)t=r?e[s].call(n,t):e[s].call(n);return r?t:void 0}function o4(n){return typeof n=="symbol"?n:"".concat(n)}function l4(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function c4(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function vt(n,e,t,r){function s(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(h){try{d(r.next(h))}catch(p){o(p)}}function c(h){try{d(r.throw(h))}catch(p){o(p)}}function d(h){h.done?a(h.value):s(h.value).then(l,c)}d((r=r.apply(n,e||[])).next())})}function d4(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(h){return c([d,h])}}function c(d){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(t=0)),t;)try{if(r=1,s&&(a=d[0]&2?s.return:d[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,d[1])).done)return a;switch(s=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,s=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){t.label=d[1];break}if(d[0]===6&&t.label<a[1]){t.label=a[1],a=d;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(d);break}a[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(h){d=[6,h],s=0}finally{r=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Wx=Object.create?(function(n,e,t,r){r===void 0&&(r=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,s)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]});function u4(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Wx(e,n,t)}function dx(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function JS(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(l){o={error:l}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function f4(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(JS(arguments[e]));return n}function h4(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),s=0,e=0;e<t;e++)for(var a=arguments[e],o=0,l=a.length;o<l;o++,s++)r[s]=a[o];return r}function m4(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,a;r<s;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function xf(n){return this instanceof xf?(this.v=n,this):new xf(n)}function p4(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(v){return function(_){return Promise.resolve(_).then(v,p)}}function l(v,_){r[v]&&(s[v]=function(w){return new Promise(function(j,T){a.push([v,w,j,T])>1||c(v,w)})},_&&(s[v]=_(s[v])))}function c(v,_){try{d(r[v](_))}catch(w){x(a[0][3],w)}}function d(v){v.value instanceof xf?Promise.resolve(v.value.v).then(h,p):x(a[0][2],v)}function h(v){c("next",v)}function p(v){c("throw",v)}function x(v,_){v(_),a.shift(),a.length&&c(a[0][0],a[0][1])}}function g4(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,a){e[s]=n[s]?function(o){return(t=!t)?{value:xf(n[s](o)),done:!1}:a?a(o):o}:a}}function x4(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof dx=="function"?dx(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(l,c){o=n[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},o)}}function y4(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var Bz=Object.create?(function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}):function(n,e){n.default=e},FN=function(n){return FN=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},FN(n)};function v4(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=FN(n),r=0;r<t.length;r++)t[r]!=="default"&&Wx(e,n,t[r]);return Bz(e,n),e}function b4(n){return n&&n.__esModule?n:{default:n}}function _4(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function w4(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t}function j4(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function N4(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,s;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var Wz=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function S4(n){function e(a){n.error=n.hasError?new Wz(a,n.error,"An error was suppressed during disposal."):a,n.hasError=!0}var t,r=0;function s(){for(;t=n.stack.pop();)try{if(!t.async&&r===1)return r=0,n.stack.push(t),Promise.resolve().then(s);if(t.dispose){var a=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(a).then(s,function(o){return e(o),s()})}else r|=1}catch(o){e(o)}if(r===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return s()}function C4(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,s,a,o){return r?e?".jsx":".js":s&&(!a||!o)?t:s+a+"."+o.toLowerCase()+"js"}):n}const $z={__extends:KS,__assign:pr,__rest:Af,__decorate:r4,__param:s4,__esDecorate:i4,__runInitializers:a4,__propKey:o4,__setFunctionName:l4,__metadata:c4,__awaiter:vt,__generator:d4,__createBinding:Wx,__exportStar:u4,__values:dx,__read:JS,__spread:f4,__spreadArrays:h4,__spreadArray:m4,__await:xf,__asyncGenerator:p4,__asyncDelegator:g4,__asyncValues:x4,__makeTemplateObject:y4,__importStar:v4,__importDefault:b4,__classPrivateFieldGet:_4,__classPrivateFieldSet:w4,__classPrivateFieldIn:j4,__addDisposableResource:N4,__disposeResources:S4,__rewriteRelativeImportExtension:C4},Hz=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:N4,get __assign(){return pr},__asyncDelegator:g4,__asyncGenerator:p4,__asyncValues:x4,__await:xf,__awaiter:vt,__classPrivateFieldGet:_4,__classPrivateFieldIn:j4,__classPrivateFieldSet:w4,__createBinding:Wx,__decorate:r4,__disposeResources:S4,__esDecorate:i4,__exportStar:u4,__extends:KS,__generator:d4,__importDefault:b4,__importStar:v4,__makeTemplateObject:y4,__metadata:c4,__param:s4,__propKey:o4,__read:JS,__rest:Af,__rewriteRelativeImportExtension:C4,__runInitializers:a4,__setFunctionName:l4,__spread:f4,__spreadArray:m4,__spreadArrays:h4,__values:dx,default:$z},Symbol.toStringTag,{value:"Module"})),Yz=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class QS extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Gz extends QS{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class gk extends QS{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class xk extends QS{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var qN;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(qN||(qN={}));class Zz{constructor(e,{headers:t={},customFetch:r,region:s=qN.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=Yz(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return vt(this,arguments,void 0,function*(t,r={}){var s;let a,o;try{const{headers:l,method:c,body:d,signal:h,timeout:p}=r;let x={},{region:v}=r;v||(v=this.region);const _=new URL(`${this.url}/${t}`);v&&v!=="any"&&(x["x-region"]=v,_.searchParams.set("forceFunctionRegion",v));let w;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",w=d):typeof d=="string"?(x["Content-Type"]="text/plain",w=d):typeof FormData<"u"&&d instanceof FormData?w=d:(x["Content-Type"]="application/json",w=JSON.stringify(d)):w=d;let j=h;p&&(o=new AbortController,a=setTimeout(()=>o.abort(),p),h?(j=o.signal,h.addEventListener("abort",()=>o.abort())):j=o.signal);const T=yield this.fetch(_.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),l),body:w,signal:j}).catch(O=>{throw new Gz(O)}),P=T.headers.get("x-relay-error");if(P&&P==="true")throw new gk(T);if(!T.ok)throw new xk(T);let E=((s=T.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),M;return E==="application/json"?M=yield T.json():E==="application/octet-stream"||E==="application/pdf"?M=yield T.blob():E==="text/event-stream"?M=T:E==="multipart/form-data"?M=yield T.formData():M=yield T.text(),{data:M,error:null,response:T}}catch(l){return{data:null,error:l,response:l instanceof xk||l instanceof gk?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var ns={};const Rf=qL(Hz);var Np={},Sp={},Cp={},Tp={},kp={},Pp={},yk;function T4(){if(yk)return Pp;yk=1,Object.defineProperty(Pp,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Pp.default=n,Pp}var vk;function k4(){if(vk)return kp;vk=1,Object.defineProperty(kp,"__esModule",{value:!0});const e=Rf.__importDefault(T4());class t{constructor(s){var a,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(a=s.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=s.signal,this.isMaybeSingle=(o=s.isMaybeSingle)!==null&&o!==void 0?o:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,a){return this.headers=new Headers(this.headers),this.headers.set(s,a),this}then(s,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,h,p,x;let v=null,_=null,w=null,j=c.status,T=c.statusText;if(c.ok){if(this.method!=="HEAD"){const O=await c.text();O===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?_=O:_=JSON.parse(O))}const E=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),M=(p=c.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");E&&M&&M.length>1&&(w=parseInt(M[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(v={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,w=null,j=406,T="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const E=await c.text();try{v=JSON.parse(E),Array.isArray(v)&&c.status===404&&(_=[],v=null,j=200,T="OK")}catch{c.status===404&&E===""?(j=204,T="No Content"):v={message:E}}if(v&&this.isMaybeSingle&&(!((x=v?.details)===null||x===void 0)&&x.includes("0 rows"))&&(v=null,j=200,T="OK"),v&&this.shouldThrowOnError)throw new e.default(v)}return{error:v,data:_,count:w,status:j,statusText:T}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,h,p;return{error:{message:`${(d=c?.name)!==null&&d!==void 0?d:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(p=c?.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,a)}returns(){return this}overrideTypes(){return this}}return kp.default=t,kp}var bk;function P4(){if(bk)return Tp;bk=1,Object.defineProperty(Tp,"__esModule",{value:!0});const e=Rf.__importDefault(k4());class t extends e.default{select(s){let a=!1;const o=(s??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:a=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",h=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${h?`${h},`:""}${s}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this}range(s,a,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(d,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:a=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var h;const p=[s?"analyze":null,a?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),x=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${x}"; options=${p};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Tp.default=t,Tp}var _k;function XS(){if(_k)return Cp;_k=1,Object.defineProperty(Cp,"__esModule",{value:!0});const e=Rf.__importDefault(P4()),t=new RegExp("[,()]");class r extends e.default{eq(a,o){return this.url.searchParams.append(a,`eq.${o}`),this}neq(a,o){return this.url.searchParams.append(a,`neq.${o}`),this}gt(a,o){return this.url.searchParams.append(a,`gt.${o}`),this}gte(a,o){return this.url.searchParams.append(a,`gte.${o}`),this}lt(a,o){return this.url.searchParams.append(a,`lt.${o}`),this}lte(a,o){return this.url.searchParams.append(a,`lte.${o}`),this}like(a,o){return this.url.searchParams.append(a,`like.${o}`),this}likeAllOf(a,o){return this.url.searchParams.append(a,`like(all).{${o.join(",")}}`),this}likeAnyOf(a,o){return this.url.searchParams.append(a,`like(any).{${o.join(",")}}`),this}ilike(a,o){return this.url.searchParams.append(a,`ilike.${o}`),this}ilikeAllOf(a,o){return this.url.searchParams.append(a,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(a,o){return this.url.searchParams.append(a,`ilike(any).{${o.join(",")}}`),this}is(a,o){return this.url.searchParams.append(a,`is.${o}`),this}in(a,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&t.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cs.{${o.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(o)}`),this}containedBy(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cd.{${o.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(o)}`),this}rangeGt(a,o){return this.url.searchParams.append(a,`sr.${o}`),this}rangeGte(a,o){return this.url.searchParams.append(a,`nxl.${o}`),this}rangeLt(a,o){return this.url.searchParams.append(a,`sl.${o}`),this}rangeLte(a,o){return this.url.searchParams.append(a,`nxr.${o}`),this}rangeAdjacent(a,o){return this.url.searchParams.append(a,`adj.${o}`),this}overlaps(a,o){return typeof o=="string"?this.url.searchParams.append(a,`ov.${o}`):this.url.searchParams.append(a,`ov.{${o.join(",")}}`),this}textSearch(a,o,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${h}.${o}`),this}match(a){return Object.entries(a).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(a,o,l){return this.url.searchParams.append(a,`not.${o}.${l}`),this}or(a,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,o,l){return this.url.searchParams.append(a,`${o}.${l}`),this}}return Cp.default=r,Cp}var wk;function M4(){if(wk)return Sp;wk=1,Object.defineProperty(Sp,"__esModule",{value:!0});const e=Rf.__importDefault(XS());class t{constructor(s,{headers:a={},schema:o,fetch:l}){this.url=s,this.headers=new Headers(a),this.schema=o,this.fetch=l}select(s,a){const{head:o=!1,count:l}=a??{},c=o?"HEAD":"GET";let d=!1;const h=(s??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",h),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:a,defaultToNull:o=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(d.length>0){const h=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(s,{onConflict:a,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var d;const h="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const p=s.reduce((x,v)=>x.concat(Object.keys(v)),[]);if(p.length>0){const x=[...new Set(p)].map(v=>`"${v}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(s,{count:a}={}){var o;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var a;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return Sp.default=t,Sp}var jk;function Kz(){if(jk)return Np;jk=1,Object.defineProperty(Np,"__esModule",{value:!0});const n=Rf,e=n.__importDefault(M4()),t=n.__importDefault(XS());class r{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new r(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:d}={}){var h;let p;const x=new URL(`${this.url}/rpc/${a}`);let v;l||c?(p=l?"HEAD":"GET",Object.entries(o).filter(([w,j])=>j!==void 0).map(([w,j])=>[w,Array.isArray(j)?`{${j.join(",")}}`:`${j}`]).forEach(([w,j])=>{x.searchParams.append(w,j)})):(p="POST",v=o);const _=new Headers(this.headers);return d&&_.set("Prefer",`count=${d}`),new t.default({method:p,url:x,headers:_,schema:this.schemaName,body:v,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return Np.default=r,Np}var Nk;function Jz(){if(Nk)return ns;Nk=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.PostgrestError=ns.PostgrestBuilder=ns.PostgrestTransformBuilder=ns.PostgrestFilterBuilder=ns.PostgrestQueryBuilder=ns.PostgrestClient=void 0;const n=Rf,e=n.__importDefault(Kz());ns.PostgrestClient=e.default;const t=n.__importDefault(M4());ns.PostgrestQueryBuilder=t.default;const r=n.__importDefault(XS());ns.PostgrestFilterBuilder=r.default;const s=n.__importDefault(P4());ns.PostgrestTransformBuilder=s.default;const a=n.__importDefault(k4());ns.PostgrestBuilder=a.default;const o=n.__importDefault(T4());return ns.PostgrestError=o.default,ns.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:a.default,PostgrestError:o.default},ns}var D4=Jz();const E4=mu(D4),Qz=FL({__proto__:null,default:E4},[D4]),{PostgrestClient:Xz,PostgrestQueryBuilder:Iue,PostgrestFilterBuilder:Aue,PostgrestTransformBuilder:Rue,PostgrestBuilder:Lue,PostgrestError:Fue}=E4||Qz;class eU{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const tU="2.81.1",nU=`realtime-js/${tU}`,O4="1.0.0",rU="2.0.0",Sk=O4,zN=1e4,sU=1e3,iU=100;var Jd;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Jd||(Jd={}));var Cr;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Cr||(Cr={}));var Vi;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Vi||(Vi={}));var UN;(function(n){n.websocket="websocket"})(UN||(UN={}));var Qd;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Qd||(Qd={}));class aU{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(e,t){if(this._isArrayBuffer(e.payload))return t(this._binaryEncodePush(e));if(e.event===this.BROADCAST&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodePush(e){const{join_ref:t,ref:r,event:s,topic:a,payload:o}=e,l=this.META_LENGTH+t.length+r.length+a.length+s.length,c=new ArrayBuffer(this.HEADER_LENGTH+l);let d=new DataView(c),h=0;d.setUint8(h++,this.KINDS.push),d.setUint8(h++,t.length),d.setUint8(h++,r.length),d.setUint8(h++,a.length),d.setUint8(h++,s.length),Array.from(t,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(r,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(a,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(s,x=>d.setUint8(h++,x.charCodeAt(0)));var p=new Uint8Array(c.byteLength+o.byteLength);return p.set(new Uint8Array(c),0),p.set(new Uint8Array(o),c.byteLength),p.buffer}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const{join_ref:s,ref:a,topic:o}=e,l=e.payload.event,c=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:new ArrayBuffer(0),d=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+o.length+l.length,h=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(h),x=0;p.setUint8(x++,this.KINDS.userBroadcastPush),p.setUint8(x++,s.length),p.setUint8(x++,a.length),p.setUint8(x++,o.length),p.setUint8(x++,l.length),p.setUint8(x++,this.BINARY_ENCODING),Array.from(s,_=>p.setUint8(x++,_.charCodeAt(0))),Array.from(a,_=>p.setUint8(x++,_.charCodeAt(0))),Array.from(o,_=>p.setUint8(x++,_.charCodeAt(0))),Array.from(l,_=>p.setUint8(x++,_.charCodeAt(0)));var v=new Uint8Array(h.byteLength+c.byteLength);return v.set(new Uint8Array(h),0),v.set(new Uint8Array(c),h.byteLength),v.buffer}_encodeJsonUserBroadcastPush(e){var t,r;const{join_ref:s,ref:a,topic:o}=e,l=e.payload.event,c=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:{},h=new TextEncoder().encode(JSON.stringify(c)).buffer,p=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+o.length+l.length,x=new ArrayBuffer(this.HEADER_LENGTH+p);let v=new DataView(x),_=0;v.setUint8(_++,this.KINDS.userBroadcastPush),v.setUint8(_++,s.length),v.setUint8(_++,a.length),v.setUint8(_++,o.length),v.setUint8(_++,l.length),v.setUint8(_++,this.JSON_ENCODING),Array.from(s,j=>v.setUint8(_++,j.charCodeAt(0))),Array.from(a,j=>v.setUint8(_++,j.charCodeAt(0))),Array.from(o,j=>v.setUint8(_++,j.charCodeAt(0))),Array.from(l,j=>v.setUint8(_++,j.charCodeAt(0)));var w=new Uint8Array(x.byteLength+h.byteLength);return w.set(new Uint8Array(x),0),w.set(new Uint8Array(h),x.byteLength),w.buffer}decode(e,t){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return t(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,a,o,l,c]=r;return t({join_ref:s,ref:a,topic:o,event:l,payload:c})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.push:return this._decodePush(e,t,s);case this.KINDS.reply:return this._decodeReply(e,t,s);case this.KINDS.broadcast:return this._decodeBroadcast(e,t,s);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,s)}}_decodePush(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3);let l=this.HEADER_LENGTH+this.META_LENGTH-1;const c=r.decode(e.slice(l,l+s));l=l+s;const d=r.decode(e.slice(l,l+a));l=l+a;const h=r.decode(e.slice(l,l+o));l=l+o;const p=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{join_ref:c,ref:null,topic:d,event:h,payload:p}}_decodeReply(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+this.META_LENGTH;const d=r.decode(e.slice(c,c+s));c=c+s;const h=r.decode(e.slice(c,c+a));c=c+a;const p=r.decode(e.slice(c,c+o));c=c+o;const x=r.decode(e.slice(c,c+l));c=c+l;const v=JSON.parse(r.decode(e.slice(c,e.byteLength))),_={status:x,response:v};return{join_ref:d,ref:h,topic:p,event:Vi.reply,payload:_}}_decodeBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+s));o=o+s;const c=r.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{join_ref:null,ref:null,topic:l,event:c,payload:d}}_decodeUserBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+4;const d=r.decode(e.slice(c,c+s));c=c+s;const h=r.decode(e.slice(c,c+a));c=c+a;const p=r.decode(e.slice(c,c+o));c=c+o;const x=e.slice(c,e.byteLength),v=l===this.JSON_ENCODING?JSON.parse(r.decode(x)):x,_={type:this.BROADCAST,event:h,payload:v};return o>0&&(_.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST,payload:_}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}}class I4{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var In;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(In||(In={}));const Ck=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((a,o)=>(a[o]=oU(o,n,e,s),a),{}):{}},oU=(n,e,t,r)=>{const s=e.find(l=>l.name===n),a=s?.type,o=t[n];return a&&!r.includes(a)?A4(a,o):VN(o)},A4=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return uU(e,t)}switch(n){case In.bool:return lU(e);case In.float4:case In.float8:case In.int2:case In.int4:case In.int8:case In.numeric:case In.oid:return cU(e);case In.json:case In.jsonb:return dU(e);case In.timestamp:return fU(e);case In.abstime:case In.date:case In.daterange:case In.int4range:case In.int8range:case In.money:case In.reltime:case In.text:case In.time:case In.timestamptz:case In.timetz:case In.tsrange:case In.tstzrange:return VN(e);default:return VN(e)}},VN=n=>n,lU=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},cU=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},dU=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},uU=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let a;const o=n.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>A4(e,l))}return n},fU=n=>typeof n=="string"?n.replace(" ","T"):n,R4=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Hv{constructor(e,t,r={},s=zN){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Tk;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Tk||(Tk={}));class Wh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Wh.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=Wh.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Wh.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const a=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(a,(d,h)=>{o[d]||(c[d]=h)}),this.map(o,(d,h)=>{const p=a[d];if(p){const x=h.map(j=>j.presence_ref),v=p.map(j=>j.presence_ref),_=h.filter(j=>v.indexOf(j.presence_ref)<0),w=p.filter(j=>x.indexOf(j.presence_ref)<0);_.length>0&&(l[d]=_),w.length>0&&(c[d]=w)}else l[d]=h}),this.syncDiff(a,{joins:l,leaves:c},r,s)}static syncDiff(e,t,r,s){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var d;const h=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),h.length>0){const p=e[l].map(v=>v.presence_ref),x=h.filter(v=>p.indexOf(v.presence_ref)<0);e[l].unshift(...x)}r(l,h,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const h=c.map(p=>p.presence_ref);d=d.filter(p=>h.indexOf(p.presence_ref)<0),e[l]=d,s(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var kk;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(kk||(kk={}));var $h;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})($h||($h={}));var pl;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(pl||(pl={}));class eC{constructor(e,t={config:{}},r){var s,a;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Cr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Hv(this,Vi.join,this.params,this.timeout),this.rejoinTimer=new I4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Cr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Cr.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Cr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Cr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Cr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vi.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Wh(this),this.broadcastEndpointURL=R4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Cr.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(v=>v.filter))!==null&&s!==void 0?s:[],h=!!this.bindings[$h.PRESENCE]&&this.bindings[$h.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,p={},x={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(pl.CHANNEL_ERROR,v)),this._onClose(()=>e?.(pl.CLOSED)),this.updateJoinPayload(Object.assign({config:x},p)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var _;if(this.socket.setAuth(),v===void 0){e?.(pl.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,j=(_=w?.length)!==null&&_!==void 0?_:0,T=[];for(let P=0;P<j;P++){const E=w[P],{filter:{event:M,schema:O,table:I,filter:q}}=E,F=v&&v[P];if(F&&F.event===M&&F.schema===O&&F.table===I&&F.filter===q)T.push(Object.assign(Object.assign({},E),{id:F.id}));else{this.unsubscribe(),this.state=Cr.errored,e?.(pl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,e&&e(pl.SUBSCRIBED);return}}).receive("error",v=>{this.state=Cr.errored,e?.(pl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(pl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===Cr.joined&&e===$h.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var s;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Cr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vi.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Hv(this,Vi.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Cr.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,a=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Hv(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>iU){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:h}=Vi;if(r&&[l,c,d,h].indexOf(o)>=0&&r!==this._joinRef())return;let x=this._onMessage(o,t,r);if(t&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var _,w,j;return((_=v.filter)===null||_===void 0?void 0:_.event)==="*"||((j=(w=v.filter)===null||w===void 0?void 0:w.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===o}).map(v=>v.callback(x,r)):(a=this.bindings[o])===null||a===void 0||a.filter(v=>{var _,w,j,T,P,E;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const M=v.id,O=(_=v.filter)===null||_===void 0?void 0:_.event;return M&&((w=t.ids)===null||w===void 0?void 0:w.includes(M))&&(O==="*"||O?.toLocaleLowerCase()===((j=t.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const M=(P=(T=v?.filter)===null||T===void 0?void 0:T.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return M==="*"||M===((E=t?.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof x=="object"&&"ids"in x){const _=x.data,{schema:w,table:j,commit_timestamp:T,type:P,errors:E}=_;x=Object.assign(Object.assign({},{schema:w,table:j,commit_timestamp:T,eventType:P,new:{},old:{},errors:E}),this._getPayloadRecords(_))}v.callback(x,r)})}_isClosed(){return this.state===Cr.closed}_isJoined(){return this.state===Cr.joined}_isJoining(){return this.state===Cr.joining}_isLeaving(){return this.state===Cr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&eC.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Vi.close,{},e)}_onError(e){this._on(Vi.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Cr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Ck(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Ck(e.columns,e.old_record)),t}}const Yv=()=>{},Mp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},hU=[1e3,2e3,5e3,1e4],mU=1e4,pU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class gU{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=zN,this.transport=null,this.heartbeatIntervalMs=Mp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Yv,this.ref=0,this.reconnectTimer=null,this.vsn=Sk,this.logger=Yv,this.conn=null,this.sendBuffer=[],this.serializer=new aU,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${UN.websocket}`,this.httpEndpoint=R4(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=eU.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Jd.connecting:return Qd.Connecting;case Jd.open:return Qd.Open;case Jd.closing:return Qd.Closing;default:return Qd.Closed}}isConnected(){return this.connectionState()===Qd.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(a=>a.topic===r);if(s)return s;{const a=new eC(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:r,payload:s,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${r} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(sU,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Mp.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:a,ref:o}=t,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${r} ${s} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(s,a,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Jd.open||this.conn.readyState===Jd.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Vi.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([pU],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:nU};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Vi.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new I4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Mp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,a,o,l,c,d,h,p,x,v;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:zN,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:Mp.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:Yv,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:Sk,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(_=>hU[_-1]||mU),this.vsn){case O4:this.encode=(h=e?.encode)!==null&&h!==void 0?h:((_,w)=>w(JSON.stringify(_))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:((_,w)=>w(JSON.parse(_)));break;case rU:this.encode=(x=e?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(v=e?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class tC extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Jn(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class xU extends tC{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class BN extends tC{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const nC=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),yU=()=>Response,WN=n=>{if(Array.isArray(n))return n.map(t=>WN(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[s]=WN(r)}),e},vU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Gv=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},bU=(n,e,t)=>vt(void 0,void 0,void 0,function*(){const r=yield yU();n instanceof r&&!t?.noResolveJson?n.json().then(s=>{const a=n.status||500,o=s?.statusCode||a+"";e(new xU(Gv(s),a,o))}).catch(s=>{e(new BN(Gv(s),s))}):e(new BN(Gv(n),n))}),_U=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||!r?s:(vU(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,e?.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function wm(n,e,t,r,s,a){return vt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,_U(e,r,s,a)).then(c=>{if(!c.ok)throw c;return r?.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>bU(c,l,r))})})}function em(n,e,t,r){return vt(this,void 0,void 0,function*(){return wm(n,"GET",e,t,r)})}function _a(n,e,t,r,s){return vt(this,void 0,void 0,function*(){return wm(n,"POST",e,r,s,t)})}function $N(n,e,t,r,s){return vt(this,void 0,void 0,function*(){return wm(n,"PUT",e,r,s,t)})}function wU(n,e,t,r){return vt(this,void 0,void 0,function*(){return wm(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function rC(n,e,t,r,s){return vt(this,void 0,void 0,function*(){return wm(n,"DELETE",e,r,s,t)})}class jU{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return vt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Jn(e))return{data:null,error:e};throw e}})}}var L4;class NU{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[L4]="BlobDownloadBuilder",this.promise=null}asStream(){return new jU(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return vt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Jn(e))return{data:null,error:e};throw e}})}}L4=Symbol.toStringTag;const SU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Pk={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class CU{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=nC(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return vt(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Pk),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),s?.headers&&(l=Object.assign(Object.assign({},l),s.headers));const d=this._removeEmptyFolders(t),h=this._getFinalPath(d),p=yield(e=="PUT"?$N:_a)(this.fetch,`${this.url}/object/${h}`,a,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Jn(a))return{data:null,error:a};throw a}})}upload(e,t,r){return vt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return vt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:Pk.upsert},s),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const p=yield $N(this.fetch,l.toString(),c,{headers:h});return{data:{path:a,fullPath:p.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Jn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return vt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");const a=yield _a(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new tC("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Jn(r))return{data:null,error:r};throw r}})}update(e,t,r){return vt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return vt(this,void 0,void 0,function*(){try{return{data:yield _a(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}copy(e,t,r){return vt(this,void 0,void 0,function*(){try{return{data:{path:(yield _a(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return vt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),a=yield _a(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return vt(this,void 0,void 0,function*(){try{const s=yield _a(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}download(e,t){const s=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),o=a?`?${a}`:"",l=this._getFinalPath(e),c=()=>em(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new NU(c,this.shouldThrowOnError)}info(e){return vt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield em(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:WN(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Jn(r))return{data:null,error:r};throw r}})}exists(e){return vt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield wU(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Jn(r)&&r instanceof BN){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return vt(this,void 0,void 0,function*(){try{return{data:yield rC(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}list(e,t,r){return vt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},SU),t),{prefix:e||""});return{data:yield _a(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}listV2(e,t){return vt(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield _a(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Jn(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const F4="2.81.1",q4={"X-Client-Info":`storage-js/${F4}`};class TU{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},q4),t),this.fetch=nC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return vt(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield em(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}getBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield em(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}createBucket(e){return vt(this,arguments,void 0,function*(t,r={public:!1}){try{return{data:yield _a(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return vt(this,void 0,void 0,function*(){try{return{data:yield $N(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Jn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield _a(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield rC(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}class kU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},q4),t),this.fetch=nC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield _a(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}listBuckets(e){return vt(this,void 0,void 0,function*(){try{const t=new URLSearchParams;e?.limit!==void 0&&t.set("limit",e.limit.toString()),e?.offset!==void 0&&t.set("offset",e.offset.toString()),e?.sortColumn&&t.set("sortColumn",e.sortColumn),e?.sortOrder&&t.set("sortOrder",e.sortOrder),e?.search&&t.set("search",e.search);const r=t.toString(),s=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield em(this.fetch,s,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield rC(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}}const sC={"X-Client-Info":`storage-js/${F4}`,"Content-Type":"application/json"};class z4 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ui(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}class Zv extends z4{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class PU extends z4{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var Mk;(function(n){n.InternalError="InternalError",n.S3VectorConflictException="S3VectorConflictException",n.S3VectorNotFoundException="S3VectorNotFoundException",n.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",n.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",n.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Mk||(Mk={}));const iC=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),MU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Dk=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),DU=(n,e,t)=>vt(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!t?.noResolveJson){const s=n.status||500,a=n;if(typeof a.json=="function")a.json().then(o=>{const l=o?.statusCode||o?.code||s+"";e(new Zv(Dk(o),s,l))}).catch(()=>{const o=s+"",l=a.statusText||`HTTP ${s} error`;e(new Zv(l,s,o))});else{const o=s+"",l=a.statusText||`HTTP ${s} error`;e(new Zv(l,s,o))}}else e(new PU(Dk(n),n))}),EU=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return r?(MU(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,Object.assign(Object.assign({},s),t)):s};function OU(n,e,t,r,s,a){return vt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,EU(e,r,s,a)).then(c=>{if(!c.ok)throw c;if(r?.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>DU(c,l,r))})})}function fi(n,e,t,r,s){return vt(this,void 0,void 0,function*(){return OU(n,"POST",e,r,s,t)})}class IU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},sC),t),this.fetch=iC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return vt(this,void 0,void 0,function*(){try{return{data:(yield fi(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}getIndex(e,t){return vt(this,void 0,void 0,function*(){try{return{data:yield fi(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ui(r))return{data:null,error:r};throw r}})}listIndexes(e){return vt(this,void 0,void 0,function*(){try{return{data:yield fi(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return vt(this,void 0,void 0,function*(){try{return{data:(yield fi(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ui(r))return{data:null,error:r};throw r}})}}class AU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},sC),t),this.fetch=iC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return vt(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield fi(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}getVectors(e){return vt(this,void 0,void 0,function*(){try{return{data:yield fi(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}listVectors(e){return vt(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield fi(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}queryVectors(e){return vt(this,void 0,void 0,function*(){try{return{data:yield fi(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}deleteVectors(e){return vt(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield fi(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}}class RU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},sC),t),this.fetch=iC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:(yield fi(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}getBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield fi(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}listBuckets(){return vt(this,arguments,void 0,function*(e={}){try{return{data:yield fi(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}deleteBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:(yield fi(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ui(t))return{data:null,error:t};throw t}})}}class LU extends RU{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new FU(this.url,this.headers,e,this.fetch)}}class FU extends IU{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return vt(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return vt(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return vt(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return vt(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new qU(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class qU extends AU{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return vt(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return vt(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return vt(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return vt(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return vt(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class zU extends TU{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new CU(this.url,this.headers,e,this.fetch)}get vectors(){return new LU(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new kU(this.url+"/iceberg",this.headers,this.fetch)}}const UU="2.81.1";let Rh="";typeof Deno<"u"?Rh="deno":typeof document<"u"?Rh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Rh="react-native":Rh="node";const VU={"X-Client-Info":`supabase-js-${Rh}/${UU}`},BU={headers:VU},WU={schema:"public"},$U={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},HU={},YU=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),GU=()=>Headers,ZU=(n,e,t)=>{const r=YU(t),s=GU();return async(a,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:n;let d=new s(o?.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(a,Object.assign(Object.assign({},o),{headers:d}))}};function KU(n){return n.endsWith("/")?n:n+"/"}function JU(n,e){var t,r;const{db:s,auth:a,realtime:o,global:l}=n,{db:c,auth:d,realtime:h,global:p}=e,x={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},h),o),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(t=p?.headers)!==null&&t!==void 0?t:{}),(r=l?.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return n.accessToken?x.accessToken=n.accessToken:delete x.accessToken,x}function QU(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(KU(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const U4="2.81.1",ef=30*1e3,HN=3,Kv=HN*ef,XU="http://localhost:9999",eV="supabase.auth.token",tV={"X-Client-Info":`gotrue-js/${U4}`},YN="X-Supabase-Api-Version",V4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},nV=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,rV=600*1e3;class tm extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function _t(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class sV extends tm{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function iV(n){return _t(n)&&n.name==="AuthApiError"}class Xd extends tm{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Hc extends tm{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class va extends Hc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function aV(n){return _t(n)&&n.name==="AuthSessionMissingError"}class Uu extends Hc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Dp extends Hc{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ep extends Hc{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function oV(n){return _t(n)&&n.name==="AuthImplicitGrantRedirectError"}class Ek extends Hc{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class GN extends Hc{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Jv(n){return _t(n)&&n.name==="AuthRetryableFetchError"}class Ok extends Hc{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class ZN extends Hc{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ux="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ik=` 	
\r=`.split(""),lV=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Ik.length;e+=1)n[Ik[e].charCodeAt(0)]=-2;for(let e=0;e<ux.length;e+=1)n[ux[e].charCodeAt(0)]=e;return n})();function Ak(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(ux[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(ux[r]),e.queuedBits-=6}}function B4(n,e,t){const r=lV[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Rk(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{uV(o,r,t)};for(let o=0;o<n.length;o+=1)B4(n.charCodeAt(o),s,a);return e.join("")}function cV(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function dV(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}cV(r,e)}}function uV(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function lf(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)B4(n.charCodeAt(s),t,r);return new Uint8Array(e)}function fV(n){const e=[];return dV(n,t=>e.push(t)),new Uint8Array(e)}function eu(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>Ak(s,t,r)),Ak(null,t,r),e.join("")}function hV(n){return Math.round(Date.now()/1e3)+n}function mV(){return Symbol("auth-callback")}const Wr=()=>typeof window<"u"&&typeof document<"u",Ld={tested:!1,writable:!1},W4=()=>{if(!Wr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ld.tested)return Ld.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Ld.tested=!0,Ld.writable=!0}catch{Ld.tested=!0,Ld.writable=!1}return Ld.writable};function pV(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,a)=>{e[a]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const $4=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),gV=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",tf=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Fd=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},_c=async(n,e)=>{await n.removeItem(e)};class $x{constructor(){this.promise=new $x.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}$x.promiseConstructor=Promise;function Qv(n){const e=n.split(".");if(e.length!==3)throw new ZN("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!nV.test(e[r]))throw new ZN("JWT not in base64url format");return{header:JSON.parse(Rk(e[0])),payload:JSON.parse(Rk(e[1])),signature:lf(e[2]),raw:{header:e[0],payload:e[1]}}}async function xV(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function yV(n,e){return new Promise((r,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await n(a);if(!e(a,null,o)){r(o);return}}catch(o){if(!e(a,o)){s(o);return}}})()})}function vV(n){return("0"+n.toString(16)).substr(-2)}function bV(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let a=0;a<56;a++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,vV).join("")}async function _V(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function wV(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await _V(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Vu(n,e,t=!1){const r=bV();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await tf(n,`${e}-code-verifier`,s);const a=await wV(r);return[a,r===a?"plain":"s256"]}const jV=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function NV(n){const e=n.headers.get(YN);if(!e||!e.match(jV))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function SV(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function CV(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const TV=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Bu(n){if(!TV.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xv(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function kV(n,e){return new Proxy(n,{get:(t,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,r,s)}})}function Lk(n){return JSON.parse(JSON.stringify(n))}const Yd=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),PV=[502,503,504];async function Fk(n){var e;if(!gV(n))throw new GN(Yd(n),0);if(PV.includes(n.status))throw new GN(Yd(n),n.status);let t;try{t=await n.json()}catch(a){throw new Xd(Yd(a),a)}let r;const s=NV(n);if(s&&s.getTime()>=V4["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Ok(Yd(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new va}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Ok(Yd(t),n.status,t.weak_password.reasons);throw new sV(Yd(t),n.status||500,r)}const MV=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function It(n,e,t,r){var s;const a=Object.assign({},r?.headers);a[YN]||(a[YN]=V4["2024-01-01"].name),r?.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const o=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await DV(n,e,t+l,{headers:a,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(c):{data:Object.assign({},c),error:null}}async function DV(n,e,t,r,s,a){const o=MV(e,r,s,a);let l;try{l=await n(t,Object.assign({},o))}catch(c){throw console.error(c),new GN(Yd(c),0)}if(l.ok||await Fk(l),r?.noResolveJson)return l;try{return await l.json()}catch(c){await Fk(c)}}function ba(n){var e;let t=null;IV(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=hV(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function qk(n){const e=ba(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Dc(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function EV(n){return{data:n,error:null}}function OV(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a}=n,o=Af(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function zk(n){return n}function IV(n){return n.access_token&&n.refresh_token&&n.expires_in}const eb=["global","local","others"];class AV{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=$4(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=eb[0]){if(eb.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${eb.join(", ")}`);try{return await It(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(_t(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await It(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Dc})}catch(r){if(_t(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Af(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await It(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:OV,redirectTo:t?.redirectTo})}catch(t){if(_t(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await It(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Dc})}catch(t){if(_t(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await It(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:zk});if(h.error)throw h.error;const p=await h.json(),x=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(_.split(";")[1].split("=")[1]);d[`${j}Page`]=w}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(_t(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Bu(e);try{return await It(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Dc})}catch(t){if(_t(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Bu(e);try{return await It(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Dc})}catch(r){if(_t(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Bu(e);try{return await It(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Dc})}catch(r){if(_t(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Bu(e.userId);try{const{data:t,error:r}=await It(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(_t(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Bu(e.userId),Bu(e.id);try{return{data:await It(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(_t(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await It(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:zk});if(h.error)throw h.error;const p=await h.json(),x=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(_.split(";")[1].split("=")[1]);d[`${j}Page`]=w}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(_t(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await It(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(_t(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await It(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(_t(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await It(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(_t(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await It(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(_t(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await It(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(_t(t))return{data:null,error:t};throw t}}}function Uk(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Wu={debug:!!(globalThis&&W4()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class H4 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class RV extends H4{}async function LV(n,e,t){Wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Wu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new RV(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Wu.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function FV(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Y4(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function qV(n){return parseInt(n,16)}function zV(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function UV(n){var e;const{chainId:t,domain:r,expirationTime:s,issuedAt:a=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:h,uri:p,version:x}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const v=Y4(n.address),_=h?`${h}://${r}`:r,w=n.statement?`${n.statement}
`:"",j=`${_} wants you to sign in with your Ethereum account:
${v}

${w}`;let T=`URI: ${p}
Version: ${x}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(s&&(T+=`
Expiration Time: ${s.toISOString()}`),l&&(T+=`
Not Before: ${l.toISOString()}`),c&&(T+=`
Request ID: ${c}`),d){let P=`
Resources:`;for(const E of d){if(!E||typeof E!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${E}`);P+=`
- ${E}`}T+=P}return`${j}
${T}`}class gr extends Error{constructor({message:e,code:t,cause:r,name:s}){var a;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(a=s??(r instanceof Error?r.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=t}}class fx extends gr{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function VV({error:n,options:e}){var t,r,s;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new gr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=a.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new gr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((r=a.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new gr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new gr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new gr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new gr({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new gr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new gr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(G4(o)){if(a.rp.id!==o)return new gr({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new gr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new gr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new gr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new gr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function BV({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new gr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new gr({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const r=window.location.hostname;if(G4(r)){if(t.rpId!==r)return new gr({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new gr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new gr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new gr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class WV{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const $V=new WV;function HV(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:r}=n,s=Af(n,["challenge","user","excludeCredentials"]),a=lf(e).buffer,o=Object.assign(Object.assign({},t),{id:lf(t.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:a,user:o});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const d=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:lf(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function YV(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,r=Af(n,["challenge","allowCredentials"]),s=lf(e).buffer,a=Object.assign(Object.assign({},r),{challenge:s});if(t&&t.length>0){a.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const l=t[o];a.allowCredentials[o]=Object.assign(Object.assign({},l),{id:lf(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function GV(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:eu(new Uint8Array(n.response.attestationObject)),clientDataJSON:eu(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function ZV(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,r=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:eu(new Uint8Array(s.authenticatorData)),clientDataJSON:eu(new Uint8Array(s.clientDataJSON)),signature:eu(new Uint8Array(s.signature)),userHandle:s.userHandle?eu(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function G4(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Vk(){var n,e;return!!(Wr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function KV(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new fx("Browser returned unexpected credential type",e)}:{data:null,error:new fx("Empty credential response",e)}}catch(e){return{data:null,error:VV({error:e,options:n})}}}async function JV(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new fx("Browser returned unexpected credential type",e)}:{data:null,error:new fx("Empty credential response",e)}}catch(e){return{data:null,error:BV({error:e,options:n})}}}const QV={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},XV={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function hx(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of n)if(s)for(const a in s){const o=s[a];if(o!==void 0)if(Array.isArray(o))r[a]=o;else if(t(o))r[a]=o;else if(e(o)){const l=r[a];e(l)?r[a]=hx(l,o):r[a]=hx(o)}else r[a]=o}return r}function eB(n,e){return hx(QV,n,e||{})}function tB(n,e){return hx(XV,n,e||{})}class nB{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},a){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:l};const c=s??$V.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=eB(o.webauthn.credential_options.publicKey,a?.create),{data:h,error:p}=await KV({publicKey:d,signal:c});return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}case"request":{const d=tB(o.webauthn.credential_options.publicKey,a?.request),{data:h,error:p}=await JV(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:c}));return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}}}catch(o){return _t(o)?{data:null,error:o}:{data:null,error:new Xd("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new tm("rpId is required for WebAuthn authentication")};try{if(!Vk())return{data:null,error:new Xd("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:a});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:r,credential_response:c.credential_response}})}catch(o){return _t(o)?{data:null,error:o}:{data:null,error:new Xd("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new tm("rpId is required for WebAuthn registration")};try{if(!Vk())return{data:null,error:new Xd("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(h=>{var p;return(p=h.data)===null||p===void 0?void 0:p.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:a});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return _t(o)?{data:null,error:o}:{data:null,error:new Xd("Unexpected error in register",o)}}}}FV();const rB={url:XU,storageKey:eV,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tV,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Bk(n,e,t){return await t()}const $u={};class nm{get jwks(){var e,t;return(t=(e=$u[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){$u[this.storageKey]=Object.assign(Object.assign({},$u[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=$u[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){$u[this.storageKey]=Object.assign(Object.assign({},$u[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},rB),e);if(this.storageKey=a.storageKey,this.instanceID=(t=nm.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,nm.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&Wr()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new AV({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=$4(a.fetch),this.lock=a.lock||Bk,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:Wr()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=LV:this.lock=Bk,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new nB(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:W4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Uk(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Uk(this.memoryStorage)),Wr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${U4}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},r="none";if(Wr()&&(t=pV(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),Wr()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),oV(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return _t(t)?this._returnResult({error:t}):this._returnResult({error:new Xd("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const a=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:ba}),{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(_t(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,r,s;try{let a;if("email"in e){const{email:h,password:p,options:x}=e;let v=null,_=null;this.flowType==="pkce"&&([v,_]=await Vu(this.storage,this.storageKey)),a=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:h,password:p,data:(t=x?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:v,code_challenge_method:_},xform:ba})}else if("phone"in e){const{phone:h,password:p,options:x}=e;a=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:p,data:(r=x?.data)!==null&&r!==void 0?r:{},channel:(s=x?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:ba})}else throw new Dp("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(_t(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:l}=e;t=await It(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:qk})}else if("phone"in e){const{phone:a,password:o,options:l}=e;t=await It(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:qk})}else throw new Dp("You must provide either an email or phone number and a password");const{data:r,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const a=new Uu;return this._returnResult({data:{user:null,session:null},error:a})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(_t(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,a,o,l,c,d,h,p,x;let v,_;if("message"in e)v=e.message,_=e.signature;else{const{chain:w,wallet:j,statement:T,options:P}=e;let E;if(Wr())if(typeof j=="object")E=j;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")E=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!P?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=j}const M=new URL((t=P?.url)!==null&&t!==void 0?t:window.location.href),O=await E.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=Y4(O[0]);let q=(r=P?.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!q){const B=await E.request({method:"eth_chainId"});q=qV(B)}const F={domain:M.host,address:I,statement:T,uri:M.href,version:"1",chainId:q,nonce:(s=P?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(a=P?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=P?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=P?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=P?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(h=P?.signInWithEthereum)===null||h===void 0?void 0:h.resources};v=UV(F),_=await E.request({method:"personal_sign",params:[zV(v),I]})}try{const{data:w,error:j}=await It(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:_},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:ba});if(j)throw j;if(!w||!w.session||!w.user){const T=new Uu;return this._returnResult({data:{user:null,session:null},error:T})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:j})}catch(w){if(_t(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var t,r,s,a,o,l,c,d,h,p,x,v;let _,w;if("message"in e)_=e.message,w=e.signature;else{const{chain:j,wallet:T,statement:P,options:E}=e;let M;if(Wr())if(typeof T=="object")M=T;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))M=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!E?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=T}const O=new URL((t=E?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in M&&M.signIn){const I=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E?.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),P?{statement:P}:null));let q;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")q=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)q=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in q&&"signature"in q&&(typeof q.signedMessage=="string"||q.signedMessage instanceof Uint8Array)&&q.signature instanceof Uint8Array)_=typeof q.signedMessage=="string"?q.signedMessage:new TextDecoder().decode(q.signedMessage),w=q.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${O.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...P?["",P,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(s=(r=E?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=E?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((o=E?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((l=E?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((c=E?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((d=E?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((p=(h=E?.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||p===void 0)&&p.length?["Resources",...E.signInWithSolana.resources.map(q=>`- ${q}`)]:[]].join(`
`);const I=await M.signMessage(new TextEncoder().encode(_),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=I}}try{const{data:j,error:T}=await It(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:eu(w)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:ba});if(T)throw T;if(!j||!j.session||!j.user){const P=new Uu;return this._returnResult({data:{user:null,session:null},error:P})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:T})}catch(j){if(_t(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async _exchangeCodeForSession(e){const t=await Fd(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:a,error:o}=await It(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ba});if(await _c(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const l=new Uu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(_t(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:a,nonce:o}=e,l=await It(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:ba}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const h=new Uu;return this._returnResult({data:{user:null,session:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(t){if(_t(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,s,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Vu(this.storage,this.storageKey));const{error:p}=await It(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c?.data)!==null&&t!==void 0?t:{},create_user:(r=c?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:h}=await It(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(a=c?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(o=c?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:h})}throw new Dp("You must provide either an email or phone number.")}catch(l){if(_t(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,r;try{let s,a;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await It(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:ba});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(_t(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,r,s,a,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Vu(this.storage,this.storageKey));const d=await It(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:EV});return!((a=d.data)===null||a===void 0)&&a.url&&Wr()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(_t(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new va;const{error:s}=await It(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(_t(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:a}=e,{error:o}=await It(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:s,options:a}=e,{data:o,error:l}=await It(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new Dp("You must provide either an email or phone number and a type")}catch(t){if(_t(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Fd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Kv:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Fd(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Xv()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=kV(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await It(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Dc}):await this._useSession(async t=>{var r,s,a;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new va}:await It(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Dc})})}catch(t){if(_t(t))return aV(t)&&(await this._removeSession(),await _c(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new va;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Vu(this.storage,this.storageKey));const{data:d,error:h}=await It(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Dc});if(h)throw h;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(_t(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new va;const t=Date.now()/1e3;let r=t,s=!0,a=null;const{payload:o}=Qv(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(_t(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new va;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(_t(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Wr())throw new Ep("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ep(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Ek("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ep("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ek("No code detected.");const{data:P,error:E}=await this._exchangeCodeForSession(e.code);if(E)throw E;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new Ep("No session defined in URL");const h=Math.round(Date.now()/1e3),p=parseInt(l);let x=h+p;c&&(x=parseInt(c));const v=x-h;v*1e3<=ef&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${p}s`);const _=x-p;h-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,x,h):h-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,x,h);const{data:w,error:j}=await this._getUser(a);if(j)throw j;const T={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:p,expires_at:x,refresh_token:o,token_type:d,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:e.type},error:null})}catch(r){if(_t(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Fd(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({error:a});const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(iV(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await _c(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=mV(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:a},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Vu(this.storage,this.storageKey,!0));try{return await It(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(_t(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(_t(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:s}=await this._useSession(async a=>{var o,l,c,d,h;const{data:p,error:x}=a;if(x)throw x;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await It(this.fetch,"GET",v,{headers:this.headers,jwt:(h=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return Wr()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),this._returnResult({data:{provider:e.provider,url:r?.url},error:null})}catch(r){if(_t(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:s,data:{session:a}}=t;if(s)throw s;const{options:o,provider:l,token:c,access_token:d,nonce:h}=e,p=await It(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=a?.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:d,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:ba}),{data:x,error:v}=p;return v?this._returnResult({data:{user:null,session:null},error:v}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Uu}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:v}))}catch(s){if(_t(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:o}=t;if(o)throw o;return await It(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(_t(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await yV(async s=>(s>0&&await xV(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await It(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ba})),(s,a)=>{const o=200*Math.pow(2,s);return a&&Jv(a)&&Date.now()+o-r<ef})}catch(r){if(this._debug(t,"error",r),_t(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Wr()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Fd(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Fd(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await tf(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:Xv()}else if(s&&!s.user&&!s.user){const o=await Fd(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await _c(this.storage,this.storageKey+"-user"),await tf(this.storage,this.storageKey,s)):s.user=Xv()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const a=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Kv;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${Kv}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Jv(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new va;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new $x;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new va;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),_t(a)){const o={data:null,error:a};return Jv(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await tf(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const a=Lk(s);await tf(this.storage,this.storageKey,a)}else{const s=Lk(t);await tf(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await _c(this.storage,this.storageKey),await _c(this.storage,this.storageKey+"-code-verifier"),await _c(this.storage,this.storageKey+"-user"),this.userStorage&&await _c(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Wr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ef);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/ef);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${ef}ms, refresh threshold is ${HN} ticks`),s<=HN&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof H4)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Wr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,o]=await Vu(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r?.queryParams){const a=new URLSearchParams(r.queryParams);s.push(a.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;return a?this._returnResult({data:null,error:a}):await It(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(_t(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await It(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=a?.session)===null||r===void 0?void 0:r.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(_t(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?GV(e.webauthn.credential_response):ZV(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await It(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(t){if(_t(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=await It(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:HV(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:YV(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(_t(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Qv(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((t=(e=r.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await It(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new va})})}catch(t){if(_t(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new va});const o=await It(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Wr()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new va});const o=await It(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Wr()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(l=>l.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+rV>s)return r;const{data:a,error:o}=await It(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,r=a.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:v,error:_}=await this.getSession();if(_||!v.session)return this._returnResult({data:null,error:_});r=v.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=Qv(r);t?.allowExpired||SV(a.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:v}=await this.getUser(r);if(v)throw v;return{data:{claims:a,header:s,signature:o},error:null}}const h=CV(s.alg),p=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,p,o,fV(`${l}.${c}`)))throw new ZN("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}}}nm.nextInstanceID={};const sB=nm;class iB extends sB{constructor(e){super(e)}}class aB{constructor(e,t,r){var s,a,o;this.supabaseUrl=e,this.supabaseKey=t;const l=QU(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:WU,realtime:HU,auth:Object.assign(Object.assign({},$U),{storageKey:c}),global:BU},h=JU(r??{},d);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=ZU(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new Xz(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new zU(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new Zz(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:o,flowType:l,lock:c,debug:d,throwOnError:h},p,x){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new iB({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),p),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:l,lock:c,debug:d,throwOnError:h,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new gU(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const oB=(n,e,t)=>new aB(n,e,t);function lB(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}lB()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const cB="https://fmyafuhxlorbafbacywa.supabase.co",dB="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZteWFmdWh4bG9yYmFmYmFjeXdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMjg1NDYsImV4cCI6MjA3NzgwNDU0Nn0.RqsniEqzNec6ww35TXJtLJD3mafnGbMI82om4XRUdUU",uB=cB,fB=dB,Me=oB(uB,fB,{auth:{persistSession:!0,storage:window.localStorage,autoRefreshToken:!0,detectSessionInUrl:!0},global:{multiTab:!1}}),hB=async n=>{try{let{data:e,error:t}=await Me.from("users").select("*, role_id").eq("id",n.id).single();if(t&&t.code==="PGRST116"){const r={id:n.id,name:n.user_metadata.name||"New User",email:n.email,role_id:"unverified"},{data:s,error:a}=await Me.from("users").insert(r).select("*, role_id").single();if(a)return console.error("Error creating user profile on-the-fly:",a.message,a),null;e=s,t=null}return t?(console.error("Error fetching app profile:",t.message,t),null):{id:e.id,name:e.name,email:n.email||"",phone:e.phone,role:e.role_id,organizationId:e.organization_id,organizationName:e.organization_name,reportingManagerId:e.reporting_manager_id,photoUrl:e.photo_url}}catch(e){return console.error("Exception fetching profile:",e),null}},mB=async(n,e)=>await Me.auth.signInWithPassword({email:n,password:e}),pB=async n=>{const{email:e,password:t,options:r}=n;return await Me.auth.signUp({email:e,password:t,options:{...r,emailRedirectTo:`${window.location.origin}/`}})},gB=async(n,e)=>await Me.from("users").update({role_id:e}).eq("id",n),xB=async()=>await Me.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}}),yB=async()=>{const{error:n}=await Me.auth.signOut();n&&console.error("Error signing out:",n.message)},vB=async n=>{const e=window.location.origin;return await Me.auth.resetPasswordForEmail(n,{redirectTo:e})},bB=async n=>await Me.auth.updateUser({password:n}),wa={getAppUserProfile:hB,signInWithPassword:mB,signUpWithPassword:pB,signInWithGoogle:xB,signOut:yB,resetPasswordForEmail:vB,updateUserPassword:bB,approveUser:gB},_B="modulepreload",wB=function(n,e){return new URL(n,e).href},Wk={},$k=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let d=function(h){return Promise.all(h.map(p=>Promise.resolve(p).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");s=d(t.map(h=>{if(h=wB(h,r),h in Wk)return;Wk[h]=!0;const p=h.endsWith(".css"),x=p?'[rel="stylesheet"]':"";if(r)for(let _=o.length-1;_>=0;_--){const w=o[_];if(w.href===h&&(!p||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${x}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":_B,p||(v.as="script"),v.crossOrigin="",v.href=h,c&&v.setAttribute("nonce",c),document.head.appendChild(v),p)return new Promise((_,w)=>{v.addEventListener("load",_),v.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function Lt(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function zn(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function gl(n,e){const t=Lt(n);return isNaN(e)?zn(n,NaN):(e&&t.setDate(t.getDate()+e),t)}function Hx(n,e){const t=Lt(n);if(isNaN(e))return zn(n,NaN);if(!e)return t;const r=t.getDate(),s=zn(n,t.getTime());s.setMonth(t.getMonth()+e+1,0);const a=s.getDate();return r>=a?s:(t.setFullYear(s.getFullYear(),s.getMonth(),r),t)}const Z4=6048e5,jB=864e5,K4=6e4,NB=36e5,SB=1e3,Op=43200,Hk=1440;let CB={};function Yc(){return CB}function No(n,e){const t=Yc(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=Lt(n),a=s.getDay(),o=(a<r?7:0)+a-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function yf(n){return No(n,{weekStartsOn:1})}function J4(n){const e=Lt(n),t=e.getFullYear(),r=zn(n,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const s=yf(r),a=zn(n,0);a.setFullYear(t,0,4),a.setHours(0,0,0,0);const o=yf(a);return e.getTime()>=s.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function zc(n){const e=Lt(n);return e.setHours(0,0,0,0),e}function vf(n){const e=Lt(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function jm(n,e){const t=zc(n),r=zc(e),s=+t-vf(t),a=+r-vf(r);return Math.round((s-a)/jB)}function TB(n){const e=J4(n),t=zn(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),yf(t)}function Kg(n,e){const t=Lt(n),r=Lt(e),s=t.getTime()-r.getTime();return s<0?-1:s>0?1:s}function kB(n){return zn(n,Date.now())}function cf(n,e){const t=zc(n),r=zc(e);return+t==+r}function PB(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function MB(n){if(!PB(n)&&typeof n!="number")return!1;const e=Lt(n);return!isNaN(Number(e))}function DB(n,e){const t=Lt(n),r=Lt(e),s=t.getFullYear()-r.getFullYear(),a=t.getMonth()-r.getMonth();return s*12+a}function EB(n,e){const t=Lt(n),r=Lt(e),s=Yk(t,r),a=Math.abs(jm(t,r));t.setDate(t.getDate()-s*a);const o=+(Yk(t,r)===-s),l=s*(a-o);return l===0?0:l}function Yk(n,e){const t=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function Q4(n){return e=>{const r=(n?Math[n]:Math.trunc)(e);return r===0?0:r}}function X4(n,e){return+Lt(n)-+Lt(e)}function df(n,e,t){const r=X4(n,e)/K4;return Q4(t?.roundingMethod)(r)}function aC(n){const e=Lt(n);return e.setHours(23,59,59,999),e}function Ca(n){const e=Lt(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function OB(n){const e=Lt(n);return+aC(e)==+Ca(e)}function IB(n,e){const t=Lt(n),r=Lt(e),s=Kg(t,r),a=Math.abs(DB(t,r));let o;if(a<1)o=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-s*a);let l=Kg(t,r)===-s;OB(Lt(n))&&a===1&&Kg(n,r)===1&&(l=!1),o=s*(a-Number(l))}return o===0?0:o}function AB(n,e,t){const r=X4(n,e)/1e3;return Q4(t?.roundingMethod)(r)}function go(n,e){const t=Lt(n.start),r=Lt(n.end);let s=+t>+r;const a=s?+t:+r,o=s?r:t;o.setHours(0,0,0,0);let l=1;const c=[];for(;+o<=a;)c.push(Lt(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return s?c.reverse():c}function mi(n){const e=Lt(n);return e.setDate(1),e.setHours(0,0,0,0),e}function RB(n){const e=Lt(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function eF(n){const e=Lt(n),t=zn(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function Gk(n,e){const t=Yc(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=Lt(n),a=s.getDay(),o=(a<r?-7:0)+6-(a-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function tb(){return aC(Date.now())}const LB={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},FB=(n,e,t)=>{let r;const s=LB[n];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function nb(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const qB={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},zB={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},UB={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},VB={date:nb({formats:qB,defaultWidth:"full"}),time:nb({formats:zB,defaultWidth:"full"}),dateTime:nb({formats:UB,defaultWidth:"full"})},BB={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},WB=(n,e,t,r)=>BB[n];function fh(n){return(e,t)=>{const r=t?.context?String(t.context):"standalone";let s;if(r==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,l=t?.width?String(t.width):o;s=n.formattingValues[l]||n.formattingValues[o]}else{const o=n.defaultWidth,l=t?.width?String(t.width):n.defaultWidth;s=n.values[l]||n.values[o]}const a=n.argumentCallback?n.argumentCallback(e):e;return s[a]}}const $B={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},HB={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},YB={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},GB={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ZB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},KB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},JB=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},QB={ordinalNumber:JB,era:fh({values:$B,defaultWidth:"wide"}),quarter:fh({values:HB,defaultWidth:"wide",argumentCallback:n=>n-1}),month:fh({values:YB,defaultWidth:"wide"}),day:fh({values:GB,defaultWidth:"wide"}),dayPeriod:fh({values:ZB,defaultWidth:"wide",formattingValues:KB,defaultFormattingWidth:"wide"})};function hh(n){return(e,t={})=>{const r=t.width,s=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],a=e.match(s);if(!a)return null;const o=a[0],l=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(l)?eW(l,p=>p.test(o)):XB(l,p=>p.test(o));let d;d=n.valueCallback?n.valueCallback(c):c,d=t.valueCallback?t.valueCallback(d):d;const h=e.slice(o.length);return{value:d,rest:h}}}function XB(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function eW(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function tW(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const s=r[0],a=e.match(n.parsePattern);if(!a)return null;let o=n.valueCallback?n.valueCallback(a[0]):a[0];o=t.valueCallback?t.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const nW=/^(\d+)(th|st|nd|rd)?/i,rW=/\d+/i,sW={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},iW={any:[/^b/i,/^(a|c)/i]},aW={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},oW={any:[/1/i,/2/i,/3/i,/4/i]},lW={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},cW={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},dW={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},uW={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},fW={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},hW={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},mW={ordinalNumber:tW({matchPattern:nW,parsePattern:rW,valueCallback:n=>parseInt(n,10)}),era:hh({matchPatterns:sW,defaultMatchWidth:"wide",parsePatterns:iW,defaultParseWidth:"any"}),quarter:hh({matchPatterns:aW,defaultMatchWidth:"wide",parsePatterns:oW,defaultParseWidth:"any",valueCallback:n=>n+1}),month:hh({matchPatterns:lW,defaultMatchWidth:"wide",parsePatterns:cW,defaultParseWidth:"any"}),day:hh({matchPatterns:dW,defaultMatchWidth:"wide",parsePatterns:uW,defaultParseWidth:"any"}),dayPeriod:hh({matchPatterns:fW,defaultMatchWidth:"any",parsePatterns:hW,defaultParseWidth:"any"})},oC={code:"en-US",formatDistance:FB,formatLong:VB,formatRelative:WB,localize:QB,match:mW,options:{weekStartsOn:0,firstWeekContainsDate:1}};function pW(n){const e=Lt(n);return jm(e,eF(e))+1}function tF(n){const e=Lt(n),t=+yf(e)-+TB(e);return Math.round(t/Z4)+1}function lC(n,e){const t=Lt(n),r=t.getFullYear(),s=Yc(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=zn(n,0);o.setFullYear(r+1,0,a),o.setHours(0,0,0,0);const l=No(o,e),c=zn(n,0);c.setFullYear(r,0,a),c.setHours(0,0,0,0);const d=No(c,e);return t.getTime()>=l.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function gW(n,e){const t=Yc(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,s=lC(n,e),a=zn(n,0);return a.setFullYear(s,0,r),a.setHours(0,0,0,0),No(a,e)}function nF(n,e){const t=Lt(n),r=+No(t,e)-+gW(t,e);return Math.round(r/Z4)+1}function _n(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const wc={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return _n(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):_n(t+1,2)},d(n,e){return _n(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return _n(n.getHours()%12||12,e.length)},H(n,e){return _n(n.getHours(),e.length)},m(n,e){return _n(n.getMinutes(),e.length)},s(n,e){return _n(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),s=Math.trunc(r*Math.pow(10,t-3));return _n(s,e.length)}},Hu={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Zk={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),s=r>0?r:1-r;return t.ordinalNumber(s,{unit:"year"})}return wc.y(n,e)},Y:function(n,e,t,r){const s=lC(n,r),a=s>0?s:1-s;if(e==="YY"){const o=a%100;return _n(o,2)}return e==="Yo"?t.ordinalNumber(a,{unit:"year"}):_n(a,e.length)},R:function(n,e){const t=J4(n);return _n(t,e.length)},u:function(n,e){const t=n.getFullYear();return _n(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return _n(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return _n(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return wc.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return _n(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const s=nF(n,r);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):_n(s,e.length)},I:function(n,e,t){const r=tF(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):_n(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):wc.d(n,e)},D:function(n,e,t){const r=pW(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):_n(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const s=n.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return _n(a,2);case"eo":return t.ordinalNumber(a,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const s=n.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return _n(a,e.length);case"co":return t.ordinalNumber(a,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return _n(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const s=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let s;switch(r===12?s=Hu.noon:r===0?s=Hu.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let s;switch(r>=17?s=Hu.evening:r>=12?s=Hu.afternoon:r>=4?s=Hu.morning:s=Hu.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return wc.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):wc.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):_n(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):_n(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):wc.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):wc.s(n,e)},S:function(n,e){return wc.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return Jk(r);case"XXXX":case"XX":return Gd(r);case"XXXXX":case"XXX":default:return Gd(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return Jk(r);case"xxxx":case"xx":return Gd(r);case"xxxxx":case"xxx":default:return Gd(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Kk(r,":");case"OOOO":default:return"GMT"+Gd(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Kk(r,":");case"zzzz":default:return"GMT"+Gd(r,":")}},t:function(n,e,t){const r=Math.trunc(n.getTime()/1e3);return _n(r,e.length)},T:function(n,e,t){const r=n.getTime();return _n(r,e.length)}};function Kk(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Math.trunc(r/60),a=r%60;return a===0?t+String(s):t+String(s)+e+_n(a,2)}function Jk(n,e){return n%60===0?(n>0?"-":"+")+_n(Math.abs(n)/60,2):Gd(n,e)}function Gd(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=_n(Math.trunc(r/60),2),a=_n(r%60,2);return t+s+e+a}const Qk=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},rF=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},xW=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],s=t[2];if(!s)return Qk(n,e);let a;switch(r){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",Qk(r,e)).replace("{{time}}",rF(s,e))},KN={p:rF,P:xW},yW=/^D+$/,vW=/^Y+$/,bW=["D","DD","YY","YYYY"];function sF(n){return yW.test(n)}function iF(n){return vW.test(n)}function JN(n,e,t){const r=_W(n,e,t);if(console.warn(r),bW.includes(n))throw new RangeError(r)}function _W(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const wW=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,jW=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,NW=/^'([^]*?)'?$/,SW=/''/g,CW=/[a-zA-Z]/;function $e(n,e,t){const r=Yc(),s=r.locale??oC,a=r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,l=Lt(n);if(!MB(l))throw new RangeError("Invalid time value");let c=e.match(jW).map(h=>{const p=h[0];if(p==="p"||p==="P"){const x=KN[p];return x(h,s.formatLong)}return h}).join("").match(wW).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const p=h[0];if(p==="'")return{isToken:!1,value:TW(h)};if(Zk[p])return{isToken:!0,value:h};if(p.match(CW))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:h}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const d={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(h=>{if(!h.isToken)return h.value;const p=h.value;(iF(p)||sF(p))&&JN(p,e,String(n));const x=Zk[p[0]];return x(l,p,s.localize,d)}).join("")}function TW(n){const e=n.match(NW);return e?e[1].replace(SW,"'"):n}function kW(n,e,t){const r=Yc(),s=t?.locale??r.locale??oC,a=2520,o=Kg(n,e);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:o});let c,d;o>0?(c=Lt(e),d=Lt(n)):(c=Lt(n),d=Lt(e));const h=AB(d,c),p=(vf(d)-vf(c))/1e3,x=Math.round((h-p)/60);let v;if(x<2)return t?.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,l):h<10?s.formatDistance("lessThanXSeconds",10,l):h<20?s.formatDistance("lessThanXSeconds",20,l):h<40?s.formatDistance("halfAMinute",0,l):h<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):x===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",x,l);if(x<45)return s.formatDistance("xMinutes",x,l);if(x<90)return s.formatDistance("aboutXHours",1,l);if(x<Hk){const _=Math.round(x/60);return s.formatDistance("aboutXHours",_,l)}else{if(x<a)return s.formatDistance("xDays",1,l);if(x<Op){const _=Math.round(x/Hk);return s.formatDistance("xDays",_,l)}else if(x<Op*2)return v=Math.round(x/Op),s.formatDistance("aboutXMonths",v,l)}if(v=IB(d,c),v<12){const _=Math.round(x/Op);return s.formatDistance("xMonths",_,l)}else{const _=v%12,w=Math.trunc(v/12);return _<3?s.formatDistance("aboutXYears",w,l):_<9?s.formatDistance("overXYears",w,l):s.formatDistance("almostXYears",w+1,l)}}function ou(n,e){return kW(n,kB(n),e)}function cC(n){return Lt(n).getDay()}function PW(){return Object.assign({},Yc())}function MW(n){let t=Lt(n).getDay();return t===0&&(t=7),t}function DW(n,e){const t=Lt(n),r=Lt(e);return t.getTime()>r.getTime()}function EW(n,e){const t=e instanceof Date?zn(e,0):new e(0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),t}const OW=10;let aF=class{subPriority=0;validate(e,t){return!0}};class IW extends aF{constructor(e,t,r,s,a){super(),this.value=e,this.validateValue=t,this.setValue=r,this.priority=s,a&&(this.subPriority=a)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,r){return this.setValue(e,t,this.value,r)}}class AW extends aF{priority=OW;subPriority=-1;set(e,t){return t.timestampIsSet?e:zn(e,EW(e,Date))}}let mn=class{run(e,t,r,s){const a=this.parse(e,t,r,s);return a?{setter:new IW(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(e,t,r){return!0}},RW=class extends mn{priority=140;parse(e,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"});case"GGGGG":return r.era(e,{width:"narrow"});case"GGGG":default:return r.era(e,{width:"wide"})||r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"})}}set(e,t,r){return t.era=r,e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]};const ar={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},xo={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function or(n,e){return n&&{value:e(n.value),rest:n.rest}}function Qn(n,e){const t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function yo(n,e){const t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const r=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,a=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:r*(s*NB+a*K4+o*SB),rest:e.slice(t[0].length)}}function oF(n){return Qn(ar.anyDigitsSigned,n)}function nr(n,e){switch(n){case 1:return Qn(ar.singleDigit,e);case 2:return Qn(ar.twoDigits,e);case 3:return Qn(ar.threeDigits,e);case 4:return Qn(ar.fourDigits,e);default:return Qn(new RegExp("^\\d{1,"+n+"}"),e)}}function mx(n,e){switch(n){case 1:return Qn(ar.singleDigitSigned,e);case 2:return Qn(ar.twoDigitsSigned,e);case 3:return Qn(ar.threeDigitsSigned,e);case 4:return Qn(ar.fourDigitsSigned,e);default:return Qn(new RegExp("^-?\\d{1,"+n+"}"),e)}}function dC(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function lF(n,e){const t=e>0,r=t?e:1-e;let s;if(r<=50)s=n||100;else{const a=r+50,o=Math.trunc(a/100)*100,l=n>=a%100;s=n+o-(l?100:0)}return t?s:1-s}function cF(n){return n%400===0||n%4===0&&n%100!==0}let LW=class extends mn{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,t,r){const s=a=>({year:a,isTwoDigitYear:t==="yy"});switch(t){case"y":return or(nr(4,e),s);case"yo":return or(r.ordinalNumber(e,{unit:"year"}),s);default:return or(nr(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r){const s=e.getFullYear();if(r.isTwoDigitYear){const o=lF(r.year,s);return e.setFullYear(o,0,1),e.setHours(0,0,0,0),e}const a=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}},FW=class extends mn{priority=130;parse(e,t,r){const s=a=>({year:a,isTwoDigitYear:t==="YY"});switch(t){case"Y":return or(nr(4,e),s);case"Yo":return or(r.ordinalNumber(e,{unit:"year"}),s);default:return or(nr(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r,s){const a=lC(e,s);if(r.isTwoDigitYear){const l=lF(r.year,a);return e.setFullYear(l,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),No(e,s)}const o=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(o,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),No(e,s)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},qW=class extends mn{priority=130;parse(e,t){return mx(t==="R"?4:t.length,e)}set(e,t,r){const s=zn(e,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),yf(s)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},zW=class extends mn{priority=130;parse(e,t){return mx(t==="u"?4:t.length,e)}set(e,t,r){return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]},UW=class extends mn{priority=120;parse(e,t,r){switch(t){case"Q":case"QQ":return nr(t.length,e);case"Qo":return r.ordinalNumber(e,{unit:"quarter"});case"QQQ":return r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(e,{width:"wide",context:"formatting"})||r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},VW=class extends mn{priority=120;parse(e,t,r){switch(t){case"q":case"qq":return nr(t.length,e);case"qo":return r.ordinalNumber(e,{unit:"quarter"});case"qqq":return r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(e,{width:"wide",context:"standalone"})||r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},BW=class extends mn{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,t,r){const s=a=>a-1;switch(t){case"M":return or(Qn(ar.month,e),s);case"MM":return or(nr(2,e),s);case"Mo":return or(r.ordinalNumber(e,{unit:"month"}),s);case"MMM":return r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(e,{width:"wide",context:"formatting"})||r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}},WW=class extends mn{priority=110;parse(e,t,r){const s=a=>a-1;switch(t){case"L":return or(Qn(ar.month,e),s);case"LL":return or(nr(2,e),s);case"Lo":return or(r.ordinalNumber(e,{unit:"month"}),s);case"LLL":return r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(e,{width:"wide",context:"standalone"})||r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};function $W(n,e,t){const r=Lt(n),s=nF(r,t)-e;return r.setDate(r.getDate()-s*7),r}let HW=class extends mn{priority=100;parse(e,t,r){switch(t){case"w":return Qn(ar.week,e);case"wo":return r.ordinalNumber(e,{unit:"week"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r,s){return No($W(e,r,s),s)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};function YW(n,e){const t=Lt(n),r=tF(t)-e;return t.setDate(t.getDate()-r*7),t}let GW=class extends mn{priority=100;parse(e,t,r){switch(t){case"I":return Qn(ar.week,e);case"Io":return r.ordinalNumber(e,{unit:"week"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r){return yf(YW(e,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};const ZW=[31,28,31,30,31,30,31,31,30,31,30,31],KW=[31,29,31,30,31,30,31,31,30,31,30,31];let JW=class extends mn{priority=90;subPriority=1;parse(e,t,r){switch(t){case"d":return Qn(ar.date,e);case"do":return r.ordinalNumber(e,{unit:"date"});default:return nr(t.length,e)}}validate(e,t){const r=e.getFullYear(),s=cF(r),a=e.getMonth();return s?t>=1&&t<=KW[a]:t>=1&&t<=ZW[a]}set(e,t,r){return e.setDate(r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]},QW=class extends mn{priority=90;subpriority=1;parse(e,t,r){switch(t){case"D":case"DD":return Qn(ar.dayOfYear,e);case"Do":return r.ordinalNumber(e,{unit:"date"});default:return nr(t.length,e)}}validate(e,t){const r=e.getFullYear();return cF(r)?t>=1&&t<=366:t>=1&&t<=365}set(e,t,r){return e.setMonth(0,r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};function uC(n,e,t){const r=Yc(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=Lt(n),o=a.getDay(),c=(e%7+7)%7,d=7-s,h=e<0||e>6?e-(o+d)%7:(c+d)%7-(o+d)%7;return gl(a,h)}let XW=class extends mn{priority=90;parse(e,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=uC(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]},e$=class extends mn{priority=90;parse(e,t,r,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(t){case"e":case"ee":return or(nr(t.length,e),a);case"eo":return or(r.ordinalNumber(e,{unit:"day"}),a);case"eee":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeeee":return r.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=uC(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},t$=class extends mn{priority=90;parse(e,t,r,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(t){case"c":case"cc":return or(nr(t.length,e),a);case"co":return or(r.ordinalNumber(e,{unit:"day"}),a);case"ccc":return r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"ccccc":return r.day(e,{width:"narrow",context:"standalone"});case"cccccc":return r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(e,{width:"wide",context:"standalone"})||r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=uC(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};function n$(n,e){const t=Lt(n),r=MW(t),s=e-r;return gl(t,s)}let r$=class extends mn{priority=90;parse(e,t,r){const s=a=>a===0?7:a;switch(t){case"i":case"ii":return nr(t.length,e);case"io":return r.ordinalNumber(e,{unit:"day"});case"iii":return or(r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s);case"iiiii":return or(r.day(e,{width:"narrow",context:"formatting"}),s);case"iiiiii":return or(r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s);case"iiii":default:return or(r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s)}}validate(e,t){return t>=1&&t<=7}set(e,t,r){return e=n$(e,r),e.setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},s$=class extends mn{priority=80;parse(e,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(dC(r),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]},i$=class extends mn{priority=80;parse(e,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(dC(r),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]},a$=class extends mn{priority=80;parse(e,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(dC(r),0,0,0),e}incompatibleTokens=["a","b","t","T"]},o$=class extends mn{priority=70;parse(e,t,r){switch(t){case"h":return Qn(ar.hour12h,e);case"ho":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,r){const s=e.getHours()>=12;return s&&r<12?e.setHours(r+12,0,0,0):!s&&r===12?e.setHours(0,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]},l$=class extends mn{priority=70;parse(e,t,r){switch(t){case"H":return Qn(ar.hour23h,e);case"Ho":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,r){return e.setHours(r,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]},c$=class extends mn{priority=70;parse(e,t,r){switch(t){case"K":return Qn(ar.hour11h,e);case"Ko":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.getHours()>=12&&r<12?e.setHours(r+12,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]},d$=class extends mn{priority=70;parse(e,t,r){switch(t){case"k":return Qn(ar.hour24h,e);case"ko":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,r){const s=r<=24?r%24:r;return e.setHours(s,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]},u$=class extends mn{priority=60;parse(e,t,r){switch(t){case"m":return Qn(ar.minute,e);case"mo":return r.ordinalNumber(e,{unit:"minute"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setMinutes(r,0,0),e}incompatibleTokens=["t","T"]},f$=class extends mn{priority=50;parse(e,t,r){switch(t){case"s":return Qn(ar.second,e);case"so":return r.ordinalNumber(e,{unit:"second"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setSeconds(r,0),e}incompatibleTokens=["t","T"]},h$=class extends mn{priority=30;parse(e,t){const r=s=>Math.trunc(s*Math.pow(10,-t.length+3));return or(nr(t.length,e),r)}set(e,t,r){return e.setMilliseconds(r),e}incompatibleTokens=["t","T"]},m$=class extends mn{priority=10;parse(e,t){switch(t){case"X":return yo(xo.basicOptionalMinutes,e);case"XX":return yo(xo.basic,e);case"XXXX":return yo(xo.basicOptionalSeconds,e);case"XXXXX":return yo(xo.extendedOptionalSeconds,e);case"XXX":default:return yo(xo.extended,e)}}set(e,t,r){return t.timestampIsSet?e:zn(e,e.getTime()-vf(e)-r)}incompatibleTokens=["t","T","x"]},p$=class extends mn{priority=10;parse(e,t){switch(t){case"x":return yo(xo.basicOptionalMinutes,e);case"xx":return yo(xo.basic,e);case"xxxx":return yo(xo.basicOptionalSeconds,e);case"xxxxx":return yo(xo.extendedOptionalSeconds,e);case"xxx":default:return yo(xo.extended,e)}}set(e,t,r){return t.timestampIsSet?e:zn(e,e.getTime()-vf(e)-r)}incompatibleTokens=["t","T","X"]},g$=class extends mn{priority=40;parse(e){return oF(e)}set(e,t,r){return[zn(e,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"},x$=class extends mn{priority=20;parse(e){return oF(e)}set(e,t,r){return[zn(e,r),{timestampIsSet:!0}]}incompatibleTokens="*"};const y$={G:new RW,y:new LW,Y:new FW,R:new qW,u:new zW,Q:new UW,q:new VW,M:new BW,L:new WW,w:new HW,I:new GW,d:new JW,D:new QW,E:new XW,e:new e$,c:new t$,i:new r$,a:new s$,b:new i$,B:new a$,h:new o$,H:new l$,K:new c$,k:new d$,m:new u$,s:new f$,S:new h$,X:new m$,x:new p$,t:new g$,T:new x$},v$=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,b$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,_$=/^'([^]*?)'?$/,w$=/''/g,j$=/\S/,N$=/[a-zA-Z]/;function S$(n,e,t,r){const s=PW(),a=s.locale??oC,o=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,l=s.weekStartsOn??s.locale?.options?.weekStartsOn??0;if(e==="")return n===""?Lt(t):zn(t,NaN);const c={firstWeekContainsDate:o,weekStartsOn:l,locale:a},d=[new AW],h=e.match(b$).map(w=>{const j=w[0];if(j in KN){const T=KN[j];return T(w,a.formatLong)}return w}).join("").match(v$),p=[];for(let w of h){iF(w)&&JN(w,e,n),sF(w)&&JN(w,e,n);const j=w[0],T=y$[j];if(T){const{incompatibleTokens:P}=T;if(Array.isArray(P)){const M=p.find(O=>P.includes(O.token)||O.token===j);if(M)throw new RangeError(`The format string mustn't contain \`${M.fullToken}\` and \`${w}\` at the same time`)}else if(T.incompatibleTokens==="*"&&p.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);p.push({token:j,fullToken:w});const E=T.run(n,w,a.match,c);if(!E)return zn(t,NaN);d.push(E.setter),n=E.rest}else{if(j.match(N$))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");if(w==="''"?w="'":j==="'"&&(w=C$(w)),n.indexOf(w)===0)n=n.slice(w.length);else return zn(t,NaN)}}if(n.length>0&&j$.test(n))return zn(t,NaN);const x=d.map(w=>w.priority).sort((w,j)=>j-w).filter((w,j,T)=>T.indexOf(w)===j).map(w=>d.filter(j=>j.priority===w).sort((j,T)=>T.subPriority-j.subPriority)).map(w=>w[0]);let v=Lt(t);if(isNaN(v.getTime()))return zn(t,NaN);const _={};for(const w of x){if(!w.validate(v,c))return zn(t,NaN);const j=w.set(v,_,c);Array.isArray(j)?(v=j[0],Object.assign(_,j[1])):v=j}return zn(t,v)}function C$(n){return n.match(_$)[1].replace(w$,"'")}function uf(n,e){return gl(n,-e)}function Jg(){return zc(Date.now())}function fC(n,e){return Hx(n,-1)}var dn;(function(n){n.assertEqual=s=>{};function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const a={};for(const o of s)a[o]=o;return a},n.getValidEnumValues=s=>{const a=n.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),o={};for(const l of a)o[l]=s[l];return n.objectValues(o)},n.objectValues=s=>n.objectKeys(s).map(function(a){return s[a]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&a.push(o);return a},n.find=(s,a)=>{for(const o of s)if(a(o))return o},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}n.joinValues=r,n.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(dn||(dn={}));var Xk;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(Xk||(Xk={}));const ft=dn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Mc=n=>{switch(typeof n){case"undefined":return ft.undefined;case"string":return ft.string;case"number":return Number.isNaN(n)?ft.nan:ft.number;case"boolean":return ft.boolean;case"function":return ft.function;case"bigint":return ft.bigint;case"symbol":return ft.symbol;case"object":return Array.isArray(n)?ft.array:n===null?ft.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?ft.promise:typeof Map<"u"&&n instanceof Map?ft.map:typeof Set<"u"&&n instanceof Set?ft.set:typeof Date<"u"&&n instanceof Date?ft.date:ft.object;default:return ft.unknown}},Qe=dn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class jl extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},r={_errors:[]},s=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let l=r,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(t(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return s(this),r}static assert(e){if(!(e instanceof jl))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,dn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];t[a]=t[a]||[],t[a].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}jl.create=n=>new jl(n);const QN=(n,e)=>{let t;switch(n.code){case Qe.invalid_type:n.received===ft.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case Qe.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,dn.jsonStringifyReplacer)}`;break;case Qe.unrecognized_keys:t=`Unrecognized key(s) in object: ${dn.joinValues(n.keys,", ")}`;break;case Qe.invalid_union:t="Invalid input";break;case Qe.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${dn.joinValues(n.options)}`;break;case Qe.invalid_enum_value:t=`Invalid enum value. Expected ${dn.joinValues(n.options)}, received '${n.received}'`;break;case Qe.invalid_arguments:t="Invalid function arguments";break;case Qe.invalid_return_type:t="Invalid function return type";break;case Qe.invalid_date:t="Invalid date";break;case Qe.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:dn.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case Qe.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case Qe.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case Qe.custom:t="Invalid input";break;case Qe.invalid_intersection_types:t="Intersection results could not be merged";break;case Qe.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case Qe.not_finite:t="Number must be finite";break;default:t=e.defaultError,dn.assertNever(n)}return{message:t}};let T$=QN;function k$(){return T$}const P$=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,a=[...t,...s.path||[]],o={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let l="";const c=r.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:e,defaultError:l}).message;return{...s,path:a,message:l}};function it(n,e){const t=k$(),r=P$({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===QN?void 0:QN].filter(s=>!!s)});n.common.issues.push(r)}class js{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return Vt;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t){const a=await s.key,o=await s.value;r.push({key:a,value:o})}return js.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:a,value:o}=s;if(a.status==="aborted"||o.status==="aborted")return Vt;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[a.value]=o.value)}return{status:e.value,value:r}}}const Vt=Object.freeze({status:"aborted"}),Lh=n=>({status:"dirty",value:n}),Zi=n=>({status:"valid",value:n}),eP=n=>n.status==="aborted",tP=n=>n.status==="dirty",bf=n=>n.status==="valid",px=n=>typeof Promise<"u"&&n instanceof Promise;var xt;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message})(xt||(xt={}));class So{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const nP=(n,e)=>{if(bf(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new jl(n.common.issues);return this._error=t,this._error}}};function Zt(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,l)=>{const{message:c}=n;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??r??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??t??l.defaultError}},description:s}}class sn{get description(){return this._def.description}_getType(e){return Mc(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Mc(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new js,ctx:{common:e.parent.common,data:e.data,parsedType:Mc(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(px(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mc(e)},s=this._parseSync({data:e,path:r.path,parent:r});return nP(r,s)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mc(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:t});return bf(r)?{value:r.value}:{issues:t.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>bf(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mc(e)},s=this._parse({data:e,path:r.path,parent:r}),a=await(px(s)?s:Promise.resolve(s));return nP(r,a)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,a)=>{const o=e(s),l=()=>a.addIssue({code:Qe.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new jf({schema:this,typeName:zt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Fc.create(this,this._def)}nullable(){return Nf.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return wo.create(this)}promise(){return bx.create(this,this._def)}or(e){return xx.create([this,e],this._def)}and(e){return yx.create(this,e,this._def)}transform(e){return new jf({...Zt(this._def),schema:this,typeName:zt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new nS({...Zt(this._def),innerType:this,defaultValue:t,typeName:zt.ZodDefault})}brand(){return new Q$({typeName:zt.ZodBranded,type:this,...Zt(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new rS({...Zt(this._def),innerType:this,catchValue:t,typeName:zt.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return hC.create(this,e)}readonly(){return sS.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const M$=/^c[^\s-]{8,}$/i,D$=/^[0-9a-z]+$/,E$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,O$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,I$=/^[a-z0-9_-]{21}$/i,A$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,R$=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,L$=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,F$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let rb;const q$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,z$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,U$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,V$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,B$=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W$=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dF="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",$$=new RegExp(`^${dF}$`);function uF(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function H$(n){return new RegExp(`^${uF(n)}$`)}function Y$(n){let e=`${dF}T${uF(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function G$(n,e){return!!((e==="v4"||!e)&&q$.test(n)||(e==="v6"||!e)&&U$.test(n))}function Z$(n,e){if(!A$.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function K$(n,e){return!!((e==="v4"||!e)&&z$.test(n)||(e==="v6"||!e)&&V$.test(n))}class vo extends sn{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ft.string){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_type,expected:ft.string,received:a.parsedType}),Vt}const r=new js;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const o=e.data.length>a.value,l=e.data.length<a.value;(o||l)&&(s=this._getOrReturnCtx(e,s),o?it(s,{code:Qe.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):l&&it(s,{code:Qe.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")L$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"email",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")rb||(rb=new RegExp(F$,"u")),rb.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"emoji",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")O$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"uuid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")I$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"nanoid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")M$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"cuid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")D$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"cuid2",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")E$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"ulid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),it(s,{validation:"url",code:Qe.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"regex",code:Qe.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?Y$(a).test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?$$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?H$(a).test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?R$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"duration",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?G$(e.data,a.version)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"ip",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?Z$(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"jwt",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?K$(e.data,a.version)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"cidr",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?B$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"base64",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?W$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"base64url",code:Qe.invalid_string,message:a.message}),r.dirty()):dn.assertNever(a);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(s=>e.test(s),{validation:t,code:Qe.invalid_string,...xt.errToObj(r)})}_addCheck(e){return new vo({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...xt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...xt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...xt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...xt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...xt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...xt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...xt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...xt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...xt.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...xt.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...xt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...xt.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...xt.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...xt.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...xt.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...xt.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...xt.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...xt.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...xt.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...xt.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...xt.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...xt.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...xt.errToObj(t)})}nonempty(e){return this.min(1,xt.errToObj(e))}trim(){return new vo({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new vo({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new vo({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}vo.create=n=>new vo({checks:[],typeName:zt.ZodString,coerce:n?.coerce??!1,...Zt(n)});function J$(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,a=Number.parseInt(n.toFixed(s).replace(".","")),o=Number.parseInt(e.toFixed(s).replace(".",""));return a%o/10**s}class lu extends sn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ft.number){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_type,expected:ft.number,received:a.parsedType}),Vt}let r;const s=new js;for(const a of this._def.checks)a.kind==="int"?dn.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?J$(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.not_finite,message:a.message}),s.dirty()):dn.assertNever(a);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,xt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,xt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,xt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,xt.toString(t))}setLimit(e,t,r,s){return new lu({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:xt.toString(s)}]})}_addCheck(e){return new lu({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:xt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:xt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:xt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:xt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:xt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:xt.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:xt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:xt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:xt.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&dn.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}lu.create=n=>new lu({checks:[],typeName:zt.ZodNumber,coerce:n?.coerce||!1,...Zt(n)});class cu extends sn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ft.bigint)return this._getInvalidInput(e);let r;const s=new js;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):dn.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return it(t,{code:Qe.invalid_type,expected:ft.bigint,received:t.parsedType}),Vt}gte(e,t){return this.setLimit("min",e,!0,xt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,xt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,xt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,xt.toString(t))}setLimit(e,t,r,s){return new cu({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:xt.toString(s)}]})}_addCheck(e){return new cu({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:xt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:xt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:xt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:xt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:xt.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}cu.create=n=>new cu({checks:[],typeName:zt.ZodBigInt,coerce:n?.coerce??!1,...Zt(n)});class gx extends sn{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ft.boolean){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.boolean,received:r.parsedType}),Vt}return Zi(e.data)}}gx.create=n=>new gx({typeName:zt.ZodBoolean,coerce:n?.coerce||!1,...Zt(n)});class _f extends sn{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ft.date){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_type,expected:ft.date,received:a.parsedType}),Vt}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_date}),Vt}const r=new js;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):dn.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new _f({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:xt.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:xt.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}_f.create=n=>new _f({checks:[],coerce:n?.coerce||!1,typeName:zt.ZodDate,...Zt(n)});class rP extends sn{_parse(e){if(this._getType(e)!==ft.symbol){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.symbol,received:r.parsedType}),Vt}return Zi(e.data)}}rP.create=n=>new rP({typeName:zt.ZodSymbol,...Zt(n)});class sP extends sn{_parse(e){if(this._getType(e)!==ft.undefined){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.undefined,received:r.parsedType}),Vt}return Zi(e.data)}}sP.create=n=>new sP({typeName:zt.ZodUndefined,...Zt(n)});class iP extends sn{_parse(e){if(this._getType(e)!==ft.null){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.null,received:r.parsedType}),Vt}return Zi(e.data)}}iP.create=n=>new iP({typeName:zt.ZodNull,...Zt(n)});class aP extends sn{constructor(){super(...arguments),this._any=!0}_parse(e){return Zi(e.data)}}aP.create=n=>new aP({typeName:zt.ZodAny,...Zt(n)});class XN extends sn{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Zi(e.data)}}XN.create=n=>new XN({typeName:zt.ZodUnknown,...Zt(n)});class Uc extends sn{_parse(e){const t=this._getOrReturnCtx(e);return it(t,{code:Qe.invalid_type,expected:ft.never,received:t.parsedType}),Vt}}Uc.create=n=>new Uc({typeName:zt.ZodNever,...Zt(n)});class oP extends sn{_parse(e){if(this._getType(e)!==ft.undefined){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.void,received:r.parsedType}),Vt}return Zi(e.data)}}oP.create=n=>new oP({typeName:zt.ZodVoid,...Zt(n)});class wo extends sn{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==ft.array)return it(t,{code:Qe.invalid_type,expected:ft.array,received:t.parsedType}),Vt;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,l=t.data.length<s.exactLength.value;(o||l)&&(it(t,{code:o?Qe.too_big:Qe.too_small,minimum:l?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(it(t,{code:Qe.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(it(t,{code:Qe.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,l)=>s.type._parseAsync(new So(t,o,t.path,l)))).then(o=>js.mergeArray(r,o));const a=[...t.data].map((o,l)=>s.type._parseSync(new So(t,o,t.path,l)));return js.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new wo({...this._def,minLength:{value:e,message:xt.toString(t)}})}max(e,t){return new wo({...this._def,maxLength:{value:e,message:xt.toString(t)}})}length(e,t){return new wo({...this._def,exactLength:{value:e,message:xt.toString(t)}})}nonempty(e){return this.min(1,e)}}wo.create=(n,e)=>new wo({type:n,minLength:null,maxLength:null,exactLength:null,typeName:zt.ZodArray,...Zt(e)});function nf(n){if(n instanceof xr){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=Fc.create(nf(r))}return new xr({...n._def,shape:()=>e})}else return n instanceof wo?new wo({...n._def,type:nf(n.element)}):n instanceof Fc?Fc.create(nf(n.unwrap())):n instanceof Nf?Nf.create(nf(n.unwrap())):n instanceof du?du.create(n.items.map(e=>nf(e))):n}class xr extends sn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=dn.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==ft.object){const d=this._getOrReturnCtx(e);return it(d,{code:Qe.invalid_type,expected:ft.object,received:d.parsedType}),Vt}const{status:r,ctx:s}=this._processInputParams(e),{shape:a,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof Uc&&this._def.unknownKeys==="strip"))for(const d in s.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const h=a[d],p=s.data[d];c.push({key:{status:"valid",value:d},value:h._parse(new So(s,p,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof Uc){const d=this._def.unknownKeys;if(d==="passthrough")for(const h of l)c.push({key:{status:"valid",value:h},value:{status:"valid",value:s.data[h]}});else if(d==="strict")l.length>0&&(it(s,{code:Qe.unrecognized_keys,keys:l}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const h of l){const p=s.data[h];c.push({key:{status:"valid",value:h},value:d._parse(new So(s,p,s.path,h)),alwaysSet:h in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const h of c){const p=await h.key,x=await h.value;d.push({key:p,value:x,alwaysSet:h.alwaysSet})}return d}).then(d=>js.mergeObjectSync(r,d)):js.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return xt.errToObj,new xr({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{const s=this._def.errorMap?.(t,r).message??r.defaultError;return t.code==="unrecognized_keys"?{message:xt.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new xr({...this._def,unknownKeys:"strip"})}passthrough(){return new xr({...this._def,unknownKeys:"passthrough"})}extend(e){return new xr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new xr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:zt.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new xr({...this._def,catchall:e})}pick(e){const t={};for(const r of dn.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new xr({...this._def,shape:()=>t})}omit(e){const t={};for(const r of dn.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new xr({...this._def,shape:()=>t})}deepPartial(){return nf(this)}partial(e){const t={};for(const r of dn.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}return new xr({...this._def,shape:()=>t})}required(e){const t={};for(const r of dn.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Fc;)a=a._def.innerType;t[r]=a}return new xr({...this._def,shape:()=>t})}keyof(){return fF(dn.objectKeys(this.shape))}}xr.create=(n,e)=>new xr({shape:()=>n,unknownKeys:"strip",catchall:Uc.create(),typeName:zt.ZodObject,...Zt(e)});xr.strictCreate=(n,e)=>new xr({shape:()=>n,unknownKeys:"strict",catchall:Uc.create(),typeName:zt.ZodObject,...Zt(e)});xr.lazycreate=(n,e)=>new xr({shape:n,unknownKeys:"strip",catchall:Uc.create(),typeName:zt.ZodObject,...Zt(e)});class xx extends sn{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(a){for(const l of a)if(l.result.status==="valid")return l.result;for(const l of a)if(l.result.status==="dirty")return t.common.issues.push(...l.ctx.common.issues),l.result;const o=a.map(l=>new jl(l.ctx.common.issues));return it(t,{code:Qe.invalid_union,unionErrors:o}),Vt}if(t.common.async)return Promise.all(r.map(async a=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let a;const o=[];for(const c of r){const d={...t,common:{...t.common,issues:[]},parent:null},h=c._parseSync({data:t.data,path:t.path,parent:d});if(h.status==="valid")return h;h.status==="dirty"&&!a&&(a={result:h,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const l=o.map(c=>new jl(c));return it(t,{code:Qe.invalid_union,unionErrors:l}),Vt}}get options(){return this._def.options}}xx.create=(n,e)=>new xx({options:n,typeName:zt.ZodUnion,...Zt(e)});function eS(n,e){const t=Mc(n),r=Mc(e);if(n===e)return{valid:!0,data:n};if(t===ft.object&&r===ft.object){const s=dn.objectKeys(e),a=dn.objectKeys(n).filter(l=>s.indexOf(l)!==-1),o={...n,...e};for(const l of a){const c=eS(n[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(t===ft.array&&r===ft.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<n.length;a++){const o=n[a],l=e[a],c=eS(o,l);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===ft.date&&r===ft.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class yx extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(a,o)=>{if(eP(a)||eP(o))return Vt;const l=eS(a.value,o.value);return l.valid?((tP(a)||tP(o))&&t.dirty(),{status:t.value,value:l.data}):(it(r,{code:Qe.invalid_intersection_types}),Vt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,o])=>s(a,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}yx.create=(n,e,t)=>new yx({left:n,right:e,typeName:zt.ZodIntersection,...Zt(t)});class du extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.array)return it(r,{code:Qe.invalid_type,expected:ft.array,received:r.parsedType}),Vt;if(r.data.length<this._def.items.length)return it(r,{code:Qe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Vt;!this._def.rest&&r.data.length>this._def.items.length&&(it(r,{code:Qe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...r.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new So(r,o,r.path,l)):null}).filter(o=>!!o);return r.common.async?Promise.all(a).then(o=>js.mergeArray(t,o)):js.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new du({...this._def,rest:e})}}du.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new du({items:n,typeName:zt.ZodTuple,rest:null,...Zt(e)})};class vx extends sn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.object)return it(r,{code:Qe.invalid_type,expected:ft.object,received:r.parsedType}),Vt;const s=[],a=this._def.keyType,o=this._def.valueType;for(const l in r.data)s.push({key:a._parse(new So(r,l,r.path,l)),value:o._parse(new So(r,r.data[l],r.path,l)),alwaysSet:l in r.data});return r.common.async?js.mergeObjectAsync(t,s):js.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof sn?new vx({keyType:e,valueType:t,typeName:zt.ZodRecord,...Zt(r)}):new vx({keyType:vo.create(),valueType:e,typeName:zt.ZodRecord,...Zt(t)})}}class lP extends sn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.map)return it(r,{code:Qe.invalid_type,expected:ft.map,received:r.parsedType}),Vt;const s=this._def.keyType,a=this._def.valueType,o=[...r.data.entries()].map(([l,c],d)=>({key:s._parse(new So(r,l,r.path,[d,"key"])),value:a._parse(new So(r,c,r.path,[d,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,h=await c.value;if(d.status==="aborted"||h.status==="aborted")return Vt;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),l.set(d.value,h.value)}return{status:t.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,h=c.value;if(d.status==="aborted"||h.status==="aborted")return Vt;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),l.set(d.value,h.value)}return{status:t.value,value:l}}}}lP.create=(n,e,t)=>new lP({valueType:e,keyType:n,typeName:zt.ZodMap,...Zt(t)});class rm extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.set)return it(r,{code:Qe.invalid_type,expected:ft.set,received:r.parsedType}),Vt;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(it(r,{code:Qe.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(it(r,{code:Qe.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const a=this._def.valueType;function o(c){const d=new Set;for(const h of c){if(h.status==="aborted")return Vt;h.status==="dirty"&&t.dirty(),d.add(h.value)}return{status:t.value,value:d}}const l=[...r.data.values()].map((c,d)=>a._parse(new So(r,c,r.path,d)));return r.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,t){return new rm({...this._def,minSize:{value:e,message:xt.toString(t)}})}max(e,t){return new rm({...this._def,maxSize:{value:e,message:xt.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}rm.create=(n,e)=>new rm({valueType:n,minSize:null,maxSize:null,typeName:zt.ZodSet,...Zt(e)});class tS extends sn{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}tS.create=(n,e)=>new tS({getter:n,typeName:zt.ZodLazy,...Zt(e)});class cP extends sn{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return it(t,{received:t.data,code:Qe.invalid_literal,expected:this._def.value}),Vt}return{status:"valid",value:e.data}}get value(){return this._def.value}}cP.create=(n,e)=>new cP({value:n,typeName:zt.ZodLiteral,...Zt(e)});function fF(n,e){return new wf({values:n,typeName:zt.ZodEnum,...Zt(e)})}class wf extends sn{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return it(t,{expected:dn.joinValues(r),received:t.parsedType,code:Qe.invalid_type}),Vt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return it(t,{received:t.data,code:Qe.invalid_enum_value,options:r}),Vt}return Zi(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return wf.create(e,{...this._def,...t})}exclude(e,t=this._def){return wf.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}wf.create=fF;class dP extends sn{_parse(e){const t=dn.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ft.string&&r.parsedType!==ft.number){const s=dn.objectValues(t);return it(r,{expected:dn.joinValues(s),received:r.parsedType,code:Qe.invalid_type}),Vt}if(this._cache||(this._cache=new Set(dn.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=dn.objectValues(t);return it(r,{received:r.data,code:Qe.invalid_enum_value,options:s}),Vt}return Zi(e.data)}get enum(){return this._def.values}}dP.create=(n,e)=>new dP({values:n,typeName:zt.ZodNativeEnum,...Zt(e)});class bx extends sn{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ft.promise&&t.common.async===!1)return it(t,{code:Qe.invalid_type,expected:ft.promise,received:t.parsedType}),Vt;const r=t.parsedType===ft.promise?t.data:Promise.resolve(t.data);return Zi(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}bx.create=(n,e)=>new bx({type:n,typeName:zt.ZodPromise,...Zt(e)});class jf extends sn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===zt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:o=>{it(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const o=s.transform(r.data,a);if(r.common.async)return Promise.resolve(o).then(async l=>{if(t.value==="aborted")return Vt;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?Vt:c.status==="dirty"||t.value==="dirty"?Lh(c.value):c});{if(t.value==="aborted")return Vt;const l=this._def.schema._parseSync({data:o,path:r.path,parent:r});return l.status==="aborted"?Vt:l.status==="dirty"||t.value==="dirty"?Lh(l.value):l}}if(s.type==="refinement"){const o=l=>{const c=s.refinement(l,a);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?Vt:(l.status==="dirty"&&t.dirty(),o(l.value),{status:t.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?Vt:(l.status==="dirty"&&t.dirty(),o(l.value).then(()=>({status:t.value,value:l.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!bf(o))return Vt;const l=s.transform(o.value,a);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>bf(o)?Promise.resolve(s.transform(o.value,a)).then(l=>({status:t.value,value:l})):Vt);dn.assertNever(s)}}jf.create=(n,e,t)=>new jf({schema:n,typeName:zt.ZodEffects,effect:e,...Zt(t)});jf.createWithPreprocess=(n,e,t)=>new jf({schema:e,effect:{type:"preprocess",transform:n},typeName:zt.ZodEffects,...Zt(t)});class Fc extends sn{_parse(e){return this._getType(e)===ft.undefined?Zi(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Fc.create=(n,e)=>new Fc({innerType:n,typeName:zt.ZodOptional,...Zt(e)});class Nf extends sn{_parse(e){return this._getType(e)===ft.null?Zi(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Nf.create=(n,e)=>new Nf({innerType:n,typeName:zt.ZodNullable,...Zt(e)});class nS extends sn{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===ft.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}nS.create=(n,e)=>new nS({innerType:n,typeName:zt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Zt(e)});class rS extends sn{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return px(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new jl(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new jl(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}rS.create=(n,e)=>new rS({innerType:n,typeName:zt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Zt(e)});class uP extends sn{_parse(e){if(this._getType(e)!==ft.nan){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.nan,received:r.parsedType}),Vt}return{status:"valid",value:e.data}}}uP.create=n=>new uP({typeName:zt.ZodNaN,...Zt(n)});class Q$ extends sn{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class hC extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Vt:a.status==="dirty"?(t.dirty(),Lh(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Vt:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new hC({in:e,out:t,typeName:zt.ZodPipeline})}}class sS extends sn{_parse(e){const t=this._def.innerType._parse(e),r=s=>(bf(s)&&(s.value=Object.freeze(s.value)),s);return px(t)?t.then(s=>r(s)):r(t)}unwrap(){return this._def.innerType}}sS.create=(n,e)=>new sS({innerType:n,typeName:zt.ZodReadonly,...Zt(e)});var zt;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(zt||(zt={}));const qd=vo.create,fP=lu.create;cu.create;const X$=gx.create;_f.create;const hP=XN.create;Uc.create;const Fh=wo.create,eH=xr.create,tH=xx.create;yx.create;du.create;const nH=vx.create,rH=tS.create,sH=wf.create;bx.create;Fc.create;Nf.create;const Yu={string:(n=>vo.create({...n,coerce:!0})),number:(n=>lu.create({...n,coerce:!0})),boolean:(n=>gx.create({...n,coerce:!0})),bigint:(n=>cu.create({...n,coerce:!0})),date:(n=>_f.create({...n,coerce:!0}))};let iH,aH;function oH(){return{geminiUrl:iH,vertexUrl:aH}}function lH(n,e,t){var r,s,a;if(!(!((r=n.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=oH();return n.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(a=o.geminiUrl)!==null&&a!==void 0?a:t}return n.httpOptions.baseUrl}class Nm{}function Rt(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const a=e[s];return a!=null?String(a):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function S(n,e,t){for(let a=0;a<e.length-1;a++){const o=e[a];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in n))if(Array.isArray(t))n[l]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[l])){const c=n[l];if(Array.isArray(t))for(let d=0;d<c.length;d++){const h=c[d];S(h,e.slice(a+1),t[d])}else for(const d of c)S(d,e.slice(a+1),t)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in n||(n[l]=[{}]);const c=n[l];S(c[0],e.slice(a+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const r=e[e.length-1],s=n[r];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else n[r]=t}function N(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const r=e[t];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in n){const a=n[s];return Array.isArray(a)?a.map(o=>N(o,e.slice(t+1))):void 0}else return}else n=n[r]}return n}catch(t){if(t instanceof TypeError)return;throw t}}var mP;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(mP||(mP={}));var pP;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(pP||(pP={}));var gP;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(gP||(gP={}));var xP;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(xP||(xP={}));var yP;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(yP||(yP={}));var et;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(et||(et={}));var vP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(vP||(vP={}));var bP;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(bP||(bP={}));var _P;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(_P||(_P={}));var wP;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(wP||(wP={}));var jP;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(jP||(jP={}));var NP;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(NP||(NP={}));var SP;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(SP||(SP={}));var sm;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(sm||(sm={}));var CP;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(CP||(CP={}));var iS;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(iS||(iS={}));var TP;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(TP||(TP={}));var kP;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(kP||(kP={}));var PP;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(PP||(PP={}));var MP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(MP||(MP={}));var DP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(DP||(DP={}));var EP;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(EP||(EP={}));var OP;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(OP||(OP={}));var IP;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(IP||(IP={}));var AP;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})(AP||(AP={}));var RP;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(RP||(RP={}));var LP;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(LP||(LP={}));var FP;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(FP||(FP={}));var qP;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(qP||(qP={}));var zP;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(zP||(zP={}));var UP;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(UP||(UP={}));var VP;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(VP||(VP={}));var BP;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(BP||(BP={}));var WP;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(WP||(WP={}));var $P;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})($P||($P={}));var HP;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(HP||(HP={}));var YP;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(YP||(YP={}));var GP;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(GP||(GP={}));var ZP;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY"})(ZP||(ZP={}));var sf;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(sf||(sf={}));class mh{get text(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const p=[];for(const x of(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[v,_]of Object.entries(x))v!=="text"&&v!=="thought"&&(_!==null||_!==void 0)&&p.push(v);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;h=!0,d+=x.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const p of(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[x,v]of Object.entries(p))x!=="inlineData"&&(v!==null||v!==void 0)&&h.push(x);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if(d?.length!==0)return d}get executableCode(){var e,t,r,s,a,o,l,c,d;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if(h?.length!==0)return(d=h?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,r,s,a,o,l,c,d;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if(h?.length!==0)return(d=h?.[0])===null||d===void 0?void 0:d.output}}class KP{}class JP{}class cH{}class dH{}class QP{}class XP{}class eM{}class uH{}class tM{}class nM{}class rM{}class fH{}class aS{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class hH{}class mH{}class pH{get text(){var e,t,r;let s="",a=!1;const o=[];for(const l of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(l))c!=="text"&&c!=="thought"&&d!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;a=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?s:void 0}get data(){var e,t,r;let s="";const a=[];for(const o of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&a.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class gH{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function Un(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function hF(n,e){const t=Un(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function mF(n,e){return Array.isArray(e)?e.map(t=>_x(n,t)):[_x(n,e)]}function _x(n,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function xH(n,e){const t=_x(n,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function yH(n,e){const t=_x(n,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function sM(n,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function pF(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>sM(n,t)):[sM(n,e)]}function oS(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function iM(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function aM(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Bs(n,e){if(e==null)throw new Error("ContentUnion is required");return oS(e)?e:{role:"user",parts:pF(n,e)}}function gF(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=Bs(n,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=Bs(n,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Bs(n,t)):[Bs(n,e)]}function Ta(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(iM(e)||aM(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Bs(n,e)]}const t=[],r=[],s=oS(e[0]);for(const a of e){const o=oS(a);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(a);else{if(iM(a)||aM(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(a)}}return s||t.push({role:"user",parts:pF(n,r)}),t}const oM=sH(["string","number","integer","object","array","boolean","null"]),vH=tH([oM,Fh(oM)]);function bH(n=!0){const e=rH(()=>{const t=eH({type:vH.optional(),format:qd().optional(),title:qd().optional(),description:qd().optional(),default:hP().optional(),items:e.optional(),minItems:Yu.string().optional(),maxItems:Yu.string().optional(),enum:Fh(hP()).optional(),properties:nH(qd(),e).optional(),required:Fh(qd()).optional(),minProperties:Yu.string().optional(),maxProperties:Yu.string().optional(),propertyOrdering:Fh(qd()).optional(),minimum:fP().optional(),maximum:fP().optional(),minLength:Yu.string().optional(),maxLength:Yu.string().optional(),pattern:qd().optional(),anyOf:Fh(e).optional(),additionalProperties:X$().optional()});return n?t.strict():t});return e}function _H(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.keys(et).includes(t[0].toUpperCase())?et[t[0].toUpperCase()]:et.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.keys(et).includes(r.toUpperCase())?et[r.toUpperCase()]:et.TYPE_UNSPECIFIED})}}function Hh(n){const e={},t=["items"],r=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&_H(n.type,e);for(const[o,l]of Object.entries(n))if(l!=null)if(o=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;e.type=Object.keys(et).includes(l.toUpperCase())?l.toUpperCase():et.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=Hh(l);else if(r.includes(o)){const c=[];for(const d of l){if(d.type=="null"){e.nullable=!0;continue}c.push(Hh(d))}e[o]=c}else if(s.includes(o)){const c={};for(const[d,h]of Object.entries(l))c[d]=Hh(h);e[o]=c}else{if(o==="additionalProperties")continue;e[o]=l}return e}function wx(n,e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=bH().parse(e);return Hh(t)}else return Hh(e)}function xF(n,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function yF(n,e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Yx(n,e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=wx(n,t.parameters)),t.response&&(t.response=wx(n,t.response));return e}function Gx(n,e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const r of e)t.push(r);return t}function wH(n,e,t,r=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Gc(n,e){if(typeof e!="string")throw new Error("name must be a string");return wH(n,e,"cachedContents")}function vF(n,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Zc(n,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function jH(n){return n!=null&&typeof n=="object"&&"name"in n}function NH(n){return n!=null&&typeof n=="object"&&"video"in n}function SH(n){return n!=null&&typeof n=="object"&&"uri"in n}function bF(n,e){var t;let r;if(jH(e)&&(r=e.name),!(SH(e)&&(r=e.uri,r===void 0))&&!(NH(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const a=r.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${r}`);r=a[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function _F(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function wF(n,e){for(const t of["models","tunedModels","publisherModels"])if(CH(e,t))return e[t];return[]}function CH(n,e){return n!==null&&typeof n=="object"&&e in n}function TH(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function kH(n,e){const t={};if(N(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function PH(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],TH(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],kH(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function lM(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>PH(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function MH(n,e){const t={},r=N(e,["behavior"]);r!=null&&S(t,["behavior"],r);const s=N(e,["description"]);s!=null&&S(t,["description"],s);const a=N(e,["name"]);a!=null&&S(t,["name"],a);const o=N(e,["parameters"]);o!=null&&S(t,["parameters"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],l),t}function DH(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function EH(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],DH(n,r)),t}function OH(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function IH(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],OH(n,r)),t}function AH(){return{}}function RH(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>MH(n,d))),S(t,["functionDeclarations"],c)}if(N(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=N(e,["googleSearch"]);s!=null&&S(t,["googleSearch"],EH(n,s));const a=N(e,["googleSearchRetrieval"]);if(a!=null&&S(t,["googleSearchRetrieval"],IH(n,a)),N(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(N(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");N(e,["urlContext"])!=null&&S(t,["urlContext"],AH());const l=N(e,["codeExecution"]);return l!=null&&S(t,["codeExecution"],l),t}function LH(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function FH(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function qH(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],FH(n,r)),t}function zH(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],LH(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],qH(n,s)),t}function UH(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);t!==void 0&&a!=null&&S(t,["expireTime"],a);const o=N(e,["displayName"]);t!==void 0&&o!=null&&S(t,["displayName"],o);const l=N(e,["contents"]);if(t!==void 0&&l!=null){let p=Ta(n,l);Array.isArray(p)&&(p=p.map(x=>lM(n,x))),S(t,["contents"],p)}const c=N(e,["systemInstruction"]);t!==void 0&&c!=null&&S(t,["systemInstruction"],lM(n,Bs(n,c)));const d=N(e,["tools"]);if(t!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(x=>RH(n,x))),S(t,["tools"],p)}const h=N(e,["toolConfig"]);if(t!==void 0&&h!=null&&S(t,["toolConfig"],zH(n,h)),N(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return r}function VH(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["model"],hF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],UH(n,s,t)),t}function BH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Gc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function WH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Gc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function $H(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);return t!==void 0&&a!=null&&S(t,["expireTime"],a),r}function HH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Gc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],$H(n,s,t)),t}function YH(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);return t!==void 0&&a!=null&&S(t,["_query","pageToken"],a),r}function GH(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],YH(n,r,t)),t}function ZH(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function KH(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function JH(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],ZH(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],KH(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function cM(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>JH(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function QH(n,e){const t={};if(N(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=N(e,["description"]);r!=null&&S(t,["description"],r);const s=N(e,["name"]);s!=null&&S(t,["name"],s);const a=N(e,["parameters"]);a!=null&&S(t,["parameters"],a);const o=N(e,["response"]);return o!=null&&S(t,["response"],o),t}function XH(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function e8(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],XH(n,r)),t}function t8(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function n8(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],t8(n,r)),t}function r8(){return{}}function s8(n,e){const t={},r=N(e,["apiKeyString"]);return r!=null&&S(t,["apiKeyString"],r),t}function i8(n,e){const t={},r=N(e,["apiKeyConfig"]);r!=null&&S(t,["apiKeyConfig"],s8(n,r));const s=N(e,["authType"]);s!=null&&S(t,["authType"],s);const a=N(e,["googleServiceAccountConfig"]);a!=null&&S(t,["googleServiceAccountConfig"],a);const o=N(e,["httpBasicAuthConfig"]);o!=null&&S(t,["httpBasicAuthConfig"],o);const l=N(e,["oauthConfig"]);l!=null&&S(t,["oauthConfig"],l);const c=N(e,["oidcConfig"]);return c!=null&&S(t,["oidcConfig"],c),t}function a8(n,e){const t={},r=N(e,["authConfig"]);return r!=null&&S(t,["authConfig"],i8(n,r)),t}function o8(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>QH(n,p))),S(t,["functionDeclarations"],h)}const s=N(e,["retrieval"]);s!=null&&S(t,["retrieval"],s);const a=N(e,["googleSearch"]);a!=null&&S(t,["googleSearch"],e8(n,a));const o=N(e,["googleSearchRetrieval"]);o!=null&&S(t,["googleSearchRetrieval"],n8(n,o)),N(e,["enterpriseWebSearch"])!=null&&S(t,["enterpriseWebSearch"],r8());const c=N(e,["googleMaps"]);if(c!=null&&S(t,["googleMaps"],a8(n,c)),N(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=N(e,["codeExecution"]);return d!=null&&S(t,["codeExecution"],d),t}function l8(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function c8(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function d8(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],c8(n,r)),t}function u8(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],l8(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],d8(n,s)),t}function f8(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);t!==void 0&&a!=null&&S(t,["expireTime"],a);const o=N(e,["displayName"]);t!==void 0&&o!=null&&S(t,["displayName"],o);const l=N(e,["contents"]);if(t!==void 0&&l!=null){let x=Ta(n,l);Array.isArray(x)&&(x=x.map(v=>cM(n,v))),S(t,["contents"],x)}const c=N(e,["systemInstruction"]);t!==void 0&&c!=null&&S(t,["systemInstruction"],cM(n,Bs(n,c)));const d=N(e,["tools"]);if(t!==void 0&&d!=null){let x=d;Array.isArray(x)&&(x=x.map(v=>o8(n,v))),S(t,["tools"],x)}const h=N(e,["toolConfig"]);t!==void 0&&h!=null&&S(t,["toolConfig"],u8(n,h));const p=N(e,["kmsKeyName"]);return t!==void 0&&p!=null&&S(t,["encryption_spec","kmsKeyName"],p),r}function h8(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["model"],hF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],f8(n,s,t)),t}function m8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Gc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function p8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Gc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function g8(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);return t!==void 0&&a!=null&&S(t,["expireTime"],a),r}function x8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Gc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],g8(n,s,t)),t}function y8(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);return t!==void 0&&a!=null&&S(t,["_query","pageToken"],a),r}function v8(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],y8(n,r,t)),t}function Qg(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["model"]);a!=null&&S(t,["model"],a);const o=N(e,["createTime"]);o!=null&&S(t,["createTime"],o);const l=N(e,["updateTime"]);l!=null&&S(t,["updateTime"],l);const c=N(e,["expireTime"]);c!=null&&S(t,["expireTime"],c);const d=N(e,["usageMetadata"]);return d!=null&&S(t,["usageMetadata"],d),t}function b8(){return{}}function _8(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>Qg(n,o))),S(t,["cachedContents"],a)}return t}function Xg(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["model"]);a!=null&&S(t,["model"],a);const o=N(e,["createTime"]);o!=null&&S(t,["createTime"],o);const l=N(e,["updateTime"]);l!=null&&S(t,["updateTime"],l);const c=N(e,["expireTime"]);c!=null&&S(t,["expireTime"],c);const d=N(e,["usageMetadata"]);return d!=null&&S(t,["usageMetadata"],d),t}function w8(){return{}}function j8(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>Xg(n,o))),S(t,["cachedContents"],a)}return t}var Sf;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Sf||(Sf={}));class Zx{constructor(e,t,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,s)}init(e,t,r){var s,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(a=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class N8 extends Nm{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Zx(Sf.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=h8(this.apiClient,e);return l=Rt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Xg(this.apiClient,h))}else{const d=VH(this.apiClient,e);return l=Rt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>Qg(this.apiClient,h))}}async get(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=m8(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Xg(this.apiClient,h))}else{const d=BH(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>Qg(this.apiClient,h))}}async delete(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=p8(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=w8(),p=new nM;return Object.assign(p,h),p})}else{const d=WH(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(()=>{const h=b8(),p=new nM;return Object.assign(p,h),p})}}async update(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=x8(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Xg(this.apiClient,h))}else{const d=HH(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>Qg(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=v8(this.apiClient,e);return l=Rt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=j8(this.apiClient,h),x=new rM;return Object.assign(x,p),x})}else{const d=GH(this.apiClient,e);return l=Rt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=_8(this.apiClient,h),x=new rM;return Object.assign(x,p),x})}}}function dM(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kn(n){return this instanceof Kn?(this.v=n,this):new Kn(n)}function Yh(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(v){return function(_){return Promise.resolve(_).then(v,p)}}function l(v,_){r[v]&&(s[v]=function(w){return new Promise(function(j,T){a.push([v,w,j,T])>1||c(v,w)})},_&&(s[v]=_(s[v])))}function c(v,_){try{d(r[v](_))}catch(w){x(a[0][3],w)}}function d(v){v.value instanceof Kn?Promise.resolve(v.value.v).then(h,p):x(a[0][2],v)}function h(v){c("next",v)}function p(v){c("throw",v)}function x(v,_){v(_),a.shift(),a.length&&c(a[0][0],a[0][1])}}function ex(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof dM=="function"?dM(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(l,c){o=n[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},o)}}function S8(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:jF(t)}function jF(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function C8(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function uM(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const s=[];let a=!0;for(;r<t&&n[r].role==="model";)s.push(n[r]),a&&!jF(n[r])&&(a=!1),r++;a?e.push(...s):e.pop()}return e}class T8{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new k8(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class k8{constructor(e,t,r,s={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=s,this.history=a,this.sendPromise=Promise.resolve(),C8(a)}async sendMessage(e){var t;await this.sendPromise;const r=Bs(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,o,l;const c=await s,d=(o=(a=c.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content,h=c.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let x=[];h!=null&&(x=(l=h.slice(p))!==null&&l!==void 0?l:[]);const v=d?[d]:[];this.recordHistory(r,v,x)})(),await this.sendPromise,s}async sendMessageStream(e){var t;await this.sendPromise;const r=Bs(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const a=await s;return this.processStreamResponse(a,r)}getHistory(e=!1){const t=e?uM(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var r,s;return Yh(this,arguments,function*(){var o,l,c,d;const h=[];try{for(var p=!0,x=ex(e),v;v=yield Kn(x.next()),o=v.done,!o;p=!0){d=v.value,p=!1;const _=d;if(S8(_)){const w=(s=(r=_.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;w!==void 0&&h.push(w)}yield yield Kn(_)}}catch(_){l={error:_}}finally{try{!p&&!o&&(c=x.return)&&(yield Kn(c.call(x)))}finally{if(l)throw l.error}}this.recordHistory(t,h)})}recordHistory(e,t,r){let s=[];t.length>0&&t.every(a=>a.role!==void 0)?s=t:s.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...uM(r)):this.history.push(e),this.history.push(...s)}}function P8(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);return t!==void 0&&a!=null&&S(t,["_query","pageToken"],a),r}function M8(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],P8(n,r,t)),t}function D8(n,e){const t={},r=N(e,["details"]);r!=null&&S(t,["details"],r);const s=N(e,["message"]);s!=null&&S(t,["message"],s);const a=N(e,["code"]);return a!=null&&S(t,["code"],a),t}function E8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["mimeType"]);a!=null&&S(t,["mimeType"],a);const o=N(e,["sizeBytes"]);o!=null&&S(t,["sizeBytes"],o);const l=N(e,["createTime"]);l!=null&&S(t,["createTime"],l);const c=N(e,["expirationTime"]);c!=null&&S(t,["expirationTime"],c);const d=N(e,["updateTime"]);d!=null&&S(t,["updateTime"],d);const h=N(e,["sha256Hash"]);h!=null&&S(t,["sha256Hash"],h);const p=N(e,["uri"]);p!=null&&S(t,["uri"],p);const x=N(e,["downloadUri"]);x!=null&&S(t,["downloadUri"],x);const v=N(e,["state"]);v!=null&&S(t,["state"],v);const _=N(e,["source"]);_!=null&&S(t,["source"],_);const w=N(e,["videoMetadata"]);w!=null&&S(t,["videoMetadata"],w);const j=N(e,["error"]);return j!=null&&S(t,["error"],D8(n,j)),t}function O8(n,e){const t={},r=N(e,["file"]);r!=null&&S(t,["file"],E8(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function I8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","file"],bF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function A8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","file"],bF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function R8(n,e){const t={},r=N(e,["details"]);r!=null&&S(t,["details"],r);const s=N(e,["message"]);s!=null&&S(t,["message"],s);const a=N(e,["code"]);return a!=null&&S(t,["code"],a),t}function lS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["mimeType"]);a!=null&&S(t,["mimeType"],a);const o=N(e,["sizeBytes"]);o!=null&&S(t,["sizeBytes"],o);const l=N(e,["createTime"]);l!=null&&S(t,["createTime"],l);const c=N(e,["expirationTime"]);c!=null&&S(t,["expirationTime"],c);const d=N(e,["updateTime"]);d!=null&&S(t,["updateTime"],d);const h=N(e,["sha256Hash"]);h!=null&&S(t,["sha256Hash"],h);const p=N(e,["uri"]);p!=null&&S(t,["uri"],p);const x=N(e,["downloadUri"]);x!=null&&S(t,["downloadUri"],x);const v=N(e,["state"]);v!=null&&S(t,["state"],v);const _=N(e,["source"]);_!=null&&S(t,["source"],_);const w=N(e,["videoMetadata"]);w!=null&&S(t,["videoMetadata"],w);const j=N(e,["error"]);return j!=null&&S(t,["error"],R8(n,j)),t}function L8(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["files"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>lS(n,o))),S(t,["files"],a)}return t}function F8(){return{}}function q8(){return{}}let z8=class extends Nm{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Zx(Sf.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>lS(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=M8(this.apiClient,e);return a=Rt("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=L8(this.apiClient,c),h=new fH;return Object.assign(h,d),h})}}async createInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=O8(this.apiClient,e);return a=Rt("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=F8(),d=new hH;return Object.assign(d,c),d})}}async get(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=I8(this.apiClient,e);return a=Rt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>lS(this.apiClient,c))}}async delete(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=A8(this.apiClient,e);return a=Rt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=q8(),d=new mH;return Object.assign(d,c),d})}}};function U8(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function V8(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function NF(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],U8(n,r)),t}function B8(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],V8(n,r)),t}function W8(n,e){const t={},r=N(e,["speaker"]);r!=null&&S(t,["speaker"],r);const s=N(e,["voiceConfig"]);return s!=null&&S(t,["voiceConfig"],NF(n,s)),t}function $8(n,e){const t={},r=N(e,["speakerVoiceConfigs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>W8(n,a))),S(t,["speakerVoiceConfigs"],s)}return t}function H8(n,e){const t={},r=N(e,["voiceConfig"]);r!=null&&S(t,["voiceConfig"],NF(n,r));const s=N(e,["multiSpeakerVoiceConfig"]);s!=null&&S(t,["multiSpeakerVoiceConfig"],$8(n,s));const a=N(e,["languageCode"]);return a!=null&&S(t,["languageCode"],a),t}function Y8(n,e){const t={},r=N(e,["voiceConfig"]);if(r!=null&&S(t,["voiceConfig"],B8(n,r)),N(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=N(e,["languageCode"]);return s!=null&&S(t,["languageCode"],s),t}function G8(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function Z8(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function K8(n,e){const t={};if(N(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function J8(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function Q8(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],G8(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],K8(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function X8(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],Z8(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],J8(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function e9(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Q8(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function t9(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>X8(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function n9(n,e){const t={},r=N(e,["behavior"]);r!=null&&S(t,["behavior"],r);const s=N(e,["description"]);s!=null&&S(t,["description"],s);const a=N(e,["name"]);a!=null&&S(t,["name"],a);const o=N(e,["parameters"]);o!=null&&S(t,["parameters"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],l),t}function r9(n,e){const t={};if(N(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=N(e,["description"]);r!=null&&S(t,["description"],r);const s=N(e,["name"]);s!=null&&S(t,["name"],s);const a=N(e,["parameters"]);a!=null&&S(t,["parameters"],a);const o=N(e,["response"]);return o!=null&&S(t,["response"],o),t}function s9(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function i9(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function a9(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],s9(n,r)),t}function o9(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],i9(n,r)),t}function l9(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function c9(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function d9(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],l9(n,r)),t}function u9(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],c9(n,r)),t}function f9(){return{}}function h9(n,e){const t={},r=N(e,["apiKeyString"]);return r!=null&&S(t,["apiKeyString"],r),t}function m9(n,e){const t={},r=N(e,["apiKeyConfig"]);r!=null&&S(t,["apiKeyConfig"],h9(n,r));const s=N(e,["authType"]);s!=null&&S(t,["authType"],s);const a=N(e,["googleServiceAccountConfig"]);a!=null&&S(t,["googleServiceAccountConfig"],a);const o=N(e,["httpBasicAuthConfig"]);o!=null&&S(t,["httpBasicAuthConfig"],o);const l=N(e,["oauthConfig"]);l!=null&&S(t,["oauthConfig"],l);const c=N(e,["oidcConfig"]);return c!=null&&S(t,["oidcConfig"],c),t}function p9(n,e){const t={},r=N(e,["authConfig"]);return r!=null&&S(t,["authConfig"],m9(n,r)),t}function g9(){return{}}function x9(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>n9(n,d))),S(t,["functionDeclarations"],c)}if(N(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=N(e,["googleSearch"]);s!=null&&S(t,["googleSearch"],a9(n,s));const a=N(e,["googleSearchRetrieval"]);if(a!=null&&S(t,["googleSearchRetrieval"],d9(n,a)),N(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(N(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");N(e,["urlContext"])!=null&&S(t,["urlContext"],g9());const l=N(e,["codeExecution"]);return l!=null&&S(t,["codeExecution"],l),t}function y9(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>r9(n,p))),S(t,["functionDeclarations"],h)}const s=N(e,["retrieval"]);s!=null&&S(t,["retrieval"],s);const a=N(e,["googleSearch"]);a!=null&&S(t,["googleSearch"],o9(n,a));const o=N(e,["googleSearchRetrieval"]);o!=null&&S(t,["googleSearchRetrieval"],u9(n,o)),N(e,["enterpriseWebSearch"])!=null&&S(t,["enterpriseWebSearch"],f9());const c=N(e,["googleMaps"]);if(c!=null&&S(t,["googleMaps"],p9(n,c)),N(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=N(e,["codeExecution"]);return d!=null&&S(t,["codeExecution"],d),t}function v9(n,e){const t={},r=N(e,["handle"]);if(r!=null&&S(t,["handle"],r),N(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function b9(n,e){const t={},r=N(e,["handle"]);r!=null&&S(t,["handle"],r);const s=N(e,["transparent"]);return s!=null&&S(t,["transparent"],s),t}function fM(){return{}}function hM(){return{}}function _9(n,e){const t={},r=N(e,["disabled"]);r!=null&&S(t,["disabled"],r);const s=N(e,["startOfSpeechSensitivity"]);s!=null&&S(t,["startOfSpeechSensitivity"],s);const a=N(e,["endOfSpeechSensitivity"]);a!=null&&S(t,["endOfSpeechSensitivity"],a);const o=N(e,["prefixPaddingMs"]);o!=null&&S(t,["prefixPaddingMs"],o);const l=N(e,["silenceDurationMs"]);return l!=null&&S(t,["silenceDurationMs"],l),t}function w9(n,e){const t={},r=N(e,["disabled"]);r!=null&&S(t,["disabled"],r);const s=N(e,["startOfSpeechSensitivity"]);s!=null&&S(t,["startOfSpeechSensitivity"],s);const a=N(e,["endOfSpeechSensitivity"]);a!=null&&S(t,["endOfSpeechSensitivity"],a);const o=N(e,["prefixPaddingMs"]);o!=null&&S(t,["prefixPaddingMs"],o);const l=N(e,["silenceDurationMs"]);return l!=null&&S(t,["silenceDurationMs"],l),t}function j9(n,e){const t={},r=N(e,["automaticActivityDetection"]);r!=null&&S(t,["automaticActivityDetection"],_9(n,r));const s=N(e,["activityHandling"]);s!=null&&S(t,["activityHandling"],s);const a=N(e,["turnCoverage"]);return a!=null&&S(t,["turnCoverage"],a),t}function N9(n,e){const t={},r=N(e,["automaticActivityDetection"]);r!=null&&S(t,["automaticActivityDetection"],w9(n,r));const s=N(e,["activityHandling"]);s!=null&&S(t,["activityHandling"],s);const a=N(e,["turnCoverage"]);return a!=null&&S(t,["turnCoverage"],a),t}function S9(n,e){const t={},r=N(e,["targetTokens"]);return r!=null&&S(t,["targetTokens"],r),t}function C9(n,e){const t={},r=N(e,["targetTokens"]);return r!=null&&S(t,["targetTokens"],r),t}function T9(n,e){const t={},r=N(e,["triggerTokens"]);r!=null&&S(t,["triggerTokens"],r);const s=N(e,["slidingWindow"]);return s!=null&&S(t,["slidingWindow"],S9(n,s)),t}function k9(n,e){const t={},r=N(e,["triggerTokens"]);r!=null&&S(t,["triggerTokens"],r);const s=N(e,["slidingWindow"]);return s!=null&&S(t,["slidingWindow"],C9(n,s)),t}function P9(n,e){const t={},r=N(e,["proactiveAudio"]);return r!=null&&S(t,["proactiveAudio"],r),t}function M9(n,e){const t={},r=N(e,["proactiveAudio"]);return r!=null&&S(t,["proactiveAudio"],r),t}function D9(n,e,t){const r={},s=N(e,["generationConfig"]);t!==void 0&&s!=null&&S(t,["setup","generationConfig"],s);const a=N(e,["responseModalities"]);t!==void 0&&a!=null&&S(t,["setup","generationConfig","responseModalities"],a);const o=N(e,["temperature"]);t!==void 0&&o!=null&&S(t,["setup","generationConfig","temperature"],o);const l=N(e,["topP"]);t!==void 0&&l!=null&&S(t,["setup","generationConfig","topP"],l);const c=N(e,["topK"]);t!==void 0&&c!=null&&S(t,["setup","generationConfig","topK"],c);const d=N(e,["maxOutputTokens"]);t!==void 0&&d!=null&&S(t,["setup","generationConfig","maxOutputTokens"],d);const h=N(e,["mediaResolution"]);t!==void 0&&h!=null&&S(t,["setup","generationConfig","mediaResolution"],h);const p=N(e,["seed"]);t!==void 0&&p!=null&&S(t,["setup","generationConfig","seed"],p);const x=N(e,["speechConfig"]);t!==void 0&&x!=null&&S(t,["setup","generationConfig","speechConfig"],H8(n,yF(n,x)));const v=N(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&S(t,["setup","generationConfig","enableAffectiveDialog"],v);const _=N(e,["systemInstruction"]);t!==void 0&&_!=null&&S(t,["setup","systemInstruction"],e9(n,Bs(n,_)));const w=N(e,["tools"]);if(t!==void 0&&w!=null){let I=Gx(n,w);Array.isArray(I)&&(I=I.map(q=>x9(n,Yx(n,q)))),S(t,["setup","tools"],I)}const j=N(e,["sessionResumption"]);t!==void 0&&j!=null&&S(t,["setup","sessionResumption"],v9(n,j));const T=N(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&S(t,["setup","inputAudioTranscription"],fM());const P=N(e,["outputAudioTranscription"]);t!==void 0&&P!=null&&S(t,["setup","outputAudioTranscription"],fM());const E=N(e,["realtimeInputConfig"]);t!==void 0&&E!=null&&S(t,["setup","realtimeInputConfig"],j9(n,E));const M=N(e,["contextWindowCompression"]);t!==void 0&&M!=null&&S(t,["setup","contextWindowCompression"],T9(n,M));const O=N(e,["proactivity"]);return t!==void 0&&O!=null&&S(t,["setup","proactivity"],P9(n,O)),r}function E9(n,e,t){const r={},s=N(e,["generationConfig"]);t!==void 0&&s!=null&&S(t,["setup","generationConfig"],s);const a=N(e,["responseModalities"]);t!==void 0&&a!=null&&S(t,["setup","generationConfig","responseModalities"],a);const o=N(e,["temperature"]);t!==void 0&&o!=null&&S(t,["setup","generationConfig","temperature"],o);const l=N(e,["topP"]);t!==void 0&&l!=null&&S(t,["setup","generationConfig","topP"],l);const c=N(e,["topK"]);t!==void 0&&c!=null&&S(t,["setup","generationConfig","topK"],c);const d=N(e,["maxOutputTokens"]);t!==void 0&&d!=null&&S(t,["setup","generationConfig","maxOutputTokens"],d);const h=N(e,["mediaResolution"]);t!==void 0&&h!=null&&S(t,["setup","generationConfig","mediaResolution"],h);const p=N(e,["seed"]);t!==void 0&&p!=null&&S(t,["setup","generationConfig","seed"],p);const x=N(e,["speechConfig"]);t!==void 0&&x!=null&&S(t,["setup","generationConfig","speechConfig"],Y8(n,yF(n,x)));const v=N(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&S(t,["setup","generationConfig","enableAffectiveDialog"],v);const _=N(e,["systemInstruction"]);t!==void 0&&_!=null&&S(t,["setup","systemInstruction"],t9(n,Bs(n,_)));const w=N(e,["tools"]);if(t!==void 0&&w!=null){let I=Gx(n,w);Array.isArray(I)&&(I=I.map(q=>y9(n,Yx(n,q)))),S(t,["setup","tools"],I)}const j=N(e,["sessionResumption"]);t!==void 0&&j!=null&&S(t,["setup","sessionResumption"],b9(n,j));const T=N(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&S(t,["setup","inputAudioTranscription"],hM());const P=N(e,["outputAudioTranscription"]);t!==void 0&&P!=null&&S(t,["setup","outputAudioTranscription"],hM());const E=N(e,["realtimeInputConfig"]);t!==void 0&&E!=null&&S(t,["setup","realtimeInputConfig"],N9(n,E));const M=N(e,["contextWindowCompression"]);t!==void 0&&M!=null&&S(t,["setup","contextWindowCompression"],k9(n,M));const O=N(e,["proactivity"]);return t!==void 0&&O!=null&&S(t,["setup","proactivity"],M9(n,O)),r}function O9(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["setup","model"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],D9(n,s,t)),t}function I9(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["setup","model"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],E9(n,s,t)),t}function A9(){return{}}function R9(){return{}}function L9(){return{}}function F9(){return{}}function q9(n,e){const t={},r=N(e,["media"]);r!=null&&S(t,["mediaChunks"],mF(n,r));const s=N(e,["audio"]);s!=null&&S(t,["audio"],yH(n,s));const a=N(e,["audioStreamEnd"]);a!=null&&S(t,["audioStreamEnd"],a);const o=N(e,["video"]);o!=null&&S(t,["video"],xH(n,o));const l=N(e,["text"]);return l!=null&&S(t,["text"],l),N(e,["activityStart"])!=null&&S(t,["activityStart"],A9()),N(e,["activityEnd"])!=null&&S(t,["activityEnd"],L9()),t}function z9(n,e){const t={},r=N(e,["media"]);if(r!=null&&S(t,["mediaChunks"],mF(n,r)),N(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=N(e,["audioStreamEnd"]);if(s!=null&&S(t,["audioStreamEnd"],s),N(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(N(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return N(e,["activityStart"])!=null&&S(t,["activityStart"],R9()),N(e,["activityEnd"])!=null&&S(t,["activityEnd"],F9()),t}function SF(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["weight"]);return s!=null&&S(t,["weight"],s),t}function U9(n,e){const t={},r=N(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>SF(n,a))),S(t,["weightedPrompts"],s)}return t}function CF(n,e){const t={},r=N(e,["temperature"]);r!=null&&S(t,["temperature"],r);const s=N(e,["topK"]);s!=null&&S(t,["topK"],s);const a=N(e,["seed"]);a!=null&&S(t,["seed"],a);const o=N(e,["guidance"]);o!=null&&S(t,["guidance"],o);const l=N(e,["bpm"]);l!=null&&S(t,["bpm"],l);const c=N(e,["density"]);c!=null&&S(t,["density"],c);const d=N(e,["brightness"]);d!=null&&S(t,["brightness"],d);const h=N(e,["scale"]);h!=null&&S(t,["scale"],h);const p=N(e,["muteBass"]);p!=null&&S(t,["muteBass"],p);const x=N(e,["muteDrums"]);x!=null&&S(t,["muteDrums"],x);const v=N(e,["onlyBassAndDrums"]);v!=null&&S(t,["onlyBassAndDrums"],v);const _=N(e,["musicGenerationMode"]);return _!=null&&S(t,["musicGenerationMode"],_),t}function V9(n,e){const t={},r=N(e,["musicGenerationConfig"]);return r!=null&&S(t,["musicGenerationConfig"],CF(n,r)),t}function TF(n,e){const t={},r=N(e,["model"]);return r!=null&&S(t,["model"],r),t}function kF(n,e){const t={},r=N(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>SF(n,a))),S(t,["weightedPrompts"],s)}return t}function cS(n,e){const t={},r=N(e,["setup"]);r!=null&&S(t,["setup"],TF(n,r));const s=N(e,["clientContent"]);s!=null&&S(t,["clientContent"],kF(n,s));const a=N(e,["musicGenerationConfig"]);a!=null&&S(t,["musicGenerationConfig"],CF(n,a));const o=N(e,["playbackControl"]);return o!=null&&S(t,["playbackControl"],o),t}function B9(){return{}}function W9(){return{}}function $9(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function H9(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function Y9(n,e){const t={},r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function G9(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function Z9(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],$9(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],Y9(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function K9(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],H9(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],G9(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function J9(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Z9(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function Q9(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>K9(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function mM(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["finished"]);return s!=null&&S(t,["finished"],s),t}function pM(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["finished"]);return s!=null&&S(t,["finished"],s),t}function X9(n,e){const t={},r=N(e,["retrievedUrl"]);r!=null&&S(t,["retrievedUrl"],r);const s=N(e,["urlRetrievalStatus"]);return s!=null&&S(t,["urlRetrievalStatus"],s),t}function e7(n,e){const t={},r=N(e,["urlMetadata"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>X9(n,a))),S(t,["urlMetadata"],s)}return t}function t7(n,e){const t={},r=N(e,["modelTurn"]);r!=null&&S(t,["modelTurn"],J9(n,r));const s=N(e,["turnComplete"]);s!=null&&S(t,["turnComplete"],s);const a=N(e,["interrupted"]);a!=null&&S(t,["interrupted"],a);const o=N(e,["groundingMetadata"]);o!=null&&S(t,["groundingMetadata"],o);const l=N(e,["generationComplete"]);l!=null&&S(t,["generationComplete"],l);const c=N(e,["inputTranscription"]);c!=null&&S(t,["inputTranscription"],mM(n,c));const d=N(e,["outputTranscription"]);d!=null&&S(t,["outputTranscription"],mM(n,d));const h=N(e,["urlContextMetadata"]);return h!=null&&S(t,["urlContextMetadata"],e7(n,h)),t}function n7(n,e){const t={},r=N(e,["modelTurn"]);r!=null&&S(t,["modelTurn"],Q9(n,r));const s=N(e,["turnComplete"]);s!=null&&S(t,["turnComplete"],s);const a=N(e,["interrupted"]);a!=null&&S(t,["interrupted"],a);const o=N(e,["groundingMetadata"]);o!=null&&S(t,["groundingMetadata"],o);const l=N(e,["generationComplete"]);l!=null&&S(t,["generationComplete"],l);const c=N(e,["inputTranscription"]);c!=null&&S(t,["inputTranscription"],pM(n,c));const d=N(e,["outputTranscription"]);return d!=null&&S(t,["outputTranscription"],pM(n,d)),t}function r7(n,e){const t={},r=N(e,["id"]);r!=null&&S(t,["id"],r);const s=N(e,["args"]);s!=null&&S(t,["args"],s);const a=N(e,["name"]);return a!=null&&S(t,["name"],a),t}function s7(n,e){const t={},r=N(e,["args"]);r!=null&&S(t,["args"],r);const s=N(e,["name"]);return s!=null&&S(t,["name"],s),t}function i7(n,e){const t={},r=N(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>r7(n,a))),S(t,["functionCalls"],s)}return t}function a7(n,e){const t={},r=N(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>s7(n,a))),S(t,["functionCalls"],s)}return t}function o7(n,e){const t={},r=N(e,["ids"]);return r!=null&&S(t,["ids"],r),t}function l7(n,e){const t={},r=N(e,["ids"]);return r!=null&&S(t,["ids"],r),t}function Ip(n,e){const t={},r=N(e,["modality"]);r!=null&&S(t,["modality"],r);const s=N(e,["tokenCount"]);return s!=null&&S(t,["tokenCount"],s),t}function Ap(n,e){const t={},r=N(e,["modality"]);r!=null&&S(t,["modality"],r);const s=N(e,["tokenCount"]);return s!=null&&S(t,["tokenCount"],s),t}function c7(n,e){const t={},r=N(e,["promptTokenCount"]);r!=null&&S(t,["promptTokenCount"],r);const s=N(e,["cachedContentTokenCount"]);s!=null&&S(t,["cachedContentTokenCount"],s);const a=N(e,["responseTokenCount"]);a!=null&&S(t,["responseTokenCount"],a);const o=N(e,["toolUsePromptTokenCount"]);o!=null&&S(t,["toolUsePromptTokenCount"],o);const l=N(e,["thoughtsTokenCount"]);l!=null&&S(t,["thoughtsTokenCount"],l);const c=N(e,["totalTokenCount"]);c!=null&&S(t,["totalTokenCount"],c);const d=N(e,["promptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(_=>Ip(n,_))),S(t,["promptTokensDetails"],v)}const h=N(e,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(_=>Ip(n,_))),S(t,["cacheTokensDetails"],v)}const p=N(e,["responseTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(_=>Ip(n,_))),S(t,["responseTokensDetails"],v)}const x=N(e,["toolUsePromptTokensDetails"]);if(x!=null){let v=x;Array.isArray(v)&&(v=v.map(_=>Ip(n,_))),S(t,["toolUsePromptTokensDetails"],v)}return t}function d7(n,e){const t={},r=N(e,["promptTokenCount"]);r!=null&&S(t,["promptTokenCount"],r);const s=N(e,["cachedContentTokenCount"]);s!=null&&S(t,["cachedContentTokenCount"],s);const a=N(e,["candidatesTokenCount"]);a!=null&&S(t,["responseTokenCount"],a);const o=N(e,["toolUsePromptTokenCount"]);o!=null&&S(t,["toolUsePromptTokenCount"],o);const l=N(e,["thoughtsTokenCount"]);l!=null&&S(t,["thoughtsTokenCount"],l);const c=N(e,["totalTokenCount"]);c!=null&&S(t,["totalTokenCount"],c);const d=N(e,["promptTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(w=>Ap(n,w))),S(t,["promptTokensDetails"],_)}const h=N(e,["cacheTokensDetails"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(w=>Ap(n,w))),S(t,["cacheTokensDetails"],_)}const p=N(e,["candidatesTokensDetails"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(w=>Ap(n,w))),S(t,["responseTokensDetails"],_)}const x=N(e,["toolUsePromptTokensDetails"]);if(x!=null){let _=x;Array.isArray(_)&&(_=_.map(w=>Ap(n,w))),S(t,["toolUsePromptTokensDetails"],_)}const v=N(e,["trafficType"]);return v!=null&&S(t,["trafficType"],v),t}function u7(n,e){const t={},r=N(e,["timeLeft"]);return r!=null&&S(t,["timeLeft"],r),t}function f7(n,e){const t={},r=N(e,["timeLeft"]);return r!=null&&S(t,["timeLeft"],r),t}function h7(n,e){const t={},r=N(e,["newHandle"]);r!=null&&S(t,["newHandle"],r);const s=N(e,["resumable"]);s!=null&&S(t,["resumable"],s);const a=N(e,["lastConsumedClientMessageIndex"]);return a!=null&&S(t,["lastConsumedClientMessageIndex"],a),t}function m7(n,e){const t={},r=N(e,["newHandle"]);r!=null&&S(t,["newHandle"],r);const s=N(e,["resumable"]);s!=null&&S(t,["resumable"],s);const a=N(e,["lastConsumedClientMessageIndex"]);return a!=null&&S(t,["lastConsumedClientMessageIndex"],a),t}function p7(n,e){const t={};N(e,["setupComplete"])!=null&&S(t,["setupComplete"],B9());const s=N(e,["serverContent"]);s!=null&&S(t,["serverContent"],t7(n,s));const a=N(e,["toolCall"]);a!=null&&S(t,["toolCall"],i7(n,a));const o=N(e,["toolCallCancellation"]);o!=null&&S(t,["toolCallCancellation"],o7(n,o));const l=N(e,["usageMetadata"]);l!=null&&S(t,["usageMetadata"],c7(n,l));const c=N(e,["goAway"]);c!=null&&S(t,["goAway"],u7(n,c));const d=N(e,["sessionResumptionUpdate"]);return d!=null&&S(t,["sessionResumptionUpdate"],h7(n,d)),t}function g7(n,e){const t={};N(e,["setupComplete"])!=null&&S(t,["setupComplete"],W9());const s=N(e,["serverContent"]);s!=null&&S(t,["serverContent"],n7(n,s));const a=N(e,["toolCall"]);a!=null&&S(t,["toolCall"],a7(n,a));const o=N(e,["toolCallCancellation"]);o!=null&&S(t,["toolCallCancellation"],l7(n,o));const l=N(e,["usageMetadata"]);l!=null&&S(t,["usageMetadata"],d7(n,l));const c=N(e,["goAway"]);c!=null&&S(t,["goAway"],f7(n,c));const d=N(e,["sessionResumptionUpdate"]);return d!=null&&S(t,["sessionResumptionUpdate"],m7(n,d)),t}function x7(){return{}}function y7(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["weight"]);return s!=null&&S(t,["weight"],s),t}function v7(n,e){const t={},r=N(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>y7(n,a))),S(t,["weightedPrompts"],s)}return t}function b7(n,e){const t={},r=N(e,["temperature"]);r!=null&&S(t,["temperature"],r);const s=N(e,["topK"]);s!=null&&S(t,["topK"],s);const a=N(e,["seed"]);a!=null&&S(t,["seed"],a);const o=N(e,["guidance"]);o!=null&&S(t,["guidance"],o);const l=N(e,["bpm"]);l!=null&&S(t,["bpm"],l);const c=N(e,["density"]);c!=null&&S(t,["density"],c);const d=N(e,["brightness"]);d!=null&&S(t,["brightness"],d);const h=N(e,["scale"]);h!=null&&S(t,["scale"],h);const p=N(e,["muteBass"]);p!=null&&S(t,["muteBass"],p);const x=N(e,["muteDrums"]);x!=null&&S(t,["muteDrums"],x);const v=N(e,["onlyBassAndDrums"]);v!=null&&S(t,["onlyBassAndDrums"],v);const _=N(e,["musicGenerationMode"]);return _!=null&&S(t,["musicGenerationMode"],_),t}function _7(n,e){const t={},r=N(e,["clientContent"]);r!=null&&S(t,["clientContent"],v7(n,r));const s=N(e,["musicGenerationConfig"]);return s!=null&&S(t,["musicGenerationConfig"],b7(n,s)),t}function w7(n,e){const t={},r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);s!=null&&S(t,["mimeType"],s);const a=N(e,["sourceMetadata"]);return a!=null&&S(t,["sourceMetadata"],_7(n,a)),t}function j7(n,e){const t={},r=N(e,["audioChunks"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>w7(n,a))),S(t,["audioChunks"],s)}return t}function N7(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["filteredReason"]);return s!=null&&S(t,["filteredReason"],s),t}function S7(n,e){const t={};N(e,["setupComplete"])!=null&&S(t,["setupComplete"],x7());const s=N(e,["serverContent"]);s!=null&&S(t,["serverContent"],j7(n,s));const a=N(e,["filteredPrompt"]);return a!=null&&S(t,["filteredPrompt"],N7(n,a)),t}function C7(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function T7(n,e){const t={};if(N(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function k7(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],C7(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],T7(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function Kx(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>k7(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function P7(n,e){const t={};if(N(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=N(e,["category"]);r!=null&&S(t,["category"],r);const s=N(e,["threshold"]);return s!=null&&S(t,["threshold"],s),t}function M7(n,e){const t={},r=N(e,["behavior"]);r!=null&&S(t,["behavior"],r);const s=N(e,["description"]);s!=null&&S(t,["description"],s);const a=N(e,["name"]);a!=null&&S(t,["name"],a);const o=N(e,["parameters"]);o!=null&&S(t,["parameters"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],l),t}function D7(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function E7(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],D7(n,r)),t}function O7(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function I7(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],O7(n,r)),t}function A7(){return{}}function R7(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>M7(n,d))),S(t,["functionDeclarations"],c)}if(N(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=N(e,["googleSearch"]);s!=null&&S(t,["googleSearch"],E7(n,s));const a=N(e,["googleSearchRetrieval"]);if(a!=null&&S(t,["googleSearchRetrieval"],I7(n,a)),N(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(N(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");N(e,["urlContext"])!=null&&S(t,["urlContext"],A7());const l=N(e,["codeExecution"]);return l!=null&&S(t,["codeExecution"],l),t}function L7(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function F7(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function q7(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],F7(n,r)),t}function z7(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],L7(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],q7(n,s)),t}function U7(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function PF(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],U7(n,r)),t}function V7(n,e){const t={},r=N(e,["speaker"]);r!=null&&S(t,["speaker"],r);const s=N(e,["voiceConfig"]);return s!=null&&S(t,["voiceConfig"],PF(n,s)),t}function B7(n,e){const t={},r=N(e,["speakerVoiceConfigs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>V7(n,a))),S(t,["speakerVoiceConfigs"],s)}return t}function W7(n,e){const t={},r=N(e,["voiceConfig"]);r!=null&&S(t,["voiceConfig"],PF(n,r));const s=N(e,["multiSpeakerVoiceConfig"]);s!=null&&S(t,["multiSpeakerVoiceConfig"],B7(n,s));const a=N(e,["languageCode"]);return a!=null&&S(t,["languageCode"],a),t}function $7(n,e){const t={},r=N(e,["includeThoughts"]);r!=null&&S(t,["includeThoughts"],r);const s=N(e,["thinkingBudget"]);return s!=null&&S(t,["thinkingBudget"],s),t}function H7(n,e,t){const r={},s=N(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],Kx(n,Bs(n,s)));const a=N(e,["temperature"]);a!=null&&S(r,["temperature"],a);const o=N(e,["topP"]);o!=null&&S(r,["topP"],o);const l=N(e,["topK"]);l!=null&&S(r,["topK"],l);const c=N(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const d=N(e,["maxOutputTokens"]);d!=null&&S(r,["maxOutputTokens"],d);const h=N(e,["stopSequences"]);h!=null&&S(r,["stopSequences"],h);const p=N(e,["responseLogprobs"]);p!=null&&S(r,["responseLogprobs"],p);const x=N(e,["logprobs"]);x!=null&&S(r,["logprobs"],x);const v=N(e,["presencePenalty"]);v!=null&&S(r,["presencePenalty"],v);const _=N(e,["frequencyPenalty"]);_!=null&&S(r,["frequencyPenalty"],_);const w=N(e,["seed"]);w!=null&&S(r,["seed"],w);const j=N(e,["responseMimeType"]);j!=null&&S(r,["responseMimeType"],j);const T=N(e,["responseSchema"]);if(T!=null&&S(r,["responseSchema"],wx(n,T)),N(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(N(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=N(e,["safetySettings"]);if(t!==void 0&&P!=null){let U=P;Array.isArray(U)&&(U=U.map(W=>P7(n,W))),S(t,["safetySettings"],U)}const E=N(e,["tools"]);if(t!==void 0&&E!=null){let U=Gx(n,E);Array.isArray(U)&&(U=U.map(W=>R7(n,Yx(n,W)))),S(t,["tools"],U)}const M=N(e,["toolConfig"]);if(t!==void 0&&M!=null&&S(t,["toolConfig"],z7(n,M)),N(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const O=N(e,["cachedContent"]);t!==void 0&&O!=null&&S(t,["cachedContent"],Gc(n,O));const I=N(e,["responseModalities"]);I!=null&&S(r,["responseModalities"],I);const q=N(e,["mediaResolution"]);q!=null&&S(r,["mediaResolution"],q);const F=N(e,["speechConfig"]);if(F!=null&&S(r,["speechConfig"],W7(n,xF(n,F))),N(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=N(e,["thinkingConfig"]);return B!=null&&S(r,["thinkingConfig"],$7(n,B)),r}function gM(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);if(s!=null){let o=Ta(n,s);Array.isArray(o)&&(o=o.map(l=>Kx(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["generationConfig"],H7(n,a,t)),t}function Y7(n,e,t){const r={},s=N(e,["taskType"]);t!==void 0&&s!=null&&S(t,["requests[]","taskType"],s);const a=N(e,["title"]);t!==void 0&&a!=null&&S(t,["requests[]","title"],a);const o=N(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&S(t,["requests[]","outputDimensionality"],o),N(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(N(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function G7(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);s!=null&&S(t,["requests[]","content"],gF(n,s));const a=N(e,["config"]);a!=null&&S(t,["config"],Y7(n,a,t));const o=N(e,["model"]);return o!==void 0&&S(t,["requests[]","model"],Un(n,o)),t}function Z7(n,e,t){const r={};if(N(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(N(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=N(e,["numberOfImages"]);t!==void 0&&s!=null&&S(t,["parameters","sampleCount"],s);const a=N(e,["aspectRatio"]);t!==void 0&&a!=null&&S(t,["parameters","aspectRatio"],a);const o=N(e,["guidanceScale"]);if(t!==void 0&&o!=null&&S(t,["parameters","guidanceScale"],o),N(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=N(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&S(t,["parameters","safetySetting"],l);const c=N(e,["personGeneration"]);t!==void 0&&c!=null&&S(t,["parameters","personGeneration"],c);const d=N(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&S(t,["parameters","includeSafetyAttributes"],d);const h=N(e,["includeRaiReason"]);t!==void 0&&h!=null&&S(t,["parameters","includeRaiReason"],h);const p=N(e,["language"]);t!==void 0&&p!=null&&S(t,["parameters","language"],p);const x=N(e,["outputMimeType"]);t!==void 0&&x!=null&&S(t,["parameters","outputOptions","mimeType"],x);const v=N(e,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&S(t,["parameters","outputOptions","compressionQuality"],v),N(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(N(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function K7(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["config"]);return a!=null&&S(t,["config"],Z7(n,a,t)),t}function J7(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function Q7(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);t!==void 0&&o!=null&&S(t,["_query","filter"],o);const l=N(e,["queryBase"]);return t!==void 0&&l!=null&&S(t,["_url","models_url"],_F(n,l)),r}function X7(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],Q7(n,r,t)),t}function eY(n,e,t){const r={},s=N(e,["displayName"]);t!==void 0&&s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);t!==void 0&&a!=null&&S(t,["description"],a);const o=N(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&S(t,["defaultCheckpointId"],o),r}function tY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],eY(n,s,t)),t}function nY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function rY(n,e){const t={};if(N(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(N(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(N(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function sY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);if(s!=null){let o=Ta(n,s);Array.isArray(o)&&(o=o.map(l=>Kx(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["config"],rY(n,a)),t}function iY(n,e){const t={};if(N(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=N(e,["imageBytes"]);r!=null&&S(t,["bytesBase64Encoded"],Zc(n,r));const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function aY(n,e,t){const r={},s=N(e,["numberOfVideos"]);if(t!==void 0&&s!=null&&S(t,["parameters","sampleCount"],s),N(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(N(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=N(e,["durationSeconds"]);if(t!==void 0&&a!=null&&S(t,["parameters","durationSeconds"],a),N(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=N(e,["aspectRatio"]);if(t!==void 0&&o!=null&&S(t,["parameters","aspectRatio"],o),N(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=N(e,["personGeneration"]);if(t!==void 0&&l!=null&&S(t,["parameters","personGeneration"],l),N(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=N(e,["negativePrompt"]);if(t!==void 0&&c!=null&&S(t,["parameters","negativePrompt"],c),N(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function oY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["image"]);a!=null&&S(t,["instances[0]","image"],iY(n,a));const o=N(e,["config"]);return o!=null&&S(t,["config"],aY(n,o,t)),t}function lY(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function cY(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function dY(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],lY(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],cY(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function Lf(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>dY(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function uY(n,e){const t={},r=N(e,["featureSelectionPreference"]);return r!=null&&S(t,["featureSelectionPreference"],r),t}function fY(n,e){const t={},r=N(e,["method"]);r!=null&&S(t,["method"],r);const s=N(e,["category"]);s!=null&&S(t,["category"],s);const a=N(e,["threshold"]);return a!=null&&S(t,["threshold"],a),t}function hY(n,e){const t={};if(N(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=N(e,["description"]);r!=null&&S(t,["description"],r);const s=N(e,["name"]);s!=null&&S(t,["name"],s);const a=N(e,["parameters"]);a!=null&&S(t,["parameters"],a);const o=N(e,["response"]);return o!=null&&S(t,["response"],o),t}function mY(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function pY(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],mY(n,r)),t}function gY(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function xY(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],gY(n,r)),t}function yY(){return{}}function vY(n,e){const t={},r=N(e,["apiKeyString"]);return r!=null&&S(t,["apiKeyString"],r),t}function bY(n,e){const t={},r=N(e,["apiKeyConfig"]);r!=null&&S(t,["apiKeyConfig"],vY(n,r));const s=N(e,["authType"]);s!=null&&S(t,["authType"],s);const a=N(e,["googleServiceAccountConfig"]);a!=null&&S(t,["googleServiceAccountConfig"],a);const o=N(e,["httpBasicAuthConfig"]);o!=null&&S(t,["httpBasicAuthConfig"],o);const l=N(e,["oauthConfig"]);l!=null&&S(t,["oauthConfig"],l);const c=N(e,["oidcConfig"]);return c!=null&&S(t,["oidcConfig"],c),t}function _Y(n,e){const t={},r=N(e,["authConfig"]);return r!=null&&S(t,["authConfig"],bY(n,r)),t}function MF(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>hY(n,p))),S(t,["functionDeclarations"],h)}const s=N(e,["retrieval"]);s!=null&&S(t,["retrieval"],s);const a=N(e,["googleSearch"]);a!=null&&S(t,["googleSearch"],pY(n,a));const o=N(e,["googleSearchRetrieval"]);o!=null&&S(t,["googleSearchRetrieval"],xY(n,o)),N(e,["enterpriseWebSearch"])!=null&&S(t,["enterpriseWebSearch"],yY());const c=N(e,["googleMaps"]);if(c!=null&&S(t,["googleMaps"],_Y(n,c)),N(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=N(e,["codeExecution"]);return d!=null&&S(t,["codeExecution"],d),t}function wY(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function jY(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function NY(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],jY(n,r)),t}function SY(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],wY(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],NY(n,s)),t}function CY(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function TY(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],CY(n,r)),t}function kY(n,e){const t={},r=N(e,["voiceConfig"]);if(r!=null&&S(t,["voiceConfig"],TY(n,r)),N(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=N(e,["languageCode"]);return s!=null&&S(t,["languageCode"],s),t}function PY(n,e){const t={},r=N(e,["includeThoughts"]);r!=null&&S(t,["includeThoughts"],r);const s=N(e,["thinkingBudget"]);return s!=null&&S(t,["thinkingBudget"],s),t}function MY(n,e,t){const r={},s=N(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],Lf(n,Bs(n,s)));const a=N(e,["temperature"]);a!=null&&S(r,["temperature"],a);const o=N(e,["topP"]);o!=null&&S(r,["topP"],o);const l=N(e,["topK"]);l!=null&&S(r,["topK"],l);const c=N(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const d=N(e,["maxOutputTokens"]);d!=null&&S(r,["maxOutputTokens"],d);const h=N(e,["stopSequences"]);h!=null&&S(r,["stopSequences"],h);const p=N(e,["responseLogprobs"]);p!=null&&S(r,["responseLogprobs"],p);const x=N(e,["logprobs"]);x!=null&&S(r,["logprobs"],x);const v=N(e,["presencePenalty"]);v!=null&&S(r,["presencePenalty"],v);const _=N(e,["frequencyPenalty"]);_!=null&&S(r,["frequencyPenalty"],_);const w=N(e,["seed"]);w!=null&&S(r,["seed"],w);const j=N(e,["responseMimeType"]);j!=null&&S(r,["responseMimeType"],j);const T=N(e,["responseSchema"]);T!=null&&S(r,["responseSchema"],wx(n,T));const P=N(e,["routingConfig"]);P!=null&&S(r,["routingConfig"],P);const E=N(e,["modelSelectionConfig"]);E!=null&&S(r,["modelConfig"],uY(n,E));const M=N(e,["safetySettings"]);if(t!==void 0&&M!=null){let Y=M;Array.isArray(Y)&&(Y=Y.map(ae=>fY(n,ae))),S(t,["safetySettings"],Y)}const O=N(e,["tools"]);if(t!==void 0&&O!=null){let Y=Gx(n,O);Array.isArray(Y)&&(Y=Y.map(ae=>MF(n,Yx(n,ae)))),S(t,["tools"],Y)}const I=N(e,["toolConfig"]);t!==void 0&&I!=null&&S(t,["toolConfig"],SY(n,I));const q=N(e,["labels"]);t!==void 0&&q!=null&&S(t,["labels"],q);const F=N(e,["cachedContent"]);t!==void 0&&F!=null&&S(t,["cachedContent"],Gc(n,F));const B=N(e,["responseModalities"]);B!=null&&S(r,["responseModalities"],B);const U=N(e,["mediaResolution"]);U!=null&&S(r,["mediaResolution"],U);const W=N(e,["speechConfig"]);W!=null&&S(r,["speechConfig"],kY(n,xF(n,W)));const $=N(e,["audioTimestamp"]);$!=null&&S(r,["audioTimestamp"],$);const se=N(e,["thinkingConfig"]);return se!=null&&S(r,["thinkingConfig"],PY(n,se)),r}function xM(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);if(s!=null){let o=Ta(n,s);Array.isArray(o)&&(o=o.map(l=>Lf(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["generationConfig"],MY(n,a,t)),t}function DY(n,e,t){const r={},s=N(e,["taskType"]);t!==void 0&&s!=null&&S(t,["instances[]","task_type"],s);const a=N(e,["title"]);t!==void 0&&a!=null&&S(t,["instances[]","title"],a);const o=N(e,["outputDimensionality"]);t!==void 0&&o!=null&&S(t,["parameters","outputDimensionality"],o);const l=N(e,["mimeType"]);t!==void 0&&l!=null&&S(t,["instances[]","mimeType"],l);const c=N(e,["autoTruncate"]);return t!==void 0&&c!=null&&S(t,["parameters","autoTruncate"],c),r}function EY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);s!=null&&S(t,["instances[]","content"],gF(n,s));const a=N(e,["config"]);return a!=null&&S(t,["config"],DY(n,a,t)),t}function OY(n,e,t){const r={},s=N(e,["outputGcsUri"]);t!==void 0&&s!=null&&S(t,["parameters","storageUri"],s);const a=N(e,["negativePrompt"]);t!==void 0&&a!=null&&S(t,["parameters","negativePrompt"],a);const o=N(e,["numberOfImages"]);t!==void 0&&o!=null&&S(t,["parameters","sampleCount"],o);const l=N(e,["aspectRatio"]);t!==void 0&&l!=null&&S(t,["parameters","aspectRatio"],l);const c=N(e,["guidanceScale"]);t!==void 0&&c!=null&&S(t,["parameters","guidanceScale"],c);const d=N(e,["seed"]);t!==void 0&&d!=null&&S(t,["parameters","seed"],d);const h=N(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&S(t,["parameters","safetySetting"],h);const p=N(e,["personGeneration"]);t!==void 0&&p!=null&&S(t,["parameters","personGeneration"],p);const x=N(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&S(t,["parameters","includeSafetyAttributes"],x);const v=N(e,["includeRaiReason"]);t!==void 0&&v!=null&&S(t,["parameters","includeRaiReason"],v);const _=N(e,["language"]);t!==void 0&&_!=null&&S(t,["parameters","language"],_);const w=N(e,["outputMimeType"]);t!==void 0&&w!=null&&S(t,["parameters","outputOptions","mimeType"],w);const j=N(e,["outputCompressionQuality"]);t!==void 0&&j!=null&&S(t,["parameters","outputOptions","compressionQuality"],j);const T=N(e,["addWatermark"]);t!==void 0&&T!=null&&S(t,["parameters","addWatermark"],T);const P=N(e,["enhancePrompt"]);return t!==void 0&&P!=null&&S(t,["parameters","enhancePrompt"],P),r}function IY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["config"]);return a!=null&&S(t,["config"],OY(n,a,t)),t}function mC(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["gcsUri"],r);const s=N(e,["imageBytes"]);s!=null&&S(t,["bytesBase64Encoded"],Zc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function AY(n,e){const t={},r=N(e,["maskMode"]);r!=null&&S(t,["maskMode"],r);const s=N(e,["segmentationClasses"]);s!=null&&S(t,["maskClasses"],s);const a=N(e,["maskDilation"]);return a!=null&&S(t,["dilation"],a),t}function RY(n,e){const t={},r=N(e,["controlType"]);r!=null&&S(t,["controlType"],r);const s=N(e,["enableControlImageComputation"]);return s!=null&&S(t,["computeControl"],s),t}function LY(n,e){const t={},r=N(e,["styleDescription"]);return r!=null&&S(t,["styleDescription"],r),t}function FY(n,e){const t={},r=N(e,["subjectType"]);r!=null&&S(t,["subjectType"],r);const s=N(e,["subjectDescription"]);return s!=null&&S(t,["subjectDescription"],s),t}function qY(n,e){const t={},r=N(e,["referenceImage"]);r!=null&&S(t,["referenceImage"],mC(n,r));const s=N(e,["referenceId"]);s!=null&&S(t,["referenceId"],s);const a=N(e,["referenceType"]);a!=null&&S(t,["referenceType"],a);const o=N(e,["maskImageConfig"]);o!=null&&S(t,["maskImageConfig"],AY(n,o));const l=N(e,["controlImageConfig"]);l!=null&&S(t,["controlImageConfig"],RY(n,l));const c=N(e,["styleImageConfig"]);c!=null&&S(t,["styleImageConfig"],LY(n,c));const d=N(e,["subjectImageConfig"]);return d!=null&&S(t,["subjectImageConfig"],FY(n,d)),t}function zY(n,e,t){const r={},s=N(e,["outputGcsUri"]);t!==void 0&&s!=null&&S(t,["parameters","storageUri"],s);const a=N(e,["negativePrompt"]);t!==void 0&&a!=null&&S(t,["parameters","negativePrompt"],a);const o=N(e,["numberOfImages"]);t!==void 0&&o!=null&&S(t,["parameters","sampleCount"],o);const l=N(e,["aspectRatio"]);t!==void 0&&l!=null&&S(t,["parameters","aspectRatio"],l);const c=N(e,["guidanceScale"]);t!==void 0&&c!=null&&S(t,["parameters","guidanceScale"],c);const d=N(e,["seed"]);t!==void 0&&d!=null&&S(t,["parameters","seed"],d);const h=N(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&S(t,["parameters","safetySetting"],h);const p=N(e,["personGeneration"]);t!==void 0&&p!=null&&S(t,["parameters","personGeneration"],p);const x=N(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&S(t,["parameters","includeSafetyAttributes"],x);const v=N(e,["includeRaiReason"]);t!==void 0&&v!=null&&S(t,["parameters","includeRaiReason"],v);const _=N(e,["language"]);t!==void 0&&_!=null&&S(t,["parameters","language"],_);const w=N(e,["outputMimeType"]);t!==void 0&&w!=null&&S(t,["parameters","outputOptions","mimeType"],w);const j=N(e,["outputCompressionQuality"]);t!==void 0&&j!=null&&S(t,["parameters","outputOptions","compressionQuality"],j);const T=N(e,["editMode"]);t!==void 0&&T!=null&&S(t,["parameters","editMode"],T);const P=N(e,["baseSteps"]);return t!==void 0&&P!=null&&S(t,["parameters","editConfig","baseSteps"],P),r}function UY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["referenceImages"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>qY(n,c))),S(t,["instances[0]","referenceImages"],l)}const o=N(e,["config"]);return o!=null&&S(t,["config"],zY(n,o,t)),t}function VY(n,e,t){const r={},s=N(e,["includeRaiReason"]);t!==void 0&&s!=null&&S(t,["parameters","includeRaiReason"],s);const a=N(e,["outputMimeType"]);t!==void 0&&a!=null&&S(t,["parameters","outputOptions","mimeType"],a);const o=N(e,["outputCompressionQuality"]);t!==void 0&&o!=null&&S(t,["parameters","outputOptions","compressionQuality"],o);const l=N(e,["numberOfImages"]);t!==void 0&&l!=null&&S(t,["parameters","sampleCount"],l);const c=N(e,["mode"]);return t!==void 0&&c!=null&&S(t,["parameters","mode"],c),r}function BY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["image"]);s!=null&&S(t,["instances[0]","image"],mC(n,s));const a=N(e,["upscaleFactor"]);a!=null&&S(t,["parameters","upscaleConfig","upscaleFactor"],a);const o=N(e,["config"]);return o!=null&&S(t,["config"],VY(n,o,t)),t}function WY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function $Y(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);t!==void 0&&o!=null&&S(t,["_query","filter"],o);const l=N(e,["queryBase"]);return t!==void 0&&l!=null&&S(t,["_url","models_url"],_F(n,l)),r}function HY(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],$Y(n,r,t)),t}function YY(n,e,t){const r={},s=N(e,["displayName"]);t!==void 0&&s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);t!==void 0&&a!=null&&S(t,["description"],a);const o=N(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&S(t,["defaultCheckpointId"],o),r}function GY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],YY(n,s,t)),t}function ZY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function KY(n,e,t){const r={},s=N(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],Lf(n,Bs(n,s)));const a=N(e,["tools"]);if(t!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>MF(n,c))),S(t,["tools"],l)}const o=N(e,["generationConfig"]);return t!==void 0&&o!=null&&S(t,["generationConfig"],o),r}function JY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);if(s!=null){let o=Ta(n,s);Array.isArray(o)&&(o=o.map(l=>Lf(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["config"],KY(n,a,t)),t}function QY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);if(s!=null){let o=Ta(n,s);Array.isArray(o)&&(o=o.map(l=>Lf(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["config"],a),t}function XY(n,e,t){const r={},s=N(e,["numberOfVideos"]);t!==void 0&&s!=null&&S(t,["parameters","sampleCount"],s);const a=N(e,["outputGcsUri"]);t!==void 0&&a!=null&&S(t,["parameters","storageUri"],a);const o=N(e,["fps"]);t!==void 0&&o!=null&&S(t,["parameters","fps"],o);const l=N(e,["durationSeconds"]);t!==void 0&&l!=null&&S(t,["parameters","durationSeconds"],l);const c=N(e,["seed"]);t!==void 0&&c!=null&&S(t,["parameters","seed"],c);const d=N(e,["aspectRatio"]);t!==void 0&&d!=null&&S(t,["parameters","aspectRatio"],d);const h=N(e,["resolution"]);t!==void 0&&h!=null&&S(t,["parameters","resolution"],h);const p=N(e,["personGeneration"]);t!==void 0&&p!=null&&S(t,["parameters","personGeneration"],p);const x=N(e,["pubsubTopic"]);t!==void 0&&x!=null&&S(t,["parameters","pubsubTopic"],x);const v=N(e,["negativePrompt"]);t!==void 0&&v!=null&&S(t,["parameters","negativePrompt"],v);const _=N(e,["enhancePrompt"]);return t!==void 0&&_!=null&&S(t,["parameters","enhancePrompt"],_),r}function eG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["image"]);a!=null&&S(t,["instances[0]","image"],mC(n,a));const o=N(e,["config"]);return o!=null&&S(t,["config"],XY(n,o,t)),t}function tG(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function nG(n,e){const t={},r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function rG(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],tG(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],nG(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function sG(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>rG(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function iG(n,e){const t={},r=N(e,["citationSources"]);return r!=null&&S(t,["citations"],r),t}function aG(n,e){const t={},r=N(e,["retrievedUrl"]);r!=null&&S(t,["retrievedUrl"],r);const s=N(e,["urlRetrievalStatus"]);return s!=null&&S(t,["urlRetrievalStatus"],s),t}function oG(n,e){const t={},r=N(e,["urlMetadata"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>aG(n,a))),S(t,["urlMetadata"],s)}return t}function lG(n,e){const t={},r=N(e,["content"]);r!=null&&S(t,["content"],sG(n,r));const s=N(e,["citationMetadata"]);s!=null&&S(t,["citationMetadata"],iG(n,s));const a=N(e,["tokenCount"]);a!=null&&S(t,["tokenCount"],a);const o=N(e,["finishReason"]);o!=null&&S(t,["finishReason"],o);const l=N(e,["urlContextMetadata"]);l!=null&&S(t,["urlContextMetadata"],oG(n,l));const c=N(e,["avgLogprobs"]);c!=null&&S(t,["avgLogprobs"],c);const d=N(e,["groundingMetadata"]);d!=null&&S(t,["groundingMetadata"],d);const h=N(e,["index"]);h!=null&&S(t,["index"],h);const p=N(e,["logprobsResult"]);p!=null&&S(t,["logprobsResult"],p);const x=N(e,["safetyRatings"]);return x!=null&&S(t,["safetyRatings"],x),t}function yM(n,e){const t={},r=N(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>lG(n,c))),S(t,["candidates"],l)}const s=N(e,["modelVersion"]);s!=null&&S(t,["modelVersion"],s);const a=N(e,["promptFeedback"]);a!=null&&S(t,["promptFeedback"],a);const o=N(e,["usageMetadata"]);return o!=null&&S(t,["usageMetadata"],o),t}function cG(n,e){const t={},r=N(e,["values"]);return r!=null&&S(t,["values"],r),t}function dG(){return{}}function uG(n,e){const t={},r=N(e,["embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>cG(n,o))),S(t,["embeddings"],a)}return N(e,["metadata"])!=null&&S(t,["metadata"],dG()),t}function fG(n,e){const t={},r=N(e,["bytesBase64Encoded"]);r!=null&&S(t,["imageBytes"],Zc(n,r));const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function DF(n,e){const t={},r=N(e,["safetyAttributes","categories"]);r!=null&&S(t,["categories"],r);const s=N(e,["safetyAttributes","scores"]);s!=null&&S(t,["scores"],s);const a=N(e,["contentType"]);return a!=null&&S(t,["contentType"],a),t}function hG(n,e){const t={},r=N(e,["_self"]);r!=null&&S(t,["image"],fG(n,r));const s=N(e,["raiFilteredReason"]);s!=null&&S(t,["raiFilteredReason"],s);const a=N(e,["_self"]);return a!=null&&S(t,["safetyAttributes"],DF(n,a)),t}function mG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>hG(n,o))),S(t,["generatedImages"],a)}const s=N(e,["positivePromptSafetyAttributes"]);return s!=null&&S(t,["positivePromptSafetyAttributes"],DF(n,s)),t}function pG(n,e){const t={},r=N(e,["baseModel"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["createTime"]);s!=null&&S(t,["createTime"],s);const a=N(e,["updateTime"]);return a!=null&&S(t,["updateTime"],a),t}function dS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);a!=null&&S(t,["description"],a);const o=N(e,["version"]);o!=null&&S(t,["version"],o);const l=N(e,["_self"]);l!=null&&S(t,["tunedModelInfo"],pG(n,l));const c=N(e,["inputTokenLimit"]);c!=null&&S(t,["inputTokenLimit"],c);const d=N(e,["outputTokenLimit"]);d!=null&&S(t,["outputTokenLimit"],d);const h=N(e,["supportedGenerationMethods"]);return h!=null&&S(t,["supportedActions"],h),t}function gG(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["_self"]);if(s!=null){let a=wF(n,s);Array.isArray(a)&&(a=a.map(o=>dS(n,o))),S(t,["models"],a)}return t}function xG(){return{}}function yG(n,e){const t={},r=N(e,["totalTokens"]);r!=null&&S(t,["totalTokens"],r);const s=N(e,["cachedContentTokenCount"]);return s!=null&&S(t,["cachedContentTokenCount"],s),t}function vG(n,e){const t={},r=N(e,["video","uri"]);r!=null&&S(t,["uri"],r);const s=N(e,["video","encodedVideo"]);s!=null&&S(t,["videoBytes"],Zc(n,s));const a=N(e,["encoding"]);return a!=null&&S(t,["mimeType"],a),t}function bG(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],vG(n,r)),t}function _G(n,e){const t={},r=N(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>bG(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function wG(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response","generateVideoResponse"]);return l!=null&&S(t,["response"],_G(n,l)),t}function jG(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function NG(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function SG(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],jG(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],NG(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function CG(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>SG(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function TG(n,e){const t={},r=N(e,["citations"]);return r!=null&&S(t,["citations"],r),t}function kG(n,e){const t={},r=N(e,["content"]);r!=null&&S(t,["content"],CG(n,r));const s=N(e,["citationMetadata"]);s!=null&&S(t,["citationMetadata"],TG(n,s));const a=N(e,["finishMessage"]);a!=null&&S(t,["finishMessage"],a);const o=N(e,["finishReason"]);o!=null&&S(t,["finishReason"],o);const l=N(e,["avgLogprobs"]);l!=null&&S(t,["avgLogprobs"],l);const c=N(e,["groundingMetadata"]);c!=null&&S(t,["groundingMetadata"],c);const d=N(e,["index"]);d!=null&&S(t,["index"],d);const h=N(e,["logprobsResult"]);h!=null&&S(t,["logprobsResult"],h);const p=N(e,["safetyRatings"]);return p!=null&&S(t,["safetyRatings"],p),t}function vM(n,e){const t={},r=N(e,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>kG(n,h))),S(t,["candidates"],d)}const s=N(e,["createTime"]);s!=null&&S(t,["createTime"],s);const a=N(e,["responseId"]);a!=null&&S(t,["responseId"],a);const o=N(e,["modelVersion"]);o!=null&&S(t,["modelVersion"],o);const l=N(e,["promptFeedback"]);l!=null&&S(t,["promptFeedback"],l);const c=N(e,["usageMetadata"]);return c!=null&&S(t,["usageMetadata"],c),t}function PG(n,e){const t={},r=N(e,["truncated"]);r!=null&&S(t,["truncated"],r);const s=N(e,["token_count"]);return s!=null&&S(t,["tokenCount"],s),t}function MG(n,e){const t={},r=N(e,["values"]);r!=null&&S(t,["values"],r);const s=N(e,["statistics"]);return s!=null&&S(t,["statistics"],PG(n,s)),t}function DG(n,e){const t={},r=N(e,["billableCharacterCount"]);return r!=null&&S(t,["billableCharacterCount"],r),t}function EG(n,e){const t={},r=N(e,["predictions[]","embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>MG(n,o))),S(t,["embeddings"],a)}const s=N(e,["metadata"]);return s!=null&&S(t,["metadata"],DG(n,s)),t}function OG(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["gcsUri"],r);const s=N(e,["bytesBase64Encoded"]);s!=null&&S(t,["imageBytes"],Zc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function EF(n,e){const t={},r=N(e,["safetyAttributes","categories"]);r!=null&&S(t,["categories"],r);const s=N(e,["safetyAttributes","scores"]);s!=null&&S(t,["scores"],s);const a=N(e,["contentType"]);return a!=null&&S(t,["contentType"],a),t}function pC(n,e){const t={},r=N(e,["_self"]);r!=null&&S(t,["image"],OG(n,r));const s=N(e,["raiFilteredReason"]);s!=null&&S(t,["raiFilteredReason"],s);const a=N(e,["_self"]);a!=null&&S(t,["safetyAttributes"],EF(n,a));const o=N(e,["prompt"]);return o!=null&&S(t,["enhancedPrompt"],o),t}function IG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>pC(n,o))),S(t,["generatedImages"],a)}const s=N(e,["positivePromptSafetyAttributes"]);return s!=null&&S(t,["positivePromptSafetyAttributes"],EF(n,s)),t}function AG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>pC(n,a))),S(t,["generatedImages"],s)}return t}function RG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>pC(n,a))),S(t,["generatedImages"],s)}return t}function LG(n,e){const t={},r=N(e,["endpoint"]);r!=null&&S(t,["name"],r);const s=N(e,["deployedModelId"]);return s!=null&&S(t,["deployedModelId"],s),t}function FG(n,e){const t={},r=N(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["createTime"]);s!=null&&S(t,["createTime"],s);const a=N(e,["updateTime"]);return a!=null&&S(t,["updateTime"],a),t}function qG(n,e){const t={},r=N(e,["checkpointId"]);r!=null&&S(t,["checkpointId"],r);const s=N(e,["epoch"]);s!=null&&S(t,["epoch"],s);const a=N(e,["step"]);return a!=null&&S(t,["step"],a),t}function uS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);a!=null&&S(t,["description"],a);const o=N(e,["versionId"]);o!=null&&S(t,["version"],o);const l=N(e,["deployedModels"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(v=>LG(n,v))),S(t,["endpoints"],x)}const c=N(e,["labels"]);c!=null&&S(t,["labels"],c);const d=N(e,["_self"]);d!=null&&S(t,["tunedModelInfo"],FG(n,d));const h=N(e,["defaultCheckpointId"]);h!=null&&S(t,["defaultCheckpointId"],h);const p=N(e,["checkpoints"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(v=>qG(n,v))),S(t,["checkpoints"],x)}return t}function zG(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["_self"]);if(s!=null){let a=wF(n,s);Array.isArray(a)&&(a=a.map(o=>uS(n,o))),S(t,["models"],a)}return t}function UG(){return{}}function VG(n,e){const t={},r=N(e,["totalTokens"]);return r!=null&&S(t,["totalTokens"],r),t}function BG(n,e){const t={},r=N(e,["tokensInfo"]);return r!=null&&S(t,["tokensInfo"],r),t}function WG(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["uri"],r);const s=N(e,["bytesBase64Encoded"]);s!=null&&S(t,["videoBytes"],Zc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function $G(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],WG(n,r)),t}function HG(n,e){const t={},r=N(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>$G(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function YG(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],HG(n,l)),t}const GG="Content-Type",ZG="X-Server-Timeout",KG="User-Agent",fS="x-goog-api-client",JG="0.15.0",QG=`google-genai-sdk/${JG}`,XG="v1beta1",eZ="v1beta",bM=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class OF extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class hS extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class tZ{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:XG,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:eZ,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const s=[this.getRequestUrlInternal(t)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.unaryApiCall(s,a,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[s,a]of Object.entries(t))typeof a=="object"?r[s]=Object.assign(Object.assign({},r[s]),a):a!==void 0&&(r[s]=a);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.streamApiCall(s,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r){if(t&&t.timeout||r){const s=new AbortController,a=s.signal;t.timeout&&t?.timeout>0&&setTimeout(()=>s.abort(),t.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=a}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async s=>(await _M(s),new aS(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async s=>(await _M(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return Yh(this,arguments,function*(){const s=(t=e?.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield Kn(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=a.decode(c);try{const p=JSON.parse(d);if("error"in p){const x=JSON.parse(JSON.stringify(p.error)),v=x.status,_=x.code,w=`got status: ${v}. ${JSON.stringify(p)}`;if(_>=400&&_<500)throw new OF(w);if(_>=500&&_<600)throw new hS(w)}}catch(p){const x=p;if(x.name==="ClientError"||x.name==="ServerError")throw p}o+=d;let h=o.match(bM);for(;h;){const p=h[1];try{const x=new Response(p,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Kn(new aS(x)),o=o.slice(h[0].length),h=o.match(bM)}catch(x){throw new Error(`exception parsing stream chunk ${p}. ${x}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=QG+" "+this.clientOptions.userAgentExtra;return e[KG]=t,e[fS]=t,e[GG]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))t.append(r,s);e.timeout&&e.timeout>0&&t.append(ZG,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var r;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const a=this.clientOptions.uploader,o=await a.stat(e);s.sizeBytes=String(o.size);const l=(r=t?.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,t);return a.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var r;let s={};t?.httpOptions?s=t.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const a={file:e},o=await this.request({path:Rt("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:s});if(!o||!o?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o?.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function _M(n){var e;if(n===void 0)throw new hS("response is undefined");if(!n.ok){const t=n.status,r=n.statusText;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const a=`got status: ${t} ${r}. ${JSON.stringify(s)}`;throw t>=400&&t<500?new OF(a):t>=500&&t<600?new hS(a):new Error(a)}}const nZ="mcp_used/unknown";function mS(n){for(const e of n)if(gC(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function pS(n){var e;n[fS]=(((e=n[fS])!==null&&e!==void 0?e:"")+` ${nZ}`).trimStart()}function rZ(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>gC(s)))!==null&&r!==void 0?r:!1}function sZ(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>!gC(s)))!==null&&r!==void 0?r:!1}function gC(n){return n!==null&&typeof n=="object"&&"tool"in n&&"callTool"in n}async function iZ(n,e,t){const r=new gH,s=JSON.parse(t.data),a=S7(n,s);Object.assign(r,a),e(r)}class aZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),o=cZ(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),c=`${s}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${l}`;let d=()=>{};const h=new Promise(E=>{d=E}),p=e.callbacks,x=function(){d({})},v=this.apiClient,_={onopen:x,onmessage:E=>{iZ(v,p.onmessage,E)},onerror:(t=p?.onerror)!==null&&t!==void 0?t:function(E){},onclose:(r=p?.onclose)!==null&&r!==void 0?r:function(E){}},w=this.webSocketFactory.create(c,lZ(o),_);w.connect(),await h;const j=Un(this.apiClient,e.model),T=TF(this.apiClient,{model:j}),P=cS(this.apiClient,{setup:T});return w.send(JSON.stringify(P)),new oZ(w,this.apiClient)}}class oZ{constructor(e,t){this.conn=e,this.apiClient=t}async setClientContent(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=U9(this.apiClient,e),r=kF(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=V9(this.apiClient,e),r=cS(this.apiClient,t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const t=cS(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(sf.PLAY)}pause(){this.sendPlaybackControl(sf.PAUSE)}stop(){this.sendPlaybackControl(sf.STOP)}resetContext(){this.sendPlaybackControl(sf.RESET_CONTEXT)}close(){this.conn.close()}}function lZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function cZ(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const dZ="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function uZ(n,e,t){const r=new pH;let s;if(t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),n.isVertexAI()){const a=g7(n,s);Object.assign(r,a)}else{const a=p7(n,s);Object.assign(r,a)}e(r)}class fZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new aZ(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,s,a,o,l;const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const p=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&mS(e.config.tools)&&pS(p);const x=gZ(p);if(this.apiClient.isVertexAI())h=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x);else{const B=this.apiClient.getApiKey();h=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${B}`}let v=()=>{};const _=new Promise(B=>{v=B}),w=e.callbacks,j=function(){var B;(B=w?.onopen)===null||B===void 0||B.call(w),v({})},T=this.apiClient,P={onopen:j,onmessage:B=>{uZ(T,w.onmessage,B)},onerror:(t=w?.onerror)!==null&&t!==void 0?t:function(B){},onclose:(r=w?.onclose)!==null&&r!==void 0?r:function(B){}},E=this.webSocketFactory.create(h,pZ(x),P);E.connect(),await _;let M=Un(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&M.startsWith("publishers/")){const B=this.apiClient.getProject(),U=this.apiClient.getLocation();M=`projects/${B}/locations/${U}/`+M}let O={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[sm.AUDIO]}:e.config.responseModalities=[sm.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I=(l=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[],q=[];for(const B of I)if(this.isCallableTool(B)){const U=B;q.push(await U.tool())}else q.push(B);q.length>0&&(e.config.tools=q);const F={model:M,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?O=I9(this.apiClient,F):O=O9(this.apiClient,F),delete O.config,E.send(JSON.stringify(O)),new mZ(E,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const hZ={turnComplete:!0};class mZ{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=Ta(e,t.turns),e.isVertexAI()?r=r.map(s=>Lf(e,s)):r=r.map(s=>Kx(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const a of r){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(dZ)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},hZ),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:z9(this.apiClient,e)}:t={realtimeInput:q9(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function pZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function gZ(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const wM=10;function jM(n){var e,t,r;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const o of(t=n?.tools)!==null&&t!==void 0?t:[])if(tx(o)){s=!0;break}if(!s)return!0;const a=(r=n?.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function tx(n){return"callTool"in n&&typeof n.callTool=="function"}function NM(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class xZ extends Nm{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,s,a,o,l;if(t.config&&t.config.tools&&mS(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),pS(t.config.httpOptions.headers)),!rZ(t)||jM(t.config))return await this.generateContentInternal(t);if(sZ(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");const c=await this.transformCallableTools(t);let d,h;const p=Ta(this.apiClient,c.contents),x=(a=(s=(r=c.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&a!==void 0?a:wM;let v=0;for(;v<x&&(d=await this.generateContentInternal(c),!(!d.functionCalls||d.functionCalls.length===0));){const _=d.candidates[0].content,w=[];for(const j of(l=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[])if(tx(j)){const P=await j.callTool(d.functionCalls);w.push(...P)}v++,h={role:"user",parts:w},c.contents=Ta(this.apiClient,c.contents),c.contents.push(_),c.contents.push(h),NM(c.config)&&(p.push(_),p.push(h))}return NM(c.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async t=>{if(t.config&&t.config.tools&&mS(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),pS(t.config.httpOptions.headers)),jM(t.config)){const r=await this.transformCallableTools(t);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var s;let a;const o=[];if(r?.generatedImages)for(const c of r.generatedImages)c&&c?.safetyAttributes&&((s=c?.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?a=c?.safetyAttributes:o.push(c);let l;return a?l={generatedImages:o,positivePromptSafetyAttributes:a}:l={generatedImages:o},l}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Zx(Sf.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async transformCallableTools(e){var t;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const s=await Promise.all(r.map(async o=>tx(o)?await o.tool():o)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};return a.config.tools=s,a}async initAfcToolsMap(e){var t,r,s;const a=new Map;for(const o of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(tx(o)){const l=o,c=await l.tool();for(const d of(s=c.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(a.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);a.set(d.name,l)}}return a}async processAfcStream(e){var t,r,s;const a=(s=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:wM;let o=!1,l=0;const c=await this.initAfcToolsMap(e);return(function(d,h,p){var x,v;return Yh(this,arguments,function*(){for(var _,w,j,T;l<a;){o&&(l++,o=!1);const O=yield Kn(d.transformCallableTools(p)),I=yield Kn(d.generateContentStreamInternal(O)),q=[],F=[];try{for(var P=!0,E=(w=void 0,ex(I)),M;M=yield Kn(E.next()),_=M.done,!_;P=!0){T=M.value,P=!1;const B=T;if(yield yield Kn(B),B.candidates&&(!((x=B.candidates[0])===null||x===void 0)&&x.content)){F.push(B.candidates[0].content);for(const U of(v=B.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(l<a&&U.functionCall){if(!U.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(U.functionCall.name)){const W=yield Kn(h.get(U.functionCall.name).callTool([U.functionCall]));q.push(...W)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${U.functionCall.name}`)}}}}catch(B){w={error:B}}finally{try{!P&&!_&&(j=E.return)&&(yield Kn(j.call(E)))}finally{if(w)throw w.error}}if(q.length>0){o=!0;const B=new mh;B.candidates=[{content:{role:"user",parts:q}}],yield yield Kn(B);const U=[];U.push(...F),U.push({role:"user",parts:q});const W=Ta(d.apiClient,p.contents).concat(U);p.contents=W}else break}})})(this,c,e)}async generateContentInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=xM(this.apiClient,e);return l=Rt("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=vM(this.apiClient,h),x=new mh;return Object.assign(x,p),x})}else{const d=gM(this.apiClient,e);return l=Rt("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=yM(this.apiClient,h),x=new mh;return Object.assign(x,p),x})}}async generateContentStreamInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=xM(this.apiClient,e);l=Rt("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return Yh(this,arguments,function*(){var x,v,_,w;try{for(var j=!0,T=ex(p),P;P=yield Kn(T.next()),x=P.done,!x;j=!0){w=P.value,j=!1;const M=vM(h,yield Kn(w.json())),O=new mh;Object.assign(O,M),yield yield Kn(O)}}catch(E){v={error:E}}finally{try{!j&&!x&&(_=T.return)&&(yield Kn(_.call(T)))}finally{if(v)throw v.error}}})})}else{const d=gM(this.apiClient,e);l=Rt("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),o.then(function(p){return Yh(this,arguments,function*(){var x,v,_,w;try{for(var j=!0,T=ex(p),P;P=yield Kn(T.next()),x=P.done,!x;j=!0){w=P.value,j=!1;const M=yM(h,yield Kn(w.json())),O=new mh;Object.assign(O,M),yield yield Kn(O)}}catch(E){v={error:E}}finally{try{!j&&!x&&(_=T.return)&&(yield Kn(_.call(T)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=EY(this.apiClient,e);return l=Rt("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=EG(this.apiClient,h),x=new KP;return Object.assign(x,p),x})}else{const d=G7(this.apiClient,e);return l=Rt("{model}:batchEmbedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=uG(this.apiClient,h),x=new KP;return Object.assign(x,p),x})}}async generateImagesInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=IY(this.apiClient,e);return l=Rt("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=IG(this.apiClient,h),x=new JP;return Object.assign(x,p),x})}else{const d=K7(this.apiClient,e);return l=Rt("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=mG(this.apiClient,h),x=new JP;return Object.assign(x,p),x})}}async editImageInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=UY(this.apiClient,e);return a=Rt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=AG(this.apiClient,c),h=new cH;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=BY(this.apiClient,e);return a=Rt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=RG(this.apiClient,c),h=new dH;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=WY(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>uS(this.apiClient,h))}else{const d=J7(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>dS(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=HY(this.apiClient,e);return l=Rt("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=zG(this.apiClient,h),x=new QP;return Object.assign(x,p),x})}else{const d=X7(this.apiClient,e);return l=Rt("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=gG(this.apiClient,h),x=new QP;return Object.assign(x,p),x})}}async update(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=GY(this.apiClient,e);return l=Rt("{model}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>uS(this.apiClient,h))}else{const d=tY(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>dS(this.apiClient,h))}}async delete(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=ZY(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=UG(),p=new XP;return Object.assign(p,h),p})}else{const d=nY(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(()=>{const h=xG(),p=new XP;return Object.assign(p,h),p})}}async countTokens(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=JY(this.apiClient,e);return l=Rt("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=VG(this.apiClient,h),x=new eM;return Object.assign(x,p),x})}else{const d=sY(this.apiClient,e);return l=Rt("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=yG(this.apiClient,h),x=new eM;return Object.assign(x,p),x})}}async computeTokens(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=QY(this.apiClient,e);return a=Rt("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=BG(this.apiClient,c),h=new uH;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=eG(this.apiClient,e);return l=Rt("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>YG(this.apiClient,h))}else{const d=oY(this.apiClient,e);return l=Rt("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>wG(this.apiClient,h))}}}function yZ(n,e){const t={},r=N(e,["operationName"]);r!=null&&S(t,["_url","operationName"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function vZ(n,e){const t={},r=N(e,["operationName"]);r!=null&&S(t,["_url","operationName"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function bZ(n,e){const t={},r=N(e,["operationName"]);r!=null&&S(t,["operationName"],r);const s=N(e,["resourceName"]);s!=null&&S(t,["_url","resourceName"],s);const a=N(e,["config"]);return a!=null&&S(t,["config"],a),t}function _Z(n,e){const t={},r=N(e,["video","uri"]);r!=null&&S(t,["uri"],r);const s=N(e,["video","encodedVideo"]);s!=null&&S(t,["videoBytes"],Zc(n,s));const a=N(e,["encoding"]);return a!=null&&S(t,["mimeType"],a),t}function wZ(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],_Z(n,r)),t}function jZ(n,e){const t={},r=N(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>wZ(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function NZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response","generateVideoResponse"]);return l!=null&&S(t,["response"],jZ(n,l)),t}function SZ(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["uri"],r);const s=N(e,["bytesBase64Encoded"]);s!=null&&S(t,["videoBytes"],Zc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function CZ(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],SZ(n,r)),t}function TZ(n,e){const t={},r=N(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>CZ(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function SM(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],TZ(n,l)),t}class kZ extends Nm{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;return r&&"httpOptions"in r&&(a=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=vZ(this.apiClient,e);return l=Rt("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>SM(this.apiClient,h))}else{const d=yZ(this.apiClient,e);return l=Rt("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>NZ(this.apiClient,h))}}async fetchPredictVideosOperationInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=bZ(this.apiClient,e);return a=Rt("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>SM(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}function PZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function MZ(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);return t!==void 0&&o!=null&&S(t,["_query","filter"],o),r}function DZ(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],MZ(n,r,t)),t}function EZ(n,e){const t={},r=N(e,["textInput"]);r!=null&&S(t,["textInput"],r);const s=N(e,["output"]);return s!=null&&S(t,["output"],s),t}function OZ(n,e){const t={};if(N(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=N(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>EZ(n,a))),S(t,["examples","examples"],s)}return t}function IZ(n,e,t){const r={};if(N(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=N(e,["tunedModelDisplayName"]);if(t!==void 0&&s!=null&&S(t,["displayName"],s),N(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=N(e,["epochCount"]);t!==void 0&&a!=null&&S(t,["tuningTask","hyperparameters","epochCount"],a);const o=N(e,["learningRateMultiplier"]);if(o!=null&&S(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),N(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(N(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=N(e,["batchSize"]);t!==void 0&&l!=null&&S(t,["tuningTask","hyperparameters","batchSize"],l);const c=N(e,["learningRate"]);return t!==void 0&&c!=null&&S(t,["tuningTask","hyperparameters","learningRate"],c),r}function AZ(n,e){const t={},r=N(e,["baseModel"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["trainingDataset"]);s!=null&&S(t,["tuningTask","trainingData"],OZ(n,s));const a=N(e,["config"]);return a!=null&&S(t,["config"],IZ(n,a,t)),t}function RZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function LZ(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);return t!==void 0&&o!=null&&S(t,["_query","filter"],o),r}function FZ(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],LZ(n,r,t)),t}function qZ(n,e,t){const r={},s=N(e,["gcsUri"]);if(t!==void 0&&s!=null&&S(t,["supervisedTuningSpec","trainingDatasetUri"],s),N(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function zZ(n,e){const t={},r=N(e,["gcsUri"]);return r!=null&&S(t,["validationDatasetUri"],r),t}function UZ(n,e,t){const r={},s=N(e,["validationDataset"]);t!==void 0&&s!=null&&S(t,["supervisedTuningSpec"],zZ(n,s));const a=N(e,["tunedModelDisplayName"]);t!==void 0&&a!=null&&S(t,["tunedModelDisplayName"],a);const o=N(e,["description"]);t!==void 0&&o!=null&&S(t,["description"],o);const l=N(e,["epochCount"]);t!==void 0&&l!=null&&S(t,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=N(e,["learningRateMultiplier"]);t!==void 0&&c!=null&&S(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=N(e,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&S(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=N(e,["adapterSize"]);if(t!==void 0&&h!=null&&S(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),N(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(N(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function VZ(n,e){const t={},r=N(e,["baseModel"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["trainingDataset"]);s!=null&&S(t,["supervisedTuningSpec","trainingDatasetUri"],qZ(n,s,t));const a=N(e,["config"]);return a!=null&&S(t,["config"],UZ(n,a,t)),t}function BZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["model"],r);const s=N(e,["name"]);return s!=null&&S(t,["endpoint"],s),t}function IF(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["state"]);s!=null&&S(t,["state"],vF(n,s));const a=N(e,["createTime"]);a!=null&&S(t,["createTime"],a);const o=N(e,["tuningTask","startTime"]);o!=null&&S(t,["startTime"],o);const l=N(e,["tuningTask","completeTime"]);l!=null&&S(t,["endTime"],l);const c=N(e,["updateTime"]);c!=null&&S(t,["updateTime"],c);const d=N(e,["description"]);d!=null&&S(t,["description"],d);const h=N(e,["baseModel"]);h!=null&&S(t,["baseModel"],h);const p=N(e,["_self"]);p!=null&&S(t,["tunedModel"],BZ(n,p));const x=N(e,["distillationSpec"]);x!=null&&S(t,["distillationSpec"],x);const v=N(e,["experiment"]);v!=null&&S(t,["experiment"],v);const _=N(e,["labels"]);_!=null&&S(t,["labels"],_);const w=N(e,["pipelineJob"]);w!=null&&S(t,["pipelineJob"],w);const j=N(e,["tunedModelDisplayName"]);return j!=null&&S(t,["tunedModelDisplayName"],j),t}function WZ(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["tunedModels"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>IF(n,o))),S(t,["tuningJobs"],a)}return t}function $Z(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);return o!=null&&S(t,["error"],o),t}function HZ(n,e){const t={},r=N(e,["checkpointId"]);r!=null&&S(t,["checkpointId"],r);const s=N(e,["epoch"]);s!=null&&S(t,["epoch"],s);const a=N(e,["step"]);a!=null&&S(t,["step"],a);const o=N(e,["endpoint"]);return o!=null&&S(t,["endpoint"],o),t}function YZ(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["model"],r);const s=N(e,["endpoint"]);s!=null&&S(t,["endpoint"],s);const a=N(e,["checkpoints"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>HZ(n,l))),S(t,["checkpoints"],o)}return t}function gS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["state"]);s!=null&&S(t,["state"],vF(n,s));const a=N(e,["createTime"]);a!=null&&S(t,["createTime"],a);const o=N(e,["startTime"]);o!=null&&S(t,["startTime"],o);const l=N(e,["endTime"]);l!=null&&S(t,["endTime"],l);const c=N(e,["updateTime"]);c!=null&&S(t,["updateTime"],c);const d=N(e,["error"]);d!=null&&S(t,["error"],d);const h=N(e,["description"]);h!=null&&S(t,["description"],h);const p=N(e,["baseModel"]);p!=null&&S(t,["baseModel"],p);const x=N(e,["tunedModel"]);x!=null&&S(t,["tunedModel"],YZ(n,x));const v=N(e,["supervisedTuningSpec"]);v!=null&&S(t,["supervisedTuningSpec"],v);const _=N(e,["tuningDataStats"]);_!=null&&S(t,["tuningDataStats"],_);const w=N(e,["encryptionSpec"]);w!=null&&S(t,["encryptionSpec"],w);const j=N(e,["partnerModelTuningSpec"]);j!=null&&S(t,["partnerModelTuningSpec"],j);const T=N(e,["distillationSpec"]);T!=null&&S(t,["distillationSpec"],T);const P=N(e,["experiment"]);P!=null&&S(t,["experiment"],P);const E=N(e,["labels"]);E!=null&&S(t,["labels"],E);const M=N(e,["pipelineJob"]);M!=null&&S(t,["pipelineJob"],M);const O=N(e,["tunedModelDisplayName"]);return O!=null&&S(t,["tunedModelDisplayName"],O),t}function GZ(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["tuningJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>gS(n,o))),S(t,["tuningJobs"],a)}return t}class ZZ extends Nm{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Zx(Sf.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:iS.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=RZ(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>gS(this.apiClient,h))}else{const d=PZ(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>IF(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=FZ(this.apiClient,e);return l=Rt("tuningJobs",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=GZ(this.apiClient,h),x=new tM;return Object.assign(x,p),x})}else{const d=DZ(this.apiClient,e);return l=Rt("tunedModels",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=WZ(this.apiClient,h),x=new tM;return Object.assign(x,p),x})}}async tuneInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=VZ(this.apiClient,e);return a=Rt("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>gS(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=AZ(this.apiClient,e);return a=Rt("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>$Z(this.apiClient,c))}}}class KZ{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const JZ=1024*1024*8,QZ=3,XZ=1e3,eK=2,sb="x-goog-upload-status";async function tK(n,e,t){var r,s,a;let o=0,l=0,c=new aS(new Response),d="upload";for(o=n.size;l<o;){const p=Math.min(JZ,o-l),x=n.slice(l,l+p);l+p>=o&&(d+=", finalize");let v=0,_=XZ;for(;v<QZ&&(c=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(p)}}}),!(!((r=c?.headers)===null||r===void 0)&&r[sb]));)v++,await rK(_),_=_*eK;if(l+=p,((s=c?.headers)===null||s===void 0?void 0:s[sb])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await c?.json();if(((a=c?.headers)===null||a===void 0?void 0:a[sb])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function nK(n){return{size:n.size,type:n.type}}function rK(n){return new Promise(e=>setTimeout(e,n))}class sK{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await tK(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await nK(e)}}class iK{create(e,t,r){return new aK(e,t,r)}}class aK{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const CM="x-goog-api-key";class oK{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(CM)===null&&e.append(CM,this.apiKey)}}const lK="gl-node/";class cK{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=lH(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new oK(this.apiKey);this.apiClient=new tZ({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:lK+"web",uploader:new sK,downloader:new KZ}),this.models=new xZ(this.apiClient),this.live=new fZ(this.apiClient,s,new iK),this.chats=new T8(this.models,this.apiClient),this.caches=new N8(this.apiClient),this.files=new z8(this.apiClient),this.operations=new kZ(this.apiClient),this.tunings=new ZZ(this.apiClient)}}const im="onboarding-documents",xS="avatars",TM="support-attachments",ph="logo",gh="background",dK="task-attachments",uK="your-google-genai-api-key";let fl=null;fl=new cK({apiKey:uK});const yS=n=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(yS);const e={...n};if(typeof e.name=="string"&&typeof e.path=="string"){const t=e.path.startsWith("avatars/")?xS:im,{data:{publicUrl:r}}=Me.storage.from(t).getPublicUrl(e.path);e.preview=r,e.url=r}for(const t in e)e[t]=yS(e[t]);return e},vS=async(n,e,t)=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return Promise.all(n.map(s=>vS(s,e,t)));const r={...n};if(r.file instanceof File){const s=r.file,a=`${e}/documents/${Date.now()}_${s.name}`,{error:o}=await Me.storage.from(im).upload(a,s);if(o)throw o;try{await Me.from("user_documents").insert({user_id:e,submission_id:t||null,name:r.name||s.name,bucket:im,path:a,file_type:s.type,file_size:s.size})}catch(l){console.error("Failed to record uploaded document:",l)}return{name:r.name||s.name,type:s.type,size:s.size,path:a}}if(typeof r.name=="string"&&r.path)return{name:r.name,type:r.type,size:r.size,path:r.path};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(r[s]=await vS(r[s],e,t));return r},fK=async n=>await(await fetch(n)).blob(),fn=n=>{if(Array.isArray(n))return n.map(e=>fn(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)&&!(n instanceof File)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/[A-Z]/g,s=>`_${s.toLowerCase()}`);e[r]=fn(n[t])}return e}return n},gt=n=>{if(Array.isArray(n))return n.map(e=>gt(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/_([a-z])/g,s=>s[1].toUpperCase());e[r]=gt(n[t])}return yS(e)}return n},ue={getInitialAppData:async()=>{const{data:n,error:e}=await Me.from("settings").select("*").eq("id","singleton").single();if(e)throw new Error("Failed to fetch core application settings.");const{data:t,error:r}=await Me.from("roles").select("*");if(r)throw new Error("Failed to fetch user roles.");const{data:s,error:a}=await Me.from("holidays").select("*");if(a)throw new Error("Failed to fetch holidays.");return{settings:gt(n),roles:(t||[]).map(gt),holidays:(s||[]).map(gt)}},getVerificationSubmissions:async(n,e)=>{let t=Me.from("onboarding_submissions").select("*");n&&(t=t.eq("status",n)),e&&(t=t.eq("organization_id",e));const{data:r,error:s}=await t.order("created_at",{ascending:!1});if(s)throw s;return(r||[]).map(gt)},getOnboardingDataById:async n=>{const{data:e,error:t}=await Me.from("onboarding_submissions").select("*").eq("id",n).single();if(t&&t.code!=="PGRST116")throw t;return e?gt(e):null},_saveSubmission:async(n,e)=>{const{data:{session:t}}=await Me.auth.getSession();if(!t?.user)throw new Error("User not authenticated");const r=n.id&&!n.id.startsWith("draft_")?n.id:crypto.randomUUID(),s=await vS(n,t.user.id,r),a={...fn(s),id:r,user_id:t.user.id,status:e?"draft":n.status};delete a.file,delete a.confirm_account_number;const{data:o,error:l}=await Me.from("onboarding_submissions").upsert(a,{onConflict:"id"}).select("id").single();if(l)throw l;return{draftId:o.id}},saveDraft:async n=>ue._saveSubmission(n,!0),submitOnboarding:async n=>{const{draftId:e}=await ue._saveSubmission(n,!1),t=await ue.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve submitted data.");return t},updateOnboarding:async n=>{const{draftId:e}=await ue._saveSubmission(n,n.status==="draft"),t=await ue.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve updated data.");return t},verifySubmission:async n=>{const{error:e}=await Me.from("onboarding_submissions").update({status:"verified",portal_sync_status:"pending_sync"}).eq("id",n);if(e)throw e},requestChanges:async(n,e)=>{const{error:t}=await Me.from("onboarding_submissions").update({status:"rejected"}).eq("id",n);if(t)throw t},syncPortals:async n=>{const{data:e,error:t}=await Me.functions.invoke("sync-portals",{body:{submissionId:n}});if(t)throw t;return gt(e)},deleteFile:async n=>{const{error:e}=await Me.storage.from(im).remove([n]);if(e)throw e},uploadDocument:async(n,e=im,t,r)=>{const{data:{session:s}}=await Me.auth.getSession(),a=s?.user?.id||"anonymous_user",o=`${a}/documents/${Date.now()}_${n.name}`,{error:l}=await Me.storage.from(e).upload(o,n);if(l)throw l;const{data:c}=Me.storage.from(e).getPublicUrl(o);if(!c.publicUrl)throw new Error("Could not get public URL for uploaded file.");try{await Me.from("user_documents").insert({user_id:a,submission_id:t||null,name:r||n.name,bucket:e,path:o,file_type:n.type,file_size:n.size})}catch(d){console.error("Failed to insert user_documents record:",d)}return{url:c.publicUrl,path:o}},getUsers:async()=>{const{data:n,error:e}=await Me.from("users").select("*, role_id");if(e)throw e;return(n||[]).map(t=>gt({...t,role:t.role_id}))},getUsersWithManagers:async()=>{const{data:n,error:e}=await Me.from("users").select("*, reporting_manager_id, role_id");if(e)throw e;const t=(n||[]).map(s=>gt({...s,role:s.role_id})),r=new Map(t.map(s=>[s.id,s.name]));return t.map(s=>({...s,managerName:s.reportingManagerId?r.get(s.reportingManagerId):void 0}))},getFieldOfficers:async()=>ue.getUsers().then(n=>n.filter(e=>e.role==="field_officer")),getNearbyUsers:async()=>{const n=await ue.getUsers();let e={};try{const t=new Date;t.setHours(0,0,0,0);const r=new Date,s=await ue.getAllAttendanceEvents(t.toISOString(),r.toISOString()),a={};s.forEach(o=>{const{userId:l,type:c,timestamp:d}=o;l&&(!a[l]||new Date(d)>new Date(a[l].timestamp))&&(a[l]={type:c.toLowerCase(),timestamp:d})}),e=Object.fromEntries(Object.entries(a).map(([o,l])=>{const c=l.type.toLowerCase().replace(/[-_\s]/g,""),d=c==="checkin";return console.log(`User ${o}: latest event type = "${l.type}", normalized = "${c}", isCheckIn = ${d}`),[o,d]}))}catch(t){console.warn("Failed to compute user availability:",t)}return n.map(t=>({...t,isAvailable:e[t.id]??!1}))},updateUser:async(n,e)=>{const{role:t,...r}=e,s=fn(r);if(t&&(s.role_id=t),"photo_url"in s){const{data:{session:l}}=await Me.auth.getSession();if(!l?.user)throw new Error("User not authenticated for photo upload");const c=l.user.id,{data:d}=await Me.from("users").select("photo_url").eq("id",n).single(),h=d?.photo_url,p=async x=>{if(x)try{const _=new URL(x).pathname.split("/public/")[1];if(_){const[w,...j]=_.split("/"),T=j.join("/");T&&await Me.storage.from(w).remove([T])}}catch(v){console.error("Failed to process old avatar URL for deletion:",v)}};if(s.photo_url&&s.photo_url.startsWith("data:")){await p(h);const x=await fK(s.photo_url),v=s.photo_url.split(";")[0].split("/")[1]||"jpg",_=`${c}/${Date.now()}.${v}`,{error:w}=await Me.storage.from(xS).upload(_,x,{upsert:!0});if(w)throw w;const{data:{publicUrl:j}}=Me.storage.from(xS).getPublicUrl(_);s.photo_url=j}else s.photo_url===null&&await p(h)}const{data:a,error:o}=await Me.from("users").update(s).eq("id",n).select().single();if(o)throw o;return gt({...a,role:a.role_id})},createUser:async n=>{const{role:e,...t}=n,r=fn(t);e&&(r.role_id=e);const{data:s,error:a}=await Me.from("users").insert(r).select().single();if(a)throw a;return gt({...s,role:s.role_id})},deleteUser:async n=>{const{error:e}=await Me.from("users").delete().eq("id",n);if(e)throw e},updateUserReportingManager:async(n,e)=>{const{error:t}=await Me.from("users").update({reporting_manager_id:e}).eq("id",n);if(t)throw t},getOrganizations:async()=>{const{data:n,error:e}=await Me.from("organizations").select("*").order("short_name");if(e)throw e;return(n||[]).map(gt)},createOrganization:async n=>{const{data:e,error:t}=await Me.from("organizations").insert(fn(n)).select().single();if(t)throw t;return gt(e)},getOrganizationStructure:async()=>{const{data:n,error:e}=await Me.from("organization_groups").select("*");if(e)throw e;const{data:t,error:r}=await Me.from("companies").select("*");if(r)throw r;const{data:s,error:a}=await Me.from("entities").select("*");if(a)throw a;const o=(n||[]).map(gt),l=(t||[]).map(gt),c=(s||[]).map(gt),d=new Map;return l.forEach(h=>{const p={...h,entities:c.filter(x=>x.companyId===h.id)};d.has(h.groupId)||d.set(h.groupId,[]),d.get(h.groupId).push(p)}),o.map(h=>({...h,companies:d.get(h.id)||[],locations:[]}))},getSiteConfigurations:async()=>{const{data:n,error:e}=await Me.from("site_configurations").select("*");if(e)throw e;return(n||[]).map(gt)},bulkUploadOrganizations:async n=>{const{count:e,error:t}=await Me.from("organizations").upsert(fn(n),{onConflict:"id"});if(t)throw t;return{count:e||0}},getModules:async()=>{const{data:n,error:e}=await Me.from("app_modules").select("*");if(e)throw e;return(n||[]).map(gt)},saveModules:async n=>{const{error:e}=await Me.from("app_modules").upsert(fn(n));if(e)throw e},getRoles:async()=>{const{data:n,error:e}=await Me.from("roles").select("*");if(e)throw e;return(n||[]).map(gt)},saveRoles:async n=>{const{error:e}=await Me.from("roles").upsert(fn(n));if(e)throw e},getHolidays:async()=>{const{data:n,error:e}=await Me.from("holidays").select("*");if(e)throw e;return(n||[]).map(gt)},addHoliday:async n=>{const{data:e,error:t}=await Me.from("holidays").insert(fn(n)).select().single();if(t)throw t;return gt(e)},removeHoliday:async n=>{const{error:e}=await Me.from("holidays").delete().eq("id",n);if(e)throw e},getAttendanceEvents:async(n,e,t)=>{const{data:r,error:s}=await Me.from("attendance_events").select("*").eq("user_id",n).gte("timestamp",e).lte("timestamp",t);if(s)throw s;return(r||[]).map(gt)},getAllAttendanceEvents:async(n,e)=>{const{data:t,error:r}=await Me.from("attendance_events").select("*").gte("timestamp",n).lte("timestamp",e);if(r)throw r;return(t||[]).map(gt)},getAttendanceDashboardData:async(n,e,t,r="UTC")=>{const{data:s,error:a}=await Me.rpc("get_attendance_dashboard_data",{start_date_iso:$e(n,"yyyy-MM-dd"),end_date_iso:$e(e,"yyyy-MM-dd"),current_date_iso:$e(t,"yyyy-MM-dd"),p_timezone:r});if(a)throw new Error("Could not load attendance dashboard data from the database function.");return s},addAttendanceEvent:async n=>{const{error:e}=await Me.from("attendance_events").insert(fn(n));if(e)throw e},getLocations:async()=>{const{data:n,error:e}=await Me.from("locations").select("*, created_by_user:created_by (id, name)");if(e)throw e;return(n||[]).map(t=>{const r=gt(t),a=r.createdByUser?.name||void 0,{createdByUser:o,...l}=r;return{...l,createdByName:a}})},getUserLocations:async n=>{const{data:e,error:t}=await Me.from("user_locations").select("location_id:location_id (*), id").eq("user_id",n);if(t)throw t;return(e||[]).map(r=>{const s=r.location_id||{};return gt(s)})},createLocation:async n=>{const e=fn(n),{data:t,error:r}=await Me.from("locations").insert(e).select("*").single();if(r)throw r;return gt(t)},assignLocationToUser:async(n,e)=>{const{error:t}=await Me.from("user_locations").insert({user_id:n,location_id:e});if(t)throw t},updateLocation:async(n,e)=>{const t=fn(e),{data:r,error:s}=await Me.from("locations").update(t).eq("id",n).select("*").single();if(s)throw s;return gt(r)},deleteLocation:async n=>{const{error:e}=await Me.from("locations").delete().eq("id",n);if(e)throw e},unassignLocationFromUser:async(n,e)=>{const{error:t}=await Me.from("user_locations").delete().match({user_id:n,location_id:e});if(t)throw t},uploadLogo:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await Me.storage.from(ph).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:s}}=Me.storage.from(ph).getPublicUrl(t);return s},getLogos:async()=>{const{data:n,error:e}=await Me.storage.from(ph).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=Me.storage.from(ph).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteLogo:async n=>{const{error:e}=await Me.storage.from(ph).remove([n]);if(e)throw e},uploadBackground:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await Me.storage.from(gh).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:s}}=Me.storage.from(gh).getPublicUrl(t);return s},getBackgroundImages:async()=>{const{data:n,error:e}=await Me.storage.from(gh).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=Me.storage.from(gh).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteBackground:async n=>{const{error:e}=await Me.storage.from(gh).remove([n]);if(e)throw e},getAttendanceSettings:async()=>{const{data:n,error:e}=await Me.from("settings").select("attendance_settings").eq("id","singleton").single();if(e)throw e;if(!n?.attendance_settings)throw new Error("Attendance settings are not configured.");return gt(n.attendance_settings)},saveAttendanceSettings:async n=>{const{error:e}=await Me.from("settings").upsert({id:"singleton",attendance_settings:fn(n),updated_at:new Date().toISOString()},{onConflict:"id"});if(e)throw console.error("Error saving attendance settings:",e),e},getRecurringHolidays:async()=>{const{data:n,error:e}=await Me.from("recurring_holidays").select("*");if(e)throw e;return(n||[]).map(t=>({id:t.id,type:t.role_type,day:t.day,n:t.occurrence}))},addRecurringHoliday:async n=>{const e={role_type:n.type||"office",day:n.day,occurrence:n.n},{data:t,error:r}=await Me.from("recurring_holidays").insert(e).select().single();if(r)throw r;return{id:t.id,type:t.role_type,day:t.day,n:t.occurrence}},deleteRecurringHoliday:async n=>{const{error:e}=await Me.from("recurring_holidays").delete().eq("id",n);if(e)throw e},createAssignment:async(n,e,t)=>{const r=(await ue.getOrganizations()).find(s=>s.id===e);await ue.createTask({name:`Visit ${r?.shortName||"site"} for verification`,description:`Perform on-site duties and verification tasks for ${r?.shortName}.`,dueDate:t,priority:"Medium",assignedToId:n})},getLeaveBalancesForUser:async n=>{const e=w=>["hr","admin","finance"].includes(w)?"office":"field",{data:t,error:r}=await Me.from("settings").select("attendance_settings").eq("id","singleton").single();if(r||!t?.attendance_settings)throw new Error("Could not load attendance rules.");const{data:s,error:a}=await Me.from("users").select("role_id").eq("id",n).single();if(a)throw a;const o=e(s.role_id),l=gt(t.attendance_settings)[o],[{data:c,error:d},{data:h,error:p},{data:x,error:v}]=await Promise.all([Me.from("leave_requests").select("leave_type, start_date, end_date, day_option").eq("user_id",n).eq("status","approved"),Me.from("comp_off_logs").select("*").eq("user_id",n),Me.from("extra_work_logs").select("hours_worked").eq("user_id",n).eq("claim_type","OT").eq("status","Approved").gte("work_date",$e(mi(new Date),"yyyy-MM-dd")).lte("work_date",$e(Ca(new Date),"yyyy-MM-dd"))]);if(d||p||v)throw new Error("Failed to fetch all leave balance data.");const _={userId:n,earnedTotal:l.annualEarnedLeaves||0,earnedUsed:0,sickTotal:l.annualSickLeaves||0,sickUsed:0,floatingTotal:(l.monthlyFloatingLeaves||0)*12,floatingUsed:0,compOffTotal:(h||[]).length,compOffUsed:(h||[]).filter(w=>w.status==="used").length,otHoursThisMonth:(x||[]).reduce((w,j)=>w+(j.hours_worked||0),0)};return(c||[]).forEach(w=>{const j=w.day_option==="half"?.5:jm(new Date(w.end_date),new Date(w.start_date))+1;w.leave_type==="Earned"&&(_.earnedUsed+=j),w.leave_type==="Sick"&&(_.sickUsed+=j),w.leave_type==="Floating"&&(_.floatingUsed+=j)}),_},submitLeaveRequest:async n=>{const{data:e,error:t}=await Me.from("users").select("reporting_manager_id").eq("id",n.userId).single();if(t)throw t;const{data:r,error:s}=await Me.from("leave_requests").insert({...fn(n),status:"pending_manager_approval",current_approver_id:e.reporting_manager_id||null,approval_history:[]}).select("*").single();if(s)throw s;return gt(r)},getLeaveRequests:async n=>{let e=Me.from("leave_requests").select("*");n?.userId&&(e=e.eq("user_id",n.userId)),n?.userIds&&(e=e.in("user_id",n.userIds)),n?.status&&(e=e.eq("status",n.status)),n?.forApproverId&&(e=e.eq("current_approver_id",n.forApproverId)),n?.startDate&&n?.endDate&&(e=e.lte("start_date",n.endDate).gte("end_date",n.startDate));const{data:t,error:r}=await e.order("start_date",{ascending:!1});if(r)throw r;return(t||[]).map(gt)},getTasks:async()=>{const{data:n,error:e}=await Me.from("tasks").select("*").order("created_at",{ascending:!1});if(e)throw e;return(n||[]).map(gt)},createTask:async n=>{const{data:e,error:t}=await Me.from("tasks").insert(fn({...n,status:"To Do",escalationStatus:"None"})).select().single();if(t)throw t;return gt(e)},updateTask:async(n,e)=>{if(e?.completionPhoto&&e.completionPhoto.file){const s=e.completionPhoto,a=s.file;try{const{path:o}=await ue.uploadDocument(a,dK);e.completionPhoto={name:s.name,type:s.type,size:s.size,path:o}}catch(o){console.error("Failed to upload task completion photo:",o),delete e.completionPhoto}}const{data:t,error:r}=await Me.from("tasks").update(fn(e)).eq("id",n).select().single();if(r)throw r;return gt(t)},deleteTask:async n=>{const{error:e}=await Me.from("tasks").delete().eq("id",n);if(e)throw e},runAutomaticEscalations:async()=>{const{data:n,error:e}=await Me.functions.invoke("run-escalations");if(e)throw e;return gt(n)},getNotifications:async n=>{const{data:e,error:t}=await Me.from("notifications").select("*").eq("user_id",n).order("created_at",{ascending:!1});if(t)throw t;return(e||[]).map(gt)},createNotification:async n=>{const{data:e,error:t}=await Me.from("notifications").insert(fn(n)).select().single();if(t)throw t;return gt(e)},markNotificationAsRead:async n=>{await Me.from("notifications").update({is_read:!0}).eq("id",n)},markAllNotificationsAsRead:async n=>{await Me.from("notifications").update({is_read:!0}).eq("user_id",n).eq("is_read",!1)},createAuthUser:async n=>{const{name:e,email:t,password:r,role:s}=n;try{const{error:a}=await Me.functions.invoke("admin-create-user",{body:{name:e,email:t,password:r,role:s}});if(a)throw a;const l=(await ue.getUsers()).find(c=>c.email===t);if(l)return l;console.warn("admin-create-user completed but user not found; falling back to client side signup")}catch(a){const o=typeof a?.message=="string"?a.message:String(a);if(!o.toLowerCase().includes("failed to send a request")&&!o.toLowerCase().includes("edge function"))throw a;console.warn("Edge function not reachable, falling back to client side signup");const{data:l,error:c}=await Me.auth.signUp({email:t,password:r,options:{data:{name:e}}});if(c||!l?.user)throw c||new Error("Failed to sign up user");const d=l.user;try{await Me.from("users").upsert({id:d.id,name:e,email:t,role_id:s},{onConflict:"id"})}catch(h){console.warn("Failed to upsert user profile after fallback signup:",h)}return{id:d.id,name:e,email:t,role:s,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}}return{id:"",name:e,email:t,role:s,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}},getPolicies:async()=>{const{data:n,error:e}=await Me.from("policies").select("*");if(e)throw e;return(n||[]).map(gt)},createPolicy:async n=>{const{data:e,error:t}=await Me.from("policies").insert(fn(n)).select().single();if(t)throw t;return gt(e)},getInsurances:async()=>{const{data:n,error:e}=await Me.from("insurances").select("*");if(e)throw e;return(n||[]).map(gt)},createInsurance:async n=>{const{data:e,error:t}=await Me.from("insurances").insert(fn(n)).select().single();if(t)throw t;return gt(e)},getApprovalWorkflowSettings:async()=>{const{data:n,error:e}=await Me.from("settings").select("approval_workflow_settings").eq("id","singleton").single();if(e)throw e;if(!n?.approval_workflow_settings)throw new Error("Approval workflow settings are not configured.");return gt(n.approval_workflow_settings)},updateApprovalWorkflowSettings:async n=>{const{error:e}=await Me.from("settings").update({approval_workflow_settings:fn({finalConfirmationRole:n})}).eq("id","singleton");if(e)throw e},approveLeaveRequest:async(n,e)=>{const{data:t,error:r}=await Me.from("leave_requests").select("approval_history").eq("id",n).single();if(r)throw r;const{finalConfirmationRole:s}=await ue.getApprovalWorkflowSettings(),{data:a}=await Me.from("users").select("id").eq("role_id",s).limit(1).single(),{data:o,error:l}=await Me.from("users").select("name").eq("id",e).single();if(l)throw l;const c={approver_id:e,approver_name:o.name,status:"approved",timestamp:new Date().toISOString()},d=[...t.approval_history||[],c],{error:h}=await Me.from("leave_requests").update({status:"pending_hr_confirmation",current_approver_id:a?.id,approval_history:d}).eq("id",n);if(h)throw h},rejectLeaveRequest:async(n,e,t="")=>{const{data:r,error:s}=await Me.from("leave_requests").select("approval_history").eq("id",n).single();if(s)throw s;const{data:a,error:o}=await Me.from("users").select("name").eq("id",e).single();if(o)throw o;const l={approver_id:e,approver_name:a.name,status:"rejected",timestamp:new Date().toISOString(),comments:t},c=[...r.approval_history||[],l],{error:d}=await Me.from("leave_requests").update({status:"rejected",current_approver_id:null,approval_history:c}).eq("id",n);if(d)throw d},confirmLeaveByHR:async(n,e)=>{const{data:t,error:r}=await Me.from("leave_requests").select("leave_type, user_id, approval_history").eq("id",n).single();if(r)throw r;const{data:s,error:a}=await Me.from("users").select("name").eq("id",e).single();if(a)throw a;const o={approver_id:e,approver_name:s.name,status:"approved",timestamp:new Date().toISOString(),comments:"Final approval."},l=[...t.approval_history||[],o],{error:c}=await Me.from("leave_requests").update({status:"approved",current_approver_id:null,approval_history:l}).eq("id",n);if(c)throw c;if(t.leave_type==="Comp Off"){const{data:d,error:h}=await Me.from("comp_off_logs").select("id").eq("user_id",t.user_id).eq("status","earned").limit(1).single();if(h&&h.code!=="PGRST116")throw h;d&&await Me.from("comp_off_logs").update({status:"used",leave_request_id:n}).eq("id",d.id)}},submitExtraWorkClaim:async n=>{const{error:e}=await Me.from("extra_work_logs").insert(fn({...n,status:"Pending"}));if(e)throw e},getExtraWorkLogs:async n=>{let e=Me.from("extra_work_logs").select("*");n?e=e.eq("user_id",n):e=e.eq("status","Pending");const{data:t,error:r}=await e.order("work_date",{ascending:!1});if(r)throw r;return(t||[]).map(gt)},approveExtraWorkClaim:async(n,e)=>{const{data:t,error:r}=await Me.from("users").select("name").eq("id",e).single();if(r)throw r;const{data:s,error:a}=await Me.from("extra_work_logs").select("*").eq("id",n).single();if(a)throw a;if(!s)throw new Error("Claim not found.");const{error:o}=await Me.from("extra_work_logs").update({status:"Approved",approver_id:e,approver_name:t.name,approved_at:new Date().toISOString()}).eq("id",n);if(o)throw o;s.claim_type==="Comp Off"&&await ue.addCompOffLog({userId:s.user_id,userName:s.user_name,dateEarned:s.work_date,reason:`Claim approved: ${s.reason}`,status:"earned",grantedById:e,grantedByName:t.name})},rejectExtraWorkClaim:async(n,e,t)=>{const{data:r,error:s}=await Me.from("users").select("name").eq("id",e).single();if(s)throw s;const{error:a}=await Me.from("extra_work_logs").update({status:"Rejected",approver_id:e,approver_name:r.name,rejection_reason:t}).eq("id",n);if(a)throw a},getManpowerDetails:async n=>{const{data:e,error:t}=await Me.rpc("get_manpower_details",{site_id_param:n});if(t)throw t;return gt(e)},addCompOffLog:async n=>{const{data:e,error:t}=await Me.from("comp_off_logs").insert(fn(n)).select().single();if(t)throw t;return gt(e)},exportAllData:async()=>{const n=["users","organizations","onboarding_submissions","settings"],e={};for(const t of n){const{data:r,error:s}=await Me.from(t).select("*");if(s)throw new Error(`Failed to export ${t}`);e[t]=r}return gt(e)},getPincodeDetails:async n=>new Promise(e=>setTimeout(()=>e({city:"Bengaluru",state:"Karnataka"}),500)),suggestDepartmentForDesignation:async n=>{const e={"Security Guard":"Security","Housekeeping Staff":"Housekeeping","Site Manager":"Management"},t=Object.keys(e).find(r=>n.toLowerCase().includes(r.toLowerCase()));return Promise.resolve(t?e[t]:null)},verifyBankAccountWithPerfios:async n=>{console.log("Mock verifying bank account:",n),await new Promise(t=>setTimeout(t,1500));const e=Math.random()>.1;return{success:e,message:e?"Bank account verified successfully.":"Account holder name did not match.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:e,uan:null,esi:null,accountHolderName:e,accountNumber:e,ifscCode:!0}}},verifyAadhaar:async n=>{console.log("Mock verifying Aadhaar:",n),await new Promise(t=>setTimeout(t,1e3));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"Aadhaar details verified.":"Invalid Aadhaar number.",verifiedFields:{name:null,dob:null,aadhaar:e,bank:null,uan:null,esi:null}}},lookupUan:async n=>{console.log("Mock looking up UAN:",n),await new Promise(t=>setTimeout(t,1200));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"UAN found and linked.":"UAN not found in EPFO database.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:null,uan:e,esi:null}}},extractDataFromImage:async(n,e,t,r)=>{if(!fl)return console.warn("AI feature disabled: cannot extract data from image. Returning empty result."),{};const a=(await fl.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:`Extract the structured data from this document image. It is a ${r||"document"}.`},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:t}})).text.trim();return JSON.parse(a)},crossVerifyNames:async(n,e)=>{if(!fl){const s=n.trim().toLowerCase()===e.trim().toLowerCase();return{isMatch:s,reason:s?"Names are identical (case-insensitive match) without AI.":"AI disabled; simple case-insensitive comparison used."}}const r=(await fl.models.generateContent({model:"gemini-2.5-flash",contents:`Are these two names referring to the same person? Name 1: "${n}", Name 2: "${e}". Respond in JSON format with two keys: "isMatch" (boolean) and "reason" (a brief string explanation).`,config:{responseMimeType:"application/json",responseSchema:{type:et.OBJECT,properties:{isMatch:{type:et.BOOLEAN},reason:{type:et.STRING}}}}})).text.trim();return JSON.parse(r)},verifyFingerprintImage:async(n,e)=>{if(!fl)return{containsFingerprints:!1,reason:"AI disabled; cannot detect fingerprints."};const r=(await fl.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:'Does this image contain one or more human fingerprints? The image might be a scan from paper. Respond in JSON with "containsFingerprints" (boolean) and "reason" (string).'},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:{type:et.OBJECT,properties:{containsFingerprints:{type:et.BOOLEAN},reason:{type:et.STRING}}}}})).text.trim();return JSON.parse(r)},enhanceDocumentPhoto:async(n,e)=>{if(!fl)return console.warn("AI disabled; returning original document photo without enhancement."),n;const t=await fl.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{text:"Enhance this document photo. Improve contrast, correct perspective to be flat, and make text as clear as possible. Return only the enhanced image."},{inlineData:{data:n,mimeType:e}}]},config:{responseModalities:[sm.IMAGE]}});for(const r of t.candidates[0].content.parts)if(r.inlineData)return r.inlineData.data;throw new Error("AI did not return an enhanced image.")},getSiteStaffDesignations:async()=>{const{data:n,error:e}=await Me.from("site_staff_designations").select("*");if(e)throw e;return(n||[]).map(gt)},updateManpowerDetails:async(n,e)=>{console.log("Mock updating manpower for",n,e),await new Promise(t=>setTimeout(t,500))},getCompOffLogs:async n=>{const{data:e,error:t}=await Me.from("comp_off_logs").select("*").eq("user_id",n).order("date_earned",{ascending:!1});if(t)throw t;return(e||[]).map(gt)},checkCompOffTableExists:async()=>{const{error:n}=await Me.from("comp_off_logs").select("id").limit(1);if(n)throw n},getAllSiteAssets:async()=>Promise.resolve({}),updateSiteAssets:async(n,e)=>(console.log("Mock updating assets for site",n,e),Promise.resolve()),getBackOfficeIdSeries:async()=>{const{data:n,error:e}=await Me.from("back_office_id_series").select("*");if(e)throw e;return(n||[]).map(gt)},updateBackOfficeIdSeries:async n=>{const{error:e}=await Me.from("back_office_id_series").upsert(fn(n),{onConflict:"id"});if(e)throw e},updateSiteStaffDesignations:async n=>{const{error:e}=await Me.from("site_staff_designations").upsert(fn(n),{onConflict:"id"});if(e)throw e},getAllSiteIssuedTools:async()=>Promise.resolve({}),getToolsList:async()=>Promise.resolve({}),updateSiteIssuedTools:async(n,e)=>{console.log("Mock updating tools for site",n,e)},getAllSiteGentsUniforms:async()=>Promise.resolve({}),getMasterGentsUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteGentsUniforms:async(n,e)=>{console.log("Mock updating gents uniforms for",n,e)},getAllSiteUniformDetails:async()=>Promise.resolve({}),updateSiteUniformDetails:async(n,e)=>{console.log("Mock updating uniform details for",n,e)},getAllSiteLadiesUniforms:async()=>Promise.resolve({}),getMasterLadiesUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteLadiesUniforms:async(n,e)=>{console.log("Mock updating ladies uniforms for",n,e)},getUniformRequests:async()=>{const{data:n,error:e}=await Me.from("uniform_requests").select("*");if(e)throw e;return(n||[]).map(gt)},submitUniformRequest:async n=>{const{data:e,error:t}=await Me.from("uniform_requests").insert(fn(n)).select().single();if(t)throw t;return gt(e)},updateUniformRequest:async n=>{const{data:e,error:t}=await Me.from("uniform_requests").update(fn(n)).eq("id",n.id).select().single();if(t)throw t;return gt(e)},deleteUniformRequest:async n=>{const{error:e}=await Me.from("uniform_requests").delete().eq("id",n);if(e)throw e},getInvoiceStatuses:async n=>(console.log("Mock fetching invoice statuses for",n),Promise.resolve({})),getInvoiceSummaryData:async(n,e)=>(console.log("Mock fetching invoice data for",n,e),Promise.resolve({siteName:"Mock Site",siteAddress:"Mock Address",invoiceNumber:"INV-001",invoiceDate:"2023-01-31",statementMonth:"January-2023",lineItems:[]})),getSupportTickets:async()=>{const{data:n,error:e}=await Me.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))");if(e)throw e;return(n||[]).map(gt)},getSupportTicketById:async n=>{const{data:e,error:t}=await Me.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))").eq("id",n).single();if(t)throw t;return gt(e)},createSupportTicket:async n=>{const e=n.attachment;if(e&&e.file instanceof File)try{const{path:s}=await ue.uploadDocument(e.file,TM);n.attachment={name:e.name,type:e.type,size:e.size,path:s}}catch(s){console.error("Failed to upload support ticket attachment:",s),delete n.attachment}const{data:t,error:r}=await Me.from("support_tickets").insert(fn(n)).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(r)throw r;return gt(t)},updateSupportTicket:async(n,e)=>{const t=e.attachment;if(t&&t.file instanceof File)try{const{path:a}=await ue.uploadDocument(t.file,TM);e.attachment={name:t.name,type:t.type,size:t.size,path:a}}catch(a){console.error("Failed to upload updated support ticket attachment:",a),delete e.attachment}const{data:r,error:s}=await Me.from("support_tickets").update(fn(e)).eq("id",n).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(s)throw s;return gt(r)},addTicketPost:async(n,e)=>{const{data:t,error:r}=await Me.from("ticket_posts").insert(fn(e)).select("*, comments:ticket_comments(*)").single();if(r)throw r;return gt(t)},togglePostLike:async(n,e)=>{const{data:t,error:r}=await Me.from("ticket_posts").select("likes").eq("id",n).single();if(r)throw r;const s=t.likes||[],a=s.includes(e)?s.filter(l=>l!==e):[...s,e],{error:o}=await Me.from("ticket_posts").update({likes:a}).eq("id",n);if(o)throw o},addPostComment:async(n,e)=>{const{data:t,error:r}=await Me.from("ticket_comments").insert(fn(e)).select().single();if(r)throw r;return gt(t)},getVerificationCostBreakdown:async(n,e)=>{const{data:t,error:r}=await Me.from("onboarding_submissions").select("id, employee_id, personal, enrollment_date, verification_usage").gte("enrollment_date",n).lte("enrollment_date",e);if(r)throw r;return(t||[]).map(s=>{const a=gt(s);return{id:a.id,employeeId:a.personal.employeeId,employeeName:`${a.personal.firstName} ${a.personal.lastName}`,enrollmentDate:a.enrollmentDate,totalCost:0,breakdown:a.verificationUsage||[]}})},generatePdf:async(n,e)=>{try{const t=(await $k(async()=>{const{default:r}=await import("./html2pdf-Deh5RZPE.js").then(s=>s.h);return{default:r}},[],import.meta.url)).default;await t().set(e).from(n).save()}catch(t){throw console.error("PDF generation failed:",t),t}},batchResolveAddresses:async n=>{if(n.length===0)return{};const e=c=>parseFloat(c.toFixed(6)),t=Array.from(new Set(n.map(c=>`${e(c.lat)},${e(c.lon)}`))).map(c=>{const[d,h]=c.split(",").map(Number);return{lat:d,lon:h}}),r={},s=[],a=t.map(c=>c.lat),{data:o,error:l}=await Me.from("location_cache").select("*").in("latitude",a);!l&&o&&o.forEach(c=>{const d=e(parseFloat(c.latitude)),h=e(parseFloat(c.longitude)),p=`${d},${h}`;t.some(x=>e(x.lat)===d&&e(x.lon)===h)&&(r[p]=c.address)}),t.forEach(c=>{const d=`${e(c.lat)},${e(c.lon)}`;r[d]||s.push(c)}),console.log("Geocoding API: Found",Object.keys(r).length,"cached,",s.length,"missing");for(const c of s)try{const d=await $k(()=>Promise.resolve().then(()=>mK),void 0,import.meta.url).then(p=>p.reverseGeocode(c.lat,c.lon)),h=`${e(c.lat)},${e(c.lon)}`;r[h]=d,await Me.from("location_cache").insert({latitude:e(c.lat),longitude:e(c.lon),address:d}),console.log("Geocoding API: Fetched and cached",h,"->",d),await new Promise(p=>setTimeout(p,1e3))}catch(d){console.error(`Failed to resolve address for ${c.lat},${c.lon}`,d);const h=`${e(c.lat)},${e(c.lon)}`;r[h]=`${c.lat.toFixed(4)}, ${c.lon.toFixed(4)}`}return r},sendSecurityAlert:async(n,e,t,r)=>{const{data:s,error:a}=await Me.from("users").select("reporting_manager_id").eq("id",n).single();if(a||!s?.reporting_manager_id){console.warn("Could not find reporting manager for security alert");return}const o=t==="developer_mode"?"attempted to access the application with Developer Mode enabled":"attempted to access the application with Location Spoofing detected",l=r?` using device: ${r}`:"";await ue.createNotification({userId:s.reporting_manager_id,title:" Security Alert",message:`${e} ${o}${l}. Access was blocked for security reasons.`,type:"security",link:"/user-management"})},sendDeviceChangeAlert:async(n,e,t,r)=>{const{data:s,error:a}=await Me.from("users").select("reporting_manager_id").eq("id",n).single();if(a||!s?.reporting_manager_id){console.warn("Could not find reporting manager for device change alert");return}await ue.createNotification({userId:s.reporting_manager_id,title:" Device Change Detected",message:`${e} logged in from a new device. Previous device: ${t}, New device: ${r}`,type:"info",link:"/user-management"})}},hK=(n,e,t="Operation timed out")=>{const r=new Promise((s,a)=>{setTimeout(()=>a(new Error(t)),e)});return Promise.race([n,r])};function bS(n,e,t,r){const s=h=>h*Math.PI/180,o=s(t-n),l=s(r-e),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(s(n))*Math.cos(s(t))*Math.sin(l/2)*Math.sin(l/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}async function am(n,e){const t=`${n.toFixed(4)}, ${e.toFixed(4)}`;try{const r=`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${n}&lon=${e}&zoom=16&addressdetails=1`,s=await fetch(r);if(!s.ok)return t;const a=await s.json();if(a.display_name)return a.display_name;if(a.address){const{road:o,suburb:l,city:c,village:d,town:h,state:p,country:x}=a.address;return[o,l,c||d||h,p,x].filter(Boolean).join(", ")}return t}catch(r){return console.warn("Reverse geocode failed:",r),t}}function Jx(n=50,e=1e4){return new Promise((t,r)=>{if(!("geolocation"in navigator))return r(new Error("Geolocation is not supported by this browser."));let s=null;const a=setTimeout(()=>{s?(navigator.geolocation.clearWatch(o),t(s)):(navigator.geolocation.clearWatch(o),r(new Error("Unable to acquire a precise position within the timeout period")))},e),o=navigator.geolocation.watchPosition(l=>{(!s||l.coords.accuracy<s.coords.accuracy)&&(s=l),l.coords.accuracy<=n&&(clearTimeout(a),navigator.geolocation.clearWatch(o),t(l))},l=>{clearTimeout(a),navigator.geolocation.clearWatch(o),r(l)},{enableHighAccuracy:!0,maximumAge:0})})}const mK=Object.freeze(Object.defineProperty({__proto__:null,calculateDistanceMeters:bS,getPrecisePosition:Jx,reverseGeocode:am},Symbol.toStringTag,{value:"Module"})),Rp=n=>{const e=n.toLowerCase();return e.includes("timed out")?"The request took too long. Please check your internet connection and try again.":e.includes("invalid api key")||e.includes("configuration")?"System configuration error. Please contact support.":e.includes("failed to fetch")||e.includes("network")?"Unable to connect. Please check your internet connection.":e.includes("invalid login credentials")?'Incorrect email or password. If you use Google Sign-In, please click "Sign in with Google".':e.includes("user already registered")||e.includes("already exists")?"This email is already registered. Please sign in.":e.includes("email not confirmed")?"Please verify your email address. Check your inbox for the confirmation link.":e.includes("too many requests")||e.includes("rate limit")?"Too many attempts. Please wait a few minutes before trying again.":e.includes("weak password")?"Password is too weak. Please use a stronger password.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again or contact support.")},ib=()=>{const n=new Date().getHours();return n<12?"Good Morning":n<17?"Good Afternoon":"Good Evening"},jt=Ia()((n,e)=>({user:null,isInitialized:!1,isCheckedIn:!1,isAttendanceLoading:!0,lastCheckInTime:null,lastCheckOutTime:null,error:null,loading:!1,isLoginAnimationPending:!1,setLoginAnimationPending:t=>n({isLoginAnimationPending:t}),setUser:t=>n({user:t,error:null,loading:!1}),setInitialized:t=>n({isInitialized:t}),setLoading:t=>n({loading:t}),resetAttendance:()=>n({isCheckedIn:!1,isAttendanceLoading:!1,lastCheckInTime:null,lastCheckOutTime:null,isLoginAnimationPending:!1}),setError:t=>n({error:t}),loginWithEmail:async(t,r,s)=>{n({error:null,loading:!0});try{await wa.signOut()}catch{}try{const{data:a,error:o}=await hK(wa.signInWithPassword(t,r),2e4,"Login attempt timed out. Please check your network connection.").catch(c=>({data:{user:null,session:null},error:{message:c.message}}));if(o||!a.user||!a.session){const c=Rp(o?.message||"Invalid login credentials");return n({error:c,loading:!1}),{error:{message:c}}}s?(localStorage.setItem("rememberedEmail",t),localStorage.setItem("supabase.auth.rememberMe",a.session.refresh_token)):(localStorage.removeItem("rememberedEmail"),localStorage.removeItem("supabase.auth.rememberMe"));const l=await wa.getAppUserProfile(a.user);if(l){n({user:l,error:null,loading:!1});try{const c=`greetingSent_${l.id}`,d=ib();await ue.createNotification({userId:l.id,message:`${d}, ${l.name||"there"}! Welcome back to Paradigm Services.`,type:"greeting"})}catch(c){console.error("Failed to send login greeting notification",c)}return{error:null}}else{await wa.signOut();const c="Login successful, but failed to retrieve user profile. Please try again.";return n({user:null,error:c,loading:!1}),{error:{message:c}}}}catch(a){console.error("Unexpected error during login flow:",a);const o=Rp("Unexpected error during login flow");return n({user:null,error:o,loading:!1}),{error:{message:o}}}},signUp:async(t,r,s)=>{n({error:null,loading:!0});const{error:a}=await wa.signUpWithPassword({email:r,password:s,options:{data:{name:t}}});if(a){const o=Rp(a.message);return n({error:o,loading:!1}),{error:{message:o}}}return n({loading:!1}),{error:null}},loginWithGoogle:async()=>{n({error:null,loading:!0});const{error:t}=await wa.signInWithGoogle();if(t){const r=Rp(t.message);return n({error:r,loading:!1}),{error:{message:r}}}return n({loading:!1}),{error:null}},sendPasswordReset:async t=>{const{error:r}=await wa.resetPasswordForEmail(t);return r?{error:{message:r.message}}:{error:null}},logout:async()=>{const t=e().user;if(t)try{const r=ib(),s=new Date().getHours()>=20?"Good Night":r;await ue.createNotification({userId:t.id,message:`${s}, ${t.name||"there"}! Thanks for your hard work today.`,type:"greeting"})}catch(r){console.error("Failed to send logout farewell notification",r)}localStorage.removeItem("supabase.auth.rememberMe"),await wa.signOut()},updateUserProfile:t=>n(r=>({user:r.user?{...r.user,...t}:null})),checkAttendanceStatus:async()=>{const{user:t}=e();if(!t){n({isAttendanceLoading:!1});return}n({isAttendanceLoading:!0});try{const r=new Date,s=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0).toISOString(),a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999).toISOString(),o=await ue.getAttendanceEvents(t.id,s,a);if(o.length===0){n({isCheckedIn:!1,lastCheckInTime:null,lastCheckOutTime:null,isAttendanceLoading:!1});return}o.sort((h,p)=>new Date(h.timestamp).getTime()-new Date(p.timestamp).getTime());const l=o.find(h=>h.type==="check-in"),c=[...o].reverse().find(h=>h.type==="check-out"),d=o[o.length-1];n({isCheckedIn:d?.type==="check-in",lastCheckInTime:l?l.timestamp:null,lastCheckOutTime:c?c.timestamp:null,isAttendanceLoading:!1})}catch(r){console.error("Failed to check attendance status:",r),n({isAttendanceLoading:!1})}},toggleCheckInStatus:async()=>{const{user:t,isCheckedIn:r}=e();if(!t)return{success:!1,message:"User not found"};const s=r?"check-out":"check-in";try{let a=null;try{a=await Jx()}catch{}(!a||!a.coords)&&(a=await new Promise(p=>{navigator.geolocation.getCurrentPosition(x=>p(x),()=>p(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}));const o=async(p,x,v)=>{await ue.addAttendanceEvent({userId:t.id,timestamp:new Date().toISOString(),type:s,latitude:p,longitude:x,locationId:v}),await e().checkAttendanceStatus();try{const _=ib(),w=s==="check-in"?"checking in":"checking out";await ue.createNotification({userId:t.id,message:`${_}, ${t.name||"there"}! Thanks for ${w}.`,type:"greeting"})}catch(_){console.warn("Failed to send user attendance notification",_)}try{const _=await ue.getAttendanceSettings();if((["admin","hr","finance","developer"].includes(t.role)?_?.office:_?.field)?.enableAttendanceNotifications){const T=[];t.reportingManagerId&&T.push({id:t.reportingManagerId});const P=await ue.getNearbyUsers();for(const I of P)T.find(q=>q.id===I.id)||T.push({id:I.id});const E=t.name||"An employee",M=v?"":p&&x?` at ${p.toFixed(4)}, ${x.toFixed(4)}`:"",O=`${E} ${s.replace("-"," ")}${M}`;await Promise.all(T.map(I=>ue.createNotification({userId:I.id,message:O,type:"greeting"})))}}catch(_){console.warn("Failed to create manager notifications:",_)}return{success:!0,message:`Successfully ${s.replace("-"," ")}!`}};if(!a||!a.coords)return await o(void 0,void 0,null);const{latitude:l,longitude:c,accuracy:d}=a.coords;if(typeof d=="number"&&d>1e3)return await o(l,c,null);let h=null;try{const p=await ue.getUserLocations(t.id);for(const x of p)if(bS(l,c,x.latitude,x.longitude)<=x.radius){h=x.id;break}if(!h){const x=await ue.getLocations();for(const v of x)if(bS(l,c,v.latitude,v.longitude)<=v.radius){h=v.id;try{await ue.assignLocationToUser(t.id,v.id)}catch(w){console.warn("Failed to autoassign location to user:",w)}break}}}catch(p){console.warn("Geofencing check failed:",p)}if(!h)try{let p=null;try{p=await am(l,c)}catch(_){console.warn("Reverse geocode failed for new location:",_)}const v=await ue.createLocation({name:p||null,latitude:l,longitude:c,radius:100,address:p||null,createdBy:t.id});try{await ue.assignLocationToUser(t.id,v.id)}catch(_){console.warn("Failed to autoassign new location to user:",_)}h=v.id}catch(p){console.warn("Failed to create a new geofence location:",p),h=null}return await o(l,c,h)}catch(a){return console.error("Error during attendance update:",a),{success:!1,message:"Failed to update attendance."}}}})),pK={};function gu(n,e){let t;try{t=n()}catch{return}return{getItem:s=>{var a;const o=c=>c===null?null:JSON.parse(c,void 0),l=(a=t.getItem(s))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(s,a)=>t.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>t.removeItem(s)}}const om=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return om(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return om(r)(t)}}}},gK=(n,e)=>(t,r,s)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:j=>j,version:0,merge:(j,T)=>({...T,...j}),...e},o=!1;const l=new Set,c=new Set;let d;try{d=a.getStorage()}catch{}if(!d)return n((...j)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...j)},r,s);const h=om(a.serialize),p=()=>{const j=a.partialize({...r()});let T;const P=h({state:j,version:a.version}).then(E=>d.setItem(a.name,E)).catch(E=>{T=E});if(T)throw T;return P},x=s.setState;s.setState=(j,T)=>{x(j,T),p()};const v=n((...j)=>{t(...j),p()},r,s);let _;const w=()=>{var j;if(!d)return;o=!1,l.forEach(P=>P(r()));const T=((j=a.onRehydrateStorage)==null?void 0:j.call(a,r()))||void 0;return om(d.getItem.bind(d))(a.name).then(P=>{if(P)return a.deserialize(P)}).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==a.version){if(a.migrate)return a.migrate(P.state,P.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return P.state}).then(P=>{var E;return _=a.merge(P,(E=r())!=null?E:v),t(_,!0),p()}).then(()=>{T?.(_,void 0),o=!0,c.forEach(P=>P(_))}).catch(P=>{T?.(void 0,P)})};return s.persist={setOptions:j=>{a={...a,...j},j.getStorage&&(d=j.getStorage())},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:j=>(l.add(j),()=>{l.delete(j)}),onFinishHydration:j=>(c.add(j),()=>{c.delete(j)})},w(),_||v},xK=(n,e)=>(t,r,s)=>{let a={storage:gu(()=>localStorage),partialize:w=>w,version:0,merge:(w,j)=>({...j,...w}),...e},o=!1;const l=new Set,c=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,s);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=s.setState;s.setState=(w,j)=>{p(w,j),h()};const x=n((...w)=>{t(...w),h()},r,s);s.getInitialState=()=>x;let v;const _=()=>{var w,j;if(!d)return;o=!1,l.forEach(P=>{var E;return P((E=r())!=null?E:x)});const T=((j=a.onRehydrateStorage)==null?void 0:j.call(a,(w=r())!=null?w:x))||void 0;return om(d.getItem.bind(d))(a.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==a.version){if(a.migrate)return[!0,a.migrate(P.state,P.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var E;const[M,O]=P;if(v=a.merge(O,(E=r())!=null?E:x),t(v,!0),M)return h()}).then(()=>{T?.(v,void 0),v=r(),o=!0,c.forEach(P=>P(v))}).catch(P=>{T?.(void 0,P)})};return s.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(c.add(w),()=>{c.delete(w)})},a.skipHydration||_(),v||x},yK=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((pK?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),gK(n,e)):xK(n,e),Ff=yK,xu=Ia(Ff(n=>({theme:"light",isAutomatic:!0,setTheme:e=>n({theme:e,isAutomatic:!1}),setAutomatic:e=>n({isAutomatic:e}),_setThemeInternal:e=>n({theme:e})}),{name:"paradigm-app-theme",storage:gu(()=>localStorage)})),vK={esiCtcThreshold:21e3,enforceManpowerLimit:!1,manpowerLimitRule:"warn",allowSalaryEdit:!1,salaryThreshold:21e3,defaultPolicySingle:"1L",defaultPolicyMarried:"2L",enableEsiRule:!1,enableGmcRule:!1,enforceFamilyValidation:!0,rulesByDesignation:{}},Kc=Ia()(n=>({...vK,init:e=>{e&&n(e)},updateRules:e=>n(t=>({...t,...e}))})),bK={unverified:[],admin:["view_all_submissions","manage_users","manage_sites","view_entity_management","view_developer_settings","view_operations_dashboard","view_site_dashboard","create_enrollment","manage_roles_and_permissions","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_approval_workflow","download_attendance_report","manage_tasks","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","view_field_officer_tracking","manage_modules","access_support_desk"],hr:["view_all_submissions","manage_users","manage_sites","view_entity_management","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","download_attendance_report","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","access_support_desk"],finance:["view_invoice_summary","view_verification_costing","view_own_attendance","apply_for_leave"],developer:["view_developer_settings"],operation_manager:["view_operations_dashboard","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_tasks","access_support_desk"],site_manager:["view_site_dashboard","create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"],field_officer:["create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"]},Ki=Ia(Ff((n,e)=>({permissions:bK,initRoles:t=>{if(!t)return;const s={...e().permissions};let a=!1;t.forEach(o=>{s[o.id]||(s[o.id]=[],a=!0)}),a&&n({permissions:s})},addRolePermissionEntry:t=>{n(r=>({permissions:{...r.permissions,[t.id]:[]}}))},removeRolePermissionEntry:t=>{n(r=>{const s={...r.permissions};return delete s[t],{permissions:s}})},renameRolePermissionEntry:(t,r)=>{n(s=>{const a={...s.permissions};return a[t]&&(a[r]=a[t],delete a[t]),{permissions:a}})},setRolePermissions:(t,r)=>{n(s=>({permissions:{...s.permissions,[t]:r}}))}}),{name:"paradigm_app_permissions_v2",storage:gu(()=>localStorage)})),_K={enablePincodeVerification:!0},wK={office:{minimumHoursFullDay:8,minimumHoursHalfDay:4,annualEarnedLeaves:5,annualSickLeaves:12,monthlyFloatingLeaves:1,annualCompOffLeaves:5,enableAttendanceNotifications:!1,sickLeaveCertificateThreshold:2},field:{minimumHoursFullDay:9,minimumHoursHalfDay:5,annualEarnedLeaves:10,annualSickLeaves:10,monthlyFloatingLeaves:0,annualCompOffLeaves:10,enableAttendanceNotifications:!0,sickLeaveCertificateThreshold:3}},jK={applicability:"Optional - Opt-in Default",optInDisclaimer:"Please note that currently the GMC facility covers only spouse and two children. If you would like to continue, please select below relationships and submit.",coverageDetails:"Spouse and two children",optOutDisclaimer:"Please note that you are opting out of the GMC Facility. You will have to submit a declaration to the company towards the same along with proof of your existing insurance.",requireAlternateInsurance:!0,collectProvider:!0,collectStartDate:!0,collectEndDate:!0,collectExtentOfCover:!0},NK={enabled:!0,clientId:"",clientSecret:""},SK={enabled:!0},CK={enabled:!0},TK={email:{enabled:!1}},kK=[{id:"cost_1",name:"Profile Picture",cost:0},{id:"cost_2",name:"Mobile to Form Prefill",cost:7},{id:"cost_3",name:"KYC OCR (Plus)",cost:1.5},{id:"cost_4",name:"Aadhaar Mobile Link",cost:2.5},{id:"cost_5",name:"EPF UAN Lookup",cost:2.5},{id:"cost_6",name:"Cheque OCR",cost:3},{id:"cost_7",name:"Bank AC Verification Advanced",cost:2.25},{id:"cost_8",name:"PAN Profile Detailed",cost:5},{id:"cost_9",name:"Aadhaar Verification",cost:1.75},{id:"cost_10",name:"Voter ID OCR",cost:1.5},{id:"cost_11",name:"Driving License OCR",cost:1.5},{id:"cost_12",name:"Education Certificate OCR",cost:2},{id:"cost_13",name:"Experience/Salary Slip OCR",cost:2},{id:"cost_14",name:"ESI Card OCR",cost:1.5}],PK={enableProvisionalSites:!1},pi=Ia()(Ff(n=>({address:_K,attendance:wK,officeHolidays:[],fieldHolidays:[],recurringHolidays:[],gmcPolicy:jK,perfiosApi:NK,geminiApi:SK,otp:CK,notifications:TK,verificationCosts:kK,siteManagement:PK,initSettings:e=>{if(e){const{holidays:t,attendanceSettings:r,recurringHolidays:s}=e,a=t.filter(l=>l.type==="office"),o=t.filter(l=>l.type==="field");n({officeHolidays:a,fieldHolidays:o,attendance:r,recurringHolidays:s||[]})}},updateAddressSettings:e=>n(t=>({address:{...t.address,...e}})),updateAttendanceSettings:e=>n({attendance:e}),updateGmcPolicySettings:e=>n(t=>({gmcPolicy:{...t.gmcPolicy,...e}})),updatePerfiosApiSettings:e=>n(t=>({perfiosApi:{...t.perfiosApi,...e}})),updateGeminiApiSettings:e=>n(t=>({geminiApi:{...t.geminiApi,...e}})),updateOtpSettings:e=>n(t=>({otp:{...t.otp,...e}})),updateNotificationSettings:e=>n(t=>({notifications:{...t.notifications,...e,email:{...t.notifications.email,...e.email}}})),updateVerificationCosts:e=>n({verificationCosts:e}),updateSiteManagementSettings:e=>n(t=>({siteManagement:{...t.siteManagement,...e}})),addHoliday:async(e,t)=>{const r=await ue.addHoliday({...t,type:e});n(s=>{const a=e==="office"?"officeHolidays":"fieldHolidays",o=[...s[a],r].sort((l,c)=>new Date(l.date).getTime()-new Date(c.date).getTime());return{[a]:o}})},removeHoliday:async(e,t)=>{await ue.removeHoliday(t),n(r=>{const s=e==="office"?"officeHolidays":"fieldHolidays";return{[s]:r[s].filter(a=>a.id!==t)}})},addRecurringHoliday:async e=>{const t=await ue.addRecurringHoliday(e);n(r=>({recurringHolidays:[...r.recurringHolidays,t]}))},removeRecurringHoliday:async e=>{await ue.deleteRecurringHoliday(e),n(t=>({recurringHolidays:t.recurringHolidays.filter(r=>r.id!==e)}))}}),{name:"paradigm_app_settings",storage:gu(()=>localStorage)})),Ft=n=>{const[e,t]=D.useState(window.matchMedia(n).matches);return D.useEffect(()=>{const r=window.matchMedia(n),s=()=>t(r.matches);try{r.addEventListener("change",s)}catch{r.addListener(s)}return()=>{try{r.removeEventListener("change",s)}catch{r.removeListener(s)}}},[n]),e},kM=()=>({id:`draft_${Date.now()}`,status:"draft",enrollmentDate:new Date().toISOString().split("T")[0],personal:{employeeId:`PARA-${Math.floor(1e3+Math.random()*9e3)}`,firstName:"",lastName:"",dob:"",gender:"",maritalStatus:"",bloodGroup:"",mobile:"",alternateMobile:"",email:"",emergencyContactName:"",emergencyContactNumber:"",relationship:"",salary:null,verifiedStatus:{}},address:{present:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},permanent:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},sameAsPresent:!0},family:[],education:[],bank:{accountHolderName:"",accountNumber:"",confirmAccountNumber:"",ifscCode:"",bankName:"",branchName:"",verifiedStatus:{}},uan:{hasPreviousPf:!1,verifiedStatus:{},salarySlip:null},esi:{hasEsi:!1,verifiedStatus:{}},gmc:{isOptedIn:null,policyAmount:"",nomineeName:"",nomineeRelation:"",selectedSpouseId:"",selectedChildIds:[],gmcPolicyCopy:null,declarationAccepted:!1},organization:{designation:"",department:"",reportingManager:"",organizationId:"",organizationName:"",joiningDate:$e(new Date,"yyyy-MM-dd"),workType:"Full-time",defaultSalary:null},uniforms:[],biometrics:{signatureImage:null,fingerprints:{leftThumb:null,leftIndex:null,leftMiddle:null,leftRing:null,leftLittle:null,rightThumb:null,rightIndex:null,rightMiddle:null,rightRing:null,rightLittle:null}},salaryChangeRequest:null,requiresManualVerification:!1,formsGenerated:!1,verificationUsage:[]}),$n=Ia(n=>({data:kM(),setData:e=>n({data:e}),updatePersonal:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,...e}}})),setPersonalVerifiedStatus:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,verifiedStatus:{...t.data.personal.verifiedStatus,...e}}}})),updateAddress:e=>n(t=>({data:{...t.data,address:{...t.data.address,...e}}})),setAddressVerifiedStatus:(e,t)=>n(r=>({data:{...r.data,address:{...r.data.address,[e]:{...r.data.address[e],verifiedStatus:{...r.data.address[e].verifiedStatus,...t}}}}})),updateFamily:e=>n(t=>({data:{...t.data,family:e}})),updateEducation:e=>n(t=>({data:{...t.data,education:e}})),updateBank:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,...e}}})),setBankVerifiedStatus:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,verifiedStatus:{...t.data.bank.verifiedStatus,...e}}}})),updateUan:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,...e}}})),setUanVerifiedStatus:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,verifiedStatus:{...t.data.uan.verifiedStatus,...e}}}})),updateEsi:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,...e}}})),setEsiVerifiedStatus:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,verifiedStatus:{...t.data.esi.verifiedStatus,...e}}}})),updateGmc:e=>n(t=>({data:{...t.data,gmc:{...t.data.gmc,...e}}})),updateOrganization:e=>n(t=>({data:{...t.data,organization:{...t.data.organization,...e}}})),updateUniforms:e=>n(t=>({data:{...t.data,uniforms:e}})),updateBiometrics:e=>n(t=>({data:{...t.data,biometrics:{...t.data.biometrics,...e}}})),setSalaryChangeRequest:e=>n(t=>({data:{...t.data,salaryChangeRequest:e}})),setRequiresManualVerification:e=>n(t=>({data:{...t.data,requiresManualVerification:e}})),setFormsGenerated:e=>n(t=>({data:{...t.data,formsGenerated:e}})),logVerificationUsage:e=>n(t=>{const r=JSON.parse(JSON.stringify(t.data.verificationUsage||[])),s=r.find(a=>a.name===e);return s?s.count+=1:r.push({name:e,count:1}),{data:{...t.data,verificationUsage:r}}}),reset:()=>n({data:kM()}),addFamilyMember:()=>n(e=>({data:{...e.data,family:[...e.data.family,{id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""}]}})),updateFamilyMember:(e,t)=>n(r=>({data:{...r.data,family:r.data.family.map(s=>s.id===e?{...s,...t}:s)}})),removeFamilyMember:e=>n(t=>({data:{...t.data,family:t.data.family.filter(r=>r.id!==e)}})),addEducationRecord:()=>n(e=>({data:{...e.data,education:[...e.data.education,{id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""}]}})),updateEducationRecord:(e,t)=>n(r=>({data:{...r.data,education:r.data.education.map(s=>s.id===e?{...s,...t}:s)}})),removeEducationRecord:e=>n(t=>({data:{...t.data,education:t.data.education.filter(r=>r.id!==e)}})),addOrUpdateEmergencyContactAsFamilyMember:()=>n(e=>{const{personal:t,family:r}=e.data,{emergencyContactName:s,emergencyContactNumber:a,relationship:o}=t;if(s&&["Spouse","Child","Father","Mother"].includes(o)){const c=r.find(d=>d.name.toLowerCase()===s.toLowerCase()&&d.relation===o);if(c){if(c.phone!==a){const d=r.map(h=>h.id===c.id?{...h,phone:a}:h);return{data:{...e.data,family:d}}}}else{const d={id:`fam_emergency_${Date.now()}`,name:s,relation:o,phone:a,dob:"",gender:"",dependent:!1,idProof:null,occupation:""};return{data:{...e.data,family:[...r,d]}}}}return e})}));const MK=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AF=(...n)=>n.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");var DK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const EK=D.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:a,iconNode:o,...l},c)=>D.createElement("svg",{ref:c,...DK,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:AF("lucide",s),...l},[...o.map(([d,h])=>D.createElement(d,h)),...Array.isArray(a)?a:[a]]));const Ae=(n,e)=>{const t=D.forwardRef(({className:r,...s},a)=>D.createElement(EK,{ref:a,iconNode:e,className:AF(`lucide-${MK(n)}`,r),...s}));return t.displayName=`${n}`,t};const qh=Ae("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const OK=Ae("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);const Aa=Ae("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const IK=Ae("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const AK=Ae("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const RK=Ae("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);const LK=Ae("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const FK=Ae("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);const Cf=Ae("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);const qK=Ae("BriefcaseBusiness",[["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2",key:"1ksdt3"}],["path",{d:"M22 13a18.15 18.15 0 0 1-20 0",key:"12hx5q"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const RF=Ae("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const $i=Ae("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const zK=Ae("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);const UK=Ae("CalendarCheck2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]]);const VK=Ae("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);const BK=Ae("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);const WK=Ae("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);const ka=Ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const xC=Ae("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);const $K=Ae("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);const _l=Ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const yu=Ae("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const Qx=Ae("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Tf=Ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const HK=Ae("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const YK=Ae("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);const GK=Ae("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);const LF=Ae("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const Hi=Ae("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const PM=Ae("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const MM=Ae("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const ZK=Ae("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const lm=Ae("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const FF=Ae("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);const qF=Ae("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);const Vc=Ae("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const KK=Ae("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);const zF=Ae("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);const JK=Ae("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);const _S=Ae("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);const xi=Ae("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);const QK=Ae("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);const Nl=Ae("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const XK=Ae("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);const eJ=Ae("FileDigit",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["rect",{width:"4",height:"6",x:"2",y:"12",rx:"2",key:"jm304g"}],["path",{d:"M10 12h2v6",key:"12zw74"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);const UF=Ae("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);const wS=Ae("FilePenLine",[["path",{d:"m18 5-3-3H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"h0fsxq"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.4 9.6a2 2 0 1 1 3 3L17 17l-4 1 1-4Z",key:"dyo8mm"}]]);const os=Ae("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const tJ=Ae("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);const nJ=Ae("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);const rJ=Ae("Files",[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]]);const VF=Ae("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);const DM=Ae("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);const sJ=Ae("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);const iJ=Ae("GitPullRequest",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]]);const BF=Ae("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const aJ=Ae("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6h0",key:"1uc279"}],["path",{d:"M14 6h0a6 6 0 0 1 6 6v3",key:"1j9mnm"}]]);const yC=Ae("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);const vC=Ae("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);const oJ=Ae("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);const WF=Ae("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const Sl=Ae("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);const ru=Ae("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const lJ=Ae("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);const $F=Ae("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);const jx=Ae("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);const bC=Ae("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);const cJ=Ae("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);const wt=Ae("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const jS=Ae("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const Nx=Ae("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);const bo=Ae("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const HF=Ae("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);const qf=Ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const Cl=Ae("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const YF=Ae("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);const NS=Ae("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const EM=Ae("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]);const cm=Ae("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);const dJ=Ae("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const uJ=Ae("MousePointerClick",[["path",{d:"m9 9 5 12 1.8-5.2L21 14Z",key:"1b76lo"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}]]);const fJ=Ae("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);const hJ=Ae("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);const mJ=Ae("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);const dm=Ae("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);const pJ=Ae("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);const kf=Ae("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const GF=Ae("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);const gJ=Ae("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);const Bt=Ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const SS=Ae("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const xJ=Ae("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);const Ns=Ae("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const Ma=Ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const _C=Ae("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);const Sm=Ae("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const ZF=Ae("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);const Xx=Ae("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const KF=Ae("ShieldHalf",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 22V2",key:"zs6s6o"}]]);const yJ=Ae("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);const um=Ae("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const Pf=Ae("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);const vJ=Ae("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);const fm=Ae("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);const cr=Ae("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);const JF=Ae("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const QF=Ae("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);const XF=Ae("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);const e3=Ae("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const bJ=Ae("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);const _J=Ae("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);const rn=Ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const OM=Ae("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const Da=Ae("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const Bc=Ae("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const uu=Ae("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);const Wc=Ae("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const Sx=Ae("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);const Tl=Ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const Yi=Ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const t3=Ae("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);const n3=Ae("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);const gi=Ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const wJ=Ae("ZapOff",[["path",{d:"M10.513 4.856 13.12 2.17a.5.5 0 0 1 .86.46l-1.377 4.317",key:"193nxd"}],["path",{d:"M15.656 10H20a1 1 0 0 1 .78 1.63l-1.72 1.773",key:"27a7lr"}],["path",{d:"M16.273 16.273 10.88 21.83a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4a1 1 0 0 1-.78-1.63l4.507-4.643",key:"1e0qe9"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const CS=Ae("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);const wC=Ae("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);const jC=Ae("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Lp="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",NC="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",SC=Ia(Ff(n=>({currentLogo:Lp,defaultLogo:Lp,setCurrentLogo:e=>n({currentLogo:e}),setDefaultLogo:()=>n(e=>({defaultLogo:e.currentLogo})),resetToDefault:()=>n(e=>({currentLogo:e.defaultLogo})),resetToOriginal:()=>n({currentLogo:Lp,defaultLogo:Lp})}),{name:"paradigm-app-logo",storage:gu(()=>localStorage)})),Gi=({className:n="",localPath:e})=>{const t=SC(s=>s.currentLogo),r=e||t;return i.jsx("img",{src:r,alt:"Paradigm Logo",className:`w-auto object-contain ${!n.includes("h-")&&"h-10"} ${n}`})},re=({children:n,className:e="",variant:t="primary",size:r="md",isLoading:s=!1,...a})=>{const l=`btn-${t}`,c=`btn-${r}`;return i.jsx("button",{className:`btn ${l} ${c} ${e}`,disabled:s||a.disabled,...a,children:s?i.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):n})},r3=Ia(Ff(n=>({autoClickOnHover:!0,autoScrollOnHover:!0,setAutoClickOnHover:e=>n({autoClickOnHover:e}),setAutoScrollOnHover:e=>n({autoScrollOnHover:e})}),{name:"paradigm-ui-settings",storage:gu(()=>localStorage)})),ey=Ia((n,e)=>({notifications:[],unreadCount:0,isLoading:!1,error:null,fetchNotifications:async()=>{const t=jt.getState().user;if(t){n({isLoading:!0,error:null});try{const r=await ue.getNotifications(t.id),s=r.filter(a=>!a.isRead).length;n({notifications:r,unreadCount:s,isLoading:!1})}catch{n({error:"Failed to fetch notifications.",isLoading:!1})}}},markAsRead:async t=>{const r=e().notifications.find(s=>s.id===t);if(!(r&&r.isRead))try{await ue.markNotificationAsRead(t),n(s=>({notifications:s.notifications.map(a=>a.id===t?{...a,isRead:!0}:a),unreadCount:Math.max(0,s.unreadCount-1)}))}catch(s){console.error("Failed to mark notification as read",s)}},markAllAsRead:async()=>{const t=jt.getState().user;if(t&&e().unreadCount!==0)try{await ue.markAllNotificationsAsRead(t.id),n(r=>({notifications:r.notifications.map(s=>({...s,isRead:!0})),unreadCount:0}))}catch(r){console.error("Failed to mark all notifications as read",r)}}})),jJ=({type:n})=>{const e={task_assigned:Wc,task_escalated:Da,provisional_site_reminder:FF,security:um,info:ru,greeting:e3},t={task_assigned:"text-blue-500 dark:text-blue-400",task_escalated:"text-orange-500 dark:text-orange-400",provisional_site_reminder:"text-purple-500 dark:text-purple-400",security:"text-red-500 dark:text-red-400",info:"text-blue-400 dark:text-blue-300",greeting:"text-yellow-500 dark:text-yellow-400"},r=e[n]||Cf;return i.jsx(r,{className:`h-5 w-5 ${t[n]}`})},NJ=({className:n=""})=>{const{notifications:e,unreadCount:t,markAsRead:r,markAllAsRead:s}=ey(),[a,o]=D.useState(!1),l=D.useRef(null),c=D.useRef(null),d=St();D.useEffect(()=>{const x=v=>{l.current&&!l.current.contains(v.target)&&c.current&&!c.current.contains(v.target)&&o(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const h=x=>{r(x.id),x.linkTo&&d(x.linkTo),o(!1)},p=()=>{s()};return i.jsxs("div",{className:`relative notification-bell ${n}`,children:[i.jsxs("button",{ref:c,onClick:()=>o(!a),className:"btn-icon relative p-2 rounded-full hover:bg-page text-muted","aria-label":`Notifications (${t} unread)`,children:[i.jsx(Cf,{className:"h-5 w-5"}),t>0&&i.jsx("span",{className:"notification-dot absolute top-0 right-0 block h-2.5 w-2.5 rounded-full bg-red-500"})]}),a&&VL.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[90] md:hidden",onClick:()=>o(!1)}),i.jsxs("div",{ref:l,className:"fixed inset-x-4 top-20 bottom-20 z-[100] flex flex-col bg-white dark:!bg-[#0d1f12] rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-800 md:absolute md:inset-auto md:top-16 md:right-4 md:mt-2 md:w-[400px] md:h-auto md:max-h-[600px] md:bottom-auto animate-in fade-in zoom-in-95 duration-200 overflow-hidden",style:{position:window.innerWidth>=768?"absolute":"fixed"},children:[i.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 dark:border-white/10 bg-gray-50 dark:!bg-[#0d1f12]",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-lg text-gray-900 dark:text-white",children:"Notifications"}),i.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:["You have ",t," unread messages"]})]}),i.jsx("div",{className:"flex items-center gap-2",children:t>0&&i.jsx("span",{onClick:p,className:"relative isolate overflow-hidden before:!content-none after:!content-none text-xs h-8 px-4 flex items-center justify-center rounded-3xl !bg-[#32CD32] hover:!bg-[#28a428] !text-[#0D1A0D] !font-bold cursor-pointer transition-colors",style:{backgroundImage:"none"},children:i.jsx("span",{className:"relative z-10",children:"Mark all read"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-white dark:!bg-[#0d1f12] dark:[color-scheme:dark]",children:e.slice(0,10).length>0?i.jsx("div",{className:"divide-y divide-gray-100 dark:divide-white/20",children:e.slice(0,10).map(x=>i.jsxs("div",{onClick:()=>h(x),className:`group flex items-start gap-4 p-5 cursor-pointer transition-all duration-200 ${x.isRead?"bg-white dark:!bg-[#0d1f12] hover:bg-gray-50 dark:hover:!bg-[#152b1b]":"bg-emerald-50 dark:!bg-[#0d1f12] hover:bg-emerald-100 dark:hover:!bg-[#152b1b]"}`,children:[i.jsx("div",{className:`flex-shrink-0 p-2.5 rounded-full ${x.isRead?"bg-gray-100 dark:bg-[#1a2e1a]":"bg-white dark:bg-[#1a2e1a] shadow-sm"}`,children:i.jsx(jJ,{type:x.type})}),i.jsxs("div",{className:"flex-1 min-w-0 pt-1",children:[i.jsx("p",{className:`text-sm font-medium leading-snug mb-1.5 ${x.isRead?"text-gray-600 dark:text-gray-300":"text-gray-900 dark:text-white"}`,children:x.message}),i.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 flex items-center gap-1",children:ou(new Date(x.createdAt),{addSuffix:!0})})]}),!x.isRead&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 mt-2.5 flex-shrink-0 shadow-[0_0_8px_rgba(16,185,129,0.5)]"})]},x.id))}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center p-8",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-[#1a2e1a] rounded-full flex items-center justify-center mb-4",children:i.jsx(Cf,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),i.jsx("h5",{className:"text-gray-900 dark:text-white font-medium mb-1",children:"No notifications"}),i.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"You're all caught up! Check back later."})]})})]})]}),document.body)]})},Hr=({isOpen:n,onClose:e,onConfirm:t,title:r,children:s,confirmButtonVariant:a="danger",confirmButtonText:o="Confirm",isConfirming:l=!1,isLoading:c})=>{if(!n)return null;const d=c!==void 0?c:l;return i.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black bg-opacity-50","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card shadow-card flex flex-col animate-fade-in-scale overflow-hidden w-full h-full sm:w-full sm:h-full sm:max-w-full sm:rounded-none md:w-auto md:h-auto md:max-w-md md:max-h-[90vh] md:rounded-xl",children:[i.jsx("div",{className:"flex-shrink-0 p-6 border-b border-border",children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:r})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsx("div",{className:"text-sm text-muted",children:s})}),i.jsx("div",{className:"flex-shrink-0 p-6 border-t border-border bg-card",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx(re,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),i.jsx(re,{onClick:t,variant:a,isLoading:d,children:o})]})})]})})},SJ=({className:n})=>i.jsxs("svg",{viewBox:"0 0 144 144",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:n,children:[i.jsx("circle",{cx:"72",cy:"72",r:"72",fill:"#F0EBE3"}),i.jsx("path",{d:"M109.5 144H34.5C34.5 119.464 51.18 99 72 99C92.82 99 109.5 119.464 109.5 144Z",fill:"white"}),i.jsx("path",{d:"M84 99C84 105.627 78.6274 111 72 111C65.3726 111 60 105.627 60 99H84Z",fill:"#E1C699"}),i.jsx("path",{d:"M96 87C96 70.4315 85.3726 57 72 57C58.6274 57 48 70.4315 48 87H96Z",fill:"#4A4A4A"}),i.jsx("rect",{x:"62",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"}),i.jsx("rect",{x:"77",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"})]}),ab=[SJ],Wi=({className:n,photoUrl:e,seed:t})=>{const{user:r}=jt();if(e)return i.jsx("img",{src:e,alt:"Profile",className:`object-cover ${n||""}`});const s=t||r?.id;if(!s){const l=ab[0];return i.jsx(l,{className:`text-muted/60 ${n||""}`})}const a=s.charCodeAt(s.length-1)%ab.length,o=ab[a];return i.jsx(o,{className:n||""})},s3=({setIsMobileMenuOpen:n})=>{const{user:e,logout:t}=jt(),{permissions:r}=Ki(),s=St(),[a,o]=D.useState(!1),[l,c]=D.useState(!1),d=D.useRef(null),h=Ft("(max-width: 767px)");cs(),D.useEffect(()=>{const _=w=>{d.current&&!d.current.contains(w.target)&&o(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]);const p=_=>_.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase()),x=()=>{n?.(!1),o(!1),c(!0)},v=async()=>{c(!1),await t(),s("/auth/login",{replace:!0})};return i.jsxs(i.Fragment,{children:[i.jsx(Hr,{isOpen:l,onClose:()=>c(!1),onConfirm:v,title:"Confirm Log Out",children:"Are you sure you want to log out?"}),i.jsx("header",{className:"sticky top-0 z-40 bg-[#041b0f] md:bg-gray-50/50 backdrop-blur-md border-b border-[#1f3d2b] md:border-gray-200/50 transition-all duration-200",style:{paddingTop:"env(safe-area-inset-top)"},children:i.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center h-16",children:[i.jsx("div",{className:"flex-1 flex justify-center md:justify-start min-w-0 px-2",children:h&&i.jsx("div",{className:"flex items-center justify-center bg-transparent p-2 border-0",children:i.jsx(Gi,{className:"border-0 h-[52px]"})})}),i.jsx("div",{className:"flex-none flex justify-end w-auto min-w-10",children:i.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[i.jsx(NJ,{}),!h&&e&&i.jsxs("div",{className:"relative",ref:d,children:[i.jsxs("button",{onClick:()=>o(!a),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-page transition-colors","aria-expanded":a,"aria-haspopup":"true",children:[i.jsx(Wi,{photoUrl:e.photoUrl,seed:e.id,className:"h-8 w-8 rounded-lg"}),i.jsxs("div",{className:"text-left hidden sm:block",children:[i.jsx("span",{className:"text-sm font-semibold",children:e.name}),i.jsx("span",{className:"text-xs text-muted block",children:p(e.role)})]}),i.jsx(yu,{className:"h-4 w-4 text-muted"})]}),a&&i.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-card rounded-xl shadow-card border border-border py-1 z-40 animate-fade-in-down",role:"menu",children:[i.jsxs(Pa,{to:"/profile",onClick:()=>o(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(Tl,{className:"mr-2 h-4 w-4"}),"Profile"]}),e&&r[e.role]?.includes("apply_for_leave")&&i.jsxs(Pa,{to:"/leaves/dashboard",onClick:()=>o(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(_S,{className:"mr-2 h-4 w-4"}),"Tracker"]}),i.jsxs("button",{onClick:x,className:"flex items-center w-full text-left px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(bo,{className:"mr-2 h-4 w-4"}),"Log Out"]})]})]})]})})]})})})]})},i3=[{to:"/verification/dashboard",label:"All Submissions",icon:$F,permission:"view_all_submissions"},{to:"/developer/api",label:"API Settings",icon:Sm,permission:"view_developer_settings"},{to:"/attendance/dashboard",label:"Attendance",icon:ka,permission:"view_own_attendance"},{to:"/hr/attendance-settings",label:"Attendance Rules",icon:UK,permission:"manage_attendance_rules"},{to:"/support",label:"Backend Support",icon:jx,permission:"access_support_desk"},{to:"/hr/entities",label:"Client Management",icon:RF,permission:"view_entity_management"},{to:"/hr/enrollment-rules",label:"Enrollment Rules",icon:FF,permission:"manage_enrollment_rules"},{to:"/hr/policies-and-insurance",label:"Insurance Management",icon:KF,permission:"manage_insurance"},{to:"/billing/summary",label:"Invoice Summary",icon:eJ,permission:"view_invoice_summary"},{to:"/billing/cost-analysis",label:"Verification Costing",icon:Sl,permission:"view_verification_costing"},{to:"/admin/approval-workflow",label:"Leave Approval Settings",icon:sJ,permission:"manage_approval_workflow"},{to:"/hr/leave-management",label:"Leave Management",icon:iJ,permission:"manage_leave_requests"},{to:"/admin/modules",label:"Module Management",icon:mJ,permission:"manage_modules"},{to:"/onboarding",label:"New Enrollment",icon:Wc,permission:"create_enrollment"},{to:"/operations/dashboard",label:"Operations",icon:qK,permission:"view_operations_dashboard"},{to:"/profile",label:"Profile",icon:Tl,permission:"view_own_attendance"},{to:"/admin/roles",label:"Role Management",icon:Xx,permission:"manage_roles_and_permissions"},{to:"/site/dashboard",label:"Site Dashboard",icon:vC,permission:"view_site_dashboard"},{to:"/admin/sites",label:"Site Management",icon:$i,permission:"manage_sites"},{to:"/tasks",label:"Task Management",icon:bC,permission:"manage_tasks"},{to:"/uniforms",label:"Uniform Management",icon:Pf,permission:"manage_uniforms"},{to:"/admin/users",label:"User Management",icon:Yi,permission:"manage_users"},{to:"/hr/field-officer-tracking",label:"User Activity Tracking",icon:YF,permission:"view_field_officer_tracking"},{to:"/hr/locations",label:"Geo Locations",icon:Cl,permission:"manage_attendance_rules"},{to:"/attendance/locations",label:"My Locations",icon:fJ,permission:"view_own_attendance"}],CJ=({isCollapsed:n,onLinkClick:e,onExpand:t,hideHeader:r=!1,mode:s="light",isMobile:a=!1})=>{const{user:o}=jt(),{permissions:l}=Ki(),c=o?i3.filter(h=>l[o.role]?.includes(h.permission)).sort((h,p)=>h.label.localeCompare(p.label)):[],d=h=>{if(a&&n&&t){h.preventDefault(),t();return}e&&e()};return i.jsxs("div",{className:"flex flex-col",children:[r&&n&&i.jsx("div",{className:"p-4 border-b border-[#1f3d2b] bg-[#041b0f] flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",children:i.jsxs("button",{onClick:()=>window.location.href="/#/profile",className:"btn-icon inline-flex items-center justify-center p-2 rounded-md text-white hover:bg-white/10 focus:outline-none","aria-label":"Go to profile page",children:[i.jsx("span",{className:"sr-only",children:"Go to profile"}),i.jsx(Aa,{className:"block h-6 w-6"})]})}),r&&!n&&i.jsx("div",{className:"p-4 border-b border-[#1f3d2b] bg-[#041b0f] flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0"}),!r&&i.jsx("div",{className:"p-4 border-b border-gray-200 bg-white flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",children:n?i.jsx("div",{className:"h-8 w-8 overflow-hidden",children:i.jsx(Gi,{className:"h-8 max-w-none object-left object-cover"})}):i.jsx(Gi,{})}),i.jsx("nav",{className:"px-3 py-4 space-y-1.5",children:c.map(h=>i.jsx(e4,{to:h.to,onClick:d,className:({isActive:p})=>`group flex items-center px-3 py-3 rounded-xl text-sm font-medium transition-all duration-200 ease-in-out ${n?"justify-center":""} ${s==="light"?p?"text-white shadow-sm border":"text-gray-500 hover:bg-gray-50 hover:text-gray-900":p?"bg-[#1c3a23] text-white shadow-sm border border-white/5":"text-white hover:bg-white/5 hover:text-white/90"}`,style:({isActive:p})=>p?s==="light"?{backgroundColor:"#006B3F",borderColor:"#005632"}:{}:{},title:h.label,children:({isActive:p})=>i.jsxs(i.Fragment,{children:[i.jsx(h.icon,{className:`h-5 w-5 flex-shrink-0 transition-colors duration-200 ${s==="light"?p?"text-white":"text-gray-400 group-hover:text-gray-600":p?"text-white":"text-white group-hover:text-white"} ${n?"":"mr-3"}`}),!n&&i.jsx("span",{children:h.label})]})},h.to))})]})},TJ=()=>{const{user:n}=jt(),{fetchNotifications:e}=ey(),{permissions:t}=Ki(),{autoScrollOnHover:r}=r3();cs();const s=Ft("(max-width: 767px)"),a=D.useRef(null),o=D.useRef(null),[l,c]=D.useState(!0),[d,h]=D.useState(0),[p,x]=D.useState(!1);D.useEffect(()=>{c(s)},[s]);const v=D.useCallback(()=>{o.current!==null&&(clearInterval(o.current),o.current=null)},[]),_=D.useCallback(w=>{v();const j=a.current;if(!j)return;const T=()=>{j.scrollBy({top:w==="up"?-window.innerHeight*.8:window.innerHeight*.8,behavior:"smooth"})};T(),o.current=window.setInterval(T,300)},[v]);return D.useEffect(()=>{const w=()=>{const T=a.current;T&&(x(T.scrollHeight>T.clientHeight),h(T.scrollTop))},j=a.current;return j?.addEventListener("scroll",w,{passive:!0}),window.addEventListener("resize",w),w(),()=>{j?.removeEventListener("scroll",w),window.removeEventListener("resize",w),v()}},[v]),D.useEffect(()=>{n&&e()},[n,e]),n?i.jsxs("div",{className:`flex min-h-screen ${s?"bg-[#041b0f]":"bg-page"} ${s?"":"p-4 md:p-6 lg:p-8 gap-4 md:gap-6 lg:gap-8"}`,children:[s&&!l&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 transition-opacity duration-300",onClick:()=>c(!0)}),i.jsxs("aside",{className:`flex flex-col flex-shrink-0 transition-all duration-300 ease-in-out ${s?l?"w-16":"w-64":l?"w-20":"w-72"} ${s?"bg-[#041b0f] border-r border-[#1f3d2b]":"bg-white border-r border-gray-200/60"} ${s?"fixed left-0 top-0 bottom-0 z-50":""}`,children:[i.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:i.jsx(CJ,{isCollapsed:l,mode:s?"dark":"light",onLinkClick:s?()=>c(!0):void 0,onExpand:()=>c(!1),hideHeader:s,isMobile:s})}),i.jsx("div",{className:`flex-shrink-0 px-2 pt-2 mt-auto flex items-center ${s?"border-t border-[#1f3d2b]":"border-t border-border"}`,children:i.jsx("button",{onClick:()=>c(!l),className:`flex-1 flex items-center justify-center p-2 rounded-lg transition-colors ${s?"text-white/70 hover:bg-white/10":"text-muted hover:bg-page"}`,title:l?"Expand sidebar":"Collapse sidebar",children:l?i.jsx(GK,{className:"h-5 w-5"}):i.jsx(YK,{className:"h-5 w-5"})})})]}),i.jsxs("div",{className:`flex-1 flex flex-col ${s?"bg-[#041b0f]":"bg-gray-50/50"} ${s&&l?"ml-16":""}`,children:[i.jsx(s3,{}),i.jsx("main",{ref:a,className:`flex-1 overflow-y-auto ${s?"bg-[#041b0f]":"bg-page"}`,children:i.jsx("div",{className:"p-4",children:i.jsx(gf,{})})})]}),p&&!s&&i.jsxs("div",{className:"fixed bottom-8 right-8 z-50 flex flex-col gap-2 no-print",children:[i.jsx(re,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:r?()=>_("up"):void 0,onMouseLeave:v,onMouseDown:()=>_("up"),onMouseUp:v,onTouchStart:()=>_("up"),onTouchEnd:v,disabled:d<=0,"aria-label":"Scroll Up",children:i.jsx(HK,{className:"h-5 w-5"})}),i.jsx(re,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:r?()=>_("down"):void 0,onMouseLeave:v,onMouseDown:()=>_("down"),onMouseUp:v,onTouchStart:()=>_("down"),onTouchEnd:v,disabled:a.current?Math.ceil(a.current.clientHeight+d)>=a.current.scrollHeight:!1,"aria-label":"Scroll Down",children:i.jsx(yu,{className:"h-5 w-5"})})]})]}):i.jsx(yl,{to:"/auth/login",replace:!0})},kJ=()=>{const{user:n}=jt(),{permissions:e}=Ki();if(!n)return null;const t=e[n.role]||[],r=[{to:"/mobile-home",label:"Home",icon:vC,show:!0},{to:"/attendance/dashboard",label:"Attendance",icon:VK,show:t.includes("view_own_attendance")},{to:"/tasks",label:"Tasks",icon:bC,show:t.includes("manage_tasks")},{to:"/profile",label:"Profile",icon:Tl,show:!0}];return i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-[#041b0f] border-t border-[#1f3d2b] z-40",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:i.jsx("div",{className:"flex justify-around items-center h-16",children:r.filter(s=>s.show).map(s=>i.jsxs(e4,{to:s.to,className:({isActive:a})=>`flex flex-col items-center justify-center flex-1 h-full transition-colors ${a?"text-[#22c55e]":"text-gray-400"}`,children:[i.jsx(s.icon,{className:"w-6 h-6"}),i.jsx("span",{className:"text-xs mt-1",children:s.label})]},s.to))})})},PJ=()=>{const[n,e]=D.useState(!0),t=D.useRef(0),r=D.useRef(!1);return D.useEffect(()=>{const s=()=>{r.current||(window.requestAnimationFrame(()=>{const a=window.scrollY;a<t.current||a<10?e(!0):a>t.current&&a>10&&e(!1),t.current=a,r.current=!1}),r.current=!0)};return window.addEventListener("scroll",s,{passive:!0}),()=>window.removeEventListener("scroll",s)},[]),i.jsxs("div",{className:"flex flex-col min-h-screen bg-[#041b0f]",children:[i.jsx("div",{className:`sticky top-0 z-50 transition-transform duration-200 ${n?"translate-y-0":"-translate-y-full"}`,children:i.jsx(s3,{})}),i.jsx("main",{className:"flex-1 overflow-y-auto px-4 pt-2",style:{paddingBottom:"calc(9.1rem + env(safe-area-inset-bottom))"},children:i.jsx(gf,{})}),i.jsx(kJ,{})]})},MJ=["https://picsum.photos/seed/corporate_campus/1200/900","https://picsum.photos/seed/luxury_complex/1200/900","https://picsum.photos/seed/office_interior/1200/900","https://picsum.photos/seed/landscaping/1200/900","https://picsum.photos/seed/lobby_design/1200/900"],a3=Ia(Ff((n,e)=>({backgroundImages:MJ,addBackgroundImage:t=>{const r=e();return r.backgroundImages.includes(t)?!1:(n({backgroundImages:[...r.backgroundImages,t]}),!0)},removeBackgroundImage:t=>n(r=>({backgroundImages:r.backgroundImages.filter((s,a)=>a!==t)}))}),{name:"paradigm-auth-layout-settings",storage:gu(()=>localStorage)})),DJ=()=>{const{backgroundImages:n}=a3(),[e,t]=D.useState(0),r=cs();D.useEffect(()=>{if(n.length>1){const o=setInterval(()=>{t(l=>(l+1)%n.length)},5e3);return()=>clearInterval(o)}},[n.length]);const s=D.useMemo(()=>n&&n.length>0?n:["https://picsum.photos/seed/default_fallback_1/1200/900"],[n]),a=D.useMemo(()=>r.pathname.includes("signup")?{title:"Create an Account",subtitle:"Join our platform to get started."}:r.pathname.includes("forgot-password")?{title:"Forgot Password?",subtitle:"No worries, we'll send you reset instructions."}:r.pathname.includes("update-password")?{title:"Set a New Password",subtitle:"Please enter your new password."}:{title:"Sign In",subtitle:"Enter your credentials to access your account."},[r.pathname]);return i.jsxs("div",{className:"min-h-screen font-sans flex items-center justify-center bg-page relative overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[s.map((o,l)=>i.jsx("div",{className:`absolute inset-0 w-full h-full bg-cover bg-center transition-opacity duration-1000 ease-in-out ${l===e?"opacity-100":"opacity-0"}`,style:{backgroundImage:`url(${o})`}},l)),i.jsx("div",{className:"absolute inset-0 bg-black/30"})," "]}),i.jsx("div",{className:"relative w-full max-w-3xl lg:max-w-4xl xl:max-w-5xl p-4",children:i.jsxs("div",{className:"auth-card-container w-full grid md:grid-cols-2 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-md bg-black/40 border border-[#041b0f] md:border-white/10",children:[i.jsxs("div",{className:"hidden md:flex flex-col justify-between p-6 lg:p-10 xl:p-16 bg-gradient-to-br from-black/40 to-black/70",children:[i.jsxs("div",{children:[i.jsx(Gi,{className:"h-8 lg:h-12 xl:h-14"}),i.jsx("h1",{className:"text-xl lg:text-2xl xl:text-4xl font-bold text-white mt-6 lg:mt-8 leading-tight drop-shadow-lg",children:"Welcome to the Future of Onboarding."}),i.jsx("p",{className:"text-white/80 mt-4 max-w-md drop-shadow-lg text-xs lg:text-sm xl:text-base",children:"Streamlining the journey for every new member of the Paradigm family."})]}),i.jsx("div",{children:i.jsxs("p",{className:"text-white/50 text-[10px] lg:text-xs mt-4",children:[" ",new Date().getFullYear()," Paradigm Services. All rights reserved."]})})]}),i.jsx("div",{className:"p-6 lg:p-10 xl:p-16 flex flex-col justify-center bg-[#050505]/85 backdrop-blur-xl border-l border-white/10",children:i.jsxs("div",{className:"w-full max-w-md mx-auto",children:[i.jsx("div",{className:"md:hidden flex justify-center mb-8",children:i.jsx(Gi,{className:"h-12"})}),i.jsx("h2",{className:"text-xl lg:text-2xl xl:text-3xl font-bold text-white mb-2",children:a.title}),i.jsx("p",{className:"text-gray-300 mb-4 lg:mb-6 xl:mb-8 text-xs lg:text-sm xl:text-base",children:a.subtitle}),i.jsx(gf,{})]})})]})})]})};function EJ(){const[n,e]=D.useState({isSecure:!0,issues:[],developerModeEnabled:!1,locationSpoofingDetected:!1});return D.useEffect(()=>{const t=()=>{const s=[];let a=!1,o=!1;("geolocation"in navigator,!1)&&(o=!0,s.push("Location spoofing detected. Please disable location mocking apps to continue."));const c=s.length===0;e({isSecure:c,issues:s,developerModeEnabled:a,locationSpoofingDetected:o})};t();const r=setInterval(t,2e3);return window.addEventListener("resize",t),()=>{clearInterval(r),window.removeEventListener("resize",t)}},[]),n}const OJ=({issues:n,onDismiss:e})=>{const[t,r]=D.useState(!1);return D.useEffect(()=>{const s=()=>{r(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),t?i.jsx("div",{className:"fixed inset-0 z-50 bg-white overflow-y-auto",children:i.jsxs("div",{className:"min-h-screen p-4 flex flex-col",children:[i.jsx("div",{className:"flex justify-center mt-8 mb-6",children:i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(um,{className:"w-8 h-8 text-red-600"})})}),i.jsx("h2",{className:"text-xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),i.jsxs("div",{className:"space-y-3 mb-4",children:[i.jsx("p",{className:"text-gray-700 text-center text-sm",children:"Access to this application has been temporarily blocked for security reasons:"}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:i.jsx("ul",{className:"space-y-2",children:n.map((s,a)=>i.jsxs("li",{className:"flex items-start gap-2 text-xs text-red-800",children:[i.jsx(Da,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:s})]},a))})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2 text-sm",children:"To continue:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs text-blue-800",children:[i.jsx("li",{children:"Close browser developer tools (F12)"}),i.jsx("li",{children:"Disable any location spoofing apps or extensions"}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:i.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&i.jsx(re,{onClick:e,variant:"outline",className:"w-full mt-auto",size:"sm",children:"I Understand"})]})}):i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 animate-in fade-in zoom-in duration-300",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(um,{className:"w-10 h-10 text-red-600"})})}),i.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),i.jsxs("div",{className:"space-y-3 mb-6",children:[i.jsx("p",{className:"text-gray-700 text-center",children:"Access to this application has been temporarily blocked for security reasons:"}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsx("ul",{className:"space-y-2",children:n.map((s,a)=>i.jsxs("li",{className:"flex items-start gap-2 text-sm text-red-800",children:[i.jsx(Da,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:s})]},a))})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"To continue:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[i.jsx("li",{children:"Close browser developer tools (F12)"}),i.jsx("li",{children:"Disable any location spoofing apps or extensions"}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6",children:i.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&i.jsx(re,{onClick:e,variant:"outline",className:"w-full",children:"I Understand"})]})})},IJ=({children:n})=>{const{user:e}=jt(),t=EJ(),[r,s]=D.useState(!1),a=e&&(e.role==="admin"||e.role==="developer");return D.useEffect(()=>{if(e&&!a&&!t.isSecure&&!r){const o=t.developerModeEnabled?"developer_mode":"location_spoofing";ue.sendSecurityAlert(e.id,e.name,o,void 0).catch(l=>console.error("Failed to send security alert:",l)),s(!0)}},[e,t,r,a]),e&&!a&&!t.isSecure?i.jsx(OJ,{issues:t.issues}):i.jsx(i.Fragment,{children:n})},AJ=({onComplete:n})=>{const e=Ft("(max-width: 767px)"),[t,r]=D.useState("prompt"),[s,a]=D.useState("prompt"),[o,l]=D.useState(!1),[c,d]=D.useState(null),h=t==="granted"&&s==="granted";D.useEffect(()=>{(!e||h)&&n()},[e,h,n]);const p=async()=>{l(!0),d(null);try{try{const x=await navigator.mediaDevices.getUserMedia({video:!0});a("granted"),x.getTracks().forEach(v=>v.stop())}catch{throw a("denied"),new Error("Camera permission was denied.")}try{await new Promise((x,v)=>{navigator.geolocation.getCurrentPosition(()=>{r("granted"),x(!0)},()=>{r("denied"),v(new Error("Location permission was denied."))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})}catch{throw new Error("Location permission was denied.")}n()}catch(x){d(x.message||"Permissions are required to use this app.")}finally{l(!1)}};return e?i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4 text-center",children:[i.jsx("div",{className:"splash-logo",children:i.jsx(Gi,{className:"h-16 mb-8"})}),i.jsxs("div",{className:"max-w-md",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Permissions Required"}),i.jsx("p",{className:"text-gray-600 mb-8",children:"To ensure the best experience and enable features like location-based check-ins and photo uploads, we need access to your device's Camera and Location."}),i.jsxs("div",{className:"space-y-4 mb-8",children:[i.jsxs("div",{className:`p-4 rounded-lg border ${t==="granted"?"bg-green-100 border-green-300":"bg-gray-100 border-gray-300"}`,children:[i.jsx("p",{className:"font-semibold",children:"Location Access"}),i.jsx("p",{className:"text-sm",children:t==="granted"?"Permission Granted":"Needed for check-in/out"})]}),i.jsxs("div",{className:`p-4 rounded-lg border ${s==="granted"?"bg-green-100 border-green-300":"bg-gray-100 border-gray-300"}`,children:[i.jsx("p",{className:"font-semibold",children:"Camera Access"}),i.jsx("p",{className:"text-sm",children:s==="granted"?"Permission Granted":"Needed for identity verification"})]})]}),i.jsx(re,{onClick:p,disabled:o,children:o?"Requesting...":"Grant Permissions"}),c&&i.jsx("p",{className:"text-red-500 mt-4",children:c}),i.jsx("p",{className:"text-xs text-gray-500 mt-8",children:"You can manage these permissions in your device settings at any time."})]})]}):null},RJ=()=>{const[n,e]=D.useState(!1),t=()=>{e(!0)};return n?i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4",children:[i.jsx("div",{className:"splash-logo",children:i.jsx(Gi,{className:"h-16 mb-8"})}),i.jsx("p",{className:"text-gray-600",children:"Loading Application..."})]}):i.jsx(AJ,{onComplete:t})},LJ=()=>{const{user:n,logout:e}=jt(),{permissions:t}=Ki(),r=St();if(!n)return null;const s=i3.filter(o=>t[n.role]?.includes(o.permission)).sort((o,l)=>o.label.localeCompare(l.label)),a=async()=>{await e(),r("/auth/login")};return i.jsxs("div",{className:"min-h-[calc(100vh-180px)] flex flex-col pb-4 bg-[#041b0f]",children:[i.jsx("div",{className:"bg-[#041b0f] p-6 rounded-3xl shadow-lg -mx-4 mb-6",children:i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Wi,{photoUrl:n.photoUrl,seed:n.id,className:"h-14 w-14 rounded-full border-2 border-[#22c55e]"}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold text-white",children:["Hi, ",n.name.split(" ")[0]]}),i.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:n.role.replace(/_/g," ")})]})]})})}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsx("h2",{className:"text-lg font-semibold text-white mb-4 px-2",children:"Apps & Features"}),i.jsx("div",{className:"grid grid-cols-3 gap-3 px-2 flex-1 content-start",children:s.map(o=>i.jsxs("div",{onClick:()=>r(o.to),className:"flex flex-col items-center justify-center p-4 bg-[#041b0f] border border-[#1f3d2b] rounded-2xl active:scale-95 transition-transform duration-150 shadow-md min-h-[110px]",children:[i.jsx("div",{className:"p-3 bg-[#041b0f] rounded-full mb-2 text-[#22c55e]",children:i.jsx(o.icon,{className:"w-7 h-7"})}),i.jsx("span",{className:"text-xs text-center text-gray-300 font-medium leading-tight",children:o.label})]},o.to))})]}),i.jsx("div",{className:"px-2 mt-6",children:i.jsxs("button",{onClick:a,className:"w-full flex items-center justify-center space-x-2 p-4 bg-[#1f2937] text-white rounded-xl font-semibold active:bg-[#374151] transition-colors",children:[i.jsx(bo,{className:"w-5 h-5"}),i.jsx("span",{children:"Log Out"})]})})]})};var Cm=n=>n.type==="checkbox",tu=n=>n instanceof Date,Us=n=>n==null;const o3=n=>typeof n=="object";var vr=n=>!Us(n)&&!Array.isArray(n)&&o3(n)&&!tu(n),l3=n=>vr(n)&&n.target?Cm(n.target)?n.target.checked:n.target.value:n,FJ=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,c3=(n,e)=>n.has(FJ(e)),qJ=n=>{const e=n.constructor&&n.constructor.prototype;return vr(e)&&e.hasOwnProperty("isPrototypeOf")},CC=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Fn(n){let e;const t=Array.isArray(n),r=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(CC&&(n instanceof Blob||r))&&(t||vr(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!qJ(n))e=n;else for(const s in n)n.hasOwnProperty(s)&&(e[s]=Fn(n[s]));else return n;return e}var ty=n=>/^\w*$/.test(n),An=n=>n===void 0,ny=n=>Array.isArray(n)?n.filter(Boolean):[],TC=n=>ny(n.replace(/["|']|\]/g,"").split(/\.|\[/)),nt=(n,e,t)=>{if(!e||!vr(n))return t;const r=(ty(e)?[e]:TC(e)).reduce((s,a)=>Us(s)?s:s[a],n);return An(r)||r===n?An(n[e])?t:n[e]:r},ci=n=>typeof n=="boolean",hn=(n,e,t)=>{let r=-1;const s=ty(e)?[e]:TC(e),a=s.length,o=a-1;for(;++r<a;){const l=s[r];let c=t;if(r!==o){const d=n[l];c=vr(d)||Array.isArray(d)?d:isNaN(+s[r+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=c,n=n[l]}};const Cx={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Bi={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},cl={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},d3=ot.createContext(null);d3.displayName="HookFormContext";const ry=()=>ot.useContext(d3);var u3=(n,e,t,r=!0)=>{const s={defaultValues:e._defaultValues};for(const a in n)Object.defineProperty(s,a,{get:()=>{const o=a;return e._proxyFormState[o]!==Bi.all&&(e._proxyFormState[o]=!r||Bi.all),t&&(t[o]=!0),n[o]}});return s};const sy=typeof window<"u"?ot.useLayoutEffect:ot.useEffect;function zJ(n){const e=ry(),{control:t=e.control,disabled:r,name:s,exact:a}=n||{},[o,l]=ot.useState(t._formState),c=ot.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return sy(()=>t._subscribe({name:s,formState:c.current,exact:a,callback:d=>{!r&&l({...t._formState,...d})}}),[s,r,a]),ot.useEffect(()=>{c.current.isValid&&t._setValid(!0)},[t]),ot.useMemo(()=>u3(o,t,c.current,!1),[o,t])}var hi=n=>typeof n=="string",TS=(n,e,t,r,s)=>hi(n)?(r&&e.watch.add(n),nt(t,n,s)):Array.isArray(n)?n.map(a=>(r&&e.watch.add(a),nt(t,a))):(r&&(e.watchAll=!0),t),kS=n=>Us(n)||!o3(n);function ja(n,e,t=new WeakSet){if(kS(n)||kS(e))return n===e;if(tu(n)&&tu(e))return n.getTime()===e.getTime();const r=Object.keys(n),s=Object.keys(e);if(r.length!==s.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const a of r){const o=n[a];if(!s.includes(a))return!1;if(a!=="ref"){const l=e[a];if(tu(o)&&tu(l)||vr(o)&&vr(l)||Array.isArray(o)&&Array.isArray(l)?!ja(o,l,t):o!==l)return!1}}return!0}function su(n){const e=ry(),{control:t=e.control,name:r,defaultValue:s,disabled:a,exact:o,compute:l}=n||{},c=ot.useRef(s),d=ot.useRef(l),h=ot.useRef(void 0),p=ot.useRef(t),x=ot.useRef(r);d.current=l;const[v,_]=ot.useState(()=>{const M=t._getWatch(r,c.current);return d.current?d.current(M):M}),w=ot.useCallback(M=>{const O=TS(r,t._names,M||t._formValues,!1,c.current);return d.current?d.current(O):O},[t._formValues,t._names,r]),j=ot.useCallback(M=>{if(!a){const O=TS(r,t._names,M||t._formValues,!1,c.current);if(d.current){const I=d.current(O);ja(I,h.current)||(_(I),h.current=I)}else _(O)}},[t._formValues,t._names,a,r]);sy(()=>((p.current!==t||!ja(x.current,r))&&(p.current=t,x.current=r,j()),t._subscribe({name:r,formState:{values:!0},exact:o,callback:M=>{j(M.values)}})),[t,o,r,j]),ot.useEffect(()=>t._removeUnmounted());const T=p.current!==t,P=x.current,E=ot.useMemo(()=>{if(a)return null;const M=!T&&!ja(P,r);return T||M?w():null},[a,T,r,P,w]);return E!==null?E:v}function UJ(n){const e=ry(),{name:t,disabled:r,control:s=e.control,shouldUnregister:a,defaultValue:o}=n,l=c3(s._names.array,t),c=ot.useMemo(()=>nt(s._formValues,t,nt(s._defaultValues,t,o)),[s,t,o]),d=su({control:s,name:t,defaultValue:c,exact:!0}),h=zJ({control:s,name:t,exact:!0}),p=ot.useRef(n),x=ot.useRef(void 0),v=ot.useRef(s.register(t,{...n.rules,value:d,...ci(n.disabled)?{disabled:n.disabled}:{}}));p.current=n;const _=ot.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!nt(h.errors,t)},isDirty:{enumerable:!0,get:()=>!!nt(h.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!nt(h.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!nt(h.validatingFields,t)},error:{enumerable:!0,get:()=>nt(h.errors,t)}}),[h,t]),w=ot.useCallback(E=>v.current.onChange({target:{value:l3(E),name:t},type:Cx.CHANGE}),[t]),j=ot.useCallback(()=>v.current.onBlur({target:{value:nt(s._formValues,t),name:t},type:Cx.BLUR}),[t,s._formValues]),T=ot.useCallback(E=>{const M=nt(s._fields,t);M&&E&&(M._f.ref={focus:()=>E.focus&&E.focus(),select:()=>E.select&&E.select(),setCustomValidity:O=>E.setCustomValidity(O),reportValidity:()=>E.reportValidity()})},[s._fields,t]),P=ot.useMemo(()=>({name:t,value:d,...ci(r)||h.disabled?{disabled:h.disabled||r}:{},onChange:w,onBlur:j,ref:T}),[t,r,h.disabled,w,j,T,d]);return ot.useEffect(()=>{const E=s._options.shouldUnregister||a,M=x.current;M&&M!==t&&!l&&s.unregister(M),s.register(t,{...p.current.rules,...ci(p.current.disabled)?{disabled:p.current.disabled}:{}});const O=(I,q)=>{const F=nt(s._fields,I);F&&F._f&&(F._f.mount=q)};if(O(t,!0),E){const I=Fn(nt(s._options.defaultValues,t,p.current.defaultValue));hn(s._defaultValues,t,I),An(nt(s._formValues,t))&&hn(s._formValues,t,I)}return!l&&s.register(t),x.current=t,()=>{(l?E&&!s._state.action:E)?s.unregister(t):O(t,!1)}},[t,s,l,a]),ot.useEffect(()=>{s._setDisabledField({disabled:r,name:t})},[r,t,s]),ot.useMemo(()=>({field:P,formState:h,fieldState:_}),[P,h,_])}const we=n=>n.render(UJ(n));var f3=(n,e,t,r,s)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[r]:s||!0}}:{},Ws=n=>Array.isArray(n)?n:[n],IM=()=>{let n=[];return{get observers(){return n},next:s=>{for(const a of n)a.next&&a.next(s)},subscribe:s=>(n.push(s),{unsubscribe:()=>{n=n.filter(a=>a!==s)}}),unsubscribe:()=>{n=[]}}};function h3(n,e){const t={};for(const r in n)if(n.hasOwnProperty(r)){const s=n[r],a=e[r];if(s&&vr(s)&&a){const o=h3(s,a);vr(o)&&(t[r]=o)}else n[r]&&(t[r]=a)}return t}var rs=n=>vr(n)&&!Object.keys(n).length,kC=n=>n.type==="file",Na=n=>typeof n=="function",Tx=n=>{if(!CC)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},m3=n=>n.type==="select-multiple",PC=n=>n.type==="radio",VJ=n=>PC(n)||Cm(n),ob=n=>Tx(n)&&n.isConnected;function BJ(n,e){const t=e.slice(0,-1).length;let r=0;for(;r<t;)n=An(n)?r++:n[e[r++]];return n}function WJ(n){for(const e in n)if(n.hasOwnProperty(e)&&!An(n[e]))return!1;return!0}function ir(n,e){const t=Array.isArray(e)?e:ty(e)?[e]:TC(e),r=t.length===1?n:BJ(n,t),s=t.length-1,a=t[s];return r&&delete r[a],s!==0&&(vr(r)&&rs(r)||Array.isArray(r)&&WJ(r))&&ir(n,t.slice(0,-1)),n}var $J=n=>{for(const e in n)if(Na(n[e]))return!0;return!1};function p3(n){return Array.isArray(n)||vr(n)&&!$J(n)}function PS(n,e={}){for(const t in n)p3(n[t])?(e[t]=Array.isArray(n[t])?[]:{},PS(n[t],e[t])):An(n[t])||(e[t]=!0);return e}function rf(n,e,t){t||(t=PS(e));for(const r in n)p3(n[r])?An(e)||kS(t[r])?t[r]=PS(n[r],Array.isArray(n[r])?[]:{}):rf(n[r],Us(e)?{}:e[r],t[r]):t[r]=!ja(n[r],e[r]);return t}const AM={value:!1,isValid:!1},RM={value:!0,isValid:!0};var g3=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!An(n[0].attributes.value)?An(n[0].value)||n[0].value===""?RM:{value:n[0].value,isValid:!0}:RM:AM}return AM},x3=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:r})=>An(n)?n:e?n===""?NaN:n&&+n:t&&hi(n)?new Date(n):r?r(n):n;const LM={isValid:!1,value:null};var y3=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,LM):LM;function FM(n){const e=n.ref;return kC(e)?e.files:PC(e)?y3(n.refs).value:m3(e)?[...e.selectedOptions].map(({value:t})=>t):Cm(e)?g3(n.refs).value:x3(An(e.value)?n.ref.value:e.value,n)}var HJ=(n,e,t,r)=>{const s={};for(const a of n){const o=nt(e,a);o&&hn(s,a,o._f)}return{criteriaMode:t,names:[...n],fields:s,shouldUseNativeValidation:r}},kx=n=>n instanceof RegExp,xh=n=>An(n)?n:kx(n)?n.source:vr(n)?kx(n.value)?n.value.source:n.value:n,af=n=>({isOnSubmit:!n||n===Bi.onSubmit,isOnBlur:n===Bi.onBlur,isOnChange:n===Bi.onChange,isOnAll:n===Bi.all,isOnTouch:n===Bi.onTouched});const qM="AsyncFunction";var YJ=n=>!!n&&!!n.validate&&!!(Na(n.validate)&&n.validate.constructor.name===qM||vr(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===qM)),GJ=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),MS=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(r=>n.startsWith(r)&&/^\.\w+/.test(n.slice(r.length))));const ff=(n,e,t,r)=>{for(const s of t||Object.keys(n)){const a=nt(n,s);if(a){const{_f:o,...l}=a;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],s)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(ff(l,e))break}else if(vr(l)&&ff(l,e))break}}};function zM(n,e,t){const r=nt(n,t);if(r||ty(t))return{error:r,name:t};const s=t.split(".");for(;s.length;){const a=s.join("."),o=nt(e,a),l=nt(n,a);if(o&&!Array.isArray(o)&&t!==a)return{name:t};if(l&&l.type)return{name:a,error:l};if(l&&l.root&&l.root.type)return{name:`${a}.root`,error:l.root};s.pop()}return{name:t}}var ZJ=(n,e,t,r)=>{t(n);const{name:s,...a}=n;return rs(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(o=>e[o]===(!r||Bi.all))},KJ=(n,e,t)=>!n||!e||n===e||Ws(n).some(r=>r&&(t?r===e:r.startsWith(e)||e.startsWith(r))),JJ=(n,e,t,r,s)=>s.isOnAll?!1:!t&&s.isOnTouch?!(e||n):(t?r.isOnBlur:s.isOnBlur)?!n:(t?r.isOnChange:s.isOnChange)?n:!0,QJ=(n,e)=>!ny(nt(n,e)).length&&ir(n,e),v3=(n,e,t)=>{const r=Ws(nt(n,t));return hn(r,"root",e[t]),hn(n,t,r),n};function UM(n,e,t="validate"){if(hi(n)||Array.isArray(n)&&n.every(hi)||ci(n)&&!n)return{type:t,message:hi(n)?n:"",ref:e}}var Gu=n=>vr(n)&&!kx(n)?n:{value:n,message:""},DS=async(n,e,t,r,s,a)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:h,min:p,max:x,pattern:v,validate:_,name:w,valueAsNumber:j,mount:T}=n._f,P=nt(t,w);if(!T||e.has(w))return{};const E=l?l[0]:o,M=$=>{s&&E.reportValidity&&(E.setCustomValidity(ci($)?"":$||""),E.reportValidity())},O={},I=PC(o),q=Cm(o),F=I||q,B=(j||kC(o))&&An(o.value)&&An(P)||Tx(o)&&o.value===""||P===""||Array.isArray(P)&&!P.length,U=f3.bind(null,w,r,O),W=($,se,Y,ae=cl.maxLength,J=cl.minLength)=>{const ee=$?se:Y;O[w]={type:$?ae:J,message:ee,ref:o,...U($?ae:J,ee)}};if(a?!Array.isArray(P)||!P.length:c&&(!F&&(B||Us(P))||ci(P)&&!P||q&&!g3(l).isValid||I&&!y3(l).isValid)){const{value:$,message:se}=hi(c)?{value:!!c,message:c}:Gu(c);if($&&(O[w]={type:cl.required,message:se,ref:E,...U(cl.required,se)},!r))return M(se),O}if(!B&&(!Us(p)||!Us(x))){let $,se;const Y=Gu(x),ae=Gu(p);if(!Us(P)&&!isNaN(P)){const J=o.valueAsNumber||P&&+P;Us(Y.value)||($=J>Y.value),Us(ae.value)||(se=J<ae.value)}else{const J=o.valueAsDate||new Date(P),ee=oe=>new Date(new Date().toDateString()+" "+oe),X=o.type=="time",Z=o.type=="week";hi(Y.value)&&P&&($=X?ee(P)>ee(Y.value):Z?P>Y.value:J>new Date(Y.value)),hi(ae.value)&&P&&(se=X?ee(P)<ee(ae.value):Z?P<ae.value:J<new Date(ae.value))}if(($||se)&&(W(!!$,Y.message,ae.message,cl.max,cl.min),!r))return M(O[w].message),O}if((d||h)&&!B&&(hi(P)||a&&Array.isArray(P))){const $=Gu(d),se=Gu(h),Y=!Us($.value)&&P.length>+$.value,ae=!Us(se.value)&&P.length<+se.value;if((Y||ae)&&(W(Y,$.message,se.message),!r))return M(O[w].message),O}if(v&&!B&&hi(P)){const{value:$,message:se}=Gu(v);if(kx($)&&!P.match($)&&(O[w]={type:cl.pattern,message:se,ref:o,...U(cl.pattern,se)},!r))return M(se),O}if(_){if(Na(_)){const $=await _(P,t),se=UM($,E);if(se&&(O[w]={...se,...U(cl.validate,se.message)},!r))return M(se.message),O}else if(vr(_)){let $={};for(const se in _){if(!rs($)&&!r)break;const Y=UM(await _[se](P,t),E,se);Y&&($={...Y,...U(se,Y.message)},M(Y.message),r&&(O[w]=$))}if(!rs($)&&(O[w]={ref:E,...$},!r))return O}}return M(!0),O};const XJ={mode:Bi.onSubmit,reValidateMode:Bi.onChange,shouldFocusError:!0};function eQ(n={}){let e={...XJ,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:Na(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},s=vr(e.defaultValues)||vr(e.values)?Fn(e.defaultValues||e.values)||{}:{},a=e.shouldUnregister?{}:Fn(s),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...h};const x={array:IM(),state:IM()},v=e.criteriaMode===Bi.all,_=te=>le=>{clearTimeout(d),d=setTimeout(te,le)},w=async te=>{if(!e.disabled&&(h.isValid||p.isValid||te)){const le=e.resolver?rs((await q()).errors):await B(r,!0);le!==t.isValid&&x.state.next({isValid:le})}},j=(te,le)=>{!e.disabled&&(h.isValidating||h.validatingFields||p.isValidating||p.validatingFields)&&((te||Array.from(l.mount)).forEach(ye=>{ye&&(le?hn(t.validatingFields,ye,le):ir(t.validatingFields,ye))}),x.state.next({validatingFields:t.validatingFields,isValidating:!rs(t.validatingFields)}))},T=(te,le=[],ye,Ve,ze=!0,Le=!0)=>{if(Ve&&ye&&!e.disabled){if(o.action=!0,Le&&Array.isArray(nt(r,te))){const rt=ye(nt(r,te),Ve.argA,Ve.argB);ze&&hn(r,te,rt)}if(Le&&Array.isArray(nt(t.errors,te))){const rt=ye(nt(t.errors,te),Ve.argA,Ve.argB);ze&&hn(t.errors,te,rt),QJ(t.errors,te)}if((h.touchedFields||p.touchedFields)&&Le&&Array.isArray(nt(t.touchedFields,te))){const rt=ye(nt(t.touchedFields,te),Ve.argA,Ve.argB);ze&&hn(t.touchedFields,te,rt)}(h.dirtyFields||p.dirtyFields)&&(t.dirtyFields=rf(s,a)),x.state.next({name:te,isDirty:W(te,le),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else hn(a,te,le)},P=(te,le)=>{hn(t.errors,te,le),x.state.next({errors:t.errors})},E=te=>{t.errors=te,x.state.next({errors:t.errors,isValid:!1})},M=(te,le,ye,Ve)=>{const ze=nt(r,te);if(ze){const Le=nt(a,te,An(ye)?nt(s,te):ye);An(Le)||Ve&&Ve.defaultChecked||le?hn(a,te,le?Le:FM(ze._f)):Y(te,Le),o.mount&&w()}},O=(te,le,ye,Ve,ze)=>{let Le=!1,rt=!1;const Xe={name:te};if(!e.disabled){if(!ye||Ve){(h.isDirty||p.isDirty)&&(rt=t.isDirty,t.isDirty=Xe.isDirty=W(),Le=rt!==Xe.isDirty);const tt=ja(nt(s,te),le);rt=!!nt(t.dirtyFields,te),tt?ir(t.dirtyFields,te):hn(t.dirtyFields,te,!0),Xe.dirtyFields=t.dirtyFields,Le=Le||(h.dirtyFields||p.dirtyFields)&&rt!==!tt}if(ye){const tt=nt(t.touchedFields,te);tt||(hn(t.touchedFields,te,ye),Xe.touchedFields=t.touchedFields,Le=Le||(h.touchedFields||p.touchedFields)&&tt!==ye)}Le&&ze&&x.state.next(Xe)}return Le?Xe:{}},I=(te,le,ye,Ve)=>{const ze=nt(t.errors,te),Le=(h.isValid||p.isValid)&&ci(le)&&t.isValid!==le;if(e.delayError&&ye?(c=_(()=>P(te,ye)),c(e.delayError)):(clearTimeout(d),c=null,ye?hn(t.errors,te,ye):ir(t.errors,te)),(ye?!ja(ze,ye):ze)||!rs(Ve)||Le){const rt={...Ve,...Le&&ci(le)?{isValid:le}:{},errors:t.errors,name:te};t={...t,...rt},x.state.next(rt)}},q=async te=>{j(te,!0);const le=await e.resolver(a,e.context,HJ(te||l.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return j(te),le},F=async te=>{const{errors:le}=await q(te);if(te)for(const ye of te){const Ve=nt(le,ye);Ve?hn(t.errors,ye,Ve):ir(t.errors,ye)}else t.errors=le;return le},B=async(te,le,ye={valid:!0})=>{for(const Ve in te){const ze=te[Ve];if(ze){const{_f:Le,...rt}=ze;if(Le){const Xe=l.array.has(Le.name),tt=ze._f&&YJ(ze._f);tt&&h.validatingFields&&j([Le.name],!0);const qt=await DS(ze,l.disabled,a,v,e.shouldUseNativeValidation&&!le,Xe);if(tt&&h.validatingFields&&j([Le.name]),qt[Le.name]&&(ye.valid=!1,le))break;!le&&(nt(qt,Le.name)?Xe?v3(t.errors,qt,Le.name):hn(t.errors,Le.name,qt[Le.name]):ir(t.errors,Le.name))}!rs(rt)&&await B(rt,le,ye)}}return ye.valid},U=()=>{for(const te of l.unMount){const le=nt(r,te);le&&(le._f.refs?le._f.refs.every(ye=>!ob(ye)):!ob(le._f.ref))&&ie(te)}l.unMount=new Set},W=(te,le)=>!e.disabled&&(te&&le&&hn(a,te,le),!ja(oe(),s)),$=(te,le,ye)=>TS(te,l,{...o.mount?a:An(le)?s:hi(te)?{[te]:le}:le},ye,le),se=te=>ny(nt(o.mount?a:s,te,e.shouldUnregister?nt(s,te,[]):[])),Y=(te,le,ye={})=>{const Ve=nt(r,te);let ze=le;if(Ve){const Le=Ve._f;Le&&(!Le.disabled&&hn(a,te,x3(le,Le)),ze=Tx(Le.ref)&&Us(le)?"":le,m3(Le.ref)?[...Le.ref.options].forEach(rt=>rt.selected=ze.includes(rt.value)):Le.refs?Cm(Le.ref)?Le.refs.forEach(rt=>{(!rt.defaultChecked||!rt.disabled)&&(Array.isArray(ze)?rt.checked=!!ze.find(Xe=>Xe===rt.value):rt.checked=ze===rt.value||!!ze)}):Le.refs.forEach(rt=>rt.checked=rt.value===ze):kC(Le.ref)?Le.ref.value="":(Le.ref.value=ze,Le.ref.type||x.state.next({name:te,values:Fn(a)})))}(ye.shouldDirty||ye.shouldTouch)&&O(te,ze,ye.shouldTouch,ye.shouldDirty,!0),ye.shouldValidate&&Z(te)},ae=(te,le,ye)=>{for(const Ve in le){if(!le.hasOwnProperty(Ve))return;const ze=le[Ve],Le=te+"."+Ve,rt=nt(r,Le);(l.array.has(te)||vr(ze)||rt&&!rt._f)&&!tu(ze)?ae(Le,ze,ye):Y(Le,ze,ye)}},J=(te,le,ye={})=>{const Ve=nt(r,te),ze=l.array.has(te),Le=Fn(le);hn(a,te,Le),ze?(x.array.next({name:te,values:Fn(a)}),(h.isDirty||h.dirtyFields||p.isDirty||p.dirtyFields)&&ye.shouldDirty&&x.state.next({name:te,dirtyFields:rf(s,a),isDirty:W(te,Le)})):Ve&&!Ve._f&&!Us(Le)?ae(te,Le,ye):Y(te,Le,ye),MS(te,l)&&x.state.next({...t,name:te}),x.state.next({name:o.mount?te:void 0,values:Fn(a)})},ee=async te=>{o.mount=!0;const le=te.target;let ye=le.name,Ve=!0;const ze=nt(r,ye),Le=tt=>{Ve=Number.isNaN(tt)||tu(tt)&&isNaN(tt.getTime())||ja(tt,nt(a,ye,tt))},rt=af(e.mode),Xe=af(e.reValidateMode);if(ze){let tt,qt;const bt=le.type?FM(ze._f):l3(te),Dt=te.type===Cx.BLUR||te.type===Cx.FOCUS_OUT,Xt=!GJ(ze._f)&&!e.resolver&&!nt(t.errors,ye)&&!ze._f.deps||JJ(Dt,nt(t.touchedFields,ye),t.isSubmitted,Xe,rt),en=MS(ye,l,Dt);hn(a,ye,bt),Dt?(!le||!le.readOnly)&&(ze._f.onBlur&&ze._f.onBlur(te),c&&c(0)):ze._f.onChange&&ze._f.onChange(te);const Yt=O(ye,bt,Dt),Ut=!rs(Yt)||en;if(!Dt&&x.state.next({name:ye,type:te.type,values:Fn(a)}),Xt)return(h.isValid||p.isValid)&&(e.mode==="onBlur"?Dt&&w():Dt||w()),Ut&&x.state.next({name:ye,...en?{}:Yt});if(!Dt&&en&&x.state.next({...t}),e.resolver){const{errors:Rn}=await q([ye]);if(Le(bt),Ve){const Nn=zM(t.errors,r,ye),an=zM(Rn,r,Nn.name||ye);tt=an.error,ye=an.name,qt=rs(Rn)}}else j([ye],!0),tt=(await DS(ze,l.disabled,a,v,e.shouldUseNativeValidation))[ye],j([ye]),Le(bt),Ve&&(tt?qt=!1:(h.isValid||p.isValid)&&(qt=await B(r,!0)));Ve&&(ze._f.deps&&(!Array.isArray(ze._f.deps)||ze._f.deps.length>0)&&Z(ze._f.deps),I(ye,qt,tt,Yt))}},X=(te,le)=>{if(nt(t.errors,le)&&te.focus)return te.focus(),1},Z=async(te,le={})=>{let ye,Ve;const ze=Ws(te);if(e.resolver){const Le=await F(An(te)?te:ze);ye=rs(Le),Ve=te?!ze.some(rt=>nt(Le,rt)):ye}else te?(Ve=(await Promise.all(ze.map(async Le=>{const rt=nt(r,Le);return await B(rt&&rt._f?{[Le]:rt}:rt)}))).every(Boolean),!(!Ve&&!t.isValid)&&w()):Ve=ye=await B(r);return x.state.next({...!hi(te)||(h.isValid||p.isValid)&&ye!==t.isValid?{}:{name:te},...e.resolver||!te?{isValid:ye}:{},errors:t.errors}),le.shouldFocus&&!Ve&&ff(r,X,te?ze:l.mount),Ve},oe=(te,le)=>{let ye={...o.mount?a:s};return le&&(ye=h3(le.dirtyFields?t.dirtyFields:t.touchedFields,ye)),An(te)?ye:hi(te)?nt(ye,te):te.map(Ve=>nt(ye,Ve))},H=(te,le)=>({invalid:!!nt((le||t).errors,te),isDirty:!!nt((le||t).dirtyFields,te),error:nt((le||t).errors,te),isValidating:!!nt(t.validatingFields,te),isTouched:!!nt((le||t).touchedFields,te)}),Q=te=>{te&&Ws(te).forEach(le=>ir(t.errors,le)),x.state.next({errors:te?t.errors:{}})},ne=(te,le,ye)=>{const Ve=(nt(r,te,{_f:{}})._f||{}).ref,ze=nt(t.errors,te)||{},{ref:Le,message:rt,type:Xe,...tt}=ze;hn(t.errors,te,{...tt,...le,ref:Ve}),x.state.next({name:te,errors:t.errors,isValid:!1}),ye&&ye.shouldFocus&&Ve&&Ve.focus&&Ve.focus()},de=(te,le)=>Na(te)?x.state.subscribe({next:ye=>"values"in ye&&te($(void 0,le),ye)}):$(te,le,!0),ce=te=>x.state.subscribe({next:le=>{KJ(te.name,le.name,te.exact)&&ZJ(le,te.formState||h,Ue,te.reRenderRoot)&&te.callback({values:{...a},...t,...le,defaultValues:s})}}).unsubscribe,pe=te=>(o.mount=!0,p={...p,...te.formState},ce({...te,formState:p})),ie=(te,le={})=>{for(const ye of te?Ws(te):l.mount)l.mount.delete(ye),l.array.delete(ye),le.keepValue||(ir(r,ye),ir(a,ye)),!le.keepError&&ir(t.errors,ye),!le.keepDirty&&ir(t.dirtyFields,ye),!le.keepTouched&&ir(t.touchedFields,ye),!le.keepIsValidating&&ir(t.validatingFields,ye),!e.shouldUnregister&&!le.keepDefaultValue&&ir(s,ye);x.state.next({values:Fn(a)}),x.state.next({...t,...le.keepDirty?{isDirty:W()}:{}}),!le.keepIsValid&&w()},xe=({disabled:te,name:le})=>{(ci(te)&&o.mount||te||l.disabled.has(le))&&(te?l.disabled.add(le):l.disabled.delete(le))},Ce=(te,le={})=>{let ye=nt(r,te);const Ve=ci(le.disabled)||ci(e.disabled);return hn(r,te,{...ye||{},_f:{...ye&&ye._f?ye._f:{ref:{name:te}},name:te,mount:!0,...le}}),l.mount.add(te),ye?xe({disabled:ci(le.disabled)?le.disabled:e.disabled,name:te}):M(te,!0,le.value),{...Ve?{disabled:le.disabled||e.disabled}:{},...e.progressive?{required:!!le.required,min:xh(le.min),max:xh(le.max),minLength:xh(le.minLength),maxLength:xh(le.maxLength),pattern:xh(le.pattern)}:{},name:te,onChange:ee,onBlur:ee,ref:ze=>{if(ze){Ce(te,le),ye=nt(r,te);const Le=An(ze.value)&&ze.querySelectorAll&&ze.querySelectorAll("input,select,textarea")[0]||ze,rt=VJ(Le),Xe=ye._f.refs||[];if(rt?Xe.find(tt=>tt===Le):Le===ye._f.ref)return;hn(r,te,{_f:{...ye._f,...rt?{refs:[...Xe.filter(ob),Le,...Array.isArray(nt(s,te))?[{}]:[]],ref:{type:Le.type,name:te}}:{ref:Le}}}),M(te,!1,void 0,Le)}else ye=nt(r,te,{}),ye._f&&(ye._f.mount=!1),(e.shouldUnregister||le.shouldUnregister)&&!(c3(l.array,te)&&o.action)&&l.unMount.add(te)}}},ve=()=>e.shouldFocusError&&ff(r,X,l.mount),Oe=te=>{ci(te)&&(x.state.next({disabled:te}),ff(r,(le,ye)=>{const Ve=nt(r,ye);Ve&&(le.disabled=Ve._f.disabled||te,Array.isArray(Ve._f.refs)&&Ve._f.refs.forEach(ze=>{ze.disabled=Ve._f.disabled||te}))},0,!1))},Pe=(te,le)=>async ye=>{let Ve;ye&&(ye.preventDefault&&ye.preventDefault(),ye.persist&&ye.persist());let ze=Fn(a);if(x.state.next({isSubmitting:!0}),e.resolver){const{errors:Le,values:rt}=await q();t.errors=Le,ze=Fn(rt)}else await B(r);if(l.disabled.size)for(const Le of l.disabled)ir(ze,Le);if(ir(t.errors,"root"),rs(t.errors)){x.state.next({errors:{}});try{await te(ze,ye)}catch(Le){Ve=Le}}else le&&await le({...t.errors},ye),ve(),setTimeout(ve);if(x.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:rs(t.errors)&&!Ve,submitCount:t.submitCount+1,errors:t.errors}),Ve)throw Ve},Ie=(te,le={})=>{nt(r,te)&&(An(le.defaultValue)?J(te,Fn(nt(s,te))):(J(te,le.defaultValue),hn(s,te,Fn(le.defaultValue))),le.keepTouched||ir(t.touchedFields,te),le.keepDirty||(ir(t.dirtyFields,te),t.isDirty=le.defaultValue?W(te,Fn(nt(s,te))):W()),le.keepError||(ir(t.errors,te),h.isValid&&w()),x.state.next({...t}))},Fe=(te,le={})=>{const ye=te?Fn(te):s,Ve=Fn(ye),ze=rs(te),Le=ze?s:Ve;if(le.keepDefaultValues||(s=ye),!le.keepValues){if(le.keepDirtyValues){const rt=new Set([...l.mount,...Object.keys(rf(s,a))]);for(const Xe of Array.from(rt))nt(t.dirtyFields,Xe)?hn(Le,Xe,nt(a,Xe)):J(Xe,nt(Le,Xe))}else{if(CC&&An(te))for(const rt of l.mount){const Xe=nt(r,rt);if(Xe&&Xe._f){const tt=Array.isArray(Xe._f.refs)?Xe._f.refs[0]:Xe._f.ref;if(Tx(tt)){const qt=tt.closest("form");if(qt){qt.reset();break}}}}if(le.keepFieldsRef)for(const rt of l.mount)J(rt,nt(Le,rt));else r={}}a=e.shouldUnregister?le.keepDefaultValues?Fn(s):{}:Fn(Le),x.array.next({values:{...Le}}),x.state.next({values:{...Le}})}l={mount:le.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!h.isValid||!!le.keepIsValid||!!le.keepDirtyValues||!e.shouldUnregister&&!rs(Le),o.watch=!!e.shouldUnregister,x.state.next({submitCount:le.keepSubmitCount?t.submitCount:0,isDirty:ze?!1:le.keepDirty?t.isDirty:!!(le.keepDefaultValues&&!ja(te,s)),isSubmitted:le.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ze?{}:le.keepDirtyValues?le.keepDefaultValues&&a?rf(s,a):t.dirtyFields:le.keepDefaultValues&&te?rf(s,te):le.keepDirty?t.dirtyFields:{},touchedFields:le.keepTouched?t.touchedFields:{},errors:le.keepErrors?t.errors:{},isSubmitSuccessful:le.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},_e=(te,le)=>Fe(Na(te)?te(a):te,le),Ne=(te,le={})=>{const ye=nt(r,te),Ve=ye&&ye._f;if(Ve){const ze=Ve.refs?Ve.refs[0]:Ve.ref;ze.focus&&(ze.focus(),le.shouldSelect&&Na(ze.select)&&ze.select())}},Ue=te=>{t={...t,...te}},qe={control:{register:Ce,unregister:ie,getFieldState:H,handleSubmit:Pe,setError:ne,_subscribe:ce,_runSchema:q,_focusError:ve,_getWatch:$,_getDirty:W,_setValid:w,_setFieldArray:T,_setDisabledField:xe,_setErrors:E,_getFieldArray:se,_reset:Fe,_resetDefaultValues:()=>Na(e.defaultValues)&&e.defaultValues().then(te=>{_e(te,e.resetOptions),x.state.next({isLoading:!1})}),_removeUnmounted:U,_disableForm:Oe,_subjects:x,_proxyFormState:h,get _fields(){return r},get _formValues(){return a},get _state(){return o},set _state(te){o=te},get _defaultValues(){return s},get _names(){return l},set _names(te){l=te},get _formState(){return t},get _options(){return e},set _options(te){e={...e,...te}}},subscribe:pe,trigger:Z,register:Ce,handleSubmit:Pe,watch:de,setValue:J,getValues:oe,reset:_e,resetField:Ie,clearErrors:Q,unregister:ie,setError:ne,setFocus:Ne,getFieldState:H};return{...qe,formControl:qe}}var jc=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const n=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=(Math.random()*16+n)%16|0;return(e=="x"?t:t&3|8).toString(16)})},lb=(n,e,t={})=>t.shouldFocus||An(t.shouldFocus)?t.focusName||`${n}.${An(t.focusIndex)?e:t.focusIndex}.`:"",cb=(n,e)=>[...n,...Ws(e)],db=n=>Array.isArray(n)?n.map(()=>{}):void 0;function ub(n,e,t){return[...n.slice(0,e),...Ws(t),...n.slice(e)]}var fb=(n,e,t)=>Array.isArray(n)?(An(n[t])&&(n[t]=void 0),n.splice(t,0,n.splice(e,1)[0]),n):[],hb=(n,e)=>[...Ws(e),...Ws(n)];function tQ(n,e){let t=0;const r=[...n];for(const s of e)r.splice(s-t,1),t++;return ny(r).length?r:[]}var mb=(n,e)=>An(e)?[]:tQ(n,Ws(e).sort((t,r)=>t-r)),pb=(n,e,t)=>{[n[e],n[t]]=[n[t],n[e]]},VM=(n,e,t)=>(n[e]=t,n);function ws(n){const e=ry(),{control:t=e.control,name:r,keyName:s="id",shouldUnregister:a,rules:o}=n,[l,c]=ot.useState(t._getFieldArray(r)),d=ot.useRef(t._getFieldArray(r).map(jc)),h=ot.useRef(!1);t._names.array.add(r),ot.useMemo(()=>o&&l.length>=0&&t.register(r,o),[t,r,l.length,o]),sy(()=>t._subjects.array.subscribe({next:({values:M,name:O})=>{if(O===r||!O){const I=nt(M,r);Array.isArray(I)&&(c(I),d.current=I.map(jc))}}}).unsubscribe,[t,r]);const p=ot.useCallback(M=>{h.current=!0,t._setFieldArray(r,M)},[t,r]),x=(M,O)=>{const I=Ws(Fn(M)),q=cb(t._getFieldArray(r),I);t._names.focus=lb(r,q.length-1,O),d.current=cb(d.current,I.map(jc)),p(q),c(q),t._setFieldArray(r,q,cb,{argA:db(M)})},v=(M,O)=>{const I=Ws(Fn(M)),q=hb(t._getFieldArray(r),I);t._names.focus=lb(r,0,O),d.current=hb(d.current,I.map(jc)),p(q),c(q),t._setFieldArray(r,q,hb,{argA:db(M)})},_=M=>{const O=mb(t._getFieldArray(r),M);d.current=mb(d.current,M),p(O),c(O),!Array.isArray(nt(t._fields,r))&&hn(t._fields,r,void 0),t._setFieldArray(r,O,mb,{argA:M})},w=(M,O,I)=>{const q=Ws(Fn(O)),F=ub(t._getFieldArray(r),M,q);t._names.focus=lb(r,M,I),d.current=ub(d.current,M,q.map(jc)),p(F),c(F),t._setFieldArray(r,F,ub,{argA:M,argB:db(O)})},j=(M,O)=>{const I=t._getFieldArray(r);pb(I,M,O),pb(d.current,M,O),p(I),c(I),t._setFieldArray(r,I,pb,{argA:M,argB:O},!1)},T=(M,O)=>{const I=t._getFieldArray(r);fb(I,M,O),fb(d.current,M,O),p(I),c(I),t._setFieldArray(r,I,fb,{argA:M,argB:O},!1)},P=(M,O)=>{const I=Fn(O),q=VM(t._getFieldArray(r),M,I);d.current=[...q].map((F,B)=>!F||B===M?jc():d.current[B]),p(q),c([...q]),t._setFieldArray(r,q,VM,{argA:M,argB:I},!0,!1)},E=M=>{const O=Ws(Fn(M));d.current=O.map(jc),p([...O]),c([...O]),t._setFieldArray(r,[...O],I=>I,{},!0,!1)};return ot.useEffect(()=>{if(t._state.action=!1,MS(r,t._names)&&t._subjects.state.next({...t._formState}),h.current&&(!af(t._options.mode).isOnSubmit||t._formState.isSubmitted)&&!af(t._options.reValidateMode).isOnSubmit)if(t._options.resolver)t._runSchema([r]).then(M=>{const O=nt(M.errors,r),I=nt(t._formState.errors,r);(I?!O&&I.type||O&&(I.type!==O.type||I.message!==O.message):O&&O.type)&&(O?hn(t._formState.errors,r,O):ir(t._formState.errors,r),t._subjects.state.next({errors:t._formState.errors}))});else{const M=nt(t._fields,r);M&&M._f&&!(af(t._options.reValidateMode).isOnSubmit&&af(t._options.mode).isOnSubmit)&&DS(M,t._names.disabled,t._formValues,t._options.criteriaMode===Bi.all,t._options.shouldUseNativeValidation,!0).then(O=>!rs(O)&&t._subjects.state.next({errors:v3(t._formState.errors,O,r)}))}t._subjects.state.next({name:r,values:Fn(t._formValues)}),t._names.focus&&ff(t._fields,(M,O)=>{if(t._names.focus&&O.startsWith(t._names.focus)&&M.focus)return M.focus(),1}),t._names.focus="",t._setValid(),h.current=!1},[l,r,t]),ot.useEffect(()=>(!nt(t._formValues,r)&&t._setFieldArray(r),()=>{const M=(O,I)=>{const q=nt(t._fields,O);q&&q._f&&(q._f.mount=I)};t._options.shouldUnregister||a?t.unregister(r):M(r,!1)}),[r,t,s,a]),{swap:ot.useCallback(j,[p,r,t]),move:ot.useCallback(T,[p,r,t]),prepend:ot.useCallback(v,[p,r,t]),append:ot.useCallback(x,[p,r,t]),remove:ot.useCallback(_,[p,r,t]),insert:ot.useCallback(w,[p,r,t]),update:ot.useCallback(P,[p,r,t]),replace:ot.useCallback(E,[p,r,t]),fields:ot.useMemo(()=>l.map((M,O)=>({...M,[s]:d.current[O]||jc()})),[l,s])}}function tn(n={}){const e=ot.useRef(void 0),t=ot.useRef(void 0),[r,s]=ot.useState({isDirty:!1,isValidating:!1,isLoading:Na(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:Na(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:r},n.defaultValues&&!Na(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=eQ(n);e.current={...l,formState:r}}const a=e.current.control;return a._options=n,sy(()=>{const o=a._subscribe({formState:a._proxyFormState,callback:()=>s({...a._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),a._formState.isReady=!0,o},[a]),ot.useEffect(()=>a._disableForm(n.disabled),[a,n.disabled]),ot.useEffect(()=>{n.mode&&(a._options.mode=n.mode),n.reValidateMode&&(a._options.reValidateMode=n.reValidateMode)},[a,n.mode,n.reValidateMode]),ot.useEffect(()=>{n.errors&&(a._setErrors(n.errors),a._focusError())},[a,n.errors]),ot.useEffect(()=>{n.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,n.shouldUnregister]),ot.useEffect(()=>{if(a._proxyFormState.isDirty){const o=a._getDirty();o!==r.isDirty&&a._subjects.state.next({isDirty:o})}},[a,r.isDirty]),ot.useEffect(()=>{n.values&&!ja(n.values,t.current)?(a._reset(n.values,{keepFieldsRef:!0,...a._options.resetOptions}),t.current=n.values,s(o=>({...o}))):a._resetDefaultValues()},[a,n.values]),ot.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),e.current.formState=u3(r,a),e.current}const BM=(n,e,t)=>{if(n&&"reportValidity"in n){const r=nt(t,e);n.setCustomValidity(r&&r.message||""),n.reportValidity()}},b3=(n,e)=>{for(const t in e.fields){const r=e.fields[t];r&&r.ref&&"reportValidity"in r.ref?BM(r.ref,t,n):r.refs&&r.refs.forEach(s=>BM(s,t,n))}},nQ=(n,e)=>{e.shouldUseNativeValidation&&b3(n,e);const t={};for(const r in n){const s=nt(e.fields,r),a=Object.assign(n[r]||{},{ref:s&&s.ref});if(rQ(e.names||Object.keys(n),r)){const o=Object.assign({},nt(t,r));hn(o,"root",a),hn(t,r,o)}else hn(t,r,a)}return t},rQ=(n,e)=>n.some(t=>t.startsWith(e+"."));function Dn(n,e,t){return e===void 0&&(e={}),t===void 0&&(t={}),function(r,s,a){try{return Promise.resolve((function(o,l){try{var c=(e.context,Promise.resolve(n[t.mode==="sync"?"validateSync":"validate"](r,Object.assign({abortEarly:!1},e,{context:s}))).then(function(d){return a.shouldUseNativeValidation&&b3({},a),{values:t.raw?r:d,errors:{}}}))}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c})(0,function(o){if(!o.inner)throw o;return{values:{},errors:nQ((l=o,c=!a.shouldUseNativeValidation&&a.criteriaMode==="all",(l.inner||[]).reduce(function(d,h){if(d[h.path]||(d[h.path]={message:h.message,type:h.type}),c){var p=d[h.path].types,x=p&&p[h.type];d[h.path]=f3(h.path,c,d,h.type,x?[].concat(x,h.message):h.message)}return d},{})),a)};var l,c}))}catch(o){return Promise.reject(o)}}}var gb,WM;function sQ(){if(WM)return gb;WM=1;function n(T){this._maxSize=T,this.clear()}n.prototype.clear=function(){this._size=0,this._values=Object.create(null)},n.prototype.get=function(T){return this._values[T]},n.prototype.set=function(T,P){return this._size>=this._maxSize&&this.clear(),T in this._values||this._size++,this._values[T]=P};var e=/[^.^\]^[]+|(?=\[\]|\.\.)/g,t=/^\d+$/,r=/^\d/,s=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,a=/^\s*(['"]?)(.*?)(\1)\s*$/,o=512,l=new n(o),c=new n(o),d=new n(o);gb={Cache:n,split:p,normalizePath:h,setter:function(T){var P=h(T);return c.get(T)||c.set(T,function(M,O){for(var I=0,q=P.length,F=M;I<q-1;){var B=P[I];if(B==="__proto__"||B==="constructor"||B==="prototype")return M;F=F[P[I++]]}F[P[I]]=O})},getter:function(T,P){var E=h(T);return d.get(T)||d.set(T,function(O){for(var I=0,q=E.length;I<q;)if(O!=null||!P)O=O[E[I++]];else return;return O})},join:function(T){return T.reduce(function(P,E){return P+(v(E)||t.test(E)?"["+E+"]":(P?".":"")+E)},"")},forEach:function(T,P,E){x(Array.isArray(T)?T:p(T),P,E)}};function h(T){return l.get(T)||l.set(T,p(T).map(function(P){return P.replace(a,"$2")}))}function p(T){return T.match(e)||[""]}function x(T,P,E){var M=T.length,O,I,q,F;for(I=0;I<M;I++)O=T[I],O&&(j(O)&&(O='"'+O+'"'),F=v(O),q=!F&&/^\d+$/.test(O),P.call(E,O,F,q,I,T))}function v(T){return typeof T=="string"&&T&&["'",'"'].indexOf(T.charAt(0))!==-1}function _(T){return T.match(r)&&!T.match(t)}function w(T){return s.test(T)}function j(T){return!v(T)&&(_(T)||w(T))}return gb}var iu=sQ(),xb,$M;function iQ(){if($M)return xb;$M=1;const n=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,e=h=>h.match(n)||[],t=h=>h[0].toUpperCase()+h.slice(1),r=(h,p)=>e(h).join(p).toLowerCase(),s=h=>e(h).reduce((p,x)=>`${p}${p?x[0].toUpperCase()+x.slice(1).toLowerCase():x.toLowerCase()}`,"");return xb={words:e,upperFirst:t,camelCase:s,pascalCase:h=>t(s(h)),snakeCase:h=>r(h,"_"),kebabCase:h=>r(h,"-"),sentenceCase:h=>t(r(h," ")),titleCase:h=>e(h).map(t).join(" ")},xb}var yb=iQ(),Fp={exports:{}},HM;function aQ(){if(HM)return Fp.exports;HM=1,Fp.exports=function(s){return n(e(s),s)},Fp.exports.array=n;function n(s,a){var o=s.length,l=new Array(o),c={},d=o,h=t(a),p=r(s);for(a.forEach(function(v){if(!p.has(v[0])||!p.has(v[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});d--;)c[d]||x(s[d],d,new Set);return l;function x(v,_,w){if(w.has(v)){var j;try{j=", node was:"+JSON.stringify(v)}catch{j=""}throw new Error("Cyclic dependency"+j)}if(!p.has(v))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(v));if(!c[_]){c[_]=!0;var T=h.get(v)||new Set;if(T=Array.from(T),_=T.length){w.add(v);do{var P=T[--_];x(P,p.get(P),w)}while(_);w.delete(v)}l[--o]=v}}}function e(s){for(var a=new Set,o=0,l=s.length;o<l;o++){var c=s[o];a.add(c[0]),a.add(c[1])}return Array.from(a)}function t(s){for(var a=new Map,o=0,l=s.length;o<l;o++){var c=s[o];a.has(c[0])||a.set(c[0],new Set),a.has(c[1])||a.set(c[1],new Set),a.get(c[0]).add(c[1])}return a}function r(s){for(var a=new Map,o=0,l=s.length;o<l;o++)a.set(s[o],o);return a}return Fp.exports}var oQ=aQ();const lQ=mu(oQ),cQ=Object.prototype.toString,dQ=Error.prototype.toString,uQ=RegExp.prototype.toString,fQ=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",hQ=/^Symbol\((.*)\)(.*)$/;function mQ(n){return n!=+n?"NaN":n===0&&1/n<0?"-0":""+n}function YM(n,e=!1){if(n==null||n===!0||n===!1)return""+n;const t=typeof n;if(t==="number")return mQ(n);if(t==="string")return e?`"${n}"`:n;if(t==="function")return"[Function "+(n.name||"anonymous")+"]";if(t==="symbol")return fQ.call(n).replace(hQ,"Symbol($1)");const r=cQ.call(n).slice(8,-1);return r==="Date"?isNaN(n.getTime())?""+n:n.toISOString(n):r==="Error"||n instanceof Error?"["+dQ.call(n)+"]":r==="RegExp"?uQ.call(n):null}function wl(n,e){let t=YM(n,e);return t!==null?t:JSON.stringify(n,function(r,s){let a=YM(this[r],e);return a!==null?a:s},2)}function _3(n){return n==null?[]:[].concat(n)}let w3,j3,N3,pQ=/\$\{\s*(\w+)\s*\}/g;w3=Symbol.toStringTag;class GM{constructor(e,t,r,s){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[w3]="Error",this.name="ValidationError",this.value=t,this.path=r,this.type=s,this.errors=[],this.inner=[],_3(e).forEach(a=>{if(bs.isError(a)){this.errors.push(...a.errors);const o=a.inner.length?a.inner:[a];this.inner.push(...o)}else this.errors.push(a)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}j3=Symbol.hasInstance;N3=Symbol.toStringTag;class bs extends Error{static formatError(e,t){const r=t.label||t.path||"this";return t=Object.assign({},t,{path:r,originalPath:t.path}),typeof e=="string"?e.replace(pQ,(s,a)=>wl(t[a])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,r,s,a){const o=new GM(e,t,r,s);if(a)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[N3]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,bs)}static[j3](e){return GM[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let po={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:n,type:e,value:t,originalValue:r})=>{const s=r!=null&&r!==t?` (cast from the value \`${wl(r,!0)}\`).`:".";return e!=="mixed"?`${n} must be a \`${e}\` type, but the final value was: \`${wl(t,!0)}\``+s:`${n} must match the configured type. The validated value was: \`${wl(t,!0)}\``+s}},zs={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},Pc={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},ES={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},OS={isValue:"${path} field must be ${value}"},nx={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},rx={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},gQ={notType:n=>{const{path:e,value:t,spec:r}=n,s=r.types.length;if(Array.isArray(t)){if(t.length<s)return`${e} tuple value has too few items, expected a length of ${s} but got ${t.length} for value: \`${wl(t,!0)}\``;if(t.length>s)return`${e} tuple value has too many items, expected a length of ${s} but got ${t.length} for value: \`${wl(t,!0)}\``}return bs.formatError(po.notType,n)}};Object.assign(Object.create(null),{mixed:po,string:zs,number:Pc,date:ES,object:nx,array:rx,boolean:OS,tuple:gQ});const iy=n=>n&&n.__isYupSchema__;class Px{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:r,then:s,otherwise:a}=t,o=typeof r=="function"?r:(...l)=>l.every(c=>c===r);return new Px(e,(l,c)=>{var d;let h=o(...l)?s:a;return(d=h?.(c))!=null?d:c})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let r=this.refs.map(a=>a.getValue(t?.value,t?.parent,t?.context)),s=this.fn(r,e,t);if(s===void 0||s===e)return e;if(!iy(s))throw new TypeError("conditions must return a schema object");return s.resolve(t)}}const qp={context:"$",value:"."};function MC(n,e){return new Jc(n,e)}class Jc{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===qp.context,this.isValue=this.key[0]===qp.value,this.isSibling=!this.isContext&&!this.isValue;let r=this.isContext?qp.context:this.isValue?qp.value:"";this.path=this.key.slice(r.length),this.getter=this.path&&iu.getter(this.path,!0),this.map=t.map}getValue(e,t,r){let s=this.isContext?r:this.isValue?e:t;return this.getter&&(s=this.getter(s||{})),this.map&&(s=this.map(s)),s}cast(e,t){return this.getValue(e,t?.parent,t?.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}Jc.prototype.__isYupRef=!0;const Sa=n=>n==null;function Zu(n){function e({value:t,path:r="",options:s,originalValue:a,schema:o},l,c){const{name:d,test:h,params:p,message:x,skipAbsent:v}=n;let{parent:_,context:w,abortEarly:j=o.spec.abortEarly,disableStackTrace:T=o.spec.disableStackTrace}=s;const P={value:t,parent:_,context:w};function E(W={}){const $=S3(Object.assign({value:t,originalValue:a,label:o.spec.label,path:W.path||r,spec:o.spec,disableStackTrace:W.disableStackTrace||T},p,W.params),P),se=new bs(bs.formatError(W.message||x,$),t,$.path,W.type||d,$.disableStackTrace);return se.params=$,se}const M=j?l:c;let O={path:r,parent:_,type:d,from:s.from,createError:E,resolve(W){return C3(W,P)},options:s,originalValue:a,schema:o};const I=W=>{bs.isError(W)?M(W):W?c(null):M(E())},q=W=>{bs.isError(W)?M(W):l(W)};if(v&&Sa(t))return I(!0);let B;try{var U;if(B=h.call(O,t,O),typeof((U=B)==null?void 0:U.then)=="function"){if(s.sync)throw new Error(`Validation test of type: "${O.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(B).then(I,q)}}catch(W){q(W);return}I(B)}return e.OPTIONS=n,e}function S3(n,e){if(!n)return n;for(const t of Object.keys(n))n[t]=C3(n[t],e);return n}function C3(n,e){return Jc.isRef(n)?n.getValue(e.value,e.parent,e.context):n}function xQ(n,e,t,r=t){let s,a,o;return e?(iu.forEach(e,(l,c,d)=>{let h=c?l.slice(1,l.length-1):l;n=n.resolve({context:r,parent:s,value:t});let p=n.type==="tuple",x=d?parseInt(h,10):0;if(n.innerType||p){if(p&&!d)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&x>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${l}, in the path: ${e}. because there is no value at that index. `);s=t,t=t&&t[x],n=p?n.spec.types[x]:n.innerType}if(!d){if(!n.fields||!n.fields[h])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${n.type}")`);s=t,t=t&&t[h],n=n.fields[h]}a=h,o=c?"["+l+"]":"."+l}),{schema:n,parent:s,parentPath:a}):{parent:s,parentPath:e,schema:n}}class Mx extends Set{describe(){const e=[];for(const t of this.values())e.push(Jc.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const r of this.values())t.push(e(r));return t}clone(){return new Mx(this.values())}merge(e,t){const r=this.clone();return e.forEach(s=>r.add(s)),t.forEach(s=>r.delete(s)),r}}function of(n,e=new Map){if(iy(n)||!n||typeof n!="object")return n;if(e.has(n))return e.get(n);let t;if(n instanceof Date)t=new Date(n.getTime()),e.set(n,t);else if(n instanceof RegExp)t=new RegExp(n),e.set(n,t);else if(Array.isArray(n)){t=new Array(n.length),e.set(n,t);for(let r=0;r<n.length;r++)t[r]=of(n[r],e)}else if(n instanceof Map){t=new Map,e.set(n,t);for(const[r,s]of n.entries())t.set(r,of(s,e))}else if(n instanceof Set){t=new Set,e.set(n,t);for(const r of n)t.add(of(r,e))}else if(n instanceof Object){t={},e.set(n,t);for(const[r,s]of Object.entries(n))t[r]=of(s,e)}else throw Error(`Unable to clone ${n}`);return t}function yQ(n){if(!(n!=null&&n.length))return;const e=[];let t="",r=!1,s=!1;for(let a=0;a<n.length;a++){const o=n[a];if(o==="["&&!s){t&&(e.push(...t.split(".").filter(Boolean)),t=""),r=!0;continue}if(o==="]"&&!s){t&&(/^\d+$/.test(t)?e.push(t):e.push(t.replace(/^"|"$/g,"")),t=""),r=!1;continue}if(o==='"'){s=!s;continue}if(o==="."&&!r&&!s){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(...t.split(".").filter(Boolean)),e}function vQ(n,e){const t=e?`${e}.${n.path}`:n.path;return n.errors.map(r=>({message:r,path:yQ(t)}))}function T3(n,e){var t;if(!((t=n.inner)!=null&&t.length)&&n.errors.length)return vQ(n,e);const r=e?`${e}.${n.path}`:n.path;return n.inner.flatMap(s=>T3(s,r))}class Hs{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new Mx,this._blacklist=new Mx,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(po.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e?.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=of(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let r=e(this);return this._mutate=t,r}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,r=e.clone();const s=Object.assign({},t.spec,r.spec);return r.spec=s,r.internalTests=Object.assign({},t.internalTests,r.internalTests),r._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),r._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),r.tests=t.tests,r.exclusiveTests=t.exclusiveTests,r.withMutation(a=>{e.tests.forEach(o=>{a.test(o.OPTIONS)})}),r.transforms=[...t.transforms,...r.transforms],r}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let r=t.conditions;t=t.clone(),t.conditions=[],t=r.reduce((s,a)=>a.resolve(s,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,r,s,a;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(r=e.abortEarly)!=null?r:this.spec.abortEarly,recursive:(s=e.recursive)!=null?s:this.spec.recursive,disableStackTrace:(a=e.disableStackTrace)!=null?a:this.spec.disableStackTrace})}cast(e,t={}){let r=this.resolve(Object.assign({},t,{value:e})),s=t.assert==="ignore-optionality",a=r._cast(e,t);if(t.assert!==!1&&!r.isType(a)){if(s&&Sa(a))return a;let o=wl(e),l=wl(a);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${r.type}". 

attempted value: ${o} 
`+(l!==o?`result of cast: ${l}`:""))}return a}_cast(e,t){let r=e===void 0?e:this.transforms.reduce((s,a)=>a.call(this,s,e,this,t),e);return r===void 0&&(r=this.getDefault(t)),r}_validate(e,t={},r,s){let{path:a,originalValue:o=e,strict:l=this.spec.strict}=t,c=e;l||(c=this._cast(c,Object.assign({assert:!1},t)));let d=[];for(let h of Object.values(this.internalTests))h&&d.push(h);this.runTests({path:a,value:c,originalValue:o,options:t,tests:d},r,h=>{if(h.length)return s(h,c);this.runTests({path:a,value:c,originalValue:o,options:t,tests:this.tests},r,s)})}runTests(e,t,r){let s=!1,{tests:a,value:o,originalValue:l,path:c,options:d}=e,h=w=>{s||(s=!0,t(w,o))},p=w=>{s||(s=!0,r(w,o))},x=a.length,v=[];if(!x)return p([]);let _={value:o,originalValue:l,path:c,options:d,schema:this};for(let w=0;w<a.length;w++){const j=a[w];j(_,h,function(P){P&&(Array.isArray(P)?v.push(...P):v.push(P)),--x<=0&&p(v)})}}asNestedTest({key:e,index:t,parent:r,parentPath:s,originalParent:a,options:o}){const l=e??t;if(l==null)throw TypeError("Must include `key` or `index` for nested validations");const c=typeof l=="number";let d=r[l];const h=Object.assign({},o,{strict:!0,parent:r,value:d,originalValue:a[l],key:void 0,[c?"index":"key"]:l,path:c||l.includes(".")?`${s||""}[${c?l:`"${l}"`}]`:(s?`${s}.`:"")+e});return(p,x,v)=>this.resolve(h)._validate(d,h,x,v)}validate(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),a=(r=t?.disableStackTrace)!=null?r:s.spec.disableStackTrace;return new Promise((o,l)=>s._validate(e,t,(c,d)=>{bs.isError(c)&&(c.value=d),l(c)},(c,d)=>{c.length?l(new bs(c,d,void 0,void 0,a)):o(d)}))}validateSync(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),a,o=(r=t?.disableStackTrace)!=null?r:s.spec.disableStackTrace;return s._validate(e,Object.assign({},t,{sync:!0}),(l,c)=>{throw bs.isError(l)&&(l.value=c),l},(l,c)=>{if(l.length)throw new bs(l,e,void 0,void 0,o);a=c}),a}isValid(e,t){return this.validate(e,t).then(()=>!0,r=>{if(bs.isError(r))return!1;throw r})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(r){if(bs.isError(r))return!1;throw r}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):of(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const r=this.clone({nullable:e});return r.internalTests.nullable=Zu({message:t,name:"nullable",test(s){return s===null?this.schema.spec.nullable:!0}}),r}optionality(e,t){const r=this.clone({optional:e});return r.internalTests.optionality=Zu({message:t,name:"optionality",test(s){return s===void 0?this.schema.spec.optional:!0}}),r}optional(){return this.optionality(!0)}defined(e=po.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=po.notNull){return this.nullability(!1,e)}required(e=po.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=po.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let r=this.clone(),s=Zu(t),a=t.exclusive||t.name&&r.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(r.exclusiveTests[t.name]=!!t.exclusive),r.tests=r.tests.filter(o=>!(o.OPTIONS.name===t.name&&(a||o.OPTIONS.test===s.OPTIONS.test))),r.tests.push(s),r}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let r=this.clone(),s=_3(e).map(a=>new Jc(a));return s.forEach(a=>{a.isSibling&&r.deps.push(a.key)}),r.conditions.push(typeof t=="function"?new Px(s,t):Px.fromOptions(s,t)),r}typeError(e){let t=this.clone();return t.internalTests.typeError=Zu({message:e,name:"typeError",skipAbsent:!0,test(r){return this.schema._typeCheck(r)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=po.oneOf){let r=this.clone();return e.forEach(s=>{r._whitelist.add(s),r._blacklist.delete(s)}),r.internalTests.whiteList=Zu({message:t,name:"oneOf",skipAbsent:!0,test(s){let a=this.schema._whitelist,o=a.resolveAll(this.resolve);return o.includes(s)?!0:this.createError({params:{values:Array.from(a).join(", "),resolved:o}})}}),r}notOneOf(e,t=po.notOneOf){let r=this.clone();return e.forEach(s=>{r._blacklist.add(s),r._whitelist.delete(s)}),r.internalTests.blacklist=Zu({message:t,name:"notOneOf",test(s){let a=this.schema._blacklist,o=a.resolveAll(this.resolve);return o.includes(s)?this.createError({params:{values:Array.from(a).join(", "),resolved:o}}):!0}}),r}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:r,meta:s,optional:a,nullable:o}=t.spec;return{meta:s,label:r,optional:a,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.filter((c,d,h)=>h.findIndex(p=>p.OPTIONS.name===c.OPTIONS.name)===d).map(c=>{const d=c.OPTIONS.params&&e?S3(Object.assign({},c.OPTIONS.params),e):c.OPTIONS.params;return{name:c.OPTIONS.name,params:d}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(r){try{return{value:await e.validate(r,{abortEarly:!1})}}catch(s){if(s instanceof bs)return{issues:T3(s)};throw s}}}}}Hs.prototype.__isYupSchema__=!0;for(const n of["validate","validateSync"])Hs.prototype[`${n}At`]=function(e,t,r={}){const{parent:s,parentPath:a,schema:o}=xQ(this,e,t,r.context);return o[n](s&&s[a],Object.assign({},r,{parent:s,path:e}))};for(const n of["equals","is"])Hs.prototype[n]=Hs.prototype.oneOf;for(const n of["not","nope"])Hs.prototype[n]=Hs.prototype.notOneOf;const bQ=()=>!0;function Wt(n){return new k3(n)}class k3 extends Hs{constructor(e){super(typeof e=="function"?{type:"mixed",check:e}:Object.assign({type:"mixed",check:bQ},e))}}Wt.prototype=k3.prototype;function ss(){return new P3}class P3 extends Hs{constructor(){super({type:"boolean",check(e){return e instanceof Boolean&&(e=e.valueOf()),typeof e=="boolean"}}),this.withMutation(()=>{this.transform((e,t)=>{if(this.spec.coerce&&!this.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e})})}isTrue(e=OS.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test(t){return Sa(t)||t===!0}})}isFalse(e=OS.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test(t){return Sa(t)||t===!1}})}default(e){return super.default(e)}defined(e){return super.defined(e)}optional(){return super.optional()}required(e){return super.required(e)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(e){return super.nonNullable(e)}strip(e){return super.strip(e)}}ss.prototype=P3.prototype;const _Q=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function wQ(n){const e=IS(n);if(!e)return Date.parse?Date.parse(n):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function IS(n){var e,t;const r=_Q.exec(n);return r?{year:dl(r[1]),month:dl(r[2],1)-1,day:dl(r[3],1),hour:dl(r[4]),minute:dl(r[5]),second:dl(r[6]),millisecond:r[7]?dl(r[7].substring(0,3)):0,precision:(e=(t=r[7])==null?void 0:t.length)!=null?e:void 0,z:r[8]||void 0,plusMinus:r[9]||void 0,hourOffset:dl(r[10]),minuteOffset:dl(r[11])}:null}function dl(n,e=0){return Number(n)||e}let jQ=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,NQ=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,SQ=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,CQ="^\\d{4}-\\d{2}-\\d{2}",TQ="\\d{2}:\\d{2}:\\d{2}",kQ="(([+-]\\d{2}(:?\\d{2})?)|Z)",PQ=new RegExp(`${CQ}T${TQ}(\\.\\d+)?${kQ}$`),MQ=n=>Sa(n)||n===n.trim(),DQ={}.toString();function ge(){return new M3}class M3 extends Hs{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce||this.isType(e)||Array.isArray(e))return e;const r=e!=null&&e.toString?e.toString():e;return r===DQ?e:r})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||po.required,name:"required",skipAbsent:!0,test:r=>!!r.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=zs.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t=zs.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t=zs.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}matches(e,t){let r=!1,s,a;return t&&(typeof t=="object"?{excludeEmptyString:r=!1,message:s,name:a}=t:s=t),this.test({name:a||"matches",message:s||zs.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&r||o.search(e)!==-1})}email(e=zs.email){return this.matches(jQ,{name:"email",message:e,excludeEmptyString:!0})}url(e=zs.url){return this.matches(NQ,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=zs.uuid){return this.matches(SQ,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",r,s;return e&&(typeof e=="object"?{message:t="",allowOffset:r=!1,precision:s=void 0}=e:t=e),this.matches(PQ,{name:"datetime",message:t||zs.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||zs.datetime_offset,params:{allowOffset:r},skipAbsent:!0,test:a=>{if(!a||r)return!0;const o=IS(a);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||zs.datetime_precision,params:{precision:s},skipAbsent:!0,test:a=>{if(!a||s==null)return!0;const o=IS(a);return o?o.precision===s:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=zs.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:MQ})}lowercase(e=zs.lowercase){return this.transform(t=>Sa(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Sa(t)||t===t.toLowerCase()})}uppercase(e=zs.uppercase){return this.transform(t=>Sa(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Sa(t)||t===t.toUpperCase()})}}ge.prototype=M3.prototype;let EQ=n=>n!=+n;function is(){return new D3}class D3 extends Hs{constructor(){super({type:"number",check(e){return e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&!EQ(e)}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce)return e;let r=e;if(typeof r=="string"){if(r=r.replace(/\s/g,""),r==="")return NaN;r=+r}return this.isType(r)||r===null?r:parseFloat(r)})})}min(e,t=Pc.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r>=this.resolve(e)}})}max(e,t=Pc.max){return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r<=this.resolve(e)}})}lessThan(e,t=Pc.lessThan){return this.test({message:t,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test(r){return r<this.resolve(e)}})}moreThan(e,t=Pc.moreThan){return this.test({message:t,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test(r){return r>this.resolve(e)}})}positive(e=Pc.positive){return this.moreThan(0,e)}negative(e=Pc.negative){return this.lessThan(0,e)}integer(e=Pc.integer){return this.test({name:"integer",message:e,skipAbsent:!0,test:t=>Number.isInteger(t)})}truncate(){return this.transform(e=>Sa(e)?e:e|0)}round(e){var t;let r=["ceil","floor","round","trunc"];if(e=((t=e)==null?void 0:t.toLowerCase())||"round",e==="trunc")return this.truncate();if(r.indexOf(e.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+r.join(", "));return this.transform(s=>Sa(s)?s:Math[e](s))}}is.prototype=D3.prototype;let OQ=new Date(""),IQ=n=>Object.prototype.toString.call(n)==="[object Date]";class DC extends Hs{constructor(){super({type:"date",check(e){return IQ(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t)=>!this.spec.coerce||this.isType(e)||e===null?e:(e=wQ(e),isNaN(e)?DC.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let r;if(Jc.isRef(e))r=e;else{let s=this.cast(e);if(!this._typeCheck(s))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);r=s}return r}min(e,t=ES.min){let r=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s>=this.resolve(r)}})}max(e,t=ES.max){let r=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(s){return s<=this.resolve(r)}})}}DC.INVALID_DATE=OQ;function AQ(n,e=[]){let t=[],r=new Set,s=new Set(e.map(([o,l])=>`${o}-${l}`));function a(o,l){let c=iu.split(o)[0];r.add(c),s.has(`${l}-${c}`)||t.push([l,c])}for(const o of Object.keys(n)){let l=n[o];r.add(o),Jc.isRef(l)&&l.isSibling?a(l.path,o):iy(l)&&"deps"in l&&l.deps.forEach(c=>a(c,o))}return lQ.array(Array.from(r),t).reverse()}function ZM(n,e){let t=1/0;return n.some((r,s)=>{var a;if((a=e.path)!=null&&a.includes(r))return t=s,!0}),t}function E3(n){return(e,t)=>ZM(n,e)-ZM(n,t)}const O3=(n,e,t)=>{if(typeof n!="string")return n;let r=n;try{r=JSON.parse(n)}catch{}return t.isType(r)?r:n};function sx(n){if("fields"in n){const e={};for(const[t,r]of Object.entries(n.fields))e[t]=sx(r);return n.setFields(e)}if(n.type==="array"){const e=n.optional();return e.innerType&&(e.innerType=sx(e.innerType)),e}return n.type==="tuple"?n.optional().clone({types:n.spec.types.map(sx)}):"optional"in n?n.optional():n}const RQ=(n,e)=>{const t=[...iu.normalizePath(e)];if(t.length===1)return t[0]in n;let r=t.pop(),s=iu.getter(iu.join(t),!0)(n);return!!(s&&r in s)};let KM=n=>Object.prototype.toString.call(n)==="[object Object]";function JM(n,e){let t=Object.keys(n.fields);return Object.keys(e).filter(r=>t.indexOf(r)===-1)}const LQ=E3([]);function Pt(n){return new I3(n)}class I3 extends Hs{constructor(e){super({type:"object",check(t){return KM(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=LQ,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var r;let s=super._cast(e,t);if(s===void 0)return this.getDefault(t);if(!this._typeCheck(s))return s;let a=this.fields,o=(r=t.stripUnknown)!=null?r:this.spec.noUnknown,l=[].concat(this._nodes,Object.keys(s).filter(p=>!this._nodes.includes(p))),c={},d=Object.assign({},t,{parent:c,__validating:t.__validating||!1}),h=!1;for(const p of l){let x=a[p],v=p in s,_=s[p];if(x){let w;d.path=(t.path?`${t.path}.`:"")+p,x=x.resolve({value:_,context:t.context,parent:c});let j=x instanceof Hs?x.spec:void 0,T=j?.strict;if(j!=null&&j.strip){h=h||p in s;continue}w=!t.__validating||!T?x.cast(_,d):_,w!==void 0&&(c[p]=w)}else v&&!o&&(c[p]=_);(v!==p in c||c[p]!==_)&&(h=!0)}return h?c:s}_validate(e,t={},r,s){let{from:a=[],originalValue:o=e,recursive:l=this.spec.recursive}=t;t.from=[{schema:this,value:o},...a],t.__validating=!0,t.originalValue=o,super._validate(e,t,r,(c,d)=>{if(!l||!KM(d)){s(c,d);return}o=o||d;let h=[];for(let p of this._nodes){let x=this.fields[p];!x||Jc.isRef(x)||h.push(x.asNestedTest({options:t,key:p,parent:d,parentPath:t.path,originalParent:o}))}this.runTests({tests:h,value:d,originalValue:o,options:t},r,p=>{s(p.sort(this._sortErrors).concat(c),d)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),r=t.fields;for(let[s,a]of Object.entries(this.fields)){const o=r[s];r[s]=o===void 0?a:o}return t.withMutation(s=>s.setFields(r,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(r=>{var s;const a=this.fields[r];let o=e;(s=o)!=null&&s.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[r]})),t[r]=a&&"getDefault"in a?a.getDefault(o):void 0}),t}setFields(e,t){let r=this.clone();return r.fields=e,r._nodes=AQ(e,t),r._sortErrors=E3(Object.keys(e)),t&&(r._excludedEdges=t),r}shape(e,t=[]){return this.clone().withMutation(r=>{let s=r._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),s=[...r._excludedEdges,...t]),r.setFields(Object.assign(r.fields,e),s)})}partial(){const e={};for(const[t,r]of Object.entries(this.fields))e[t]="optional"in r&&r.optional instanceof Function?r.optional():r;return this.setFields(e)}deepPartial(){return sx(this)}pick(e){const t={};for(const r of e)this.fields[r]&&(t[r]=this.fields[r]);return this.setFields(t,this._excludedEdges.filter(([r,s])=>e.includes(r)&&e.includes(s)))}omit(e){const t=[];for(const r of Object.keys(this.fields))e.includes(r)||t.push(r);return this.pick(t)}from(e,t,r){let s=iu.getter(e,!0);return this.transform(a=>{if(!a)return a;let o=a;return RQ(a,e)&&(o=Object.assign({},a),r||delete o[e],o[t]=s(a)),o})}json(){return this.transform(O3)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||nx.exact,test(t){if(t==null)return!0;const r=JM(this.schema,t);return r.length===0||this.createError({params:{properties:r.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=nx.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let r=this.test({name:"noUnknown",exclusive:!0,message:t,test(s){if(s==null)return!0;const a=JM(this.schema,s);return!e||a.length===0||this.createError({params:{unknown:a.join(", ")}})}});return r.spec.noUnknown=e,r}unknown(e=!0,t=nx.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const r={};for(const s of Object.keys(t))r[e(s)]=t[s];return r})}camelCase(){return this.transformKeys(yb.camelCase)}snakeCase(){return this.transformKeys(yb.snakeCase)}constantCase(){return this.transformKeys(e=>yb.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);r.fields={};for(const[a,o]of Object.entries(t.fields)){var s;let l=e;(s=l)!=null&&s.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[a]})),r.fields[a]=o.describe(l)}return r}}Pt.prototype=I3.prototype;function _s(n){return new A3(n)}class A3 extends Hs{constructor(e){super({type:"array",spec:{types:e},check(t){return Array.isArray(t)}}),this.innerType=void 0,this.innerType=e}_cast(e,t){const r=super._cast(e,t);if(!this._typeCheck(r)||!this.innerType)return r;let s=!1;const a=r.map((o,l)=>{const c=this.innerType.cast(o,Object.assign({},t,{path:`${t.path||""}[${l}]`,parent:r,originalValue:o,value:o,index:l}));return c!==o&&(s=!0),c});return s?a:r}_validate(e,t={},r,s){var a;let o=this.innerType,l=(a=t.recursive)!=null?a:this.spec.recursive;t.originalValue!=null&&t.originalValue,super._validate(e,t,r,(c,d)=>{var h;if(!l||!o||!this._typeCheck(d)){s(c,d);return}let p=new Array(d.length);for(let v=0;v<d.length;v++){var x;p[v]=o.asNestedTest({options:t,index:v,parent:d,parentPath:t.path,originalParent:(x=t.originalValue)!=null?x:e})}this.runTests({value:d,tests:p,originalValue:(h=t.originalValue)!=null?h:e,options:t},r,v=>s(v.concat(c),d))})}clone(e){const t=super.clone(e);return t.innerType=this.innerType,t}json(){return this.transform(O3)}concat(e){let t=super.concat(e);return t.innerType=this.innerType,e.innerType&&(t.innerType=t.innerType?t.innerType.concat(e.innerType):e.innerType),t}of(e){let t=this.clone();if(!iy(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+wl(e));return t.innerType=e,t.spec=Object.assign({},t.spec,{types:e}),t}length(e,t=rx.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t){return t=t||rx.min,this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t){return t=t||rx.max,this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}ensure(){return this.default(()=>[]).transform((e,t)=>this._typeCheck(e)?e:t==null?[]:[].concat(t))}compact(e){let t=e?(r,s,a)=>!e(r,s,a):r=>!!r;return this.transform(r=>r!=null?r.filter(t):r)}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);if(t.innerType){var s;let a=e;(s=a)!=null&&s.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[0]})),r.innerType=t.innerType.describe(a)}return r}}_s.prototype=A3.prototype;const je=({label:n,id:e,error:t,registration:r,...s})=>{const{className:a,...o}=s,d=`form-input ${t?"form-input--error":""} ${a||""}`,h=i.jsx("input",{id:e,className:d,"aria-invalid":!!t,...r,...o});return i.jsxs("div",{children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsx("div",{className:n?"mt-1":"",children:h}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},Pn=D.forwardRef(({id:n,label:e,description:t,className:r,labelClassName:s,inputClassName:a,...o},l)=>{const c=n||o.name;return i.jsxs("div",{className:`relative flex items-start ${r}`,children:[i.jsx("div",{className:"flex h-6 items-center",children:i.jsx("input",{id:c,"aria-describedby":t?`${c}-description`:void 0,type:"checkbox",ref:l,className:`h-4 w-4 rounded border-gray-300 text-accent focus:ring-accent cursor-pointer ${a||""}`,...o})}),i.jsxs("div",{className:"ml-3 text-sm leading-6",children:[i.jsx("label",{htmlFor:c,className:`font-medium text-primary-text cursor-pointer ${s}`,children:e}),t&&i.jsx("p",{id:`${c}-description`,className:"text-muted",children:t})]})]})});Pn.displayName="Checkbox";function FQ(){const[n,e]=D.useState(null),[t,r]=D.useState(!1),[s,a]=D.useState(null);return D.useEffect(()=>{const l=(()=>{const p=navigator.userAgent,x=`${window.screen.width}x${window.screen.height}`,v=Intl.DateTimeFormat().resolvedOptions().timeZone,_=navigator.language,w=navigator.platform,j=navigator.hardwareConcurrency||0,T=`${p}|${x}|${v}|${_}|${w}|${j}`;let P=0;for(let I=0;I<T.length;I++){const q=T.charCodeAt(I);P=(P<<5)-P+q,P=P&P}const E="dev_"+Math.abs(P).toString(36),M=()=>p.indexOf("Chrome")>-1?"Chrome":p.indexOf("Firefox")>-1?"Firefox":p.indexOf("Safari")>-1?"Safari":p.indexOf("Edge")>-1?"Edge":"Unknown",O=()=>p.indexOf("Win")>-1?"Windows":p.indexOf("Mac")>-1?"MacOS":p.indexOf("Linux")>-1?"Linux":p.indexOf("Android")>-1?"Android":p.indexOf("iOS")>-1?"iOS":"Unknown";return{deviceId:E,deviceName:`${O()} - ${M()}`,browser:M(),os:O(),timestamp:new Date().toISOString()}})();e(l);const c=localStorage.getItem("device_id"),d=localStorage.getItem("device_name"),h=localStorage.getItem("device_timestamp");c&&c!==l.deviceId&&(r(!0),a({deviceId:c,deviceName:d||"Unknown Device",browser:"",os:"",timestamp:h||new Date().toISOString()})),localStorage.setItem("device_id",l.deviceId),localStorage.setItem("device_name",l.deviceName),localStorage.setItem("device_timestamp",l.timestamp)},[]),{deviceInfo:n,isNewDevice:t,previousDevice:s}}const qQ=Pt({email:ge().email("Must be a valid email").required("Email is required"),password:ge().required("Password is required"),rememberMe:ss().optional()}).defined(),zQ=n=>n.role==="unverified"?"/pending-approval":"/profile",UQ=()=>{const{user:n,loginWithEmail:e,loginWithGoogle:t,error:r,setError:s,loading:a,setLoginAnimationPending:o,isLoginAnimationPending:l}=jt(),c=St(),d=cs(),{deviceInfo:h,isNewDevice:p,previousDevice:x}=FQ(),[v,_]=D.useState(!1),[w,j]=D.useState(!1);D.useEffect(()=>{s(null);const F=new URLSearchParams(d.hash.substring(1)),B=F.get("error_code"),U=F.get("error_description");B==="otp_expired"&&U&&(s("Email confirmation link has expired or is invalid. Please try signing up again or request a new confirmation email."),c("/auth/login",{replace:!0}))},[s,d,c]),D.useEffect(()=>{n&&p&&x&&!v&&(ue.sendDeviceChangeAlert(n.id,n.name,x.deviceName,h?.deviceName||"Unknown Device").catch(F=>console.error("Failed to send device change alert:",F)),_(!0))},[n,p,x,v,h]),D.useEffect(()=>{n&&!l&&c(zQ(n),{replace:!0})},[n,c,l]);const{register:T,handleSubmit:P,setValue:E,formState:{errors:M}}=tn({resolver:Dn(qQ)});D.useEffect(()=>{const F=localStorage.getItem("rememberedEmail");F&&(E("email",F),E("rememberMe",!0)),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&E("rememberMe",!0)},[E]);const O=async F=>{o(!0);const U=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:F.rememberMe||!1;(await e(F.email,F.password,U)).error?o(!1):(j(!0),setTimeout(()=>{o(!1)},1500))},I=async()=>{await t()},q=a||w;return i.jsxs(i.Fragment,{children:[i.jsxs("form",{onSubmit:P(O),className:"space-y-3",children:[i.jsxs("fieldset",{disabled:q,className:"space-y-3",children:[i.jsxs("div",{className:"relative group",children:[i.jsx(qf,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),i.jsx(je,{id:"email",type:"email",autoComplete:"email",placeholder:"Email",registration:T("email"),error:M.email?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),i.jsxs("div",{className:"relative group",children:[i.jsx(jS,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),i.jsx(je,{id:"password",type:"password",autoComplete:"current-password",placeholder:"Password",registration:T("password"),error:M.password?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-center justify-between gap-3",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(Pn,{id:"rememberMe",label:"Remember me",labelClassName:"text-white font-medium",...T("rememberMe"),inputClassName:"text-[#22c55e] border-white/20 rounded bg-black/40 focus:ring-[#22c55e]"})}),i.jsx(Pa,{to:"/auth/forgot-password",className:`text-sm font-medium !text-white hover:text-gray-200 transition-colors auth-link ${q?"pointer-events-none opacity-50":""}`,"aria-disabled":q,onClick:F=>{q&&F.preventDefault()},children:"Forgot your password?"})]})]}),i.jsx("div",{className:"min-h-[24px] flex items-center justify-center",children:r&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-400 text-center p-2 bg-red-500/10 rounded-lg border border-red-500/20",children:[i.jsx(Da,{className:"h-4 w-4 flex-shrink-0"}),i.jsx("span",{children:r})]})}),i.jsx(re,{type:"submit",className:`w-full !font-bold !py-3 !rounded-full shadow-lg transition-all transform hover:scale-[1.02] signin-btn ${w?"!bg-[#22c55e] !border-[#22c55e] !text-white hover:!bg-[#22c55e]":"!bg-transparent border border-[#22c55e] !text-[#22c55e] hover:!bg-[#22c55e] hover:!text-white shadow-green-500/20"}`,isLoading:a&&!w,size:"lg",disabled:q&&!w,children:w?i.jsx(_l,{className:"w-6 h-6 animate-bounce"}):"Sign In"})]}),i.jsxs("div",{className:"flex items-center my-6",children:[i.jsx("div",{className:"flex-1 border-t border-white/10"}),i.jsx("span",{className:"px-4 text-sm text-gray-400 font-medium",children:"OR"}),i.jsx("div",{className:"flex-1 border-t border-white/10"})]}),i.jsxs("button",{type:"button",onClick:I,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 hover:bg-gray-100 font-bold py-3 rounded-full transition-all transform hover:scale-[1.02] shadow-lg google-btn",disabled:q,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 48 48",children:[i.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),i.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),i.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.519-3.487-11.181-8.264l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),i.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C39.99,35.508,44,30.021,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),"Sign in with Google"]}),i.jsx("div",{className:"text-center mt-4",children:i.jsxs("p",{className:"text-sm text-gray-300",children:["Don't have an account?"," ",i.jsx(Pa,{to:"/auth/signup",className:"font-medium !text-white hover:text-gray-200 auth-link",children:"Sign Up"})]})})]})},VQ=Pt({name:ge().required("Your name is required"),email:ge().email("Must be a valid email").required("Email is required"),password:ge().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:ge().oneOf([MC("password")],"Passwords must match").required("Please confirm your password")}).defined(),BQ=()=>{const{signUp:n}=jt(),[e,t]=D.useState(""),[r,s]=D.useState(!1),{register:a,handleSubmit:o,formState:{errors:l,isSubmitting:c}}=tn({resolver:Dn(VQ)}),d=async h=>{t("");const{error:p}=await n(h.name,h.email,h.password);p?t(p.message):s(!0)};return r?i.jsxs("div",{className:"text-center",children:[i.jsx(HF,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Confirm your email"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"We've sent a confirmation link to your email address. Please click the link to activate your account."}),i.jsx("div",{className:"mt-6",children:i.jsx(Pa,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",children:" Back to Login"})})]}):i.jsxs("form",{onSubmit:o(d),className:"space-y-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Tl,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(je,{id:"name",type:"text",placeholder:"Full Name",registration:a("name"),error:l.name?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(qf,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(je,{id:"email",type:"email",placeholder:"Email Address",registration:a("email"),error:l.email?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(jS,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(je,{id:"password",type:"password",placeholder:"Password",registration:a("password"),error:l.password?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(jS,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(je,{id:"confirmPassword",type:"password",placeholder:"Confirm Password",registration:a("confirmPassword"),error:l.confirmPassword?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),e&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),i.jsx("div",{className:"pt-2",children:i.jsx(re,{type:"submit",className:"w-full",isLoading:c,size:"lg",children:"Sign Up"})}),i.jsx("div",{className:"text-center pt-2",children:i.jsx(Pa,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",children:"Already have an account? Sign In"})})]})},WQ=Pt({email:ge().email("Must be a valid email").required("Email is required")}).defined(),$Q=()=>{const{sendPasswordReset:n}=jt(),[e,t]=D.useState(""),[r,s]=D.useState(!1),a=St();D.useEffect(()=>{if(r){const p=setTimeout(()=>{a("/auth/login",{replace:!0})},3e3);return()=>clearTimeout(p)}},[r,a]);const{register:o,handleSubmit:l,formState:{errors:c,isSubmitting:d}}=tn({resolver:Dn(WQ)}),h=async p=>{t("");const{error:x}=await n(p.email);x&&x.message.includes("rate limit")?t("Too many attempts. Please wait a few minutes before trying again."):s(!0)};return r?i.jsxs("div",{className:"text-center",children:[i.jsx(HF,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Check your email"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"If an account exists for the email you provided, we've sent password reset instructions. Redirecting to login..."})]}):i.jsx(i.Fragment,{children:i.jsxs("form",{onSubmit:l(h),className:"space-y-6",children:[i.jsxs("div",{className:"relative group",children:[i.jsx(qf,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none z-10"}),i.jsx(je,{id:"email",type:"email",autoComplete:"email",placeholder:"Email Address",registration:o("email"),error:c.email?.message,className:"!pl-12 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-400 focus:!border-[#22c55e] !py-3 !rounded-xl transition-all"})]}),e&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),i.jsx("div",{children:i.jsx(re,{type:"submit",className:"w-full",isLoading:d,size:"lg",children:"Send Reset Link"})}),i.jsx("div",{className:"text-center",children:i.jsx(Pa,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",children:" Back to Login"})})]})})},HQ=Pt({password:ge().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:ge().oneOf([MC("password")],"Passwords must match").required("Please confirm your password")}).defined(),YQ=n=>{const e=n.toLowerCase();return e.includes("weak password")?"Password is too weak. Please use at least 6 characters.":e.includes("requires a recent login")?"For your security, please sign in again to continue.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again.")},GQ=()=>{const[n,e]=D.useState(""),[t,r]=D.useState(!1),s=St(),{user:a,logout:o}=jt();D.useEffect(()=>{a||e("Invalid or expired password reset session. Please request a new password reset link.")},[a]);const{register:l,handleSubmit:c,formState:{errors:d,isSubmitting:h}}=tn({resolver:Dn(HQ)}),p=async x=>{e("");const{error:v}=await wa.updateUserPassword(x.password);v?e(YQ(v.message)):(r(!0),await o(),setTimeout(()=>s("/auth/login",{replace:!0}),2e3))};return t?i.jsxs("div",{className:"text-center",children:[i.jsx(Hi,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Password Updated!"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"Your password has been changed successfully. You will be redirected to the login page shortly."}),i.jsx("div",{className:"mt-6",children:i.jsx(Pa,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",children:" Back to Login Now"})})]}):n&&!a?i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-3xl font-bold text-white",children:"Link Expired"}),i.jsx("p",{className:"text-sm text-gray-300 mt-1",children:"This password reset link is no longer valid."}),i.jsxs("div",{className:"mt-6 flex flex-col gap-4",children:[i.jsx(Pa,{to:"/auth/forgot-password",className:"font-medium text-white/80 hover:text-white",children:"Request a new link"}),i.jsx("div",{className:"auth-separator",children:"OR"}),i.jsx(re,{onClick:()=>s("/auth/login"),className:"w-full",size:"lg",children:"Back to Sign In"})]})]}):i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm text-center text-gray-300 -mt-6 mb-6",children:["for ",i.jsx("span",{className:"font-semibold text-white",children:a?.email}),"."]}),i.jsxs("form",{onSubmit:c(p),className:"space-y-6",children:[i.jsx(je,{id:"password",type:"password",placeholder:"New Password",autoComplete:"new-password",registration:l("password"),error:d.password?.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),i.jsx(je,{id:"confirmPassword",type:"password",placeholder:"Confirm New Password",autoComplete:"new-password",registration:l("confirmPassword"),error:d.confirmPassword?.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),n&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:n}),i.jsx("div",{children:i.jsx(re,{type:"submit",className:"w-full",isLoading:h,size:"lg",disabled:!a,children:"Update Password"})})]})]})},ZQ=()=>{const n=St(),{logout:e}=jt(),t=async()=>{await e(),n("/auth/login",{replace:!0})},r=()=>{n(-1)};return i.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 relative",children:i.jsxs("div",{className:"w-full max-w-md bg-card rounded-2xl shadow-card p-8 text-center relative z-10",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"p-4 rounded-full bg-red-100",children:i.jsx(bo,{className:"h-10 w-10 text-red-600"})})}),i.jsx("h1",{className:"text-2xl font-bold text-primary-text mb-2",children:"Log Out"}),i.jsx("p",{className:"text-muted mb-8",children:"Are you sure you want to log out? You will need to sign in again to access your account."}),i.jsxs("div",{className:"flex flex-col gap-3",children:[i.jsx(re,{onClick:t,variant:"danger",className:"w-full !py-3 !text-lg shadow-lg shadow-red-100",children:"Yes, Log Out"}),i.jsx(re,{onClick:r,variant:"secondary",className:"w-full !py-3",children:"Cancel"})]})]})})},KQ=()=>{const{logout:n,user:e}=jt(),t=St(),r=async()=>{await n(),t("/auth/login",{replace:!0})};return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:i.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[i.jsx(Gi,{className:"h-10 mx-auto mb-6"}),i.jsx(oJ,{className:"h-16 w-16 text-accent mx-auto mb-4"}),i.jsx("h2",{className:"text-2xl font-bold text-primary-text mb-2",children:"Account Pending Approval"}),i.jsxs("p",{className:"text-muted mb-6",children:["Welcome, ",e?.name||"user","! Your account has been created successfully and is pending approval. An administrator will review your details and perform a security check before activating your account."]}),i.jsx("div",{className:"flex justify-center",children:i.jsxs(re,{onClick:r,variant:"secondary",children:[i.jsx(bo,{className:"mr-2 h-4 w-4"}),"Log Out"]})})]})})},JQ=()=>{const n=St();return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:i.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx(ZF,{className:"h-16 w-16 text-red-500"})}),i.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Access Denied"}),i.jsx("p",{className:"text-muted mb-6",children:"You do not have the necessary permissions to view this page. If you believe this is an error, please contact your administrator."}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx(re,{onClick:()=>n(-1),variant:"secondary",children:"Go Back"}),i.jsx(re,{onClick:async()=>{await jt.getState().logout(),n("/auth/login")},children:"Login"})]})]})})},QQ=()=>{const n=St(),{data:e,reset:t}=$n(),{user:r}=jt(),s=e.personal.firstName||e.personal.lastName,a=Ft("(max-width: 767px)"),o=()=>{t(),n("/onboarding/select-organization")},l=()=>{n("/onboarding/add/personal")};return a?i.jsx("div",{className:"flex flex-col items-center justify-center text-center relative min-h-[70vh]",children:i.jsxs("div",{className:"p-8 max-w-sm w-full bg-transparent",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"p-4 rounded-full bg-black/20",children:i.jsx(wS,{className:"h-10 w-10 text-emerald-400"})})}),i.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to Employee Onboarding"}),i.jsx("p",{className:"text-gray-400 text-sm mb-8",children:"We need to collect some information to get you set up. This should only take a few minutes."}),i.jsxs("div",{className:"flex flex-col gap-3",children:[s&&i.jsx(re,{onClick:l,variant:"secondary",className:"w-full !py-3",children:"Continue Previous Application"}),i.jsx(re,{onClick:o,variant:"primary",className:"w-full !py-3 !text-lg",children:"Start New Application"})]})]})}):i.jsx("div",{className:"h-full flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-card p-8 sm:p-12 rounded-2xl shadow-card text-center w-full",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"bg-accent-light p-4 rounded-full",children:i.jsx(wS,{className:"h-12 w-12 text-accent-dark"})})}),i.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Welcome to Employee Onboarding"}),i.jsx("p",{className:"text-muted mb-8 max-w-md mx-auto",children:"We need to collect some information to get you set up. This should only take a few minutes."}),i.jsxs("div",{className:"mt-10 flex justify-center items-center gap-4 flex-wrap",children:[s&&i.jsx(re,{onClick:l,variant:"secondary",children:"Continue Draft"}),i.jsx(re,{onClick:o,variant:"primary",children:s?"Start Fresh":"Start New Application"})]})]})})},Ke=({label:n,id:e,error:t,registration:r,children:s,...a})=>{const{className:o,...l}=a,h=`form-input ${t?"form-input--error":""} ${o||""}`,p=i.jsx("select",{id:e,className:h,"aria-invalid":!!t,...r,...l,children:s});return i.jsxs("div",{children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsx("div",{className:n?"mt-1":"",children:p}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},XQ=()=>{const n=St(),{updateOrganization:e,updatePersonal:t}=$n(),{enforceManpowerLimit:r,manpowerLimitRule:s}=Kc(),{user:a}=jt(),[o,l]=D.useState(!0),[c,d]=D.useState([]),[h,p]=D.useState([]),[x,v]=D.useState([]),[_,w]=D.useState(""),[j,T]=D.useState(""),[P,E]=D.useState(""),[M,O]=D.useState(""),[I,q]=D.useState([]),[F,B]=D.useState(window.innerWidth<768);D.useEffect(()=>{const Z=()=>B(window.innerWidth<768);return window.addEventListener("resize",Z),()=>window.removeEventListener("resize",Z)},[]);const[U,W]=D.useState({isOverLimit:!1,message:""}),$=a?.role==="field_officer"&&F;D.useEffect(()=>{(async()=>{l(!0);try{const[oe,H,Q]=await Promise.all([ue.getOrganizationStructure(),ue.getOrganizations(),ue.getSiteStaffDesignations()]);d(oe),p(H),v(Q)}catch(oe){console.error("Failed to fetch organization structure",oe)}finally{l(!1)}})()},[]);const se=D.useMemo(()=>c.find(Z=>Z.id===_),[c,_]),Y=D.useMemo(()=>se?.companies||[],[se]),ae=D.useMemo(()=>Y.find(Z=>Z.id===j),[Y,j]),J=D.useMemo(()=>ae?.entities||[],[ae]);D.useEffect(()=>{O("");const Z=J.find(oe=>oe.id===P);q(Z?x:[])},[P,J,x]),D.useEffect(()=>{(async()=>{if(W({isOverLimit:!1,message:""}),!P||!r)return;const H=J.find(de=>de.id===P)?.organizationId;if(!H)return;const ne=h.find(de=>de.id===H)?.manpowerApprovedCount;if(ne==null){W({isOverLimit:!1,message:"Manpower limit not set for this site."});return}try{const ce=(await ue.getVerificationSubmissions()).filter(pe=>pe.organizationId===H&&(pe.status==="verified"||pe.status==="pending")).length;if(ce>=ne){const pe=`Manpower limit of ${ne} reached (${ce} deployed).`;W({isOverLimit:!0,message:pe})}else{const pe=`Manpower: ${ce} / ${ne} deployed.`;W({isOverLimit:!1,message:pe})}}catch{W({isOverLimit:!1,message:"Could not verify manpower count."})}})()},[P,h,J,r]);const ee=()=>{const Z=J.find(oe=>oe.id===P);if(Z?.organizationId){const oe=h.find(Q=>Q.id===Z.organizationId),H=x.find(Q=>Q.designation===M);oe&&H?(e({organizationId:oe.id,organizationName:oe.shortName,joiningDate:$e(new Date,"yyyy-MM-dd"),workType:"Full-time",designation:M,department:H.department,defaultSalary:H.monthlySalary||null}),t({salary:H.monthlySalary||null}),n("/onboarding/pre-upload")):console.error("Organization or Designation details not found.")}};if(o)return i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})});const X=!P||!M||U.isOverLimit&&s==="block";return $?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header text-white",children:[i.jsx("button",{onClick:()=>n("/onboarding"),"aria-label":"Go back",className:"text-white",children:i.jsx(Aa,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-xl font-bold",children:"New Enrollment"})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx($i,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Select Site"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Choose the client and site for the new employee."})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("select",{value:_,onChange:Z=>{w(Z.target.value),T(""),E("")},className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs("select",{value:j,onChange:Z=>{T(Z.target.value),E("")},disabled:!_,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Company --"}),Y.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs("select",{value:P,onChange:Z=>E(Z.target.value),disabled:!j,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Client/Site --"}),J.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs("select",{value:M,onChange:Z=>O(Z.target.value),disabled:!P,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Designation --"}),I.map(Z=>i.jsx("option",{value:Z.designation,children:Z.designation},Z.id))]}),U.message&&i.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${U.isOverLimit?"bg-red-900/50 text-red-300 border border-red-500/50":"bg-green-900/50 text-green-300 border border-green-500/50"}`,children:U.message})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center justify-between gap-4",children:[i.jsx("button",{onClick:()=>n("/onboarding"),className:"fo-btn-secondary px-6",children:"Back"}),i.jsx("button",{onClick:ee,disabled:X,className:"fo-btn-primary flex-1",children:"Continue"})]})]}):i.jsx("div",{className:"p-4 md:p-0",children:i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx($i,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Select Site"}),i.jsx("p",{className:"text-muted",children:"Choose the client and site for the new employee."})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs(Ke,{label:"Company Group",id:"group",value:_,onChange:Z=>{w(Z.target.value),T(""),E("")},children:[i.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs(Ke,{label:"Company",id:"company",value:j,onChange:Z=>{T(Z.target.value),E("")},disabled:!_,children:[i.jsx("option",{value:"",children:"-- Select a Company --"}),Y.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs(Ke,{label:"Client / Site",id:"entity",value:P,onChange:Z=>E(Z.target.value),disabled:!j,children:[i.jsx("option",{value:"",children:"-- Select a Client/Site --"}),J.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs(Ke,{label:"Designation",id:"designation",value:M,onChange:Z=>O(Z.target.value),disabled:!P,children:[i.jsx("option",{value:"",children:"-- Select a Designation --"}),I.map(Z=>i.jsx("option",{value:Z.designation,children:Z.designation},Z.id))]})]}),U.message&&i.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${U.isOverLimit?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:U.message}),i.jsx("div",{className:"mt-8 pt-6 border-t flex justify-end",children:i.jsxs(re,{onClick:ee,disabled:X,children:["Continue ",i.jsx(IK,{className:"ml-2 h-4 w-4"})]})})]})})},QM=({steps:n,currentStepIndex:e,onStepClick:t,highestStepReached:r,isMobileOptimized:s=!1})=>{const[a,o]=D.useState(0),l=4,c=Math.ceil(n.length/l);D.useEffect(()=>{if(s){const x=Math.floor(e/l);o(x)}},[e,s,l]);const d=()=>{o(x=>Math.min(x+1,c-1))},h=()=>{o(x=>Math.max(x-1,0))},p=D.useMemo(()=>{if(!s)return[];const x=a*l,v=x+l;return Array.from({length:n.length},(_,w)=>w).slice(x,v)},[a,l,n.length,s]);if(!s){const x=e>0?e/(n.length-1)*100:0,_=100/n.length/2;return i.jsx("nav",{"aria-label":"Onboarding Progress",className:"py-4",children:i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"absolute top-4 h-1",style:{left:`${_}%`,right:`${_}%`},children:[i.jsx("div",{className:"w-full h-full bg-border rounded-full"}),i.jsx("div",{className:"absolute top-0 left-0 h-full bg-accent rounded-full transition-all duration-500 ease-in-out",style:{width:`${x}%`}})]}),i.jsx("ol",{role:"list",className:"relative flex items-center",children:n.map((w,j)=>{const T=j<e,P=j===e,E=j<=r;return i.jsx("li",{className:"flex-1",children:i.jsxs("div",{className:"relative flex flex-col items-center group",children:[i.jsx("button",{type:"button",onClick:()=>E&&t(j),disabled:!E,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-accent-dark rounded-full disabled:cursor-not-allowed","aria-current":P?"step":void 0,title:w.label,children:i.jsx("div",{className:`relative flex items-center justify-center w-9 h-9 rounded-full transition-all duration-300 border-2 z-10 ${T?"bg-accent border-accent text-white":""} ${P?"bg-card border-accent text-accent scale-110":""} ${!T&&!P?"bg-card border-border text-muted":""} ${E?"group-hover:border-accent-dark":""}`,children:T?i.jsx(_l,{className:"w-5 h-5"}):ot.createElement(w.icon,{className:"w-5 h-5"})})}),i.jsx("span",{className:`hidden sm:block absolute top-12 w-24 text-center text-xs transition-colors duration-300 ${P?"text-accent font-bold":"text-muted"} ${E?"group-hover:text-primary-text":""}`,children:w.label})]})},w.key)})})]})})}return i.jsxs("nav",{"aria-label":"Onboarding Progress",className:"bg-card rounded-2xl mx-4 my-2 p-2 flex items-center gap-1",children:[i.jsx("button",{type:"button",onClick:h,disabled:a===0,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Previous steps",children:i.jsx(Qx,{className:"h-6 w-6"})}),i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx("ol",{role:"list",className:"flex items-center justify-around",children:p.map(x=>{const v=n[x],_=x<e,w=x===e,j=x<=r;return i.jsx("li",{className:"flex-shrink-0",children:i.jsx("div",{className:"relative flex flex-col items-center group",children:i.jsx("button",{type:"button",onClick:()=>j&&t(x),disabled:!j,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-full disabled:cursor-not-allowed","aria-current":w?"step":void 0,title:v.label,children:i.jsx("div",{className:`relative flex items-center justify-center w-10 h-10 rounded-full transition-all duration-300 border-2 z-10
                      ${_?"bg-green-600 border-green-600 text-white":""}
                      ${w?"bg-transparent border-green-500 text-white scale-110":""}
                      ${!_&&!w?`bg-transparent ${j?"border-gray-500 text-gray-400 group-hover:border-emerald-400":"border-gray-700 text-gray-600 opacity-50"}`:""}`,children:_?i.jsx(_l,{className:"w-6 h-6 text-white"}):ot.createElement(v.icon,{className:"w-6 h-6"})})})})},v.key)})})}),i.jsx("button",{type:"button",onClick:d,disabled:a>=c-1,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Next steps",children:i.jsx(Tf,{className:"h-6 w-6"})})]})},ht=({message:n,type:e,onDismiss:t})=>{D.useEffect(()=>{const a=setTimeout(()=>{t()},5e3);return()=>{clearTimeout(a)}},[t]);const r=e==="success"?"bg-green-500":"bg-red-500",s=e==="success"?Hi:lm;return i.jsxs("div",{className:`fixed top-5 right-5 z-50 flex items-center p-4 rounded-lg text-white shadow-lg ${r}`,children:[i.jsx(s,{className:"h-6 w-6 mr-3"}),i.jsx("span",{className:"text-sm font-medium",children:n}),i.jsx("button",{onClick:t,className:"ml-4 -mr-2 p-1.5 rounded-md hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white",children:i.jsx(gi,{className:"h-5 w-5"})})]})},R3=[{key:"personal",label:"Personal",icon:Tl},{key:"address",label:"Address",icon:Cl},{key:"organization",label:"Organization",icon:$i},{key:"family",label:"Family",icon:Yi},{key:"education",label:"Education",icon:BF},{key:"bank",label:"Bank",icon:Sl},{key:"uan",label:"UAN/PF",icon:AK},{key:"esi",label:"ESI",icon:yJ},{key:"gmc",label:"GMC",icon:yC},{key:"uniform",label:"Uniform",icon:Pf},{key:"documents",label:"Documents",icon:rJ},{key:"biometrics",label:"Biometrics",icon:VF},{key:"review",label:"Review",icon:XK}],qi=R3.map(n=>n.key),eX=()=>{const n=St(),e=cs(),{data:t,reset:r,setData:s}=$n(),{user:a}=jt(),{salaryThreshold:o}=Kc(),[l,c]=D.useState(!1),[d,h]=D.useState(!0),[p,x]=D.useState(null),[v]=t4(),[_,w]=D.useState(!1),[j,T]=D.useState("idle"),P=D.useRef(null),E=Ft("(max-width: 767px)"),M=D.useRef(null),O=e.pathname.split("/").pop(),I=D.useMemo(()=>qi.indexOf(O),[O]),[q,F]=D.useState(0);D.useEffect(()=>{const X=t.personal.firstName==="Ravi"&&t.status==="draft";if(t.status!=="draft"||X){F(qi.length-1);return}const Z=sessionStorage.getItem(`onboarding_progress_${t.id}`),oe=Z?parseInt(Z,10):0,H=Math.max(oe,I);F(H),I>oe&&sessionStorage.setItem(`onboarding_progress_${t.id}`,String(I))},[t,I]);const B=D.useMemo(()=>R3.map((X,Z)=>({...X,status:Z<I?"complete":Z===I?"current":"upcoming"})),[I]);D.useEffect(()=>{const X=v.get("id");X?(async oe=>{h(!0);try{const H=await ue.getOnboardingDataById(oe);H?(s(H),T("saved")):(x({message:"Could not find submission data.",type:"error"}),r())}catch(H){console.error("Failed to fetch submission data",H),x({message:"Failed to load submission data.",type:"error"}),r()}finally{h(!1)}})(X):h(!1)},[v,s,r]);const U=D.useCallback(async()=>{T("saving");try{const{draftId:X}=await ue.saveDraft(t);X!==t.id&&s({...t,id:X}),T("saved")}catch{x({message:"Auto-save failed. Check your connection.",type:"error"}),T("dirty")}},[t,s]);D.useEffect(()=>((!t.id||t.id.startsWith("draft_")||t.status==="draft")&&!d&&(j!=="saving"&&T("dirty"),P.current&&clearTimeout(P.current),P.current=window.setTimeout(()=>{U()},2e3)),()=>{P.current&&clearTimeout(P.current)}),[t,d,U,j]);const W=async()=>{P.current&&clearTimeout(P.current),await U();const X=M.current;if(M.current=null,X)n(`/onboarding/add/${X}`);else if(I<qi.length-1){let Z=I+1;O==="esi"&&qi[Z]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||Z++),Z<qi.length&&n(`/onboarding/add/${qi[Z]}`)}},$=X=>{X<=q&&n(`/onboarding/add/${qi[X]}`)},se=()=>{if(I>0){let X=I-1;O==="uniform"&&qi[X]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||X--),X>=0?n(`/onboarding/add/${qi[X]}`):n("/onboarding/select-organization")}else n("/onboarding/select-organization")},Y=async()=>{c(!0);const X={...t,status:"pending"};try{!!t.id&&!t.id.startsWith("draft_")?(await ue.updateOnboarding(X),x({message:"Application updated successfully!",type:"success"})):(await ue.submitOnboarding(X),x({message:"Application submitted successfully!",type:"success"})),setTimeout(()=>{r(),a?.role==="site_manager"?n("/site/dashboard"):n("/onboarding")},2e3)}catch{x({message:"Failed to submit application.",type:"error"}),c(!1)}},ae=()=>{sessionStorage.removeItem(`onboarding_progress_${t.id}`),r(),w(!1),n("/onboarding/add/personal",{replace:!0}),x({message:"Form has been cleared.",type:"success"})},J=X=>{if(X.key!=="ArrowUp"&&X.key!=="ArrowDown"&&X.key!=="Enter")return;const Z=X.target;if(X.key==="Enter"&&Z.tagName!=="TEXTAREA"&&Z.tagName!=="BUTTON"&&X.preventDefault(),X.key==="Enter"&&Z.tagName==="BUTTON"||(X.key==="ArrowUp"||X.key==="ArrowDown")&&(Z.tagName==="TEXTAREA"||Z.type==="number"))return;const oe=X.currentTarget,H=Array.from(oe.querySelectorAll('input:not([type="hidden"]):not([readonly]), select, textarea, button')).filter(de=>!de.hasAttribute("disabled")&&de.offsetParent!==null),Q=H.indexOf(document.activeElement);if(Q===-1)return;(X.key==="ArrowUp"||X.key==="ArrowDown")&&X.preventDefault();let ne=Q;if(X.key==="ArrowUp"?ne=Q-1:ne=Q+1,ne>=0&&ne<H.length)H[ne].focus();else if(X.key==="Enter"&&ne>=H.length){const de=document.getElementById("save-and-next-button");de&&de.click()}};if(d)return i.jsxs("div",{className:"flex justify-center items-center h-full text-muted",children:[i.jsx(wt,{className:"h-8 w-8 animate-spin mr-4"}),i.jsx("p",{children:"Loading application data..."})]});const ee=qi[I]==="review";return E?i.jsxs("div",{className:"h-full flex flex-col",children:[p&&i.jsx(ht,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(QM,{steps:B,currentStepIndex:I,onStepClick:$,highestStepReached:q,isMobileOptimized:!0}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4 pb-28",onKeyDown:J,children:i.jsx("div",{className:"bg-card p-6 rounded-2xl",children:i.jsx(gf,{context:{onValidated:W,onSubmit:Y,isSubmitting:l,setToast:x}})})}),i.jsxs("footer",{className:"fixed bottom-0 left-0 right-0 p-4 flex items-center justify-between gap-2 bg-card border-t border-[#123820] z-10",children:[i.jsx(re,{type:"button",onClick:se,variant:"secondary",children:"Back"}),i.jsx(re,{type:"button",onClick:()=>n("/onboarding"),variant:"secondary",className:"!p-3 !rounded-full","aria-label":"Go to Home",children:i.jsx(vC,{className:"h-5 w-5"})}),i.jsx(re,{id:"save-and-next-button",type:"submit",form:`${qi[I]}-form`,children:ee?"Submit":"Next"})]})]}):i.jsx("div",{className:"p-4 md:p-0",children:i.jsxs("div",{className:`transition-opacity duration-300 ${l?"opacity-50 pointer-events-none":""}`,children:[p&&i.jsx(ht,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Hr,{isOpen:_,onClose:()=>w(!1),onConfirm:ae,title:"Confirm Clear Form",children:"Are you sure you want to clear all data entered in this form? This action cannot be undone."}),i.jsx(QM,{steps:B,currentStepIndex:I,onStepClick:$,highestStepReached:q,isMobileOptimized:E}),i.jsx("div",{className:"mt-8 bg-card p-6 sm:p-8 rounded-xl shadow-card",onKeyDown:J,children:i.jsx(gf,{context:{onValidated:W,onSubmit:Y,isSubmitting:l,setToast:x}})}),i.jsxs("div",{className:"mt-8 flex justify-between items-center",children:[i.jsx(re,{onClick:se,disabled:I===0,variant:"secondary",children:"Back"}),i.jsxs("div",{className:"flex flex-wrap gap-4 justify-end items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted italic transition-opacity duration-300 min-h-[20px]",children:[j==="saving"&&i.jsxs(i.Fragment,{children:[i.jsx(wt,{className:"h-4 w-4 animate-spin"}),i.jsx("span",{children:"Saving..."})]}),j==="saved"&&i.jsxs(i.Fragment,{children:[i.jsx(Hi,{className:"h-4 w-4 text-accent"}),i.jsx("span",{children:"Draft saved"})]}),j==="dirty"&&i.jsx("span",{className:"text-gray-500",children:"Unsaved changes"})]}),!ee&&i.jsx(re,{id:"save-and-next-button",type:"submit",form:`${qi[I]}-form`,children:"Save & Next"})]})]})]})})},EC=({status:n})=>{const t={pending:"status-chip--pending",verified:"status-chip--verified",rejected:"status-chip--rejected",draft:"status-chip--draft"}[n]||"status-chip--draft";return i.jsx("span",{className:`status-chip ${t}`,children:n})},$r=({className:n=""})=>i.jsx("div",{className:`skeleton-pulse rounded-md ${n}`}),tX=({rows:n,cols:e})=>i.jsx("div",{className:"space-y-4",children:Array.from({length:n}).map((t,r)=>i.jsx("div",{className:"bg-card rounded-2xl border border-border p-4 space-y-3",children:Array.from({length:e}).map((s,a)=>i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx($r,{className:"h-4 w-1/4"}),i.jsx($r,{className:"h-4 w-1/2"})]},a))},r))}),nX=({rows:n,cols:e})=>i.jsx(i.Fragment,{children:Array.from({length:n}).map((t,r)=>i.jsx("tr",{children:Array.from({length:e}).map((s,a)=>i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"space-y-2",children:[i.jsx($r,{className:`h-4 ${a===0?"w-3/4":"w-full"}`}),a===0&&i.jsx($r,{className:"h-3 w-1/2"})]})},a))},r))}),Ea=({rows:n=5,cols:e=4,isMobile:t=!1,mobileCols:r})=>t?i.jsx(tX,{rows:n,cols:r||e}):i.jsx(nX,{rows:n,cols:e}),rX=({submission:n,isSyncing:e})=>{if(n.status!=="verified"||!n.portalSyncStatus)return i.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});if(e)return i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[i.jsx(wt,{className:"h-4 w-4 animate-spin"})," Syncing..."]});const t=n.uan?.hasPreviousPf,r=[{label:"Aadhaar",verified:n.personal?.verifiedStatus?.idProofNumber},{label:"Bank",verified:n.bank?.verifiedStatus?.accountNumber},...t?[{label:"UAN",verified:n.uan?.verifiedStatus?.uanNumber}]:[]],s=n.portalSyncStatus==="synced"||n.portalSyncStatus==="failed",a=({label:o,status:l})=>{const c=s&&l===!0,d=s&&l===!1,h=c?fm:d?JF:QF,p=c?"text-green-600":d?"text-red-600":"text-muted",x=c?"Verified":d?"Failed":"Pending Verification";return i.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-medium ${p}`,title:x,children:[i.jsx(h,{className:"h-4 w-4"}),i.jsx("span",{children:o})]})};return i.jsx("div",{className:"flex flex-row gap-3 items-center",children:r.map(o=>i.jsx(a,{label:o.label,status:o.verified},o.label))})},sX=()=>{const[n,e]=D.useState([]),[t,r]=D.useState(!0),[s,a]=D.useState("all"),[o,l]=D.useState(""),[c,d]=D.useState(null),[h,p]=D.useState(null),x=St(),v=Ft("(max-width: 767px)"),_=D.useCallback(async()=>{r(!0);try{const M=await ue.getVerificationSubmissions(s==="all"?void 0:s);e(M)}catch(M){console.error("Failed to fetch submissions",M)}finally{r(!1)}},[s]);D.useEffect(()=>{_();const M=Me.channel("submissions-feed").on("postgres_changes",{event:"*",schema:"public",table:"onboarding_submissions"},O=>{console.log("Real-time change received!",O),_()}).subscribe();return()=>{Me.removeChannel(M)}},[_]);const w=D.useMemo(()=>n?n.filter(M=>M.personal.firstName?.toLowerCase().includes(o.toLowerCase())||M.personal.lastName?.toLowerCase().includes(o.toLowerCase())||M.personal.employeeId?.toLowerCase().includes(o.toLowerCase())||M.organizationName?.toLowerCase().includes(o.toLowerCase())):[],[n,o]),j=async(M,O)=>{e(I=>I.map(q=>q.id===O?{...q,status:M==="approve"?"verified":"rejected",portalSyncStatus:M==="approve"?"pending_sync":void 0}:q));try{M==="approve"?await ue.verifySubmission(O):await ue.requestChanges(O,"Changes requested by admin.")}catch(I){console.error(`Failed to ${M} submission`,I)}},T=async M=>{d(M);try{const O=await ue.syncPortals(M);e(I=>I.map(q=>q.id===M?O:q)),O.portalSyncStatus==="synced"?p({message:"Portals synced successfully!",type:"success"}):p({message:"Portal sync failed. Check details.",type:"error"})}catch{p({message:"An error occurred during sync.",type:"error"})}finally{d(null)}},P=["all","pending","verified","rejected"],E=s==="verified"?4:5;return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx("h2",{className:"text-2xl font-semibold text-primary-text mb-6",children:"Onboarding Forms"}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[i.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:i.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:P.map(M=>i.jsx("button",{onClick:()=>a(M),className:`${s===M?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize`,children:M},M))})}),i.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ma,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name, ID, site...",value:o,onChange:M=>l(M.target.value),className:"form-input block w-full pl-10 pr-3 py-2 border-border rounded-lg leading-5 placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site"}),s!=="verified"&&i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Verification"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-card md:divide-y-0",children:t?v?i.jsx("tr",{children:i.jsx("td",{colSpan:E,children:i.jsx(Ea,{rows:3,cols:4,isMobile:!0})})}):i.jsx(Ea,{rows:5,cols:E}):w.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:E,className:"text-center py-10 text-muted",children:"No submissions found."})}):w.map(M=>i.jsxs("tr",{className:M.requiresManualVerification?"bg-orange-50":"",children:[i.jsx("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[M.requiresManualVerification&&i.jsx("span",{title:"Manual verification required due to data mismatch.",children:i.jsx(Da,{className:"h-4 w-4 text-orange-500 mr-2 flex-shrink-0"})}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[M.personal.firstName," ",M.personal.lastName]}),i.jsx("div",{className:"text-sm text-muted",children:M.personal.employeeId})]})]})}),i.jsx("td",{"data-label":"Site",className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-primary-text",children:M.organizationName}),s!=="verified"&&i.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(EC,{status:M.status})}),i.jsx("td",{"data-label":"Portal Verification",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(rX,{submission:M,isSyncing:c===M.id})}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(re,{variant:"icon",size:"sm",onClick:()=>x(`/onboarding/add/personal?id=${M.id}`),title:"View Details","aria-label":`View details for ${M.personal.firstName}`,children:i.jsx(Nl,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>x(`/onboarding/pdf/${M.id}`),title:"Download Forms","aria-label":`Download forms for ${M.personal.firstName}`,children:i.jsx(os,{className:"h-4 w-4"})}),M.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx(re,{variant:"icon",size:"sm",onClick:()=>j("approve",M.id),title:"Verify","aria-label":`Verify submission for ${M.personal.firstName}`,children:i.jsx(fm,{className:"h-4 w-4 text-green-600"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>j("reject",M.id),title:"Request Changes","aria-label":`Request changes for ${M.personal.firstName}`,children:i.jsx(JF,{className:"h-4 w-4 text-red-600"})})]}),M.status==="verified"&&(M.portalSyncStatus==="pending_sync"||M.portalSyncStatus==="failed")&&i.jsxs(re,{variant:"outline",size:"sm",onClick:()=>T(M.id),isLoading:c===M.id,title:"Push data to government portals",children:[c!==M.id&&i.jsx(_C,{className:"h-4 w-4 mr-1"}),"Sync Portals"]})]})})]},M.id))})]})})]})},Ji=({title:n,children:e})=>i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:n}),e&&i.jsx("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:e})]}),iX=({isOpen:n,onClose:e,onApprove:t,user:r,isConfirming:s})=>{const[a,o]=D.useState([]),[l,c]=D.useState(""),[d,h]=D.useState(!0);D.useEffect(()=>{n&&(h(!0),ue.getRoles().then(x=>{const v=x.filter(_=>_.id!=="unverified"&&_.id!=="admin");o(v),v.length>0&&c(v[0].id),h(!1)}))},[n]);const p=()=>{r&&l&&t(r.id,l)};return!n||!r?null:i.jsx(Hr,{isOpen:n,onClose:e,onConfirm:p,title:"Approve User Account",confirmButtonText:"Confirm Approval",confirmButtonVariant:"primary",isConfirming:s,children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{children:["You are approving the account for ",i.jsx("strong",{className:"text-primary-text",children:r.name})," (",r.email,")."]}),i.jsx("p",{children:"Please assign a role to activate their account."}),d?i.jsx("p",{children:"Loading roles..."}):i.jsx(Ke,{label:"Assign Role",id:"approval-role",value:l,onChange:x=>c(x.target.value),children:a.map(x=>i.jsx("option",{value:x.id,children:x.displayName},x.id))})]})})},aX=({isOpen:n,onClose:e,userId:t,userName:r,onSuccess:s})=>{const[a,o]=D.useState([]),[l,c]=D.useState([]),[d,h]=D.useState(!0),[p,x]=D.useState(!1),[v,_]=D.useState(""),[w,j]=D.useState(null);D.useEffect(()=>{n&&t&&T()},[n,t]);const T=async()=>{h(!0);try{const[I,q]=await Promise.all([ue.getUserLocations(t),ue.getLocations()]);o(I),c(q)}catch(I){console.error("Failed to load locations:",I),j({message:"Failed to load locations.",type:"error"})}finally{h(!1)}},P=async I=>{x(!0);try{await ue.assignLocationToUser(t,I);const q=await ue.getUserLocations(t);o(q),j({message:"Location assigned successfully!",type:"success"}),s?.()}catch(q){console.error("Failed to assign location:",q),j({message:q.message||"Failed to assign location.",type:"error"})}finally{x(!1)}},E=async I=>{x(!0);try{await ue.unassignLocationFromUser(t,I);const q=await ue.getUserLocations(t);o(q),j({message:"Location unassigned successfully!",type:"success"}),s?.()}catch(q){console.error("Failed to unassign location:",q),j({message:q.message||"Failed to unassign location.",type:"error"})}finally{x(!1)}},M=I=>a.some(q=>q.id===I),O=l.filter(I=>!M(I.id)).filter(I=>v===""||I.name?.toLowerCase().includes(v.toLowerCase())||I.address?.toLowerCase().includes(v.toLowerCase()));return i.jsxs(i.Fragment,{children:[w&&i.jsx(ht,{message:w.message,type:w.type,onDismiss:()=>j(null)}),i.jsx(Hr,{isOpen:n,onClose:e,title:`Manage Locations for ${r}`,children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-primary-text mb-3",children:["Assigned Locations (",a.length,")"]}),d?i.jsx("p",{className:"text-sm text-muted",children:"Loading..."}):a.length===0?i.jsx("p",{className:"text-sm text-muted bg-gray-50 p-3 rounded-lg",children:"No locations assigned yet."}):i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:a.map(I=>i.jsxs("div",{className:"flex items-start justify-between bg-accent/10 border border-accent/30 rounded-lg p-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm text-primary-text",children:I.name||"Unnamed"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:I.address||"No address"})]}),i.jsx("button",{type:"button",onClick:()=>E(I.id),disabled:p,className:"text-red-500 hover:text-red-700 disabled:opacity-50 p-1",title:"Remove",children:i.jsx(gi,{className:"h-5 w-5"})})]},I.id))})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-primary-text mb-3",children:["Available Locations (",O.length,")"]}),i.jsx(je,{type:"text",placeholder:"Search locations...",value:v,onChange:I=>_(I.target.value),className:"mb-3"}),d?i.jsx("p",{className:"text-sm text-muted",children:"Loading..."}):O.length===0?i.jsx("p",{className:"text-sm text-muted bg-gray-50 p-3 rounded-lg",children:v?"No locations found.":"All assigned."}):i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:O.map(I=>i.jsxs("div",{className:"flex items-start justify-between border border-border rounded-lg p-3 hover:bg-gray-50",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm text-primary-text",children:I.name||"Unnamed"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:I.address||"No address"}),i.jsxs("p",{className:"text-xs text-muted mt-1",children:[I.latitude.toFixed(4),", ",I.longitude.toFixed(4),"  Radius: ",I.radius,"m"]})]}),i.jsx("button",{type:"button",onClick:()=>P(I.id),disabled:p,className:"text-accent hover:text-accent-dark disabled:opacity-50 p-1",title:"Assign",children:i.jsx(Bt,{className:"h-5 w-5"})})]},I.id))})]}),i.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:i.jsx(re,{onClick:e,variant:"secondary",children:"Done"})})]})})]})},oX=()=>{const n=St(),[e,t]=D.useState([]),[r,s]=D.useState(!0),[a,o]=D.useState(!1),[l,c]=D.useState(!1),[d,h]=D.useState(!1),[p,x]=D.useState(!1),[v,_]=D.useState(null),[w,j]=D.useState(null),[T,P]=D.useState(null),E=Ft("(max-width: 767px)"),M=D.useCallback(async()=>{s(!0);try{const $=await ue.getUsers();t($)}catch{P({message:"Failed to fetch users.",type:"error"})}finally{s(!1)}},[]);D.useEffect(()=>{M()},[M]);const O=()=>{n("/admin/users/add")},I=$=>{n(`/admin/users/edit/${$.id}`)},q=$=>{_($),h(!0)},F=$=>{_($),c(!0)},B=async($,se)=>{o(!0);try{await ue.updateUser($,{role:se}),P({message:"User approved successfully!",type:"success"}),h(!1),M()}catch{P({message:"Failed to approve user.",type:"error"})}finally{o(!1)}},U=async()=>{if(v){o(!0);try{await ue.deleteUser(v.id),P({message:"User deleted. Remember to also remove them from Supabase Auth.",type:"success"}),c(!1),M()}catch{P({message:"Failed to delete user.",type:"error"})}finally{o(!1)}}},W=$=>$?$.replace(/_/g," ").replace(/\b\w/g,se=>se.toUpperCase()):"N/A";return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[T&&i.jsx(ht,{message:T.message,type:T.type,onDismiss:()=>P(null)}),i.jsx(iX,{isOpen:d,onClose:()=>h(!1),onApprove:B,user:v,isConfirming:a}),i.jsxs(Hr,{isOpen:l,onClose:()=>c(!1),onConfirm:U,title:"Confirm Deletion",isConfirming:a,children:['Are you sure you want to delete the user "',v?.name,'"? This action cannot be undone.']}),i.jsx(aX,{isOpen:p,onClose:()=>x(!1),userId:w?.id||"",userName:w?.name||""}),i.jsx(Ji,{title:"User Management",children:i.jsxs(re,{onClick:O,children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add User"]})}),i.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 text-blue-800 p-4 rounded-lg text-sm",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(ru,{className:"h-5 w-5 mr-3 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold",children:"Adding New Users"}),i.jsxs("p",{className:"mt-1",children:["Use the ",i.jsx("strong",{children:"Add User"})," button below to create a new user. Provide their name, email, role and a temporary password. The system will automatically provision their login, send them a verification email and create their profile."]}),i.jsx("p",{className:"mt-2",children:"Once they confirm their email they can sign in using the password you set. You can edit or delete users at any time from this page."})]})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Email"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:r?E?i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsx(Ea,{rows:3,cols:4,isMobile:!0})})}):i.jsx(Ea,{rows:5,cols:4}):e.map($=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Name",className:"px-6 py-4 font-medium",children:$.name}),i.jsx("td",{"data-label":"Email",className:"px-6 py-4 text-sm text-muted",children:$.email}),i.jsxs("td",{"data-label":"Role",className:"px-6 py-4 text-sm text-muted",children:[i.jsxs("div",{className:"flex items-center md:justify-start justify-end",children:[i.jsx(Xx,{className:"h-4 w-4 mr-2 text-accent"}),W($.role)]}),$.role==="unverified"&&i.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800 ml-2",children:"Pending Approval"})]}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[$.role==="unverified"&&i.jsxs(re,{variant:"outline",size:"sm",onClick:()=>q($),"aria-label":`Approve user ${$.name}`,title:`Approve user ${$.name}`,children:[i.jsx(uu,{className:"h-4 w-4 mr-2"}),"Approve"]}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>I($),"aria-label":`Edit user ${$.name}`,title:`Edit user ${$.name}`,children:i.jsx(cr,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",onClick:()=>F($),"aria-label":`Delete user ${$.name}`,title:`Delete user ${$.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})})]},$.id))})]})})]})};var vb,XM;function lX(){if(XM)return vb;XM=1;var n=!1,e,t,r,s,a,o,l,c,d,h,p,x,v,_,w;function j(){if(!n){n=!0;var P=navigator.userAgent,E=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(P),M=/(Mac OS X)|(Windows)|(Linux)/.exec(P);if(x=/\b(iPhone|iP[ao]d)/.exec(P),v=/\b(iP[ao]d)/.exec(P),h=/Android/i.exec(P),_=/FBAN\/\w+;/i.exec(P),w=/Mobile/i.exec(P),p=!!/Win64/.exec(P),E){e=E[1]?parseFloat(E[1]):E[5]?parseFloat(E[5]):NaN,e&&document&&document.documentMode&&(e=document.documentMode);var O=/(?:Trident\/(\d+.\d+))/.exec(P);o=O?parseFloat(O[1])+4:e,t=E[2]?parseFloat(E[2]):NaN,r=E[3]?parseFloat(E[3]):NaN,s=E[4]?parseFloat(E[4]):NaN,s?(E=/(?:Chrome\/(\d+\.\d+))/.exec(P),a=E&&E[1]?parseFloat(E[1]):NaN):a=NaN}else e=t=r=a=s=NaN;if(M){if(M[1]){var I=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(P);l=I?parseFloat(I[1].replace("_",".")):!0}else l=!1;c=!!M[2],d=!!M[3]}else l=c=d=!1}}var T={ie:function(){return j()||e},ieCompatibilityMode:function(){return j()||o>e},ie64:function(){return T.ie()&&p},firefox:function(){return j()||t},opera:function(){return j()||r},webkit:function(){return j()||s},safari:function(){return T.webkit()},chrome:function(){return j()||a},windows:function(){return j()||c},osx:function(){return j()||l},linux:function(){return j()||d},iphone:function(){return j()||x},mobile:function(){return j()||x||v||h||w},nativeApp:function(){return j()||_},android:function(){return j()||h},ipad:function(){return j()||v}};return vb=T,vb}var bb,eD;function cX(){if(eD)return bb;eD=1;var n=!!(typeof window<"u"&&window.document&&window.document.createElement),e={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};return bb=e,bb}var _b,tD;function dX(){if(tD)return _b;tD=1;var n=cX(),e;n.canUseDOM&&(e=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function t(r,s){if(!n.canUseDOM||s&&!("addEventListener"in document))return!1;var a="on"+r,o=a in document;if(!o){var l=document.createElement("div");l.setAttribute(a,"return;"),o=typeof l[a]=="function"}return!o&&e&&r==="wheel"&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o}return _b=t,_b}var wb,nD;function uX(){if(nD)return wb;nD=1;var n=lX(),e=dX(),t=10,r=40,s=800;function a(o){var l=0,c=0,d=0,h=0;return"detail"in o&&(c=o.detail),"wheelDelta"in o&&(c=-o.wheelDelta/120),"wheelDeltaY"in o&&(c=-o.wheelDeltaY/120),"wheelDeltaX"in o&&(l=-o.wheelDeltaX/120),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(l=c,c=0),d=l*t,h=c*t,"deltaY"in o&&(h=o.deltaY),"deltaX"in o&&(d=o.deltaX),(d||h)&&o.deltaMode&&(o.deltaMode==1?(d*=r,h*=r):(d*=s,h*=s)),d&&!l&&(l=d<1?-1:1),h&&!c&&(c=h<1?-1:1),{spinX:l,spinY:c,pixelX:d,pixelY:h}}return a.getEventType=function(){return n.firefox()?"DOMMouseScroll":e("wheel")?"wheel":"mousewheel"},wb=a,wb}var jb,rD;function fX(){return rD||(rD=1,jb=uX()),jb}var hX=fX();const mX=mu(hX);function pX(n,e,t,r,s,a){a===void 0&&(a=0);var o=Mf(n,e,a),l=o.width,c=o.height,d=Math.min(l,t),h=Math.min(c,r);return d>h*s?{width:h*s,height:h}:{width:d,height:d/s}}function gX(n){return n.width>n.height?n.width/n.naturalWidth:n.height/n.naturalHeight}function yh(n,e,t,r,s){s===void 0&&(s=0);var a=Mf(e.width,e.height,s),o=a.width,l=a.height;return{x:sD(n.x,o,t.width,r),y:sD(n.y,l,t.height,r)}}function sD(n,e,t,r){var s=e*r/2-t/2;return ay(n,-s,s)}function iD(n,e){return Math.sqrt(Math.pow(n.y-e.y,2)+Math.pow(n.x-e.x,2))}function aD(n,e){return Math.atan2(e.y-n.y,e.x-n.x)*180/Math.PI}function xX(n,e,t,r,s,a,o){a===void 0&&(a=0),o===void 0&&(o=!0);var l=o?yX:vX,c=Mf(e.width,e.height,a),d=Mf(e.naturalWidth,e.naturalHeight,a),h={x:l(100,((c.width-t.width/s)/2-n.x/s)/c.width*100),y:l(100,((c.height-t.height/s)/2-n.y/s)/c.height*100),width:l(100,t.width/c.width*100/s),height:l(100,t.height/c.height*100/s)},p=Math.round(l(d.width,h.width*d.width/100)),x=Math.round(l(d.height,h.height*d.height/100)),v=d.width>=d.height*r,_=v?{width:Math.round(x*r),height:x}:{width:p,height:Math.round(p/r)},w=pr(pr({},_),{x:Math.round(l(d.width-_.width,h.x*d.width/100)),y:Math.round(l(d.height-_.height,h.y*d.height/100))});return{croppedAreaPercentages:h,croppedAreaPixels:w}}function yX(n,e){return Math.min(n,Math.max(0,e))}function vX(n,e){return e}function bX(n,e,t,r,s,a){var o=Mf(e.width,e.height,t),l=ay(r.width/o.width*(100/n.width),s,a),c={x:l*o.width/2-r.width/2-o.width*l*(n.x/100),y:l*o.height/2-r.height/2-o.height*l*(n.y/100)};return{crop:c,zoom:l}}function _X(n,e,t){var r=gX(e);return t.height>t.width?t.height/(n.height*r):t.width/(n.width*r)}function wX(n,e,t,r,s,a){t===void 0&&(t=0);var o=Mf(e.naturalWidth,e.naturalHeight,t),l=ay(_X(n,e,r),s,a),c=r.height>r.width?r.height/n.height:r.width/n.width,d={x:((o.width-n.width)/2-n.x)*c,y:((o.height-n.height)/2-n.y)*c};return{crop:d,zoom:l}}function oD(n,e){return{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}function jX(n){return n*Math.PI/180}function Mf(n,e,t){var r=jX(t);return{width:Math.abs(Math.cos(r)*n)+Math.abs(Math.sin(r)*e),height:Math.abs(Math.sin(r)*n)+Math.abs(Math.cos(r)*e)}}function ay(n,e,t){return Math.min(Math.max(n,e),t)}function zp(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.filter(function(t){return typeof t=="string"&&t.length>0}).join(" ").trim()}var NX=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,SX=1,CX=3,TX=1,kX=(function(n){KS(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.cropperRef=D.createRef(),t.imageRef=D.createRef(),t.videoRef=D.createRef(),t.containerPosition={x:0,y:0},t.containerRef=null,t.styleRef=null,t.containerRect=null,t.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},t.dragStartPosition={x:0,y:0},t.dragStartCrop={x:0,y:0},t.gestureZoomStart=0,t.gestureRotationStart=0,t.isTouching=!1,t.lastPinchDistance=0,t.lastPinchRotation=0,t.rafDragTimeout=null,t.rafPinchTimeout=null,t.wheelTimer=null,t.currentDoc=typeof document<"u"?document:null,t.currentWindow=typeof window<"u"?window:null,t.resizeObserver=null,t.previousCropSize=null,t.isInitialized=!1,t.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},t.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!t.containerRef)){var r=!0;t.resizeObserver=new window.ResizeObserver(function(s){if(r){r=!1;return}t.computeSizes()}),t.resizeObserver.observe(t.containerRef)}},t.preventZoomSafari=function(r){return r.preventDefault()},t.cleanEvents=function(){t.currentDoc&&(t.currentDoc.removeEventListener("mousemove",t.onMouseMove),t.currentDoc.removeEventListener("mouseup",t.onDragStopped),t.currentDoc.removeEventListener("touchmove",t.onTouchMove),t.currentDoc.removeEventListener("touchend",t.onDragStopped),t.currentDoc.removeEventListener("gesturechange",t.onGestureChange),t.currentDoc.removeEventListener("gestureend",t.onGestureEnd),t.currentDoc.removeEventListener("scroll",t.onScroll))},t.clearScrollEvent=function(){t.containerRef&&t.containerRef.removeEventListener("wheel",t.onWheel),t.wheelTimer&&clearTimeout(t.wheelTimer)},t.onMediaLoad=function(){var r=t.computeSizes();r&&(t.previousCropSize=r,t.emitCropData(),t.setInitialCrop(r),t.isInitialized=!0),t.props.onMediaLoaded&&t.props.onMediaLoaded(t.mediaSize)},t.setInitialCrop=function(r){if(t.props.initialCroppedAreaPercentages){var s=bX(t.props.initialCroppedAreaPercentages,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),a=s.crop,o=s.zoom;t.props.onCropChange(a),t.props.onZoomChange&&t.props.onZoomChange(o)}else if(t.props.initialCroppedAreaPixels){var l=wX(t.props.initialCroppedAreaPixels,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),a=l.crop,o=l.zoom;t.props.onCropChange(a),t.props.onZoomChange&&t.props.onZoomChange(o)}},t.computeSizes=function(){var r,s,a,o,l,c,d=t.imageRef.current||t.videoRef.current;if(d&&t.containerRef){t.containerRect=t.containerRef.getBoundingClientRect(),t.saveContainerPosition();var h=t.containerRect.width/t.containerRect.height,p=((r=t.imageRef.current)===null||r===void 0?void 0:r.naturalWidth)||((s=t.videoRef.current)===null||s===void 0?void 0:s.videoWidth)||0,x=((a=t.imageRef.current)===null||a===void 0?void 0:a.naturalHeight)||((o=t.videoRef.current)===null||o===void 0?void 0:o.videoHeight)||0,v=d.offsetWidth<p||d.offsetHeight<x,_=p/x,w=void 0;if(v)switch(t.state.mediaObjectFit){default:case"contain":w=h>_?{width:t.containerRect.height*_,height:t.containerRect.height}:{width:t.containerRect.width,height:t.containerRect.width/_};break;case"horizontal-cover":w={width:t.containerRect.width,height:t.containerRect.width/_};break;case"vertical-cover":w={width:t.containerRect.height*_,height:t.containerRect.height};break}else w={width:d.offsetWidth,height:d.offsetHeight};t.mediaSize=pr(pr({},w),{naturalWidth:p,naturalHeight:x}),t.props.setMediaSize&&t.props.setMediaSize(t.mediaSize);var j=t.props.cropSize?t.props.cropSize:pX(t.mediaSize.width,t.mediaSize.height,t.containerRect.width,t.containerRect.height,t.props.aspect,t.props.rotation);return(((l=t.state.cropSize)===null||l===void 0?void 0:l.height)!==j.height||((c=t.state.cropSize)===null||c===void 0?void 0:c.width)!==j.width)&&t.props.onCropSizeChange&&t.props.onCropSizeChange(j),t.setState({cropSize:j},t.recomputeCropPosition),t.props.setCropSize&&t.props.setCropSize(j),j}},t.saveContainerPosition=function(){if(t.containerRef){var r=t.containerRef.getBoundingClientRect();t.containerPosition={x:r.left,y:r.top}}},t.onMouseDown=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("mousemove",t.onMouseMove),t.currentDoc.addEventListener("mouseup",t.onDragStopped),t.saveContainerPosition(),t.onDragStart(e.getMousePoint(r)))},t.onMouseMove=function(r){return t.onDrag(e.getMousePoint(r))},t.onScroll=function(r){t.currentDoc&&(r.preventDefault(),t.saveContainerPosition())},t.onTouchStart=function(r){t.currentDoc&&(t.isTouching=!0,!(t.props.onTouchRequest&&!t.props.onTouchRequest(r))&&(t.currentDoc.addEventListener("touchmove",t.onTouchMove,{passive:!1}),t.currentDoc.addEventListener("touchend",t.onDragStopped),t.saveContainerPosition(),r.touches.length===2?t.onPinchStart(r):r.touches.length===1&&t.onDragStart(e.getTouchPoint(r.touches[0]))))},t.onTouchMove=function(r){r.preventDefault(),r.touches.length===2?t.onPinchMove(r):r.touches.length===1&&t.onDrag(e.getTouchPoint(r.touches[0]))},t.onGestureStart=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("gesturechange",t.onGestureChange),t.currentDoc.addEventListener("gestureend",t.onGestureEnd),t.gestureZoomStart=t.props.zoom,t.gestureRotationStart=t.props.rotation)},t.onGestureChange=function(r){if(r.preventDefault(),!t.isTouching){var s=e.getMousePoint(r),a=t.gestureZoomStart-1+r.scale;if(t.setNewZoom(a,s,{shouldUpdatePosition:!0}),t.props.onRotationChange){var o=t.gestureRotationStart+r.rotation;t.props.onRotationChange(o)}}},t.onGestureEnd=function(r){t.cleanEvents()},t.onDragStart=function(r){var s,a,o=r.x,l=r.y;t.dragStartPosition={x:o,y:l},t.dragStartCrop=pr({},t.props.crop),(a=(s=t.props).onInteractionStart)===null||a===void 0||a.call(s)},t.onDrag=function(r){var s=r.x,a=r.y;t.currentWindow&&(t.rafDragTimeout&&t.currentWindow.cancelAnimationFrame(t.rafDragTimeout),t.rafDragTimeout=t.currentWindow.requestAnimationFrame(function(){if(t.state.cropSize&&!(s===void 0||a===void 0)){var o=s-t.dragStartPosition.x,l=a-t.dragStartPosition.y,c={x:t.dragStartCrop.x+o,y:t.dragStartCrop.y+l},d=t.props.restrictPosition?yh(c,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):c;t.props.onCropChange(d)}}))},t.onDragStopped=function(){var r,s;t.isTouching=!1,t.cleanEvents(),t.emitCropData(),(s=(r=t.props).onInteractionEnd)===null||s===void 0||s.call(r)},t.onWheel=function(r){if(t.currentWindow&&!(t.props.onWheelRequest&&!t.props.onWheelRequest(r))){r.preventDefault();var s=e.getMousePoint(r),a=mX(r).pixelY,o=t.props.zoom-a*t.props.zoomSpeed/200;t.setNewZoom(o,s,{shouldUpdatePosition:!0}),t.state.hasWheelJustStarted||t.setState({hasWheelJustStarted:!0},function(){var l,c;return(c=(l=t.props).onInteractionStart)===null||c===void 0?void 0:c.call(l)}),t.wheelTimer&&clearTimeout(t.wheelTimer),t.wheelTimer=t.currentWindow.setTimeout(function(){return t.setState({hasWheelJustStarted:!1},function(){var l,c;return(c=(l=t.props).onInteractionEnd)===null||c===void 0?void 0:c.call(l)})},250)}},t.getPointOnContainer=function(r,s){var a=r.x,o=r.y;if(!t.containerRect)throw new Error("The Cropper is not mounted");return{x:t.containerRect.width/2-(a-s.x),y:t.containerRect.height/2-(o-s.y)}},t.getPointOnMedia=function(r){var s=r.x,a=r.y,o=t.props,l=o.crop,c=o.zoom;return{x:(s+l.x)/c,y:(a+l.y)/c}},t.setNewZoom=function(r,s,a){var o=a===void 0?{}:a,l=o.shouldUpdatePosition,c=l===void 0?!0:l;if(!(!t.state.cropSize||!t.props.onZoomChange)){var d=ay(r,t.props.minZoom,t.props.maxZoom);if(c){var h=t.getPointOnContainer(s,t.containerPosition),p=t.getPointOnMedia(h),x={x:p.x*d-h.x,y:p.y*d-h.y},v=t.props.restrictPosition?yh(x,t.mediaSize,t.state.cropSize,d,t.props.rotation):x;t.props.onCropChange(v)}t.props.onZoomChange(d)}},t.getCropData=function(){if(!t.state.cropSize)return null;var r=t.props.restrictPosition?yh(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;return xX(r,t.mediaSize,t.state.cropSize,t.getAspect(),t.props.zoom,t.props.rotation,t.props.restrictPosition)},t.emitCropData=function(){var r=t.getCropData();if(r){var s=r.croppedAreaPercentages,a=r.croppedAreaPixels;t.props.onCropComplete&&t.props.onCropComplete(s,a),t.props.onCropAreaChange&&t.props.onCropAreaChange(s,a)}},t.emitCropAreaChange=function(){var r=t.getCropData();if(r){var s=r.croppedAreaPercentages,a=r.croppedAreaPixels;t.props.onCropAreaChange&&t.props.onCropAreaChange(s,a)}},t.recomputeCropPosition=function(){if(t.state.cropSize){var r=t.props.crop;if(t.isInitialized&&t.previousCropSize){var s=Math.abs(t.previousCropSize.width-t.state.cropSize.width)>1e-6||Math.abs(t.previousCropSize.height-t.state.cropSize.height)>1e-6;if(s){var a=t.state.cropSize.width/t.previousCropSize.width,o=t.state.cropSize.height/t.previousCropSize.height;r={x:t.props.crop.x*a,y:t.props.crop.y*o}}}var l=t.props.restrictPosition?yh(r,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):r;t.previousCropSize=t.state.cropSize,t.props.onCropChange(l),t.emitCropData()}},t.onKeyDown=function(r){var s,a,o=t.props,l=o.crop,c=o.onCropChange,d=o.keyboardStep,h=o.zoom,p=o.rotation,x=d;if(t.state.cropSize){r.shiftKey&&(x*=.2);var v=pr({},l);switch(r.key){case"ArrowUp":v.y-=x,r.preventDefault();break;case"ArrowDown":v.y+=x,r.preventDefault();break;case"ArrowLeft":v.x-=x,r.preventDefault();break;case"ArrowRight":v.x+=x,r.preventDefault();break;default:return}t.props.restrictPosition&&(v=yh(v,t.mediaSize,t.state.cropSize,h,p)),r.repeat||(a=(s=t.props).onInteractionStart)===null||a===void 0||a.call(s),c(v)}},t.onKeyUp=function(r){var s,a;switch(r.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":r.preventDefault();break;default:return}t.emitCropData(),(a=(s=t.props).onInteractionEnd)===null||a===void 0||a.call(s)},t}return e.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=NX,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},e.prototype.componentWillUnmount=function(){var t,r;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((r=this.styleRef.parentNode)===null||r===void 0||r.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},e.prototype.componentDidUpdate=function(t){var r,s,a,o,l,c,d,h,p;t.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):t.aspect!==this.props.aspect?this.computeSizes():t.objectFit!==this.props.objectFit?this.computeSizes():t.zoom!==this.props.zoom?this.recomputeCropPosition():((r=t.cropSize)===null||r===void 0?void 0:r.height)!==((s=this.props.cropSize)===null||s===void 0?void 0:s.height)||((a=t.cropSize)===null||a===void 0?void 0:a.width)!==((o=this.props.cropSize)===null||o===void 0?void 0:o.width)?this.computeSizes():(((l=t.crop)===null||l===void 0?void 0:l.x)!==((c=this.props.crop)===null||c===void 0?void 0:c.x)||((d=t.crop)===null||d===void 0?void 0:d.y)!==((h=this.props.crop)===null||h===void 0?void 0:h.y))&&this.emitCropAreaChange(),t.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),t.video!==this.props.video&&((p=this.videoRef.current)===null||p===void 0||p.load());var x=this.getObjectFit();x!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:x},this.computeSizes)},e.prototype.getAspect=function(){var t=this.props,r=t.cropSize,s=t.aspect;return r?r.width/r.height:s},e.prototype.getObjectFit=function(){var t,r,s,a;if(this.props.objectFit==="cover"){var o=this.imageRef.current||this.videoRef.current;if(o&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var l=this.containerRect.width/this.containerRect.height,c=((t=this.imageRef.current)===null||t===void 0?void 0:t.naturalWidth)||((r=this.videoRef.current)===null||r===void 0?void 0:r.videoWidth)||0,d=((s=this.imageRef.current)===null||s===void 0?void 0:s.naturalHeight)||((a=this.videoRef.current)===null||a===void 0?void 0:a.videoHeight)||0,h=c/d;return h<l?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},e.prototype.onPinchStart=function(t){var r=e.getTouchPoint(t.touches[0]),s=e.getTouchPoint(t.touches[1]);this.lastPinchDistance=iD(r,s),this.lastPinchRotation=aD(r,s),this.onDragStart(oD(r,s))},e.prototype.onPinchMove=function(t){var r=this;if(!(!this.currentDoc||!this.currentWindow)){var s=e.getTouchPoint(t.touches[0]),a=e.getTouchPoint(t.touches[1]),o=oD(s,a);this.onDrag(o),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var l=iD(s,a),c=r.props.zoom*(l/r.lastPinchDistance);r.setNewZoom(c,o,{shouldUpdatePosition:!1}),r.lastPinchDistance=l;var d=aD(s,a),h=r.props.rotation+(d-r.lastPinchRotation);r.props.onRotationChange&&r.props.onRotationChange(h),r.lastPinchRotation=d})}},e.prototype.render=function(){var t=this,r,s=this.props,a=s.image,o=s.video,l=s.mediaProps,c=s.cropperProps,d=s.transform,h=s.crop,p=h.x,x=h.y,v=s.rotation,_=s.zoom,w=s.cropShape,j=s.showGrid,T=s.roundCropAreaPixels,P=s.style,E=P.containerStyle,M=P.cropAreaStyle,O=P.mediaStyle,I=s.classes,q=I.containerClassName,F=I.cropAreaClassName,B=I.mediaClassName,U=(r=this.state.mediaObjectFit)!==null&&r!==void 0?r:this.getObjectFit();return D.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function($){return t.containerRef=$},"data-testid":"container",style:E,className:zp("reactEasyCrop_Container",q)},a?D.createElement("img",pr({alt:"",className:zp("reactEasyCrop_Image",U==="contain"&&"reactEasyCrop_Contain",U==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",U==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",B)},l,{src:a,ref:this.imageRef,style:pr(pr({},O),{transform:d||"translate(".concat(p,"px, ").concat(x,"px) rotate(").concat(v,"deg) scale(").concat(_,")")}),onLoad:this.onMediaLoad})):o&&D.createElement("video",pr({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:zp("reactEasyCrop_Video",U==="contain"&&"reactEasyCrop_Contain",U==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",U==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",B)},l,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:pr(pr({},O),{transform:d||"translate(".concat(p,"px, ").concat(x,"px) rotate(").concat(v,"deg) scale(").concat(_,")")}),controls:!1}),(Array.isArray(o)?o:[{src:o}]).map(function(W){return D.createElement("source",pr({key:W.src},W))})),this.state.cropSize&&D.createElement("div",pr({ref:this.cropperRef,style:pr(pr({},M),{width:T?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:T?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:zp("reactEasyCrop_CropArea",w==="round"&&"reactEasyCrop_CropAreaRound",j&&"reactEasyCrop_CropAreaGrid",F)},c)))},e.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:CX,minZoom:SX,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:TX},e.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e})(D.Component);const PX=n=>new Promise((e,t)=>{const r=new Image;r.addEventListener("load",()=>e(r)),r.addEventListener("error",s=>t(s)),r.src=n});async function MX(n,e){const t=await PX(n),r=document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("No 2d context");return r.width=e.width,r.height=e.height,s.drawImage(t,e.x,e.y,e.width,e.height,0,0,e.width,e.height),r.toDataURL("image/jpeg",.9)}const L3=({isOpen:n,onClose:e,onCapture:t,captureGuidance:r="none"})=>{const s=D.useRef(null),a=D.useRef(null),o=D.useRef(null),[l,c]=D.useState(null),[d,h]=D.useState(null),[p,x]=D.useState(!1),[v,_]=D.useState(""),[w,j]=D.useState(!1),[T,P]=D.useState({x:0,y:0}),[E,M]=D.useState(1),[O,I]=D.useState(null),[q,F]=D.useState(null),[B,U]=D.useState([]),[W,$]=D.useState(0),[se,Y]=D.useState(!1),[ae,J]=D.useState(!1),[ee,X]=D.useState(!1),[Z,oe]=D.useState(!1),[H,Q]=D.useState(),ne=D.useCallback(()=>{o.current&&(o.current.getTracks().forEach(Ne=>Ne.stop()),o.current=null)},[]),de=D.useCallback(async Ne=>{ne(),c(null),j(!1),Y(!1);try{const Ue={video:Ne?{deviceId:{exact:Ne}}:{facingMode:"environment"}},Be=await navigator.mediaDevices.getUserMedia(Ue);o.current=Be,s.current&&(s.current.srcObject=Be),h(null);const qe=Be.getVideoTracks()[0];if(qe){const te=qe.getCapabilities();J(!!te.torch),Q(qe.getSettings().facingMode)}else J(!1)}catch(Ue){console.error("Error accessing camera:",Ue),h("Could not access camera. Please check permissions.")}},[ne]);D.useEffect(()=>{if(!n){ne();return}let Ne=!1;return(async()=>{try{const Be=await navigator.mediaDevices.getUserMedia({video:!0});if(Ne){Be.getTracks().forEach(le=>le.stop());return}const te=(await navigator.mediaDevices.enumerateDevices()).filter(le=>le.kind==="videoinput");if(Be.getTracks().forEach(le=>le.stop()),Ne)return;if(U(te),te.length>0){let le=W;le>=te.length&&(le=0),await de(te[le].deviceId)}else h("No camera found.")}catch(Be){console.error(Be),h("Could not access camera.")}})(),()=>{Ne=!0,ne()}},[n,W,de,ne]);const ce=()=>{if(s.current&&a.current){const Ne=s.current,Ue=a.current;Ue.width=Ne.videoWidth,Ue.height=Ne.videoHeight,Ue.getContext("2d")?.drawImage(Ne,0,0,Ne.videoWidth,Ne.videoHeight),c(Ue.toDataURL("image/jpeg",.9)),ne()}},pe=()=>{H==="user"&&ee?(oe(!0),setTimeout(()=>{ce(),oe(!1)},100)):ce()},ie=()=>{h(null),c(null),F(null),j(!1),M(1)},xe=async()=>{if(!o.current||!ae)return;const Ne=o.current.getVideoTracks()[0];try{await Ne.applyConstraints({advanced:[{torch:!se}]}),Y(!se)}catch(Ue){console.error("Failed to toggle flash",Ue)}},Ce=D.useCallback((Ne,Ue)=>{I(Ue)},[]),ve=()=>{j(!0),M(1)},Oe=async()=>{try{if(l&&O){const Ne=await MX(l,O);F(Ne),j(!1)}}catch(Ne){console.error(Ne),h("Failed to crop image")}},Pe=()=>{j(!1),M(1),F(null)},Ie=async()=>{const Ne=q||l;if(Ne){x(!0);try{const Ue=Ne.split(",")[1];_("Enhancing photo...");const qe=(r==="document"?await ue.enhanceDocumentPhoto(Ue,"image/jpeg"):null)||Ue;t(qe,"image/jpeg"),e()}catch(Ue){h(Ue.message||"Processing failed.")}finally{x(!1)}}},Fe=()=>{ne(),e()};if(!n)return null;const _e=q||l;return i.jsxs("div",{className:"fixed inset-0 z-[200] flex flex-col bg-black text-white",children:[Z&&i.jsx("div",{className:"absolute inset-0 bg-white z-50"}),p&&i.jsxs("div",{className:"absolute inset-0 z-40 flex flex-col items-center justify-center bg-black/80",children:[i.jsx(wt,{className:"h-12 w-12 animate-spin text-white"}),i.jsx("p",{className:"mt-4 text-lg font-semibold",children:v})]}),i.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 bg-gradient-to-b from-black/70 to-transparent z-30 flex justify-between items-center",children:[i.jsx(re,{variant:"icon",className:"!text-white hover:!bg-white/20 !p-2",onClick:Fe,children:i.jsx(Aa,{className:"h-6 w-6"})}),i.jsx("h3",{className:"text-lg font-bold flex-1 text-center",children:w?"Crop Photo":l?"Preview":"Capture Photo"}),i.jsx("div",{className:"w-10"})]}),i.jsxs("div",{className:"flex-grow relative flex items-center justify-center overflow-hidden bg-black",children:[d&&!l&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white p-4 text-center bg-black/50 z-10",children:d}),w&&l?i.jsx("div",{className:"absolute inset-0",children:i.jsx(kX,{image:l,crop:T,zoom:E,aspect:r==="profile"?1:4/3,onCropChange:P,onCropComplete:Ce,onZoomChange:M,cropShape:r==="profile"?"round":"rect",style:{containerStyle:{backgroundColor:"transparent"},mediaStyle:{objectFit:"contain"}},classes:{containerClassName:"bg-black/30"}})}):i.jsxs(i.Fragment,{children:[i.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,muted:!0,className:`w-full h-full object-cover ${l?"hidden":""}`}),_e&&i.jsx("img",{src:_e,alt:"Preview",className:"w-full h-full object-contain"})]}),i.jsx("canvas",{ref:a,className:"hidden"})]}),i.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent z-30",children:[d&&!l&&i.jsx("div",{className:"mb-2 p-3 bg-red-500/30 text-white text-sm rounded-lg text-center",children:d}),w&&i.jsx("div",{className:"mb-4 px-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(jC,{className:"h-5 w-5 text-white/70"}),i.jsx("input",{type:"range",min:1,max:3,step:.1,value:E,onChange:Ne=>M(Number(Ne.target.value)),className:"flex-1 h-1 bg-white/20 rounded-lg"}),i.jsx(wC,{className:"h-5 w-5 text-white/70"})]})}),i.jsx("div",{className:"flex justify-around items-center",children:w?i.jsxs(i.Fragment,{children:[i.jsx(re,{onClick:Pe,variant:"secondary",size:"lg",className:"!rounded-full !px-6",children:"Cancel"}),i.jsxs(re,{onClick:Oe,size:"lg",className:"!rounded-full !px-6",children:[i.jsx(_l,{className:"h-5 w-5 mr-2"})," Apply"]})]}):l?i.jsxs(i.Fragment,{children:[i.jsx(re,{onClick:ie,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:i.jsx(SS,{className:"h-6 w-6"})}),i.jsx(re,{onClick:ve,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:i.jsx(JK,{className:"h-6 w-6"})}),i.jsx(re,{onClick:Ie,size:"lg",className:"!rounded-full !p-4",children:i.jsx(_l,{className:"h-6 w-6"})})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"w-16 h-16 flex items-center justify-center",children:[H==="environment"&&ae&&i.jsx(re,{onClick:xe,variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3",children:se?i.jsx(wJ,{className:"h-6 w-6"}):i.jsx(CS,{className:"h-6 w-6"})}),H==="user"&&i.jsx(re,{onClick:()=>X(!ee),variant:"icon",className:`!rounded-full !p-3 ${ee?"!text-yellow-400":"!text-white"} hover:!bg-white/20`,children:i.jsx(e3,{className:"h-6 w-6"})})]}),i.jsx(re,{onClick:pe,disabled:!!d||!o.current,size:"lg",className:"!rounded-full !w-20 !h-20",children:i.jsx(xC,{className:"h-8 w-8"})}),i.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:B.length>1&&i.jsx(re,{onClick:()=>$(Ne=>(Ne+1)%B.length),variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3",children:i.jsx(SS,{className:"h-6 w-6"})})})]})})]})]})},DX=({isOpen:n,onClose:e,imageUrl:t})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 p-4",onClick:e,role:"dialog","aria-modal":"true",children:i.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",onClick:r=>r.stopPropagation(),children:[i.jsx("img",{src:t,alt:"Document Preview",className:"max-w-full max-h-full object-contain rounded-lg"}),i.jsx("button",{onClick:e,className:"absolute top-0 right-0 m-2 p-2 bg-black/50 rounded-full text-white hover:bg-black/80 transition-colors","aria-label":"Close image preview",children:i.jsx(gi,{className:"h-6 w-6"})})]})}):null,yt=({label:n,file:e,onFileChange:t,allowedTypes:r=["image/jpeg","image/png","application/pdf"],error:s,allowCapture:a=!1,costingItemName:o,verificationStatus:l,onOcrComplete:c,ocrSchema:d,setToast:h,docType:p,onVerification:x})=>{const[v,_]=D.useState(!1),[w,j]=D.useState(""),[T,P]=D.useState(!1),[E,M]=D.useState(!1),{logVerificationUsage:O}=$n.getState(),I=D.useMemo(()=>{const Y=n.toLowerCase();return Y.includes("photo")?"profile":["proof","document","card","slip","passbook","cheque","certificate"].some(ae=>Y.includes(ae))?"document":"none"},[n]),q=D.useCallback(async Y=>{if(!r.includes(Y.type)){j(`Invalid file type. Allowed: ${r.join(", ")}.`);return}if(Y.size>5*1024*1024){j("File size must be less than 5MB.");return}j(""),_(!0);const ae=URL.createObjectURL(Y);let J={name:Y.name,type:Y.type,size:Y.size,preview:ae,file:Y};t(J),o&&O(o);try{const ee=new FileReader;ee.readAsDataURL(Y),ee.onloadend=async()=>{try{const X=ee.result.split(",")[1];if(x){const Z=await x(X,Y.type);if(!Z.success){j(Z.reason),_(!1);return}}if(c&&d&&h)try{const Z=await ue.extractDataFromImage(X,Y.type,d,p);c(Z)}catch(Z){console.error("OCR failed:",Z),h({message:"AI extraction failed. Please check the document.",type:"error"})}}catch(X){j(X.message||"Processing failed.")}finally{_(!1)}},ee.onerror=()=>{throw new Error("Could not read file for processing.")}}catch(ee){j(ee.message||"Processing failed."),_(!1)}},[r,t,o,O,c,d,h,p,x]),F=D.useCallback(async(Y,ae)=>{const J=await(await fetch(`data:${ae};base64,${Y}`)).blob(),ee=new File([J],`capture-${Date.now()}.jpg`,{type:ae});q(ee)},[q]),B=()=>{e&&URL.revokeObjectURL(e.preview),t(null),j("")},U=`file-upload-${n.replace(/\s+/g,"-")}`,W=s||w,se=(Y=>{const ae=Y.toLowerCase();return ae.includes("profile photo")?Tl:ae.includes("id proof")||ae.includes("aadhaar")||ae.includes("pan")||ae.includes("voter")?zF:ae.includes("bank proof")?Sl:ae.includes("signature")?wS:ae.includes("fingerprint")?VF:ae.includes("certificate")?BF:os})(n);return i.jsxs("div",{className:"w-full",children:[i.jsx(DX,{isOpen:E,onClose:()=>M(!1),imageUrl:e?.preview||""}),T&&i.jsx(L3,{isOpen:T,onClose:()=>P(!1),onCapture:F,captureGuidance:I}),i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("label",{className:"block text-sm font-medium text-muted",htmlFor:U,children:n}),l===!0&&i.jsx("span",{title:"Verified",children:i.jsx(Hi,{className:"h-4 w-4 text-green-400"})}),l===!1&&i.jsx("span",{title:"Verification Failed",children:i.jsx(lm,{className:"h-4 w-4 text-red-400"})})]}),i.jsx("div",{className:"w-full text-center transition-all duration-300",children:e?i.jsxs("div",{className:"w-full flex flex-col h-full bg-page p-2 border border-border rounded-lg relative pro-dark-theme:bg-[#0d2c18] pro-dark-theme:border-[#123820]",children:[i.jsxs("div",{className:"flex-grow w-full rounded-md overflow-hidden group relative bg-black/10 flex items-center justify-center min-h-[100px]",children:[v?i.jsxs("div",{className:"flex flex-col items-center text-muted",children:[i.jsx(wt,{className:"h-8 w-8 animate-spin"}),i.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):e.type.startsWith("image/")?i.jsx("img",{src:e.preview,alt:"preview",className:"max-w-full max-h-28 object-contain"}):i.jsxs("div",{className:"text-muted p-2",children:[i.jsx(nJ,{className:"h-10 w-10 mx-auto"}),i.jsx("span",{className:"text-xs mt-1 block break-all",children:e.name})]}),i.jsx("label",{htmlFor:U,className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-md cursor-pointer",children:i.jsx(SS,{className:"h-6 w-6 text-white"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 flex-shrink-0",children:[e.type.startsWith("image/")&&i.jsxs("button",{type:"button",onClick:()=>M(!0),className:"text-xs font-medium text-accent hover:underline flex items-center gap-1 p-1",children:[i.jsx(Nl,{className:"h-3 w-3"})," View"]}),i.jsxs("button",{type:"button",onClick:B,className:"text-xs font-medium text-red-500 hover:underline flex items-center gap-1 p-1",children:[i.jsx(rn,{className:"h-3 w-3"})," Remove"]})]})]}):i.jsxs("label",{htmlFor:U,className:`
                        cursor-pointer flex flex-col items-center justify-center
                        p-6 border-2 border-dashed rounded-lg transition-colors
                        border-border hover:border-accent hover:bg-accent-light
                        pro-dark-theme:border-gray-600 pro-dark-theme:hover:border-accent pro-dark-theme:hover:bg-accent-light
                        ${W?"!border-red-500":""}
                    `,children:[i.jsx("div",{className:"p-3 bg-accent-light rounded-full text-accent-dark pro-dark-theme:bg-accent/20 pro-dark-theme:text-accent",children:i.jsx(se,{className:"h-8 w-8"})}),i.jsx("p",{className:"font-semibold text-primary-text mt-2",children:"Click to upload"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:"or drag & drop"}),a&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-xs text-muted my-2",children:"OR"}),i.jsxs(re,{type:"button",onClick:Y=>{Y.preventDefault(),P(!0)},variant:"secondary",size:"sm",children:[i.jsx(xC,{className:"h-4 w-4 mr-2"}),"Capture with Camera"]})]})]})}),i.jsx("input",{id:U,type:"file",className:"sr-only",onChange:Y=>Y.target.files?.[0]&&q(Y.target.files[0]),accept:r.join(",")}),i.jsx("div",{className:"text-center mt-1 min-h-[16px]",children:W&&i.jsx("p",{className:"text-xs text-red-500",children:W})})]})};var Nb={},vh={},Sb={exports:{}},Cb,lD;function EX(){if(lD)return Cb;lD=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Cb=n,Cb}var Tb,cD;function OX(){if(cD)return Tb;cD=1;var n=EX();function e(){}function t(){}return t.resetWarningCache=e,Tb=function(){function r(o,l,c,d,h,p){if(p!==n){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}r.isRequired=r;function s(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:t,resetWarningCache:e};return a.PropTypes=a,a},Tb}var dD;function Pl(){return dD||(dD=1,Sb.exports=OX()()),Sb.exports}var bh={},zd={},kb={exports:{}};var uD;function vu(){return uD||(uD=1,(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var a="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(a=s(a,r(l)))}return a}function r(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return t.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var o="";for(var l in a)e.call(a,l)&&a[l]&&(o=s(o,l));return o}function s(a,o){return o?a?a+" "+o:a+o:a}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(kb)),kb.exports}var Pb={},Mb={},Db={},Eb={},fD;function Re(){if(fD)return Eb;fD=1,Eb.toDate=n;function n(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}return Eb}var Ob={},hD;function un(){if(hD)return Ob;hD=1,Ob.constructFrom=n;function n(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}return Ob}var mD;function Ml(){if(mD)return Db;mD=1,Db.addDays=t;var n=Re(),e=un();function t(r,s){const a=(0,n.toDate)(r);return isNaN(s)?(0,e.constructFrom)(r,NaN):(s&&a.setDate(a.getDate()+s),a)}return Db}var Ib={},pD;function Tm(){if(pD)return Ib;pD=1,Ib.addMonths=t;var n=Re(),e=un();function t(r,s){const a=(0,n.toDate)(r);if(isNaN(s))return(0,e.constructFrom)(r,NaN);if(!s)return a;const o=a.getDate(),l=(0,e.constructFrom)(r,a.getTime());l.setMonth(a.getMonth()+s+1,0);const c=l.getDate();return o>=c?l:(a.setFullYear(l.getFullYear(),l.getMonth(),o),a)}return Ib}var gD;function F3(){if(gD)return Mb;gD=1,Mb.add=s;var n=Ml(),e=Tm(),t=un(),r=Re();function s(a,o){const{years:l=0,months:c=0,weeks:d=0,days:h=0,hours:p=0,minutes:x=0,seconds:v=0}=o,_=(0,r.toDate)(a),w=c||l?(0,e.addMonths)(_,c+l*12):_,j=h||d?(0,n.addDays)(w,h+d*7):w,T=x+p*60,E=(v+T*60)*1e3;return(0,t.constructFrom)(a,j.getTime()+E)}return Mb}var Ab={},Rb={},xD;function q3(){if(xD)return Rb;xD=1,Rb.isSaturday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===6}return Rb}var Lb={},yD;function z3(){if(yD)return Lb;yD=1,Lb.isSunday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===0}return Lb}var Fb={},vD;function oy(){if(vD)return Fb;vD=1,Fb.isWeekend=e;var n=Re();function e(t){const r=(0,n.toDate)(t).getDay();return r===0||r===6}return Fb}var bD;function U3(){if(bD)return Ab;bD=1,Ab.addBusinessDays=a;var n=un(),e=q3(),t=z3(),r=oy(),s=Re();function a(o,l){const c=(0,s.toDate)(o),d=(0,r.isWeekend)(c);if(isNaN(l))return(0,n.constructFrom)(o,NaN);const h=c.getHours(),p=l<0?-1:1,x=Math.trunc(l/5);c.setDate(c.getDate()+x*7);let v=Math.abs(l%5);for(;v>0;)c.setDate(c.getDate()+p),(0,r.isWeekend)(c)||(v-=1);return d&&(0,r.isWeekend)(c)&&l!==0&&((0,e.isSaturday)(c)&&c.setDate(c.getDate()+(p<0?2:-1)),(0,t.isSunday)(c)&&c.setDate(c.getDate()+(p<0?1:-2))),c.setHours(h),c}return Ab}var qb={},zb={},_D;function km(){if(_D)return zb;_D=1,zb.addMilliseconds=t;var n=Re(),e=un();function t(r,s){const a=+(0,n.toDate)(r);return(0,e.constructFrom)(r,a+s)}return zb}var Ot={},wD;function Qt(){if(wD)return Ot;wD=1,Ot.secondsInYear=Ot.secondsInWeek=Ot.secondsInQuarter=Ot.secondsInMonth=Ot.secondsInMinute=Ot.secondsInHour=Ot.secondsInDay=Ot.quartersInYear=Ot.monthsInYear=Ot.monthsInQuarter=Ot.minutesInYear=Ot.minutesInMonth=Ot.minutesInHour=Ot.minutesInDay=Ot.minTime=Ot.millisecondsInWeek=Ot.millisecondsInSecond=Ot.millisecondsInMinute=Ot.millisecondsInHour=Ot.millisecondsInDay=Ot.maxTime=Ot.daysInYear=Ot.daysInWeek=void 0,Ot.daysInWeek=7;const n=Ot.daysInYear=365.2425,e=Ot.maxTime=Math.pow(10,8)*24*60*60*1e3;Ot.minTime=-e,Ot.millisecondsInWeek=6048e5,Ot.millisecondsInDay=864e5,Ot.millisecondsInMinute=6e4,Ot.millisecondsInHour=36e5,Ot.millisecondsInSecond=1e3,Ot.minutesInYear=525600,Ot.minutesInMonth=43200,Ot.minutesInDay=1440,Ot.minutesInHour=60,Ot.monthsInQuarter=3,Ot.monthsInYear=12,Ot.quartersInYear=4;const t=Ot.secondsInHour=3600;Ot.secondsInMinute=60;const r=Ot.secondsInDay=t*24;Ot.secondsInWeek=r*7;const s=Ot.secondsInYear=r*n,a=Ot.secondsInMonth=s/12;return Ot.secondsInQuarter=a*3,Ot}var jD;function OC(){if(jD)return qb;jD=1,qb.addHours=t;var n=km(),e=Qt();function t(r,s){return(0,n.addMilliseconds)(r,s*e.millisecondsInHour)}return qb}var Ub={},Vb={},Bb={},Wb={},Up={},ND;function Ss(){if(ND)return Up;ND=1,Up.getDefaultOptions=e,Up.setDefaultOptions=t;let n={};function e(){return n}function t(r){n=r}return Up}var SD;function To(){if(SD)return Wb;SD=1,Wb.startOfWeek=t;var n=Re(),e=Ss();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?7:0)+c-o;return l.setDate(l.getDate()-d),l.setHours(0,0,0,0),l}return Wb}var CD;function Dl(){if(CD)return Bb;CD=1,Bb.startOfISOWeek=e;var n=To();function e(t){return(0,n.startOfWeek)(t,{weekStartsOn:1})}return Bb}var TD;function bu(){if(TD)return Vb;TD=1,Vb.getISOWeekYear=r;var n=un(),e=Dl(),t=Re();function r(s){const a=(0,t.toDate)(s),o=a.getFullYear(),l=(0,n.constructFrom)(s,0);l.setFullYear(o+1,0,4),l.setHours(0,0,0,0);const c=(0,e.startOfISOWeek)(l),d=(0,n.constructFrom)(s,0);d.setFullYear(o,0,4),d.setHours(0,0,0,0);const h=(0,e.startOfISOWeek)(d);return a.getTime()>=c.getTime()?o+1:a.getTime()>=h.getTime()?o:o-1}return Vb}var $b={},Hb={},Yb={},kD;function ly(){if(kD)return Yb;kD=1,Yb.startOfDay=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setHours(0,0,0,0),r}return Yb}var Gb={},PD;function Qc(){if(PD)return Gb;PD=1,Gb.getTimezoneOffsetInMilliseconds=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+t-+s}return Gb}var MD;function Xc(){if(MD)return Hb;MD=1,Hb.differenceInCalendarDays=r;var n=Qt(),e=ly(),t=Qc();function r(s,a){const o=(0,e.startOfDay)(s),l=(0,e.startOfDay)(a),c=+o-(0,t.getTimezoneOffsetInMilliseconds)(o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l);return Math.round((c-d)/n.millisecondsInDay)}return Hb}var Zb={},DD;function Pm(){if(DD)return Zb;DD=1,Zb.startOfISOWeekYear=r;var n=bu(),e=Dl(),t=un();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);return o.setFullYear(a,0,4),o.setHours(0,0,0,0),(0,e.startOfISOWeek)(o)}return Zb}var ED;function V3(){if(ED)return $b;ED=1,$b.setISOWeekYear=s;var n=un(),e=Xc(),t=Pm(),r=Re();function s(a,o){let l=(0,r.toDate)(a);const c=(0,e.differenceInCalendarDays)(l,(0,t.startOfISOWeekYear)(l)),d=(0,n.constructFrom)(a,0);return d.setFullYear(o,0,4),d.setHours(0,0,0,0),l=(0,t.startOfISOWeekYear)(d),l.setDate(l.getDate()+c),l}return $b}var OD;function B3(){if(OD)return Ub;OD=1,Ub.addISOWeekYears=t;var n=bu(),e=V3();function t(r,s){return(0,e.setISOWeekYear)(r,(0,n.getISOWeekYear)(r)+s)}return Ub}var Kb={},ID;function IC(){if(ID)return Kb;ID=1,Kb.addMinutes=t;var n=km(),e=Qt();function t(r,s){return(0,n.addMilliseconds)(r,s*e.millisecondsInMinute)}return Kb}var Jb={},AD;function AC(){if(AD)return Jb;AD=1,Jb.addQuarters=e;var n=Tm();function e(t,r){const s=r*3;return(0,n.addMonths)(t,s)}return Jb}var Qb={},RD;function W3(){if(RD)return Qb;RD=1,Qb.addSeconds=e;var n=km();function e(t,r){return(0,n.addMilliseconds)(t,r*1e3)}return Qb}var Xb={},LD;function cy(){if(LD)return Xb;LD=1,Xb.addWeeks=e;var n=Ml();function e(t,r){const s=r*7;return(0,n.addDays)(t,s)}return Xb}var e0={},FD;function $3(){if(FD)return e0;FD=1,e0.addYears=e;var n=Tm();function e(t,r){return(0,n.addMonths)(t,r*12)}return e0}var t0={},qD;function IX(){if(qD)return t0;qD=1,t0.areIntervalsOverlapping=e;var n=Re();function e(t,r,s){const[a,o]=[+(0,n.toDate)(t.start),+(0,n.toDate)(t.end)].sort((d,h)=>d-h),[l,c]=[+(0,n.toDate)(r.start),+(0,n.toDate)(r.end)].sort((d,h)=>d-h);return s?.inclusive?a<=c&&l<=o:a<c&&l<o}return t0}var n0={},r0={},zD;function H3(){if(zD)return r0;zD=1,r0.max=e;var n=Re();function e(t){let r;return t.forEach(function(s){const a=(0,n.toDate)(s);(r===void 0||r<a||isNaN(Number(a)))&&(r=a)}),r||new Date(NaN)}return r0}var s0={},UD;function Y3(){if(UD)return s0;UD=1,s0.min=e;var n=Re();function e(t){let r;return t.forEach(s=>{const a=(0,n.toDate)(s);(!r||r>a||isNaN(+a))&&(r=a)}),r||new Date(NaN)}return s0}var VD;function AX(){if(VD)return n0;VD=1,n0.clamp=t;var n=H3(),e=Y3();function t(r,s){return(0,e.min)([(0,n.max)([r,s.start]),s.end])}return n0}var i0={},BD;function RX(){if(BD)return i0;BD=1,i0.closestIndexTo=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);if(isNaN(Number(s)))return NaN;const a=s.getTime();let o,l;return r.forEach(function(c,d){const h=(0,n.toDate)(c);if(isNaN(Number(h))){o=NaN,l=NaN;return}const p=Math.abs(a-h.getTime());(o==null||p<l)&&(o=d,l=p)}),o}return i0}var a0={},WD;function LX(){if(WD)return a0;WD=1,a0.closestTo=t;var n=un(),e=Re();function t(r,s){const a=(0,e.toDate)(r);if(isNaN(Number(a)))return(0,n.constructFrom)(r,NaN);const o=a.getTime();let l,c;return s.forEach(d=>{const h=(0,e.toDate)(d);if(isNaN(Number(h))){l=(0,n.constructFrom)(r,NaN),c=NaN;return}const p=Math.abs(o-h.getTime());(l==null||p<c)&&(l=h,c=p)}),l}return a0}var o0={},$D;function zf(){if($D)return o0;$D=1,o0.compareAsc=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getTime()-a.getTime();return o<0?-1:o>0?1:o}return o0}var l0={},HD;function FX(){if(HD)return l0;HD=1,l0.compareDesc=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getTime()-a.getTime();return o>0?-1:o<0?1:o}return l0}var c0={},YD;function Gs(){if(YD)return c0;YD=1,c0.constructNow=e;var n=un();function e(t){return(0,n.constructFrom)(t,Date.now())}return c0}var d0={},GD;function qX(){if(GD)return d0;GD=1,d0.daysToWeeks=e;var n=Qt();function e(t){const r=t/n.daysInWeek,s=Math.trunc(r);return s===0?0:s}return d0}var u0={},f0={},ZD;function Mm(){if(ZD)return f0;ZD=1,f0.isSameDay=e;var n=ly();function e(t,r){const s=(0,n.startOfDay)(t),a=(0,n.startOfDay)(r);return+s==+a}return f0}var h0={},m0={},KD;function G3(){if(KD)return m0;KD=1,m0.isDate=n;function n(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}return m0}var JD;function ed(){if(JD)return h0;JD=1,h0.isValid=t;var n=G3(),e=Re();function t(r){if(!(0,n.isDate)(r)&&typeof r!="number")return!1;const s=(0,e.toDate)(r);return!isNaN(Number(s))}return h0}var QD;function zX(){if(QD)return u0;QD=1,u0.differenceInBusinessDays=o;var n=Ml(),e=Xc(),t=Mm(),r=ed(),s=oy(),a=Re();function o(l,c){const d=(0,a.toDate)(l);let h=(0,a.toDate)(c);if(!(0,r.isValid)(d)||!(0,r.isValid)(h))return NaN;const p=(0,e.differenceInCalendarDays)(d,h),x=p<0?-1:1,v=Math.trunc(p/7);let _=v*5;for(h=(0,n.addDays)(h,v*7);!(0,t.isSameDay)(d,h);)_+=(0,s.isWeekend)(h)?0:x,h=(0,n.addDays)(h,x);return _===0?0:_}return u0}var p0={},XD;function Z3(){if(XD)return p0;XD=1,p0.differenceInCalendarISOWeekYears=e;var n=bu();function e(t,r){return(0,n.getISOWeekYear)(t)-(0,n.getISOWeekYear)(r)}return p0}var g0={},eE;function UX(){if(eE)return g0;eE=1,g0.differenceInCalendarISOWeeks=r;var n=Qt(),e=Dl(),t=Qc();function r(s,a){const o=(0,e.startOfISOWeek)(s),l=(0,e.startOfISOWeek)(a),c=+o-(0,t.getTimezoneOffsetInMilliseconds)(o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l);return Math.round((c-d)/n.millisecondsInWeek)}return g0}var x0={},tE;function RC(){if(tE)return x0;tE=1,x0.differenceInCalendarMonths=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getFullYear()-a.getFullYear(),l=s.getMonth()-a.getMonth();return o*12+l}return x0}var y0={},v0={},nE;function K3(){if(nE)return v0;nE=1,v0.getQuarter=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return Math.trunc(r.getMonth()/3)+1}return v0}var rE;function J3(){if(rE)return y0;rE=1,y0.differenceInCalendarQuarters=t;var n=K3(),e=Re();function t(r,s){const a=(0,e.toDate)(r),o=(0,e.toDate)(s),l=a.getFullYear()-o.getFullYear(),c=(0,n.getQuarter)(a)-(0,n.getQuarter)(o);return l*4+c}return y0}var b0={},sE;function LC(){if(sE)return b0;sE=1,b0.differenceInCalendarWeeks=r;var n=Qt(),e=To(),t=Qc();function r(s,a,o){const l=(0,e.startOfWeek)(s,o),c=(0,e.startOfWeek)(a,o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l),h=+c-(0,t.getTimezoneOffsetInMilliseconds)(c);return Math.round((d-h)/n.millisecondsInWeek)}return b0}var _0={},iE;function FC(){if(iE)return _0;iE=1,_0.differenceInCalendarYears=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()-a.getFullYear()}return _0}var w0={},aE;function qC(){if(aE)return w0;aE=1,w0.differenceInDays=t;var n=Xc(),e=Re();function t(s,a){const o=(0,e.toDate)(s),l=(0,e.toDate)(a),c=r(o,l),d=Math.abs((0,n.differenceInCalendarDays)(o,l));o.setDate(o.getDate()-c*d);const h=+(r(o,l)===-c),p=c*(d-h);return p===0?0:p}function r(s,a){const o=s.getFullYear()-a.getFullYear()||s.getMonth()-a.getMonth()||s.getDate()-a.getDate()||s.getHours()-a.getHours()||s.getMinutes()-a.getMinutes()||s.getSeconds()-a.getSeconds()||s.getMilliseconds()-a.getMilliseconds();return o<0?-1:o>0?1:o}return w0}var j0={},N0={},oE;function td(){if(oE)return N0;oE=1,N0.getRoundingMethod=n;function n(e){return t=>{const s=(e?Math[e]:Math.trunc)(t);return s===0?0:s}}return N0}var S0={},lE;function dy(){if(lE)return S0;lE=1,S0.differenceInMilliseconds=e;var n=Re();function e(t,r){return+(0,n.toDate)(t)-+(0,n.toDate)(r)}return S0}var cE;function zC(){if(cE)return j0;cE=1,j0.differenceInHours=r;var n=td(),e=Qt(),t=dy();function r(s,a,o){const l=(0,t.differenceInMilliseconds)(s,a)/e.millisecondsInHour;return(0,n.getRoundingMethod)(o?.roundingMethod)(l)}return j0}var C0={},T0={},dE;function Q3(){if(dE)return T0;dE=1,T0.subISOWeekYears=e;var n=B3();function e(t,r){return(0,n.addISOWeekYears)(t,-r)}return T0}var uE;function VX(){if(uE)return C0;uE=1,C0.differenceInISOWeekYears=s;var n=zf(),e=Z3(),t=Q3(),r=Re();function s(a,o){let l=(0,r.toDate)(a);const c=(0,r.toDate)(o),d=(0,n.compareAsc)(l,c),h=Math.abs((0,e.differenceInCalendarISOWeekYears)(l,c));l=(0,t.subISOWeekYears)(l,d*h);const p=+((0,n.compareAsc)(l,c)===-d),x=d*(h-p);return x===0?0:x}return C0}var k0={},fE;function UC(){if(fE)return k0;fE=1,k0.differenceInMinutes=r;var n=td(),e=Qt(),t=dy();function r(s,a,o){const l=(0,t.differenceInMilliseconds)(s,a)/e.millisecondsInMinute;return(0,n.getRoundingMethod)(o?.roundingMethod)(l)}return k0}var P0={},M0={},D0={},hE;function VC(){if(hE)return D0;hE=1,D0.endOfDay=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setHours(23,59,59,999),r}return D0}var E0={},mE;function BC(){if(mE)return E0;mE=1,E0.endOfMonth=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(23,59,59,999),r}return E0}var pE;function X3(){if(pE)return M0;pE=1,M0.isLastDayOfMonth=r;var n=VC(),e=BC(),t=Re();function r(s){const a=(0,t.toDate)(s);return+(0,n.endOfDay)(a)==+(0,e.endOfMonth)(a)}return M0}var gE;function uy(){if(gE)return P0;gE=1,P0.differenceInMonths=s;var n=zf(),e=RC(),t=X3(),r=Re();function s(a,o){const l=(0,r.toDate)(a),c=(0,r.toDate)(o),d=(0,n.compareAsc)(l,c),h=Math.abs((0,e.differenceInCalendarMonths)(l,c));let p;if(h<1)p=0;else{l.getMonth()===1&&l.getDate()>27&&l.setDate(30),l.setMonth(l.getMonth()-d*h);let x=(0,n.compareAsc)(l,c)===-d;(0,t.isLastDayOfMonth)((0,r.toDate)(a))&&h===1&&(0,n.compareAsc)(a,c)===1&&(x=!1),p=d*(h-Number(x))}return p===0?0:p}return P0}var O0={},xE;function BX(){if(xE)return O0;xE=1,O0.differenceInQuarters=t;var n=td(),e=uy();function t(r,s,a){const o=(0,e.differenceInMonths)(r,s)/3;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return O0}var I0={},yE;function fy(){if(yE)return I0;yE=1,I0.differenceInSeconds=t;var n=td(),e=dy();function t(r,s,a){const o=(0,e.differenceInMilliseconds)(r,s)/1e3;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return I0}var A0={},vE;function WX(){if(vE)return A0;vE=1,A0.differenceInWeeks=t;var n=td(),e=qC();function t(r,s,a){const o=(0,e.differenceInDays)(r,s)/7;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return A0}var R0={},bE;function e5(){if(bE)return R0;bE=1,R0.differenceInYears=r;var n=zf(),e=FC(),t=Re();function r(s,a){const o=(0,t.toDate)(s),l=(0,t.toDate)(a),c=(0,n.compareAsc)(o,l),d=Math.abs((0,e.differenceInCalendarYears)(o,l));o.setFullYear(1584),l.setFullYear(1584);const h=(0,n.compareAsc)(o,l)===-c,p=c*(d-+h);return p===0?0:p}return R0}var L0={},_E;function t5(){if(_E)return L0;_E=1,L0.eachDayOfInterval=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setDate(c.getDate()+d),c.setHours(0,0,0,0);return o?h.reverse():h}return L0}var F0={},wE;function $X(){if(wE)return F0;wE=1,F0.eachHourOfInterval=t;var n=OC(),e=Re();function t(r,s){const a=(0,e.toDate)(r.start),o=(0,e.toDate)(r.end);let l=+a>+o;const c=l?+a:+o;let d=l?o:a;d.setMinutes(0,0,0);let h=s?.step??1;if(!h)return[];h<0&&(h=-h,l=!l);const p=[];for(;+d<=c;)p.push((0,e.toDate)(d)),d=(0,n.addHours)(d,h);return l?p.reverse():p}return F0}var q0={},z0={},jE;function WC(){if(jE)return z0;jE=1,z0.startOfMinute=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setSeconds(0,0),r}return z0}var NE;function HX(){if(NE)return q0;NE=1,q0.eachMinuteOfInterval=r;var n=IC(),e=WC(),t=Re();function r(s,a){const o=(0,e.startOfMinute)((0,t.toDate)(s.start)),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?+o:+l;let h=c?l:o,p=a?.step??1;if(!p)return[];p<0&&(p=-p,c=!c);const x=[];for(;+h<=d;)x.push((0,t.toDate)(h)),h=(0,n.addMinutes)(h,p);return c?x.reverse():x}return q0}var U0={},SE;function YX(){if(SE)return U0;SE=1,U0.eachMonthOfInterval=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0),c.setDate(1);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setMonth(c.getMonth()+d);return o?h.reverse():h}return U0}var V0={},B0={},CE;function $C(){if(CE)return B0;CE=1,B0.startOfQuarter=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3;return r.setMonth(a,1),r.setHours(0,0,0,0),r}return B0}var TE;function GX(){if(TE)return V0;TE=1,V0.eachQuarterOfInterval=r;var n=AC(),e=$C(),t=Re();function r(s,a){const o=(0,t.toDate)(s.start),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?+(0,e.startOfQuarter)(o):+(0,e.startOfQuarter)(l);let h=c?(0,e.startOfQuarter)(l):(0,e.startOfQuarter)(o),p=a?.step??1;if(!p)return[];p<0&&(p=-p,c=!c);const x=[];for(;+h<=d;)x.push((0,t.toDate)(h)),h=(0,n.addQuarters)(h,p);return c?x.reverse():x}return V0}var W0={},kE;function ZX(){if(kE)return W0;kE=1,W0.eachWeekOfInterval=r;var n=cy(),e=To(),t=Re();function r(s,a){const o=(0,t.toDate)(s.start),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?(0,e.startOfWeek)(l,a):(0,e.startOfWeek)(o,a),h=c?(0,e.startOfWeek)(o,a):(0,e.startOfWeek)(l,a);d.setHours(15),h.setHours(15);const p=+h.getTime();let x=d,v=a?.step??1;if(!v)return[];v<0&&(v=-v,c=!c);const _=[];for(;+x<=p;)x.setHours(0),_.push((0,t.toDate)(x)),x=(0,n.addWeeks)(x,v),x.setHours(15);return c?_.reverse():_}return W0}var $0={},PE;function HC(){if(PE)return $0;PE=1,$0.eachWeekendOfInterval=t;var n=t5(),e=oy();function t(r){const s=(0,n.eachDayOfInterval)(r),a=[];let o=0;for(;o<s.length;){const l=s[o++];(0,e.isWeekend)(l)&&a.push(l)}return a}return $0}var H0={},Y0={},ME;function hy(){if(ME)return Y0;ME=1,Y0.startOfMonth=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setDate(1),r.setHours(0,0,0,0),r}return Y0}var DE;function KX(){if(DE)return H0;DE=1,H0.eachWeekendOfMonth=r;var n=HC(),e=BC(),t=hy();function r(s){const a=(0,t.startOfMonth)(s),o=(0,e.endOfMonth)(s);return(0,n.eachWeekendOfInterval)({start:a,end:o})}return H0}var G0={},Z0={},EE;function n5(){if(EE)return Z0;EE=1,Z0.endOfYear=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(23,59,59,999),r}return Z0}var K0={},OE;function YC(){if(OE)return K0;OE=1,K0.startOfYear=t;var n=Re(),e=un();function t(r){const s=(0,n.toDate)(r),a=(0,e.constructFrom)(r,0);return a.setFullYear(s.getFullYear(),0,1),a.setHours(0,0,0,0),a}return K0}var IE;function JX(){if(IE)return G0;IE=1,G0.eachWeekendOfYear=r;var n=HC(),e=n5(),t=YC();function r(s){const a=(0,t.startOfYear)(s),o=(0,e.endOfYear)(s);return(0,n.eachWeekendOfInterval)({start:a,end:o})}return G0}var J0={},AE;function QX(){if(AE)return J0;AE=1,J0.eachYearOfInterval=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0),c.setMonth(0,1);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setFullYear(c.getFullYear()+d);return o?h.reverse():h}return J0}var Q0={},RE;function XX(){if(RE)return Q0;RE=1,Q0.endOfDecade=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=9+Math.floor(s/10)*10;return r.setFullYear(a,11,31),r.setHours(23,59,59,999),r}return Q0}var X0={},LE;function eee(){if(LE)return X0;LE=1,X0.endOfHour=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setMinutes(59,59,999),r}return X0}var e_={},t_={},FE;function r5(){if(FE)return t_;FE=1,t_.endOfWeek=t;var n=Re(),e=Ss();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?-7:0)+6-(c-o);return l.setDate(l.getDate()+d),l.setHours(23,59,59,999),l}return t_}var qE;function tee(){if(qE)return e_;qE=1,e_.endOfISOWeek=e;var n=r5();function e(t){return(0,n.endOfWeek)(t,{weekStartsOn:1})}return e_}var n_={},zE;function nee(){if(zE)return n_;zE=1,n_.endOfISOWeekYear=r;var n=bu(),e=Dl(),t=un();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const l=(0,e.startOfISOWeek)(o);return l.setMilliseconds(l.getMilliseconds()-1),l}return n_}var r_={},UE;function ree(){if(UE)return r_;UE=1,r_.endOfMinute=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setSeconds(59,999),r}return r_}var s_={},VE;function see(){if(VE)return s_;VE=1,s_.endOfQuarter=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3+3;return r.setMonth(a,0),r.setHours(23,59,59,999),r}return s_}var i_={},BE;function iee(){if(BE)return i_;BE=1,i_.endOfSecond=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setMilliseconds(999),r}return i_}var a_={},WE;function aee(){if(WE)return a_;WE=1,a_.endOfToday=e;var n=VC();function e(){return(0,n.endOfDay)(Date.now())}return a_}var o_={},$E;function oee(){if($E)return o_;$E=1,o_.endOfTomorrow=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s+1),a.setHours(23,59,59,999),a}return o_}var l_={},HE;function lee(){if(HE)return l_;HE=1,l_.endOfYesterday=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s-1),a.setHours(23,59,59,999),a}return l_}var c_={},d_={},Vp={},Bp={},YE;function cee(){if(YE)return Bp;YE=1,Bp.formatDistance=void 0;const n={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},e=(t,r,s)=>{let a;const o=n[t];return typeof o=="string"?a=o:r===1?a=o.one:a=o.other.replace("{{count}}",r.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};return Bp.formatDistance=e,Bp}var Wp={},u_={},GE;function dee(){if(GE)return u_;GE=1,u_.buildFormatLongFn=n;function n(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}return u_}var ZE;function uee(){if(ZE)return Wp;ZE=1,Wp.formatLong=void 0;var n=dee();const e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},t={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},r={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"};return Wp.formatLong={date:(0,n.buildFormatLongFn)({formats:e,defaultWidth:"full"}),time:(0,n.buildFormatLongFn)({formats:t,defaultWidth:"full"}),dateTime:(0,n.buildFormatLongFn)({formats:r,defaultWidth:"full"})},Wp}var $p={},KE;function fee(){if(KE)return $p;KE=1,$p.formatRelative=void 0;const n={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},e=(t,r,s,a)=>n[t];return $p.formatRelative=e,$p}var Hp={},f_={},JE;function hee(){if(JE)return f_;JE=1,f_.buildLocalizeFn=n;function n(e){return(t,r)=>{const s=r?.context?String(r.context):"standalone";let a;if(s==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=r?.width?String(r.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=r?.width?String(r.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(t):t;return a[o]}}return f_}var QE;function mee(){if(QE)return Hp;QE=1,Hp.localize=void 0;var n=hee();const e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},t={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},r={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},s={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},a={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},o={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},l=(c,d)=>{const h=Number(c),p=h%100;if(p>20||p<10)switch(p%10){case 1:return h+"st";case 2:return h+"nd";case 3:return h+"rd"}return h+"th"};return Hp.localize={ordinalNumber:l,era:(0,n.buildLocalizeFn)({values:e,defaultWidth:"wide"}),quarter:(0,n.buildLocalizeFn)({values:t,defaultWidth:"wide",argumentCallback:c=>c-1}),month:(0,n.buildLocalizeFn)({values:r,defaultWidth:"wide"}),day:(0,n.buildLocalizeFn)({values:s,defaultWidth:"wide"}),dayPeriod:(0,n.buildLocalizeFn)({values:a,defaultWidth:"wide",formattingValues:o,defaultFormattingWidth:"wide"})},Hp}var Yp={},h_={},XE;function pee(){if(XE)return h_;XE=1,h_.buildMatchFn=n;function n(r){return(s,a={})=>{const o=a.width,l=o&&r.matchPatterns[o]||r.matchPatterns[r.defaultMatchWidth],c=s.match(l);if(!c)return null;const d=c[0],h=o&&r.parsePatterns[o]||r.parsePatterns[r.defaultParseWidth],p=Array.isArray(h)?t(h,_=>_.test(d)):e(h,_=>_.test(d));let x;x=r.valueCallback?r.valueCallback(p):p,x=a.valueCallback?a.valueCallback(x):x;const v=s.slice(d.length);return{value:x,rest:v}}}function e(r,s){for(const a in r)if(Object.prototype.hasOwnProperty.call(r,a)&&s(r[a]))return a}function t(r,s){for(let a=0;a<r.length;a++)if(s(r[a]))return a}return h_}var m_={},e2;function gee(){if(e2)return m_;e2=1,m_.buildMatchPatternFn=n;function n(e){return(t,r={})=>{const s=t.match(e.matchPattern);if(!s)return null;const a=s[0],o=t.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=r.valueCallback?r.valueCallback(l):l;const c=t.slice(a.length);return{value:l,rest:c}}}return m_}var t2;function xee(){if(t2)return Yp;t2=1,Yp.match=void 0;var n=pee(),e=gee();const t=/^(\d+)(th|st|nd|rd)?/i,r=/\d+/i,s={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},a={any:[/^b/i,/^(a|c)/i]},o={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},l={any:[/1/i,/2/i,/3/i,/4/i]},c={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},d={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},h={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},p={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},x={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},v={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}};return Yp.match={ordinalNumber:(0,e.buildMatchPatternFn)({matchPattern:t,parsePattern:r,valueCallback:_=>parseInt(_,10)}),era:(0,n.buildMatchFn)({matchPatterns:s,defaultMatchWidth:"wide",parsePatterns:a,defaultParseWidth:"any"}),quarter:(0,n.buildMatchFn)({matchPatterns:o,defaultMatchWidth:"wide",parsePatterns:l,defaultParseWidth:"any",valueCallback:_=>_+1}),month:(0,n.buildMatchFn)({matchPatterns:c,defaultMatchWidth:"wide",parsePatterns:d,defaultParseWidth:"any"}),day:(0,n.buildMatchFn)({matchPatterns:h,defaultMatchWidth:"wide",parsePatterns:p,defaultParseWidth:"any"}),dayPeriod:(0,n.buildMatchFn)({matchPatterns:x,defaultMatchWidth:"any",parsePatterns:v,defaultParseWidth:"any"})},Yp}var n2;function s5(){if(n2)return Vp;n2=1,Vp.enUS=void 0;var n=cee(),e=uee(),t=fee(),r=mee(),s=xee();return Vp.enUS={code:"en-US",formatDistance:n.formatDistance,formatLong:e.formatLong,formatRelative:t.formatRelative,localize:r.localize,match:s.match,options:{weekStartsOn:0,firstWeekContainsDate:1}},Vp}var r2;function Uf(){return r2||(r2=1,(function(n){Object.defineProperty(n,"defaultLocale",{enumerable:!0,get:function(){return e.enUS}});var e=s5()})(d_)),d_}var Gp={},p_={},s2;function i5(){if(s2)return p_;s2=1,p_.getDayOfYear=r;var n=Xc(),e=YC(),t=Re();function r(s){const a=(0,t.toDate)(s);return(0,n.differenceInCalendarDays)(a,(0,e.startOfYear)(a))+1}return p_}var g_={},i2;function GC(){if(i2)return g_;i2=1,g_.getISOWeek=s;var n=Qt(),e=Dl(),t=Pm(),r=Re();function s(a){const o=(0,r.toDate)(a),l=+(0,e.startOfISOWeek)(o)-+(0,t.startOfISOWeekYear)(o);return Math.round(l/n.millisecondsInWeek)+1}return g_}var x_={},y_={},v_={},a2;function my(){if(a2)return v_;a2=1,v_.getWeekYear=s;var n=un(),e=To(),t=Re(),r=Ss();function s(a,o){const l=(0,t.toDate)(a),c=l.getFullYear(),d=(0,r.getDefaultOptions)(),h=o?.firstWeekContainsDate??o?.locale?.options?.firstWeekContainsDate??d.firstWeekContainsDate??d.locale?.options?.firstWeekContainsDate??1,p=(0,n.constructFrom)(a,0);p.setFullYear(c+1,0,h),p.setHours(0,0,0,0);const x=(0,e.startOfWeek)(p,o),v=(0,n.constructFrom)(a,0);v.setFullYear(c,0,h),v.setHours(0,0,0,0);const _=(0,e.startOfWeek)(v,o);return l.getTime()>=x.getTime()?c+1:l.getTime()>=_.getTime()?c:c-1}return v_}var o2;function ZC(){if(o2)return y_;o2=1,y_.startOfWeekYear=s;var n=un(),e=my(),t=To(),r=Ss();function s(a,o){const l=(0,r.getDefaultOptions)(),c=o?.firstWeekContainsDate??o?.locale?.options?.firstWeekContainsDate??l.firstWeekContainsDate??l.locale?.options?.firstWeekContainsDate??1,d=(0,e.getWeekYear)(a,o),h=(0,n.constructFrom)(a,0);return h.setFullYear(d,0,c),h.setHours(0,0,0,0),(0,t.startOfWeek)(h,o)}return y_}var l2;function KC(){if(l2)return x_;l2=1,x_.getWeek=s;var n=Qt(),e=To(),t=ZC(),r=Re();function s(a,o){const l=(0,r.toDate)(a),c=+(0,e.startOfWeek)(l,o)-+(0,t.startOfWeekYear)(l,o);return Math.round(c/n.millisecondsInWeek)+1}return x_}var b_={},c2;function Vf(){if(c2)return b_;c2=1,b_.addLeadingZeros=n;function n(e,t){const r=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return r+s}return b_}var Zp={},d2;function a5(){if(d2)return Zp;d2=1,Zp.lightFormatters=void 0;var n=Vf();return Zp.lightFormatters={y(e,t){const r=e.getFullYear(),s=r>0?r:1-r;return(0,n.addLeadingZeros)(t==="yy"?s%100:s,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):(0,n.addLeadingZeros)(r+1,2)},d(e,t){return(0,n.addLeadingZeros)(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return(0,n.addLeadingZeros)(e.getHours()%12||12,t.length)},H(e,t){return(0,n.addLeadingZeros)(e.getHours(),t.length)},m(e,t){return(0,n.addLeadingZeros)(e.getMinutes(),t.length)},s(e,t){return(0,n.addLeadingZeros)(e.getSeconds(),t.length)},S(e,t){const r=t.length,s=e.getMilliseconds(),a=Math.trunc(s*Math.pow(10,r-3));return(0,n.addLeadingZeros)(a,t.length)}},Zp}var u2;function yee(){if(u2)return Gp;u2=1,Gp.formatters=void 0;var n=i5(),e=GC(),t=bu(),r=KC(),s=my(),a=Vf(),o=a5();const l={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"};Gp.formatters={G:function(p,x,v){const _=p.getFullYear()>0?1:0;switch(x){case"G":case"GG":case"GGG":return v.era(_,{width:"abbreviated"});case"GGGGG":return v.era(_,{width:"narrow"});case"GGGG":default:return v.era(_,{width:"wide"})}},y:function(p,x,v){if(x==="yo"){const _=p.getFullYear(),w=_>0?_:1-_;return v.ordinalNumber(w,{unit:"year"})}return o.lightFormatters.y(p,x)},Y:function(p,x,v,_){const w=(0,s.getWeekYear)(p,_),j=w>0?w:1-w;if(x==="YY"){const T=j%100;return(0,a.addLeadingZeros)(T,2)}return x==="Yo"?v.ordinalNumber(j,{unit:"year"}):(0,a.addLeadingZeros)(j,x.length)},R:function(p,x){const v=(0,t.getISOWeekYear)(p);return(0,a.addLeadingZeros)(v,x.length)},u:function(p,x){const v=p.getFullYear();return(0,a.addLeadingZeros)(v,x.length)},Q:function(p,x,v){const _=Math.ceil((p.getMonth()+1)/3);switch(x){case"Q":return String(_);case"QQ":return(0,a.addLeadingZeros)(_,2);case"Qo":return v.ordinalNumber(_,{unit:"quarter"});case"QQQ":return v.quarter(_,{width:"abbreviated",context:"formatting"});case"QQQQQ":return v.quarter(_,{width:"narrow",context:"formatting"});case"QQQQ":default:return v.quarter(_,{width:"wide",context:"formatting"})}},q:function(p,x,v){const _=Math.ceil((p.getMonth()+1)/3);switch(x){case"q":return String(_);case"qq":return(0,a.addLeadingZeros)(_,2);case"qo":return v.ordinalNumber(_,{unit:"quarter"});case"qqq":return v.quarter(_,{width:"abbreviated",context:"standalone"});case"qqqqq":return v.quarter(_,{width:"narrow",context:"standalone"});case"qqqq":default:return v.quarter(_,{width:"wide",context:"standalone"})}},M:function(p,x,v){const _=p.getMonth();switch(x){case"M":case"MM":return o.lightFormatters.M(p,x);case"Mo":return v.ordinalNumber(_+1,{unit:"month"});case"MMM":return v.month(_,{width:"abbreviated",context:"formatting"});case"MMMMM":return v.month(_,{width:"narrow",context:"formatting"});case"MMMM":default:return v.month(_,{width:"wide",context:"formatting"})}},L:function(p,x,v){const _=p.getMonth();switch(x){case"L":return String(_+1);case"LL":return(0,a.addLeadingZeros)(_+1,2);case"Lo":return v.ordinalNumber(_+1,{unit:"month"});case"LLL":return v.month(_,{width:"abbreviated",context:"standalone"});case"LLLLL":return v.month(_,{width:"narrow",context:"standalone"});case"LLLL":default:return v.month(_,{width:"wide",context:"standalone"})}},w:function(p,x,v,_){const w=(0,r.getWeek)(p,_);return x==="wo"?v.ordinalNumber(w,{unit:"week"}):(0,a.addLeadingZeros)(w,x.length)},I:function(p,x,v){const _=(0,e.getISOWeek)(p);return x==="Io"?v.ordinalNumber(_,{unit:"week"}):(0,a.addLeadingZeros)(_,x.length)},d:function(p,x,v){return x==="do"?v.ordinalNumber(p.getDate(),{unit:"date"}):o.lightFormatters.d(p,x)},D:function(p,x,v){const _=(0,n.getDayOfYear)(p);return x==="Do"?v.ordinalNumber(_,{unit:"dayOfYear"}):(0,a.addLeadingZeros)(_,x.length)},E:function(p,x,v){const _=p.getDay();switch(x){case"E":case"EE":case"EEE":return v.day(_,{width:"abbreviated",context:"formatting"});case"EEEEE":return v.day(_,{width:"narrow",context:"formatting"});case"EEEEEE":return v.day(_,{width:"short",context:"formatting"});case"EEEE":default:return v.day(_,{width:"wide",context:"formatting"})}},e:function(p,x,v,_){const w=p.getDay(),j=(w-_.weekStartsOn+8)%7||7;switch(x){case"e":return String(j);case"ee":return(0,a.addLeadingZeros)(j,2);case"eo":return v.ordinalNumber(j,{unit:"day"});case"eee":return v.day(w,{width:"abbreviated",context:"formatting"});case"eeeee":return v.day(w,{width:"narrow",context:"formatting"});case"eeeeee":return v.day(w,{width:"short",context:"formatting"});case"eeee":default:return v.day(w,{width:"wide",context:"formatting"})}},c:function(p,x,v,_){const w=p.getDay(),j=(w-_.weekStartsOn+8)%7||7;switch(x){case"c":return String(j);case"cc":return(0,a.addLeadingZeros)(j,x.length);case"co":return v.ordinalNumber(j,{unit:"day"});case"ccc":return v.day(w,{width:"abbreviated",context:"standalone"});case"ccccc":return v.day(w,{width:"narrow",context:"standalone"});case"cccccc":return v.day(w,{width:"short",context:"standalone"});case"cccc":default:return v.day(w,{width:"wide",context:"standalone"})}},i:function(p,x,v){const _=p.getDay(),w=_===0?7:_;switch(x){case"i":return String(w);case"ii":return(0,a.addLeadingZeros)(w,x.length);case"io":return v.ordinalNumber(w,{unit:"day"});case"iii":return v.day(_,{width:"abbreviated",context:"formatting"});case"iiiii":return v.day(_,{width:"narrow",context:"formatting"});case"iiiiii":return v.day(_,{width:"short",context:"formatting"});case"iiii":default:return v.day(_,{width:"wide",context:"formatting"})}},a:function(p,x,v){const w=p.getHours()/12>=1?"pm":"am";switch(x){case"a":case"aa":return v.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"aaa":return v.dayPeriod(w,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return v.dayPeriod(w,{width:"narrow",context:"formatting"});case"aaaa":default:return v.dayPeriod(w,{width:"wide",context:"formatting"})}},b:function(p,x,v){const _=p.getHours();let w;switch(_===12?w=l.noon:_===0?w=l.midnight:w=_/12>=1?"pm":"am",x){case"b":case"bb":return v.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"bbb":return v.dayPeriod(w,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return v.dayPeriod(w,{width:"narrow",context:"formatting"});case"bbbb":default:return v.dayPeriod(w,{width:"wide",context:"formatting"})}},B:function(p,x,v){const _=p.getHours();let w;switch(_>=17?w=l.evening:_>=12?w=l.afternoon:_>=4?w=l.morning:w=l.night,x){case"B":case"BB":case"BBB":return v.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"BBBBB":return v.dayPeriod(w,{width:"narrow",context:"formatting"});case"BBBB":default:return v.dayPeriod(w,{width:"wide",context:"formatting"})}},h:function(p,x,v){if(x==="ho"){let _=p.getHours()%12;return _===0&&(_=12),v.ordinalNumber(_,{unit:"hour"})}return o.lightFormatters.h(p,x)},H:function(p,x,v){return x==="Ho"?v.ordinalNumber(p.getHours(),{unit:"hour"}):o.lightFormatters.H(p,x)},K:function(p,x,v){const _=p.getHours()%12;return x==="Ko"?v.ordinalNumber(_,{unit:"hour"}):(0,a.addLeadingZeros)(_,x.length)},k:function(p,x,v){let _=p.getHours();return _===0&&(_=24),x==="ko"?v.ordinalNumber(_,{unit:"hour"}):(0,a.addLeadingZeros)(_,x.length)},m:function(p,x,v){return x==="mo"?v.ordinalNumber(p.getMinutes(),{unit:"minute"}):o.lightFormatters.m(p,x)},s:function(p,x,v){return x==="so"?v.ordinalNumber(p.getSeconds(),{unit:"second"}):o.lightFormatters.s(p,x)},S:function(p,x){return o.lightFormatters.S(p,x)},X:function(p,x,v){const _=p.getTimezoneOffset();if(_===0)return"Z";switch(x){case"X":return d(_);case"XXXX":case"XX":return h(_);case"XXXXX":case"XXX":default:return h(_,":")}},x:function(p,x,v){const _=p.getTimezoneOffset();switch(x){case"x":return d(_);case"xxxx":case"xx":return h(_);case"xxxxx":case"xxx":default:return h(_,":")}},O:function(p,x,v){const _=p.getTimezoneOffset();switch(x){case"O":case"OO":case"OOO":return"GMT"+c(_,":");case"OOOO":default:return"GMT"+h(_,":")}},z:function(p,x,v){const _=p.getTimezoneOffset();switch(x){case"z":case"zz":case"zzz":return"GMT"+c(_,":");case"zzzz":default:return"GMT"+h(_,":")}},t:function(p,x,v){const _=Math.trunc(p.getTime()/1e3);return(0,a.addLeadingZeros)(_,x.length)},T:function(p,x,v){const _=p.getTime();return(0,a.addLeadingZeros)(_,x.length)}};function c(p,x=""){const v=p>0?"-":"+",_=Math.abs(p),w=Math.trunc(_/60),j=_%60;return j===0?v+String(w):v+String(w)+x+(0,a.addLeadingZeros)(j,2)}function d(p,x){return p%60===0?(p>0?"-":"+")+(0,a.addLeadingZeros)(Math.abs(p)/60,2):h(p,x)}function h(p,x=""){const v=p>0?"-":"+",_=Math.abs(p),w=(0,a.addLeadingZeros)(Math.trunc(_/60),2),j=(0,a.addLeadingZeros)(_%60,2);return v+w+x+j}return Gp}var Kp={},f2;function o5(){if(f2)return Kp;f2=1,Kp.longFormatters=void 0;const n=(r,s)=>{switch(r){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},e=(r,s)=>{switch(r){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},t=(r,s)=>{const a=r.match(/(P+)(p+)?/)||[],o=a[1],l=a[2];if(!l)return n(r,s);let c;switch(o){case"P":c=s.dateTime({width:"short"});break;case"PP":c=s.dateTime({width:"medium"});break;case"PPP":c=s.dateTime({width:"long"});break;case"PPPP":default:c=s.dateTime({width:"full"});break}return c.replace("{{date}}",n(o,s)).replace("{{time}}",e(l,s))};return Kp.longFormatters={p:e,P:t},Kp}var _h={},h2;function l5(){if(h2)return _h;h2=1,_h.isProtectedDayOfYearToken=r,_h.isProtectedWeekYearToken=s,_h.warnOrThrowProtectedError=a;const n=/^D+$/,e=/^Y+$/,t=["D","DD","YY","YYYY"];function r(l){return n.test(l)}function s(l){return e.test(l)}function a(l,c,d){const h=o(l,c,d);if(console.warn(h),t.includes(l))throw new RangeError(h)}function o(l,c,d){const h=l[0]==="Y"?"years":"days of the month";return`Use \`${l.toLowerCase()}\` instead of \`${l}\` (in \`${c}\`) for formatting ${h} to the input \`${d}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}return _h}var m2;function c5(){return m2||(m2=1,(function(n){n.format=n.formatDate=v,Object.defineProperty(n,"formatters",{enumerable:!0,get:function(){return r.formatters}}),Object.defineProperty(n,"longFormatters",{enumerable:!0,get:function(){return s.longFormatters}});var e=Uf(),t=Ss(),r=yee(),s=o5(),a=l5(),o=ed(),l=Re();const c=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,d=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,h=/^'([^]*?)'?$/,p=/''/g,x=/[a-zA-Z]/;function v(w,j,T){const P=(0,t.getDefaultOptions)(),E=T?.locale??P.locale??e.defaultLocale,M=T?.firstWeekContainsDate??T?.locale?.options?.firstWeekContainsDate??P.firstWeekContainsDate??P.locale?.options?.firstWeekContainsDate??1,O=T?.weekStartsOn??T?.locale?.options?.weekStartsOn??P.weekStartsOn??P.locale?.options?.weekStartsOn??0,I=(0,l.toDate)(w);if(!(0,o.isValid)(I))throw new RangeError("Invalid time value");let q=j.match(d).map(B=>{const U=B[0];if(U==="p"||U==="P"){const W=s.longFormatters[U];return W(B,E.formatLong)}return B}).join("").match(c).map(B=>{if(B==="''")return{isToken:!1,value:"'"};const U=B[0];if(U==="'")return{isToken:!1,value:_(B)};if(r.formatters[U])return{isToken:!0,value:B};if(U.match(x))throw new RangeError("Format string contains an unescaped latin alphabet character `"+U+"`");return{isToken:!1,value:B}});E.localize.preprocessor&&(q=E.localize.preprocessor(I,q));const F={firstWeekContainsDate:M,weekStartsOn:O,locale:E};return q.map(B=>{if(!B.isToken)return B.value;const U=B.value;(!T?.useAdditionalWeekYearTokens&&(0,a.isProtectedWeekYearToken)(U)||!T?.useAdditionalDayOfYearTokens&&(0,a.isProtectedDayOfYearToken)(U))&&(0,a.warnOrThrowProtectedError)(U,j,String(w));const W=r.formatters[U[0]];return W(I,U,E.localize,F)}).join("")}function _(w){const j=w.match(h);return j?j[1].replace(p,"'"):w}})(c_)),c_}var __={},p2;function d5(){if(p2)return __;p2=1,__.formatDistance=c;var n=zf(),e=Qt(),t=uy(),r=fy(),s=Re(),a=Uf(),o=Ss(),l=Qc();function c(d,h,p){const x=(0,o.getDefaultOptions)(),v=p?.locale??x.locale??a.defaultLocale,_=2520,w=(0,n.compareAsc)(d,h);if(isNaN(w))throw new RangeError("Invalid time value");const j=Object.assign({},p,{addSuffix:p?.addSuffix,comparison:w});let T,P;w>0?(T=(0,s.toDate)(h),P=(0,s.toDate)(d)):(T=(0,s.toDate)(d),P=(0,s.toDate)(h));const E=(0,r.differenceInSeconds)(P,T),M=((0,l.getTimezoneOffsetInMilliseconds)(P)-(0,l.getTimezoneOffsetInMilliseconds)(T))/1e3,O=Math.round((E-M)/60);let I;if(O<2)return p?.includeSeconds?E<5?v.formatDistance("lessThanXSeconds",5,j):E<10?v.formatDistance("lessThanXSeconds",10,j):E<20?v.formatDistance("lessThanXSeconds",20,j):E<40?v.formatDistance("halfAMinute",0,j):E<60?v.formatDistance("lessThanXMinutes",1,j):v.formatDistance("xMinutes",1,j):O===0?v.formatDistance("lessThanXMinutes",1,j):v.formatDistance("xMinutes",O,j);if(O<45)return v.formatDistance("xMinutes",O,j);if(O<90)return v.formatDistance("aboutXHours",1,j);if(O<e.minutesInDay){const q=Math.round(O/60);return v.formatDistance("aboutXHours",q,j)}else{if(O<_)return v.formatDistance("xDays",1,j);if(O<e.minutesInMonth){const q=Math.round(O/e.minutesInDay);return v.formatDistance("xDays",q,j)}else if(O<e.minutesInMonth*2)return I=Math.round(O/e.minutesInMonth),v.formatDistance("aboutXMonths",I,j)}if(I=(0,t.differenceInMonths)(P,T),I<12){const q=Math.round(O/e.minutesInMonth);return v.formatDistance("xMonths",q,j)}else{const q=I%12,F=Math.trunc(I/12);return q<3?v.formatDistance("aboutXYears",F,j):q<9?v.formatDistance("overXYears",F,j):v.formatDistance("almostXYears",F+1,j)}}return __}var w_={},g2;function u5(){if(g2)return w_;g2=1,w_.formatDistanceStrict=l;var n=Uf(),e=Ss(),t=td(),r=Qc(),s=zf(),a=Qt(),o=Re();function l(c,d,h){const p=(0,e.getDefaultOptions)(),x=h?.locale??p.locale??n.defaultLocale,v=(0,s.compareAsc)(c,d);if(isNaN(v))throw new RangeError("Invalid time value");const _=Object.assign({},h,{addSuffix:h?.addSuffix,comparison:v});let w,j;v>0?(w=(0,o.toDate)(d),j=(0,o.toDate)(c)):(w=(0,o.toDate)(c),j=(0,o.toDate)(d));const T=(0,t.getRoundingMethod)(h?.roundingMethod??"round"),P=j.getTime()-w.getTime(),E=P/a.millisecondsInMinute,M=(0,r.getTimezoneOffsetInMilliseconds)(j)-(0,r.getTimezoneOffsetInMilliseconds)(w),O=(P-M)/a.millisecondsInMinute,I=h?.unit;let q;if(I?q=I:E<1?q="second":E<60?q="minute":E<a.minutesInDay?q="hour":O<a.minutesInMonth?q="day":O<a.minutesInYear?q="month":q="year",q==="second"){const F=T(P/1e3);return x.formatDistance("xSeconds",F,_)}else if(q==="minute"){const F=T(E);return x.formatDistance("xMinutes",F,_)}else if(q==="hour"){const F=T(E/60);return x.formatDistance("xHours",F,_)}else if(q==="day"){const F=T(O/a.minutesInDay);return x.formatDistance("xDays",F,_)}else if(q==="month"){const F=T(O/a.minutesInMonth);return F===12&&I!=="month"?x.formatDistance("xYears",1,_):x.formatDistance("xMonths",F,_)}else{const F=T(O/a.minutesInYear);return x.formatDistance("xYears",F,_)}}return w_}var j_={},x2;function vee(){if(x2)return j_;x2=1,j_.formatDistanceToNow=t;var n=Gs(),e=d5();function t(r,s){return(0,e.formatDistance)(r,(0,n.constructNow)(r),s)}return j_}var N_={},y2;function bee(){if(y2)return N_;y2=1,N_.formatDistanceToNowStrict=t;var n=u5(),e=Gs();function t(r,s){return(0,n.formatDistanceStrict)(r,(0,e.constructNow)(r),s)}return N_}var S_={},v2;function _ee(){if(v2)return S_;v2=1,S_.formatDuration=r;var n=Uf(),e=Ss();const t=["years","months","weeks","days","hours","minutes","seconds"];function r(s,a){const o=(0,e.getDefaultOptions)(),l=a?.locale??o.locale??n.defaultLocale,c=a?.format??t,d=a?.zero??!1,h=a?.delimiter??" ";return l.formatDistance?c.reduce((x,v)=>{const _=`x${v.replace(/(^.)/,j=>j.toUpperCase())}`,w=s[v];return w!==void 0&&(d||s[v])?x.concat(l.formatDistance(_,w)):x},[]).join(h):""}return S_}var C_={},b2;function wee(){if(b2)return C_;b2=1,C_.formatISO=t;var n=Re(),e=Vf();function t(r,s){const a=(0,n.toDate)(r);if(isNaN(a.getTime()))throw new RangeError("Invalid time value");const o=s?.format??"extended",l=s?.representation??"complete";let c="",d="";const h=o==="extended"?"-":"",p=o==="extended"?":":"";if(l!=="time"){const x=(0,e.addLeadingZeros)(a.getDate(),2),v=(0,e.addLeadingZeros)(a.getMonth()+1,2);c=`${(0,e.addLeadingZeros)(a.getFullYear(),4)}${h}${v}${h}${x}`}if(l!=="date"){const x=a.getTimezoneOffset();if(x!==0){const P=Math.abs(x),E=(0,e.addLeadingZeros)(Math.trunc(P/60),2),M=(0,e.addLeadingZeros)(P%60,2);d=`${x<0?"+":"-"}${E}:${M}`}else d="Z";const v=(0,e.addLeadingZeros)(a.getHours(),2),_=(0,e.addLeadingZeros)(a.getMinutes(),2),w=(0,e.addLeadingZeros)(a.getSeconds(),2),j=c===""?"":"T",T=[v,_,w].join(p);c=`${c}${j}${T}${d}`}return c}return C_}var T_={},_2;function jee(){if(_2)return T_;_2=1,T_.formatISO9075=r;var n=ed(),e=Re(),t=Vf();function r(s,a){const o=(0,e.toDate)(s);if(!(0,n.isValid)(o))throw new RangeError("Invalid time value");const l=a?.format??"extended",c=a?.representation??"complete";let d="";const h=l==="extended"?"-":"",p=l==="extended"?":":"";if(c!=="time"){const x=(0,t.addLeadingZeros)(o.getDate(),2),v=(0,t.addLeadingZeros)(o.getMonth()+1,2);d=`${(0,t.addLeadingZeros)(o.getFullYear(),4)}${h}${v}${h}${x}`}if(c!=="date"){const x=(0,t.addLeadingZeros)(o.getHours(),2),v=(0,t.addLeadingZeros)(o.getMinutes(),2),_=(0,t.addLeadingZeros)(o.getSeconds(),2);d=`${d}${d===""?"":" "}${x}${p}${v}${p}${_}`}return d}return T_}var k_={},w2;function Nee(){if(w2)return k_;w2=1,k_.formatISODuration=n;function n(e){const{years:t=0,months:r=0,days:s=0,hours:a=0,minutes:o=0,seconds:l=0}=e;return`P${t}Y${r}M${s}DT${a}H${o}M${l}S`}return k_}var P_={},j2;function See(){if(j2)return P_;j2=1,P_.formatRFC3339=r;var n=ed(),e=Re(),t=Vf();function r(s,a){const o=(0,e.toDate)(s);if(!(0,n.isValid)(o))throw new RangeError("Invalid time value");const l=a?.fractionDigits??0,c=(0,t.addLeadingZeros)(o.getDate(),2),d=(0,t.addLeadingZeros)(o.getMonth()+1,2),h=o.getFullYear(),p=(0,t.addLeadingZeros)(o.getHours(),2),x=(0,t.addLeadingZeros)(o.getMinutes(),2),v=(0,t.addLeadingZeros)(o.getSeconds(),2);let _="";if(l>0){const T=o.getMilliseconds(),P=Math.trunc(T*Math.pow(10,l-3));_="."+(0,t.addLeadingZeros)(P,l)}let w="";const j=o.getTimezoneOffset();if(j!==0){const T=Math.abs(j),P=(0,t.addLeadingZeros)(Math.trunc(T/60),2),E=(0,t.addLeadingZeros)(T%60,2);w=`${j<0?"+":"-"}${P}:${E}`}else w="Z";return`${h}-${d}-${c}T${p}:${x}:${v}${_}${w}`}return P_}var M_={},N2;function Cee(){if(N2)return M_;N2=1,M_.formatRFC7231=a;var n=ed(),e=Re(),t=Vf();const r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function a(o){const l=(0,e.toDate)(o);if(!(0,n.isValid)(l))throw new RangeError("Invalid time value");const c=r[l.getUTCDay()],d=(0,t.addLeadingZeros)(l.getUTCDate(),2),h=s[l.getUTCMonth()],p=l.getUTCFullYear(),x=(0,t.addLeadingZeros)(l.getUTCHours(),2),v=(0,t.addLeadingZeros)(l.getUTCMinutes(),2),_=(0,t.addLeadingZeros)(l.getUTCSeconds(),2);return`${c}, ${d} ${h} ${p} ${x}:${v}:${_} GMT`}return M_}var D_={},S2;function Tee(){if(S2)return D_;S2=1,D_.formatRelative=a;var n=Xc(),e=c5(),t=Re(),r=Uf(),s=Ss();function a(o,l,c){const d=(0,t.toDate)(o),h=(0,t.toDate)(l),p=(0,s.getDefaultOptions)(),x=c?.locale??p.locale??r.defaultLocale,v=c?.weekStartsOn??c?.locale?.options?.weekStartsOn??p.weekStartsOn??p.locale?.options?.weekStartsOn??0,_=(0,n.differenceInCalendarDays)(d,h);if(isNaN(_))throw new RangeError("Invalid time value");let w;_<-6?w="other":_<-1?w="lastWeek":_<0?w="yesterday":_<1?w="today":_<2?w="tomorrow":_<7?w="nextWeek":w="other";const j=x.formatRelative(w,d,h,{locale:x,weekStartsOn:v});return(0,e.format)(d,j,{locale:x,weekStartsOn:v})}return D_}var E_={},C2;function kee(){if(C2)return E_;C2=1,E_.fromUnixTime=e;var n=Re();function e(t){return(0,n.toDate)(t*1e3)}return E_}var O_={},T2;function f5(){if(T2)return O_;T2=1,O_.getDate=e;var n=Re();function e(t){return(0,n.toDate)(t).getDate()}return O_}var I_={},k2;function py(){if(k2)return I_;k2=1,I_.getDay=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()}return I_}var A_={},P2;function h5(){if(P2)return A_;P2=1,A_.getDaysInMonth=t;var n=Re(),e=un();function t(r){const s=(0,n.toDate)(r),a=s.getFullYear(),o=s.getMonth(),l=(0,e.constructFrom)(r,0);return l.setFullYear(a,o+1,0),l.setHours(0,0,0,0),l.getDate()}return A_}var R_={},L_={},M2;function m5(){if(M2)return L_;M2=1,L_.isLeapYear=e;var n=Re();function e(t){const s=(0,n.toDate)(t).getFullYear();return s%400===0||s%4===0&&s%100!==0}return L_}var D2;function Pee(){if(D2)return R_;D2=1,R_.getDaysInYear=t;var n=m5(),e=Re();function t(r){const s=(0,e.toDate)(r);return String(new Date(s))==="Invalid Date"?NaN:(0,n.isLeapYear)(s)?366:365}return R_}var F_={},E2;function Mee(){if(E2)return F_;E2=1,F_.getDecade=e;var n=Re();function e(t){const s=(0,n.toDate)(t).getFullYear();return Math.floor(s/10)*10}return F_}var q_={},O2;function p5(){if(O2)return q_;O2=1,q_.getDefaultOptions=e;var n=Ss();function e(){return Object.assign({},(0,n.getDefaultOptions)())}return q_}var z_={},I2;function Dee(){if(I2)return z_;I2=1,z_.getHours=e;var n=Re();function e(t){return(0,n.toDate)(t).getHours()}return z_}var U_={},A2;function g5(){if(A2)return U_;A2=1,U_.getISODay=e;var n=Re();function e(t){let s=(0,n.toDate)(t).getDay();return s===0&&(s=7),s}return U_}var V_={},R2;function Eee(){if(R2)return V_;R2=1,V_.getISOWeeksInYear=r;var n=cy(),e=Qt(),t=Pm();function r(s){const a=(0,t.startOfISOWeekYear)(s),l=+(0,t.startOfISOWeekYear)((0,n.addWeeks)(a,60))-+a;return Math.round(l/e.millisecondsInWeek)}return V_}var B_={},L2;function Oee(){if(L2)return B_;L2=1,B_.getMilliseconds=e;var n=Re();function e(t){return(0,n.toDate)(t).getMilliseconds()}return B_}var W_={},F2;function Iee(){if(F2)return W_;F2=1,W_.getMinutes=e;var n=Re();function e(t){return(0,n.toDate)(t).getMinutes()}return W_}var $_={},q2;function Aee(){if(q2)return $_;q2=1,$_.getMonth=e;var n=Re();function e(t){return(0,n.toDate)(t).getMonth()}return $_}var H_={},z2;function Ree(){if(z2)return H_;z2=1,H_.getOverlappingDaysInIntervals=r;var n=Qc(),e=Qt(),t=Re();function r(s,a){const[o,l]=[+(0,t.toDate)(s.start),+(0,t.toDate)(s.end)].sort((w,j)=>w-j),[c,d]=[+(0,t.toDate)(a.start),+(0,t.toDate)(a.end)].sort((w,j)=>w-j);if(!(o<d&&c<l))return 0;const p=c<o?o:c,x=p-(0,n.getTimezoneOffsetInMilliseconds)(p),v=d>l?l:d,_=v-(0,n.getTimezoneOffsetInMilliseconds)(v);return Math.ceil((_-x)/e.millisecondsInDay)}return H_}var Y_={},U2;function Lee(){if(U2)return Y_;U2=1,Y_.getSeconds=e;var n=Re();function e(t){return(0,n.toDate)(t).getSeconds()}return Y_}var G_={},V2;function Fee(){if(V2)return G_;V2=1,G_.getTime=e;var n=Re();function e(t){return(0,n.toDate)(t).getTime()}return G_}var Z_={},B2;function qee(){if(B2)return Z_;B2=1,Z_.getUnixTime=e;var n=Re();function e(t){return Math.trunc(+(0,n.toDate)(t)/1e3)}return Z_}var K_={},W2;function zee(){if(W2)return K_;W2=1,K_.getWeekOfMonth=s;var n=f5(),e=py(),t=hy(),r=Ss();function s(a,o){const l=(0,r.getDefaultOptions)(),c=o?.weekStartsOn??o?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,d=(0,n.getDate)(a);if(isNaN(d))return NaN;const h=(0,e.getDay)((0,t.startOfMonth)(a));let p=c-h;p<=0&&(p+=7);const x=d-p;return Math.ceil(x/7)+1}return K_}var J_={},Q_={},$2;function x5(){if($2)return Q_;$2=1,Q_.lastDayOfMonth=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(0,0,0,0),r}return Q_}var H2;function Uee(){if(H2)return J_;H2=1,J_.getWeeksInMonth=r;var n=LC(),e=x5(),t=hy();function r(s,a){return(0,n.differenceInCalendarWeeks)((0,e.lastDayOfMonth)(s),(0,t.startOfMonth)(s),a)+1}return J_}var X_={},Y2;function Vee(){if(Y2)return X_;Y2=1,X_.getYear=e;var n=Re();function e(t){return(0,n.toDate)(t).getFullYear()}return X_}var ew={},G2;function Bee(){if(G2)return ew;G2=1,ew.hoursToMilliseconds=e;var n=Qt();function e(t){return Math.trunc(t*n.millisecondsInHour)}return ew}var tw={},Z2;function Wee(){if(Z2)return tw;Z2=1,tw.hoursToMinutes=e;var n=Qt();function e(t){return Math.trunc(t*n.minutesInHour)}return tw}var nw={},K2;function $ee(){if(K2)return nw;K2=1,nw.hoursToSeconds=e;var n=Qt();function e(t){return Math.trunc(t*n.secondsInHour)}return nw}var rw={},J2;function Hee(){if(J2)return rw;J2=1,rw.interval=e;var n=Re();function e(t,r,s){const a=(0,n.toDate)(t);if(isNaN(+a))throw new TypeError("Start date is invalid");const o=(0,n.toDate)(r);if(isNaN(+o))throw new TypeError("End date is invalid");if(s?.assertPositive&&+a>+o)throw new TypeError("End date must be after start date");return{start:a,end:o}}return rw}var sw={},Q2;function Yee(){if(Q2)return sw;Q2=1,sw.intervalToDuration=c;var n=F3(),e=qC(),t=zC(),r=UC(),s=uy(),a=fy(),o=e5(),l=Re();function c(d){const h=(0,l.toDate)(d.start),p=(0,l.toDate)(d.end),x={},v=(0,o.differenceInYears)(p,h);v&&(x.years=v);const _=(0,n.add)(h,{years:x.years}),w=(0,s.differenceInMonths)(p,_);w&&(x.months=w);const j=(0,n.add)(_,{months:x.months}),T=(0,e.differenceInDays)(p,j);T&&(x.days=T);const P=(0,n.add)(j,{days:x.days}),E=(0,t.differenceInHours)(p,P);E&&(x.hours=E);const M=(0,n.add)(P,{hours:x.hours}),O=(0,r.differenceInMinutes)(p,M);O&&(x.minutes=O);const I=(0,n.add)(M,{minutes:x.minutes}),q=(0,a.differenceInSeconds)(p,I);return q&&(x.seconds=q),x}return sw}var iw={},X2;function Gee(){if(X2)return iw;X2=1,iw.intlFormat=e;var n=Re();function e(r,s,a){let o;return t(s)?o=s:a=s,new Intl.DateTimeFormat(a?.locale,o).format((0,n.toDate)(r))}function t(r){return r!==void 0&&!("locale"in r)}return iw}var aw={},eO;function Zee(){if(eO)return aw;eO=1,aw.intlFormatDistance=h;var n=Qt(),e=Xc(),t=RC(),r=J3(),s=LC(),a=FC(),o=zC(),l=UC(),c=fy(),d=Re();function h(p,x,v){let _=0,w;const j=(0,d.toDate)(p),T=(0,d.toDate)(x);if(v?.unit)w=v?.unit,w==="second"?_=(0,c.differenceInSeconds)(j,T):w==="minute"?_=(0,l.differenceInMinutes)(j,T):w==="hour"?_=(0,o.differenceInHours)(j,T):w==="day"?_=(0,e.differenceInCalendarDays)(j,T):w==="week"?_=(0,s.differenceInCalendarWeeks)(j,T):w==="month"?_=(0,t.differenceInCalendarMonths)(j,T):w==="quarter"?_=(0,r.differenceInCalendarQuarters)(j,T):w==="year"&&(_=(0,a.differenceInCalendarYears)(j,T));else{const E=(0,c.differenceInSeconds)(j,T);Math.abs(E)<n.secondsInMinute?(_=(0,c.differenceInSeconds)(j,T),w="second"):Math.abs(E)<n.secondsInHour?(_=(0,l.differenceInMinutes)(j,T),w="minute"):Math.abs(E)<n.secondsInDay&&Math.abs((0,e.differenceInCalendarDays)(j,T))<1?(_=(0,o.differenceInHours)(j,T),w="hour"):Math.abs(E)<n.secondsInWeek&&(_=(0,e.differenceInCalendarDays)(j,T))&&Math.abs(_)<7?w="day":Math.abs(E)<n.secondsInMonth?(_=(0,s.differenceInCalendarWeeks)(j,T),w="week"):Math.abs(E)<n.secondsInQuarter?(_=(0,t.differenceInCalendarMonths)(j,T),w="month"):Math.abs(E)<n.secondsInYear&&(0,r.differenceInCalendarQuarters)(j,T)<4?(_=(0,r.differenceInCalendarQuarters)(j,T),w="quarter"):(_=(0,a.differenceInCalendarYears)(j,T),w="year")}return new Intl.RelativeTimeFormat(v?.locale,{localeMatcher:v?.localeMatcher,numeric:v?.numeric||"auto",style:v?.style}).format(_,w)}return aw}var ow={},tO;function Kee(){if(tO)return ow;tO=1,ow.isAfter=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getTime()>a.getTime()}return ow}var lw={},nO;function Jee(){if(nO)return lw;nO=1,lw.isBefore=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return+s<+a}return lw}var cw={},rO;function Qee(){if(rO)return cw;rO=1,cw.isEqual=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return+s==+a}return cw}var dw={},sO;function Xee(){if(sO)return dw;sO=1,dw.isExists=n;function n(e,t,r){const s=new Date(e,t,r);return s.getFullYear()===e&&s.getMonth()===t&&s.getDate()===r}return dw}var uw={},iO;function ete(){if(iO)return uw;iO=1,uw.isFirstDayOfMonth=e;var n=Re();function e(t){return(0,n.toDate)(t).getDate()===1}return uw}var fw={},aO;function tte(){if(aO)return fw;aO=1,fw.isFriday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===5}return fw}var hw={},oO;function nte(){if(oO)return hw;oO=1,hw.isFuture=e;var n=Re();function e(t){return+(0,n.toDate)(t)>Date.now()}return hw}var mw={},pw={},Jp={},Qp={},Xp={},Nc={},gw={},lO;function y5(){if(lO)return gw;lO=1,gw.transpose=e;var n=un();function e(t,r){const s=r instanceof Date?(0,n.constructFrom)(r,0):new r(0);return s.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),s.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),s}return gw}var cO;function v5(){if(cO)return Nc;cO=1,Nc.ValueSetter=Nc.Setter=Nc.DateToSystemTimezoneSetter=void 0;var n=y5(),e=un();const t=10;let r=class{subPriority=0;validate(l,c){return!0}};Nc.Setter=r;class s extends r{constructor(l,c,d,h,p){super(),this.value=l,this.validateValue=c,this.setValue=d,this.priority=h,p&&(this.subPriority=p)}validate(l,c){return this.validateValue(l,this.value,c)}set(l,c,d){return this.setValue(l,c,this.value,d)}}Nc.ValueSetter=s;class a extends r{priority=t;subPriority=-1;set(l,c){return c.timestampIsSet?l:(0,e.constructFrom)(l,(0,n.transpose)(l,Date))}}return Nc.DateToSystemTimezoneSetter=a,Nc}var dO;function pn(){if(dO)return Xp;dO=1,Xp.Parser=void 0;var n=v5();let e=class{run(r,s,a,o){const l=this.parse(r,s,a,o);return l?{setter:new n.ValueSetter(l.value,this.validate,this.set,this.priority,this.subPriority),rest:l.rest}:null}validate(r,s,a){return!0}};return Xp.Parser=e,Xp}var uO;function rte(){if(uO)return Qp;uO=1,Qp.EraParser=void 0;var n=pn();let e=class extends n.Parser{priority=140;parse(r,s,a){switch(s){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,s,a){return s.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}incompatibleTokens=["R","u","t","T"]};return Qp.EraParser=e,Qp}var eg={},ya={},Ku={},fO;function Cs(){return fO||(fO=1,Ku.timezonePatterns=Ku.numericPatterns=void 0,Ku.numericPatterns={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Ku.timezonePatterns={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/}),Ku}var hO;function jn(){if(hO)return ya;hO=1,ya.dayPeriodEnumToHours=c,ya.isLeapYearIndex=h,ya.mapValue=t,ya.normalizeTwoDigitYear=d,ya.parseAnyDigitsSigned=a,ya.parseNDigits=o,ya.parseNDigitsSigned=l,ya.parseNumericPattern=r,ya.parseTimezonePattern=s;var n=Qt(),e=Cs();function t(p,x){return p&&{value:x(p.value),rest:p.rest}}function r(p,x){const v=x.match(p);return v?{value:parseInt(v[0],10),rest:x.slice(v[0].length)}:null}function s(p,x){const v=x.match(p);if(!v)return null;if(v[0]==="Z")return{value:0,rest:x.slice(1)};const _=v[1]==="+"?1:-1,w=v[2]?parseInt(v[2],10):0,j=v[3]?parseInt(v[3],10):0,T=v[5]?parseInt(v[5],10):0;return{value:_*(w*n.millisecondsInHour+j*n.millisecondsInMinute+T*n.millisecondsInSecond),rest:x.slice(v[0].length)}}function a(p){return r(e.numericPatterns.anyDigitsSigned,p)}function o(p,x){switch(p){case 1:return r(e.numericPatterns.singleDigit,x);case 2:return r(e.numericPatterns.twoDigits,x);case 3:return r(e.numericPatterns.threeDigits,x);case 4:return r(e.numericPatterns.fourDigits,x);default:return r(new RegExp("^\\d{1,"+p+"}"),x)}}function l(p,x){switch(p){case 1:return r(e.numericPatterns.singleDigitSigned,x);case 2:return r(e.numericPatterns.twoDigitsSigned,x);case 3:return r(e.numericPatterns.threeDigitsSigned,x);case 4:return r(e.numericPatterns.fourDigitsSigned,x);default:return r(new RegExp("^-?\\d{1,"+p+"}"),x)}}function c(p){switch(p){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function d(p,x){const v=x>0,_=v?x:1-x;let w;if(_<=50)w=p||100;else{const j=_+50,T=Math.trunc(j/100)*100,P=p>=j%100;w=p+T-(P?100:0)}return v?w:1-w}function h(p){return p%400===0||p%4===0&&p%100!==0}return ya}var mO;function ste(){if(mO)return eg;mO=1,eg.YearParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(s,a,o){const l=c=>({year:c,isTwoDigitYear:a==="yy"});switch(a){case"y":return(0,e.mapValue)((0,e.parseNDigits)(4,s),l);case"yo":return(0,e.mapValue)(o.ordinalNumber(s,{unit:"year"}),l);default:return(0,e.mapValue)((0,e.parseNDigits)(a.length,s),l)}}validate(s,a){return a.isTwoDigitYear||a.year>0}set(s,a,o){const l=s.getFullYear();if(o.isTwoDigitYear){const d=(0,e.normalizeTwoDigitYear)(o.year,l);return s.setFullYear(d,0,1),s.setHours(0,0,0,0),s}const c=!("era"in a)||a.era===1?o.year:1-o.year;return s.setFullYear(c,0,1),s.setHours(0,0,0,0),s}};return eg.YearParser=t,eg}var tg={},pO;function ite(){if(pO)return tg;pO=1,tg.LocalWeekYearParser=void 0;var n=my(),e=To(),t=pn(),r=jn();let s=class extends t.Parser{priority=130;parse(o,l,c){const d=h=>({year:h,isTwoDigitYear:l==="YY"});switch(l){case"Y":return(0,r.mapValue)((0,r.parseNDigits)(4,o),d);case"Yo":return(0,r.mapValue)(c.ordinalNumber(o,{unit:"year"}),d);default:return(0,r.mapValue)((0,r.parseNDigits)(l.length,o),d)}}validate(o,l){return l.isTwoDigitYear||l.year>0}set(o,l,c,d){const h=(0,n.getWeekYear)(o,d);if(c.isTwoDigitYear){const x=(0,r.normalizeTwoDigitYear)(c.year,h);return o.setFullYear(x,0,d.firstWeekContainsDate),o.setHours(0,0,0,0),(0,e.startOfWeek)(o,d)}const p=!("era"in l)||l.era===1?c.year:1-c.year;return o.setFullYear(p,0,d.firstWeekContainsDate),o.setHours(0,0,0,0),(0,e.startOfWeek)(o,d)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]};return tg.LocalWeekYearParser=s,tg}var ng={},gO;function ate(){if(gO)return ng;gO=1,ng.ISOWeekYearParser=void 0;var n=Dl(),e=un(),t=pn(),r=jn();let s=class extends t.Parser{priority=130;parse(o,l){return l==="R"?(0,r.parseNDigitsSigned)(4,o):(0,r.parseNDigitsSigned)(l.length,o)}set(o,l,c){const d=(0,e.constructFrom)(o,0);return d.setFullYear(c,0,4),d.setHours(0,0,0,0),(0,n.startOfISOWeek)(d)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]};return ng.ISOWeekYearParser=s,ng}var rg={},xO;function ote(){if(xO)return rg;xO=1,rg.ExtendedYearParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=130;parse(s,a){return a==="u"?(0,e.parseNDigitsSigned)(4,s):(0,e.parseNDigitsSigned)(a.length,s)}set(s,a,o){return s.setFullYear(o,0,1),s.setHours(0,0,0,0),s}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]};return rg.ExtendedYearParser=t,rg}var sg={},yO;function lte(){if(yO)return sg;yO=1,sg.QuarterParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=120;parse(s,a,o){switch(a){case"Q":case"QQ":return(0,e.parseNDigits)(a.length,s);case"Qo":return o.ordinalNumber(s,{unit:"quarter"});case"QQQ":return o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(s,{width:"wide",context:"formatting"})||o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"})}}validate(s,a){return a>=1&&a<=4}set(s,a,o){return s.setMonth((o-1)*3,1),s.setHours(0,0,0,0),s}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]};return sg.QuarterParser=t,sg}var ig={},vO;function cte(){if(vO)return ig;vO=1,ig.StandAloneQuarterParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=120;parse(s,a,o){switch(a){case"q":case"qq":return(0,e.parseNDigits)(a.length,s);case"qo":return o.ordinalNumber(s,{unit:"quarter"});case"qqq":return o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(s,{width:"wide",context:"standalone"})||o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"})}}validate(s,a){return a>=1&&a<=4}set(s,a,o){return s.setMonth((o-1)*3,1),s.setHours(0,0,0,0),s}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]};return ig.StandAloneQuarterParser=t,ig}var ag={},bO;function dte(){if(bO)return ag;bO=1,ag.MonthParser=void 0;var n=Cs(),e=pn(),t=jn();let r=class extends e.Parser{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(a,o,l){const c=d=>d-1;switch(o){case"M":return(0,t.mapValue)((0,t.parseNumericPattern)(n.numericPatterns.month,a),c);case"MM":return(0,t.mapValue)((0,t.parseNDigits)(2,a),c);case"Mo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"month"}),c);case"MMM":return l.month(a,{width:"abbreviated",context:"formatting"})||l.month(a,{width:"narrow",context:"formatting"});case"MMMMM":return l.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return l.month(a,{width:"wide",context:"formatting"})||l.month(a,{width:"abbreviated",context:"formatting"})||l.month(a,{width:"narrow",context:"formatting"})}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.setMonth(l,1),a.setHours(0,0,0,0),a}};return ag.MonthParser=r,ag}var og={},_O;function ute(){if(_O)return og;_O=1,og.StandAloneMonthParser=void 0;var n=Cs(),e=pn(),t=jn();let r=class extends e.Parser{priority=110;parse(a,o,l){const c=d=>d-1;switch(o){case"L":return(0,t.mapValue)((0,t.parseNumericPattern)(n.numericPatterns.month,a),c);case"LL":return(0,t.mapValue)((0,t.parseNDigits)(2,a),c);case"Lo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"month"}),c);case"LLL":return l.month(a,{width:"abbreviated",context:"standalone"})||l.month(a,{width:"narrow",context:"standalone"});case"LLLLL":return l.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return l.month(a,{width:"wide",context:"standalone"})||l.month(a,{width:"abbreviated",context:"standalone"})||l.month(a,{width:"narrow",context:"standalone"})}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.setMonth(l,1),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};return og.StandAloneMonthParser=r,og}var lg={},xw={},wO;function b5(){if(wO)return xw;wO=1,xw.setWeek=t;var n=KC(),e=Re();function t(r,s,a){const o=(0,e.toDate)(r),l=(0,n.getWeek)(o,a)-s;return o.setDate(o.getDate()-l*7),o}return xw}var jO;function fte(){if(jO)return lg;jO=1,lg.LocalWeekParser=void 0;var n=b5(),e=To(),t=Cs(),r=pn(),s=jn();let a=class extends r.Parser{priority=100;parse(l,c,d){switch(c){case"w":return(0,s.parseNumericPattern)(t.numericPatterns.week,l);case"wo":return d.ordinalNumber(l,{unit:"week"});default:return(0,s.parseNDigits)(c.length,l)}}validate(l,c){return c>=1&&c<=53}set(l,c,d,h){return(0,e.startOfWeek)((0,n.setWeek)(l,d,h),h)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};return lg.LocalWeekParser=a,lg}var cg={},yw={},NO;function _5(){if(NO)return yw;NO=1,yw.setISOWeek=t;var n=GC(),e=Re();function t(r,s){const a=(0,e.toDate)(r),o=(0,n.getISOWeek)(a)-s;return a.setDate(a.getDate()-o*7),a}return yw}var SO;function hte(){if(SO)return cg;SO=1,cg.ISOWeekParser=void 0;var n=_5(),e=Dl(),t=Cs(),r=pn(),s=jn();let a=class extends r.Parser{priority=100;parse(l,c,d){switch(c){case"I":return(0,s.parseNumericPattern)(t.numericPatterns.week,l);case"Io":return d.ordinalNumber(l,{unit:"week"});default:return(0,s.parseNDigits)(c.length,l)}}validate(l,c){return c>=1&&c<=53}set(l,c,d){return(0,e.startOfISOWeek)((0,n.setISOWeek)(l,d))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};return cg.ISOWeekParser=a,cg}var dg={},CO;function mte(){if(CO)return dg;CO=1,dg.DateParser=void 0;var n=Cs(),e=pn(),t=jn();const r=[31,28,31,30,31,30,31,31,30,31,30,31],s=[31,29,31,30,31,30,31,31,30,31,30,31];let a=class extends e.Parser{priority=90;subPriority=1;parse(l,c,d){switch(c){case"d":return(0,t.parseNumericPattern)(n.numericPatterns.date,l);case"do":return d.ordinalNumber(l,{unit:"date"});default:return(0,t.parseNDigits)(c.length,l)}}validate(l,c){const d=l.getFullYear(),h=(0,t.isLeapYearIndex)(d),p=l.getMonth();return h?c>=1&&c<=s[p]:c>=1&&c<=r[p]}set(l,c,d){return l.setDate(d),l.setHours(0,0,0,0),l}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]};return dg.DateParser=a,dg}var ug={},TO;function pte(){if(TO)return ug;TO=1,ug.DayOfYearParser=void 0;var n=Cs(),e=pn(),t=jn();let r=class extends e.Parser{priority=90;subpriority=1;parse(a,o,l){switch(o){case"D":case"DD":return(0,t.parseNumericPattern)(n.numericPatterns.dayOfYear,a);case"Do":return l.ordinalNumber(a,{unit:"date"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){const l=a.getFullYear();return(0,t.isLeapYearIndex)(l)?o>=1&&o<=366:o>=1&&o<=365}set(a,o,l){return a.setMonth(0,l),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};return ug.DayOfYearParser=r,ug}var fg={},vw={},kO;function gy(){if(kO)return vw;kO=1,vw.setDay=r;var n=Ml(),e=Re(),t=Ss();function r(s,a,o){const l=(0,t.getDefaultOptions)(),c=o?.weekStartsOn??o?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,d=(0,e.toDate)(s),h=d.getDay(),x=(a%7+7)%7,v=7-c,_=a<0||a>6?a-(h+v)%7:(x+v)%7-(h+v)%7;return(0,n.addDays)(d,_)}return vw}var PO;function gte(){if(PO)return fg;PO=1,fg.DayParser=void 0;var n=gy(),e=pn();let t=class extends e.Parser{priority=90;parse(s,a,o){switch(a){case"E":case"EE":case"EEE":return o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(s,{width:"wide",context:"formatting"})||o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"})}}validate(s,a){return a>=0&&a<=6}set(s,a,o,l){return s=(0,n.setDay)(s,o,l),s.setHours(0,0,0,0),s}incompatibleTokens=["D","i","e","c","t","T"]};return fg.DayParser=t,fg}var hg={},MO;function xte(){if(MO)return hg;MO=1,hg.LocalDayParser=void 0;var n=gy(),e=pn(),t=jn();let r=class extends e.Parser{priority=90;parse(a,o,l,c){const d=h=>{const p=Math.floor((h-1)/7)*7;return(h+c.weekStartsOn+6)%7+p};switch(o){case"e":case"ee":return(0,t.mapValue)((0,t.parseNDigits)(o.length,a),d);case"eo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"day"}),d);case"eee":return l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"});case"eeeee":return l.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"});case"eeee":default:return l.day(a,{width:"wide",context:"formatting"})||l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"})}}validate(a,o){return o>=0&&o<=6}set(a,o,l,c){return a=(0,n.setDay)(a,l,c),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]};return hg.LocalDayParser=r,hg}var mg={},DO;function yte(){if(DO)return mg;DO=1,mg.StandAloneLocalDayParser=void 0;var n=gy(),e=pn(),t=jn();let r=class extends e.Parser{priority=90;parse(a,o,l,c){const d=h=>{const p=Math.floor((h-1)/7)*7;return(h+c.weekStartsOn+6)%7+p};switch(o){case"c":case"cc":return(0,t.mapValue)((0,t.parseNDigits)(o.length,a),d);case"co":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"day"}),d);case"ccc":return l.day(a,{width:"abbreviated",context:"standalone"})||l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"});case"ccccc":return l.day(a,{width:"narrow",context:"standalone"});case"cccccc":return l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"});case"cccc":default:return l.day(a,{width:"wide",context:"standalone"})||l.day(a,{width:"abbreviated",context:"standalone"})||l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"})}}validate(a,o){return o>=0&&o<=6}set(a,o,l,c){return a=(0,n.setDay)(a,l,c),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};return mg.StandAloneLocalDayParser=r,mg}var pg={},bw={},EO;function w5(){if(EO)return bw;EO=1,bw.setISODay=r;var n=Ml(),e=g5(),t=Re();function r(s,a){const o=(0,t.toDate)(s),l=(0,e.getISODay)(o),c=a-l;return(0,n.addDays)(o,c)}return bw}var OO;function vte(){if(OO)return pg;OO=1,pg.ISODayParser=void 0;var n=w5(),e=pn(),t=jn();let r=class extends e.Parser{priority=90;parse(a,o,l){const c=d=>d===0?7:d;switch(o){case"i":case"ii":return(0,t.parseNDigits)(o.length,a);case"io":return l.ordinalNumber(a,{unit:"day"});case"iii":return(0,t.mapValue)(l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c);case"iiiii":return(0,t.mapValue)(l.day(a,{width:"narrow",context:"formatting"}),c);case"iiiiii":return(0,t.mapValue)(l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c);case"iiii":default:return(0,t.mapValue)(l.day(a,{width:"wide",context:"formatting"})||l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c)}}validate(a,o){return o>=1&&o<=7}set(a,o,l){return a=(0,n.setISODay)(a,l),a.setHours(0,0,0,0),a}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]};return pg.ISODayParser=r,pg}var gg={},IO;function bte(){if(IO)return gg;IO=1,gg.AMPMParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"a":case"aa":case"aaa":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["b","B","H","k","t","T"]};return gg.AMPMParser=t,gg}var xg={},AO;function _te(){if(AO)return xg;AO=1,xg.AMPMMidnightParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"b":case"bb":case"bbb":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["a","B","H","k","t","T"]};return xg.AMPMMidnightParser=t,xg}var yg={},RO;function wte(){if(RO)return yg;RO=1,yg.DayPeriodParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"B":case"BB":case"BBB":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["a","b","t","T"]};return yg.DayPeriodParser=t,yg}var vg={},LO;function jte(){if(LO)return vg;LO=1,vg.Hour1to12Parser=void 0;var n=Cs(),e=pn(),t=jn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"h":return(0,t.parseNumericPattern)(n.numericPatterns.hour12h,a);case"ho":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=1&&o<=12}set(a,o,l){const c=a.getHours()>=12;return c&&l<12?a.setHours(l+12,0,0,0):!c&&l===12?a.setHours(0,0,0,0):a.setHours(l,0,0,0),a}incompatibleTokens=["H","K","k","t","T"]};return vg.Hour1to12Parser=r,vg}var bg={},FO;function Nte(){if(FO)return bg;FO=1,bg.Hour0to23Parser=void 0;var n=Cs(),e=pn(),t=jn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"H":return(0,t.parseNumericPattern)(n.numericPatterns.hour23h,a);case"Ho":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=23}set(a,o,l){return a.setHours(l,0,0,0),a}incompatibleTokens=["a","b","h","K","k","t","T"]};return bg.Hour0to23Parser=r,bg}var _g={},qO;function Ste(){if(qO)return _g;qO=1,_g.Hour0To11Parser=void 0;var n=Cs(),e=pn(),t=jn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"K":return(0,t.parseNumericPattern)(n.numericPatterns.hour11h,a);case"Ko":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.getHours()>=12&&l<12?a.setHours(l+12,0,0,0):a.setHours(l,0,0,0),a}incompatibleTokens=["h","H","k","t","T"]};return _g.Hour0To11Parser=r,_g}var wg={},zO;function Cte(){if(zO)return wg;zO=1,wg.Hour1To24Parser=void 0;var n=Cs(),e=pn(),t=jn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"k":return(0,t.parseNumericPattern)(n.numericPatterns.hour24h,a);case"ko":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=1&&o<=24}set(a,o,l){const c=l<=24?l%24:l;return a.setHours(c,0,0,0),a}incompatibleTokens=["a","b","h","H","K","t","T"]};return wg.Hour1To24Parser=r,wg}var jg={},UO;function Tte(){if(UO)return jg;UO=1,jg.MinuteParser=void 0;var n=Cs(),e=pn(),t=jn();let r=class extends e.Parser{priority=60;parse(a,o,l){switch(o){case"m":return(0,t.parseNumericPattern)(n.numericPatterns.minute,a);case"mo":return l.ordinalNumber(a,{unit:"minute"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=59}set(a,o,l){return a.setMinutes(l,0,0),a}incompatibleTokens=["t","T"]};return jg.MinuteParser=r,jg}var Ng={},VO;function kte(){if(VO)return Ng;VO=1,Ng.SecondParser=void 0;var n=Cs(),e=pn(),t=jn();let r=class extends e.Parser{priority=50;parse(a,o,l){switch(o){case"s":return(0,t.parseNumericPattern)(n.numericPatterns.second,a);case"so":return l.ordinalNumber(a,{unit:"second"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=59}set(a,o,l){return a.setSeconds(l,0),a}incompatibleTokens=["t","T"]};return Ng.SecondParser=r,Ng}var Sg={},BO;function Pte(){if(BO)return Sg;BO=1,Sg.FractionOfSecondParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=30;parse(s,a){const o=l=>Math.trunc(l*Math.pow(10,-a.length+3));return(0,e.mapValue)((0,e.parseNDigits)(a.length,s),o)}set(s,a,o){return s.setMilliseconds(o),s}incompatibleTokens=["t","T"]};return Sg.FractionOfSecondParser=t,Sg}var Cg={},WO;function Mte(){if(WO)return Cg;WO=1,Cg.ISOTimezoneWithZParser=void 0;var n=un(),e=Qc(),t=Cs(),r=pn(),s=jn();let a=class extends r.Parser{priority=10;parse(l,c){switch(c){case"X":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalMinutes,l);case"XX":return(0,s.parseTimezonePattern)(t.timezonePatterns.basic,l);case"XXXX":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalSeconds,l);case"XXXXX":return(0,s.parseTimezonePattern)(t.timezonePatterns.extendedOptionalSeconds,l);case"XXX":default:return(0,s.parseTimezonePattern)(t.timezonePatterns.extended,l)}}set(l,c,d){return c.timestampIsSet?l:(0,n.constructFrom)(l,l.getTime()-(0,e.getTimezoneOffsetInMilliseconds)(l)-d)}incompatibleTokens=["t","T","x"]};return Cg.ISOTimezoneWithZParser=a,Cg}var Tg={},$O;function Dte(){if($O)return Tg;$O=1,Tg.ISOTimezoneParser=void 0;var n=un(),e=Qc(),t=Cs(),r=pn(),s=jn();let a=class extends r.Parser{priority=10;parse(l,c){switch(c){case"x":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalMinutes,l);case"xx":return(0,s.parseTimezonePattern)(t.timezonePatterns.basic,l);case"xxxx":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalSeconds,l);case"xxxxx":return(0,s.parseTimezonePattern)(t.timezonePatterns.extendedOptionalSeconds,l);case"xxx":default:return(0,s.parseTimezonePattern)(t.timezonePatterns.extended,l)}}set(l,c,d){return c.timestampIsSet?l:(0,n.constructFrom)(l,l.getTime()-(0,e.getTimezoneOffsetInMilliseconds)(l)-d)}incompatibleTokens=["t","T","X"]};return Tg.ISOTimezoneParser=a,Tg}var kg={},HO;function Ete(){if(HO)return kg;HO=1,kg.TimestampSecondsParser=void 0;var n=un(),e=pn(),t=jn();let r=class extends e.Parser{priority=40;parse(a){return(0,t.parseAnyDigitsSigned)(a)}set(a,o,l){return[(0,n.constructFrom)(a,l*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"};return kg.TimestampSecondsParser=r,kg}var Pg={},YO;function Ote(){if(YO)return Pg;YO=1,Pg.TimestampMillisecondsParser=void 0;var n=un(),e=pn(),t=jn();let r=class extends e.Parser{priority=20;parse(a){return(0,t.parseAnyDigitsSigned)(a)}set(a,o,l){return[(0,n.constructFrom)(a,l),{timestampIsSet:!0}]}incompatibleTokens="*"};return Pg.TimestampMillisecondsParser=r,Pg}var GO;function Ite(){if(GO)return Jp;GO=1,Jp.parsers=void 0;var n=rte(),e=ste(),t=ite(),r=ate(),s=ote(),a=lte(),o=cte(),l=dte(),c=ute(),d=fte(),h=hte(),p=mte(),x=pte(),v=gte(),_=xte(),w=yte(),j=vte(),T=bte(),P=_te(),E=wte(),M=jte(),O=Nte(),I=Ste(),q=Cte(),F=Tte(),B=kte(),U=Pte(),W=Mte(),$=Dte(),se=Ete(),Y=Ote();return Jp.parsers={G:new n.EraParser,y:new e.YearParser,Y:new t.LocalWeekYearParser,R:new r.ISOWeekYearParser,u:new s.ExtendedYearParser,Q:new a.QuarterParser,q:new o.StandAloneQuarterParser,M:new l.MonthParser,L:new c.StandAloneMonthParser,w:new d.LocalWeekParser,I:new h.ISOWeekParser,d:new p.DateParser,D:new x.DayOfYearParser,E:new v.DayParser,e:new _.LocalDayParser,c:new w.StandAloneLocalDayParser,i:new j.ISODayParser,a:new T.AMPMParser,b:new P.AMPMMidnightParser,B:new E.DayPeriodParser,h:new M.Hour1to12Parser,H:new O.Hour0to23Parser,K:new I.Hour0To11Parser,k:new q.Hour1To24Parser,m:new F.MinuteParser,s:new B.SecondParser,S:new U.FractionOfSecondParser,X:new W.ISOTimezoneWithZParser,x:new $.ISOTimezoneParser,t:new se.TimestampSecondsParser,T:new Y.TimestampMillisecondsParser},Jp}var ZO;function j5(){return ZO||(ZO=1,(function(n){Object.defineProperty(n,"longFormatters",{enumerable:!0,get:function(){return a.longFormatters}}),n.parse=w,Object.defineProperty(n,"parsers",{enumerable:!0,get:function(){return l.parsers}});var e=un(),t=p5(),r=Uf(),s=Re(),a=o5(),o=l5(),l=Ite(),c=v5();const d=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,h=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,p=/^'([^]*?)'?$/,x=/''/g,v=/\S/,_=/[a-zA-Z]/;function w(T,P,E,M){const O=(0,t.getDefaultOptions)(),I=M?.locale??O.locale??r.defaultLocale,q=M?.firstWeekContainsDate??M?.locale?.options?.firstWeekContainsDate??O.firstWeekContainsDate??O.locale?.options?.firstWeekContainsDate??1,F=M?.weekStartsOn??M?.locale?.options?.weekStartsOn??O.weekStartsOn??O.locale?.options?.weekStartsOn??0;if(P==="")return T===""?(0,s.toDate)(E):(0,e.constructFrom)(E,NaN);const B={firstWeekContainsDate:q,weekStartsOn:F,locale:I},U=[new c.DateToSystemTimezoneSetter],W=P.match(h).map(J=>{const ee=J[0];if(ee in a.longFormatters){const X=a.longFormatters[ee];return X(J,I.formatLong)}return J}).join("").match(d),$=[];for(let J of W){!M?.useAdditionalWeekYearTokens&&(0,o.isProtectedWeekYearToken)(J)&&(0,o.warnOrThrowProtectedError)(J,P,T),!M?.useAdditionalDayOfYearTokens&&(0,o.isProtectedDayOfYearToken)(J)&&(0,o.warnOrThrowProtectedError)(J,P,T);const ee=J[0],X=l.parsers[ee];if(X){const{incompatibleTokens:Z}=X;if(Array.isArray(Z)){const H=$.find(Q=>Z.includes(Q.token)||Q.token===ee);if(H)throw new RangeError(`The format string mustn't contain \`${H.fullToken}\` and \`${J}\` at the same time`)}else if(X.incompatibleTokens==="*"&&$.length>0)throw new RangeError(`The format string mustn't contain \`${J}\` and any other token at the same time`);$.push({token:ee,fullToken:J});const oe=X.run(T,J,I.match,B);if(!oe)return(0,e.constructFrom)(E,NaN);U.push(oe.setter),T=oe.rest}else{if(ee.match(_))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ee+"`");if(J==="''"?J="'":ee==="'"&&(J=j(J)),T.indexOf(J)===0)T=T.slice(J.length);else return(0,e.constructFrom)(E,NaN)}}if(T.length>0&&v.test(T))return(0,e.constructFrom)(E,NaN);const se=U.map(J=>J.priority).sort((J,ee)=>ee-J).filter((J,ee,X)=>X.indexOf(J)===ee).map(J=>U.filter(ee=>ee.priority===J).sort((ee,X)=>X.subPriority-ee.subPriority)).map(J=>J[0]);let Y=(0,s.toDate)(E);if(isNaN(Y.getTime()))return(0,e.constructFrom)(E,NaN);const ae={};for(const J of se){if(!J.validate(Y,B))return(0,e.constructFrom)(E,NaN);const ee=J.set(Y,ae,B);Array.isArray(ee)?(Y=ee[0],Object.assign(ae,ee[1])):Y=ee}return(0,e.constructFrom)(E,Y)}function j(T){return T.match(p)[1].replace(x,"'")}})(pw)),pw}var KO;function Ate(){if(KO)return mw;KO=1,mw.isMatch=t;var n=ed(),e=j5();function t(r,s,a){return(0,n.isValid)((0,e.parse)(r,s,new Date,a))}return mw}var _w={},JO;function Rte(){if(JO)return _w;JO=1,_w.isMonday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===1}return _w}var ww={},QO;function Lte(){if(QO)return ww;QO=1,ww.isPast=e;var n=Re();function e(t){return+(0,n.toDate)(t)<Date.now()}return ww}var jw={},Nw={},XO;function N5(){if(XO)return Nw;XO=1,Nw.startOfHour=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setMinutes(0,0,0),r}return Nw}var eI;function S5(){if(eI)return jw;eI=1,jw.isSameHour=e;var n=N5();function e(t,r){const s=(0,n.startOfHour)(t),a=(0,n.startOfHour)(r);return+s==+a}return jw}var Sw={},Cw={},tI;function JC(){if(tI)return Cw;tI=1,Cw.isSameWeek=e;var n=To();function e(t,r,s){const a=(0,n.startOfWeek)(t,s),o=(0,n.startOfWeek)(r,s);return+a==+o}return Cw}var nI;function C5(){if(nI)return Sw;nI=1,Sw.isSameISOWeek=e;var n=JC();function e(t,r){return(0,n.isSameWeek)(t,r,{weekStartsOn:1})}return Sw}var Tw={},rI;function Fte(){if(rI)return Tw;rI=1,Tw.isSameISOWeekYear=e;var n=Pm();function e(t,r){const s=(0,n.startOfISOWeekYear)(t),a=(0,n.startOfISOWeekYear)(r);return+s==+a}return Tw}var kw={},sI;function T5(){if(sI)return kw;sI=1,kw.isSameMinute=e;var n=WC();function e(t,r){const s=(0,n.startOfMinute)(t),a=(0,n.startOfMinute)(r);return+s==+a}return kw}var Pw={},iI;function k5(){if(iI)return Pw;iI=1,Pw.isSameMonth=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()}return Pw}var Mw={},aI;function P5(){if(aI)return Mw;aI=1,Mw.isSameQuarter=e;var n=$C();function e(t,r){const s=(0,n.startOfQuarter)(t),a=(0,n.startOfQuarter)(r);return+s==+a}return Mw}var Dw={},Ew={},oI;function M5(){if(oI)return Ew;oI=1,Ew.startOfSecond=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setMilliseconds(0),r}return Ew}var lI;function D5(){if(lI)return Dw;lI=1,Dw.isSameSecond=e;var n=M5();function e(t,r){const s=(0,n.startOfSecond)(t),a=(0,n.startOfSecond)(r);return+s==+a}return Dw}var Ow={},cI;function E5(){if(cI)return Ow;cI=1,Ow.isSameYear=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()===a.getFullYear()}return Ow}var Iw={},dI;function qte(){if(dI)return Iw;dI=1,Iw.isThisHour=t;var n=Gs(),e=S5();function t(r){return(0,e.isSameHour)(r,(0,n.constructNow)(r))}return Iw}var Aw={},uI;function zte(){if(uI)return Aw;uI=1,Aw.isThisISOWeek=t;var n=Gs(),e=C5();function t(r){return(0,e.isSameISOWeek)(r,(0,n.constructNow)(r))}return Aw}var Rw={},fI;function Ute(){if(fI)return Rw;fI=1,Rw.isThisMinute=t;var n=Gs(),e=T5();function t(r){return(0,e.isSameMinute)(r,(0,n.constructNow)(r))}return Rw}var Lw={},hI;function Vte(){if(hI)return Lw;hI=1,Lw.isThisMonth=t;var n=Gs(),e=k5();function t(r){return(0,e.isSameMonth)(r,(0,n.constructNow)(r))}return Lw}var Fw={},mI;function Bte(){if(mI)return Fw;mI=1,Fw.isThisQuarter=t;var n=Gs(),e=P5();function t(r){return(0,e.isSameQuarter)(r,(0,n.constructNow)(r))}return Fw}var qw={},pI;function Wte(){if(pI)return qw;pI=1,qw.isThisSecond=t;var n=Gs(),e=D5();function t(r){return(0,e.isSameSecond)(r,(0,n.constructNow)(r))}return qw}var zw={},gI;function $te(){if(gI)return zw;gI=1,zw.isThisWeek=t;var n=Gs(),e=JC();function t(r,s){return(0,e.isSameWeek)(r,(0,n.constructNow)(r),s)}return zw}var Uw={},xI;function Hte(){if(xI)return Uw;xI=1,Uw.isThisYear=t;var n=Gs(),e=E5();function t(r){return(0,e.isSameYear)(r,(0,n.constructNow)(r))}return Uw}var Vw={},yI;function Yte(){if(yI)return Vw;yI=1,Vw.isThursday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===4}return Vw}var Bw={},vI;function Gte(){if(vI)return Bw;vI=1,Bw.isToday=t;var n=Gs(),e=Mm();function t(r){return(0,e.isSameDay)(r,(0,n.constructNow)(r))}return Bw}var Ww={},bI;function Zte(){if(bI)return Ww;bI=1,Ww.isTomorrow=r;var n=Ml(),e=Gs(),t=Mm();function r(s){return(0,t.isSameDay)(s,(0,n.addDays)((0,e.constructNow)(s),1))}return Ww}var $w={},_I;function Kte(){if(_I)return $w;_I=1,$w.isTuesday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===2}return $w}var Hw={},wI;function Jte(){if(wI)return Hw;wI=1,Hw.isWednesday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===3}return Hw}var Yw={},jI;function Qte(){if(jI)return Yw;jI=1,Yw.isWithinInterval=e;var n=Re();function e(t,r){const s=+(0,n.toDate)(t),[a,o]=[+(0,n.toDate)(r.start),+(0,n.toDate)(r.end)].sort((l,c)=>l-c);return s>=a&&s<=o}return Yw}var Gw={},Zw={},NI;function xy(){if(NI)return Zw;NI=1,Zw.subDays=e;var n=Ml();function e(t,r){return(0,n.addDays)(t,-r)}return Zw}var SI;function Xte(){if(SI)return Gw;SI=1,Gw.isYesterday=r;var n=Gs(),e=Mm(),t=xy();function r(s){return(0,e.isSameDay)(s,(0,t.subDays)((0,n.constructNow)(s),1))}return Gw}var Kw={},CI;function ene(){if(CI)return Kw;CI=1,Kw.lastDayOfDecade=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=9+Math.floor(s/10)*10;return r.setFullYear(a+1,0,0),r.setHours(0,0,0,0),r}return Kw}var Jw={},Qw={},TI;function O5(){if(TI)return Qw;TI=1,Qw.lastDayOfWeek=t;var n=Re(),e=Ss();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?-7:0)+6-(c-o);return l.setHours(0,0,0,0),l.setDate(l.getDate()+d),l}return Qw}var kI;function tne(){if(kI)return Jw;kI=1,Jw.lastDayOfISOWeek=e;var n=O5();function e(t){return(0,n.lastDayOfWeek)(t,{weekStartsOn:1})}return Jw}var Xw={},PI;function nne(){if(PI)return Xw;PI=1,Xw.lastDayOfISOWeekYear=r;var n=bu(),e=Dl(),t=un();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const l=(0,e.startOfISOWeek)(o);return l.setDate(l.getDate()-1),l}return Xw}var ej={},MI;function rne(){if(MI)return ej;MI=1,ej.lastDayOfQuarter=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3+3;return r.setMonth(a,0),r.setHours(0,0,0,0),r}return ej}var tj={},DI;function sne(){if(DI)return tj;DI=1,tj.lastDayOfYear=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(0,0,0,0),r}return tj}var nj={},EI;function ine(){return EI||(EI=1,(function(n){n.lightFormat=c,Object.defineProperty(n,"lightFormatters",{enumerable:!0,get:function(){return r.lightFormatters}});var e=ed(),t=Re(),r=a5();const s=/(\w)\1*|''|'(''|[^'])+('|$)|./g,a=/^'([^]*?)'?$/,o=/''/g,l=/[a-zA-Z]/;function c(h,p){const x=(0,t.toDate)(h);if(!(0,e.isValid)(x))throw new RangeError("Invalid time value");const v=p.match(s);return v?v.map(w=>{if(w==="''")return"'";const j=w[0];if(j==="'")return d(w);const T=r.lightFormatters[j];if(T)return T(x,w);if(j.match(l))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");return w}).join(""):""}function d(h){const p=h.match(a);return p?p[1].replace(o,"'"):h}})(nj)),nj}var rj={},OI;function ane(){if(OI)return rj;OI=1,rj.milliseconds=e;var n=Qt();function e({years:t,months:r,weeks:s,days:a,hours:o,minutes:l,seconds:c}){let d=0;t&&(d+=t*n.daysInYear),r&&(d+=r*(n.daysInYear/12)),s&&(d+=s*7),a&&(d+=a);let h=d*24*60*60;return o&&(h+=o*60*60),l&&(h+=l*60),c&&(h+=c),Math.trunc(h*1e3)}return rj}var sj={},II;function one(){if(II)return sj;II=1,sj.millisecondsToHours=e;var n=Qt();function e(t){const r=t/n.millisecondsInHour;return Math.trunc(r)}return sj}var ij={},AI;function lne(){if(AI)return ij;AI=1,ij.millisecondsToMinutes=e;var n=Qt();function e(t){const r=t/n.millisecondsInMinute;return Math.trunc(r)}return ij}var aj={},RI;function cne(){if(RI)return aj;RI=1,aj.millisecondsToSeconds=e;var n=Qt();function e(t){const r=t/n.millisecondsInSecond;return Math.trunc(r)}return aj}var oj={},LI;function dne(){if(LI)return oj;LI=1,oj.minutesToHours=e;var n=Qt();function e(t){const r=t/n.minutesInHour;return Math.trunc(r)}return oj}var lj={},FI;function une(){if(FI)return lj;FI=1,lj.minutesToMilliseconds=e;var n=Qt();function e(t){return Math.trunc(t*n.millisecondsInMinute)}return lj}var cj={},qI;function fne(){if(qI)return cj;qI=1,cj.minutesToSeconds=e;var n=Qt();function e(t){return Math.trunc(t*n.secondsInMinute)}return cj}var dj={},zI;function hne(){if(zI)return dj;zI=1,dj.monthsToQuarters=e;var n=Qt();function e(t){const r=t/n.monthsInQuarter;return Math.trunc(r)}return dj}var uj={},UI;function mne(){if(UI)return uj;UI=1,uj.monthsToYears=e;var n=Qt();function e(t){const r=t/n.monthsInYear;return Math.trunc(r)}return uj}var fj={},VI;function nd(){if(VI)return fj;VI=1,fj.nextDay=t;var n=Ml(),e=py();function t(r,s){let a=s-(0,e.getDay)(r);return a<=0&&(a+=7),(0,n.addDays)(r,a)}return fj}var hj={},BI;function pne(){if(BI)return hj;BI=1,hj.nextFriday=e;var n=nd();function e(t){return(0,n.nextDay)(t,5)}return hj}var mj={},WI;function gne(){if(WI)return mj;WI=1,mj.nextMonday=e;var n=nd();function e(t){return(0,n.nextDay)(t,1)}return mj}var pj={},$I;function xne(){if($I)return pj;$I=1,pj.nextSaturday=e;var n=nd();function e(t){return(0,n.nextDay)(t,6)}return pj}var gj={},HI;function yne(){if(HI)return gj;HI=1,gj.nextSunday=e;var n=nd();function e(t){return(0,n.nextDay)(t,0)}return gj}var xj={},YI;function vne(){if(YI)return xj;YI=1,xj.nextThursday=e;var n=nd();function e(t){return(0,n.nextDay)(t,4)}return xj}var yj={},GI;function bne(){if(GI)return yj;GI=1,yj.nextTuesday=e;var n=nd();function e(t){return(0,n.nextDay)(t,2)}return yj}var vj={},ZI;function _ne(){if(ZI)return vj;ZI=1,vj.nextWednesday=e;var n=nd();function e(t){return(0,n.nextDay)(t,3)}return vj}var bj={},KI;function wne(){if(KI)return bj;KI=1,bj.parseISO=e;var n=Qt();function e(O,I){const q=I?.additionalDigits??2,F=o(O);let B;if(F.date){const se=l(F.date,q);B=c(se.restDateString,se.year)}if(!B||isNaN(B.getTime()))return new Date(NaN);const U=B.getTime();let W=0,$;if(F.time&&(W=h(F.time),isNaN(W)))return new Date(NaN);if(F.timezone){if($=x(F.timezone),isNaN($))return new Date(NaN)}else{const se=new Date(U+W),Y=new Date(0);return Y.setFullYear(se.getUTCFullYear(),se.getUTCMonth(),se.getUTCDate()),Y.setHours(se.getUTCHours(),se.getUTCMinutes(),se.getUTCSeconds(),se.getUTCMilliseconds()),Y}return new Date(U+W+$)}const t={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},r=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,s=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,a=/^([+-])(\d{2})(?::?(\d{2}))?$/;function o(O){const I={},q=O.split(t.dateTimeDelimiter);let F;if(q.length>2)return I;if(/:/.test(q[0])?F=q[0]:(I.date=q[0],F=q[1],t.timeZoneDelimiter.test(I.date)&&(I.date=O.split(t.timeZoneDelimiter)[0],F=O.substr(I.date.length,O.length))),F){const B=t.timezone.exec(F);B?(I.time=F.replace(B[1],""),I.timezone=B[1]):I.time=F}return I}function l(O,I){const q=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+I)+"})|(\\d{2}|[+-]\\d{"+(2+I)+"})$)"),F=O.match(q);if(!F)return{year:NaN,restDateString:""};const B=F[1]?parseInt(F[1]):null,U=F[2]?parseInt(F[2]):null;return{year:U===null?B:U*100,restDateString:O.slice((F[1]||F[2]).length)}}function c(O,I){if(I===null)return new Date(NaN);const q=O.match(r);if(!q)return new Date(NaN);const F=!!q[4],B=d(q[1]),U=d(q[2])-1,W=d(q[3]),$=d(q[4]),se=d(q[5])-1;if(F)return P(I,$,se)?v(I,$,se):new Date(NaN);{const Y=new Date(0);return!j(I,U,W)||!T(I,B)?new Date(NaN):(Y.setUTCFullYear(I,U,Math.max(B,W)),Y)}}function d(O){return O?parseInt(O):1}function h(O){const I=O.match(s);if(!I)return NaN;const q=p(I[1]),F=p(I[2]),B=p(I[3]);return E(q,F,B)?q*n.millisecondsInHour+F*n.millisecondsInMinute+B*1e3:NaN}function p(O){return O&&parseFloat(O.replace(",","."))||0}function x(O){if(O==="Z")return 0;const I=O.match(a);if(!I)return 0;const q=I[1]==="+"?-1:1,F=parseInt(I[2]),B=I[3]&&parseInt(I[3])||0;return M(F,B)?q*(F*n.millisecondsInHour+B*n.millisecondsInMinute):NaN}function v(O,I,q){const F=new Date(0);F.setUTCFullYear(O,0,4);const B=F.getUTCDay()||7,U=(I-1)*7+q+1-B;return F.setUTCDate(F.getUTCDate()+U),F}const _=[31,null,31,30,31,30,31,31,30,31,30,31];function w(O){return O%400===0||O%4===0&&O%100!==0}function j(O,I,q){return I>=0&&I<=11&&q>=1&&q<=(_[I]||(w(O)?29:28))}function T(O,I){return I>=1&&I<=(w(O)?366:365)}function P(O,I,q){return I>=1&&I<=53&&q>=0&&q<=6}function E(O,I,q){return O===24?I===0&&q===0:q>=0&&q<60&&I>=0&&I<60&&O>=0&&O<25}function M(O,I){return I>=0&&I<=59}return bj}var _j={},JI;function jne(){if(JI)return _j;JI=1,_j.parseJSON=n;function n(e){const t=e.match(/(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})(?:\.(\d{0,7}))?(?:Z|(.)(\d{2}):?(\d{2})?)?/);return t?new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4]-(+t[9]||0)*(t[8]=="-"?-1:1),+t[5]-(+t[10]||0)*(t[8]=="-"?-1:1),+t[6],+((t[7]||"0")+"00").substring(0,3))):new Date(NaN)}return _j}var wj={},QI;function rd(){if(QI)return wj;QI=1,wj.previousDay=t;var n=py(),e=xy();function t(r,s){let a=(0,n.getDay)(r)-s;return a<=0&&(a+=7),(0,e.subDays)(r,a)}return wj}var jj={},XI;function Nne(){if(XI)return jj;XI=1,jj.previousFriday=e;var n=rd();function e(t){return(0,n.previousDay)(t,5)}return jj}var Nj={},eA;function Sne(){if(eA)return Nj;eA=1,Nj.previousMonday=e;var n=rd();function e(t){return(0,n.previousDay)(t,1)}return Nj}var Sj={},tA;function Cne(){if(tA)return Sj;tA=1,Sj.previousSaturday=e;var n=rd();function e(t){return(0,n.previousDay)(t,6)}return Sj}var Cj={},nA;function Tne(){if(nA)return Cj;nA=1,Cj.previousSunday=e;var n=rd();function e(t){return(0,n.previousDay)(t,0)}return Cj}var Tj={},rA;function kne(){if(rA)return Tj;rA=1,Tj.previousThursday=e;var n=rd();function e(t){return(0,n.previousDay)(t,4)}return Tj}var kj={},sA;function Pne(){if(sA)return kj;sA=1,kj.previousTuesday=e;var n=rd();function e(t){return(0,n.previousDay)(t,2)}return kj}var Pj={},iA;function Mne(){if(iA)return Pj;iA=1,Pj.previousWednesday=e;var n=rd();function e(t){return(0,n.previousDay)(t,3)}return Pj}var Mj={},aA;function Dne(){if(aA)return Mj;aA=1,Mj.quartersToMonths=e;var n=Qt();function e(t){return Math.trunc(t*n.monthsInQuarter)}return Mj}var Dj={},oA;function Ene(){if(oA)return Dj;oA=1,Dj.quartersToYears=e;var n=Qt();function e(t){const r=t/n.quartersInYear;return Math.trunc(r)}return Dj}var Ej={},lA;function One(){if(lA)return Ej;lA=1,Ej.roundToNearestHours=r;var n=td(),e=un(),t=Re();function r(s,a){const o=a?.nearestTo??1;if(o<1||o>12)return(0,e.constructFrom)(s,NaN);const l=(0,t.toDate)(s),c=l.getMinutes()/60,d=l.getSeconds()/60/60,h=l.getMilliseconds()/1e3/60/60,p=l.getHours()+c+d+h,x=a?.roundingMethod??"round",_=(0,n.getRoundingMethod)(x)(p/o)*o,w=(0,e.constructFrom)(s,l);return w.setHours(_,0,0,0),w}return Ej}var Oj={},cA;function Ine(){if(cA)return Oj;cA=1,Oj.roundToNearestMinutes=r;var n=td(),e=un(),t=Re();function r(s,a){const o=a?.nearestTo??1;if(o<1||o>30)return(0,e.constructFrom)(s,NaN);const l=(0,t.toDate)(s),c=l.getSeconds()/60,d=l.getMilliseconds()/1e3/60,h=l.getMinutes()+c+d,p=a?.roundingMethod??"round",v=(0,n.getRoundingMethod)(p)(h/o)*o,_=(0,e.constructFrom)(s,l);return _.setMinutes(v,0,0),_}return Oj}var Ij={},dA;function Ane(){if(dA)return Ij;dA=1,Ij.secondsToHours=e;var n=Qt();function e(t){const r=t/n.secondsInHour;return Math.trunc(r)}return Ij}var Aj={},uA;function Rne(){if(uA)return Aj;uA=1,Aj.secondsToMilliseconds=e;var n=Qt();function e(t){return t*n.millisecondsInSecond}return Aj}var Rj={},fA;function Lne(){if(fA)return Rj;fA=1,Rj.secondsToMinutes=e;var n=Qt();function e(t){const r=t/n.secondsInMinute;return Math.trunc(r)}return Rj}var Lj={},Fj={},hA;function QC(){if(hA)return Fj;hA=1,Fj.setMonth=r;var n=un(),e=h5(),t=Re();function r(s,a){const o=(0,t.toDate)(s),l=o.getFullYear(),c=o.getDate(),d=(0,n.constructFrom)(s,0);d.setFullYear(l,a,15),d.setHours(0,0,0,0);const h=(0,e.getDaysInMonth)(d);return o.setMonth(a,Math.min(c,h)),o}return Fj}var mA;function Fne(){if(mA)return Lj;mA=1,Lj.set=r;var n=un(),e=QC(),t=Re();function r(s,a){let o=(0,t.toDate)(s);return isNaN(+o)?(0,n.constructFrom)(s,NaN):(a.year!=null&&o.setFullYear(a.year),a.month!=null&&(o=(0,e.setMonth)(o,a.month)),a.date!=null&&o.setDate(a.date),a.hours!=null&&o.setHours(a.hours),a.minutes!=null&&o.setMinutes(a.minutes),a.seconds!=null&&o.setSeconds(a.seconds),a.milliseconds!=null&&o.setMilliseconds(a.milliseconds),o)}return Lj}var qj={},pA;function qne(){if(pA)return qj;pA=1,qj.setDate=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setDate(r),s}return qj}var zj={},gA;function zne(){if(gA)return zj;gA=1,zj.setDayOfYear=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setMonth(0),s.setDate(r),s}return zj}var Uj={},xA;function Une(){if(xA)return Uj;xA=1,Uj.setDefaultOptions=e;var n=Ss();function e(t){const r={},s=(0,n.getDefaultOptions)();for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&(r[a]=s[a]);for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(t[a]===void 0?delete r[a]:r[a]=t[a]);(0,n.setDefaultOptions)(r)}return Uj}var Vj={},yA;function Vne(){if(yA)return Vj;yA=1,Vj.setHours=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setHours(r),s}return Vj}var Bj={},vA;function Bne(){if(vA)return Bj;vA=1,Bj.setMilliseconds=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setMilliseconds(r),s}return Bj}var Wj={},bA;function Wne(){if(bA)return Wj;bA=1,Wj.setMinutes=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setMinutes(r),s}return Wj}var $j={},_A;function $ne(){if(_A)return $j;_A=1,$j.setQuarter=t;var n=QC(),e=Re();function t(r,s){const a=(0,e.toDate)(r),o=Math.trunc(a.getMonth()/3)+1,l=s-o;return(0,n.setMonth)(a,a.getMonth()+l*3)}return $j}var Hj={},wA;function Hne(){if(wA)return Hj;wA=1,Hj.setSeconds=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setSeconds(r),s}return Hj}var Yj={},jA;function Yne(){if(jA)return Yj;jA=1,Yj.setWeekYear=a;var n=un(),e=Xc(),t=ZC(),r=Re(),s=Ss();function a(o,l,c){const d=(0,s.getDefaultOptions)(),h=c?.firstWeekContainsDate??c?.locale?.options?.firstWeekContainsDate??d.firstWeekContainsDate??d.locale?.options?.firstWeekContainsDate??1;let p=(0,r.toDate)(o);const x=(0,e.differenceInCalendarDays)(p,(0,t.startOfWeekYear)(p,c)),v=(0,n.constructFrom)(o,0);return v.setFullYear(l,0,h),v.setHours(0,0,0,0),p=(0,t.startOfWeekYear)(v,c),p.setDate(p.getDate()+x),p}return Yj}var Gj={},NA;function Gne(){if(NA)return Gj;NA=1,Gj.setYear=t;var n=un(),e=Re();function t(r,s){const a=(0,e.toDate)(r);return isNaN(+a)?(0,n.constructFrom)(r,NaN):(a.setFullYear(s),a)}return Gj}var Zj={},SA;function Zne(){if(SA)return Zj;SA=1,Zj.startOfDecade=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=Math.floor(s/10)*10;return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}return Zj}var Kj={},CA;function Kne(){if(CA)return Kj;CA=1,Kj.startOfToday=e;var n=ly();function e(){return(0,n.startOfDay)(Date.now())}return Kj}var Jj={},TA;function Jne(){if(TA)return Jj;TA=1,Jj.startOfTomorrow=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s+1),a.setHours(0,0,0,0),a}return Jj}var Qj={},kA;function Qne(){if(kA)return Qj;kA=1,Qj.startOfYesterday=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s-1),a.setHours(0,0,0,0),a}return Qj}var Xj={},eN={},PA;function I5(){if(PA)return eN;PA=1,eN.subMonths=e;var n=Tm();function e(t,r){return(0,n.addMonths)(t,-r)}return eN}var MA;function Xne(){if(MA)return Xj;MA=1,Xj.sub=r;var n=xy(),e=I5(),t=un();function r(s,a){const{years:o=0,months:l=0,weeks:c=0,days:d=0,hours:h=0,minutes:p=0,seconds:x=0}=a,v=(0,e.subMonths)(s,l+o*12),_=(0,n.subDays)(v,d+c*7),w=p+h*60,T=(x+w*60)*1e3;return(0,t.constructFrom)(s,_.getTime()-T)}return Xj}var tN={},DA;function ere(){if(DA)return tN;DA=1,tN.subBusinessDays=e;var n=U3();function e(t,r){return(0,n.addBusinessDays)(t,-r)}return tN}var nN={},EA;function tre(){if(EA)return nN;EA=1,nN.subHours=e;var n=OC();function e(t,r){return(0,n.addHours)(t,-r)}return nN}var rN={},OA;function nre(){if(OA)return rN;OA=1,rN.subMilliseconds=e;var n=km();function e(t,r){return(0,n.addMilliseconds)(t,-r)}return rN}var sN={},IA;function rre(){if(IA)return sN;IA=1,sN.subMinutes=e;var n=IC();function e(t,r){return(0,n.addMinutes)(t,-r)}return sN}var iN={},AA;function sre(){if(AA)return iN;AA=1,iN.subQuarters=e;var n=AC();function e(t,r){return(0,n.addQuarters)(t,-r)}return iN}var aN={},RA;function ire(){if(RA)return aN;RA=1,aN.subSeconds=e;var n=W3();function e(t,r){return(0,n.addSeconds)(t,-r)}return aN}var oN={},LA;function are(){if(LA)return oN;LA=1,oN.subWeeks=e;var n=cy();function e(t,r){return(0,n.addWeeks)(t,-r)}return oN}var lN={},FA;function ore(){if(FA)return lN;FA=1,lN.subYears=e;var n=$3();function e(t,r){return(0,n.addYears)(t,-r)}return lN}var cN={},qA;function lre(){if(qA)return cN;qA=1,cN.weeksToDays=e;var n=Qt();function e(t){return Math.trunc(t*n.daysInWeek)}return cN}var dN={},zA;function cre(){if(zA)return dN;zA=1,dN.yearsToDays=e;var n=Qt();function e(t){return Math.trunc(t*n.daysInYear)}return dN}var uN={},UA;function dre(){if(UA)return uN;UA=1,uN.yearsToMonths=e;var n=Qt();function e(t){return Math.trunc(t*n.monthsInYear)}return uN}var fN={},VA;function ure(){if(VA)return fN;VA=1,fN.yearsToQuarters=e;var n=Qt();function e(t){return Math.trunc(t*n.quartersInYear)}return fN}var BA;function _u(){return BA||(BA=1,(function(n){var e=F3();Object.keys(e).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===e[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return e[g]}})});var t=U3();Object.keys(t).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===t[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return t[g]}})});var r=Ml();Object.keys(r).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===r[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return r[g]}})});var s=OC();Object.keys(s).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===s[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return s[g]}})});var a=B3();Object.keys(a).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===a[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return a[g]}})});var o=km();Object.keys(o).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===o[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return o[g]}})});var l=IC();Object.keys(l).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===l[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return l[g]}})});var c=Tm();Object.keys(c).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===c[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return c[g]}})});var d=AC();Object.keys(d).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===d[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return d[g]}})});var h=W3();Object.keys(h).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===h[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return h[g]}})});var p=cy();Object.keys(p).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===p[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return p[g]}})});var x=$3();Object.keys(x).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===x[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return x[g]}})});var v=IX();Object.keys(v).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===v[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return v[g]}})});var _=AX();Object.keys(_).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _[g]}})});var w=RX();Object.keys(w).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===w[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return w[g]}})});var j=LX();Object.keys(j).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===j[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return j[g]}})});var T=zf();Object.keys(T).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===T[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return T[g]}})});var P=FX();Object.keys(P).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===P[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return P[g]}})});var E=un();Object.keys(E).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===E[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return E[g]}})});var M=Gs();Object.keys(M).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===M[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return M[g]}})});var O=qX();Object.keys(O).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===O[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return O[g]}})});var I=zX();Object.keys(I).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===I[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return I[g]}})});var q=Xc();Object.keys(q).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===q[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return q[g]}})});var F=Z3();Object.keys(F).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===F[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return F[g]}})});var B=UX();Object.keys(B).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===B[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return B[g]}})});var U=RC();Object.keys(U).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===U[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return U[g]}})});var W=J3();Object.keys(W).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===W[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return W[g]}})});var $=LC();Object.keys($).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $[g]}})});var se=FC();Object.keys(se).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===se[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return se[g]}})});var Y=qC();Object.keys(Y).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Y[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Y[g]}})});var ae=zC();Object.keys(ae).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ae[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ae[g]}})});var J=VX();Object.keys(J).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===J[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return J[g]}})});var ee=dy();Object.keys(ee).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ee[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ee[g]}})});var X=UC();Object.keys(X).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===X[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return X[g]}})});var Z=uy();Object.keys(Z).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Z[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Z[g]}})});var oe=BX();Object.keys(oe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oe[g]}})});var H=fy();Object.keys(H).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===H[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return H[g]}})});var Q=WX();Object.keys(Q).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Q[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Q[g]}})});var ne=e5();Object.keys(ne).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ne[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ne[g]}})});var de=t5();Object.keys(de).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===de[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return de[g]}})});var ce=$X();Object.keys(ce).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ce[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ce[g]}})});var pe=HX();Object.keys(pe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pe[g]}})});var ie=YX();Object.keys(ie).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ie[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ie[g]}})});var xe=GX();Object.keys(xe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xe[g]}})});var Ce=ZX();Object.keys(Ce).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ce[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ce[g]}})});var ve=HC();Object.keys(ve).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ve[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ve[g]}})});var Oe=KX();Object.keys(Oe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oe[g]}})});var Pe=JX();Object.keys(Pe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pe[g]}})});var Ie=QX();Object.keys(Ie).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ie[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ie[g]}})});var Fe=VC();Object.keys(Fe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fe[g]}})});var _e=XX();Object.keys(_e).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_e[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _e[g]}})});var Ne=eee();Object.keys(Ne).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ne[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ne[g]}})});var Ue=tee();Object.keys(Ue).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ue[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ue[g]}})});var Be=nee();Object.keys(Be).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Be[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Be[g]}})});var qe=ree();Object.keys(qe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qe[g]}})});var te=BC();Object.keys(te).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===te[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return te[g]}})});var le=see();Object.keys(le).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===le[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return le[g]}})});var ye=iee();Object.keys(ye).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ye[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ye[g]}})});var Ve=aee();Object.keys(Ve).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ve[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ve[g]}})});var ze=oee();Object.keys(ze).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ze[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ze[g]}})});var Le=r5();Object.keys(Le).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Le[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Le[g]}})});var rt=n5();Object.keys(rt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===rt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return rt[g]}})});var Xe=lee();Object.keys(Xe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xe[g]}})});var tt=c5();Object.keys(tt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===tt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return tt[g]}})});var qt=d5();Object.keys(qt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qt[g]}})});var bt=u5();Object.keys(bt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bt[g]}})});var Dt=vee();Object.keys(Dt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Dt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Dt[g]}})});var Xt=bee();Object.keys(Xt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xt[g]}})});var en=_ee();Object.keys(en).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===en[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return en[g]}})});var Yt=wee();Object.keys(Yt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yt[g]}})});var Ut=jee();Object.keys(Ut).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ut[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ut[g]}})});var Rn=Nee();Object.keys(Rn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rn[g]}})});var Nn=See();Object.keys(Nn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Nn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Nn[g]}})});var an=Cee();Object.keys(an).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===an[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return an[g]}})});var rr=Tee();Object.keys(rr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===rr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return rr[g]}})});var Hn=kee();Object.keys(Hn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Hn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Hn[g]}})});var lt=f5();Object.keys(lt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===lt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return lt[g]}})});var Vn=py();Object.keys(Vn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vn[g]}})});var br=i5();Object.keys(br).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===br[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return br[g]}})});var vn=h5();Object.keys(vn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vn[g]}})});var ds=Pee();Object.keys(ds).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ds[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ds[g]}})});var Zs=Mee();Object.keys(Zs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zs[g]}})});var Yr=p5();Object.keys(Yr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yr[g]}})});var Qi=Dee();Object.keys(Qi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qi[g]}})});var Ra=g5();Object.keys(Ra).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ra[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ra[g]}})});var Xi=GC();Object.keys(Xi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xi[g]}})});var ko=bu();Object.keys(ko).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ko[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ko[g]}})});var ea=Eee();Object.keys(ea).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ea[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ea[g]}})});var ad=Oee();Object.keys(ad).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ad[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ad[g]}})});var dr=Iee();Object.keys(dr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dr[g]}})});var dt=Aee();Object.keys(dt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dt[g]}})});var ta=Ree();Object.keys(ta).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ta[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ta[g]}})});var La=K3();Object.keys(La).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===La[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return La[g]}})});var El=Lee();Object.keys(El).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===El[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return El[g]}})});var Ol=Fee();Object.keys(Ol).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ol[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ol[g]}})});var Po=qee();Object.keys(Po).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Po[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Po[g]}})});var Ts=KC();Object.keys(Ts).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ts[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ts[g]}})});var Ks=zee();Object.keys(Ks).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ks[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ks[g]}})});var Mo=my();Object.keys(Mo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mo[g]}})});var od=Uee();Object.keys(od).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===od[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return od[g]}})});var Il=Vee();Object.keys(Il).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Il[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Il[g]}})});var Al=Bee();Object.keys(Al).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Al[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Al[g]}})});var Rl=Wee();Object.keys(Rl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rl[g]}})});var Do=$ee();Object.keys(Do).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Do[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Do[g]}})});var ld=Hee();Object.keys(ld).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ld[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ld[g]}})});var Fa=Yee();Object.keys(Fa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fa[g]}})});var Cn=Gee();Object.keys(Cn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Cn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Cn[g]}})});var cd=Zee();Object.keys(cd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===cd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return cd[g]}})});var Eo=Kee();Object.keys(Eo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Eo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Eo[g]}})});var Ll=Jee();Object.keys(Ll).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ll[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ll[g]}})});var qa=G3();Object.keys(qa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qa[g]}})});var Oo=Qee();Object.keys(Oo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oo[g]}})});var vi=Xee();Object.keys(vi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vi[g]}})});var na=ete();Object.keys(na).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===na[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return na[g]}})});var Ar=tte();Object.keys(Ar).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ar[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ar[g]}})});var ra=nte();Object.keys(ra).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ra[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ra[g]}})});var Et=X3();Object.keys(Et).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Et[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Et[g]}})});var bn=m5();Object.keys(bn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bn[g]}})});var za=Ate();Object.keys(za).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===za[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return za[g]}})});var bi=Rte();Object.keys(bi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bi[g]}})});var us=Lte();Object.keys(us).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===us[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return us[g]}})});var _i=Mm();Object.keys(_i).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_i[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _i[g]}})});var Mt=S5();Object.keys(Mt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mt[g]}})});var gn=C5();Object.keys(gn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gn[g]}})});var Io=Fte();Object.keys(Io).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Io[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Io[g]}})});var Ua=T5();Object.keys(Ua).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ua[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ua[g]}})});var ur=k5();Object.keys(ur).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ur[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ur[g]}})});var Fl=P5();Object.keys(Fl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fl[g]}})});var wi=D5();Object.keys(wi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wi[g]}})});var Rr=JC();Object.keys(Rr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rr[g]}})});var En=E5();Object.keys(En).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===En[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return En[g]}})});var fs=q3();Object.keys(fs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fs[g]}})});var Kt=z3();Object.keys(Kt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Kt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Kt[g]}})});var ji=qte();Object.keys(ji).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ji[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ji[g]}})});var Va=zte();Object.keys(Va).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Va[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Va[g]}})});var Js=Ute();Object.keys(Js).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Js[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Js[g]}})});var Ba=Vte();Object.keys(Ba).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ba[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ba[g]}})});var Wa=Bte();Object.keys(Wa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wa[g]}})});var sa=Wte();Object.keys(sa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===sa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return sa[g]}})});var ia=$te();Object.keys(ia).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ia[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ia[g]}})});var Ni=Hte();Object.keys(Ni).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ni[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ni[g]}})});var Lr=Yte();Object.keys(Lr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Lr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Lr[g]}})});var hs=Gte();Object.keys(hs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hs[g]}})});var Gr=Zte();Object.keys(Gr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gr[g]}})});var aa=Kte();Object.keys(aa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===aa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return aa[g]}})});var Ct=ed();Object.keys(Ct).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ct[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ct[g]}})});var Yn=Jte();Object.keys(Yn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yn[g]}})});var ln=oy();Object.keys(ln).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ln[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ln[g]}})});var Ao=Qte();Object.keys(Ao).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ao[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ao[g]}})});var Qs=Xte();Object.keys(Qs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qs[g]}})});var Ro=ene();Object.keys(Ro).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ro[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ro[g]}})});var $a=tne();Object.keys($a).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$a[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $a[g]}})});var Zr=nne();Object.keys(Zr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zr[g]}})});var Ha=x5();Object.keys(Ha).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ha[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ha[g]}})});var oa=rne();Object.keys(oa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oa[g]}})});var Tn=O5();Object.keys(Tn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Tn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Tn[g]}})});var Fr=sne();Object.keys(Fr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fr[g]}})});var Xs=ine();Object.keys(Xs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xs[g]}})});var la=H3();Object.keys(la).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===la[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return la[g]}})});var dd=ane();Object.keys(dd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dd[g]}})});var ql=one();Object.keys(ql).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ql[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ql[g]}})});var ca=lne();Object.keys(ca).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ca[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ca[g]}})});var Ya=cne();Object.keys(Ya).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ya[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ya[g]}})});var Ga=Y3();Object.keys(Ga).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ga[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ga[g]}})});var Ht=dne();Object.keys(Ht).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ht[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ht[g]}})});var ks=une();Object.keys(ks).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ks[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ks[g]}})});var _r=fne();Object.keys(_r).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_r[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _r[g]}})});var Ps=hne();Object.keys(Ps).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ps[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ps[g]}})});var Lo=mne();Object.keys(Lo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Lo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Lo[g]}})});var Za=nd();Object.keys(Za).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Za[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Za[g]}})});var Si=pne();Object.keys(Si).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Si[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Si[g]}})});var zl=gne();Object.keys(zl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zl[g]}})});var fr=xne();Object.keys(fr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fr[g]}})});var Ci=yne();Object.keys(Ci).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ci[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ci[g]}})});var Fo=vne();Object.keys(Fo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fo[g]}})});var ei=bne();Object.keys(ei).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ei[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ei[g]}})});var ud=_ne();Object.keys(ud).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ud[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ud[g]}})});var Mr=j5();Object.keys(Mr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mr[g]}})});var qo=wne();Object.keys(qo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qo[g]}})});var Ti=jne();Object.keys(Ti).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ti[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ti[g]}})});var qr=rd();Object.keys(qr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qr[g]}})});var zo=Nne();Object.keys(zo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zo[g]}})});var Ul=Sne();Object.keys(Ul).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ul[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ul[g]}})});var Uo=Cne();Object.keys(Uo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Uo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Uo[g]}})});var fd=Tne();Object.keys(fd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fd[g]}})});var Ka=kne();Object.keys(Ka).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ka[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ka[g]}})});var Vl=Pne();Object.keys(Vl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vl[g]}})});var hd=Mne();Object.keys(hd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hd[g]}})});var md=Dne();Object.keys(md).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===md[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return md[g]}})});var Vo=Ene();Object.keys(Vo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vo[g]}})});var pd=One();Object.keys(pd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pd[g]}})});var Bo=Ine();Object.keys(Bo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bo[g]}})});var Bl=Ane();Object.keys(Bl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bl[g]}})});var Ja=Rne();Object.keys(Ja).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ja[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ja[g]}})});var ti=Lne();Object.keys(ti).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ti[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ti[g]}})});var gd=Fne();Object.keys(gd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gd[g]}})});var ni=qne();Object.keys(ni).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ni[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ni[g]}})});var Dr=gy();Object.keys(Dr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Dr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Dr[g]}})});var Wl=zne();Object.keys(Wl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wl[g]}})});var $l=Une();Object.keys($l).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$l[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $l[g]}})});var Hl=Vne();Object.keys(Hl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Hl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Hl[g]}})});var Wo=w5();Object.keys(Wo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wo[g]}})});var $o=_5();Object.keys($o).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$o[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $o[g]}})});var xd=V3();Object.keys(xd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xd[g]}})});var yd=Bne();Object.keys(yd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===yd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return yd[g]}})});var Yl=Wne();Object.keys(Yl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yl[g]}})});var vd=QC();Object.keys(vd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vd[g]}})});var zr=$ne();Object.keys(zr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zr[g]}})});var Ms=Hne();Object.keys(Ms).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ms[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ms[g]}})});var da=b5();Object.keys(da).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===da[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return da[g]}})});var ms=Yne();Object.keys(ms).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ms[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ms[g]}})});var Gl=Gne();Object.keys(Gl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gl[g]}})});var ri=ly();Object.keys(ri).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ri[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ri[g]}})});var Zl=Zne();Object.keys(Zl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zl[g]}})});var ki=N5();Object.keys(ki).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ki[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ki[g]}})});var Ho=Dl();Object.keys(Ho).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ho[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ho[g]}})});var ps=Pm();Object.keys(ps).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ps[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ps[g]}})});var bd=WC();Object.keys(bd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bd[g]}})});var Ds=hy();Object.keys(Ds).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ds[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ds[g]}})});var Qa=$C();Object.keys(Qa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qa[g]}})});var Kl=M5();Object.keys(Kl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Kl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Kl[g]}})});var Xa=Kne();Object.keys(Xa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xa[g]}})});var ua=Jne();Object.keys(ua).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ua[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ua[g]}})});var wr=To();Object.keys(wr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wr[g]}})});var _d=ZC();Object.keys(_d).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_d[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _d[g]}})});var gs=YC();Object.keys(gs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gs[g]}})});var wd=Qne();Object.keys(wd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wd[g]}})});var Kr=Xne();Object.keys(Kr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Kr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Kr[g]}})});var Pi=ere();Object.keys(Pi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pi[g]}})});var eo=xy();Object.keys(eo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===eo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return eo[g]}})});var to=tre();Object.keys(to).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===to[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return to[g]}})});var fa=Q3();Object.keys(fa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fa[g]}})});var no=nre();Object.keys(no).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===no[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return no[g]}})});var ro=rre();Object.keys(ro).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ro[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ro[g]}})});var Mi=I5();Object.keys(Mi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mi[g]}})});var so=sre();Object.keys(so).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===so[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return so[g]}})});var Yo=ire();Object.keys(Yo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yo[g]}})});var Jl=are();Object.keys(Jl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jl[g]}})});var Ur=ore();Object.keys(Ur).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ur[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ur[g]}})});var Es=Re();Object.keys(Es).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Es[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Es[g]}})});var Ql=y5();Object.keys(Ql).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ql[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ql[g]}})});var Go=lre();Object.keys(Go).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Go[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Go[g]}})});var Xl=cre();Object.keys(Xl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xl[g]}})});var Zo=dre();Object.keys(Zo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zo[g]}})});var Ko=ure();Object.keys(Ko).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ko[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ko[g]}})})})(Pb)),Pb}var WA;function yy(){if(WA)return zd;WA=1,Object.defineProperty(zd,"__esModule",{value:!0}),zd.rangeShape=zd.default=void 0;var n=o(Ys()),e=s(Pl()),t=s(vu()),r=_u();function s(v){return v&&v.__esModule?v:{default:v}}function a(v){if(typeof WeakMap!="function")return null;var _=new WeakMap,w=new WeakMap;return(a=function(j){return j?w:_})(v)}function o(v,_){if(v&&v.__esModule)return v;if(v===null||typeof v!="object"&&typeof v!="function")return{default:v};var w=a(_);if(w&&w.has(v))return w.get(v);var j={__proto__:null},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in v)if(P!=="default"&&Object.prototype.hasOwnProperty.call(v,P)){var E=T?Object.getOwnPropertyDescriptor(v,P):null;E&&(E.get||E.set)?Object.defineProperty(j,P,E):j[P]=v[P]}return j.default=v,w&&w.set(v,j),j}function l(){return l=Object.assign?Object.assign.bind():function(v){for(var _=1;_<arguments.length;_++){var w=arguments[_];for(var j in w)Object.prototype.hasOwnProperty.call(w,j)&&(v[j]=w[j])}return v},l.apply(this,arguments)}function c(v,_,w){return _=d(_),_ in v?Object.defineProperty(v,_,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[_]=w,v}function d(v){var _=h(v,"string");return typeof _=="symbol"?_:String(_)}function h(v,_){if(typeof v!="object"||!v)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var j=w.call(v,_);if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(v)}let p=class extends n.Component{constructor(_,w){super(_,w),c(this,"handleKeyEvent",j=>{const{day:T,onMouseDown:P,onMouseUp:E}=this.props;[13,32].includes(j.keyCode)&&(j.type==="keydown"?P(T):E(T))}),c(this,"handleMouseEvent",j=>{const{day:T,disabled:P,onPreviewChange:E,onMouseEnter:M,onMouseDown:O,onMouseUp:I}=this.props,q={};if(P){E();return}switch(j.type){case"mouseenter":M(T),E(T),q.hover=!0;break;case"blur":case"mouseleave":q.hover=!1;break;case"mousedown":q.active=!0,O(T);break;case"mouseup":j.stopPropagation(),q.active=!1,I(T);break;case"focus":E(T);break}Object.keys(q).length&&this.setState(q)}),c(this,"getClassNames",()=>{const{isPassive:j,isToday:T,isWeekend:P,isStartOfWeek:E,isEndOfWeek:M,isStartOfMonth:O,isEndOfMonth:I,disabled:q,styles:F}=this.props;return(0,t.default)(F.day,{[F.dayPassive]:j,[F.dayDisabled]:q,[F.dayToday]:T,[F.dayWeekend]:P,[F.dayStartOfWeek]:E,[F.dayEndOfWeek]:M,[F.dayStartOfMonth]:O,[F.dayEndOfMonth]:I,[F.dayHovered]:this.state.hover,[F.dayActive]:this.state.active})}),c(this,"renderPreviewPlaceholder",()=>{const{preview:j,day:T,styles:P}=this.props;if(!j)return null;const E=j.startDate?(0,r.endOfDay)(j.startDate):null,M=j.endDate?(0,r.startOfDay)(j.endDate):null,O=(!E||(0,r.isAfter)(T,E))&&(!M||(0,r.isBefore)(T,M)),I=!O&&(0,r.isSameDay)(T,E),q=!O&&(0,r.isSameDay)(T,M);return n.default.createElement("span",{className:(0,t.default)({[P.dayStartPreview]:I,[P.dayInPreview]:O,[P.dayEndPreview]:q}),style:{color:j.color}})}),c(this,"renderSelectionPlaceholders",()=>{const{styles:j,ranges:T,day:P}=this.props;return this.props.displayMode==="date"?(0,r.isSameDay)(this.props.day,this.props.date)?n.default.createElement("span",{className:j.selected,style:{color:this.props.color}}):null:T.reduce((M,O)=>{let I=O.startDate,q=O.endDate;I&&q&&(0,r.isBefore)(q,I)&&([I,q]=[q,I]),I=I?(0,r.endOfDay)(I):null,q=q?(0,r.startOfDay)(q):null;const F=(!I||(0,r.isAfter)(P,I))&&(!q||(0,r.isBefore)(P,q)),B=!F&&(0,r.isSameDay)(P,I),U=!F&&(0,r.isSameDay)(P,q);return F||B||U?[...M,{isStartEdge:B,isEndEdge:U,isInRange:F,...O}]:M},[]).map((M,O)=>n.default.createElement("span",{key:O,className:(0,t.default)({[j.startEdge]:M.isStartEdge,[j.endEdge]:M.isEndEdge,[j.inRange]:M.isInRange}),style:{color:M.color||this.props.color}}))}),this.state={hover:!1,active:!1}}render(){const{dayContentRenderer:_}=this.props;return n.default.createElement("button",l({type:"button",onMouseEnter:this.handleMouseEvent,onMouseLeave:this.handleMouseEvent,onFocus:this.handleMouseEvent,onMouseDown:this.handleMouseEvent,onMouseUp:this.handleMouseEvent,onBlur:this.handleMouseEvent,onPauseCapture:this.handleMouseEvent,onKeyDown:this.handleKeyEvent,onKeyUp:this.handleKeyEvent,className:this.getClassNames(this.props.styles)},this.props.disabled||this.props.isPassive?{tabIndex:-1}:{},{style:{color:this.props.color}}),this.renderSelectionPlaceholders(),this.renderPreviewPlaceholder(),n.default.createElement("span",{className:this.props.styles.dayNumber},_?.(this.props.day)||n.default.createElement("span",null,(0,r.format)(this.props.day,this.props.dayDisplayFormat))))}};p.defaultProps={};const x=zd.rangeShape=e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string,key:e.default.string,autoFocus:e.default.bool,disabled:e.default.bool,showDateDisplay:e.default.bool});return p.propTypes={day:e.default.object.isRequired,dayDisplayFormat:e.default.string,date:e.default.object,ranges:e.default.arrayOf(x),preview:e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string}),onPreviewChange:e.default.func,previewColor:e.default.string,disabled:e.default.bool,isPassive:e.default.bool,isToday:e.default.bool,isWeekend:e.default.bool,isStartOfWeek:e.default.bool,isEndOfWeek:e.default.bool,isStartOfMonth:e.default.bool,isEndOfMonth:e.default.bool,color:e.default.string,displayMode:e.default.oneOf(["dateRange","date"]),styles:e.default.object,onMouseDown:e.default.func,onMouseUp:e.default.func,onMouseEnter:e.default.func,dayContentRenderer:e.default.func},zd.default=p,zd}var wh={},Ud={},$A;function vy(){if($A)return Ud;$A=1,Object.defineProperty(Ud,"__esModule",{value:!0}),Ud.calcFocusDate=r,Ud.findNextRangeIndex=s,Ud.generateStyles=o,Ud.getMonthDisplayRange=a;var n=t(vu()),e=_u();function t(l){return l&&l.__esModule?l:{default:l}}function r(l,c){const{shownDate:d,date:h,months:p,ranges:x,focusedRange:v,displayMode:_}=c;let w;if(_==="dateRange"){const T=x[v[0]]||{};w={start:T.startDate,end:T.endDate}}else w={start:h,end:h};w.start=(0,e.startOfMonth)(w.start||new Date),w.end=(0,e.endOfMonth)(w.end||w.start);const j=w.start||w.end||d||new Date;return l?(0,e.differenceInCalendarMonths)(w.start,w.end)>p?l:j:d||j}function s(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const d=l.findIndex((h,p)=>p>c&&h.autoFocus!==!1&&!h.disabled);return d!==-1?d:l.findIndex(h=>h.autoFocus!==!1&&!h.disabled)}function a(l,c,d){const h=(0,e.startOfMonth)(l,c),p=(0,e.endOfMonth)(l,c),x=(0,e.startOfWeek)(h,c);let v=(0,e.endOfWeek)(p,c);return d&&(0,e.differenceInCalendarDays)(v,x)<=34&&(v=(0,e.addDays)(v,7)),{start:x,end:v,startDateOfMonth:h,endDateOfMonth:p}}function o(l){return l.length?l.filter(d=>!!d).reduce((d,h)=>(Object.keys(h).forEach(p=>{d[p]=(0,n.default)(d[p],h[p])}),d),{}):{}}return Ud}var HA;function fre(){if(HA)return wh;HA=1,Object.defineProperty(wh,"__esModule",{value:!0}),wh.default=void 0;var n=l(Ys()),e=a(Pl()),t=l(yy()),r=_u(),s=vy();function a(p){return p&&p.__esModule?p:{default:p}}function o(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(o=function(_){return _?v:x})(p)}function l(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=o(x);if(v&&v.has(p))return v.get(p);var _={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var T=w?Object.getOwnPropertyDescriptor(p,j):null;T&&(T.get||T.set)?Object.defineProperty(_,j,T):_[j]=p[j]}return _.default=p,v&&v.set(p,_),_}function c(){return c=Object.assign?Object.assign.bind():function(p){for(var x=1;x<arguments.length;x++){var v=arguments[x];for(var _ in v)Object.prototype.hasOwnProperty.call(v,_)&&(p[_]=v[_])}return p},c.apply(this,arguments)}function d(p,x,v){const _=new Date;return n.default.createElement("div",{className:p.weekDays},(0,r.eachDayOfInterval)({start:(0,r.startOfWeek)(_,x),end:(0,r.endOfWeek)(_,x)}).map((w,j)=>n.default.createElement("span",{className:p.weekDay,key:j},(0,r.format)(w,v,x))))}let h=class extends n.PureComponent{render(){const x=new Date,{displayMode:v,focusedRange:_,drag:w,styles:j,disabledDates:T,disabledDay:P}=this.props,E=this.props.minDate&&(0,r.startOfDay)(this.props.minDate),M=this.props.maxDate&&(0,r.endOfDay)(this.props.maxDate),O=(0,s.getMonthDisplayRange)(this.props.month,this.props.dateOptions,this.props.fixedHeight);let I=this.props.ranges;if(v==="dateRange"&&w.status){let{startDate:F,endDate:B}=w.range;I=I.map((U,W)=>W!==_[0]?U:{...U,startDate:F,endDate:B})}const q=this.props.showPreview&&!w.disablePreview;return n.default.createElement("div",{className:j.month,style:this.props.style},this.props.showMonthName?n.default.createElement("div",{className:j.monthName},(0,r.format)(this.props.month,this.props.monthDisplayFormat,this.props.dateOptions)):null,this.props.showWeekDays&&d(j,this.props.dateOptions,this.props.weekdayDisplayFormat),n.default.createElement("div",{className:j.days,onMouseLeave:this.props.onMouseLeave},(0,r.eachDayOfInterval)({start:O.start,end:O.end}).map((F,B)=>{const U=(0,r.isSameDay)(F,O.startDateOfMonth),W=(0,r.isSameDay)(F,O.endDateOfMonth),$=E&&(0,r.isBefore)(F,E)||M&&(0,r.isAfter)(F,M),se=T.some(ae=>(0,r.isSameDay)(ae,F)),Y=P(F);return n.default.createElement(t.default,c({},this.props,{ranges:I,day:F,preview:q?this.props.preview:null,isWeekend:(0,r.isWeekend)(F,this.props.dateOptions),isToday:(0,r.isSameDay)(F,x),isStartOfWeek:(0,r.isSameDay)(F,(0,r.startOfWeek)(F,this.props.dateOptions)),isEndOfWeek:(0,r.isSameDay)(F,(0,r.endOfWeek)(F,this.props.dateOptions)),isStartOfMonth:U,isEndOfMonth:W,key:B,disabled:$||se||Y,isPassive:!(0,r.isWithinInterval)(F,{start:O.startDateOfMonth,end:O.endDateOfMonth}),styles:j,onMouseDown:this.props.onDragSelectionStart,onMouseUp:this.props.onDragSelectionEnd,onMouseEnter:this.props.onDragSelectionMove,dragRange:w.range,drag:w.status}))})))}};return h.defaultProps={},h.propTypes={style:e.default.object,styles:e.default.object,month:e.default.object,drag:e.default.object,dateOptions:e.default.object,disabledDates:e.default.array,disabledDay:e.default.func,preview:e.default.shape({startDate:e.default.object,endDate:e.default.object}),showPreview:e.default.bool,displayMode:e.default.oneOf(["dateRange","date"]),minDate:e.default.object,maxDate:e.default.object,ranges:e.default.arrayOf(t.rangeShape),focusedRange:e.default.arrayOf(e.default.number),onDragSelectionStart:e.default.func,onDragSelectionEnd:e.default.func,onDragSelectionMove:e.default.func,onMouseLeave:e.default.func,monthDisplayFormat:e.default.string,weekdayDisplayFormat:e.default.string,dayDisplayFormat:e.default.string,showWeekDays:e.default.bool,showMonthName:e.default.bool,fixedHeight:e.default.bool},wh.default=h,wh}var jh={},YA;function hre(){if(YA)return jh;YA=1,Object.defineProperty(jh,"__esModule",{value:!0}),jh.default=void 0;var n=o(Ys()),e=s(Pl()),t=s(vu()),r=_u();function s(p){return p&&p.__esModule?p:{default:p}}function a(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(a=function(_){return _?v:x})(p)}function o(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=a(x);if(v&&v.has(p))return v.get(p);var _={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var T=w?Object.getOwnPropertyDescriptor(p,j):null;T&&(T.get||T.set)?Object.defineProperty(_,j,T):_[j]=p[j]}return _.default=p,v&&v.set(p,_),_}function l(p,x,v){return x=c(x),x in p?Object.defineProperty(p,x,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[x]=v,p}function c(p){var x=d(p,"string");return typeof x=="symbol"?x:String(x)}function d(p,x){if(typeof p!="object"||!p)return p;var v=p[Symbol.toPrimitive];if(v!==void 0){var _=v.call(p,x);if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(p)}let h=class extends n.PureComponent{constructor(x,v){super(x,v),l(this,"onKeyDown",_=>{const{value:w}=this.state;_.key==="Enter"&&this.update(w)}),l(this,"onChange",_=>{this.setState({value:_.target.value,changed:!0,invalid:!1})}),l(this,"onBlur",()=>{const{value:_}=this.state;this.update(_)}),this.state={invalid:!1,changed:!1,value:this.formatDate(x)}}componentDidUpdate(x){const{value:v}=x;(0,r.isEqual)(v,this.props.value)||this.setState({value:this.formatDate(this.props)})}formatDate(x){let{value:v,dateDisplayFormat:_,dateOptions:w}=x;return v&&(0,r.isValid)(v)?(0,r.format)(v,_,w):""}update(x){const{invalid:v,changed:_}=this.state;if(v||!_||!x)return;const{onChange:w,dateDisplayFormat:j,dateOptions:T}=this.props,P=(0,r.parse)(x,j,new Date,T);(0,r.isValid)(P)?this.setState({changed:!1},()=>w(P)):this.setState({invalid:!0})}render(){const{className:x,readOnly:v,placeholder:_,ariaLabel:w,disabled:j,onFocus:T}=this.props,{value:P,invalid:E}=this.state;return n.default.createElement("span",{className:(0,t.default)("rdrDateInput",x)},n.default.createElement("input",{readOnly:v,disabled:j,value:P,placeholder:_,"aria-label":w,onKeyDown:this.onKeyDown,onChange:this.onChange,onBlur:this.onBlur,onFocus:T}),E&&n.default.createElement("span",{className:"rdrWarning"},""))}};return h.propTypes={value:e.default.object,placeholder:e.default.string,disabled:e.default.bool,readOnly:e.default.bool,dateOptions:e.default.object,dateDisplayFormat:e.default.string,ariaLabel:e.default.string,className:e.default.string,onFocus:e.default.func.isRequired,onChange:e.default.func.isRequired},h.defaultProps={readOnly:!0,disabled:!1,dateDisplayFormat:"MMM D, YYYY"},jh.default=h,jh}var Mg={},GA;function mre(){return GA||(GA=1,(function(n){(function(e,t){t(n,Ys(),zL())})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Mg,function(e,t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function s(Q){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne},s(Q)}function a(Q,ne){if(!(Q instanceof ne))throw new TypeError("Cannot call a class as a function")}function o(Q,ne){for(var de=0;de<ne.length;de++){var ce=ne[de];ce.enumerable=ce.enumerable||!1,ce.configurable=!0,"value"in ce&&(ce.writable=!0),Object.defineProperty(Q,P(ce.key),ce)}}function l(Q,ne,de){return ne&&o(Q.prototype,ne),de&&o(Q,de),Object.defineProperty(Q,"prototype",{writable:!1}),Q}function c(Q,ne,de){return ne=x(ne),d(Q,p()?Reflect.construct(ne,de||[],x(Q).constructor):ne.apply(Q,de))}function d(Q,ne){if(ne&&(s(ne)=="object"||typeof ne=="function"))return ne;if(ne!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(Q)}function h(Q){if(Q===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Q}function p(){try{var Q=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(p=function(){return!!Q})()}function x(Q){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ne){return ne.__proto__||Object.getPrototypeOf(ne)},x(Q)}function v(Q,ne){if(typeof ne!="function"&&ne!==null)throw new TypeError("Super expression must either be null or a function");Q.prototype=Object.create(ne&&ne.prototype,{constructor:{value:Q,writable:!0,configurable:!0}}),Object.defineProperty(Q,"prototype",{writable:!1}),ne&&_(Q,ne)}function _(Q,ne){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(de,ce){return de.__proto__=ce,de},_(Q,ne)}function w(Q,ne){var de=Object.keys(Q);if(Object.getOwnPropertySymbols){var ce=Object.getOwnPropertySymbols(Q);ne&&(ce=ce.filter(function(pe){return Object.getOwnPropertyDescriptor(Q,pe).enumerable})),de.push.apply(de,ce)}return de}function j(Q){for(var ne=1;ne<arguments.length;ne++){var de=arguments[ne]!=null?arguments[ne]:{};ne%2?w(Object(de),!0).forEach(function(ce){T(Q,ce,de[ce])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(de)):w(Object(de)).forEach(function(ce){Object.defineProperty(Q,ce,Object.getOwnPropertyDescriptor(de,ce))})}return Q}function T(Q,ne,de){return(ne=P(ne))in Q?Object.defineProperty(Q,ne,{value:de,enumerable:!0,configurable:!0,writable:!0}):Q[ne]=de,Q}function P(Q){var ne=E(Q,"string");return s(ne)=="symbol"?ne:ne+""}function E(Q,ne){if(s(Q)!="object"||!Q)return Q;var de=Q[Symbol.toPrimitive];if(de!==void 0){var ce=de.call(Q,ne);if(s(ce)!="object")return ce;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ne==="string"?String:Number)(Q)}var M={x:"clientWidth",y:"clientHeight"},O={x:"clientTop",y:"clientLeft"},I={x:"innerWidth",y:"innerHeight"},q={x:"offsetWidth",y:"offsetHeight"},F={x:"offsetLeft",y:"offsetTop"},B={x:"overflowX",y:"overflowY"},U={x:"scrollWidth",y:"scrollHeight"},W={x:"scrollLeft",y:"scrollTop"},$={x:"width",y:"height"},se=function(){},Y=(function(){if(typeof window>"u")return!1;var Q=!1;try{document.createElement("div").addEventListener("test",se,{get passive(){return Q=!0,!1}})}catch{}return Q})()?{passive:!0}:!1,ae="ReactList failed to reach a stable state.",J=40,ee=function(ne,de){for(var ce in de)if(ne[ce]!==de[ce])return!1;return!0},X=function(ne){for(var de=ne.props.axis,ce=ne.getEl(),pe=B[de];ce=ce.parentElement;)switch(window.getComputedStyle(ce)[pe]){case"auto":case"scroll":case"overlay":return ce}return window},Z=function(ne){var de=ne.props.axis,ce=ne.scrollParent;return ce===window?window[I[de]]:ce[M[de]]},oe=function(ne,de){var ce=ne.length,pe=ne.minSize,ie=ne.type,xe=de.from,Ce=de.size,ve=de.itemsPerRow;Ce=Math.max(Ce,pe);var Oe=Ce%ve;return Oe&&(Ce+=ve-Oe),Ce>ce&&(Ce=ce),xe=ie==="simple"||!xe?0:Math.max(Math.min(xe,ce-Ce),0),(Oe=xe%ve)&&(xe-=Oe,Ce+=Oe),xe===de.from&&Ce===de.size?de:j(j({},de),{},{from:xe,size:Ce})},H=e.default=(function(Q){function ne(de){var ce;return a(this,ne),ce=c(this,ne,[de]),ce.state=oe(de,{itemsPerRow:1,from:de.initialIndex,size:0}),ce.cache={},ce.cachedScrollPosition=null,ce.prevPrevState={},ce.unstable=!1,ce.updateCounter=0,ce}return v(ne,Q),l(ne,[{key:"componentDidMount",value:function(){this.updateFrameAndClearCache=this.updateFrameAndClearCache.bind(this),window.addEventListener("resize",this.updateFrameAndClearCache),this.updateFrame(this.scrollTo.bind(this,this.props.initialIndex))}},{key:"componentDidUpdate",value:function(ce){var pe=this;if(this.props.axis!==ce.axis&&this.clearSizeCache(),!this.unstable){if(++this.updateCounter>J)return this.unstable=!0,console.error(ae);this.updateCounterTimeoutId||(this.updateCounterTimeoutId=setTimeout(function(){pe.updateCounter=0,delete pe.updateCounterTimeoutId},0)),this.updateFrame()}}},{key:"maybeSetState",value:function(ce,pe){if(ee(this.state,ce))return pe();this.setState(ce,pe)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateFrameAndClearCache),this.scrollParent.removeEventListener("scroll",this.updateFrameAndClearCache,Y),this.scrollParent.removeEventListener("mousewheel",se,Y)}},{key:"getOffset",value:function(ce){var pe=this.props.axis,ie=ce[O[pe]]||0,xe=F[pe];do ie+=ce[xe]||0;while(ce=ce.offsetParent);return ie}},{key:"getEl",value:function(){return this.el||this.items}},{key:"getScrollPosition",value:function(){if(typeof this.cachedScrollPosition=="number")return this.cachedScrollPosition;var ce=this.scrollParent,pe=this.props.axis,ie=W[pe],xe=ce===window?document.body[ie]||document.documentElement[ie]:ce[ie],Ce=this.getScrollSize()-this.props.scrollParentViewportSizeGetter(this),ve=Math.max(0,Math.min(xe,Ce)),Oe=this.getEl();return this.cachedScrollPosition=this.getOffset(ce)+ve-this.getOffset(Oe),this.cachedScrollPosition}},{key:"setScroll",value:function(ce){var pe=this.scrollParent,ie=this.props.axis;if(ce+=this.getOffset(this.getEl()),pe===window)return window.scrollTo(0,ce);ce-=this.getOffset(this.scrollParent),pe[W[ie]]=ce}},{key:"getScrollSize",value:function(){var ce=this.scrollParent,pe=document,ie=pe.body,xe=pe.documentElement,Ce=U[this.props.axis];return ce===window?Math.max(ie[Ce],xe[Ce]):ce[Ce]}},{key:"hasDeterminateSize",value:function(){var ce=this.props,pe=ce.itemSizeGetter,ie=ce.type;return ie==="uniform"||pe}},{key:"getStartAndEnd",value:function(){var ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.threshold,pe=this.getScrollPosition(),ie=Math.max(0,pe-ce),xe=pe+this.props.scrollParentViewportSizeGetter(this)+ce;return this.hasDeterminateSize()&&(xe=Math.min(xe,this.getSpaceBefore(this.props.length))),{start:ie,end:xe}}},{key:"getItemSizeAndItemsPerRow",value:function(){var ce=this.props,pe=ce.axis,ie=ce.useStaticSize,xe=this.state,Ce=xe.itemSize,ve=xe.itemsPerRow;if(ie&&Ce&&ve)return{itemSize:Ce,itemsPerRow:ve};var Oe=this.items.children;if(!Oe.length)return{};var Pe=Oe[0],Ie=Pe[q[pe]],Fe=Math.abs(Ie-Ce);if((isNaN(Fe)||Fe>=1)&&(Ce=Ie),!Ce)return{};var _e=F[pe],Ne=Pe[_e];ve=1;for(var Ue=Oe[ve];Ue&&Ue[_e]===Ne;Ue=Oe[ve])++ve;return{itemSize:Ce,itemsPerRow:ve}}},{key:"clearSizeCache",value:function(){this.cachedScrollPosition=null}},{key:"updateFrameAndClearCache",value:function(ce){return this.clearSizeCache(),this.updateFrame(ce)}},{key:"updateFrame",value:function(ce){switch(this.updateScrollParent(),typeof ce!="function"&&(ce=se),this.props.type){case"simple":return this.updateSimpleFrame(ce);case"variable":return this.updateVariableFrame(ce);case"uniform":return this.updateUniformFrame(ce)}}},{key:"updateScrollParent",value:function(){var ce=this.scrollParent;this.scrollParent=this.props.scrollParentGetter(this),ce!==this.scrollParent&&(ce&&(ce.removeEventListener("scroll",this.updateFrameAndClearCache),ce.removeEventListener("mousewheel",se)),this.clearSizeCache(),this.scrollParent.addEventListener("scroll",this.updateFrameAndClearCache,Y),this.scrollParent.addEventListener("mousewheel",se,Y))}},{key:"updateSimpleFrame",value:function(ce){var pe=this.getStartAndEnd(),ie=pe.end,xe=this.items.children,Ce=0;if(xe.length){var ve=this.props.axis,Oe=xe[0],Pe=xe[xe.length-1];Ce=this.getOffset(Pe)+Pe[q[ve]]-this.getOffset(Oe)}if(Ce>ie)return ce();var Ie=this.props,Fe=Ie.pageSize,_e=Ie.length,Ne=Math.min(this.state.size+Fe,_e);this.maybeSetState({size:Ne},ce)}},{key:"updateVariableFrame",value:function(ce){this.props.itemSizeGetter||this.cacheSizes();for(var pe=this.getStartAndEnd(),ie=pe.start,xe=pe.end,Ce=this.props,ve=Ce.length,Oe=Ce.pageSize,Pe=0,Ie=0,Fe=0,_e=ve-1;Ie<_e;){var Ne=this.getSizeOfItem(Ie);if(Ne==null||Pe+Ne>ie)break;Pe+=Ne,++Ie}for(var Ue=ve-Ie;Fe<Ue&&Pe<xe;){var Be=this.getSizeOfItem(Ie+Fe);if(Be==null){Fe=Math.min(Fe+Oe,Ue);break}Pe+=Be,++Fe}this.maybeSetState(oe(this.props,{from:Ie,itemsPerRow:1,size:Fe}),ce)}},{key:"updateUniformFrame",value:function(ce){var pe=this.getItemSizeAndItemsPerRow(),ie=pe.itemSize,xe=pe.itemsPerRow;if(!ie||!xe)return ce();var Ce=this.getStartAndEnd(),ve=Ce.start,Oe=Ce.end,Pe=oe(this.props,{from:Math.floor(ve/ie)*xe,size:(Math.ceil((Oe-ve)/ie)+1)*xe,itemsPerRow:xe}),Ie=Pe.from,Fe=Pe.size;return this.maybeSetState({itemsPerRow:xe,from:Ie,itemSize:ie,size:Fe},ce)}},{key:"getSpaceBefore",value:function(ce){var pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(pe[ce]!=null)return pe[ce];var ie=this.state,xe=ie.itemSize,Ce=ie.itemsPerRow;if(xe)return pe[ce]=Math.floor(ce/Ce)*xe;for(var ve=ce;ve>0&&pe[--ve]==null;);for(var Oe=pe[ve]||0,Pe=ve;Pe<ce;++Pe){pe[Pe]=Oe;var Ie=this.getSizeOfItem(Pe);if(Ie==null)break;Oe+=Ie}return pe[ce]=Oe}},{key:"cacheSizes",value:function(){for(var ce=this.cache,pe=this.state.from,ie=this.items.children,xe=q[this.props.axis],Ce=0,ve=ie.length;Ce<ve;++Ce)ce[pe+Ce]=ie[Ce][xe]}},{key:"getSizeOfItem",value:function(ce){var pe=this.cache,ie=this.items,xe=this.props,Ce=xe.axis,ve=xe.itemSizeGetter,Oe=xe.itemSizeEstimator,Pe=xe.type,Ie=this.state,Fe=Ie.from,_e=Ie.itemSize,Ne=Ie.size;if(_e)return _e;if(ve)return ve(ce);if(ce in pe)return pe[ce];if(Pe==="simple"&&ce>=Fe&&ce<Fe+Ne&&ie){var Ue=ie.children[ce-Fe];if(Ue)return Ue[q[Ce]]}if(Oe)return Oe(ce,pe)}},{key:"scrollTo",value:function(ce){ce!=null&&this.setScroll(this.getSpaceBefore(ce))}},{key:"scrollAround",value:function(ce){var pe=this.getScrollPosition(),ie=this.getSpaceBefore(ce),xe=ie-this.props.scrollParentViewportSizeGetter(this)+this.getSizeOfItem(ce),Ce=Math.min(xe,ie),ve=Math.max(xe,ie);if(pe<=Ce)return this.setScroll(Ce);if(pe>ve)return this.setScroll(ve)}},{key:"getVisibleRange",value:function(){for(var ce=this.state,pe=ce.from,ie=ce.size,xe=this.getStartAndEnd(0),Ce=xe.start,ve=xe.end,Oe={},Pe,Ie,Fe=pe;Fe<pe+ie;++Fe){var _e=this.getSpaceBefore(Fe,Oe),Ne=_e+this.getSizeOfItem(Fe);Pe==null&&Ne>Ce&&(Pe=Fe),Pe!=null&&_e<ve&&(Ie=Fe)}return[Pe,Ie]}},{key:"renderItems",value:function(){for(var ce=this,pe=this.props,ie=pe.itemRenderer,xe=pe.itemsRenderer,Ce=this.state,ve=Ce.from,Oe=Ce.size,Pe=[],Ie=0;Ie<Oe;++Ie)Pe.push(ie(ve+Ie,Ie));return xe(Pe,function(Fe){return ce.items=Fe})}},{key:"render",value:function(){var ce=this,pe=this.props,ie=pe.axis,xe=pe.length,Ce=pe.type,ve=pe.useTranslate3d,Oe=this.state,Pe=Oe.from,Ie=Oe.itemsPerRow,Fe=this.renderItems();if(Ce==="simple")return Fe;var _e={position:"relative"},Ne={},Ue=Math.ceil(xe/Ie)*Ie,Be=this.getSpaceBefore(Ue,Ne);Be&&(_e[$[ie]]=Be,ie==="x"&&(_e.overflowX="hidden"));var qe=this.getSpaceBefore(Pe,Ne),te=ie==="x"?qe:0,le=ie==="y"?qe:0,ye=ve?"translate3d(".concat(te,"px, ").concat(le,"px, 0)"):"translate(".concat(te,"px, ").concat(le,"px)"),Ve={msTransform:ye,WebkitTransform:ye,transform:ye};return(0,r.jsx)("div",{style:_e,ref:function(Le){return ce.el=Le},children:(0,r.jsx)("div",{style:Ve,children:Fe})})}}],[{key:"getDerivedStateFromProps",value:function(ce,pe){var ie=oe(ce,pe);return ie===pe?null:ie}}])})(t.Component);T(H,"displayName","ReactList"),T(H,"defaultProps",{axis:"y",itemRenderer:function(ne,de){return(0,r.jsx)("div",{children:ne},de)},itemsRenderer:function(ne,de){return(0,r.jsx)("div",{ref:de,children:ne})},length:0,minSize:1,pageSize:10,scrollParentGetter:X,scrollParentViewportSizeGetter:Z,threshold:100,type:"simple",useStaticSize:!1,useTranslate3d:!1})})})(Mg)),Mg}function pre(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=Object.keys(n),r=Object.keys(e),s=t.length;if(r.length!==s)return!1;for(var a=0;a<s;a++){var o=t[a];if(n[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}function gre(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=n.length;if(e.length!==t)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}const xre=Object.freeze(Object.defineProperty({__proto__:null,shallowEqualArrays:gre,shallowEqualObjects:pre},Symbol.toStringTag,{value:"Module"})),yre=qL(xre);var Nh={},ZA;function by(){return ZA||(ZA=1,Object.defineProperty(Nh,"__esModule",{value:!0}),Nh.default=void 0,Nh.default={dateRangeWrapper:"rdrDateRangeWrapper",calendarWrapper:"rdrCalendarWrapper",dateDisplay:"rdrDateDisplay",dateDisplayItem:"rdrDateDisplayItem",dateDisplayItemActive:"rdrDateDisplayItemActive",monthAndYearWrapper:"rdrMonthAndYearWrapper",monthAndYearPickers:"rdrMonthAndYearPickers",nextPrevButton:"rdrNextPrevButton",month:"rdrMonth",weekDays:"rdrWeekDays",weekDay:"rdrWeekDay",days:"rdrDays",day:"rdrDay",dayNumber:"rdrDayNumber",dayPassive:"rdrDayPassive",dayToday:"rdrDayToday",dayStartOfWeek:"rdrDayStartOfWeek",dayEndOfWeek:"rdrDayEndOfWeek",daySelected:"rdrDaySelected",dayDisabled:"rdrDayDisabled",dayStartOfMonth:"rdrDayStartOfMonth",dayEndOfMonth:"rdrDayEndOfMonth",dayWeekend:"rdrDayWeekend",dayStartPreview:"rdrDayStartPreview",dayInPreview:"rdrDayInPreview",dayEndPreview:"rdrDayEndPreview",dayHovered:"rdrDayHovered",dayActive:"rdrDayActive",inRange:"rdrInRange",endEdge:"rdrEndEdge",startEdge:"rdrStartEdge",prevButton:"rdrPprevButton",nextButton:"rdrNextButton",selected:"rdrSelected",months:"rdrMonths",monthPicker:"rdrMonthPicker",yearPicker:"rdrYearPicker",dateDisplayWrapper:"rdrDateDisplayWrapper",definedRangesWrapper:"rdrDefinedRangesWrapper",staticRanges:"rdrStaticRanges",staticRange:"rdrStaticRange",inputRanges:"rdrInputRanges",inputRange:"rdrInputRange",inputRangeInput:"rdrInputRangeInput",dateRangePickerWrapper:"rdrDateRangePickerWrapper",staticRangeLabel:"rdrStaticRangeLabel",staticRangeSelected:"rdrStaticRangeSelected",monthName:"rdrMonthName",infiniteMonths:"rdrInfiniteMonths",monthsVertical:"rdrMonthsVertical",monthsHorizontal:"rdrMonthsHorizontal"}),Nh}var Sh={},KA;function vre(){if(KA)return Sh;KA=1,Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.ariaLabelsShape=void 0;var n=e(Pl());function e(t){return t&&t.__esModule?t:{default:t}}return Sh.ariaLabelsShape=n.default.shape({dateInput:n.default.objectOf(n.default.shape({startDate:n.default.string,endDate:n.default.string})),monthPicker:n.default.string,yearPicker:n.default.string,prevButton:n.default.string,nextButton:n.default.string}),Sh}var JA;function A5(){if(JA)return bh;JA=1,Object.defineProperty(bh,"__esModule",{value:!0}),bh.default=void 0;var n=w(Ys()),e=v(Pl()),t=yy(),r=v(fre()),s=v(hre()),a=vy(),o=v(vu()),l=v(mre()),c=yre,d=_u(),h=s5(),p=v(by()),x=vre();function v(O){return O&&O.__esModule?O:{default:O}}function _(O){if(typeof WeakMap!="function")return null;var I=new WeakMap,q=new WeakMap;return(_=function(F){return F?q:I})(O)}function w(O,I){if(O&&O.__esModule)return O;if(O===null||typeof O!="object"&&typeof O!="function")return{default:O};var q=_(I);if(q&&q.has(O))return q.get(O);var F={__proto__:null},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in O)if(U!=="default"&&Object.prototype.hasOwnProperty.call(O,U)){var W=B?Object.getOwnPropertyDescriptor(O,U):null;W&&(W.get||W.set)?Object.defineProperty(F,U,W):F[U]=O[U]}return F.default=O,q&&q.set(O,F),F}function j(){return j=Object.assign?Object.assign.bind():function(O){for(var I=1;I<arguments.length;I++){var q=arguments[I];for(var F in q)Object.prototype.hasOwnProperty.call(q,F)&&(O[F]=q[F])}return O},j.apply(this,arguments)}function T(O,I,q){return I=P(I),I in O?Object.defineProperty(O,I,{value:q,enumerable:!0,configurable:!0,writable:!0}):O[I]=q,O}function P(O){var I=E(O,"string");return typeof I=="symbol"?I:String(I)}function E(O,I){if(typeof O!="object"||!O)return O;var q=O[Symbol.toPrimitive];if(q!==void 0){var F=q.call(O,I);if(typeof F!="object")return F;throw new TypeError("@@toPrimitive must return a primitive value.")}return(I==="string"?String:Number)(O)}let M=class AS extends n.PureComponent{constructor(I,q){var F;super(I,q),F=this,T(this,"focusToDate",function(B){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:F.props,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!U.scroll.enabled){if(W&&U.preventSnapRefocus){const Y=(0,d.differenceInCalendarMonths)(B,F.state.focusedDate),ae=U.calendarFocus==="forwards"&&Y>=0,J=U.calendarFocus==="backwards"&&Y<=0;if((ae||J)&&Math.abs(Y)<U.months)return}F.setState({focusedDate:B});return}const $=(0,d.differenceInCalendarMonths)(B,U.minDate,F.dateOptions),se=F.list.getVisibleRange();W&&se.includes($)||(F.isFirstRender=!0,F.list.scrollTo($),F.setState({focusedDate:B}))}),T(this,"updateShownDate",function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:F.props;const U=B.scroll.enabled?{...B,months:F.list.getVisibleRange().length}:B,W=(0,a.calcFocusDate)(F.state.focusedDate,U);F.focusToDate(W,U)}),T(this,"updatePreview",B=>{if(!B){this.setState({preview:null});return}const U={startDate:B,endDate:B,color:this.props.color};this.setState({preview:U})}),T(this,"changeShownDate",function(B){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"set";const{focusedDate:W}=F.state,{onShownDateChange:$,minDate:se,maxDate:Y}=F.props,ae={monthOffset:()=>(0,d.addMonths)(W,B),setMonth:()=>(0,d.setMonth)(W,B),setYear:()=>(0,d.setYear)(W,B),set:()=>B},J=(0,d.min)([(0,d.max)([ae[U](),se]),Y]);F.focusToDate(J,F.props,!1),$&&$(J)}),T(this,"handleRangeFocusChange",(B,U)=>{this.props.onRangeFocusChange&&this.props.onRangeFocusChange([B,U])}),T(this,"handleScroll",()=>{const{onShownDateChange:B,minDate:U}=this.props,{focusedDate:W}=this.state,{isFirstRender:$}=this,se=this.list.getVisibleRange();if(se[0]===void 0)return;const Y=(0,d.addMonths)(U,se[0]||0);!(0,d.isSameMonth)(Y,W)&&!$&&(this.setState({focusedDate:Y}),B&&B(Y)),this.isFirstRender=!1}),T(this,"renderMonthAndYear",(B,U,W)=>{const{showMonthArrow:$,minDate:se,maxDate:Y,showMonthAndYearPickers:ae,ariaLabels:J}=W,ee=(Y||AS.defaultProps.maxDate).getFullYear(),X=(se||AS.defaultProps.minDate).getFullYear(),Z=this.styles;return n.default.createElement("div",{onMouseUp:oe=>oe.stopPropagation(),className:Z.monthAndYearWrapper},$?n.default.createElement("button",{type:"button",className:(0,o.default)(Z.nextPrevButton,Z.prevButton),onClick:()=>U(-1,"monthOffset"),"aria-label":J.prevButton},n.default.createElement("i",null)):null,ae?n.default.createElement("span",{className:Z.monthAndYearPickers},n.default.createElement("span",{className:Z.monthPicker},n.default.createElement("select",{value:B.getMonth(),onChange:oe=>U(oe.target.value,"setMonth"),"aria-label":J.monthPicker},this.state.monthNames.map((oe,H)=>n.default.createElement("option",{key:H,value:H},oe)))),n.default.createElement("span",{className:Z.monthAndYearDivider}),n.default.createElement("span",{className:Z.yearPicker},n.default.createElement("select",{value:B.getFullYear(),onChange:oe=>U(oe.target.value,"setYear"),"aria-label":J.yearPicker},new Array(ee-X+1).fill(ee).map((oe,H)=>{const Q=oe-H;return n.default.createElement("option",{key:Q,value:Q},Q)})))):n.default.createElement("span",{className:Z.monthAndYearPickers},this.state.monthNames[B.getMonth()]," ",B.getFullYear()),$?n.default.createElement("button",{type:"button",className:(0,o.default)(Z.nextPrevButton,Z.nextButton),onClick:()=>U(1,"monthOffset"),"aria-label":J.nextButton},n.default.createElement("i",null)):null)}),T(this,"renderDateDisplay",()=>{const{focusedRange:B,color:U,ranges:W,rangeColors:$,dateDisplayFormat:se,editableDateInputs:Y,startDatePlaceholder:ae,endDatePlaceholder:J,ariaLabels:ee}=this.props,X=$[B[0]]||U,Z=this.styles;return n.default.createElement("div",{className:Z.dateDisplayWrapper},W.map((oe,H)=>oe.showDateDisplay===!1||oe.disabled&&!oe.showDateDisplay?null:n.default.createElement("div",{className:Z.dateDisplay,key:H,style:{color:oe.color||X}},n.default.createElement(s.default,{className:(0,o.default)(Z.dateDisplayItem,{[Z.dateDisplayItemActive]:B[0]===H&&B[1]===0}),readOnly:!Y,disabled:oe.disabled,value:oe.startDate,placeholder:ae,dateOptions:this.dateOptions,dateDisplayFormat:se,ariaLabel:ee.dateInput&&ee.dateInput[oe.key]&&ee.dateInput[oe.key].startDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(H,0)}),n.default.createElement(s.default,{className:(0,o.default)(Z.dateDisplayItem,{[Z.dateDisplayItemActive]:B[0]===H&&B[1]===1}),readOnly:!Y,disabled:oe.disabled,value:oe.endDate,placeholder:J,dateOptions:this.dateOptions,dateDisplayFormat:se,ariaLabel:ee.dateInput&&ee.dateInput[oe.key]&&ee.dateInput[oe.key].endDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(H,1)}))))}),T(this,"onDragSelectionStart",B=>{const{onChange:U,dragSelectionEnabled:W}=this.props;W?this.setState({drag:{status:!0,range:{startDate:B,endDate:B},disablePreview:!0}}):U&&U(B)}),T(this,"onDragSelectionEnd",B=>{const{updateRange:U,displayMode:W,onChange:$,dragSelectionEnabled:se}=this.props;if(!se)return;if(W==="date"||!this.state.drag.status){$&&$(B);return}const Y={startDate:this.state.drag.range.startDate,endDate:B};W!=="dateRange"||(0,d.isSameDay)(Y.startDate,B)?this.setState({drag:{status:!1,range:{}}},()=>$&&$(B)):this.setState({drag:{status:!1,range:{}}},()=>{U&&U(Y)})}),T(this,"onDragSelectionMove",B=>{const{drag:U}=this.state;!U.status||!this.props.dragSelectionEnabled||this.setState({drag:{status:U.status,range:{startDate:U.range.startDate,endDate:B},disablePreview:!0}})}),T(this,"estimateMonthSize",(B,U)=>{const{direction:W,minDate:$}=this.props,{scrollArea:se}=this.state;if(U&&(this.listSizeCache=U,U[B]))return U[B];if(W==="horizontal")return se.monthWidth;const Y=(0,d.addMonths)($,B),{start:ae,end:J}=(0,a.getMonthDisplayRange)(Y,this.dateOptions);return(0,d.differenceInDays)(J,ae,this.dateOptions)+1>35?se.longMonthHeight:se.monthHeight}),this.dateOptions={locale:I.locale},I.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=I.weekStartsOn),this.styles=(0,a.generateStyles)([p.default,I.classNames]),this.listSizeCache={},this.isFirstRender=!0,this.state={monthNames:this.getMonthNames(),focusedDate:(0,a.calcFocusDate)(null,I),drag:{status:!1,range:{startDate:null,endDate:null},disablePreview:!1},scrollArea:this.calcScrollArea(I)}}getMonthNames(){return[...Array(12).keys()].map(I=>this.props.locale.localize.month(I))}calcScrollArea(I){const{direction:q,months:F,scroll:B}=I;if(!B.enabled)return{enabled:!1};const U=B.longMonthHeight||B.monthHeight;return q==="vertical"?{enabled:!0,monthHeight:B.monthHeight||220,longMonthHeight:U||260,calendarWidth:"auto",calendarHeight:(B.calendarHeight||U||240)*F}:{enabled:!0,monthWidth:B.monthWidth||332,calendarWidth:(B.calendarWidth||B.monthWidth||332)*F,monthHeight:U||300,calendarHeight:U||300}}componentDidMount(){this.props.scroll.enabled&&setTimeout(()=>this.focusToDate(this.state.focusedDate))}componentDidUpdate(I){const F={dateRange:"ranges",date:"date"}[this.props.displayMode];this.props[F]!==I[F]&&this.updateShownDate(this.props),(I.locale!==this.props.locale||I.weekStartsOn!==this.props.weekStartsOn)&&(this.dateOptions={locale:this.props.locale},this.props.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=this.props.weekStartsOn),this.setState({monthNames:this.getMonthNames()})),(0,c.shallowEqualObjects)(I.scroll,this.props.scroll)||this.setState({scrollArea:this.calcScrollArea(this.props)})}renderWeekdays(){const I=new Date;return n.default.createElement("div",{className:this.styles.weekDays},(0,d.eachDayOfInterval)({start:(0,d.startOfWeek)(I,this.dateOptions),end:(0,d.endOfWeek)(I,this.dateOptions)}).map((q,F)=>n.default.createElement("span",{className:this.styles.weekDay,key:F},(0,d.format)(q,this.props.weekdayDisplayFormat,this.dateOptions))))}render(){const{showDateDisplay:I,onPreviewChange:q,scroll:F,direction:B,disabledDates:U,disabledDay:W,maxDate:$,minDate:se,rangeColors:Y,color:ae,navigatorRenderer:J,className:ee,preview:X}=this.props,{scrollArea:Z,focusedDate:oe}=this.state,H=B==="vertical",Q=J||this.renderMonthAndYear,ne=this.props.ranges.map((de,ce)=>({...de,color:de.color||Y[ce]||ae}));return n.default.createElement("div",{className:(0,o.default)(this.styles.calendarWrapper,ee),onMouseUp:()=>this.setState({drag:{status:!1,range:{}}}),onMouseLeave:()=>{this.setState({drag:{status:!1,range:{}}})}},I&&this.renderDateDisplay(),Q(oe,this.changeShownDate,this.props),F.enabled?n.default.createElement("div",null,H&&this.renderWeekdays(this.dateOptions),n.default.createElement("div",{className:(0,o.default)(this.styles.infiniteMonths,H?this.styles.monthsVertical:this.styles.monthsHorizontal),onMouseLeave:()=>q&&q(),style:{width:Z.calendarWidth+11,height:Z.calendarHeight+11},onScroll:this.handleScroll},n.default.createElement(l.default,{length:(0,d.differenceInCalendarMonths)((0,d.endOfMonth)($),(0,d.addDays)((0,d.startOfMonth)(se),-1),this.dateOptions),treshold:500,type:"variable",ref:de=>this.list=de,itemSizeEstimator:this.estimateMonthSize,axis:H?"y":"x",itemRenderer:(de,ce)=>{const pe=(0,d.addMonths)(se,de);return n.default.createElement(r.default,j({},this.props,{onPreviewChange:q||this.updatePreview,preview:X||this.state.preview,ranges:ne,key:ce,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:U,disabledDay:W,month:pe,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>q&&q(),styles:this.styles,style:H?{height:this.estimateMonthSize(de)}:{height:Z.monthHeight,width:this.estimateMonthSize(de)},showMonthName:!0,showWeekDays:!H}))}}))):n.default.createElement("div",{className:(0,o.default)(this.styles.months,H?this.styles.monthsVertical:this.styles.monthsHorizontal)},new Array(this.props.months).fill(null).map((de,ce)=>{let pe=(0,d.addMonths)(this.state.focusedDate,ce);return this.props.calendarFocus==="backwards"&&(pe=(0,d.subMonths)(this.state.focusedDate,this.props.months-1-ce)),n.default.createElement(r.default,j({},this.props,{onPreviewChange:q||this.updatePreview,preview:X||this.state.preview,ranges:ne,key:ce,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:U,disabledDay:W,month:pe,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>q&&q(),styles:this.styles,showWeekDays:!H||ce===0,showMonthName:!H||ce>0}))})))}};return M.defaultProps={showMonthArrow:!0,showMonthAndYearPickers:!0,disabledDates:[],disabledDay:()=>{},classNames:{},locale:h.enUS,ranges:[],focusedRange:[0,0],dateDisplayFormat:"MMM d, yyyy",monthDisplayFormat:"MMM yyyy",weekdayDisplayFormat:"E",dayDisplayFormat:"d",showDateDisplay:!0,showPreview:!0,displayMode:"date",months:1,color:"#3d91ff",scroll:{enabled:!1},direction:"vertical",maxDate:(0,d.addYears)(new Date,20),minDate:(0,d.addYears)(new Date,-100),rangeColors:["#3d91ff","#3ecf8e","#fed14c"],startDatePlaceholder:"Early",endDatePlaceholder:"Continuous",editableDateInputs:!1,dragSelectionEnabled:!0,fixedHeight:!1,calendarFocus:"forwards",preventSnapRefocus:!1,ariaLabels:{}},M.propTypes={showMonthArrow:e.default.bool,showMonthAndYearPickers:e.default.bool,disabledDates:e.default.array,disabledDay:e.default.func,minDate:e.default.object,maxDate:e.default.object,date:e.default.object,onChange:e.default.func,onPreviewChange:e.default.func,onRangeFocusChange:e.default.func,classNames:e.default.object,locale:e.default.object,shownDate:e.default.object,onShownDateChange:e.default.func,ranges:e.default.arrayOf(t.rangeShape),preview:e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string}),dateDisplayFormat:e.default.string,monthDisplayFormat:e.default.string,weekdayDisplayFormat:e.default.string,weekStartsOn:e.default.number,dayDisplayFormat:e.default.string,focusedRange:e.default.arrayOf(e.default.number),initialFocusedRange:e.default.arrayOf(e.default.number),months:e.default.number,className:e.default.string,showDateDisplay:e.default.bool,showPreview:e.default.bool,displayMode:e.default.oneOf(["dateRange","date"]),color:e.default.string,updateRange:e.default.func,scroll:e.default.shape({enabled:e.default.bool,monthHeight:e.default.number,longMonthHeight:e.default.number,monthWidth:e.default.number,calendarWidth:e.default.number,calendarHeight:e.default.number}),direction:e.default.oneOf(["vertical","horizontal"]),startDatePlaceholder:e.default.string,endDatePlaceholder:e.default.string,navigatorRenderer:e.default.func,rangeColors:e.default.arrayOf(e.default.string),editableDateInputs:e.default.bool,dragSelectionEnabled:e.default.bool,fixedHeight:e.default.bool,calendarFocus:e.default.string,preventSnapRefocus:e.default.bool,ariaLabels:x.ariaLabelsShape},bh.default=M,bh}var QA;function R5(){if(QA)return vh;QA=1,Object.defineProperty(vh,"__esModule",{value:!0}),vh.default=void 0;var n=h(Ys()),e=c(Pl()),t=c(A5()),r=yy(),s=vy(),a=_u(),o=c(vu()),l=c(by());function c(j){return j&&j.__esModule?j:{default:j}}function d(j){if(typeof WeakMap!="function")return null;var T=new WeakMap,P=new WeakMap;return(d=function(E){return E?P:T})(j)}function h(j,T){if(j&&j.__esModule)return j;if(j===null||typeof j!="object"&&typeof j!="function")return{default:j};var P=d(T);if(P&&P.has(j))return P.get(j);var E={__proto__:null},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in j)if(O!=="default"&&Object.prototype.hasOwnProperty.call(j,O)){var I=M?Object.getOwnPropertyDescriptor(j,O):null;I&&(I.get||I.set)?Object.defineProperty(E,O,I):E[O]=j[O]}return E.default=j,P&&P.set(j,E),E}function p(){return p=Object.assign?Object.assign.bind():function(j){for(var T=1;T<arguments.length;T++){var P=arguments[T];for(var E in P)Object.prototype.hasOwnProperty.call(P,E)&&(j[E]=P[E])}return j},p.apply(this,arguments)}function x(j,T,P){return T=v(T),T in j?Object.defineProperty(j,T,{value:P,enumerable:!0,configurable:!0,writable:!0}):j[T]=P,j}function v(j){var T=_(j,"string");return typeof T=="symbol"?T:String(T)}function _(j,T){if(typeof j!="object"||!j)return j;var P=j[Symbol.toPrimitive];if(P!==void 0){var E=P.call(j,T);if(typeof E!="object")return E;throw new TypeError("@@toPrimitive must return a primitive value.")}return(T==="string"?String:Number)(j)}let w=class extends n.Component{constructor(T,P){var E;super(T,P),E=this,x(this,"calcNewSelection",function(M){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const I=E.props.focusedRange||E.state.focusedRange,{ranges:q,onChange:F,maxDate:B,moveRangeOnFirstSelection:U,retainEndDateOnFirstSelection:W,disabledDates:$}=E.props,se=I[0],Y=q[se];if(!Y||!F)return{};let{startDate:ae,endDate:J}=Y;const ee=new Date;let X;if(!O)ae=M.startDate,J=M.endDate;else if(I[1]===0){const H=(0,a.differenceInCalendarDays)(J||ee,ae),Q=()=>U?(0,a.addDays)(M,H):W?!J||(0,a.isBefore)(M,J)?J:M:M||ee;ae=M,J=Q(),B&&(J=(0,a.min)([J,B])),X=[I[0],1]}else J=M;let Z=I[1]===0;(0,a.isBefore)(J,ae)&&(Z=!Z,[ae,J]=[J,ae]);const oe=$.filter(H=>(0,a.isWithinInterval)(H,{start:ae,end:J}));return oe.length>0&&(Z?ae=(0,a.addDays)((0,a.max)(oe),1):J=(0,a.addDays)((0,a.min)(oe),-1)),X||(X=[(0,s.findNextRangeIndex)(E.props.ranges,I[0]),0]),{wasValid:!(oe.length>0),range:{startDate:ae,endDate:J},nextFocusRange:X}}),x(this,"setSelection",(M,O)=>{const{onChange:I,ranges:q,onRangeFocusChange:F}=this.props,U=(this.props.focusedRange||this.state.focusedRange)[0],W=q[U];if(!W)return;const $=this.calcNewSelection(M,O);I({[W.key||`range${U+1}`]:{...W,...$.range}}),this.setState({focusedRange:$.nextFocusRange,preview:null}),F&&F($.nextFocusRange)}),x(this,"handleRangeFocusChange",M=>{this.setState({focusedRange:M}),this.props.onRangeFocusChange&&this.props.onRangeFocusChange(M)}),x(this,"updatePreview",M=>{if(!M){this.setState({preview:null});return}const{rangeColors:O,ranges:I}=this.props,q=this.props.focusedRange||this.state.focusedRange,F=I[q[0]]?.color||O[q[0]]||F;this.setState({preview:{...M.range,color:F}})}),this.state={focusedRange:T.initialFocusedRange||[(0,s.findNextRangeIndex)(T.ranges),0],preview:null},this.styles=(0,s.generateStyles)([l.default,T.classNames])}render(){return n.default.createElement(t.default,p({focusedRange:this.state.focusedRange,onRangeFocusChange:this.handleRangeFocusChange,preview:this.state.preview,onPreviewChange:T=>{this.updatePreview(T?this.calcNewSelection(T):null)}},this.props,{displayMode:"dateRange",className:(0,o.default)(this.styles.dateRangeWrapper,this.props.className),onChange:this.setSelection,updateRange:T=>this.setSelection(T,!1),ref:T=>{this.calendar=T}}))}};return w.defaultProps={classNames:{},ranges:[],moveRangeOnFirstSelection:!1,retainEndDateOnFirstSelection:!1,rangeColors:["#3d91ff","#3ecf8e","#fed14c"],disabledDates:[]},w.propTypes={...t.default.propTypes,onChange:e.default.func,onRangeFocusChange:e.default.func,className:e.default.string,ranges:e.default.arrayOf(r.rangeShape),moveRangeOnFirstSelection:e.default.bool,retainEndDateOnFirstSelection:e.default.bool},vh.default=w,vh}var Ch={},Th={},Sc={},XA;function L5(){if(XA)return Sc;XA=1,Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.createStaticRanges=r,Sc.defaultStaticRanges=Sc.defaultInputRanges=void 0;var n=_u();const e={startOfWeek:(0,n.startOfWeek)(new Date),endOfWeek:(0,n.endOfWeek)(new Date),startOfLastWeek:(0,n.startOfWeek)((0,n.addDays)(new Date,-7)),endOfLastWeek:(0,n.endOfWeek)((0,n.addDays)(new Date,-7)),startOfToday:(0,n.startOfDay)(new Date),endOfToday:(0,n.endOfDay)(new Date),startOfYesterday:(0,n.startOfDay)((0,n.addDays)(new Date,-1)),endOfYesterday:(0,n.endOfDay)((0,n.addDays)(new Date,-1)),startOfMonth:(0,n.startOfMonth)(new Date),endOfMonth:(0,n.endOfMonth)(new Date),startOfLastMonth:(0,n.startOfMonth)((0,n.addMonths)(new Date,-1)),endOfLastMonth:(0,n.endOfMonth)((0,n.addMonths)(new Date,-1))},t={range:{},isSelected(s){const a=this.range();return(0,n.isSameDay)(s.startDate,a.startDate)&&(0,n.isSameDay)(s.endDate,a.endDate)}};function r(s){return s.map(a=>({...t,...a}))}return Sc.defaultStaticRanges=r([{label:"Today",range:()=>({startDate:e.startOfToday,endDate:e.endOfToday})},{label:"Yesterday",range:()=>({startDate:e.startOfYesterday,endDate:e.endOfYesterday})},{label:"This Week",range:()=>({startDate:e.startOfWeek,endDate:e.endOfWeek})},{label:"Last Week",range:()=>({startDate:e.startOfLastWeek,endDate:e.endOfLastWeek})},{label:"This Month",range:()=>({startDate:e.startOfMonth,endDate:e.endOfMonth})},{label:"Last Month",range:()=>({startDate:e.startOfLastMonth,endDate:e.endOfLastMonth})}]),Sc.defaultInputRanges=[{label:"days up to today",range(s){return{startDate:(0,n.addDays)(e.startOfToday,(Math.max(Number(s),1)-1)*-1),endDate:e.endOfToday}},getCurrentValue(s){return(0,n.isSameDay)(s.endDate,e.endOfToday)?s.startDate?(0,n.differenceInCalendarDays)(e.endOfToday,s.startDate)+1:"":"-"}},{label:"days starting today",range(s){const a=new Date;return{startDate:a,endDate:(0,n.addDays)(a,Math.max(Number(s),1)-1)}},getCurrentValue(s){return(0,n.isSameDay)(s.startDate,e.startOfToday)?s.endDate?(0,n.differenceInCalendarDays)(s.endDate,e.startOfToday)+1:"":"-"}}],Sc}var kh={},eR;function bre(){if(eR)return kh;eR=1,Object.defineProperty(kh,"__esModule",{value:!0}),kh.default=void 0;var n=s(Ys()),e=t(Pl());function t(p){return p&&p.__esModule?p:{default:p}}function r(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(r=function(_){return _?v:x})(p)}function s(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=r(x);if(v&&v.has(p))return v.get(p);var _={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var T=w?Object.getOwnPropertyDescriptor(p,j):null;T&&(T.get||T.set)?Object.defineProperty(_,j,T):_[j]=p[j]}return _.default=p,v&&v.set(p,_),_}function a(p,x,v){return x=o(x),x in p?Object.defineProperty(p,x,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[x]=v,p}function o(p){var x=l(p,"string");return typeof x=="symbol"?x:String(x)}function l(p,x){if(typeof p!="object"||!p)return p;var v=p[Symbol.toPrimitive];if(v!==void 0){var _=v.call(p,x);if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(p)}const c=0,d=99999;let h=class extends n.Component{constructor(x,v){super(x,v),a(this,"onChange",_=>{const{onChange:w}=this.props;let j=parseInt(_.target.value,10);j=isNaN(j)?0:Math.max(Math.min(d,j),c),w(j)})}shouldComponentUpdate(x){const{value:v,label:_,placeholder:w}=this.props;return v!==x.value||_!==x.label||w!==x.placeholder}render(){const{label:x,placeholder:v,value:_,styles:w,onBlur:j,onFocus:T}=this.props;return n.default.createElement("div",{className:w.inputRange},n.default.createElement("input",{className:w.inputRangeInput,placeholder:v,value:_,min:c,max:d,onChange:this.onChange,onFocus:T,onBlur:j}),n.default.createElement("span",{className:w.inputRangeLabel},x))}};return h.propTypes={value:e.default.oneOfType([e.default.string,e.default.number]),label:e.default.oneOfType([e.default.element,e.default.node]).isRequired,placeholder:e.default.string,styles:e.default.shape({inputRange:e.default.string,inputRangeInput:e.default.string,inputRangeLabel:e.default.string}).isRequired,onBlur:e.default.func.isRequired,onFocus:e.default.func.isRequired,onChange:e.default.func.isRequired},h.defaultProps={value:"",placeholder:"-"},kh.default=h,kh}var tR;function F5(){if(tR)return Th;tR=1,Object.defineProperty(Th,"__esModule",{value:!0}),Th.default=void 0;var n=d(Ys()),e=l(Pl()),t=l(by()),r=L5(),s=yy(),a=l(bre()),o=l(vu());function l(_){return _&&_.__esModule?_:{default:_}}function c(_){if(typeof WeakMap!="function")return null;var w=new WeakMap,j=new WeakMap;return(c=function(T){return T?j:w})(_)}function d(_,w){if(_&&_.__esModule)return _;if(_===null||typeof _!="object"&&typeof _!="function")return{default:_};var j=c(w);if(j&&j.has(_))return j.get(_);var T={__proto__:null},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in _)if(E!=="default"&&Object.prototype.hasOwnProperty.call(_,E)){var M=P?Object.getOwnPropertyDescriptor(_,E):null;M&&(M.get||M.set)?Object.defineProperty(T,E,M):T[E]=_[E]}return T.default=_,j&&j.set(_,T),T}function h(_,w,j){return w=p(w),w in _?Object.defineProperty(_,w,{value:j,enumerable:!0,configurable:!0,writable:!0}):_[w]=j,_}function p(_){var w=x(_,"string");return typeof w=="symbol"?w:String(w)}function x(_,w){if(typeof _!="object"||!_)return _;var j=_[Symbol.toPrimitive];if(j!==void 0){var T=j.call(_,w);if(typeof T!="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return(w==="string"?String:Number)(_)}let v=class extends n.Component{constructor(w){super(w),h(this,"handleRangeChange",j=>{const{onChange:T,ranges:P,focusedRange:E}=this.props,M=P[E[0]];!T||!M||T({[M.key||`range${E[0]+1}`]:{...M,...j}})}),this.state={rangeOffset:0,focusedInput:-1}}getRangeOptionValue(w){const{ranges:j=[],focusedRange:T=[]}=this.props;if(typeof w.getCurrentValue!="function")return"";const P=j[T[0]]||{};return w.getCurrentValue(P)||""}getSelectedRange(w,j){const T=w.findIndex(E=>!E.startDate||!E.endDate||E.disabled?!1:j.isSelected(E));return{selectedRange:w[T],focusedRangeIndex:T}}render(){const{headerContent:w,footerContent:j,onPreviewChange:T,inputRanges:P,staticRanges:E,ranges:M,renderStaticRangeLabel:O,rangeColors:I,className:q}=this.props;return n.default.createElement("div",{className:(0,o.default)(t.default.definedRangesWrapper,q)},w,n.default.createElement("div",{className:t.default.staticRanges},E.map((F,B)=>{const{selectedRange:U,focusedRangeIndex:W}=this.getSelectedRange(M,F);let $;return F.hasCustomRendering?$=O(F):$=F.label,n.default.createElement("button",{type:"button",className:(0,o.default)(t.default.staticRange,{[t.default.staticRangeSelected]:!!U}),style:{color:U?U.color||I[W]:null},key:B,onClick:()=>this.handleRangeChange(F.range(this.props)),onFocus:()=>T&&T(F.range(this.props)),onMouseOver:()=>T&&T(F.range(this.props)),onMouseLeave:()=>{T&&T()}},n.default.createElement("span",{tabIndex:-1,className:t.default.staticRangeLabel},$))})),n.default.createElement("div",{className:t.default.inputRanges},P.map((F,B)=>n.default.createElement(a.default,{key:B,styles:t.default,label:F.label,onFocus:()=>this.setState({focusedInput:B,rangeOffset:0}),onBlur:()=>this.setState({rangeOffset:0}),onChange:U=>this.handleRangeChange(F.range(U,this.props)),value:this.getRangeOptionValue(F)}))),j)}};return v.propTypes={inputRanges:e.default.array,staticRanges:e.default.array,ranges:e.default.arrayOf(s.rangeShape),focusedRange:e.default.arrayOf(e.default.number),onPreviewChange:e.default.func,onChange:e.default.func,footerContent:e.default.any,headerContent:e.default.any,rangeColors:e.default.arrayOf(e.default.string),className:e.default.string,renderStaticRangeLabel:e.default.func},v.defaultProps={inputRanges:r.defaultInputRanges,staticRanges:r.defaultStaticRanges,ranges:[],rangeColors:["#3d91ff","#3ecf8e","#fed14c"],focusedRange:[0,0]},Th.default=v,Th}var nR;function _re(){if(nR)return Ch;nR=1,Object.defineProperty(Ch,"__esModule",{value:!0}),Ch.default=void 0;var n=d(Ys()),e=l(Pl()),t=l(R5()),r=l(F5()),s=vy(),a=l(vu()),o=l(by());function l(x){return x&&x.__esModule?x:{default:x}}function c(x){if(typeof WeakMap!="function")return null;var v=new WeakMap,_=new WeakMap;return(c=function(w){return w?_:v})(x)}function d(x,v){if(x&&x.__esModule)return x;if(x===null||typeof x!="object"&&typeof x!="function")return{default:x};var _=c(v);if(_&&_.has(x))return _.get(x);var w={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in x)if(T!=="default"&&Object.prototype.hasOwnProperty.call(x,T)){var P=j?Object.getOwnPropertyDescriptor(x,T):null;P&&(P.get||P.set)?Object.defineProperty(w,T,P):w[T]=x[T]}return w.default=x,_&&_.set(x,w),w}function h(){return h=Object.assign?Object.assign.bind():function(x){for(var v=1;v<arguments.length;v++){var _=arguments[v];for(var w in _)Object.prototype.hasOwnProperty.call(_,w)&&(x[w]=_[w])}return x},h.apply(this,arguments)}let p=class extends n.Component{constructor(v){super(v),this.state={focusedRange:[(0,s.findNextRangeIndex)(v.ranges),0]},this.styles=(0,s.generateStyles)([o.default,v.classNames])}render(){const{focusedRange:v}=this.state;return n.default.createElement("div",{className:(0,a.default)(this.styles.dateRangePickerWrapper,this.props.className)},n.default.createElement(r.default,h({focusedRange:v,onPreviewChange:_=>this.dateRange.updatePreview(_?this.dateRange.calcNewSelection(_,typeof _=="string"):null)},this.props,{range:this.props.ranges[v[0]],className:void 0})),n.default.createElement(t.default,h({onRangeFocusChange:_=>this.setState({focusedRange:_}),focusedRange:v},this.props,{ref:_=>this.dateRange=_,className:void 0})))}};return p.defaultProps={},p.propTypes={...t.default.propTypes,...r.default.propTypes,className:e.default.string},Ch.default=p,Ch}var rR;function wre(){return rR||(rR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Calendar",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"DateRange",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"DateRangePicker",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"DefinedRange",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"createStaticRanges",{enumerable:!0,get:function(){return a.createStaticRanges}}),Object.defineProperty(n,"defaultInputRanges",{enumerable:!0,get:function(){return a.defaultInputRanges}}),Object.defineProperty(n,"defaultStaticRanges",{enumerable:!0,get:function(){return a.defaultStaticRanges}});var e=o(R5()),t=o(A5()),r=o(_re()),s=o(F5()),a=L5();function o(l){return l&&l.__esModule?l:{default:l}}})(Nb)),Nb}var hm=wre();const kn=({label:n,id:e,error:t,value:r,onChange:s,maxDate:a,minDate:o,...l})=>{const[c,d]=D.useState(!1),[h,p]=D.useState(!1),x=D.useRef(null),{theme:v}=xu(),_=v==="dark";D.useEffect(()=>{p(document.body.classList.contains("field-officer-dark-theme"))},[]);const w=I=>{s&&s($e(I,"yyyy-MM-dd")),d(!1)};D.useEffect(()=>{const I=q=>{x.current&&!x.current.contains(q.target)&&d(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]);const{className:j,...T}=l,M=`${h?"fo-input":"form-input"} ${t?h?"fo-input--error":"form-input--error":""} flex justify-between items-center cursor-pointer ${j||""}`,O=r?new Date(r+"T12:00:00"):new Date;return i.jsxs("div",{ref:x,children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsxs("div",{className:n?"mt-1 relative":"relative",children:[i.jsxs("div",{id:e,className:M,onClick:()=>d(!c),role:"button","aria-haspopup":"dialog","aria-expanded":c,"aria-label":`Date picker for ${n}`,children:[i.jsx("span",{className:r?"":"text-muted",children:r?$e(O,"dd MMM, yyyy"):"Select date"}),i.jsx(ka,{className:"h-4 w-4 text-muted"})]}),c&&i.jsx("div",{className:`absolute z-50 mt-1 rounded-lg shadow-lg overflow-hidden ${_?"dark-calendar bg-[#041b0f] border border-[#1f3d2b]":"bg-white border border-gray-200"}`,children:i.jsx(hm.Calendar,{date:O,onChange:w,maxDate:a,minDate:o,color:_?"#10B981":"#005D22"})})]}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},q5=["Apartment","Villa","Vilament","Rowhouse","Combined","Commercial Office","Commercial Retail","Commercial","Public",""],jre=Pt({organizationId:ge().required(),location:ge().optional().nullable(),entityId:ge().optional(),billingName:ge().optional().nullable(),registeredAddress:ge().optional().nullable(),gstNumber:ge().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,{message:"Invalid GST Number format",excludeEmptyString:!0}),panNumber:ge().optional().nullable().transform(n=>n?.toUpperCase()||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,{message:"Invalid PAN format",excludeEmptyString:!0}),email1:ge().email("Invalid email format").optional().nullable(),email2:ge().email("Invalid email format").optional().nullable(),email3:ge().email("Invalid email format").optional().nullable(),eShramNumber:ge().optional().nullable(),shopAndEstablishmentCode:ge().optional().nullable(),keyAccountManager:ge().optional(),siteAreaSqFt:is().typeError("Must be a number").nullable().optional(),projectType:ge().oneOf(q5).optional(),apartmentCount:is().typeError("Must be a number").nullable().optional(),agreementDetails:Pt({fromDate:ge().optional().nullable(),toDate:ge().optional().nullable().test("is-after-from","To Date must be after From Date",function(n){const{fromDate:e}=this.parent;return!e||!n?!0:new Date(n.replace(/-/g,"/"))>=new Date(e.replace(/-/g,"/"))}),renewalIntervalDays:is().typeError("Must be a number").nullable().optional().min(0,"Cannot be negative"),softCopy:Wt().nullable().optional(),scannedCopy:Wt().nullable().optional(),agreementDate:ge().optional().nullable(),addendum1Date:ge().optional().nullable(),addendum2Date:ge().optional().nullable()}).optional(),siteOperations:Pt({form6Applicable:ss().default(!1),form6RenewalTaskCreation:ss().optional(),form6ValidityFrom:ge().nullable().when("form6Applicable",{is:!0,then:n=>n.required("From Date is required")}),form6ValidityTo:ge().nullable().when("form6Applicable",{is:!0,then:n=>n.required("To Date is required")}),form6Document:Wt().nullable().when("form6Applicable",{is:!0,then:n=>n.required("Document is required")}),minWageRevisionApplicable:ss().default(!1),minWageRevisionTaskCreation:ss().optional(),minWageRevisionValidityFrom:ge().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("From Date is required")}),minWageRevisionValidityTo:ge().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("To Date is required")}),minWageRevisionDocument:Wt().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("Document is required")}),holidays:Pt({numberOfDays:is().nullable().min(0),list:_s().of(Pt({id:ge(),date:ge().required(),description:ge().required()})),salaryPayment:ge().oneOf(["Full Payment","Duty Payment","Nil Payment",""]),billing:ge().oneOf(["Full Payment","Duty Payment","Nil Payment",""])}).optional(),costingSheetLink:ge().url("Must be a valid URL").nullable().optional(),tools:Pt({dcCopy1:Wt().nullable().optional(),dcCopy2:Wt().nullable().optional(),list:_s().of(Pt({id:ge(),name:ge().required(),brand:ge().optional(),size:ge().optional(),quantity:is().nullable().min(0),issueDate:ge().required(),picture:Wt().nullable().optional()}))}).optional(),sims:Pt({issuedCount:is().nullable().min(0),details:_s().of(Pt({id:ge(),mobileNumber:ge().required().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),allocatedTo:ge().optional(),plan:ge().optional(),ownerName:ge().optional()}))}).optional(),equipment:Pt({issued:_s().of(Pt({id:ge(),name:ge().required(),brand:ge().optional(),modelNumber:ge().optional(),serialNumber:ge().optional(),accessories:ge().optional(),condition:ge().oneOf(["New","Old",""]),issueDate:ge().required(),picture:Wt().nullable().optional()})),intermittent:Pt({billing:ge().oneOf(["To Be Billed","Not to be Billed",""]),frequency:ge().oneOf(["Monthly","Bi-Monthly","Quarterly","Half Yearly","Yearly",""]),taskCreation:ss().default(!1),durationDays:is().nullable().min(0)}).optional()}).optional(),billingCycleFrom:ge().nullable().optional(),uniformDeductions:ss().default(!1)}).optional(),insuranceStatus:Pt({isCompliant:ss().required()}).optional().nullable(),assets:_s().optional(),issuedTools:_s().optional()}).defined(),sR=({title:n,children:e})=>{const[t,r]=D.useState(!1);return i.jsxs("div",{className:"border border-border rounded-lg bg-page",children:[i.jsxs("button",{type:"button",onClick:()=>r(!t),className:"w-full flex justify-between items-center p-3 font-medium text-left text-primary-text",children:[i.jsx("span",{children:n}),i.jsx(yu,{className:`h-5 w-5 transform transition-transform ${t?"rotate-180":""}`})]}),t&&i.jsx("div",{className:"p-4 border-t border-border bg-card",children:e})]})},z5=({isOpen:n,onClose:e,onSave:t,organization:r,allClients:s,initialData:a})=>{const[o,l]=D.useState("General"),c=Ft("(max-width: 767px)"),{register:d,handleSubmit:h,control:p,watch:x,setValue:v,formState:{errors:_},reset:w}=tn({resolver:Dn(jre),defaultValues:{siteOperations:{form6Applicable:!1,minWageRevisionApplicable:!1,uniformDeductions:!1}}}),{fields:j,append:T,remove:P}=ws({control:p,name:"siteOperations.holidays.list"});ws({control:p,name:"siteOperations.tools.list"}),ws({control:p,name:"siteOperations.sims.details"}),ws({control:p,name:"siteOperations.equipment.issued"}),D.useEffect(()=>{n&&w(a||{organizationId:r.id})},[n,a,r.id,w]);const E=x("entityId"),M=x("siteOperations.form6Applicable"),O=x("siteOperations.minWageRevisionApplicable");D.useEffect(()=>{if(E){const F=s.find(B=>B.id===E);F&&(v("registeredAddress",F.registeredAddress||""),v("gstNumber",F.gstNumber||""),v("panNumber",F.panNumber||""),v("email1",F.email||""),v("eShramNumber",F.eShramNumber||""),v("shopAndEstablishmentCode",F.shopAndEstablishmentCode||""))}},[E,s,v]);const I=F=>{t(r.id,F)},q=({tabName:F})=>i.jsx("button",{type:"button",onClick:()=>l(F),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${o===F?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:F});return n?i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4 flex items-center justify-center",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale",onClick:F=>F.stopPropagation(),children:i.jsxs("form",{onSubmit:h(I),className:"p-6",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Site Configuration"}),i.jsxs("p",{className:"text-sm text-muted mb-4",children:["For: ",r.shortName]}),i.jsx("div",{className:"mb-6",children:c?i.jsxs(Ke,{label:"Configuration Section",id:"site-config-tabs",value:o,onChange:F=>l(F.target.value),className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"General",children:"General"}),i.jsx("option",{value:"Compliance",children:"Compliance"}),i.jsx("option",{value:"Agreement",children:"Agreement"}),i.jsx("option",{value:"Site Operations",children:"Site Operations"})]}):i.jsx("div",{className:"border-b border-border",children:i.jsxs("nav",{className:"-mb-px flex space-x-4",children:[i.jsx(q,{tabName:"General"}),i.jsx(q,{tabName:"Compliance"}),i.jsx(q,{tabName:"Agreement"}),i.jsx(q,{tabName:"Site Operations"})]})})}),i.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2 space-y-4",children:[o==="General"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(je,{label:"Location",id:"location",registration:d("location"),error:_.location?.message}),i.jsx(je,{label:"Billing Name",id:"billingName",registration:d("billingName"),error:_.billingName?.message}),i.jsx(je,{label:"Key Account Manager",id:"keyAccountManager",registration:d("keyAccountManager"),error:_.keyAccountManager?.message}),i.jsx(je,{label:"Site Area (Sq.ft)",id:"siteAreaSqFt",type:"number",registration:d("siteAreaSqFt"),error:_.siteAreaSqFt?.message}),i.jsxs(Ke,{label:"Type of Project",id:"projectType",registration:d("projectType"),error:_.projectType?.message,children:[i.jsx("option",{value:"",children:"-- Select Type --"}),q5.filter(Boolean).map(F=>i.jsx("option",{value:F,children:F},F))]}),i.jsx(je,{label:"No of Apartments/Villas",id:"apartmentCount",type:"number",registration:d("apartmentCount"),error:_.apartmentCount?.message})]}),o==="Compliance"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx("div",{className:"md:col-span-2",children:i.jsx(we,{name:"entityId",control:p,render:({field:F})=>i.jsxs(Ke,{label:"Link to Client (Prefills data)",id:"entityId",...F,error:_.entityId?.message,children:[i.jsx("option",{value:"",children:"-- Select Client --"}),s.map(B=>i.jsxs("option",{value:B.id,children:[B.name," (",B.companyName,")"]},B.id))]})})}),i.jsx(je,{label:"GST Number",id:"gstNumber",registration:d("gstNumber"),error:_.gstNumber?.message}),i.jsx(je,{label:"PAN Number",id:"panNumber",registration:d("panNumber"),error:_.panNumber?.message}),i.jsx(je,{label:"Email Address 1",id:"email1",registration:d("email1"),error:_.email1?.message}),i.jsx(je,{label:"Email Address 2",id:"email2",registration:d("email2"),error:_.email2?.message}),i.jsx(je,{label:"Email Address 3",id:"email3",registration:d("email3"),error:_.email3?.message}),i.jsx(je,{label:"E-Shram Number",id:"eShramNumber",registration:d("eShramNumber"),error:_.eShramNumber?.message}),i.jsx(je,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:d("shopAndEstablishmentCode"),error:_.shopAndEstablishmentCode?.message})]}),o==="Agreement"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(we,{name:"agreementDetails.fromDate",control:p,render:({field:F})=>i.jsx(kn,{label:"From Date",id:"agreementDetails.fromDate",value:F.value,onChange:F.onChange,error:_.agreementDetails?.fromDate?.message})}),i.jsx(we,{name:"agreementDetails.toDate",control:p,render:({field:F})=>i.jsx(kn,{label:"To Date",id:"agreementDetails.toDate",value:F.value,onChange:F.onChange,error:_.agreementDetails?.toDate?.message})}),i.jsx(je,{label:"Renewal Interval (Days)",id:"agreementDetails.renewalIntervalDays",type:"number",registration:d("agreementDetails.renewalIntervalDays"),error:_.agreementDetails?.renewalIntervalDays?.message}),i.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(we,{name:"agreementDetails.softCopy",control:p,render:({field:F})=>i.jsx(yt,{label:"Soft Copy",file:F.value,onFileChange:F.onChange})}),i.jsx(we,{name:"agreementDetails.scannedCopy",control:p,render:({field:F})=>i.jsx(yt,{label:"Scanned Copy",file:F.value,onFileChange:F.onChange})})]}),i.jsx(we,{name:"agreementDetails.agreementDate",control:p,render:({field:F})=>i.jsx(kn,{label:"Agreement Dated",id:"agreementDetails.agreementDate",value:F.value,onChange:F.onChange,error:_.agreementDetails?.agreementDate?.message})}),i.jsx(we,{name:"agreementDetails.addendum1Date",control:p,render:({field:F})=>i.jsx(kn,{label:"Addendum 1 Dated",id:"agreementDetails.addendum1Date",value:F.value,onChange:F.onChange,error:_.agreementDetails?.addendum1Date?.message})}),i.jsx(we,{name:"agreementDetails.addendum2Date",control:p,render:({field:F})=>i.jsx(kn,{label:"Addendum 2 Dated",id:"agreementDetails.addendum2Date",value:F.value,onChange:F.onChange,error:_.agreementDetails?.addendum2Date?.message})})]}),o==="Site Operations"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(sR,{title:"Compliance Forms",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(we,{name:"siteOperations.form6Applicable",control:p,render:({field:F})=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:F.value,onChange:F.onChange})," Form 6 Applicable"]})}),M&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[i.jsx(we,{name:"siteOperations.form6ValidityFrom",control:p,render:({field:F})=>i.jsx(kn,{label:"Valid From",id:"form6from",value:F.value,onChange:F.onChange,error:_.siteOperations?.form6ValidityFrom?.message})}),i.jsx(we,{name:"siteOperations.form6ValidityTo",control:p,render:({field:F})=>i.jsx(kn,{label:"Valid To",id:"form6to",value:F.value,onChange:F.onChange,error:_.siteOperations?.form6ValidityTo?.message})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(we,{name:"siteOperations.form6Document",control:p,render:({field:F})=>i.jsx(yt,{label:"Form 6 Document",file:F.value,onFileChange:F.onChange,error:_.siteOperations?.form6Document?.message})})})]})]}),i.jsxs("div",{children:[i.jsx(we,{name:"siteOperations.minWageRevisionApplicable",control:p,render:({field:F})=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:F.value,onChange:F.onChange})," Min. Wage Revision Applicable"]})}),O&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[i.jsx(we,{name:"siteOperations.minWageRevisionValidityFrom",control:p,render:({field:F})=>i.jsx(kn,{label:"Valid From",id:"minwagefrom",value:F.value,onChange:F.onChange,error:_.siteOperations?.minWageRevisionValidityFrom?.message})}),i.jsx(we,{name:"siteOperations.minWageRevisionValidityTo",control:p,render:({field:F})=>i.jsx(kn,{label:"Valid To",id:"minwageto",value:F.value,onChange:F.onChange,error:_.siteOperations?.minWageRevisionValidityTo?.message})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(we,{name:"siteOperations.minWageRevisionDocument",control:p,render:({field:F})=>i.jsx(yt,{label:"Min. Wage Document",file:F.value,onFileChange:F.onChange,error:_.siteOperations?.minWageRevisionDocument?.message})})})]})]})]})}),i.jsx(sR,{title:"Holidays",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx(je,{label:"Number of National & Festival Holidays",id:"holiday-count",type:"number",registration:d("siteOperations.holidays.numberOfDays")}),i.jsxs(Ke,{label:"Salary Payment for Holiday",id:"holiday-salary",registration:d("siteOperations.holidays.salaryPayment"),children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Full Payment"}),i.jsx("option",{children:"Duty Payment"}),i.jsx("option",{children:"Nil Payment"})]}),i.jsxs(Ke,{label:"Billing for Holiday",id:"holiday-billing",registration:d("siteOperations.holidays.billing"),children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Full Payment"}),i.jsx("option",{children:"Duty Payment"}),i.jsx("option",{children:"Nil Payment"})]}),i.jsx("h5",{className:"font-semibold pt-2 border-t",children:"Holiday List"}),j.map((F,B)=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[i.jsx("div",{className:"col-span-6",children:i.jsx(je,{label:"Description",id:`holiday-desc-${B}`,...d(`siteOperations.holidays.list.${B}.description`)})}),i.jsx("div",{className:"col-span-5",children:i.jsx(we,{name:`siteOperations.holidays.list.${B}.date`,control:p,render:({field:U})=>i.jsx(kn,{label:"Date",id:`holiday-date-${B}`,value:U.value,onChange:U.onChange})})}),i.jsx("div",{className:"col-span-1",children:i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>P(B),children:i.jsx(rn,{className:"h-4 text-red-500"})})})]},F.id)),i.jsxs(re,{type:"button",variant:"outline",size:"sm",onClick:()=>T({id:`hol_${Date.now()}`,date:"",description:""}),children:[i.jsx(Bt,{className:"h-4 mr-1"})," Add Holiday"]})]})})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[i.jsx(re,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(re,{type:"submit",children:"Save Configuration"})]})]})})}):null},Nre=({isOpen:n,onClose:e,siteName:t,details:r,isLoading:s,onSave:a,designations:o})=>{const[l,c]=D.useState([]),[d,h]=D.useState(!1),p=D.useRef(null),[x,v]=D.useState(!1),_=D.useMemo(()=>{const I=new Set;return o.filter(q=>I.has(q.designation)?!1:(I.add(q.designation),!0)).sort((q,F)=>q.designation.localeCompare(F.designation))},[o]),w=()=>{const I=p.current;if(I){const q=I.scrollHeight>I.clientHeight,F=I.scrollHeight-I.scrollTop<=I.clientHeight+1;v(q&&!F)}else v(!1)};D.useEffect(()=>{if(n){c(JSON.parse(JSON.stringify(r)));const I=setTimeout(w,150);return()=>clearTimeout(I)}},[r,n,s]);const j=(I,q,F)=>{const B=[...l],U=B[I];if(q==="count"){const W=Number(F);U.count=isNaN(W)?0:W}else U.designation=String(F);c(B)},T=()=>{c([...l,{designation:"",count:0,tempId:`new_${Date.now()}`}]),setTimeout(w,50)},P=I=>{const q=l.filter((F,B)=>B!==I);c(q),setTimeout(w,50)},E=async()=>{h(!0);const I=l.filter(q=>q.designation.trim()!=="").map(({tempId:q,...F})=>F);await a(I),h(!1)},M=ot.useMemo(()=>l.reduce((I,q)=>I+(Number(q.count)||0),0),[l]),O=I=>{if(I.key!=="ArrowUp"&&I.key!=="ArrowDown")return;const q=I.target;if(q.tagName!=="INPUT"&&q.tagName!=="SELECT")return;const F=q.getAttribute("data-row-index"),B=q.getAttribute("data-col-index");if(!F||!B||q.type==="number")return;I.preventDefault();const U=I.currentTarget,W=parseInt(F,10),$=parseInt(B,10),se=I.key==="ArrowUp"?W-1:W+1,Y=U.querySelector(`[data-row-index="${se}"][data-col-index="${$}"]`);Y&&Y.focus()};return n?VL.createPortal(i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm sm:max-w-lg md:max-w-2xl m-4 animate-fade-in-scale flex flex-col",onClick:I=>I.stopPropagation(),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Allocate Manpower"}),i.jsxs("p",{className:"text-sm text-muted mb-4",children:["For site: ",t]}),i.jsxs("div",{className:"flex-grow relative overflow-hidden",children:[i.jsx("div",{ref:p,onScroll:w,onKeyDown:O,className:"overflow-y-auto pr-2 min-h-[300px] max-h-[60vh] h-full",children:s?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-12 gap-4 sticky top-0 bg-page p-2 rounded-t-lg z-10",children:[i.jsx("div",{className:"col-span-6 font-medium text-sm text-muted",children:"Designation"}),i.jsx("div",{className:"col-span-4 font-medium text-sm text-muted",children:"Count"}),i.jsx("div",{className:"col-span-2"})]}),l.length>0?l.map((I,q)=>i.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[i.jsx("div",{className:"col-span-6",children:i.jsxs(Ke,{id:`designation-${q}`,value:I.designation,onChange:F=>j(q,"designation",F.target.value),className:"py-1.5","data-row-index":q,"data-col-index":0,"aria-label":`Designation for row ${q+1}`,children:[i.jsx("option",{value:"",children:"Select Designation"}),_.map(F=>i.jsx("option",{value:F.designation,children:F.designation},F.id))]})}),i.jsx("div",{className:"col-span-4",children:i.jsx(je,{id:`count-${q}`,type:"number",value:I.count,onChange:F=>j(q,"count",F.target.value),min:"0",step:"0.01",className:"py-1.5","data-row-index":q,"data-col-index":1,"aria-label":`Count for row ${q+1}`})}),i.jsx("div",{className:"col-span-2 text-right",children:i.jsx(re,{variant:"icon",size:"sm",onClick:()=>P(q),title:"Remove row","aria-label":`Remove row ${q+1}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},I.tempId||q)):i.jsx("p",{className:"text-center text-muted py-10",children:"No designations added yet. Click below to start."}),i.jsxs(re,{variant:"outline",size:"sm",onClick:T,className:"mt-4",children:[i.jsx(Bt,{className:"h-4 w-4 mr-2"})," Add Designation"]})]})}),x&&i.jsx("div",{className:"absolute bottom-0 left-0 right-2 h-16 bg-gradient-to-t from-card to-transparent pointer-events-none"})]}),i.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-between items-center",children:[i.jsxs("div",{className:"font-semibold",children:["Total Manpower: ",i.jsx("span",{className:"text-accent",children:M.toFixed(2)})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx(re,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),i.jsx(re,{onClick:E,isLoading:d,disabled:s,children:"Save Changes"})]})]})]})}),document.getElementById("modal-root")):null},hN=["id","shortName","fullName","address","manpowerApprovedCount","reportingManagerName","managerName","fieldOfficerNames","backendFieldOfficerNames"],Sre=(n,e)=>{const t=e.join(","),r=n.map(s=>e.map(a=>{let o=s[a];return Array.isArray(o)&&(o=o.join(";")),o=o==null?"":String(o),o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...r].join(`
`)},Cre=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,"")),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),a[l]=d}),r.push(a)}return r},Tre=()=>{const n=St(),[e,t]=D.useState([]),[r,s]=D.useState([]),[a,o]=D.useState([]),[l,c]=D.useState([]),[d,h]=D.useState(!0),[p,x]=D.useState(!1),[v,_]=D.useState(!1),[w,j]=D.useState(!1),[T,P]=D.useState(null),[E,M]=D.useState(null),[O,I]=D.useState(null),[q,F]=D.useState([]),[B,U]=D.useState(!1),W=D.useRef(null),$=Ft("(max-width: 767px)"),{siteManagement:se}=pi(),Y=D.useCallback(async()=>{h(!0);try{const[ne,de,ce,pe]=await Promise.all([ue.getOrganizations().catch(xe=>(console.error("Failed to fetch organizations:",xe),[])),ue.getOrganizationStructure().catch(xe=>(console.error("Failed to fetch organization structure:",xe),[])),ue.getSiteConfigurations().catch(xe=>(console.error("Failed to fetch site configurations:",xe),[])),ue.getSiteStaffDesignations().catch(xe=>(console.error("Failed to fetch site staff designations:",xe),I({message:"Could not load designation list. Manpower editing may be affected.",type:"error"}),[]))]);t(ne),s(ce),c(pe);const ie=de.flatMap(xe=>xe.companies.flatMap(Ce=>Ce.entities.map(ve=>({...ve,companyName:Ce.name}))));o(ie)}catch{I({message:"An unexpected error occurred while fetching data.",type:"error"})}finally{h(!1)}},[]);D.useEffect(()=>{Y()},[Y]);const ae=ne=>{P(ne),x(!0)},J=ne=>{M(ne),_(!0)},ee=(ne,de)=>{s(ce=>{const pe=[...ce],ie=pe.findIndex(xe=>xe.organizationId===ne);return ie>-1?pe[ie]=de:pe.push(de),pe}),I({message:"Site configuration saved.",type:"success"}),x(!1)},X=async()=>{E&&(t(ne=>ne.filter(de=>de.id!==E.id)),s(ne=>ne.filter(de=>de.organizationId!==E.id)),I({message:"Site deleted.",type:"success"}),_(!1))},Z=async ne=>{M(ne),U(!0),j(!0);try{const de=await ue.getManpowerDetails(ne.id);F(de)}catch{I({message:"Could not load manpower details.",type:"error"})}finally{U(!1)}},oe=async ne=>{if(E)try{await ue.updateManpowerDetails(E.id,ne);const de=ne.reduce((ce,pe)=>ce+(Number(pe.count)||0),0);t(ce=>ce.map(pe=>pe.id===E.id?{...pe,manpowerApprovedCount:de}:pe)),j(!1),I({message:"Manpower details updated successfully.",type:"success"})}catch{I({message:"Failed to save manpower details.",type:"error"})}},H=()=>{const ne=Sre(e,hN),de=new Blob([ne],{type:"text/csv;charset=utf-8;"}),ce=document.createElement("a");ce.href=URL.createObjectURL(de),ce.setAttribute("download","sites_export.csv"),document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),I({message:"Sites exported successfully.",type:"success"})},Q=ne=>{const de=ne.target.files?.[0];if(!de)return;const ce=new FileReader;ce.onload=async pe=>{try{const ie=pe.target?.result;if(!ie)throw new Error("File is empty or could not be read.");const xe=Cre(ie);if(xe.length===0)throw new Error("No data rows found in the CSV file.");const Ce=Object.keys(xe[0]);if(!hN.every(Ie=>Ce.includes(Ie)))throw new Error(`CSV is missing headers. Required: ${hN.join(", ")}`);const Oe=xe.map(Ie=>({id:Ie.id,shortName:Ie.shortName,fullName:Ie.fullName,address:Ie.address,manpowerApprovedCount:parseFloat(Ie.manpowerApprovedCount)||0,reportingManagerName:Ie.reportingManagerName||void 0,managerName:Ie.managerName||void 0,fieldOfficerNames:Ie.fieldOfficerNames?Ie.fieldOfficerNames.split(";").map(Fe=>Fe.trim()).filter(Fe=>Fe):void 0,backendFieldOfficerNames:Ie.backendFieldOfficerNames?Ie.backendFieldOfficerNames.split(";").map(Fe=>Fe.trim()).filter(Fe=>Fe):void 0})),{count:Pe}=await ue.bulkUploadOrganizations(Oe);I({message:`${Pe} sites imported/updated successfully.`,type:"success"}),Y()}catch(ie){I({message:ie.message||"Failed to import CSV.",type:"error"})}finally{ne.target&&(ne.target.value="")}},ce.readAsText(de)};return i.jsxs("div",{className:"p-4 md:p-8",children:[O&&i.jsx(ht,{message:O.message,type:O.type,onDismiss:()=>I(null)}),i.jsx("input",{type:"file",ref:W,className:"hidden",accept:".csv",onChange:Q}),i.jsx("input",{type:"file",ref:W,className:"hidden",accept:".csv",onChange:Q}),p&&T&&i.jsx(z5,{isOpen:p,onClose:()=>x(!1),onSave:ee,organization:T,allClients:a,initialData:r.find(ne=>ne.organizationId===T.id)}),E&&i.jsx(Nre,{isOpen:w,onClose:()=>j(!1),siteName:E.shortName,details:q,isLoading:B,onSave:oe,designations:l}),i.jsxs(Hr,{isOpen:v,onClose:()=>_(!1),onConfirm:X,title:"Confirm Deletion",children:['Are you sure you want to delete the site "',E?.shortName,'"? This action cannot be undone.']}),i.jsxs("div",{className:"bg-card p-4 rounded-2xl mb-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Site Management"}),!$&&i.jsxs("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:[i.jsxs(re,{variant:"outline",onClick:()=>n("/admin/sites/quick-add"),className:"mr-2 hover:bg-gray-100",children:[i.jsx(Bt,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),i.jsxs(re,{onClick:()=>n("/admin/sites/add"),className:"mr-2 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[i.jsx(Bt,{className:"w-5 h-5 mr-2"}),"Add Site"]}),i.jsxs(re,{variant:"outline",onClick:()=>W.current?.click(),className:"mr-2 hover:bg-gray-100",children:[i.jsx(Bc,{className:"w-5 h-5 mr-2"}),"Import"]}),i.jsxs(re,{variant:"outline",onClick:H,className:"hover:bg-gray-100",children:[i.jsx(xi,{className:"w-5 h-5 mr-2"}),"Export"]})]})]}),$&&i.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[i.jsxs(re,{onClick:()=>n("/admin/sites/add"),className:"w-full justify-center bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[i.jsx(Bt,{className:"w-5 h-5 mr-2"}),"Add Site"]}),i.jsxs(re,{variant:"outline",onClick:()=>n("/admin/sites/quick-add"),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(Bt,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs(re,{variant:"outline",onClick:()=>W.current?.click(),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(Bc,{className:"w-5 h-5 mr-2"}),"Import"]}),i.jsxs(re,{variant:"outline",onClick:H,className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(xi,{className:"w-5 h-5 mr-2"}),"Export"]})]})]})]}),i.jsx("div",{className:"bg-card rounded-2xl shadow-sm border border-border overflow-hidden",children:d?i.jsx("div",{className:"overflow-x-auto",children:i.jsx("table",{className:"w-full",children:i.jsx("tbody",{className:"divide-y divide-border",children:i.jsx(Ea,{cols:5,rows:5})})})}):e.length===0?i.jsxs("div",{className:"p-8 text-center text-muted",children:[i.jsx($i,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),i.jsx("p",{children:"No sites found. Add a new site to get started."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-muted/50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Location"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-muted uppercase tracking-wider",children:"Manpower"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Key Staff"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:e.map(ne=>{r.find(pe=>pe.organizationId===ne.id);const de=!!ne.provisionalCreationDate,ce=de&&ne.provisionalCreationDate?90-EB(new Date,new Date(ne.provisionalCreationDate)):0;return i.jsxs("tr",{className:"hover:bg-muted/5 transition-colors",children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center",children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-primary-text",children:ne.shortName}),i.jsx("div",{className:"text-xs text-muted",children:ne.fullName}),de&&i.jsxs("div",{className:`mt-1 text-xs px-2 py-0.5 rounded-full inline-flex items-center gap-1 ${ce>30?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[i.jsx(LF,{className:"w-3 h-3"}),ce>0?`${ce} days left`:"Expired"]})]})})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"text-sm text-primary-text max-w-xs truncate",title:ne.address,children:ne.address})}),i.jsx("td",{className:"px-6 py-4 text-center",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:ne.manpowerApprovedCount||0})}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"text-xs space-y-1",children:[ne.reportingManagerName&&i.jsxs("div",{className:"flex items-center gap-1",title:"Reporting Manager",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:"RM:"})," ",ne.reportingManagerName]}),ne.managerName&&i.jsxs("div",{className:"flex items-center gap-1",title:"Site Manager",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:"SM:"})," ",ne.managerName]}),ne.fieldOfficerNames&&ne.fieldOfficerNames.length>0&&i.jsxs("div",{className:"flex items-start gap-1",title:"Field Officers",children:[i.jsx("span",{className:"font-semibold text-primary-text whitespace-nowrap",children:"FO:"}),i.jsx("span",{className:"truncate max-w-[150px]",children:ne.fieldOfficerNames.join(", ")})]}),ne.backendFieldOfficerNames&&ne.backendFieldOfficerNames.length>0&&i.jsxs("div",{className:"flex items-start gap-1",title:"Backend Field Officers",children:[i.jsx("span",{className:"font-semibold text-primary-text whitespace-nowrap",children:"BFO:"}),i.jsx("span",{className:"truncate max-w-[150px]",children:ne.backendFieldOfficerNames.join(", ")})]})]})}),i.jsx("td",{className:"px-6 py-4 text-right whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx(re,{variant:"icon",size:"sm",onClick:()=>Z(ne),title:"Manpower Details",children:i.jsx(Yi,{className:"w-4 h-4 text-blue-600"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>ae(ne),title:"Configure Site",children:i.jsx(Sm,{className:"w-4 h-4 text-gray-600"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>J(ne),title:"Delete Site",children:i.jsx(rn,{className:"w-4 h-4 text-red-600"})})]})})]},ne.id)})})]})})})]})},kre=({isOpen:n,onClose:e,onSave:t,title:r,initialName:s=""})=>{const[a,o]=D.useState(s),[l,c]=D.useState("");D.useEffect(()=>{n&&(o(s),c(""))},[n,s]);const d=()=>{if(!a.trim()){c("Role name cannot be empty.");return}t(a.trim()),e()};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm m-4 animate-fade-in-scale",onClick:h=>h.stopPropagation(),children:i.jsxs("form",{onSubmit:h=>{h.preventDefault(),d()},children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-4",children:r}),i.jsx(je,{label:"Role Display Name",id:"role-name",value:a,onChange:h=>o(h.target.value),error:l,autoFocus:!0}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(re,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(re,{type:"submit",children:"Save"})]})]})})}):null},mm=[{key:"apply_for_leave",name:"Apply for Leave",description:"Allows users to request time off."},{key:"create_enrollment",name:"Create Enrollment",description:"Access the multi-step form to onboard new employees."},{key:"view_developer_settings",name:"Developer Settings",description:"Access API settings and other developer tools."},{key:"download_attendance_report",name:"Download Attendance Report",description:"Generate and download attendance reports in CSV format."},{key:"manage_approval_workflow",name:"Manage Approval Workflow",description:"Set up reporting managers for leave approvals."},{key:"manage_attendance_rules",name:"Manage Attendance Rules",description:"Set work hours, holidays, and leave allocations."},{key:"manage_enrollment_rules",name:"Manage Enrollment Rules",description:"Set rules for ESI/GMC, manpower limits, and documents."},{key:"manage_insurance",name:"Manage Insurance",description:"Create and manage company insurance plans."},{key:"manage_leave_requests",name:"Manage Leave Requests",description:"Approve or reject leave requests for employees."},{key:"manage_modules",name:"Manage Modules",description:"Create, edit, and group permissions into modules."},{key:"manage_policies",name:"Manage Policies",description:"Create and manage company policies."},{key:"manage_roles_and_permissions",name:"Manage Roles & Permissions",description:"Access this page to edit role permissions."},{key:"manage_sites",name:"Manage Sites",description:"Create, edit, and delete organizations/sites."},{key:"manage_tasks",name:"Manage Tasks",description:"Create, assign, and manage all organizational tasks, including escalations."},{key:"manage_uniforms",name:"Manage Uniforms",description:"Manage uniform requests and site configurations."},{key:"manage_users",name:"Manage Users",description:"Create, edit, and delete user accounts."},{key:"view_operations_dashboard",name:"Operations Dashboard",description:"View the operations management dashboard."},{key:"view_site_dashboard",name:"Site Dashboard",description:"View the dashboard for a specific site/organization."},{key:"view_all_attendance",name:"View All Attendance",description:"Allows users to see attendance records for all employees."},{key:"view_all_submissions",name:"View All Submissions",description:"Access the main dashboard to view all employee submissions."},{key:"view_entity_management",name:"View Entity Management",description:"Access the HR dashboard for managing company entities."},{key:"view_field_officer_tracking",name:"View Field Officer Tracking",description:"Track user check-in/out locations and activity on a map."},{key:"view_invoice_summary",name:"View Invoice Summary",description:"View and generate monthly invoices for sites."},{key:"view_own_attendance",name:"View Own Attendance",description:"Allows users to see their own attendance records."},{key:"view_verification_costing",name:"View Verification Costing",description:"Analyze costs associated with third-party document verifications."}].sort((n,e)=>n.name.localeCompare(e.name)),Pre=()=>{const n=St(),{permissions:e,setRolePermissions:t,addRolePermissionEntry:r,removeRolePermissionEntry:s,renameRolePermissionEntry:a}=Ki(),[o,l]=D.useState([]),[c,d]=D.useState([]),[h,p]=D.useState(!0),[x,v]=D.useState(null),[_,w]=D.useState(!1),[j,T]=D.useState(!1),[P,E]=D.useState(null),[M,O]=D.useState(!1),[I,q]=D.useState(null),F=D.useRef(null),B=Ft("(max-width: 767px)");D.useEffect(()=>{(async()=>{p(!0);try{const[ee,X]=await Promise.all([ue.getRoles(),ue.getModules()]);l(ee),d(X.sort((Z,oe)=>Z.name.localeCompare(oe.name)))}catch(ee){console.error("Failed to load data",ee),v({message:"Failed to load page data.",type:"error"})}finally{p(!1)}})()},[]),D.useEffect(()=>{const J=ee=>{F.current&&!F.current.contains(ee.target)&&q(null)};return document.addEventListener("mousedown",J),()=>document.removeEventListener("mousedown",J)},[]);const U=(J,ee,X)=>{const Z=e[J]||[],oe=X?[...Z,ee]:Z.filter(H=>H!==ee);t(J,oe)},W=async J=>{const ee=J.toLowerCase().replace(/\s+/g,"_");if(M&&P){if(P.id==="admin"){v({message:"The Admin role cannot be renamed.",type:"error"});return}if(o.some(Z=>Z.id===ee&&Z.id!==P.id)){v({message:`A role with ID '${ee}' already exists.`,type:"error"});return}const X=o.map(Z=>Z.id===P.id?{...Z,displayName:J,id:ee}:Z);await ue.saveRoles(X),l(X),a(P.id,ee),v({message:"Role renamed.",type:"success"})}else{if(o.some(oe=>oe.id===ee)){v({message:`A role with ID '${ee}' already exists.`,type:"error"});return}const X={id:ee,displayName:J},Z=[...o,X];await ue.saveRoles(Z),l(Z),r(X),v({message:"Role added successfully.",type:"success"})}},$=async()=>{if(!P||P.id==="admin"){v({message:"This role cannot be deleted.",type:"error"}),T(!1);return}const J=o.filter(ee=>ee.id!==P.id);await ue.saveRoles(J),l(J),s(P.id),v({message:`Role '${P.displayName}' deleted.`,type:"success"}),T(!1)},se=D.useMemo(()=>new Map(mm.map(J=>[J.key,J])),[]),Y=D.useMemo(()=>{const J=new Set(c.flatMap(ee=>ee.permissions));return mm.filter(ee=>!J.has(ee.key))},[c]),ae=J=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Permission",className:"px-4 py-4",children:i.jsxs("div",{className:"flex flex-col items-end text-right md:items-start md:text-left",children:[i.jsx("div",{className:"font-semibold text-primary-text",children:J.name}),i.jsx("div",{className:"text-xs text-muted",children:J.description})]})}),o.map(ee=>{const X=e[ee.id]?.includes(J.key),Z=ee.id==="admin",oe=Z?"Admin role has all permissions by default and cannot be changed.":"";return i.jsx("td",{"data-label":ee.displayName,className:"px-4 py-4 text-center align-middle",children:i.jsx("div",{className:"flex justify-center",children:i.jsxs("label",{className:`relative flex items-center justify-center w-5 h-5 ${Z?"cursor-not-allowed":"cursor-pointer"}`,children:[i.jsx("input",{type:"checkbox",className:"sr-only peer",checked:X,onChange:H=>U(ee.id,J.key,H.target.checked),disabled:Z,title:oe}),i.jsx("span",{className:`w-5 h-5 bg-white border border-gray-300 rounded flex items-center justify-center peer-focus-visible:ring-2 peer-focus-visible:ring-offset-2 peer-focus-visible:ring-accent-dark peer-checked:border-accent ${Z?"opacity-50":""}`,children:X?i.jsx(_l,{className:"w-4 h-4 text-accent"}):i.jsx(gi,{className:"w-4 h-4 text-red-500"})})]})})},ee.id)})]},J.key);return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)}),i.jsx(kre,{isOpen:_,onClose:()=>w(!1),onSave:W,title:M?"Rename Role":"Add New Role",initialName:M?P?.displayName:""}),i.jsxs(Hr,{isOpen:j,onClose:()=>T(!1),onConfirm:$,title:"Confirm Deletion",children:['Are you sure you want to delete the role "',P?.displayName,'"? This action cannot be undone.']}),i.jsx(Ji,{title:"Role & Permission Management",children:i.jsxs("button",{onClick:()=>n("/admin/roles/add"),className:"btn btn-primary btn-md",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Role"]})}),i.jsx("p",{className:"text-muted text-sm -mt-4 mb-6",children:"Assign permissions to user roles. Changes are saved automatically."}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-4 py-3 text-left font-bold text-primary-text",children:"Permission"}),o.map(J=>i.jsx("th",{scope:"col",className:"px-4 py-3 text-center font-bold text-primary-text w-40",children:i.jsxs("div",{className:"flex items-center justify-center gap-1",children:[i.jsx("span",{children:J.displayName}),J.id!=="admin"&&i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>q(J.id===I?null:J.id),children:i.jsx(QK,{className:"h-4 w-4 text-muted"})}),I===J.id&&i.jsxs("div",{ref:F,className:"absolute right-0 mt-2 w-32 bg-card border rounded-md shadow-lg z-10",children:[i.jsxs("button",{onClick:()=>{n(`/admin/roles/edit/${J.id}`),q(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center",children:[i.jsx(cr,{className:"mr-2 h-4 w-4"}),"Edit"]}),i.jsxs("button",{onClick:()=>{E(J),T(!0),q(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center text-red-600",children:[i.jsx(rn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})},J.id))]})}),h?i.jsx("tbody",{children:B?i.jsx("tr",{children:i.jsx("td",{colSpan:o.length+1||2,children:i.jsx(Ea,{rows:3,cols:2,isMobile:!0})})}):i.jsx(Ea,{rows:10,cols:o.length+1||5})}):i.jsxs(i.Fragment,{children:[c.map(J=>i.jsxs("tbody",{className:"divide-y divide-border",children:[i.jsx("tr",{className:"bg-page/50",children:i.jsx("td",{colSpan:o.length+1,className:"p-2 font-bold text-primary-text",children:J.name})}),J.permissions.map(ee=>{const X=se.get(ee);return X?ae(X):null})]},J.id)),Y.length>0&&i.jsxs("tbody",{className:"divide-y divide-border",children:[i.jsx("tr",{className:"bg-page/50",children:i.jsx("td",{colSpan:o.length+1,className:"p-2 font-bold text-primary-text",children:"Uncategorized"})}),Y.map(ae)]})]})]})})]})},Mre=Pt({id:ge().required(),name:ge().required("Module name is required"),description:ge().required("Description is required"),permissions:_s().of(ge().required()).min(1,"At least one permission must be selected")}).defined(),Dre=({isOpen:n,onClose:e,onSave:t,initialData:r})=>{const{register:s,handleSubmit:a,control:o,reset:l,formState:{errors:c}}=tn({resolver:Dn(Mre)});return D.useEffect(()=>{n&&l(r||{id:`mod_${Date.now()}`,name:"",description:"",permissions:[]})},[n,r,l]),n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-2xl my-8 animate-fade-in-scale flex flex-col",onClick:d=>d.stopPropagation(),children:i.jsxs("form",{onSubmit:a(t),children:[i.jsx("div",{className:"p-4 border-b",children:i.jsxs("h3",{className:"text-xl font-bold",children:[r?"Edit":"Add"," Module"]})}),i.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[i.jsx(je,{label:"Module Name",...s("name"),error:c.name?.message}),i.jsx(je,{label:"Description",...s("description"),error:c.description?.message}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Permissions"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 p-4 border rounded-lg h-64 overflow-y-auto bg-page",children:i.jsx(we,{name:"permissions",control:o,render:({field:d})=>i.jsx(i.Fragment,{children:mm.map(h=>i.jsx(Pn,{id:`perm-${h.key}`,label:h.name,checked:d.value?.includes(h.key)||!1,onChange:p=>{const x=p?[...d.value||[],h.key]:(d.value||[]).filter(v=>v!==h.key);d.onChange(x)}},h.key))})})}),c.permissions&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:Array.isArray(c.permissions)?c.permissions[0]?.message:c.permissions.message})]})]}),i.jsxs("div",{className:"p-4 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(re,{type:"submit",children:"Save Module"})]})]})})}):null},Ere=({count:n=6})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:n}).map((e,t)=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx($r,{className:"h-5 w-5 rounded-full"}),i.jsx($r,{className:"h-5 w-1/2"})]}),i.jsx($r,{className:"h-4 w-full"}),i.jsx($r,{className:"h-4 w-3/4"}),i.jsx($r,{className:"h-3 w-1/4"})]},t))}),Ore=()=>{const n=St(),[e,t]=D.useState([]),[r,s]=D.useState(!0),[a,o]=D.useState(null),[l,c]=D.useState(!1),[d,h]=D.useState(!1),[p,x]=D.useState(null);D.useEffect(()=>{(async()=>{s(!0);try{const j=await ue.getModules();t(j)}catch{o({message:"Failed to load modules.",type:"error"})}finally{s(!1)}})()},[]);const v=async w=>{const j=[...e],T=j.findIndex(P=>P.id===w.id);T>-1?j[T]=w:j.push(w);try{await ue.saveModules(j),t(j.sort((P,E)=>P.name.localeCompare(E.name))),o({message:`Module '${w.name}' saved.`,type:"success"}),c(!1)}catch{o({message:"Failed to save module.",type:"error"})}},_=async()=>{if(!p)return;const w=e.filter(j=>j.id!==p.id);try{await ue.saveModules(w),t(w),o({message:`Module '${p.name}' deleted.`,type:"success"}),h(!1)}catch{o({message:"Failed to delete module.",type:"error"})}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a&&i.jsx(ht,{...a,onDismiss:()=>o(null)}),i.jsx(Dre,{isOpen:l,onClose:()=>c(!1),onSave:v,initialData:p}),i.jsxs(Hr,{isOpen:d,onClose:()=>h(!1),onConfirm:_,title:"Confirm Deletion",children:['Are you sure you want to delete the module "',p?.name,'"?']}),i.jsx(Ji,{title:"Module Management",children:i.jsxs(re,{onClick:()=>n("/admin/modules/add"),children:[i.jsx(Bt,{className:"mr-2 h-4"})," Add Module"]})}),r?i.jsx(Ere,{count:6}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(w=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col",children:[i.jsxs("div",{className:"flex-grow",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx(dm,{className:"h-5 w-5 text-accent"}),i.jsx("h4",{className:"font-bold text-primary-text",children:w.name})]}),i.jsx("p",{className:"text-sm text-muted mb-3",children:w.description}),i.jsxs("p",{className:"text-xs font-semibold text-muted",children:[w.permissions.length," permissions"]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border flex justify-end gap-2",children:[i.jsx(re,{variant:"icon",onClick:()=>{x(w),c(!0)},title:`Edit ${w.name}`,className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(cr,{className:"h-5 w-5"})}),i.jsx(re,{variant:"icon",onClick:()=>{x(w),h(!0)},title:`Delete ${w.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]},w.id))})]})},mN=({title:n,icon:e,children:t})=>i.jsxs("div",{className:"bg-page p-4 rounded-lg",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(e,{className:"h-5 w-5 text-accent-dark mr-3"}),i.jsx("h4",{className:"font-semibold text-primary-text",children:n})]}),i.jsx("div",{className:"space-y-4",children:t})]}),Ire=({isOpen:n,onClose:e})=>{const{currentLogo:t,defaultLogo:r,setCurrentLogo:s,setDefaultLogo:a,resetToDefault:o,resetToOriginal:l}=SC(),{backgroundImages:c,addBackgroundImage:d,removeBackgroundImage:h}=a3(),p=r3(),[x,v]=D.useState(null),_=E=>{if(E){const M=new FileReader;M.readAsDataURL(E.file),M.onloadend=()=>{const O=M.result;s(O),v({message:"Active logo updated!",type:"success"})},M.onerror=()=>{v({message:"Failed to read logo file.",type:"error"})}}},w=()=>{a(),v({message:"Active logo has been set as the new default.",type:"success"})},j=()=>{o(),v({message:"Logo has been reset to your default.",type:"success"})},T=()=>{l(),v({message:"Logo has been reset to the system original.",type:"success"})},P=E=>{if(E&&!E.url){const M=new FileReader;M.readAsDataURL(E.file),M.onloadend=()=>{const O=M.result,I=d(O);v(I?{message:"Background image added.",type:"success"}:{message:"This image has already been added.",type:"error"})},M.onerror=()=>{v({message:"Failed to read image file.",type:"error"})}}};return n?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:[x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)}),i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale flex flex-col",onClick:E=>E.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Page Interface Settings"}),i.jsx(re,{variant:"icon",onClick:e,children:i.jsx(gi,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[75vh]",children:[i.jsxs(mN,{title:"Branding & Logo",icon:WF,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the active and default logos for your application."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pt-4 items-start",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Active Logo"}),i.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:i.jsx("img",{src:t,alt:"Current Active Logo",className:"max-h-24 w-auto"})}),i.jsx(yt,{label:"Change Active Logo",file:null,onFileChange:_,allowedTypes:["image/jpeg","image/png"]})]}),i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Default Logo"}),i.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:i.jsx("img",{src:r,alt:"Default Logo",className:"max-h-24 w-auto"})})]}),i.jsx("div",{className:"flex-grow"}),i.jsxs("div",{className:"space-y-2 mt-4",children:[i.jsx(re,{type:"button",className:"w-full",onClick:w,children:"Set Active Logo as Default"}),i.jsx(re,{type:"button",className:"w-full",variant:"outline",onClick:j,children:"Use Default Logo"}),i.jsx("div",{className:"text-center pt-2",children:i.jsx("button",{type:"button",onClick:T,className:"text-xs text-muted hover:text-primary-text underline",children:"Reset to System Original"})})]})]})]})]}),i.jsxs(mN,{title:"Login Screen Background",icon:$F,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the background images for the login screen carousel."}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:c.map((E,M)=>i.jsxs("div",{className:"relative group aspect-video bg-page rounded-md overflow-hidden",children:[i.jsx("img",{src:E,className:"w-full h-full object-cover",alt:`Background ${M+1}`}),i.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:i.jsx(re,{variant:"icon",onClick:()=>h(M),className:"!rounded-full !bg-white/20 hover:!bg-white/40",children:i.jsx(rn,{className:"h-5 w-5 text-white"})})})]},`${E.substring(0,30)}-${M}`))}),i.jsx("div",{className:"mt-4",children:i.jsx(yt,{label:"Add new background image",file:null,onFileChange:P,allowedTypes:["image/jpeg","image/png","image/webp"]})})]}),i.jsxs(mN,{title:"Interaction Settings",icon:uJ,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize hover and auto-scroll behaviors for easier navigation."}),i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsx(Pn,{id:"auto-click-hover-modal",label:"Enable Auto-Click on Hover",description:"Automatically switch tabs or pages by hovering over them.",checked:p.autoClickOnHover,onChange:p.setAutoClickOnHover}),i.jsx(Pn,{id:"auto-scroll-hover-modal",label:"Enable Auto-Scroll on Hover",description:"Automatically scroll the page by hovering over the up/down arrows.",checked:p.autoScrollOnHover,onChange:p.setAutoScrollOnHover})]})]})]}),i.jsx("div",{className:"p-4 border-t flex justify-end",children:i.jsx(re,{variant:"primary",onClick:e,children:"Done"})})]})]}):null},Ju=({title:n,icon:e,children:t,className:r})=>i.jsxs("div",{className:`border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card ${r||""}`,children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(e,{className:"h-6 w-6 text-accent-dark"})}),i.jsx("div",{children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:n})})]}),i.jsx("div",{className:"space-y-4",children:t})]}),Are=()=>{const n=pi(),[e,t]=D.useState(!1),[r,s]=D.useState(null),[a,o]=D.useState(!1),l=async()=>{t(!0),s(null);try{const c=await ue.exportAllData(),d=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(c,null,2))}`,h=document.createElement("a");h.href=d,h.download=`paradigm_backup_${new Date().toISOString()}.json`,document.body.appendChild(h),h.click(),document.body.removeChild(h),s({message:"Data exported successfully!",type:"success"})}catch{s({message:"Failed to export data.",type:"error"})}finally{t(!1)}};return i.jsxs("div",{className:"space-y-8 p-4 md:p-0",children:[r&&i.jsx(ht,{message:r.message,type:r.type,onDismiss:()=>s(null)}),i.jsx(Ire,{isOpen:a,onClose:()=>o(!1)}),i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"System Settings"})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[i.jsxs("div",{className:"space-y-8",children:[i.jsxs(Ju,{title:"Page Interface",icon:WF,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize the application's branding, login screen, and user interaction settings."}),i.jsx("div",{className:"pt-4",children:i.jsx(re,{type:"button",onClick:()=>o(!0),children:"Open Interface Settings"})})]}),i.jsxs(Ju,{title:"Verification APIs",icon:Xx,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure third-party services for employee verification."}),i.jsxs("div",{className:"space-y-6 pt-4",children:[i.jsx("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:i.jsx(Pn,{id:"gemini-enabled",label:"Enable Gemini API OCR Verification",description:"Use Google's Gemini API for document data extraction. This is a powerful fallback or primary OCR. API key must be configured on the backend.",checked:n.geminiApi.enabled,onChange:c=>n.updateGeminiApiSettings({enabled:c})})}),i.jsxs("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:[i.jsx(Pn,{id:"perfios-enabled",label:"Enable Perfios API Verification",description:"Use Perfios for Bank, Aadhaar, and UAN verification.",checked:n.perfiosApi.enabled,onChange:c=>n.updatePerfiosApiSettings({enabled:c})}),i.jsxs("div",{className:`mt-4 space-y-4 transition-opacity ${n.perfiosApi.enabled?"opacity-100":"opacity-50 pointer-events-none"}`,children:[i.jsx(je,{label:"Perfios Client ID",value:n.perfiosApi.clientId,onChange:c=>n.updatePerfiosApiSettings({clientId:c.target.value})}),i.jsx(je,{label:"Perfios Client Secret",type:"password",value:n.perfiosApi.clientSecret,onChange:c=>n.updatePerfiosApiSettings({clientSecret:c.target.value})})]})]})]})]}),i.jsxs(Ju,{title:"Authentication Settings",icon:kf,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage how users sign in to the application."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Pn,{id:"otp-enabled",label:"Enable OTP Phone Sign-In",description:"Allow users to sign in using a one-time password sent via SMS.",checked:n.otp.enabled,onChange:c=>n.updateOtpSettings({enabled:c})})})]})]}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs(Ju,{title:"Client & Site Management",icon:$i,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Control workflows for site creation and management."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Pn,{id:"enable-provisional-sites",label:"Enable Provisional Site Creation",description:"Allows HR/Admins to create a site with just a name, providing a 90-day grace period to complete the full configuration for easier onboarding.",checked:n.siteManagement.enableProvisionalSites,onChange:c=>n.updateSiteManagementSettings({enableProvisionalSites:c})})})]}),i.jsxs(Ju,{title:"System & Data",icon:Sm,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage core system settings and data operations."}),i.jsxs("div",{className:"space-y-6 pt-4",children:[i.jsx(Pn,{id:"pincode-verification",label:"Enable Pincode API Verification",description:"Auto-fill City/State from pincode during onboarding.",checked:n.address.enablePincodeVerification,onChange:c=>n.updateAddressSettings({enablePincodeVerification:c})}),i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:"Backup & Export"}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Download all data from the active data source (Mock Data)."}),i.jsxs(re,{type:"button",variant:"outline",onClick:l,isLoading:e,children:[i.jsx(xi,{className:"mr-2 h-4 w-4"})," Export All Data"]})]})]})]}),i.jsxs(Ju,{title:"Notification Settings",icon:qf,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure how the system sends notifications."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Pn,{id:"email-notif-enabled",label:"Enable Email Notifications",description:"Send emails for important events like task assignments. SMTP must be configured on the backend.",checked:n.notifications.email.enabled,onChange:c=>n.updateNotificationSettings({email:{enabled:c}})})})]})]})]})]})},Pr=({title:n,subtitle:e})=>i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text form-header-title",children:n}),i.jsx("p",{className:"mt-2 text-sm text-muted",children:e})]}),Rre=({title:n,value:e,icon:t})=>i.jsxs("div",{className:"bg-card p-4 rounded-2xl flex flex-col md:flex-row items-start md:items-center col-span-1 gap-3 md:gap-0",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light md:mr-4",children:i.jsx(t,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-muted font-medium",children:n}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:e})]})]}),_o=ot.memo(Rre),Lre=()=>{const n=St(),[e,t]=D.useState([]),[r,s]=D.useState([]),[a,o]=D.useState([]),[l,c]=D.useState(!0),[d,h]=D.useState(null),[p,x]=D.useState([{startDate:new Date(new Date().setMonth(new Date().getMonth()-1)),endDate:new Date,key:"selection"}]),[v,_]=D.useState(!1),[w,j]=D.useState(""),[T,P]=D.useState(""),[E,M]=D.useState($e(new Date,"yyyy-MM-dd"));D.useEffect(()=>{(async()=>{c(!0);try{const[U,W,$]=await Promise.all([ue.getVerificationSubmissions(),ue.getFieldOfficers(),ue.getOrganizations()]);t(U),s(W),o($)}catch{h({message:"Failed to load dashboard data.",type:"error"})}finally{c(!1)}})()},[]);const O=D.useMemo(()=>{const B=p[0].startDate,U=p[0].endDate;if(!B||!U)return e;const W=new Date(U);return W.setHours(23,59,59,999),e.filter($=>{const se=new Date($.enrollmentDate.replace(/-/g,"/"));return se>=B&&se<=W})},[e,p]),I=D.useMemo(()=>({total:O.length,verified:O.filter(B=>B.status==="verified").length,rejected:O.filter(B=>B.status==="rejected").length}),[O]),q=async B=>{if(B.preventDefault(),!w||!T||!E){h({message:"Please fill all fields for assignment.",type:"error"});return}try{await ue.createAssignment(w,T,E),h({message:"Assignment created successfully (mocked).",type:"success"})}catch{h({message:"Failed to create assignment.",type:"error"})}},F=p[0].startDate&&p[0].endDate?`${$e(p[0].startDate,"MMM d, yyyy")} - ${$e(p[0].endDate,"MMM d, yyyy")}`:"Select Date";return i.jsxs("div",{className:"p-4 space-y-8",children:[d&&i.jsx(ht,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsx("div",{className:"bg-card p-4 rounded-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Operations Dashboard"}),i.jsxs("div",{className:"relative",children:[i.jsxs(re,{variant:"outline",onClick:()=>_(!v),children:[i.jsx(ka,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:F})]}),v&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:i.jsx(hm.DateRangePicker,{onChange:B=>{x([B.selection]),_(!1)},months:1,ranges:p,direction:"horizontal"})})]})]})}),i.jsx("div",{className:"bg-gradient-to-br from-accent/10 to-accent/5 border-2 border-accent/30 rounded-2xl p-6 cursor-pointer hover:border-accent hover:shadow-lg transition-all group",onClick:()=>n("/operations/team-activity"),children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"bg-accent rounded-xl p-3 group-hover:scale-110 transition-transform",children:i.jsx(qh,{className:"h-6 w-6 text-white"})}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Team Activity Monitor"})]}),i.jsx("p",{className:"text-muted mb-4",children:"Track your field team in real-time. Monitor check-ins, working hours, locations, and communicate instantly with your team members."}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("span",{className:"px-3 py-1 bg-green-500/10 text-green-600 rounded-full text-xs font-medium",children:"Real-time tracking"}),i.jsx("span",{className:"px-3 py-1 bg-blue-500/10 text-blue-600 rounded-full text-xs font-medium",children:"Location monitoring"}),i.jsx("span",{className:"px-3 py-1 bg-purple-500/10 text-purple-600 rounded-full text-xs font-medium",children:"Quick communication"})]})]}),i.jsx("div",{className:"flex-shrink-0 ml-4",children:i.jsx(re,{onClick:B=>{B.stopPropagation(),n("/operations/team-activity")},style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:"View Team Activity "})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsx(_o,{title:"Total Submissions",value:I.total,icon:os}),i.jsx(_o,{title:"Verified Employees",value:I.verified,icon:uu}),i.jsx(_o,{title:"Rejected Applications",value:I.rejected,icon:Sx})]}),i.jsxs("div",{className:"bg-card p-6 rounded-2xl",children:[i.jsx(Pr,{title:"Assign Field Officer",subtitle:"Assign a field officer to an organization for a specific date."}),i.jsxs("form",{onSubmit:q,className:"grid grid-cols-1 md:grid-cols-4 gap-6 items-end",children:[i.jsx("div",{className:"md:col-span-1",children:i.jsxs(Ke,{label:"Field Officer",id:"officer",value:w,onChange:B=>j(B.target.value),children:[i.jsx("option",{value:"",children:"Select Officer"}),r.map(B=>i.jsx("option",{value:B.id,children:B.name},B.id))]})}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs(Ke,{label:"Organization/Site",id:"site",value:T,onChange:B=>P(B.target.value),children:[i.jsx("option",{value:"",children:"Select Site"}),a.map(B=>i.jsx("option",{value:B.id,children:B.shortName},B.id))]})}),i.jsx("div",{className:"md:col-span-1",children:i.jsx(kn,{label:"Assignment Date",id:"assignmentDate",value:E,onChange:M})}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs(re,{type:"submit",className:"w-full",children:[i.jsx(_C,{className:"mr-2 h-4 w-4"}),"Assign"]})})]})]})]})},Fre=()=>{const{user:n}=jt(),[e,t]=D.useState([]),[r,s]=D.useState(!0),[a,o]=D.useState(null),l=Ft("(max-width: 767px)");D.useEffect(()=>{c();const _=setInterval(c,3e4);return()=>clearInterval(_)},[n]);const c=async()=>{if(n)try{s(!0);const _=await ue.getUsers();let w=[];n.role==="admin"||n.role==="developer"?w=_.filter(E=>E.role==="operation_manager"||E.role==="field_officer"):n.role==="operation_manager"&&(w=_.filter(E=>E.role==="field_officer"&&E.reportingManagerId===n.id));const j=new Date;j.setHours(0,0,0,0);const T=new Date;T.setHours(23,59,59,999);const P=await Promise.all(w.map(async E=>{try{const O=(await ue.getAttendanceEvents(E.id,j.toISOString(),T.toISOString())).sort(($,se)=>new Date(se.timestamp).getTime()-new Date($.timestamp).getTime()),I=O.filter($=>$.type.toLowerCase().replace(/[-_\s]/g,"")==="checkin"),q=O.filter($=>$.type.toLowerCase().replace(/[-_\s]/g,"")==="checkout"),F=I[0],B=q[0];let U=0;for(let $=0;$<q.length;$++){const se=q[$],Y=I.find(ae=>new Date(ae.timestamp)<new Date(se.timestamp));if(Y){const ae=new Date(se.timestamp).getTime()-new Date(Y.timestamp).getTime();U+=ae/(1e3*60*60)}}const W=F&&(!B||new Date(F.timestamp)>new Date(B.timestamp));if(W&&F){const $=Date.now()-new Date(F.timestamp).getTime();U+=$/(1e3*60*60)}return{...E,lastCheckIn:F?.timestamp,lastCheckOut:B?.timestamp,currentLocation:F?{latitude:F.latitude||0,longitude:F.longitude||0,address:F.address||void 0}:void 0,todayWorkingHours:U,todayTravelDistance:0,isCurrentlyWorking:W,isPresent:I.length>0}}catch(M){return console.error(`Error fetching data for ${E.name}:`,M),{...E,isPresent:!1,isCurrentlyWorking:!1}}}));t(P)}catch(_){console.error("Error fetching team members:",_)}finally{s(!1)}},d=_=>{if(!_)return;const w=_.replace(/\D/g,"").slice(-10);window.location.href=`tel:+91${w}`},h=_=>{if(!_)return;const w=_.replace(/\D/g,"").slice(-10);window.location.href=`sms:+91${w}`},p=_=>{if(!_)return"0h 0m";const w=Math.floor(_),j=Math.floor((_-w)*60);return`${w}h ${j}m`};if(r)return i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})});const x=({member:_})=>i.jsx("div",{className:"bg-card border border-border rounded-xl p-4 hover:border-accent transition-all cursor-pointer",onClick:()=>o(_),children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Wi,{photoUrl:_.photoUrl,seed:_.id,className:"w-12 h-12 rounded-full"}),i.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ring-2 ring-white ${_.isCurrentlyWorking?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":_.isPresent?"bg-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.8)]":"bg-gray-400"}`})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-primary-text truncate",children:_.name}),i.jsx("p",{className:"text-xs text-muted",children:_.role.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())}),i.jsxs("div",{className:"mt-2 space-y-1",children:[i.jsx("div",{className:"flex items-center gap-2 text-xs",children:_.isCurrentlyWorking?i.jsxs(i.Fragment,{children:[i.jsx(qh,{className:"h-3 w-3 text-green-500"}),i.jsx("span",{className:"text-green-500 font-medium",children:"Working"})]}):_.isPresent?i.jsxs(i.Fragment,{children:[i.jsx(PM,{className:"h-3 w-3 text-yellow-500"}),i.jsx("span",{className:"text-yellow-500",children:"Checked Out"})]}):i.jsxs(i.Fragment,{children:[i.jsx(lm,{className:"h-3 w-3 text-gray-400"}),i.jsx("span",{className:"text-gray-400",children:"Absent"})]})}),_.todayWorkingHours>0&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted",children:[i.jsx(Vc,{className:"h-3 w-3"}),i.jsx("span",{children:p(_.todayWorkingHours)})]})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx(re,{variant:"icon",size:"sm",onClick:w=>{w.stopPropagation(),d(_.phone)},className:"hover:bg-accent/10",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:i.jsx(kf,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:w=>{w.stopPropagation(),h(_.phone)},className:"hover:bg-accent/10",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:i.jsx(cm,{className:"h-4 w-4"})})]})]})}),v=({member:_})=>i.jsxs("div",{className:"bg-card border border-border rounded-xl p-6",children:[i.jsxs("div",{className:"flex items-start justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Wi,{photoUrl:_.photoUrl,seed:_.id,className:"w-16 h-16 rounded-full"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:_.name}),i.jsx("p",{className:"text-sm text-muted",children:_.role.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())})]})]}),l&&i.jsx(re,{variant:"secondary",size:"sm",onClick:()=>o(null),children:"Close"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Nx,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Last Check In"})]}),i.jsx("p",{className:"text-sm font-bold text-primary-text",children:_.lastCheckIn?$e(new Date(_.lastCheckIn),"hh:mm a"):"Not checked in"}),_.lastCheckIn&&i.jsx("p",{className:"text-xs text-muted mt-1",children:ou(new Date(_.lastCheckIn),{addSuffix:!0})})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(bo,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Last Check Out"})]}),i.jsx("p",{className:"text-sm font-bold text-primary-text",children:_.lastCheckOut?$e(new Date(_.lastCheckOut),"hh:mm a"):"Not checked out"}),_.lastCheckOut&&i.jsx("p",{className:"text-xs text-muted mt-1",children:ou(new Date(_.lastCheckOut),{addSuffix:!0})})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Vc,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Working Hours Today"})]}),i.jsx("p",{className:"text-lg font-bold text-primary-text",children:p(_.todayWorkingHours)})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(qh,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Status"})]}),i.jsx("p",{className:`text-lg font-bold ${_.isCurrentlyWorking?"text-green-500":_.isPresent?"text-yellow-500":"text-gray-400"}`,children:_.isCurrentlyWorking?"Working":_.isPresent?"Checked Out":"Absent"})]})]}),_.currentLocation&&i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Cl,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Current Location"})]}),i.jsx("p",{className:"text-sm text-primary-text",children:_.currentLocation.address||"Location not available"}),_.currentLocation.latitude!==0&&i.jsx("a",{href:`https://www.google.com/maps?q=${_.currentLocation.latitude},${_.currentLocation.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-accent hover:underline mt-2 inline-block",children:"View on map "})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(re,{onClick:()=>d(_.phone),className:"flex-1",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:[i.jsx(kf,{className:"h-4 w-4 mr-2"}),"Call"]}),i.jsxs(re,{onClick:()=>h(_.phone),className:"flex-1",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:[i.jsx(cm,{className:"h-4 w-4 mr-2"}),"Message"]})]})]});return i.jsxs("div",{className:"p-4 lg:p-8 space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-primary-text",children:"Team Activity"}),i.jsx("p",{className:"text-sm text-muted mt-1",children:n?.role==="operation_manager"?"Monitor your field team in real-time":"Monitor all operation managers and field officers"})]}),i.jsxs(re,{onClick:c,variant:"secondary",size:"sm",children:[i.jsx(qh,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Tl,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Total Team"})]}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:e.length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(qh,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Working Now"})]}),i.jsx("p",{className:"text-2xl font-bold text-green-500",children:e.filter(_=>_.isCurrentlyWorking).length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(PM,{className:"h-4 w-4 text-yellow-500"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Present"})]}),i.jsx("p",{className:"text-2xl font-bold text-yellow-500",children:e.filter(_=>_.isPresent).length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(lm,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Absent"})]}),i.jsx("p",{className:"text-2xl font-bold text-gray-400",children:e.filter(_=>!_.isPresent).length})]})]}),l&&a?i.jsx(v,{member:a}):i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-2 space-y-3",children:e.length===0?i.jsxs("div",{className:"bg-card border border-border rounded-xl p-12 text-center",children:[i.jsx(Tl,{className:"h-12 w-12 mx-auto text-muted mb-4 opacity-50"}),i.jsx("p",{className:"text-muted",children:"No team members found"})]}):e.map(_=>i.jsx(x,{member:_},_.id))}),!l&&a&&i.jsx("div",{className:"lg:col-span-1 sticky top-6 self-start",children:i.jsx(v,{member:a})})]})]})},qre=({status:n})=>{if(!n)return i.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});const e={pending_sync:"sync-chip--pending_sync",synced:"sync-chip--synced",failed:"sync-chip--failed"},t={pending_sync:"Pending Sync",synced:"Synced",failed:"Failed"},r=e[n];return i.jsx("span",{className:`sync-chip ${r}`,children:t[n]})},zre=()=>{const[n,e]=D.useState([]),[t,r]=D.useState(!0),[s,a]=D.useState("all"),[o,l]=D.useState(""),[c,d]=D.useState(null),h=St(),{user:p}=jt(),x=Ft("(max-width: 767px)"),[v,_]=D.useState([]),[w,j]=D.useState(p?.organizationId),T=p&&p.role==="admin";D.useEffect(()=>{T&&ue.getOrganizations().then(I=>{_(I),I.length>0&&!w&&j(I[0].id)})},[T,w]);const P=D.useCallback(async()=>{if(!w){p?.organizationId&&r(!1);return}r(!0);try{const I=await ue.getVerificationSubmissions(s==="all"?void 0:s,w);e(I)}catch(I){console.error("Failed to fetch submissions",I)}finally{r(!1)}},[s,w,p?.organizationId]);D.useEffect(()=>{P()},[P]);const E=D.useMemo(()=>n.filter(I=>I.personal.firstName.toLowerCase().includes(o.toLowerCase())||I.personal.lastName.toLowerCase().includes(o.toLowerCase())||I.personal.employeeId.toLowerCase().includes(o.toLowerCase())),[n,o]),M=v.find(I=>I.id===w)?.shortName||p?.organizationName,O=["all","pending","verified","rejected"];return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Site Dashboard"}),i.jsxs("p",{className:"text-muted",children:["Viewing submissions for site: ",i.jsx("span",{className:"font-semibold text-accent-dark",children:M||"N/A"})]})]}),!x&&i.jsxs("div",{className:"flex items-center gap-4",children:[T&&i.jsx("div",{className:"w-full sm:w-56",children:i.jsxs(Ke,{label:"",id:"org-selector",value:w,onChange:I=>j(I.target.value),children:[i.jsx("option",{value:"",children:"Select a Site"}),v.map(I=>i.jsx("option",{value:I.id,children:I.shortName},I.id))]})}),i.jsxs(re,{onClick:()=>h("/onboarding/select-organization"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Wc,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]})]}),x&&i.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[T&&i.jsxs(Ke,{label:"Select Site",id:"org-selector-mobile",value:w,onChange:I=>j(I.target.value),children:[i.jsx("option",{value:"",children:"Select a Site"}),v.map(I=>i.jsx("option",{value:I.id,children:I.shortName},I.id))]}),i.jsxs(re,{onClick:()=>h("/onboarding/select-organization"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Wc,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center my-6 gap-4",children:[i.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:i.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:O.map(I=>i.jsx("button",{onClick:()=>a(I),className:`${s===I?"border-emerald-500 text-emerald-700":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize transition-colors duration-200`,children:I},I))})}),i.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ma,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name or ID...",value:o,onChange:I=>l(I.target.value),className:"block w-full pl-10 pr-3 py-2 border border-border rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Sync"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading submissions..."})}):w?E.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No submissions found for this site."})}):E.map(I=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:[i.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[I.personal.firstName," ",I.personal.lastName]}),i.jsx("div",{className:"text-sm text-muted",children:I.personal.employeeId})]}),i.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(EC,{status:I.status})}),i.jsx("td",{"data-label":"Portal Sync",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(qre,{status:I.portalSyncStatus})}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[i.jsx(re,{variant:"icon",size:"sm",onClick:()=>h(`/onboarding/add/personal?id=${I.id}`),title:"View/Edit Details",children:i.jsx(Nl,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>h(`/onboarding/pdf/${I.id}`),title:"Download Forms",children:i.jsx(os,{className:"h-4 w-4"})})]})})]},I.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Please select a site to view submissions."})})})]})})]})},RS=({file:n,onFileChange:e})=>{const[t,r]=D.useState(!1),[s,a]=D.useState(""),[o,l]=D.useState(!1),c=D.useCallback(async v=>{if(v&&v.type.startsWith("image/")){a("");const _={name:v.name,type:v.type,size:v.size,preview:URL.createObjectURL(v),file:v};e(_)}},[e]),d=async v=>{const _=v.target.files?.[0];_&&c(_)},h=D.useCallback(async(v,_)=>{const w=await(await fetch(`data:${_};base64,${v}`)).blob(),j=new File([w],`capture-${Date.now()}.jpg`,{type:_});c(j)},[c]),p=()=>{n&&URL.revokeObjectURL(n.preview),e(null),a("")},x="avatar-upload";return i.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[o&&i.jsx(L3,{isOpen:o,onClose:()=>l(!1),onCapture:h,captureGuidance:"profile"}),i.jsxs("div",{className:"relative w-40 h-40",children:[i.jsx("div",{className:`w-full h-full rounded-full bg-page flex items-center justify-center overflow-hidden border-2 transition-colors ${s?"border-red-500":"border-border"}`,children:t?i.jsxs("div",{className:"flex flex-col items-center text-muted",children:[i.jsx(wt,{className:"h-8 w-8 animate-spin"}),i.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):n?.preview?i.jsx("img",{src:n.preview,alt:"Profile preview",className:"w-full h-full object-cover"}):i.jsx(Wi,{})}),n&&!t&&i.jsx("button",{type:"button",onClick:p,id:"avatar-delete-button",className:"avatar-delete-btn btn-icon absolute top-2 right-2 p-1.5 rounded-full transition-colors !bg-white/90 !text-red-600 hover:!bg-red-100","aria-label":"Remove photo",children:i.jsx(rn,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("label",{htmlFor:x,className:`cursor-pointer inline-flex items-center justify-center font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200 rounded-full bg-accent text-white hover:bg-accent-dark focus:ring-accent px-4 py-2 text-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[i.jsx(cr,{className:"w-4 h-4 mr-2"}),n?"Change":"Upload"]}),i.jsx("input",{id:x,name:x,type:"file",className:"sr-only",onChange:d,accept:"image/*",disabled:t}),i.jsxs("button",{type:"button",onClick:()=>l(!0),disabled:t,className:`avatar-capture-btn inline-flex items-center justify-center px-4 py-2 font-semibold rounded-full transition-colors duration-200 text-sm border border-red-200 !text-red-600 hover:!bg-red-50 !bg-card/70 backdrop-blur-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[i.jsx(xC,{className:"w-4 h-4 mr-2"}),"Capture"]})]}),s&&i.jsxs("p",{className:"text-xs text-red-600 text-center max-w-[160px] flex items-center gap-1",children:[i.jsx(Da,{className:"h-3 w-3 flex-shrink-0"})," ",s]})]})},Ure=Pt({name:ge().required("Name is required"),email:ge().email("Must be a valid email").required("Email is required"),phone:ge().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number").optional().nullable()}).defined(),Vre=()=>{const{user:n,updateUserProfile:e,isCheckedIn:t,isAttendanceLoading:r,toggleCheckInStatus:s,logout:a,lastCheckInTime:o,lastCheckOutTime:l,checkAttendanceStatus:c}=jt(),{permissions:d}=Ki(),h=St(),{theme:p,setTheme:x,isAutomatic:v,setAutomatic:_}=xu(),[w,j]=D.useState(!1),[T,P]=D.useState(!1),[E,M]=D.useState(null),[O,I]=D.useState("prompt"),F=Ft("(max-width: 767px)");D.useEffect(()=>{const ne=async()=>{if(!navigator.permissions?.query){I("prompt");return}try{const de=await navigator.permissions.query({name:"camera"}),ce=await navigator.permissions.query({name:"geolocation"});de.state==="granted"&&ce.state==="granted"?I("granted"):de.state==="denied"||ce.state==="denied"?I("denied"):I("prompt");const pe=()=>ne();de.onchange=pe,ce.onchange=pe}catch(de){console.warn("Permissions API not fully supported. Defaulting to 'prompt'.",de),I("prompt")}};ne()},[]);const{register:B,handleSubmit:U,formState:{errors:W,isDirty:$},getValues:se,trigger:Y,reset:ae}=tn({resolver:Dn(Ure),defaultValues:{name:n?.name||"",email:n?.email||"",phone:n?.phone||""}});D.useEffect(()=>{n&&ae({name:n.name||"",email:n.email||"",phone:n.phone||""})},[n,ae]);const J=async ne=>{if(!n)return;const de=n.photoUrl;e({photoUrl:ne?.preview});try{let ce=null;ne&&ne.file&&(ce=await new Promise((ie,xe)=>{const Ce=new FileReader;Ce.onloadend=()=>ie(Ce.result),Ce.onerror=xe,Ce.readAsDataURL(ne.file)}));const pe=await ue.updateUser(n.id,{photoUrl:ce});e(pe),M({message:`Profile photo ${ce?"updated":"removed"}.`,type:"success"})}catch(ce){console.error(ce),M({message:"Failed to save photo.",type:"error"}),e({photoUrl:de})}},ee=async ne=>{if(n){j(!0);try{const de=await ue.updateUser(n.id,ne);e(de),ae(ne),M({message:"Profile updated successfully!",type:"success"})}catch{M({message:"Failed to update profile.",type:"error"})}finally{j(!1)}}},X=T,Z=()=>{h("/auth/logout")},oe=ne=>ne?$e(new Date(ne),"hh:mm a"):"--:--";n&&d[n.role]?.includes("manage_tasks");const H=ne=>ne.replace(/_/g," ").replace(/\b\w/g,de=>de.toUpperCase());if(!n)return i.jsx("div",{children:"Loading user profile..."});const Q=n.photoUrl?{preview:n.photoUrl,name:"Profile Photo",type:"image/jpeg",size:0}:null;return F?i.jsxs("div",{className:"p-4 space-y-8 md:bg-transparent bg-[#041b0f]",children:[E&&i.jsx(ht,{message:E.message,type:E.type,onDismiss:()=>M(null)}),i.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[i.jsx(RS,{file:Q,onFileChange:J}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold",children:n.name}),i.jsx("p",{className:"text-muted",children:n.role.replace(/_/g," ").replace(/\b\w/g,ne=>ne.toUpperCase())})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Profile Details"}),i.jsxs("form",{onSubmit:U(ee),className:"space-y-4",children:[i.jsx(je,{label:"Full Name",id:"name",error:W.name?.message,registration:B("name")}),i.jsx(je,{label:"Email Address",id:"email",type:"email",error:W.email?.message,registration:B("email"),readOnly:!0,className:"!bg-gray-700/50"}),i.jsx(je,{label:"Phone Number",id:"phone",type:"tel",error:W.phone?.message,registration:B("phone")}),i.jsx("div",{className:"flex justify-end pt-2",children:i.jsx(re,{type:"submit",isLoading:w,disabled:!$,children:"Save Changes"})})]})]}),i.jsxs("section",{className:"hidden md:block",children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Appearance"}),i.jsxs("div",{className:"p-4 rounded-lg bg-[#041b0f] md:bg-[#243524] border border-[#374151] space-y-4",children:[i.jsx(Pn,{id:"theme-automatic-mobile",label:"Automatic",description:"Switch themes based on screen size.",checked:v,onChange:ne=>_(ne.target.checked)}),i.jsx(Pn,{id:"theme-dark-mode-mobile",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:p==="dark",onChange:ne=>x(ne.target.checked?"dark":"light"),disabled:v})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Work Hours Tracking"}),i.jsxs("div",{className:"fo-attendance-card space-y-4",children:[i.jsxs("div",{className:"flex justify-around",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"fo-attendance-time",children:"Last Check In"}),i.jsx("p",{className:"fo-attendance-time",children:i.jsx("strong",{children:oe(o)})})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"fo-attendance-time",children:"Last Check Out"}),i.jsx("p",{className:"fo-attendance-time",children:i.jsx("strong",{children:oe(l)})})]})]}),r?i.jsx("div",{className:"flex items-center justify-center text-muted h-[56px]",children:i.jsx(wt,{className:"h-6 w-6 animate-spin"})}):i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(re,{onClick:()=>h("/attendance/check-in"),variant:"primary",className:"flex-1 !py-4 text-lg font-bold shadow-lg transition-all rounded-2xl",disabled:t||X,children:[i.jsx(Nx,{className:"mr-3 h-6 w-6"})," Check In"]}),i.jsxs(re,{onClick:()=>h("/attendance/check-out"),variant:"danger",className:"flex-1 !py-4 text-lg font-bold shadow-lg transition-all rounded-2xl",disabled:!t||X,children:[i.jsx(bo,{className:"mr-3 h-6 w-6"})," Check Out"]})]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Account Actions"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(re,{onClick:()=>h("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center !py-3",title:"View your leave history and balances",children:[i.jsx(_S,{className:"mr-2 h-5 w-5"})," Leave Tracker"]}),i.jsxs(re,{onClick:Z,variant:"danger",className:"w-full justify-center !py-3",children:[i.jsx(bo,{className:"mr-2 h-5 w-5"})," Log Out"]})]})]})]})]}):i.jsxs("div",{className:"w-full space-y-8",children:[E&&i.jsx(ht,{message:E.message,type:E.type,onDismiss:()=>M(null)}),i.jsxs("div",{className:"relative overflow-hidden md:bg-white md:p-6 md:rounded-2xl md:shadow-lg flex flex-col md:flex-row items-center gap-6 border border-gray-100",children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-[#006b3f] border-b-4 border-[#005632] shadow-lg"}),i.jsx("div",{className:"relative z-10",children:i.jsx(RS,{file:Q,onFileChange:J})}),i.jsxs("div",{className:"text-center md:text-left relative z-10 flex-1 mt-16 md:mt-0",children:[i.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-primary-text tracking-tight",children:n.name}),i.jsx("div",{className:"flex items-center justify-center md:justify-start gap-2 mt-1.5",children:i.jsx("span",{className:"px-2.5 py-0.5 rounded-full bg-emerald-100 text-emerald-800 border border-emerald-200 text-xs md:text-sm font-medium",children:H(n.role)})}),i.jsx("p",{className:"text-gray-500 mt-1.5 font-medium text-sm md:text-base",children:n.email})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[i.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-blue-50 rounded-lg",children:i.jsx(Tl,{className:"h-5 w-5 text-blue-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Profile Details"})]}),i.jsxs("form",{onSubmit:U(ee),className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[i.jsx(je,{label:"Full Name",id:"name",error:W.name?.message,registration:B("name"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),i.jsx(je,{label:"Phone Number",id:"phone",type:"tel",error:W.phone?.message,registration:B("phone"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(je,{label:"Email Address",id:"email",type:"email",error:W.email?.message,registration:B("email"),readOnly:!0,className:"bg-gray-100/50 text-gray-500 cursor-not-allowed border-gray-200"})})]}),i.jsx("div",{className:"flex justify-end pt-3 border-t border-gray-100",children:i.jsx(re,{type:"submit",isLoading:w,disabled:!$,className:"px-6",children:"Save Changes"})})]})]}),i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-purple-50 rounded-lg",children:i.jsx(qF,{className:"h-5 w-5 text-purple-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Work Hours Tracking"})]}),i.jsxs("div",{className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[i.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[i.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check In"}),i.jsx("p",{className:"text-2xl md:text-3xl font-bold text-emerald-600",children:oe(o)})]}),i.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[i.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check Out"}),i.jsx("p",{className:"text-2xl md:text-3xl font-bold text-rose-600",children:oe(l)})]})]}),r?i.jsx("div",{className:"flex items-center justify-center h-[56px] bg-gray-50 rounded-xl",children:i.jsx(wt,{className:"h-6 w-6 animate-spin text-gray-400"})}):i.jsxs("div",{className:"flex gap-4",children:[i.jsxs(re,{onClick:()=>h("/attendance/check-in"),variant:"primary",className:"flex-1 !py-3 text-base md:text-lg shadow-lg shadow-emerald-100 hover:shadow-emerald-200 transition-all",disabled:t||X,children:[i.jsx(Nx,{className:"mr-2 h-5 w-5"})," Check In"]}),i.jsxs(re,{onClick:()=>h("/attendance/check-out"),variant:"danger",className:"flex-1 !py-3 text-base md:text-lg shadow-lg shadow-red-100 hover:shadow-red-200 transition-all",disabled:!t||X,children:[i.jsx(bo,{className:"mr-2 h-5 w-5"})," Check Out"]})]})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Appearance"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:i.jsx(Pn,{id:"theme-automatic-desktop",label:"Automatic",description:"Switch themes based on screen size.",checked:v,onChange:ne=>_(ne.target.checked)})}),i.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:i.jsx(Pn,{id:"theme-dark-mode-desktop",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:p==="dark",onChange:ne=>x(ne.target.checked?"dark":"light"),disabled:v})})]})]}),i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Account Actions"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs(re,{onClick:()=>h("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center py-3 bg-gray-50 hover:bg-gray-100 border-gray-200",title:"View your leave history and balances",children:[i.jsx(_S,{className:"mr-2 h-4 w-4"})," Leave Tracker"]}),i.jsxs(re,{onClick:Z,variant:"danger",className:"w-full justify-center py-3",isLoading:w,children:[i.jsx(bo,{className:"mr-2 h-4 w-4"})," Log Out"]})]})]})]})]})]})};function Dm(n){return n+.5|0}const Oc=(n,e,t)=>Math.max(Math.min(n,t),e);function zh(n){return Oc(Dm(n*2.55),0,255)}function qc(n){return Oc(Dm(n*255),0,255)}function xl(n){return Oc(Dm(n/2.55)/100,0,1)}function iR(n){return Oc(Dm(n*100),0,100)}const zi={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},LS=[..."0123456789ABCDEF"],Bre=n=>LS[n&15],Wre=n=>LS[(n&240)>>4]+LS[n&15],Dg=n=>(n&240)>>4===(n&15),$re=n=>Dg(n.r)&&Dg(n.g)&&Dg(n.b)&&Dg(n.a);function Hre(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&zi[n[1]]*17,g:255&zi[n[2]]*17,b:255&zi[n[3]]*17,a:e===5?zi[n[4]]*17:255}:(e===7||e===9)&&(t={r:zi[n[1]]<<4|zi[n[2]],g:zi[n[3]]<<4|zi[n[4]],b:zi[n[5]]<<4|zi[n[6]],a:e===9?zi[n[7]]<<4|zi[n[8]]:255})),t}const Yre=(n,e)=>n<255?e(n):"";function Gre(n){var e=$re(n)?Bre:Wre;return n?"#"+e(n.r)+e(n.g)+e(n.b)+Yre(n.a,e):void 0}const Zre=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function U5(n,e,t){const r=e*Math.min(t,1-t),s=(a,o=(a+n/30)%12)=>t-r*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function Kre(n,e,t){const r=(s,a=(s+n/60)%6)=>t-t*e*Math.max(Math.min(a,4-a,1),0);return[r(5),r(3),r(1)]}function Jre(n,e,t){const r=U5(n,1,.5);let s;for(e+t>1&&(s=1/(e+t),e*=s,t*=s),s=0;s<3;s++)r[s]*=1-e-t,r[s]+=e;return r}function Qre(n,e,t,r,s){return n===s?(e-t)/r+(e<t?6:0):e===s?(t-n)/r+2:(n-e)/r+4}function XC(n){const t=n.r/255,r=n.g/255,s=n.b/255,a=Math.max(t,r,s),o=Math.min(t,r,s),l=(a+o)/2;let c,d,h;return a!==o&&(h=a-o,d=l>.5?h/(2-a-o):h/(a+o),c=Qre(t,r,s,h,a),c=c*60+.5),[c|0,d||0,l]}function e1(n,e,t,r){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,r)).map(qc)}function t1(n,e,t){return e1(U5,n,e,t)}function Xre(n,e,t){return e1(Jre,n,e,t)}function ese(n,e,t){return e1(Kre,n,e,t)}function V5(n){return(n%360+360)%360}function tse(n){const e=Zre.exec(n);let t=255,r;if(!e)return;e[5]!==r&&(t=e[6]?zh(+e[5]):qc(+e[5]));const s=V5(+e[2]),a=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=Xre(s,a,o):e[1]==="hsv"?r=ese(s,a,o):r=t1(s,a,o),{r:r[0],g:r[1],b:r[2],a:t}}function nse(n,e){var t=XC(n);t[0]=V5(t[0]+e),t=t1(t),n.r=t[0],n.g=t[1],n.b=t[2]}function rse(n){if(!n)return;const e=XC(n),t=e[0],r=iR(e[1]),s=iR(e[2]);return n.a<255?`hsla(${t}, ${r}%, ${s}%, ${xl(n.a)})`:`hsl(${t}, ${r}%, ${s}%)`}const aR={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},oR={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function sse(){const n={},e=Object.keys(oR),t=Object.keys(aR);let r,s,a,o,l;for(r=0;r<e.length;r++){for(o=l=e[r],s=0;s<t.length;s++)a=t[s],l=l.replace(a,aR[a]);a=parseInt(oR[o],16),n[l]=[a>>16&255,a>>8&255,a&255]}return n}let Eg;function ise(n){Eg||(Eg=sse(),Eg.transparent=[0,0,0,0]);const e=Eg[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const ase=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function ose(n){const e=ase.exec(n);let t=255,r,s,a;if(e){if(e[7]!==r){const o=+e[7];t=e[8]?zh(o):Oc(o*255,0,255)}return r=+e[1],s=+e[3],a=+e[5],r=255&(e[2]?zh(r):Oc(r,0,255)),s=255&(e[4]?zh(s):Oc(s,0,255)),a=255&(e[6]?zh(a):Oc(a,0,255)),{r,g:s,b:a,a:t}}}function lse(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${xl(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const pN=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Qu=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function cse(n,e,t){const r=Qu(xl(n.r)),s=Qu(xl(n.g)),a=Qu(xl(n.b));return{r:qc(pN(r+t*(Qu(xl(e.r))-r))),g:qc(pN(s+t*(Qu(xl(e.g))-s))),b:qc(pN(a+t*(Qu(xl(e.b))-a))),a:n.a+t*(e.a-n.a)}}function Og(n,e,t){if(n){let r=XC(n);r[e]=Math.max(0,Math.min(r[e]+r[e]*t,e===0?360:1)),r=t1(r),n.r=r[0],n.g=r[1],n.b=r[2]}}function B5(n,e){return n&&Object.assign(e||{},n)}function lR(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=qc(n[3]))):(e=B5(n,{r:0,g:0,b:0,a:1}),e.a=qc(e.a)),e}function dse(n){return n.charAt(0)==="r"?ose(n):tse(n)}class pm{constructor(e){if(e instanceof pm)return e;const t=typeof e;let r;t==="object"?r=lR(e):t==="string"&&(r=Hre(e)||ise(e)||dse(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=B5(this._rgb);return e&&(e.a=xl(e.a)),e}set rgb(e){this._rgb=lR(e)}rgbString(){return this._valid?lse(this._rgb):void 0}hexString(){return this._valid?Gre(this._rgb):void 0}hslString(){return this._valid?rse(this._rgb):void 0}mix(e,t){if(e){const r=this.rgb,s=e.rgb;let a;const o=t===a?.5:t,l=2*o-1,c=r.a-s.a,d=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;a=1-d,r.r=255&d*r.r+a*s.r+.5,r.g=255&d*r.g+a*s.g+.5,r.b=255&d*r.b+a*s.b+.5,r.a=o*r.a+(1-o)*s.a,this.rgb=r}return this}interpolate(e,t){return e&&(this._rgb=cse(this._rgb,e._rgb,t)),this}clone(){return new pm(this.rgb)}alpha(e){return this._rgb.a=qc(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Dm(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Og(this._rgb,2,e),this}darken(e){return Og(this._rgb,2,-e),this}saturate(e){return Og(this._rgb,1,e),this}desaturate(e){return Og(this._rgb,1,-e),this}rotate(e){return nse(this._rgb,e),this}}function ul(){}const use=(()=>{let n=0;return()=>n++})();function yn(n){return n==null}function Tr(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function nn(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function ls(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function fo(n,e){return ls(n)?n:e}function Gt(n,e){return typeof n>"u"?e:n}const fse=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,W5=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function qn(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function wn(n,e,t,r){let s,a,o;if(Tr(n))for(a=n.length,s=0;s<a;s++)e.call(t,n[s],s);else if(nn(n))for(o=Object.keys(n),a=o.length,s=0;s<a;s++)e.call(t,n[o[s]],o[s])}function Dx(n,e){let t,r,s,a;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(s=n[t],a=e[t],s.datasetIndex!==a.datasetIndex||s.index!==a.index)return!1;return!0}function Ex(n){if(Tr(n))return n.map(Ex);if(nn(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let s=0;for(;s<r;++s)e[t[s]]=Ex(n[t[s]]);return e}return n}function $5(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function hse(n,e,t,r){if(!$5(n))return;const s=e[n],a=t[n];nn(s)&&nn(a)?gm(s,a,r):e[n]=Ex(a)}function gm(n,e,t){const r=Tr(e)?e:[e],s=r.length;if(!nn(n))return n;t=t||{};const a=t.merger||hse;let o;for(let l=0;l<s;++l){if(o=r[l],!nn(o))continue;const c=Object.keys(o);for(let d=0,h=c.length;d<h;++d)a(c[d],n,o,t)}return n}function Gh(n,e){return gm(n,e,{merger:mse})}function mse(n,e,t){if(!$5(n))return;const r=e[n],s=t[n];nn(r)&&nn(s)?Gh(r,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Ex(s))}const cR={"":n=>n,x:n=>n.x,y:n=>n.y};function pse(n){const e=n.split("."),t=[];let r="";for(const s of e)r+=s,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}function gse(n){const e=pse(n);return t=>{for(const r of e){if(r==="")break;t=t&&t[r]}return t}}function fu(n,e){return(cR[e]||(cR[e]=gse(e)))(n)}function n1(n){return n.charAt(0).toUpperCase()+n.slice(1)}const xm=n=>typeof n<"u",$c=n=>typeof n=="function",dR=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function xse(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Mn=Math.PI,Xn=2*Mn,yse=Xn+Mn,Ox=Number.POSITIVE_INFINITY,vse=Mn/180,kr=Mn/2,Vd=Mn/4,uR=Mn*2/3,H5=Math.log10,jo=Math.sign;function Zh(n,e,t){return Math.abs(n-e)<t}function fR(n){const e=Math.round(n);n=Zh(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(H5(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function bse(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r===0&&(e.push(r),e.push(n/r));return t===(t|0)&&e.push(t),e.sort((s,a)=>s-a).pop(),e}function _se(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function ym(n){return!_se(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function wse(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function jse(n,e,t){let r,s,a;for(r=0,s=n.length;r<s;r++)a=n[r][t],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function vl(n){return n*(Mn/180)}function Nse(n){return n*(180/Mn)}function hR(n){if(!ls(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function Y5(n,e){const t=e.x-n.x,r=e.y-n.y,s=Math.sqrt(t*t+r*r);let a=Math.atan2(r,t);return a<-.5*Mn&&(a+=Xn),{angle:a,distance:s}}function FS(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function Sse(n,e){return(n-e+yse)%Xn-Mn}function di(n){return(n%Xn+Xn)%Xn}function vm(n,e,t,r){const s=di(n),a=di(e),o=di(t),l=di(a-s),c=di(o-s),d=di(s-a),h=di(s-o);return s===a||s===o||r&&a===o||l>c&&d<h}function as(n,e,t){return Math.max(e,Math.min(t,n))}function Cse(n){return as(n,-32768,32767)}function bl(n,e,t,r=1e-6){return n>=Math.min(e,t)-r&&n<=Math.max(e,t)+r}function r1(n,e,t){t=t||(o=>n[o]<e);let r=n.length-1,s=0,a;for(;r-s>1;)a=s+r>>1,t(a)?s=a:r=a;return{lo:s,hi:r}}const nu=(n,e,t,r)=>r1(n,t,r?s=>{const a=n[s][e];return a<t||a===t&&n[s+1][e]===t}:s=>n[s][e]<t),Tse=(n,e,t)=>r1(n,t,r=>n[r][e]>=t);function kse(n,e,t){let r=0,s=n.length;for(;r<s&&n[r]<e;)r++;for(;s>r&&n[s-1]>t;)s--;return r>0||s<n.length?n.slice(r,s):n}const G5=["push","pop","shift","splice","unshift"];function Pse(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),G5.forEach(t=>{const r="_onData"+n1(t),s=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...a){const o=s.apply(this,a);return n._chartjs.listeners.forEach(l=>{typeof l[r]=="function"&&l[r](...a)}),o}})})}function mR(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,s=r.indexOf(e);s!==-1&&r.splice(s,1),!(r.length>0)&&(G5.forEach(a=>{delete n[a]}),delete n._chartjs)}function Z5(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const K5=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function J5(n,e){let t=[],r=!1;return function(...s){t=s,r||(r=!0,K5.call(window,()=>{r=!1,n.apply(e,t)}))}}function Mse(n,e){let t;return function(...r){return e?(clearTimeout(t),t=setTimeout(n,e,r)):n.apply(this,r),e}}const Q5=n=>n==="start"?"left":n==="end"?"right":"center",li=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,Dse=(n,e,t,r)=>n===(r?"left":"right")?t:n==="center"?(e+t)/2:e;function Ese(n,e,t){const r=e.length;let s=0,a=r;if(n._sorted){const{iScale:o,vScale:l,_parsed:c}=n,d=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,h=o.axis,{min:p,max:x,minDefined:v,maxDefined:_}=o.getUserBounds();if(v){if(s=Math.min(nu(c,h,p).lo,t?r:nu(e,h,o.getPixelForValue(p)).lo),d){const w=c.slice(0,s+1).reverse().findIndex(j=>!yn(j[l.axis]));s-=Math.max(0,w)}s=as(s,0,r-1)}if(_){let w=Math.max(nu(c,o.axis,x,!0).hi+1,t?0:nu(e,h,o.getPixelForValue(x),!0).hi+1);if(d){const j=c.slice(w-1).findIndex(T=>!yn(T[l.axis]));w+=Math.max(0,j)}a=as(w,s,r)-s}else a=r-s}return{start:s,count:a}}function Ose(n){const{xScale:e,yScale:t,_scaleRanges:r}=n,s={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!r)return n._scaleRanges=s,!0;const a=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,s),a}const Ig=n=>n===0||n===1,pR=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Xn/t)),gR=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Xn/t)+1,Kh={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*kr)+1,easeOutSine:n=>Math.sin(n*kr),easeInOutSine:n=>-.5*(Math.cos(Mn*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Ig(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Ig(n)?n:pR(n,.075,.3),easeOutElastic:n=>Ig(n)?n:gR(n,.075,.3),easeInOutElastic(n){return Ig(n)?n:n<.5?.5*pR(n*2,.1125,.45):.5+.5*gR(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Kh.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Kh.easeInBounce(n*2)*.5:Kh.easeOutBounce(n*2-1)*.5+.5};function s1(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function xR(n){return s1(n)?n:new pm(n)}function gN(n){return s1(n)?n:new pm(n).saturate(.5).darken(.1).hexString()}const Ise=["x","y","borderWidth","radius","tension"],Ase=["color","borderColor","backgroundColor"];function Rse(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:Ase},numbers:{type:"number",properties:Ise}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Lse(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const yR=new Map;function Fse(n,e){e=e||{};const t=n+JSON.stringify(e);let r=yR.get(t);return r||(r=new Intl.NumberFormat(n,e),yR.set(t,r)),r}function i1(n,e,t){return Fse(e,t).format(n)}const qse={values(n){return Tr(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const r=this.chart.options.locale;let s,a=n;if(t.length>1){const d=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(d<1e-4||d>1e15)&&(s="scientific"),a=zse(n,t)}const o=H5(Math.abs(a)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:s,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),i1(n,r,c)}};function zse(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var X5={formatters:qse};function Use(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:X5.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const hu=Object.create(null),qS=Object.create(null);function Jh(n,e){if(!e)return n;const t=e.split(".");for(let r=0,s=t.length;r<s;++r){const a=t[r];n=n[a]||(n[a]=Object.create(null))}return n}function xN(n,e,t){return typeof e=="string"?gm(Jh(n,e),t):gm(Jh(n,""),e)}class Vse{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,s)=>gN(s.backgroundColor),this.hoverBorderColor=(r,s)=>gN(s.borderColor),this.hoverColor=(r,s)=>gN(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return xN(this,e,t)}get(e){return Jh(this,e)}describe(e,t){return xN(qS,e,t)}override(e,t){return xN(hu,e,t)}route(e,t,r,s){const a=Jh(this,e),o=Jh(this,r),l="_"+t;Object.defineProperties(a,{[l]:{value:a[t],writable:!0},[t]:{enumerable:!0,get(){const c=this[l],d=o[s];return nn(c)?Object.assign({},d,c):Gt(c,d)},set(c){this[l]=c}}})}apply(e){e.forEach(t=>t(this))}}var lr=new Vse({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Rse,Lse,Use]);function Bse(n){return!n||yn(n.size)||yn(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function vR(n,e,t,r,s){let a=e[s];return a||(a=e[s]=n.measureText(s).width,t.push(s)),a>r&&(r=a),r}function Bd(n,e,t){const r=n.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*r)/r+s}function bR(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function zS(n,e,t,r){e6(n,e,t,r,null)}function e6(n,e,t,r,s){let a,o,l,c,d,h,p,x;const v=e.pointStyle,_=e.rotation,w=e.radius;let j=(_||0)*vse;if(v&&typeof v=="object"&&(a=v.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){n.save(),n.translate(t,r),n.rotate(j),n.drawImage(v,-v.width/2,-v.height/2,v.width,v.height),n.restore();return}if(!(isNaN(w)||w<=0)){switch(n.beginPath(),v){default:s?n.ellipse(t,r,s/2,w,0,0,Xn):n.arc(t,r,w,0,Xn),n.closePath();break;case"triangle":h=s?s/2:w,n.moveTo(t+Math.sin(j)*h,r-Math.cos(j)*w),j+=uR,n.lineTo(t+Math.sin(j)*h,r-Math.cos(j)*w),j+=uR,n.lineTo(t+Math.sin(j)*h,r-Math.cos(j)*w),n.closePath();break;case"rectRounded":d=w*.516,c=w-d,o=Math.cos(j+Vd)*c,p=Math.cos(j+Vd)*(s?s/2-d:c),l=Math.sin(j+Vd)*c,x=Math.sin(j+Vd)*(s?s/2-d:c),n.arc(t-p,r-l,d,j-Mn,j-kr),n.arc(t+x,r-o,d,j-kr,j),n.arc(t+p,r+l,d,j,j+kr),n.arc(t-x,r+o,d,j+kr,j+Mn),n.closePath();break;case"rect":if(!_){c=Math.SQRT1_2*w,h=s?s/2:c,n.rect(t-h,r-c,2*h,2*c);break}j+=Vd;case"rectRot":p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+x,r-o),n.lineTo(t+p,r+l),n.lineTo(t-x,r+o),n.closePath();break;case"crossRot":j+=Vd;case"cross":p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o);break;case"star":p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o),j+=Vd,p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o);break;case"line":o=s?s/2:Math.cos(j)*w,l=Math.sin(j)*w,n.moveTo(t-o,r-l),n.lineTo(t+o,r+l);break;case"dash":n.moveTo(t,r),n.lineTo(t+Math.cos(j)*(s?s/2:w),r+Math.sin(j)*w);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function bm(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function _y(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function wy(n){n.restore()}function Wse(n,e,t,r,s){if(!e)return n.lineTo(t.x,t.y);if(s==="middle"){const a=(e.x+t.x)/2;n.lineTo(a,e.y),n.lineTo(a,t.y)}else s==="after"!=!!r?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function $se(n,e,t,r){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function Hse(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),yn(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function Yse(n,e,t,r,s){if(s.strikethrough||s.underline){const a=n.measureText(r),o=e-a.actualBoundingBoxLeft,l=e+a.actualBoundingBoxRight,c=t-a.actualBoundingBoxAscent,d=t+a.actualBoundingBoxDescent,h=s.strikethrough?(c+d)/2:d;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(o,h),n.lineTo(l,h),n.stroke()}}function Gse(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Ix(n,e,t,r,s,a={}){const o=Tr(e)?e:[e],l=a.strokeWidth>0&&a.strokeColor!=="";let c,d;for(n.save(),n.font=s.string,Hse(n,a),c=0;c<o.length;++c)d=o[c],a.backdrop&&Gse(n,a.backdrop),l&&(a.strokeColor&&(n.strokeStyle=a.strokeColor),yn(a.strokeWidth)||(n.lineWidth=a.strokeWidth),n.strokeText(d,t,r,a.maxWidth)),n.fillText(d,t,r,a.maxWidth),Yse(n,t,r,d,a),r+=Number(s.lineHeight);n.restore()}function Ax(n,e){const{x:t,y:r,w:s,h:a,radius:o}=e;n.arc(t+o.topLeft,r+o.topLeft,o.topLeft,1.5*Mn,Mn,!0),n.lineTo(t,r+a-o.bottomLeft),n.arc(t+o.bottomLeft,r+a-o.bottomLeft,o.bottomLeft,Mn,kr,!0),n.lineTo(t+s-o.bottomRight,r+a),n.arc(t+s-o.bottomRight,r+a-o.bottomRight,o.bottomRight,kr,0,!0),n.lineTo(t+s,r+o.topRight),n.arc(t+s-o.topRight,r+o.topRight,o.topRight,0,-kr,!0),n.lineTo(t+o.topLeft,r)}const Zse=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Kse=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Jse(n,e){const t=(""+n).match(Zse);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const Qse=n=>+n||0;function a1(n,e){const t={},r=nn(e),s=r?Object.keys(e):e,a=nn(n)?r?o=>Gt(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of s)t[o]=Qse(a(o));return t}function t6(n){return a1(n,{top:"y",right:"x",bottom:"y",left:"x"})}function hf(n){return a1(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Oa(n){const e=t6(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function $s(n,e){n=n||{},e=e||lr.font;let t=Gt(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let r=Gt(n.style,e.style);r&&!(""+r).match(Kse)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const s={family:Gt(n.family,e.family),lineHeight:Jse(Gt(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:Gt(n.weight,e.weight),string:""};return s.string=Bse(s),s}function Ag(n,e,t,r){let s,a,o;for(s=0,a=n.length;s<a;++s)if(o=n[s],o!==void 0&&o!==void 0)return o}function Xse(n,e,t){const{min:r,max:s}=n,a=W5(e,(s-r)/2),o=(l,c)=>t&&l===0?0:l+c;return{min:o(r,-Math.abs(a)),max:o(s,a)}}function wu(n,e){return Object.assign(Object.create(n),e)}function o1(n,e=[""],t,r,s=()=>n[0]){const a=t||n;typeof r>"u"&&(r=i6("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:a,_fallback:r,_getTarget:s,override:l=>o1([l,...n],e,a,r)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete n[0][c],!0},get(l,c){return r6(l,c,()=>oie(c,e,n,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(l,c){return wR(l).includes(c)},ownKeys(l){return wR(l)},set(l,c,d){const h=l._storage||(l._storage=s());return l[c]=h[c]=d,delete l._keys,!0}})}function Df(n,e,t,r){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:n6(n,r),setContext:a=>Df(n,a,t,r),override:a=>Df(n.override(a),e,t,r)};return new Proxy(s,{deleteProperty(a,o){return delete a[o],delete n[o],!0},get(a,o,l){return r6(a,o,()=>tie(a,o,l))},getOwnPropertyDescriptor(a,o){return a._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(a,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(a,o,l){return n[o]=l,delete a[o],!0}})}function n6(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:t,indexable:r,isScriptable:$c(t)?t:()=>t,isIndexable:$c(r)?r:()=>r}}const eie=(n,e)=>n?n+n1(e):e,l1=(n,e)=>nn(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function r6(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const r=t();return n[e]=r,r}function tie(n,e,t){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=n;let l=r[e];return $c(l)&&o.isScriptable(e)&&(l=nie(e,l,n,t)),Tr(l)&&l.length&&(l=rie(e,l,n,o.isIndexable)),l1(e,l)&&(l=Df(l,s,a&&a[e],o)),l}function nie(n,e,t,r){const{_proxy:s,_context:a,_subProxy:o,_stack:l}=t;if(l.has(n))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+n);l.add(n);let c=e(a,o||r);return l.delete(n),l1(n,c)&&(c=c1(s._scopes,s,n,c)),c}function rie(n,e,t,r){const{_proxy:s,_context:a,_subProxy:o,_descriptors:l}=t;if(typeof a.index<"u"&&r(n))return e[a.index%e.length];if(nn(e[0])){const c=e,d=s._scopes.filter(h=>h!==c);e=[];for(const h of c){const p=c1(d,s,n,h);e.push(Df(p,a,o&&o[n],l))}}return e}function s6(n,e,t){return $c(n)?n(e,t):n}const sie=(n,e)=>n===!0?e:typeof n=="string"?fu(e,n):void 0;function iie(n,e,t,r,s){for(const a of e){const o=sie(t,a);if(o){n.add(o);const l=s6(o._fallback,t,s);if(typeof l<"u"&&l!==t&&l!==r)return l}else if(o===!1&&typeof r<"u"&&t!==r)return null}return!1}function c1(n,e,t,r){const s=e._rootScopes,a=s6(e._fallback,t,r),o=[...n,...s],l=new Set;l.add(r);let c=_R(l,o,t,a||t,r);return c===null||typeof a<"u"&&a!==t&&(c=_R(l,o,a,c,r),c===null)?!1:o1(Array.from(l),[""],s,a,()=>aie(e,t,r))}function _R(n,e,t,r,s){for(;t;)t=iie(n,e,t,r,s);return t}function aie(n,e,t){const r=n._getTarget();e in r||(r[e]={});const s=r[e];return Tr(s)&&nn(t)?t:s||{}}function oie(n,e,t,r){let s;for(const a of e)if(s=i6(eie(a,n),t),typeof s<"u")return l1(n,s)?c1(t,r,n,s):s}function i6(n,e){for(const t of e){if(!t)continue;const r=t[n];if(typeof r<"u")return r}}function wR(n){let e=n._keys;return e||(e=n._keys=lie(n._scopes)),e}function lie(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(r);return Array.from(e)}const cie=Number.EPSILON||1e-14,Ef=(n,e)=>e<n.length&&!n[e].skip&&n[e],a6=n=>n==="x"?"y":"x";function die(n,e,t,r){const s=n.skip?e:n,a=e,o=t.skip?e:t,l=FS(a,s),c=FS(o,a);let d=l/(l+c),h=c/(l+c);d=isNaN(d)?0:d,h=isNaN(h)?0:h;const p=r*d,x=r*h;return{previous:{x:a.x-p*(o.x-s.x),y:a.y-p*(o.y-s.y)},next:{x:a.x+x*(o.x-s.x),y:a.y+x*(o.y-s.y)}}}function uie(n,e,t){const r=n.length;let s,a,o,l,c,d=Ef(n,0);for(let h=0;h<r-1;++h)if(c=d,d=Ef(n,h+1),!(!c||!d)){if(Zh(e[h],0,cie)){t[h]=t[h+1]=0;continue}s=t[h]/e[h],a=t[h+1]/e[h],l=Math.pow(s,2)+Math.pow(a,2),!(l<=9)&&(o=3/Math.sqrt(l),t[h]=s*o*e[h],t[h+1]=a*o*e[h])}}function fie(n,e,t="x"){const r=a6(t),s=n.length;let a,o,l,c=Ef(n,0);for(let d=0;d<s;++d){if(o=l,l=c,c=Ef(n,d+1),!l)continue;const h=l[t],p=l[r];o&&(a=(h-o[t])/3,l[`cp1${t}`]=h-a,l[`cp1${r}`]=p-a*e[d]),c&&(a=(c[t]-h)/3,l[`cp2${t}`]=h+a,l[`cp2${r}`]=p+a*e[d])}}function hie(n,e="x"){const t=a6(e),r=n.length,s=Array(r).fill(0),a=Array(r);let o,l,c,d=Ef(n,0);for(o=0;o<r;++o)if(l=c,c=d,d=Ef(n,o+1),!!c){if(d){const h=d[e]-c[e];s[o]=h!==0?(d[t]-c[t])/h:0}a[o]=l?d?jo(s[o-1])!==jo(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}uie(n,s,a),fie(n,a,e)}function Rg(n,e,t){return Math.max(Math.min(n,t),e)}function mie(n,e){let t,r,s,a,o,l=bm(n[0],e);for(t=0,r=n.length;t<r;++t)o=a,a=l,l=t<r-1&&bm(n[t+1],e),a&&(s=n[t],o&&(s.cp1x=Rg(s.cp1x,e.left,e.right),s.cp1y=Rg(s.cp1y,e.top,e.bottom)),l&&(s.cp2x=Rg(s.cp2x,e.left,e.right),s.cp2y=Rg(s.cp2y,e.top,e.bottom)))}function pie(n,e,t,r,s){let a,o,l,c;if(e.spanGaps&&(n=n.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")hie(n,s);else{let d=r?n[n.length-1]:n[0];for(a=0,o=n.length;a<o;++a)l=n[a],c=die(d,l,n[Math.min(a+1,o-(r?0:1))%o],e.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,d=l}e.capBezierPoints&&mie(n,t)}function d1(){return typeof window<"u"&&typeof document<"u"}function u1(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Rx(n,e,t){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*e.parentNode[t])):r=n,r}const jy=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function gie(n,e){return jy(n).getPropertyValue(e)}const xie=["top","right","bottom","left"];function au(n,e,t){const r={};t=t?"-"+t:"";for(let s=0;s<4;s++){const a=xie[s];r[a]=parseFloat(n[e+"-"+a+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const yie=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function vie(n,e){const t=n.touches,r=t&&t.length?t[0]:n,{offsetX:s,offsetY:a}=r;let o=!1,l,c;if(yie(s,a,n.target))l=s,c=a;else{const d=e.getBoundingClientRect();l=r.clientX-d.left,c=r.clientY-d.top,o=!0}return{x:l,y:c,box:o}}function Zd(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:r}=e,s=jy(t),a=s.boxSizing==="border-box",o=au(s,"padding"),l=au(s,"border","width"),{x:c,y:d,box:h}=vie(n,t),p=o.left+(h&&l.left),x=o.top+(h&&l.top);let{width:v,height:_}=e;return a&&(v-=o.width+l.width,_-=o.height+l.height),{x:Math.round((c-p)/v*t.width/r),y:Math.round((d-x)/_*t.height/r)}}function bie(n,e,t){let r,s;if(e===void 0||t===void 0){const a=n&&u1(n);if(!a)e=n.clientWidth,t=n.clientHeight;else{const o=a.getBoundingClientRect(),l=jy(a),c=au(l,"border","width"),d=au(l,"padding");e=o.width-d.width-c.width,t=o.height-d.height-c.height,r=Rx(l.maxWidth,a,"clientWidth"),s=Rx(l.maxHeight,a,"clientHeight")}}return{width:e,height:t,maxWidth:r||Ox,maxHeight:s||Ox}}const Ic=n=>Math.round(n*10)/10;function _ie(n,e,t,r){const s=jy(n),a=au(s,"margin"),o=Rx(s.maxWidth,n,"clientWidth")||Ox,l=Rx(s.maxHeight,n,"clientHeight")||Ox,c=bie(n,e,t);let{width:d,height:h}=c;if(s.boxSizing==="content-box"){const x=au(s,"border","width"),v=au(s,"padding");d-=v.width+x.width,h-=v.height+x.height}return d=Math.max(0,d-a.width),h=Math.max(0,r?d/r:h-a.height),d=Ic(Math.min(d,o,c.maxWidth)),h=Ic(Math.min(h,l,c.maxHeight)),d&&!h&&(h=Ic(d/2)),(e!==void 0||t!==void 0)&&r&&c.height&&h>c.height&&(h=c.height,d=Ic(Math.floor(h*r))),{width:d,height:h}}function jR(n,e,t){const r=e||1,s=Ic(n.height*r),a=Ic(n.width*r);n.height=Ic(n.height),n.width=Ic(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==r||o.height!==s||o.width!==a?(n.currentDevicePixelRatio=r,o.height=s,o.width=a,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const wie=(function(){let n=!1;try{const e={get passive(){return n=!0,!1}};d1()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n})();function NR(n,e){const t=gie(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Kd(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function jie(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:r==="middle"?t<.5?n.y:e.y:r==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function Nie(n,e,t,r){const s={x:n.cp2x,y:n.cp2y},a={x:e.cp1x,y:e.cp1y},o=Kd(n,s,t),l=Kd(s,a,t),c=Kd(a,e,t),d=Kd(o,l,t),h=Kd(l,c,t);return Kd(d,h,t)}const Sie=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,r){return t-r},leftForLtr(t,r){return t-r}}},Cie=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function mf(n,e,t){return n?Sie(e,t):Cie()}function o6(n,e){let t,r;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=r)}function l6(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function c6(n){return n==="angle"?{between:vm,compare:Sse,normalize:di}:{between:bl,compare:(e,t)=>e-t,normalize:e=>e}}function SR({start:n,end:e,count:t,loop:r,style:s}){return{start:n%t,end:e%t,loop:r&&(e-n+1)%t===0,style:s}}function Tie(n,e,t){const{property:r,start:s,end:a}=t,{between:o,normalize:l}=c6(r),c=e.length;let{start:d,end:h,loop:p}=n,x,v;if(p){for(d+=c,h+=c,x=0,v=c;x<v&&o(l(e[d%c][r]),s,a);++x)d--,h--;d%=c,h%=c}return h<d&&(h+=c),{start:d,end:h,loop:p,style:n.style}}function d6(n,e,t){if(!t)return[n];const{property:r,start:s,end:a}=t,o=e.length,{compare:l,between:c,normalize:d}=c6(r),{start:h,end:p,loop:x,style:v}=Tie(n,e,t),_=[];let w=!1,j=null,T,P,E;const M=()=>c(s,E,T)&&l(s,E)!==0,O=()=>l(a,T)===0||c(a,E,T),I=()=>w||M(),q=()=>!w||O();for(let F=h,B=h;F<=p;++F)P=e[F%o],!P.skip&&(T=d(P[r]),T!==E&&(w=c(T,s,a),j===null&&I()&&(j=l(T,s)===0?F:B),j!==null&&q()&&(_.push(SR({start:j,end:F,loop:x,count:o,style:v})),j=null),B=F,E=T));return j!==null&&_.push(SR({start:j,end:p,loop:x,count:o,style:v})),_}function u6(n,e){const t=[],r=n.segments;for(let s=0;s<r.length;s++){const a=d6(r[s],n.points,e);a.length&&t.push(...a)}return t}function kie(n,e,t,r){let s=0,a=e-1;if(t&&!r)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,t&&(a+=s);a>s&&n[a%e].skip;)a--;return a%=e,{start:s,end:a}}function Pie(n,e,t,r){const s=n.length,a=[];let o=e,l=n[e],c;for(c=e+1;c<=t;++c){const d=n[c%s];d.skip||d.stop?l.skip||(r=!1,a.push({start:e%s,end:(c-1)%s,loop:r}),e=o=d.stop?c:null):(o=c,l.skip&&(e=c)),l=d}return o!==null&&a.push({start:e%s,end:o%s,loop:r}),a}function Mie(n,e){const t=n.points,r=n.options.spanGaps,s=t.length;if(!s)return[];const a=!!n._loop,{start:o,end:l}=kie(t,s,a,r);if(r===!0)return CR(n,[{start:o,end:l,loop:a}],t,e);const c=l<o?l+s:l,d=!!n._fullLoop&&o===0&&l===s-1;return CR(n,Pie(t,o,c,d),t,e)}function CR(n,e,t,r){return!r||!r.setContext||!t?e:Die(n,e,t,r)}function Die(n,e,t,r){const s=n._chart.getContext(),a=TR(n.options),{_datasetIndex:o,options:{spanGaps:l}}=n,c=t.length,d=[];let h=a,p=e[0].start,x=p;function v(_,w,j,T){const P=l?-1:1;if(_!==w){for(_+=c;t[_%c].skip;)_-=P;for(;t[w%c].skip;)w+=P;_%c!==w%c&&(d.push({start:_%c,end:w%c,loop:j,style:T}),h=T,p=w%c)}}for(const _ of e){p=l?p:_.start;let w=t[p%c],j;for(x=p+1;x<=_.end;x++){const T=t[x%c];j=TR(r.setContext(wu(s,{type:"segment",p0:w,p1:T,p0DataIndex:(x-1)%c,p1DataIndex:x%c,datasetIndex:o}))),Eie(j,h)&&v(p,x-1,_.loop,h),w=T,h=j}p<x-1&&v(p,x-1,_.loop,h)}return d}function TR(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function Eie(n,e){if(!e)return!1;const t=[],r=function(s,a){return s1(a)?(t.includes(a)||t.push(a),t.indexOf(a)):a};return JSON.stringify(n,r)!==JSON.stringify(e,r)}function Lg(n,e,t){return n.options.clip?n[t]:e[t]}function Oie(n,e){const{xScale:t,yScale:r}=n;return t&&r?{left:Lg(t,e,"left"),right:Lg(t,e,"right"),top:Lg(r,e,"top"),bottom:Lg(r,e,"bottom")}:e}function f6(n,e){const t=e._clip;if(t.disabled)return!1;const r=Oie(e,n.chartArea);return{left:t.left===!1?0:r.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:r.right+(t.right===!0?0:t.right),top:t.top===!1?0:r.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:r.bottom+(t.bottom===!0?0:t.bottom)}}class Iie{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,s){const a=t.listeners[s],o=t.duration;a.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(r-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=K5.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,s)=>{if(!r.running||!r.items.length)return;const a=r.items;let o=a.length-1,l=!1,c;for(;o>=0;--o)c=a[o],c._active?(c._total>r.duration&&(r.duration=c._total),c.tick(e),l=!0):(a[o]=a[a.length-1],a.pop());l&&(s.draw(),this._notify(s,r,e,"progress")),a.length||(r.running=!1,this._notify(s,r,e,"complete"),r.initial=!1),t+=a.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,s)=>Math.max(r,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let s=r.length-1;for(;s>=0;--s)r[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var hl=new Iie;const kR="transparent",Aie={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const r=xR(n||kR),s=r.valid&&xR(e||kR);return s&&s.valid?s.mix(r,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class Rie{constructor(e,t,r,s){const a=t[r];s=Ag([e.to,s,a,e.from]);const o=Ag([e.from,a,s]);this._active=!0,this._fn=e.fn||Aie[e.type||typeof o],this._easing=Kh[e.easing]||Kh.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const s=this._target[this._prop],a=r-this._start,o=this._duration-a;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=Ag([e.to,t,s,e.from]),this._from=Ag([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,s=this._prop,a=this._from,o=this._loop,l=this._to;let c;if(this._active=a!==l&&(o||t<r),!this._active){this._target[s]=l,this._notify(!0);return}if(t<0){this._target[s]=a;return}c=t/r%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[s]=this._fn(a,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let s=0;s<r.length;s++)r[s][t]()}}class h6{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!nn(e))return;const t=Object.keys(lr.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const a=e[s];if(!nn(a))return;const o={};for(const l of t)o[l]=a[l];(Tr(a.properties)&&a.properties||[s]).forEach(l=>{(l===s||!r.has(l))&&r.set(l,o)})})}_animateOptions(e,t){const r=t.options,s=Fie(e,r);if(!s)return[];const a=this._createAnimations(s,r);return r.$shared&&Lie(e.options.$animations,r).then(()=>{e.options=r},()=>{}),a}_createAnimations(e,t){const r=this._properties,s=[],a=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const d=o[c];if(d.charAt(0)==="$")continue;if(d==="options"){s.push(...this._animateOptions(e,t));continue}const h=t[d];let p=a[d];const x=r.get(d);if(p)if(x&&p.active()){p.update(x,h,l);continue}else p.cancel();if(!x||!x.duration){e[d]=h;continue}a[d]=p=new Rie(x,e,d,h),s.push(p)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return hl.add(this._chart,r),!0}}function Lie(n,e){const t=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const a=n[r[s]];a&&a.active()&&t.push(a.wait())}return Promise.all(t)}function Fie(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function PR(n,e){const t=n&&n.options||{},r=t.reverse,s=t.min===void 0?e:0,a=t.max===void 0?e:0;return{start:r?a:s,end:r?s:a}}function qie(n,e,t){if(t===!1)return!1;const r=PR(n,t),s=PR(e,t);return{top:s.end,right:r.end,bottom:s.start,left:r.start}}function zie(n){let e,t,r,s;return nn(n)?(e=n.top,t=n.right,r=n.bottom,s=n.left):e=t=r=s=n,{top:e,right:t,bottom:r,left:s,disabled:n===!1}}function m6(n,e){const t=[],r=n._getSortedDatasetMetas(e);let s,a;for(s=0,a=r.length;s<a;++s)t.push(r[s].index);return t}function MR(n,e,t,r={}){const s=n.keys,a=r.mode==="single";let o,l,c,d;if(e===null)return;let h=!1;for(o=0,l=s.length;o<l;++o){if(c=+s[o],c===t){if(h=!0,r.all)continue;break}d=n.values[c],ls(d)&&(a||e===0||jo(e)===jo(d))&&(e+=d)}return!h&&!r.all?0:e}function Uie(n,e){const{iScale:t,vScale:r}=e,s=t.axis==="x"?"x":"y",a=r.axis==="x"?"x":"y",o=Object.keys(n),l=new Array(o.length);let c,d,h;for(c=0,d=o.length;c<d;++c)h=o[c],l[c]={[s]:h,[a]:n[h]};return l}function yN(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function Vie(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function Bie(n){const{min:e,max:t,minDefined:r,maxDefined:s}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function Wie(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function DR(n,e,t,r){for(const s of e.getMatchingVisibleMetas(r).reverse()){const a=n[s.index];if(t&&a>0||!t&&a<0)return s.index}return null}function ER(n,e){const{chart:t,_cachedMeta:r}=n,s=t._stacks||(t._stacks={}),{iScale:a,vScale:o,index:l}=r,c=a.axis,d=o.axis,h=Vie(a,o,r),p=e.length;let x;for(let v=0;v<p;++v){const _=e[v],{[c]:w,[d]:j}=_,T=_._stacks||(_._stacks={});x=T[d]=Wie(s,h,w),x[l]=j,x._top=DR(x,o,!0,r.type),x._bottom=DR(x,o,!1,r.type);const P=x._visualValues||(x._visualValues={});P[l]=j}}function vN(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function $ie(n,e){return wu(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Hie(n,e,t){return wu(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Ph(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const s of e){const a=s._stacks;if(!a||a[r]===void 0||a[r][t]===void 0)return;delete a[r][t],a[r]._visualValues!==void 0&&a[r]._visualValues[t]!==void 0&&delete a[r]._visualValues[t]}}}const bN=n=>n==="reset"||n==="none",OR=(n,e)=>e?n:Object.assign({},n),Yie=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:m6(t,!0),values:null};class Ny{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=yN(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Ph(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),s=(p,x,v,_)=>p==="x"?x:p==="r"?_:v,a=t.xAxisID=Gt(r.xAxisID,vN(e,"x")),o=t.yAxisID=Gt(r.yAxisID,vN(e,"y")),l=t.rAxisID=Gt(r.rAxisID,vN(e,"r")),c=t.indexAxis,d=t.iAxisID=s(c,a,o,l),h=t.vAxisID=s(c,o,a,l);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(d),t.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&mR(this._data,this),e._stacked&&Ph(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(nn(t)){const s=this._cachedMeta;this._data=Uie(t,s)}else if(r!==t){if(r){mR(r,this);const s=this._cachedMeta;Ph(s),s._parsed=[]}t&&Object.isExtensible(t)&&Pse(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let s=!1;this._dataCheck();const a=t._stacked;t._stacked=yN(t.vScale,t),t.stack!==r.stack&&(s=!0,Ph(t),t.stack=r.stack),this._resyncElements(e),(s||a!==t._stacked)&&(ER(this,t._parsed),t._stacked=yN(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:s}=this,{iScale:a,_stacked:o}=r,l=a.axis;let c=e===0&&t===s.length?!0:r._sorted,d=e>0&&r._parsed[e-1],h,p,x;if(this._parsing===!1)r._parsed=s,r._sorted=!0,x=s;else{Tr(s[e])?x=this.parseArrayData(r,s,e,t):nn(s[e])?x=this.parseObjectData(r,s,e,t):x=this.parsePrimitiveData(r,s,e,t);const v=()=>p[l]===null||d&&p[l]<d[l];for(h=0;h<t;++h)r._parsed[h+e]=p=x[h],c&&(v()&&(c=!1),d=p);r._sorted=c}o&&ER(this,x)}parsePrimitiveData(e,t,r,s){const{iScale:a,vScale:o}=e,l=a.axis,c=o.axis,d=a.getLabels(),h=a===o,p=new Array(s);let x,v,_;for(x=0,v=s;x<v;++x)_=x+r,p[x]={[l]:h||a.parse(d[_],_),[c]:o.parse(t[_],_)};return p}parseArrayData(e,t,r,s){const{xScale:a,yScale:o}=e,l=new Array(s);let c,d,h,p;for(c=0,d=s;c<d;++c)h=c+r,p=t[h],l[c]={x:a.parse(p[0],h),y:o.parse(p[1],h)};return l}parseObjectData(e,t,r,s){const{xScale:a,yScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=new Array(s);let h,p,x,v;for(h=0,p=s;h<p;++h)x=h+r,v=t[x],d[h]={x:a.parse(fu(v,l),x),y:o.parse(fu(v,c),x)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const s=this.chart,a=this._cachedMeta,o=t[e.axis],l={keys:m6(s,!0),values:t._stacks[e.axis]._visualValues};return MR(l,o,a.index,{mode:r})}updateRangeFromParsed(e,t,r,s){const a=r[t.axis];let o=a===null?NaN:a;const l=s&&r._stacks[t.axis];s&&l&&(s.values=l,o=MR(s,a,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const r=this._cachedMeta,s=r._parsed,a=r._sorted&&e===r.iScale,o=s.length,l=this._getOtherScale(e),c=Yie(t,r,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:p}=Bie(l);let x,v;function _(){v=s[x];const w=v[l.axis];return!ls(v[e.axis])||h>w||p<w}for(x=0;x<o&&!(!_()&&(this.updateRangeFromParsed(d,e,v,c),a));++x);if(a){for(x=o-1;x>=0;--x)if(!_()){this.updateRangeFromParsed(d,e,v,c);break}}return d}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let s,a,o;for(s=0,a=t.length;s<a;++s)o=t[s][e.axis],ls(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,s=t.vScale,a=this.getParsed(e);return{label:r?""+r.getLabelForValue(a[r.axis]):"",value:s?""+s.getLabelForValue(a[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=zie(Gt(this.options.clip,qie(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,s=r.data||[],a=t.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||s.length-l,d=this.options.drawActiveElementsOnTop;let h;for(r.dataset&&r.dataset.draw(e,a,l,c),h=l;h<l+c;++h){const p=s[h];p.hidden||(p.active&&d?o.push(p):p.draw(e,a))}for(h=0;h<o.length;++h)o[h].draw(e,a)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const s=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];a=o.$context||(o.$context=Hie(this.getContext(),e,o)),a.parsed=this.getParsed(e),a.raw=s.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=$ie(this.chart.getContext(),this.index)),a.dataset=s,a.index=a.datasetIndex=this.index;return a.active=!!t,a.mode=r,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const s=t==="active",a=this._cachedDataOpts,o=e+"-"+t,l=a[o],c=this.enableOptionSharing&&xm(r);if(l)return OR(l,c);const d=this.chart.config,h=d.datasetElementScopeKeys(this._type,e),p=s?[`${e}Hover`,"hover",e,""]:[e,""],x=d.getOptionScopes(this.getDataset(),h),v=Object.keys(lr.elements[e]),_=()=>this.getContext(r,s,t),w=d.resolveNamedOptions(x,v,_,p);return w.$shared&&(w.$shared=c,a[o]=Object.freeze(OR(w,c))),w}_resolveAnimations(e,t,r){const s=this.chart,a=this._cachedDataOpts,o=`animation-${t}`,l=a[o];if(l)return l;let c;if(s.options.animation!==!1){const h=this.chart.config,p=h.datasetAnimationScopeKeys(this._type,t),x=h.getOptionScopes(this.getDataset(),p);c=h.createResolver(x,this.getContext(e,r,t))}const d=new h6(s,c&&c.animations);return c&&c._cacheable&&(a[o]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||bN(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),s=this._sharedOptions,a=this.getSharedOptions(r),o=this.includeOptions(t,a)||a!==s;return this.updateSharedOptions(a,t,r),{sharedOptions:a,includeOptions:o}}updateElement(e,t,r,s){bN(s)?Object.assign(e,r):this._resolveAnimations(t,s).update(e,r)}updateSharedOptions(e,t,r){e&&!bN(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,s){e.active=s;const a=this.getStyle(t,s);this._resolveAnimations(t,r,s).update(e,{options:!s&&this.getSharedOptions(a)||a})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[l,c,d]of this._syncList)this[l](c,d);this._syncList=[];const s=r.length,a=t.length,o=Math.min(a,s);o&&this.parse(0,o),a>s?this._insertElements(s,a-s,e):a<s&&this._removeElements(a,s-a)}_insertElements(e,t,r=!0){const s=this._cachedMeta,a=s.data,o=e+t;let l;const c=d=>{for(d.length+=t,l=d.length-1;l>=o;l--)d[l]=d[l-t]};for(c(a),l=e;l<o;++l)a[l]=new this.dataElementType;this._parsing&&c(s._parsed),this.parse(e,t),r&&this.updateElements(a,e,t,"reset")}updateElements(e,t,r,s){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const s=r._parsed.splice(e,t);r._stacked&&Ph(r,s)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,s]=e;this[t](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Gie(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let r=[];for(let s=0,a=t.length;s<a;s++)r=r.concat(t[s].controller.getAllParsedValues(n));n._cache.$bar=Z5(r.sort((s,a)=>s-a))}return n._cache.$bar}function Zie(n){const e=n.iScale,t=Gie(e,n.type);let r=e._length,s,a,o,l;const c=()=>{o===32767||o===-32768||(xm(l)&&(r=Math.min(r,Math.abs(o-l)||r)),l=o)};for(s=0,a=t.length;s<a;++s)o=e.getPixelForValue(t[s]),c();for(l=void 0,s=0,a=e.ticks.length;s<a;++s)o=e.getPixelForTick(s),c();return r}function Kie(n,e,t,r){const s=t.barThickness;let a,o;return yn(s)?(a=e.min*t.categoryPercentage,o=t.barPercentage):(a=s*r,o=1),{chunk:a/r,ratio:o,start:e.pixels[n]-a/2}}function Jie(n,e,t,r){const s=e.pixels,a=s[n];let o=n>0?s[n-1]:null,l=n<s.length-1?s[n+1]:null;const c=t.categoryPercentage;o===null&&(o=a-(l===null?e.end-e.start:l-a)),l===null&&(l=a+a-o);const d=a-(a-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/r,ratio:t.barPercentage,start:d}}function Qie(n,e,t,r){const s=t.parse(n[0],r),a=t.parse(n[1],r),o=Math.min(s,a),l=Math.max(s,a);let c=o,d=l;Math.abs(o)>Math.abs(l)&&(c=l,d=o),e[t.axis]=d,e._custom={barStart:c,barEnd:d,start:s,end:a,min:o,max:l}}function p6(n,e,t,r){return Tr(n)?Qie(n,e,t,r):e[t.axis]=t.parse(n,r),e}function IR(n,e,t,r){const s=n.iScale,a=n.vScale,o=s.getLabels(),l=s===a,c=[];let d,h,p,x;for(d=t,h=t+r;d<h;++d)x=e[d],p={},p[s.axis]=l||s.parse(o[d],d),c.push(p6(x,p,a,d));return c}function _N(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function Xie(n,e,t){return n!==0?jo(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function eae(n){let e,t,r,s,a;return n.horizontal?(e=n.base>n.x,t="left",r="right"):(e=n.base<n.y,t="bottom",r="top"),e?(s="end",a="start"):(s="start",a="end"),{start:t,end:r,reverse:e,top:s,bottom:a}}function tae(n,e,t,r){let s=e.borderSkipped;const a={};if(!s){n.borderSkipped=a;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:d,bottom:h}=eae(n);s==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===r?s=d:(t._bottom||0)===r?s=h:(a[AR(h,o,l,c)]=!0,s=d)),a[AR(s,o,l,c)]=!0,n.borderSkipped=a}function AR(n,e,t,r){return r?(n=nae(n,e,t),n=RR(n,t,e)):n=RR(n,e,t),n}function nae(n,e,t){return n===e?t:n===t?e:n}function RR(n,e,t){return n==="start"?e:n==="end"?t:n}function rae(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class sae extends Ny{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,r,s){return IR(e,t,r,s)}parseArrayData(e,t,r,s){return IR(e,t,r,s)}parseObjectData(e,t,r,s){const{iScale:a,vScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=a.axis==="x"?l:c,h=o.axis==="x"?l:c,p=[];let x,v,_,w;for(x=r,v=r+s;x<v;++x)w=t[x],_={},_[a.axis]=a.parse(fu(w,d),x),p.push(p6(fu(w,h),_,o,x));return p}updateRangeFromParsed(e,t,r,s){super.updateRangeFromParsed(e,t,r,s);const a=r._custom;a&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:s}=t,a=this.getParsed(e),o=a._custom,l=_N(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(a[s.axis]);return{label:""+r.getLabelForValue(a[r.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,s){const a=s==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),d=l.isHorizontal(),h=this._getRuler(),{sharedOptions:p,includeOptions:x}=this._getSharedOptions(t,s);for(let v=t;v<t+r;v++){const _=this.getParsed(v),w=a||yn(_[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(v),j=this._calculateBarIndexPixels(v,h),T=(_._stacks||{})[l.axis],P={horizontal:d,base:w.base,enableBorderRadius:!T||_N(_._custom)||o===T._top||o===T._bottom,x:d?w.head:j.center,y:d?j.center:w.head,height:d?j.size:Math.abs(w.size),width:d?Math.abs(w.size):j.size};x&&(P.options=p||this.resolveDataElementOptions(v,e[v].active?"active":s));const E=P.options||e[v].options;tae(P,E,T,o),rae(P,E,h.ratio),this.updateElement(e[v],v,P,s)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),a=r.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),c=l&&l[r.axis],d=h=>{const p=h._parsed.find(v=>v[r.axis]===c),x=p&&p[h.vScale.axis];if(yn(x)||isNaN(x))return!0};for(const h of s)if(!(t!==void 0&&d(h))&&((a===!1||o.indexOf(h.stack)===-1||a===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[Gt(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,r){const s=this._getStacks(e,r),a=t!==void 0?s.indexOf(t):-1;return a===-1?s.length-1:a}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,s=[];let a,o;for(a=0,o=t.data.length;a<o;++a)s.push(r.getPixelForValue(this.getParsed(a)[r.axis],a));const l=e.barThickness;return{min:l||Zie(t),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:s},options:{base:a,minBarLength:o}}=this,l=a||0,c=this.getParsed(e),d=c._custom,h=_N(d);let p=c[t.axis],x=0,v=r?this.applyStack(t,c,r):p,_,w;v!==p&&(x=v-p,v=p),h&&(p=d.barStart,v=d.barEnd-d.barStart,p!==0&&jo(p)!==jo(d.barEnd)&&(x=0),x+=p);const j=!yn(a)&&!h?a:x;let T=t.getPixelForValue(j);if(this.chart.getDataVisibility(e)?_=t.getPixelForValue(x+v):_=T,w=_-T,Math.abs(w)<o){w=Xie(w,t,l)*o,p===l&&(T-=w/2);const P=t.getPixelForDecimal(0),E=t.getPixelForDecimal(1),M=Math.min(P,E),O=Math.max(P,E);T=Math.max(Math.min(T,O),M),_=T+w,r&&!h&&(c._stacks[t.axis]._visualValues[s]=t.getValueForPixel(_)-t.getValueForPixel(T))}if(T===t.getPixelForValue(l)){const P=jo(w)*t.getLineWidthForValue(l)/2;T+=P,w-=P}return{size:w,base:T,head:_,center:_+w/2}}_calculateBarIndexPixels(e,t){const r=t.scale,s=this.options,a=s.skipNull,o=Gt(s.maxBarThickness,1/0);let l,c;const d=this._getAxisCount();if(t.grouped){const h=a?this._getStackCount(e):t.stackCount,p=s.barThickness==="flex"?Jie(e,t,s,h*d):Kie(e,t,s,h*d),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,v=this._getAxis().indexOf(Gt(x,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+v;l=p.start+p.chunk*_+p.chunk/2,c=Math.min(o,p.chunk*p.ratio)}else l=r.getPixelForValue(this.getParsed(e)[r.axis],e),c=Math.min(o,t.min*t.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,s=r.length;let a=0;for(;a<s;++a)this.getParsed(a)[t.axis]!==null&&!r[a].hidden&&r[a].draw(this._ctx)}}function iae(n,e,t){let r=1,s=1,a=0,o=0;if(e<Xn){const l=n,c=l+e,d=Math.cos(l),h=Math.sin(l),p=Math.cos(c),x=Math.sin(c),v=(E,M,O)=>vm(E,l,c,!0)?1:Math.max(M,M*t,O,O*t),_=(E,M,O)=>vm(E,l,c,!0)?-1:Math.min(M,M*t,O,O*t),w=v(0,d,p),j=v(kr,h,x),T=_(Mn,d,p),P=_(Mn+kr,h,x);r=(w-T)/2,s=(j-P)/2,a=-(w+T)/2,o=-(j+P)/2}return{ratioX:r,ratioY:s,offsetX:a,offsetY:o}}class aae extends Ny{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:r,textAlign:s,color:a,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((c,d)=>{const p=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:p.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(d),lineDash:p.borderDash,lineDashOffset:p.borderDashOffset,lineJoin:p.borderJoinStyle,lineWidth:p.borderWidth,strokeStyle:p.borderColor,textAlign:s,pointStyle:r,borderRadius:o&&(l||p.borderRadius),index:d}}):[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=r;else{let a=c=>+r[c];if(nn(r[e])){const{key:c="value"}=this._parsing;a=d=>+fu(r[d],c)}let o,l;for(o=e,l=e+t;o<l;++o)s._parsed[o]=a(o)}}_getRotation(){return vl(this.options.rotation-90)}_getCircumference(){return vl(this.options.circumference)}_getRotationExtents(){let e=Xn,t=-Xn;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const s=this.chart.getDatasetMeta(r).controller,a=s._getRotation(),o=s._getCircumference();e=Math.min(e,a),t=Math.max(t,a+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,s=this._cachedMeta,a=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,l=Math.max((Math.min(r.width,r.height)-o)/2,0),c=Math.min(fse(this.options.cutout,l),1),d=this._getRingWeight(this.index),{circumference:h,rotation:p}=this._getRotationExtents(),{ratioX:x,ratioY:v,offsetX:_,offsetY:w}=iae(p,h,c),j=(r.width-o)/x,T=(r.height-o)/v,P=Math.max(Math.min(j,T)/2,0),E=W5(this.options.radius,P),M=Math.max(E*c,0),O=(E-M)/this._getVisibleDatasetWeightTotal();this.offsetX=_*E,this.offsetY=w*E,s.total=this.calculateTotal(),this.outerRadius=E-O*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-O*d,0),this.updateElements(a,0,a.length,e)}_circumference(e,t){const r=this.options,s=this._cachedMeta,a=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*a/Xn)}updateElements(e,t,r,s){const a=s==="reset",o=this.chart,l=o.chartArea,d=o.options.animation,h=(l.left+l.right)/2,p=(l.top+l.bottom)/2,x=a&&d.animateScale,v=x?0:this.innerRadius,_=x?0:this.outerRadius,{sharedOptions:w,includeOptions:j}=this._getSharedOptions(t,s);let T=this._getRotation(),P;for(P=0;P<t;++P)T+=this._circumference(P,a);for(P=t;P<t+r;++P){const E=this._circumference(P,a),M=e[P],O={x:h+this.offsetX,y:p+this.offsetY,startAngle:T,endAngle:T+E,circumference:E,outerRadius:_,innerRadius:v};j&&(O.options=w||this.resolveDataElementOptions(P,M.active?"active":s)),T+=E,this.updateElement(M,P,O,s)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r=0,s;for(s=0;s<t.length;s++){const a=e._parsed[s];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(s)&&!t[s].hidden&&(r+=Math.abs(a))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Xn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,s=r.data.labels||[],a=i1(t._parsed[e],r.options.locale);return{label:s[e]||"",value:a}}getMaxBorderWidth(e){let t=0;const r=this.chart;let s,a,o,l,c;if(!e){for(s=0,a=r.data.datasets.length;s<a;++s)if(r.isDatasetVisible(s)){o=r.getDatasetMeta(s),e=o.data,l=o.controller;break}}if(!e)return 0;for(s=0,a=e.length;s<a;++s)c=l.resolveDataElementOptions(s),c.borderAlign!=="inner"&&(t=Math.max(t,c.borderWidth||0,c.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,s=e.length;r<s;++r){const a=this.resolveDataElementOptions(r);t=Math.max(t,a.offset||0,a.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(Gt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class oae extends Ny{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:s=[],_dataset:a}=t,o=this.chart._animationsDisabled;let{start:l,count:c}=Ese(t,s,o);this._drawStart=l,this._drawCount=c,Ose(t)&&(l=0,c=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!a._decimated,r.points=s;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:d},e),this.updateElements(s,l,c,e)}updateElements(e,t,r,s){const a=s==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:d}=this._cachedMeta,{sharedOptions:h,includeOptions:p}=this._getSharedOptions(t,s),x=o.axis,v=l.axis,{spanGaps:_,segment:w}=this.options,j=ym(_)?_:Number.POSITIVE_INFINITY,T=this.chart._animationsDisabled||a||s==="none",P=t+r,E=e.length;let M=t>0&&this.getParsed(t-1);for(let O=0;O<E;++O){const I=e[O],q=T?I:{};if(O<t||O>=P){q.skip=!0;continue}const F=this.getParsed(O),B=yn(F[v]),U=q[x]=o.getPixelForValue(F[x],O),W=q[v]=a||B?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,F,c):F[v],O);q.skip=isNaN(U)||isNaN(W)||B,q.stop=O>0&&Math.abs(F[x]-M[x])>j,w&&(q.parsed=F,q.raw=d.data[O]),p&&(q.options=h||this.resolveDataElementOptions(O,I.active?"active":s)),T||this.updateElement(I,O,q,s),M=F}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,s=e.data||[];if(!s.length)return r;const a=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,a,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}function Wd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class f1{static override(e){Object.assign(f1.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Wd()}parse(){return Wd()}format(){return Wd()}add(){return Wd()}diff(){return Wd()}startOf(){return Wd()}endOf(){return Wd()}}var lae={_date:f1};function cae(n,e,t,r){const{controller:s,data:a,_sorted:o}=n,l=s._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&a.length){const d=l._reversePixels?Tse:nu;if(r){if(s._sharedOptions){const h=a[0],p=typeof h.getRange=="function"&&h.getRange(e);if(p){const x=d(a,e,t-p),v=d(a,e,t+p);return{lo:x.lo,hi:v.hi}}}}else{const h=d(a,e,t);if(c){const{vScale:p}=s._cachedMeta,{_parsed:x}=n,v=x.slice(0,h.lo+1).reverse().findIndex(w=>!yn(w[p.axis]));h.lo-=Math.max(0,v);const _=x.slice(h.hi).findIndex(w=>!yn(w[p.axis]));h.hi+=Math.max(0,_)}return h}}return{lo:0,hi:a.length-1}}function Sy(n,e,t,r,s){const a=n.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,c=a.length;l<c;++l){const{index:d,data:h}=a[l],{lo:p,hi:x}=cae(a[l],e,o,s);for(let v=p;v<=x;++v){const _=h[v];_.skip||r(_,d,v)}}}function dae(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(r,s){const a=e?Math.abs(r.x-s.x):0,o=t?Math.abs(r.y-s.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}function wN(n,e,t,r,s){const a=[];return!s&&!n.isPointInArea(e)||Sy(n,t,e,function(l,c,d){!s&&!bm(l,n.chartArea,0)||l.inRange(e.x,e.y,r)&&a.push({element:l,datasetIndex:c,index:d})},!0),a}function uae(n,e,t,r){let s=[];function a(o,l,c){const{startAngle:d,endAngle:h}=o.getProps(["startAngle","endAngle"],r),{angle:p}=Y5(o,{x:e.x,y:e.y});vm(p,d,h)&&s.push({element:o,datasetIndex:l,index:c})}return Sy(n,t,e,a),s}function fae(n,e,t,r,s,a){let o=[];const l=dae(t);let c=Number.POSITIVE_INFINITY;function d(h,p,x){const v=h.inRange(e.x,e.y,s);if(r&&!v)return;const _=h.getCenterPoint(s);if(!(!!a||n.isPointInArea(_))&&!v)return;const j=l(e,_);j<c?(o=[{element:h,datasetIndex:p,index:x}],c=j):j===c&&o.push({element:h,datasetIndex:p,index:x})}return Sy(n,t,e,d),o}function jN(n,e,t,r,s,a){return!a&&!n.isPointInArea(e)?[]:t==="r"&&!r?uae(n,e,t,s):fae(n,e,t,r,s,a)}function LR(n,e,t,r,s){const a=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return Sy(n,t,e,(c,d,h)=>{c[o]&&c[o](e[t],s)&&(a.push({element:c,datasetIndex:d,index:h}),l=l||c.inRange(e.x,e.y,s))}),r&&!l?[]:a}var hae={modes:{index(n,e,t,r){const s=Zd(e,n),a=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?wN(n,s,a,r,o):jN(n,s,a,!1,r,o),c=[];return l.length?(n.getSortedVisibleDatasetMetas().forEach(d=>{const h=l[0].index,p=d.data[h];p&&!p.skip&&c.push({element:p,datasetIndex:d.index,index:h})}),c):[]},dataset(n,e,t,r){const s=Zd(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?wN(n,s,a,r,o):jN(n,s,a,!1,r,o);if(l.length>0){const c=l[0].datasetIndex,d=n.getDatasetMeta(c).data;l=[];for(let h=0;h<d.length;++h)l.push({element:d[h],datasetIndex:c,index:h})}return l},point(n,e,t,r){const s=Zd(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return wN(n,s,a,r,o)},nearest(n,e,t,r){const s=Zd(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return jN(n,s,a,t.intersect,r,o)},x(n,e,t,r){const s=Zd(e,n);return LR(n,s,"x",t.intersect,r)},y(n,e,t,r){const s=Zd(e,n);return LR(n,s,"y",t.intersect,r)}}};const g6=["left","top","right","bottom"];function Mh(n,e){return n.filter(t=>t.pos===e)}function FR(n,e){return n.filter(t=>g6.indexOf(t.pos)===-1&&t.box.axis===e)}function Dh(n,e){return n.sort((t,r)=>{const s=e?r:t,a=e?t:r;return s.weight===a.weight?s.index-a.index:s.weight-a.weight})}function mae(n){const e=[];let t,r,s,a,o,l;for(t=0,r=(n||[]).length;t<r;++t)s=n[t],{position:a,options:{stack:o,stackWeight:l=1}}=s,e.push({index:t,box:s,pos:a,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&a+o,stackWeight:l});return e}function pae(n){const e={};for(const t of n){const{stack:r,pos:s,stackWeight:a}=t;if(!r||!g6.includes(s))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=a}return e}function gae(n,e){const t=pae(n),{vBoxMaxWidth:r,hBoxMaxHeight:s}=e;let a,o,l;for(a=0,o=n.length;a<o;++a){l=n[a];const{fullSize:c}=l.box,d=t[l.stack],h=d&&l.stackWeight/d.weight;l.horizontal?(l.width=h?h*r:c&&e.availableWidth,l.height=s):(l.width=r,l.height=h?h*s:c&&e.availableHeight)}return t}function xae(n){const e=mae(n),t=Dh(e.filter(d=>d.box.fullSize),!0),r=Dh(Mh(e,"left"),!0),s=Dh(Mh(e,"right")),a=Dh(Mh(e,"top"),!0),o=Dh(Mh(e,"bottom")),l=FR(e,"x"),c=FR(e,"y");return{fullSize:t,leftAndTop:r.concat(a),rightAndBottom:s.concat(c).concat(o).concat(l),chartArea:Mh(e,"chartArea"),vertical:r.concat(s).concat(c),horizontal:a.concat(o).concat(l)}}function qR(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function x6(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function yae(n,e,t,r){const{pos:s,box:a}=t,o=n.maxPadding;if(!nn(s)){t.size&&(n[s]-=t.size);const p=r[t.stack]||{size:0,count:1};p.size=Math.max(p.size,t.horizontal?a.height:a.width),t.size=p.size/p.count,n[s]+=t.size}a.getPadding&&x6(o,a.getPadding());const l=Math.max(0,e.outerWidth-qR(o,n,"left","right")),c=Math.max(0,e.outerHeight-qR(o,n,"top","bottom")),d=l!==n.w,h=c!==n.h;return n.w=l,n.h=c,t.horizontal?{same:d,other:h}:{same:h,other:d}}function vae(n){const e=n.maxPadding;function t(r){const s=Math.max(e[r]-n[r],0);return n[r]+=s,s}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function bae(n,e){const t=e.maxPadding;function r(s){const a={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{a[o]=Math.max(e[o],t[o])}),a}return r(n?["left","right"]:["top","bottom"])}function Uh(n,e,t,r){const s=[];let a,o,l,c,d,h;for(a=0,o=n.length,d=0;a<o;++a){l=n[a],c=l.box,c.update(l.width||e.w,l.height||e.h,bae(l.horizontal,e));const{same:p,other:x}=yae(e,t,l,r);d|=p&&s.length,h=h||x,c.fullSize||s.push(l)}return d&&Uh(s,e,t,r)||h}function Fg(n,e,t,r,s){n.top=t,n.left=e,n.right=e+r,n.bottom=t+s,n.width=r,n.height=s}function zR(n,e,t,r){const s=t.padding;let{x:a,y:o}=e;for(const l of n){const c=l.box,d=r[l.stack]||{placed:0,weight:1},h=l.stackWeight/d.weight||1;if(l.horizontal){const p=e.w*h,x=d.size||c.height;xm(d.start)&&(o=d.start),c.fullSize?Fg(c,s.left,o,t.outerWidth-s.right-s.left,x):Fg(c,e.left+d.placed,o,p,x),d.start=o,d.placed+=p,o=c.bottom}else{const p=e.h*h,x=d.size||c.width;xm(d.start)&&(a=d.start),c.fullSize?Fg(c,a,s.top,x,t.outerHeight-s.bottom-s.top):Fg(c,a,e.top+d.placed,x,p),d.start=a,d.placed+=p,a=c.right}}e.x=a,e.y=o}var Ac={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const s=Oa(n.options.layout.padding),a=Math.max(e-s.width,0),o=Math.max(t-s.height,0),l=xae(n.boxes),c=l.vertical,d=l.horizontal;wn(n.boxes,w=>{typeof w.beforeLayout=="function"&&w.beforeLayout()});const h=c.reduce((w,j)=>j.box.options&&j.box.options.display===!1?w:w+1,0)||1,p=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:a,availableHeight:o,vBoxMaxWidth:a/2/h,hBoxMaxHeight:o/2}),x=Object.assign({},s);x6(x,Oa(r));const v=Object.assign({maxPadding:x,w:a,h:o,x:s.left,y:s.top},s),_=gae(c.concat(d),p);Uh(l.fullSize,v,p,_),Uh(c,v,p,_),Uh(d,v,p,_)&&Uh(c,v,p,_),vae(v),zR(l.leftAndTop,v,p,_),v.x+=v.w,v.y+=v.h,zR(l.rightAndBottom,v,p,_),n.chartArea={left:v.left,top:v.top,right:v.left+v.w,bottom:v.top+v.h,height:v.h,width:v.w},wn(l.chartArea,w=>{const j=w.box;Object.assign(j,n.chartArea),j.update(v.w,v.h,{left:0,top:0,right:0,bottom:0})})}};class y6{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,s){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):r)}}isAttached(e){return!0}updateConfig(e){}}class _ae extends y6{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const ix="$chartjs",wae={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},UR=n=>n===null||n==="";function jae(n,e){const t=n.style,r=n.getAttribute("height"),s=n.getAttribute("width");if(n[ix]={initial:{height:r,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",UR(s)){const a=NR(n,"width");a!==void 0&&(n.width=a)}if(UR(r))if(n.style.height==="")n.height=n.width/(e||2);else{const a=NR(n,"height");a!==void 0&&(n.height=a)}return n}const v6=wie?{passive:!0}:!1;function Nae(n,e,t){n&&n.addEventListener(e,t,v6)}function Sae(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,v6)}function Cae(n,e){const t=wae[n.type]||n.type,{x:r,y:s}=Zd(n,e);return{type:t,chart:e,native:n,x:r!==void 0?r:null,y:s!==void 0?s:null}}function Lx(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function Tae(n,e,t){const r=n.canvas,s=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||Lx(l.addedNodes,r),o=o&&!Lx(l.removedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function kae(n,e,t){const r=n.canvas,s=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||Lx(l.removedNodes,r),o=o&&!Lx(l.addedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const _m=new Map;let VR=0;function b6(){const n=window.devicePixelRatio;n!==VR&&(VR=n,_m.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function Pae(n,e){_m.size||window.addEventListener("resize",b6),_m.set(n,e)}function Mae(n){_m.delete(n),_m.size||window.removeEventListener("resize",b6)}function Dae(n,e,t){const r=n.canvas,s=r&&u1(r);if(!s)return;const a=J5((l,c)=>{const d=s.clientWidth;t(l,c),d<s.clientWidth&&t()},window),o=new ResizeObserver(l=>{const c=l[0],d=c.contentRect.width,h=c.contentRect.height;d===0&&h===0||a(d,h)});return o.observe(s),Pae(n,a),o}function NN(n,e,t){t&&t.disconnect(),e==="resize"&&Mae(n)}function Eae(n,e,t){const r=n.canvas,s=J5(a=>{n.ctx!==null&&t(Cae(a,n))},n);return Nae(r,e,s),s}class Oae extends y6{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(jae(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[ix])return!1;const r=t[ix].initial;["height","width"].forEach(a=>{const o=r[a];yn(o)?t.removeAttribute(a):t.setAttribute(a,o)});const s=r.style||{};return Object.keys(s).forEach(a=>{t.style[a]=s[a]}),t.width=t.width,delete t[ix],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),o={attach:Tae,detach:kae,resize:Dae}[t]||Eae;s[t]=o(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),s=r[t];if(!s)return;({attach:NN,detach:NN,resize:NN}[t]||Sae)(e,t,s),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,s){return _ie(e,t,r,s)}isAttached(e){const t=e&&u1(e);return!!(t&&t.isConnected)}}function Iae(n){return!d1()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?_ae:Oae}let sd=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return ym(this.x)&&ym(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const s={};return e.forEach(a=>{s[a]=r[a]&&r[a].active()?r[a]._to:this[a]}),s}};function Aae(n,e){const t=n.options.ticks,r=Rae(n),s=Math.min(t.maxTicksLimit||r,r),a=t.major.enabled?Fae(e):[],o=a.length,l=a[0],c=a[o-1],d=[];if(o>s)return qae(e,d,a,o/s),d;const h=Lae(a,e,s);if(o>0){let p,x;const v=o>1?Math.round((c-l)/(o-1)):null;for(qg(e,d,h,yn(v)?0:l-v,l),p=0,x=o-1;p<x;p++)qg(e,d,h,a[p],a[p+1]);return qg(e,d,h,c,yn(v)?e.length:c+v),d}return qg(e,d,h),d}function Rae(n){const e=n.options.offset,t=n._tickSize(),r=n._length/t+(e?0:1),s=n._maxLength/t;return Math.floor(Math.min(r,s))}function Lae(n,e,t){const r=zae(n),s=e.length/t;if(!r)return Math.max(s,1);const a=bse(r);for(let o=0,l=a.length-1;o<l;o++){const c=a[o];if(c>s)return c}return Math.max(s,1)}function Fae(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}function qae(n,e,t,r){let s=0,a=t[0],o;for(r=Math.ceil(r),o=0;o<n.length;o++)o===a&&(e.push(n[o]),s++,a=t[s*r])}function qg(n,e,t,r,s){const a=Gt(r,0),o=Math.min(Gt(s,n.length),n.length);let l=0,c,d,h;for(t=Math.ceil(t),s&&(c=s-r,t=c/Math.floor(c/t)),h=a;h<0;)l++,h=Math.round(a+l*t);for(d=Math.max(a,0);d<o;d++)d===h&&(e.push(n[d]),l++,h=Math.round(a+l*t))}function zae(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}const Uae=n=>n==="left"?"right":n==="right"?"left":n,BR=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,WR=(n,e)=>Math.min(e||n,n);function $R(n,e){const t=[],r=n.length/e,s=n.length;let a=0;for(;a<s;a+=r)t.push(n[Math.floor(a)]);return t}function Vae(n,e,t){const r=n.ticks.length,s=Math.min(e,r-1),a=n._startPixel,o=n._endPixel,l=1e-6;let c=n.getPixelForTick(s),d;if(!(t&&(r===1?d=Math.max(c-a,o-c):e===0?d=(n.getPixelForTick(1)-c)/2:d=(c-n.getPixelForTick(s-1))/2,c+=s<e?d:-d,c<a-l||c>o+l)))return c}function Bae(n,e){wn(n,t=>{const r=t.gc,s=r.length/2;let a;if(s>e){for(a=0;a<s;++a)delete t.data[r[a]];r.splice(0,s)}})}function Eh(n){return n.drawTicks?n.tickLength:0}function HR(n,e){if(!n.display)return 0;const t=$s(n.font,e),r=Oa(n.padding);return(Tr(n.text)?n.text.length:1)*t.lineHeight+r.height}function Wae(n,e){return wu(n,{scale:e,type:"scale"})}function $ae(n,e,t){return wu(n,{tick:t,index:e,type:"tick"})}function Hae(n,e,t){let r=Q5(n);return(t&&e!=="right"||!t&&e==="right")&&(r=Uae(r)),r}function Yae(n,e,t,r){const{top:s,left:a,bottom:o,right:l,chart:c}=n,{chartArea:d,scales:h}=c;let p=0,x,v,_;const w=o-s,j=l-a;if(n.isHorizontal()){if(v=li(r,a,l),nn(t)){const T=Object.keys(t)[0],P=t[T];_=h[T].getPixelForValue(P)+w-e}else t==="center"?_=(d.bottom+d.top)/2+w-e:_=BR(n,t,e);x=l-a}else{if(nn(t)){const T=Object.keys(t)[0],P=t[T];v=h[T].getPixelForValue(P)-j+e}else t==="center"?v=(d.left+d.right)/2-j+e:v=BR(n,t,e);_=li(r,o,s),p=t==="left"?-kr:kr}return{titleX:v,titleY:_,maxWidth:x,rotation:p}}class Bf extends sd{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:s}=this;return e=fo(e,Number.POSITIVE_INFINITY),t=fo(t,Number.NEGATIVE_INFINITY),r=fo(r,Number.POSITIVE_INFINITY),s=fo(s,Number.NEGATIVE_INFINITY),{min:fo(e,r),max:fo(t,s),minDefined:ls(e),maxDefined:ls(t)}}getMinMax(e){let{min:t,max:r,minDefined:s,maxDefined:a}=this.getUserBounds(),o;if(s&&a)return{min:t,max:r};const l=this.getMatchingVisibleMetas();for(let c=0,d=l.length;c<d;++c)o=l[c].controller.getMinMax(this,e),s||(t=Math.min(t,o.min)),a||(r=Math.max(r,o.max));return t=a&&t>r?r:t,r=s&&t>r?t:r,{min:fo(t,fo(r,t)),max:fo(r,fo(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){qn(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:s,grace:a,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Xse(this,a,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?$R(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Aae(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,r;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,e=!e),this._startPixel=t,this._endPixel=r,this._reversePixels=e,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){qn(this.options.afterUpdate,[this])}beforeSetDimensions(){qn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){qn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),qn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){qn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,s,a;for(r=0,s=e.length;r<s;r++)a=e[r],a.label=qn(t.callback,[a.value,r,e],this)}afterTickToLabelConversion(){qn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){qn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=WR(this.ticks.length,e.ticks.maxTicksLimit),s=t.minRotation||0,a=t.maxRotation;let o=s,l,c,d;if(!this._isVisible()||!t.display||s>=a||r<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),p=h.widest.width,x=h.highest.height,v=as(this.chart.width-p,0,this.maxWidth);l=e.offset?this.maxWidth/r:v/(r-1),p+6>l&&(l=v/(r-(e.offset?.5:1)),c=this.maxHeight-Eh(e.grid)-t.padding-HR(e.title,this.chart.options.font),d=Math.sqrt(p*p+x*x),o=Nse(Math.min(Math.asin(as((h.highest.height+6)/l,-1,1)),Math.asin(as(c/d,-1,1))-Math.asin(as(x/d,-1,1)))),o=Math.max(s,Math.min(a,o))),this.labelRotation=o}afterCalculateLabelRotation(){qn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){qn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:s,grid:a}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=HR(s,t.options.font);if(l?(e.width=this.maxWidth,e.height=Eh(a)+c):(e.height=this.maxHeight,e.width=Eh(a)+c),r.display&&this.ticks.length){const{first:d,last:h,widest:p,highest:x}=this._getLabelSizes(),v=r.padding*2,_=vl(this.labelRotation),w=Math.cos(_),j=Math.sin(_);if(l){const T=r.mirror?0:j*p.width+w*x.height;e.height=Math.min(this.maxHeight,e.height+T+v)}else{const T=r.mirror?0:w*p.width+j*x.height;e.width=Math.min(this.maxWidth,e.width+T+v)}this._calculatePadding(d,h,j,w)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,s){const{ticks:{align:a,padding:o},position:l}=this.options,c=this.labelRotation!==0,d=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,p=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,v=0;c?d?(x=s*e.width,v=r*t.height):(x=r*e.height,v=s*t.width):a==="start"?v=t.width:a==="end"?x=e.width:a!=="inner"&&(x=e.width/2,v=t.width/2),this.paddingLeft=Math.max((x-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((v-p+o)*this.width/(this.width-p),0)}else{let h=t.height/2,p=e.height/2;a==="start"?(h=0,p=e.height):a==="end"&&(h=t.height,p=0),this.paddingTop=h+o,this.paddingBottom=p+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){qn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,r;for(t=0,r=e.length;t<r;t++)yn(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=$R(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:s,_longestTextCache:a}=this,o=[],l=[],c=Math.floor(t/WR(t,r));let d=0,h=0,p,x,v,_,w,j,T,P,E,M,O;for(p=0;p<t;p+=c){if(_=e[p].label,w=this._resolveTickFontOptions(p),s.font=j=w.string,T=a[j]=a[j]||{data:{},gc:[]},P=w.lineHeight,E=M=0,!yn(_)&&!Tr(_))E=vR(s,T.data,T.gc,E,_),M=P;else if(Tr(_))for(x=0,v=_.length;x<v;++x)O=_[x],!yn(O)&&!Tr(O)&&(E=vR(s,T.data,T.gc,E,O),M+=P);o.push(E),l.push(M),d=Math.max(E,d),h=Math.max(M,h)}Bae(a,t);const I=o.indexOf(d),q=l.indexOf(h),F=B=>({width:o[B]||0,height:l[B]||0});return{first:F(0),last:F(t-1),widest:F(I),highest:F(q),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return Cse(this._alignToPixels?Bd(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=$ae(this.getContext(),e,r))}return this.$context||(this.$context=Wae(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=vl(this.labelRotation),r=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),a=this._getLabelSizes(),o=e.autoSkipPadding||0,l=a?a.widest.width+o:0,c=a?a.highest.height+o:0;return this.isHorizontal()?c*r>l*s?l/r:c/s:c*s<l*r?c/r:l/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,s=this.options,{grid:a,position:o,border:l}=s,c=a.offset,d=this.isHorizontal(),p=this.ticks.length+(c?1:0),x=Eh(a),v=[],_=l.setContext(this.getContext()),w=_.display?_.width:0,j=w/2,T=function(J){return Bd(r,J,w)};let P,E,M,O,I,q,F,B,U,W,$,se;if(o==="top")P=T(this.bottom),q=this.bottom-x,B=P-j,W=T(e.top)+j,se=e.bottom;else if(o==="bottom")P=T(this.top),W=e.top,se=T(e.bottom)-j,q=P+j,B=this.top+x;else if(o==="left")P=T(this.right),I=this.right-x,F=P-j,U=T(e.left)+j,$=e.right;else if(o==="right")P=T(this.left),U=e.left,$=T(e.right)-j,I=P+j,F=this.left+x;else if(t==="x"){if(o==="center")P=T((e.top+e.bottom)/2+.5);else if(nn(o)){const J=Object.keys(o)[0],ee=o[J];P=T(this.chart.scales[J].getPixelForValue(ee))}W=e.top,se=e.bottom,q=P+j,B=q+x}else if(t==="y"){if(o==="center")P=T((e.left+e.right)/2);else if(nn(o)){const J=Object.keys(o)[0],ee=o[J];P=T(this.chart.scales[J].getPixelForValue(ee))}I=P-j,F=I-x,U=e.left,$=e.right}const Y=Gt(s.ticks.maxTicksLimit,p),ae=Math.max(1,Math.ceil(p/Y));for(E=0;E<p;E+=ae){const J=this.getContext(E),ee=a.setContext(J),X=l.setContext(J),Z=ee.lineWidth,oe=ee.color,H=X.dash||[],Q=X.dashOffset,ne=ee.tickWidth,de=ee.tickColor,ce=ee.tickBorderDash||[],pe=ee.tickBorderDashOffset;M=Vae(this,E,c),M!==void 0&&(O=Bd(r,M,Z),d?I=F=U=$=O:q=B=W=se=O,v.push({tx1:I,ty1:q,tx2:F,ty2:B,x1:U,y1:W,x2:$,y2:se,width:Z,color:oe,borderDash:H,borderDashOffset:Q,tickWidth:ne,tickColor:de,tickBorderDash:ce,tickBorderDashOffset:pe}))}return this._ticksLength=p,this._borderValue=P,v}_computeLabelItems(e){const t=this.axis,r=this.options,{position:s,ticks:a}=r,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:h,mirror:p}=a,x=Eh(r.grid),v=x+h,_=p?-h:v,w=-vl(this.labelRotation),j=[];let T,P,E,M,O,I,q,F,B,U,W,$,se="middle";if(s==="top")I=this.bottom-_,q=this._getXAxisLabelAlignment();else if(s==="bottom")I=this.top+_,q=this._getXAxisLabelAlignment();else if(s==="left"){const ae=this._getYAxisLabelAlignment(x);q=ae.textAlign,O=ae.x}else if(s==="right"){const ae=this._getYAxisLabelAlignment(x);q=ae.textAlign,O=ae.x}else if(t==="x"){if(s==="center")I=(e.top+e.bottom)/2+v;else if(nn(s)){const ae=Object.keys(s)[0],J=s[ae];I=this.chart.scales[ae].getPixelForValue(J)+v}q=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")O=(e.left+e.right)/2-v;else if(nn(s)){const ae=Object.keys(s)[0],J=s[ae];O=this.chart.scales[ae].getPixelForValue(J)}q=this._getYAxisLabelAlignment(x).textAlign}t==="y"&&(c==="start"?se="top":c==="end"&&(se="bottom"));const Y=this._getLabelSizes();for(T=0,P=l.length;T<P;++T){E=l[T],M=E.label;const ae=a.setContext(this.getContext(T));F=this.getPixelForTick(T)+a.labelOffset,B=this._resolveTickFontOptions(T),U=B.lineHeight,W=Tr(M)?M.length:1;const J=W/2,ee=ae.color,X=ae.textStrokeColor,Z=ae.textStrokeWidth;let oe=q;o?(O=F,q==="inner"&&(T===P-1?oe=this.options.reverse?"left":"right":T===0?oe=this.options.reverse?"right":"left":oe="center"),s==="top"?d==="near"||w!==0?$=-W*U+U/2:d==="center"?$=-Y.highest.height/2-J*U+U:$=-Y.highest.height+U/2:d==="near"||w!==0?$=U/2:d==="center"?$=Y.highest.height/2-J*U:$=Y.highest.height-W*U,p&&($*=-1),w!==0&&!ae.showLabelBackdrop&&(O+=U/2*Math.sin(w))):(I=F,$=(1-W)*U/2);let H;if(ae.showLabelBackdrop){const Q=Oa(ae.backdropPadding),ne=Y.heights[T],de=Y.widths[T];let ce=$-Q.top,pe=0-Q.left;switch(se){case"middle":ce-=ne/2;break;case"bottom":ce-=ne;break}switch(q){case"center":pe-=de/2;break;case"right":pe-=de;break;case"inner":T===P-1?pe-=de:T>0&&(pe-=de/2);break}H={left:pe,top:ce,width:de+Q.width,height:ne+Q.height,color:ae.backdropColor}}j.push({label:M,font:B,textOffset:$,options:{rotation:w,color:ee,strokeColor:X,strokeWidth:Z,textAlign:oe,textBaseline:se,translation:[O,I],backdrop:H}})}return j}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-vl(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:s,padding:a}}=this.options,o=this._getLabelSizes(),l=e+a,c=o.widest.width;let d,h;return t==="left"?s?(h=this.right+a,r==="near"?d="left":r==="center"?(d="center",h+=c/2):(d="right",h+=c)):(h=this.right-l,r==="near"?d="right":r==="center"?(d="center",h-=c/2):(d="left",h=this.left)):t==="right"?s?(h=this.left+a,r==="near"?d="right":r==="center"?(d="center",h-=c/2):(d="left",h-=c)):(h=this.left+l,r==="near"?d="left":r==="center"?(d="center",h+=c/2):(d="right",h=this.right)):d="right",{textAlign:d,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:s,width:a,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,s,a,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(a=>a.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,r=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,o;const l=(c,d,h)=>{!h.width||!h.color||(r.save(),r.lineWidth=h.width,r.strokeStyle=h.color,r.setLineDash(h.borderDash||[]),r.lineDashOffset=h.borderDashOffset,r.beginPath(),r.moveTo(c.x,c.y),r.lineTo(d.x,d.y),r.stroke(),r.restore())};if(t.display)for(a=0,o=s.length;a<o;++a){const c=s[a];t.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),t.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:s}}=this,a=r.setContext(this.getContext()),o=r.display?a.width:0;if(!o)return;const l=s.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,h,p,x;this.isHorizontal()?(d=Bd(e,this.left,o)-o/2,h=Bd(e,this.right,l)+l/2,p=x=c):(p=Bd(e,this.top,o)-o/2,x=Bd(e,this.bottom,l)+l/2,d=h=c),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(d,p),t.lineTo(h,x),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,s=this._computeLabelArea();s&&_y(r,s);const a=this.getLabelItems(e);for(const o of a){const l=o.options,c=o.font,d=o.label,h=o.textOffset;Ix(r,d,0,h,c,l)}s&&wy(r)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:s}}=this;if(!r.display)return;const a=$s(r.font),o=Oa(r.padding),l=r.align;let c=a.lineHeight/2;t==="bottom"||t==="center"||nn(t)?(c+=o.bottom,Tr(r.text)&&(c+=a.lineHeight*(r.text.length-1))):c+=o.top;const{titleX:d,titleY:h,maxWidth:p,rotation:x}=Yae(this,c,t,l);Ix(e,r.text,0,0,a,{color:r.color,maxWidth:p,rotation:x,textAlign:Hae(l,t,s),textBaseline:"middle",translation:[d,h]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=Gt(e.grid&&e.grid.z,-1),s=Gt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Bf.prototype.draw?[{z:t,draw:a=>{this.draw(a)}}]:[{z:r,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:t,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",s=[];let a,o;for(a=0,o=t.length;a<o;++a){const l=t[a];l[r]===this.id&&(!e||l.type===e)&&s.push(l)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return $s(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class zg{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;Kae(t)&&(r=this.register(t));const s=this.items,a=e.id,o=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in s||(s[a]=e,Gae(e,o,r),this.override&&lr.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,s=this.scope;r in t&&delete t[r],s&&r in lr[s]&&(delete lr[s][r],this.override&&delete hu[r])}}function Gae(n,e,t){const r=gm(Object.create(null),[t?lr.get(t):{},lr.get(e),n.defaults]);lr.set(e,r),n.defaultRoutes&&Zae(e,n.defaultRoutes),n.descriptors&&lr.describe(e,n.descriptors)}function Zae(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),s=r.pop(),a=[n].concat(r).join("."),o=e[t].split("."),l=o.pop(),c=o.join(".");lr.route(a,s,c,l)})}function Kae(n){return"id"in n&&"defaults"in n}class Jae{constructor(){this.controllers=new zg(Ny,"datasets",!0),this.elements=new zg(sd,"elements"),this.plugins=new zg(Object,"plugins"),this.scales=new zg(Bf,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(s=>{const a=r||this._getRegistryForType(s);r||a.isForType(s)||a===this.plugins&&s.id?this._exec(e,a,s):wn(s,o=>{const l=r||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,r){const s=n1(e);qn(r["before"+s],[],r),t[e](r),qn(r["after"+s],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return s}}var mo=new Jae;class Qae{constructor(){this._init=void 0}notify(e,t,r,s){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=s?this._descriptors(e).filter(s):this._descriptors(e),o=this._notify(a,e,t,r);return t==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,r,s){s=s||{};for(const a of e){const o=a.plugin,l=o[r],c=[t,s,a.options];if(qn(l,c,o)===!1&&s.cancelable)return!1}return!0}invalidate(){yn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,s=Gt(r.options&&r.options.plugins,{}),a=Xae(r);return s===!1&&!t?[]:toe(e,a,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,s=(a,o)=>a.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(s(t,r),e,"stop"),this._notify(s(r,t),e,"start")}}function Xae(n){const e={},t=[],r=Object.keys(mo.plugins.items);for(let a=0;a<r.length;a++)t.push(mo.getPlugin(r[a]));const s=n.plugins||[];for(let a=0;a<s.length;a++){const o=s[a];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function eoe(n,e){return!e&&n===!1?null:n===!0?{}:n}function toe(n,{plugins:e,localIds:t},r,s){const a=[],o=n.getContext();for(const l of e){const c=l.id,d=eoe(r[c],s);d!==null&&a.push({plugin:l,options:noe(n.config,{plugin:l,local:t[c]},d,o)})}return a}function noe(n,{plugin:e,local:t},r,s){const a=n.pluginScopeKeys(e),o=n.getOptionScopes(r,a);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function US(n,e){const t=lr.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function roe(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function soe(n,e){return n===e?"_index_":"_value_"}function YR(n){if(n==="x"||n==="y"||n==="r")return n}function ioe(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function VS(n,...e){if(YR(n))return n;for(const t of e){const r=t.axis||ioe(t.position)||n.length>1&&YR(n[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function GR(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function aoe(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(r=>r.xAxisID===n||r.yAxisID===n);if(t.length)return GR(n,"x",t[0])||GR(n,"y",t[0])}return{}}function ooe(n,e){const t=hu[n.type]||{scales:{}},r=e.scales||{},s=US(n.type,e),a=Object.create(null);return Object.keys(r).forEach(o=>{const l=r[o];if(!nn(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=VS(o,l,aoe(o,n),lr.scales[l.type]),d=soe(c,s),h=t.scales||{};a[o]=Gh(Object.create(null),[{axis:c},l,h[c],h[d]])}),n.data.datasets.forEach(o=>{const l=o.type||n.type,c=o.indexAxis||US(l,e),h=(hu[l]||{}).scales||{};Object.keys(h).forEach(p=>{const x=roe(p,c),v=o[x+"AxisID"]||x;a[v]=a[v]||Object.create(null),Gh(a[v],[{axis:x},r[v],h[p]])})}),Object.keys(a).forEach(o=>{const l=a[o];Gh(l,[lr.scales[l.type],lr.scale])}),a}function _6(n){const e=n.options||(n.options={});e.plugins=Gt(e.plugins,{}),e.scales=ooe(n,e)}function w6(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function loe(n){return n=n||{},n.data=w6(n.data),_6(n),n}const ZR=new Map,j6=new Set;function Ug(n,e){let t=ZR.get(n);return t||(t=e(),ZR.set(n,t),j6.add(t)),t}const Oh=(n,e,t)=>{const r=fu(e,t);r!==void 0&&n.add(r)};class coe{constructor(e){this._config=loe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=w6(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),_6(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Ug(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Ug(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Ug(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return Ug(`${r}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let s=r.get(e);return(!s||t)&&(s=new Map,r.set(e,s)),s}getOptionScopes(e,t,r){const{options:s,type:a}=this,o=this._cachedScopes(e,r),l=o.get(t);if(l)return l;const c=new Set;t.forEach(h=>{e&&(c.add(e),h.forEach(p=>Oh(c,e,p))),h.forEach(p=>Oh(c,s,p)),h.forEach(p=>Oh(c,hu[a]||{},p)),h.forEach(p=>Oh(c,lr,p)),h.forEach(p=>Oh(c,qS,p))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),j6.has(t)&&o.set(t,d),d}chartOptionScopes(){const{options:e,type:t}=this;return[e,hu[t]||{},lr.datasets[t]||{},{type:t},lr,qS]}resolveNamedOptions(e,t,r,s=[""]){const a={$shared:!0},{resolver:o,subPrefixes:l}=KR(this._resolverCache,e,s);let c=o;if(uoe(o,t)){a.$shared=!1,r=$c(r)?r():r;const d=this.createResolver(e,r,l);c=Df(o,r,d)}for(const d of t)a[d]=c[d];return a}createResolver(e,t,r=[""],s){const{resolver:a}=KR(this._resolverCache,e,r);return nn(t)?Df(a,t,void 0,s):a}}function KR(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const s=t.join();let a=r.get(s);return a||(a={resolver:o1(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},r.set(s,a)),a}const doe=n=>nn(n)&&Object.getOwnPropertyNames(n).some(e=>$c(n[e]));function uoe(n,e){const{isScriptable:t,isIndexable:r}=n6(n);for(const s of e){const a=t(s),o=r(s),l=(o||a)&&n[s];if(a&&($c(l)||doe(l))||o&&Tr(l))return!0}return!1}var foe="4.5.1";const hoe=["top","bottom","left","right","chartArea"];function JR(n,e){return n==="top"||n==="bottom"||hoe.indexOf(n)===-1&&e==="x"}function QR(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function XR(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),qn(t&&t.onComplete,[n],e)}function moe(n){const e=n.chart,t=e.options.animation;qn(t&&t.onProgress,[n],e)}function N6(n){return d1()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const ax={},eL=n=>{const e=N6(n);return Object.values(ax).filter(t=>t.canvas===e).pop()};function poe(n,e,t){const r=Object.keys(n);for(const s of r){const a=+s;if(a>=e){const o=n[s];delete n[s],(t>0||a>e)&&(n[a+t]=o)}}}function goe(n,e,t,r){return!t||n.type==="mouseout"?null:r?e:n}class Cy{static defaults=lr;static instances=ax;static overrides=hu;static registry=mo;static version=foe;static getChart=eL;static register(...e){mo.add(...e),tL()}static unregister(...e){mo.remove(...e),tL()}constructor(e,t){const r=this.config=new coe(t),s=N6(e),a=eL(s);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||Iae(s)),this.platform.updateConfig(r);const l=this.platform.acquireContext(s,o.aspectRatio),c=l&&l.canvas,d=c&&c.height,h=c&&c.width;if(this.id=use(),this.ctx=l,this.canvas=c,this.width=h,this.height=d,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Qae,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Mse(p=>this.update(p),o.resizeDelay||0),this._dataChanges=[],ax[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}hl.listen(this,"complete",XR),hl.listen(this,"progress",moe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:s,_aspectRatio:a}=this;return yn(e)?t&&a?a:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return mo}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():jR(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return bR(this.canvas,this.ctx),this}stop(){return hl.stop(this),this}resize(e,t){hl.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,s=this.canvas,a=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,e,t,a),l=r.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,jR(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),qn(r.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};wn(t,(r,s)=>{r.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,s=Object.keys(r).reduce((o,l)=>(o[l]=!1,o),{});let a=[];t&&(a=a.concat(Object.keys(t).map(o=>{const l=t[o],c=VS(o,l),d=c==="r",h=c==="x";return{options:l,dposition:d?"chartArea":h?"bottom":"left",dtype:d?"radialLinear":h?"category":"linear"}}))),wn(a,o=>{const l=o.options,c=l.id,d=VS(c,l),h=Gt(l.type,o.dtype);(l.position===void 0||JR(l.position,d)!==JR(o.dposition))&&(l.position=o.dposition),s[c]=!0;let p=null;if(c in r&&r[c].type===h)p=r[c];else{const x=mo.getScale(h);p=new x({id:c,type:h,ctx:this.ctx,chart:this}),r[p.id]=p}p.init(l,e)}),wn(s,(o,l)=>{o||delete r[l]}),wn(r,o=>{Ac.configure(this,o,o.options),Ac.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((s,a)=>s.index-a.index),r>t){for(let s=t;s<r;++s)this._destroyDatasetMeta(s);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(QR("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,s)=>{t.filter(a=>a===r._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,s;for(this._removeUnreferencedMetasets(),r=0,s=t.length;r<s;r++){const a=t[r];let o=this.getDatasetMeta(r);const l=a.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=l,o.indexAxis=a.indexAxis||US(l,this.options),o.order=a.order||0,o.index=r,o.label=""+a.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const c=mo.getController(l),{datasetElementType:d,dataElementType:h}=lr.datasets[l];Object.assign(c,{dataElementType:mo.getElement(h),datasetElementType:d&&mo.getElement(d)}),o.controller=new c(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){wn(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let d=0,h=this.data.datasets.length;d<h;d++){const{controller:p}=this.getDatasetMeta(d),x=!s&&a.indexOf(p)===-1;p.buildOrUpdateElements(x),o=Math.max(+p.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),s||wn(a,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(QR("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){wn(this.scales,e=>{Ac.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!dR(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:s,count:a}of t){const o=r==="_removeElements"?-a:a;poe(e,s,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=a=>new Set(e.filter(o=>o[0]===a).map((o,l)=>l+","+o.splice(1).join(","))),s=r(0);for(let a=1;a<t;a++)if(!dR(s,r(a)))return;return Array.from(s).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ac.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],wn(this.boxes,s=>{r&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,a)=>{s._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,$c(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),s={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(r.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(hl.has(this)?this.attached&&!hl.running(this)&&hl.start(this):(this.draw(),XR({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let s,a;for(s=0,a=t.length;s<a;++s){const o=t[s];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r={meta:e,index:e.index,cancelable:!0},s=f6(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(s&&_y(t,s),e.controller.draw(),s&&wy(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return bm(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,s){const a=hae.modes[t];return typeof a=="function"?a(this,e,r,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let s=r.filter(a=>a&&a._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=wu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const s=r?"show":"hide",a=this.getDatasetMeta(e),o=a.controller._resolveAnimations(void 0,s);xm(t)?(a.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(a,{visible:r}),this.update(l=>l.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),hl.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),bR(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete ax[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(a,o)=>{t.addEventListener(this,a,o),e[a]=o},s=(a,o,l)=>{a.offsetX=o,a.offsetY=l,this._eventHandler(a)};wn(this.options.events,a=>r(a,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(c,d)=>{t.addEventListener(this,c,d),e[c]=d},s=(c,d)=>{e[c]&&(t.removeEventListener(this,c,d),delete e[c])},a=(c,d)=>{this.canvas&&this.resize(c,d)};let o;const l=()=>{s("attach",l),this.attached=!0,this.resize(),r("resize",a),r("detach",o)};o=()=>{this.attached=!1,s("resize",a),this._stop(),this._resize(0,0),r("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){wn(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},wn(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const s=r?"set":"remove";let a,o,l,c;for(t==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+s+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){o=e[l];const d=o&&this.getDatasetMeta(o.datasetIndex).controller;d&&d[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:a,index:o})=>{const l=this.getDatasetMeta(a);if(!l)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:l.data[o],index:o}});!Dx(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const s=this.options.hover,a=(c,d)=>c.filter(h=>!d.some(p=>h.datasetIndex===p.datasetIndex&&h.index===p.index)),o=a(t,e),l=r?e:a(e,t);o.length&&this.updateHoverStyle(o,s.mode,!1),l.length&&s.mode&&this.updateHoverStyle(l,s.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,s)===!1)return;const a=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(a||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:s=[],options:a}=this,o=t,l=this._getActiveElements(e,s,r,o),c=xse(e),d=goe(e,this._lastEvent,r,c);r&&(this._lastEvent=null,qn(a.onHover,[e,l,this],this),c&&qn(a.onClick,[e,l,this],this));const h=!Dx(l,s);return(h||t)&&(this._active=l,this._updateHoverStyles(l,s,t)),this._lastEvent=d,h}_getActiveElements(e,t,r,s){if(e.type==="mouseout")return[];if(!r)return t;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,s)}}function tL(){return wn(Cy.instances,n=>n._plugins.invalidate())}function xoe(n,e,t){const{startAngle:r,x:s,y:a,outerRadius:o,innerRadius:l,options:c}=e,{borderWidth:d,borderJoinStyle:h}=c,p=Math.min(d/o,di(r-t));if(n.beginPath(),n.arc(s,a,o-d/2,r+p/2,t-p/2),l>0){const x=Math.min(d/l,di(r-t));n.arc(s,a,l+d/2,t-x/2,r+x/2,!0)}else{const x=Math.min(d/2,o*di(r-t));if(h==="round")n.arc(s,a,x,t-Mn/2,r+Mn/2,!0);else if(h==="bevel"){const v=2*x*x,_=-v*Math.cos(t+Mn/2)+s,w=-v*Math.sin(t+Mn/2)+a,j=v*Math.cos(r+Mn/2)+s,T=v*Math.sin(r+Mn/2)+a;n.lineTo(_,w),n.lineTo(j,T)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function yoe(n,e,t){const{startAngle:r,pixelMargin:s,x:a,y:o,outerRadius:l,innerRadius:c}=e;let d=s/l;n.beginPath(),n.arc(a,o,l,r-d,t+d),c>s?(d=s/c,n.arc(a,o,c,t+d,r-d,!0)):n.arc(a,o,s,t+kr,r-kr),n.closePath(),n.clip()}function voe(n){return a1(n,["outerStart","outerEnd","innerStart","innerEnd"])}function boe(n,e,t,r){const s=voe(n.options.borderRadius),a=(t-e)/2,o=Math.min(a,r*e/2),l=c=>{const d=(t-Math.min(a,c))*r/2;return as(c,0,Math.min(a,d))};return{outerStart:l(s.outerStart),outerEnd:l(s.outerEnd),innerStart:as(s.innerStart,0,o),innerEnd:as(s.innerEnd,0,o)}}function Xu(n,e,t,r){return{x:t+n*Math.cos(e),y:r+n*Math.sin(e)}}function Fx(n,e,t,r,s,a){const{x:o,y:l,startAngle:c,pixelMargin:d,innerRadius:h}=e,p=Math.max(e.outerRadius+r+t-d,0),x=h>0?h+r+t+d:0;let v=0;const _=s-c;if(r){const ae=h>0?h-r:0,J=p>0?p-r:0,ee=(ae+J)/2,X=ee!==0?_*ee/(ee+r):_;v=(_-X)/2}const w=Math.max(.001,_*p-t/Mn)/p,j=(_-w)/2,T=c+j+v,P=s-j-v,{outerStart:E,outerEnd:M,innerStart:O,innerEnd:I}=boe(e,x,p,P-T),q=p-E,F=p-M,B=T+E/q,U=P-M/F,W=x+O,$=x+I,se=T+O/W,Y=P-I/$;if(n.beginPath(),a){const ae=(B+U)/2;if(n.arc(o,l,p,B,ae),n.arc(o,l,p,ae,U),M>0){const Z=Xu(F,U,o,l);n.arc(Z.x,Z.y,M,U,P+kr)}const J=Xu($,P,o,l);if(n.lineTo(J.x,J.y),I>0){const Z=Xu($,Y,o,l);n.arc(Z.x,Z.y,I,P+kr,Y+Math.PI)}const ee=(P-I/x+(T+O/x))/2;if(n.arc(o,l,x,P-I/x,ee,!0),n.arc(o,l,x,ee,T+O/x,!0),O>0){const Z=Xu(W,se,o,l);n.arc(Z.x,Z.y,O,se+Math.PI,T-kr)}const X=Xu(q,T,o,l);if(n.lineTo(X.x,X.y),E>0){const Z=Xu(q,B,o,l);n.arc(Z.x,Z.y,E,T-kr,B)}}else{n.moveTo(o,l);const ae=Math.cos(B)*p+o,J=Math.sin(B)*p+l;n.lineTo(ae,J);const ee=Math.cos(U)*p+o,X=Math.sin(U)*p+l;n.lineTo(ee,X)}n.closePath()}function _oe(n,e,t,r,s){const{fullCircles:a,startAngle:o,circumference:l}=e;let c=e.endAngle;if(a){Fx(n,e,t,r,c,s);for(let d=0;d<a;++d)n.fill();isNaN(l)||(c=o+(l%Xn||Xn))}return Fx(n,e,t,r,c,s),n.fill(),c}function woe(n,e,t,r,s){const{fullCircles:a,startAngle:o,circumference:l,options:c}=e,{borderWidth:d,borderJoinStyle:h,borderDash:p,borderDashOffset:x,borderRadius:v}=c,_=c.borderAlign==="inner";if(!d)return;n.setLineDash(p||[]),n.lineDashOffset=x,_?(n.lineWidth=d*2,n.lineJoin=h||"round"):(n.lineWidth=d,n.lineJoin=h||"bevel");let w=e.endAngle;if(a){Fx(n,e,t,r,w,s);for(let j=0;j<a;++j)n.stroke();isNaN(l)||(w=o+(l%Xn||Xn))}_&&yoe(n,e,w),c.selfJoin&&w-o>=Mn&&v===0&&h!=="miter"&&xoe(n,e,w),a||(Fx(n,e,t,r,w,s),n.stroke())}class joe extends sd{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,r){const s=this.getProps(["x","y"],r),{angle:a,distance:o}=Y5(s,{x:e,y:t}),{startAngle:l,endAngle:c,innerRadius:d,outerRadius:h,circumference:p}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),x=(this.options.spacing+this.options.borderWidth)/2,v=Gt(p,c-l),_=vm(a,l,c)&&l!==c,w=v>=Xn||_,j=bl(o,d+x,h+x);return w&&j}getCenterPoint(e){const{x:t,y:r,startAngle:s,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:d}=this.options,h=(s+a)/2,p=(o+l+d+c)/2;return{x:t+Math.cos(h)*p,y:r+Math.sin(h)*p}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:r}=this,s=(t.offset||0)/4,a=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=r>Xn?Math.floor(r/Xn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*s,Math.sin(l)*s);const c=1-Math.sin(Math.min(Mn,r||0)),d=s*c;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,_oe(e,this,d,a,o),woe(e,this,d,a,o),e.restore()}}function S6(n,e,t=e){n.lineCap=Gt(t.borderCapStyle,e.borderCapStyle),n.setLineDash(Gt(t.borderDash,e.borderDash)),n.lineDashOffset=Gt(t.borderDashOffset,e.borderDashOffset),n.lineJoin=Gt(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Gt(t.borderWidth,e.borderWidth),n.strokeStyle=Gt(t.borderColor,e.borderColor)}function Noe(n,e,t){n.lineTo(t.x,t.y)}function Soe(n){return n.stepped?Wse:n.tension||n.cubicInterpolationMode==="monotone"?$se:Noe}function C6(n,e,t={}){const r=n.length,{start:s=0,end:a=r-1}=t,{start:o,end:l}=e,c=Math.max(s,o),d=Math.min(a,l),h=s<o&&a<o||s>l&&a>l;return{count:r,start:c,loop:e.loop,ilen:d<c&&!h?r+d-c:d-c}}function Coe(n,e,t,r){const{points:s,options:a}=e,{count:o,start:l,loop:c,ilen:d}=C6(s,t,r),h=Soe(a);let{move:p=!0,reverse:x}=r||{},v,_,w;for(v=0;v<=d;++v)_=s[(l+(x?d-v:v))%o],!_.skip&&(p?(n.moveTo(_.x,_.y),p=!1):h(n,w,_,x,a.stepped),w=_);return c&&(_=s[(l+(x?d:0))%o],h(n,w,_,x,a.stepped)),!!c}function Toe(n,e,t,r){const s=e.points,{count:a,start:o,ilen:l}=C6(s,t,r),{move:c=!0,reverse:d}=r||{};let h=0,p=0,x,v,_,w,j,T;const P=M=>(o+(d?l-M:M))%a,E=()=>{w!==j&&(n.lineTo(h,j),n.lineTo(h,w),n.lineTo(h,T))};for(c&&(v=s[P(0)],n.moveTo(v.x,v.y)),x=0;x<=l;++x){if(v=s[P(x)],v.skip)continue;const M=v.x,O=v.y,I=M|0;I===_?(O<w?w=O:O>j&&(j=O),h=(p*h+M)/++p):(E(),n.lineTo(M,O),_=I,p=0,w=j=O),T=O}E()}function BS(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?Toe:Coe}function koe(n){return n.stepped?jie:n.tension||n.cubicInterpolationMode==="monotone"?Nie:Kd}function Poe(n,e,t,r){let s=e._path;s||(s=e._path=new Path2D,e.path(s,t,r)&&s.closePath()),S6(n,e.options),n.stroke(s)}function Moe(n,e,t,r){const{segments:s,options:a}=e,o=BS(e);for(const l of s)S6(n,a,l.style),n.beginPath(),o(n,e,l,{start:t,end:t+r-1})&&n.closePath(),n.stroke()}const Doe=typeof Path2D=="function";function Eoe(n,e,t,r){Doe&&!e.options.segment?Poe(n,e,t,r):Moe(n,e,t,r)}class Ty extends sd{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const s=r.spanGaps?this._loop:this._fullLoop;pie(this._points,r,e,s,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Mie(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,s=e[t],a=this.points,o=u6(this,{property:t,start:s,end:s});if(!o.length)return;const l=[],c=koe(r);let d,h;for(d=0,h=o.length;d<h;++d){const{start:p,end:x}=o[d],v=a[p],_=a[x];if(v===_){l.push(v);continue}const w=Math.abs((s-v[t])/(_[t]-v[t])),j=c(v,_,w,r.stepped);j[t]=e[t],l.push(j)}return l.length===1?l[0]:l}pathSegment(e,t,r){return BS(this)(e,this,t,r)}path(e,t,r){const s=this.segments,a=BS(this);let o=this._loop;t=t||0,r=r||this.points.length-t;for(const l of s)o&=a(e,this,l,{start:t,end:t+r-1});return!!o}draw(e,t,r,s){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),Eoe(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function nL(n,e,t,r){const s=n.options,{[t]:a}=n.getProps([t],r);return Math.abs(e-a)<s.radius+s.hitRadius}class Ooe extends sd{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,r){const s=this.options,{x:a,y:o}=this.getProps(["x","y"],r);return Math.pow(e-a,2)+Math.pow(t-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,t){return nL(this,e,"x",t)}inYRange(e,t){return nL(this,e,"y",t)}getCenterPoint(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const r=t&&e.borderWidth||0;return(t+r)*2}draw(e,t){const r=this.options;this.skip||r.radius<.1||!bm(this,t,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,zS(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function T6(n,e){const{x:t,y:r,base:s,width:a,height:o}=n.getProps(["x","y","base","width","height"],e);let l,c,d,h,p;return n.horizontal?(p=o/2,l=Math.min(t,s),c=Math.max(t,s),d=r-p,h=r+p):(p=a/2,l=t-p,c=t+p,d=Math.min(r,s),h=Math.max(r,s)),{left:l,top:d,right:c,bottom:h}}function Rc(n,e,t,r){return n?0:as(e,t,r)}function Ioe(n,e,t){const r=n.options.borderWidth,s=n.borderSkipped,a=t6(r);return{t:Rc(s.top,a.top,0,t),r:Rc(s.right,a.right,0,e),b:Rc(s.bottom,a.bottom,0,t),l:Rc(s.left,a.left,0,e)}}function Aoe(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,a=hf(s),o=Math.min(e,t),l=n.borderSkipped,c=r||nn(s);return{topLeft:Rc(!c||l.top||l.left,a.topLeft,0,o),topRight:Rc(!c||l.top||l.right,a.topRight,0,o),bottomLeft:Rc(!c||l.bottom||l.left,a.bottomLeft,0,o),bottomRight:Rc(!c||l.bottom||l.right,a.bottomRight,0,o)}}function Roe(n){const e=T6(n),t=e.right-e.left,r=e.bottom-e.top,s=Ioe(n,t/2,r/2),a=Aoe(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:a},inner:{x:e.left+s.l,y:e.top+s.t,w:t-s.l-s.r,h:r-s.t-s.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,a.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(s.b,s.r))}}}}function SN(n,e,t,r){const s=e===null,a=t===null,l=n&&!(s&&a)&&T6(n,r);return l&&(s||bl(e,l.left,l.right))&&(a||bl(t,l.top,l.bottom))}function Loe(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Foe(n,e){n.rect(e.x,e.y,e.w,e.h)}function CN(n,e,t={}){const r=n.x!==t.x?-e:0,s=n.y!==t.y?-e:0,a=(n.x+n.w!==t.x+t.w?e:0)-r,o=(n.y+n.h!==t.y+t.h?e:0)-s;return{x:n.x+r,y:n.y+s,w:n.w+a,h:n.h+o,radius:n.radius}}class qoe extends sd{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:s}}=this,{inner:a,outer:o}=Roe(this),l=Loe(o.radius)?Ax:Foe;e.save(),(o.w!==a.w||o.h!==a.h)&&(e.beginPath(),l(e,CN(o,t,a)),e.clip(),l(e,CN(a,-t,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),l(e,CN(a,t)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,t,r){return SN(this,e,t,r)}inXRange(e,t){return SN(this,e,null,t)}inYRange(e,t){return SN(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:s,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(t+s)/2:t,y:a?r:(r+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}function zoe(n,e,t){const r=n.segments,s=n.points,a=e.points,o=[];for(const l of r){let{start:c,end:d}=l;d=ky(c,d,s);const h=WS(t,s[c],s[d],l.loop);if(!e.segments){o.push({source:l,target:h,start:s[c],end:s[d]});continue}const p=u6(e,h);for(const x of p){const v=WS(t,a[x.start],a[x.end],x.loop),_=d6(l,s,v);for(const w of _)o.push({source:w,target:x,start:{[t]:rL(h,v,"start",Math.max)},end:{[t]:rL(h,v,"end",Math.min)}})}}return o}function WS(n,e,t,r){if(r)return;let s=e[n],a=t[n];return n==="angle"&&(s=di(s),a=di(a)),{property:n,start:s,end:a}}function Uoe(n,e){const{x:t=null,y:r=null}=n||{},s=e.points,a=[];return e.segments.forEach(({start:o,end:l})=>{l=ky(o,l,s);const c=s[o],d=s[l];r!==null?(a.push({x:c.x,y:r}),a.push({x:d.x,y:r})):t!==null&&(a.push({x:t,y:c.y}),a.push({x:t,y:d.y}))}),a}function ky(n,e,t){for(;e>n;e--){const r=t[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function rL(n,e,t,r){return n&&e?r(n[t],e[t]):n?n[t]:e?e[t]:0}function k6(n,e){let t=[],r=!1;return Tr(n)?(r=!0,t=n):t=Uoe(n,e),t.length?new Ty({points:t,options:{tension:0},_loop:r,_fullLoop:r}):null}function sL(n){return n&&n.fill!==!1}function Voe(n,e,t){let s=n[e].fill;const a=[e];let o;if(!t)return s;for(;s!==!1&&a.indexOf(s)===-1;){if(!ls(s))return s;if(o=n[s],!o)return!1;if(o.visible)return s;a.push(s),s=o.fill}return!1}function Boe(n,e,t){const r=Yoe(n);if(nn(r))return isNaN(r.value)?!1:r;let s=parseFloat(r);return ls(s)&&Math.floor(s)===s?Woe(r[0],e,s,t):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function Woe(n,e,t,r){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=r?!1:t}function $oe(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:nn(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function Hoe(n,e,t){let r;return n==="start"?r=t:n==="end"?r=e.options.reverse?e.min:e.max:nn(n)?r=n.value:r=e.getBaseValue(),r}function Yoe(n){const e=n.options,t=e.fill;let r=Gt(t&&t.target,t);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function Goe(n){const{scale:e,index:t,line:r}=n,s=[],a=r.segments,o=r.points,l=Zoe(e,t);l.push(k6({x:null,y:e.bottom},r));for(let c=0;c<a.length;c++){const d=a[c];for(let h=d.start;h<=d.end;h++)Koe(s,o[h],l)}return new Ty({points:s,options:{}})}function Zoe(n,e){const t=[],r=n.getMatchingVisibleMetas("line");for(let s=0;s<r.length;s++){const a=r[s];if(a.index===e)break;a.hidden||t.unshift(a.dataset)}return t}function Koe(n,e,t){const r=[];for(let s=0;s<t.length;s++){const a=t[s],{first:o,last:l,point:c}=Joe(a,e,"x");if(!(!c||o&&l)){if(o)r.unshift(c);else if(n.push(c),!l)break}}n.push(...r)}function Joe(n,e,t){const r=n.interpolate(e,t);if(!r)return{};const s=r[t],a=n.segments,o=n.points;let l=!1,c=!1;for(let d=0;d<a.length;d++){const h=a[d],p=o[h.start][t],x=o[h.end][t];if(bl(s,p,x)){l=s===p,c=s===x;break}}return{first:l,last:c,point:r}}class P6{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,r){const{x:s,y:a,radius:o}=this;return t=t||{start:0,end:Xn},e.arc(s,a,o,t.end,t.start,!0),!r.bounds}interpolate(e){const{x:t,y:r,radius:s}=this,a=e.angle;return{x:t+Math.cos(a)*s,y:r+Math.sin(a)*s,angle:a}}}function Qoe(n){const{chart:e,fill:t,line:r}=n;if(ls(t))return Xoe(e,t);if(t==="stack")return Goe(n);if(t==="shape")return!0;const s=ele(n);return s instanceof P6?s:k6(s,r)}function Xoe(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function ele(n){return(n.scale||{}).getPointPositionForValue?nle(n):tle(n)}function tle(n){const{scale:e={},fill:t}=n,r=$oe(t,e);if(ls(r)){const s=e.isHorizontal();return{x:s?r:null,y:s?null:r}}return null}function nle(n){const{scale:e,fill:t}=n,r=e.options,s=e.getLabels().length,a=r.reverse?e.max:e.min,o=Hoe(t,e,a),l=[];if(r.grid.circular){const c=e.getPointPositionForValue(0,a);return new P6({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(o)})}for(let c=0;c<s;++c)l.push(e.getPointPositionForValue(c,o));return l}function TN(n,e,t){const r=Qoe(e),{chart:s,index:a,line:o,scale:l,axis:c}=e,d=o.options,h=d.fill,p=d.backgroundColor,{above:x=p,below:v=p}=h||{},_=s.getDatasetMeta(a),w=f6(s,_);r&&o.points.length&&(_y(n,t),rle(n,{line:o,target:r,above:x,below:v,area:t,scale:l,axis:c,clip:w}),wy(n))}function rle(n,e){const{line:t,target:r,above:s,below:a,area:o,scale:l,clip:c}=e,d=t._loop?"angle":e.axis;n.save();let h=a;a!==s&&(d==="x"?(iL(n,r,o.top),kN(n,{line:t,target:r,color:s,scale:l,property:d,clip:c}),n.restore(),n.save(),iL(n,r,o.bottom)):d==="y"&&(aL(n,r,o.left),kN(n,{line:t,target:r,color:a,scale:l,property:d,clip:c}),n.restore(),n.save(),aL(n,r,o.right),h=s)),kN(n,{line:t,target:r,color:h,scale:l,property:d,clip:c}),n.restore()}function iL(n,e,t){const{segments:r,points:s}=e;let a=!0,o=!1;n.beginPath();for(const l of r){const{start:c,end:d}=l,h=s[c],p=s[ky(c,d,s)];a?(n.moveTo(h.x,h.y),a=!1):(n.lineTo(h.x,t),n.lineTo(h.x,h.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(p.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function aL(n,e,t){const{segments:r,points:s}=e;let a=!0,o=!1;n.beginPath();for(const l of r){const{start:c,end:d}=l,h=s[c],p=s[ky(c,d,s)];a?(n.moveTo(h.x,h.y),a=!1):(n.lineTo(t,h.y),n.lineTo(h.x,h.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(t,p.y)}n.lineTo(t,e.first().y),n.closePath(),n.clip()}function kN(n,e){const{line:t,target:r,property:s,color:a,scale:o,clip:l}=e,c=zoe(t,r,s);for(const{source:d,target:h,start:p,end:x}of c){const{style:{backgroundColor:v=a}={}}=d,_=r!==!0;n.save(),n.fillStyle=v,sle(n,o,l,_&&WS(s,p,x)),n.beginPath();const w=!!t.pathSegment(n,d);let j;if(_){w?n.closePath():oL(n,r,x,s);const T=!!r.pathSegment(n,h,{move:w,reverse:!0});j=w&&T,j||oL(n,r,p,s)}n.closePath(),n.fill(j?"evenodd":"nonzero"),n.restore()}}function sle(n,e,t,r){const s=e.chart.chartArea,{property:a,start:o,end:l}=r||{};if(a==="x"||a==="y"){let c,d,h,p;a==="x"?(c=o,d=s.top,h=l,p=s.bottom):(c=s.left,d=o,h=s.right,p=l),n.beginPath(),t&&(c=Math.max(c,t.left),h=Math.min(h,t.right),d=Math.max(d,t.top),p=Math.min(p,t.bottom)),n.rect(c,d,h-c,p-d),n.clip()}}function oL(n,e,t,r){const s=e.interpolate(t,r);s&&n.lineTo(s.x,s.y)}var ile={id:"filler",afterDatasetsUpdate(n,e,t){const r=(n.data.datasets||[]).length,s=[];let a,o,l,c;for(o=0;o<r;++o)a=n.getDatasetMeta(o),l=a.dataset,c=null,l&&l.options&&l instanceof Ty&&(c={visible:n.isDatasetVisible(o),index:o,fill:Boe(l,o,r),chart:n,axis:a.controller.options.indexAxis,scale:a.vScale,line:l}),a.$filler=c,s.push(c);for(o=0;o<r;++o)c=s[o],!(!c||c.fill===!1)&&(c.fill=Voe(s,o,t.propagate))},beforeDraw(n,e,t){const r=t.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),a=n.chartArea;for(let o=s.length-1;o>=0;--o){const l=s[o].$filler;l&&(l.line.updateControlPoints(a,l.axis),r&&l.fill&&TN(n.ctx,l,a))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const r=n.getSortedVisibleDatasetMetas();for(let s=r.length-1;s>=0;--s){const a=r[s].$filler;sL(a)&&TN(n.ctx,a,n.chartArea)}},beforeDatasetDraw(n,e,t){const r=e.meta.$filler;!sL(r)||t.drawTime!=="beforeDatasetDraw"||TN(n.ctx,r,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const lL=(n,e)=>{let{boxHeight:t=e,boxWidth:r=e}=n;return n.usePointStyle&&(t=Math.min(t,e),r=n.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(e,t)}},ale=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class cL extends sd{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=qn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(r=>e.filter(r,this.chart.data))),e.sort&&(t=t.sort((r,s)=>e.sort(r,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,s=$s(r.font),a=s.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=lL(r,a);let d,h;t.font=s.string,this.isHorizontal()?(d=this.maxWidth,h=this._fitRows(o,a,l,c)+10):(h=this.maxHeight,d=this._fitCols(o,s,l,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(h,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,s){const{ctx:a,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],h=s+l;let p=e;a.textAlign="left",a.textBaseline="middle";let x=-1,v=-h;return this.legendItems.forEach((_,w)=>{const j=r+t/2+a.measureText(_.text).width;(w===0||d[d.length-1]+j+2*l>o)&&(p+=h,d[d.length-(w>0?0:1)]=0,v+=h,x++),c[w]={left:0,top:v,row:x,width:j,height:s},d[d.length-1]+=j+l}),p}_fitCols(e,t,r,s){const{ctx:a,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],h=o-e;let p=l,x=0,v=0,_=0,w=0;return this.legendItems.forEach((j,T)=>{const{itemWidth:P,itemHeight:E}=ole(r,t,a,j,s);T>0&&v+E+2*l>h&&(p+=x+l,d.push({width:x,height:v}),_+=x+l,w++,x=v=0),c[T]={left:_,top:v,col:w,width:P,height:E},x=Math.max(x,P),v+=E+l}),p+=x,d.push({width:x,height:v}),p}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:s},rtl:a}}=this,o=mf(a,this.left,this.width);if(this.isHorizontal()){let l=0,c=li(r,this.left+s,this.right-this.lineWidths[l]);for(const d of t)l!==d.row&&(l=d.row,c=li(r,this.left+s,this.right-this.lineWidths[l])),d.top+=this.top+e+s,d.left=o.leftForLtr(o.x(c),d.width),c+=d.width+s}else{let l=0,c=li(r,this.top+e+s,this.bottom-this.columnSizes[l].height);for(const d of t)d.col!==l&&(l=d.col,c=li(r,this.top+e+s,this.bottom-this.columnSizes[l].height)),d.top=c,d.left+=this.left+s,d.left=o.leftForLtr(o.x(d.left),d.width),c+=d.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;_y(e,this),this._draw(),wy(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:s}=this,{align:a,labels:o}=e,l=lr.color,c=mf(e.rtl,this.left,this.width),d=$s(o.font),{padding:h}=o,p=d.size,x=p/2;let v;this.drawTitle(),s.textAlign=c.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=d.string;const{boxWidth:_,boxHeight:w,itemHeight:j}=lL(o,p),T=function(I,q,F){if(isNaN(_)||_<=0||isNaN(w)||w<0)return;s.save();const B=Gt(F.lineWidth,1);if(s.fillStyle=Gt(F.fillStyle,l),s.lineCap=Gt(F.lineCap,"butt"),s.lineDashOffset=Gt(F.lineDashOffset,0),s.lineJoin=Gt(F.lineJoin,"miter"),s.lineWidth=B,s.strokeStyle=Gt(F.strokeStyle,l),s.setLineDash(Gt(F.lineDash,[])),o.usePointStyle){const U={radius:w*Math.SQRT2/2,pointStyle:F.pointStyle,rotation:F.rotation,borderWidth:B},W=c.xPlus(I,_/2),$=q+x;e6(s,U,W,$,o.pointStyleWidth&&_)}else{const U=q+Math.max((p-w)/2,0),W=c.leftForLtr(I,_),$=hf(F.borderRadius);s.beginPath(),Object.values($).some(se=>se!==0)?Ax(s,{x:W,y:U,w:_,h:w,radius:$}):s.rect(W,U,_,w),s.fill(),B!==0&&s.stroke()}s.restore()},P=function(I,q,F){Ix(s,F.text,I,q+j/2,d,{strikethrough:F.hidden,textAlign:c.textAlign(F.textAlign)})},E=this.isHorizontal(),M=this._computeTitleHeight();E?v={x:li(a,this.left+h,this.right-r[0]),y:this.top+h+M,line:0}:v={x:this.left+h,y:li(a,this.top+M+h,this.bottom-t[0].height),line:0},o6(this.ctx,e.textDirection);const O=j+h;this.legendItems.forEach((I,q)=>{s.strokeStyle=I.fontColor,s.fillStyle=I.fontColor;const F=s.measureText(I.text).width,B=c.textAlign(I.textAlign||(I.textAlign=o.textAlign)),U=_+x+F;let W=v.x,$=v.y;c.setWidth(this.width),E?q>0&&W+U+h>this.right&&($=v.y+=O,v.line++,W=v.x=li(a,this.left+h,this.right-r[v.line])):q>0&&$+O>this.bottom&&(W=v.x=W+t[v.line].width+h,v.line++,$=v.y=li(a,this.top+M+h,this.bottom-t[v.line].height));const se=c.x(W);if(T(se,$,I),W=Dse(B,W+_+x,E?W+U:this.right,e.rtl),P(c.x(W),$,I),E)v.x+=U+h;else if(typeof I.text!="string"){const Y=d.lineHeight;v.y+=M6(I,Y)+h}else v.y+=O}),l6(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=$s(t.font),s=Oa(t.padding);if(!t.display)return;const a=mf(e.rtl,this.left,this.width),o=this.ctx,l=t.position,c=r.size/2,d=s.top+c;let h,p=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),h=this.top+d,p=li(e.align,p,this.right-x);else{const _=this.columnSizes.reduce((w,j)=>Math.max(w,j.height),0);h=d+li(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const v=li(l,p,p+x);o.textAlign=a.textAlign(Q5(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=r.string,Ix(o,t.text,v,h,r)}_computeTitleHeight(){const e=this.options.title,t=$s(e.font),r=Oa(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,s,a;if(bl(e,this.left,this.right)&&bl(t,this.top,this.bottom)){for(a=this.legendHitBoxes,r=0;r<a.length;++r)if(s=a[r],bl(e,s.left,s.left+s.width)&&bl(t,s.top,s.top+s.height))return this.legendItems[r]}return null}handleEvent(e){const t=this.options;if(!dle(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,a=ale(s,r);s&&!a&&qn(t.onLeave,[e,s,this],this),this._hoveredItem=r,r&&!a&&qn(t.onHover,[e,r,this],this)}else r&&qn(t.onClick,[e,r,this],this)}}function ole(n,e,t,r,s){const a=lle(r,n,e,t),o=cle(s,r,e.lineHeight);return{itemWidth:a,itemHeight:o}}function lle(n,e,t,r){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((a,o)=>a.length>o.length?a:o)),e+t.size/2+r.measureText(s).width}function cle(n,e,t){let r=n;return typeof e.text!="string"&&(r=M6(e,t)),r}function M6(n,e){const t=n.text?n.text.length:0;return e*t}function dle(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var ule={id:"legend",_element:cL,start(n,e,t){const r=n.legend=new cL({ctx:n.ctx,options:t,chart:n});Ac.configure(n,r,t),Ac.addBox(n,r)},stop(n){Ac.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const r=n.legend;Ac.configure(n,r,t),r.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const r=e.datasetIndex,s=t.chart;s.isDatasetVisible(r)?(s.hide(r),e.hidden=!0):(s.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:s,color:a,useBorderRadius:o,borderRadius:l}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(t?0:void 0),h=Oa(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:a,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:d.borderColor,pointStyle:r||d.pointStyle,rotation:d.rotation,textAlign:s||d.textAlign,borderRadius:o&&(l||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};const Vh={average(n){if(!n.length)return!1;let e,t,r=new Set,s=0,a=0;for(e=0,t=n.length;e<t;++e){const l=n[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();r.add(c.x),s+=c.y,++a}}return a===0||r.size===0?!1:{x:[...r].reduce((l,c)=>l+c)/r.size,y:s/a}},nearest(n,e){if(!n.length)return!1;let t=e.x,r=e.y,s=Number.POSITIVE_INFINITY,a,o,l;for(a=0,o=n.length;a<o;++a){const c=n[a].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),h=FS(e,d);h<s&&(s=h,l=c)}}if(l){const c=l.tooltipPosition();t=c.x,r=c.y}return{x:t,y:r}}};function ho(n,e){return e&&(Tr(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function ml(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function fle(n,e){const{element:t,datasetIndex:r,index:s}=e,a=n.getDatasetMeta(r).controller,{label:o,value:l}=a.getLabelAndValue(s);return{chart:n,label:o,parsed:a.getParsed(s),raw:n.data.datasets[r].data[s],formattedValue:l,dataset:a.getDataset(),dataIndex:s,datasetIndex:r,element:t}}function dL(n,e){const t=n.chart.ctx,{body:r,footer:s,title:a}=n,{boxWidth:o,boxHeight:l}=e,c=$s(e.bodyFont),d=$s(e.titleFont),h=$s(e.footerFont),p=a.length,x=s.length,v=r.length,_=Oa(e.padding);let w=_.height,j=0,T=r.reduce((M,O)=>M+O.before.length+O.lines.length+O.after.length,0);if(T+=n.beforeBody.length+n.afterBody.length,p&&(w+=p*d.lineHeight+(p-1)*e.titleSpacing+e.titleMarginBottom),T){const M=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;w+=v*M+(T-v)*c.lineHeight+(T-1)*e.bodySpacing}x&&(w+=e.footerMarginTop+x*h.lineHeight+(x-1)*e.footerSpacing);let P=0;const E=function(M){j=Math.max(j,t.measureText(M).width+P)};return t.save(),t.font=d.string,wn(n.title,E),t.font=c.string,wn(n.beforeBody.concat(n.afterBody),E),P=e.displayColors?o+2+e.boxPadding:0,wn(r,M=>{wn(M.before,E),wn(M.lines,E),wn(M.after,E)}),P=0,t.font=h.string,wn(n.footer,E),t.restore(),j+=_.width,{width:j,height:w}}function hle(n,e){const{y:t,height:r}=e;return t<r/2?"top":t>n.height-r/2?"bottom":"center"}function mle(n,e,t,r){const{x:s,width:a}=r,o=t.caretSize+t.caretPadding;if(n==="left"&&s+a+o>e.width||n==="right"&&s-a-o<0)return!0}function ple(n,e,t,r){const{x:s,width:a}=t,{width:o,chartArea:{left:l,right:c}}=n;let d="center";return r==="center"?d=s<=(l+c)/2?"left":"right":s<=a/2?d="left":s>=o-a/2&&(d="right"),mle(d,n,e,t)&&(d="center"),d}function uL(n,e,t){const r=t.yAlign||e.yAlign||hle(n,t);return{xAlign:t.xAlign||e.xAlign||ple(n,e,t,r),yAlign:r}}function gle(n,e){let{x:t,width:r}=n;return e==="right"?t-=r:e==="center"&&(t-=r/2),t}function xle(n,e,t){let{y:r,height:s}=n;return e==="top"?r+=t:e==="bottom"?r-=s+t:r-=s/2,r}function fL(n,e,t,r){const{caretSize:s,caretPadding:a,cornerRadius:o}=n,{xAlign:l,yAlign:c}=t,d=s+a,{topLeft:h,topRight:p,bottomLeft:x,bottomRight:v}=hf(o);let _=gle(e,l);const w=xle(e,c,d);return c==="center"?l==="left"?_+=d:l==="right"&&(_-=d):l==="left"?_-=Math.max(h,x)+s:l==="right"&&(_+=Math.max(p,v)+s),{x:as(_,0,r.width-e.width),y:as(w,0,r.height-e.height)}}function Vg(n,e,t){const r=Oa(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-r.right:n.x+r.left}function hL(n){return ho([],ml(n))}function yle(n,e,t){return wu(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function mL(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const D6={beforeTitle:ul,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:ul,beforeBody:ul,beforeLabel:ul,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return yn(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ul,afterBody:ul,beforeFooter:ul,footer:ul,afterFooter:ul};function qs(n,e,t,r){const s=n[e].call(t,r);return typeof s>"u"?D6[e].call(t,r):s}class pL extends sd{static positioners=Vh;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&t.options.animation&&r.animations,a=new h6(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=yle(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:r}=t,s=qs(r,"beforeTitle",this,e),a=qs(r,"title",this,e),o=qs(r,"afterTitle",this,e);let l=[];return l=ho(l,ml(s)),l=ho(l,ml(a)),l=ho(l,ml(o)),l}getBeforeBody(e,t){return hL(qs(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,s=[];return wn(e,a=>{const o={before:[],lines:[],after:[]},l=mL(r,a);ho(o.before,ml(qs(l,"beforeLabel",this,a))),ho(o.lines,qs(l,"label",this,a)),ho(o.after,ml(qs(l,"afterLabel",this,a))),s.push(o)}),s}getAfterBody(e,t){return hL(qs(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,s=qs(r,"beforeFooter",this,e),a=qs(r,"footer",this,e),o=qs(r,"afterFooter",this,e);let l=[];return l=ho(l,ml(s)),l=ho(l,ml(a)),l=ho(l,ml(o)),l}_createItems(e){const t=this._active,r=this.chart.data,s=[],a=[],o=[];let l=[],c,d;for(c=0,d=t.length;c<d;++c)l.push(fle(this.chart,t[c]));return e.filter&&(l=l.filter((h,p,x)=>e.filter(h,p,x,r))),e.itemSort&&(l=l.sort((h,p)=>e.itemSort(h,p,r))),wn(l,h=>{const p=mL(e.callbacks,h);s.push(qs(p,"labelColor",this,h)),a.push(qs(p,"labelPointStyle",this,h)),o.push(qs(p,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const r=this.options.setContext(this.getContext()),s=this._active;let a,o=[];if(!s.length)this.opacity!==0&&(a={opacity:0});else{const l=Vh[r.position].call(this,s,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const c=this._size=dL(this,r),d=Object.assign({},l,c),h=uL(this.chart,r,d),p=fL(r,d,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,a={opacity:1,x:p.x,y:p.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,s){const a=this.getCaretPosition(e,r,s);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}getCaretPosition(e,t,r){const{xAlign:s,yAlign:a}=this,{caretSize:o,cornerRadius:l}=r,{topLeft:c,topRight:d,bottomLeft:h,bottomRight:p}=hf(l),{x,y:v}=e,{width:_,height:w}=t;let j,T,P,E,M,O;return a==="center"?(M=v+w/2,s==="left"?(j=x,T=j-o,E=M+o,O=M-o):(j=x+_,T=j+o,E=M-o,O=M+o),P=j):(s==="left"?T=x+Math.max(c,h)+o:s==="right"?T=x+_-Math.max(d,p)-o:T=this.caretX,a==="top"?(E=v,M=E-o,j=T-o,P=T+o):(E=v+w,M=E+o,j=T+o,P=T-o),O=E),{x1:j,x2:T,x3:P,y1:E,y2:M,y3:O}}drawTitle(e,t,r){const s=this.title,a=s.length;let o,l,c;if(a){const d=mf(r.rtl,this.x,this.width);for(e.x=Vg(this,r.titleAlign,r),t.textAlign=d.textAlign(r.titleAlign),t.textBaseline="middle",o=$s(r.titleFont),l=r.titleSpacing,t.fillStyle=r.titleColor,t.font=o.string,c=0;c<a;++c)t.fillText(s[c],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,c+1===a&&(e.y+=r.titleMarginBottom-l)}}_drawColorBox(e,t,r,s,a){const o=this.labelColors[r],l=this.labelPointStyles[r],{boxHeight:c,boxWidth:d}=a,h=$s(a.bodyFont),p=Vg(this,"left",a),x=s.x(p),v=c<h.lineHeight?(h.lineHeight-c)/2:0,_=t.y+v;if(a.usePointStyle){const w={radius:Math.min(d,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},j=s.leftForLtr(x,d)+d/2,T=_+c/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,zS(e,w,j,T),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,zS(e,w,j,T)}else{e.lineWidth=nn(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const w=s.leftForLtr(x,d),j=s.leftForLtr(s.xPlus(x,1),d-2),T=hf(o.borderRadius);Object.values(T).some(P=>P!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,Ax(e,{x:w,y:_,w:d,h:c,radius:T}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Ax(e,{x:j,y:_+1,w:d-2,h:c-2,radius:T}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(w,_,d,c),e.strokeRect(w,_,d,c),e.fillStyle=o.backgroundColor,e.fillRect(j,_+1,d-2,c-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:s}=this,{bodySpacing:a,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:d,boxPadding:h}=r,p=$s(r.bodyFont);let x=p.lineHeight,v=0;const _=mf(r.rtl,this.x,this.width),w=function(F){t.fillText(F,_.x(e.x+v),e.y+x/2),e.y+=x+a},j=_.textAlign(o);let T,P,E,M,O,I,q;for(t.textAlign=o,t.textBaseline="middle",t.font=p.string,e.x=Vg(this,j,r),t.fillStyle=r.bodyColor,wn(this.beforeBody,w),v=l&&j!=="right"?o==="center"?d/2+h:d+2+h:0,M=0,I=s.length;M<I;++M){for(T=s[M],P=this.labelTextColors[M],t.fillStyle=P,wn(T.before,w),E=T.lines,l&&E.length&&(this._drawColorBox(t,e,M,_,r),x=Math.max(p.lineHeight,c)),O=0,q=E.length;O<q;++O)w(E[O]),x=p.lineHeight;wn(T.after,w)}v=0,x=p.lineHeight,wn(this.afterBody,w),e.y-=a}drawFooter(e,t,r){const s=this.footer,a=s.length;let o,l;if(a){const c=mf(r.rtl,this.x,this.width);for(e.x=Vg(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=c.textAlign(r.footerAlign),t.textBaseline="middle",o=$s(r.footerFont),t.fillStyle=r.footerColor,t.font=o.string,l=0;l<a;++l)t.fillText(s[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,t,r,s){const{xAlign:a,yAlign:o}=this,{x:l,y:c}=e,{width:d,height:h}=r,{topLeft:p,topRight:x,bottomLeft:v,bottomRight:_}=hf(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(l+p,c),o==="top"&&this.drawCaret(e,t,r,s),t.lineTo(l+d-x,c),t.quadraticCurveTo(l+d,c,l+d,c+x),o==="center"&&a==="right"&&this.drawCaret(e,t,r,s),t.lineTo(l+d,c+h-_),t.quadraticCurveTo(l+d,c+h,l+d-_,c+h),o==="bottom"&&this.drawCaret(e,t,r,s),t.lineTo(l+v,c+h),t.quadraticCurveTo(l,c+h,l,c+h-v),o==="center"&&a==="left"&&this.drawCaret(e,t,r,s),t.lineTo(l,c+p),t.quadraticCurveTo(l,c,l+p,c),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,s=r&&r.x,a=r&&r.y;if(s||a){const o=Vh[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=dL(this,e),c=Object.assign({},o,this._size),d=uL(t,e,c),h=fL(e,c,d,t);(s._to!==h.x||a._to!==h.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},a={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=Oa(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=r,this.drawBackground(a,e,s,t),o6(e,t.textDirection),a.y+=o.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),l6(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,s=e.map(({datasetIndex:l,index:c})=>{const d=this.chart.getDatasetMeta(l);if(!d)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:d.data[c],index:c}}),a=!Dx(r,s),o=this._positionChanged(s,t);(a||o)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,a=this._active||[],o=this._getActiveElements(e,a,t,r),l=this._positionChanged(o,e),c=t||!Dx(o,a)||l;return c&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),c}_getActiveElements(e,t,r,s){const a=this.options;if(e.type==="mouseout")return[];if(!s)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,a.mode,a,r);return a.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:r,caretY:s,options:a}=this,o=Vh[a.position].call(this,e,t);return o!==!1&&(r!==o.x||s!==o.y)}}var vle={id:"tooltip",_element:pL,positioners:Vh,afterInit(n,e,t){t&&(n.tooltip=new pL({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:D6},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const ble=(n,e,t,r)=>(typeof e=="string"?(t=n.push(e)-1,r.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function _le(n,e,t,r){const s=n.indexOf(e);if(s===-1)return ble(n,e,t,r);const a=n.lastIndexOf(e);return s!==a?t:s}const wle=(n,e)=>n===null?null:as(Math.round(n),0,e);function gL(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class jle extends Bf{static id="category";static defaults={ticks:{callback:gL}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const r=this.getLabels();for(const{index:s,label:a}of t)r[s]===a&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(yn(e))return null;const r=this.getLabels();return t=isFinite(t)&&r[t]===e?t:_le(r,e,Gt(t,e),this._addedLabels),wle(t,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),t||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,s=[];let a=this.getLabels();a=e===0&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=t;o++)s.push({value:o});return s}getLabelForValue(e){return gL.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function Nle(n,e){const t=[],{bounds:s,step:a,min:o,max:l,precision:c,count:d,maxTicks:h,maxDigits:p,includeBounds:x}=n,v=a||1,_=h-1,{min:w,max:j}=e,T=!yn(o),P=!yn(l),E=!yn(d),M=(j-w)/(p+1);let O=fR((j-w)/_/v)*v,I,q,F,B;if(O<1e-14&&!T&&!P)return[{value:w},{value:j}];B=Math.ceil(j/O)-Math.floor(w/O),B>_&&(O=fR(B*O/_/v)*v),yn(c)||(I=Math.pow(10,c),O=Math.ceil(O*I)/I),s==="ticks"?(q=Math.floor(w/O)*O,F=Math.ceil(j/O)*O):(q=w,F=j),T&&P&&a&&wse((l-o)/a,O/1e3)?(B=Math.round(Math.min((l-o)/O,h)),O=(l-o)/B,q=o,F=l):E?(q=T?o:q,F=P?l:F,B=d-1,O=(F-q)/B):(B=(F-q)/O,Zh(B,Math.round(B),O/1e3)?B=Math.round(B):B=Math.ceil(B));const U=Math.max(hR(O),hR(q));I=Math.pow(10,yn(c)?U:c),q=Math.round(q*I)/I,F=Math.round(F*I)/I;let W=0;for(T&&(x&&q!==o?(t.push({value:o}),q<o&&W++,Zh(Math.round((q+W*O)*I)/I,o,xL(o,M,n))&&W++):q<o&&W++);W<B;++W){const $=Math.round((q+W*O)*I)/I;if(P&&$>l)break;t.push({value:$})}return P&&x&&F!==l?t.length&&Zh(t[t.length-1].value,l,xL(l,M,n))?t[t.length-1].value=l:t.push({value:l}):(!P||F===l)&&t.push({value:F}),t}function xL(n,e,{horizontal:t,minRotation:r}){const s=vl(r),a=(t?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+n).length;return Math.min(e/a,o)}class Sle extends Bf{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return yn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:s,max:a}=this;const o=c=>s=t?s:c,l=c=>a=r?a:c;if(e){const c=jo(s),d=jo(a);c<0&&d<0?l(0):c>0&&d>0&&o(0)}if(s===a){let c=a===0?1:Math.abs(a*.05);l(a+c),e||o(s-c)}this.min=s,this.max=a}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,s;return r?(s=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),t=t||11),t&&(s=Math.min(t,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const s={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},a=this._range||this,o=Nle(s,a);return e.bounds==="ticks"&&jse(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const s=(r-t)/Math.max(e.length-1,1)/2;t-=s,r+=s}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return i1(e,this.chart.options.locale,this.options.ticks.format)}}class Cle extends Sle{static id="linear";static defaults={ticks:{callback:X5.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=ls(e)?e:0,this.max=ls(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=vl(this.options.ticks.minRotation),s=(e?Math.sin(r):Math.cos(r))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const Py={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Vs=Object.keys(Py);function yL(n,e){return n-e}function vL(n,e){if(yn(e))return null;const t=n._adapter,{parser:r,round:s,isoWeekday:a}=n._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),ls(o)||(o=typeof r=="string"?t.parse(o,r):t.parse(o)),o===null?null:(s&&(o=s==="week"&&(ym(a)||a===!0)?t.startOf(o,"isoWeek",a):t.startOf(o,s)),+o)}function bL(n,e,t,r){const s=Vs.length;for(let a=Vs.indexOf(n);a<s-1;++a){const o=Py[Vs[a]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=r)return Vs[a]}return Vs[s-1]}function Tle(n,e,t,r,s){for(let a=Vs.length-1;a>=Vs.indexOf(t);a--){const o=Vs[a];if(Py[o].common&&n._adapter.diff(s,r,o)>=e-1)return o}return Vs[t?Vs.indexOf(t):0]}function kle(n){for(let e=Vs.indexOf(n)+1,t=Vs.length;e<t;++e)if(Py[Vs[e]].common)return Vs[e]}function _L(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:r,hi:s}=r1(t,e),a=t[r]>=e?t[r]:t[s];n[a]=!0}}function Ple(n,e,t,r){const s=n._adapter,a=+s.startOf(e[0].value,r),o=e[e.length-1].value;let l,c;for(l=a;l<=o;l=+s.add(l,1,r))c=t[l],c>=0&&(e[c].major=!0);return e}function wL(n,e,t){const r=[],s={},a=e.length;let o,l;for(o=0;o<a;++o)l=e[o],s[l]=o,r.push({value:l,major:!1});return a===0||!t?r:Ple(n,r,s,t)}class jL extends Bf{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),s=this._adapter=new lae._date(e.adapters.date);s.init(t),Gh(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:vL(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:s,max:a,minDefined:o,maxDefined:l}=this.getUserBounds();function c(d){!o&&!isNaN(d.min)&&(s=Math.min(s,d.min)),!l&&!isNaN(d.max)&&(a=Math.max(a,d.max))}(!o||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),s=ls(s)&&!isNaN(s)?s:+t.startOf(Date.now(),r),a=ls(a)&&!isNaN(a)?a:+t.endOf(Date.now(),r)+1,this.min=Math.min(s,a-1),this.max=Math.max(s+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,s=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const a=this.min,o=this.max,l=kse(s,a,o);return this._unit=t.unit||(r.autoSkip?bL(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):Tle(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:kle(this._unit),this.initOffsets(s),e.reverse&&l.reverse(),wL(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,s,a;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?r=a:r=(a-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=as(t,0,o),r=as(r,0,o),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,s=this.options,a=s.time,o=a.unit||bL(a.minUnit,t,r,this._getLabelCapacity(t)),l=Gt(s.ticks.stepSize,1),c=o==="week"?a.isoWeekday:!1,d=ym(c)||c===!0,h={};let p=t,x,v;if(d&&(p=+e.startOf(p,"isoWeek",c)),p=+e.startOf(p,d?"day":o),e.diff(r,t,o)>1e5*l)throw new Error(t+" and "+r+" are too far apart with stepSize of "+l+" "+o);const _=s.ticks.source==="data"&&this.getDataTimestamps();for(x=p,v=0;x<r;x=+e.add(x,l,o),v++)_L(h,x,_);return(x===r||s.bounds==="ticks"||v===1)&&_L(h,x,_),Object.keys(h).sort(yL).map(w=>+w)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,a=this._unit,o=t||s[a];return this._adapter.format(e,o)}_tickFormatFunction(e,t,r,s){const a=this.options,o=a.ticks.callback;if(o)return qn(o,[e,t,r],this);const l=a.time.displayFormats,c=this._unit,d=this._majorUnit,h=c&&l[c],p=d&&l[d],x=r[t],v=d&&p&&x&&x.major;return this._adapter.format(e,s||(v?p:h))}generateTickLabels(e){let t,r,s;for(t=0,r=e.length;t<r;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,s=vl(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(s),o=Math.sin(s),l=this._resolveTickFontOptions(0).size;return{w:r*a+l*o,h:r*o+l*a}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,s=r[t.unit]||r.millisecond,a=this._tickFormatFunction(e,0,wL(this,[e],this._majorUnit),s),o=this._getLabelSize(a),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,r=s.length;t<r;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const s=this.getLabels();for(t=0,r=s.length;t<r;++t)e.push(vL(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Z5(e.sort(yL))}}function Bg(n,e,t){let r=0,s=n.length-1,a,o,l,c;t?(e>=n[r].pos&&e<=n[s].pos&&({lo:r,hi:s}=nu(n,"pos",e)),{pos:a,time:l}=n[r],{pos:o,time:c}=n[s]):(e>=n[r].time&&e<=n[s].time&&({lo:r,hi:s}=nu(n,"time",e)),{time:a,pos:l}=n[r],{time:o,pos:c}=n[s]);const d=o-a;return d?l+(c-l)*(e-a)/d:l}class ahe extends jL{static id="timeseries";static defaults=jL.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Bg(t,this.min),this._tableRange=Bg(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,s=[],a=[];let o,l,c,d,h;for(o=0,l=e.length;o<l;++o)d=e[o],d>=t&&d<=r&&s.push(d);if(s.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(o=0,l=s.length;o<l;++o)h=s[o+1],c=s[o-1],d=s[o],Math.round((h+c)/2)!==d&&a.push({time:d,pos:o/(l-1)});return a}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(t)||r.length===1)&&r.push(t),r.sort((s,a)=>s-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Bg(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return Bg(this._table,r*this._tableRange+this._minPos,!0)}}Cy.register(sae,qoe,jle,Cle,oae,Ty,Ooe,aae,joe,vle,ule,ile);const NL=({title:n,icon:e,children:t})=>i.jsxs("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card col-span-1",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(e,{className:"h-5 w-5 mr-3 text-muted"}),i.jsx("h3",{className:"font-semibold text-primary-text",children:n})]}),i.jsx("div",{className:"h-64 md:h-80 relative",children:t})]}),Mle=({data:n})=>{const e=D.useRef(null),t=D.useRef(null);return D.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const r=e.current.getContext("2d");r&&(t.current=new Cy(r,{type:"bar",data:{labels:n.labels,datasets:[{label:"Present",data:n.present,backgroundColor:"#005D22",borderColor:"#004218",borderWidth:1,borderRadius:4},{label:"Absent",data:n.absent,backgroundColor:"#EF4444",borderColor:"#DC2626",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}}))}return()=>{t.current&&t.current.destroy()}},[n]),i.jsx("div",{className:"h-full w-full flex flex-col",children:i.jsx("div",{className:"flex-grow relative",children:i.jsx("canvas",{ref:e})})})},Dle=({data:n})=>{const e=D.useRef(null),t=D.useRef(null);return D.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const r=e.current.getContext("2d");if(r){const s=r.createLinearGradient(0,0,0,200);s.addColorStop(0,"rgba(0, 93, 34, 0.4)"),s.addColorStop(1,"rgba(0, 93, 34, 0)"),t.current=new Cy(r,{type:"line",data:{labels:n.labels,datasets:[{label:"Average Hours Worked",data:n.hours,borderColor:"#005D22",backgroundColor:s,fill:!0,tension:.4,pointBackgroundColor:"#005D22",pointRadius:0,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"},ticks:{stepSize:1,precision:0,callback:a=>{const o=typeof a=="string"?parseFloat(a):a;return Math.round(o)}}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}})}}return()=>{t.current&&t.current.destroy()}},[n]),i.jsx("div",{className:"h-full w-full flex flex-col",children:i.jsx("div",{className:"flex-grow relative",children:i.jsx("canvas",{ref:e})})})},Ele=({data:n,dateRange:e})=>i.jsxs("div",{className:"p-8 font-sans text-sm text-black bg-white",children:[i.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-6",children:[i.jsx(Gi,{className:"h-10",localPath:NC}),i.jsxs("div",{className:"text-right",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Attendance Log"}),i.jsxs("p",{className:"text-gray-600",children:[$e(e.startDate,"dd MMM yyyy")," to ",$e(e.endDate,"dd MMM yyyy")]})]})]}),i.jsxs("table",{className:"w-full mt-6 text-left border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"p-2 border border-gray-300",children:"User"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Date"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Time"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Event"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Location"})]})}),i.jsx("tbody",{children:n.map((t,r)=>i.jsxs("tr",{className:"border-b",children:[i.jsx("td",{className:"p-2 border border-gray-300",children:t.userName}),i.jsx("td",{className:"p-2 border border-gray-300",children:t.date}),i.jsx("td",{className:"p-2 border border-gray-300",children:t.time}),i.jsx("td",{className:"p-2 border border-gray-300 capitalize",children:t.type.replace("-"," ")}),i.jsx("td",{className:"p-2 border border-gray-300",children:t.locationName||(t.latitude?`${t.latitude?.toFixed(4)}, ${t.longitude?.toFixed(4)}`:"N/A")})]},`${t.userName}-${t.date}-${t.time}-${r}`))})]})]}),Ole=({data:n,dateRange:e})=>{const r=[];for(let s=0;s<n.length;s+=15)r.push(n.slice(s,s+15));return r.length===0?null:i.jsx("div",{children:r.map((s,a)=>{const o=15-s.length,l=a===r.length-1;return i.jsxs("div",{style:{padding:a===0?"40px":"0px 40px 40px 40px",paddingTop:a===0?"40px":"0px",marginTop:a===0?"0px":"-40px",fontFamily:'"Courier New", Courier, monospace',fontSize:"14px",color:"#000",backgroundColor:"#fff",width:"1123px",height:"794px",boxSizing:"border-box",letterSpacing:"0.5px",pageBreakAfter:l?"auto":"always",position:"relative",display:"flex",flexDirection:"column"},children:[i.jsx("table",{style:{width:"100%",borderBottom:"2px solid #000",marginBottom:"16px",paddingBottom:"8px"},children:i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{style:{width:"50%",verticalAlign:"top",textAlign:"left"},children:i.jsx(Gi,{className:"h-14",localPath:NC})}),i.jsxs("td",{style:{width:"50%",verticalAlign:"top",textAlign:"right"},children:[i.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"1px"},children:"Basic Attendance Report"}),i.jsxs("div",{style:{fontSize:"12px",color:"#333",marginBottom:"4px"},children:[$e(e.startDate,"dd MMM yyyy")," -"," ",$e(e.endDate,"dd MMM yyyy")]}),i.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["Generated: ",$e(new Date,"dd MMM yyyy HH:mm")]})]})]})})}),i.jsx("div",{style:{flexGrow:1},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #000",tableLayout:"fixed"},children:[i.jsx("thead",{style:{display:"table-header-group"},children:i.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"28%",fontSize:"11px",fontWeight:"bold"},children:"Employee Name"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Date"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Status"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check In"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check Out"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"15%",fontSize:"11px",fontWeight:"bold"},children:"Hours"})]})}),i.jsxs("tbody",{children:[s.map((c,d)=>i.jsxs("tr",{style:{backgroundColor:d%2===0?"#fff":"#fafafa"},children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle",wordWrap:"break-word",whiteSpace:"normal",lineHeight:"1.4"},children:c.userName}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:$e(new Date(String(c.date).replace(/-/g,"/")),"dd MMM yyyy")}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.status}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.checkIn||"-"}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.checkOut||"-"}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.duration||"-"})]},`${c.userName}-${c.date}-${d}`)),Array.from({length:o}).map((c,d)=>i.jsxs("tr",{style:{backgroundColor:"#fff"},children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",height:"33px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""})]},`empty-${d}`))]})]})}),i.jsxs("div",{style:{marginTop:"10px",borderTop:"1px solid #ccc",paddingTop:"8px",textAlign:"center",fontSize:"10px",color:"#888"},children:["Paradigm Services - Confidential Report - Page ",a+1," of ",r.length]})]},a)})})},Ile=({data:n,dateRange:e})=>{const t=go({start:e.startDate,end:e.endDate});return i.jsxs("div",{className:"p-8 font-sans text-[9px] text-black bg-white",children:[i.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-4",children:[i.jsx(Gi,{className:"h-8",localPath:NC}),i.jsxs("div",{className:"text-right",children:[i.jsx("h1",{className:"text-lg font-bold",children:"Monthly Attendance Report"}),i.jsxs("p",{className:"text-gray-600",children:[$e(e.startDate,"dd MMM yyyy")," to ",$e(e.endDate,"dd MMM yyyy")]})]})]}),i.jsxs("table",{className:"w-full border-collapse border border-gray-400 text-center",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-200 font-bold",children:[i.jsx("td",{className:"border p-1 border-gray-400 text-left",children:"Employee Name"}),t.map((r,s)=>i.jsx("td",{className:"border p-1 border-gray-400",children:$e(r,"d")},s)),i.jsx("td",{className:"border p-1 border-gray-400",children:"P"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"1/2P"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"A"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"WO"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"H"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"WOP"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"HP"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"Total"})]})}),i.jsx("tbody",{children:n.map((r,s)=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1 border-gray-400 text-left",children:r.userName}),r.statuses.map((a,o)=>i.jsx("td",{className:"border p-1 border-gray-400",children:a},o)),i.jsx("td",{className:"border p-1 border-gray-400",children:r.presentDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.halfDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.absentDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.weekOffs}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.holidays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.weekendPresents}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.holidayPresents}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.totalPayableDays})]},s))})]})]})},Ale=()=>{const n=Ft("(max-width: 639px)"),{user:e}=jt(),{permissions:t}=Ki(),{recurringHolidays:r}=pi(),[s,a]=D.useState([]),[o,l]=D.useState([]),[c,d]=D.useState(null),[h,p]=D.useState(!0),[x,v]=D.useState({startDate:Jg(),endDate:tb(),key:"selection"}),_=D.useMemo(()=>[x],[x]),[w,j]=D.useState("Today"),[T,P]=D.useState(!1),E=D.useRef(null),[M,O]=D.useState("all"),[I,q]=D.useState("all"),[F,B]=D.useState("all"),[U,W]=D.useState("basic"),[$,se]=D.useState(!1),[Y,ae]=D.useState(null),[J,ee]=D.useState({}),X=D.useRef(null),Z=e&&t[e.role]?.includes("download_attendance_report"),H=!(e&&t[e.role]?.includes("view_all_attendance")),[Q,ne]=D.useState({present:0,absent:0,ot:0,compOff:0}),[de,ce]=D.useState([]);D.useEffect(()=>{const _e=Ne=>{E.current&&!E.current.contains(Ne.target)&&P(!1)};return document.addEventListener("mousedown",_e),()=>document.removeEventListener("mousedown",_e)},[]),D.useEffect(()=>{Z&&ue.getUsers().then(a)},[Z]),D.useEffect(()=>{(async()=>{if(!(!H||!e||!x.startDate||!x.endDate)){p(!0);try{const Ne=uf(x.startDate,7),Ue=Ne.toISOString(),Be=x.endDate.toISOString(),[qe,te]=await Promise.all([ue.getAttendanceEvents(e.id,Ue,Be),ue.getCompOffLogs(e.id)]);let ye=go({start:Ne,end:x.endDate}).map(tt=>{const qt=$e(tt,"yyyy-MM-dd"),bt=qe.filter(an=>$e(new Date(an.timestamp),"yyyy-MM-dd")===qt);let Dt="Absent",Xt="-",en="-",Yt=0;const Ut=$e(tt,"EEEE"),Rn=Ut==="Sunday";if(r.some(an=>{if(an.day.toLowerCase()!==Ut.toLowerCase())return!1;const rr=Math.ceil(tt.getDate()/7),Hn=e.role==="field_officer"?"field":"office";return an.n===rr&&(an.type||"office")===Hn})?Dt="Holiday":Rn&&(Dt="Weekend"),bt.length>0){Dt="Present",bt.sort((Hn,lt)=>new Date(Hn.timestamp).getTime()-new Date(lt.timestamp).getTime());const an=bt.find(Hn=>Hn.type==="check-in"),rr=[...bt].reverse().find(Hn=>Hn.type==="check-out");if(an&&(Xt=$e(new Date(an.timestamp),"hh:mm a")),rr&&(en=$e(new Date(rr.timestamp),"hh:mm a"),an)){const lt=df(new Date(rr.timestamp),new Date(an.timestamp))/60;lt>8&&(Yt=Math.round((lt-8)*10)/10)}}return{rawDate:tt,date:$e(tt,"dd MMM, yyyy"),day:Ut,checkIn:Xt,checkOut:en,status:Dt,ot:Yt}});ye.forEach((tt,qt)=>{if(tt.status==="Weekend"&&tt.day==="Sunday"){let bt=0;const Dt=Math.max(0,qt-6);for(let Xt=qt-1;Xt>=Dt;Xt--)ye[Xt].status==="Absent"&&bt++;bt>=4&&(tt.status="Absent")}});const Ve=ye.filter(tt=>tt.rawDate>=x.startDate),ze=Ve.filter(tt=>tt.status==="Present").length,Le=Ve.filter(tt=>tt.status==="Absent"&&tt.rawDate<=new Date).length,rt=Ve.reduce((tt,qt)=>tt+qt.ot,0),Xe=te.filter(tt=>{const qt=new Date(tt.dateEarned);return qt>=x.startDate&&qt<=x.endDate&&tt.status==="earned"}).length;ne({present:ze,absent:Le,ot:Math.round(rt*10)/10,compOff:Xe}),ce(Ve.reverse())}catch(Ne){console.error("Failed to fetch employee attendance",Ne)}finally{p(!1)}}})()},[H,e,x,r]);const pe=D.useCallback(async(_e,Ne)=>{p(!0);try{let Ue=s;Ue.length===0&&(Ue=await ue.getUsers(),a(Ue));const Be=new Date,qe=_e<Be?_e:Jg(),te=Ne>Be?Ne:tb(),[le,ye]=await Promise.all([ue.getAllAttendanceEvents(qe.toISOString(),te.toISOString()),ue.getLeaveRequests({startDate:qe.toISOString(),endDate:te.toISOString(),status:"approved"})]);l(le);const Ve=$e(Be,"yyyy-MM-dd"),ze=le.filter(Ut=>$e(new Date(Ut.timestamp),"yyyy-MM-dd")===Ve),Le=new Set(ze.map(Ut=>Ut.userId)).size,rt=ye.filter(Ut=>{const Rn=new Date(Ut.startDate),Nn=new Date(Ut.endDate);return Be>=Rn&&Be<=Nn}),Xe=new Set(rt.map(Ut=>Ut.userId)).size,tt=Ue.length,qt=Math.max(0,tt-Le-Xe),bt=go({start:_e,end:Ne}),Dt=bt.map(Ut=>$e(Ut,"dd MMM")),Xt=[],en=[],Yt=[];bt.forEach(Ut=>{const Rn=$e(Ut,"yyyy-MM-dd"),Nn=le.filter(vn=>$e(new Date(vn.timestamp),"yyyy-MM-dd")===Rn),an=new Set(Nn.map(vn=>vn.userId)).size,rr=ye.filter(vn=>{const ds=new Date(vn.startDate),Zs=new Date(vn.endDate);return Ut>=ds&&Ut<=Zs}),Hn=new Set(rr.map(vn=>vn.userId)).size,lt=Math.max(0,tt-an-Hn);Xt.push(an),en.push(lt);let Vn=0;const br={};Nn.forEach(vn=>{br[vn.userId]||(br[vn.userId]=[]),br[vn.userId].push(vn)}),Object.values(br).forEach(vn=>{vn.sort((Yr,Qi)=>new Date(Yr.timestamp).getTime()-new Date(Qi.timestamp).getTime());const ds=vn.find(Yr=>Yr.type==="check-in"),Zs=[...vn].reverse().find(Yr=>Yr.type==="check-out");if(ds&&Zs){const Yr=df(new Date(Zs.timestamp),new Date(ds.timestamp));Vn+=Yr/60}}),Yt.push(an>0?parseFloat((Vn/an).toFixed(1)):0)}),d({totalEmployees:tt,presentToday:Le,absentToday:qt,onLeaveToday:Xe,attendanceTrend:{labels:Dt,present:Xt,absent:en},productivityTrend:{labels:Dt,hours:Yt}})}catch(Ue){console.error("Failed to load dashboard data",Ue)}finally{p(!1)}},[s]);D.useEffect(()=>{x.startDate&&x.endDate&&pe(x.startDate,x.endDate)},[x,pe]),D.useEffect(()=>{if(U!=="log"||!x.startDate||!x.endDate)return;const _e=Ue=>parseFloat(Ue.toFixed(6));(async()=>{const Ue=M==="all"?s:s.filter(le=>le.id===M),Be=new Set(Ue.map(le=>le.id)),qe=o.filter(le=>{if(!Be.has(le.userId)||new Date(le.timestamp)<x.startDate||new Date(le.timestamp)>x.endDate||le.locationName||!le.latitude||!le.longitude)return!1;const ye=`${_e(le.latitude)},${_e(le.longitude)}`;return!J[ye]});if(console.log("Geocoding: Events to process:",qe.length),qe.length===0)return;const te=qe.map(le=>({lat:le.latitude,lon:le.longitude}));console.log("Geocoding: Fetching addresses for",te.length,"unique coordinates");try{const le=await ue.batchResolveAddresses(te);console.log("Geocoding: Resolved addresses:",Object.keys(le).length),ee(ye=>({...ye,...le}))}catch(le){console.error("Batch geocoding failed:",le)}})()},[o,x,M,U,s]);const ie=_e=>{j(_e);const Ne=new Date;let Ue=Jg(),Be=tb();_e==="This Month"?(Ue=mi(Ne),Be=Ca(Ne)):_e==="This Year"?(Ue=eF(Ne),Be=RB(Ne)):_e==="Last 7 Days"?Ue=uf(Ne,6):_e==="Last 30 Days"&&(Ue=uf(Ne,29)),Be>Ne&&(Be=Ne),v({startDate:Ue,endDate:Be,key:"selection"})},xe=_e=>{v(_e.selection),j("Custom"),P(!1)},Ce=D.useMemo(()=>{const _e=x.endDate,Ne=new Date;return $e(_e,"yyyy-MM-dd")===$e(Ne,"yyyy-MM-dd")?"Today":`on ${$e(_e,"MMM d")}`},[x]),ve=D.useMemo(()=>{if(!x.startDate||!x.endDate)return[];const _e=[],Ne=go({start:x.startDate,end:x.endDate});(M==="all"?s:s.filter(qe=>qe.id===M)).forEach(qe=>{Ne.forEach(te=>{const le=$e(te,"yyyy-MM-dd"),ye=o.filter(bt=>bt.userId===qe.id&&$e(new Date(bt.timestamp),"yyyy-MM-dd")===le);let Ve="Absent",ze="",Le="",rt="";const Xe=$e(te,"EEEE"),tt=Xe==="Sunday";if(r.some(bt=>{if(bt.day.toLowerCase()!==Xe.toLowerCase())return!1;const Dt=te.getDate(),Xt=Math.ceil(Dt/7),en=qe.role==="field_staff"?"field":"office",Yt=bt.type||"office";return bt.n===Xt&&Yt===en})?Ve="Holiday":tt&&(Ve="Weekend"),ye.length>0){const bt=[...ye].sort((en,Yt)=>new Date(en.timestamp).getTime()-new Date(Yt.timestamp).getTime()),Dt=bt.find(en=>en.type==="check-in"),Xt=[...bt].reverse().find(en=>en.type==="check-out");if(Dt&&(Ve="Present",ze=$e(new Date(Dt.timestamp),"HH:mm")),Xt&&(Le=$e(new Date(Xt.timestamp),"HH:mm")),Dt&&Xt){const en=new Date(Dt.timestamp),Yt=new Date(Xt.timestamp),Ut=df(Yt,en),Rn=Math.floor(Ut/60),Nn=Ut%60;rt=`${Rn}h ${Nn}m`}}_e.push({userName:qe.name,date:le,status:Ve,checkIn:ze,checkOut:Le,duration:rt})})});let Be=I==="all"?_e:_e.filter(qe=>qe.status===I);return F!=="all"&&(Be=Be.filter(qe=>{const te=qe.checkIn&&qe.checkIn!=="-"&&qe.checkIn!=="",le=qe.checkOut&&qe.checkOut!=="-"&&qe.checkOut!=="";switch(F){case"complete":return te&&le;case"missing_checkout":return te&&!le;case"missing_checkin":return!te&&le;case"incomplete":return!te||!le;default:return!0}})),Be},[s,o,x,M,I,F,r]),Oe=D.useMemo(()=>{if(!x.startDate||!x.endDate)return[];const _e=Be=>parseFloat(Be.toFixed(6)),Ne=M==="all"?s:s.filter(Be=>Be.id===M),Ue=new Set(Ne.map(Be=>Be.id));return o.filter(Be=>Ue.has(Be.userId)).map(Be=>{const qe=s.find(ye=>ye.id===Be.userId),te=Be.latitude&&Be.longitude?`${_e(Be.latitude)},${_e(Be.longitude)}`:"",le=J[te];return{userName:qe?.name||"Unknown",date:$e(new Date(Be.timestamp),"yyyy-MM-dd"),time:$e(new Date(Be.timestamp),"HH:mm:ss"),type:Be.type,locationName:Be.locationName||le||(Be.latitude?`${Be.latitude.toFixed(4)}, ${Be.longitude.toFixed(4)}`:"N/A"),latitude:Be.latitude,longitude:Be.longitude}}).sort((Be,qe)=>Be.date!==qe.date?Be.date.localeCompare(qe.date):Be.time.localeCompare(qe.time))},[s,o,x,M,J]),Pe=D.useMemo(()=>{if(!x.startDate||!x.endDate)return[];const _e=go({start:x.startDate,end:x.endDate});return(M==="all"?s:s.filter(Ue=>Ue.id===M)).map(Ue=>{const Be=[];let qe=0,te=0,le=0,ye=0,Ve=0,ze=0,Le=0;_e.forEach(Xe=>{const tt=$e(Xe,"yyyy-MM-dd"),bt=o.filter(Ut=>Ut.userId===Ue.id&&$e(new Date(Ut.timestamp),"yyyy-MM-dd")===tt).some(Ut=>Ut.type==="check-in"),Dt=$e(Xe,"EEEE"),Xt=Dt==="Sunday",en=r.some(Ut=>{if(Ut.day.toLowerCase()!==Dt.toLowerCase())return!1;const Rn=Xe.getDate(),Nn=Math.ceil(Rn/7),an=Ue.role==="field_staff"?"field":"office",rr=Ut.type||"office";return Ut.n===Nn&&rr===an});let Yt="";bt?en?(Yt="HP",Le++):Xt?(Yt="WOP",ze++):(Yt="P",qe++):en?(Yt="H",Ve++):Xt?(Yt="WO",ye++):(Yt="A",te++),Be.push(Yt)});const rt=qe+ye+Ve+ze+Le+le*.5;return{userName:Ue.name,statuses:Be,presentDays:qe,absentDays:te,halfDays:le,weekOffs:ye,holidays:Ve,weekendPresents:ze,holidayPresents:Le,totalPayableDays:rt}})},[s,o,x,M,r]),Ie=D.useMemo(()=>U==="basic"?i.jsx(Ole,{data:ve,dateRange:x}):U==="log"?i.jsx(Ele,{data:Oe,dateRange:x}):U==="monthly"?i.jsx(Ile,{data:Pe,dateRange:x}):null,[U,ve,Oe,Pe,x]),Fe=()=>{se(!0);try{let _e="data:text/csv;charset=utf-8,",Ne=`Attendance_Report_${$e(new Date,"yyyy-MM-dd")}.csv`;if(U==="basic")_e+=`Employee Name,Date,Status,Check In,Check Out,Hours
`,ve.forEach(qe=>{_e+=`"${qe.userName}","${qe.date}","${qe.status}","${qe.checkIn}","${qe.checkOut}","${qe.duration}"
`});else if(U==="log")_e+=`User,Date,Time,Event,Location,Latitude,Longitude
`,Oe.forEach(qe=>{_e+=`"${qe.userName}","${qe.date}","${qe.time}","${qe.type}","${qe.locationName||""}","${qe.latitude||""}","${qe.longitude||""}"
`});else if(U==="monthly"){const te=go({start:x.startDate,end:x.endDate}).map(le=>$e(le,"dd MMM")).join(",");_e+=`Employee Name,${te},Present,Absent,Half Days,Week Offs,Holidays,Weekend Presents,Holiday Presents,Total Payable Days
`,Pe.forEach(le=>{const ye=le.statuses.join(",");_e+=`"${le.userName}",${ye},"${le.presentDays}","${le.absentDays}","${le.halfDays}","${le.weekOffs}","${le.holidays}","${le.weekendPresents}","${le.holidayPresents}","${le.totalPayableDays}"
`})}const Ue=encodeURI(_e),Be=document.createElement("a");Be.setAttribute("href",Ue),Be.setAttribute("download",Ne),document.body.appendChild(Be),Be.click(),document.body.removeChild(Be),ae({message:"CSV downloaded successfully.",type:"success"})}catch(_e){console.error("CSV generation failed:",_e),ae({message:"Failed to generate CSV.",type:"error"})}finally{se(!1)}};return h&&!c&&!H?i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):H?i.jsxs("div",{className:"p-4 space-y-6 pb-24 md:bg-transparent bg-[#041b0f]",children:[i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Attendance"}),i.jsxs("div",{className:"bg-card p-3 rounded-xl shadow-sm border border-border flex flex-wrap items-center gap-2",children:[["Today","This Month","Last 30 Days"].map(_e=>i.jsx(re,{type:"button",variant:w===_e?"primary":"outline",onClick:()=>ie(_e),className:w===_e?"text-white shadow-md border":"bg-card text-primary-text border border-border hover:bg-accent-light",style:w===_e?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},children:_e},_e)),i.jsxs("div",{className:"relative",ref:E,children:[i.jsxs(re,{type:"button",variant:w==="Custom"?"primary":"outline",onClick:()=>P(!T),className:w==="Custom"?"text-white shadow-md border":"bg-card text-primary-text border border-border hover:bg-accent-light",style:w==="Custom"?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},children:[i.jsx(ka,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:w==="Custom"?`${$e(x.startDate,"dd MMM")} - ${$e(x.endDate,"dd MMM")}`:"Custom"})]}),T&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-50 bg-white dark:bg-gray-950 border border-border rounded-lg shadow-xl w-[300px] sm:w-auto overflow-hidden",children:i.jsx("div",{className:"text-gray-900",children:i.jsx(hm.DateRangePicker,{onChange:xe,months:1,ranges:_,direction:"horizontal",maxDate:new Date})})})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-emerald-600 text-white rounded-full mb-3 shadow-lg shadow-emerald-200 dark:shadow-none",children:i.jsx(uu,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Present"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:Q.present})]}),i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-rose-600 text-white rounded-full mb-3 shadow-lg shadow-rose-200 dark:shadow-none",children:i.jsx(Sx,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Absent"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:Q.absent})]}),i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-blue-600 text-white rounded-full mb-3 shadow-lg shadow-blue-200 dark:shadow-none",children:i.jsx(Vc,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Overtime"}),i.jsxs("p",{className:"text-2xl font-bold text-primary-text",children:[Q.ot,"h"]})]}),i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-purple-600 text-white rounded-full mb-3 shadow-lg shadow-purple-200 dark:shadow-none",children:i.jsx(OM,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Comp Offs"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:Q.compOff})]})]}),i.jsxs("div",{className:"bg-card rounded-xl shadow-sm border border-border overflow-hidden",children:[i.jsx("div",{className:"p-4 border-b border-border font-semibold text-primary-text",children:"Attendance Logs"}),i.jsx("div",{className:"divide-y divide-border",children:h?i.jsx("div",{className:"p-8 text-center text-muted",children:i.jsx(wt,{className:"h-6 w-6 animate-spin mx-auto"})}):de.length===0?i.jsx("div",{className:"p-8 text-center text-muted",children:"No records found for this period."}):de.map((_e,Ne)=>i.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-900/50 transition-colors",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-primary-text",children:_e.date}),i.jsx("p",{className:"text-xs text-muted",children:_e.day})]}),i.jsxs("div",{className:"flex flex-col items-end gap-1.5",children:[i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider shadow-sm
                                            ${_e.status==="Present"?"bg-emerald-500 text-white dark:bg-emerald-600":_e.status==="Absent"?"bg-rose-500 text-white dark:bg-rose-600":_e.status==="Holiday"?"bg-amber-500 text-white dark:bg-amber-600":_e.status==="Weekend"?"bg-indigo-500 text-white dark:bg-indigo-600":"bg-gray-500 text-white dark:bg-gray-600"}`,children:_e.status}),(_e.checkIn!=="-"||_e.checkOut!=="-")&&i.jsxs("div",{className:"text-xs text-muted font-medium",children:[_e.checkIn," - ",_e.checkOut]}),_e.ot>0&&i.jsxs("span",{className:"text-[10px] text-blue-600 dark:text-blue-400 font-bold",children:["+",_e.ot,"h OT"]})]})]},Ne))})]})]}):i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Attendance Dashboard"})}),i.jsxs("div",{className:"hidden md:flex bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex-wrap items-end gap-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Today","Last 7 Days","This Month"].map(_e=>i.jsx(re,{type:"button",onClick:()=>ie(_e),className:w===_e?"text-white shadow-md border":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50",style:w===_e?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},children:_e},_e)),i.jsxs("div",{className:"relative",ref:E,children:[i.jsxs(re,{type:"button",variant:"outline",onClick:()=>P(!T),className:"hover:bg-gray-100",children:[i.jsx(ka,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:w==="Custom"?`${$e(x.startDate,"dd MMM, yyyy")} - ${$e(x.endDate,"dd MMM, yyyy")}`:"Custom Range"})]}),T&&i.jsxs("div",{className:"absolute top-full left-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 p-3",children:[i.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:$e(x.startDate,"yyyy-MM-dd"),max:$e(new Date,"yyyy-MM-dd"),onChange:_e=>{const Ne=new Date(_e.target.value);let Ue=x.endDate;Ne>Ue&&(Ue=Ne),v({startDate:Ne,endDate:Ue,key:"selection"}),j("Custom")}}),i.jsx("span",{className:"text-sm",children:"to"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:$e(x.endDate,"yyyy-MM-dd"),max:$e(new Date,"yyyy-MM-dd"),onChange:_e=>{const Ne=new Date(_e.target.value);let Ue=x.startDate;Ne<Ue&&(Ue=Ne),v({startDate:Ue,endDate:Ne,key:"selection"}),j("Custom")}})]}),i.jsx(hm.DateRangePicker,{onChange:xe,months:n?1:2,ranges:_,direction:"horizontal",maxDate:new Date})]})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Report Type"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none",value:U,onChange:_e=>W(_e.target.value),children:[i.jsx("option",{value:"basic",children:"Basic Report"}),i.jsx("option",{value:"log",children:"Attendance Log"}),i.jsx("option",{value:"monthly",children:"Monthly Report"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Employee"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none max-w-[200px]",value:M,onChange:_e=>O(_e.target.value),children:[i.jsx("option",{value:"all",children:"All Employees"}),s.map(_e=>i.jsx("option",{value:_e.id,children:_e.name},_e.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Status"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none max-w-[200px]",value:I,onChange:_e=>q(_e.target.value),children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"Present",children:"Present"}),i.jsx("option",{value:"Half Day",children:"Half Day"}),i.jsx("option",{value:"Absent",children:"Absent"}),i.jsx("option",{value:"On Leave (Full)",children:"On Leave (Full)"}),i.jsx("option",{value:"On Leave (Half)",children:"On Leave (Half)"}),i.jsx("option",{value:"Holiday",children:"Holiday"}),i.jsx("option",{value:"Weekend",children:"Weekend"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Record Type"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none max-w-[200px]",value:F,onChange:_e=>B(_e.target.value),children:[i.jsx("option",{value:"all",children:"All Records"}),i.jsx("option",{value:"complete",children:"Complete (Check-in & Check-out)"}),i.jsx("option",{value:"missing_checkout",children:"Missing Check-out"}),i.jsx("option",{value:"missing_checkin",children:"Missing Check-in"}),i.jsx("option",{value:"incomplete",children:"Incomplete (Any Missing)"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(_o,{title:"Total Employees",value:c?.totalEmployees||0,icon:Yi}),i.jsx(_o,{title:`Present ${Ce}`,value:c?.presentToday||0,icon:uu}),i.jsx(_o,{title:`Absent ${Ce}`,value:c?.absentToday||0,icon:Sx}),i.jsx(_o,{title:`On Leave ${Ce}`,value:c?.onLeaveToday||0,icon:Vc})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx(NL,{title:"Attendance Trend",icon:LK,children:c?i.jsx(Mle,{data:c.attendanceTrend}):i.jsx(wt,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})}),i.jsx(NL,{title:"Productivity Trend (Avg. Hours)",icon:OM,children:c?i.jsx(Dle,{data:c.productivityTrend}):i.jsx(wt,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})})]}),i.jsx("div",{style:{position:"fixed",top:"0",left:"0",width:"1123px",zIndex:-1e3,opacity:0,pointerEvents:"none"},children:i.jsx("div",{ref:X,className:"w-full bg-white",children:Ie})}),i.jsxs("div",{className:"hidden md:block bg-white p-6 rounded-xl shadow-sm border border-gray-100 overflow-auto max-h-[600px]",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold",children:"Report Preview"}),Z&&i.jsxs(re,{type:"button",onClick:Fe,disabled:$,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[$?i.jsx(wt,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(UF,{className:"mr-2 h-4 w-4"}),$?"Generating...":"Download CSV"]})]}),i.jsx("div",{className:"border p-4 rounded bg-gray-50",children:Ie})]}),Y&&i.jsx(ht,{message:Y.message,type:Y.type,onDismiss:()=>ae(null)})]})},Rle=n=>n.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),Lle=(n,e,t,r)=>{const a=n*Math.PI/180,o=t*Math.PI/180,l=(t-n)*Math.PI/180,c=(r-e)*Math.PI/180,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},Fle=()=>{const{user:n}=jt(),[e,t]=D.useState([]),[r,s]=D.useState([]),[a,o]=D.useState(!0),[l,c]=D.useState(!1),[d,h]=D.useState(null),[p,x]=D.useState(""),[v,_]=D.useState(""),[w,j]=D.useState(""),[T,P]=D.useState(""),[E,M]=D.useState(null),[O,I]=D.useState([]),[q,F]=D.useState(!1),[B,U]=D.useState(""),W=n&&["admin","hr"].includes(n.role);D.useEffect(()=>{(async()=>{if(n)try{const[Q,ne]=await Promise.all([ue.getUserLocations(n.id),ue.getLocations()]);t(Q),s(ne)}catch(Q){console.error(Q),h({message:"Failed to load locations.",type:"error"})}finally{o(!1)}})()},[n]);const $=H=>{const Q=H.target.value,ne=Rle(Q);x(ne)},se=async()=>{c(!0);try{const H=await Jx().catch(()=>null);let Q,ne;if(H&&H.coords&&(Q=H.coords.latitude,ne=H.coords.longitude),Q===void 0||ne===void 0){const de=await new Promise(ce=>{navigator.geolocation.getCurrentPosition(pe=>ce(pe),()=>ce(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})});de&&de.coords&&(Q=de.coords.latitude,ne=de.coords.longitude)}if(Q===void 0||ne===void 0)throw new Error("Unable to retrieve current location.");_(Q.toString()),j(ne.toString());try{const de=await am(Q,ne);P(de)}catch(de){console.warn("Reverse geocode failed:",de)}h({message:"Coordinates and address filled. Please enter a location name.",type:"success"})}catch(H){console.error(H),h({message:H.message||"Failed to get current location.",type:"error"})}finally{c(!1)}},Y=async()=>{if(!n||O.length===0){h({message:"Please select at least one location.",type:"error"});return}F(!0);try{await Promise.all(O.map(Q=>ue.assignLocationToUser(n.id,Q))),h({message:"Locations assigned successfully!",type:"success"}),I([]);const H=await ue.getUserLocations(n.id);t(H)}catch(H){console.error(H),h({message:H.message||"Failed to assign locations.",type:"error"})}finally{F(!1)}},ae=H=>{I(Q=>Q.includes(H)?Q.filter(ne=>ne!==H):[...Q,H])},J=async()=>{if(!n)return;if(!E&&!W){h({message:"You do not have permission to add locations.",type:"error"});return}if(!p.trim()){h({message:"Please enter a location name.",type:"error"});return}const H=parseFloat(v),Q=parseFloat(w);if(isNaN(H)||isNaN(Q)){h({message:"Please provide valid coordinates.",type:"error"});return}if(r.find(de=>de.id!==E&&de.name?.toLowerCase()===p.toLowerCase())){h({message:`Location "${p}" already exists. Please use a different name.`,type:"error"});return}if(!E&&r.find(ce=>Lle(H,Q,ce.latitude,ce.longitude)<10)){h({message:"A location already exists at these coordinates.",type:"error"});return}c(!0);try{if(E)await ue.updateLocation(E,{name:p,latitude:H,longitude:Q,radius:100,address:T||null}),h({message:"Location updated successfully.",type:"success"});else{const ie=await ue.createLocation({name:p,latitude:H,longitude:Q,radius:100,address:T||null,createdBy:n.id});await ue.assignLocationToUser(n.id,ie.id),h({message:"Location added successfully.",type:"success"})}const[ce,pe]=await Promise.all([ue.getUserLocations(n.id),ue.getLocations()]);t(ce),s(pe),Z()}catch(de){console.error(de),h({message:de.message||"Failed to save location.",type:"error"})}finally{c(!1)}},ee=H=>{M(H.id),x(H.name||""),_(H.latitude.toString()),j(H.longitude.toString()),P(H.address||""),window.scrollTo({top:0,behavior:"smooth"})},X=async H=>{if(!n||!W){h({message:"You do not have permission to delete locations.",type:"error"});return}if(window.confirm("Are you sure you want to delete this location? It will be removed from all users."))try{await ue.deleteLocation(H),h({message:"Location deleted successfully.",type:"success"});const[Q,ne]=await Promise.all([ue.getUserLocations(n.id),ue.getLocations()]);t(Q),s(ne)}catch(Q){console.error(Q),h({message:Q.message||"Failed to delete location.",type:"error"})}},Z=()=>{x(""),_(""),j(""),P(""),M(null)},oe=e.filter((H,Q,ne)=>H.address?Q===ne.findIndex(de=>de.address===H.address):!0);return i.jsxs("div",{className:"p-4 md:p-6 w-full",children:[d&&i.jsx(ht,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center",children:[i.jsx(Cl,{className:"h-6 w-6 mr-2"})," My Locations"]}),i.jsxs("p",{className:"text-muted mb-6",children:["These are the geofenced locations assigned to you. You may check in/out only when within one of these locations. ",W?"Use the form below to add a new location.":"You can edit location names by clicking the edit button."]}),(W||E)&&i.jsxs("div",{className:"bg-gray-50 border border-border rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:E?"Edit Location":"Add New Location"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(je,{label:"Location Name (required) *",id:"locationName",value:p,onChange:$,placeholder:"e.g. Office HQ",required:!0}),i.jsx(je,{label:"Latitude",id:"latitude",type:"number",value:v,onChange:H=>_(H.target.value),placeholder:"12.9716",step:"any",disabled:E&&!W}),i.jsx(je,{label:"Longitude",id:"longitude",type:"number",value:w,onChange:H=>j(H.target.value),placeholder:"77.5946",step:"any",disabled:E&&!W}),i.jsx(je,{label:"Address (optional)",id:"address",value:T,onChange:H=>P(H.target.value),placeholder:"Street, City, State",disabled:E&&!W})]}),i.jsxs("div",{className:"flex gap-4 flex-wrap",children:[W&&i.jsxs(re,{onClick:se,variant:"secondary",isLoading:l,disabled:l,children:[i.jsx(GF,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),i.jsx(re,{onClick:J,isLoading:l,disabled:l||!p.trim(),children:E?"Save Changes":"Add Location"}),E&&i.jsx(re,{onClick:Z,variant:"secondary",children:"Cancel"})]})]})]}),i.jsx("div",{className:"mt-6",children:a?i.jsx("p",{children:"Loading locations..."}):e.length===0?i.jsx("div",{children:W?i.jsx("p",{className:"text-muted text-center md:text-left",children:"No locations assigned. Use the form above to add one."}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Select Your Locations"}),i.jsx("p",{className:"text-sm text-blue-800 mb-4",children:"You don't have any locations assigned yet. Please select the locations where you'll be working from the list below."})]}),r.length===0?i.jsx("p",{className:"text-muted text-center",children:"No locations available. Contact your administrator."}):i.jsxs("div",{children:[i.jsx("div",{className:"mb-4",children:i.jsx(je,{type:"text",placeholder:"Search by name or address...",value:B,onChange:H=>U(H.target.value)})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:r.filter(H=>B===""||H.name?.toLowerCase().includes(B.toLowerCase())||H.address?.toLowerCase().includes(B.toLowerCase())).map(H=>i.jsx("div",{onClick:()=>ae(H.id),className:`border rounded-lg p-4 cursor-pointer transition-all ${O.includes(H.id)?"border-accent bg-accent/10 shadow-md":"border-border hover:border-accent/50 hover:bg-gray-50"}`,children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("input",{type:"checkbox",checked:O.includes(H.id),onChange:()=>{},className:"mt-1 mr-3 h-5 w-5 text-accent rounded focus:ring-accent"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:H.name||"Unnamed Location"}),i.jsx("button",{type:"button",onClick:Q=>{Q.stopPropagation(),ee(H)},className:"text-blue-600 hover:text-blue-800 p-1",title:"Edit Name",children:i.jsx(cr,{className:"h-4 w-4"})})]}),i.jsx("p",{className:"text-sm text-muted mt-1",children:H.address||"No address"}),i.jsxs("p",{className:"text-xs text-muted mt-2",children:["Coordinates: ",H.latitude.toFixed(4),", ",H.longitude.toFixed(4),"  Radius: ",H.radius,"m"]})]})]})},H.id))}),i.jsx("div",{className:"flex justify-center",children:i.jsx(re,{onClick:Y,isLoading:q,disabled:q||O.length===0,children:O.length===0?"Select Locations Above":`Assign ${O.length} Location${O.length>1?"s":""}`})})]})]})}):i.jsxs("div",{className:"space-y-4 md:space-y-0 md:grid md:grid-cols-1 md:gap-4",children:[i.jsx("div",{className:"md:hidden space-y-4",children:oe.map(H=>i.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-primary-text",children:H.name||H.address||"Unnamed Location"}),i.jsx("p",{className:"text-sm text-muted",children:H.address})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-500 hover:text-blue-700 p-1",title:W?"Edit Location":"Edit Name",onClick:()=>ee(H),children:i.jsx(cr,{className:"h-5 w-5"})}),W&&i.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 p-1",title:"Delete Location",onClick:()=>X(H.id),children:i.jsx(rn,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Radius"}),i.jsxs("p",{children:[H.radius,"m"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Coordinates"}),i.jsxs("p",{children:[H.latitude?.toFixed(4),", ",H.longitude?.toFixed(4)]})]})]})]},H.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[i.jsx("thead",{className:"bg-page text-primary-text",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),i.jsx("tbody",{children:oe.map(H=>i.jsxs("tr",{className:"border-b border-border",children:[i.jsx("td",{className:"p-3",children:H.name||"-"}),i.jsx("td",{className:"p-3",children:H.radius}),i.jsxs("td",{className:"p-3",children:[H.latitude?.toFixed(4),", ",H.longitude?.toFixed(4)]}),i.jsx("td",{className:"p-3",children:H.address||"-"}),i.jsxs("td",{className:"p-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-800",title:W?"Edit Location":"Edit Name",onClick:()=>ee(H),children:i.jsx(cr,{className:"h-4 w-4"})}),W&&i.jsx("button",{type:"button",className:"text-red-600 hover:text-red-800",title:"Delete Location",onClick:()=>X(H.id),children:i.jsx(rn,{className:"h-4 w-4"})})]})]},H.id))})]})})]})})]})},SL=()=>{const n=St(),e=cs(),{toggleCheckInStatus:t,isCheckedIn:r}=jt(),[s,a]=D.useState(!1),[o,l]=D.useState(null),c=e.pathname.includes("check-in"),d=c?"Check In":"Check Out",h=c?Nx:bo,p=c?"bg-emerald-100":"bg-red-100",x=c?"text-emerald-600":"text-red-600",v=async()=>{a(!0);const{success:w,message:j}=await t();l({message:j,type:w?"success":"error"}),a(!1),w&&setTimeout(()=>{n("/profile",{replace:!0})},1500)},_=()=>{n(-1)};return i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 relative",children:[o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)}),i.jsxs("div",{className:"w-full max-w-md bg-card rounded-2xl shadow-card p-8 text-center relative z-10",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:`p-4 rounded-full ${p}`,children:i.jsx(h,{className:`h-10 w-10 ${x}`})})}),i.jsx("h1",{className:"text-2xl font-bold text-primary-text mb-2",children:d}),i.jsxs("p",{className:"text-muted mb-8",children:["Are you sure you want to ",d.toLowerCase(),"?"]}),i.jsxs("div",{className:"flex flex-col gap-3",children:[i.jsxs(re,{onClick:v,variant:c?"primary":"danger",className:"w-full !py-3 !text-lg shadow-lg",isLoading:s,children:["Yes, ",d]}),i.jsx(re,{onClick:_,variant:"secondary",className:"w-full !py-3",disabled:s,children:"Cancel"})]})]})]})},qle=()=>{const{attendance:n,officeHolidays:e,fieldHolidays:t,recurringHolidays:r,addHoliday:s,removeHoliday:a,addRecurringHoliday:o,removeRecurringHoliday:l,updateAttendanceSettings:c}=pi(),[d,h]=D.useState(n),[p,x]=D.useState(!1),[v,_]=D.useState(!1),[w,j]=D.useState("office"),[T,P]=D.useState(""),[E,M]=D.useState(""),[O,I]=D.useState(3),[q,F]=D.useState("Saturday"),[B,U]=D.useState(null);D.useEffect(()=>{h(n)},[n]),D.useEffect(()=>{x(JSON.stringify(d)!==JSON.stringify(n))},[d,n]);const W=d[w],$=w==="office"?e:t,se=async J=>{if(J.preventDefault(),T&&E){if($.some(ee=>ee.date===E)){U({message:"A holiday for this date already exists.",type:"error"});return}try{await s(w,{name:T,date:E}),P(""),M(""),U({message:"Holiday added successfully.",type:"success"})}catch{U({message:"Failed to add holiday.",type:"error"})}}else U({message:"Please provide both a name and a date.",type:"error"})},Y=(J,ee)=>{h(X=>({...X,[w]:{...X[w],[J]:ee}}))},ae=async()=>{_(!0);try{await ue.saveAttendanceSettings(d),c(d),U({message:"Attendance rules saved successfully!",type:"success"})}catch{U({message:"Failed to save attendance rules.",type:"error"})}finally{_(!1)}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full pb-40",children:[B&&i.jsx(ht,{message:B.message,type:B.type,onDismiss:()=>U(null)}),i.jsx(Ji,{title:"Attendance & Leave Rules",children:i.jsxs(re,{onClick:ae,isLoading:v,disabled:!p,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),i.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Set company-wide rules for attendance and leave calculation."}),i.jsx("div",{className:"mb-6 border-b border-border",children:i.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[i.jsx("button",{onClick:()=>j("office"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${w==="office"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Office Staff"}),i.jsx("button",{onClick:()=>j("field"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${w==="field"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Field Staff"})]})}),w==="office"&&i.jsx("p",{className:"text-sm text-muted -mt-4 mb-4",children:"These rules apply to Admin, HR, and Finance roles."}),w==="field"&&i.jsx("p",{className:"text-sm text-muted -mt-4 mb-4",children:"These rules apply to all other roles (e.g., Field Officers, Managers)."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Vc,{className:"mr-2 h-5 w-5 text-muted"}),"Work Hours"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx(je,{label:"Minimum Hours for Full Day",id:"minHoursFull",type:"number",value:W.minimumHoursFullDay,onChange:J=>Y("minimumHoursFullDay",parseFloat(J.target.value)||0)}),i.jsx(je,{label:"Minimum Hours for Half Day",id:"minHoursHalf",type:"number",value:W.minimumHoursHalfDay,onChange:J=>Y("minimumHoursHalfDay",parseFloat(J.target.value)||0)})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(jx,{className:"mr-2 h-5 w-5 text-muted"}),"Leave Allocation"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx(je,{label:"Annual Earned Leaves",id:"annualEarnedLeaves",type:"number",value:W.annualEarnedLeaves,onChange:J=>Y("annualEarnedLeaves",parseInt(J.target.value,10)||0)}),i.jsx(je,{label:"Annual Sick Leaves",id:"annualSickLeaves",type:"number",value:W.annualSickLeaves,onChange:J=>Y("annualSickLeaves",parseInt(J.target.value,10)||0)}),i.jsx(je,{label:"Monthly Floating Holidays",id:"monthlyFloatingLeaves",type:"number",value:W.monthlyFloatingLeaves,onChange:J=>Y("monthlyFloatingLeaves",parseInt(J.target.value,10)||0)}),i.jsx(je,{label:"Annual Compensatory Off",id:"annualCompOffLeaves",type:"number",value:W.annualCompOffLeaves,onChange:J=>Y("annualCompOffLeaves",parseInt(J.target.value,10)||0)}),i.jsx(je,{label:"Sick Leave Cert. After (Days)",id:"sickLeaveCertThreshold",type:"number",value:W.sickLeaveCertificateThreshold,onChange:J=>Y("sickLeaveCertificateThreshold",parseInt(J.target.value,10)||0),title:"Require a doctor's certificate if total sick leave taken exceeds this number of days."})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Cf,{className:"mr-2 h-5 w-5 text-muted"}),"Notifications"]}),i.jsx(Pn,{id:"attendance-notifications",label:"Enable Check-in/Check-out Notifications",description:"Send a notification to Site Managers, Ops Managers, and HR when a Field Officer checks in or out.",checked:W.enableAttendanceNotifications,onChange:J=>Y("enableAttendanceNotifications",J.target.checked)})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(ka,{className:"mr-2 h-5 w-5 text-muted"}),"Recurring Holidays"]}),i.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Add Recurring Holiday"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[i.jsxs(Ke,{label:"Occurrence",value:O,onChange:J=>I(parseInt(J.target.value)),children:[i.jsx("option",{value:1,children:"1st"}),i.jsx("option",{value:2,children:"2nd"}),i.jsx("option",{value:3,children:"3rd"}),i.jsx("option",{value:4,children:"4th"}),i.jsx("option",{value:5,children:"5th"})]}),i.jsxs(Ke,{label:"Day",value:q,onChange:J=>F(J.target.value),children:[i.jsx("option",{value:"Monday",children:"Monday"}),i.jsx("option",{value:"Tuesday",children:"Tuesday"}),i.jsx("option",{value:"Wednesday",children:"Wednesday"}),i.jsx("option",{value:"Thursday",children:"Thursday"}),i.jsx("option",{value:"Friday",children:"Friday"}),i.jsx("option",{value:"Saturday",children:"Saturday"}),i.jsx("option",{value:"Sunday",children:"Sunday"})]}),i.jsxs(re,{type:"button",onClick:async()=>{try{await o({day:q,n:O,type:w}),U({message:"Recurring holiday added successfully.",type:"success"})}catch{U({message:"Failed to add recurring holiday.",type:"error"})}},size:"sm",className:"w-full sm:w-auto",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Rule"]})]})]}),i.jsxs("div",{className:"mt-4 space-y-2",children:[r.filter(J=>(J.type||"office")===w).map((J,ee)=>i.jsxs("div",{className:"flex justify-between items-start p-4 pr-6 border border-white/10 rounded-lg bg-white/5 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("p",{className:"font-medium text-primary-text truncate",children:[J.n===1?"1st":J.n===2?"2nd":J.n===3?"3rd":J.n+"th"," ",J.day]}),i.jsx("p",{className:"text-sm text-muted",children:"Repeats every month"})]}),i.jsx("div",{className:"ml-4 shrink-0",children:i.jsx(re,{variant:"icon",onClick:async()=>{if(J.id)try{await l(J.id),U({message:"Recurring holiday removed successfully.",type:"success"})}catch{U({message:"Failed to remove recurring holiday.",type:"error"})}},className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})})]},J.id||ee)),r.filter(J=>(J.type||"office")===w).length===0&&i.jsx("p",{className:"text-center text-muted py-4",children:"No recurring holidays configured."})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(ka,{className:"mr-2 h-5 w-5 text-muted"}),"Holiday List"]}),i.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Add New Holiday"}),i.jsxs("form",{onSubmit:se,className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[i.jsx(je,{label:"Holiday Name",id:"holidayName",value:T,onChange:J=>P(J.target.value)}),i.jsx(kn,{label:"Date",id:"holidayDate",value:E,onChange:M}),i.jsxs(re,{type:"submit",size:"sm",className:"w-full sm:w-auto",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add"]})]})]}),i.jsx("div",{className:"mt-4 space-y-2",children:$.length>0?$.map(J=>i.jsxs("div",{className:"flex justify-between items-start p-4 pr-6 border border-white/10 rounded-lg bg-white/5 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium text-primary-text truncate",children:J.name}),i.jsx("p",{className:"text-sm text-muted",children:new Date(J.date.replace(/-/g,"/")).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})})]}),i.jsx("div",{className:"ml-4 shrink-0",children:i.jsx(re,{variant:"icon",onClick:()=>a(w,J.id),"aria-label":`Remove ${J.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})})]},J.id)):i.jsxs("p",{className:"text-center text-muted py-4",children:["No holidays added yet for ",w," staff."]})})]})]})]})},zle=()=>{const{user:n}=jt(),{officeHolidays:e,fieldHolidays:t,attendance:r,recurringHolidays:s}=pi(),[a,o]=D.useState(new Date),[l,c]=D.useState([]),[d,h]=D.useState(!1),p=D.useMemo(()=>n?.role==="field_officer"?t:e,[n,t,e]),x=D.useMemo(()=>{const E=n?.role==="field_officer"?"field":"office";return s.filter(M=>(M.type||"office")===E)},[n,s]);D.useEffect(()=>{console.log("Active Recurring Rules:",x)},[x]);const v=D.useMemo(()=>{const E=[],M=mi(a),O=Ca(a),I=go({start:M,end:O}),q=(n?.role==="field_officer"?r?.field?.monthlyFloatingLeaves:r?.office?.monthlyFloatingLeaves)??0;let F=0;return x.forEach(B=>{if(F>=q)return;let U=0;for(const W of I)if($e(W,"EEEE").toLowerCase()===B.day.toLowerCase()&&(U++,U===B.n)){E.push(W),F++;break}}),E},[a,x,r,n]);D.useEffect(()=>{console.log("Calculated Recurring Holiday Dates:",v)},[v]),D.useEffect(()=>{const E=async()=>{if(n){h(!0);try{const I=mi(a).toISOString(),q=Ca(a).toISOString(),F=await ue.getAttendanceEvents(n.id,I,q);c(F)}catch(I){console.error("Failed to fetch attendance events",I)}finally{h(!1)}}},M=async()=>{try{console.log("Fetching attendance settings...");const I=await ue.getAttendanceSettings();console.log("Fetched settings:",I),pi.getState().updateAttendanceSettings(I)}catch(I){console.error("Failed to fetch attendance settings",I)}},O=async()=>{try{console.log("Fetching recurring holidays...");const I=await ue.getRecurringHolidays();console.log("Fetched recurring holidays:",I),pi.setState({recurringHolidays:I})}catch(I){console.error("Failed to fetch recurring holidays",I)}};E(),M(),O()},[n,a]);const _=D.useMemo(()=>go({start:mi(a),end:Ca(a)}),[a]),w=E=>{const M=l.some(F=>cf(new Date(F.timestamp),E)&&(F.type.toLowerCase().includes("check")||F.type.toLowerCase().includes("in"))),O=v.some(F=>cf(F,E)),I=p.some(F=>cf(new Date(F.date),E));return(O||I)&&M?"holiday-present":O?"floating-holiday":I?"holiday":M?"present":DW(zc(new Date),zc(E))?"absent":"neutral"},j=E=>{switch(E){case"present":return"bg-emerald-500 text-white border-emerald-600 shadow-sm";case"absent":return"bg-rose-500 text-white border-rose-600 shadow-sm";case"holiday":return"bg-red-600 text-white border-red-700 shadow-sm";case"floating-holiday":return"bg-amber-500 text-white border-amber-600 shadow-sm";case"holiday-present":return"bg-violet-600 text-white border-violet-700 shadow-sm";default:return"bg-gray-50 text-gray-400 border-gray-100"}},T=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],P=cC(mi(a));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-none bg-transparent p-3 rounded-xl shadow-none w-full md:w-full md:max-w-[320px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Attendance Calendar"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(re,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>o(fC(a)),children:i.jsx(Qx,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-sm",children:$e(a,"MMMM yyyy")}),i.jsx(re,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>o(Hx(a,1)),children:i.jsx(Tf,{className:"h-3 w-3"})})]})]}),d?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(wt,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[T.map(E=>i.jsx("div",{className:"text-center text-xs font-medium text-muted py-1",children:E},E)),Array.from({length:P}).map((E,M)=>i.jsx("div",{className:"aspect-square"},`empty-${M}`)),_.map(E=>{const M=w(E),O=j(M);return i.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${O} transition-colors`,children:i.jsx("span",{className:"text-sm font-semibold",children:$e(E,"d")})},E.toISOString())})]}),i.jsxs("div",{className:"mt-3 flex gap-3 text-xs text-muted justify-center flex-wrap",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-emerald-500 border border-emerald-600 rounded-sm"})," Present"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-rose-500 border border-rose-600 rounded-sm"})," Absent"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-red-600 border border-red-700 rounded-sm"})," Holiday"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-amber-500 border border-amber-600 rounded-sm"})," Floating Holiday"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-violet-600 border border-violet-700 rounded-sm"})," Holiday Present"]})]})]})},Ule=({logs:n,isLoading:e=!1})=>{const[t,r]=D.useState(new Date),s=D.useMemo(()=>go({start:mi(t),end:Ca(t)}),[t]),a=d=>n.some(p=>{const x=new Date(p.dateEarned.replace(/-/g,"/"));return cf(x,d)})?"earned":"neutral",o=d=>{switch(d){case"earned":return"bg-blue-600 text-white border-blue-700 shadow-sm";default:return"bg-gray-50 text-gray-400 border-gray-100"}},l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],c=cC(mi(t));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-none bg-transparent p-3 rounded-xl shadow-none w-full md:w-full md:max-w-[320px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Comp Off Tracker"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(re,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>r(fC(t)),children:i.jsx(Qx,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-sm",children:$e(t,"MMMM yyyy")}),i.jsx(re,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>r(Hx(t,1)),children:i.jsx(Tf,{className:"h-3 w-3"})})]})]}),e?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(wt,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[l.map(d=>i.jsx("div",{className:"text-center text-xs font-medium text-muted py-1",children:d},d)),Array.from({length:c}).map((d,h)=>i.jsx("div",{className:"aspect-square"},`empty-${h}`)),s.map(d=>{const h=a(d),p=o(h);return i.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${p} transition-colors`,children:i.jsx("span",{className:"text-sm font-semibold",children:$e(d,"d")})},d.toISOString())})]}),i.jsx("div",{className:"mt-3 flex gap-3 text-xs text-muted justify-center",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-600 border border-blue-700 rounded-sm"})," Comp Off Earned"]})})]})},Vle=()=>{const{user:n}=jt(),[e,t]=D.useState(new Date),[r,s]=D.useState([]),[a,o]=D.useState(!1);D.useEffect(()=>{(async()=>{if(n){o(!0);try{const x=mi(e).toISOString(),v=Ca(e).toISOString(),_=await ue.getAttendanceEvents(n.id,x,v);s(_)}catch(x){console.error("Failed to fetch attendance events",x)}finally{o(!1)}}})()},[n,e]);const l=D.useMemo(()=>go({start:mi(e),end:Ca(e)}),[e]),c=p=>{const x=r.filter(P=>cf(new Date(P.timestamp),p));if(x.length===0)return 0;const v=[...x].sort((P,E)=>new Date(P.timestamp).getTime()-new Date(E.timestamp).getTime());let _=0,w=null;v.forEach(P=>{const E=new Date(P.timestamp);P.type==="check-in"?w=E:P.type==="check-out"&&w&&(_+=df(E,w),w=null)});const j=_/60,T=Math.max(0,j-8);return parseFloat(T.toFixed(1))},d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h=cC(mi(e));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-0 bg-transparent p-3 rounded-xl shadow-none w-full",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"OT Calendar"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(re,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>t(fC(e)),children:i.jsx(Qx,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-xs",children:$e(e,"MMMM yyyy")}),i.jsx(re,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>t(Hx(e,1)),children:i.jsx(Tf,{className:"h-3 w-3"})})]})]}),a?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(wt,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[d.map(p=>i.jsx("div",{className:"text-center text-[10px] font-medium text-muted py-1",children:p},p)),Array.from({length:h}).map((p,x)=>i.jsx("div",{className:"aspect-square"},`empty-${x}`)),l.map(p=>{const x=c(p),v=x>0;return i.jsxs("div",{className:`aspect-square rounded border flex flex-col items-center justify-center transition-colors ${v?"bg-blue-600 text-white border-blue-700 shadow-sm":"bg-gray-50 text-gray-400 border-gray-100"}`,children:[i.jsx("span",{className:"text-xs font-semibold",children:$e(p,"d")}),v&&i.jsxs("span",{className:"text-[8px] font-bold",children:["+",x,"h"]})]},p.toISOString())})]}),i.jsx("div",{className:"mt-3 flex gap-3 text-[10px] text-muted justify-center flex-wrap",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-600 border border-blue-700 rounded-sm"})," Overtime (>8h)"]})})]})},Ble=()=>{const{user:n}=jt(),[e,t]=D.useState([]),[r,s]=D.useState(!0),[a,o]=D.useState("day"),[l,c]=D.useState(new Date),[d,h]=D.useState({});Ft("(max-width: 767px)");const p=async()=>{if(n){s(!0);try{let T,P;switch(a){case"day":T=zc(l),P=aC(l);break;case"week":T=No(l,{weekStartsOn:1}),P=Gk(l,{weekStartsOn:1});break;case"month":T=mi(l),P=Ca(l);break}const E=await ue.getAttendanceEvents(n.id,T.toISOString(),P.toISOString());t(E);const M=E.filter(O=>O.latitude&&O.longitude).map(O=>({lat:O.latitude,lon:O.longitude}));if(M.length>0)try{const O=await ue.batchResolveAddresses(M);h(O)}catch(O){console.error("Failed to fetch location addresses:",O)}}catch(T){console.error("Failed to fetch attendance events:",T)}finally{s(!1)}}};D.useEffect(()=>{p()},[n,a,l]);const x=D.useMemo(()=>{const T={};return e.forEach(P=>{const E=$e(new Date(P.timestamp),"yyyy-MM-dd");T[E]||(T[E]={date:E,events:[],checkIns:[],checkOuts:[],totalMinutes:0}),T[E].events.push(P),P.type==="check-in"?T[E].checkIns.push(P):P.type==="check-out"&&T[E].checkOuts.push(P)}),Object.values(T).forEach(P=>{const E=[...P.events].sort((I,q)=>new Date(I.timestamp).getTime()-new Date(q.timestamp).getTime());let M=0,O=null;E.forEach(I=>{const q=new Date(I.timestamp);I.type==="check-in"?O=q:I.type==="check-out"&&O&&(M+=df(q,O),O=null)}),P.totalMinutes=M}),Object.values(T).sort((P,E)=>E.date.localeCompare(P.date))},[e]),v=T=>{const P=Math.floor(T/60),E=T%60;return`${P}h ${E}m`},_=T=>{o(T)},w=T=>{const P=new Date(l);switch(a){case"day":P.setDate(P.getDate()+(T==="next"?1:-1));break;case"week":P.setDate(P.getDate()+(T==="next"?7:-7));break;case"month":P.setMonth(P.getMonth()+(T==="next"?1:-1));break}c(P)},j=()=>{switch(a){case"day":return $e(l,"dd MMM, yyyy");case"week":const T=No(l,{weekStartsOn:1}),P=Gk(l,{weekStartsOn:1});return`${$e(T,"dd MMM")} - ${$e(P,"dd MMM, yyyy")}`;case"month":return $e(l,"MMMM yyyy")}};return n?i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-indigo-50 rounded-lg",children:i.jsx(Vc,{className:"h-5 w-5 text-indigo-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Employee Log"})]}),i.jsxs("div",{className:"mb-6 space-y-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>_("day"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="day"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Day"}),i.jsx("button",{onClick:()=>_("week"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="week"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Week"}),i.jsx("button",{onClick:()=>_("month"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="month"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Month"})]}),i.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[i.jsx("button",{onClick:()=>w("prev"),className:"px-3 py-1 bg-white rounded-md shadow-sm hover:bg-gray-100 transition-colors",children:""}),i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-gray-900",children:[i.jsx(ka,{className:"h-4 w-4"}),i.jsx("span",{children:j()})]}),i.jsx("button",{onClick:()=>w("next"),className:"px-3 py-1 bg-white rounded-md shadow-sm hover:bg-gray-100 transition-colors",children:""})]})]}),i.jsx("div",{className:"space-y-4",children:r?i.jsx("div",{className:"flex items-center justify-center py-10",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-indigo-600"})}):x.length===0?i.jsxs("div",{className:"text-center py-10 text-gray-500",children:[i.jsx(ka,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{className:"font-medium",children:"No attendance records found"}),i.jsx("p",{className:"text-sm mt-1",children:"Check-in to start tracking your attendance"})]}):x.map(T=>i.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl border border-gray-200 overflow-hidden",children:[i.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-500 px-4 py-3 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 text-white",children:[i.jsx(ka,{className:"h-4 w-4"}),i.jsx("span",{className:"font-semibold",children:$e(new Date(T.date),"EEEE, dd MMMM yyyy")})]}),i.jsx("div",{className:"text-white text-sm font-medium bg-white/20 px-3 py-1 rounded-full",children:v(T.totalMinutes)})]}),i.jsx("div",{className:"p-4 space-y-3",children:T.events.sort((P,E)=>new Date(P.timestamp).getTime()-new Date(E.timestamp).getTime()).map((P,E)=>i.jsx("div",{className:`p-3 rounded-lg border-l-4 ${P.type==="check-in"?"bg-emerald-50 border-emerald-500":"bg-rose-50 border-rose-500"}`,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`p-2 rounded-lg ${P.type==="check-in"?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:i.jsx(Vc,{className:"h-4 w-4"})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900 capitalize",children:P.type.replace("-"," ")}),i.jsx("div",{className:"text-sm text-gray-600",children:$e(new Date(P.timestamp),"hh:mm a")})]})]}),P.latitude&&P.longitude&&i.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-600 bg-white px-3 py-1.5 rounded-lg border border-gray-200 max-w-md",children:[i.jsx(Cl,{className:"h-4 w-4 text-indigo-600 flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-xs break-words",children:d[`${P.latitude.toFixed(6)},${P.longitude.toFixed(6)}`]||`${P.latitude.toFixed(4)}, ${P.longitude.toFixed(4)}`})]})]})},`${P.timestamp}-${E}`))}),i.jsx("div",{className:"bg-gray-50 px-4 py-3 border-t border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Check-ins:"}),i.jsx("span",{className:"ml-2 font-semibold text-emerald-600",children:T.checkIns.length})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Check-outs:"}),i.jsx("span",{className:"ml-2 font-semibold text-rose-600",children:T.checkOuts.length})]})]})})]},T.date))})]}):null},CL=({title:n,value:e,icon:t})=>i.jsxs("div",{className:"bg-card p-3 md:p-4 rounded-xl flex flex-col md:flex-row items-center md:items-center gap-2 md:gap-4 border border-border text-center md:text-left w-full",children:[i.jsx("div",{className:"bg-accent-light p-2 md:p-3 rounded-full flex-shrink-0",children:i.jsx(t,{className:"h-5 w-5 md:h-6 md:w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-xs md:text-sm text-muted font-medium",children:n}),i.jsx("p",{className:"text-lg md:text-2xl font-bold text-primary-text",children:e})]})]}),Wle=({status:n})=>{const e={pending_manager_approval:"leave-status-chip--pending_manager_approval",pending_hr_confirmation:"leave-status-chip--pending_hr_confirmation",approved:"leave-status-chip--approved",rejected:"leave-status-chip--rejected"},t=n.replace(/_/g," ");return i.jsx("span",{className:`leave-status-chip ${e[n]}`,children:t})},$le=n=>Pt({leaveType:ge().oneOf(["Earned","Sick","Floating","Comp Off"]).required("Leave type is required"),startDate:ge().required("Start date is required"),endDate:ge().required("End date is required").test("is-after-start","End date must be on or after start date",function(e){const{startDate:t}=this.parent;return!t||!e?!0:new Date(e.replace(/-/g,"/"))>=new Date(t.replace(/-/g,"/"))}),reason:ge().required("A reason for the leave is required").min(10,"Please provide a more detailed reason."),dayOption:ge().oneOf(["full","half"]).optional(),doctorCertificate:Wt().when(["leaveType","startDate","endDate"],{is:(e,t,r)=>e!=="Sick"||!t||!r?!1:jm(new Date(r.replace(/-/g,"/")),new Date(t.replace(/-/g,"/")))+1>n,then:e=>e.required(`A doctor's certificate is required for sick leave longer than ${n} days.`),otherwise:e=>e.nullable().optional()})}),Hle=({isOpen:n,onClose:e,onSuccess:t,user:r,isMobile:s,setToast:a})=>{const{attendance:{office:{sickLeaveCertificateThreshold:o}}}=pi(),l=D.useMemo(()=>$le(o),[o]),{register:c,control:d,handleSubmit:h,watch:p,formState:{errors:x},reset:v}=tn({resolver:Dn(l),defaultValues:{leaveType:"Earned",startDate:$e(new Date,"yyyy-MM-dd"),endDate:$e(new Date,"yyyy-MM-dd"),dayOption:"full"}}),_=p("startDate"),w=p("endDate"),j=p("leaveType"),P=D.useMemo(()=>!_||!w?!1:cf(new Date(_.replace(/-/g,"/")),new Date(w.replace(/-/g,"/"))),[_,w])&&j==="Earned",E=D.useMemo(()=>j!=="Sick"||!_||!w?!1:jm(new Date(w.replace(/-/g,"/")),new Date(_.replace(/-/g,"/")))+1>o,[j,_,w,o]),M=async O=>{try{await ue.submitLeaveRequest({...O,userId:r.id,userName:r.name}),t()}catch{a({message:"Failed to submit leave request.",type:"error"})}};return n?i.jsx("div",{className:`fixed inset-0 z-40 bg-card ${s?"flex flex-col":"flex items-center justify-center bg-black/50 p-4"}`,children:i.jsxs("div",{className:`w-full ${s?"flex flex-col h-full":"max-w-2xl bg-card rounded-xl shadow-lg"}`,children:[i.jsxs("header",{className:`p-4 flex-shrink-0 flex items-center gap-4 ${s?"fo-mobile-header":"border-b"}`,children:[i.jsx(re,{variant:"icon",onClick:e,"aria-label":"Go back",children:i.jsx(Aa,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-lg font-semibold",children:s?"New Leave Request":"Submit a New Leave Request"})]}),i.jsxs("form",{id:"leave-form",onSubmit:h(M),className:"flex-grow overflow-y-auto p-4 space-y-4",children:[i.jsx(we,{name:"leaveType",control:d,render:({field:O})=>i.jsxs(Ke,{label:"Leave Type",...O,error:x.leaveType?.message,className:s?"pro-select pro-select-arrow":"",children:[i.jsx("option",{children:"Earned"}),i.jsx("option",{children:"Sick"}),i.jsx("option",{children:"Floating"}),i.jsx("option",{children:"Comp Off"})]})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(we,{name:"startDate",control:d,render:({field:O})=>i.jsx(kn,{label:"Start Date",id:"startDate",value:O.value,onChange:O.onChange,error:x.startDate?.message})}),i.jsx(we,{name:"endDate",control:d,render:({field:O})=>i.jsx(kn,{label:"End Date",id:"endDate",value:O.value,onChange:O.onChange,error:x.endDate?.message})})]}),P&&i.jsx(we,{name:"dayOption",control:d,render:({field:O})=>i.jsxs(Ke,{label:"Day Option",...O,className:s?"pro-select pro-select-arrow":"",children:[i.jsx("option",{value:"full",children:"Full Day"}),i.jsx("option",{value:"half",children:"Half Day"})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Reason"}),i.jsx("textarea",{...c("reason"),rows:4,className:`mt-1 form-input ${x.reason?"form-input--error":""}`}),x.reason&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.reason.message})]}),E&&i.jsx(we,{name:"doctorCertificate",control:d,render:({field:O,fieldState:I})=>i.jsx(yt,{label:"Doctor's Certificate (Required)",file:O.value,onFileChange:O.onChange,error:I.error?.message,allowCapture:!0})})]}),i.jsxs("footer",{className:`p-4 flex-shrink-0 flex items-center justify-end gap-2 ${s?"":"border-t"}`,children:[i.jsx(re,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(re,{type:"submit",form:"leave-form",children:"Submit Request"})]})]})}):null},Yle=()=>{const{user:n}=jt(),[e,t]=D.useState(null),[r,s]=D.useState([]),[a,o]=D.useState([]),[l,c]=D.useState(!0),[d,h]=D.useState(!1),[p,x]=D.useState("all"),[v,_]=D.useState(null),w=Ft("(max-width: 767px)"),[j,T]=D.useState(!1),[P,E]=D.useState(0),M=D.useCallback(async()=>{if(n){c(!0),h(!1);try{const[B,U,W]=await Promise.all([ue.getLeaveBalancesForUser(n.id),ue.getLeaveRequests({userId:n.id,status:p==="all"?void 0:p}),ue.getCompOffLogs(n.id).catch($=>{if($&&$.message&&($.message.includes("comp_off_logs")||$.message.includes('relation "public.comp_off_logs" does not exist')))return h(!0),[];throw $})]);if(t(B),s(U),o(W),n.role==="field_officer"){const $=new Date,se=mi($).toISOString(),Y=Ca($).toISOString(),ae=await ue.getAttendanceEvents(n.id,se,Y),J={};ae.forEach(X=>{const Z=$e(new Date(X.timestamp),"yyyy-MM-dd");J[Z]||(J[Z]=[]),J[Z].push(X)});let ee=0;Object.values(J).forEach(X=>{const Z=[...X].sort((ne,de)=>new Date(ne.timestamp).getTime()-new Date(de.timestamp).getTime());let oe=0,H=null;Z.forEach(ne=>{const de=new Date(ne.timestamp);ne.type==="check-in"?H=de:ne.type==="check-out"&&H&&(oe+=df(de,H),H=null)});const Q=oe/60;Q>8&&(ee+=Q-8)}),E(parseFloat(ee.toFixed(1)))}}catch(B){let U="Failed to load leave data.";B&&typeof B.message=="string"&&B.message.includes('relation "leave_requests" does not exist')&&(U='Database setup error: The "leave_requests" table is missing.'),console.error("Failed to load leave data",B),d||_({message:U,type:"error"})}finally{c(!1)}}},[n,p]);D.useEffect(()=>{M()},[M]);const O=()=>{_({message:"Leave request submitted successfully!",type:"success"}),T(!1),M()},I=B=>B.replace(/_/g," ").replace(/\b\w/g,U=>U.toUpperCase()),q=["all","pending_manager_approval","pending_hr_confirmation","approved","rejected"],F=e?[{title:"Earned Leave",value:`${e.earnedTotal-e.earnedUsed} / ${e.earnedTotal}`,icon:RF},{title:"Sick Leave",value:`${e.sickTotal-e.sickUsed} / ${e.sickTotal}`,icon:yC},{title:"Floating Holiday",value:`${e.floatingTotal-e.floatingUsed} / ${e.floatingTotal}`,icon:gJ},{title:"Compensatory Off",value:`${e.compOffTotal-e.compOffUsed} / ${e.compOffTotal}`,icon:BK}]:[];return i.jsxs("div",{className:"p-4 space-y-6",children:[v&&i.jsx(ht,{message:v.message,type:v.type,onDismiss:()=>_(null)}),n&&i.jsx(Hle,{isOpen:j,onClose:()=>T(!1),onSuccess:O,user:n,isMobile:w,setToast:_}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Leave Requests"}),!w&&i.jsxs(re,{onClick:()=>T(!0),children:[i.jsx(Bt,{className:"mr-2 h-4"})," New Request"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6 justify-items-center md:justify-items-start",children:[F.map(B=>i.jsx(CL,{...B},B.title)),n?.role==="field_officer"&&i.jsx(CL,{title:"Overtime Hours",value:`${P} hrs`,icon:Vc})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[i.jsx(zle,{}),i.jsx(Ule,{logs:a,isLoading:l}),n?.role==="field_officer"&&i.jsx(Vle,{})]}),w&&i.jsx("div",{className:"my-4 w-full",children:i.jsxs(re,{onClick:()=>T(!0),size:"lg",className:"w-full justify-center text-lg",children:[i.jsx(Bt,{className:"mr-2 h-5"})," New Request"]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full md:w-full",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:i.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 space-y-2 md:space-y-0","aria-label":"Tabs",children:q.map(B=>i.jsx("button",{onClick:()=>x(B),className:`whitespace-nowrap font-medium text-base rounded-lg md:rounded-none w-full md:w-auto text-left px-4 py-2 md:px-1 md:py-3 md:bg-transparent md:border-b-2
                                    ${p===B?"bg-accent-light text-accent-dark md:border-accent":"text-muted hover:bg-accent-light hover:text-accent-dark md:border-transparent md:hover:border-accent"}`,children:I(B)},B))})})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Dates"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted text-lg",children:"No requests found."})}):r.map(B=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Type",className:"px-4 py-3 font-medium text-base",children:[B.leaveType," ",B.dayOption&&`(${B.dayOption})`]}),i.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted text-base",children:[$e(new Date(B.startDate.replace(/-/g,"/")),"dd MMM")," - ",$e(new Date(B.endDate.replace(/-/g,"/")),"dd MMM")]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate text-base",children:B.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3 text-base",children:i.jsx(Wle,{status:B.status})})]},B.id))})]})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full md:w-full",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Compensatory Off Tracker"}),d?i.jsxs("div",{className:"text-center py-10 text-muted bg-page rounded-lg",children:[i.jsx(Da,{className:"h-8 w-8 mx-auto mb-2 text-yellow-500"}),i.jsx("p",{className:"font-semibold",children:"Feature Unavailable"}),i.jsx("p",{className:"text-sm",children:"The Compensatory Off feature is disabled because the required 'comp_off_logs' table is missing in the database."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date Earned"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason for Comp-Off"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Granted By"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted text-lg",children:"No comp-off history found."})}):a.map(B=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Date Earned",className:"px-4 py-3 font-medium",children:$e(new Date(B.dateEarned.replace(/-/g,"/")),"dd MMM, yyyy")}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted",children:B.reason}),i.jsx("td",{"data-label":"Granted By",className:"px-4 py-3 text-muted",children:B.grantedByName||"-"}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full capitalize ${B.status==="earned"?"bg-blue-100 text-blue-800":"bg-gray-200 text-gray-800"}`,children:B.status})})]},B.id))})]})})]}),i.jsx(Ble,{})]})},Gle=({isOpen:n,onClose:e,onConfirm:t,isConfirming:r})=>{const[s,a]=D.useState(""),[o,l]=D.useState(""),c=()=>{if(!s.trim()){l("A reason for rejection is required.");return}t(s)},d=()=>{a(""),l(""),e()};return n?i.jsx(Hr,{isOpen:n,onClose:d,onConfirm:c,title:"Reject Claim",confirmButtonText:"Confirm Rejection",isConfirming:r,children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{children:"Please provide a reason for rejecting this claim. This will be visible to the employee."}),i.jsxs("div",{children:[i.jsx("textarea",{value:s,onChange:h=>{a(h.target.value),o&&l("")},rows:3,className:`mt-1 form-input ${o?"form-input--error":""}`,placeholder:"e.g., Overtime was not pre-approved."}),o&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:o})]})]})}):null},Zle=({status:n})=>{const e={pending_manager_approval:"bg-yellow-100 text-yellow-800",pending_hr_confirmation:"bg-blue-100 text-blue-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},t=n.replace(/_/g," ");return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:t})},Kle=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},Jle=()=>{const n=St(),{user:e}=jt(),[t,r]=D.useState([]),[s,a]=D.useState([]),[o,l]=D.useState(!0),[c,d]=D.useState("pending_manager_approval"),[h,p]=D.useState(null),[x,v]=D.useState(null),_=Ft("(max-width: 767px)"),[w,j]=D.useState(!0),[T,P]=D.useState(!1),[E,M]=D.useState(null);D.useEffect(()=>{(async()=>{try{await ue.checkCompOffTableExists(),j(!0)}catch{j(!1)}})()},[]);const O=D.useCallback(async()=>{if(e){l(!0);try{const $=["admin","hr","operation_manager","site_manager"].includes(e.role),[se,Y]=await Promise.all([ue.getLeaveRequests({forApproverId:e.id,status:c!=="all"&&c!=="claims"?c:void 0}),$?ue.getExtraWorkLogs():Promise.resolve([])]);r(se),a(Y)}catch{p({message:"Failed to load approval data.",type:"error"})}finally{l(!1)}}},[e,c]);D.useEffect(()=>{O()},[O]);const I=async($,se)=>{if(e){v($);try{switch(se){case"approve":await ue.approveLeaveRequest($,e.id);break;case"reject":await ue.rejectLeaveRequest($,e.id);break;case"confirm":await ue.confirmLeaveByHR($,e.id);break}p({message:"Request actioned successfully.",type:"success"}),O()}catch{p({message:"Failed to update request.",type:"error"})}finally{v(null)}}},q=async $=>{if(e){v($);try{await ue.approveExtraWorkClaim($,e.id),p({message:"Claim approved successfully.",type:"success"}),O()}catch{p({message:"Failed to approve claim.",type:"error"})}finally{v(null)}}},F=async $=>{if(!(!e||!E)){v(E.id);try{await ue.rejectExtraWorkClaim(E.id,e.id,$),p({message:"Claim rejected successfully.",type:"success"}),O()}catch{p({message:"Failed to reject claim.",type:"error"})}finally{v(null),P(!1),M(null)}}},B=["pending_manager_approval","claims","pending_hr_confirmation","approved","rejected","all"],U=({request:$})=>{if(!e||$.status==="approved"||$.status==="rejected")return null;if($.currentApproverId===e.id){if($.status==="pending_manager_approval")return i.jsxs("div",{className:"flex gap-2",children:[i.jsx(re,{size:"sm",variant:"icon",onClick:()=>I($.id,"approve"),disabled:x===$.id,title:"Approve","aria-label":"Approve request",children:i.jsx(_l,{className:"h-4 w-4 text-green-600"})}),i.jsx(re,{size:"sm",variant:"icon",onClick:()=>I($.id,"reject"),disabled:x===$.id,title:"Reject","aria-label":"Reject request",children:i.jsx(gi,{className:"h-4 w-4 text-red-600"})})]});if($.status==="pending_hr_confirmation"&&(e.role==="hr"||e.role==="admin"))return i.jsxs("div",{className:"flex gap-2",children:[i.jsx(re,{size:"sm",variant:"icon",onClick:()=>I($.id,"confirm"),disabled:x===$.id,title:"Confirm & Finalize","aria-label":"Confirm and finalize request",children:i.jsx(_l,{className:"h-4 w-4 text-blue-600"})}),i.jsx(re,{size:"sm",variant:"icon",onClick:()=>I($.id,"reject"),disabled:x===$.id,title:"Reject","aria-label":"Reject request",children:i.jsx(gi,{className:"h-4 w-4 text-red-600"})})]})}return null},W=$=>$.replace(/_/g," ").replace(/\b\w/g,se=>se.toUpperCase());return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(Gle,{isOpen:T,onClose:()=>{P(!1),M(null)},onConfirm:F,isConfirming:!!x}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Leave Approval Inbox"}),!_&&i.jsxs(re,{onClick:()=>n("/hr/leave-management/grant-comp-off"),disabled:!w,title:w?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})]}),_&&i.jsx("div",{className:"mb-6",children:i.jsxs(re,{onClick:()=>n("/hr/leave-management/grant-comp-off"),disabled:!w,title:w?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})}),i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:i.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 md:overflow-x-auto space-y-1 md:space-y-0","aria-label":"Tabs",children:B.map($=>i.jsx("button",{onClick:()=>d($),className:`whitespace-nowrap font-medium text-sm rounded-lg md:rounded-none w-full md:w-auto text-left md:text-center px-4 py-3 md:px-1 md:py-3 md:bg-transparent md:border-b-2 transition-colors duration-200
                                ${c===$?"bg-emerald-50 text-emerald-700 md:border-emerald-500 md:bg-transparent":"text-muted hover:bg-emerald-50 hover:text-emerald-700 md:border-transparent md:hover:border-emerald-500"}`,children:W($)},$))})})}),c==="claims"?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date & Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Claim"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:o?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10",children:i.jsx(wt,{className:"h-6 w-6 animate-spin mx-auto"})})}):s.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No pending claims found."})}):s.map($=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:$.userName}),i.jsxs("td",{"data-label":"Date & Type",className:"px-4 py-3 text-muted",children:[$e(new Date($.workDate),"dd MMM, yyyy")," (",$.workType,")"]}),i.jsxs("td",{"data-label":"Claim",className:"px-4 py-3 text-muted",children:[$.claimType,$.claimType==="OT"?` (${$.hoursWorked} hrs)`:""]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:$.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(Kle,{status:$.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex md:justify-start justify-end gap-2",children:[i.jsx(re,{size:"sm",variant:"icon",onClick:()=>q($.id),disabled:x===$.id,title:"Approve Claim",children:i.jsx(_l,{className:"h-4 w-4 text-green-600"})}),i.jsx(re,{size:"sm",variant:"icon",onClick:()=>{M($),P(!0)},disabled:x===$.id,title:"Reject Claim",children:i.jsx(gi,{className:"h-4 w-4 text-red-600"})})]})})]},$.id))})]})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Dates"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:o?_?i.jsx("tr",{children:i.jsx("td",{colSpan:6,children:i.jsx(Ea,{rows:3,cols:6,isMobile:!0})})}):i.jsx(Ea,{rows:5,cols:6}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No requests found for this filter."})}):t.map($=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:$.userName}),i.jsxs("td",{"data-label":"Type",className:"px-4 py-3 text-muted",children:[$.leaveType," ",$.dayOption&&`(${$.dayOption})`]}),i.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted",children:[$e(new Date($.startDate.replace(/-/g,"/")),"dd MMM")," - ",$e(new Date($.endDate.replace(/-/g,"/")),"dd MMM")]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:$.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(Zle,{status:$.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsx("div",{className:"flex md:justify-start justify-end",children:x===$.id?i.jsx(wt,{className:"h-4 w-4 animate-spin"}):i.jsx(U,{request:$})})})]},$.id))})]})})]})},E6=({users:n,externalSearchQuery:e,externalZoom:t,showControls:r=!0})=>{const s=D.useRef(null),a=D.useRef(null),[o,l]=D.useState(null),[c,d]=D.useState(null),[h,p]=D.useState({x:0,y:0}),[x,v]=D.useState(""),[_,w]=D.useState(1),[j,T]=D.useState({x:0,y:0}),P=e!==void 0?e:x,E=t!==void 0?t:_,M=v,O=w,I=D.useRef(null),q=D.useRef(!1),F=D.useRef({x:0,y:0}),B=D.useRef(!1),U=D.useRef({x:0,y:0}),W=D.useRef(0),$=D.useRef(new Map),se=D.useRef(window.devicePixelRatio||1);D.useEffect(()=>{n.forEach(ie=>{if(ie.photoUrl&&!$.current.has(ie.id)){const xe=new Image;xe.crossOrigin="anonymous",xe.src=ie.photoUrl,xe.onload=()=>{$.current.set(ie.id,xe)}}})},[n]);const Y=()=>{const ie=new Map;n.forEach(Ce=>{ie.set(Ce.id,{...Ce,children:[]})});const xe=[];return n.forEach(Ce=>{const ve=ie.get(Ce.id);if(Ce.reportingManagerId){const Oe=ie.get(Ce.reportingManagerId);Oe?Oe.children.push(ve):xe.push(ve)}else xe.push(ve)}),xe},ae=(ie,xe=50,Ce=50,ve=0)=>{let _e=xe;const Ne=[];let Ue=1/0,Be=-1/0,qe=1/0,te=-1/0;ie.forEach(ye=>{if(ye.level=ve,ye.children&&ye.children.length>0){const Ve=ae(ye.children,_e,Ce+120+120,ve+1),ze=Ve.width,Le=_e+ze/2-180/2;ye.x=Le,ye.y=Ce,Ne.push(ye),Ne.push(...Ve.nodes),Ue=Math.min(Ue,Le,Ve.bounds.minX),Be=Math.max(Be,Le+180,Ve.bounds.maxX),qe=Math.min(qe,Ce,Ve.bounds.minY),te=Math.max(te,Ce+120,Ve.bounds.maxY),_e+=ze+20}else ye.x=_e,ye.y=Ce,Ne.push(ye),Ue=Math.min(Ue,_e),Be=Math.max(Be,_e+180),qe=Math.min(qe,Ce),te=Math.max(te,Ce+120),_e+=200});const le=Math.max(0,_e-xe-20);return{width:Math.max(le,180),nodes:Ne,bounds:{minX:isFinite(Ue)?Ue:0,maxX:isFinite(Be)?Be:180,minY:isFinite(qe)?qe:0,maxY:isFinite(te)?te:300}}},J=(ie,xe,Ce,ve)=>{if(xe.x===void 0||xe.y===void 0||Ce.x===void 0||Ce.y===void 0)return;const Oe=(xe.x+90)*E+j.x,Pe=(xe.y+120)*E+j.y,Ie=(Ce.x+90)*E+j.x,Fe=Ce.y*E+j.y,_e=ie.createLinearGradient(Oe,Pe,Ie,Fe),Ne=ve*5e-4%1;_e.addColorStop(0,"#E0E7FF"),_e.addColorStop(Ne,"#818CF8"),_e.addColorStop(1,"#E0E7FF"),ie.save(),ie.strokeStyle=_e,ie.lineWidth=2*E,ie.lineCap="round",ie.shadowColor="rgba(99, 102, 241, 0.2)",ie.shadowBlur=4,ie.beginPath(),ie.moveTo(Oe,Pe);const Ue=(Pe+Fe)/2;ie.bezierCurveTo(Oe,Ue,Ie,Ue,Ie,Fe),ie.stroke(),ie.restore();const qe=(ve*5e-4+xe.id.charCodeAt(0)*.1)%1,te={x:Oe,y:Pe},le={x:Oe,y:(Pe+Fe)/2},ye={x:Ie,y:(Pe+Fe)/2},Ve={x:Ie,y:Fe},ze=3*(le.x-te.x),Le=3*(ye.x-le.x)-ze,rt=Ve.x-te.x-ze-Le,Xe=3*(le.y-te.y),tt=3*(ye.y-le.y)-Xe,qt=Ve.y-te.y-Xe-tt,bt=rt*qe*qe*qe+Le*qe*qe+ze*qe+te.x,Dt=qt*qe*qe*qe+tt*qe*qe+Xe*qe+te.y;ie.save(),ie.fillStyle="#6366F1",ie.shadowColor="#6366F1",ie.shadowBlur=8,ie.beginPath(),ie.arc(bt,Dt,3*E,0,Math.PI*2),ie.fill(),ie.restore()},ee=(ie,xe,Ce,ve,Oe)=>{if(xe.x===void 0||xe.y===void 0)return null;const Pe=xe.x*E+j.x,Ie=xe.y*E+j.y,Fe=180*E,_e=120*E,Ne=48*E,Ue=!!P&&xe.name.toLowerCase().includes(P.toLowerCase());ie.save(),ie.shadowColor=ve?"rgba(99, 102, 241, 0.4)":"rgba(0, 0, 0, 0.08)",ie.shadowBlur=(ve?24:12)*E,ie.shadowOffsetY=(ve?8:4)*E;const Be=ie.createLinearGradient(Pe,Ie,Pe,Ie+_e);Be.addColorStop(0,"#FFFFFF"),Be.addColorStop(1,"#FAFAFA"),ie.fillStyle=Be;const qe=16*E;ie.beginPath(),ie.roundRect?ie.roundRect(Pe,Ie,Fe,_e,qe):(ie.moveTo(Pe+qe,Ie),ie.lineTo(Pe+Fe-qe,Ie),ie.quadraticCurveTo(Pe+Fe,Ie,Pe+Fe,Ie+qe),ie.lineTo(Pe+Fe,Ie+_e-qe),ie.quadraticCurveTo(Pe+Fe,Ie+_e,Pe+Fe-qe,Ie+_e),ie.lineTo(Pe+qe,Ie+_e),ie.quadraticCurveTo(Pe,Ie+_e,Pe,Ie+_e-qe),ie.lineTo(Pe,Ie+qe),ie.quadraticCurveTo(Pe,Ie,Pe+qe,Ie)),ie.fill(),ie.lineWidth=(ve?2:1)*E,ie.strokeStyle=ve?"#6366F1":Ce?"#A5B4FC":Ue?"#22C55E":"#E5E7EB",ie.stroke(),ie.restore(),(ve||Ue)&&(ie.save(),ie.globalAlpha=.05,ie.fillStyle=ve?"#6366F1":"#22C55E",ie.beginPath(),ie.roundRect&&ie.roundRect(Pe,Ie,Fe,_e,qe),ie.fill(),ie.restore());const te=Pe+(Fe-Ne)/2,le=Ie+16*E;ie.save(),ie.beginPath(),ie.arc(te+Ne/2,le+Ne/2,Ne/2,0,Math.PI*2),ie.clip();const ye=$.current.get(xe.id);if(ye&&ye.complete)ie.drawImage(ye,te,le,Ne,Ne);else{const tt=ie.createLinearGradient(te,le,te+Ne,le+Ne);tt.addColorStop(0,"#818CF8"),tt.addColorStop(1,"#4F46E5"),ie.fillStyle=tt,ie.fillRect(te,le,Ne,Ne),ie.fillStyle="#FFF",ie.font=`600 ${Math.max(12,16*E)}px "Inter", sans-serif`,ie.textAlign="center",ie.textBaseline="middle";const qt=xe.name.split(" ").map(bt=>bt[0]).join("").substring(0,2).toUpperCase();ie.fillText(qt,te+Ne/2,le+Ne/2+1*E)}if(ie.restore(),ie.save(),ie.strokeStyle=ve?"#6366F1":"#FFF",ie.lineWidth=2*E,ie.beginPath(),ie.arc(te+Ne/2,le+Ne/2,Ne/2,0,Math.PI*2),ie.stroke(),ie.restore(),xe.level!==void 0&&xe.level>0){const tt=18*E,qt=te+Ne-tt/2,bt=le+Ne-tt/2;ie.save(),ie.fillStyle="#10B981",ie.shadowColor="rgba(16, 185, 129, 0.4)",ie.shadowBlur=4*E,ie.beginPath(),ie.arc(qt,bt,tt/2,0,Math.PI*2),ie.fill(),ie.fillStyle="#FFF",ie.font=`700 ${Math.max(8,9*E)}px "Inter", sans-serif`,ie.textAlign="center",ie.textBaseline="middle",ie.fillText(`L${xe.level}`,qt,bt+1*E),ie.restore()}ie.save(),ie.fillStyle="#111827",ie.font=`600 ${Math.max(11,13*E)}px "Inter", sans-serif`,ie.textAlign="center",ie.textBaseline="top";const Ve=le+Ne+12*E;let ze=xe.name;const Le=Fe-24*E;if(ie.measureText(ze).width>Le){for(;ie.measureText(ze+"...").width>Le&&ze.length>0;)ze=ze.substring(0,ze.length-1);ze+="..."}ie.fillText(ze,Pe+Fe/2,Ve),ie.fillStyle="#6B7280",ie.font=`500 ${Math.max(9,11*E)}px "Inter", sans-serif`;const rt=Ve+18*E;let Xe=(xe.role||"").replace(/_/g," ");if(Xe=Xe?Xe.charAt(0).toUpperCase()+Xe.slice(1).toLowerCase():"",ie.measureText(Xe).width>Le){for(;ie.measureText(Xe+"...").width>Le&&Xe.length>0;)Xe=Xe.substring(0,Xe.length-1);Xe+="..."}return ie.fillText(Xe,Pe+Fe/2,rt),ie.restore(),{x:Pe,y:Ie,width:Fe,height:_e}},X=(ie,xe)=>{const Ce=Y(),ve=ae(Ce),Oe=new Map;return ve.nodes.forEach(Pe=>{Pe.children&&Pe.children.forEach(Ie=>{J(ie,Pe,Ie,xe)})}),ve.nodes.forEach(Pe=>{const Ie=o?.id===Pe.id,Fe=c?.id===Pe.id,_e=ee(ie,Pe,Ie,Fe);_e&&Oe.set(Pe.id,_e)}),{nodePositions:Oe,layout:ve}},Z=ie=>{const xe=ie??s.current;if(!xe)return;const Ce=xe.getBoundingClientRect(),ve=Y(),Pe=ae(ve).bounds,Ie=180,Fe=120,_e=Math.max(1,Pe.maxX-Pe.minX+Ie),Ne=Math.max(1,Pe.maxY-Pe.minY+Fe),Ue=Pe.minX+_e/2,Be=Pe.minY+Ne/2,qe=.98,te=Ce.width*qe/_e,le=Ce.height*qe/Ne;let ye=Math.min(te,le);ye=Math.max(.3,Math.min(ye,1.5));const Ve=t!==void 0?t:ye,ze=Ce.width/2-Ue*Ve,Le=Ce.height/2-Be*Ve;t===void 0&&O(ye),T({x:ze,y:Le})};D.useEffect(()=>{if(n.length>0){const ie=setTimeout(()=>Z(),100);return()=>clearTimeout(ie)}},[n.length]),D.useEffect(()=>{t!==void 0&&n.length>0&&Z()},[t]),D.useEffect(()=>{const ie=()=>{const xe=s.current,Ce=a.current;if(!xe||!Ce)return;const ve=window.devicePixelRatio||1;se.current=ve;const Oe=Ce.getBoundingClientRect(),Pe=Math.max(1,Oe.width),Ie=Math.max(1,Oe.height);xe.width=Math.round(Pe*ve),xe.height=Math.round(Ie*ve),xe.style.width=`${Pe}px`,xe.style.height=`${Ie}px`;const Fe=xe.getContext("2d");Fe&&(Fe.setTransform(ve,0,0,ve,0,0),Z(xe))};return ie(),window.addEventListener("resize",ie),()=>window.removeEventListener("resize",ie)},[n]),D.useEffect(()=>{const ie=s.current,xe=ie?.getContext("2d");if(!ie||!xe)return;const Ce=se.current;let ve=0;const Oe=()=>{W.current+=16,xe.clearRect(0,0,ie.width/Ce,ie.height/Ce);const Pe=ie.width/Ce,Ie=ie.height/Ce,Fe=xe.createLinearGradient(0,0,Pe,Ie);Fe.addColorStop(0,"#FAFAFA"),Fe.addColorStop(1,"#F3F4F6"),xe.fillStyle=Fe,xe.fillRect(0,0,Pe,Ie);const{nodePositions:_e}=X(xe,W.current);let Ne=!1;for(const[Ue,Be]of _e.entries())if(h.x>=Be.x&&h.x<=Be.x+Be.width&&h.y>=Be.y&&h.y<=Be.y+Be.height){const qe=n.find(te=>te.id===Ue);if(qe){l(qe),Ne=!0;break}}!Ne&&o&&l(null),ve=requestAnimationFrame(Oe),I.current=ve};return I.current=requestAnimationFrame(Oe),()=>{I.current&&cancelAnimationFrame(I.current)}},[n,o,c,h,E,j,P]);const oe=ie=>{q.current=!0,B.current=!1;const xe=ie.nativeEvent.offsetX,Ce=ie.nativeEvent.offsetY;U.current={x:xe,y:Ce},F.current={x:xe,y:Ce}},H=ie=>{const xe=ie.nativeEvent.offsetX,Ce=ie.nativeEvent.offsetY;if(p({x:xe,y:Ce}),q.current){const ve=(xe-U.current.x)*1.3,Oe=(Ce-U.current.y)*1.3;Math.sqrt(Math.pow(xe-F.current.x,2)+Math.pow(Ce-F.current.y,2))>5&&(B.current=!0),T(Ie=>({x:Ie.x+ve,y:Ie.y+Oe})),U.current={x:xe,y:Ce}}},Q=()=>{q.current=!1},ne=()=>{o&&!B.current&&d(c?.id===o.id?null:o),B.current=!1},de=()=>O(ie=>Math.min(ie+.2,2.5)),ce=()=>O(ie=>Math.max(ie-.2,.4)),pe=()=>{Z(),d(null),M("")};return i.jsxs("div",{className:"relative w-full h-full bg-gradient-to-br from-slate-50 to-slate-100",ref:a,children:[r&&i.jsxs("div",{className:"absolute top-4 left-4 z-20 flex flex-col gap-3",children:[i.jsxs("div",{className:"bg-white/90 backdrop-blur-md border border-slate-200 rounded-xl shadow-xl p-3 min-w-[280px]",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Ma,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),i.jsx("input",{type:"text",placeholder:"Search employees...",value:P,onChange:ie=>M(ie.target.value),className:"w-full pl-10 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),P&&i.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:[n.filter(ie=>ie.name.toLowerCase().includes(P.toLowerCase())).length," results"]})]}),i.jsxs("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 rounded-2xl shadow-lg p-3 flex flex-col gap-3 min-w-[240px]",children:[i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsx("button",{onClick:ce,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Zoom Out",children:i.jsx(jC,{className:"w-5 h-5"})}),i.jsx("div",{className:"flex-1 px-2",children:i.jsx("input",{type:"range",min:"40",max:"250",value:Math.round(E*100),onChange:ie=>O(parseInt(ie.target.value)/100),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-indigo-500 [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-md [&::-webkit-slider-thumb]:transition-transform [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-indigo-500 [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:border-0 [&::-moz-range-thumb]:shadow-md",title:"Zoom Slider"})}),i.jsx("button",{onClick:de,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Zoom In",children:i.jsx(wC,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"px-2 min-w-[60px] text-center font-semibold text-slate-700 text-sm tabular-nums bg-slate-100 rounded-lg py-1",children:[Math.round(E*100),"%"]}),i.jsx("div",{className:"w-px h-6 bg-slate-200"}),i.jsx("button",{onClick:pe,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Reset View",children:i.jsx(NS,{className:"w-5 h-5"})})]})]})]}),i.jsx("canvas",{ref:s,className:"w-full h-full cursor-grab active:cursor-grabbing",onMouseDown:oe,onMouseMove:H,onMouseUp:Q,onMouseLeave:Q,onClick:ne}),o&&o.x!==void 0&&o.y!==void 0&&i.jsx("div",{className:"absolute pointer-events-none z-10 transform -translate-x-1/2 transition-all duration-200",style:{left:`${o.x*E+j.x+90*E}px`,top:`${Math.max(10,o.y*E+j.y-10)}px`},children:i.jsx("div",{className:"bg-white/95 backdrop-blur-xl border border-indigo-200 rounded-2xl shadow-2xl p-5 min-w-[320px] animate-fade-in-scale",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsxs("div",{className:"flex-shrink-0 relative",children:[o.photoUrl?i.jsx("img",{src:o.photoUrl,alt:o.name,className:"w-20 h-20 rounded-2xl object-cover border-3 border-indigo-500 shadow-lg"}):i.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-indigo-600 flex items-center justify-center text-white font-bold text-2xl border-3 border-white shadow-lg",children:o.name.split(" ").map(ie=>ie[0]).join("").substring(0,2).toUpperCase()}),o.level!==void 0&&o.level>0&&i.jsxs("div",{className:"absolute -bottom-2 -right-2 bg-emerald-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg",children:["L",o.level]})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-slate-900 text-xl mb-1 truncate",children:o.name}),i.jsx("p",{className:"text-sm text-indigo-600 font-medium capitalize mb-3 truncate",children:o.role.replace(/_/g," ")}),i.jsxs("div",{className:"space-y-2",children:[o.email&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(qf,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{className:"truncate",children:o.email})]}),o.phone&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(kf,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{children:o.phone})]}),o.managerName&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(Yi,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsxs("span",{className:"truncate",children:["Reports to: ",i.jsx("strong",{children:o.managerName})]})]})]}),i.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200",children:i.jsxs("p",{className:"text-xs text-slate-500 italic",children:["Click to ",c?.id===o.id?"deselect":"select and focus"]})})]})]})})}),r&&i.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-white/90 backdrop-blur-md px-6 py-3 rounded-full border border-slate-200 shadow-xl",children:i.jsxs("p",{className:"text-sm text-slate-700 font-medium flex items-center gap-3",children:[i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),"Drag to pan"]}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Hover for details"}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Click to select"})]})}),r&&i.jsxs("div",{className:"absolute top-4 right-4 bg-white/90 backdrop-blur-md border border-slate-200 rounded-2xl shadow-xl p-4 max-w-[200px]",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-900 mb-3 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),"Org Hierarchy"]}),i.jsxs("div",{className:"space-y-2.5",children:[i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded bg-gradient-to-br from-purple-500 to-indigo-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Team Member"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded bg-gradient-to-br from-emerald-400 to-emerald-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Search Match"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-8 h-0.5 bg-gradient-to-r from-indigo-400 to-purple-500 flex-shrink-0 shadow-sm"}),i.jsx("span",{children:"Reports To"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-emerald-500 text-white text-[8px] font-bold flex items-center justify-center flex-shrink-0",children:"L2"}),i.jsx("span",{children:"Level Badge"})]})]}),c&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[i.jsx("p",{className:"text-xs font-semibold text-indigo-600 mb-1",children:"Selected:"}),i.jsx("p",{className:"text-xs text-slate-700 font-medium truncate",children:c.name})]})]}),i.jsxs("div",{className:"absolute bottom-6 right-6 bg-slate-900/80 backdrop-blur-sm text-white text-xs px-3 py-2 rounded-full font-mono",children:[n.length," employees"]})]})},Qle=({users:n})=>{const[e,t]=D.useState(!1),[r,s]=D.useState(""),[a,o]=D.useState(null),[l,c]=D.useState(!0),d=()=>{s(""),o(null),setTimeout(()=>{},100)},h=()=>o(v=>Math.min((v??80)+10,250)),p=()=>o(v=>Math.max((v??80)-10,40)),x=i.jsxs("div",{className:`flex flex-col ${e?"h-screen":"h-[75vh] min-h-[500px]"}`,children:[i.jsx("div",{className:"flex-shrink-0 bg-white border-b border-slate-200 px-4 py-3",children:i.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3",children:[i.jsxs("div",{className:"relative flex-shrink-0 w-full md:w-64",children:[i.jsx(Ma,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),i.jsx("input",{type:"text",placeholder:"Search employees...",value:r,onChange:v=>s(v.target.value),className:"w-full pl-10 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),i.jsx("div",{className:"flex-1"}),i.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 rounded-lg px-3 py-2 border border-slate-200",children:[i.jsx("button",{onClick:p,className:"p-1.5 hover:bg-slate-200/60 rounded-md transition-colors text-slate-600 hover:text-slate-900",title:"Zoom Out",children:i.jsx(jC,{className:"w-4 h-4"})}),i.jsx("input",{type:"range",min:"40",max:"250",value:a??80,disabled:a===null,onChange:v=>o(parseInt(v.target.value)),className:"w-24 h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-primary [&::-webkit-slider-thumb]:cursor-pointer [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-primary [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:border-0"}),i.jsx("span",{className:"text-xs font-semibold text-slate-700 min-w-[45px] text-center",children:a?`${a}%`:"Auto"}),i.jsx("button",{onClick:h,className:"p-1.5 hover:bg-slate-200/60 rounded-md transition-colors text-slate-600 hover:text-slate-900",title:"Zoom In",children:i.jsx(wC,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:d,className:"px-3 py-2 text-sm font-medium text-slate-700 hover:text-slate-900 bg-slate-50 hover:bg-slate-100 border border-slate-200 rounded-lg transition-colors flex items-center gap-2",children:[i.jsx(NS,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Reset"})]}),i.jsxs("button",{onClick:()=>t(!e),className:"px-3 py-2 text-sm font-medium text-white bg-primary hover:bg-primary/90 rounded-lg transition-colors flex items-center gap-2",children:[e?i.jsx(dJ,{className:"w-4 h-4"}):i.jsx(NS,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:e?"Exit":"Full Screen"})]})]})]})}),i.jsxs("div",{className:"flex-1 bg-slate-50 relative overflow-hidden",children:[i.jsx(E6,{users:n,externalSearchQuery:r,externalZoom:a!==null?a/100:void 0,showControls:!1}),i.jsx("div",{className:`absolute bottom-4 right-4 z-20 ${l?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"bg-white/95 backdrop-blur-sm border border-slate-200 rounded-xl shadow-lg px-4 py-3 min-w-[200px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h4",{className:"text-xs font-bold text-slate-900 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),"Legend"]}),i.jsx("button",{onClick:()=>c(!l),className:"md:hidden text-slate-400 hover:text-slate-600",children:i.jsx(ru,{className:"w-3 h-3"})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-purple-500 to-indigo-600 border border-white shadow-sm flex-shrink-0"}),i.jsx("span",{children:"Team Member"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-emerald-400 to-emerald-600 border border-white shadow-sm flex-shrink-0"}),i.jsx("span",{children:"Search Match"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-6 h-0.5 bg-gradient-to-r from-indigo-400 to-purple-500 flex-shrink-0 shadow-sm"}),i.jsx("span",{children:"Reports To"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded-full bg-emerald-500 text-white text-[8px] font-bold flex items-center justify-center flex-shrink-0",children:"L2"}),i.jsx("span",{children:"Level Badge"})]})]})]})}),i.jsx("button",{onClick:()=>c(!l),className:"md:hidden absolute bottom-4 right-4 z-30 bg-white border border-slate-200 rounded-full p-2 shadow-lg",children:i.jsx(ru,{className:"w-5 h-5 text-slate-600"})})]}),r&&i.jsx("div",{className:"flex-shrink-0 bg-white border-t border-slate-200 px-4 py-2",children:i.jsxs("p",{className:"text-xs text-slate-600",children:[n.filter(v=>v.name.toLowerCase().includes(r.toLowerCase())).length," results found"]})})]});return e?i.jsx("div",{className:"fixed inset-0 z-50 bg-white",children:x}):i.jsx("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:x})},Xle=()=>{St();const[n,e]=D.useState([]),[t,r]=D.useState([]),[s,a]=D.useState("hr"),[o,l]=D.useState(!0),[c,d]=D.useState(!1),[h,p]=D.useState(null),[x,v]=D.useState("table"),_=D.useCallback(async()=>{l(!0);try{const[T,P,E]=await Promise.all([ue.getUsersWithManagers(),ue.getApprovalWorkflowSettings(),ue.getRoles()]);e(T),a(P.finalConfirmationRole),r(E.filter(M=>["admin","hr","operation_manager"].includes(M.id)))}catch{p({message:"Failed to load workflow data.",type:"error"})}finally{l(!1)}},[]);D.useEffect(()=>{_()},[_]);const w=(T,P)=>{e(E=>E.map(M=>M.id===T?{...M,reportingManagerId:P||void 0}:M))},j=async()=>{d(!0);try{await Promise.all(n.map(T=>ue.updateUserReportingManager(T.id,T.reportingManagerId||null))),await ue.updateApprovalWorkflowSettings(s),p({message:"Workflow saved successfully!",type:"success"}),_()}catch{p({message:"Failed to save workflow.",type:"error"})}finally{d(!1)}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(Ji,{title:"Leave Approval Settings",children:i.jsxs(re,{onClick:j,isLoading:c,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Workflow"]})}),i.jsxs("section",{className:"mb-8",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text mb-2",children:"Final Confirmation Step"}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Select the role responsible for the final confirmation of a leave request after it has been approved by the reporting manager chain."}),i.jsx("div",{className:"max-w-xs",children:i.jsx(Ke,{label:"Final Confirmation Role",id:"final-approver",value:s,onChange:T=>a(T.target.value),children:t.map(T=>i.jsx("option",{value:T.id,children:T.displayName},T.id))})})]}),i.jsxs("section",{children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-1",children:"Reporting Structure"}),i.jsx("p",{className:"text-sm text-muted",children:"View and manage organizational hierarchy"})]})}),i.jsx("div",{className:"border-b border-border mb-6",children:i.jsxs("div",{className:"flex gap-1 overflow-x-auto",children:[i.jsxs("button",{onClick:()=>v("table"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="table"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(bJ,{className:"w-4 h-4"}),"Table View"]}),i.jsxs("button",{onClick:()=>v("2d"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="2d"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(hJ,{className:"w-4 h-4"}),"2D Workflow Chart"]})]})}),o?i.jsx("div",{className:"flex justify-center items-center py-10",children:i.jsx(wt,{className:"h-6 w-6 animate-spin text-muted"})}):i.jsxs(i.Fragment,{children:[x==="table"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-muted mb-4",children:"For each employee, assign a reporting manager. Leave requests will be sent to this manager for first-level approval."}),i.jsx("div",{className:"overflow-x-auto hidden md:block border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase w-1/2",children:"Reporting Manager"})]})}),i.jsx("tbody",{className:"bg-card divide-y divide-border",children:n.map(T=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 font-medium text-primary-text",children:T.name}),i.jsx("td",{className:"px-6 py-4 text-sm text-muted capitalize",children:t.find(P=>P.id===T.role)?.displayName||T.role.replace(/_/g," ")}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs(Ke,{label:"",id:`manager-for-desktop-${T.id}`,value:T.reportingManagerId||"",onChange:P=>w(T.id,P.target.value),className:"w-full",children:[i.jsx("option",{value:"",children:"None (Reports to Final Approver)"}),n.filter(P=>P.id!==T.id).map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})})]},T.id))})]})}),i.jsx("div",{className:"space-y-3 md:hidden",children:n.map(T=>i.jsxs("div",{className:"bg-card rounded-lg border border-border overflow-hidden",children:[i.jsxs("div",{className:"p-3",children:[i.jsx("p",{className:"font-semibold text-primary-text",children:T.name}),i.jsx("p",{className:"text-sm text-muted capitalize",children:t.find(P=>P.id===T.role)?.displayName||T.role.replace(/_/g," ")})]}),i.jsxs("div",{className:"p-3 border-t border-border",children:[i.jsx("label",{className:"text-sm text-muted block mb-1",children:"Manager"}),i.jsxs(Ke,{id:`manager-for-mobile-${T.id}`,value:T.reportingManagerId||"",onChange:P=>w(T.id,P.target.value),children:[i.jsx("option",{value:"",children:"None"}),n.filter(P=>P.id!==T.id).map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})]})]},T.id))})]}),x==="2d"&&i.jsx(Qle,{users:n})]})]})]})},ece=()=>{const n=St(),[e,t]=D.useState([]),[r,s]=D.useState(!0);D.useEffect(()=>{(async()=>{try{const l=await ue.getUsersWithManagers();t(l)}catch(l){console.error("Failed to load users",l)}finally{s(!1)}})()},[]);const a=()=>{n("/admin/approval-workflow")};return r?i.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-slate-50",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-primary"})}):i.jsxs("div",{className:"w-screen h-screen relative bg-slate-50 overflow-hidden",children:[i.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-50 p-3 bg-white rounded-full shadow-xl hover:bg-gray-50 transition-all duration-200 border border-gray-200 group",title:"Close Full Screen",children:i.jsx(gi,{className:"h-6 w-6 text-gray-600 group-hover:text-red-500 transition-colors"})}),i.jsx(E6,{users:e})]})},h1=Ia(n=>({tasks:[],isLoading:!1,error:null,fetchTasks:async()=>{n({isLoading:!0,error:null});try{const e=await ue.getTasks();n({tasks:e,isLoading:!1})}catch{n({error:"Failed to fetch tasks.",isLoading:!1})}},createTask:async e=>{try{const t=await ue.createTask(e);n(r=>({tasks:[t,...r.tasks]}))}catch(t){throw console.error("Failed to create task",t),new Error("Failed to create task.")}},updateTask:async(e,t)=>{try{const r=await ue.updateTask(e,t);n(s=>({tasks:s.tasks.map(a=>a.id===e?r:a)}))}catch(r){throw console.error("Failed to update task",r),new Error("Failed to update task.")}},deleteTask:async e=>{try{await ue.deleteTask(e),n(t=>({tasks:t.tasks.filter(r=>r.id!==e)}))}catch(t){throw console.error("Failed to delete task",t),new Error("Failed to delete task.")}},runAutomaticEscalations:async()=>{try{const{updatedTasks:e,newNotifications:t}=await ue.runAutomaticEscalations();if(e.length>0&&n(r=>({tasks:r.tasks.map(s=>e.find(a=>a.id===s.id)||s)})),t.length>0){const r=t.map(s=>ue.createNotification(s));await Promise.all(r),ey.getState().fetchNotifications()}}catch(e){console.error("Failed to run automatic escalations",e)}}})),tce=Pt({completionNotes:ge().required("Completion notes are required").min(10,"Please provide more detail."),completionPhoto:Wt().required("A photo proof of completion is required.").nullable()}).defined(),nce=({isOpen:n,onClose:e,task:t,setToast:r})=>{const{updateTask:s}=h1(),[a,o]=ot.useState(!1),{handleSubmit:l,formState:{errors:c},reset:d,control:h}=tn({resolver:Dn(tce),defaultValues:{completionNotes:"",completionPhoto:null}}),p=async x=>{o(!0);try{await s(t.id,{...x,status:"Done"}),r({message:"Task completed successfully!",type:"success"}),e()}catch{r({message:"Failed to complete task.",type:"error"})}finally{o(!1)}};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:x=>x.stopPropagation(),children:i.jsxs("form",{onSubmit:l(p),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Complete Task: ",t.name]}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Provide a summary and photo proof of your work."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"completionNotes",className:"block text-sm font-medium text-muted",children:"Completion Notes"}),i.jsx("textarea",{id:"completionNotes",rows:4,...h.register("completionNotes"),className:`mt-1 bg-card border ${c.completionNotes?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`}),c.completionNotes&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionNotes.message})]}),i.jsx(we,{name:"completionPhoto",control:h,render:({field:x})=>i.jsx(yt,{label:"Upload Photo Proof",file:x.value,onFileChange:x.onChange,allowedTypes:["image/jpeg","image/png"]})}),c.completionPhoto&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionPhoto.message})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(re,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:a,children:"Mark as Done"})]})]})})}):null},rce=n=>{const e=new Date;e.setHours(0,0,0,0);const t=o=>o?new Date(o):null;if(n.status==="Done"||!n.dueDate)return{date:n.dueDate?$e(t(n.dueDate),"dd MMM, yyyy"):"-",isOverdue:!1};let r=null;const s=t(n.dueDate);switch(n.escalationStatus){case"None":r=n.escalationLevel1DurationDays?gl(s,n.escalationLevel1DurationDays):s;break;case"Level 1":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays){const o=gl(s,n.escalationLevel1DurationDays);r=gl(o,n.escalationLevel2DurationDays)}break;case"Level 2":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays&&n.escalationEmailDurationDays){const o=gl(s,n.escalationLevel1DurationDays),l=gl(o,n.escalationLevel2DurationDays);r=gl(l,n.escalationEmailDurationDays)}break}r||(r=s);const a=r?r<e:!1;return{date:$e(r,"dd MMM, yyyy"),isOverdue:a}},sce=()=>{const n=St(),{user:e}=jt(),{tasks:t,isLoading:r,error:s,fetchTasks:a,deleteTask:o,runAutomaticEscalations:l}=h1(),{theme:c}=xu(),d=c==="dark",[h,p]=D.useState(!1),[x,v]=D.useState(!1),[_,w]=D.useState(null),[j,T]=D.useState(null),[P,E]=D.useState([]),[M,O]=D.useState("all"),[I,q]=D.useState("all"),[F,B]=D.useState("all"),U=Ft("(max-width: 767px)");D.useEffect(()=>{(async()=>{ue.getUsers().then(E),await a(),await l()})()},[a,l]);const W=()=>{n("/tasks/add")},$=Q=>{n(`/tasks/edit/${Q.id}`)},se=Q=>{w(Q),p(!0)},Y=Q=>{w(Q),v(!0)},ae=async()=>{if(_)try{await o(_.id),T({message:"Task deleted.",type:"success"}),v(!1)}catch{T({message:"Failed to delete task.",type:"error"})}},J=D.useMemo(()=>t.filter(Q=>{if(M!=="all"&&Q.status!==M||I!=="all"&&Q.priority!==I)return!1;if(F==="unassigned"){if(Q.assignedToId)return!1}else if(F!=="all"&&Q.assignedToId!==F)return!1;return!0}),[t,M,I,F]),ee=()=>{O("all"),q("all"),B("all")},X=M!=="all"||I!=="all"||F!=="all",Z=Q=>{const ne={High:d?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800",Medium:d?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800",Low:d?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${ne[Q]}`,children:Q})},oe=Q=>{const ne={"To Do":d?"bg-gray-500/20 text-gray-300":"bg-gray-100 text-gray-800","In Progress":d?"bg-indigo-500/20 text-indigo-300":"bg-indigo-100 text-indigo-800",Done:d?"bg-green-500/20 text-green-300":"bg-green-100 text-green-800"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${ne[Q]}`,children:Q})},H=Q=>{if(Q==="None")return null;const ne={None:"","Level 1":d?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-800","Level 2":d?"bg-amber-500/20 text-amber-400":"bg-amber-100 text-amber-800","Email Sent":d?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${ne[Q]}`,children:Q})};return i.jsxs("div",{className:`min-h-screen ${U?"bg-[#041b0f] text-white p-4 pb-24":`p-4 ${d?"bg-[#041b0f] border border-white/10":"md:bg-card"} md:p-6 md:rounded-xl md:shadow-card`}`,children:[j&&i.jsx(ht,{message:j.message,type:j.type,onDismiss:()=>T(null)}),j&&i.jsx(ht,{message:j.message,type:j.type,onDismiss:()=>T(null)}),h&&_&&i.jsx(nce,{isOpen:h,onClose:()=>p(!1),task:_,setToast:T}),i.jsxs(Hr,{isOpen:x,onClose:()=>v(!1),onConfirm:ae,title:"Confirm Deletion",children:['Are you sure you want to delete the task "',_?.name,'"?']}),i.jsx("div",{className:"mb-6",children:i.jsx("h1",{className:`text-2xl font-bold ${U||d?"text-white":"text-gray-900"}`,children:"Task Management"})}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 md:items-end justify-between",children:[i.jsxs("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${U||d?"text-gray-300":"text-gray-700"}`,children:"Filter by Status"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${U||d?"bg-[#152b1b] border-white/10 text-white":"bg-white border-gray-300 text-gray-900"}`,value:M,onChange:Q=>O(Q.target.value),children:[i.jsx("option",{value:"all",className:U||d?"bg-[#041b0f]":"",children:"All Statuses"}),i.jsx("option",{value:"To Do",className:U||d?"bg-[#041b0f]":"",children:"To Do"}),i.jsx("option",{value:"In Progress",className:U||d?"bg-[#041b0f]":"",children:"In Progress"}),i.jsx("option",{value:"Done",className:U||d?"bg-[#041b0f]":"",children:"Done"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${U||d?"text-gray-300":"text-gray-700"}`,children:"Filter by Priority"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${U||d?"bg-[#152b1b] border-white/10 text-white":"bg-white border-gray-300 text-gray-900"}`,value:I,onChange:Q=>q(Q.target.value),children:[i.jsx("option",{value:"all",className:U||d?"bg-[#041b0f]":"",children:"All Priorities"}),i.jsx("option",{value:"Low",className:U||d?"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:U||d?"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:U||d?"bg-[#041b0f]":"",children:"High"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${U||d?"text-gray-300":"text-gray-700"}`,children:"Filter by Assignee"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${U||d?"bg-[#152b1b] border-white/10 text-white":"bg-white border-gray-300 text-gray-900"}`,value:F,onChange:Q=>B(Q.target.value),children:[i.jsx("option",{value:"all",className:U||d?"bg-[#041b0f]":"",children:"All Users"}),i.jsx("option",{value:"unassigned",className:U||d?"bg-[#041b0f]":"",children:"Unassigned"}),P.map(Q=>i.jsx("option",{value:Q.id,className:U||d?"bg-[#041b0f]":"",children:Q.name},Q.id))]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 mt-4 md:mt-0",children:[X&&i.jsxs(re,{variant:"secondary",onClick:ee,className:U||d?"!bg-[#152b1b] !text-white !border-white/10":"",children:[i.jsx(gi,{className:"mr-2 h-4 w-4"})," Clear Filters"]}),i.jsxs("button",{onClick:W,className:`flex items-center justify-center transition-colors ${U?"!bg-[#32CD32] hover:!bg-[#28a428] !text-[#0D1A0D] !font-bold !border-none shadow-none text-sm py-3 px-6 rounded-xl":"bg-emerald-600 text-white hover:bg-emerald-700 rounded-lg px-6 py-2.5 font-medium"}`,children:[i.jsx(Bt,{className:"mr-2 h-5 w-5"})," Add Task"]})]})]}),s&&i.jsx("p",{className:"text-red-500 mb-4",children:s}),i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:U?"hidden":d?"bg-white/5 text-white":"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Task Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Priority"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Next Due Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Assigned To"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Escalation"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:`divide-y md:divide-y-0 ${U?"divide-white/10 space-y-4 block":d?"divide-white/10 bg-[#041b0f]":"divide-border md:bg-card"}`,children:r?U?i.jsx("tr",{children:i.jsx("td",{colSpan:7,children:i.jsx(Ea,{rows:3,cols:7,isMobile:!0})})}):i.jsx(Ea,{rows:5,cols:7}):J.map(Q=>{const{date:ne,isOverdue:de}=rce(Q);return U?i.jsxs("div",{className:"bg-[#152b1b] p-4 rounded-xl border border-white/5 mb-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-white text-lg",children:Q.name}),i.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Due: ",i.jsx("span",{className:de?"text-red-400 font-bold":"",children:ne||"-"})]})]}),Z(Q.priority)]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500 block text-xs",children:"Assigned To"}),i.jsx("span",{className:"text-gray-300",children:Q.assignedToName||"-"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500 block text-xs",children:"Status"}),i.jsx("span",{className:"text-gray-300",children:Q.status})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 border-t border-white/10 pt-3",children:[i.jsx("button",{onClick:()=>$(Q),className:"p-2 text-gray-400 hover:text-white bg-white/5 rounded-lg",children:i.jsx(cr,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>Y(Q),className:"p-2 text-red-400 hover:text-red-300 bg-red-500/10 rounded-lg",children:i.jsx(rn,{className:"h-4 w-4"})}),Q.assignedToId===e?.id&&Q.status!=="Done"&&i.jsxs("button",{onClick:()=>se(Q),className:"flex items-center px-3 py-2 bg-emerald-500/10 text-emerald-400 rounded-lg text-sm font-medium",children:[i.jsx(Hi,{className:"h-4 w-4 mr-1.5"})," Complete"]})]})]},Q.id):i.jsxs("tr",{className:de?"bg-red-50":d?"text-gray-300 hover:bg-white/5":"",children:[i.jsx("td",{"data-label":"Task Name",className:"px-6 py-4 font-medium",children:Q.name}),i.jsx("td",{"data-label":"Priority",className:"px-6 py-4",children:Z(Q.priority)}),i.jsx("td",{"data-label":"Next Due Date",className:`px-6 py-4 text-sm ${de?"font-bold text-red-600":"text-muted"}`,children:ne||"-"}),i.jsx("td",{"data-label":"Assigned To",className:"px-6 py-4 text-sm text-muted",children:Q.assignedToName||"-"}),i.jsx("td",{"data-label":"Status",className:"px-6 py-4 text-sm text-muted",children:oe(Q.status)}),i.jsx("td",{"data-label":"Escalation",className:"px-6 py-4 text-sm text-muted",children:H(Q.escalationStatus)}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[i.jsx(re,{variant:"icon",size:"sm",onClick:()=>$(Q),title:"Edit Task",children:i.jsx(cr,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>Y(Q),title:"Delete Task",children:i.jsx(rn,{className:"h-4 w-4 text-red-600"})}),Q.assignedToId===e?.id&&Q.status!=="Done"&&i.jsxs(re,{variant:"outline",size:"sm",onClick:()=>se(Q),children:[i.jsx(Hi,{className:"h-4 w-4 mr-2"})," Complete"]})]})})]},Q.id)})})]}),!r&&J.length===0&&i.jsxs("div",{className:"text-center py-10 text-muted",children:[i.jsx("p",{className:U||d?"text-gray-400":"",children:"No tasks found matching your criteria."}),X&&i.jsx(re,{variant:"secondary",size:"sm",className:"mt-2",onClick:ee,children:"Clear filters"})]})]})]})},ice=Pt({id:ge().required(),name:ge().required("Client name is required"),organizationId:ge().optional(),location:ge().optional(),registeredAddress:ge().optional(),registrationType:ge().oneOf(["CIN","ROC","ROF","Society","Trust",""]).optional(),registrationNumber:ge().optional(),gstNumber:ge().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,"Invalid GST Number format").optional(),panNumber:ge().transform(n=>n?.toUpperCase()||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,"Invalid PAN format").optional(),email:ge().email("Invalid email format").optional(),eShramNumber:ge().optional(),shopAndEstablishmentCode:ge().optional(),epfoCode:ge().optional(),esicCode:ge().optional(),psaraLicenseNumber:ge().optional(),psaraValidTill:ge().optional().nullable(),insuranceIds:_s().of(ge().required()).optional(),policyIds:_s().of(ge().required()).optional()}).defined(),ace=({isOpen:n,onClose:e,onSave:t,initialData:r,companyName:s})=>{const[a,o]=D.useState("General"),[l,c]=D.useState([]),[d,h]=D.useState([]),[p,x]=D.useState(!0),{register:v,handleSubmit:_,formState:{errors:w},reset:j,control:T}=tn({resolver:Dn(ice)}),P=!!r;D.useEffect(()=>{n&&(x(!0),Promise.all([ue.getPolicies(),ue.getInsurances()]).then(([O,I])=>{c(O),h(I),x(!1)}),j(r||{id:`new_${Date.now()}`,name:"",location:"",registeredAddress:"",registrationType:"",registrationNumber:"",gstNumber:"",panNumber:"",email:"",eShramNumber:"",shopAndEstablishmentCode:"",epfoCode:"",esicCode:"",psaraLicenseNumber:"",psaraValidTill:"",insuranceIds:[],policyIds:[]}))},[r,j,n]);const E=O=>{t(O)};if(!n)return null;const M=({tabName:O})=>i.jsx("button",{type:"button",onClick:()=>o(O),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${a===O?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:O});return i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-3xl my-8 mx-auto animate-fade-in-scale",onClick:O=>O.stopPropagation(),children:i.jsxs("form",{onSubmit:_(E),children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:P?"Edit Client":"Add New Client"}),i.jsxs("p",{className:"text-sm text-muted",children:["for ",s]})]}),i.jsx("div",{className:"border-b border-border mb-6",children:i.jsxs("nav",{className:"-mb-px flex space-x-4",children:[i.jsx(M,{tabName:"General"}),i.jsx(M,{tabName:"Registration"}),i.jsx(M,{tabName:"Compliance"}),i.jsx(M,{tabName:"Policies & Insurance"})]})}),i.jsxs("div",{className:"space-y-6 min-h-[300px]",children:[a==="General"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(je,{label:"Client Name (as per document)",id:"name",registration:v("name"),error:w.name?.message}),i.jsx(je,{label:"Location / City",id:"location",registration:v("location"),error:w.location?.message}),i.jsx(je,{label:"Registered Address",id:"registeredAddress",registration:v("registeredAddress"),error:w.registeredAddress?.message})]}),a==="Registration"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsxs(Ke,{label:"Registration Type",id:"registrationType",registration:v("registrationType"),error:w.registrationType?.message,children:[i.jsx("option",{value:"",children:"Select Type"}),i.jsx("option",{value:"CIN",children:"CIN"}),i.jsx("option",{value:"ROC",children:"ROC"}),i.jsx("option",{value:"ROF",children:"ROF"}),i.jsx("option",{value:"Society",children:"Society"}),i.jsx("option",{value:"Trust",children:"Trust"})]}),i.jsx(je,{label:"Registration Number",id:"registrationNumber",registration:v("registrationNumber"),error:w.registrationNumber?.message}),i.jsx(je,{label:"GST Number",id:"gstNumber",registration:v("gstNumber"),error:w.gstNumber?.message}),i.jsx(je,{label:"PAN Number",id:"panNumber",registration:v("panNumber"),error:w.panNumber?.message}),i.jsx(je,{label:"Email Address",id:"email",type:"email",registration:v("email"),error:w.email?.message})]}),a==="Compliance"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(je,{label:"E-Shram Number",id:"eShramNumber",registration:v("eShramNumber"),error:w.eShramNumber?.message}),i.jsx(je,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:v("shopAndEstablishmentCode"),error:w.shopAndEstablishmentCode?.message}),i.jsx(je,{label:"EPFO Code",id:"epfoCode",registration:v("epfoCode"),error:w.epfoCode?.message}),i.jsx(je,{label:"ESIC Code",id:"esicCode",registration:v("esicCode"),error:w.esicCode?.message}),i.jsx(je,{label:"PSARA License Number",id:"psaraLicenseNumber",registration:v("psaraLicenseNumber"),error:w.psaraLicenseNumber?.message}),i.jsx(we,{name:"psaraValidTill",control:T,render:({field:O})=>i.jsx(kn,{label:"PSARA Valid Till",id:"psaraValidTill",value:O.value,onChange:O.onChange,error:w.psaraValidTill?.message})})]}),a==="Policies & Insurance"&&(p?i.jsx(wt,{className:"mx-auto h-6 w-6 animate-spin text-muted"}):i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsx(we,{name:"policyIds",control:T,render:({field:O})=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Policies"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:l.map(I=>i.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:O.value?.includes(I.id),onChange:q=>{const F=q.target.checked?[...O.value||[],I.id]:(O.value||[]).filter(B=>B!==I.id);O.onChange(F)}}),i.jsx("span",{className:"ml-3 text-sm",children:I.name})]},I.id))})]})}),i.jsx(we,{name:"insuranceIds",control:T,render:({field:O})=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Insurance"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:d.map(I=>i.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:O.value?.includes(I.id),onChange:q=>{const F=q.target.checked?[...O.value||[],I.id]:(O.value||[]).filter(B=>B!==I.id);O.onChange(F)}}),i.jsxs("span",{className:"ml-3 text-sm",children:[I.type," - ",I.provider]})]},I.id))})]})})]}))]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[i.jsx(re,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(re,{type:"submit",children:P?"Save Changes":"Add Client"})]})]})})})},Wg=({number:n,title:e,children:t})=>i.jsxs("div",{children:[i.jsxs("h4",{className:"font-bold text-lg text-primary-text mb-2",children:["Step ",n,": ",e]}),i.jsx("div",{className:"text-sm text-muted space-y-2",children:t})]}),oce=({isOpen:n,onClose:e})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-3xl my-8 animate-fade-in-scale flex flex-col",onClick:t=>t.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex items-center gap-3",children:[i.jsx(os,{className:"h-6 w-6 text-accent"}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"How to Use Import Templates"})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[70vh]",children:[i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(Da,{className:"h-5 w-5 text-red-500 mr-3 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-red-800",children:"The Golden Rule: Do Not Modify the Template Structure"}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:"You must **NEVER** add, delete, rename, or reorder columns. Any changes to the header row will cause the import to fail. This rule ensures data integrity."})]})]})}),i.jsxs(Wg,{number:1,title:"Get the Template",children:[i.jsx("p",{children:"You have two options for getting a file to work with:"}),i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(os,{className:"h-4 w-4"})," Download Template:"]}),i.jsx("span",{children:"Provides a blank CSV file with only the correct header row. Use this for adding **new** records in bulk."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(UF,{className:"h-4 w-4"})," Export Data:"]}),i.jsx("span",{children:"Provides a CSV file filled with all the current data from the system. Use this for **updating existing** records in bulk."})]})]})]}),i.jsx(Wg,{number:2,title:"Edit Your Data",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(cr,{className:"h-4 w-4"})," To Update Existing Data:"]}),i.jsx("span",{children:"Use the file from **Export Data**. Find the row you want to change and edit its values. Do **NOT** edit the ID columns (e.g., `GroupId`, `EntityId`). These are used by the system to identify records."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(Bt,{className:"h-4 w-4"})," To Add New Data:"]}),i.jsx("span",{children:"Add a new row at the bottom of the file. Leave the ID columns blank; the system will generate them automatically. Fill in all other required information."})]}),i.jsxs("li",{children:[i.jsx("strong",{className:"text-primary-text",children:"Complex Data (JSON):"}),i.jsx("span",{children:"For Site Configuration, some columns like `agreementDetails` contain complex data. This is exported as a JSON text string. Only edit this text if you are familiar with JSON, as incorrect formatting will cause the import to fail."})]})]})}),i.jsx(Wg,{number:3,title:"Save and Import",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsx("strong",{className:"text-primary-text",children:"Save as CSV:"}),i.jsx("span",{children:"After making your changes, save your file. If you are using Excel or Google Sheets, make sure to **Save As** or **Download As** a **CSV (Comma-Separated Values)** file."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(tJ,{className:"h-4 w-4"})," Import:"]}),i.jsx("span",{children:"Go back to the application, click **Import**, and select the CSV file you just saved."})]})]})}),i.jsx(Wg,{number:4,title:"Review Feedback",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-green-600 flex items-center gap-2",children:[i.jsx(Hi,{className:"h-4 w-4"})," Success:"]}),i.jsx("span",{children:"You will see a success message indicating how many records were imported."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-red-600 flex items-center gap-2",children:[i.jsx(Da,{className:"h-4 w-4"})," Error:"]}),i.jsx("span",{children:'If the import fails, a specific error message will appear. The most common error is a "Header mismatch," which means you have violated the Golden Rule. If this happens, download a fresh template and carefully copy your data into it.'})]})]})})]}),i.jsx("div",{className:"p-4 border-t flex justify-end",children:i.jsx(re,{onClick:e,children:"Close"})})]})}):null,id=({title:n})=>i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8 bg-page rounded-lg min-h-[400px]",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text mb-2",children:n}),i.jsx("p",{className:"text-muted max-w-sm",children:"Configuration for this section will be available here. The form details will be provided in a future update."})]}),TL=["Site Name","Designation","Quantity","Billing Rate","Billing Model","Holiday Billing Policy","Holiday Payment Policy","Uniform Deduction"],lce=n=>{if(n.length===0)return"";const e=Object.keys(n[0]);return[e.join(","),...n.map(r=>e.map(s=>{const a=String(r[s]??"");return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(","))].join(`
`)},cce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim()),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'""')),a[l]=d}),r.push(a)}return r},dce=()=>{const[n,e]=D.useState([]),[t,r]=D.useState(!0),[s,a]=D.useState(!1),[o,l]=D.useState({}),[c,d]=D.useState(null),h=D.useRef(null),{register:p,control:x,handleSubmit:v,watch:_,setValue:w}=tn({defaultValues:{resources:[],serviceChargePercentage:10}}),{fields:j,append:T,remove:P,replace:E}=ws({control:x,name:"resources"});D.useEffect(()=>{ue.getOrganizations().then(e).finally(()=>r(!1))},[]);const M=async ae=>{if(!ae){E([]);return}a(!0);try{const J=await ue.getManpowerDetails(ae),ee=J.filter(X=>X.count>0).map(X=>({id:`res_${X.designation.replace(/\s/g,"_")}_${Date.now()}`,siteId:ae,designation:X.designation,quantity:X.count,billingRate:null,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"}));if(!o[ae]){const X=J.map(Z=>Z.designation);l(Z=>({...Z,[ae]:X}))}E(ee)}catch(J){console.error("Failed to load manpower",J),d({message:"Failed to load manpower details.",type:"error"})}finally{a(!1)}},O=async(ae,J)=>{if(w(`resources.${J}.designation`,""),ae&&!o[ae])try{const X=(await ue.getManpowerDetails(ae)).map(Z=>Z.designation);l(Z=>({...Z,[ae]:X}))}catch(ee){console.error(`Failed to load designations for site ${ae}`,ee)}},I=_("resources"),q=_("serviceChargePercentage"),F=()=>{T({id:`res_${Date.now()}`,siteId:"",designation:"",quantity:1,billingRate:0,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"})},{subTotal:B,serviceCharge:U,grandTotal:W}=ot.useMemo(()=>{const J=(Array.isArray(I)?I:[]).reduce((oe,H)=>{const Q=Number(H.quantity)||0,ne=Number(H.billingRate)||0;return oe+Q*ne},0),ee=Number(q)||0,X=J*(ee/100),Z=J+X;return{subTotal:J,serviceCharge:X,grandTotal:Z}},[I,q]),$=()=>{const ae=[Object.fromEntries(TL.map(Z=>[Z,""]))],J=lce(ae),ee=new Blob([J],{type:"text/csv;charset=utf-8;"}),X=document.createElement("a");X.href=URL.createObjectURL(ee),X.setAttribute("download","costing_resource_template.csv"),document.body.appendChild(X),X.click(),document.body.removeChild(X)},se=ae=>{const J=ae.target.files?.[0];if(!J)return;const ee=new FileReader;ee.onload=async X=>{try{const Z=X.target?.result;if(!Z)throw new Error("File is empty.");const oe=cce(Z);if(oe.length===0)throw new Error("No data rows found in CSV.");const H=Object.keys(oe[0]);if(!TL.every(ie=>H.includes(ie)))throw new Error("CSV file is missing required headers.");const ne=new Map(n.map(ie=>[ie.shortName.toLowerCase(),ie.id])),de=new Set;for(const ie of oe){const xe=ie["Site Name"]?.trim().toLowerCase();if(xe){const Ce=ne.get(xe);typeof Ce=="string"&&de.add(Ce)}}const ce=[...de].filter(ie=>!o[ie]);if(ce.length>0){const ie=ce.map(Ce=>ue.getManpowerDetails(Ce).then(ve=>({siteId:Ce,designations:ve.map(Oe=>Oe.designation)}))),xe=await Promise.all(ie);l(Ce=>{const ve={...Ce};return xe.forEach(Oe=>{ve[Oe.siteId]=Oe.designations}),ve})}const pe=oe.map(ie=>{const xe=ie["Site Name"]?.trim().toLowerCase(),Ce=xe?ne.get(xe):void 0;return Ce?{id:`res_imported_${Date.now()}_${Math.random()}`,siteId:Ce,designation:ie.Designation||"",quantity:parseFloat(ie.Quantity)||0,billingRate:parseFloat(ie["Billing Rate"])||0,billingModel:ie["Billing Model"]||"Per Month",holidayBillingPolicy:ie["Holiday Billing Policy"]||"",holidayPaymentPolicy:ie["Holiday Payment Policy"]||"",uniformDeduction:ie["Uniform Deduction"]||"Yes"}:null}).filter(ie=>ie!==null);E(pe),d({message:`Successfully imported ${pe.length} resources.`,type:"success"})}catch(Z){d({message:Z.message||"Failed to import CSV.",type:"error"})}finally{ae.target&&(ae.target.value="")}},ee.readAsText(J)},Y=ae=>{console.log("Saving Costing & Resource Data:",ae),d({message:"Configuration saved successfully (mocked).",type:"success"})};return i.jsxs("form",{onSubmit:v(Y),className:"space-y-6",children:[c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsx("input",{type:"file",ref:h,className:"hidden",accept:".csv",onChange:se}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Costing & Resource Configuration"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsxs(Ke,{label:"Load Manpower from Site",id:"site-selector",onChange:ae=>M(ae.target.value),disabled:t||s,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),n.map(ae=>i.jsx("option",{value:ae.id,children:ae.shortName},ae.id))]}),s&&i.jsx(wt,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 md:flex md:flex-wrap md:justify-end md:gap-2",children:[i.jsxs(re,{type:"button",variant:"outline",onClick:$,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Download Template",children:[i.jsx(xi,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Template"})]}),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>h.current?.click(),className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Import",children:[i.jsx(Bc,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Import"})]}),i.jsxs(re,{type:"button",variant:"outline",onClick:F,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Add Resource",children:[i.jsx(Bt,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Add Resource"})]}),i.jsxs(re,{type:"submit",className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Save",children:[i.jsx(Ns,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Save"})]})]}),i.jsx("div",{className:"space-y-4",children:j.map((ae,J)=>{const ee=_(`resources.${J}.siteId`);return i.jsxs("div",{className:"p-4 border border-border rounded-xl relative bg-page/50",children:[i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>P(J),className:"absolute top-2 right-2","aria-label":"Remove Resource",children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsx(we,{control:x,name:`resources.${J}.siteId`,render:({field:X})=>i.jsxs(Ke,{label:"Site",id:`res-site-${J}`,...X,onChange:Z=>{X.onChange(Z),O(Z.target.value,J)},children:[i.jsx("option",{value:"",children:"Select Site"}),n.map(Z=>i.jsx("option",{value:Z.id,children:Z.shortName},Z.id))]})}),i.jsxs(Ke,{label:"Designation",id:`res-desig-${J}`,...p(`resources.${J}.designation`),disabled:!ee,children:[i.jsx("option",{value:"",children:"Select Designation"}),(o[ee]||[]).map(X=>i.jsx("option",{value:X,children:X},X))]}),i.jsx(je,{label:"Quantity",id:`res-qty-${J}`,type:"number",step:"0.01",...p(`resources.${J}.quantity`)}),i.jsx(je,{label:"Billing Rate",id:`res-rate-${J}`,type:"number",step:"0.01",...p(`resources.${J}.billingRate`)}),i.jsxs(Ke,{label:"Billing Model",id:`res-billing-${J}`,...p(`resources.${J}.billingModel`),children:[i.jsx("option",{children:"Per Month"}),i.jsx("option",{children:"Per Day"}),i.jsx("option",{children:"Per Hour"}),i.jsx("option",{children:"Lumpsum"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:`res-hol-bill-${J}`,className:"block text-sm font-medium text-muted",children:"Holiday Billing Policy"}),i.jsx("textarea",{id:`res-hol-bill-${J}`,...p(`resources.${J}.holidayBillingPolicy`),rows:3,className:"mt-1 form-input"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`res-hol-pay-${J}`,className:"block text-sm font-medium text-muted",children:"Holiday Payment Policy"}),i.jsx("textarea",{id:`res-hol-pay-${J}`,...p(`resources.${J}.holidayPaymentPolicy`),rows:3,className:"mt-1 form-input"})]}),i.jsxs(Ke,{label:"Uniform Deduction",id:`res-uniform-${J}`,...p(`resources.${J}.uniformDeduction`),children:[i.jsx("option",{children:"Yes"}),i.jsx("option",{children:"No"})]})]})]},ae.id)})}),j.length>0&&i.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:i.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsx("span",{className:"text-muted font-medium",children:"Sub Total"}),i.jsx("span",{className:"font-semibold text-primary-text",children:B.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-muted font-medium",children:"Service Charges"}),i.jsx("div",{className:"w-20",children:i.jsx(je,{"aria-label":"Service charge percentage",id:"service-charge-perc",type:"number",...p("serviceChargePercentage")})}),i.jsx("span",{className:"text-muted font-medium",children:"%"})]}),i.jsx("span",{className:"font-semibold text-primary-text",children:U.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),i.jsxs("div",{className:"flex justify-between items-center pt-2 mt-2 border-t-2 border-primary-text",children:[i.jsx("span",{className:"font-bold text-lg",children:"Grand Total"}),i.jsx("span",{className:"font-bold text-lg",children:W.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]})]})}),j.length===0&&i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:t?i.jsx(wt,{className:"h-5 w-5 animate-spin mx-auto"}):'Select a site to load manpower or click "Add Resource" to begin.'})]})},O6=["Department","Designation","PermanentId","TemporaryId"],uce=n=>{const e=O6.join(","),t=n.map(r=>[r.department,r.designation,r.permanentId,r.temporaryId].map(s=>{const a=String(s??"");return a.includes(",")?`"${a}"`:a}).join(","));return[e,...t].join(`
`)},fce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim());if(!["Department","Designation","PermanentId","TemporaryId"].every(s=>t.includes(s)))throw new Error("CSV is missing required headers.");return e.slice(1).map(s=>{const a=s.split(","),o={};return t.forEach((l,c)=>{l==="Department"&&(o.department=a[c]),l==="Designation"&&(o.designation=a[c]),l==="PermanentId"&&(o.permanentId=a[c]),l==="TemporaryId"&&(o.temporaryId=a[c])}),o})},hce=()=>{const[n,e]=D.useState(!0),[t,r]=D.useState(null),s=D.useRef(null),{register:a,control:o,handleSubmit:l,reset:c,watch:d}=tn({defaultValues:{series:[]}}),{append:h,remove:p,replace:x}=ws({control:o,name:"series"});D.useEffect(()=>{e(!0),ue.getBackOfficeIdSeries().then(M=>c({series:M})).catch(()=>r({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const v=d("series"),_=D.useMemo(()=>Array.isArray(v)?v.reduce((M,O,I)=>{const q=O.department||"Uncategorized";return M[q]||(M[q]=[]),M[q].push({...O,originalIndex:I}),M},{}):{},[v]),w=()=>{h({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:""})},j=async M=>{try{await ue.updateBackOfficeIdSeries(M.series),r({message:"Configuration saved successfully.",type:"success"})}catch{r({message:"Failed to save configuration.",type:"error"})}},T=()=>{if(!Array.isArray(v)||v.length===0){r({message:"No data to export.",type:"error"});return}const M=uce(v),O=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(O),I.setAttribute("download","back_office_id_series.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},P=()=>{const M=O6.join(","),O=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(O),I.setAttribute("download","id_series_template.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},E=M=>{const O=M.target.files?.[0];if(!O)return;const I=new FileReader;I.onload=q=>{try{const F=q.target?.result,U=fce(F).map(W=>({id:`imported_${Date.now()}_${Math.random()}`,department:W.department||"",designation:W.designation||"",permanentId:W.permanentId||"",temporaryId:W.temporaryId||""}));x(U),r({message:`Imported ${U.length} records.`,type:"success"})}catch(F){r({message:F.message||"Failed to import CSV.",type:"error"})}finally{M.target&&(M.target.value="")}},I.readAsText(O)};return i.jsxs("form",{onSubmit:l(j),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(ht,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:E}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Back Office Department & Emp ID Series"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(re,{type:"button",variant:"outline",onClick:P,children:[i.jsx(os,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Bc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(re,{type:"button",variant:"outline",onClick:T,children:[i.jsx(xi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(re,{type:"submit",children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsx("div",{className:"space-y-6",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(_).length===0?i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No ID series defined. Click "Add Designation" to begin.'}):Object.entries(_).map(([M,O])=>i.jsxs("div",{className:"border border-border rounded-xl",children:[i.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:i.jsx(je,{"aria-label":`Department for ${M}`,id:`series.${O[0].originalIndex}.department`,...a(`series.${O[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),i.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(O)&&O.map(I=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-10 gap-2 items-center",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Designation","aria-label":`Designation for ${M}`,id:`series.${I.originalIndex}.designation`,...a(`series.${I.originalIndex}.designation`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${I.designation}`,id:`series.${I.originalIndex}.permanentId`,...a(`series.${I.originalIndex}.permanentId`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${I.designation}`,id:`series.${I.originalIndex}.temporaryId`,...a(`series.${I.originalIndex}.temporaryId`)})}),i.jsx("div",{className:"md:col-span-1 text-right",children:i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>p(I.originalIndex),"aria-label":`Remove ${I.designation}`,title:`Remove ${I.designation}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},I.id))})]},M))}),i.jsxs(re,{type:"button",onClick:w,variant:"outline",className:"mt-6",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},qx=["Department","Designation","PermanentId","TemporaryId","MonthlySalary"],mce=n=>{const e=qx.join(","),t=n.map(r=>[r.department,r.designation,r.permanentId,r.temporaryId,r.monthlySalary].map(s=>{const a=String(s??"");return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(","));return[e,...t].join(`
`)},pce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,""));if(!qx.every(s=>t.includes(s)))throw new Error(`CSV is missing required headers: ${qx.join(", ")}`);const r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((c,d)=>{let h=(o[d]||"").trim();h.startsWith('"')&&h.endsWith('"')&&(h=h.substring(1,h.length-1).replace(/""/g,'""')),a[c]=h});const l=parseFloat(a.MonthlySalary);r.push({department:a.Department,designation:a.Designation,permanentId:a.PermanentId,temporaryId:a.TemporaryId,monthlySalary:isNaN(l)?null:l})}return r},gce=()=>{const[n,e]=D.useState(!0),[t,r]=D.useState(null),s=D.useRef(null),{register:a,control:o,handleSubmit:l,reset:c,watch:d}=tn({defaultValues:{designations:[]}}),{append:h,remove:p,replace:x}=ws({control:o,name:"designations"});D.useEffect(()=>{e(!0),ue.getSiteStaffDesignations().then(M=>c({designations:M})).catch(()=>r({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const v=d("designations"),_=D.useMemo(()=>Array.isArray(v)?v.reduce((M,O,I)=>{const q=O.department||"Uncategorized";return M[q]||(M[q]=[]),M[q].push({...O,originalIndex:I}),M},{}):{},[v]),w=()=>{h({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:"",monthlySalary:null})},j=async M=>{try{await ue.updateSiteStaffDesignations(M.designations),r({message:"Configuration saved successfully.",type:"success"})}catch{r({message:"Failed to save configuration.",type:"error"})}},T=()=>{if(!Array.isArray(v)||v.length===0){r({message:"No data to export.",type:"error"});return}const M=mce(v),O=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(O),I.setAttribute("download","site_staff_designations.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},P=()=>{const M=qx.join(","),O=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(O),I.setAttribute("download","site_staff_template.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},E=M=>{const O=M.target.files?.[0];if(!O)return;const I=new FileReader;I.onload=q=>{try{const F=q.target?.result,U=pce(F).map(W=>({id:`imported_${Date.now()}_${Math.random()}`,department:W.department||"",designation:W.designation||"",permanentId:W.permanentId||"",temporaryId:W.temporaryId||"",monthlySalary:W.monthlySalary||null}));x(U),r({message:`Imported ${U.length} records.`,type:"success"})}catch(F){r({message:F.message||"Failed to import CSV.",type:"error"})}finally{M.target&&(M.target.value="")}},I.readAsText(O)};return i.jsxs("form",{onSubmit:l(j),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(ht,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:E}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Staff Designation & ID Series"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(re,{type:"button",variant:"outline",onClick:P,children:[i.jsx(os,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Bc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(re,{type:"button",variant:"outline",onClick:T,children:[i.jsx(xi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(re,{type:"submit",children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsx("div",{className:"space-y-6",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(_).length===0?i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No designations defined. Click "Add Designation" to begin.'}):Object.entries(_).map(([M,O])=>i.jsxs("div",{className:"border border-border rounded-xl",children:[i.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:i.jsx(je,{"aria-label":`Department for ${M}`,id:`designations.${O[0].originalIndex}.department`,...a(`designations.${O[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),i.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(O)&&O.map(I=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-center",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Designation","aria-label":`Designation for ${M}`,id:`designations.${I.originalIndex}.designation`,...a(`designations.${I.originalIndex}.designation`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${I.designation}`,id:`designations.${I.originalIndex}.permanentId`,...a(`designations.${I.originalIndex}.permanentId`)})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(je,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${I.designation}`,id:`designations.${I.originalIndex}.temporaryId`,...a(`designations.${I.originalIndex}.temporaryId`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Monthly Salary (Gross)","aria-label":`Salary for ${I.designation}`,id:`designations.${I.originalIndex}.monthlySalary`,type:"number",...a(`designations.${I.originalIndex}.monthlySalary`,{valueAsNumber:!0})})}),i.jsx("div",{className:"md:col-span-1 text-right",children:i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>p(I.originalIndex),"aria-label":`Remove ${I.designation}`,title:`Remove ${I.designation}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},I.id))})]},M))}),i.jsxs(re,{type:"button",onClick:w,variant:"outline",className:"mt-4",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},xce=({id:n,label:e,checked:t,onChange:r,description:s,disabled:a})=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{className:"flex-grow flex flex-col",children:[i.jsx("span",{className:"text-sm font-medium text-primary-text",children:e}),s&&i.jsx("span",{className:"text-sm text-muted",children:s})]}),i.jsxs("div",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",id:n,className:"sr-only peer",checked:t,onChange:o=>r(o.target.checked),disabled:a}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-accent-dark peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent"})]})]}),$S=["Applicability","OptInDisclaimer","CoverageDetails","OptOutDisclaimer","RequireAlternateInsurance","CollectProvider","CollectStartDate","CollectEndDate","CollectExtentOfCover"],yce={applicability:"Optional - Opt-in Default",optInDisclaimer:"",coverageDetails:"",optOutDisclaimer:"",requireAlternateInsurance:!1,collectProvider:!1,collectStartDate:!1,collectEndDate:!1,collectExtentOfCover:!1},vce=n=>{const e=$S.join(","),t=$S.map(r=>{const s=r.charAt(0).toLowerCase()+r.slice(1);let a=n[s];return typeof a=="string"&&(a.includes(",")||a.includes(`
`)||a.includes('"'))?`"${a.replace(/"/g,'""')}"`:a});return[e,t.join(",")].join(`
`)},bce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)throw new Error("CSV file must have a header and at least one data row.");const t=e[0].split(",").map(a=>a.trim()),r=e[1].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[],s={};return t.forEach((a,o)=>{const l=a.charAt(0).toLowerCase()+a.slice(1);let c=(r[o]||"").trim();c.startsWith('"')&&c.endsWith('"')&&(c=c.substring(1,c.length-1).replace(/""/g,'""')),l==="applicability"?s[l]=c:typeof yce[l]=="boolean"?s[l]=c.toLowerCase()==="true":s[l]=c}),s},$g=({label:n,...e})=>i.jsxs("label",{className:"flex items-center gap-2 text-sm text-muted",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",...e}),n]}),_ce=()=>{const{gmcPolicy:n,updateGmcPolicySettings:e}=pi(),[t,r]=D.useState(null),s=D.useRef(null),{register:a,handleSubmit:o,control:l,watch:c,reset:d,formState:{isDirty:h}}=tn({defaultValues:n});D.useEffect(()=>{d(n)},[n,d]);const p=c("requireAlternateInsurance"),x=c("applicability")==="Mandatory",v=T=>{e(T),r({message:"GMC policy settings saved.",type:"success"})},_=()=>{const T=vce(n),P=new Blob([T],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a");E.href=URL.createObjectURL(P),E.setAttribute("download","gmc_policy_settings.csv"),document.body.appendChild(E),E.click(),document.body.removeChild(E)},w=()=>{const T=$S.join(","),P=new Blob([T],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a");E.href=URL.createObjectURL(P),E.setAttribute("download","gmc_policy_template.csv"),document.body.appendChild(E),E.click(),document.body.removeChild(E)},j=T=>{const P=T.target.files?.[0];if(!P)return;const E=new FileReader;E.onload=M=>{try{const O=M.target?.result,I=bce(O);d(I),r({message:"Settings imported from CSV. Review and save.",type:"success"})}catch(O){r({message:O.message||"Failed to import CSV.",type:"error"})}finally{T.target&&(T.target.value="")}},E.readAsText(P)};return i.jsxs("form",{onSubmit:o(v),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(ht,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:j}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"GMC Policy Configuration"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(re,{type:"button",variant:"outline",onClick:w,children:[i.jsx(os,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Bc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(re,{type:"button",variant:"outline",onClick:_,children:[i.jsx(xi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(re,{type:"submit",disabled:!h,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{children:i.jsx(we,{name:"applicability",control:l,render:({field:T})=>i.jsxs(Ke,{label:"Applicability",...T,children:[i.jsx("option",{children:"Mandatory"}),i.jsx("option",{children:"Optional - Opt-in Default"}),i.jsx("option",{children:"Optional - Opt-out Default"})]})})}),i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-In Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-In Disclaimer"}),i.jsx("textarea",{...a("optInDisclaimer"),rows:3,className:"form-input mt-1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Coverage Details"}),i.jsx("textarea",{...a("coverageDetails"),rows:2,className:"form-input mt-1"})]})]}),!x&&i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-Out Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-Out Disclaimer"}),i.jsx("textarea",{...a("optOutDisclaimer"),rows:3,className:"form-input mt-1"})]}),i.jsx(we,{name:"requireAlternateInsurance",control:l,render:({field:T})=>i.jsx(xce,{id:"require-alt-ins",label:"Require proof of alternate insurance on opt-out",checked:T.value,onChange:T.onChange})}),p&&i.jsxs("div",{className:"p-4 bg-page rounded-lg space-y-3",children:[i.jsx("p",{className:"text-sm text-muted",children:"Collect the following from employees who opt out:"}),i.jsx(we,{name:"collectProvider",control:l,render:({field:T})=>i.jsx($g,{label:"Provider Name",checked:T.value,onChange:T.onChange})}),i.jsx(we,{name:"collectStartDate",control:l,render:({field:T})=>i.jsx($g,{label:"Policy Start Date",checked:T.value,onChange:T.onChange})}),i.jsx(we,{name:"collectEndDate",control:l,render:({field:T})=>i.jsx($g,{label:"Policy End Date",checked:T.value,onChange:T.onChange})}),i.jsx(we,{name:"collectExtentOfCover",control:l,render:({field:T})=>i.jsx($g,{label:"Extent of Cover (Sum Assured)",checked:T.value,onChange:T.onChange})})]})]})]})]})},I6=[{key:"Phone",label:"Phone",icon:vJ},{key:"Computer",label:"Computer / Laptop",icon:lJ},{key:"Vehicle",label:"Vehicle",icon:$K},{key:"Sim",label:"SIM Card",icon:KK},{key:"IdCard",label:"Identity Card",icon:ZK},{key:"Petrocard",label:"Petrocard",icon:zF},{key:"Tools",label:"Tools",icon:aJ},{key:"Other",label:"Other Asset",icon:dm}],wce=({assetType:n,...e})=>{switch(n){case"Phone":return i.jsx(jce,{...e});case"Computer":return i.jsx(Sce,{...e});case"Vehicle":return i.jsx(kce,{...e});case"Sim":return i.jsx(Nce,{...e});case"IdCard":return i.jsx(Cce,{...e});case"Petrocard":return i.jsx(Tce,{...e});case"Tools":return i.jsx(Pce,{...e});case"Other":return i.jsx(Mce,{...e});default:return null}},jce=({index:n,control:e})=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4",children:[i.jsx(we,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(je,{label:"Brand",...t})}),i.jsx(we,{name:`assets.${n}.imei`,control:e,render:({field:t})=>i.jsx(je,{label:"IMEI Number",...t})}),i.jsx(we,{name:`assets.${n}.color`,control:e,render:({field:t})=>i.jsx(je,{label:"Colour",...t})}),i.jsx(we,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(we,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Charger",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Charger"}),i.jsx("option",{children:"Without Charger"})]})}),i.jsx(we,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Display Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(we,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Body Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(we,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),Nce=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(we,{name:`assets.${n}.number`,control:e,render:({field:t})=>i.jsx(je,{label:"SIM Number",...t})})}),Sce=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(we,{name:`assets.${n}.computerType`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Type",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Laptop"}),i.jsx("option",{children:"Desktop"}),i.jsx("option",{children:"Tab"})]})}),i.jsx(we,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(je,{label:"Brand",...t})}),i.jsx(we,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>i.jsx(je,{label:"Serial Number",...t})}),i.jsx(we,{name:`assets.${n}.windowsKey`,control:e,render:({field:t})=>i.jsx(je,{label:"Windows Key",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(we,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(we,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Charger",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Charger"}),i.jsx("option",{children:"Without Charger"})]})}),i.jsx(we,{name:`assets.${n}.bagStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Bag",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Bag"}),i.jsx("option",{children:"Without Bag"})]})}),i.jsx(we,{name:`assets.${n}.mouseStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Mouse",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Mouse"}),i.jsx("option",{children:"Without Mouse"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(we,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Display Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(we,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Body Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(we,{name:`assets.${n}.officeStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"MS Office",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Office"}),i.jsx("option",{children:"Without Office"})]})}),i.jsx(we,{name:`assets.${n}.antivirusStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Antivirus",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Antivirus"}),i.jsx("option",{children:"Without Antivirus"})]})})]}),i.jsx(we,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),Cce=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(we,{name:`assets.${n}.issueDate`,control:e,render:({field:t})=>i.jsx(kn,{label:"Date Issued",id:t.name,value:t.value,onChange:t.onChange})})}),Tce=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(we,{name:`assets.${n}.number`,control:e,render:({field:t})=>i.jsx(je,{label:"Petrocard Number",...t})})}),kce=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(we,{name:`assets.${n}.vehicleType`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Vehicle Type",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Bicycle"}),i.jsx("option",{children:"Two Wheeler"}),i.jsx("option",{children:"Three Wheeler"}),i.jsx("option",{children:"Four Wheeler"})]})}),i.jsx(we,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(je,{label:"Brand",...t})}),i.jsx(we,{name:`assets.${n}.vehicleNumber`,control:e,render:({field:t})=>i.jsx(je,{label:"Vehicle Number",...t})}),i.jsx(we,{name:`assets.${n}.chassisNumber`,control:e,render:({field:t})=>i.jsx(je,{label:"Chassis Number",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(we,{name:`assets.${n}.dlNumber`,control:e,render:({field:t})=>i.jsx(je,{label:"DL Number of User",...t})}),i.jsx(we,{name:`assets.${n}.kmsAtIssue`,control:e,render:({field:t})=>i.jsx(je,{label:"Kms at issue",type:"number",...t})}),i.jsx(we,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(we,{name:`assets.${n}.finesStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Violations / Fines",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Existing"}),i.jsx("option",{children:"Nil"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(we,{name:`assets.${n}.insuranceValidity`,control:e,render:({field:t})=>i.jsx(kn,{label:"Insurance Validity",id:t.name,value:t.value,onChange:t.onChange})}),i.jsx(we,{name:`assets.${n}.pollutionCertValidity`,control:e,render:({field:t})=>i.jsx(kn,{label:"Pollution Cert. Validity",id:t.name,value:t.value,onChange:t.onChange})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(we,{name:`assets.${n}.dlFrontPic`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture of DL (Front)",file:t.value,onFileChange:t.onChange})}),i.jsx(we,{name:`assets.${n}.dlBackPic`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture of DL (Back)",file:t.value,onFileChange:t.onChange})}),i.jsx(we,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture of Vehicle",file:t.value,onFileChange:t.onChange})})]})]}),Pce=({index:n,control:e})=>{const{fields:t,append:r,remove:s}=ws({control:e,name:`assets.${n}.toolList`});return i.jsxs("div",{className:"space-y-4 pt-4",children:[t.map((a,o)=>i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("div",{className:"flex-1",children:i.jsx(we,{name:`assets.${n}.toolList.${o}.name`,control:e,render:({field:l})=>i.jsx(je,{label:"Tool Name",...l})})}),i.jsx("div",{className:"flex-1",children:i.jsx(we,{name:`assets.${n}.toolList.${o}.description`,control:e,render:({field:l})=>i.jsx(je,{label:"Description",...l})})}),i.jsx("div",{children:i.jsx(we,{name:`assets.${n}.toolList.${o}.quantity`,control:e,render:({field:l})=>i.jsx(je,{label:"Quantity",type:"number",...l})})}),i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>s(o),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]},a.id)),i.jsxs(re,{type:"button",variant:"outline",size:"sm",onClick:()=>r({id:`tool_${Date.now()}`,name:"",description:"",quantity:1}),children:[i.jsx(Bt,{className:"mr-1 h-4 w-4"})," Add Tool"]}),i.jsx(we,{name:`assets.${n}.picture`,control:e,render:({field:a})=>i.jsx(yt,{label:"Picture of Tools",file:a.value,onFileChange:a.onChange})})]})},Mce=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(we,{name:`assets.${n}.name`,control:e,render:({field:t})=>i.jsx(je,{label:"Asset Name",placeholder:"e.g. Printer",...t})}),i.jsx(we,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(je,{label:"Brand",...t})}),i.jsx(we,{name:`assets.${n}.model`,control:e,render:({field:t})=>i.jsx(je,{label:"Model No.",...t})}),i.jsx(we,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>i.jsx(je,{label:"Serial Number",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(we,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(we,{name:`assets.${n}.issueCondition`,control:e,render:({field:t})=>i.jsx(je,{label:"Condition at time of issue",...t})})]}),i.jsx("div",{children:i.jsx(we,{name:`assets.${n}.accessories`,control:e,render:({field:t})=>i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Accessories List"}),i.jsx("textarea",{...t,rows:3,className:"form-input mt-1"})]})})}),i.jsx(we,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture of Asset",file:t.value,onFileChange:t.onChange})})]}),Dce=({item:n,index:e,control:t,errors:r,remove:s})=>{const[a,o]=D.useState(()=>n.id.startsWith("new_")),l=I6.find(p=>p.key===n.type),c=l?.icon||dm,h=(p=>"brand"in p&&p.brand?`${p.brand} ${p.type}`:"number"in p&&p.number?`${p.type} - ${p.number}`:"name"in p&&p.name?p.name:"vehicleNumber"in p&&p.vehicleNumber?p.vehicleNumber:l?.label||"Asset")(n);return i.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[i.jsxs("div",{className:"flex items-center p-3",children:[i.jsxs("button",{type:"button",onClick:()=>o(!a),className:"flex items-center gap-3 flex-grow text-left",children:[i.jsx(c,{className:"h-5 w-5 text-muted flex-shrink-0"}),i.jsx("span",{className:"font-semibold text-primary-text",children:h})]}),i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>s(e),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})}),i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>o(!a),children:i.jsx(yu,{className:`h-5 w-5 transform transition-transform ${a?"rotate-180":""}`})})]}),a&&i.jsx("div",{className:"p-4 border-t border-border",children:i.jsx(wce,{assetType:n.type,index:e,control:t,errors:r})})]})},Ece=({site:n,initialAssets:e,onSave:t,onBack:r,setToast:s})=>{const[a,o]=D.useState(!1),[l,c]=D.useState(!1),d=D.useRef(null),{control:h,handleSubmit:p,reset:x,formState:{errors:v}}=tn(),{fields:_,append:w,remove:j}=ws({control:h,name:"assets"});D.useEffect(()=>{x({assets:e})},[e,x]),D.useEffect(()=>{const E=M=>{d.current&&!d.current.contains(M.target)&&c(!1)};return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[]);const T=E=>{const M={id:`new_${E}_${Date.now()}`,type:E};let O;switch(E){case"Phone":O={...M,type:"Phone",brand:"",condition:"",chargerStatus:"",displayStatus:"",bodyStatus:"",imei:"",color:""};break;case"Sim":O={...M,type:"Sim",number:""};break;case"Computer":O={...M,type:"Computer",computerType:"",brand:"",condition:"",bagStatus:"",mouseStatus:"",chargerStatus:"",displayStatus:"",bodyStatus:"",serialNumber:"",windowsKey:"",officeStatus:"",antivirusStatus:""};break;case"IdCard":O={...M,type:"IdCard",issueDate:""};break;case"Petrocard":O={...M,type:"Petrocard",number:""};break;case"Vehicle":O={...M,type:"Vehicle",vehicleType:"",brand:"",dlNumber:"",condition:"",kmsAtIssue:null,vehicleNumber:"",chassisNumber:"",insuranceValidity:"",pollutionCertValidity:"",finesStatus:""};break;case"Tools":O={...M,type:"Tools",toolList:[]};break;case"Other":O={...M,type:"Other",name:"",brand:"",model:"",serialNumber:"",condition:"",issueCondition:"",accessories:""};break;default:return}w(O),c(!1)},P=async E=>{o(!0);try{await t(n.id,E.assets)}catch{}finally{o(!1)}};return i.jsxs("form",{onSubmit:p(P),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsxs(re,{type:"button",onClick:r,variant:"outline",size:"sm",className:"mb-2",children:[i.jsx(Aa,{className:"mr-2 h-4 w-4"})," Back to List"]}),i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Assets for: ",n.shortName]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"relative",ref:d,children:[i.jsxs(re,{type:"button",onClick:()=>c(!l),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Asset"]}),l&&i.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-card border rounded-lg shadow-lg z-10",children:I6.map(E=>i.jsxs("button",{type:"button",className:"w-full text-left px-4 py-2 text-sm hover:bg-page flex items-center gap-3",onClick:()=>T(E.key),children:[i.jsx(E.icon,{className:"h-4 w-4 text-muted"}),i.jsx("span",{children:E.label})]},E.key))})]}),i.jsxs(re,{type:"submit",isLoading:a,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),i.jsx("div",{className:"space-y-4",children:_.length>0?_.map((E,M)=>i.jsx(Dce,{item:E,index:M,control:h,errors:v,remove:j},E.id)):i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No assets found for this site. Click "Add Asset" to begin.'})})]})},Oce=({sites:n,allAssets:e,searchTerm:t,setSearchTerm:r,onViewDetails:s})=>{const a=(o=[])=>{if(!o||o.length===0)return"No assets assigned.";const l=o.reduce((c,d)=>(c[d.type]=(c[d.type]||0)+1,c),{});return Object.entries(l).map(([c,d])=>`${d} ${c}(s)`).join(", ")};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Asset Overview"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsx(Ma,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx(je,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>r(o.target.value)})]})]}),i.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Asset Summary"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),i.jsx("td",{className:"px-4 py-3 text-muted",children:a(e[o.id])}),i.jsx("td",{className:"px-4 py-3",children:i.jsx(re,{variant:"icon",size:"sm",onClick:()=>s(o.id),title:"View Details",children:i.jsx(Nl,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},Ice=()=>{const[n,e]=D.useState("list"),[t,r]=D.useState(null),[s,a]=D.useState([]),[o,l]=D.useState({}),[c,d]=D.useState(!0),[h,p]=D.useState(""),[x,v]=D.useState(null);D.useEffect(()=>{d(!0),Promise.all([ue.getOrganizations(),ue.getAllSiteAssets()]).then(([T,P])=>{a(T.sort((E,M)=>E.shortName.localeCompare(M.shortName))),l(P)}).catch(()=>v({message:"Failed to load asset configuration.",type:"error"})).finally(()=>d(!1))},[]);const _=async(T,P)=>{try{await ue.updateSiteAssets(T,P),l(E=>({...E,[T]:P})),v({message:"Assets saved successfully.",type:"success"})}catch(E){throw v({message:"Failed to save assets.",type:"error"}),E}},w=T=>{r(T),e("detail")},j=D.useMemo(()=>h?s.filter(T=>T.shortName.toLowerCase().includes(h.toLowerCase())):s,[s,h]);return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{children:[x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)}),n==="detail"&&t?i.jsx(Ece,{site:s.find(T=>T.id===t),initialAssets:o[t]||[],onSave:_,onBack:()=>e("list"),setToast:v}):i.jsx(Oce,{sites:j,allAssets:o,searchTerm:h,setSearchTerm:p,onViewDetails:w})]})},Ace=({control:n,index:e,remove:t,masterTools:r})=>{const[s,a]=D.useState(!0),o=su({control:n,name:`tools.${e}.department`}),l=su({control:n,name:`tools.${e}.name`}),c=o?r[o]||[]:[],d=l||"New Tool",h=o||"Select a department";return i.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[i.jsxs("div",{className:"flex items-center p-3",children:[i.jsxs("button",{type:"button",onClick:()=>a(!s),className:"flex items-center gap-3 flex-grow text-left",children:[i.jsx(n3,{className:"h-5 w-5 text-muted flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold text-primary-text",children:d}),i.jsx("p",{className:"text-sm text-muted",children:h})]})]}),i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>t(e),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})}),i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>a(!s),children:i.jsx(yu,{className:`h-5 w-5 transform transition-transform ${s?"rotate-180":""}`})})]}),s&&i.jsxs("div",{className:"p-4 border-t border-border space-y-4 animate-fade-in-down",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(we,{name:`tools.${e}.department`,control:n,render:({field:p})=>i.jsxs(Ke,{label:"Department",...p,children:[i.jsx("option",{value:"",children:"Select Department"}),Object.keys(r).map(x=>i.jsx("option",{value:x,children:x},x))]})}),i.jsx(we,{name:`tools.${e}.name`,control:n,render:({field:p})=>i.jsxs(Ke,{label:"Tool Name",...p,disabled:!o,children:[i.jsx("option",{value:"",children:"Select Tool"}),c.map(x=>i.jsx("option",{value:x.name,children:x.name},x.id))]})}),i.jsx(we,{name:`tools.${e}.quantity`,control:n,render:({field:p})=>i.jsx(je,{label:"Quantity",type:"number",...p})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(we,{name:`tools.${e}.picture`,control:n,render:({field:p})=>i.jsx(yt,{label:"Picture of Tool",file:p.value,onFileChange:p.onChange})}),i.jsx(we,{name:`tools.${e}.inwardDcCopy`,control:n,render:({field:p})=>i.jsx(yt,{label:"Inward DC Copy",file:p.value,onFileChange:p.onChange})}),i.jsx(we,{name:`tools.${e}.deliveryCopy`,control:n,render:({field:p})=>i.jsx(yt,{label:"Delivery Copy",file:p.value,onFileChange:p.onChange})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end",children:[i.jsx(we,{name:`tools.${e}.invoiceCopy`,control:n,render:({field:p})=>i.jsx(yt,{label:"Invoice",file:p.value,onFileChange:p.onChange})}),i.jsx(we,{name:`tools.${e}.signedReceipt`,control:n,render:({field:p})=>i.jsx(yt,{label:"Signed Receipt",file:p.value,onFileChange:p.onChange})}),i.jsx(we,{name:`tools.${e}.receiverName`,control:n,render:({field:p})=>i.jsx(je,{label:"Receiver's Name",...p})})]})]})]})},Rce=({site:n,initialTools:e,masterTools:t,onSave:r,onBack:s})=>{const[a,o]=D.useState(!1),{control:l,handleSubmit:c,reset:d}=tn(),{fields:h,append:p,remove:x}=ws({control:l,name:"tools"});D.useEffect(()=>{d({tools:e})},[e,d]);const v=()=>{p({id:`new_tool_${Date.now()}`,department:"",name:"",quantity:1})},_=async w=>{o(!0);try{await r(n.id,w.tools)}finally{o(!1)}};return i.jsxs("form",{onSubmit:c(_),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsxs(re,{type:"button",onClick:s,variant:"outline",size:"sm",className:"mb-2",children:[i.jsx(Aa,{className:"mr-2 h-4 w-4"})," Back to List"]}),i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Tools for: ",n.shortName]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(re,{type:"button",onClick:v,children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Tool"]}),i.jsxs(re,{type:"submit",isLoading:a,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),i.jsx("div",{className:"space-y-4",children:h.length>0?h.map((w,j)=>i.jsx(Ace,{control:l,index:j,remove:x,masterTools:t},w.id)):i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No tools found for this site. Click "Add Tool" to begin.'})})]})},Lce=({sites:n,allIssuedTools:e,searchTerm:t,setSearchTerm:r,onViewDetails:s})=>{const a=(o=[])=>{if(!o||o.length===0)return"No tools issued.";const l=o.reduce((d,h)=>d+(h.quantity||0),0),c=new Set(o.map(d=>d.department)).size;return`${l} tools issued across ${c} department${c>1?"s":""}.`};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Site Tools Overview"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsx(Ma,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx(je,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>r(o.target.value)})]})]}),i.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Tools Summary"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),i.jsx("td",{className:"px-4 py-3 text-muted",children:a(e[o.id])}),i.jsx("td",{className:"px-4 py-3",children:i.jsx(re,{variant:"icon",size:"sm",onClick:()=>s(o.id),title:"View Details",children:i.jsx(Nl,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},Fce=()=>{const[n,e]=D.useState(null),[t,r]=D.useState([]),[s,a]=D.useState({}),[o,l]=D.useState({}),[c,d]=D.useState(!0),[h,p]=D.useState(""),[x,v]=D.useState(null);D.useEffect(()=>{d(!0),Promise.all([ue.getOrganizations(),ue.getAllSiteIssuedTools(),ue.getToolsList()]).then(([j,T,P])=>{r(j.sort((E,M)=>E.shortName.localeCompare(M.shortName))),a(T),l(P)}).catch(()=>v({message:"Failed to load initial configuration.",type:"error"})).finally(()=>d(!1))},[]);const _=async(j,T)=>{try{await ue.updateSiteIssuedTools(j,T),a(P=>({...P,[j]:T})),v({message:"Tools list saved successfully.",type:"success"})}catch(P){throw v({message:"Failed to save tools list.",type:"error"}),P}},w=D.useMemo(()=>h?t.filter(j=>j.shortName.toLowerCase().includes(h.toLowerCase())):t,[t,h]);return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{children:[x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)}),n?i.jsx(Rce,{site:t.find(j=>j.id===n),initialTools:s[n]||[],masterTools:o,onSave:_,onBack:()=>e(null)}):i.jsx(Lce,{sites:w,allIssuedTools:s,searchTerm:h,setSearchTerm:p,onViewDetails:e})]})},qce=()=>i.jsx(id,{title:"Attendance Format"}),zce=()=>i.jsx(id,{title:"Attendance Overview"}),Uce=()=>i.jsx(id,{title:"Daily Attendance Summary"}),Vce=()=>i.jsx(id,{title:"Notification & Mail Configuration"}),Bce=()=>i.jsx(id,{title:"Onboarding Rejection Reasons"}),Wce=()=>i.jsx(id,{title:"Salary Breakup"}),$ce=()=>i.jsx(id,{title:"Salary Line Item"}),kL=(n,e)=>{const t=e.join(","),r=n.map(s=>e.map(a=>{const o=s[a]===null||s[a]===void 0?"":String(s[a]);return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...r].join(`
`)},PL=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,"")),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),a[l]=d}),r.push(a)}return r},PN=["GroupId","GroupName","CompanyId","CompanyName","EntityId","EntityName","organizationId","Location","RegisteredAddress","RegistrationType","RegistrationNumber","GSTNumber","PANNumber","Email","EShramNumber","ShopAndEstablishmentCode","EPFOCode","ESICCode","PSARALicenseNumber","PSARAValidTill"],MN=["organizationId","organizationName","location","entityId","billingName","registeredAddress","gstNumber","panNumber","email1","email2","email3","eShramNumber","shopAndEstablishmentCode","keyAccountManager","siteAreaSqFt","projectType","apartmentCount","agreementDetails","siteOperations"],ML=(n,e)=>{const t=new Blob([n],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(t),r.setAttribute("download",e),document.body.appendChild(r),r.click(),document.body.removeChild(r)},Hce=({isOpen:n,onClose:e,onSave:t,title:r,label:s,initialName:a=""})=>{const[o,l]=D.useState(a),[c,d]=D.useState("");D.useEffect(()=>{n&&l(a)},[n,a]);const h=()=>{if(!o.trim()){d("Name cannot be empty.");return}t(o),e()};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4",onClick:p=>p.stopPropagation(),children:[i.jsx("h3",{className:"text-lg font-bold",children:r}),i.jsx("div",{className:"mt-4",children:i.jsx(je,{label:s,id:"name-input",value:o,onChange:p=>{l(p.target.value),d("")},error:c})}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(re,{onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(re,{onClick:h,children:"Save"})]})]})}):null},DN=[{key:"client_structure",label:"Client Structure",icon:qF},{key:"site_configuration",label:"Site Configuration",icon:Sm},{key:"costing_resource",label:"Costing & Resource",icon:zK},{key:"backoffice_heads",label:"Back Office & ID Series",icon:Yi},{key:"staff_designation",label:"Staff Designation",icon:RK},{key:"gmc_policy",label:"GMC Policy",icon:yC},{key:"asset",label:"Asset Management",icon:OK},{key:"tools_list",label:"Tools List",icon:n3},{key:"attendance_format",label:"Attendance Format",icon:WK},{key:"attendance_overview",label:"Attendance Overview",icon:FK},{key:"notification_template",label:"Notification & Mail",icon:qf},{key:"onboard_reject_reason",label:"Onboarding Rejection Reasons",icon:Sx},{key:"salary_template",label:"Salary Breakup",icon:Sl},{key:"salary_line_item",label:"Salary Line Item",icon:Sl}],Yce=()=>{const n=St(),[e,t]=D.useState([]),[r,s]=D.useState([]),[a,o]=D.useState([]),[l,c]=D.useState(!0),[d,h]=D.useState(null),[p,x]=D.useState({}),[v,_]=D.useState("client_structure"),w=D.useRef(null),[j,T]=D.useState(""),[P,E]=D.useState(null),[M,O]=D.useState(!1),I=Ft("(max-width: 767px)"),[q,F]=D.useState({isOpen:!1,initialData:null,companyName:""}),[B,U]=D.useState({isOpen:!1,mode:"add",type:"group",title:"",label:""}),[W,$]=D.useState({isOpen:!1,type:"group",id:"",name:""}),[se,Y]=D.useState({isOpen:!1,org:null}),ae=D.useMemo(()=>e.flatMap(ve=>ve.companies.flatMap(Oe=>Oe.entities.map(Pe=>({...Pe,companyName:Oe.name})))),[e]);D.useEffect(()=>{(async()=>{c(!0);try{const[Oe,Pe,Ie]=await Promise.all([ue.getOrganizationStructure(),ue.getOrganizations(),ue.getSiteConfigurations()]);t(Oe),s(Pe),o(Ie)}catch{h({message:"Failed to load data.",type:"error"})}finally{c(!1)}})()},[]);const J=D.useMemo(()=>{if(!j.trim())return e;const ve=j.toLowerCase();return e.map(Oe=>{if(Oe.name.toLowerCase().includes(ve))return Oe;const Pe=Oe.companies.map(Ie=>{if(Ie.name.toLowerCase().includes(ve))return Ie;const Fe=Ie.entities.filter(_e=>_e.name.toLowerCase().includes(ve));return Fe.length>0?{...Ie,entities:Fe}:null}).filter(Boolean);return Pe.length>0?{...Oe,companies:Pe}:null}).filter(Boolean)},[e,j]),ee=D.useMemo(()=>{if(!j.trim())return r;const ve=j.toLowerCase();return r.filter(Oe=>Oe.shortName.toLowerCase().includes(ve))},[r,j]),X=ve=>x(Oe=>({...Oe,[ve]:!Oe[ve]})),Z=()=>{h({message:"All changes saved successfully (mocked).",type:"success"})},oe=ve=>F({isOpen:!0,initialData:null,companyName:ve}),H=(ve,Oe)=>F({isOpen:!0,initialData:ve,companyName:Oe}),Q=ve=>{h({message:ve.id.startsWith("new_")?"Client added.":"Client updated.",type:"success"}),F({isOpen:!1,initialData:null,companyName:""})},ne=(ve,Oe,Pe)=>$({isOpen:!0,type:ve,id:Oe,name:Pe}),de=()=>{const{type:ve,id:Oe,name:Pe}=W;ve==="group"?t(Ie=>Ie.filter(Fe=>Fe.id!==Oe)):ve==="company"?t(Ie=>Ie.map(Fe=>({...Fe,companies:Fe.companies.filter(_e=>_e.id!==Oe)}))):ve==="client"&&t(Ie=>Ie.map(Fe=>({...Fe,companies:Fe.companies.map(_e=>({..._e,entities:_e.entities.filter(Ne=>Ne.id!==Oe)}))}))),h({message:`${ve.charAt(0).toUpperCase()+ve.slice(1)} '${Pe}' deleted.`,type:"success"}),$({isOpen:!1,type:"group",id:"",name:""})},ce=ve=>{const{mode:Oe,type:Pe,id:Ie,groupId:Fe}=B;if(Oe==="add"){if(Pe==="group"){const _e={id:`group_${Date.now()}`,name:ve,locations:[],companies:[]};t(Ne=>[...Ne,_e]),h({message:`Group '${ve}' added.`,type:"success"})}else if(Pe==="company"&&Fe){const _e={id:`comp_${Date.now()}`,name:ve,entities:[]};t(Ne=>Ne.map(Ue=>Ue.id===Fe?{...Ue,companies:[...Ue.companies,_e]}:Ue)),h({message:`Company '${ve}' added.`,type:"success"})}}else Pe==="group"&&Ie?(t(_e=>_e.map(Ne=>Ne.id===Ie?{...Ne,name:ve}:Ne)),h({message:"Group updated.",type:"success"})):Pe==="company"&&Ie&&Fe&&(t(_e=>_e.map(Ne=>Ne.id===Fe?{...Ne,companies:Ne.companies.map(Ue=>Ue.id===Ie?{...Ue,name:ve}:Ue)}:Ne)),h({message:"Company updated.",type:"success"}));U({isOpen:!1,mode:"add",type:"group",title:"",label:""})},pe=()=>{let ve,Oe,Pe;if(v==="client_structure"){Pe=PN;const Ie=e.flatMap(Fe=>Fe.companies.flatMap(_e=>_e.entities.map(Ne=>({GroupId:Fe.id,GroupName:Fe.name,CompanyId:_e.id,CompanyName:_e.name,EntityId:Ne.id,EntityName:Ne.name,organizationId:Ne.organizationId||"",Location:Ne.location||"",RegisteredAddress:Ne.registeredAddress||"",RegistrationType:Ne.registrationType||"",RegistrationNumber:Ne.registrationNumber||"",GSTNumber:Ne.gstNumber||"",PANNumber:Ne.panNumber||"",Email:Ne.email||"",EShramNumber:Ne.eShramNumber||"",ShopAndEstablishmentCode:Ne.shopAndEstablishmentCode||"",EPFOCode:Ne.epfoCode||"",ESICCode:Ne.esicCode||"",PSARALicenseNumber:Ne.psaraLicenseNumber||"",PSARAValidTill:Ne.psaraValidTill||""}))));ve=kL(Ie,Pe),Oe="client_structure_export.csv"}else if(v==="site_configuration"){Pe=MN;const Ie=r.map(Fe=>{const _e=a.find(Ne=>Ne.organizationId===Fe.id);return{organizationId:Fe.id,organizationName:Fe.shortName,..._e||{},agreementDetails:JSON.stringify(_e?.agreementDetails||{}),siteOperations:JSON.stringify(_e?.siteOperations||{})}});ve=kL(Ie,Pe),Oe="site_configuration_export.csv"}else{h({message:"Export not implemented for this view.",type:"error"});return}ML(ve,Oe),h({message:"Data exported successfully.",type:"success"})},ie=()=>{let ve,Oe;if(v==="client_structure")ve=PN,Oe="client_structure_template.csv";else if(v==="site_configuration")ve=MN,Oe="site_configuration_template.csv";else{h({message:"Template not available for this view.",type:"error"});return}ML(ve.join(","),Oe)},xe=ve=>{const Oe=ve.target.files?.[0];if(!Oe)return;const Pe=new FileReader;Pe.onload=Ie=>{try{const Fe=Ie.target?.result;if(!Fe)throw new Error("File is empty.");const _e=Fe.trim().replace(/\r/g,"").split(`
`);if(_e.length<1)throw new Error("CSV file is empty.");const Ne=_e[0].split(",").map(Ue=>Ue.trim().replace(/"/g,""));if(v==="client_structure"){if(Ne.join(",")!==PN.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const Ue=PL(Fe);if(Ue.length===0)throw new Error("No data rows found.");const Be=new Map;for(const te of Ue){Be.has(te.GroupId)||Be.set(te.GroupId,{group:{id:te.GroupId,name:te.GroupName,locations:[],companies:[]},companiesMap:new Map});const le=Be.get(te.GroupId);le.companiesMap.has(te.CompanyId)||le.companiesMap.set(te.CompanyId,{id:te.CompanyId,name:te.CompanyName,entities:[]});const ye=le.companiesMap.get(te.CompanyId),Ve={id:te.EntityId,name:te.EntityName,organizationId:te.organizationId,location:te.Location,registeredAddress:te.RegisteredAddress,registrationType:te.RegistrationType||"",registrationNumber:te.RegistrationNumber,gstNumber:te.GSTNumber,panNumber:te.PANNumber,email:te.Email,eShramNumber:te.EShramNumber,shopAndEstablishmentCode:te.ShopAndEstablishmentCode,epfoCode:te.EPFOCode,esicCode:te.ESICCode,psaraLicenseNumber:te.PSARALicenseNumber,psaraValidTill:te.PSARAValidTill};ye.entities.push(Ve)}const qe=Array.from(Be.values()).map(te=>(te.group.companies=Array.from(te.companiesMap.values()),te.group));t(qe),h({message:`Successfully imported ${Ue.length} client records.`,type:"success"})}else if(v==="site_configuration"){if(Ne.join(",")!==MN.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const Ue=PL(Fe);if(Ue.length===0)throw new Error("No data rows found.");const Be=Ue.map(qe=>{const te={};for(const le of Object.keys(qe))if(le==="agreementDetails"||le==="siteOperations")try{te[le]=JSON.parse(qe[le])}catch{console.warn(`Could not parse JSON for ${le} in row for site ${qe.organizationId}`),te[le]={}}else te[le]=qe[le];return te});o(qe=>{const te=[...qe];return Be.forEach(le=>{const ye=te.findIndex(Ve=>Ve.organizationId===le.organizationId);ye>-1?te[ye]=le:te.push(le)}),te}),h({message:`Successfully imported ${Be.length} site configurations.`,type:"success"})}else h({message:"Import not implemented for this view.",type:"error"})}catch(Fe){h({message:Fe.message||"Failed to import CSV.",type:"error"})}finally{ve.target&&(ve.target.value="")}},Pe.readAsText(Oe)},Ce=()=>{switch(v){case"client_structure":return i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsxs(re,{onClick:()=>n("/hr/entity-management/add-group"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Bt,{className:"mr-2 h-4"}),"Add Group"]}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(re,{type:"button",variant:"outline",onClick:ie,className:"hover:bg-gray-100",children:[i.jsx(os,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>w.current?.click(),className:"hover:bg-gray-100",children:[i.jsx(Bc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(re,{type:"button",variant:"outline",onClick:pe,className:"hover:bg-gray-100",children:[i.jsx(xi,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),i.jsx("div",{className:"space-y-2",children:J.map(Oe=>i.jsxs("div",{className:"border-b border-border",children:[i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>X(Oe.id),children:i.jsx(Tf,{className:`h-5 w-5 transition-transform ${p[Oe.id]?"rotate-90":""}`})}),i.jsx($i,{className:"h-5 w-5 text-muted"}),i.jsx("span",{className:"font-semibold",children:Oe.name})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(re,{size:"sm",className:"!p-1.5",onClick:()=>U({isOpen:!0,mode:"add",type:"company",groupId:Oe.id,title:`Add Company to ${Oe.name}`,label:"Company Name"}),title:"Add Company",children:i.jsx(Bt,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",onClick:()=>U({isOpen:!0,mode:"edit",type:"group",id:Oe.id,initialName:Oe.name,title:"Edit Group Name",label:"Group Name"}),title:"Edit group name",className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(cr,{className:"h-5 w-5"})}),i.jsx(re,{variant:"icon",onClick:()=>ne("group",Oe.id,Oe.name),title:"Delete group",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]}),p[Oe.id]&&i.jsx("div",{className:"pl-6 pr-3 pb-3 space-y-2",children:Oe.companies.map(Pe=>i.jsxs("div",{className:"border border-border rounded-lg",children:[i.jsxs("div",{className:"p-2 flex items-center justify-between bg-card",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>X(Pe.id),children:i.jsx(Tf,{className:`h-5 w-5 transition-transform ${p[Pe.id]?"rotate-90":""}`})}),i.jsxs("span",{children:[Pe.name," (",Pe.entities.length," clients)"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(re,{variant:"icon",size:"sm",title:`View ${Pe.entities.length} clients`,onClick:()=>E({companyName:Pe.name,clients:Pe.entities}),children:i.jsx(Nl,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>oe(Pe.name),title:"Add client",children:i.jsx(Bt,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",onClick:()=>U({isOpen:!0,mode:"edit",type:"company",id:Pe.id,groupId:Oe.id,initialName:Pe.name,title:"Edit Company Name",label:"Company Name"}),title:"Edit company name",className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(cr,{className:"h-5 w-5"})}),i.jsx(re,{variant:"icon",onClick:()=>ne("company",Pe.id,Pe.name),title:"Delete company",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]}),p[Pe.id]&&i.jsx("div",{className:"p-2",children:Pe.entities.map(Ie=>i.jsxs("div",{className:"p-2 flex items-center justify-between hover:bg-page rounded",children:[i.jsx("span",{children:Ie.name}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(re,{variant:"icon",onClick:()=>H(Ie,Pe.name),className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(cr,{className:"h-5 w-5"})}),i.jsx(re,{variant:"icon",onClick:()=>ne("client",Ie.id,Ie.name),className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]},Ie.id))})]},Pe.id))})]},Oe.id))})]});case"site_configuration":return i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Sites Configuration"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(re,{type:"button",variant:"outline",onClick:ie,children:[i.jsx(os,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>w.current?.click(),children:[i.jsx(Bc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(re,{type:"button",variant:"outline",onClick:pe,children:[i.jsx(xi,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Configuration Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:ee.map(Oe=>{const Pe=a.find(Fe=>Fe.organizationId===Oe.id),Ie=!!Pe&&(!!Pe.billingName||!!Pe.keyAccountManager);return i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx($i,{className:"h-5 w-5 text-muted"}),i.jsx("span",{children:Oe.shortName})]})}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:Ie?i.jsxs("span",{className:"flex items-center text-green-600",children:[i.jsx(Hi,{className:"h-4 w-4 mr-1"})," Complete"]}):i.jsxs("span",{className:"flex items-center text-yellow-600",children:[i.jsx(LF,{className:"h-4 w-4 mr-1"})," Incomplete"]})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs(re,{size:"sm",variant:"outline",onClick:()=>Y({isOpen:!0,org:Oe}),children:[i.jsx(Nl,{className:"mr-2 h-4 w-4"})," View / Edit"]})})]},Oe.id)})})]})})]});case"costing_resource":return i.jsx(dce,{});case"backoffice_heads":return i.jsx(hce,{});case"staff_designation":return i.jsx(gce,{});case"gmc_policy":return i.jsx(_ce,{});case"asset":return i.jsx(Ice,{});case"tools_list":return i.jsx(Fce,{});case"attendance_format":return i.jsx(qce,{});case"attendance_overview":return i.jsx(zce,{});case"daily_attendance":return i.jsx(Uce,{});case"notification_template":return i.jsx(Vce,{});case"onboard_reject_reason":return i.jsx(Bce,{});case"salary_template":return i.jsx(Wce,{});case"salary_line_item":return i.jsx($ce,{});default:const ve=DN.find(Oe=>Oe.key===v);return i.jsx(id,{title:ve?.label||"Configuration"})}};return i.jsxs("div",{className:"p-4 space-y-6",children:[d&&i.jsx(ht,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsx(oce,{isOpen:M,onClose:()=>O(!1)}),q.isOpen&&i.jsx(ace,{...q,onClose:()=>F(ve=>({...ve,isOpen:!1})),onSave:Q}),i.jsx(Hce,{isOpen:B.isOpen,onClose:()=>U({isOpen:!1,mode:"add",type:"group",title:"",label:""}),onSave:ce,title:B.title,label:B.label,initialName:B.initialName}),i.jsxs(Hr,{isOpen:W.isOpen,onClose:()=>$(ve=>({...ve,isOpen:!1})),onConfirm:de,title:"Confirm Deletion",children:["Are you sure you want to delete the ",W.type,' "',W.name,'"? This action cannot be undone.']}),se.isOpen&&se.org&&i.jsx(z5,{isOpen:se.isOpen,onClose:()=>Y({isOpen:!1,org:null}),onSave:()=>{},organization:se.org,allClients:ae,initialData:a.find(ve=>ve.organizationId===se.org?.id)}),P&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",onClick:()=>E(null),children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 animate-fade-in-scale",onClick:ve=>ve.stopPropagation(),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text mb-4",children:["Clients in ",P.companyName]}),P.clients.length>0?i.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:P.clients.map(ve=>i.jsx("li",{className:"text-sm p-2 bg-page rounded-md",children:ve.name},ve.id))}):i.jsx("p",{className:"text-muted text-center py-4",children:"No clients found for this company."}),i.jsx("div",{className:"mt-6 text-right",children:i.jsx(re,{onClick:()=>E(null),variant:"secondary",children:"Close"})})]})}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Client Management"}),!I&&i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(re,{variant:"outline",onClick:()=>O(!0),className:"hover:bg-gray-100",children:[i.jsx(MM,{className:"mr-2 h-4 w-4"})," Help"]}),i.jsx("input",{type:"file",ref:w,className:"hidden",accept:".csv",onChange:xe}),i.jsxs(re,{onClick:Z,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save All Changes"]})]})]}),I&&i.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[i.jsxs(re,{onClick:Z,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save All Changes"]}),i.jsxs(re,{variant:"outline",onClick:()=>O(!0),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(MM,{className:"mr-2 h-4 w-4"})," Help"]}),i.jsx("input",{type:"file",ref:w,className:"hidden",accept:".csv",onChange:xe})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Ma,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx("input",{type:"text",placeholder:"Search across all clients and sites...",value:j,onChange:ve=>T(ve.target.value),className:"form-input pl-10 w-full"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx("nav",{className:"md:col-span-1",children:I?i.jsx(Ke,{label:"Configuration Section",id:"hr-config-select",value:v,onChange:ve=>_(ve.target.value),children:DN.map(ve=>i.jsx("option",{value:ve.key,children:ve.label},ve.key))}):i.jsx("div",{className:"space-y-1",children:DN.map(ve=>i.jsxs("button",{onClick:()=>_(ve.key),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg text-left transition-colors ${v===ve.key?"text-white":"text-muted hover:bg-accent-light hover:text-accent-dark"}`,style:v===ve.key?{backgroundColor:"#006B3F"}:{},children:[i.jsx(ve.icon,{className:"h-5 w-5"}),i.jsx("span",{children:ve.label})]},ve.key))})}),i.jsx("main",{className:"md:col-span-3",children:l?i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent mx-auto mt-16"}):Ce()})]})]})},Gce=({isOpen:n,onSave:e,onClose:t,initialData:r})=>{const[s,a]=D.useState(r?.name||""),[o,l]=D.useState(r?.description||""),[c,d]=D.useState(!1);D.useEffect(()=>{n&&(a(r?.name||""),l(r?.description||""),d(!1))},[n,r]);const h=async p=>{if(p&&p.preventDefault(),!!s.trim()){d(!0);try{await e({name:s.trim(),description:o.trim()})}catch(x){console.error("Error saving policy:",x),d(!1)}}};return i.jsx(Hr,{isOpen:n,onClose:t,onConfirm:h,title:`${r?"Edit":"Add"} Policy`,confirmButtonText:"Save Policy",isLoading:c,children:i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"policy-name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"policy-name",value:s,onChange:p=>a(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"policy-description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"policy-description",value:o,onChange:p=>l(p.target.value),placeholder:"Description",className:"form-input",rows:3,disabled:c})]})]})})},Zce=()=>{const n=St(),[e,t]=D.useState([]),[r,s]=D.useState(!0),[a,o]=D.useState(!1),[l,c]=D.useState(null),[d,h]=D.useState(null),p=D.useRef(!0);D.useEffect(()=>(p.current=!0,()=>{p.current=!1}),[]);const x=D.useCallback(async()=>{s(!0);try{const j=await ue.getPolicies();p.current&&t(j)}catch(j){console.error("Error fetching policies:",j),p.current&&h({message:"Failed to fetch policies.",type:"error"})}finally{p.current&&s(!1)}},[]);D.useEffect(()=>{x()},[x]);const v=async j=>{try{l?h({message:"Policy updated.",type:"success"}):(await ue.createPolicy(j),p.current&&h({message:"Policy created successfully!",type:"success"})),p.current&&(o(!1),c(null),x())}catch(T){throw console.error("Error saving policy:",T),p.current&&h({message:"Failed to save policy. Please try again.",type:"error"}),T}},_=()=>{n("/hr/policies/add")},w=j=>{c(j),o(!0)};return i.jsxs("div",{children:[d&&i.jsx(ht,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsx(Gce,{isOpen:a,onSave:v,onClose:()=>{o(!1),c(null)},initialData:l}),i.jsx(Ji,{title:"Policy Management",children:i.jsxs(re,{onClick:_,children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Policy"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Description"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):e.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:'No policies found. Click "Add Policy" to create one.'})}):e.map(j=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Policy Name",className:"px-6 py-4 font-medium",children:j.name}),i.jsx("td",{"data-label":"Description",className:"px-6 py-4 text-sm text-muted",children:j.description||""}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:i.jsx(re,{variant:"icon",size:"sm",onClick:()=>w(j),children:i.jsx(cr,{className:"h-4 w-4"})})})})]},j.id))})]})})]})},Kce=Pt({type:ge().oneOf(["GMC","GPA","WCA","Other"]).required("Type is required"),provider:ge().required("Provider is required"),policyNumber:ge().required("Policy number is required"),validTill:ge().required("Valid till date is required")}).defined(),Jce=({onSave:n,onClose:e,initialData:t})=>{const{register:r,handleSubmit:s,control:a,formState:{errors:o},reset:l}=tn({resolver:Dn(Kce)});D.useEffect(()=>{l(t||{type:"GMC",provider:"",policyNumber:"",validTill:""})},[t,l]);const c=d=>{n(d)};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4",onClick:d=>d.stopPropagation(),children:i.jsxs("form",{onSubmit:s(c),children:[i.jsxs("h3",{className:"text-lg font-bold mb-4",children:[t?"Edit":"Add"," Insurance"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(Ke,{label:"Insurance Type",id:"type",registration:r("type"),error:o.type?.message,children:[i.jsx("option",{children:"GMC"}),i.jsx("option",{children:"GPA"}),i.jsx("option",{children:"WCA"}),i.jsx("option",{children:"Other"})]}),i.jsx(je,{label:"Provider",id:"provider",registration:r("provider"),error:o.provider?.message}),i.jsx(je,{label:"Policy Number",id:"policyNumber",registration:r("policyNumber"),error:o.policyNumber?.message}),i.jsx(we,{name:"validTill",control:a,render:({field:d})=>i.jsx(kn,{label:"Valid Till",id:"validTill",value:d.value,onChange:d.onChange,error:o.validTill?.message})})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[i.jsx(re,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(re,{type:"submit",children:"Save Insurance"})]})]})})})},Qce=()=>{const[n,e]=D.useState([]),[t,r]=D.useState(!0),[s,a]=D.useState(!1),[o,l]=D.useState(null),[c,d]=D.useState(null),h=D.useCallback(async()=>{r(!0);try{const x=await ue.getInsurances();e(x)}catch{d({message:"Failed to fetch insurance policies.",type:"error"})}finally{r(!1)}},[]);D.useEffect(()=>{h()},[h]);const p=async x=>{try{o||(await ue.createInsurance(x),d({message:"Insurance created.",type:"success"})),a(!1),h()}catch{d({message:"Failed to save insurance.",type:"error"})}};return i.jsxs("div",{children:[c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)}),s&&i.jsx(Jce,{onSave:p,onClose:()=>a(!1),initialData:o}),i.jsx(Ji,{title:"Insurance Management",children:i.jsxs(re,{onClick:()=>{l(null),a(!0)},children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Insurance"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Provider"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Number"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Valid Till"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:5,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):n.map(x=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Type",className:"px-6 py-4 font-medium",children:x.type}),i.jsx("td",{"data-label":"Provider",className:"px-6 py-4 text-sm text-muted",children:x.provider}),i.jsx("td",{"data-label":"Policy Number",className:"px-6 py-4 text-sm text-muted",children:x.policyNumber}),i.jsx("td",{"data-label":"Valid Till",className:"px-6 py-4 text-sm text-muted",children:x.validTill}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:i.jsx(re,{variant:"icon",size:"sm",onClick:()=>{l(x),a(!0)},children:i.jsx(cr,{className:"h-4 w-4"})})})})]},x.id))})]})})]})},Xce=()=>{const[n,e]=D.useState("policies");return i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Policies & Insurance"})}),i.jsx("div",{children:i.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[i.jsxs("button",{onClick:()=>e("policies"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="policies"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[i.jsx(os,{className:"h-5 w-5"}),i.jsx("span",{children:"Company Policies"})]}),i.jsxs("button",{onClick:()=>e("insurance"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="insurance"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[i.jsx(KF,{className:"h-5 w-5"}),i.jsx("span",{children:"Insurance Plans"})]})]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[n==="policies"&&i.jsx(Zce,{}),n==="insurance"&&i.jsx(Qce,{})]})]})},Hg={documents:{aadhaar:!1,pan:!1,bankProof:!1,educationCertificate:!1,salarySlip:!1,uanProof:!1,familyAadhaar:!1},verifications:{requireBengaluruAddress:!1,requireDobVerification:!1}},ede=()=>{const n=Kc(),[e,t]=D.useState(null),[r,s]=D.useState([]),[a,o]=D.useState("Administrator");D.useEffect(()=>{ue.getSiteStaffDesignations().then(P=>{const E=[...new Set(P.map(M=>M.designation))];E.includes("Administrator")||E.unshift("Administrator"),s(E.map((M,O)=>({id:`${O}`,designation:M,department:"",permanentId:"",temporaryId:""})))})},[]);const{register:l,handleSubmit:c,control:d,formState:{isDirty:h},watch:p,reset:x,setValue:v}=tn({defaultValues:n});D.useEffect(()=>{x(n)},[n,x]),D.useEffect(()=>{n.rulesByDesignation?.[a]||(Object.keys(Hg.documents).forEach(E=>{v(`rulesByDesignation.${a}.documents.${E}`,!0,{shouldDirty:!0})}),Object.keys(Hg.verifications).forEach(E=>{v(`rulesByDesignation.${a}.verifications.${E}`,!0,{shouldDirty:!0})}))},[a,n.rulesByDesignation,v]);const _=p("enforceManpowerLimit"),w=p("enableEsiRule"),j=p("enableGmcRule"),T=P=>{n.updateRules(P),t({message:"Enrollment rules saved successfully!",type:"success"}),x(P)};return i.jsxs("form",{onSubmit:c(T),className:"p-4 space-y-8 w-full",children:[e&&i.jsx(ht,{message:e.message,type:e.type,onDismiss:()=>t(null)}),i.jsx(Ji,{title:"Enrollment Rules",children:i.jsxs(re,{type:"submit",disabled:!h,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(os,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"Designation-Specific Rules"}),i.jsx("p",{className:"text-muted",children:"Set mandatory documents and verifications for specific roles."})]})]}),i.jsx("div",{className:"mb-4",children:i.jsx(Ke,{label:"Configure rules for designation",value:a,onChange:P=>o(P.target.value),children:r.map(P=>i.jsx("option",{value:P.designation,children:P.designation},P.id))})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Mandatory Documents"}),i.jsx("div",{className:"space-y-3",children:Object.keys(Hg.documents).map(P=>i.jsx(we,{name:`rulesByDesignation.${a}.documents.${P}`,control:d,defaultValue:!0,render:({field:E})=>i.jsx(Pn,{id:`${a}-${P}`,label:P.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()),checked:E.value,onChange:E.onChange})},P))})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Data Verifications"}),i.jsx("div",{className:"space-y-3",children:Object.keys(Hg.verifications).map(P=>i.jsx(we,{name:`rulesByDesignation.${a}.verifications.${P}`,control:d,defaultValue:!0,render:({field:E})=>i.jsx(Pn,{id:`${a}-${P}`,label:P.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()),checked:E.value,onChange:E.onChange})},P))})]})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Sl,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"ESI Eligibility"}),i.jsx("p",{className:"text-muted",children:"Define salary threshold for statutory insurance."})]}),i.jsx(we,{name:"enableEsiRule",control:d,render:({field:P})=>i.jsx(Pn,{id:"enableEsiRule",label:"Enable Rule",checked:P.value,onChange:P.onChange})})]}),i.jsx("div",{className:`transition-opacity ${w?"opacity-100":"opacity-50 pointer-events-none"}`,children:i.jsxs("div",{className:"max-w-sm",children:[i.jsx(je,{label:"ESI Eligibility Gross Salary Threshold",id:"esiCtcThreshold",type:"number",registration:l("esiCtcThreshold",{valueAsNumber:!0}),disabled:!w}),i.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees at or below this amount are eligible for ESI. Those above are eligible for GMC."})]})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Sl,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"GMC/Insurance Policy Rules"}),i.jsx("p",{className:"text-muted",children:"Set default GMC policies."})]}),i.jsx(we,{name:"enableGmcRule",control:d,render:({field:P})=>i.jsx(Pn,{id:"enableGmcRule",label:"Enable Rule",checked:P.value,onChange:P.onChange})})]}),i.jsxs("div",{className:`transition-opacity ${j?"opacity-100":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[i.jsx(je,{label:"GMC Salary Threshold",id:"salaryThreshold",type:"number",registration:l("salaryThreshold",{valueAsNumber:!0}),disabled:!j}),i.jsx(we,{name:"defaultPolicySingle",control:d,render:({field:P})=>i.jsxs(Ke,{label:"Policy (Single)",...P,disabled:!j,children:[i.jsx("option",{value:"1L",children:"1 Lakh"}),i.jsx("option",{value:"2L",children:"2 Lakh"})]})}),i.jsx(we,{name:"defaultPolicyMarried",control:d,render:({field:P})=>i.jsxs(Ke,{label:"Policy (Married)",...P,disabled:!j,children:[i.jsx("option",{value:"1L",children:"1 Lakh"}),i.jsx("option",{value:"2L",children:"2 Lakh"})]})})]}),i.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees with a salary *above* this threshold will be eligible for GMC."})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Yi,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Manpower Allocation"}),i.jsx("p",{className:"text-muted",children:"Set rules for enrolling based on approved manpower."})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(we,{name:"enforceManpowerLimit",control:d,render:({field:P})=>i.jsx(Pn,{id:"enforceManpowerLimit",label:"Enforce Manpower Allocation Limits",description:"Check new enrollments against the approved manpower count for the site.",checked:P.value,onChange:P.onChange})}),i.jsx("div",{className:`max-w-sm transition-opacity ${_?"opacity-100":"opacity-50 pointer-events-none"}`,children:i.jsxs(Ke,{label:"Action When Limit is Reached",id:"manpowerLimitRule",registration:l("manpowerLimitRule"),disabled:!_,children:[i.jsx("option",{value:"warn",children:"Warn field officer but allow enrollment"}),i.jsx("option",{value:"block",children:"Block enrollment and require approval"})]})})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(cr,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Field Officer Permissions"}),i.jsx("p",{className:"text-muted",children:"Control what field officers can do during enrollment."})]})]}),i.jsx("div",{className:"space-y-4",children:i.jsx(we,{name:"allowSalaryEdit",control:d,render:({field:P})=>i.jsx(Pn,{id:"allowSalaryEdit",label:"Allow Salary Editing",description:"Permit field officers to edit default salary, triggering an approval workflow.",checked:P.value??!1,onChange:P.onChange})})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(uu,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Family Details Validation"}),i.jsx("p",{className:"text-muted",children:"Set rules for validating family member details."})]})]}),i.jsx("div",{className:"space-y-4",children:i.jsx(we,{name:"enforceFamilyValidation",control:d,render:({field:P})=>i.jsx(Pn,{id:"enforceFamilyValidation",label:"Enforce Strict Family Validation",description:"Enable checks for duplicates, age, and gender based on relationship.",checked:P.value??!1,onChange:P.onChange})})})]})]})},tde=()=>{const{id:n}=If(),e=St(),[t,r]=D.useState(null),[s,a]=D.useState(!0),[o,l]=D.useState(!1),c=D.useRef(null),{data:d,setFormsGenerated:h}=$n(),p=SC(O=>O.currentLogo),[x,v]=D.useState(!1);D.useEffect(()=>{(async()=>{if(n&&!n.startsWith("draft_")){a(!0);const I=await ue.getOnboardingDataById(n);r(I||null),a(!1)}else r(d),a(!1)})()},[n,d]);const _=async()=>{const O=c.current;if(O&&t){v(!0);try{const I=O.outerHTML,q={margin:0,filename:`Onboarding_Forms_${t?.personal.employeeId}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ue.generatePdf(I,q)}catch(I){console.error("PDF generation failed:",I)}finally{v(!1)}}},w=()=>{h(!0),e(`/onboarding/add/review?id=${n}`)};if(s||x)return i.jsx("div",{className:"text-center p-10",children:i.jsx(wt,{className:"h-8 w-8 animate-spin mx-auto"})});if(!t)return i.jsx("div",{className:"text-center p-10 text-red-500",children:"Could not find employee data."});const j=t,T=`${j.personal.firstName} ${j.personal.middleName||""} ${j.personal.lastName}`.replace(/\s+/g," ").trim(),P=j.family.find(O=>O.relation==="Father")?.name||"",E=j.family.find(O=>O.relation==="Spouse")?.name||"",M=j.family.find(O=>O.relation==="Mother")?.name||"";return i.jsx("div",{className:"bg-page",children:i.jsxs("div",{className:"max-w-4xl p-4 sm:p-6 lg:p-8",children:[i.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card no-print mb-8 sticky top-4 z-10",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsxs(re,{type:"button",onClick:()=>e(-1),variant:"secondary",children:[i.jsx(Aa,{className:"mr-2 h-4 w-4"})," Go Back"]}),i.jsxs("div",{className:"text-center",children:[i.jsx("h2",{className:"font-bold text-lg",children:"Review Official Forms"}),i.jsx("p",{className:"text-sm text-muted",children:"Please confirm these details before submitting."})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(re,{type:"button",onClick:_,variant:"outline",disabled:x,children:[x?i.jsx(wt,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(xi,{className:"mr-2 h-4 w-4"}),x?"Generating...":"Download"]}),i.jsx(re,{type:"button",onClick:w,children:"Confirm & Continue"})]})]})}),i.jsxs("div",{ref:c,className:"bg-white rounded-xl border border-border shadow-lg",children:[i.jsx("div",{className:"pdf-page p-8 font-serif text-sm text-black",children:i.jsxs("div",{className:"border-4 border-black p-6 h-full flex flex-col",children:[i.jsx("h1",{className:"text-center text-xl font-bold tracking-widest mb-8",children:"EMPLOYEE PERSONAL DATA"}),i.jsx("div",{className:"w-64 mx-auto border-2 border-black p-2 my-8",children:i.jsx("img",{src:p,alt:"Paradigm Logo",className:"w-full"})}),i.jsxs("div",{className:"mt-auto space-y-8 text-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S NAME"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:T})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"SITE"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.organization.organizationName})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"DESIGNATION"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.organization.designation})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S ID NO."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.personal.employeeId})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"PF No."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.uan.pfNumber||j.uan.uanNumber})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"ESI NO."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.esi.esiNumber})]})]})]})}),i.jsx("div",{className:"page-break"}),i.jsx("div",{className:"pdf-page p-8 font-serif text-xs text-black",children:i.jsxs("div",{className:"border-2 border-black p-4 h-full relative",children:[i.jsx("div",{className:"absolute top-4 right-4 w-48",children:i.jsx("img",{src:p,alt:"Paradigm Logo",className:"w-full"})}),i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h2",{className:"font-bold",children:["EMPLOYEE ID No. : ",i.jsx("span",{className:"font-normal underline",children:j.personal.employeeId})]}),i.jsx("h1",{className:"text-center font-bold text-base tracking-wider",children:"PERSONAL DATA"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("p",{children:["1. Name: ",i.jsx("span",{className:"underline",children:T})]}),i.jsxs("p",{children:["2. Father's Name: ",i.jsx("span",{className:"underline",children:P})]}),i.jsxs("p",{children:["3. Mother's Name: ",i.jsx("span",{className:"underline",children:M})]}),i.jsxs("p",{children:["4. Reference by: ",i.jsx("span",{className:"underline"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["5. Date of Birth: ",i.jsx("span",{className:"underline",children:j.personal.dob})]}),i.jsxs("p",{children:["6. Age: ",i.jsx("span",{className:"underline",children:j.personal.dob?new Date().getFullYear()-new Date(j.personal.dob).getFullYear():""})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["7. Qualification: ",i.jsx("span",{className:"underline",children:j.education[0]?.degree||""})]}),i.jsxs("p",{children:["8. Experience: ",i.jsx("span",{className:"underline"})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["9. Designation: ",i.jsx("span",{className:"underline",children:j.organization.designation})]}),i.jsxs("p",{children:["10. Net Salary Offered: ",i.jsx("span",{className:"underline",children:j.personal.salary?.toLocaleString("en-IN")})]})]}),i.jsxs("p",{children:["11. Present Address: ",i.jsx("span",{className:"underline",children:`${j.address.present.line1}, ${j.address.present.city}, ${j.address.present.state} - ${j.address.present.pincode}`})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["12. Permanent Address: ",i.jsx("span",{className:"underline",children:j.address.sameAsPresent?"Same as Present":`${j.address.permanent.line1}, ${j.address.permanent.city}`})]}),i.jsxs("p",{children:["Ph. No.: ",i.jsx("span",{className:"underline",children:j.personal.mobile})," Alternate Ph. No.: ",i.jsx("span",{className:"underline",children:j.personal.alternateMobile||""})]})]}),i.jsx("p",{children:"13. Left hand thumb impression"}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{})]}),i.jsx("p",{children:"14. Right hand thumb impression"}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["15. Marital Status: ",i.jsx("span",{className:"underline",children:j.personal.maritalStatus})]}),i.jsxs("p",{children:["16. Name of the Spouse: ",i.jsx("span",{className:"underline",children:E})," Contact No.: ",i.jsx("span",{className:"underline"})]})]}),i.jsxs("p",{children:["17. Languages Known: to Speak ",i.jsx("span",{className:"underline"})," to Write ",i.jsx("span",{className:"underline"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["18. Date of Joining: ",i.jsx("span",{className:"underline",children:j.organization.joiningDate})]}),i.jsx("p",{children:"19. ID Card:"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["20. ESI Number: ",i.jsx("span",{className:"underline",children:j.esi.esiNumber})]}),i.jsxs("p",{children:["21. PF Number: ",i.jsx("span",{className:"underline",children:j.uan.pfNumber||j.uan.uanNumber})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"22. Uniform Details: "}),i.jsx("p",{children:"23. Shoe Details: "})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["24. Name of the Site: ",i.jsx("span",{className:"underline",children:j.organization.organizationName})]}),i.jsx("p",{children:"25. Site / Estate Manager: "})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"26. Record enclosed: "}),i.jsx("p",{children:"28. Reference Name:"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"27. Hirer: "}),i.jsx("p",{className:"ml-24",children:"Reference Ph.:"})]}),i.jsxs("p",{children:["29. Emergency Contact Name: ",i.jsx("span",{className:"underline",children:j.personal.emergencyContactName})," Ph.: ",i.jsx("span",{className:"underline",children:j.personal.emergencyContactNumber})," Blood Group: ",i.jsx("span",{className:"underline",children:j.personal.bloodGroup})]})]}),i.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between",children:[i.jsx("p",{children:"Employee Signature:"}),i.jsx("p",{children:"Documented by:"})]})]})})]})]})})},nde=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-blue-100 text-blue-800",Issued:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},Yg=({title:n,sizes:e,headers:t,control:r,quantityType:s,quantities:a,readOnly:o=!1})=>{const l=Array.from(new Set(e.map(d=>d.fit))),c=Array.from(new Set(e.map(d=>d.size))).sort((d,h)=>{const p=parseInt(String(d)),x=parseInt(String(h));return!isNaN(p)&&!isNaN(x)?p-x:String(d).localeCompare(String(h))});return i.jsxs("div",{className:"border rounded-lg flex flex-col overflow-hidden",children:[i.jsx("h4",{className:"p-3 font-semibold bg-page border-b flex-shrink-0",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:"Size"}),t.map(d=>i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:d.label},String(d.key))),i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted w-20",children:"Qty"})]})}),i.jsx("tbody",{className:"divide-y",children:c.map(d=>i.jsx(ot.Fragment,{children:l.map((h,p)=>{const x=e.find(v=>v.size===d&&v.fit===h);return x?i.jsxs("tr",{children:[p===0&&i.jsx("td",{rowSpan:l.filter(v=>e.some(_=>_.size===d&&_.fit===v)).length,className:"px-2 py-2 align-middle font-semibold border-r",children:d}),t.map(v=>i.jsx("td",{className:"px-2 py-2",children:x[v.key]},String(v.key))),i.jsx("td",{className:"px-2 py-2",children:o?i.jsx("span",{className:"font-semibold block text-center pr-4",children:a?.[x.id]||0}):i.jsx(we,{name:`${s}.${x.id}`,control:r,render:({field:v})=>i.jsx(je,{"aria-label":`Quantity for ${n} size ${d} ${h}`,type:"number",...v,value:v.value||"",onChange:_=>v.onChange(parseInt(_.target.value)||null),className:"!py-1.5"})})})]},x.id):null})},d))})]})})]})},rde=({request:n,onClose:e,masterUniforms:t})=>{if(!n)return null;const{pantsQuantities:r,shirtsQuantities:s}=D.useMemo(()=>{const o={},l={};return n.items.forEach(c=>{c.category==="Pants"?o[c.sizeId]=c.quantity:l[c.sizeId]=c.quantity}),{pantsQuantities:o,shirtsQuantities:l}},[n.items]),a=n.gender==="Gents"?t.gents:t.ladies;return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-6xl my-4 animate-fade-in-scale flex flex-col max-h-[90vh]",onClick:o=>o.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-start flex-shrink-0",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Uniform Request Details"}),i.jsxs("p",{className:"text-sm text-muted",children:[n.siteName," - ",$e(new Date(n.requestedDate),"dd MMM, yyyy")]})]}),i.jsx(re,{variant:"icon",onClick:e,children:i.jsx(gi,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-6",children:i.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:n.gender==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Yg,{readOnly:!0,title:"Gents' Pants",sizes:a.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],quantities:r}),i.jsx(Yg,{readOnly:!0,title:"Gents' Shirts",sizes:a.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],quantities:s})]}):i.jsxs(i.Fragment,{children:[i.jsx(Yg,{readOnly:!0,title:"Ladies' Pants",sizes:a.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],quantities:r}),i.jsx(Yg,{readOnly:!0,title:"Ladies' Shirts",sizes:a.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],quantities:s})]})})}),i.jsx("div",{className:"p-4 border-t flex justify-end flex-shrink-0",children:i.jsx(re,{variant:"secondary",onClick:e,children:"Close"})})]})})},sde=()=>{const n=St(),[e,t]=D.useState("list"),[r,s]=D.useState([]),[a,o]=D.useState([]),[l,c]=D.useState(null),[d,h]=D.useState(!0),[p,x]=D.useState(null),[v,_]=D.useState(null),[w,j]=D.useState(null),[T,P]=D.useState(null),E=async()=>{h(!0);try{const[q,F,B,U]=await Promise.all([ue.getUniformRequests(),ue.getOrganizations(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);s(q),o(F),c({gents:B,ladies:U})}catch{x({message:"Failed to load uniform data.",type:"error"})}finally{h(!1)}};D.useEffect(()=>{E()},[]);const M=()=>{n("/uniforms/request/new")},O=q=>{n(`/uniforms/request/edit/${q.id}`)},I=async()=>{if(w)try{await ue.deleteUniformRequest(w.id),x({message:"Request deleted.",type:"success"}),j(null),E()}catch{x({message:"Failed to delete request.",type:"error"})}};return d?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"p-4 space-y-6",children:[p&&i.jsx(ht,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Hr,{isOpen:!!w,onClose:()=>j(null),onConfirm:I,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),l&&i.jsx(rde,{request:T,onClose:()=>P(null),masterUniforms:l}),i.jsx("div",{className:"bg-card p-4 rounded-2xl",children:i.jsx(Ji,{title:"Uniform Management",children:e==="list"&&i.jsxs(re,{onClick:M,children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," New Uniform Request"]})})}),e==="list"&&i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site / Employee"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Gender"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Requested By"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Source"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{children:r.map(q=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Site",className:"px-4 py-3 font-medium",children:[i.jsx("p",{children:q.siteName}),q.source==="Individual"&&q.employeeDetails?.[0]?.employeeName&&i.jsxs("p",{className:"text-xs text-muted",children:["For: ",q.employeeDetails[0].employeeName]}),q.source==="Enrollment"&&i.jsxs("p",{className:"text-xs text-muted",children:["(",q.employeeDetails?.length||0," employees)"]})]}),i.jsx("td",{"data-label":"Gender",className:"px-4 py-3 text-muted",children:q.gender}),i.jsx("td",{"data-label":"Requested By",className:"px-4 py-3 text-muted",children:q.requestedByName||"System"}),i.jsx("td",{"data-label":"Source",className:"px-4 py-3 text-muted",children:q.source||"Bulk"}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(nde,{status:q.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[i.jsx(re,{variant:"icon",size:"sm",onClick:()=>P(q),title:"View Request",children:i.jsx(Nl,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>O(q),title:"Edit Request",disabled:q.source==="Enrollment",children:i.jsx(cr,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>j(q),title:"Delete Request",disabled:q.source==="Enrollment",children:i.jsx(rn,{className:"h-4 w-4 text-red-600"})})]})})]},q.id))})]}),r.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No uniform requests found."})]})]})},ide=({item:n})=>{const[e,t]=D.useState(!1);return i.jsxs("div",{className:"bg-card rounded-xl border border-border p-4",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-primary-text",children:n.employeeName}),i.jsx("p",{className:"text-sm text-muted",children:n.employeeId}),i.jsx("p",{className:"text-xs text-muted mt-1",children:$e(new Date(n.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")})]}),i.jsx("div",{className:"text-right",children:i.jsxs("p",{className:"text-lg font-bold text-accent",children:["",n.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),n.breakdown.length>0&&i.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[i.jsxs("button",{onClick:()=>t(!e),className:"flex justify-between items-center w-full text-sm text-muted",children:[i.jsx("span",{children:"Details"}),i.jsx(yu,{className:`h-4 w-4 transition-transform ${e?"rotate-180":""}`})]}),e&&i.jsx("ul",{className:"list-disc list-inside space-y-1 mt-2 text-sm text-muted animate-fade-in-down",children:n.breakdown.map((r,s)=>i.jsxs("li",{children:[r.name,": ",(r.cost||0).toFixed(2)]},s))})]})]})},ade=()=>i.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,e)=>i.jsxs("div",{className:"bg-card rounded-xl border border-border p-4 space-y-3 skeleton-pulse",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-5 w-32 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-24 bg-gray-300 rounded"})]}),i.jsx("div",{className:"h-6 w-20 bg-gray-300 rounded"})]}),i.jsx("div",{className:"h-4 w-1/4 bg-gray-300 rounded mt-2"})]},e))}),ode=()=>{const[n,e]=D.useState([]),[t,r]=D.useState(!0),{verificationCosts:s,updateVerificationCosts:a}=pi(),[o,l]=D.useState(s),[c,d]=D.useState(!1),[h,p]=D.useState([{startDate:uf(new Date,29),endDate:new Date,key:"selection"}]),[x,v]=D.useState("Last 30 Days"),[_,w]=D.useState(!1),j=D.useRef(null),[T,P]=D.useState(null),E=D.useRef(null),M=Ft("(max-width: 767px)"),O=D.useCallback(async()=>{const Z=h[0]?.startDate,oe=h[0]?.endDate;if(!(!Z||!oe)){r(!0);try{const H=await ue.getVerificationCostBreakdown($e(Z,"yyyy-MM-dd"),$e(oe,"yyyy-MM-dd"));e(H)}catch(H){console.error("Failed to fetch cost breakdown",H),P({message:"Failed to load verification data.",type:"error"})}finally{r(!1)}}},[h]);D.useEffect(()=>{O()},[O]),D.useEffect(()=>{const Z=oe=>{j.current&&!j.current.contains(oe.target)&&w(!1)};return document.addEventListener("mousedown",Z),()=>document.removeEventListener("mousedown",Z)},[]),D.useEffect(()=>{l(s)},[s]),D.useEffect(()=>{d(JSON.stringify(o)!==JSON.stringify(s))},[o,s]);const I=(Z,oe,H)=>{l(Q=>Q.map(ne=>ne.id===Z?oe==="cost"?{...ne,cost:parseFloat(H)||0}:{...ne,name:H}:ne))},q=()=>{l(Z=>[...Z,{id:`new_${Date.now()}`,name:"New Verification Type",cost:0}])},F=Z=>{l(oe=>oe.filter(H=>H.id!==Z))},B=()=>{a(o),P({message:"Costs updated successfully!",type:"success"})},U=D.useMemo(()=>{const Z=new Map(s.map(oe=>[oe.name,oe.cost]));return n.map(oe=>{const H=oe.breakdown.map(ne=>({...ne,cost:Number(Z.get(ne.name))||0})),Q=H.reduce((ne,de)=>ne+(de.cost||0)*de.count,0);return{...oe,breakdown:H,totalCost:Q}})},[n,s]),W=D.useMemo(()=>{const Z=U.length,oe=U.reduce((Q,ne)=>Q+ne.totalCost,0),H=Z>0?oe/Z:0;return{totalEmployees:Z,totalCost:oe,averageCost:H}},[U]),$=D.useMemo(()=>{const Z={};return U.forEach(oe=>{oe.breakdown.forEach(H=>{Z[H.name]||(Z[H.name]={count:0,total:0}),Z[H.name].count+=H.count,Z[H.name].total+=(H.cost||0)*H.count})}),Object.entries(Z).map(([oe,H])=>({name:oe,...H}))},[U]),[se,Y]=D.useState(!1),ae=async Z=>{{const oe=E.current;if(!oe){P({message:"Could not find report to export.",type:"error"});return}Y(!0);try{const H=oe.outerHTML,Q={margin:.5,filename:`Cost_Analysis_Report_${$e(h[0].startDate,"yyyy-MM-dd")}_to_${$e(h[0].endDate,"yyyy-MM-dd")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ue.generatePdf(H,Q)}catch(H){console.error("PDF generation failed:",H),P({message:"Failed to generate PDF.",type:"error"})}finally{Y(!1)}}},J=[{label:"Today",value:"Today"},{label:"Last 7 Days",value:"Last 7 Days"},{label:"Last 30 Days",value:"Last 30 Days"}],ee=Z=>{const oe=new Date;let H=new Date;Z==="Today"?H=Jg():Z==="Last 7 Days"?H=uf(oe,6):Z==="Last 30 Days"&&(H=uf(oe,29)),v(Z),p([{startDate:H,endDate:oe,key:"selection"}]),w(!1)},X=Z=>{p([Z.selection])};return i.jsxs("div",{className:"p-4 space-y-6",children:[T&&i.jsx(ht,{message:T.message,type:T.type,onDismiss:()=>P(null)}),i.jsx(Ji,{title:"Verification Costing",children:i.jsx("div",{className:"w-full sm:w-auto",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:flex sm:items-center sm:flex-wrap",children:[i.jsxs(re,{onClick:()=>ae(),variant:"outline",size:"sm",disabled:se||t||U.length===0,children:[se?i.jsx(wt,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(xi,{className:"mr-2 h-4 w-4"}),se?"Generating PDF...":"Download PDF"]}),J.map(Z=>i.jsx(re,{variant:x===Z.value?"outline":"secondary",size:"sm",onClick:()=>ee(Z.value),className:"justify-center",children:Z.label},Z.value)),i.jsxs("div",{className:"relative",ref:j,children:[i.jsxs(re,{variant:x==="Custom"?"outline":"secondary",size:"sm",onClick:()=>{w(Z=>!Z),v("Custom")},className:"w-full justify-center",children:[i.jsx(ka,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Custom Range"})]}),_&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:i.jsx(hm.DateRangePicker,{onChange:X,ranges:h,maxDate:new Date,direction:"horizontal"})})]})]})})}),i.jsx("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"cursor-pointer flex justify-between items-center list-none",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2 text-primary-text",children:[i.jsx(Sm,{className:"h-5 w-5 text-muted"})," Cost Configuration"]}),i.jsx(yu,{className:"transition-transform group-open:rotate-180"})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t",children:[i.jsx("div",{className:"space-y-2",children:o.map(Z=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[i.jsx("div",{className:"col-span-12 sm:col-span-6",children:i.jsx(je,{"aria-label":"Cost Item Name",value:Z.name,onChange:oe=>I(Z.id,"name",oe.target.value),className:"!py-2"})}),i.jsx("div",{className:"col-span-8 sm:col-span-4",children:i.jsx(je,{"aria-label":"Cost Value",type:"number",step:"0.01",value:Z.cost||0,onChange:oe=>I(Z.id,"cost",oe.target.value),className:"!py-2"})}),i.jsx("div",{className:"col-span-4 sm:col-span-2 text-right",children:i.jsx(re,{variant:"icon",onClick:()=>F(Z.id),"aria-label":`Remove ${Z.name}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},Z.id))}),i.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[i.jsxs(re,{type:"button",variant:"outline",size:"sm",onClick:q,children:[i.jsx(Bt,{className:"mr-2 h-4"})," Add Cost Item"]}),i.jsxs(re,{onClick:B,disabled:!c,children:[i.jsx(Ns,{className:"mr-2 h-4"})," Save Costs"]})]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx(_o,{title:"Total Verification Cost",value:`${W.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Sl}),i.jsx(_o,{title:"Total Verified Employees",value:W.totalEmployees,icon:Yi}),i.jsx(_o,{title:"Avg. Cost Per Employee",value:`${W.averageCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Sl})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Verification Usage Breakdown"}),t?i.jsx("div",{className:"flex justify-center items-center h-24",children:i.jsx(wt,{className:"h-6 w-6 animate-spin text-muted"})}):$.length>0?i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:$.map(Z=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border",children:[i.jsx("p",{className:"text-sm font-medium text-muted",children:Z.name}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:Z.count}),i.jsxs("p",{className:"text-sm font-semibold text-accent-dark",children:["Total: ",Z.total.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Z.name))}):i.jsx("p",{className:"text-center text-muted py-8",children:"No verification data for this period."})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx("div",{className:"flex justify-between items-center",children:i.jsx("h3",{className:"text-lg font-semibold text-primary-text",children:"Detailed Report"})}),i.jsx("div",{ref:E,className:"mt-4 pt-4 border-t border-border",children:M?t?i.jsx(ade,{}):U.length===0?i.jsx("p",{className:"text-center text-muted py-8",children:"No report data for this period."}):i.jsx("div",{className:"space-y-4",children:U.map(Z=>i.jsx(ide,{item:Z},Z.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Enrollment Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Cost Breakdown"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase",children:"Total Cost"})]})}),i.jsx("tbody",{children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10",children:i.jsx(wt,{className:"h-6 w-6 animate-spin text-muted mx-auto"})})}):U.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No report data for this period."})}):U.map(Z=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Employee",className:"px-6 py-4",children:[i.jsx("div",{className:"font-medium text-primary-text",children:Z.employeeName}),i.jsx("div",{className:"text-sm text-muted",children:Z.employeeId})]}),i.jsx("td",{"data-label":"Enrollment Date",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:$e(new Date(Z.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")}),i.jsx("td",{"data-label":"Cost Breakdown",className:"px-6 py-4 text-sm text-muted",children:i.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[Z.breakdown.map((oe,H)=>i.jsxs("li",{children:[oe.name,": ",(oe.cost||0).toFixed(2)]},H)),Z.breakdown.length===0&&i.jsx("li",{children:"No verifications performed"})]})}),i.jsxs("td",{"data-label":"Total Cost",className:"px-6 py-4 whitespace-nowrap text-right font-semibold text-primary-text",children:["",Z.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Z.id))})]})})})]})]})},lde=({status:n})=>{if(!n)return i.jsx("span",{className:"text-xs text-muted",children:"-"});const e={"Not Generated":"bg-slate-700 text-white dark:bg-slate-600 dark:text-slate-200",Generated:"bg-sky-100 text-sky-800 dark:bg-sky-500/20 dark:text-sky-300",Sent:"bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-300",Paid:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${e[n]}`,children:n})},cde=({invoiceData:n,discount:e,setDiscount:t,roundOff:r,setRoundOff:s})=>{const a=l=>new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l),o=D.useMemo(()=>{if(!n)return null;const l=n.lineItems.reduce((x,v)=>{const _=v.deployment*v.ratePerMonth;return v.description.toLowerCase().includes("deduction")?x-_:x+_},0),c=l*.1,d=l+c-e,h=d*.09,p=d+h+h+r;return{subTotal:l,serviceCharge:c,grandTotal:d,gst:h,finalTotal:p}},[n,e,r]);return o?i.jsxs("div",{className:"p-4 bg-white text-black text-[10px] printable-area",children:[i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("div",{children:[i.jsxs("p",{children:["Name : ",n.siteName]}),i.jsxs("p",{children:["Address : ",n.siteAddress]}),i.jsxs("p",{children:["City : ",n.siteAddress.split(",").pop()?.trim()]})]}),i.jsxs("div",{className:"border border-black",children:[i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Invoice No"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceNumber})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Date"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceDate})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Month"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.statementMonth.split("-")[0]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-black",children:"Due Date"}),i.jsx("div",{className:"p-1",children:"January 15, 2023"})]})]})]}),i.jsx("div",{className:"my-4 flex justify-center",children:i.jsx(Gi,{className:"h-10"})}),i.jsxs("h2",{className:"text-center font-bold text-sm underline mb-2",children:[n.siteName," Summary Statement for the month of ",n.statementMonth]}),i.jsxs("table",{className:"w-full border-collapse border border-black",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"font-bold bg-gray-200",children:[i.jsx("td",{className:"border p-1 border-black",children:"Sl.No"}),i.jsx("td",{className:"border p-1 border-black",children:"Description"}),i.jsx("td",{className:"border p-1 border-black",children:"Deployment"}),i.jsx("td",{className:"border p-1 border-black",children:"No of Days"}),i.jsx("td",{className:"border p-1 border-black",children:"Rate/Day"}),i.jsx("td",{className:"border p-1 border-black",children:"Rate/Month"}),i.jsx("td",{className:"border p-1 border-black",children:"Amount(Rs)"})]})}),i.jsxs("tbody",{children:[i.jsx("tr",{children:i.jsxs("td",{className:"border p-1 border-black font-bold",colSpan:7,children:["SERVICES (01/",$e(new Date(n.statementMonth),"MM/yyyy")," to ",$e(new Date(n.invoiceDate),"dd/MM/yyyy"),")"]})}),n.lineItems.map((l,c)=>{const d=l.deployment*l.ratePerMonth,h=l.description.toLowerCase().includes("deduction"),p=l.deployment===0;return i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1 border-black text-center",children:c+1}),i.jsx("td",{className:`border p-1 border-black ${h?"text-red-600":""}`,children:l.description}),i.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":l.deployment}),i.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":l.noOfDays}),i.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":a(l.ratePerDay)}),i.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":a(l.ratePerMonth)}),i.jsx("td",{className:`border p-1 border-black text-right ${h?"text-red-600":""}`,children:a(d)})]},l.id)}),Array.from({length:Math.max(0,10-n.lineItems.length)}).map((l,c)=>i.jsx("tr",{children:i.jsx("td",{className:"border p-1 border-black h-6",colSpan:7})},`spacer-${c}`))]}),i.jsxs("tfoot",{children:[i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Sub Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:a(o.subTotal)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Admin,Overheads and Service Charges 10% on Sub Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.serviceCharge)})]}),i.jsxs("tr",{className:"no-print",children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold text-red-600",children:"Discount"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:i.jsx(je,{type:"number",value:e,onChange:l=>t(parseFloat(l.target.value)||0),className:"text-right !p-1"})})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Grand Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:a(o.grandTotal)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"Central GST"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.gst)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"State GST"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.gst)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Round off"}),i.jsxs("td",{colSpan:2,className:"border p-1 border-black text-right",children:[i.jsx("span",{className:"print-only",children:a(r)}),i.jsx("span",{className:"no-print",children:i.jsx(je,{type:"number",step:"0.01",value:r,onChange:l=>s(parseFloat(l.target.value)||0),className:"text-right !p-1"})})]})]}),i.jsxs("tr",{className:"bg-gray-200 font-bold text-base",children:[i.jsx("td",{colSpan:5,className:"border p-2 border-black",children:"Payable for Services rendered"}),i.jsx("td",{colSpan:2,className:"border p-2 border-black text-right",children:a(o.finalTotal)})]})]})]})]}):null},dde=()=>{const[n,e]=D.useState([]),[t,r]=D.useState(!0),[s,a]=D.useState(!1),[o,l]=D.useState($e(new Date,"yyyy-MM")),[c,d]=D.useState({}),[h,p]=D.useState({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),[x,v]=D.useState(0),[_,w]=D.useState(.2),[j,T]=D.useState(null),P=D.useRef(null),[E,M]=D.useState(!1);D.useEffect(()=>{ue.getOrganizations().then(B=>e(B.sort((U,W)=>U.shortName.localeCompare(W.shortName)))).catch(()=>T({message:"Failed to load sites.",type:"error"})).finally(()=>r(!1))},[]);const O=D.useCallback(async B=>{a(!0);try{const U=new Date(B+"-02"),W=await ue.getInvoiceStatuses(U);d(W)}catch{T({message:"Failed to fetch invoice statuses.",type:"error"})}finally{a(!1)}},[]);D.useEffect(()=>{o&&O(o)},[o,O]);const I=async B=>{p({isOpen:!0,site:B,invoiceData:null,isLoading:!0});try{const U=new Date(o+"-02"),W=await ue.getInvoiceSummaryData(B.id,U);p({isOpen:!0,site:B,invoiceData:W,isLoading:!1})}catch{T({message:"Failed to fetch invoice data.",type:"error"}),p({isOpen:!1,site:null,invoiceData:null,isLoading:!1})}},q=async()=>{const B=P.current;if(!B||!h.invoiceData){T({message:"Could not find invoice to export.",type:"error"});return}M(!0);try{const U=B.outerHTML,W={margin:.25,filename:`Invoice_${h.invoiceData.siteName.replace(" ","_")}_${h.invoiceData.statementMonth}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ue.generatePdf(U,W)}catch(U){console.error("PDF generation failed:",U),T({message:"Failed to generate PDF.",type:"error"})}finally{M(!1)}},F=()=>{p({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),v(0),w(.2)};return t?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"p-4 md:p-0",children:[j&&i.jsx(ht,{message:j.message,type:j.type,onDismiss:()=>T(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx(Ji,{title:"Invoice Summary"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Monthly Invoice Status"}),i.jsx("div",{className:"md:w-56",children:i.jsx(je,{label:"",id:"month-select",type:"month",value:o,onChange:B=>l(B.target.value)})})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Invoice Status"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:n.map(B=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:B.shortName}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:s?i.jsx(wt,{className:"h-4 w-4 animate-spin"}):i.jsx(lde,{status:c[B.id]})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[i.jsx(re,{variant:"icon",size:"sm",onClick:()=>I(B),disabled:c[B.id]==="Not Generated"||s,title:"View Invoice",children:i.jsx(Nl,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>I(B),disabled:c[B.id]==="Not Generated"||s,title:"Download Invoice",children:i.jsx(xi,{className:"h-4 w-4"})})]})})]},B.id))})]})})]})]}),h.isOpen&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:F,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl m-4 animate-fade-in-scale flex flex-col",onClick:B=>B.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center no-print",children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Invoice for ",h.site?.shortName]}),i.jsx(re,{variant:"icon",onClick:F,children:i.jsx(gi,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-4 max-h-[70vh]",children:h.isLoading?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):h.invoiceData?i.jsx("div",{ref:P,children:i.jsx(cde,{invoiceData:h.invoiceData,discount:x,setDiscount:v,roundOff:_,setRoundOff:w})}):i.jsx("p",{className:"text-center text-muted",children:"No data to display."})}),i.jsx("div",{className:"p-4 border-t flex justify-end no-print",children:i.jsxs(re,{onClick:q,disabled:!h.invoiceData||E,children:[E?i.jsx(wt,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(xi,{className:"mr-2 h-4 w-4"}),E?"Generating...":"Download PDF"]})})]})})]})};var Bh={exports:{}};var ude=Bh.exports,DL;function fde(){return DL||(DL=1,(function(n,e){(function(t,r){r(e)})(ude,(function(t){var r="1.9.4";function s(f){var y,C,A,V;for(C=1,A=arguments.length;C<A;C++){V=arguments[C];for(y in V)f[y]=V[y]}return f}var a=Object.create||(function(){function f(){}return function(y){return f.prototype=y,new f}})();function o(f,y){var C=Array.prototype.slice;if(f.bind)return f.bind.apply(f,C.call(arguments,1));var A=C.call(arguments,2);return function(){return f.apply(y,A.length?A.concat(C.call(arguments)):arguments)}}var l=0;function c(f){return"_leaflet_id"in f||(f._leaflet_id=++l),f._leaflet_id}function d(f,y,C){var A,V,K,he;return he=function(){A=!1,V&&(K.apply(C,V),V=!1)},K=function(){A?V=arguments:(f.apply(C,arguments),setTimeout(he,y),A=!0)},K}function h(f,y,C){var A=y[1],V=y[0],K=A-V;return f===A&&C?f:((f-V)%K+K)%K+V}function p(){return!1}function x(f,y){if(y===!1)return f;var C=Math.pow(10,y===void 0?6:y);return Math.round(f*C)/C}function v(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function _(f){return v(f).split(/\s+/)}function w(f,y){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?a(f.options):{});for(var C in y)f.options[C]=y[C];return f.options}function j(f,y,C){var A=[];for(var V in f)A.push(encodeURIComponent(C?V.toUpperCase():V)+"="+encodeURIComponent(f[V]));return(!y||y.indexOf("?")===-1?"?":"&")+A.join("&")}var T=/\{ *([\w_ -]+) *\}/g;function P(f,y){return f.replace(T,function(C,A){var V=y[A];if(V===void 0)throw new Error("No value provided for variable "+C);return typeof V=="function"&&(V=V(y)),V})}var E=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function M(f,y){for(var C=0;C<f.length;C++)if(f[C]===y)return C;return-1}var O="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function I(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var q=0;function F(f){var y=+new Date,C=Math.max(0,16-(y-q));return q=y+C,window.setTimeout(f,C)}var B=window.requestAnimationFrame||I("RequestAnimationFrame")||F,U=window.cancelAnimationFrame||I("CancelAnimationFrame")||I("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function W(f,y,C){if(C&&B===F)f.call(y);else return B.call(window,o(f,y))}function $(f){f&&U.call(window,f)}var se={__proto__:null,extend:s,create:a,bind:o,get lastId(){return l},stamp:c,throttle:d,wrapNum:h,falseFn:p,formatNum:x,trim:v,splitWords:_,setOptions:w,getParamString:j,template:P,isArray:E,indexOf:M,emptyImageUrl:O,requestFn:B,cancelFn:U,requestAnimFrame:W,cancelAnimFrame:$};function Y(){}Y.extend=function(f){var y=function(){w(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},C=y.__super__=this.prototype,A=a(C);A.constructor=y,y.prototype=A;for(var V in this)Object.prototype.hasOwnProperty.call(this,V)&&V!=="prototype"&&V!=="__super__"&&(y[V]=this[V]);return f.statics&&s(y,f.statics),f.includes&&(ae(f.includes),s.apply(null,[A].concat(f.includes))),s(A,f),delete A.statics,delete A.includes,A.options&&(A.options=C.options?a(C.options):{},s(A.options,f.options)),A._initHooks=[],A.callInitHooks=function(){if(!this._initHooksCalled){C.callInitHooks&&C.callInitHooks.call(this),this._initHooksCalled=!0;for(var K=0,he=A._initHooks.length;K<he;K++)A._initHooks[K].call(this)}},y},Y.include=function(f){var y=this.prototype.options;return s(this.prototype,f),f.options&&(this.prototype.options=y,this.mergeOptions(f.options)),this},Y.mergeOptions=function(f){return s(this.prototype.options,f),this},Y.addInitHook=function(f){var y=Array.prototype.slice.call(arguments,1),C=typeof f=="function"?f:function(){this[f].apply(this,y)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(C),this};function ae(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=E(f)?f:[f];for(var y=0;y<f.length;y++)f[y]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var J={on:function(f,y,C){if(typeof f=="object")for(var A in f)this._on(A,f[A],y);else{f=_(f);for(var V=0,K=f.length;V<K;V++)this._on(f[V],y,C)}return this},off:function(f,y,C){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var A in f)this._off(A,f[A],y);else{f=_(f);for(var V=arguments.length===1,K=0,he=f.length;K<he;K++)V?this._off(f[K]):this._off(f[K],y,C)}return this},_on:function(f,y,C,A){if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}if(this._listens(f,y,C)===!1){C===this&&(C=void 0);var V={fn:y,ctx:C};A&&(V.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(V)}},_off:function(f,y,C){var A,V,K;if(this._events&&(A=this._events[f],!!A)){if(arguments.length===1){if(this._firingCount)for(V=0,K=A.length;V<K;V++)A[V].fn=p;delete this._events[f];return}if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}var he=this._listens(f,y,C);if(he!==!1){var Se=A[he];this._firingCount&&(Se.fn=p,this._events[f]=A=A.slice()),A.splice(he,1)}}},fire:function(f,y,C){if(!this.listens(f,C))return this;var A=s({},y,{type:f,target:this,sourceTarget:y&&y.sourceTarget||this});if(this._events){var V=this._events[f];if(V){this._firingCount=this._firingCount+1||1;for(var K=0,he=V.length;K<he;K++){var Se=V[K],De=Se.fn;Se.once&&this.off(f,De,Se.ctx),De.call(Se.ctx||this,A)}this._firingCount--}}return C&&this._propagateEvent(A),this},listens:function(f,y,C,A){typeof f!="string"&&console.warn('"string" type argument expected');var V=y;typeof y!="function"&&(A=!!y,V=void 0,C=void 0);var K=this._events&&this._events[f];if(K&&K.length&&this._listens(f,V,C)!==!1)return!0;if(A){for(var he in this._eventParents)if(this._eventParents[he].listens(f,y,C,A))return!0}return!1},_listens:function(f,y,C){if(!this._events)return!1;var A=this._events[f]||[];if(!y)return!!A.length;C===this&&(C=void 0);for(var V=0,K=A.length;V<K;V++)if(A[V].fn===y&&A[V].ctx===C)return V;return!1},once:function(f,y,C){if(typeof f=="object")for(var A in f)this._on(A,f[A],y,!0);else{f=_(f);for(var V=0,K=f.length;V<K;V++)this._on(f[V],y,C,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[c(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[c(f)],this},_propagateEvent:function(f){for(var y in this._eventParents)this._eventParents[y].fire(f.type,s({layer:f.target,propagatedFrom:f.target},f),!0)}};J.addEventListener=J.on,J.removeEventListener=J.clearAllEventListeners=J.off,J.addOneTimeEventListener=J.once,J.fireEvent=J.fire,J.hasEventListeners=J.listens;var ee=Y.extend(J);function X(f,y,C){this.x=C?Math.round(f):f,this.y=C?Math.round(y):y}var Z=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};X.prototype={clone:function(){return new X(this.x,this.y)},add:function(f){return this.clone()._add(oe(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(oe(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new X(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new X(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Z(this.x),this.y=Z(this.y),this},distanceTo:function(f){f=oe(f);var y=f.x-this.x,C=f.y-this.y;return Math.sqrt(y*y+C*C)},equals:function(f){return f=oe(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=oe(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function oe(f,y,C){return f instanceof X?f:E(f)?new X(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new X(f.x,f.y):new X(f,y,C)}function H(f,y){if(f)for(var C=y?[f,y]:f,A=0,V=C.length;A<V;A++)this.extend(C[A])}H.prototype={extend:function(f){var y,C;if(!f)return this;if(f instanceof X||typeof f[0]=="number"||"x"in f)y=C=oe(f);else if(f=Q(f),y=f.min,C=f.max,!y||!C)return this;return!this.min&&!this.max?(this.min=y.clone(),this.max=C.clone()):(this.min.x=Math.min(y.x,this.min.x),this.max.x=Math.max(C.x,this.max.x),this.min.y=Math.min(y.y,this.min.y),this.max.y=Math.max(C.y,this.max.y)),this},getCenter:function(f){return oe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return oe(this.min.x,this.max.y)},getTopRight:function(){return oe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var y,C;return typeof f[0]=="number"||f instanceof X?f=oe(f):f=Q(f),f instanceof H?(y=f.min,C=f.max):y=C=f,y.x>=this.min.x&&C.x<=this.max.x&&y.y>=this.min.y&&C.y<=this.max.y},intersects:function(f){f=Q(f);var y=this.min,C=this.max,A=f.min,V=f.max,K=V.x>=y.x&&A.x<=C.x,he=V.y>=y.y&&A.y<=C.y;return K&&he},overlaps:function(f){f=Q(f);var y=this.min,C=this.max,A=f.min,V=f.max,K=V.x>y.x&&A.x<C.x,he=V.y>y.y&&A.y<C.y;return K&&he},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var y=this.min,C=this.max,A=Math.abs(y.x-C.x)*f,V=Math.abs(y.y-C.y)*f;return Q(oe(y.x-A,y.y-V),oe(C.x+A,C.y+V))},equals:function(f){return f?(f=Q(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function Q(f,y){return!f||f instanceof H?f:new H(f,y)}function ne(f,y){if(f)for(var C=y?[f,y]:f,A=0,V=C.length;A<V;A++)this.extend(C[A])}ne.prototype={extend:function(f){var y=this._southWest,C=this._northEast,A,V;if(f instanceof ce)A=f,V=f;else if(f instanceof ne){if(A=f._southWest,V=f._northEast,!A||!V)return this}else return f?this.extend(pe(f)||de(f)):this;return!y&&!C?(this._southWest=new ce(A.lat,A.lng),this._northEast=new ce(V.lat,V.lng)):(y.lat=Math.min(A.lat,y.lat),y.lng=Math.min(A.lng,y.lng),C.lat=Math.max(V.lat,C.lat),C.lng=Math.max(V.lng,C.lng)),this},pad:function(f){var y=this._southWest,C=this._northEast,A=Math.abs(y.lat-C.lat)*f,V=Math.abs(y.lng-C.lng)*f;return new ne(new ce(y.lat-A,y.lng-V),new ce(C.lat+A,C.lng+V))},getCenter:function(){return new ce((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ce(this.getNorth(),this.getWest())},getSouthEast:function(){return new ce(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof ce||"lat"in f?f=pe(f):f=de(f);var y=this._southWest,C=this._northEast,A,V;return f instanceof ne?(A=f.getSouthWest(),V=f.getNorthEast()):A=V=f,A.lat>=y.lat&&V.lat<=C.lat&&A.lng>=y.lng&&V.lng<=C.lng},intersects:function(f){f=de(f);var y=this._southWest,C=this._northEast,A=f.getSouthWest(),V=f.getNorthEast(),K=V.lat>=y.lat&&A.lat<=C.lat,he=V.lng>=y.lng&&A.lng<=C.lng;return K&&he},overlaps:function(f){f=de(f);var y=this._southWest,C=this._northEast,A=f.getSouthWest(),V=f.getNorthEast(),K=V.lat>y.lat&&A.lat<C.lat,he=V.lng>y.lng&&A.lng<C.lng;return K&&he},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,y){return f?(f=de(f),this._southWest.equals(f.getSouthWest(),y)&&this._northEast.equals(f.getNorthEast(),y)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function de(f,y){return f instanceof ne?f:new ne(f,y)}function ce(f,y,C){if(isNaN(f)||isNaN(y))throw new Error("Invalid LatLng object: ("+f+", "+y+")");this.lat=+f,this.lng=+y,C!==void 0&&(this.alt=+C)}ce.prototype={equals:function(f,y){if(!f)return!1;f=pe(f);var C=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return C<=(y===void 0?1e-9:y)},toString:function(f){return"LatLng("+x(this.lat,f)+", "+x(this.lng,f)+")"},distanceTo:function(f){return xe.distance(this,pe(f))},wrap:function(){return xe.wrapLatLng(this)},toBounds:function(f){var y=180*f/40075017,C=y/Math.cos(Math.PI/180*this.lat);return de([this.lat-y,this.lng-C],[this.lat+y,this.lng+C])},clone:function(){return new ce(this.lat,this.lng,this.alt)}};function pe(f,y,C){return f instanceof ce?f:E(f)&&typeof f[0]!="object"?f.length===3?new ce(f[0],f[1],f[2]):f.length===2?new ce(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new ce(f.lat,"lng"in f?f.lng:f.lon,f.alt):y===void 0?null:new ce(f,y,C)}var ie={latLngToPoint:function(f,y){var C=this.projection.project(f),A=this.scale(y);return this.transformation._transform(C,A)},pointToLatLng:function(f,y){var C=this.scale(y),A=this.transformation.untransform(f,C);return this.projection.unproject(A)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var y=this.projection.bounds,C=this.scale(f),A=this.transformation.transform(y.min,C),V=this.transformation.transform(y.max,C);return new H(A,V)},infinite:!1,wrapLatLng:function(f){var y=this.wrapLng?h(f.lng,this.wrapLng,!0):f.lng,C=this.wrapLat?h(f.lat,this.wrapLat,!0):f.lat,A=f.alt;return new ce(C,y,A)},wrapLatLngBounds:function(f){var y=f.getCenter(),C=this.wrapLatLng(y),A=y.lat-C.lat,V=y.lng-C.lng;if(A===0&&V===0)return f;var K=f.getSouthWest(),he=f.getNorthEast(),Se=new ce(K.lat-A,K.lng-V),De=new ce(he.lat-A,he.lng-V);return new ne(Se,De)}},xe=s({},ie,{wrapLng:[-180,180],R:6371e3,distance:function(f,y){var C=Math.PI/180,A=f.lat*C,V=y.lat*C,K=Math.sin((y.lat-f.lat)*C/2),he=Math.sin((y.lng-f.lng)*C/2),Se=K*K+Math.cos(A)*Math.cos(V)*he*he,De=2*Math.atan2(Math.sqrt(Se),Math.sqrt(1-Se));return this.R*De}}),Ce=6378137,ve={R:Ce,MAX_LATITUDE:85.0511287798,project:function(f){var y=Math.PI/180,C=this.MAX_LATITUDE,A=Math.max(Math.min(C,f.lat),-C),V=Math.sin(A*y);return new X(this.R*f.lng*y,this.R*Math.log((1+V)/(1-V))/2)},unproject:function(f){var y=180/Math.PI;return new ce((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*y,f.x*y/this.R)},bounds:(function(){var f=Ce*Math.PI;return new H([-f,-f],[f,f])})()};function Oe(f,y,C,A){if(E(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=y,this._c=C,this._d=A}Oe.prototype={transform:function(f,y){return this._transform(f.clone(),y)},_transform:function(f,y){return y=y||1,f.x=y*(this._a*f.x+this._b),f.y=y*(this._c*f.y+this._d),f},untransform:function(f,y){return y=y||1,new X((f.x/y-this._b)/this._a,(f.y/y-this._d)/this._c)}};function Pe(f,y,C,A){return new Oe(f,y,C,A)}var Ie=s({},xe,{code:"EPSG:3857",projection:ve,transformation:(function(){var f=.5/(Math.PI*ve.R);return Pe(f,.5,-f,.5)})()}),Fe=s({},Ie,{code:"EPSG:900913"});function _e(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function Ne(f,y){var C="",A,V,K,he,Se,De;for(A=0,K=f.length;A<K;A++){for(Se=f[A],V=0,he=Se.length;V<he;V++)De=Se[V],C+=(V?"L":"M")+De.x+" "+De.y;C+=y?dt.svg?"z":"x":""}return C||"M0 0"}var Ue=document.documentElement.style,Be="ActiveXObject"in window,qe=Be&&!document.addEventListener,te="msLaunchUri"in navigator&&!("documentMode"in document),le=dr("webkit"),ye=dr("android"),Ve=dr("android 2")||dr("android 3"),ze=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Le=ye&&dr("Google")&&ze<537&&!("AudioNode"in window),rt=!!window.opera,Xe=!te&&dr("chrome"),tt=dr("gecko")&&!le&&!rt&&!Be,qt=!Xe&&dr("safari"),bt=dr("phantom"),Dt="OTransition"in Ue,Xt=navigator.platform.indexOf("Win")===0,en=Be&&"transition"in Ue,Yt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ve,Ut="MozPerspective"in Ue,Rn=!window.L_DISABLE_3D&&(en||Yt||Ut)&&!Dt&&!bt,Nn=typeof orientation<"u"||dr("mobile"),an=Nn&&le,rr=Nn&&Yt,Hn=!window.PointerEvent&&window.MSPointerEvent,lt=!!(window.PointerEvent||Hn),Vn="ontouchstart"in window||!!window.TouchEvent,br=!window.L_NO_TOUCH&&(Vn||lt),vn=Nn&&rt,ds=Nn&&tt,Zs=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Yr=(function(){var f=!1;try{var y=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",p,y),window.removeEventListener("testPassiveEventSupport",p,y)}catch{}return f})(),Qi=(function(){return!!document.createElement("canvas").getContext})(),Ra=!!(document.createElementNS&&_e("svg").createSVGRect),Xi=!!Ra&&(function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ko=!Ra&&(function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var y=f.firstChild;return y.style.behavior="url(#default#VML)",y&&typeof y.adj=="object"}catch{return!1}})(),ea=navigator.platform.indexOf("Mac")===0,ad=navigator.platform.indexOf("Linux")===0;function dr(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var dt={ie:Be,ielt9:qe,edge:te,webkit:le,android:ye,android23:Ve,androidStock:Le,opera:rt,chrome:Xe,gecko:tt,safari:qt,phantom:bt,opera12:Dt,win:Xt,ie3d:en,webkit3d:Yt,gecko3d:Ut,any3d:Rn,mobile:Nn,mobileWebkit:an,mobileWebkit3d:rr,msPointer:Hn,pointer:lt,touch:br,touchNative:Vn,mobileOpera:vn,mobileGecko:ds,retina:Zs,passiveEvents:Yr,canvas:Qi,svg:Ra,vml:ko,inlineSvg:Xi,mac:ea,linux:ad},ta=dt.msPointer?"MSPointerDown":"pointerdown",La=dt.msPointer?"MSPointerMove":"pointermove",El=dt.msPointer?"MSPointerUp":"pointerup",Ol=dt.msPointer?"MSPointerCancel":"pointercancel",Po={touchstart:ta,touchmove:La,touchend:El,touchcancel:Ol},Ts={touchstart:Cn,touchmove:Fa,touchend:Fa,touchcancel:Fa},Ks={},Mo=!1;function od(f,y,C){return y==="touchstart"&&ld(),Ts[y]?(C=Ts[y].bind(this,C),f.addEventListener(Po[y],C,!1),C):(console.warn("wrong event specified:",y),p)}function Il(f,y,C){if(!Po[y]){console.warn("wrong event specified:",y);return}f.removeEventListener(Po[y],C,!1)}function Al(f){Ks[f.pointerId]=f}function Rl(f){Ks[f.pointerId]&&(Ks[f.pointerId]=f)}function Do(f){delete Ks[f.pointerId]}function ld(){Mo||(document.addEventListener(ta,Al,!0),document.addEventListener(La,Rl,!0),document.addEventListener(El,Do,!0),document.addEventListener(Ol,Do,!0),Mo=!0)}function Fa(f,y){if(y.pointerType!==(y.MSPOINTER_TYPE_MOUSE||"mouse")){y.touches=[];for(var C in Ks)y.touches.push(Ks[C]);y.changedTouches=[y],f(y)}}function Cn(f,y){y.MSPOINTER_TYPE_TOUCH&&y.pointerType===y.MSPOINTER_TYPE_TOUCH&&Tn(y),Fa(f,y)}function cd(f){var y={},C,A;for(A in f)C=f[A],y[A]=C&&C.bind?C.bind(f):C;return f=y,y.type="dblclick",y.detail=2,y.isTrusted=!1,y._simulated=!0,y}var Eo=200;function Ll(f,y){f.addEventListener("dblclick",y);var C=0,A;function V(K){if(K.detail!==1){A=K.detail;return}if(!(K.pointerType==="mouse"||K.sourceCapabilities&&!K.sourceCapabilities.firesTouchEvents)){var he=Xs(K);if(!(he.some(function(De){return De instanceof HTMLLabelElement&&De.attributes.for})&&!he.some(function(De){return De instanceof HTMLInputElement||De instanceof HTMLSelectElement}))){var Se=Date.now();Se-C<=Eo?(A++,A===2&&y(cd(K))):A=1,C=Se}}}return f.addEventListener("click",V),{dblclick:y,simDblclick:V}}function qa(f,y){f.removeEventListener("dblclick",y.dblclick),f.removeEventListener("click",y.simDblclick)}var Oo=wi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),vi=wi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),na=vi==="webkitTransition"||vi==="OTransition"?vi+"End":"transitionend";function Ar(f){return typeof f=="string"?document.getElementById(f):f}function ra(f,y){var C=f.style[y]||f.currentStyle&&f.currentStyle[y];if((!C||C==="auto")&&document.defaultView){var A=document.defaultView.getComputedStyle(f,null);C=A?A[y]:null}return C==="auto"?null:C}function Et(f,y,C){var A=document.createElement(f);return A.className=y||"",C&&C.appendChild(A),A}function bn(f){var y=f.parentNode;y&&y.removeChild(f)}function za(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function bi(f){var y=f.parentNode;y&&y.lastChild!==f&&y.appendChild(f)}function us(f){var y=f.parentNode;y&&y.firstChild!==f&&y.insertBefore(f,y.firstChild)}function _i(f,y){if(f.classList!==void 0)return f.classList.contains(y);var C=Ua(f);return C.length>0&&new RegExp("(^|\\s)"+y+"(\\s|$)").test(C)}function Mt(f,y){if(f.classList!==void 0)for(var C=_(y),A=0,V=C.length;A<V;A++)f.classList.add(C[A]);else if(!_i(f,y)){var K=Ua(f);Io(f,(K?K+" ":"")+y)}}function gn(f,y){f.classList!==void 0?f.classList.remove(y):Io(f,v((" "+Ua(f)+" ").replace(" "+y+" "," ")))}function Io(f,y){f.className.baseVal===void 0?f.className=y:f.className.baseVal=y}function Ua(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function ur(f,y){"opacity"in f.style?f.style.opacity=y:"filter"in f.style&&Fl(f,y)}function Fl(f,y){var C=!1,A="DXImageTransform.Microsoft.Alpha";try{C=f.filters.item(A)}catch{if(y===1)return}y=Math.round(y*100),C?(C.Enabled=y!==100,C.Opacity=y):f.style.filter+=" progid:"+A+"(opacity="+y+")"}function wi(f){for(var y=document.documentElement.style,C=0;C<f.length;C++)if(f[C]in y)return f[C];return!1}function Rr(f,y,C){var A=y||new X(0,0);f.style[Oo]=(dt.ie3d?"translate("+A.x+"px,"+A.y+"px)":"translate3d("+A.x+"px,"+A.y+"px,0)")+(C?" scale("+C+")":"")}function En(f,y){f._leaflet_pos=y,dt.any3d?Rr(f,y):(f.style.left=y.x+"px",f.style.top=y.y+"px")}function fs(f){return f._leaflet_pos||new X(0,0)}var Kt,ji,Va;if("onselectstart"in document)Kt=function(){Ct(window,"selectstart",Tn)},ji=function(){ln(window,"selectstart",Tn)};else{var Js=wi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Kt=function(){if(Js){var f=document.documentElement.style;Va=f[Js],f[Js]="none"}},ji=function(){Js&&(document.documentElement.style[Js]=Va,Va=void 0)}}function Ba(){Ct(window,"dragstart",Tn)}function Wa(){ln(window,"dragstart",Tn)}var sa,ia;function Ni(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(Lr(),sa=f,ia=f.style.outlineStyle,f.style.outlineStyle="none",Ct(window,"keydown",Lr))}function Lr(){sa&&(sa.style.outlineStyle=ia,sa=void 0,ia=void 0,ln(window,"keydown",Lr))}function hs(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function Gr(f){var y=f.getBoundingClientRect();return{x:y.width/f.offsetWidth||1,y:y.height/f.offsetHeight||1,boundingClientRect:y}}var aa={__proto__:null,TRANSFORM:Oo,TRANSITION:vi,TRANSITION_END:na,get:Ar,getStyle:ra,create:Et,remove:bn,empty:za,toFront:bi,toBack:us,hasClass:_i,addClass:Mt,removeClass:gn,setClass:Io,getClass:Ua,setOpacity:ur,testProp:wi,setTransform:Rr,setPosition:En,getPosition:fs,get disableTextSelection(){return Kt},get enableTextSelection(){return ji},disableImageDrag:Ba,enableImageDrag:Wa,preventOutline:Ni,restoreOutline:Lr,getSizedParentNode:hs,getScale:Gr};function Ct(f,y,C,A){if(y&&typeof y=="object")for(var V in y)Ro(f,V,y[V],C);else{y=_(y);for(var K=0,he=y.length;K<he;K++)Ro(f,y[K],C,A)}return this}var Yn="_leaflet_events";function ln(f,y,C,A){if(arguments.length===1)Ao(f),delete f[Yn];else if(y&&typeof y=="object")for(var V in y)$a(f,V,y[V],C);else if(y=_(y),arguments.length===2)Ao(f,function(Se){return M(y,Se)!==-1});else for(var K=0,he=y.length;K<he;K++)$a(f,y[K],C,A);return this}function Ao(f,y){for(var C in f[Yn]){var A=C.split(/\d/)[0];(!y||y(A))&&$a(f,A,null,null,C)}}var Qs={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ro(f,y,C,A){var V=y+c(C)+(A?"_"+c(A):"");if(f[Yn]&&f[Yn][V])return this;var K=function(Se){return C.call(A||f,Se||window.event)},he=K;!dt.touchNative&&dt.pointer&&y.indexOf("touch")===0?K=od(f,y,K):dt.touch&&y==="dblclick"?K=Ll(f,K):"addEventListener"in f?y==="touchstart"||y==="touchmove"||y==="wheel"||y==="mousewheel"?f.addEventListener(Qs[y]||y,K,dt.passiveEvents?{passive:!1}:!1):y==="mouseenter"||y==="mouseleave"?(K=function(Se){Se=Se||window.event,ca(f,Se)&&he(Se)},f.addEventListener(Qs[y],K,!1)):f.addEventListener(y,he,!1):f.attachEvent("on"+y,K),f[Yn]=f[Yn]||{},f[Yn][V]=K}function $a(f,y,C,A,V){V=V||y+c(C)+(A?"_"+c(A):"");var K=f[Yn]&&f[Yn][V];if(!K)return this;!dt.touchNative&&dt.pointer&&y.indexOf("touch")===0?Il(f,y,K):dt.touch&&y==="dblclick"?qa(f,K):"removeEventListener"in f?f.removeEventListener(Qs[y]||y,K,!1):f.detachEvent("on"+y,K),f[Yn][V]=null}function Zr(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function Ha(f){return Ro(f,"wheel",Zr),this}function oa(f){return Ct(f,"mousedown touchstart dblclick contextmenu",Zr),f._leaflet_disable_click=!0,this}function Tn(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function Fr(f){return Tn(f),Zr(f),this}function Xs(f){if(f.composedPath)return f.composedPath();for(var y=[],C=f.target;C;)y.push(C),C=C.parentNode;return y}function la(f,y){if(!y)return new X(f.clientX,f.clientY);var C=Gr(y),A=C.boundingClientRect;return new X((f.clientX-A.left)/C.x-y.clientLeft,(f.clientY-A.top)/C.y-y.clientTop)}var dd=dt.linux&&dt.chrome?window.devicePixelRatio:dt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ql(f){return dt.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/dd:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function ca(f,y){var C=y.relatedTarget;if(!C)return!0;try{for(;C&&C!==f;)C=C.parentNode}catch{return!1}return C!==f}var Ya={__proto__:null,on:Ct,off:ln,stopPropagation:Zr,disableScrollPropagation:Ha,disableClickPropagation:oa,preventDefault:Tn,stop:Fr,getPropagationPath:Xs,getMousePosition:la,getWheelDelta:ql,isExternalTarget:ca,addListener:Ct,removeListener:ln},Ga=ee.extend({run:function(f,y,C,A){this.stop(),this._el=f,this._inProgress=!0,this._duration=C||.25,this._easeOutPower=1/Math.max(A||.5,.2),this._startPos=fs(f),this._offset=y.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=W(this._animate,this),this._step()},_step:function(f){var y=+new Date-this._startTime,C=this._duration*1e3;y<C?this._runFrame(this._easeOut(y/C),f):(this._runFrame(1),this._complete())},_runFrame:function(f,y){var C=this._startPos.add(this._offset.multiplyBy(f));y&&C._round(),En(this._el,C),this.fire("step")},_complete:function(){$(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),Ht=ee.extend({options:{crs:Ie,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,y){y=w(this,y),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),y.maxBounds&&this.setMaxBounds(y.maxBounds),y.zoom!==void 0&&(this._zoom=this._limitZoom(y.zoom)),y.center&&y.zoom!==void 0&&this.setView(pe(y.center),y.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=vi&&dt.any3d&&!dt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ct(this._proxy,na,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,y,C){if(y=y===void 0?this._zoom:this._limitZoom(y),f=this._limitCenter(pe(f),y,this.options.maxBounds),C=C||{},this._stop(),this._loaded&&!C.reset&&C!==!0){C.animate!==void 0&&(C.zoom=s({animate:C.animate},C.zoom),C.pan=s({animate:C.animate,duration:C.duration},C.pan));var A=this._zoom!==y?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,y,C.zoom):this._tryAnimatedPan(f,C.pan);if(A)return clearTimeout(this._sizeTimer),this}return this._resetView(f,y,C.pan&&C.pan.noMoveStart),this},setZoom:function(f,y){return this._loaded?this.setView(this.getCenter(),f,{zoom:y}):(this._zoom=f,this)},zoomIn:function(f,y){return f=f||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,y)},zoomOut:function(f,y){return f=f||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,y)},setZoomAround:function(f,y,C){var A=this.getZoomScale(y),V=this.getSize().divideBy(2),K=f instanceof X?f:this.latLngToContainerPoint(f),he=K.subtract(V).multiplyBy(1-1/A),Se=this.containerPointToLatLng(V.add(he));return this.setView(Se,y,{zoom:C})},_getBoundsCenterZoom:function(f,y){y=y||{},f=f.getBounds?f.getBounds():de(f);var C=oe(y.paddingTopLeft||y.padding||[0,0]),A=oe(y.paddingBottomRight||y.padding||[0,0]),V=this.getBoundsZoom(f,!1,C.add(A));if(V=typeof y.maxZoom=="number"?Math.min(y.maxZoom,V):V,V===1/0)return{center:f.getCenter(),zoom:V};var K=A.subtract(C).divideBy(2),he=this.project(f.getSouthWest(),V),Se=this.project(f.getNorthEast(),V),De=this.unproject(he.add(Se).divideBy(2).add(K),V);return{center:De,zoom:V}},fitBounds:function(f,y){if(f=de(f),!f.isValid())throw new Error("Bounds are not valid.");var C=this._getBoundsCenterZoom(f,y);return this.setView(C.center,C.zoom,y)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,y){return this.setView(f,this._zoom,{pan:y})},panBy:function(f,y){if(f=oe(f).round(),y=y||{},!f.x&&!f.y)return this.fire("moveend");if(y.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ga,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),y.noMoveStart||this.fire("movestart"),y.animate!==!1){Mt(this._mapPane,"leaflet-pan-anim");var C=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,C,y.duration||.25,y.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,y,C){if(C=C||{},C.animate===!1||!dt.any3d)return this.setView(f,y,C);this._stop();var A=this.project(this.getCenter()),V=this.project(f),K=this.getSize(),he=this._zoom;f=pe(f),y=y===void 0?he:y;var Se=Math.max(K.x,K.y),De=Se*this.getZoomScale(he,y),We=V.distanceTo(A)||1,st=1.42,Nt=st*st;function $t(xn){var lc=xn?-1:1,Dy=xn?De:Se,Ey=De*De-Se*Se+lc*Nt*Nt*We*We,Xo=2*Dy*Nt*We,el=Ey/Xo,tl=Math.sqrt(el*el+1)-el,Cu=tl<1e-9?-18:Math.log(tl);return Cu}function jr(xn){return(Math.exp(xn)-Math.exp(-xn))/2}function hr(xn){return(Math.exp(xn)+Math.exp(-xn))/2}function xs(xn){return jr(xn)/hr(xn)}var Jr=$t(0);function ac(xn){return Se*(hr(Jr)/hr(Jr+st*xn))}function Kf(xn){return Se*(hr(Jr)*xs(Jr+st*xn)-jr(Jr))/Nt}function oo(xn){return 1-Math.pow(1-xn,1.5)}var Fm=Date.now(),Qo=($t(1)-Jr)/st,Ei=C.duration?1e3*C.duration:1e3*Qo*.8;function oc(){var xn=(Date.now()-Fm)/Ei,lc=oo(xn)*Qo;xn<=1?(this._flyToFrame=W(oc,this),this._move(this.unproject(A.add(V.subtract(A).multiplyBy(Kf(lc)/We)),he),this.getScaleZoom(Se/ac(lc),he),{flyTo:!0})):this._move(f,y)._moveEnd(!0)}return this._moveStart(!0,C.noMoveStart),oc.call(this),this},flyToBounds:function(f,y){var C=this._getBoundsCenterZoom(f,y);return this.flyTo(C.center,C.zoom,y)},setMaxBounds:function(f){return f=de(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var y=this.options.minZoom;return this.options.minZoom=f,this._loaded&&y!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var y=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&y!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,y){this._enforcingBounds=!0;var C=this.getCenter(),A=this._limitCenter(C,this._zoom,de(f));return C.equals(A)||this.panTo(A,y),this._enforcingBounds=!1,this},panInside:function(f,y){y=y||{};var C=oe(y.paddingTopLeft||y.padding||[0,0]),A=oe(y.paddingBottomRight||y.padding||[0,0]),V=this.project(this.getCenter()),K=this.project(f),he=this.getPixelBounds(),Se=Q([he.min.add(C),he.max.subtract(A)]),De=Se.getSize();if(!Se.contains(K)){this._enforcingBounds=!0;var We=K.subtract(Se.getCenter()),st=Se.extend(K).getSize().subtract(De);V.x+=We.x<0?-st.x:st.x,V.y+=We.y<0?-st.y:st.y,this.panTo(this.unproject(V),y),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=s({animate:!1,pan:!0},f===!0?{animate:!0}:f);var y=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var C=this.getSize(),A=y.divideBy(2).round(),V=C.divideBy(2).round(),K=A.subtract(V);return!K.x&&!K.y?this:(f.animate&&f.pan?this.panBy(K):(f.pan&&this._rawPanBy(K),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:y,newSize:C}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=s({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var y=o(this._handleGeolocationResponse,this),C=o(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(y,C,f):navigator.geolocation.getCurrentPosition(y,C,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var y=f.code,C=f.message||(y===1?"permission denied":y===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:y,message:"Geolocation error: "+C+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var y=f.coords.latitude,C=f.coords.longitude,A=new ce(y,C),V=A.toBounds(f.coords.accuracy*2),K=this._locateOptions;if(K.setView){var he=this.getBoundsZoom(V);this.setView(A,K.maxZoom?Math.min(he,K.maxZoom):he)}var Se={latlng:A,bounds:V,timestamp:f.timestamp};for(var De in f.coords)typeof f.coords[De]=="number"&&(Se[De]=f.coords[De]);this.fire("locationfound",Se)}},addHandler:function(f,y){if(!y)return this;var C=this[f]=new y(this);return this._handlers.push(C),this.options[f]&&C.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),bn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&($(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)bn(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,y){var C="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),A=Et("div",C,y||this._mapPane);return f&&(this._panes[f]=A),A},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),y=this.unproject(f.getBottomLeft()),C=this.unproject(f.getTopRight());return new ne(y,C)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,y,C){f=de(f),C=oe(C||[0,0]);var A=this.getZoom()||0,V=this.getMinZoom(),K=this.getMaxZoom(),he=f.getNorthWest(),Se=f.getSouthEast(),De=this.getSize().subtract(C),We=Q(this.project(Se,A),this.project(he,A)).getSize(),st=dt.any3d?this.options.zoomSnap:1,Nt=De.x/We.x,$t=De.y/We.y,jr=y?Math.max(Nt,$t):Math.min(Nt,$t);return A=this.getScaleZoom(jr,A),st&&(A=Math.round(A/(st/100))*(st/100),A=y?Math.ceil(A/st)*st:Math.floor(A/st)*st),Math.max(V,Math.min(K,A))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new X(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,y){var C=this._getTopLeftPoint(f,y);return new H(C,C.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,y){var C=this.options.crs;return y=y===void 0?this._zoom:y,C.scale(f)/C.scale(y)},getScaleZoom:function(f,y){var C=this.options.crs;y=y===void 0?this._zoom:y;var A=C.zoom(f*C.scale(y));return isNaN(A)?1/0:A},project:function(f,y){return y=y===void 0?this._zoom:y,this.options.crs.latLngToPoint(pe(f),y)},unproject:function(f,y){return y=y===void 0?this._zoom:y,this.options.crs.pointToLatLng(oe(f),y)},layerPointToLatLng:function(f){var y=oe(f).add(this.getPixelOrigin());return this.unproject(y)},latLngToLayerPoint:function(f){var y=this.project(pe(f))._round();return y._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(pe(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(de(f))},distance:function(f,y){return this.options.crs.distance(pe(f),pe(y))},containerPointToLayerPoint:function(f){return oe(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return oe(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var y=this.containerPointToLayerPoint(oe(f));return this.layerPointToLatLng(y)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(pe(f)))},mouseEventToContainerPoint:function(f){return la(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var y=this._container=Ar(f);if(y){if(y._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ct(y,"scroll",this._onScroll,this),this._containerId=c(y)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&dt.any3d,Mt(f,"leaflet-container"+(dt.touch?" leaflet-touch":"")+(dt.retina?" leaflet-retina":"")+(dt.ielt9?" leaflet-oldie":"")+(dt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var y=ra(f,"position");y!=="absolute"&&y!=="relative"&&y!=="fixed"&&y!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),En(this._mapPane,new X(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Mt(f.markerPane,"leaflet-zoom-hide"),Mt(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,y,C){En(this._mapPane,new X(0,0));var A=!this._loaded;this._loaded=!0,y=this._limitZoom(y),this.fire("viewprereset");var V=this._zoom!==y;this._moveStart(V,C)._move(f,y)._moveEnd(V),this.fire("viewreset"),A&&this.fire("load")},_moveStart:function(f,y){return f&&this.fire("zoomstart"),y||this.fire("movestart"),this},_move:function(f,y,C,A){y===void 0&&(y=this._zoom);var V=this._zoom!==y;return this._zoom=y,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),A?C&&C.pinch&&this.fire("zoom",C):((V||C&&C.pinch)&&this.fire("zoom",C),this.fire("move",C)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return $(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){En(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[c(this._container)]=this;var y=f?ln:Ct;y(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&y(window,"resize",this._onResize,this),dt.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){$(this._resizeRequest),this._resizeRequest=W(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,y){for(var C=[],A,V=y==="mouseout"||y==="mouseover",K=f.target||f.srcElement,he=!1;K;){if(A=this._targets[c(K)],A&&(y==="click"||y==="preclick")&&this._draggableMoved(A)){he=!0;break}if(A&&A.listens(y,!0)&&(V&&!ca(K,f)||(C.push(A),V))||K===this._container)break;K=K.parentNode}return!C.length&&!he&&!V&&this.listens(y,!0)&&(C=[this]),C},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var y=f.target||f.srcElement;if(!(!this._loaded||y._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(y))){var C=f.type;C==="mousedown"&&Ni(y),this._fireDOMEvent(f,C)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,y,C){if(f.type==="click"){var A=s({},f);A.type="preclick",this._fireDOMEvent(A,A.type,C)}var V=this._findEventTargets(f,y);if(C){for(var K=[],he=0;he<C.length;he++)C[he].listens(y,!0)&&K.push(C[he]);V=K.concat(V)}if(V.length){y==="contextmenu"&&Tn(f);var Se=V[0],De={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var We=Se.getLatLng&&(!Se._radius||Se._radius<=10);De.containerPoint=We?this.latLngToContainerPoint(Se.getLatLng()):this.mouseEventToContainerPoint(f),De.layerPoint=this.containerPointToLayerPoint(De.containerPoint),De.latlng=We?Se.getLatLng():this.layerPointToLatLng(De.layerPoint)}for(he=0;he<V.length;he++)if(V[he].fire(y,De,!0),De.originalEvent._stopped||V[he].options.bubblingMouseEvents===!1&&M(this._mouseEvents,y)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,y=this._handlers.length;f<y;f++)this._handlers[f].disable()},whenReady:function(f,y){return this._loaded?f.call(y||this,{target:this}):this.on("load",f,y),this},_getMapPanePos:function(){return fs(this._mapPane)||new X(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,y){var C=f&&y!==void 0?this._getNewPixelOrigin(f,y):this.getPixelOrigin();return C.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,y){var C=this.getSize()._divideBy(2);return this.project(f,y)._subtract(C)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,y,C){var A=this._getNewPixelOrigin(C,y);return this.project(f,y)._subtract(A)},_latLngBoundsToNewLayerBounds:function(f,y,C){var A=this._getNewPixelOrigin(C,y);return Q([this.project(f.getSouthWest(),y)._subtract(A),this.project(f.getNorthWest(),y)._subtract(A),this.project(f.getSouthEast(),y)._subtract(A),this.project(f.getNorthEast(),y)._subtract(A)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,y,C){if(!C)return f;var A=this.project(f,y),V=this.getSize().divideBy(2),K=new H(A.subtract(V),A.add(V)),he=this._getBoundsOffset(K,C,y);return Math.abs(he.x)<=1&&Math.abs(he.y)<=1?f:this.unproject(A.add(he),y)},_limitOffset:function(f,y){if(!y)return f;var C=this.getPixelBounds(),A=new H(C.min.add(f),C.max.add(f));return f.add(this._getBoundsOffset(A,y))},_getBoundsOffset:function(f,y,C){var A=Q(this.project(y.getNorthEast(),C),this.project(y.getSouthWest(),C)),V=A.min.subtract(f.min),K=A.max.subtract(f.max),he=this._rebound(V.x,-K.x),Se=this._rebound(V.y,-K.y);return new X(he,Se)},_rebound:function(f,y){return f+y>0?Math.round(f-y)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(y))},_limitZoom:function(f){var y=this.getMinZoom(),C=this.getMaxZoom(),A=dt.any3d?this.options.zoomSnap:1;return A&&(f=Math.round(f/A)*A),Math.max(y,Math.min(C,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){gn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,y){var C=this._getCenterOffset(f)._trunc();return(y&&y.animate)!==!0&&!this.getSize().contains(C)?!1:(this.panBy(C,y),!0)},_createAnimProxy:function(){var f=this._proxy=Et("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(y){var C=Oo,A=this._proxy.style[C];Rr(this._proxy,this.project(y.center,y.zoom),this.getZoomScale(y.zoom,1)),A===this._proxy.style[C]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){bn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),y=this.getZoom();Rr(this._proxy,this.project(f,y),this.getZoomScale(y,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,y,C){if(this._animatingZoom)return!0;if(C=C||{},!this._zoomAnimated||C.animate===!1||this._nothingToAnimate()||Math.abs(y-this._zoom)>this.options.zoomAnimationThreshold)return!1;var A=this.getZoomScale(y),V=this._getCenterOffset(f)._divideBy(1-1/A);return C.animate!==!0&&!this.getSize().contains(V)?!1:(W(function(){this._moveStart(!0,C.noMoveStart||!1)._animateZoom(f,y,!0)},this),!0)},_animateZoom:function(f,y,C,A){this._mapPane&&(C&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=y,Mt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:y,noUpdate:A}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&gn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ks(f,y){return new Ht(f,y)}var _r=Y.extend({options:{position:"topright"},initialize:function(f){w(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var y=this._map;return y&&y.removeControl(this),this.options.position=f,y&&y.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var y=this._container=this.onAdd(f),C=this.getPosition(),A=f._controlCorners[C];return Mt(y,"leaflet-control"),C.indexOf("bottom")!==-1?A.insertBefore(y,A.firstChild):A.appendChild(y),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(bn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),Ps=function(f){return new _r(f)};Ht.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},y="leaflet-",C=this._controlContainer=Et("div",y+"control-container",this._container);function A(V,K){var he=y+V+" "+y+K;f[V+K]=Et("div",he,C)}A("top","left"),A("top","right"),A("bottom","left"),A("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)bn(this._controlCorners[f]);bn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Lo=_r.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,y,C,A){return C<A?-1:A<C?1:0}},initialize:function(f,y,C){w(this,C),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var A in f)this._addLayer(f[A],A);for(A in y)this._addLayer(y[A],A,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var y=0;y<this._layers.length;y++)this._layers[y].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return _r.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,y){return this._addLayer(f,y),this._map?this._update():this},addOverlay:function(f,y){return this._addLayer(f,y,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var y=this._getLayer(c(f));return y&&this._layers.splice(this._layers.indexOf(y),1),this._map?this._update():this},expand:function(){Mt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(Mt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):gn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return gn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",y=this._container=Et("div",f),C=this.options.collapsed;y.setAttribute("aria-haspopup",!0),oa(y),Ha(y);var A=this._section=Et("section",f+"-list");C&&(this._map.on("click",this.collapse,this),Ct(y,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var V=this._layersLink=Et("a",f+"-toggle",y);V.href="#",V.title="Layers",V.setAttribute("role","button"),Ct(V,{keydown:function(K){K.keyCode===13&&this._expandSafely()},click:function(K){Tn(K),this._expandSafely()}},this),C||this.expand(),this._baseLayersList=Et("div",f+"-base",A),this._separator=Et("div",f+"-separator",A),this._overlaysList=Et("div",f+"-overlays",A),y.appendChild(A)},_getLayer:function(f){for(var y=0;y<this._layers.length;y++)if(this._layers[y]&&c(this._layers[y].layer)===f)return this._layers[y]},_addLayer:function(f,y,C){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:y,overlay:C}),this.options.sortLayers&&this._layers.sort(o(function(A,V){return this.options.sortFunction(A.layer,V.layer,A.name,V.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;za(this._baseLayersList),za(this._overlaysList),this._layerControlInputs=[];var f,y,C,A,V=0;for(C=0;C<this._layers.length;C++)A=this._layers[C],this._addItem(A),y=y||A.overlay,f=f||!A.overlay,V+=A.overlay?0:1;return this.options.hideSingleBase&&(f=f&&V>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=y&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var y=this._getLayer(c(f.target)),C=y.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;C&&this._map.fire(C,y)},_createRadioElement:function(f,y){var C='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(y?' checked="checked"':"")+"/>",A=document.createElement("div");return A.innerHTML=C,A.firstChild},_addItem:function(f){var y=document.createElement("label"),C=this._map.hasLayer(f.layer),A;f.overlay?(A=document.createElement("input"),A.type="checkbox",A.className="leaflet-control-layers-selector",A.defaultChecked=C):A=this._createRadioElement("leaflet-base-layers_"+c(this),C),this._layerControlInputs.push(A),A.layerId=c(f.layer),Ct(A,"click",this._onInputClick,this);var V=document.createElement("span");V.innerHTML=" "+f.name;var K=document.createElement("span");y.appendChild(K),K.appendChild(A),K.appendChild(V);var he=f.overlay?this._overlaysList:this._baseLayersList;return he.appendChild(y),this._checkDisabledLayers(),y},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,y,C,A=[],V=[];this._handlingClick=!0;for(var K=f.length-1;K>=0;K--)y=f[K],C=this._getLayer(y.layerId).layer,y.checked?A.push(C):y.checked||V.push(C);for(K=0;K<V.length;K++)this._map.hasLayer(V[K])&&this._map.removeLayer(V[K]);for(K=0;K<A.length;K++)this._map.hasLayer(A[K])||this._map.addLayer(A[K]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,y,C,A=this._map.getZoom(),V=f.length-1;V>=0;V--)y=f[V],C=this._getLayer(y.layerId).layer,y.disabled=C.options.minZoom!==void 0&&A<C.options.minZoom||C.options.maxZoom!==void 0&&A>C.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,Ct(f,"click",Tn),this.expand();var y=this;setTimeout(function(){ln(f,"click",Tn),y._preventClick=!1})}}),Za=function(f,y,C){return new Lo(f,y,C)},Si=_r.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var y="leaflet-control-zoom",C=Et("div",y+" leaflet-bar"),A=this.options;return this._zoomInButton=this._createButton(A.zoomInText,A.zoomInTitle,y+"-in",C,this._zoomIn),this._zoomOutButton=this._createButton(A.zoomOutText,A.zoomOutTitle,y+"-out",C,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),C},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,y,C,A,V){var K=Et("a",C,A);return K.innerHTML=f,K.href="#",K.title=y,K.setAttribute("role","button"),K.setAttribute("aria-label",y),oa(K),Ct(K,"click",Fr),Ct(K,"click",V,this),Ct(K,"click",this._refocusOnMap,this),K},_updateDisabled:function(){var f=this._map,y="leaflet-disabled";gn(this._zoomInButton,y),gn(this._zoomOutButton,y),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(Mt(this._zoomOutButton,y),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(Mt(this._zoomInButton,y),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ht.mergeOptions({zoomControl:!0}),Ht.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Si,this.addControl(this.zoomControl))});var zl=function(f){return new Si(f)},fr=_r.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var y="leaflet-control-scale",C=Et("div",y),A=this.options;return this._addScales(A,y+"-line",C),f.on(A.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),C},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,y,C){f.metric&&(this._mScale=Et("div",y,C)),f.imperial&&(this._iScale=Et("div",y,C))},_update:function(){var f=this._map,y=f.getSize().y/2,C=f.distance(f.containerPointToLatLng([0,y]),f.containerPointToLatLng([this.options.maxWidth,y]));this._updateScales(C)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var y=this._getRoundNum(f),C=y<1e3?y+" m":y/1e3+" km";this._updateScale(this._mScale,C,y/f)},_updateImperial:function(f){var y=f*3.2808399,C,A,V;y>5280?(C=y/5280,A=this._getRoundNum(C),this._updateScale(this._iScale,A+" mi",A/C)):(V=this._getRoundNum(y),this._updateScale(this._iScale,V+" ft",V/y))},_updateScale:function(f,y,C){f.style.width=Math.round(this.options.maxWidth*C)+"px",f.innerHTML=y},_getRoundNum:function(f){var y=Math.pow(10,(Math.floor(f)+"").length-1),C=f/y;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:1,y*C}}),Ci=function(f){return new fr(f)},Fo='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ei=_r.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(dt.inlineSvg?Fo+" ":"")+"Leaflet</a>"},initialize:function(f){w(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=Et("div","leaflet-control-attribution"),oa(this._container);for(var y in f._layers)f._layers[y].getAttribution&&this.addAttribution(f._layers[y].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var y in this._attributions)this._attributions[y]&&f.push(y);var C=[];this.options.prefix&&C.push(this.options.prefix),f.length&&C.push(f.join(", ")),this._container.innerHTML=C.join(' <span aria-hidden="true">|</span> ')}}});Ht.mergeOptions({attributionControl:!0}),Ht.addInitHook(function(){this.options.attributionControl&&new ei().addTo(this)});var ud=function(f){return new ei(f)};_r.Layers=Lo,_r.Zoom=Si,_r.Scale=fr,_r.Attribution=ei,Ps.layers=Za,Ps.zoom=zl,Ps.scale=Ci,Ps.attribution=ud;var Mr=Y.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Mr.addTo=function(f,y){return f.addHandler(y,this),this};var qo={Events:J},Ti=dt.touch?"touchstart mousedown":"mousedown",qr=ee.extend({options:{clickTolerance:3},initialize:function(f,y,C,A){w(this,A),this._element=f,this._dragStartTarget=y||f,this._preventOutline=C},enable:function(){this._enabled||(Ct(this._dragStartTarget,Ti,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(qr._dragging===this&&this.finishDrag(!0),ln(this._dragStartTarget,Ti,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!_i(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){qr._dragging===this&&this.finishDrag();return}if(!(qr._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(qr._dragging=this,this._preventOutline&&Ni(this._element),Ba(),Kt(),!this._moving)){this.fire("down");var y=f.touches?f.touches[0]:f,C=hs(this._element);this._startPoint=new X(y.clientX,y.clientY),this._startPos=fs(this._element),this._parentScale=Gr(C);var A=f.type==="mousedown";Ct(document,A?"mousemove":"touchmove",this._onMove,this),Ct(document,A?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var y=f.touches&&f.touches.length===1?f.touches[0]:f,C=new X(y.clientX,y.clientY)._subtract(this._startPoint);!C.x&&!C.y||Math.abs(C.x)+Math.abs(C.y)<this.options.clickTolerance||(C.x/=this._parentScale.x,C.y/=this._parentScale.y,Tn(f),this._moved||(this.fire("dragstart"),this._moved=!0,Mt(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Mt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(C),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),En(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){gn(document.body,"leaflet-dragging"),this._lastTarget&&(gn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ln(document,"mousemove touchmove",this._onMove,this),ln(document,"mouseup touchend touchcancel",this._onUp,this),Wa(),ji();var y=this._moved&&this._moving;this._moving=!1,qr._dragging=!1,y&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function zo(f,y,C){var A,V=[1,4,2,8],K,he,Se,De,We,st,Nt,$t;for(K=0,st=f.length;K<st;K++)f[K]._code=ti(f[K],y);for(Se=0;Se<4;Se++){for(Nt=V[Se],A=[],K=0,st=f.length,he=st-1;K<st;he=K++)De=f[K],We=f[he],De._code&Nt?We._code&Nt||($t=Ja(We,De,Nt,y,C),$t._code=ti($t,y),A.push($t)):(We._code&Nt&&($t=Ja(We,De,Nt,y,C),$t._code=ti($t,y),A.push($t)),A.push(De));f=A}return f}function Ul(f,y){var C,A,V,K,he,Se,De,We,st;if(!f||f.length===0)throw new Error("latlngs not passed");Dr(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var Nt=pe([0,0]),$t=de(f),jr=$t.getNorthWest().distanceTo($t.getSouthWest())*$t.getNorthEast().distanceTo($t.getNorthWest());jr<1700&&(Nt=Uo(f));var hr=f.length,xs=[];for(C=0;C<hr;C++){var Jr=pe(f[C]);xs.push(y.project(pe([Jr.lat-Nt.lat,Jr.lng-Nt.lng])))}for(Se=De=We=0,C=0,A=hr-1;C<hr;A=C++)V=xs[C],K=xs[A],he=V.y*K.x-K.y*V.x,De+=(V.x+K.x)*he,We+=(V.y+K.y)*he,Se+=he*3;Se===0?st=xs[0]:st=[De/Se,We/Se];var ac=y.unproject(oe(st));return pe([ac.lat+Nt.lat,ac.lng+Nt.lng])}function Uo(f){for(var y=0,C=0,A=0,V=0;V<f.length;V++){var K=pe(f[V]);y+=K.lat,C+=K.lng,A++}return pe([y/A,C/A])}var fd={__proto__:null,clipPolygon:zo,polygonCenter:Ul,centroid:Uo};function Ka(f,y){if(!y||!f.length)return f.slice();var C=y*y;return f=pd(f,C),f=md(f,C),f}function Vl(f,y,C){return Math.sqrt(ni(f,y,C,!0))}function hd(f,y,C){return ni(f,y,C)}function md(f,y){var C=f.length,A=typeof Uint8Array<"u"?Uint8Array:Array,V=new A(C);V[0]=V[C-1]=1,Vo(f,V,y,0,C-1);var K,he=[];for(K=0;K<C;K++)V[K]&&he.push(f[K]);return he}function Vo(f,y,C,A,V){var K=0,he,Se,De;for(Se=A+1;Se<=V-1;Se++)De=ni(f[Se],f[A],f[V],!0),De>K&&(he=Se,K=De);K>C&&(y[he]=1,Vo(f,y,C,A,he),Vo(f,y,C,he,V))}function pd(f,y){for(var C=[f[0]],A=1,V=0,K=f.length;A<K;A++)gd(f[A],f[V])>y&&(C.push(f[A]),V=A);return V<K-1&&C.push(f[K-1]),C}var Bo;function Bl(f,y,C,A,V){var K=A?Bo:ti(f,C),he=ti(y,C),Se,De,We;for(Bo=he;;){if(!(K|he))return[f,y];if(K&he)return!1;Se=K||he,De=Ja(f,y,Se,C,V),We=ti(De,C),Se===K?(f=De,K=We):(y=De,he=We)}}function Ja(f,y,C,A,V){var K=y.x-f.x,he=y.y-f.y,Se=A.min,De=A.max,We,st;return C&8?(We=f.x+K*(De.y-f.y)/he,st=De.y):C&4?(We=f.x+K*(Se.y-f.y)/he,st=Se.y):C&2?(We=De.x,st=f.y+he*(De.x-f.x)/K):C&1&&(We=Se.x,st=f.y+he*(Se.x-f.x)/K),new X(We,st,V)}function ti(f,y){var C=0;return f.x<y.min.x?C|=1:f.x>y.max.x&&(C|=2),f.y<y.min.y?C|=4:f.y>y.max.y&&(C|=8),C}function gd(f,y){var C=y.x-f.x,A=y.y-f.y;return C*C+A*A}function ni(f,y,C,A){var V=y.x,K=y.y,he=C.x-V,Se=C.y-K,De=he*he+Se*Se,We;return De>0&&(We=((f.x-V)*he+(f.y-K)*Se)/De,We>1?(V=C.x,K=C.y):We>0&&(V+=he*We,K+=Se*We)),he=f.x-V,Se=f.y-K,A?he*he+Se*Se:new X(V,K)}function Dr(f){return!E(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function Wl(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Dr(f)}function $l(f,y){var C,A,V,K,he,Se,De,We;if(!f||f.length===0)throw new Error("latlngs not passed");Dr(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var st=pe([0,0]),Nt=de(f),$t=Nt.getNorthWest().distanceTo(Nt.getSouthWest())*Nt.getNorthEast().distanceTo(Nt.getNorthWest());$t<1700&&(st=Uo(f));var jr=f.length,hr=[];for(C=0;C<jr;C++){var xs=pe(f[C]);hr.push(y.project(pe([xs.lat-st.lat,xs.lng-st.lng])))}for(C=0,A=0;C<jr-1;C++)A+=hr[C].distanceTo(hr[C+1])/2;if(A===0)We=hr[0];else for(C=0,K=0;C<jr-1;C++)if(he=hr[C],Se=hr[C+1],V=he.distanceTo(Se),K+=V,K>A){De=(K-A)/V,We=[Se.x-De*(Se.x-he.x),Se.y-De*(Se.y-he.y)];break}var Jr=y.unproject(oe(We));return pe([Jr.lat+st.lat,Jr.lng+st.lng])}var Hl={__proto__:null,simplify:Ka,pointToSegmentDistance:Vl,closestPointOnSegment:hd,clipSegment:Bl,_getEdgeIntersection:Ja,_getBitCode:ti,_sqClosestPointOnSegment:ni,isFlat:Dr,_flat:Wl,polylineCenter:$l},Wo={project:function(f){return new X(f.lng,f.lat)},unproject:function(f){return new ce(f.y,f.x)},bounds:new H([-180,-90],[180,90])},$o={R:6378137,R_MINOR:6356752314245179e-9,bounds:new H([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var y=Math.PI/180,C=this.R,A=f.lat*y,V=this.R_MINOR/C,K=Math.sqrt(1-V*V),he=K*Math.sin(A),Se=Math.tan(Math.PI/4-A/2)/Math.pow((1-he)/(1+he),K/2);return A=-C*Math.log(Math.max(Se,1e-10)),new X(f.lng*y*C,A)},unproject:function(f){for(var y=180/Math.PI,C=this.R,A=this.R_MINOR/C,V=Math.sqrt(1-A*A),K=Math.exp(-f.y/C),he=Math.PI/2-2*Math.atan(K),Se=0,De=.1,We;Se<15&&Math.abs(De)>1e-7;Se++)We=V*Math.sin(he),We=Math.pow((1-We)/(1+We),V/2),De=Math.PI/2-2*Math.atan(K*We)-he,he+=De;return new ce(he*y,f.x*y/C)}},xd={__proto__:null,LonLat:Wo,Mercator:$o,SphericalMercator:ve},yd=s({},xe,{code:"EPSG:3395",projection:$o,transformation:(function(){var f=.5/(Math.PI*$o.R);return Pe(f,.5,-f,.5)})()}),Yl=s({},xe,{code:"EPSG:4326",projection:Wo,transformation:Pe(1/180,1,-1/180,.5)}),vd=s({},ie,{projection:Wo,transformation:Pe(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,y){var C=y.lng-f.lng,A=y.lat-f.lat;return Math.sqrt(C*C+A*A)},infinite:!0});ie.Earth=xe,ie.EPSG3395=yd,ie.EPSG3857=Ie,ie.EPSG900913=Fe,ie.EPSG4326=Yl,ie.Simple=vd;var zr=ee.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[c(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[c(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var y=f.target;if(y.hasLayer(this)){if(this._map=y,this._zoomAnimated=y._zoomAnimated,this.getEvents){var C=this.getEvents();y.on(C,this),this.once("remove",function(){y.off(C,this)},this)}this.onAdd(y),this.fire("add"),y.fire("layeradd",{layer:this})}}});Ht.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var y=c(f);return this._layers[y]?this:(this._layers[y]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var y=c(f);return this._layers[y]?(this._loaded&&f.onRemove(this),delete this._layers[y],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return c(f)in this._layers},eachLayer:function(f,y){for(var C in this._layers)f.call(y,this._layers[C]);return this},_addLayers:function(f){f=f?E(f)?f:[f]:[];for(var y=0,C=f.length;y<C;y++)this.addLayer(f[y])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[c(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var y=c(f);this._zoomBoundLayers[y]&&(delete this._zoomBoundLayers[y],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,y=-1/0,C=this._getZoomSpan();for(var A in this._zoomBoundLayers){var V=this._zoomBoundLayers[A].options;f=V.minZoom===void 0?f:Math.min(f,V.minZoom),y=V.maxZoom===void 0?y:Math.max(y,V.maxZoom)}this._layersMaxZoom=y===-1/0?void 0:y,this._layersMinZoom=f===1/0?void 0:f,C!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ms=zr.extend({initialize:function(f,y){w(this,y),this._layers={};var C,A;if(f)for(C=0,A=f.length;C<A;C++)this.addLayer(f[C])},addLayer:function(f){var y=this.getLayerId(f);return this._layers[y]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var y=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[y]&&this._map.removeLayer(this._layers[y]),delete this._layers[y],this},hasLayer:function(f){var y=typeof f=="number"?f:this.getLayerId(f);return y in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var y=Array.prototype.slice.call(arguments,1),C,A;for(C in this._layers)A=this._layers[C],A[f]&&A[f].apply(A,y);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,y){for(var C in this._layers)f.call(y,this._layers[C]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return c(f)}}),da=function(f,y){return new Ms(f,y)},ms=Ms.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),Ms.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),Ms.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new ne;for(var y in this._layers){var C=this._layers[y];f.extend(C.getBounds?C.getBounds():C.getLatLng())}return f}}),Gl=function(f,y){return new ms(f,y)},ri=Y.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){w(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,y){var C=this._getIconUrl(f);if(!C){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var A=this._createImg(C,y&&y.tagName==="IMG"?y:null);return this._setIconStyles(A,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),A},_setIconStyles:function(f,y){var C=this.options,A=C[y+"Size"];typeof A=="number"&&(A=[A,A]);var V=oe(A),K=oe(y==="shadow"&&C.shadowAnchor||C.iconAnchor||V&&V.divideBy(2,!0));f.className="leaflet-marker-"+y+" "+(C.className||""),K&&(f.style.marginLeft=-K.x+"px",f.style.marginTop=-K.y+"px"),V&&(f.style.width=V.x+"px",f.style.height=V.y+"px")},_createImg:function(f,y){return y=y||document.createElement("img"),y.src=f,y},_getIconUrl:function(f){return dt.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function Zl(f){return new ri(f)}var ki=ri.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof ki.imagePath!="string"&&(ki.imagePath=this._detectIconPath()),(this.options.imagePath||ki.imagePath)+ri.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var y=function(C,A,V){var K=A.exec(C);return K&&K[V]};return f=y(f,/^url\((['"])?(.+)\1\)$/,2),f&&y(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=Et("div","leaflet-default-icon-path",document.body),y=ra(f,"background-image")||ra(f,"backgroundImage");if(document.body.removeChild(f),y=this._stripUrl(y),y)return y;var C=document.querySelector('link[href$="leaflet.css"]');return C?C.href.substring(0,C.href.length-11-1):""}}),Ho=Mr.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new qr(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Mt(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&gn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var y=this._marker,C=y._map,A=this._marker.options.autoPanSpeed,V=this._marker.options.autoPanPadding,K=fs(y._icon),he=C.getPixelBounds(),Se=C.getPixelOrigin(),De=Q(he.min._subtract(Se).add(V),he.max._subtract(Se).subtract(V));if(!De.contains(K)){var We=oe((Math.max(De.max.x,K.x)-De.max.x)/(he.max.x-De.max.x)-(Math.min(De.min.x,K.x)-De.min.x)/(he.min.x-De.min.x),(Math.max(De.max.y,K.y)-De.max.y)/(he.max.y-De.max.y)-(Math.min(De.min.y,K.y)-De.min.y)/(he.min.y-De.min.y)).multiplyBy(A);C.panBy(We,{animate:!1}),this._draggable._newPos._add(We),this._draggable._startPos._add(We),En(y._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=W(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&($(this._panRequest),this._panRequest=W(this._adjustPan.bind(this,f)))},_onDrag:function(f){var y=this._marker,C=y._shadow,A=fs(y._icon),V=y._map.layerPointToLatLng(A);C&&En(C,A),y._latlng=V,f.latlng=V,f.oldLatLng=this._oldLatLng,y.fire("move",f).fire("drag",f)},_onDragEnd:function(f){$(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),ps=zr.extend({options:{icon:new ki,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,y){w(this,y),this._latlng=pe(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var y=this._latlng;return this._latlng=pe(f),this.update(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,y="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),C=f.icon.createIcon(this._icon),A=!1;C!==this._icon&&(this._icon&&this._removeIcon(),A=!0,f.title&&(C.title=f.title),C.tagName==="IMG"&&(C.alt=f.alt||"")),Mt(C,y),f.keyboard&&(C.tabIndex="0",C.setAttribute("role","button")),this._icon=C,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ct(C,"focus",this._panOnFocus,this);var V=f.icon.createShadow(this._shadow),K=!1;V!==this._shadow&&(this._removeShadow(),K=!0),V&&(Mt(V,y),V.alt=""),this._shadow=V,f.opacity<1&&this._updateOpacity(),A&&this.getPane().appendChild(this._icon),this._initInteraction(),V&&K&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ln(this._icon,"focus",this._panOnFocus,this),bn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&bn(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&En(this._icon,f),this._shadow&&En(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(y)},_initInteraction:function(){if(this.options.interactive&&(Mt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ho)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ho(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&ur(this._icon,f),this._shadow&&ur(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var y=this.options.icon.options,C=y.iconSize?oe(y.iconSize):oe(0,0),A=y.iconAnchor?oe(y.iconAnchor):oe(0,0);f.panInside(this._latlng,{paddingTopLeft:A,paddingBottomRight:C.subtract(A)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function bd(f,y){return new ps(f,y)}var Ds=zr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return w(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Qa=Ds.extend({options:{fill:!0,radius:10},initialize:function(f,y){w(this,y),this._latlng=pe(f),this._radius=this.options.radius},setLatLng:function(f){var y=this._latlng;return this._latlng=pe(f),this.redraw(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var y=f&&f.radius||this._radius;return Ds.prototype.setStyle.call(this,f),this.setRadius(y),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,y=this._radiusY||f,C=this._clickTolerance(),A=[f+C,y+C];this._pxBounds=new H(this._point.subtract(A),this._point.add(A))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Kl(f,y){return new Qa(f,y)}var Xa=Qa.extend({initialize:function(f,y,C){if(typeof y=="number"&&(y=s({},C,{radius:y})),w(this,y),this._latlng=pe(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new ne(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:Ds.prototype.setStyle,_project:function(){var f=this._latlng.lng,y=this._latlng.lat,C=this._map,A=C.options.crs;if(A.distance===xe.distance){var V=Math.PI/180,K=this._mRadius/xe.R/V,he=C.project([y+K,f]),Se=C.project([y-K,f]),De=he.add(Se).divideBy(2),We=C.unproject(De).lat,st=Math.acos((Math.cos(K*V)-Math.sin(y*V)*Math.sin(We*V))/(Math.cos(y*V)*Math.cos(We*V)))/V;(isNaN(st)||st===0)&&(st=K/Math.cos(Math.PI/180*y)),this._point=De.subtract(C.getPixelOrigin()),this._radius=isNaN(st)?0:De.x-C.project([We,f-st]).x,this._radiusY=De.y-he.y}else{var Nt=A.unproject(A.project(this._latlng).subtract([this._mRadius,0]));this._point=C.latLngToLayerPoint(this._latlng),this._radius=this._point.x-C.latLngToLayerPoint(Nt).x}this._updateBounds()}});function ua(f,y,C){return new Xa(f,y,C)}var wr=Ds.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,y){w(this,y),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var y=1/0,C=null,A=ni,V,K,he=0,Se=this._parts.length;he<Se;he++)for(var De=this._parts[he],We=1,st=De.length;We<st;We++){V=De[We-1],K=De[We];var Nt=A(f,V,K,!0);Nt<y&&(y=Nt,C=A(f,V,K))}return C&&(C.distance=Math.sqrt(y)),C},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return $l(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,y){return y=y||this._defaultShape(),f=pe(f),y.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new ne,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return Dr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var y=[],C=Dr(f),A=0,V=f.length;A<V;A++)C?(y[A]=pe(f[A]),this._bounds.extend(y[A])):y[A]=this._convertLatLngs(f[A]);return y},_project:function(){var f=new H;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),y=new X(f,f);this._rawPxBounds&&(this._pxBounds=new H([this._rawPxBounds.min.subtract(y),this._rawPxBounds.max.add(y)]))},_projectLatlngs:function(f,y,C){var A=f[0]instanceof ce,V=f.length,K,he;if(A){for(he=[],K=0;K<V;K++)he[K]=this._map.latLngToLayerPoint(f[K]),C.extend(he[K]);y.push(he)}else for(K=0;K<V;K++)this._projectLatlngs(f[K],y,C)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var y=this._parts,C,A,V,K,he,Se,De;for(C=0,V=0,K=this._rings.length;C<K;C++)for(De=this._rings[C],A=0,he=De.length;A<he-1;A++)Se=Bl(De[A],De[A+1],f,A,!0),Se&&(y[V]=y[V]||[],y[V].push(Se[0]),(Se[1]!==De[A+1]||A===he-2)&&(y[V].push(Se[1]),V++))}},_simplifyPoints:function(){for(var f=this._parts,y=this.options.smoothFactor,C=0,A=f.length;C<A;C++)f[C]=Ka(f[C],y)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,y){var C,A,V,K,he,Se,De=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(C=0,K=this._parts.length;C<K;C++)for(Se=this._parts[C],A=0,he=Se.length,V=he-1;A<he;V=A++)if(!(!y&&A===0)&&Vl(f,Se[V],Se[A])<=De)return!0;return!1}});function _d(f,y){return new wr(f,y)}wr._flat=Wl;var gs=wr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ul(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var y=wr.prototype._convertLatLngs.call(this,f),C=y.length;return C>=2&&y[0]instanceof ce&&y[0].equals(y[C-1])&&y.pop(),y},_setLatLngs:function(f){wr.prototype._setLatLngs.call(this,f),Dr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Dr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,y=this.options.weight,C=new X(y,y);if(f=new H(f.min.subtract(C),f.max.add(C)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var A=0,V=this._rings.length,K;A<V;A++)K=zo(this._rings[A],f,!0),K.length&&this._parts.push(K)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var y=!1,C,A,V,K,he,Se,De,We;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(K=0,De=this._parts.length;K<De;K++)for(C=this._parts[K],he=0,We=C.length,Se=We-1;he<We;Se=he++)A=C[he],V=C[Se],A.y>f.y!=V.y>f.y&&f.x<(V.x-A.x)*(f.y-A.y)/(V.y-A.y)+A.x&&(y=!y);return y||wr.prototype._containsPoint.call(this,f,!0)}});function wd(f,y){return new gs(f,y)}var Kr=ms.extend({initialize:function(f,y){w(this,y),this._layers={},f&&this.addData(f)},addData:function(f){var y=E(f)?f:f.features,C,A,V;if(y){for(C=0,A=y.length;C<A;C++)V=y[C],(V.geometries||V.geometry||V.features||V.coordinates)&&this.addData(V);return this}var K=this.options;if(K.filter&&!K.filter(f))return this;var he=Pi(f,K);return he?(he.feature=so(f),he.defaultOptions=he.options,this.resetStyle(he),K.onEachFeature&&K.onEachFeature(f,he),this.addLayer(he)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=s({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(y){this._setLayerStyle(y,f)},this)},_setLayerStyle:function(f,y){f.setStyle&&(typeof y=="function"&&(y=y(f.feature)),f.setStyle(y))}});function Pi(f,y){var C=f.type==="Feature"?f.geometry:f,A=C?C.coordinates:null,V=[],K=y&&y.pointToLayer,he=y&&y.coordsToLatLng||to,Se,De,We,st;if(!A&&!C)return null;switch(C.type){case"Point":return Se=he(A),eo(K,f,Se,y);case"MultiPoint":for(We=0,st=A.length;We<st;We++)Se=he(A[We]),V.push(eo(K,f,Se,y));return new ms(V);case"LineString":case"MultiLineString":return De=fa(A,C.type==="LineString"?0:1,he),new wr(De,y);case"Polygon":case"MultiPolygon":return De=fa(A,C.type==="Polygon"?1:2,he),new gs(De,y);case"GeometryCollection":for(We=0,st=C.geometries.length;We<st;We++){var Nt=Pi({geometry:C.geometries[We],type:"Feature",properties:f.properties},y);Nt&&V.push(Nt)}return new ms(V);case"FeatureCollection":for(We=0,st=C.features.length;We<st;We++){var $t=Pi(C.features[We],y);$t&&V.push($t)}return new ms(V);default:throw new Error("Invalid GeoJSON object.")}}function eo(f,y,C,A){return f?f(y,C):new ps(C,A&&A.markersInheritOptions&&A)}function to(f){return new ce(f[1],f[0],f[2])}function fa(f,y,C){for(var A=[],V=0,K=f.length,he;V<K;V++)he=y?fa(f[V],y-1,C):(C||to)(f[V]),A.push(he);return A}function no(f,y){return f=pe(f),f.alt!==void 0?[x(f.lng,y),x(f.lat,y),x(f.alt,y)]:[x(f.lng,y),x(f.lat,y)]}function ro(f,y,C,A){for(var V=[],K=0,he=f.length;K<he;K++)V.push(y?ro(f[K],Dr(f[K])?0:y-1,C,A):no(f[K],A));return!y&&C&&V.length>0&&V.push(V[0].slice()),V}function Mi(f,y){return f.feature?s({},f.feature,{geometry:y}):so(y)}function so(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var Yo={toGeoJSON:function(f){return Mi(this,{type:"Point",coordinates:no(this.getLatLng(),f)})}};ps.include(Yo),Xa.include(Yo),Qa.include(Yo),wr.include({toGeoJSON:function(f){var y=!Dr(this._latlngs),C=ro(this._latlngs,y?1:0,!1,f);return Mi(this,{type:(y?"Multi":"")+"LineString",coordinates:C})}}),gs.include({toGeoJSON:function(f){var y=!Dr(this._latlngs),C=y&&!Dr(this._latlngs[0]),A=ro(this._latlngs,C?2:y?1:0,!0,f);return y||(A=[A]),Mi(this,{type:(C?"Multi":"")+"Polygon",coordinates:A})}}),Ms.include({toMultiPoint:function(f){var y=[];return this.eachLayer(function(C){y.push(C.toGeoJSON(f).geometry.coordinates)}),Mi(this,{type:"MultiPoint",coordinates:y})},toGeoJSON:function(f){var y=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(y==="MultiPoint")return this.toMultiPoint(f);var C=y==="GeometryCollection",A=[];return this.eachLayer(function(V){if(V.toGeoJSON){var K=V.toGeoJSON(f);if(C)A.push(K.geometry);else{var he=so(K);he.type==="FeatureCollection"?A.push.apply(A,he.features):A.push(he)}}}),C?Mi(this,{geometries:A,type:"GeometryCollection"}):{type:"FeatureCollection",features:A}}});function Jl(f,y){return new Kr(f,y)}var Ur=Jl,Es=zr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,y,C){this._url=f,this._bounds=de(y),w(this,C)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Mt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){bn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&bi(this._image),this},bringToBack:function(){return this._map&&us(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=de(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",y=this._image=f?this._url:Et("img");if(Mt(y,"leaflet-image-layer"),this._zoomAnimated&&Mt(y,"leaflet-zoom-animated"),this.options.className&&Mt(y,this.options.className),y.onselectstart=p,y.onmousemove=p,y.onload=o(this.fire,this,"load"),y.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=y.src;return}y.src=this._url,y.alt=this.options.alt},_animateZoom:function(f){var y=this._map.getZoomScale(f.zoom),C=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;Rr(this._image,C,y)},_reset:function(){var f=this._image,y=new H(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),C=y.getSize();En(f,y.min),f.style.width=C.x+"px",f.style.height=C.y+"px"},_updateOpacity:function(){ur(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),Ql=function(f,y,C){return new Es(f,y,C)},Go=Es.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",y=this._image=f?this._url:Et("video");if(Mt(y,"leaflet-image-layer"),this._zoomAnimated&&Mt(y,"leaflet-zoom-animated"),this.options.className&&Mt(y,this.options.className),y.onselectstart=p,y.onmousemove=p,y.onloadeddata=o(this.fire,this,"load"),f){for(var C=y.getElementsByTagName("source"),A=[],V=0;V<C.length;V++)A.push(C[V].src);this._url=C.length>0?A:[y.src];return}E(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(y.style,"objectFit")&&(y.style.objectFit="fill"),y.autoplay=!!this.options.autoplay,y.loop=!!this.options.loop,y.muted=!!this.options.muted,y.playsInline=!!this.options.playsInline;for(var K=0;K<this._url.length;K++){var he=Et("source");he.src=this._url[K],y.appendChild(he)}}});function Xl(f,y,C){return new Go(f,y,C)}var Zo=Es.extend({_initImage:function(){var f=this._image=this._url;Mt(f,"leaflet-image-layer"),this._zoomAnimated&&Mt(f,"leaflet-zoom-animated"),this.options.className&&Mt(f,this.options.className),f.onselectstart=p,f.onmousemove=p}});function Ko(f,y,C){return new Zo(f,y,C)}var g=zr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,y){f&&(f instanceof ce||E(f))?(this._latlng=pe(f),w(this,y)):(w(this,f),this._source=y),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&ur(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&ur(this._container,1),this.bringToFront(),this.options.interactive&&(Mt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(ur(this._container,0),this._removeTimeout=setTimeout(o(bn,void 0,this._container),200)):bn(this._container),this.options.interactive&&(gn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=pe(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&bi(this._container),this},bringToBack:function(){return this._map&&us(this._container),this},_prepareOpen:function(f){var y=this._source;if(!y._map)return!1;if(y instanceof ms){y=null;var C=this._source._layers;for(var A in C)if(C[A]._map){y=C[A];break}if(!y)return!1;this._source=y}if(!f)if(y.getCenter)f=y.getCenter();else if(y.getLatLng)f=y.getLatLng();else if(y.getBounds)f=y.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,y=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof y=="string")f.innerHTML=y;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(y)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),y=oe(this.options.offset),C=this._getAnchor();this._zoomAnimated?En(this._container,f.add(C)):y=y.add(f).add(C);var A=this._containerBottom=-y.y,V=this._containerLeft=-Math.round(this._containerWidth/2)+y.x;this._container.style.bottom=A+"px",this._container.style.left=V+"px"}},_getAnchor:function(){return[0,0]}});Ht.include({_initOverlay:function(f,y,C,A){var V=y;return V instanceof f||(V=new f(A).setContent(y)),C&&V.setLatLng(C),V}}),zr.include({_initOverlay:function(f,y,C,A){var V=C;return V instanceof f?(w(V,A),V._source=this):(V=y&&!A?y:new f(A,this),V.setContent(C)),V}});var ju=g.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,g.prototype.openOn.call(this,f)},onAdd:function(f){g.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ds||this._source.on("preclick",Zr))},onRemove:function(f){g.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ds||this._source.off("preclick",Zr))},getEvents:function(){var f=g.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",y=this._container=Et("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),C=this._wrapper=Et("div",f+"-content-wrapper",y);if(this._contentNode=Et("div",f+"-content",C),oa(y),Ha(this._contentNode),Ct(y,"contextmenu",Zr),this._tipContainer=Et("div",f+"-tip-container",y),this._tip=Et("div",f+"-tip",this._tipContainer),this.options.closeButton){var A=this._closeButton=Et("a",f+"-close-button",y);A.setAttribute("role","button"),A.setAttribute("aria-label","Close popup"),A.href="#close",A.innerHTML='<span aria-hidden="true">&#215;</span>',Ct(A,"click",function(V){Tn(V),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,y=f.style;y.width="",y.whiteSpace="nowrap";var C=f.offsetWidth;C=Math.min(C,this.options.maxWidth),C=Math.max(C,this.options.minWidth),y.width=C+1+"px",y.whiteSpace="",y.height="";var A=f.offsetHeight,V=this.options.maxHeight,K="leaflet-popup-scrolled";V&&A>V?(y.height=V+"px",Mt(f,K)):gn(f,K),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),C=this._getAnchor();En(this._container,y.add(C))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,y=parseInt(ra(this._container,"marginBottom"),10)||0,C=this._container.offsetHeight+y,A=this._containerWidth,V=new X(this._containerLeft,-C-this._containerBottom);V._add(fs(this._container));var K=f.layerPointToContainerPoint(V),he=oe(this.options.autoPanPadding),Se=oe(this.options.autoPanPaddingTopLeft||he),De=oe(this.options.autoPanPaddingBottomRight||he),We=f.getSize(),st=0,Nt=0;K.x+A+De.x>We.x&&(st=K.x+A-We.x+De.x),K.x-st-Se.x<0&&(st=K.x-Se.x),K.y+C+De.y>We.y&&(Nt=K.y+C-We.y+De.y),K.y-Nt-Se.y<0&&(Nt=K.y-Se.y),(st||Nt)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([st,Nt]))}},_getAnchor:function(){return oe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ec=function(f,y){return new ju(f,y)};Ht.mergeOptions({closePopupOnClick:!0}),Ht.include({openPopup:function(f,y,C){return this._initOverlay(ju,f,y,C).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),zr.include({bindPopup:function(f,y){return this._popup=this._initOverlay(ju,this._popup,f,y),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof ms||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){Fr(f);var y=f.layer||f.target;if(this._popup._source===y&&!(y instanceof Ds)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=y,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var tc=g.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){g.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){g.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=g.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",y=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Et("div",y),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var y,C,A=this._map,V=this._container,K=A.latLngToContainerPoint(A.getCenter()),he=A.layerPointToContainerPoint(f),Se=this.options.direction,De=V.offsetWidth,We=V.offsetHeight,st=oe(this.options.offset),Nt=this._getAnchor();Se==="top"?(y=De/2,C=We):Se==="bottom"?(y=De/2,C=0):Se==="center"?(y=De/2,C=We/2):Se==="right"?(y=0,C=We/2):Se==="left"?(y=De,C=We/2):he.x<K.x?(Se="right",y=0,C=We/2):(Se="left",y=De+(st.x+Nt.x)*2,C=We/2),f=f.subtract(oe(y,C,!0)).add(st).add(Nt),gn(V,"leaflet-tooltip-right"),gn(V,"leaflet-tooltip-left"),gn(V,"leaflet-tooltip-top"),gn(V,"leaflet-tooltip-bottom"),Mt(V,"leaflet-tooltip-"+Se),En(V,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&ur(this._container,f)},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(y)},_getAnchor:function(){return oe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),jd=function(f,y){return new tc(f,y)};Ht.include({openTooltip:function(f,y,C){return this._initOverlay(tc,f,y,C).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),zr.include({bindTooltip:function(f,y){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(tc,this._tooltip,f,y),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var y=f?"off":"on",C={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?C.add=this._openTooltip:(C.mouseover=this._openTooltip,C.mouseout=this.closeTooltip,C.click=this._openTooltip,this._map?this._addFocusListeners():C.add=this._addFocusListeners),this._tooltip.options.sticky&&(C.mousemove=this._moveTooltip),this[y](C),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof ms||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var y=typeof f.getElement=="function"&&f.getElement();y&&(Ct(y,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),Ct(y,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var y=typeof f.getElement=="function"&&f.getElement();y&&y.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var y=this;this._map.once("moveend",function(){y._openOnceFlag=!1,y._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var y=f.latlng,C,A;this._tooltip.options.sticky&&f.originalEvent&&(C=this._map.mouseEventToContainerPoint(f.originalEvent),A=this._map.containerPointToLayerPoint(C),y=this._map.layerPointToLatLng(A)),this._tooltip.setLatLng(y)}});var Nu=ri.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var y=f&&f.tagName==="DIV"?f:document.createElement("div"),C=this.options;if(C.html instanceof Element?(za(y),y.appendChild(C.html)):y.innerHTML=C.html!==!1?C.html:"",C.bgPos){var A=oe(C.bgPos);y.style.backgroundPosition=-A.x+"px "+-A.y+"px"}return this._setIconStyles(y,"icon"),y},createShadow:function(){return null}});function Em(f){return new Nu(f)}ri.Default=ki;var io=zr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:dt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){w(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),bn(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(bi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(us(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof X?f:new X(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var y=this.getPane().children,C=-f(-1/0,1/0),A=0,V=y.length,K;A<V;A++)K=y[A].style.zIndex,y[A]!==this._container&&K&&(C=f(C,+K));isFinite(C)&&(this.options.zIndex=C+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!dt.ielt9){ur(this._container,this.options.opacity);var f=+new Date,y=!1,C=!1;for(var A in this._tiles){var V=this._tiles[A];if(!(!V.current||!V.loaded)){var K=Math.min(1,(f-V.loaded)/200);ur(V.el,K),K<1?y=!0:(V.active?C=!0:this._onOpaqueTile(V),V.active=!0)}}C&&!this._noPrune&&this._pruneTiles(),y&&($(this._fadeFrame),this._fadeFrame=W(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=Et("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,y=this.options.maxZoom;if(f!==void 0){for(var C in this._levels)C=Number(C),this._levels[C].el.children.length||C===f?(this._levels[C].el.style.zIndex=y-Math.abs(f-C),this._onUpdateLevel(C)):(bn(this._levels[C].el),this._removeTilesAtZoom(C),this._onRemoveLevel(C),delete this._levels[C]);var A=this._levels[f],V=this._map;return A||(A=this._levels[f]={},A.el=Et("div","leaflet-tile-container leaflet-zoom-animated",this._container),A.el.style.zIndex=y,A.origin=V.project(V.unproject(V.getPixelOrigin()),f).round(),A.zoom=f,this._setZoomTransform(A,V.getCenter(),V.getZoom()),p(A.el.offsetWidth),this._onCreateLevel(A)),this._level=A,A}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var f,y,C=this._map.getZoom();if(C>this.options.maxZoom||C<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)y=this._tiles[f],y.retain=y.current;for(f in this._tiles)if(y=this._tiles[f],y.current&&!y.active){var A=y.coords;this._retainParent(A.x,A.y,A.z,A.z-5)||this._retainChildren(A.x,A.y,A.z,A.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var y in this._tiles)this._tiles[y].coords.z===f&&this._removeTile(y)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)bn(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,y,C,A){var V=Math.floor(f/2),K=Math.floor(y/2),he=C-1,Se=new X(+V,+K);Se.z=+he;var De=this._tileCoordsToKey(Se),We=this._tiles[De];return We&&We.active?(We.retain=!0,!0):(We&&We.loaded&&(We.retain=!0),he>A?this._retainParent(V,K,he,A):!1)},_retainChildren:function(f,y,C,A){for(var V=2*f;V<2*f+2;V++)for(var K=2*y;K<2*y+2;K++){var he=new X(V,K);he.z=C+1;var Se=this._tileCoordsToKey(he),De=this._tiles[Se];if(De&&De.active){De.retain=!0;continue}else De&&De.loaded&&(De.retain=!0);C+1<A&&this._retainChildren(V,K,C+1,A)}},_resetView:function(f){var y=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),y,y)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var y=this.options;return y.minNativeZoom!==void 0&&f<y.minNativeZoom?y.minNativeZoom:y.maxNativeZoom!==void 0&&y.maxNativeZoom<f?y.maxNativeZoom:f},_setView:function(f,y,C,A){var V=Math.round(y);this.options.maxZoom!==void 0&&V>this.options.maxZoom||this.options.minZoom!==void 0&&V<this.options.minZoom?V=void 0:V=this._clampZoom(V);var K=this.options.updateWhenZooming&&V!==this._tileZoom;(!A||K)&&(this._tileZoom=V,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),V!==void 0&&this._update(f),C||this._pruneTiles(),this._noPrune=!!C),this._setZoomTransforms(f,y)},_setZoomTransforms:function(f,y){for(var C in this._levels)this._setZoomTransform(this._levels[C],f,y)},_setZoomTransform:function(f,y,C){var A=this._map.getZoomScale(C,f.zoom),V=f.origin.multiplyBy(A).subtract(this._map._getNewPixelOrigin(y,C)).round();dt.any3d?Rr(f.el,V,A):En(f.el,V)},_resetGrid:function(){var f=this._map,y=f.options.crs,C=this._tileSize=this.getTileSize(),A=this._tileZoom,V=this._map.getPixelWorldBounds(this._tileZoom);V&&(this._globalTileRange=this._pxBoundsToTileRange(V)),this._wrapX=y.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,y.wrapLng[0]],A).x/C.x),Math.ceil(f.project([0,y.wrapLng[1]],A).x/C.y)],this._wrapY=y.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([y.wrapLat[0],0],A).y/C.x),Math.ceil(f.project([y.wrapLat[1],0],A).y/C.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var y=this._map,C=y._animatingZoom?Math.max(y._animateToZoom,y.getZoom()):y.getZoom(),A=y.getZoomScale(C,this._tileZoom),V=y.project(f,this._tileZoom).floor(),K=y.getSize().divideBy(A*2);return new H(V.subtract(K),V.add(K))},_update:function(f){var y=this._map;if(y){var C=this._clampZoom(y.getZoom());if(f===void 0&&(f=y.getCenter()),this._tileZoom!==void 0){var A=this._getTiledPixelBounds(f),V=this._pxBoundsToTileRange(A),K=V.getCenter(),he=[],Se=this.options.keepBuffer,De=new H(V.getBottomLeft().subtract([Se,-Se]),V.getTopRight().add([Se,-Se]));if(!(isFinite(V.min.x)&&isFinite(V.min.y)&&isFinite(V.max.x)&&isFinite(V.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var We in this._tiles){var st=this._tiles[We].coords;(st.z!==this._tileZoom||!De.contains(new X(st.x,st.y)))&&(this._tiles[We].current=!1)}if(Math.abs(C-this._tileZoom)>1){this._setView(f,C);return}for(var Nt=V.min.y;Nt<=V.max.y;Nt++)for(var $t=V.min.x;$t<=V.max.x;$t++){var jr=new X($t,Nt);if(jr.z=this._tileZoom,!!this._isValidTile(jr)){var hr=this._tiles[this._tileCoordsToKey(jr)];hr?hr.current=!0:he.push(jr)}}if(he.sort(function(Jr,ac){return Jr.distanceTo(K)-ac.distanceTo(K)}),he.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var xs=document.createDocumentFragment();for($t=0;$t<he.length;$t++)this._addTile(he[$t],xs);this._level.el.appendChild(xs)}}}},_isValidTile:function(f){var y=this._map.options.crs;if(!y.infinite){var C=this._globalTileRange;if(!y.wrapLng&&(f.x<C.min.x||f.x>C.max.x)||!y.wrapLat&&(f.y<C.min.y||f.y>C.max.y))return!1}if(!this.options.bounds)return!0;var A=this._tileCoordsToBounds(f);return de(this.options.bounds).overlaps(A)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var y=this._map,C=this.getTileSize(),A=f.scaleBy(C),V=A.add(C),K=y.unproject(A,f.z),he=y.unproject(V,f.z);return[K,he]},_tileCoordsToBounds:function(f){var y=this._tileCoordsToNwSe(f),C=new ne(y[0],y[1]);return this.options.noWrap||(C=this._map.wrapLatLngBounds(C)),C},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var y=f.split(":"),C=new X(+y[0],+y[1]);return C.z=+y[2],C},_removeTile:function(f){var y=this._tiles[f];y&&(bn(y.el),delete this._tiles[f],this.fire("tileunload",{tile:y.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){Mt(f,"leaflet-tile");var y=this.getTileSize();f.style.width=y.x+"px",f.style.height=y.y+"px",f.onselectstart=p,f.onmousemove=p,dt.ielt9&&this.options.opacity<1&&ur(f,this.options.opacity)},_addTile:function(f,y){var C=this._getTilePos(f),A=this._tileCoordsToKey(f),V=this.createTile(this._wrapCoords(f),o(this._tileReady,this,f));this._initTile(V),this.createTile.length<2&&W(o(this._tileReady,this,f,null,V)),En(V,C),this._tiles[A]={el:V,coords:f,current:!0},y.appendChild(V),this.fire("tileloadstart",{tile:V,coords:f})},_tileReady:function(f,y,C){y&&this.fire("tileerror",{error:y,tile:C,coords:f});var A=this._tileCoordsToKey(f);C=this._tiles[A],C&&(C.loaded=+new Date,this._map._fadeAnimated?(ur(C.el,0),$(this._fadeFrame),this._fadeFrame=W(this._updateOpacity,this)):(C.active=!0,this._pruneTiles()),y||(Mt(C.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:C.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),dt.ielt9||!this._map._fadeAnimated?W(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var y=new X(this._wrapX?h(f.x,this._wrapX):f.x,this._wrapY?h(f.y,this._wrapY):f.y);return y.z=f.z,y},_pxBoundsToTileRange:function(f){var y=this.getTileSize();return new H(f.min.unscaleBy(y).floor(),f.max.unscaleBy(y).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function nc(f){return new io(f)}var ao=io.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,y){this._url=f,y=w(this,y),y.detectRetina&&dt.retina&&y.maxZoom>0?(y.tileSize=Math.floor(y.tileSize/2),y.zoomReverse?(y.zoomOffset--,y.minZoom=Math.min(y.maxZoom,y.minZoom+1)):(y.zoomOffset++,y.maxZoom=Math.max(y.minZoom,y.maxZoom-1)),y.minZoom=Math.max(0,y.minZoom)):y.zoomReverse?y.minZoom=Math.min(y.maxZoom,y.minZoom):y.maxZoom=Math.max(y.minZoom,y.maxZoom),typeof y.subdomains=="string"&&(y.subdomains=y.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,y){return this._url===f&&y===void 0&&(y=!0),this._url=f,y||this.redraw(),this},createTile:function(f,y){var C=document.createElement("img");return Ct(C,"load",o(this._tileOnLoad,this,y,C)),Ct(C,"error",o(this._tileOnError,this,y,C)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(C.referrerPolicy=this.options.referrerPolicy),C.alt="",C.src=this.getTileUrl(f),C},getTileUrl:function(f){var y={r:dt.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var C=this._globalTileRange.max.y-f.y;this.options.tms&&(y.y=C),y["-y"]=C}return P(this._url,s(y,this.options))},_tileOnLoad:function(f,y){dt.ielt9?setTimeout(o(f,this,null,y),0):f(null,y)},_tileOnError:function(f,y,C){var A=this.options.errorTileUrl;A&&y.getAttribute("src")!==A&&(y.src=A),f(C,y)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,y=this.options.maxZoom,C=this.options.zoomReverse,A=this.options.zoomOffset;return C&&(f=y-f),f+A},_getSubdomain:function(f){var y=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[y]},_abortLoading:function(){var f,y;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(y=this._tiles[f].el,y.onload=p,y.onerror=p,!y.complete)){y.src=O;var C=this._tiles[f].coords;bn(y),delete this._tiles[f],this.fire("tileabort",{tile:y,coords:C})}},_removeTile:function(f){var y=this._tiles[f];if(y)return y.el.setAttribute("src",O),io.prototype._removeTile.call(this,f)},_tileReady:function(f,y,C){if(!(!this._map||C&&C.getAttribute("src")===O))return io.prototype._tileReady.call(this,f,y,C)}});function Wf(f,y){return new ao(f,y)}var Nd=ao.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,y){this._url=f;var C=s({},this.defaultWmsParams);for(var A in y)A in this.options||(C[A]=y[A]);y=w(this,y);var V=y.detectRetina&&dt.retina?2:1,K=this.getTileSize();C.width=K.x*V,C.height=K.y*V,this.wmsParams=C},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var y=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[y]=this._crs.code,ao.prototype.onAdd.call(this,f)},getTileUrl:function(f){var y=this._tileCoordsToNwSe(f),C=this._crs,A=Q(C.project(y[0]),C.project(y[1])),V=A.min,K=A.max,he=(this._wmsVersion>=1.3&&this._crs===Yl?[V.y,V.x,K.y,K.x]:[V.x,V.y,K.x,K.y]).join(","),Se=ao.prototype.getTileUrl.call(this,f);return Se+j(this.wmsParams,Se,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+he},setParams:function(f,y){return s(this.wmsParams,f),y||this.redraw(),this}});function Om(f,y){return new Nd(f,y)}ao.WMS=Nd,Wf.wms=Om;var Di=zr.extend({options:{padding:.1},initialize:function(f){w(this,f),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Mt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,y){var C=this._map.getZoomScale(y,this._zoom),A=this._map.getSize().multiplyBy(.5+this.options.padding),V=this._map.project(this._center,y),K=A.multiplyBy(-C).add(V).subtract(this._map._getNewPixelOrigin(f,y));dt.any3d?Rr(this._container,K,C):En(this._container,K)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,y=this._map.getSize(),C=this._map.containerPointToLayerPoint(y.multiplyBy(-f)).round();this._bounds=new H(C,C.add(y.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),$f=Di.extend({options:{tolerance:0},getEvents:function(){var f=Di.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Di.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");Ct(f,"mousemove",this._onMouseMove,this),Ct(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ct(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){$(this._redrawRequest),delete this._ctx,bn(this._container),ln(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var y in this._layers)f=this._layers[y],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Di.prototype._update.call(this);var f=this._bounds,y=this._container,C=f.getSize(),A=dt.retina?2:1;En(y,f.min),y.width=A*C.x,y.height=A*C.y,y.style.width=C.x+"px",y.style.height=C.y+"px",dt.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){Di.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[c(f)]=f;var y=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=y),this._drawLast=y,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var y=f._order,C=y.next,A=y.prev;C?C.prev=A:this._drawLast=A,A?A.next=C:this._drawFirst=C,delete f._order,delete this._layers[c(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var y=f.options.dashArray.split(/[, ]+/),C=[],A,V;for(V=0;V<y.length;V++){if(A=Number(y[V]),isNaN(A))return;C.push(A)}f.options._dashArray=C}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||W(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var y=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new H,this._redrawBounds.extend(f._pxBounds.min.subtract([y,y])),this._redrawBounds.extend(f._pxBounds.max.add([y,y]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var y=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,y.x,y.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,y=this._redrawBounds;if(this._ctx.save(),y){var C=y.getSize();this._ctx.beginPath(),this._ctx.rect(y.min.x,y.min.y,C.x,C.y),this._ctx.clip()}this._drawing=!0;for(var A=this._drawFirst;A;A=A.next)f=A.layer,(!y||f._pxBounds&&f._pxBounds.intersects(y))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,y){if(this._drawing){var C,A,V,K,he=f._parts,Se=he.length,De=this._ctx;if(Se){for(De.beginPath(),C=0;C<Se;C++){for(A=0,V=he[C].length;A<V;A++)K=he[C][A],De[A?"lineTo":"moveTo"](K.x,K.y);y&&De.closePath()}this._fillStroke(De,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var y=f._point,C=this._ctx,A=Math.max(Math.round(f._radius),1),V=(Math.max(Math.round(f._radiusY),1)||A)/A;V!==1&&(C.save(),C.scale(1,V)),C.beginPath(),C.arc(y.x,y.y/V,A,0,Math.PI*2,!1),V!==1&&C.restore(),this._fillStroke(C,f)}},_fillStroke:function(f,y){var C=y.options;C.fill&&(f.globalAlpha=C.fillOpacity,f.fillStyle=C.fillColor||C.color,f.fill(C.fillRule||"evenodd")),C.stroke&&C.weight!==0&&(f.setLineDash&&f.setLineDash(y.options&&y.options._dashArray||[]),f.globalAlpha=C.opacity,f.lineWidth=C.weight,f.strokeStyle=C.color,f.lineCap=C.lineCap,f.lineJoin=C.lineJoin,f.stroke())},_onClick:function(f){for(var y=this._map.mouseEventToLayerPoint(f),C,A,V=this._drawFirst;V;V=V.next)C=V.layer,C.options.interactive&&C._containsPoint(y)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(C))&&(A=C);this._fireEvent(A?[A]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var y=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,y)}},_handleMouseOut:function(f){var y=this._hoveredLayer;y&&(gn(this._container,"leaflet-interactive"),this._fireEvent([y],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,y){if(!this._mouseHoverThrottled){for(var C,A,V=this._drawFirst;V;V=V.next)C=V.layer,C.options.interactive&&C._containsPoint(y)&&(A=C);A!==this._hoveredLayer&&(this._handleMouseOut(f),A&&(Mt(this._container,"leaflet-interactive"),this._fireEvent([A],f,"mouseover"),this._hoveredLayer=A)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,y,C){this._map._fireDOMEvent(y,C||y.type,f)},_bringToFront:function(f){var y=f._order;if(y){var C=y.next,A=y.prev;if(C)C.prev=A;else return;A?A.next=C:C&&(this._drawFirst=C),y.prev=this._drawLast,this._drawLast.next=y,y.next=null,this._drawLast=y,this._requestRedraw(f)}},_bringToBack:function(f){var y=f._order;if(y){var C=y.next,A=y.prev;if(A)A.next=C;else return;C?C.prev=A:A&&(this._drawLast=A),y.prev=null,y.next=this._drawFirst,this._drawFirst.prev=y,this._drawFirst=y,this._requestRedraw(f)}}});function Hf(f){return dt.canvas?new $f(f):null}var rc=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Im={_initContainer:function(){this._container=Et("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Di.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var y=f._container=rc("shape");Mt(y,"leaflet-vml-shape "+(this.options.className||"")),y.coordsize="1 1",f._path=rc("path"),y.appendChild(f._path),this._updateStyle(f),this._layers[c(f)]=f},_addPath:function(f){var y=f._container;this._container.appendChild(y),f.options.interactive&&f.addInteractiveTarget(y)},_removePath:function(f){var y=f._container;bn(y),f.removeInteractiveTarget(y),delete this._layers[c(f)]},_updateStyle:function(f){var y=f._stroke,C=f._fill,A=f.options,V=f._container;V.stroked=!!A.stroke,V.filled=!!A.fill,A.stroke?(y||(y=f._stroke=rc("stroke")),V.appendChild(y),y.weight=A.weight+"px",y.color=A.color,y.opacity=A.opacity,A.dashArray?y.dashStyle=E(A.dashArray)?A.dashArray.join(" "):A.dashArray.replace(/( *, *)/g," "):y.dashStyle="",y.endcap=A.lineCap.replace("butt","flat"),y.joinstyle=A.lineJoin):y&&(V.removeChild(y),f._stroke=null),A.fill?(C||(C=f._fill=rc("fill")),V.appendChild(C),C.color=A.fillColor||A.color,C.opacity=A.fillOpacity):C&&(V.removeChild(C),f._fill=null)},_updateCircle:function(f){var y=f._point.round(),C=Math.round(f._radius),A=Math.round(f._radiusY||C);this._setPath(f,f._empty()?"M0 0":"AL "+y.x+","+y.y+" "+C+","+A+" 0,"+65535*360)},_setPath:function(f,y){f._path.v=y},_bringToFront:function(f){bi(f._container)},_bringToBack:function(f){us(f._container)}},si=dt.vml?rc:_e,Jo=Di.extend({_initContainer:function(){this._container=si("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=si("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){bn(this._container),ln(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Di.prototype._update.call(this);var f=this._bounds,y=f.getSize(),C=this._container;(!this._svgSize||!this._svgSize.equals(y))&&(this._svgSize=y,C.setAttribute("width",y.x),C.setAttribute("height",y.y)),En(C,f.min),C.setAttribute("viewBox",[f.min.x,f.min.y,y.x,y.y].join(" ")),this.fire("update")}},_initPath:function(f){var y=f._path=si("path");f.options.className&&Mt(y,f.options.className),f.options.interactive&&Mt(y,"leaflet-interactive"),this._updateStyle(f),this._layers[c(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){bn(f._path),f.removeInteractiveTarget(f._path),delete this._layers[c(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var y=f._path,C=f.options;y&&(C.stroke?(y.setAttribute("stroke",C.color),y.setAttribute("stroke-opacity",C.opacity),y.setAttribute("stroke-width",C.weight),y.setAttribute("stroke-linecap",C.lineCap),y.setAttribute("stroke-linejoin",C.lineJoin),C.dashArray?y.setAttribute("stroke-dasharray",C.dashArray):y.removeAttribute("stroke-dasharray"),C.dashOffset?y.setAttribute("stroke-dashoffset",C.dashOffset):y.removeAttribute("stroke-dashoffset")):y.setAttribute("stroke","none"),C.fill?(y.setAttribute("fill",C.fillColor||C.color),y.setAttribute("fill-opacity",C.fillOpacity),y.setAttribute("fill-rule",C.fillRule||"evenodd")):y.setAttribute("fill","none"))},_updatePoly:function(f,y){this._setPath(f,Ne(f._parts,y))},_updateCircle:function(f){var y=f._point,C=Math.max(Math.round(f._radius),1),A=Math.max(Math.round(f._radiusY),1)||C,V="a"+C+","+A+" 0 1,0 ",K=f._empty()?"M0 0":"M"+(y.x-C)+","+y.y+V+C*2+",0 "+V+-C*2+",0 ";this._setPath(f,K)},_setPath:function(f,y){f._path.setAttribute("d",y)},_bringToFront:function(f){bi(f._path)},_bringToBack:function(f){us(f._path)}});dt.vml&&Jo.include(Im);function Su(f){return dt.svg||dt.vml?new Jo(f):null}Ht.include({getRenderer:function(f){var y=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return y||(y=this._renderer=this._createRenderer()),this.hasLayer(y)||this.addLayer(y),y},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var y=this._paneRenderers[f];return y===void 0&&(y=this._createRenderer({pane:f}),this._paneRenderers[f]=y),y},_createRenderer:function(f){return this.options.preferCanvas&&Hf(f)||Su(f)}});var Am=gs.extend({initialize:function(f,y){gs.prototype.initialize.call(this,this._boundsToLatLngs(f),y)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=de(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function My(f,y){return new Am(f,y)}Jo.create=si,Jo.pointsToPath=Ne,Kr.geometryToLayer=Pi,Kr.coordsToLatLng=to,Kr.coordsToLatLngs=fa,Kr.latLngToCoords=no,Kr.latLngsToCoords=ro,Kr.getFeature=Mi,Kr.asFeature=so,Ht.mergeOptions({boxZoom:!0});var sc=Mr.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){Ct(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ln(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){bn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Kt(),Ba(),this._startPoint=this._map.mouseEventToContainerPoint(f),Ct(document,{contextmenu:Fr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Et("div","leaflet-zoom-box",this._container),Mt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var y=new H(this._point,this._startPoint),C=y.getSize();En(this._box,y.min),this._box.style.width=C.x+"px",this._box.style.height=C.y+"px"},_finish:function(){this._moved&&(bn(this._box),gn(this._container,"leaflet-crosshair")),ji(),Wa(),ln(document,{contextmenu:Fr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var y=new ne(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(y).fire("boxzoomend",{boxZoomBounds:y})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ht.addInitHook("addHandler","boxZoom",sc),Ht.mergeOptions({doubleClickZoom:!0});var Rm=Mr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var y=this._map,C=y.getZoom(),A=y.options.zoomDelta,V=f.originalEvent.shiftKey?C-A:C+A;y.options.doubleClickZoom==="center"?y.setZoom(V):y.setZoomAround(f.containerPoint,V)}});Ht.addInitHook("addHandler","doubleClickZoom",Rm),Ht.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Yf=Mr.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new qr(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}Mt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){gn(this._map._container,"leaflet-grab"),gn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var y=de(this._map.options.maxBounds);this._offsetLimit=Q(this._map.latLngToContainerPoint(y.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(y.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var y=this._lastTime=+new Date,C=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(C),this._times.push(y),this._prunePositions(y)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),y=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=y.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,y){return f-(f-y)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),y=this._offsetLimit;f.x<y.min.x&&(f.x=this._viscousLimit(f.x,y.min.x)),f.y<y.min.y&&(f.y=this._viscousLimit(f.y,y.min.y)),f.x>y.max.x&&(f.x=this._viscousLimit(f.x,y.max.x)),f.y>y.max.y&&(f.y=this._viscousLimit(f.y,y.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,y=Math.round(f/2),C=this._initialWorldOffset,A=this._draggable._newPos.x,V=(A-y+C)%f+y-C,K=(A+y+C)%f-y-C,he=Math.abs(V+C)<Math.abs(K+C)?V:K;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=he},_onDragEnd:function(f){var y=this._map,C=y.options,A=!C.inertia||f.noInertia||this._times.length<2;if(y.fire("dragend",f),A)y.fire("moveend");else{this._prunePositions(+new Date);var V=this._lastPos.subtract(this._positions[0]),K=(this._lastTime-this._times[0])/1e3,he=C.easeLinearity,Se=V.multiplyBy(he/K),De=Se.distanceTo([0,0]),We=Math.min(C.inertiaMaxSpeed,De),st=Se.multiplyBy(We/De),Nt=We/(C.inertiaDeceleration*he),$t=st.multiplyBy(-Nt/2).round();!$t.x&&!$t.y?y.fire("moveend"):($t=y._limitOffset($t,y.options.maxBounds),W(function(){y.panBy($t,{duration:Nt,easeLinearity:he,noMoveStart:!0,animate:!0})}))}}});Ht.addInitHook("addHandler","dragging",Yf),Ht.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Gf=Mr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),Ct(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ln(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,y=document.documentElement,C=f.scrollTop||y.scrollTop,A=f.scrollLeft||y.scrollLeft;this._map._container.focus(),window.scrollTo(A,C)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var y=this._panKeys={},C=this.keyCodes,A,V;for(A=0,V=C.left.length;A<V;A++)y[C.left[A]]=[-1*f,0];for(A=0,V=C.right.length;A<V;A++)y[C.right[A]]=[f,0];for(A=0,V=C.down.length;A<V;A++)y[C.down[A]]=[0,f];for(A=0,V=C.up.length;A<V;A++)y[C.up[A]]=[0,-1*f]},_setZoomDelta:function(f){var y=this._zoomKeys={},C=this.keyCodes,A,V;for(A=0,V=C.zoomIn.length;A<V;A++)y[C.zoomIn[A]]=f;for(A=0,V=C.zoomOut.length;A<V;A++)y[C.zoomOut[A]]=-f},_addHooks:function(){Ct(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ln(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var y=f.keyCode,C=this._map,A;if(y in this._panKeys){if(!C._panAnim||!C._panAnim._inProgress)if(A=this._panKeys[y],f.shiftKey&&(A=oe(A).multiplyBy(3)),C.options.maxBounds&&(A=C._limitOffset(oe(A),C.options.maxBounds)),C.options.worldCopyJump){var V=C.wrapLatLng(C.unproject(C.project(C.getCenter()).add(A)));C.panTo(V)}else C.panBy(A)}else if(y in this._zoomKeys)C.setZoom(C.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[y]);else if(y===27&&C._popup&&C._popup.options.closeOnEscapeKey)C.closePopup();else return;Fr(f)}}});Ht.addInitHook("addHandler","keyboard",Gf),Ht.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Sn=Mr.extend({addHooks:function(){Ct(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ln(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var y=ql(f),C=this._map.options.wheelDebounceTime;this._delta+=y,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var A=Math.max(C-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),A),Fr(f)},_performZoom:function(){var f=this._map,y=f.getZoom(),C=this._map.options.zoomSnap||0;f._stop();var A=this._delta/(this._map.options.wheelPxPerZoomLevel*4),V=4*Math.log(2/(1+Math.exp(-Math.abs(A))))/Math.LN2,K=C?Math.ceil(V/C)*C:V,he=f._limitZoom(y+(this._delta>0?K:-K))-y;this._delta=0,this._startTime=null,he&&(f.options.scrollWheelZoom==="center"?f.setZoom(y+he):f.setZoomAround(this._lastMousePos,y+he))}});Ht.addInitHook("addHandler","scrollWheelZoom",Sn);var Zf=600;Ht.mergeOptions({tapHold:dt.touchNative&&dt.safari&&dt.mobile,tapTolerance:15});var Sd=Mr.extend({addHooks:function(){Ct(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ln(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var y=f.touches[0];this._startPos=this._newPos=new X(y.clientX,y.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Ct(document,"touchend",Tn),Ct(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",y))},this),Zf),Ct(document,"touchend touchcancel contextmenu",this._cancel,this),Ct(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){ln(document,"touchend",Tn),ln(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),ln(document,"touchend touchcancel contextmenu",this._cancel,this),ln(document,"touchmove",this._onMove,this)},_onMove:function(f){var y=f.touches[0];this._newPos=new X(y.clientX,y.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,y){var C=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:y.screenX,screenY:y.screenY,clientX:y.clientX,clientY:y.clientY});C._simulated=!0,y.target.dispatchEvent(C)}});Ht.addInitHook("addHandler","tapHold",Sd),Ht.mergeOptions({touchZoom:dt.touch,bounceAtZoomLimits:!0});var ic=Mr.extend({addHooks:function(){Mt(this._map._container,"leaflet-touch-zoom"),Ct(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){gn(this._map._container,"leaflet-touch-zoom"),ln(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var y=this._map;if(!(!f.touches||f.touches.length!==2||y._animatingZoom||this._zooming)){var C=y.mouseEventToContainerPoint(f.touches[0]),A=y.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=y.getSize()._divideBy(2),this._startLatLng=y.containerPointToLatLng(this._centerPoint),y.options.touchZoom!=="center"&&(this._pinchStartLatLng=y.containerPointToLatLng(C.add(A)._divideBy(2))),this._startDist=C.distanceTo(A),this._startZoom=y.getZoom(),this._moved=!1,this._zooming=!0,y._stop(),Ct(document,"touchmove",this._onTouchMove,this),Ct(document,"touchend touchcancel",this._onTouchEnd,this),Tn(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var y=this._map,C=y.mouseEventToContainerPoint(f.touches[0]),A=y.mouseEventToContainerPoint(f.touches[1]),V=C.distanceTo(A)/this._startDist;if(this._zoom=y.getScaleZoom(V,this._startZoom),!y.options.bounceAtZoomLimits&&(this._zoom<y.getMinZoom()&&V<1||this._zoom>y.getMaxZoom()&&V>1)&&(this._zoom=y._limitZoom(this._zoom)),y.options.touchZoom==="center"){if(this._center=this._startLatLng,V===1)return}else{var K=C._add(A)._divideBy(2)._subtract(this._centerPoint);if(V===1&&K.x===0&&K.y===0)return;this._center=y.unproject(y.project(this._pinchStartLatLng,this._zoom).subtract(K),this._zoom)}this._moved||(y._moveStart(!0,!1),this._moved=!0),$(this._animRequest);var he=o(y._move,y,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=W(he,this,!0),Tn(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,$(this._animRequest),ln(document,"touchmove",this._onTouchMove,this),ln(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ht.addInitHook("addHandler","touchZoom",ic),Ht.BoxZoom=sc,Ht.DoubleClickZoom=Rm,Ht.Drag=Yf,Ht.Keyboard=Gf,Ht.ScrollWheelZoom=Sn,Ht.TapHold=Sd,Ht.TouchZoom=ic,t.Bounds=H,t.Browser=dt,t.CRS=ie,t.Canvas=$f,t.Circle=Xa,t.CircleMarker=Qa,t.Class=Y,t.Control=_r,t.DivIcon=Nu,t.DivOverlay=g,t.DomEvent=Ya,t.DomUtil=aa,t.Draggable=qr,t.Evented=ee,t.FeatureGroup=ms,t.GeoJSON=Kr,t.GridLayer=io,t.Handler=Mr,t.Icon=ri,t.ImageOverlay=Es,t.LatLng=ce,t.LatLngBounds=ne,t.Layer=zr,t.LayerGroup=Ms,t.LineUtil=Hl,t.Map=Ht,t.Marker=ps,t.Mixin=qo,t.Path=Ds,t.Point=X,t.PolyUtil=fd,t.Polygon=gs,t.Polyline=wr,t.Popup=ju,t.PosAnimation=Ga,t.Projection=xd,t.Rectangle=Am,t.Renderer=Di,t.SVG=Jo,t.SVGOverlay=Zo,t.TileLayer=ao,t.Tooltip=tc,t.Transformation=Oe,t.Util=se,t.VideoOverlay=Go,t.bind=o,t.bounds=Q,t.canvas=Hf,t.circle=ua,t.circleMarker=Kl,t.control=Ps,t.divIcon=Em,t.extend=s,t.featureGroup=Gl,t.geoJSON=Jl,t.geoJson=Ur,t.gridLayer=nc,t.icon=Zl,t.imageOverlay=Ql,t.latLng=pe,t.latLngBounds=de,t.layerGroup=da,t.map=ks,t.marker=bd,t.point=oe,t.polygon=wd,t.polyline=_d,t.popup=ec,t.rectangle=My,t.setOptions=w,t.stamp=c,t.svg=Su,t.svgOverlay=Ko,t.tileLayer=Wf,t.tooltip=jd,t.transformation=Pe,t.version=r,t.videoOverlay=Xl;var Lm=window.L;t.noConflict=function(){return window.L=Lm,this},window.L=t}))})(Bh,Bh.exports)),Bh.exports}var hde=fde();const $d=mu(hde),mde=({events:n,users:e})=>{const t=D.useRef(null),r=D.useRef(null),s=D.useRef($d.layerGroup()),a=D.useRef(null),{theme:o}=xu();return D.useEffect(()=>{r.current&&!t.current&&(t.current=$d.map(r.current,{zoomControl:!1}).setView([12.9716,77.5946],12),s.current.addTo(t.current),$d.control.zoom({position:"bottomright"}).addTo(t.current)),setTimeout(()=>t.current?.invalidateSize(),100)},[]),D.useEffect(()=>{if(!t.current)return;const l=o==="dark",h=l?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",p=l?'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>':'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';a.current?(a.current.setUrl(h),t.current.attributionControl.setPrefix(p)):a.current=$d.tileLayer(h,{attribution:p}).addTo(t.current)},[o]),D.useEffect(()=>{s.current.clearLayers();const l=new Map;n.forEach(h=>{if(h.latitude&&h.longitude){const p=l.get(h.userId);(!p||new Date(h.timestamp)>new Date(p.timestamp))&&l.set(h.userId,h)}});const c=new Map(e.map(h=>[h.id,h])),d=[];if(l.forEach(h=>{const p=c.get(h.userId);if(p&&h.latitude&&h.longitude){const x=$d.divIcon({className:"",html:`<div class="user-marker" style="background-image: url(${p.photoUrl||`https://i.pravatar.cc/150?u=${p.id}`})"></div>`,iconSize:[48,48],iconAnchor:[24,56],popupAnchor:[0,-56]}),v=$d.marker([h.latitude,h.longitude],{icon:x});v.bindPopup(`
                    <div class="user-marker-popup">
                        <p class="popup-name">${p.name}</p>
                        <p class="popup-time">Last seen: ${$e(new Date(h.timestamp),"hh:mm a")}</p>
                    </div>
                `),s.current.addLayer(v),d.push(v)}}),d.length>0&&t.current){const h=$d.featureGroup(d);t.current.fitBounds(h.getBounds().pad(.5))}else t.current&&t.current.setView([12.9716,77.5946],12)},[n,e]),i.jsx("div",{ref:r,style:{height:"600px",width:"100%",borderRadius:"1rem",zIndex:0}})},pde=({event:n})=>i.jsxs("div",{className:"bg-card rounded-2xl border border-border overflow-hidden shadow-sm",children:[i.jsxs("div",{className:"p-3 bg-page flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium text-muted",children:"User"}),i.jsx("span",{className:"font-semibold text-primary-text",children:n.userName})]}),i.jsxs("div",{className:"p-3 space-y-3 text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Event"}),i.jsx("span",{className:"font-semibold capitalize text-primary-text",children:n.type.replace("-"," ")})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Timestamp"}),i.jsx("span",{className:"text-primary-text",children:$e(new Date(n.timestamp),"dd MMM, yy - hh:mm a")})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Location"}),n.latitude&&n.longitude?i.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${n.latitude},${n.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-accent hover:underline",children:[i.jsx(Cl,{className:"h-4 w-4 mr-1"})," View on Map"]}):i.jsx("span",{className:"text-primary-text",children:"-"})]})]})]}),gde=()=>{const[n,e]=D.useState("list"),[t,r]=D.useState([]),[s,a]=D.useState([]),[o,l]=D.useState(!0),[c,d]=D.useState($e(new Date,"yyyy-MM-dd")),[h,p]=D.useState($e(new Date,"yyyy-MM-dd")),[x,v]=D.useState("all"),_=Ft("(max-width: 767px)"),w=D.useMemo(()=>s.filter(M=>M.role==="field_officer"),[s]),j=D.useCallback(async()=>{l(!0);try{const M=new Date(c);M.setHours(0,0,0,0);const O=new Date(h);O.setHours(23,59,59,999);const[I,q]=await Promise.all([ue.getAllAttendanceEvents(M.toISOString(),O.toISOString()),ue.getUsers()]);r(I),a(q)}catch(M){console.error("Failed to fetch tracking data",M)}finally{l(!1)}},[c,h]);D.useEffect(()=>{j()},[j]);const T=D.useMemo(()=>{let M=t;x!=="all"&&(M=M.filter(I=>I.userId===x));const O=new Map(s.map(I=>[I.id,I]));return M.map(I=>({...I,userName:O.get(I.userId)?.name||"Unknown User"})).sort((I,q)=>new Date(q.timestamp).getTime()-new Date(I.timestamp).getTime())},[t,s,x]),P=D.useMemo(()=>{const M=new Set(T.map(O=>O.userId));return s.filter(O=>M.has(O.id))},[T,s]),E=()=>o?i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):n==="map"?i.jsx(mde,{events:T,users:P}):n==="route"?x==="all"?i.jsx("div",{className:"text-center py-10 text-muted",children:"Please select a specific user to view their route coverage."}):i.jsx(RouteView,{events:T,selectedUser:x}):_?i.jsx("div",{className:"space-y-3",children:T.length===0?i.jsx("div",{className:"text-center py-10 text-muted",children:"No events found."}):T.map(M=>i.jsx(pde,{event:M},M.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"User"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Event"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Timestamp"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Location"})]})}),i.jsx("tbody",{children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No events found."})}):T.map(M=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"User",className:"px-6 py-4 whitespace-nowrap font-medium",children:M.userName}),i.jsx("td",{"data-label":"Event",className:"px-6 py-4 whitespace-nowrap capitalize",children:M.type.replace("-"," ")}),i.jsx("td",{"data-label":"Timestamp",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:$e(new Date(M.timestamp),"dd MMM, yyyy - hh:mm a")}),i.jsx("td",{"data-label":"Location",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:M.latitude&&M.longitude?i.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${M.latitude},${M.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center md:justify-start justify-end text-accent hover:underline",children:[i.jsx(Cl,{className:"h-4 w-4 mr-1"})," View on Map"]}):"-"})]},M.id))})]})});return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text flex-shrink-0",children:"User Activity Tracking"}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto justify-end flex-wrap",children:[i.jsx("div",{className:"w-full sm:w-40",children:i.jsx(kn,{label:"",id:"start-date",value:c,onChange:d})}),i.jsx("div",{className:"w-full sm:w-40",children:i.jsx(kn,{label:"",id:"end-date",value:h,onChange:p})}),i.jsx("div",{className:"w-full sm:w-48",children:i.jsxs(Ke,{label:"",id:"user-select",value:x,onChange:M=>v(M.target.value),children:[i.jsx("option",{value:"all",children:"All Users"}),w.map(M=>i.jsx("option",{value:M.id,children:M.name},M.id))]})})]})]}),i.jsx("div",{className:"mt-4",children:i.jsxs("div",{className:"bg-page p-1 rounded-full flex items-center w-fit",children:[i.jsxs("button",{onClick:()=>e("list"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="list"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(cJ,{className:"h-4 w-4"}),"List View"]}),i.jsxs("button",{onClick:()=>e("map"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="map"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(YF,{className:"h-4 w-4"}),"Map View"]}),i.jsxs("button",{onClick:()=>e("route"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="route"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(xJ,{className:"h-4 w-4"}),"Route View"]})]})})]}),i.jsx("div",{className:"mt-6",children:E()})]})},xde=(n,e,t,r)=>{const a=n*Math.PI/180,o=t*Math.PI/180,l=(t-n)*Math.PI/180,c=(r-e)*Math.PI/180,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},yde=()=>{const{user:n}=jt(),[e,t]=D.useState([]),[r,s]=D.useState([]),[a,o]=D.useState(""),[l,c]=D.useState("100"),[d,h]=D.useState(""),[p,x]=D.useState(""),[v,_]=D.useState(""),[w,j]=D.useState(""),[T,P]=D.useState([]),[E,M]=D.useState(!0),[O,I]=D.useState(null),[q,F]=D.useState(null);D.useEffect(()=>{(async()=>{try{const[X,Z]=await Promise.all([ue.getLocations(),ue.getUsers()]);t(X),s(Z)}catch(X){console.error(X),I({message:"Failed to load locations or users.",type:"error"})}finally{M(!1)}})()},[]);const B=ot.useMemo(()=>{const ee=new Map;return r.forEach(X=>ee.set(X.id,X.name)),ee},[r]),U=async()=>{try{const ee=await ue.getLocations();t(ee)}catch(ee){console.error(ee),I({message:"Failed to refresh locations.",type:"error"})}},W=async()=>{try{const ee=await Jx(),{latitude:X,longitude:Z}=ee.coords;h(X.toString()),x(Z.toString());try{const oe=await am(X,Z);v||_(oe),a||o(oe)}catch(oe){console.warn("Reverse geocode failed",oe)}}catch(ee){console.error(ee),I({message:"Unable to retrieve current location.",type:"error"})}},$=async()=>{const ee=parseFloat(l),X=parseFloat(d),Z=parseFloat(p);if(isNaN(ee)||ee<10||ee>1e3){I({message:"Radius must be between 10 and 1000 meters.",type:"error"});return}if(isNaN(X)||isNaN(Z)){I({message:"Please provide valid latitude and longitude.",type:"error"});return}try{const oe=v||await am(X,Z);if(!q&&e.some(Q=>xde(X,Z,Q.latitude,Q.longitude)<10)){I({message:"A location already exists at these coordinates. Please use a different location.",type:"error"});return}q?(await ue.updateLocation(q,{name:a||oe,latitude:X,longitude:Z,radius:ee,address:oe}),I({message:"Location updated successfully.",type:"success"}),F(null)):(await ue.createLocation({name:a||oe,latitude:X,longitude:Z,radius:ee,address:oe,createdBy:n?.id||null}),I({message:"Location created successfully.",type:"success"})),o(""),c("100"),h(""),x(""),_(""),await U()}catch(oe){console.error(oe);const H=oe?.message||(q?"Failed to update location.":"Failed to create location.");I({message:H,type:"error"})}},se=async()=>{if(!w||T.length===0){I({message:"Please select a user and at least one location.",type:"error"});return}try{await Promise.all(T.map(ee=>ue.assignLocationToUser(w,ee))),I({message:"Location(s) assigned to user.",type:"success"}),j(""),P([])}catch(ee){console.error(ee),I({message:"Failed to assign location(s).",type:"error"})}},Y=ee=>{F(ee.id),o(ee.name||""),c(ee.radius.toString()),h(ee.latitude.toString()),x(ee.longitude.toString()),_(ee.address||""),window.scrollTo({top:0,behavior:"smooth"})},ae=()=>{F(null),o(""),c("100"),h(""),x(""),_("")},J=async ee=>{if(window.confirm("Are you sure you want to delete this location? This will remove it from all users and the database."))try{await ue.deleteLocation(ee),I({message:"Location deleted successfully from all users and database.",type:"success"}),await U()}catch(X){console.error(X);const Z=X?.message||"Failed to delete location.";I({message:Z,type:"error"})}};return i.jsxs("div",{className:"p-4 md:p-6 w-full",children:[O&&i.jsx(ht,{message:O.message,type:O.type,onDismiss:()=>I(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx(Ji,{title:"Location Management"}),i.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Define geofenced locations and assign them to staff. Only checkins within these locations will be accepted."})]}),i.jsxs("div",{className:"mt-6 space-y-6",children:[i.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Cl,{className:"h-5 w-5 mr-2 text-muted"})," ",q?"Edit Location":"Add New Location"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(je,{label:"Name (optional)",id:"locName",value:a,onChange:ee=>o(ee.target.value),placeholder:"e.g. Office HQ"}),i.jsx(je,{label:"Radius (meters)",id:"locRadius",type:"number",value:l,onChange:ee=>c(ee.target.value),min:"10",max:"1000"}),i.jsx(je,{label:"Latitude",id:"locLat",type:"number",value:d,onChange:ee=>h(ee.target.value),placeholder:"12.9716"}),i.jsx(je,{label:"Longitude",id:"locLng",type:"number",value:p,onChange:ee=>x(ee.target.value),placeholder:"77.5946"}),i.jsx(je,{label:"Address (optional)",id:"locAddr",value:v,onChange:ee=>_(ee.target.value),placeholder:"Street, City, State"})]}),i.jsxs("div",{className:"flex flex-wrap mt-4 gap-4",children:[i.jsxs(re,{variant:"secondary",onClick:W,children:[i.jsx(GF,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),q?i.jsxs(i.Fragment,{children:[i.jsxs(re,{onClick:$,children:[i.jsx(Ns,{className:"h-4 w-4 mr-2"})," Save Changes"]}),i.jsx(re,{variant:"secondary",onClick:ae,children:"Cancel"})]}):i.jsxs(re,{onClick:$,children:[i.jsx(Bt,{className:"h-4 w-4 mr-2"})," Add Location"]})]})]}),i.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Yi,{className:"h-5 w-5 mr-2 text-muted"})," Assign Location to User"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs(Ke,{label:"Select User",id:"assignUser",value:w,onChange:ee=>j(ee.target.value),children:[i.jsx("option",{value:"",children:"-- Select User --"}),r.map(ee=>i.jsx("option",{value:ee.id,children:ee.name},ee.id))]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Select Location(s)"}),i.jsx("div",{className:"border border-border rounded-lg p-3 max-h-48 overflow-y-auto bg-page",children:e.length===0?i.jsx("p",{className:"text-muted text-sm",children:"No locations available."}):e.map(ee=>i.jsxs("label",{className:"flex items-center justify-start gap-2 py-1 text-sm",children:[i.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-accent border-gray-300 rounded",checked:T.includes(ee.id),onChange:X=>{P(Z=>X.target.checked?[...Z,ee.id]:Z.filter(oe=>oe!==ee.id))}}),i.jsx("span",{children:ee.name||ee.address||`${ee.latitude.toFixed(4)}, ${ee.longitude.toFixed(4)}`})]},ee.id))})]})]}),i.jsx("div",{className:"flex justify-end mt-4",children:i.jsxs(re,{onClick:se,className:"w-full md:w-auto",children:[i.jsx(Ns,{className:"h-4 w-4 mr-2"})," Assign"]})})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-xl font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Cl,{className:"h-5 w-5 mr-2 text-muted"})," Existing Locations"]}),E?i.jsx("p",{children:"Loading..."}):e.length===0?i.jsx("p",{className:"text-muted text-center md:text-left",children:"No locations defined yet."}):i.jsxs("div",{className:"space-y-4 md:space-y-0",children:[i.jsx("div",{className:"md:hidden space-y-4",children:e.map(ee=>i.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-primary-text",children:ee.name||"Unnamed Location"}),i.jsx("p",{className:"text-sm text-muted",children:ee.address})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-500 hover:text-blue-700 p-1",title:"Edit",onClick:()=>Y(ee),children:i.jsx(cr,{className:"h-5 w-5"})}),i.jsx("button",{type:"button",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",title:"Delete",onClick:()=>J(ee.id),children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Radius"}),i.jsxs("p",{children:[ee.radius,"m"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Coordinates"}),i.jsxs("p",{children:[ee.latitude.toFixed(4),", ",ee.longitude.toFixed(4)]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Created By"}),i.jsx("p",{children:ee.createdByName||B.get(ee.createdBy||"")||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Created At"}),i.jsx("p",{children:ee.createdAt?new Date(ee.createdAt).toLocaleDateString():"-"})]})]})]},ee.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[i.jsx("thead",{className:"bg-page text-primary-text",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created By"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created At"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),i.jsx("tbody",{children:e.map(ee=>i.jsxs("tr",{className:"border-b border-border",children:[i.jsx("td",{className:"p-3",children:ee.name||"-"}),i.jsx("td",{className:"p-3",children:ee.radius}),i.jsxs("td",{className:"p-3",children:[ee.latitude.toFixed(4),", ",ee.longitude.toFixed(4)]}),i.jsx("td",{className:"p-3",children:ee.address||"-"}),i.jsx("td",{className:"p-3",children:ee.createdByName||B.get(ee.createdBy||"")||"-"}),i.jsx("td",{className:"p-3",children:ee.createdAt?new Date(ee.createdAt).toLocaleString():"-"}),i.jsxs("td",{className:"p-3 whitespace-nowrap",children:[i.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-800 mr-3",title:"Edit",onClick:()=>Y(ee),children:i.jsx(cr,{className:"h-4 w-4"})}),i.jsx("button",{type:"button",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",title:"Delete",onClick:()=>J(ee.id),children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]},ee.id))})]})})]})]})]})]})},vde=({isOpen:n,onClose:e,onOverride:t,employeeName:r,bankName:s,reason:a})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",children:[i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10 flex items-center justify-center rounded-full bg-red-100",children:i.jsx(Da,{className:"h-6 w-6 text-red-600"})}),i.jsxs("div",{className:"ml-4 flex-1",children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Verification Alert: Name Mismatch Found"}),i.jsxs("div",{className:"mt-2 text-sm text-muted space-y-2",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name on ID:"}),' "',r,'"']}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name on Bank Proof:"}),' "',s,'"']}),a&&i.jsxs("p",{className:"mt-2 p-2 bg-page rounded-md",children:[i.jsx("strong",{children:"AI Analysis:"})," ",i.jsx("em",{children:a})]}),i.jsx("p",{className:"mt-2",children:"Please upload the correct documents. If the names are different for a valid reason (e.g., maiden name), you can override this warning, but it will require manual verification by an administrator."})]})]})]}),i.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[i.jsx(re,{onClick:t,variant:"danger",children:"Override & Proceed"}),i.jsx(re,{onClick:e,variant:"secondary",children:"Re-upload Documents"})]})]})}):null,bde={documents:{aadhaar:!0,pan:!0,bankProof:!0,educationCertificate:!0,salarySlip:!0,uanProof:!0,familyAadhaar:!0},verifications:{requireBengaluruAddress:!0,requireDobVerification:!0}},_de=n=>{const e=Pt({id:ge().required(),relation:ge().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),phone:ge().when("relation",{is:"Child",then:r=>r.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:r=>r.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:n.documents.familyAadhaar?Wt().nonNullable("Aadhaar proof is required for each family member."):Wt().optional().nullable()}),t=Pt({id:ge().required(),document:n.documents.educationCertificate?Wt().nonNullable("Education certificate is required."):Wt().optional().nullable()});return Pt({photo:Wt().optional().nullable(),aadhaarLinkedMobile:ge().required("Aadhaar-linked mobile number is required.").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),alternateMobile:ge().optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),idProofType:ge().oneOf(["Aadhaar","PAN","Voter ID",""]).required(),idProofFront:Wt().nonNullable("Aadhaar (Front) is required."),idProofBack:Wt().nonNullable("Aadhaar (Back) is required."),bankProof:Wt().nonNullable("Bank proof document is required."),uanProof:Wt().nonNullable("UAN proof document is required."),salarySlip:n.documents.salarySlip?Wt().nonNullable("Salary slip is required."):Wt().optional().nullable(),family:_s().of(e).optional(),education:_s().of(t).optional()}).defined()},Hd=n=>new Promise((e,t)=>{const r=new FileReader;r.readAsDataURL(n),r.onload=()=>e({base64:r.result.split(",")[1],type:n.type}),r.onerror=s=>t(s)}),Ih=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",wde=()=>{const n=St(),e=$n(),{user:t}=jt(),{rulesByDesignation:r}=Kc(),[s,a]=D.useState(!1),[o,l]=D.useState(null),[c,d]=D.useState({isOpen:!1,employeeName:"",bankName:"",reason:""}),[h,p]=D.useState(window.innerWidth<768),x=e.data.organization.designation,v=D.useMemo(()=>x&&r[x]?r[x]:bde,[x,r]),_=D.useMemo(()=>_de(v),[v]);D.useEffect(()=>{const Y=()=>p(window.innerWidth<768);return window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]),t?.role;const{control:w,handleSubmit:j,formState:{errors:T},getValues:P,watch:E}=tn({resolver:Dn(_),defaultValues:{aadhaarLinkedMobile:"",alternateMobile:"",photo:null,idProofType:"Aadhaar",idProofFront:null,idProofBack:null,bankProof:null,salarySlip:null,uanProof:null,family:[],education:[]}}),{fields:M,append:O,remove:I}=ws({control:w,name:"family"}),{fields:q,append:F,remove:B}=ws({control:w,name:"education"});E("idProofType");const U=E("family"),W=async(Y,ae=!1)=>{a(!0),e.setRequiresManualVerification(ae);try{const J={type:et.OBJECT,properties:{name:{type:et.STRING,description:"The person's full name as written on the card."},dob:{type:et.STRING,description:"The person's date of birth in YYYY-MM-DD format. If only year available, return YYYY-01-01."},gender:{type:et.STRING,description:"Gender: 'Male', 'Female', or 'Other'."},aadhaarNumber:{type:et.STRING,description:"The 12-digit Aadhaar number, if present."},panNumber:{type:et.STRING,description:"The 10-character PAN number, if present."},voterIdNumber:{type:et.STRING,description:"The Voter ID number, also known as EPIC number."}}},ee={type:et.OBJECT,properties:{address:{type:et.OBJECT,description:"The full address on the back of an Aadhaar card, parsed into components.",properties:{line1:{type:et.STRING,description:"Full address line(s) excluding city, state, pincode. e.g., 'S/O: John Doe, 123 Maple Street, Anytown'"},city:{type:et.STRING},state:{type:et.STRING},pincode:{type:et.STRING}}}}},X={type:et.OBJECT,properties:{accountHolderName:{type:et.STRING,description:"The account holder's full name."},accountNumber:{type:et.STRING,description:"The full bank account number."},ifscCode:{type:et.STRING,description:"The bank's IFSC code."},bankName:{type:et.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:et.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}}},Z={type:et.OBJECT,properties:{uanNumber:{type:et.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:et.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:et.STRING,description:"The 10 or 17-digit ESI number."}}},oe={type:et.OBJECT,properties:{uanNumber:{type:et.STRING}}},H={type:et.OBJECT,properties:{name:{type:et.STRING},dob:{type:et.STRING}}},Q={type:et.OBJECT,properties:{degree:{type:et.STRING},institution:{type:et.STRING},endYear:{type:et.STRING}}},ne=[Y.idProofFront?Hd(Y.idProofFront.file):Promise.resolve(null),(Y.idProofType==="Aadhaar"||Y.idProofType==="Voter ID")&&Y.idProofBack?Hd(Y.idProofBack.file):Promise.resolve(null),Y.bankProof?Hd(Y.bankProof.file):Promise.resolve(null),Y.salarySlip?Hd(Y.salarySlip.file):Promise.resolve(null),Y.uanProof?Hd(Y.uanProof.file):Promise.resolve(null),...Y.family.map(lt=>lt.idProof?Hd(lt.idProof.file):Promise.resolve(null)),...Y.education.map(lt=>lt.document?Hd(lt.document.file):Promise.resolve(null))],[de,ce,pe,ie,xe,...Ce]=await Promise.all(ne),ve=Ce.slice(0,Y.family.length),Oe=Ce.slice(Y.family.length),Pe=de?ue.extractDataFromImage(de.base64,de.type,J,Y.idProofType):Promise.resolve({}),Ie=ce&&Y.idProofType==="Aadhaar"?ue.extractDataFromImage(ce.base64,ce.type,ee,"Aadhaar"):Promise.resolve({}),Fe=pe?ue.extractDataFromImage(pe.base64,pe.type,X,"Bank"):Promise.resolve({}),_e=ie?ue.extractDataFromImage(ie.base64,ie.type,Z,"Salary"):Promise.resolve(null),Ne=xe?ue.extractDataFromImage(xe.base64,xe.type,oe,"UAN"):Promise.resolve(null),Ue=ve.map(lt=>lt?ue.extractDataFromImage(lt.base64,lt.type,H,"Aadhaar"):Promise.resolve({})),Be=Oe.map(lt=>lt?ue.extractDataFromImage(lt.base64,lt.type,Q):Promise.resolve({})),[qe,te,le,ye,Ve,...ze]=await Promise.all([Pe,Ie,Fe,_e,Ne,...Ue,...Be]),Le=ze.slice(0,ve.length),rt=ze.slice(ve.length),Xe={...qe,...te},tt=Xe.name||"",qt=le.accountHolderName||"";if(!ae&&tt&&qt){const{isMatch:lt,reason:Vn}=await ue.crossVerifyNames(tt,qt);if(!lt){d({isOpen:!0,employeeName:tt,bankName:qt,reason:Vn}),a(!1);return}}const bt={idProofType:Y.idProofType,idProofFront:Y.idProofFront,idProofBack:Y.idProofBack,photo:Y.photo,mobile:Y.aadhaarLinkedMobile,alternateMobile:Y.alternateMobile},Dt={};if(Xe.name){const lt=Xe.name.split(" ");bt.firstName=Ih(lt.shift()||""),bt.lastName=Ih(lt.pop()||""),bt.middleName=Ih(lt.join(" ")),bt.preferredName=bt.firstName,Dt.name=!0}if(Xe.dob)try{bt.dob=$e(new Date(Xe.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd"),Dt.dob=!0}catch{}if(Xe.gender){const lt=Xe.gender.toLowerCase().trim();lt.includes("male")||lt.includes("purush")||lt==="m"?bt.gender="Male":lt.includes("female")||lt.includes("mahila")||lt==="f"?bt.gender="Female":lt.includes("transgender")&&(bt.gender="Other")}(Xe.aadhaarNumber||Xe.panNumber||Xe.voterIdNumber)&&(bt.idProofNumber=(Xe.aadhaarNumber||Xe.panNumber||Xe.voterIdNumber).replace(/\s/g,""),Dt.idProofNumber=!0);const Xt={bankProof:Y.bankProof},en={};if(le.accountHolderName&&(Xt.accountHolderName=Ih(le.accountHolderName),en.accountHolderName=!0),le.accountNumber){const lt=le.accountNumber.replace(/\D/g,"");Xt.accountNumber=lt,Xt.confirmAccountNumber=lt,en.accountNumber=!0}le.ifscCode&&(Xt.ifscCode=le.ifscCode.toUpperCase().replace(/\s/g,""),en.ifscCode=!0),le.bankName&&(Xt.bankName=le.bankName),le.branchName&&(Xt.branchName=le.branchName);const Yt={salarySlip:Y.salarySlip,document:Y.uanProof},Ut={},Rn={},Nn={},an=Ve?.uanNumber||ye?.uanNumber;if(an){const lt=an.replace(/\D/g,"");lt.length===12&&(Yt.uanNumber=lt,Yt.hasPreviousPf=!0,Rn.uanNumber=!0)}if(ye?.pfNumber&&(Yt.pfNumber=ye.pfNumber,Yt.hasPreviousPf=!0),ye?.esiNumber){const lt=ye.esiNumber.replace(/\D/g,"");(lt.length===10||lt.length===17)&&(Ut.esiNumber=lt,Ut.hasEsi=!0,Nn.esiNumber=!0)}const rr=Le.map((lt,Vn)=>{const br=Y.family[Vn];let vn="";if(lt.dob)try{vn=$e(new Date(lt.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd")}catch{}return{id:`fam_preupload_${Date.now()}_${Vn}`,relation:br.relation,name:Ih(lt.name)||"",dob:vn,gender:"",occupation:"",dependent:!1,idProof:br.idProof,phone:br.phone}}),Hn=rt.map((lt,Vn)=>{const br=Y.education[Vn];return{id:`edu_preupload_${Date.now()}_${Vn}`,degree:lt.degree||"",institution:lt.institution||"",startYear:"",endYear:lt.endYear||"",document:br.document}});Xe.address&&e.updateAddress({present:{...Xe.address,country:"India",verifiedStatus:{line1:!0,city:!0,state:!0,pincode:!0,country:!0}},permanent:{...Xe.address,country:"India"},sameAsPresent:!0}),e.updateBank(Xt),e.setBankVerifiedStatus(en),e.updateUan(Yt),e.setUanVerifiedStatus(Rn),e.updateEsi(Ut),e.setEsiVerifiedStatus(Nn),e.updateFamily(rr),e.updateEducation(Hn),e.updatePersonal(bt),e.setPersonalVerifiedStatus(Dt),l({message:"Application auto-filled! Please review.",type:"success"}),n("/onboarding/add/personal")}catch(J){const ee=J instanceof Error?J.message:"An unexpected error occurred.";console.error("Document processing failed:",J),l({message:`Document processing failed: ${ee}`,type:"error"}),a(!1)}},$=Y=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),W(Y,!1)},se=()=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),W(P(),!0)};return i.jsxs("div",{className:"relative",children:[s&&i.jsxs("div",{className:"absolute inset-0 bg-page/90 backdrop-blur-sm z-10 flex flex-col items-center justify-center rounded-xl animate-fade-in-scale",children:[i.jsx(wt,{className:"h-12 w-12 animate-spin text-accent"}),i.jsx("p",{className:"mt-4 text-lg font-semibold text-primary-text",children:"Processing Documents..."}),i.jsx("p",{className:"text-muted text-center max-w-xs",children:"Our AI is analyzing your files. This may take a moment."})]}),i.jsxs("div",{className:`bg-card p-8 rounded-xl shadow-card w-full transition-all ${s?"blur-sm pointer-events-none":""}`,children:[i.jsx(vde,{...c,onClose:()=>d({isOpen:!1,employeeName:"",bankName:"",reason:""}),onOverride:se}),i.jsxs("form",{onSubmit:j($),children:[i.jsx(Pr,{title:"Document Collection",subtitle:"Upload documents to auto-fill the application."}),i.jsxs("div",{className:"space-y-8 mt-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(we,{name:"photo",control:w,render:({field:Y})=>i.jsx(yt,{label:"Profile Photo",file:Y.value,onFileChange:Y.onChange,allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsx(we,{name:"aadhaarLinkedMobile",control:w,render:({field:Y,fieldState:ae})=>i.jsx(je,{label:"Aadhaar Linked Mobile Number",type:"tel",...Y,error:ae.error?.message})}),i.jsx(we,{name:"alternateMobile",control:w,render:({field:Y,fieldState:ae})=>i.jsx(je,{label:"Alternative Mobile Number (Optional)",type:"tel",...Y,error:ae.error?.message})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(we,{name:"idProofFront",control:w,render:({field:Y})=>i.jsx(yt,{label:"Aadhaar (Front Side)",file:Y.value,onFileChange:Y.onChange,error:T.idProofFront?.message,allowCapture:!0,verificationStatus:e.data.personal.verifiedStatus?.idProofNumber})}),i.jsx(we,{name:"idProofBack",control:w,render:({field:Y})=>i.jsx(yt,{label:"Aadhaar (Back Side)",file:Y.value,onFileChange:Y.onChange,error:T.idProofBack?.message,allowCapture:!0,verificationStatus:e.data.personal.verifiedStatus?.idProofNumber})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(we,{name:"bankProof",control:w,render:({field:Y})=>i.jsx(yt,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:Y.value,onFileChange:Y.onChange,error:T.bankProof?.message,allowCapture:!0,verificationStatus:e.data.bank.verifiedStatus?.accountNumber})}),i.jsx(we,{name:"uanProof",control:w,render:({field:Y})=>i.jsx(yt,{label:"UAN Proof Document",file:Y.value,onFileChange:Y.onChange,error:T.uanProof?.message,allowCapture:!0,verificationStatus:e.data.uan.verifiedStatus?.uanNumber})})]}),v.documents.salarySlip&&i.jsx(we,{name:"salarySlip",control:w,render:({field:Y})=>i.jsx(yt,{label:"Latest Salary Slip",file:Y.value,onFileChange:Y.onChange,error:T.salarySlip?.message,allowCapture:!0})}),v.documents.educationCertificate&&i.jsxs("div",{className:"pt-6 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[q.map((Y,ae)=>i.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 relative",children:[i.jsx(we,{name:`education.${ae}.document`,control:w,render:({field:J,fieldState:ee})=>i.jsx(yt,{label:"Certificate",file:J.value,onFileChange:J.onChange,error:ee.error?.message,allowCapture:!0})}),i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>B(ae),className:"!absolute top-2 right-2",children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]},Y.id)),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>F({id:`edu_upload_${Date.now()}`,document:null}),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Certificate"]})]})]}),v.documents.familyAadhaar&&i.jsxs("div",{className:"pt-6 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[M.map((Y,ae)=>{const ee=U?.[ae]?.relation==="Child";return i.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 grid grid-cols-1 md:grid-cols-3 gap-4 items-start relative",children:[i.jsx(we,{name:`family.${ae}.relation`,control:w,render:({field:X,fieldState:Z})=>i.jsxs(Ke,{label:"Relation",error:Z.error?.message,...X,children:[" ",i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})," "]})}),i.jsx(we,{name:`family.${ae}.phone`,control:w,render:({field:X,fieldState:Z})=>i.jsx(je,{label:`Phone Number${ee?" (Optional)":""}`,type:"tel",...X,error:Z.error?.message})}),i.jsx("div",{className:"md:col-start-1 md:col-span-3",children:i.jsx(we,{name:`family.${ae}.idProof`,control:w,render:({field:X,fieldState:Z})=>i.jsx(yt,{label:"Aadhaar Card",file:X.value,onFileChange:X.onChange,error:Z.error?.message,allowCapture:!0})})}),i.jsx(re,{type:"button",variant:"icon",size:"sm",onClick:()=>I(ae),className:"!absolute top-2 right-2",children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]},Y.id)}),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>O({id:`fam_upload_${Date.now()}`,relation:"",idProof:null,phone:""}),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-between items-center gap-4",children:[i.jsxs(re,{type:"button",variant:"secondary",onClick:()=>n(-1),children:[i.jsx(Aa,{className:"mr-2 h-4 w-4"})," Back"]}),i.jsx(re,{type:"submit",isLoading:s,children:"Process"})]})]})]})]})},jde=({count:n=3})=>i.jsx("div",{className:"space-y-2.5",children:Array.from({length:n}).map((e,t)=>i.jsxs("div",{className:"bg-[#041b0f] md:bg-[#243524] p-3 rounded-xl flex gap-4 items-start border border-transparent",children:[i.jsx($r,{className:"w-12 h-12 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"flex-grow space-y-2 mt-1",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx($r,{className:"h-4 w-1/2"}),i.jsx($r,{className:"h-5 w-20 rounded-full"})]}),i.jsx($r,{className:"h-3 w-1/3"}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[i.jsx($r,{className:"h-3 w-20"}),i.jsx($r,{className:"h-3 w-20"}),i.jsx($r,{className:"h-3 w-20"}),i.jsx($r,{className:"h-3 w-20"})]})]})]},t))}),Gg=({label:n,checked:e})=>i.jsxs("div",{className:"flex items-center gap-1.5",children:[e?i.jsx(fm,{className:"h-4 w-4 text-emerald-400"}):i.jsx(QF,{className:"h-4 w-4 text-gray-500"}),i.jsx("span",{className:e?"text-gray-300":"text-gray-500",children:n})]}),Nde=({submission:n})=>{const{esiCtcThreshold:e}=Kc(),t=D.useMemo(()=>{const{personal:r,uan:s,esi:a,gmc:o}=n,l=r.salary!=null&&r.salary<=e;let c=!1;return l?c=!a.hasEsi||a.hasEsi&&!!a.esiNumber:o.isOptedIn===!0?c=!0:o.isOptedIn===!1&&(c=!!o.gmcPolicyCopy&&!!o.declarationAccepted),{aadhaar:!!r.idProofFront,uan:!s.hasPreviousPf||s.hasPreviousPf&&!!s.uanNumber,pf:!s.hasPreviousPf||s.hasPreviousPf&&!!s.uanNumber,esiGmc:c}},[n,e]);return i.jsx(Pa,{to:`/onboarding/add/personal?id=${n.id}`,className:"block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-xl",children:i.jsxs("div",{className:"bg-[#041b0f] md:bg-[#243524] p-3 rounded-xl flex gap-4 items-start border border-transparent hover:border-emerald-500 transition-colors duration-200",children:[i.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 border-2 border-gray-600",children:i.jsx(Wi,{photoUrl:n.personal.photo?.preview,seed:n.id})}),i.jsxs("div",{className:"flex-grow",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx("p",{className:"font-semibold text-green-400",children:`${n.personal.firstName} ${n.personal.lastName}`}),i.jsx("div",{className:"flex-shrink-0",children:i.jsx(EC,{status:n.status})})]}),i.jsx("p",{className:"text-sm text-gray-400",children:n.personal.mobile}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[i.jsx(Gg,{label:"Aadhaar",checked:t.aadhaar}),i.jsx(Gg,{label:"UAN",checked:t.uan}),i.jsx(Gg,{label:"PF",checked:t.pf}),i.jsx(Gg,{label:"ESI / GMC",checked:t.esiGmc})]})]})]})})},Sde=()=>{const[n,e]=D.useState([]),[t,r]=D.useState(!0),[s,a]=D.useState("in-progress"),[o,l]=D.useState(""),[c,d]=D.useState(null),h=St(),p=D.useRef(null);D.useEffect(()=>{(async()=>{r(!0);try{const T=await ue.getVerificationSubmissions();e(T)}catch{d({message:"Failed to load submissions.",type:"error"})}finally{r(!1)}})()},[]);const x=D.useMemo(()=>{const j={"in-progress":["pending","draft","rejected"],existing:["verified"]};return n.filter(T=>j[s].includes(T.status)).filter(T=>`${T.personal.firstName} ${T.personal.lastName}`.toLowerCase().includes(o.toLowerCase())||T.personal.mobile?.toLowerCase().includes(o.toLowerCase()))},[n,s,o]),v=()=>{h("/onboarding/select-organization")},_=()=>{p.current?.focus()},w=[{key:"in-progress",label:"IN PROGRESS"},{key:"existing",label:"EXISTING"}];return i.jsxs("div",{className:"h-full flex flex-col bg-[#041b0f] text-white",children:[c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header sticky top-0 z-10 bg-[#041b0f]/80 backdrop-blur-sm border-b border-[#374151]",children:[i.jsx("button",{onClick:()=>h("/onboarding"),"aria-label":"Go back",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(Aa,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-lg font-semibold",children:"On Boarding"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:_,"aria-label":"Search employee",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(Ma,{className:"h-6 w-6"})}),i.jsx("button",{onClick:v,"aria-label":"Add new employee",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(Wc,{className:"h-6 w-6"})}),i.jsx("button",{onClick:()=>h("/profile"),"aria-label":"Exit to profile",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(gi,{className:"h-6 w-6"})})]})]}),i.jsx("div",{className:"px-4 pt-4 pb-3 flex-shrink-0",children:i.jsx("div",{className:"flex",children:w.map(j=>i.jsx("button",{onClick:()=>a(j.key),className:`flex-1 py-2 text-sm font-semibold uppercase tracking-wider transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-sm ${s===j.key?"border-b-2 border-emerald-400 text-emerald-400":"border-b-2 border-transparent text-gray-400 hover:text-white"}`,children:j.label},j.key))})}),i.jsxs("main",{className:"flex-1 overflow-y-auto px-4 space-y-2.5 pb-24",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Ma,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-500"}),i.jsx("input",{ref:p,type:"text",placeholder:"Search by name or number...",value:o,onChange:j=>l(j.target.value),className:"form-input w-full !pl-10 !h-12 !rounded-md"})]}),t?i.jsx("div",{className:"pt-4",children:i.jsx(jde,{count:3})}):x.length>0?i.jsx("div",{className:"space-y-2.5",children:x.map(j=>i.jsx(Nde,{submission:j},j.id))}):i.jsx("div",{className:"text-center pt-16 text-gray-500",children:i.jsxs("p",{children:["No ",s.replace("-"," ")," submissions found."]})})]})]})},Cde=({status:n})=>{const e={"To Do":"bg-gray-500","In Progress":"bg-blue-500",Done:"bg-green-600"};return i.jsx("span",{className:`fo-status-badge ${e[n]}`,children:n})},Tde=()=>{const{user:n}=jt(),[e,t]=D.useState("tasks"),[r,s]=D.useState([]),[a,o]=D.useState([]),[l,c]=D.useState(!0);D.useEffect(()=>{if(!n)return;(async()=>{c(!0);try{const[p,x]=await Promise.all([ue.getTasks(),ue.getNotifications(n.id)]),v=p.filter(_=>_.assignedToId===n.id);s(v),o(x)}catch(p){console.error("Failed to load data for tasks page",p)}finally{c(!1)}})()},[n]);const d=h=>{const p=["HR","Admin","Ops Manager","Site Manager"];return p[h.charCodeAt(h.length-1)%p.length]};return i.jsxs("div",{children:[i.jsx("header",{className:"p-4 flex-shrink-0 text-center fo-mobile-header sticky top-0 bg-[#041b0f]/80 backdrop-blur-sm z-10 border-b border-[#374151]",children:i.jsx("h1",{children:"Tasks"})}),i.jsx("div",{className:"flex-shrink-0 p-4",children:i.jsxs("div",{className:"fo-tabs-container",children:[i.jsx("button",{onClick:()=>t("tasks"),className:`fo-tab-button ${e==="tasks"?"active":""}`,children:"Tasks"}),i.jsx("button",{onClick:()=>t("notifications"),className:`fo-tab-button ${e==="notifications"?"active":""}`,children:"Notifications"})]})}),i.jsx("main",{className:"p-4",children:l?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-muted"})}):e==="tasks"?r.length>0?i.jsx("div",{className:"space-y-4",children:r.map(h=>i.jsxs("div",{className:"fo-task-card",children:[i.jsxs("div",{className:"fo-task-header",children:[i.jsx("p",{className:"fo-task-title",children:h.name}),i.jsx(Cde,{status:h.status})]}),i.jsx("p",{className:"text-sm text-gray-400 mb-2",children:h.description}),i.jsxs("div",{className:"fo-task-meta flex justify-between items-center",children:[i.jsxs("span",{children:["Due: ",h.dueDate?$e(new Date(h.dueDate),"dd MMM, yyyy"):"N/A"]}),i.jsxs("span",{children:["Assigned by: ",d(h.id)]})]})]},h.id))}):i.jsxs("div",{className:"text-center text-muted pt-16",children:[i.jsx(bC,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"You have no assigned tasks."})]}):a.length>0?i.jsx("div",{className:"divide-y divide-border",children:a.map(h=>i.jsxs("div",{className:"fo-notification-item",children:[i.jsx(Cf,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("p",{className:"text-sm text-gray-300",children:h.message}),i.jsx("p",{className:"text-xs text-muted mt-1",children:ou(new Date(h.createdAt),{addSuffix:!0})})]})]},h.id))}):i.jsxs("div",{className:"text-center text-muted pt-16",children:[i.jsx(Cf,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"You have no notifications."})]})})]})},kde=({status:n})=>{const e={Pending:"bg-yellow-900/50 text-yellow-300 border border-yellow-500/50",Approved:"bg-blue-900/50 text-blue-300 border border-blue-500/50",Issued:"bg-green-900/50 text-green-300 border border-green-500/50",Rejected:"bg-red-900/50 text-red-300 border border-red-500/50"};return i.jsx("span",{className:`fo-status-badge ${e[n]}`,children:n})},Zg=({title:n,sizes:e,headers:t,control:r,quantityType:s})=>{const a=Array.from(new Set(e.map(l=>l.fit))),o=Array.from(new Set(e.map(l=>l.size))).sort((l,c)=>{const d=parseInt(String(l)),h=parseInt(String(c));return!isNaN(d)&&!isNaN(h)?d-h:String(l).localeCompare(String(c))});return i.jsxs("div",{className:"border border-border rounded-lg",children:[i.jsx("h4",{className:"p-3 font-semibold bg-accent text-white border-b border-accent",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:"Size"}),t.map(l=>i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:l.label},String(l.key))),i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted w-24",children:"Quantity"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:o.map(l=>i.jsx(ot.Fragment,{children:a.map((c,d)=>{const h=e.find(p=>p.size===l&&p.fit===c);return h?i.jsxs("tr",{children:[d===0&&i.jsx("td",{rowSpan:a.filter(p=>e.some(x=>x.size===l&&x.fit===p)).length,className:"px-3 py-2 align-middle font-semibold border-r",children:l}),t.map(p=>i.jsx("td",{className:"px-3 py-2",children:h[p.key]},String(p.key))),i.jsx("td",{className:"px-3 py-2",children:i.jsx(we,{name:`${s}.${h.id}`,control:r,render:({field:p})=>i.jsx(je,{"aria-label":`Quantity for ${n} size ${l} ${c}`,type:"number",...p,value:p.value||"",onChange:x=>p.onChange(parseInt(x.target.value)||null),className:"!py-1.5"})})})]},h.id):null})},l))})]})})]})},Pde=({onSave:n,onCancel:e,sites:t,masterUniforms:r,initialData:s})=>{const{register:a,control:o,handleSubmit:l,watch:c,reset:d}=tn({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),{data:h}=$n(),{user:p}=jt(),x=c("gender"),v=c("siteId");D.useEffect(()=>{if(s){const w={},j={};s.items.forEach(T=>{T.category==="Pants"?w[T.sizeId]=T.quantity:j[T.sizeId]=T.quantity}),d({siteId:s.siteId,gender:s.gender,pantsQuantities:w,shirtsQuantities:j})}else{const w=h.organization.organizationId||"",T=h.personal.gender==="Female"?"Ladies":"Gents";d({siteId:w,gender:T,pantsQuantities:{},shirtsQuantities:{}})}},[s,d,h]);const _=w=>{const j=t.find(M=>M.id===w.siteId);if(!j||!p)return;const T=x==="Gents"?[...r.gents.pants,...r.gents.shirts]:[...r.ladies.pants,...r.ladies.shirts],P=[];for(const[M,O]of Object.entries(w.pantsQuantities))if(O&&O>0){const I=T.find(q=>q.id===M);I&&P.push({sizeId:M,quantity:O,category:"Pants",sizeLabel:I.size,fit:I.fit})}for(const[M,O]of Object.entries(w.shirtsQuantities))if(O&&O>0){const I=T.find(q=>q.id===M);I&&P.push({sizeId:M,quantity:O,category:"Shirts",sizeLabel:I.size,fit:I.fit})}const E={id:s?.id||`new_${Date.now()}`,siteId:w.siteId,siteName:j.shortName,gender:w.gender,requestedDate:s?.requestedDate||new Date().toISOString(),status:s?.status||"Pending",items:P,source:"Individual",requestedById:p.id,requestedByName:p.name,employeeDetails:[{employeeName:`${h.personal.firstName} ${h.personal.lastName}`,employeeId:h.personal.employeeId,items:P.map(M=>({itemName:M.category,sizeLabel:M.sizeLabel,fit:M.fit,quantity:M.quantity}))}]};n(E)};return i.jsx("form",{onSubmit:l(_),children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(Ke,{label:"Select Site",value:v,...a("siteId"),required:!0,disabled:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),t.map(w=>i.jsx("option",{value:w.id,children:w.shortName},w.id))]}),i.jsxs(Ke,{label:"Select Uniform Type",value:x,...a("gender"),disabled:!0,children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Zg,{title:"Gents' Pants",sizes:r.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(Zg,{title:"Gents' Shirts",sizes:r.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Zg,{title:"Ladies' Pants",sizes:r.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(Zg,{title:"Ladies' Shirts",sizes:r.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]})}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#374151]",children:[i.jsx(re,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsxs(re,{type:"submit",children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Request"]})]})]})})},Mde=()=>{const[n,e]=D.useState("list"),[t,r]=D.useState([]),[s,a]=D.useState([]),[o,l]=D.useState(null),[c,d]=D.useState(!0),[h,p]=D.useState(null),[x,v]=D.useState(null),[_,w]=D.useState(null),j=St(),[T]=t4(),{updateUniforms:P}=$n(),E=T.get("from")==="onboarding",M=async()=>{d(!0);try{const[U,W,$,se]=await Promise.all([ue.getUniformRequests(),ue.getOrganizations(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);r(U.sort((Y,ae)=>new Date(ae.requestedDate).getTime()-new Date(Y.requestedDate).getTime())),a(W),l({gents:$,ladies:se})}catch{p({message:"Failed to load uniform data.",type:"error"})}finally{d(!1)}};D.useEffect(()=>{M()},[]),D.useEffect(()=>{E&&(e("form"),v(null))},[E]);const O=()=>{v(null),e("form")},I=U=>{v(U),e("form")},q=async U=>{if(E&&o){const W=U.gender==="Ladies"?[...o.ladies.pants,...o.ladies.shirts]:[...o.gents.pants,...o.gents.shirts],$=U.items.map(se=>{const Y=W.find(ee=>ee.id===se.sizeId),ae=se.category==="Pants"?`${U.gender}' Pants`:`${U.gender}' Shirts`;return{itemId:`generic_${U.gender.toLowerCase()}_${se.category==="Pants"?"pants":"shirts"}`,itemName:ae,sizeId:se.sizeId,sizeLabel:Y?.size||"",fit:Y?.fit||"",quantity:se.quantity}});P($),await ue.submitUniformRequest(U),j(-1);return}try{U.id.startsWith("new_")?(await ue.submitUniformRequest(U),p({message:"New request submitted.",type:"success"})):(await ue.updateUniformRequest(U),p({message:"Request updated.",type:"success"})),e("list"),M()}catch{p({message:"Failed to save request.",type:"error"})}},F=async()=>{if(_)try{await ue.deleteUniformRequest(_.id),p({message:"Request deleted.",type:"success"}),w(null),M()}catch{p({message:"Failed to delete request.",type:"error"})}},B=U=>U.reduce((W,$)=>W+$.quantity,0);if(c||!o)return i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-muted"})});if(n==="form"){const U=()=>{E?j(-1):e("list")};return i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header",children:[i.jsx("button",{onClick:U,"aria-label":"Go back",children:i.jsx(Aa,{className:"h-6 w-6"})}),i.jsxs("h1",{children:[x?"Edit":"New"," Request"]})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsx(Pde,{onSave:q,onCancel:U,sites:s,masterUniforms:o,initialData:x})})]})}return i.jsxs("div",{className:"h-full flex flex-col",children:[h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(Hr,{isOpen:!!_,onClose:()=>w(null),onConfirm:F,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header",children:[i.jsx("h1",{className:"text-lg font-semibold",children:"Uniform Requests"}),i.jsx("button",{onClick:O,"aria-label":"New Uniform Request",children:i.jsx(Wc,{className:"h-6 w-6"})})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:t.length>0?t.map(U=>i.jsxs("div",{className:"bg-[#243524] p-3 rounded-xl border border-[#374151]",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-white",children:U.siteName}),i.jsx("p",{className:"text-xs text-gray-400",children:$e(new Date(U.requestedDate),"dd MMM, yyyy")})]}),i.jsx(kde,{status:U.status})]}),i.jsxs("div",{className:"mt-3 flex justify-between items-end",children:[i.jsxs("div",{className:"text-sm text-gray-300",children:[i.jsxs("p",{children:[U.gender," Uniforms"]}),i.jsxs("p",{className:"font-semibold",children:[B(U.items)," Items"]})]}),U.status==="Pending"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(re,{variant:"icon",size:"sm",onClick:()=>I(U),children:i.jsx(cr,{className:"h-4 w-4 text-gray-400"})}),i.jsx(re,{variant:"icon",size:"sm",onClick:()=>w(U),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]})]})]},U.id)):i.jsxs("div",{className:"text-center text-muted pt-16",children:[i.jsx(Pf,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"No uniform requests found."}),i.jsxs(re,{onClick:O,className:"mt-4",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Create First Request"]})]})})]})},Dde=({priority:n})=>{const e={Low:"bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.5)]",Medium:"bg-yellow-500 shadow-[0_0_8px_rgba(234,179,8,0.5)]",High:"bg-orange-500 shadow-[0_0_8px_rgba(249,115,22,0.5)]",Urgent:"bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]"};return i.jsx("span",{className:`w-3 h-3 rounded-full ${e[n]}`,title:`Priority: ${n}`})},Ede=({status:n})=>{const e={Open:"bg-emerald-500/10 text-emerald-500 border-emerald-500/20","In Progress":"bg-blue-500/10 text-blue-500 border-blue-500/20","Pending Requester":"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",Resolved:"bg-purple-500/10 text-purple-500 border-purple-500/20",Closed:"bg-gray-500/10 text-gray-500 border-gray-500/20"};return i.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${e[n]}`,children:n})},Ode=({ticket:n,onClick:e})=>i.jsxs("div",{onClick:e,className:"group bg-card hover:bg-accent/5 p-5 rounded-xl border border-border hover:border-accent cursor-pointer transition-all duration-300 flex flex-col justify-between h-full shadow-sm hover:shadow-md",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-start gap-3 mb-2",children:[i.jsx("h4",{className:"font-bold text-primary-text leading-snug group-hover:text-accent transition-colors line-clamp-2",children:n.title}),i.jsx("div",{className:"flex-shrink-0 mt-1",children:i.jsx(Dde,{priority:n.priority})})]}),i.jsxs("p",{className:"text-xs text-muted font-mono",children:["#",n.ticketNumber]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[i.jsxs("div",{className:"flex justify-between items-center text-xs text-muted mb-3",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-700 flex items-center justify-center text-[10px] text-white font-bold",children:n.raisedByName.charAt(0)}),i.jsx("span",{children:n.raisedByName})]}),i.jsx("span",{children:ou(new Date(n.raisedAt),{addSuffix:!0})})]}),i.jsx("div",{className:"flex justify-between items-center",children:i.jsx(Ede,{status:n.status})})]})]}),EL=({user:n,onAction:e})=>i.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-card border border-border hover:border-accent/50 transition-colors",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Wi,{photoUrl:n.photoUrl,seed:n.id,className:"w-12 h-12 rounded-full shadow-sm"}),i.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ${n.isAvailable?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":"bg-rose-600 shadow-[0_0_6px_rgba(225,29,72,0.6)]"} ring-2 ring-white`})]}),i.jsxs("div",{className:"flex-grow min-w-0",children:[i.jsx("p",{className:"text-sm font-bold text-primary-text truncate",children:n.name}),i.jsx("p",{className:"text-xs text-muted truncate",children:n.role.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(re,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Call",onClick:()=>e(n.phone),children:i.jsx(kf,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Message",onClick:()=>e(n.phone),children:i.jsx(cm,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Video",onClick:()=>e(n.phone),children:i.jsx(t3,{className:"h-4 w-4"})})]})]}),Ide=()=>{const n=St(),{user:e}=jt(),[t,r]=D.useState([]),[s,a]=D.useState([]),[o,l]=D.useState(!0),[c,d]=D.useState(null),[h,p]=D.useState("All"),[x,v]=D.useState("All"),[_,w]=D.useState(""),[j,T]=D.useState(!1),[P,E]=D.useState(!1),M=Ft("(max-width: 767px)"),[O,I]=D.useState({status:"all",priority:"all",searchTerm:""});D.useEffect(()=>{(async()=>{if(e){l(!0);try{const[$,se]=await Promise.all([ue.getSupportTickets(),ue.getNearbyUsers()]);r($),a(se.filter(Y=>Y.id!==e.id))}catch{d({message:"Failed to load support data.",type:"error"})}finally{l(!1)}}})()},[e]);const q=D.useMemo(()=>t.filter(W=>{const $=O.status==="all"||W.status===O.status,se=O.priority==="all"||W.priority===O.priority,Y=O.searchTerm===""||W.title.toLowerCase().includes(O.searchTerm.toLowerCase())||W.ticketNumber.toLowerCase().includes(O.searchTerm.toLowerCase())||W.description.toLowerCase().includes(O.searchTerm.toLowerCase());return $&&se&&Y}),[t,O]),F=D.useMemo(()=>{const W=t.filter($=>$.status==="Resolved"&&$.raisedById===e?.id);return{open:t.filter($=>$.status==="Open").length,inProgress:t.filter($=>$.status==="In Progress").length,pendingYourAction:W.length}},[t,e]),B=W=>{if(!W){d({message:"User does not have a phone number.",type:"error"});return}let $=W.replace(/\D/g,"");if($.length>10&&($=$.slice(-10)),$.length!==10){d({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${$}`,"_blank")},U=({title:W,value:$,icon:se,colorClass:Y})=>i.jsxs("div",{className:"bg-transparent p-5 rounded-2xl flex items-center justify-between transition-all",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted mb-1",children:W}),i.jsx("p",{className:`text-3xl font-bold ${Y.replace("bg-","text-").split(" ")[0]}`,children:$})]}),i.jsx("div",{className:`p-3 rounded-full bg-opacity-10 ${Y.replace("text-","bg-")} ${Y}`,children:se})]});return i.jsxs("div",{className:"w-full p-4 lg:p-8 space-y-8",children:[c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsx(Hr,{isOpen:P,onClose:()=>E(!1),title:"Nearby Available Support",onConfirm:()=>E(!1),confirmButtonText:"Close",children:i.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:s.length>0?s.map(W=>i.jsx(EL,{user:W,onAction:B},W.id)):i.jsxs("div",{className:"text-center py-8 text-muted",children:[i.jsx(Yi,{className:"h-10 w-10 mx-auto mb-2 opacity-20"}),i.jsx("p",{children:"No support staff found nearby."})]})})}),i.jsx("div",{className:"relative overflow-hidden rounded-3xl bg-transparent p-6 lg:p-10 transition-all",children:i.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg backdrop-blur-sm",children:i.jsx(jx,{className:"h-6 w-6 text-emerald-600"})}),i.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-primary-text",children:"Support & Audit"})]}),i.jsx("p",{className:"text-muted max-w-xl text-sm",children:"Track issues, request audits, and connect with support staff in real-time."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 w-full lg:w-auto",children:[M&&i.jsxs(re,{onClick:()=>E(!0),variant:"secondary",className:"flex-1 lg:flex-none bg-gray-100 text-gray-900 hover:bg-gray-200 border-none shadow-none p-0 text-sm transition-colors",children:[i.jsx(uu,{className:"mr-1.5 h-3.5 w-3.5"})," Nearby"]}),i.jsxs(re,{onClick:()=>n("/support/ticket/new"),className:"flex-1 lg:flex-none",children:[i.jsx(Bt,{className:"mr-1.5 h-3.5 w-3.5"})," New Ticket"]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 lg:gap-6",children:[i.jsx(U,{title:"Open Tickets",value:F.open,icon:i.jsx(jx,{className:"h-6 w-6"}),colorClass:"text-rose-500"}),i.jsx(U,{title:"In Progress",value:F.inProgress,icon:i.jsx(wt,{className:"h-6 w-6"}),colorClass:"text-blue-500"}),i.jsx(U,{title:"Pending Your Action",value:F.pendingYourAction,icon:i.jsx(uu,{className:"h-6 w-6"}),colorClass:"text-amber-500"})]}),i.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-8",children:[i.jsx("div",{className:"lg:col-span-2 space-y-6",children:i.jsxs("div",{className:"bg-transparent p-5 rounded-2xl",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[i.jsxs("div",{className:"relative flex-grow",children:[i.jsx(Ma,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(je,{id:"search",placeholder:"Search tickets...",className:"pl-10 bg-gray-50 border-gray-200",value:O.searchTerm,onChange:W=>I($=>({...$,searchTerm:W.target.value}))})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:"w-32 sm:w-40",children:i.jsxs(Ke,{value:O.status,onChange:W=>I($=>({...$,status:W.target.value})),className:"bg-gray-50 border-gray-200",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{children:"Open"}),i.jsx("option",{children:"In Progress"}),i.jsx("option",{value:"Pending Requester",children:"Pending"}),i.jsx("option",{children:"Resolved"}),i.jsx("option",{children:"Closed"})]})}),i.jsx("div",{className:"w-32 sm:w-40",children:i.jsxs(Ke,{value:O.priority,onChange:W=>I($=>({...$,priority:W.target.value})),className:"bg-gray-50 border-gray-200",children:[i.jsx("option",{value:"all",children:"All Priority"}),i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})})]})]}),o?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:q.length>0?q.map(W=>i.jsx(Ode,{ticket:W,onClick:()=>n(`/support/ticket/${W.id}`)},W.id)):i.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-muted",children:[i.jsx("div",{className:"p-4 bg-accent/5 rounded-full mb-3",children:i.jsx(Ma,{className:"h-8 w-8 opacity-50"})}),i.jsx("p",{children:"No tickets match your filters."})]})})]})}),i.jsx("aside",{className:"hidden lg:block space-y-6",children:i.jsxs("div",{className:"bg-card p-6 rounded-2xl border border-border shadow-sm sticky top-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h3",{className:"font-bold text-lg text-primary-text flex items-center gap-2",children:[i.jsx(Yi,{className:"h-5 w-5 text-accent"})," Nearby Support"]}),i.jsxs("span",{className:"text-xs font-medium bg-accent/10 text-accent px-2 py-1 rounded-full",children:[s.filter(W=>W.isAvailable).length," Online"]})]}),i.jsx("div",{className:"space-y-3 max-h-[calc(100vh-200px)] overflow-y-auto pr-1 custom-scrollbar",children:s.length>0?s.map(W=>i.jsx(EL,{user:W,onAction:B},W.id)):i.jsx("div",{className:"text-center py-8 text-muted",children:i.jsx("p",{children:"No support staff found nearby."})})})]})})]})]})},Ade=({post:n,ticket:e,setTicket:t})=>{const{user:r}=jt(),[s,a]=D.useState(!1),[o,l]=D.useState(""),[c,d]=D.useState(!1),h=r?n.likes.includes(r.id):!1,p=async()=>{if(!r)return;const v=[...n.likes],_=h?n.likes.filter(w=>w!==r.id):[...n.likes,r.id];t(w=>w?{...w,posts:w.posts.map(j=>j.id===n.id?{...j,likes:_}:j)}:null);try{await ue.togglePostLike(n.id,r.id)}catch{t(j=>j?{...j,posts:j.posts.map(T=>T.id===n.id?{...T,likes:v}:T)}:null)}},x=async()=>{if(!(!o.trim()||!r)){d(!0);try{const v=await ue.addPostComment(n.id,{postId:n.id,authorId:r.id,authorName:r.name,content:o});t(_=>_?{..._,posts:_.posts.map(w=>w.id===n.id?{...w,comments:[...w.comments,v]}:w)}:null),l("")}catch{}finally{d(!1)}}};return i.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Wi,{seed:n.authorId,className:"w-10 h-10 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"w-full",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:n.authorName}),i.jsx("span",{className:"text-xs text-muted",children:n.authorRole.replace(/_/g," ")}),i.jsxs("span",{className:"text-xs text-muted",children:[" ",ou(new Date(n.createdAt),{addSuffix:!0})]})]}),i.jsx("p",{className:"text-sm text-muted mt-1 whitespace-pre-wrap",children:n.content}),i.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted",children:[i.jsxs("button",{onClick:p,className:`flex items-center gap-1.5 hover:text-accent transition-colors ${h?"text-accent font-semibold":""}`,children:[i.jsx(_J,{className:`h-4 w-4 ${h?"fill-current":""}`}),i.jsxs("span",{children:[n.likes.length," Like",n.likes.length!==1&&"s"]})]}),i.jsxs("button",{onClick:()=>a(!s),className:"flex items-center gap-1.5 hover:text-accent transition-colors",children:[i.jsx(cm,{className:"h-4 w-4"}),i.jsxs("span",{children:[n.comments.length," Comment",n.comments.length!==1&&"s"]})]})]}),s&&i.jsxs("div",{className:"mt-4 space-y-3 pt-3 border-t border-border animate-fade-in-down",children:[n.comments.map(v=>i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Wi,{seed:v.authorId,className:"w-8 h-8 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"bg-page p-2 rounded-lg flex-grow",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"font-semibold text-sm text-primary-text",children:v.authorName}),i.jsx("span",{className:"text-xs text-muted",children:ou(new Date(v.createdAt),{addSuffix:!0})})]}),i.jsx("p",{className:"text-sm text-muted",children:v.content})]})]},v.id)),i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Wi,{className:"w-8 h-8 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("textarea",{value:o,onChange:v=>l(v.target.value),placeholder:"Write a comment...",rows:2,className:"form-input text-sm"}),i.jsx("div",{className:"text-right mt-1",children:i.jsx(re,{size:"sm",onClick:x,isLoading:c,children:"Post"})})]})]})]})]})]})})},Rde=Pt({rating:is().min(1,"Please select a rating.").required(),feedback:ge().required("Feedback is required to close the ticket.").min(10,"Please provide more detailed feedback.")}).defined(),Lde=({value:n,onChange:e})=>{const[t,r]=D.useState(0);return i.jsx("div",{className:"flex items-center justify-center gap-1",onMouseLeave:()=>r(0),children:[1,2,3,4,5].map(s=>i.jsx("button",{type:"button",onMouseEnter:()=>r(s),onClick:()=>e(s),className:"focus:outline-none",children:i.jsx(XF,{className:`h-8 w-8 cursor-pointer transition-colors ${(t||n)>=s?"text-yellow-400 fill-current":"text-gray-400"}`})},s))})},Fde=({isOpen:n,onClose:e,onSubmit:t})=>{const[r,s]=D.useState(!1),{register:a,handleSubmit:o,control:l,formState:{errors:c}}=tn({resolver:Dn(Rde),defaultValues:{rating:0,feedback:""}}),d=h=>{s(!0),t(h.rating,h.feedback),s(!1)};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:h=>h.stopPropagation(),children:i.jsxs("form",{onSubmit:o(d),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-2 text-center",children:"Ticket Resolved"}),i.jsx("p",{className:"text-sm text-muted text-center mb-4",children:"Please rate the support you received before closing this ticket."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx(we,{name:"rating",control:l,render:({field:h})=>i.jsx(Lde,{value:h.value,onChange:h.onChange})}),c.rating&&i.jsx("p",{className:"mt-2 text-xs text-red-500 text-center",children:c.rating.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted text-center",children:"Your Feedback"}),i.jsx("textarea",{...a("feedback"),rows:4,className:`mt-1 form-input ${c.feedback?"form-input--error":""}`}),c.feedback&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.feedback.message})]})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(re,{type:"button",onClick:e,variant:"secondary",children:"Not Now"}),i.jsx(re,{type:"submit",isLoading:r,children:"Confirm & Close"})]})]})})}):null},qde=({priority:n})=>{const e={Low:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",Medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",High:"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300",Urgent:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"};return i.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${e[n]}`,children:n})},zde=({status:n})=>{const e={Open:"status-chip--pending","In Progress":"sync-chip--pending_sync","Pending Requester":"leave-status-chip--pending_hr_confirmation",Resolved:"leave-status-chip--approved",Closed:"status-chip--draft"};return i.jsx("span",{className:`status-chip ${e[n]}`,children:n})},Ude=()=>{const{id:n}=If(),e=St(),{user:t}=jt(),[r,s]=D.useState(null),[a,o]=D.useState([]),[l,c]=D.useState(!0),[d,h]=D.useState(null),[p,x]=D.useState(""),[v,_]=D.useState(!1),[w,j]=D.useState(!1);Ft("(max-width: 1023px)"),D.useEffect(()=>{if(!n)return;(async()=>{c(!0);try{const[F,B]=await Promise.all([ue.getSupportTicketById(n),ue.getNearbyUsers()]);F?s(F):(h({message:"Ticket not found.",type:"error"}),e("/support")),o(B)}catch{h({message:"Failed to load ticket data.",type:"error"})}finally{c(!1)}})()},[n,e]);const T=async()=>{if(!(!p.trim()||!r||!t)){_(!0);try{const q=await ue.addTicketPost(r.id,{ticketId:r.id,authorId:t.id,authorName:t.name,authorRole:t.role,content:p});s(F=>F?{...F,posts:[...F.posts,q]}:null),x("")}catch{h({message:"Failed to add post.",type:"error"})}finally{_(!1)}}},P=async q=>{if(r)try{const F=await ue.updateSupportTicket(r.id,q);s(F),q.status&&h({message:`Ticket status updated to ${q.status}`,type:"success"})}catch{h({message:"Failed to update ticket.",type:"error"})}},E=async(q,F)=>{await P({status:"Closed",rating:q,feedback:F,closedAt:new Date().toISOString()}),j(!1)},M=q=>{if(!q){h({message:"User does not have a phone number.",type:"error"});return}let F=q.replace(/\D/g,"");if(F.length>10&&(F=F.slice(-10)),F.length!==10){h({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${F}`,"_blank")};if(l)return i.jsx("div",{className:"flex justify-center items-center h-screen",children:i.jsx(wt,{className:"h-12 w-12 animate-spin text-accent"})});if(!r)return null;const O=t?.id===r.raisedById,I=()=>r.status==="Closed"?null:i.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.status==="Open"&&i.jsx(re,{onClick:()=>P({status:"In Progress",assignedToId:t?.id,assignedToName:t?.name}),children:"Assign to Me"}),r.status==="In Progress"&&t?.id===r.assignedToId&&i.jsx(re,{onClick:()=>P({status:"Resolved",resolvedAt:new Date().toISOString()}),children:"Mark as Resolved"}),r.status==="Resolved"&&O&&i.jsx(re,{onClick:()=>j(!0),children:"Close Ticket"})]});return i.jsxs("div",{className:"p-4",children:[d&&i.jsx(ht,{message:d.message,type:d.type,onDismiss:()=>h(null)}),w&&i.jsx(Fde,{isOpen:w,onClose:()=>j(!1),onSubmit:E}),i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx(re,{variant:"icon",onClick:()=>e("/support"),children:i.jsx(Aa,{})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl md:text-2xl font-bold text-primary-text",children:r.title}),i.jsxs("p",{className:"text-xs text-muted",children:["#",r.ticketNumber]})]})]}),i.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-6",children:[i.jsxs("main",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card space-y-4",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-start",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(zde,{status:r.status}),i.jsx(qde,{priority:r.priority})]}),i.jsxs("div",{className:"text-sm text-muted text-right",children:[i.jsxs("p",{children:["Raised by: ",i.jsx("span",{className:"font-semibold text-primary-text",children:r.raisedByName})]}),i.jsx("p",{children:$e(new Date(r.raisedAt),"dd MMM, yyyy - hh:mm a")})]})]}),i.jsx("p",{className:"text-sm text-muted whitespace-pre-wrap",children:r.description}),r.attachmentUrl&&i.jsxs("div",{className:"mt-4",children:[i.jsx("h5",{className:"text-sm font-semibold text-primary-text mb-2",children:"Attachment"}),i.jsx("a",{href:r.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"block border rounded-lg overflow-hidden max-w-xs hover:border-accent",children:i.jsx("img",{src:r.attachmentUrl,alt:"Attachment",className:"max-h-64 w-auto"})})]})]}),i.jsx("div",{className:"space-y-4",children:r.posts.map(q=>i.jsx(Ade,{post:q,ticket:r,setTicket:s},q.id))}),r.status!=="Closed"&&i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card flex items-start gap-3",children:[i.jsx(Wi,{className:"w-10 h-10 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"w-full",children:[i.jsx("textarea",{value:p,onChange:q=>x(q.target.value),placeholder:"Add a public reply...",className:"form-input w-full",rows:3}),i.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[i.jsx(re,{variant:"icon",size:"sm",title:"Attach file",children:i.jsx(pJ,{className:"h-5 w-5"})}),i.jsxs(re,{onClick:T,isLoading:v,children:[i.jsx(_C,{className:"mr-2 h-4"})," Post"]})]})]})]})]}),i.jsxs("aside",{className:"space-y-6 mt-6 lg:mt-0",children:[i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[i.jsx("h3",{className:"font-semibold text-primary-text mb-3",children:"Ticket Details"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Assigned To:"})," ",i.jsx("span",{className:"font-semibold",children:r.assignedToName||"Unassigned"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Category:"})," ",i.jsx("span",{children:r.category})]}),r.resolvedAt&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Resolved:"})," ",i.jsx("span",{children:$e(new Date(r.resolvedAt),"dd MMM, yy")})]}),r.closedAt&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Closed:"})," ",i.jsx("span",{children:$e(new Date(r.closedAt),"dd MMM, yy")})]}),r.rating&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Rating:"})," ",i.jsxs("span",{className:"flex items-center gap-1",children:[r.rating," ",i.jsx(XF,{className:"h-4 w-4 text-yellow-400 fill-current"})]})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:I()})]}),i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[i.jsxs("h3",{className:"font-semibold text-primary-text mb-3 flex items-center gap-2",children:[i.jsx(Yi,{className:"h-5 w-5 text-muted"})," Nearby Users"]}),i.jsx("div",{className:"space-y-3",children:a.map(q=>i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Wi,{photoUrl:q.photoUrl,seed:q.id,className:"w-10 h-10 rounded-full"}),i.jsx("span",{className:"absolute bottom-0 right-0 block h-2.5 w-2.5 rounded-full bg-green-400 ring-2 ring-card"})]}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("p",{className:"text-sm font-semibold",children:q.name}),i.jsx("p",{className:"text-xs text-muted",children:q.role.replace(/_/g," ").replace(/\b\w/g,F=>F.toUpperCase())})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(re,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(q.phone),children:i.jsx(kf,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(q.phone),children:i.jsx(cm,{className:"h-4 w-4"})}),i.jsx(re,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(q.phone),children:i.jsx(t3,{className:"h-4 w-4"})})]})]},q.id))})]})]})]})]})},Vde=Pt({id:ge().optional(),name:ge().required("Name is required"),email:ge().email("Invalid email").required("Email is required"),role:ge().required("Role is required"),password:ge().min(6,"Password must be at least 6 characters").required("Password is required for new users"),phone:ge().optional(),organizationId:ge().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:ge().optional(),reportingManagerId:ge().optional(),photoUrl:ge().optional().nullable()}).defined(),Bde=Pt({id:ge().optional(),name:ge().required("Name is required"),email:ge().email("Invalid email").required("Email is required"),role:ge().required("Role is required"),phone:ge().optional(),organizationId:ge().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:ge().optional(),reportingManagerId:ge().optional(),photoUrl:ge().optional().nullable()}).defined(),OL=()=>{const n=St(),{id:e}=If(),t=!!e,r=Ft("(max-width: 767px)"),[s,a]=D.useState(!1),[o,l]=D.useState([]),[c,d]=D.useState([]),[h,p]=D.useState(null),[x,v]=D.useState(null),_=t?Bde:Vde,{register:w,handleSubmit:j,formState:{errors:T},reset:P,watch:E,setValue:M}=tn({resolver:Dn(_)}),O=E("role");D.useEffect(()=>{(async()=>{try{const[B,U]=await Promise.all([ue.getOrganizations(),ue.getRoles()]);if(l(B),d(U),t&&e){const $=(await ue.getUsers()).find(se=>se.id===e);$&&(v($),P($))}else P({name:"",email:"",role:"field_officer"})}catch{p({message:"Failed to load form data.",type:"error"})}})()},[e,t,P]);const I=F=>{const B=F.target.value,U=o.find(W=>W.id===B);M("organizationId",B),M("organizationName",U?.shortName||"")},q=async F=>{a(!0);try{if(t&&e){const{password:B,...U}=F;await ue.updateUser(e,U),p({message:"User updated successfully!",type:"success"})}else{const{name:B,email:U,password:W,role:$,...se}=F;if(!W)throw new Error("Password is required when creating a new user");const Y=await ue.createAuthUser({name:B,email:U,password:W,role:$});se&&Object.keys(se).length>0&&await ue.updateUser(Y.id,se),await ue.createNotification({userId:Y.id,message:`Welcome ${Y.name}! Your account has been created.`,type:"greeting"}),p({message:"User created successfully!",type:"success"})}setTimeout(()=>n("/admin/users"),1500)}catch(B){p({message:B.message||"Failed to save user.",type:"error"})}finally{a(!1)}};return r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit User":"Add User"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Wc,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit User":"Add New User"}),i.jsx("p",{className:"text-sm text-gray-400",children:t?"Update user information below.":"Create a new user account with initial credentials."})]}),i.jsxs("form",{onSubmit:j(q),className:"space-y-4",children:[i.jsx(je,{label:"Full Name",id:"name",registration:w("name"),error:T.name?.message}),i.jsx(je,{label:"Email",id:"email",type:"email",registration:w("email"),error:T.email?.message}),i.jsx(Ke,{label:"Role",id:"role",registration:w("role"),error:T.role?.message,children:c.map(F=>i.jsx("option",{value:F.id,children:F.displayName},F.id))}),!t&&i.jsx(je,{label:"Password",id:"password",type:"password",registration:w("password"),error:T.password?.message}),O==="site_manager"&&i.jsxs(Ke,{label:"Assigned Site",id:"organizationId",...w("organizationId"),error:T.organizationId?.message,onChange:I,children:[i.jsx("option",{value:"",children:"Select a Site"}),o.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/users"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:j(q),disabled:s,className:"fo-btn-primary flex-1",children:s?"Saving...":t?"Save Changes":"Create User"})]}),h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Wc,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit User":"Add New User"}),i.jsx("p",{className:"text-muted",children:t?"Update user information below.":"Create a new user account with initial credentials."})]})]}),i.jsxs("form",{onSubmit:j(q),className:"space-y-6",children:[i.jsx(je,{label:"Full Name",id:"name",registration:w("name"),error:T.name?.message}),i.jsx(je,{label:"Email",id:"email",type:"email",registration:w("email"),error:T.email?.message}),i.jsx(Ke,{label:"Role",id:"role",registration:w("role"),error:T.role?.message,children:c.map(F=>i.jsx("option",{value:F.id,children:F.displayName},F.id))}),!t&&i.jsx(je,{label:"Password",id:"password",type:"password",registration:w("password"),error:T.password?.message}),O==="site_manager"&&i.jsxs(Ke,{label:"Assigned Site",id:"organizationId",...w("organizationId"),error:T.organizationId?.message,onChange:I,children:[i.jsx("option",{value:"",children:"Select a Site"}),o.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/admin/users"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:s,children:t?"Save Changes":"Create User"})]})]})]}),h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)})]})},Wde=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=D.useState(""),[s,a]=D.useState(""),[o,l]=D.useState(!1),[c,d]=D.useState(null),h=async p=>{if(p.preventDefault(),!!t.trim()){l(!0);try{await ue.createPolicy({name:t.trim(),description:s.trim()}),d({message:"Policy created successfully!",type:"success"}),setTimeout(()=>n("/hr/policies-and-insurance"),1500)}catch{d({message:"Failed to save policy. Please try again.",type:"error"})}finally{l(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Policy"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(os,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Policy"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new policy for your organization."})]}),i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:p=>r(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:o})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"description",value:s,onChange:p=>a(p.target.value),placeholder:"Description",className:"form-input",rows:4,disabled:o})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/policies-and-insurance"),disabled:o,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:h,disabled:o||!t.trim(),className:"fo-btn-primary flex-1",children:o?"Saving...":"Save Policy"})]}),c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(os,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Policy"}),i.jsx("p",{className:"text-muted",children:"Create a new policy for your organization."})]})]}),i.jsxs("form",{onSubmit:h,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:p=>r(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:o})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"description",value:s,onChange:p=>a(p.target.value),placeholder:"Description",className:"form-input",rows:4,disabled:o})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/hr/policies-and-insurance"),variant:"secondary",disabled:o,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:o,disabled:!t.trim(),children:"Save Policy"})]})]})]}),c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)})]})},$de=Pt({title:ge().required("Title is required"),description:ge().required("Description is required"),category:ge().oneOf(["Software Developer","Admin","Operational","HR Query","Other"]).required("Category is required"),priority:ge().oneOf(["Low","Medium","High","Urgent"]).required("Priority is required"),assignedToId:ge().optional().nullable(),attachment:Wt().optional().nullable()}).defined(),Hde=()=>{const n=St(),{user:e}=jt(),[t,r]=D.useState(!1),[s,a]=D.useState([]),[o,l]=D.useState(null),c=Ft("(max-width: 767px)"),{register:d,handleSubmit:h,control:p,formState:{errors:x}}=tn({resolver:Dn($de),defaultValues:{category:"Software Developer",priority:"Medium",assignedToId:null,attachment:null}}),v=su({control:p,name:"category"});D.useEffect(()=>{ue.getUsers().then(a)},[]);const _=D.useMemo(()=>{if(!s)return[];switch(v){case"Software Developer":return s.filter(P=>P.role==="developer");case"Admin":return s.filter(P=>P.role==="admin");case"HR Query":return s.filter(P=>P.role==="hr");case"Operational":return s.filter(P=>["operation_manager","site_manager"].includes(P.role));default:const T=["admin","hr","developer","operation_manager","site_manager"];return s.filter(P=>T.includes(P.role))}},[s,v]),w=async T=>{if(e){r(!0);try{const P=s.find(E=>E.id===T.assignedToId);await ue.createSupportTicket({...T,attachment:T.attachment,status:"Open",raisedById:e.id,raisedByName:e.name,assignedToId:T.assignedToId||null,assignedToName:P?.name||null,resolvedAt:null,closedAt:null,rating:null,feedback:null}),l({message:"Ticket created successfully!",type:"success"}),setTimeout(()=>n("/support"),1500)}catch{l({message:"Failed to create ticket.",type:"error"})}finally{r(!1)}}},j="new-ticket-form";return c?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"New Support Ticket"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(EM,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Create New Ticket"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Submit a support request or report an issue."})]}),i.jsxs("form",{id:j,onSubmit:h(w),className:"space-y-4",children:[i.jsx(je,{placeholder:"Title / Subject",...d("title"),error:x.title?.message}),i.jsxs("div",{children:[i.jsx("textarea",{placeholder:"Description",...d("description"),rows:5,className:`form-input ${x.description?"form-input--error":""}`}),x.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.description.message})]}),i.jsx(we,{name:"category",control:p,render:({field:T})=>i.jsxs(Ke,{...T,error:x.category?.message,children:[i.jsx("option",{children:"Software Developer"}),i.jsx("option",{children:"Admin"}),i.jsx("option",{children:"Operational"}),i.jsx("option",{children:"HR Query"}),i.jsx("option",{children:"Other"})]})}),i.jsx(we,{name:"priority",control:p,render:({field:T})=>i.jsxs(Ke,{...T,error:x.priority?.message,children:[i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})}),i.jsx(we,{name:"assignedToId",control:p,render:({field:T})=>i.jsxs(Ke,{...T,value:T.value??"",error:x.assignedToId?.message,children:[i.jsx("option",{value:"",children:"Unassigned"}),_.map(P=>i.jsxs("option",{value:P.id,children:[P.name," (",P.role.replace(/_/g," "),")"]},P.id))]})}),i.jsx(we,{name:"attachment",control:p,render:({field:T,fieldState:P})=>i.jsx(yt,{label:"Attach Screenshot or Document (Image only)",file:T.value,onFileChange:T.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:P.error?.message})})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/support"),disabled:t,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",form:j,disabled:t,className:"fo-btn-primary flex-1",children:t?"Creating...":"Create Ticket"})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(EM,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Create New Ticket"}),i.jsx("p",{className:"text-muted",children:"Submit a support request or report an issue."})]})]}),i.jsxs("form",{id:j,onSubmit:h(w),className:"space-y-6",children:[i.jsx(je,{label:"Title / Subject",...d("title"),error:x.title?.message}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{...d("description"),rows:5,className:`form-input ${x.description?"form-input--error":""}`}),x.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.description.message})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(we,{name:"category",control:p,render:({field:T})=>i.jsxs(Ke,{label:"Category",...T,error:x.category?.message,children:[i.jsx("option",{children:"Software Developer"}),i.jsx("option",{children:"Admin"}),i.jsx("option",{children:"Operational"}),i.jsx("option",{children:"HR Query"}),i.jsx("option",{children:"Other"})]})}),i.jsx(we,{name:"priority",control:p,render:({field:T})=>i.jsxs(Ke,{label:"Priority",...T,error:x.priority?.message,children:[i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})})]}),i.jsx(we,{name:"assignedToId",control:p,render:({field:T})=>i.jsxs(Ke,{label:"Assigned To (Optional)",...T,value:T.value??"",error:x.assignedToId?.message,children:[i.jsx("option",{value:"",children:"Unassigned"}),_.map(P=>i.jsxs("option",{value:P.id,children:[P.name," (",P.role.replace(/_/g," "),")"]},P.id))]})}),i.jsx(we,{name:"attachment",control:p,render:({field:T,fieldState:P})=>i.jsx(yt,{label:"Attach Screenshot or Document (Image only)",file:T.value,onFileChange:T.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:P.error?.message})}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/support"),variant:"secondary",disabled:t,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:t,children:"Create Ticket"})]})]})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},Yde=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=D.useState(""),[s,a]=D.useState(!1),[o,l]=D.useState(null),c=async d=>{if(d.preventDefault(),!!t.trim()){a(!0);try{const h={id:`group_${Date.now()}`,name:t.trim(),locations:[],companies:[]};l({message:"Group created successfully!",type:"success"}),setTimeout(()=>n("/hr/entity-management"),1500)}catch{l({message:"Failed to create group. Please try again.",type:"error"})}finally{a(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Group"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx($i,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Group"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new organizational group."})]}),i.jsx("form",{onSubmit:c,className:"space-y-4",children:i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Group Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:d=>r(d.target.value),placeholder:"Enter group name",className:"form-input",required:!0,disabled:s})]})})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/entity-management"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:c,disabled:s||!t.trim(),className:"fo-btn-primary flex-1",children:s?"Saving...":"Create Group"})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx($i,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Group"}),i.jsx("p",{className:"text-muted",children:"Create a new organizational group."})]})]}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Group Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:d=>r(d.target.value),placeholder:"Enter group name",className:"form-input",required:!0,disabled:s})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/hr/entity-management"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:s,disabled:!t.trim(),children:"Create Group"})]})]})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},Gde=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=D.useState([]),[s,a]=D.useState(""),[o,l]=D.useState(""),[c,d]=D.useState(""),[h,p]=D.useState(!1),[x,v]=D.useState(null),_=async w=>{if(w.preventDefault(),!(!s||!o||!c.trim())){p(!0);try{console.log("Granting comp off:",{userId:s,days:o,reason:c}),v({message:"Comp off granted successfully!",type:"success"}),setTimeout(()=>n("/hr/leave-management"),1500)}catch{v({message:"Failed to grant comp off.",type:"error"})}finally{p(!1)}}};return D.useEffect(()=>{(async()=>{try{const j=await ue.getUsers();r(j)}catch{v({message:"Failed to load users.",type:"error"})}})()},[]),e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Grant Comp Off"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(DM,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Grant Compensatory Off"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Grant comp off days to an employee."})]}),i.jsxs("form",{onSubmit:_,className:"space-y-4",children:[i.jsxs(Ke,{label:"Select Employee",id:"user",value:s,onChange:w=>a(w.target.value),error:!s&&s!==""?"Please select an employee":"",children:[i.jsx("option",{value:"",children:"Select an employee"}),t.map(w=>i.jsxs("option",{value:w.id,children:[w.name," - ",w.role]},w.id))]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"days",className:"block text-sm font-medium text-muted mb-1",children:["Number of Days ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"days",type:"number",step:"0.5",min:"0.5",value:o,onChange:w=>l(w.target.value),placeholder:"e.g. 1, 0.5, 2",className:"form-input",required:!0,disabled:h})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-muted mb-1",children:["Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"reason",value:c,onChange:w=>d(w.target.value),placeholder:"Reason for granting comp off",className:"form-input",rows:4,required:!0,disabled:h})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/leave-management"),disabled:h,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:_,disabled:h||!s||!o||!c.trim(),className:"fo-btn-primary flex-1",children:h?"Granting...":"Grant Comp Off"})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(DM,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Grant Compensatory Off"}),i.jsx("p",{className:"text-muted",children:"Grant comp off days to an employee."})]})]}),i.jsxs("form",{onSubmit:_,className:"space-y-6",children:[i.jsxs(Ke,{label:"Select Employee",id:"user",value:s,onChange:w=>a(w.target.value),children:[i.jsx("option",{value:"",children:"Select an employee"}),t.map(w=>i.jsxs("option",{value:w.id,children:[w.name," - ",w.role]},w.id))]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"days",className:"block text-sm font-medium text-muted mb-1",children:["Number of Days ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"days",type:"number",step:"0.5",min:"0.5",value:o,onChange:w=>l(w.target.value),placeholder:"e.g. 1, 0.5, 2",className:"form-input",required:!0,disabled:h})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-muted mb-1",children:["Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"reason",value:c,onChange:w=>d(w.target.value),placeholder:"Reason for granting comp off",className:"form-input",rows:4,required:!0,disabled:h})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/hr/leave-management"),variant:"secondary",disabled:h,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:h,disabled:!s||!o||!c.trim(),children:"Grant Comp Off"})]})]})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]})},Zde=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=D.useState(""),[s,a]=D.useState(""),[o,l]=D.useState(""),[c,d]=D.useState(!1),[h,p]=D.useState(null),x=async v=>{if(v.preventDefault(),!(!t.trim()||!s.trim())){d(!0);try{const _={id:t.toLowerCase().replace(/\s+/g,"_"),name:t.trim(),description:s.trim(),permissions:o.split(",").map(T=>T.trim()).filter(Boolean)},w=await ue.getModules();if(w.some(T=>T.id===_.id)){p({message:"Module with this ID already exists.",type:"error"}),d(!1);return}const j=[...w,_];await ue.saveModules(j),p({message:"Module created successfully!",type:"success"}),setTimeout(()=>n("/admin/modules"),1500)}catch{p({message:"Failed to create module. Please try again.",type:"error"})}finally{d(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Module"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(dm,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Module"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new system module."})]}),i.jsxs("form",{onSubmit:x,className:"space-y-4",children:[i.jsx(je,{label:"Module Name",id:"name",value:t,onChange:v=>r(v.target.value),placeholder:"e.g. HR Tasks & Management",required:!0,disabled:c,error:!t.trim()&&t!==""?"Module name is required":""}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:["Description ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"description",value:s,onChange:v=>a(v.target.value),placeholder:"Manage leaves, policies, insurance, uniforms, and tasks.",className:"form-input",rows:4,required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"permissions",className:"block text-sm font-medium text-muted mb-1",children:"Permissions (comma-separated)"}),i.jsx("input",{id:"permissions",value:o,onChange:v=>l(v.target.value),placeholder:"e.g. view_module, manage_module",className:"form-input",disabled:c})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/modules"),disabled:c,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:x,disabled:c||!t.trim()||!s.trim(),className:"fo-btn-primary flex-1",children:c?"Creating...":"Create Module"})]}),h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(dm,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Module"}),i.jsx("p",{className:"text-muted",children:"Create a new system module."})]})]}),i.jsxs("form",{onSubmit:x,className:"space-y-6",children:[i.jsx(je,{label:"Module Name",id:"name",value:t,onChange:v=>r(v.target.value),placeholder:"e.g. HR Tasks & Management",required:!0,disabled:c}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:["Description ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"description",value:s,onChange:v=>a(v.target.value),placeholder:"Manage leaves, policies, insurance, uniforms, and tasks.",className:"form-input",rows:4,required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"permissions",className:"block text-sm font-medium text-muted mb-1",children:"Permissions (comma-separated)"}),i.jsx("input",{id:"permissions",value:o,onChange:v=>l(v.target.value),placeholder:"e.g. view_module, manage_module",className:"form-input",disabled:c})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/admin/modules"),variant:"secondary",disabled:c,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:c,disabled:!t.trim()||!s.trim(),children:"Create Module"})]})]})]}),h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)})]})},IL=()=>{const n=St(),{id:e}=If(),t=!!e,r=Ft("(max-width: 767px)"),{permissions:s,setRolePermissions:a,addRolePermissionEntry:o}=Ki(),[l,c]=D.useState(""),[d,h]=D.useState(""),[p,x]=D.useState([]),[v,_]=D.useState(!1),[w,j]=D.useState(null);D.useEffect(()=>{(async()=>{try{if(t&&e){const O=(await ue.getRoles()).find(I=>I.id===e);if(O){c(O.id),h(O.displayName);const I=s[O.id]||[];x(I)}}}catch{j({message:"Failed to load data.",type:"error"})}})()},[e,t,s]);const T=E=>{x(M=>M.includes(E)?M.filter(O=>O!==E):[...M,E])},P=async E=>{if(E.preventDefault(),!(!l.trim()||!d.trim())){_(!0);try{const M=t?l:l.toLowerCase().replace(/\s+/g,"_"),O={id:M,displayName:d.trim()},I=await ue.getRoles();let q=[...I];if(t)q=q.map(F=>F.id===M?O:F);else{if(I.some(F=>F.id===M)){j({message:"Role ID already exists.",type:"error"}),_(!1);return}q.push(O)}await ue.saveRoles(q),a(M,p),t||o(O),j({message:`Role ${t?"updated":"created"} successfully!`,type:"success"}),setTimeout(()=>n("/admin/roles"),1500)}catch{j({message:"Failed to save role. Please try again.",type:"error"})}finally{_(!1)}}};return r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Role":"Add Role"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(um,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit Role":"Add New Role"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Define role permissions and access control."})]}),i.jsxs("form",{onSubmit:P,className:"space-y-4",children:[i.jsx(je,{label:"Role ID",id:"roleId",value:l,onChange:E=>c(E.target.value),placeholder:"e.g. admin, hr, field_officer",required:!0,disabled:v||t}),i.jsx(je,{label:"Display Name",id:"displayName",value:d,onChange:E=>h(E.target.value),placeholder:"e.g. Admin, HR, Field Officer",required:!0,disabled:v}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Permissions"}),i.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:mm.map(E=>i.jsxs("label",{className:"flex items-center gap-2 p-2 rounded hover:bg-page cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.includes(E.key),onChange:()=>T(E.key),className:"form-checkbox",disabled:v}),i.jsx("span",{className:"text-sm",children:E.name})]},E.key))})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/roles"),disabled:v,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:P,disabled:v||!l.trim()||!d.trim(),className:"fo-btn-primary flex-1",children:v?"Saving...":t?"Save Changes":"Create Role"})]}),w&&i.jsx(ht,{message:w.message,type:w.type,onDismiss:()=>j(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(um,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit Role":"Add New Role"}),i.jsx("p",{className:"text-muted",children:"Define role permissions and access control."})]})]}),i.jsxs("form",{onSubmit:P,className:"space-y-6",children:[i.jsx(je,{label:"Role ID",id:"roleId",value:l,onChange:E=>c(E.target.value),placeholder:"e.g. admin, hr, field_officer",required:!0,disabled:v||t}),i.jsx(je,{label:"Display Name",id:"displayName",value:d,onChange:E=>h(E.target.value),placeholder:"e.g. Admin, HR, Field Officer",required:!0,disabled:v}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-muted mb-2",children:["Permissions (",p.length," selected)"]}),i.jsx("div",{className:"border border-border rounded-lg p-4 space-y-2 max-h-96 overflow-y-auto",children:mm.map(E=>i.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-page cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.includes(E.key),onChange:()=>T(E.key),className:"form-checkbox",disabled:v}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium",children:E.name}),E.description&&i.jsx("div",{className:"text-xs text-muted",children:E.description})]})]},E.key))})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/admin/roles"),variant:"secondary",disabled:v,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:v,disabled:!l.trim()||!d.trim(),children:t?"Save Changes":"Create Role"})]})]})]}),w&&i.jsx(ht,{message:w.message,type:w.type,onDismiss:()=>j(null)})]})},Kde=Pt({groupId:ge().required("Please select a group"),companyId:ge().required("Please select a company"),clientId:ge().required("Please select a client"),manpowerCount:is().typeError("Must be a number").min(0,"Cannot be negative").required("Manpower count is required")}).defined(),Jde=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=D.useState([]),[s,a]=D.useState(!0),[o,l]=D.useState(!1),[c,d]=D.useState(""),[h,p]=D.useState(!1),[x,v]=D.useState(null),_=D.useRef(null),{register:w,handleSubmit:j,watch:T,formState:{errors:P},setValue:E}=tn({resolver:Dn(Kde)}),M=T("groupId"),O=T("companyId");D.useEffect(()=>{a(!0),ue.getOrganizationStructure().then(r).catch(()=>v({message:"Failed to load organization structure.",type:"error"})).finally(()=>a(!1))},[]),D.useEffect(()=>{E("companyId",""),E("clientId",""),d("")},[M,E]),D.useEffect(()=>{E("clientId",""),d("")},[O,E]),D.useEffect(()=>{const W=$=>{_.current&&!_.current.contains($.target)&&p(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[]);const I=D.useMemo(()=>t.find(W=>W.id===M)?.companies||[],[t,M]),q=D.useMemo(()=>I.find(W=>W.id===O)?.entities||[],[I,O]),F=D.useMemo(()=>c?q.filter(W=>W.name.toLowerCase().includes(c.toLowerCase())):q,[q,c]),B=W=>{E("clientId",W.id,{shouldValidate:!0}),d(W.name),p(!1)},U=async W=>{const $=q.find(se=>se.id===W.clientId);if($){l(!0);try{if((await ue.getOrganizations()).some(ae=>ae.id===$.organizationId)){v({message:"A site for this client already exists.",type:"error"}),l(!1);return}const Y={id:$.organizationId||`site_${Date.now()}`,shortName:$.name,fullName:$.name,address:$.location||$.registeredAddress||"",manpowerApprovedCount:W.manpowerCount};await ue.createOrganization(Y),v({message:"Site added successfully!",type:"success"}),setTimeout(()=>n("/admin/sites"),1500)}catch{v({message:"Failed to add site. Please try again.",type:"error"})}finally{l(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Site"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx($i,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add Site from Client"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new site from an existing client entity."})]}),s?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("form",{onSubmit:j(U),className:"space-y-4",children:[i.jsxs(Ke,{label:"Group",id:"groupId",registration:w("groupId"),error:P.groupId?.message,children:[i.jsx("option",{value:"",children:"Select a Group"}),t.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs(Ke,{label:"Company",id:"companyId",registration:w("companyId"),error:P.companyId?.message,disabled:!M,children:[i.jsx("option",{value:"",children:"Select a Company"}),I.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs("div",{className:"relative",ref:_,children:[i.jsx(je,{label:"Client",id:"clientSearch",value:c,onChange:W=>{d(W.target.value),p(!0),E("clientId","")},onFocus:()=>p(!0),disabled:!O,error:P.clientId?.message,autoComplete:"off"}),h&&F.length>0&&i.jsx("ul",{className:"absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto shadow-lg",children:F.map(W=>i.jsx("li",{onClick:()=>B(W),className:"px-3 py-2 text-sm cursor-pointer hover:bg-page",children:W.name},W.id))})]}),i.jsx(je,{label:"Approved Manpower Count",id:"manpowerCount",type:"number",registration:w("manpowerCount"),error:P.manpowerCount?.message})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/sites"),disabled:o,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:j(U),disabled:o||s,className:"fo-btn-primary flex-1",children:o?"Adding...":"Add Site"})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx($i,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add Site from Client"}),i.jsx("p",{className:"text-muted",children:"Create a new site from an existing client entity."})]})]}),s?i.jsx("div",{className:"flex justify-center py-12",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("form",{onSubmit:j(U),className:"space-y-6",children:[i.jsxs(Ke,{label:"Group",id:"groupId",registration:w("groupId"),error:P.groupId?.message,children:[i.jsx("option",{value:"",children:"Select a Group"}),t.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs(Ke,{label:"Company",id:"companyId",registration:w("companyId"),error:P.companyId?.message,disabled:!M,children:[i.jsx("option",{value:"",children:"Select a Company"}),I.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs("div",{className:"relative",ref:_,children:[i.jsx(je,{label:"Client",id:"clientSearch",value:c,onChange:W=>{d(W.target.value),p(!0),E("clientId","")},onFocus:()=>p(!0),disabled:!O,error:P.clientId?.message,autoComplete:"off"}),h&&F.length>0&&i.jsx("ul",{className:"absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto shadow-lg",children:F.map(W=>i.jsx("li",{onClick:()=>B(W),className:"px-3 py-2 text-sm cursor-pointer hover:bg-page",children:W.name},W.id))})]}),i.jsx(je,{label:"Approved Manpower Count",id:"manpowerCount",type:"number",registration:w("manpowerCount"),error:P.manpowerCount?.message}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/admin/sites"),variant:"secondary",disabled:o,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:o,children:"Add Site"})]})]})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]})},Qde=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=D.useState(""),[s,a]=D.useState(!1),[o,l]=D.useState(null),c=async d=>{if(d.preventDefault(),!!t.trim()){a(!0);try{const h={id:`SITE-${t.toUpperCase().replace(/\s/g,"").substring(0,4)}-${Date.now()%1e3}`,shortName:t.trim(),fullName:t.trim(),address:"To be configured",provisionalCreationDate:new Date().toISOString()};await ue.createOrganization(h),l({message:`Provisional site '${t}' created.`,type:"success"}),setTimeout(()=>n("/admin/sites"),1500)}catch(h){const p=h?.message||h?.error?.message||"Failed to create site.";l({message:`Failed to create site: ${p}`,type:"error"})}finally{a(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Quick Add Site"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(CS,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Quick Add Provisional Site"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new site with a 90-day grace period."})]}),i.jsxs("form",{onSubmit:c,className:"space-y-4",children:[i.jsx(je,{label:"New Site Name",id:"quick-add-site-name",value:t,onChange:d=>r(d.target.value),placeholder:"e.g. New Project Site",required:!0,disabled:s,autoFocus:!0}),i.jsx("p",{className:"text-xs text-muted",children:"This will create a new site with a 90-day grace period to complete the full configuration."})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/sites"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:c,disabled:s||!t.trim(),className:"fo-btn-primary flex-1",children:s?"Adding...":"Add Site"})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(CS,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Quick Add Provisional Site"}),i.jsx("p",{className:"text-muted",children:"Create a new site with a 90-day grace period to complete the full configuration."})]})]}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[i.jsx(je,{label:"New Site Name",id:"quick-add-site-name",value:t,onChange:d=>r(d.target.value),placeholder:"e.g. New Project Site",required:!0,disabled:s,autoFocus:!0}),i.jsx("p",{className:"text-sm text-muted -mt-4",children:"This will create a new site with a 90-day grace period to complete the full configuration."}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/admin/sites"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:s,disabled:!t.trim(),children:"Add Site"})]})]})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},Xde=Pt({name:ge().required("Task name is required"),description:ge().required("Description is required"),dueDate:ge().required("A due date is required").nullable(),priority:ge().oneOf(["Low","Medium","High"]).required("Priority is required"),assignedToId:ge().required("An assignee is required"),escalationLevel1UserId:ge().optional(),escalationLevel1DurationDays:is().when("escalationLevel1UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationLevel2UserId:ge().optional(),escalationLevel2DurationDays:is().when("escalationLevel2UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationEmail:ge().email("Must be a valid email address").optional(),escalationEmailDurationDays:is().when("escalationEmail",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()})}).defined(),AL=()=>{const n=St(),{id:e}=If(),t=!!e,r=Ft("(max-width: 767px)"),{createTask:s,updateTask:a,tasks:o}=h1(),[l,c]=D.useState(!1),[d,h]=D.useState([]),[p,x]=D.useState(null),{permissions:v}=Ki(),{fetchNotifications:_}=ey(),{theme:w}=xu(),j=w==="dark",{register:T,handleSubmit:P,formState:{errors:E},reset:M,control:O,watch:I}=tn({resolver:Dn(Xde),defaultValues:{priority:"Medium",assignedToId:"",dueDate:null}}),q=I("escalationLevel1UserId"),F=I("escalationLevel2UserId"),B=I("escalationEmail");D.useEffect(()=>{(async()=>{try{const X=await ue.getUsers();if(h(X),t&&e){let Z=o.find(oe=>oe.id===e);Z||(Z=(await ue.getTasks()).find(H=>H.id===e)),Z?M(Z):(x({message:"Task not found.",type:"error"}),setTimeout(()=>n("/tasks"),2e3))}}catch{x({message:"Failed to load data.",type:"error"})}})()},[e,t,o,M,n]);const U=async ee=>{c(!0);try{const X=d.find(oe=>oe.id===ee.assignedToId),Z={...ee,assignedToName:X?.name};if(t&&e?(await a(e,Z),x({message:"Task updated successfully!",type:"success"})):(await s(Z),x({message:"Task created successfully.",type:"success"})),X){const Q=(v[X.role]||[]).includes("manage_tasks")?"/tasks":"/onboarding/tasks";(!t||t&&e)&&(await ue.createNotification({userId:X.id,type:"task_assigned",message:`You have been assigned a new task: "${ee.name}"`,linkTo:Q}),_())}setTimeout(()=>n("/tasks"),1500)}catch{x({message:"Failed to save task.",type:"error"})}finally{c(!1)}},W="!bg-[#041b0f] !border-white/10 !text-white !placeholder-gray-500 !rounded-xl focus:!ring-emerald-500 focus:!border-emerald-500",$="text-gray-300 font-medium mb-1.5 block",se="",Y="block text-sm font-medium text-muted mb-1",ae=j?W:se,J=j?$:Y;return r?i.jsxs("div",{className:`h-full flex flex-col ${j?"bg-[#041b0f] text-white":""}`,children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Task":"Add Task"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:`${j?"bg-[#152b1b] border border-white/10":"bg-card"} rounded-2xl p-6 space-y-6`,children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:`inline-block p-3 rounded-full mb-2 ${j?"bg-emerald-500/20":"bg-accent-light"}`,children:i.jsx(fm,{className:`h-8 w-8 ${j?"text-emerald-400":"text-accent-dark"}`})}),i.jsx("h2",{className:`text-xl font-bold ${j?"text-white":"text-primary-text"}`,children:t?"Edit Task":"Create New Task"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Assign tasks and set deadlines."})]}),i.jsxs("form",{onSubmit:P(U),className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"name",className:J,children:"Task Name"}),i.jsx(je,{id:"name",registration:T("name"),error:E.name?.message,className:ae,placeholder:j?"Enter task name":""})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:J,children:"Description"}),i.jsx("textarea",{id:"description",rows:4,...T("description"),className:j?`w-full ${ae} px-3 py-3 outline-none`:`mt-1 bg-card border ${E.description?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`,placeholder:j?"Enter task description":""}),E.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.description.message})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:J,children:"Due Date"}),i.jsx(we,{name:"dueDate",control:O,render:({field:ee})=>i.jsx(kn,{label:"",id:"dueDate",value:ee.value,onChange:ee.onChange,error:E.dueDate?.message,minDate:new Date,className:ae})})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"priority",className:J,children:"Priority"}),i.jsxs(Ke,{id:"priority",registration:T("priority"),error:E.priority?.message,className:ae,children:[i.jsx("option",{value:"Low",className:j?"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:j?"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:j?"bg-[#041b0f]":"",children:"High"})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"assignedToId",className:J,children:"Assign To"}),i.jsxs(Ke,{id:"assignedToId",registration:T("assignedToId"),error:E.assignedToId?.message,className:ae,children:[i.jsx("option",{value:"",className:j?"bg-[#041b0f]":"",children:"Select User"}),d.map(ee=>i.jsxs("option",{value:ee.id,className:j?"bg-[#041b0f]":"",children:[ee.name," (",ee.role.replace(/_/g," "),")"]},ee.id))]})]})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/tasks"),disabled:l,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:P(U),disabled:l,className:"fo-btn-primary flex-1",children:l?"Saving...":t?"Save Changes":"Create Task"})]}),p&&i.jsx(ht,{message:p.message,type:p.type,onDismiss:()=>x(null)})]}):i.jsxs("div",{className:`p-4 md:p-6 ${j?"text-white":""}`,children:[i.jsxs("div",{className:`${j?"bg-[#152b1b] border border-white/10":"bg-card"} p-8 rounded-xl shadow-card w-full max-w-3xl mx-auto`,children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:`p-3 rounded-full mr-4 ${j?"bg-emerald-500/20":"bg-accent-light"}`,children:i.jsx(fm,{className:`h-8 w-8 ${j?"text-emerald-400":"text-accent-dark"}`})}),i.jsxs("div",{children:[i.jsx("h2",{className:`text-2xl font-bold ${j?"text-white":"text-primary-text"}`,children:t?"Edit Task":"Create New Task"}),i.jsx("p",{className:j?"text-gray-400":"text-muted",children:"Assign tasks and set deadlines."})]})]}),i.jsxs("form",{onSubmit:P(U),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"name",className:J,children:"Task Name"}),i.jsx(je,{id:"name",registration:T("name"),error:E.name?.message,className:ae,placeholder:j?"Enter task name":""})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"description",className:J,children:"Description"}),i.jsx("textarea",{id:"description",rows:4,...T("description"),className:j?`w-full ${ae} px-3 py-3 outline-none`:`mt-1 bg-card border ${E.description?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`,placeholder:j?"Enter task description":""}),E.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:E.description.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:J,children:"Due Date"}),i.jsx(we,{name:"dueDate",control:O,render:({field:ee})=>i.jsx(kn,{label:"",id:"dueDate",value:ee.value,onChange:ee.onChange,error:E.dueDate?.message,minDate:new Date,className:ae})})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"priority",className:J,children:"Priority"}),i.jsxs(Ke,{id:"priority",registration:T("priority"),error:E.priority?.message,className:ae,children:[i.jsx("option",{value:"Low",className:j?"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:j?"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:j?"bg-[#041b0f]":"",children:"High"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"assignedToId",className:J,children:"Assign To"}),i.jsxs(Ke,{id:"assignedToId",registration:T("assignedToId"),error:E.assignedToId?.message,className:ae,children:[i.jsx("option",{value:"",className:j?"bg-[#041b0f]":"",children:"Select User"}),d.map(ee=>i.jsxs("option",{value:ee.id,className:j?"bg-[#041b0f]":"",children:[ee.name," (",ee.role.replace(/_/g," "),")"]},ee.id))]})]})]}),i.jsxs("div",{className:`pt-6 border-t ${j?"border-white/10":"border-border"}`,children:[i.jsx("h4",{className:`text-lg font-semibold ${j?"text-white":"text-primary-text"} mb-1`,children:"Escalation Matrix (Optional)"}),i.jsx("p",{className:`text-sm ${j?"text-gray-400":"text-muted"} mb-6`,children:"Define who gets notified if this task becomes overdue."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel1UserId",className:J,children:"Escalation Level 1"}),i.jsxs(Ke,{id:"escalationLevel1UserId",registration:T("escalationLevel1UserId"),error:E.escalationLevel1UserId?.message,className:ae,children:[i.jsx("option",{value:"",className:j?"bg-[#041b0f]":"",children:"Select User"}),d.map(ee=>i.jsx("option",{value:ee.id,className:j?"bg-[#041b0f]":"",children:ee.name},ee.id))]})]}),q&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel1DurationDays",className:J,children:"Days until L1 Escalation"}),i.jsx(je,{id:"escalationLevel1DurationDays",type:"number",registration:T("escalationLevel1DurationDays"),error:E.escalationLevel1DurationDays?.message,className:ae})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel2UserId",className:J,children:"Escalation Level 2"}),i.jsxs(Ke,{id:"escalationLevel2UserId",registration:T("escalationLevel2UserId"),error:E.escalationLevel2UserId?.message,className:ae,children:[i.jsx("option",{value:"",className:j?"bg-[#041b0f]":"",children:"Select User"}),d.map(ee=>i.jsx("option",{value:ee.id,className:j?"bg-[#041b0f]":"",children:ee.name},ee.id))]})]}),F&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel2DurationDays",className:J,children:"Days until L2 Escalation"}),i.jsx(je,{id:"escalationLevel2DurationDays",type:"number",registration:T("escalationLevel2DurationDays"),error:E.escalationLevel2DurationDays?.message,className:ae})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"escalationEmail",className:J,children:"Final Escalation Email"}),i.jsx(je,{id:"escalationEmail",type:"email",registration:T("escalationEmail"),error:E.escalationEmail?.message,className:ae,placeholder:j?"Enter email address":""})]}),B&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"escalationEmailDurationDays",className:J,children:"Days until Final Escalation"}),i.jsx(je,{id:"escalationEmailDurationDays",type:"number",registration:T("escalationEmailDurationDays"),error:E.escalationEmailDurationDays?.message,className:ae})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/tasks"),variant:"secondary",disabled:l,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:l,children:t?"Save Changes":"Create Task"})]})]})]}),p&&i.jsx(ht,{message:p.message,type:p.type,onDismiss:()=>x(null)})]})},Cc=({title:n,sizes:e,headers:t,control:r,quantityType:s,quantities:a,readOnly:o=!1})=>{const l=Array.from(new Set(e.map(d=>d.fit))),c=Array.from(new Set(e.map(d=>d.size))).sort((d,h)=>{const p=parseInt(String(d)),x=parseInt(String(h));return!isNaN(p)&&!isNaN(x)?p-x:String(d).localeCompare(String(h))});return i.jsxs("div",{className:"border rounded-lg flex flex-col overflow-hidden bg-card",children:[i.jsx("h4",{className:"p-3 font-semibold bg-gray-50 dark:bg-white/5 border-b flex-shrink-0",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 dark:bg-white/5",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:"Size"}),t.map(d=>i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:d.label},String(d.key))),i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted w-20",children:"Qty"})]})}),i.jsx("tbody",{className:"divide-y dark:divide-white/10",children:c.map(d=>i.jsx(ot.Fragment,{children:l.map((h,p)=>{const x=e.find(v=>v.size===d&&v.fit===h);return x?i.jsxs("tr",{children:[p===0&&i.jsx("td",{rowSpan:l.filter(v=>e.some(_=>_.size===d&&_.fit===v)).length,className:"px-2 py-2 align-middle font-semibold border-r dark:border-white/10",children:d}),t.map(v=>i.jsx("td",{className:"px-2 py-2",children:x[v.key]},String(v.key))),i.jsx("td",{className:"px-2 py-2",children:o?i.jsx("span",{className:"font-semibold block text-center pr-4",children:a?.[x.id]||0}):i.jsx(we,{name:`${s}.${x.id}`,control:r,render:({field:v})=>i.jsx(je,{"aria-label":`Quantity for ${n} size ${d} ${h}`,type:"number",...v,value:v.value||"",onChange:_=>v.onChange(parseInt(_.target.value)||null),className:"!py-1.5"})})})]},x.id):null})},d))})]})})]})},RL=()=>{const n=St(),{id:e}=If(),t=!!e,r=Ft("(max-width: 767px)"),[s,a]=D.useState([]),[o,l]=D.useState(null),[c,d]=D.useState(!0),[h,p]=D.useState(!1),[x,v]=D.useState(null),[_,w]=D.useState(null),{register:j,control:T,handleSubmit:P,watch:E,reset:M}=tn({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),O=E("gender");D.useEffect(()=>{(async()=>{d(!0);try{const[F,B,U]=await Promise.all([ue.getOrganizations(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);if(a(F),l({gents:B,ladies:U}),t&&e){const $=(await ue.getUniformRequests()).find(se=>se.id===e);if($){w($);const se={},Y={};$.items.forEach(ae=>{ae.category==="Pants"?se[ae.sizeId]=ae.quantity:Y[ae.sizeId]=ae.quantity}),M({siteId:$.siteId,gender:$.gender,pantsQuantities:se,shirtsQuantities:Y})}else v({message:"Request not found.",type:"error"}),setTimeout(()=>n("/uniforms"),2e3)}}catch{v({message:"Failed to load data.",type:"error"})}finally{d(!1)}})()},[e,t,n,M]);const I=async q=>{if(!o)return;const F=s.find(B=>B.id===q.siteId);if(F){p(!0);try{const B=O==="Gents"?[...o.gents.pants,...o.gents.shirts]:[...o.ladies.pants,...o.ladies.shirts],U=[];for(const[$,se]of Object.entries(q.pantsQuantities))if(se&&se>0){const Y=B.find(ae=>ae.id===$);Y&&U.push({sizeId:$,quantity:se,category:"Pants",sizeLabel:Y.size,fit:Y.fit})}for(const[$,se]of Object.entries(q.shirtsQuantities))if(se&&se>0){const Y=B.find(ae=>ae.id===$);Y&&U.push({sizeId:$,quantity:se,category:"Shirts",sizeLabel:Y.size,fit:Y.fit})}const W={id:_?.id||`new_${Date.now()}`,siteId:q.siteId,siteName:F.shortName,gender:q.gender,requestedDate:_?.requestedDate||new Date().toISOString(),status:_?.status||"Pending",items:U};W.id.startsWith("new_")?(await ue.submitUniformRequest(W),v({message:"New request submitted.",type:"success"})):(await ue.updateUniformRequest(W),v({message:"Request updated.",type:"success"})),setTimeout(()=>n("/uniforms"),1500)}catch{v({message:"Failed to save request.",type:"error"})}finally{p(!1)}}};return c?i.jsx("div",{className:"flex justify-center items-center h-screen",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-emerald-600"})}):o?r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Request":"New Request"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Pf,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit Uniform Request":"New Uniform Request"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Submit a request for new uniforms."})]}),i.jsxs("form",{onSubmit:P(I),className:"space-y-6",children:[i.jsxs(Ke,{label:"Select Site",...j("siteId"),required:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),s.map(q=>i.jsx("option",{value:q.id,children:q.shortName},q.id))]}),i.jsxs(Ke,{label:"Select Uniform Type",...j("gender"),children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]}),i.jsx("div",{className:"space-y-6",children:O==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Cc,{title:"Gents' Pants",sizes:o.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],control:T,quantityType:"pantsQuantities"}),i.jsx(Cc,{title:"Gents' Shirts",sizes:o.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],control:T,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Cc,{title:"Ladies' Pants",sizes:o.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:T,quantityType:"pantsQuantities"}),i.jsx(Cc,{title:"Ladies' Shirts",sizes:o.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:T,quantityType:"shirtsQuantities"})]})})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/uniforms"),disabled:h,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:P(I),disabled:h,className:"fo-btn-primary flex-1",children:h?"Saving...":"Save Request"})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Pf,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit Uniform Request":"New Uniform Request"}),i.jsx("p",{className:"text-muted",children:"Submit a request for new uniforms."})]})]}),i.jsxs("form",{onSubmit:P(I),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(Ke,{label:"Select Site",...j("siteId"),required:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),s.map(q=>i.jsx("option",{value:q.id,children:q.shortName},q.id))]}),i.jsxs(Ke,{label:"Select Uniform Type",...j("gender"),children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]})]}),i.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:O==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Cc,{title:"Gents' Pants",sizes:o.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],control:T,quantityType:"pantsQuantities"}),i.jsx(Cc,{title:"Gents' Shirts",sizes:o.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],control:T,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Cc,{title:"Ladies' Pants",sizes:o.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:T,quantityType:"pantsQuantities"}),i.jsx(Cc,{title:"Ladies' Shirts",sizes:o.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:T,quantityType:"shirtsQuantities"})]})}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(re,{type:"button",onClick:()=>n("/uniforms"),variant:"secondary",disabled:h,children:"Cancel"}),i.jsx(re,{type:"submit",isLoading:h,children:h?"Saving...":"Save Request"})]})]})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):null},yr=({label:n,isVerified:e,hasValue:t,error:r,registration:s,onManualInput:a,...o})=>{const{theme:l}=xu(),c=l==="dark",h=s?{...s,onChange:async p=>{a&&a(),s?.onChange&&await s.onChange(p)}}:void 0;return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center mb-1",children:[i.jsx("label",{htmlFor:o.id,className:"block text-sm font-medium text-muted",children:n}),t&&(e?i.jsx("span",{className:`ml-2 flex items-center ${c?"text-green-400":"text-green-600"}`,title:"Verified from document",children:i.jsx(Hi,{className:"h-4 w-4"})}):i.jsx("span",{className:`ml-2 flex items-center ${c?"text-yellow-400":"text-yellow-500"}`,title:"Manually entered. Please verify.",children:i.jsx(Da,{className:"h-4 w-4"})}))]}),i.jsx(je,{id:o.id,error:r,registration:h,label:"",...o})]})},eue=Pt({employeeId:ge().required(),firstName:ge().required("First name is required"),middleName:ge().optional(),lastName:ge().required("Last name is required"),preferredName:ge().optional(),dob:ge().required("Date of birth is required"),gender:ge().oneOf(["Male","Female","Other",""]).required("Gender is required"),maritalStatus:ge().oneOf(["Single","Married","Divorced","Widowed",""]).required("Marital status is required"),bloodGroup:ge().oneOf(["","A+","A-","B+","B-","AB+","AB-","O+","O-"]).required("Blood group is required"),mobile:ge().required("Mobile number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number"),alternateMobile:ge().optional().nullable(),email:ge().email("Must be a valid email").required("Email is required"),idProofType:ge().oneOf(["Aadhaar","PAN","Voter ID",""]).optional(),idProofNumber:ge().optional(),photo:Wt().optional().nullable(),idProofFront:Wt().optional().nullable(),idProofBack:Wt().optional().nullable(),emergencyContactName:ge().required("Emergency contact name is required"),emergencyContactNumber:ge().required("Emergency contact number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),relationship:ge().oneOf(["Spouse","Child","Father","Mother","Sibling","Other",""]).required("Relationship is required"),salary:is().typeError("Salary must be a number").min(0).required("Salary is required").nullable(),verifiedStatus:Pt().optional()}).defined(),tue=()=>{const{onValidated:n}=yi(),{data:e,updatePersonal:t,addOrUpdateEmergencyContactAsFamilyMember:r,setPersonalVerifiedStatus:s}=$n(),{register:a,handleSubmit:o,formState:{errors:l},control:c,reset:d,watch:h}=tn({resolver:Dn(eue),defaultValues:e.personal}),p=h();D.useEffect(()=>{d(e.personal)},[e.personal,d]),D.useEffect(()=>{let v;const _=h(w=>{clearTimeout(v),v=window.setTimeout(()=>{t(w)},500)});return()=>{_.unsubscribe(),clearTimeout(v)}},[h,t]);const x=async v=>{t(v),r(),await n()};return i.jsxs("form",{onSubmit:o(x),id:"personal-form",children:[i.jsx("div",{className:"text-left",children:i.jsx(Pr,{title:"Personal Details",subtitle:"Please provide your personal information as per your official documents."})}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-8 md:items-start",children:[i.jsx("div",{className:"flex-shrink-0 mx-auto md:mx-0",children:i.jsx(we,{name:"photo",control:c,render:({field:v})=>i.jsx(RS,{file:v.value,onFileChange:_=>v.onChange(_)})})}),i.jsxs("div",{className:"w-full flex-grow grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{label:"Employee ID",id:"employeeId",registration:a("employeeId"),error:l.employeeId?.message,readOnly:!0,className:"bg-gray-100"})}),i.jsx(yr,{label:"First Name",id:"firstName",registration:a("firstName"),error:l.firstName?.message,isVerified:e.personal.verifiedStatus?.name===!0,hasValue:!!p.firstName,onManualInput:()=>s({name:!1})}),i.jsx(je,{label:"Middle Name (Optional)",id:"middleName",registration:a("middleName")}),i.jsx(yr,{label:"Last Name",id:"lastName",registration:a("lastName"),error:l.lastName?.message,isVerified:e.personal.verifiedStatus?.name===!0,hasValue:!!p.lastName,onManualInput:()=>s({name:!1})}),i.jsx(je,{label:"Preferred Name (Optional)",id:"preferredName",registration:a("preferredName")}),i.jsx(we,{name:"dob",control:c,render:({field:v})=>i.jsx(kn,{label:"Date of Birth",id:"dob",error:l.dob?.message,value:v.value,onChange:_=>{v.onChange(_),s({dob:!1})},maxDate:new Date})}),i.jsxs(Ke,{label:"Gender",id:"gender",registration:a("gender"),error:l.gender?.message,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{children:"Male"}),i.jsx("option",{children:"Female"}),i.jsx("option",{children:"Other"})]}),i.jsxs(Ke,{label:"Marital Status",id:"maritalStatus",registration:a("maritalStatus"),error:l.maritalStatus?.message,children:[i.jsx("option",{value:"",children:"Select Status"}),i.jsx("option",{children:"Single"}),i.jsx("option",{children:"Married"}),i.jsx("option",{children:"Divorced"}),i.jsx("option",{children:"Widowed"})]}),i.jsxs(Ke,{label:"Blood Group",id:"bloodGroup",registration:a("bloodGroup"),error:l.bloodGroup?.message,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"A+"}),i.jsx("option",{children:"A-"}),i.jsx("option",{children:"B+"}),i.jsx("option",{children:"B-"}),i.jsx("option",{children:"AB+"}),i.jsx("option",{children:"AB-"}),i.jsx("option",{children:"O+"}),i.jsx("option",{children:"O-"})]}),i.jsx(je,{label:"Mobile Number",id:"mobile",type:"tel",registration:a("mobile"),error:l.mobile?.message}),i.jsx(je,{label:"Alternate Mobile (Optional)",id:"alternateMobile",type:"tel",registration:a("alternateMobile")}),i.jsx(je,{label:"Email Address",id:"email",type:"email",registration:a("email"),error:l.email?.message}),i.jsx(je,{label:"Monthly Salary (Gross)",id:"salary",type:"number",registration:a("salary"),error:l.salary?.message}),i.jsxs("div",{className:"md:col-span-3 pt-4 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Emergency Contact"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[i.jsx(je,{label:"Contact Name",id:"emergencyContactName",registration:a("emergencyContactName"),error:l.emergencyContactName?.message}),i.jsx(je,{label:"Contact Number",id:"emergencyContactNumber",type:"tel",registration:a("emergencyContactNumber"),error:l.emergencyContactNumber?.message}),i.jsxs(Ke,{label:"Relationship",id:"relationship",registration:a("relationship"),error:l.relationship?.message,children:[i.jsx("option",{value:"",children:"Select Relationship"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"}),i.jsx("option",{children:"Sibling"}),i.jsx("option",{children:"Other"})]})]})]})]})]})]})},LL=Pt({line1:ge().required("Address line 1 is required"),line2:ge().optional(),city:ge().required("City is required"),state:ge().required("State is required"),country:ge().required("Country is required"),pincode:ge().required("Pincode is required").matches(/^[1-9][0-9]{5}$/,"Must be a valid 6-digit Indian pincode"),verifiedStatus:Pt().optional()}).defined(),nue=Pt({present:LL.required(),permanent:LL.required(),sameAsPresent:ss().required()}).defined(),rue=()=>{const{onValidated:n}=yi(),{data:e,updateAddress:t,setAddressVerifiedStatus:r}=$n(),{address:s}=pi(),[a,o]=D.useState(!1),[l,c]=D.useState(""),{register:d,handleSubmit:h,formState:{errors:p},control:x,setValue:v,trigger:_,getValues:w,reset:j,watch:T}=tn({resolver:Dn(nue),defaultValues:e.address}),P=su({control:x,name:"sameAsPresent"}),E=su({control:x,name:"present"}),M=su({control:x,name:"permanent"});D.useEffect(()=>{j(e.address)},[e.address,j]),D.useEffect(()=>{let F;const B=T(U=>{clearTimeout(F),F=window.setTimeout(()=>{t(U)},500)});return()=>{B.unsubscribe(),clearTimeout(F)}},[T,t]),D.useEffect(()=>{P&&(v("permanent",E),_("permanent"))},[P,E,v,_]);const O=(F,B)=>{r(F,{[B]:!1})},I=async F=>{const B=F.target.value;if(O("present","pincode"),s.enablePincodeVerification&&/^[1-9][0-9]{5}$/.test(B)){o(!0),c("");try{const U=await ue.getPincodeDetails(B);v("present.city",U.city,{shouldValidate:!0}),v("present.state",U.state,{shouldValidate:!0}),r("present",{city:!0,state:!0,pincode:!0})}catch{c("Invalid Pincode. Please check and try again.")}finally{o(!1)}}},q=async F=>{t(F),await n()};return i.jsxs("form",{onSubmit:h(q),id:"address-form",children:[i.jsx(Pr,{title:"Address Details",subtitle:"Your communication and permanent address."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Present Address"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(yr,{label:"Address Line 1",id:"present.line1",isVerified:!!e.address.present.verifiedStatus?.line1,hasValue:!!E?.line1,onManualInput:()=>O("present","line1"),error:p.present?.line1?.message,registration:d("present.line1")})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(je,{label:"Address Line 2 (Optional)",id:"present.line2",registration:d("present.line2")})}),i.jsx(yr,{label:"Country",id:"present.country",isVerified:!!e.address.present.verifiedStatus?.country,hasValue:!!E?.country,onManualInput:()=>O("present","country"),error:p.present?.country?.message,registration:d("present.country")}),i.jsxs("div",{className:"relative",children:[i.jsx(yr,{label:"Pincode",id:"present.pincode",type:"tel",isVerified:!!e.address.present.verifiedStatus?.pincode,hasValue:!!E?.pincode,error:p.present?.pincode?.message||l,registration:d("present.pincode"),onBlur:I}),a&&i.jsx(wt,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]}),i.jsx(yr,{label:"City",id:"present.city",isVerified:!!e.address.present.verifiedStatus?.city,hasValue:!!E?.city,onManualInput:()=>O("present","city"),error:p.present?.city?.message,registration:d("present.city")}),i.jsx(yr,{label:"State",id:"present.state",isVerified:!!e.address.present.verifiedStatus?.state,hasValue:!!E?.state,onManualInput:()=>O("present","state"),error:p.present?.state?.message,registration:d("present.state")})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Permanent Address"}),i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("input",{id:"sameAsPresent",type:"checkbox",...d("sameAsPresent"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),i.jsx("label",{htmlFor:"sameAsPresent",className:"ml-2 block text-sm text-muted",children:"Same as Present Address"})]}),!P&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(yr,{label:"Address Line 1",id:"permanent.line1",isVerified:!!e.address.permanent.verifiedStatus?.line1,hasValue:!!M?.line1,onManualInput:()=>O("permanent","line1"),error:p.permanent?.line1?.message,registration:d("permanent.line1")})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(je,{label:"Address Line 2 (Optional)",id:"permanent.line2",registration:d("permanent.line2")})}),i.jsx(yr,{label:"Country",id:"permanent.country",isVerified:!!e.address.permanent.verifiedStatus?.country,hasValue:!!M?.country,onManualInput:()=>O("permanent","country"),error:p.permanent?.country?.message,registration:d("permanent.country")}),i.jsx(yr,{label:"Pincode",id:"permanent.pincode",type:"tel",isVerified:!!e.address.permanent.verifiedStatus?.pincode,hasValue:!!M?.pincode,onManualInput:()=>O("permanent","pincode"),error:p.permanent?.pincode?.message,registration:d("permanent.pincode")}),i.jsx(yr,{label:"City",id:"permanent.city",isVerified:!!e.address.permanent.verifiedStatus?.city,hasValue:!!M?.city,onManualInput:()=>O("permanent","city"),error:p.permanent?.city?.message,registration:d("permanent.city")}),i.jsx(yr,{label:"State",id:"permanent.state",isVerified:!!e.address.permanent.verifiedStatus?.state,hasValue:!!M?.state,onManualInput:()=>O("permanent","state"),error:p.permanent?.state?.message,registration:d("permanent.state")})]})]})]})]})},sue=Pt({designation:ge().required("Designation is required"),department:ge().required("Department is required"),reportingManager:ge().optional(),organizationId:ge().required("Organization is required"),organizationName:ge().required(),joiningDate:ge().required("Joining date is required"),workType:ge().oneOf(["Full-time","Part-time","Contract",""]).required("Work type is required"),site:ge().optional(),defaultSalary:is().nullable().optional()}).defined(),iue=()=>{const{onValidated:n}=yi(),{user:e}=jt(),{data:t,updateOrganization:r}=$n(),[s,a]=D.useState([]),o=Ft("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:h,watch:p,setValue:x,reset:v}=tn({resolver:Dn(sue),defaultValues:t.organization}),_=p("organizationId"),w=p("designation"),j=!!t.organization.organizationId;D.useEffect(()=>{ue.getOrganizations().then(a)},[]),D.useEffect(()=>{v(t.organization)},[t.organization,v]),D.useEffect(()=>{let P;const E=p(M=>{clearTimeout(P),P=window.setTimeout(()=>{r(M)},500)});return()=>{E.unsubscribe(),clearTimeout(P)}},[p,r]),D.useEffect(()=>{const P=s.find(E=>E.id===_);P&&x("organizationName",P.shortName)},[_,s,x]),D.useEffect(()=>{w&&ue.suggestDepartmentForDesignation(w).then(P=>{P&&x("department",P,{shouldValidate:!0})})},[w,x]);const T=async P=>{r(P),await n()};return o?i.jsx("form",{onSubmit:c(T),id:"organization-form",children:i.jsxs("div",{className:"space-y-6",children:[i.jsx("p",{className:"text-sm text-gray-400",children:"Provide the employment details for the new employee within the organization."}),i.jsxs("select",{...l("organizationId"),className:"pro-select pro-select-arrow",disabled:j,children:[i.jsx("option",{value:"",children:"Select Organization"}),s.map(P=>i.jsx("option",{value:P.id,children:P.shortName},P.id))]}),d.organizationId&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.organizationId.message}),i.jsx("input",{placeholder:"Designation",...l("designation"),className:"form-input"}),i.jsx("input",{placeholder:"Department",...l("department"),className:"form-input"}),i.jsx("input",{placeholder:"Reporting Manager",...l("reportingManager"),className:"form-input"}),i.jsx(we,{name:"joiningDate",control:h,render:({field:P})=>i.jsx("input",{type:"date",...P,className:"form-input"})}),d.joiningDate&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.joiningDate.message}),i.jsxs("select",{...l("workType"),className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"Select Work Type"}),i.jsx("option",{children:"Full-time"}),i.jsx("option",{children:"Part-time"}),i.jsx("option",{children:"Contract"})]}),d.workType&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.workType.message})]})}):i.jsxs("form",{onSubmit:c(T),id:"organization-form",children:[i.jsx(Pr,{title:"Organization Details",subtitle:"Your employment details within the organization."}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsxs(Ke,{label:"Organization / Client",id:"organizationId",error:d.organizationId?.message,registration:l("organizationId"),disabled:j,children:[i.jsx("option",{value:"",children:"Select Organization"}),s.map(P=>i.jsx("option",{value:P.id,children:P.shortName},P.id))]}),i.jsx(je,{label:"Designation",id:"designation",error:d.designation?.message,registration:l("designation")}),i.jsx(je,{label:"Department",id:"department",error:d.department?.message,registration:l("department")}),i.jsx(je,{label:"Reporting Manager",id:"reportingManager",error:d.reportingManager?.message,registration:l("reportingManager")}),i.jsx(we,{name:"joiningDate",control:h,render:({field:P})=>i.jsx(kn,{label:"Joining Date",id:"joiningDate",error:d.joiningDate?.message,value:P.value,onChange:P.onChange})}),i.jsxs(Ke,{label:"Work Type",id:"workType",error:d.workType?.message,registration:l("workType"),children:[i.jsx("option",{value:"",children:"Select Work Type"}),i.jsx("option",{children:"Full-time"}),i.jsx("option",{children:"Part-time"}),i.jsx("option",{children:"Contract"})]})]})]})},aue=()=>{const{onValidated:n,setToast:e}=yi(),{data:t,updateFamily:r}=$n(),{rulesByDesignation:s}=Kc(),a=Ft("(max-width: 767px)"),o=t.organization.designation,l=D.useMemo(()=>{const $=o&&s[o];return $?$.documents.familyAadhaar:!1},[o,s]),c=Pt({id:ge().required(),relation:ge().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),name:ge().required("Name is required"),dob:ge().required("Date of birth is required"),gender:ge().oneOf(["Male","Female","Other",""]).required("Gender is required"),occupation:ge().optional(),dependent:ss().required(),phone:ge().when("relation",{is:"Child",then:$=>$.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:$=>$.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:Wt().nullable().when([],{is:()=>l,then:$=>$.test("is-required","Aadhaar proof is required for this designation.",se=>se!=null).nullable(),otherwise:$=>$.optional().nullable()})}),d=Pt({family:_s().of(c).required()}),{control:h,handleSubmit:p,formState:{errors:x},watch:v,setValue:_}=tn({resolver:Dn(d),defaultValues:{family:t.family}}),{fields:w,append:j,remove:T}=ws({control:h,name:"family"}),[P,E]=D.useState(!1),[M,O]=D.useState(null);D.useEffect(()=>{let $;const se=v(Y=>{clearTimeout($),$=window.setTimeout(()=>{r(Y.family)},500)});return()=>{se.unsubscribe(),clearTimeout($)}},[v,r]);const I=$=>se=>{let Y=!1;if(se.name){const ae=se.name.toLowerCase().replace(/\b(\w)/g,J=>J.toUpperCase());_(`family.${$}.name`,ae,{shouldValidate:!0}),Y=!0}if(se.dob)try{const ae=se.dob.replace(/[/.]/g,"-"),J=["dd-MM-yyyy","yyyy-MM-dd","MM-dd-yyyy","d-M-yyyy"];let ee=null;for(const X of J){const Z=S$(ae,X,new Date);if(!isNaN(Z.getTime())){ee=Z;break}}if(ee){const X=$e(ee,"yyyy-MM-dd");_(`family.${$}.dob`,X,{shouldValidate:!0}),Y=!0}}catch{console.error("Could not parse date from OCR:",se.dob)}if(se.gender){const ae=se.gender.toLowerCase().trim();ae.includes("male")||ae.includes("purush")||ae==="m"?(_(`family.${$}.gender`,"Male",{shouldValidate:!0}),Y=!0):(ae.includes("female")||ae.includes("mahila")||ae==="f")&&(_(`family.${$}.gender`,"Female",{shouldValidate:!0}),Y=!0)}Y&&e({message:"Family member details auto-filled.",type:"success"})},q={type:et.OBJECT,properties:{name:{type:et.STRING},dob:{type:et.STRING},gender:{type:et.STRING}}},F=()=>{j({id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""})},B=$=>{O($),E(!0)},U=()=>{M!==null&&(T(M),E(!1),O(null))},W=async $=>{r($.family),await n()};return a?i.jsxs("form",{onSubmit:p(W),id:"family-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List your immediate family members."}),i.jsx("div",{className:"space-y-4",children:w.map(($,se)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[i.jsx("button",{type:"button",onClick:()=>B(se),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove family member",children:i.jsx(rn,{className:"h-5 w-5"})}),i.jsx(we,{name:`family.${se}.relation`,control:h,render:({field:Y})=>i.jsxs("select",{...Y,className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"Select Relation"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})]})}),i.jsx(we,{name:`family.${se}.name`,control:h,render:({field:Y})=>i.jsx("input",{placeholder:"Full Name",...Y,className:"form-input"})}),i.jsx(we,{name:`family.${se}.dob`,control:h,render:({field:Y})=>i.jsx("input",{type:"date",placeholder:"Date of Birth",...Y,className:"form-input"})}),i.jsx(we,{name:`family.${se}.phone`,control:h,render:({field:Y})=>i.jsx("input",{placeholder:"Phone Number",type:"tel",...Y,className:"form-input"})})]},$.id))}),i.jsxs(re,{type:"button",onClick:F,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]}):i.jsxs("form",{onSubmit:p(W),id:"family-form",children:[i.jsx(Hr,{isOpen:P,onClose:()=>E(!1),onConfirm:U,title:"Confirm Deletion",children:"Are you sure you want to remove this family member? This action cannot be undone."}),i.jsx(Pr,{title:"Family Details",subtitle:"List your immediate family members."}),i.jsx("div",{className:"space-y-6",children:w.map(($,se)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[i.jsx("button",{type:"button",onClick:()=>B(se),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${$.name}`,children:i.jsx(rn,{className:"h-4 w-4"})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[i.jsx(we,{name:`family.${se}.relation`,control:h,render:({field:Y})=>i.jsxs(Ke,{label:"Relation",id:Y.name,error:x.family?.[se]?.relation?.message,...Y,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})]})}),i.jsx(we,{name:`family.${se}.name`,control:h,render:({field:Y})=>i.jsx(je,{label:"Full Name",id:Y.name,error:x.family?.[se]?.name?.message,...Y})}),i.jsx(we,{name:`family.${se}.dob`,control:h,render:({field:Y})=>i.jsx(kn,{label:"Date of Birth",id:Y.name,value:Y.value,onChange:Y.onChange,error:x.family?.[se]?.dob?.message,maxDate:new Date})}),i.jsx(we,{name:`family.${se}.gender`,control:h,render:({field:Y})=>i.jsxs(Ke,{label:"Gender",id:Y.name,error:x.family?.[se]?.gender?.message,...Y,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Male"}),i.jsx("option",{children:"Female"}),i.jsx("option",{children:"Other"})]})}),i.jsx(we,{name:`family.${se}.phone`,control:h,render:({field:Y})=>i.jsx(je,{label:"Phone Number",id:Y.name,type:"tel",error:x.family?.[se]?.phone?.message,...Y,value:Y.value??""})}),i.jsx(we,{name:`family.${se}.occupation`,control:h,render:({field:Y})=>i.jsx(je,{label:"Occupation (Optional)",id:Y.name,...Y,value:Y.value??""})}),i.jsx("div",{className:"col-span-full md:col-span-1 flex items-center pt-5",children:i.jsx(we,{name:`family.${se}.dependent`,control:h,render:({field:Y})=>i.jsx(Pn,{id:Y.name,label:"Is a dependent?",checked:Y.value,onChange:Y.onChange})})}),i.jsx("div",{className:"col-span-full",children:i.jsx(we,{name:`family.${se}.idProof`,control:h,render:({field:Y,fieldState:ae})=>i.jsx(yt,{label:`Aadhaar Proof ${l?"(Mandatory)":"(Optional)"}`,file:Y.value,onFileChange:Y.onChange,onOcrComplete:I(se),ocrSchema:q,setToast:e,error:ae.error?.message,docType:"Aadhaar"})})})]})]},$.id))}),i.jsxs(re,{type:"button",onClick:F,variant:"outline",className:"mt-6",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})},oue=()=>{const{onValidated:n,setToast:e}=yi(),{user:t}=jt(),{data:r,updateEducation:s,updateEducationRecord:a}=$n(),o=Ft("(max-width: 767px)"),l=D.useMemo(()=>/manager|admin|head/i.test(r.organization.designation),[r.organization.designation]),c=D.useMemo(()=>Pt({id:ge().required(),degree:ge().required("Degree is required"),institution:ge().required("Institution is required"),startYear:ge().required("Start year is required").matches(/^\d{4}$/,"Must be a 4-digit year"),endYear:ge().required("End year is required").matches(/^\d{4}$/,"Must be a 4-digit year").test("is-after-start-year","End year must be on or after start year",function(se){const{startYear:Y}=this.parent;return!Y||!se||parseInt(se)>=parseInt(Y)}),percentage:is().nullable().min(0).max(100).optional(),grade:ge().optional(),document:Wt().nullable().when([],{is:()=>l,then:se=>se.required("Certificate is mandatory for this role.").nullable(),otherwise:se=>se.optional().nullable()})}).defined(),[l]),d=Pt({education:_s().of(c).required()}),{control:h,handleSubmit:p,formState:{errors:x},setValue:v,reset:_,watch:w}=tn({resolver:Dn(d),context:{isAdminOrManager:l},mode:"onBlur"}),{fields:j,append:T,remove:P}=ws({control:h,name:"education"}),[E,M]=D.useState(!1),[O,I]=D.useState(null);D.useEffect(()=>{_({education:r.education})},[r.education,_]),D.useEffect(()=>{let se;const Y=w(ae=>{clearTimeout(se),se=window.setTimeout(()=>{s(ae.education)},500)});return()=>{Y.unsubscribe(),clearTimeout(se)}},[w,s]);const q=()=>{T({id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""})},F=se=>{I(se),M(!0)},B=()=>{O!==null&&(P(O),M(!1),I(null))},U=async se=>{s(se.education),await n()},W=se=>Y=>{const ae=j[se].id,J={};if(Y.degree&&(v(`education.${se}.degree`,Y.degree,{shouldValidate:!0}),J.degree=Y.degree),Y.institution&&(v(`education.${se}.institution`,Y.institution,{shouldValidate:!0}),J.institution=Y.institution),Y.endYear){const ee=Y.endYear.toString();v(`education.${se}.endYear`,ee,{shouldValidate:!0}),J.endYear=ee}Object.keys(J).length>0&&(a(ae,J),e({message:"Education details auto-filled.",type:"success"}))},$={type:et.OBJECT,properties:{degree:{type:et.STRING,description:"The name of the degree, diploma, or certificate."},institution:{type:et.STRING,description:"The name of the university, college, or institution."},endYear:{type:et.STRING,description:"The year of completion or graduation as a 4-digit number."}},required:["degree","institution","endYear"]};return o?i.jsxs("form",{onSubmit:p(U),id:"education-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List educational qualifications, starting with the most recent."}),i.jsx("div",{className:"space-y-4",children:j.map((se,Y)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[i.jsx("button",{type:"button",onClick:()=>F(Y),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove qualification",children:i.jsx(rn,{className:"h-5 w-5"})}),i.jsx(we,{name:`education.${Y}.degree`,control:h,render:({field:ae})=>i.jsx("input",{placeholder:"Degree / Certificate",...ae,className:"form-input"})}),i.jsx(we,{name:`education.${Y}.institution`,control:h,render:({field:ae})=>i.jsx("input",{placeholder:"Institution / University",...ae,className:"form-input"})}),i.jsx(we,{name:`education.${Y}.endYear`,control:h,render:({field:ae})=>i.jsx("input",{placeholder:"Year of Completion",type:"text",maxLength:4,...ae,className:"form-input"})}),i.jsx(we,{name:`education.${Y}.document`,control:h,render:({field:ae,fieldState:J})=>i.jsx(yt,{label:`Certificate ${l?"(Mandatory)":"(Optional)"}`,file:ae.value,onFileChange:ae.onChange,error:J.error?.message,allowCapture:!0})})]},se.id))}),i.jsxs(re,{type:"button",onClick:q,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]}):i.jsxs("form",{onSubmit:p(U),id:"education-form",children:[i.jsx(Hr,{isOpen:E,onClose:()=>M(!1),onConfirm:B,title:"Confirm Deletion",children:"Are you sure you want to remove this education record? This action cannot be undone."}),i.jsx(Pr,{title:"Education Details",subtitle:"List your educational qualifications, starting with the most recent."}),i.jsx("div",{className:"space-y-6",children:j.map((se,Y)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[i.jsx("button",{type:"button",onClick:()=>F(Y),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${se.degree}`,children:i.jsx(rn,{className:"h-4 w-4"})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(we,{name:`education.${Y}.degree`,control:h,render:({field:ae})=>i.jsx(je,{label:"Degree / Certificate",id:ae.name,error:x.education?.[Y]?.degree?.message,...ae})}),i.jsx(we,{name:`education.${Y}.institution`,control:h,render:({field:ae})=>i.jsx(je,{label:"Institution / University",id:ae.name,error:x.education?.[Y]?.institution?.message,...ae})}),i.jsx(we,{name:`education.${Y}.startYear`,control:h,render:({field:ae})=>i.jsx(je,{label:"Start Year",id:ae.name,type:"text",maxLength:4,error:x.education?.[Y]?.startYear?.message,...ae})}),i.jsx(we,{name:`education.${Y}.endYear`,control:h,render:({field:ae})=>i.jsx(je,{label:"End Year",id:ae.name,type:"text",maxLength:4,error:x.education?.[Y]?.endYear?.message,...ae})}),i.jsx(we,{name:`education.${Y}.percentage`,control:h,render:({field:ae})=>i.jsx(je,{label:"Percentage (Optional)",id:ae.name,type:"number",error:x.education?.[Y]?.percentage?.message,...ae,value:ae.value??""})}),i.jsx(we,{name:`education.${Y}.grade`,control:h,render:({field:ae})=>i.jsx(je,{label:"Grade (Optional)",id:ae.name,type:"text",error:x.education?.[Y]?.grade?.message,...ae,value:ae.value??""})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(we,{name:`education.${Y}.document`,control:h,render:({field:ae,fieldState:J})=>i.jsx(yt,{label:`Upload Certificate ${l?"(Mandatory)":"(Optional)"}`,file:ae.value,onFileChange:ae.onChange,onOcrComplete:W(Y),ocrSchema:$,setToast:e,error:J.error?.message})})})]})]},se.id))}),i.jsxs(re,{type:"button",onClick:q,variant:"outline",className:"mt-6",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})},HS=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",lue=ge().matches(/^[a-zA-Z\s.'-]*$/,"Name can only contain letters and spaces").transform(HS),cue=Pt({accountHolderName:lue.required("Account holder name is required"),accountNumber:ge().required("Account number is required").matches(/^[0-9]+$/,"Must be only digits"),confirmAccountNumber:ge().oneOf([MC("accountNumber")],"Account numbers must match").required("Please confirm your account number"),ifscCode:ge().required("IFSC code is required").transform(n=>n.toUpperCase()).matches(/^[A-Z]{4}0[A-Z0-9]{6}$/,"Invalid IFSC code format (e.g., SBIN0123456)"),bankName:ge().required("Bank name is required"),branchName:ge().required("Branch name is required"),bankProof:Wt().optional().nullable(),verifiedStatus:Pt().optional()}).defined(),due=()=>{const{onValidated:n,setToast:e}=yi(),{user:t}=jt(),{data:r,updateBank:s,setBankVerifiedStatus:a}=$n(),o=Ft("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:h,setValue:p,watch:x,reset:v}=tn({resolver:Dn(cue),defaultValues:r.bank});D.useEffect(()=>{v(r.bank)},[r.bank,v]),D.useEffect(()=>{let M;const O=x(I=>{clearTimeout(M),M=window.setTimeout(()=>{s(I)},500)});return()=>{O.unsubscribe(),clearTimeout(M)}},[x,s]);const _=x(),w=async M=>{s(M),await n()},j=M=>{const O=M.target.value;p("accountHolderName",HS(O),{shouldValidate:!0})},T=M=>{const O={};M.forEach(I=>{O[I]=!1}),a(O)},P=M=>{const O={},I={};if(M.accountHolderName){const q=HS(M.accountHolderName);p("accountHolderName",q,{shouldValidate:!0}),O.accountHolderName=q,I.accountHolderName=!0}if(M.accountNumber){const q=M.accountNumber.replace(/\D/g,"");p("accountNumber",q,{shouldValidate:!0}),p("confirmAccountNumber",q,{shouldValidate:!0}),O.accountNumber=q,O.confirmAccountNumber=q,I.accountNumber=!0}if(M.ifscCode){const q=M.ifscCode.toUpperCase().replace(/\s/g,"");p("ifscCode",q,{shouldValidate:!0}),O.ifscCode=q,I.ifscCode=!0}M.bankName&&(p("bankName",M.bankName,{shouldValidate:!0}),O.bankName=M.bankName),M.branchName&&(p("branchName",M.branchName,{shouldValidate:!0}),O.branchName=M.branchName),Object.keys(O).length>0&&s(O),a(I),e({message:"Bank details extracted. Please review.",type:"success"})},E={type:et.OBJECT,properties:{accountHolderName:{type:et.STRING,description:"The account holder's full name."},accountNumber:{type:et.STRING,description:"The full bank account number."},ifscCode:{type:et.STRING,description:"The bank's IFSC code."},bankName:{type:et.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:et.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}},required:["accountHolderName","accountNumber","ifscCode","bankName","branchName"]};return o?i.jsxs("form",{onSubmit:c(w),id:"bank-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Your salary will be credited to this account."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("input",{placeholder:"Account Holder Name",...l("accountHolderName"),onBlur:j,className:"form-input"}),i.jsx("input",{placeholder:"Bank Name",...l("bankName"),className:"form-input"}),i.jsx("input",{placeholder:"Account Number",...l("accountNumber"),className:"form-input"}),i.jsx("input",{placeholder:"Confirm Account Number",...l("confirmAccountNumber"),className:"form-input"}),i.jsx("input",{placeholder:"IFSC Code",...l("ifscCode"),className:"form-input"}),i.jsx("input",{placeholder:"Branch Name",...l("branchName"),className:"form-input"}),i.jsx(we,{name:"bankProof",control:h,render:({field:M})=>i.jsx(yt,{label:"Upload Bank Proof (Optional)",file:M.value,onFileChange:M.onChange,allowCapture:!0})})]})]}):i.jsxs("form",{onSubmit:c(w),id:"bank-form",children:[i.jsx(Pr,{title:"Bank Details",subtitle:"Your salary will be credited to this account."}),i.jsxs("div",{className:"space-y-6",children:[i.jsx(we,{name:"bankProof",control:h,render:({field:M})=>i.jsx(yt,{label:"Upload Bank Proof (Cancelled Cheque/Passbook)",file:M.value,onFileChange:M.onChange,onOcrComplete:P,ocrSchema:E,setToast:e})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 pt-6 border-t",children:[i.jsx(yr,{label:"Account Holder Name",id:"accountHolderName",hasValue:!!_.accountHolderName,isVerified:r.bank.verifiedStatus?.accountHolderName===!0,onManualInput:()=>T(["accountHolderName"]),error:d.accountHolderName?.message,registration:l("accountHolderName"),onBlur:j}),i.jsx(yr,{label:"Bank Name",id:"bankName",hasValue:!!_.bankName,isVerified:!1,error:d.bankName?.message,registration:l("bankName")}),i.jsx(yr,{label:"Account Number",id:"accountNumber",hasValue:!!_.accountNumber,isVerified:r.bank.verifiedStatus?.accountNumber===!0,onManualInput:()=>T(["accountNumber"]),error:d.accountNumber?.message,registration:l("accountNumber")}),i.jsx(yr,{label:"Confirm Account Number",id:"confirmAccountNumber",hasValue:!!_.confirmAccountNumber,isVerified:r.bank.verifiedStatus?.accountNumber===!0,onManualInput:()=>T(["accountNumber"]),error:d.confirmAccountNumber?.message,registration:l("confirmAccountNumber")}),i.jsx(yr,{label:"IFSC Code",id:"ifscCode",hasValue:!!_.ifscCode,isVerified:r.bank.verifiedStatus?.ifscCode===!0,onManualInput:()=>T(["ifscCode"]),error:d.ifscCode?.message,registration:l("ifscCode")}),i.jsx(yr,{label:"Branch Name",id:"branchName",hasValue:!!_.branchName,isVerified:!1,error:d.branchName?.message,registration:l("branchName")})]})]})]})},uue=Pt({hasPreviousPf:ss().required(),uanNumber:ge().when("hasPreviousPf",{is:!0,then:n=>n.required("UAN Number is required").matches(/^[0-9]{12}$/,"UAN must be 12 digits"),otherwise:n=>n.optional().nullable()}),pfNumber:ge().when("hasPreviousPf",{is:!0,then:n=>n.optional().nullable(),otherwise:n=>n.optional().nullable()}),document:Wt().optional().nullable(),salarySlip:Wt().optional().nullable(),verifiedStatus:Pt().optional()}).defined(),fue=()=>{const{onValidated:n,setToast:e}=yi(),{user:t}=jt(),{data:r,updateUan:s,setUanVerifiedStatus:a}=$n(),o=Ft("(max-width: 767px)"),{register:l,control:c,handleSubmit:d,formState:{errors:h},setValue:p,watch:x,reset:v}=tn({resolver:Dn(uue),defaultValues:r.uan});D.useEffect(()=>{v(r.uan)},[r.uan,v]),D.useEffect(()=>{let M;const O=x(I=>{clearTimeout(M),M=window.setTimeout(()=>{s(I)},500)});return()=>{O.unsubscribe(),clearTimeout(M)}},[x,s]);const _=x("hasPreviousPf"),w=x(),j=async M=>{s(M),await n()},T=()=>{a({uanNumber:!1})},P=M=>{if(M.uanNumber){const O=M.uanNumber.replace(/\D/g,"");if(O.length===12){const I={uanNumber:O,hasPreviousPf:!0};p("uanNumber",O,{shouldValidate:!0}),p("hasPreviousPf",!0,{shouldValidate:!0}),s(I),a({uanNumber:!0}),e({message:"UAN extracted successfully.",type:"success"})}}},E={type:et.OBJECT,properties:{uanNumber:{type:et.STRING,description:"The 12-digit Universal Account Number (UAN)."}},required:["uanNumber"]};return o?i.jsxs("form",{onSubmit:d(j),id:"uan-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Universal Account Number if you have one."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",...l("hasPreviousPf"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"Do you have a previous PF account or UAN?"})]}),_&&i.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[i.jsx("input",{placeholder:"UAN Number",...l("uanNumber"),className:"form-input"}),i.jsx("input",{placeholder:"PF Number (Optional)",...l("pfNumber"),className:"form-input"}),i.jsx(we,{name:"document",control:c,render:({field:M})=>i.jsx(yt,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,allowCapture:!0,costingItemName:"EPF UAN Lookup"})})]})]})]}):i.jsxs("form",{onSubmit:d(j),id:"uan-form",children:[i.jsx(Pr,{title:"UAN / PF Details",subtitle:"Provide your Universal Account Number if you have one."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"hasPreviousPf",type:"checkbox",...l("hasPreviousPf"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),i.jsx("label",{htmlFor:"hasPreviousPf",className:"ml-2 block text-sm text-muted",children:"Do you have a previous PF account or UAN?"})]}),r.uan.salarySlip&&i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-2",children:"Reference Salary Slip"}),i.jsx(yt,{label:"",file:r.uan.salarySlip,onFileChange:()=>{}})]}),_&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx(yr,{label:"UAN Number",id:"uanNumber",hasValue:!!w.uanNumber,isVerified:r.uan.verifiedStatus?.uanNumber===!0,onManualInput:T,registration:l("uanNumber"),error:h.uanNumber?.message}),i.jsx(je,{label:"PF Number (Optional)",id:"pfNumber",registration:l("pfNumber"),error:h.pfNumber?.message})]}),i.jsx(we,{name:"document",control:c,render:({field:M})=>i.jsx(yt,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,onOcrComplete:P,ocrSchema:E,setToast:e,costingItemName:"EPF UAN Lookup"})})]})]})]})},hue=Pt({hasEsi:ss().required(),esiNumber:ge().when("hasEsi",{is:!0,then:n=>n.required("ESI Number is required").matches(/^(\d{10}|\d{17})$/,"ESI number must be 10 or 17 digits"),otherwise:n=>n.optional().nullable()}),esiRegistrationDate:ge().when("hasEsi",{is:!0,then:n=>n.required("Registration date is required").test("not-in-future","Registration date cannot be in the future",e=>e?new Date(e.replace(/-/g,"/"))<=new Date:!0),otherwise:n=>n.optional().nullable()}),esicBranch:ge().when("hasEsi",{is:!0,then:n=>n.required("ESIC Branch is required"),otherwise:n=>n.optional().nullable()}),document:Wt().optional().nullable(),verifiedStatus:Pt().optional()}),mue=()=>{const{onValidated:n,setToast:e}=yi(),{user:t}=jt(),{data:r,updateEsi:s,setEsiVerifiedStatus:a}=$n(),{esiCtcThreshold:o,enableEsiRule:l}=Kc(),c=Ft("(max-width: 767px)"),{register:d,control:h,handleSubmit:p,formState:{errors:x},reset:v,setValue:_,watch:w}=tn({resolver:Dn(hue),defaultValues:r.esi}),j=w("hasEsi"),T=w(),P=r.personal.salary!=null&&r.personal.salary<=o;D.useEffect(()=>{v(r.esi)},[r.esi,v]),D.useEffect(()=>{let q;const F=w(B=>{clearTimeout(q),q=window.setTimeout(()=>{s(B)},500)});return()=>{F.unsubscribe(),clearTimeout(q)}},[w,s]),D.useEffect(()=>{P||r.esi.hasEsi&&s({hasEsi:!1,esiNumber:"",esiRegistrationDate:"",esicBranch:""})},[P,r.esi.hasEsi,s]);const E=async q=>{s(q),await n()},M=()=>{a({esiNumber:!1})},O=q=>{if(q.esiNumber){const F=q.esiNumber.replace(/\D/g,"");if(F.length===10||F.length===17){const B={esiNumber:F,hasEsi:!0};_("esiNumber",F,{shouldValidate:!0}),_("hasEsi",!0,{shouldValidate:!0}),s(B),a({esiNumber:!0}),e({message:"ESI Number extracted successfully.",type:"success"})}}},I={type:et.OBJECT,properties:{esiNumber:{type:et.STRING,description:"The 10 or 17-digit ESI number."}},required:["esiNumber"]};if(c){if(!l||!P){const q=l?`Employee is not eligible for ESI as their gross salary is above the ${o.toLocaleString()} threshold.`:"ESI enrollment is currently disabled by company policy. This step is not applicable.";return i.jsx("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"esi-form",children:i.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-900/40 rounded-lg border border-blue-500/50",children:[i.jsx(ru,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),i.jsx("p",{className:"text-sm text-blue-300",children:q})]})})}return i.jsxs("form",{onSubmit:p(E),id:"esi-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Employee's State Insurance number if applicable."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",...d("hasEsi"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"Are you covered under ESI?"})]}),j&&i.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[i.jsx("input",{placeholder:"ESI Number",...d("esiNumber"),className:"form-input"}),i.jsx("input",{type:"date",...d("esiRegistrationDate"),className:"form-input"}),i.jsx("input",{placeholder:"ESIC Branch",...d("esicBranch"),className:"form-input"}),i.jsx(we,{name:"document",control:h,render:({field:q})=>i.jsx(yt,{label:"Upload ESI Card",file:q.value,onFileChange:q.onChange,allowCapture:!0,costingItemName:"ESI Card OCR"})})]})]})]})}return l?P?i.jsxs("form",{onSubmit:p(E),id:"esi-form",children:[i.jsx(Pr,{title:"ESI Details",subtitle:"Provide your Employee's State Insurance number if applicable."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"hasEsi",type:"checkbox",...d("hasEsi"),className:"h-4 w-4 text-accent"}),i.jsx("label",{htmlFor:"hasEsi",className:"ml-2 block text-sm text-muted",children:"Are you covered under ESI?"})]}),j&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx(yr,{label:"ESI Number",id:"esiNumber",hasValue:!!T.esiNumber,isVerified:r.esi.verifiedStatus?.esiNumber===!0,onManualInput:M,registration:d("esiNumber"),error:x.esiNumber?.message}),i.jsx(we,{name:"esiRegistrationDate",control:h,render:({field:q})=>i.jsx(kn,{label:"ESI Registration Date",id:"esiRegistrationDate",error:x.esiRegistrationDate?.message,value:q.value,onChange:q.onChange,maxDate:new Date})}),i.jsx(je,{label:"ESIC Branch",id:"esicBranch",registration:d("esicBranch"),error:x.esicBranch?.message})]}),i.jsx(we,{name:"document",control:h,render:({field:q})=>i.jsx(yt,{label:"Upload ESI Card",file:q.value,onFileChange:q.onChange,onOcrComplete:O,ocrSchema:I,setToast:e,costingItemName:"ESI Card OCR"})})]})]})]}):i.jsxs("form",{onSubmit:async q=>{q.preventDefault(),await n()},id:"esi-form",children:[i.jsx(Pr,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),i.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[i.jsx(ru,{className:"h-5 w-5 text-blue-500 mr-3"}),i.jsxs("p",{className:"text-sm text-blue-700",children:["Employee is not eligible for ESI as their gross salary is above the $",o.toLocaleString()," threshold."]})]})]}):i.jsxs("form",{onSubmit:async q=>{q.preventDefault(),await n()},id:"esi-form",children:[i.jsx(Pr,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),i.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[i.jsx(ru,{className:"h-5 w-5 text-blue-500 mr-3"}),i.jsx("p",{className:"text-sm text-blue-700",children:"ESI enrollment is currently disabled by company policy. This step is not applicable."})]})]})},pue=Pt({isOptedIn:ss().nullable().required("Please choose whether you want to avail Group Medical Cover."),selectedSpouseId:ge().optional(),selectedChildIds:_s().of(ge().required()).optional(),gmcPolicyCopy:Wt().when("isOptedIn",{is:!1,then:n=>n.required("Please upload GMC policy copy (PNG, JPG, PDF up to 5MB)."),otherwise:n=>n.optional().nullable()}),declarationAccepted:ss().when("isOptedIn",{is:!1,then:n=>n.oneOf([!0],"Please accept the declaration to proceed."),otherwise:n=>n.optional()}),policyAmount:ge().optional().nullable(),nomineeName:ge().optional().nullable(),nomineeRelation:ge().optional().nullable(),wantsToAddDependents:ss().optional().nullable(),optOutReason:ge().optional().nullable(),alternateInsuranceProvider:ge().optional().nullable(),alternateInsuranceStartDate:ge().optional().nullable(),alternateInsuranceEndDate:ge().optional().nullable(),alternateInsuranceCoverage:ge().optional().nullable()}).defined(),gue=()=>{const{onValidated:n}=yi(),{user:e}=jt(),{data:t,updateGmc:r}=$n(),s=Ft("(max-width: 767px)"),{control:a,handleSubmit:o,formState:{errors:l},watch:c,reset:d,setValue:h,getValues:p}=tn({resolver:Dn(pue),defaultValues:t.gmc}),x=c("isOptedIn"),v=c("selectedSpouseId"),_=c("selectedChildIds")||[],w=D.useMemo(()=>t.family.find(M=>M.relation==="Spouse"),[t.family]),j=D.useMemo(()=>t.family.filter(M=>M.relation==="Child"),[t.family]),T=D.useMemo(()=>{const M=[];return w&&M.push(w),M.push(...j),M},[w,j]);D.useEffect(()=>{if(t.gmc.isOptedIn===!0){const M=!t.gmc.selectedSpouseId&&(!t.gmc.selectedChildIds||t.gmc.selectedChildIds.length===0),O=w||j.length>0;M&&O&&(h("selectedSpouseId",w?.id||"",{shouldDirty:!0}),h("selectedChildIds",j.map(I=>I.id),{shouldDirty:!0}))}},[t.gmc.isOptedIn,w,j,h,t.gmc.selectedSpouseId,t.gmc.selectedChildIds]),D.useEffect(()=>{d(t.gmc)},[t.gmc,d]),D.useEffect(()=>{let M;const O=c(I=>{clearTimeout(M),M=window.setTimeout(()=>{r(I)},500)});return()=>{O.unsubscribe(),clearTimeout(M)}},[c,r]);const P=async M=>{const O={...M};M.isOptedIn?(O.gmcPolicyCopy=null,O.declarationAccepted=!1):(O.selectedSpouseId="",O.selectedChildIds=[]),r(O),await n()},E=(M,O)=>{if(M.relation==="Spouse")h("selectedSpouseId",O?M.id:"",{shouldDirty:!0});else{const I=p("selectedChildIds")||[],q=O?[...I,M.id]:I.filter(F=>F!==M.id);h("selectedChildIds",q,{shouldDirty:!0})}};return s?i.jsxs("form",{onSubmit:o(P),id:"gmc-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please choose whether to enroll in the company's insurance plan."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-md font-semibold",children:"Would you like to Avail Group Medical Cover?"}),i.jsx(we,{name:"isOptedIn",control:a,render:({field:M})=>i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!0?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!0),checked:M.value===!0,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!1?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!1),checked:M.value===!1,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),x===!0&&i.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[i.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Select Dependents"}),T.map(M=>{const O=M.relation==="Spouse"?v===M.id:_.includes(M.id);return i.jsx(Pn,{id:`dep-mob-${M.id}`,label:`${M.name} (${M.relation})`,checked:O,onChange:I=>E(M,I)},M.id)})]}),x===!1&&i.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[i.jsx(we,{name:"gmcPolicyCopy",control:a,render:({field:M,fieldState:O})=>i.jsx(yt,{label:"Upload GMC Policy Copy",file:M.value,onFileChange:M.onChange,error:O.error?.message,allowCapture:!0})}),i.jsx(we,{name:"declarationAccepted",control:a,render:({field:M,fieldState:O})=>i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",checked:M.value??!1,onChange:M.onChange,className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"I declare I will not avail company GMC and the uploaded policy is valid."})]})})]})]})]}):i.jsxs("form",{onSubmit:o(P),id:"gmc-form",children:[i.jsx(Pr,{title:"Group Medical Cover (GMC)",subtitle:"Please choose whether to enroll in the company's insurance plan."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Would you like to Avail Group Medical Cover?"}),i.jsx(we,{name:"isOptedIn",control:a,render:({field:M})=>i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!0?"border-accent bg-accent-light":"border-border"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!0),checked:M.value===!0,className:"h-4 w-4 text-accent focus:ring-accent"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!1?"border-accent bg-accent-light":"border-border"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!1),checked:M.value===!1,className:"h-4 w-4 text-accent focus:ring-accent"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),l.isOptedIn&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:l.isOptedIn.message})]}),x===!0&&i.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[i.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Select Dependents for Policy"}),i.jsx("p",{className:"text-sm text-muted -mt-2 mb-2",children:"Spouse and children are included by default. Uncheck any dependents you do not want to include."}),i.jsx("div",{className:"space-y-2 p-4 border rounded-lg bg-page",children:T.length>0?T.map(M=>{const O=M.relation==="Spouse"?v===M.id:_.includes(M.id);return i.jsx(Pn,{id:`dep-${M.id}`,label:`${M.name} (${M.relation})`,checked:O,onChange:I=>E(M,I)},M.id)}):i.jsx("p",{className:"text-sm text-muted",children:'No spouse or children added. Please add them in the "Family Details" section to include them in the policy.'})})]}),x===!1&&i.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[i.jsx(we,{name:"gmcPolicyCopy",control:a,render:({field:M,fieldState:O})=>i.jsx(yt,{label:"Upload GMC Policy Copy",file:M.value,onFileChange:M.onChange,allowedTypes:["image/png","image/jpeg","application/pdf"],error:O.error?.message})}),i.jsx(we,{name:"declarationAccepted",control:a,render:({field:M,fieldState:O})=>i.jsxs("div",{className:"space-y-1",children:[i.jsx(Pn,{id:"declarationAccepted",label:"I declare that I will not avail company GMC and the uploaded policy is valid.",checked:M.value??!1,onChange:M.onChange}),O.error&&i.jsx("p",{className:"text-xs text-red-600",children:O.error.message})]})})]})]})]})},xue=()=>{const{onValidated:n,setToast:e}=yi(),{user:t}=jt(),r=St(),{data:s,updateUniforms:a}=$n(),o=Ft("(max-width: 767px)"),[l,c]=D.useState(!0),[d,h]=D.useState(null),{gender:p}=s.personal,{organizationId:x,department:v,designation:_}=s.organization,{control:w,handleSubmit:j,reset:T,watch:P}=tn(),{fields:E,replace:M}=ws({control:w,name:"uniforms"});D.useEffect(()=>{(async()=>{c(!0);try{const[B,U,W]=await Promise.all([ue.getAllSiteUniformDetails(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);h({details:B,gents:U,ladies:W})}catch{e({message:"Failed to load uniform configuration.",type:"error"})}finally{c(!1)}})()},[e]);const O=D.useMemo(()=>{if(!d||!x||!v||!_)return[];const F=d.details[x];if(!F)return[];const B=F.departments.find(W=>W.department===v);return B?B.designations.find(W=>W.designation===_)?.items||[]:[]},[d,x,v,_]);D.useEffect(()=>{const F=O.map(B=>{const U=s.uniforms.find($=>$.itemId===B.id),W=B.name.toLowerCase().includes("pant")?"Pants":"Shirts";return{itemId:B.id,itemName:B.name,category:W,sizeId:U?.sizeId||"",quantity:U?.quantity||1}});M(F)},[O,s.uniforms,M]),D.useEffect(()=>{let F;const B=P(U=>{clearTimeout(F),F=window.setTimeout(()=>{const W=U,$=p==="Female"?[...d?.ladies.pants||[],...d?.ladies.shirts||[]]:[...d?.gents.pants||[],...d?.gents.shirts||[]],se=(W.uniforms||[]).filter(Y=>Y.sizeId&&Y.quantity>0).map(Y=>{const ae=$.find(J=>J.id===Y.sizeId);return{itemId:Y.itemId,itemName:Y.itemName,sizeId:Y.sizeId,sizeLabel:ae?.size||"",fit:ae?.fit||"",quantity:Y.quantity}});a(se)},500)});return()=>{B.unsubscribe(),clearTimeout(F)}},[P,a,p,d]);const I=async F=>{const B=p==="Female"?[...d?.ladies.pants||[],...d?.ladies.shirts||[]]:[...d?.gents.pants||[],...d?.gents.shirts||[]],U=F.uniforms.filter(W=>W.sizeId&&W.quantity>0).map(W=>{const $=B.find(se=>se.id===W.sizeId);return{itemId:W.itemId,itemName:W.itemName,sizeId:W.sizeId,sizeLabel:$?.size||"",fit:$?.fit||"",quantity:W.quantity}});a(U),await n()};if(l)return i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(wt,{className:"h-8 w-8 animate-spin text-accent"})});if(O.length===0&&s.uniforms.length>0)return i.jsxs("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"uniform-form",children:[!o&&i.jsx(Pr,{title:"Uniform Details",subtitle:"The following items have been selected for this employee."}),i.jsxs("div",{className:"space-y-4",children:[s.uniforms.map(F=>i.jsx("div",{className:`p-4 border rounded-lg flex justify-between items-center ${o?"bg-[#243524] border-border":"bg-page"}`,children:i.jsxs("div",{children:[i.jsx("p",{className:`font-semibold ${o?"text-white":"text-primary-text"}`,children:F.itemName}),i.jsxs("p",{className:`text-sm ${o?"text-gray-400":"text-muted"}`,children:["Size: ",F.sizeLabel,", Fit: ",F.fit,", Quantity: ",F.quantity]})]})},F.itemId+F.sizeId)),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>r("/onboarding/uniforms?from=onboarding"),children:[i.jsx(cr,{className:"mr-2 h-4 w-4"}),"Edit Uniform Selection"]})]})]});if(!p||O.length===0){const F=p?"No uniform requirements found for the selected site, department, and designation.":"Please select a gender in 'Personal Details' to view uniform options.",B=p&&O.length===0;return i.jsxs("form",{onSubmit:async U=>{U.preventDefault(),await n()},id:"uniform-form",children:[!o&&i.jsx(Pr,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),i.jsxs("div",{className:`text-center p-8 rounded-lg ${o?"":"bg-page"}`,children:[i.jsx(Pf,{className:`h-12 w-12 mx-auto ${o?"text-gray-500":"text-muted"}`}),i.jsx("p",{className:`mt-4 ${o?"text-gray-400":"text-muted"}`,children:F}),B&&i.jsxs("div",{className:"mt-6",children:[i.jsx("p",{className:`text-sm mb-4 ${o?"text-gray-500":"text-muted"}`,children:"You can proceed to the next step, or create a new site-level request if uniforms are needed."}),i.jsxs(re,{type:"button",onClick:()=>r("/onboarding/uniforms?from=onboarding"),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"}),"Create Site Uniform Request"]})]})]})]})}const q=p==="Female"?d?.ladies:d?.gents;return o?i.jsxs("form",{onSubmit:j(I),id:"uniform-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide uniform measurements for the employee."}),i.jsx("div",{className:"space-y-4",children:E.map((F,B)=>{const U=F.category==="Pants"?q?.pants:q?.shirts;return i.jsxs("div",{className:"p-4 border border-border rounded-xl space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:F.itemName}),i.jsx(we,{name:`uniforms.${B}.sizeId`,control:w,render:({field:W})=>i.jsxs("select",{...W,className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"-- Select Size --"}),U?.map($=>i.jsxs("option",{value:$.id,children:["Size: ",$.size," - ",$.fit]},$.id))]})}),i.jsx(we,{name:`uniforms.${B}.quantity`,control:w,render:({field:W})=>i.jsx("input",{type:"number",min:"1",...W,className:"form-input"})})]},F.id)})})]}):i.jsxs("form",{onSubmit:j(I),id:"uniform-form",children:[i.jsx(Pr,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),i.jsx("div",{className:"space-y-6",children:E.map((F,B)=>{const U=F.category==="Pants"?q?.pants:q?.shirts;return i.jsxs("div",{className:"p-4 border border-border rounded-xl bg-page/50",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:F.itemName}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(we,{name:`uniforms.${B}.sizeId`,control:w,rules:{required:"Please select a size"},render:({field:W,fieldState:$})=>i.jsxs(Ke,{label:"Size & Fit",error:$.error?.message,...W,children:[i.jsx("option",{value:"",children:"-- Select Size --"}),U?.map(se=>i.jsxs("option",{value:se.id,children:["Size: ",se.size," - ",se.fit]},se.id))]})}),i.jsx(we,{name:`uniforms.${B}.quantity`,control:w,rules:{required:!0,min:1},render:({field:W})=>i.jsx(je,{label:"Quantity",type:"number",min:"1",...W})})]})]},F.id)})})]})},Ah=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",yue=()=>{const{onValidated:n,setToast:e}=yi(),{user:t}=jt(),r=St(),{data:s,updatePersonal:a,updateBank:o,addEducationRecord:l,updateFamilyMember:c,updateEducationRecord:d,updateUan:h,updateEsi:p,updateGmc:x}=$n(),v=Ft("(max-width: 767px)"),_=U=>{const W={};if(U.name){const $=U.name.split(" ");W.firstName=Ah($.shift()||""),W.lastName=Ah($.pop()||""),W.middleName=Ah($.join(" "))}if(U.dob)try{const $=new Date(U.dob);isNaN($.getTime())||(W.dob=$e($,"yyyy-MM-dd"))}catch{}U.aadhaarNumber&&(W.idProofNumber=U.aadhaarNumber.replace(/\s/g,""),W.idProofType="Aadhaar"),a(W)},w=U=>{const W={};if(U.accountHolderName&&(W.accountHolderName=Ah(U.accountHolderName)),U.accountNumber){const $=U.accountNumber.replace(/\D/g,"");W.accountNumber=$,W.confirmAccountNumber=$}U.ifscCode&&(W.ifscCode=U.ifscCode.toUpperCase().replace(/\s/g,"")),o(W)},j=U=>{const W={};U.uanNumber&&(W.uanNumber=U.uanNumber.replace(/\D/g,""),W.hasPreviousPf=!0),h(W)},T=U=>{const W={};U.esiNumber&&(W.esiNumber=U.esiNumber.replace(/\D/g,""),W.hasEsi=!0),p(W)},P=U=>W=>{const $={};if(W.name&&($.name=Ah(W.name)),W.dob)try{const se=new Date(W.dob);isNaN(se.getTime())||($.dob=$e(se,"yyyy-MM-dd"))}catch{}c(U,$)},E=U=>W=>{const $={};W.degree&&($.degree=W.degree),W.institution&&($.institution=W.institution),W.endYear&&($.endYear=W.endYear.toString()),d(U,$)},M={type:et.OBJECT,properties:{name:{type:et.STRING},dob:{type:et.STRING},aadhaarNumber:{type:et.STRING}}},O={type:et.OBJECT,properties:{accountHolderName:{type:et.STRING},accountNumber:{type:et.STRING},ifscCode:{type:et.STRING}}},I={type:et.OBJECT,properties:{uanNumber:{type:et.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:et.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:et.STRING,description:"The 10 or 17-digit ESI number."}}},q={type:et.OBJECT,properties:{uanNumber:{type:et.STRING}}},F={type:et.OBJECT,properties:{esiNumber:{type:et.STRING}}},B={type:et.OBJECT,properties:{degree:{type:et.STRING},institution:{type:et.STRING},endYear:{type:et.STRING}}};return v?i.jsxs("form",{onSubmit:async U=>{U.preventDefault(),await n()},id:"documents-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Upload supporting documents. You can also do this within each relevant section."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(yt,{label:"ID Proof (Front Side)",file:s.personal.idProofFront,onFileChange:U=>a({idProofFront:U}),onOcrComplete:_,ocrSchema:M,setToast:e,allowCapture:!0,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(yt,{label:"ID Proof (Back Side)",file:s.personal.idProofBack,onFileChange:U=>a({idProofBack:U}),onOcrComplete:_,ocrSchema:M,setToast:e,allowCapture:!0,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(yt,{label:"Profile Photo",file:s.personal.photo,onFileChange:U=>a({photo:U}),allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]}),i.jsx(yt,{label:"Bank Proof",file:s.bank.bankProof,onFileChange:U=>o({bankProof:U}),onOcrComplete:w,ocrSchema:O,setToast:e,allowCapture:!0,docType:"Bank"}),i.jsx(yt,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:s.uan.salarySlip,onFileChange:U=>h({salarySlip:U}),onOcrComplete:U=>{j(U),T(U)},ocrSchema:I,setToast:e,allowCapture:!0,docType:"Salary"}),s.uan.hasPreviousPf&&i.jsx(yt,{label:"UAN Document",file:s.uan.document,onFileChange:U=>h({document:U}),onOcrComplete:j,ocrSchema:q,setToast:e,allowCapture:!0,docType:"UAN"}),s.esi.hasEsi&&i.jsx(yt,{label:"ESI Document",file:s.esi.document,onFileChange:U=>p({document:U}),onOcrComplete:T,ocrSchema:F,setToast:e,allowCapture:!0}),s.gmc.isOptedIn===!1&&i.jsx(yt,{label:"GMC Policy Copy",file:s.gmc.gmcPolicyCopy,onFileChange:U=>x({gmcPolicyCopy:U}),allowCapture:!0}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[i.jsx("h4",{className:"form-header-title mb-4",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[s.education.map(U=>i.jsx(yt,{label:`Certificate for ${U.degree||"Qualification"}`,file:U.document,onFileChange:W=>d(U.id,{document:W}),onOcrComplete:E(U.id),ocrSchema:B,setToast:e,allowCapture:!0},U.id)),i.jsxs(re,{type:"button",onClick:()=>r("/onboarding/add/education"),variant:"secondary",className:"w-full flex items-center justify-center",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Add / Edit Qualifications"})]})]})]}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[i.jsx("h4",{className:"form-header-title mb-4",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[s.family.map(U=>i.jsx(yt,{label:`ID Proof for ${U.name||"Family Member"}`,file:U.idProof,onFileChange:W=>c(U.id,{idProof:W}),onOcrComplete:P(U.id),ocrSchema:M,setToast:e,allowCapture:!0,docType:"Aadhaar"},U.id)),s.family.length===0&&i.jsx("p",{className:"text-sm text-gray-400",children:"No family members added."}),i.jsxs(re,{type:"button",onClick:()=>r("/onboarding/add/family"),variant:"secondary",className:"w-full flex items-center justify-center",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Add/Edit on Family Page"})]})]})]})]})]}):i.jsxs("form",{onSubmit:async U=>{U.preventDefault(),await n()},id:"documents-form",children:[i.jsx(Pr,{title:"Document Collection",subtitle:"Upload supporting documents. You can also do this within each relevant section."}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("section",{children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx(yt,{label:"Employee ID Proof (Aadhaar/PAN) - Front Side",file:s.personal.idProofFront,onFileChange:U=>a({idProofFront:U}),onOcrComplete:_,ocrSchema:M,setToast:e,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(yt,{label:"Employee ID Proof (Aadhaar/PAN) - Back Side",file:s.personal.idProofBack,onFileChange:U=>a({idProofBack:U}),onOcrComplete:_,ocrSchema:M,setToast:e,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(yt,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:s.bank.bankProof,onFileChange:U=>o({bankProof:U}),onOcrComplete:w,ocrSchema:O,setToast:e,docType:"Bank"}),i.jsx(yt,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:s.uan.salarySlip,onFileChange:U=>h({salarySlip:U}),onOcrComplete:U=>{j(U),T(U)},ocrSchema:I,setToast:e,docType:"Salary"})]})}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[s.education.map(U=>i.jsx(yt,{label:`Certificate for ${U.degree||"New Qualification"}`,file:U.document,onFileChange:W=>d(U.id,{document:W}),onOcrComplete:E(U.id),ocrSchema:B,setToast:e},U.id)),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>l(),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[s.family.map(U=>i.jsx(yt,{label:`ID Proof for ${U.name||`(${U.relation})`}`,file:U.idProof,onFileChange:W=>c(U.id,{idProof:W}),onOcrComplete:P(U.id),ocrSchema:M,setToast:e,docType:"Aadhaar"},U.id)),s.family.length===0&&i.jsx("p",{className:"text-sm text-muted",children:"No family members added yet."}),i.jsxs(re,{type:"button",variant:"outline",onClick:()=>r("/onboarding/add/family"),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Go to Family Page to Add/Edit"]})]})]})]})]})},vue=Pt({signatureImage:Wt().required("A signature image is mandatory.").nullable(),fingerprints:Pt().shape({leftThumb:Wt().optional().nullable(),leftIndex:Wt().optional().nullable(),leftMiddle:Wt().optional().nullable(),leftRing:Wt().optional().nullable(),leftLittle:Wt().optional().nullable(),rightThumb:Wt().optional().nullable(),rightIndex:Wt().optional().nullable(),rightMiddle:Wt().optional().nullable(),rightRing:Wt().optional().nullable(),rightLittle:Wt().optional().nullable()})}).defined(),bue=[{hand:"Left",key:"leftThumb",name:"Thumb"},{hand:"Left",key:"leftIndex",name:"Index"},{hand:"Left",key:"leftMiddle",name:"Middle"},{hand:"Left",key:"leftRing",name:"Ring"},{hand:"Left",key:"leftLittle",name:"Little"},{hand:"Right",key:"rightThumb",name:"Thumb"},{hand:"Right",key:"rightIndex",name:"Index"},{hand:"Right",key:"rightMiddle",name:"Middle"},{hand:"Right",key:"rightRing",name:"Ring"},{hand:"Right",key:"rightLittle",name:"Little"}],_ue=()=>{const{onValidated:n}=yi(),{data:e,updateBiometrics:t}=$n(),{user:r}=jt(),s=Ft("(max-width: 767px)"),{control:a,handleSubmit:o,formState:{errors:l},reset:c,watch:d}=tn({resolver:Dn(vue),defaultValues:e.biometrics});D.useEffect(()=>{c(e.biometrics)},[e.biometrics,c]),D.useEffect(()=>{const v=d(_=>{t(_)});return()=>v.unsubscribe()},[d,t]);const h=async(v,_)=>{try{const w=await ue.verifyFingerprintImage(v,_);return w.containsFingerprints?{success:!0,reason:""}:{success:!1,reason:w.reason||"Image does not appear to contain fingerprints. Please upload a clear scan."}}catch(w){return{success:!1,reason:w.message||"AI verification failed."}}},p=async v=>{t(v),await n()},x=v=>bue.filter(_=>_.hand===v).map(_=>i.jsx(we,{name:`fingerprints.${_.key}`,control:a,render:({field:w})=>i.jsx(yt,{label:`${v} ${_.name}`,file:w.value,onFileChange:w.onChange,onVerification:h,allowCapture:!0})},_.key));return i.jsxs("form",{onSubmit:o(p),id:"biometrics-form",children:[!s&&i.jsx(Pr,{title:"Biometrics",subtitle:"Please provide fingerprint scans and a mandatory signature."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:`text-lg font-semibold text-center mb-4 ${s?"form-header-title":"text-primary-text"}`,children:["Signature ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("div",{className:"w-full",children:i.jsx(we,{name:"signatureImage",control:a,render:({field:v,fieldState:_})=>i.jsx(yt,{label:"Upload or capture a signature",file:v.value,onFileChange:v.onChange,allowCapture:!0,error:_.error?.message})})})]}),i.jsx("div",{className:s?"":"my-8 border-t border-border"}),i.jsxs("div",{children:[i.jsx("h4",{className:`text-lg font-semibold text-center mb-4 ${s?"form-header-title":"text-primary-text"}`,children:"Fingerprints (Optional)"}),i.jsx("p",{className:`text-center mb-6 ${s?"text-gray-400":"text-muted"}`,children:"Upload scans for all 10 fingerprints, one image per finger."}),i.jsxs("div",{className:"w-full grid grid-cols-2 md:grid-cols-5 gap-4",children:[x("Left"),x("Right")]})]})]})]})},Tc=({label:n,value:e})=>i.jsxs("div",{children:[i.jsx("dt",{className:"text-sm font-medium text-muted",children:n}),i.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),kc=({label:n,value:e,status:t,isVerifying:r})=>i.jsxs("div",{children:[i.jsxs("dt",{className:"text-sm font-medium text-muted flex items-center",children:[n,r&&i.jsx(wt,{className:"h-4 w-4 text-muted animate-spin ml-2"}),!r&&t===!0&&i.jsx("span",{title:"Verified from document",className:"ml-2",children:i.jsx(Hi,{className:"h-4 w-4 text-green-500"})}),!r&&t===!1&&i.jsx("span",{title:"Verification Failed",className:"ml-2",children:i.jsx(lm,{className:"h-4 w-4 text-red-500"})})]}),i.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),Ui=({label:n,value:e})=>i.jsxs("div",{className:"flex justify-between items-start py-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:n}),i.jsx("span",{className:"text-sm text-white font-medium text-right max-w-[60%]",children:e||"-"})]}),wue=()=>{const{onSubmit:n,isSubmitting:e}=yi(),{user:t}=jt(),{data:r,logVerificationUsage:s,setPersonalVerifiedStatus:a,setBankVerifiedStatus:o,setUanVerifiedStatus:l}=$n(),{perfiosApi:c}=pi(),d=St(),[h,p]=D.useState(window.innerWidth<768);D.useEffect(()=>{const O=()=>p(window.innerWidth<768);return window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[]);const x=t?.role==="field_officer"&&h,[v,_]=D.useState("idle"),[w,j]=D.useState(""),T=D.useMemo(()=>Object.entries(r.biometrics.fingerprints).filter(([,O])=>O!==null).map(([O])=>O.replace(/([A-Z])/g," $1").replace(/^./,I=>I.toUpperCase())),[r.biometrics.fingerprints]),P=async()=>{_("verifying"),j("");let O=!0;const I=[];try{s("Bank AC Verification Advanced");const q=await ue.verifyBankAccountWithPerfios({name:r.bank.accountHolderName,dob:r.personal.dob,aadhaar:r.personal.idProofNumber||null,pan:null,bank:{accountNumber:r.bank.accountNumber,ifsc:r.bank.ifscCode},uan:r.uan.uanNumber||null,esi:r.esi.esiNumber||null});if(I.push(`Bank: ${q.message}`),o({accountNumber:q.verifiedFields.accountNumber,accountHolderName:q.verifiedFields.accountHolderName}),q.success||(O=!1),r.personal.idProofType==="Aadhaar"&&r.personal.idProofNumber){s("Aadhaar Verification");const F=await ue.verifyAadhaar(r.personal.idProofNumber);I.push(`Aadhaar: ${F.message}`),a({idProofNumber:F.success}),F.success||(O=!1)}if(r.uan.hasPreviousPf&&r.uan.uanNumber){s("EPF UAN Lookup");const F=await ue.lookupUan(r.uan.uanNumber);I.push(`UAN: ${F.message}`),l({uanNumber:F.verifiedFields.uan}),F.success||(O=!1)}await ue.updateOnboarding($n.getState().data),j(I.join(`
`)),_(O?"success":"failed")}catch(q){_("failed"),j(q.message||"An unexpected error occurred during verification.")}},E=()=>{d(`/onboarding/pdf/${r.id||"draft"}`)},M=(v==="success"||!c.enabled)&&r.formsGenerated;return x?i.jsxs("form",{onSubmit:async O=>{O.preventDefault(),await n()},id:"review-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please review all your details carefully before submitting."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Personal Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Ui,{label:"Full Name",value:`${r.personal.firstName} ${r.personal.lastName}`}),i.jsx(Ui,{label:"Email",value:r.personal.email}),i.jsx(Ui,{label:"Mobile",value:r.personal.mobile}),i.jsx(Ui,{label:"Date of Birth",value:r.personal.dob})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Organization Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Ui,{label:"Site",value:r.organization.organizationName}),i.jsx(Ui,{label:"Designation",value:r.organization.designation}),i.jsx(Ui,{label:"Department",value:r.organization.department})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Bank Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Ui,{label:"Account Holder",value:r.bank.accountHolderName}),i.jsx(Ui,{label:"Account Number",value:"*".repeat(Math.max(0,r.bank.accountNumber.length-4))+r.bank.accountNumber.slice(-4)}),i.jsx(Ui,{label:"IFSC Code",value:r.bank.ifscCode})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Uniform Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Ui,{label:"Uniform Required",value:r.uniforms.length>0?"Yes":"No"}),r.uniforms.map(O=>i.jsx(Ui,{label:O.itemName,value:`${O.quantity} x Size ${O.sizeLabel} (${O.fit})`},O.itemId))]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Biometrics"}),r.biometrics.signatureImage&&i.jsxs("div",{className:"mb-4",children:[i.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Signature"}),i.jsx("img",{src:r.biometrics.signatureImage.preview,alt:"Signature",className:"h-24 bg-white border rounded-md mx-auto"})]}),T.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Fingerprints"}),i.jsx("ul",{className:"text-sm text-center text-gray-400 list-disc list-inside",children:T.map(O=>i.jsx("li",{children:O},O))})]})]})]})]}):i.jsxs("form",{onSubmit:async O=>{O.preventDefault(),await n()},id:"review-form",children:[i.jsx(Pr,{title:"Review & Submit",subtitle:"Please review all your details carefully before submitting."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Personal Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(kc,{label:"Full Name",value:`${r.personal.firstName} ${r.personal.lastName}`,status:r.personal.verifiedStatus?.name,isVerifying:!1}),i.jsx(Tc,{label:"Email",value:r.personal.email}),i.jsx(Tc,{label:"Mobile",value:r.personal.mobile}),i.jsx(kc,{label:"Date of Birth",value:r.personal.dob,status:r.personal.verifiedStatus?.dob,isVerifying:!1}),i.jsx(Tc,{label:"Gender",value:r.personal.gender}),i.jsx(kc,{label:"Aadhaar Number",value:r.personal.idProofNumber,status:r.personal.verifiedStatus?.idProofNumber,isVerifying:v==="verifying"})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Organization Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Tc,{label:"Site / Client",value:r.organization.organizationName}),i.jsx(Tc,{label:"Designation",value:r.organization.designation}),i.jsx(Tc,{label:"Department",value:r.organization.department}),i.jsx(Tc,{label:"Joining Date",value:r.organization.joiningDate})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Bank & Statutory Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(kc,{label:"Account Holder",value:r.bank.accountHolderName,status:r.bank.verifiedStatus?.accountHolderName,isVerifying:v==="verifying"}),i.jsx(kc,{label:"Account Number",value:"*".repeat(Math.max(0,r.bank.accountNumber.length-4))+r.bank.accountNumber.slice(-4),status:r.bank.verifiedStatus?.accountNumber,isVerifying:v==="verifying"}),i.jsx(kc,{label:"IFSC Code",value:r.bank.ifscCode,status:r.bank.verifiedStatus?.ifscCode,isVerifying:v==="verifying"}),i.jsx(Tc,{label:"Bank Name",value:r.bank.bankName}),r.uan.hasPreviousPf&&i.jsx(kc,{label:"UAN",value:r.uan.uanNumber,status:r.uan.verifiedStatus?.uanNumber,isVerifying:v==="verifying"}),r.esi.hasEsi&&i.jsx(kc,{label:"ESI Number",value:r.esi.esiNumber,status:r.esi.verifiedStatus?.esiNumber,isVerifying:v==="verifying"})]})]}),r.uniforms.length>0&&i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Uniform Details"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.uniforms.map(O=>i.jsxs("div",{className:"bg-page p-3 rounded-md",children:[i.jsx("p",{className:"font-semibold text-sm",children:O.itemName}),i.jsxs("p",{className:"text-xs text-muted",children:["Size: ",O.sizeLabel," (",O.fit,")"]}),i.jsxs("p",{className:"text-xs text-muted",children:["Qty: ",O.quantity]})]},O.itemId))})]}),r.biometrics.signatureImage&&i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Biometrics"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-primary-text",children:"Signature"}),i.jsx("div",{className:"mt-2 p-2 border rounded-lg inline-block bg-page",children:i.jsx("img",{src:r.biometrics.signatureImage.preview,alt:"Signature",className:"h-24"})})]}),T.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-primary-text",children:"Fingerprints Uploaded"}),i.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-muted columns-2",children:T.map(O=>i.jsx("li",{children:O},O))})]})]})]})]}),c.enabled&&i.jsxs("div",{className:"mt-8 pt-6 border-t",children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Third-Party Verification"}),i.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:"Run a background check against official records."}),i.jsx("p",{className:"text-sm text-muted",children:"This step is required before you can submit the application."}),v==="failed"&&i.jsx("p",{className:"text-sm text-red-600 mt-2",children:w}),v==="success"&&i.jsx("p",{className:"text-sm text-green-600 mt-2",children:w})]}),i.jsxs(re,{onClick:P,isLoading:v==="verifying",disabled:v==="success",children:[v==="idle"&&i.jsxs(i.Fragment,{children:[i.jsx(Xx,{className:"mr-2 h-4 w-4"})," Verify Details"]}),v==="verifying"&&"Verifying...",v==="failed"&&"Retry Verification",v==="success"&&i.jsxs(i.Fragment,{children:[i.jsx(Hi,{className:"mr-2 h-4 w-4"})," Verified"]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t",children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Generate Official Forms"}),i.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:"Generate and review the official PDF documents."}),i.jsx("p",{className:"text-sm text-muted",children:"This step is mandatory before final submission."})]}),r.formsGenerated?i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-green-600",children:[i.jsx(Hi,{className:"h-5 w-5"}),i.jsx("span",{children:"Forms Generated & Confirmed"})]}):i.jsxs(re,{onClick:E,children:[i.jsx(os,{className:"mr-2 h-4 w-4"})," Generate & Review Forms"]})]})]}),i.jsx("div",{className:"mt-8 pt-6 border-t",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex items-center h-5",children:i.jsx("input",{id:"confirmation",name:"confirmation",type:"checkbox",required:!0,className:"focus:ring-accent h-4 w-4 text-accent border-gray-300 rounded",disabled:!M})}),i.jsxs("div",{className:"ml-3 text-sm",children:[i.jsx("label",{htmlFor:"confirmation",className:`font-medium ${M?"text-gray-700":"text-gray-400"}`,children:"Declaration"}),i.jsx("p",{className:`${M?"text-muted":"text-gray-400"}`,children:"I hereby declare that the information provided is true and correct to the best of my knowledge."})]})]})})]})},Wn=({requiredPermission:n,children:e})=>{const{user:t,isInitialized:r}=jt(),{permissions:s}=Ki();return r?t?(s[t.role]||[]).includes(n)?e?i.jsx(i.Fragment,{children:e}):i.jsx(gf,{}):i.jsx(yl,{to:"/forbidden",replace:!0}):i.jsx(yl,{to:"/auth/login",replace:!0}):null},jue=({onIdle:n,idleTimeout:e,promptTimeout:t,disabled:r=!1})=>{const[s,a]=D.useState(!1),[o,l]=D.useState(t),c=D.useRef(null),d=D.useRef(null),h=D.useRef(null),p=["mousemove","keydown","mousedown","scroll","touchstart"],x=D.useCallback(()=>{r||(a(!1),l(t),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current),c.current=window.setTimeout(()=>{a(!0)},e))},[e,t,r]);return D.useEffect(()=>{if(!r)return s&&(d.current=window.setTimeout(n,t),h.current=window.setInterval(()=>{l(v=>Math.max(0,v-1e3))},1e3)),()=>{d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)}},[s,n,t,r]),D.useEffect(()=>{if(r)return;const v=()=>x();return p.forEach(_=>{window.addEventListener(_,v)}),x(),()=>{p.forEach(_=>{window.removeEventListener(_,v)}),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)}},[x,r]),{isIdle:s,countdown:o,reset:x}},Nue=1800*1e3,Sue=120*1e3,Cue=()=>{const{logout:n}=jt(),e=St(),t=()=>{n(),e("/auth/login",{replace:!0})},r=Ft("(max-width: 768px)"),{isIdle:s,countdown:a,reset:o}=jue({onIdle:t,idleTimeout:Nue,promptTimeout:Sue,disabled:r});return s?i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-70 backdrop-blur-sm","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 text-center animate-fade-in-scale",children:[i.jsx(ZF,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Are you still there?"}),i.jsx("p",{className:"mt-2 text-muted",children:"For your security, you will be logged out due to inactivity."}),i.jsx("div",{className:"my-6 text-4xl font-bold text-accent",children:Math.ceil(a/1e3)}),i.jsx("p",{className:"text-sm text-muted mb-6",children:"Click the button below to stay logged in."}),i.jsx("div",{className:"flex justify-center gap-4",children:i.jsx(re,{onClick:o,variant:"primary",size:"lg",children:"Stay Logged In"})})]})}):null},Tue=()=>{const{pathname:n}=cs();return D.useEffect(()=>{window.scrollTo(0,0);const e=document.querySelector("main");e&&e.scrollTo(0,0);const t=document.getElementById("root");t&&t.scrollTo(0,0)},[n]),null},kue=()=>{const{theme:n,isAutomatic:e,_setThemeInternal:t}=xu(),r=Ft("(max-width: 767px)");return D.useEffect(()=>{const s=document.body;let a="light";e?a=r?"dark":"light":a=n,t(a),a==="dark"?s.classList.add("pro-dark-theme"):s.classList.remove("pro-dark-theme")},[n,e,r,t]),null},ox="app:lastPath",Pue=["/auth","/splash","/pending-approval","/forbidden"],YS=n=>n==="/"||n==="/#"||n==="/index.html"?!1:!Pue.some(e=>n.startsWith(e)),Mue=()=>{const{user:n,isInitialized:e}=jt(),t=cs();return e?n?n.role==="unverified"?i.jsx(yl,{to:"/pending-approval",replace:!0}):Ft("(max-width: 767px)")?i.jsx(PJ,{}):i.jsx(TJ,{}):(YS(t.pathname+t.search)&&localStorage.setItem(ox,t.pathname+t.search),i.jsx(yl,{to:"/auth/login",replace:!0})):null},Due=()=>{const{user:n,isInitialized:e,setUser:t,setInitialized:r,resetAttendance:s,setLoading:a,isLoginAnimationPending:o}=jt(),{init:l}=Kc(),{initRoles:c}=Ki(),{initSettings:d}=pi(),h=St(),p=cs();return D.useEffect(()=>{n&&YS(p.pathname+p.search)&&localStorage.setItem(ox,p.pathname+p.search)},[n,p.pathname,p.search]),D.useEffect(()=>{let x=!0;const v=setTimeout(()=>{x&&(console.warn("App initialization is taking too long. Proceeding without a session."),a(!1),r(!0))},3e4);(async()=>{a(!0);try{let{data:{session:j},error:T}=await Me.auth.getSession();if(T&&console.error("Error fetching initial session:",T.message),!j){const P=localStorage.getItem("supabase.auth.rememberMe");if(P){console.log("Attempting to restore session from long-term token...");try{const{data:E,error:M}=await Me.auth.setSession({refresh_token:P});M?(console.error("Failed to restore session from long-term token:",M.message),localStorage.removeItem("supabase.auth.rememberMe")):j=E.session}catch(E){console.error("Exception while restoring session from long-term token:",E)}}}if(j)try{const P=await wa.getAppUserProfile(j.user);x&&t(P)}catch(P){console.error("Failed to fetch user profile during initialization:",P),x&&(t(null),s())}else x&&(t(null),s())}catch(j){console.error("Error during app initialization:",j),x&&(t(null),s())}finally{clearTimeout(v),x&&(a(!1),r(!0))}})();const{data:{subscription:w}}=Me.auth.onAuthStateChange((j,T)=>{if(j==="PASSWORD_RECOVERY"){h("/auth/update-password",{replace:!0});return}T?.user?setTimeout(async()=>{try{const P=await wa.getAppUserProfile(T.user);if(x&&(t(P),P))try{const E=`greetingSent_${P.id}`;localStorage.getItem(E)||(await ue.createNotification({userId:P.id,message:`Good morning, ${P.name||"there"}! Welcome to Paradigm Services.`,type:"greeting"}),localStorage.setItem(E,"1"))}catch(E){console.error("Failed to send login greeting notification",E)}}catch(P){console.error("Failed to fetch user profile after auth change:",P),x&&(t(null),s(),$n.getState().reset())}},0):x&&(t(null),s(),$n.getState().reset())});return()=>{x=!1,w?.unsubscribe(),clearTimeout(v)}},[t,r,s,a]),D.useEffect(()=>{n&&e&&((async()=>{try{const{settings:v,roles:_,holidays:w}=await ue.getInitialAppData(),j=await ue.getRecurringHolidays();v.enrollmentRules&&l(v.enrollmentRules),_&&c(_),v.attendanceSettings&&w&&d({holidays:w,attendanceSettings:v.attendanceSettings,recurringHolidays:j||[]})}catch(v){console.error("Failed to load initial application data:",v)}})(),jt.getState().checkAttendanceStatus())},[n,e,l,c,d]),D.useEffect(()=>{if(e&&p.pathname!=="/auth/update-password"&&n&&!o&&(p.pathname.startsWith("/auth")&&p.pathname!=="/auth/logout"||p.pathname==="/"||p.pathname==="/splash")){const x=localStorage.getItem(ox);x&&YS(x)&&x!=="/"&&x!=="/#"?(localStorage.removeItem(ox),h(x,{replace:!0})):n.role==="unverified"?h("/pending-approval",{replace:!0}):h("/profile",{replace:!0})}},[e,n,p.pathname,h,o]),e?i.jsxs(i.Fragment,{children:[i.jsx(Tue,{}),i.jsx(kue,{}),n&&i.jsx(Cue,{}),i.jsxs(gz,{children:[i.jsxs(He,{path:"/auth",element:i.jsx(DJ,{}),children:[i.jsx(He,{index:!0,element:i.jsx(yl,{to:"login",replace:!0})}),i.jsx(He,{path:"login",element:i.jsx(UQ,{})}),i.jsx(He,{path:"signup",element:i.jsx(BQ,{})}),i.jsx(He,{path:"forgot-password",element:i.jsx($Q,{})}),i.jsx(He,{path:"update-password",element:i.jsx(GQ,{})}),i.jsx(He,{path:"logout",element:i.jsx(ZQ,{})})]}),i.jsx(He,{path:"/pending-approval",element:n&&n.role==="unverified"?i.jsx(KQ,{}):i.jsx(yl,{to:"/auth/login",replace:!0})}),i.jsx(He,{path:"/forbidden",element:i.jsx(JQ,{})}),i.jsxs(He,{path:"/",element:i.jsx(IJ,{children:i.jsx(Mue,{})}),children:[i.jsx(He,{index:!0,element:i.jsx(yl,{to:"/profile",replace:!0})}),i.jsx(He,{path:"profile",element:i.jsx(Vre,{})}),i.jsx(He,{path:"mobile-home",element:i.jsx(LJ,{})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"create_enrollment"}),children:[i.jsx(He,{path:"onboarding",element:i.jsx(QQ,{})}),i.jsx(He,{path:"onboarding/select-organization",element:i.jsx(XQ,{})}),i.jsx(He,{path:"onboarding/pre-upload",element:i.jsx(wde,{})}),i.jsx(He,{path:"onboarding/submissions",element:i.jsx(Sde,{})}),i.jsx(He,{path:"onboarding/tasks",element:i.jsx(Tde,{})}),i.jsx(He,{path:"onboarding/uniforms",element:i.jsx(Mde,{})}),i.jsxs(He,{path:"onboarding/add",element:i.jsx(eX,{}),children:[i.jsx(He,{path:"personal",element:i.jsx(tue,{})}),i.jsx(He,{path:"address",element:i.jsx(rue,{})}),i.jsx(He,{path:"organization",element:i.jsx(iue,{})}),i.jsx(He,{path:"family",element:i.jsx(aue,{})}),i.jsx(He,{path:"education",element:i.jsx(oue,{})}),i.jsx(He,{path:"bank",element:i.jsx(due,{})}),i.jsx(He,{path:"uan",element:i.jsx(fue,{})}),i.jsx(He,{path:"esi",element:i.jsx(mue,{})}),i.jsx(He,{path:"gmc",element:i.jsx(gue,{})}),i.jsx(He,{path:"uniform",element:i.jsx(xue,{})}),i.jsx(He,{path:"documents",element:i.jsx(yue,{})}),i.jsx(He,{path:"biometrics",element:i.jsx(_ue,{})}),i.jsx(He,{path:"review",element:i.jsx(wue,{})})]}),i.jsx(He,{path:"onboarding/pdf/:id",element:i.jsx(tde,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_all_submissions"}),children:i.jsx(He,{path:"verification/dashboard",element:i.jsx(sX,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_users"}),children:[i.jsx(He,{path:"admin/users",element:i.jsx(oX,{})}),i.jsx(He,{path:"admin/users/add",element:i.jsx(OL,{})}),i.jsx(He,{path:"admin/users/edit/:id",element:i.jsx(OL,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_sites"}),children:[i.jsx(He,{path:"admin/sites",element:i.jsx(Tre,{})}),i.jsx(He,{path:"admin/sites/add",element:i.jsx(Jde,{})}),i.jsx(He,{path:"admin/sites/quick-add",element:i.jsx(Qde,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_roles_and_permissions"}),children:[i.jsx(He,{path:"admin/roles",element:i.jsx(Pre,{})}),i.jsx(He,{path:"admin/roles/add",element:i.jsx(IL,{})}),i.jsx(He,{path:"admin/roles/edit/:id",element:i.jsx(IL,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_modules"}),children:[i.jsx(He,{path:"admin/modules",element:i.jsx(Ore,{})}),i.jsx(He,{path:"admin/modules/add",element:i.jsx(Zde,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_approval_workflow"}),children:[i.jsx(He,{path:"admin/approval-workflow",element:i.jsx(Xle,{})}),i.jsx(He,{path:"admin/approval-workflow/chart",element:i.jsx(ece,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_developer_settings"}),children:i.jsx(He,{path:"developer/api",element:i.jsx(Are,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"view_operations_dashboard"}),children:[i.jsx(He,{path:"operations/dashboard",element:i.jsx(Lre,{})}),i.jsx(He,{path:"operations/team-activity",element:i.jsx(Fre,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_site_dashboard"}),children:i.jsx(He,{path:"site/dashboard",element:i.jsx(zre,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"view_own_attendance"}),children:[i.jsx(He,{path:"attendance/dashboard",element:i.jsx(Ale,{})}),i.jsx(He,{path:"attendance/locations",element:i.jsx(Fle,{})}),i.jsx(He,{path:"attendance/check-in",element:i.jsx(SL,{})}),i.jsx(He,{path:"attendance/check-out",element:i.jsx(SL,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"apply_for_leave"}),children:i.jsx(He,{path:"leaves/dashboard",element:i.jsx(Yle,{})})}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"manage_attendance_rules"}),children:i.jsx(He,{path:"hr/attendance-settings",element:i.jsx(qle,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_leave_requests"}),children:[i.jsx(He,{path:"hr/leave-management",element:i.jsx(Jle,{})}),i.jsx(He,{path:"hr/leave-management/grant-comp-off",element:i.jsx(Gde,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"view_entity_management"}),children:[i.jsx(He,{path:"hr/entities",element:i.jsx(Yce,{})}),i.jsx(He,{path:"hr/entity-management/add-group",element:i.jsx(Yde,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_policies"}),children:[i.jsx(He,{path:"hr/policies-and-insurance",element:i.jsx(Xce,{})}),i.jsx(He,{path:"hr/policies/add",element:i.jsx(Wde,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"manage_enrollment_rules"}),children:i.jsx(He,{path:"hr/enrollment-rules",element:i.jsx(ede,{})})}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_field_officer_tracking"}),children:i.jsx(He,{path:"hr/field-officer-tracking",element:i.jsx(gde,{})})}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"manage_attendance_rules"}),children:i.jsx(He,{path:"hr/locations",element:i.jsx(yde,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_uniforms"}),children:[i.jsx(He,{path:"uniforms",element:i.jsx(sde,{})}),i.jsx(He,{path:"uniforms/request/new",element:i.jsx(RL,{})}),i.jsx(He,{path:"uniforms/request/edit/:id",element:i.jsx(RL,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_verification_costing"}),children:i.jsx(He,{path:"billing/cost-analysis",element:i.jsx(ode,{})})}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_invoice_summary"}),children:i.jsx(He,{path:"billing/summary",element:i.jsx(dde,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_tasks"}),children:[i.jsx(He,{path:"tasks",element:i.jsx(sce,{})}),i.jsx(He,{path:"tasks/add",element:i.jsx(AL,{})}),i.jsx(He,{path:"tasks/edit/:id",element:i.jsx(AL,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"access_support_desk"}),children:[i.jsx(He,{path:"support",element:i.jsx(Ide,{})}),i.jsx(He,{path:"support/ticket/new",element:i.jsx(Hde,{})}),i.jsx(He,{path:"support/ticket/:id",element:i.jsx(Ude,{})})]})]}),i.jsx(He,{path:"*",element:i.jsx(yl,{to:"/",replace:!0})})]})]}):i.jsx(RJ,{})},A6=document.getElementById("root");if(!A6)throw new Error("Could not find root element to mount to");const Eue=Sq.createRoot(A6);Eue.render(i.jsx(ot.StrictMode,{children:i.jsx(Sz,{children:i.jsx(Due,{})})}));export{$k as _,mu as a,Oue as c,qL as g};
