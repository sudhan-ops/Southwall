function t4(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var Sfe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function n4(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var Yv={exports:{}},bh={},Gv={exports:{}},Xt={};var rk;function Lq(){if(rk)return Xt;rk=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function x(H){return H===null||typeof H!="object"?null:(H=p&&H[p]||H["@@iterator"],typeof H=="function"?H:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,_={};function j(H,ae,le){this.props=H,this.context=ae,this.refs=_,this.updater=le||v}j.prototype.isReactComponent={},j.prototype.setState=function(H,ae){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ae,"setState")},j.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function C(){}C.prototype=j.prototype;function P(H,ae,le){this.props=H,this.context=ae,this.refs=_,this.updater=le||v}var O=P.prototype=new C;O.constructor=P,b(O,j.prototype),O.isPureReactComponent=!0;var M=Array.isArray,D=Object.prototype.hasOwnProperty,I={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function q(H,ae,le){var ue,ie={},pe=null,re=null;if(ae!=null)for(ue in ae.ref!==void 0&&(re=ae.ref),ae.key!==void 0&&(pe=""+ae.key),ae)D.call(ae,ue)&&!F.hasOwnProperty(ue)&&(ie[ue]=ae[ue]);var de=arguments.length-2;if(de===1)ie.children=le;else if(1<de){for(var je=Array(de),Ae=0;Ae<de;Ae++)je[Ae]=arguments[Ae+2];ie.children=je}if(H&&H.defaultProps)for(ue in de=H.defaultProps,de)ie[ue]===void 0&&(ie[ue]=de[ue]);return{$$typeof:n,type:H,key:pe,ref:re,props:ie,_owner:I.current}}function U(H,ae){return{$$typeof:n,type:H.type,key:ae,ref:H.ref,props:H.props,_owner:H._owner}}function B(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function W(H){var ae={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(le){return ae[le]})}var Y=/\/+/g;function G(H,ae){return typeof H=="object"&&H!==null&&H.key!=null?W(""+H.key):ae.toString(36)}function Z(H,ae,le,ue,ie){var pe=typeof H;(pe==="undefined"||pe==="boolean")&&(H=null);var re=!1;if(H===null)re=!0;else switch(pe){case"string":case"number":re=!0;break;case"object":switch(H.$$typeof){case n:case e:re=!0}}if(re)return re=H,ie=ie(re),H=ue===""?"."+G(re,0):ue,M(ie)?(le="",H!=null&&(le=H.replace(Y,"$&/")+"/"),Z(ie,ae,le,"",function(Ae){return Ae})):ie!=null&&(B(ie)&&(ie=U(ie,le+(!ie.key||re&&re.key===ie.key?"":(""+ie.key).replace(Y,"$&/")+"/")+H)),ae.push(ie)),1;if(re=0,ue=ue===""?".":ue+":",M(H))for(var de=0;de<H.length;de++){pe=H[de];var je=ue+G(pe,de);re+=Z(pe,ae,le,je,ie)}else if(je=x(H),typeof je=="function")for(H=je.call(H),de=0;!(pe=H.next()).done;)pe=pe.value,je=ue+G(pe,de++),re+=Z(pe,ae,le,je,ie);else if(pe==="object")throw ae=String(H),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.");return re}function oe(H,ae,le){if(H==null)return H;var ue=[],ie=0;return Z(H,ue,"","",function(pe){return ae.call(le,pe,ie++)}),ue}function X(H){if(H._status===-1){var ae=H._result;ae=ae(),ae.then(function(le){(H._status===0||H._status===-1)&&(H._status=1,H._result=le)},function(le){(H._status===0||H._status===-1)&&(H._status=2,H._result=le)}),H._status===-1&&(H._status=0,H._result=ae)}if(H._status===1)return H._result.default;throw H._result}var he={current:null},$={transition:null},K={ReactCurrentDispatcher:he,ReactCurrentBatchConfig:$,ReactCurrentOwner:I};function te(){throw Error("act(...) is not supported in production builds of React.")}return Xt.Children={map:oe,forEach:function(H,ae,le){oe(H,function(){ae.apply(this,arguments)},le)},count:function(H){var ae=0;return oe(H,function(){ae++}),ae},toArray:function(H){return oe(H,function(ae){return ae})||[]},only:function(H){if(!B(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Xt.Component=j,Xt.Fragment=t,Xt.Profiler=s,Xt.PureComponent=P,Xt.StrictMode=r,Xt.Suspense=c,Xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K,Xt.act=te,Xt.cloneElement=function(H,ae,le){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var ue=b({},H.props),ie=H.key,pe=H.ref,re=H._owner;if(ae!=null){if(ae.ref!==void 0&&(pe=ae.ref,re=I.current),ae.key!==void 0&&(ie=""+ae.key),H.type&&H.type.defaultProps)var de=H.type.defaultProps;for(je in ae)D.call(ae,je)&&!F.hasOwnProperty(je)&&(ue[je]=ae[je]===void 0&&de!==void 0?de[je]:ae[je])}var je=arguments.length-2;if(je===1)ue.children=le;else if(1<je){de=Array(je);for(var Ae=0;Ae<je;Ae++)de[Ae]=arguments[Ae+2];ue.children=de}return{$$typeof:n,type:H.type,key:ie,ref:pe,props:ue,_owner:re}},Xt.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:a,_context:H},H.Consumer=H},Xt.createElement=q,Xt.createFactory=function(H){var ae=q.bind(null,H);return ae.type=H,ae},Xt.createRef=function(){return{current:null}},Xt.forwardRef=function(H){return{$$typeof:l,render:H}},Xt.isValidElement=B,Xt.lazy=function(H){return{$$typeof:h,_payload:{_status:-1,_result:H},_init:X}},Xt.memo=function(H,ae){return{$$typeof:d,type:H,compare:ae===void 0?null:ae}},Xt.startTransition=function(H){var ae=$.transition;$.transition={};try{H()}finally{$.transition=ae}},Xt.unstable_act=te,Xt.useCallback=function(H,ae){return he.current.useCallback(H,ae)},Xt.useContext=function(H){return he.current.useContext(H)},Xt.useDebugValue=function(){},Xt.useDeferredValue=function(H){return he.current.useDeferredValue(H)},Xt.useEffect=function(H,ae){return he.current.useEffect(H,ae)},Xt.useId=function(){return he.current.useId()},Xt.useImperativeHandle=function(H,ae,le){return he.current.useImperativeHandle(H,ae,le)},Xt.useInsertionEffect=function(H,ae){return he.current.useInsertionEffect(H,ae)},Xt.useLayoutEffect=function(H,ae){return he.current.useLayoutEffect(H,ae)},Xt.useMemo=function(H,ae){return he.current.useMemo(H,ae)},Xt.useReducer=function(H,ae,le){return he.current.useReducer(H,ae,le)},Xt.useRef=function(H){return he.current.useRef(H)},Xt.useState=function(H){return he.current.useState(H)},Xt.useSyncExternalStore=function(H,ae,le){return he.current.useSyncExternalStore(H,ae,le)},Xt.useTransition=function(){return he.current.useTransition()},Xt.version="18.3.1",Xt}var sk;function Qs(){return sk||(sk=1,Gv.exports=Lq()),Gv.exports}var ik;function Fq(){if(ik)return bh;ik=1;var n=Qs(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(l,c,d){var h,p={},x=null,v=null;d!==void 0&&(x=""+d),c.key!==void 0&&(x=""+c.key),c.ref!==void 0&&(v=c.ref);for(h in c)r.call(c,h)&&!a.hasOwnProperty(h)&&(p[h]=c[h]);if(l&&l.defaultProps)for(h in c=l.defaultProps,c)p[h]===void 0&&(p[h]=c[h]);return{$$typeof:e,type:l,key:x,ref:v,props:p,_owner:s.current}}return bh.Fragment=t,bh.jsx=o,bh.jsxs=o,bh}var ak;function r4(){return ak||(ak=1,Yv.exports=Fq()),Yv.exports}var i=r4(),E=Qs();const ot=wu(E),qq=t4({__proto__:null,default:ot},[E]);var Ip={},Zv={exports:{}},Vs={},Kv={exports:{}},Jv={};var ok;function zq(){return ok||(ok=1,(function(n){function e($,K){var te=$.length;$.push(K);e:for(;0<te;){var H=te-1>>>1,ae=$[H];if(0<s(ae,K))$[H]=K,$[te]=ae,te=H;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var K=$[0],te=$.pop();if(te!==K){$[0]=te;e:for(var H=0,ae=$.length,le=ae>>>1;H<le;){var ue=2*(H+1)-1,ie=$[ue],pe=ue+1,re=$[pe];if(0>s(ie,te))pe<ae&&0>s(re,ie)?($[H]=re,$[pe]=te,H=pe):($[H]=ie,$[ue]=te,H=ue);else if(pe<ae&&0>s(re,te))$[H]=re,$[pe]=te,H=pe;else break e}}return K}function s($,K){var te=$.sortIndex-K.sortIndex;return te!==0?te:$.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,p=null,x=3,v=!1,b=!1,_=!1,j=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O($){for(var K=t(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=$)r(d),K.sortIndex=K.expirationTime,e(c,K);else break;K=t(d)}}function M($){if(_=!1,O($),!b)if(t(c)!==null)b=!0,X(D);else{var K=t(d);K!==null&&he(M,K.startTime-$)}}function D($,K){b=!1,_&&(_=!1,C(q),q=-1),v=!0;var te=x;try{for(O(K),p=t(c);p!==null&&(!(p.expirationTime>K)||$&&!W());){var H=p.callback;if(typeof H=="function"){p.callback=null,x=p.priorityLevel;var ae=H(p.expirationTime<=K);K=n.unstable_now(),typeof ae=="function"?p.callback=ae:p===t(c)&&r(c),O(K)}else r(c);p=t(c)}if(p!==null)var le=!0;else{var ue=t(d);ue!==null&&he(M,ue.startTime-K),le=!1}return le}finally{p=null,x=te,v=!1}}var I=!1,F=null,q=-1,U=5,B=-1;function W(){return!(n.unstable_now()-B<U)}function Y(){if(F!==null){var $=n.unstable_now();B=$;var K=!0;try{K=F(!0,$)}finally{K?G():(I=!1,F=null)}}else I=!1}var G;if(typeof P=="function")G=function(){P(Y)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,oe=Z.port2;Z.port1.onmessage=Y,G=function(){oe.postMessage(null)}}else G=function(){j(Y,0)};function X($){F=$,I||(I=!0,G())}function he($,K){q=j(function(){$(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){b||v||(b=!0,X(D))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function($){switch(x){case 1:case 2:case 3:var K=3;break;default:K=x}var te=x;x=K;try{return $()}finally{x=te}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,K){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var te=x;x=$;try{return K()}finally{x=te}},n.unstable_scheduleCallback=function($,K,te){var H=n.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?H+te:H):te=H,$){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=te+ae,$={id:h++,callback:K,priorityLevel:$,startTime:te,expirationTime:ae,sortIndex:-1},te>H?($.sortIndex=te,e(d,$),t(c)===null&&$===t(d)&&(_?(C(q),q=-1):_=!0,he(M,te-H))):($.sortIndex=ae,e(c,$),b||v||(b=!0,X(D))),$},n.unstable_shouldYield=W,n.unstable_wrapCallback=function($){var K=x;return function(){var te=x;x=K;try{return $.apply(this,arguments)}finally{x=te}}}})(Jv)),Jv}var lk;function Uq(){return lk||(lk=1,Kv.exports=zq()),Kv.exports}var ck;function Bq(){if(ck)return Vs;ck=1;var n=Qs(),e=Uq();function t(u){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+u,w=1;w<arguments.length;w++)m+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+u+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(u,m){o(u,m),o(u+"Capture",m)}function o(u,m){for(s[u]=m,u=0;u<m.length;u++)r.add(m[u])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function x(u){return c.call(p,u)?!0:c.call(h,u)?!1:d.test(u)?p[u]=!0:(h[u]=!0,!1)}function v(u,m,w,k){if(w!==null&&w.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return k?!1:w!==null?!w.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function b(u,m,w,k){if(m===null||typeof m>"u"||v(u,m,w,k))return!0;if(k)return!1;if(w!==null)switch(w.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function _(u,m,w,k,R,z,J){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=k,this.attributeNamespace=R,this.mustUseProperty=w,this.propertyName=u,this.type=m,this.sanitizeURL=z,this.removeEmptyString=J}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){j[u]=new _(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var m=u[0];j[m]=new _(m,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){j[u]=new _(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){j[u]=new _(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){j[u]=new _(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){j[u]=new _(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){j[u]=new _(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){j[u]=new _(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){j[u]=new _(u,5,!1,u.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function P(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var m=u.replace(C,P);j[m]=new _(m,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var m=u.replace(C,P);j[m]=new _(m,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var m=u.replace(C,P);j[m]=new _(m,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){j[u]=new _(u,1,!1,u.toLowerCase(),null,!1,!1)}),j.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){j[u]=new _(u,1,!1,u.toLowerCase(),null,!0,!0)});function O(u,m,w,k){var R=j.hasOwnProperty(m)?j[m]:null;(R!==null?R.type!==0:k||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(b(m,w,R,k)&&(w=null),k||R===null?x(m)&&(w===null?u.removeAttribute(m):u.setAttribute(m,""+w)):R.mustUseProperty?u[R.propertyName]=w===null?R.type===3?!1:"":w:(m=R.attributeName,k=R.attributeNamespace,w===null?u.removeAttribute(m):(R=R.type,w=R===3||R===4&&w===!0?"":""+w,k?u.setAttributeNS(k,m,w):u.setAttribute(m,w))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),I=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),W=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),he=Symbol.for("react.offscreen"),$=Symbol.iterator;function K(u){return u===null||typeof u!="object"?null:(u=$&&u[$]||u["@@iterator"],typeof u=="function"?u:null)}var te=Object.assign,H;function ae(u){if(H===void 0)try{throw Error()}catch(w){var m=w.stack.trim().match(/\n( *(at )?)/);H=m&&m[1]||""}return`
`+H+u}var le=!1;function ue(u,m){if(!u||le)return"";le=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(Oe){var k=Oe}Reflect.construct(u,[],m)}else{try{m.call()}catch(Oe){k=Oe}u.call(m.prototype)}else{try{throw Error()}catch(Oe){k=Oe}u()}}catch(Oe){if(Oe&&k&&typeof Oe.stack=="string"){for(var R=Oe.stack.split(`
`),z=k.stack.split(`
`),J=R.length-1,fe=z.length-1;1<=J&&0<=fe&&R[J]!==z[fe];)fe--;for(;1<=J&&0<=fe;J--,fe--)if(R[J]!==z[fe]){if(J!==1||fe!==1)do if(J--,fe--,0>fe||R[J]!==z[fe]){var ge=`
`+R[J].replace(" at new "," at ");return u.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",u.displayName)),ge}while(1<=J&&0<=fe);break}}}finally{le=!1,Error.prepareStackTrace=w}return(u=u?u.displayName||u.name:"")?ae(u):""}function ie(u){switch(u.tag){case 5:return ae(u.type);case 16:return ae("Lazy");case 13:return ae("Suspense");case 19:return ae("SuspenseList");case 0:case 2:case 15:return u=ue(u.type,!1),u;case 11:return u=ue(u.type.render,!1),u;case 1:return u=ue(u.type,!0),u;default:return""}}function pe(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case F:return"Fragment";case I:return"Portal";case U:return"Profiler";case q:return"StrictMode";case G:return"Suspense";case Z:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case W:return(u.displayName||"Context")+".Consumer";case B:return(u._context.displayName||"Context")+".Provider";case Y:var m=u.render;return u=u.displayName,u||(u=m.displayName||m.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case oe:return m=u.displayName||null,m!==null?m:pe(u.type)||"Memo";case X:m=u._payload,u=u._init;try{return pe(u(m))}catch{}}return null}function re(u){var m=u.type;switch(u.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=m.render,u=u.displayName||u.name||"",m.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(m);case 8:return m===q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function de(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function je(u){var m=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function Ae(u){var m=je(u)?"checked":"value",w=Object.getOwnPropertyDescriptor(u.constructor.prototype,m),k=""+u[m];if(!u.hasOwnProperty(m)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var R=w.get,z=w.set;return Object.defineProperty(u,m,{configurable:!0,get:function(){return R.call(this)},set:function(J){k=""+J,z.call(this,J)}}),Object.defineProperty(u,m,{enumerable:w.enumerable}),{getValue:function(){return k},setValue:function(J){k=""+J},stopTracking:function(){u._valueTracker=null,delete u[m]}}}}function Te(u){u._valueTracker||(u._valueTracker=Ae(u))}function Se(u){if(!u)return!1;var m=u._valueTracker;if(!m)return!0;var w=m.getValue(),k="";return u&&(k=je(u)?u.checked?"true":"false":u.value),u=k,u!==w?(m.setValue(u),!0):!1}function Pe(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function qe(u,m){var w=m.checked;return te({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:w??u._wrapperState.initialChecked})}function He(u,m){var w=m.defaultValue==null?"":m.defaultValue,k=m.checked!=null?m.checked:m.defaultChecked;w=de(m.value!=null?m.value:w),u._wrapperState={initialChecked:k,initialValue:w,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function ze(u,m){m=m.checked,m!=null&&O(u,"checked",m,!1)}function be(u,m){ze(u,m);var w=de(m.value),k=m.type;if(w!=null)k==="number"?(w===0&&u.value===""||u.value!=w)&&(u.value=""+w):u.value!==""+w&&(u.value=""+w);else if(k==="submit"||k==="reset"){u.removeAttribute("value");return}m.hasOwnProperty("value")?Ve(u,m.type,w):m.hasOwnProperty("defaultValue")&&Ve(u,m.type,de(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(u.defaultChecked=!!m.defaultChecked)}function Ue(u,m,w){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var k=m.type;if(!(k!=="submit"&&k!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+u._wrapperState.initialValue,w||m===u.value||(u.value=m),u.defaultValue=m}w=u.name,w!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,w!==""&&(u.name=w)}function Ve(u,m,w){(m!=="number"||Pe(u.ownerDocument)!==u)&&(w==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+w&&(u.defaultValue=""+w))}var ee=Array.isArray;function se(u,m,w,k){if(u=u.options,m){m={};for(var R=0;R<w.length;R++)m["$"+w[R]]=!0;for(w=0;w<u.length;w++)R=m.hasOwnProperty("$"+u[w].value),u[w].selected!==R&&(u[w].selected=R),R&&k&&(u[w].defaultSelected=!0)}else{for(w=""+de(w),m=null,R=0;R<u.length;R++){if(u[R].value===w){u[R].selected=!0,k&&(u[R].defaultSelected=!0);return}m!==null||u[R].disabled||(m=u[R])}m!==null&&(m.selected=!0)}}function xe(u,m){if(m.dangerouslySetInnerHTML!=null)throw Error(t(91));return te({},m,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function ke(u,m){var w=m.value;if(w==null){if(w=m.children,m=m.defaultValue,w!=null){if(m!=null)throw Error(t(92));if(ee(w)){if(1<w.length)throw Error(t(93));w=w[0]}m=w}m==null&&(m=""),w=m}u._wrapperState={initialValue:de(w)}}function Ie(u,m){var w=de(m.value),k=de(m.defaultValue);w!=null&&(w=""+w,w!==u.value&&(u.value=w),m.defaultValue==null&&u.defaultValue!==w&&(u.defaultValue=w)),k!=null&&(u.defaultValue=""+k)}function Re(u){var m=u.textContent;m===u._wrapperState.initialValue&&m!==""&&m!==null&&(u.value=m)}function nt(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xe(u,m){return u==null||u==="http://www.w3.org/1999/xhtml"?nt(m):u==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var ht,Bt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,w,k,R){MSApp.execUnsafeLocalFunction(function(){return u(m,w,k,R)})}:u})(function(u,m){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=m;else{for(ht=ht||document.createElement("div"),ht.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=ht.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;m.firstChild;)u.appendChild(m.firstChild)}});function lt(u,m){if(m){var w=u.firstChild;if(w&&w===u.lastChild&&w.nodeType===3){w.nodeValue=m;return}}u.textContent=m}var Wt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Yt=["Webkit","ms","Moz","O"];Object.keys(Wt).forEach(function(u){Yt.forEach(function(m){m=m+u.charAt(0).toUpperCase()+u.substring(1),Wt[m]=Wt[u]})});function Qt(u,m,w){return m==null||typeof m=="boolean"||m===""?"":w||typeof m!="number"||m===0||Wt.hasOwnProperty(u)&&Wt[u]?(""+m).trim():m+"px"}function Gt(u,m){u=u.style;for(var w in m)if(m.hasOwnProperty(w)){var k=w.indexOf("--")===0,R=Qt(w,m[w],k);w==="float"&&(w="cssFloat"),k?u.setProperty(w,R):u[w]=R}}var ln=te({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rn(u,m){if(m){if(ln[u]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(t(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(t(61))}if(m.style!=null&&typeof m.style!="object")throw Error(t(62))}}function Et(u,m){if(u.indexOf("-")===-1)return typeof m.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qn=null;function sr(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var vn=null,it=null,dn=null;function ir(u){if(u=rl(u)){if(typeof vn!="function")throw Error(t(280));var m=u.stateNode;m&&(m=Du(m),vn(u.stateNode,u.type,m))}}function ks(u){it?dn?dn.push(u):dn=[u]:it=u}function Ps(){if(it){var u=it,m=dn;if(dn=it=null,ir(u),m)for(u=0;u<m.length;u++)ir(m[u])}}function In(u,m){return u(m)}function Ms(){}var Es=!1;function Er(u,m,w){if(Es)return u(m,w);Es=!0;try{return In(u,m,w)}finally{Es=!1,(it!==null||dn!==null)&&(Ms(),Ps())}}function ei(u,m){var w=u.stateNode;if(w===null)return null;var k=Du(w);if(k===null)return null;w=k[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(u=u.type,k=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!k;break e;default:u=!1}if(u)return null;if(w&&typeof w!="function")throw Error(t(231,m,typeof w));return w}var Eo=!1;if(l)try{var sa={};Object.defineProperty(sa,"passive",{get:function(){Eo=!0}}),window.addEventListener("test",sa,sa),window.removeEventListener("test",sa,sa)}catch{Eo=!1}function hd(u,m,w,k,R,z,J,fe,ge){var Oe=Array.prototype.slice.call(arguments,3);try{m.apply(w,Oe)}catch(Ge){this.onError(Ge)}}var fr=!1,dt=null,ia=!1,za=null,Al={onError:function(u){fr=!0,dt=u}};function Rl(u,m,w,k,R,z,J,fe,ge){fr=!1,dt=null,hd.apply(Al,arguments)}function Do(u,m,w,k,R,z,J,fe,ge){if(Rl.apply(this,arguments),fr){if(fr){var Oe=dt;fr=!1,dt=null}else throw Error(t(198));ia||(ia=!0,za=Oe)}}function Ds(u){var m=u,w=u;if(u.alternate)for(;m.return;)m=m.return;else{u=m;do m=u,(m.flags&4098)!==0&&(w=m.return),u=m.return;while(u)}return m.tag===3?w:null}function ti(u){if(u.tag===13){var m=u.memoizedState;if(m===null&&(u=u.alternate,u!==null&&(m=u.memoizedState)),m!==null)return m.dehydrated}return null}function Oo(u){if(Ds(u)!==u)throw Error(t(188))}function md(u){var m=u.alternate;if(!m){if(m=Ds(u),m===null)throw Error(t(188));return m!==u?null:u}for(var w=u,k=m;;){var R=w.return;if(R===null)break;var z=R.alternate;if(z===null){if(k=R.return,k!==null){w=k;continue}break}if(R.child===z.child){for(z=R.child;z;){if(z===w)return Oo(R),u;if(z===k)return Oo(R),m;z=z.sibling}throw Error(t(188))}if(w.return!==k.return)w=R,k=z;else{for(var J=!1,fe=R.child;fe;){if(fe===w){J=!0,w=R,k=z;break}if(fe===k){J=!0,k=R,w=z;break}fe=fe.sibling}if(!J){for(fe=z.child;fe;){if(fe===w){J=!0,w=z,k=R;break}if(fe===k){J=!0,k=z,w=R;break}fe=fe.sibling}if(!J)throw Error(t(189))}}if(w.alternate!==k)throw Error(t(190))}if(w.tag!==3)throw Error(t(188));return w.stateNode.current===w?u:m}function Ll(u){return u=md(u),u!==null?Fl(u):null}function Fl(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var m=Fl(u);if(m!==null)return m;u=u.sibling}return null}var ql=e.unstable_scheduleCallback,Io=e.unstable_cancelCallback,pd=e.unstable_shouldYield,Ua=e.unstable_requestPaint,Pn=e.unstable_now,gd=e.unstable_getCurrentPriorityLevel,Ao=e.unstable_ImmediatePriority,zl=e.unstable_UserBlockingPriority,Ba=e.unstable_NormalPriority,Ro=e.unstable_LowPriority,Si=e.unstable_IdlePriority,aa=null,Fr=null;function oa(u){if(Fr&&typeof Fr.onCommitFiberRoot=="function")try{Fr.onCommitFiberRoot(aa,u,void 0,(u.current.flags&128)===128)}catch{}}var Dt=Math.clz32?Math.clz32:Ni,jn=Math.log,Va=Math.LN2;function Ni(u){return u>>>=0,u===0?32:31-(jn(u)/Va|0)|0}var fs=64,Ci=4194304;function Mt(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function bn(u,m){var w=u.pendingLanes;if(w===0)return 0;var k=0,R=u.suspendedLanes,z=u.pingedLanes,J=w&268435455;if(J!==0){var fe=J&~R;fe!==0?k=Mt(fe):(z&=J,z!==0&&(k=Mt(z)))}else J=w&~R,J!==0?k=Mt(J):z!==0&&(k=Mt(z));if(k===0)return 0;if(m!==0&&m!==k&&(m&R)===0&&(R=k&-k,z=m&-m,R>=z||R===16&&(z&4194240)!==0))return m;if((k&4)!==0&&(k|=w&16),m=u.entangledLanes,m!==0)for(u=u.entanglements,m&=k;0<m;)w=31-Dt(m),R=1<<w,k|=u[w],m&=~R;return k}function Lo(u,m){switch(u){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wa(u,m){for(var w=u.suspendedLanes,k=u.pingedLanes,R=u.expirationTimes,z=u.pendingLanes;0<z;){var J=31-Dt(z),fe=1<<J,ge=R[J];ge===-1?((fe&w)===0||(fe&k)!==0)&&(R[J]=Lo(fe,m)):ge<=m&&(u.expiredLanes|=fe),z&=~fe}}function hr(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function Ul(){var u=fs;return fs<<=1,(fs&4194240)===0&&(fs=64),u}function Ti(u){for(var m=[],w=0;31>w;w++)m.push(u);return m}function qr(u,m,w){u.pendingLanes|=m,m!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,m=31-Dt(m),u[m]=w}function An(u,m){var w=u.pendingLanes&~m;u.pendingLanes=m,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=m,u.mutableReadLanes&=m,u.entangledLanes&=m,m=u.entanglements;var k=u.eventTimes;for(u=u.expirationTimes;0<w;){var R=31-Dt(w),z=1<<R;m[R]=0,k[R]=-1,u[R]=-1,w&=~z}}function hs(u,m){var w=u.entangledLanes|=m;for(u=u.entanglements;w;){var k=31-Dt(w),R=1<<k;R&m|u[k]&m&&(u[k]|=m),w&=~R}}var Jt=0;function ki(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var $a,ni,Ha,Ya,la,ca=!1,Pi=[],zr=null,ms=null,Jr=null,da=new Map,Ct=new Map,Gn=[],un="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fo(u,m){switch(u){case"focusin":case"focusout":zr=null;break;case"dragenter":case"dragleave":ms=null;break;case"mouseover":case"mouseout":Jr=null;break;case"pointerover":case"pointerout":da.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ct.delete(m.pointerId)}}function ri(u,m,w,k,R,z){return u===null||u.nativeEvent!==z?(u={blockedOn:m,domEventName:w,eventSystemFlags:k,nativeEvent:z,targetContainers:[R]},m!==null&&(m=rl(m),m!==null&&ni(m)),u):(u.eventSystemFlags|=k,m=u.targetContainers,R!==null&&m.indexOf(R)===-1&&m.push(R),u)}function qo(u,m,w,k,R){switch(m){case"focusin":return zr=ri(zr,u,m,w,k,R),!0;case"dragenter":return ms=ri(ms,u,m,w,k,R),!0;case"mouseover":return Jr=ri(Jr,u,m,w,k,R),!0;case"pointerover":var z=R.pointerId;return da.set(z,ri(da.get(z)||null,u,m,w,k,R)),!0;case"gotpointercapture":return z=R.pointerId,Ct.set(z,ri(Ct.get(z)||null,u,m,w,k,R)),!0}return!1}function Ga(u){var m=nl(u.target);if(m!==null){var w=Ds(m);if(w!==null){if(m=w.tag,m===13){if(m=ti(w),m!==null){u.blockedOn=m,la(u.priority,function(){Ha(w)});return}}else if(m===3&&w.stateNode.current.memoizedState.isDehydrated){u.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Qr(u){if(u.blockedOn!==null)return!1;for(var m=u.targetContainers;0<m.length;){var w=Ja(u.domEventName,u.eventSystemFlags,m[0],u.nativeEvent);if(w===null){w=u.nativeEvent;var k=new w.constructor(w.type,w);qn=k,w.target.dispatchEvent(k),qn=null}else return m=rl(w),m!==null&&ni(m),u.blockedOn=w,!1;m.shift()}return!0}function Za(u,m,w){Qr(u)&&w.delete(m)}function ua(){ca=!1,zr!==null&&Qr(zr)&&(zr=null),ms!==null&&Qr(ms)&&(ms=null),Jr!==null&&Qr(Jr)&&(Jr=null),da.forEach(Za),Ct.forEach(Za)}function Mn(u,m){u.blockedOn===m&&(u.blockedOn=null,ca||(ca=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ua)))}function Ur(u){function m(R){return Mn(R,u)}if(0<Pi.length){Mn(Pi[0],u);for(var w=1;w<Pi.length;w++){var k=Pi[w];k.blockedOn===u&&(k.blockedOn=null)}}for(zr!==null&&Mn(zr,u),ms!==null&&Mn(ms,u),Jr!==null&&Mn(Jr,u),da.forEach(m),Ct.forEach(m),w=0;w<Gn.length;w++)k=Gn[w],k.blockedOn===u&&(k.blockedOn=null);for(;0<Gn.length&&(w=Gn[0],w.blockedOn===null);)Ga(w),w.blockedOn===null&&Gn.shift()}var si=M.ReactCurrentBatchConfig,fa=!0;function xd(u,m,w,k){var R=Jt,z=si.transition;si.transition=null;try{Jt=1,ha(u,m,w,k)}finally{Jt=R,si.transition=z}}function Bl(u,m,w,k){var R=Jt,z=si.transition;si.transition=null;try{Jt=4,ha(u,m,w,k)}finally{Jt=R,si.transition=z}}function ha(u,m,w,k){if(fa){var R=Ja(u,m,w,k);if(R===null)f(u,m,k,Ka,w),Fo(u,k);else if(qo(R,u,m,w,k))k.stopPropagation();else if(Fo(u,k),m&4&&-1<un.indexOf(u)){for(;R!==null;){var z=rl(R);if(z!==null&&$a(z),z=Ja(u,m,w,k),z===null&&f(u,m,k,Ka,w),z===R)break;R=z}R!==null&&k.stopPropagation()}else f(u,m,k,null,w)}}var Ka=null;function Ja(u,m,w,k){if(Ka=null,u=sr(k),u=nl(u),u!==null)if(m=Ds(u),m===null)u=null;else if(w=m.tag,w===13){if(u=ti(m),u!==null)return u;u=null}else if(w===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;u=null}else m!==u&&(u=null);return Ka=u,null}function Ht(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gd()){case Ao:return 1;case zl:return 4;case Ba:case Ro:return 16;case Si:return 536870912;default:return 16}default:return 16}}var Os=null,_r=null,Is=null;function zo(){if(Is)return Is;var u,m=_r,w=m.length,k,R="value"in Os?Os.value:Os.textContent,z=R.length;for(u=0;u<w&&m[u]===R[u];u++);var J=w-u;for(k=1;k<=J&&m[w-k]===R[z-k];k++);return Is=R.slice(u,1<k?1-k:void 0)}function Qa(u){var m=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&m===13&&(u=13)):u=m,u===10&&(u=13),32<=u||u===13?u:0}function Mi(){return!0}function Vl(){return!1}function mr(u){function m(w,k,R,z,J){this._reactName=w,this._targetInst=R,this.type=k,this.nativeEvent=z,this.target=J,this.currentTarget=null;for(var fe in u)u.hasOwnProperty(fe)&&(w=u[fe],this[fe]=w?w(z):z[fe]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?Mi:Vl,this.isPropagationStopped=Vl,this}return te(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=Mi)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=Mi)},persist:function(){},isPersistent:Mi}),m}var Ei={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uo=mr(Ei),ii=te({},Ei,{view:0,detail:0}),yd=mr(ii),Dr,Bo,Di,Br=te({},ii,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oi,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Di&&(Di&&u.type==="mousemove"?(Dr=u.screenX-Di.screenX,Bo=u.screenY-Di.screenY):Bo=Dr=0,Di=u),Dr)},movementY:function(u){return"movementY"in u?u.movementY:Bo}}),Vo=mr(Br),Wl=te({},Br,{dataTransfer:0}),Wo=mr(Wl),vd=te({},ii,{relatedTarget:0}),Xa=mr(vd),$l=te({},Ei,{animationName:0,elapsedTime:0,pseudoElement:0}),bd=mr($l),wd=te({},Ei,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),$o=mr(wd),_d=te({},Ei,{data:0}),Ho=mr(_d),Hl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ai={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jd(u){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(u):(u=ai[u])?!!m[u]:!1}function oi(){return jd}var Or=te({},ii,{key:function(u){if(u.key){var m=Hl[u.key]||u.key;if(m!=="Unidentified")return m}return u.type==="keypress"?(u=Qa(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?eo[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oi,charCode:function(u){return u.type==="keypress"?Qa(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Qa(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Yl=mr(Or),Gl=te({},Br,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zl=mr(Gl),Yo=te({},ii,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oi}),Go=mr(Yo),Sd=te({},Ei,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nd=mr(Sd),Kl=te({},Br,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),Cd=mr(Kl),Vr=[9,13,27,32],As=l&&"CompositionEvent"in window,ma=null;l&&"documentMode"in document&&(ma=document.documentMode);var ps=l&&"TextEvent"in window&&!ma,Jl=l&&(!As||ma&&8<ma&&11>=ma),li=" ",Ql=!1;function Oi(u,m){switch(u){case"keyup":return Vr.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zo(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var gs=!1;function Td(u,m){switch(u){case"compositionend":return Zo(m);case"keypress":return m.which!==32?null:(Ql=!0,li);case"textInput":return u=m.data,u===li&&Ql?null:u;default:return null}}function Rs(u,m){if(gs)return u==="compositionend"||!As&&Oi(u,m)?(u=zo(),Is=_r=Os=null,gs=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Jl&&m.locale!=="ko"?null:m.data;default:return null}}var to={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xl(u){var m=u&&u.nodeName&&u.nodeName.toLowerCase();return m==="input"?!!to[u.type]:m==="textarea"}function no(u,m,w,k){ks(k),m=T(m,"onChange"),0<m.length&&(w=new Uo("onChange","change",null,w,k),u.push({event:w,listeners:m}))}var pa=null,jr=null;function kd(u){rh(u,0)}function xs(u){var m=sl(u);if(Se(m))return u}function Pd(u,m){if(u==="change")return m}var Xr=!1;if(l){var Ii;if(l){var ro="oninput"in document;if(!ro){var so=document.createElement("div");so.setAttribute("oninput","return;"),ro=typeof so.oninput=="function"}Ii=ro}else Ii=!1;Xr=Ii&&(!document.documentMode||9<document.documentMode)}function ga(){pa&&(pa.detachEvent("onpropertychange",io),jr=pa=null)}function io(u){if(u.propertyName==="value"&&xs(jr)){var m=[];no(m,jr,u,sr(u)),Er(kd,m)}}function ao(u,m,w){u==="focusin"?(ga(),pa=m,jr=w,pa.attachEvent("onpropertychange",io)):u==="focusout"&&ga()}function Ai(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return xs(jr)}function oo(u,m){if(u==="click")return xs(m)}function Ko(u,m){if(u==="input"||u==="change")return xs(m)}function ec(u,m){return u===m&&(u!==0||1/u===1/m)||u!==u&&m!==m}var Wr=typeof Object.is=="function"?Object.is:ec;function Ls(u,m){if(Wr(u,m))return!0;if(typeof u!="object"||u===null||typeof m!="object"||m===null)return!1;var w=Object.keys(u),k=Object.keys(m);if(w.length!==k.length)return!1;for(k=0;k<w.length;k++){var R=w[k];if(!c.call(m,R)||!Wr(u[R],m[R]))return!1}return!0}function tc(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function Jo(u,m){var w=tc(u);u=0;for(var k;w;){if(w.nodeType===3){if(k=u+w.textContent.length,u<=m&&k>=m)return{node:w,offset:m-u};u=k}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=tc(w)}}function nc(u,m){return u&&m?u===m?!0:u&&u.nodeType===3?!1:m&&m.nodeType===3?nc(u,m.parentNode):"contains"in u?u.contains(m):u.compareDocumentPosition?!!(u.compareDocumentPosition(m)&16):!1:!1}function Qo(){for(var u=window,m=Pe();m instanceof u.HTMLIFrameElement;){try{var w=typeof m.contentWindow.location.href=="string"}catch{w=!1}if(w)u=m.contentWindow;else break;m=Pe(u.document)}return m}function Xo(u){var m=u&&u.nodeName&&u.nodeName.toLowerCase();return m&&(m==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||m==="textarea"||u.contentEditable==="true")}function g(u){var m=Qo(),w=u.focusedElem,k=u.selectionRange;if(m!==w&&w&&w.ownerDocument&&nc(w.ownerDocument.documentElement,w)){if(k!==null&&Xo(w)){if(m=k.start,u=k.end,u===void 0&&(u=m),"selectionStart"in w)w.selectionStart=m,w.selectionEnd=Math.min(u,w.value.length);else if(u=(m=w.ownerDocument||document)&&m.defaultView||window,u.getSelection){u=u.getSelection();var R=w.textContent.length,z=Math.min(k.start,R);k=k.end===void 0?z:Math.min(k.end,R),!u.extend&&z>k&&(R=k,k=z,z=R),R=Jo(w,z);var J=Jo(w,k);R&&J&&(u.rangeCount!==1||u.anchorNode!==R.node||u.anchorOffset!==R.offset||u.focusNode!==J.node||u.focusOffset!==J.offset)&&(m=m.createRange(),m.setStart(R.node,R.offset),u.removeAllRanges(),z>k?(u.addRange(m),u.extend(J.node,J.offset)):(m.setEnd(J.node,J.offset),u.addRange(m)))}}for(m=[],u=w;u=u.parentNode;)u.nodeType===1&&m.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<m.length;w++)u=m[w],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var Pu=l&&"documentMode"in document&&11>=document.documentMode,rc=null,sc=null,Md=null,Mu=!1;function Vm(u,m,w){var k=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;Mu||rc==null||rc!==Pe(k)||(k=rc,"selectionStart"in k&&Xo(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),Md&&Ls(Md,k)||(Md=k,k=T(sc,"onSelect"),0<k.length&&(m=new Uo("onSelect","select",null,m,w),u.push({event:m,listeners:k}),m.target=rc)))}function lo(u,m){var w={};return w[u.toLowerCase()]=m.toLowerCase(),w["Webkit"+u]="webkit"+m,w["Moz"+u]="moz"+m,w}var ic={animationend:lo("Animation","AnimationEnd"),animationiteration:lo("Animation","AnimationIteration"),animationstart:lo("Animation","AnimationStart"),transitionend:lo("Transition","TransitionEnd")},co={},Xf={};l&&(Xf=document.createElement("div").style,"AnimationEvent"in window||(delete ic.animationend.animation,delete ic.animationiteration.animation,delete ic.animationstart.animation),"TransitionEvent"in window||delete ic.transitionend.transition);function Ed(u){if(co[u])return co[u];if(!ic[u])return u;var m=ic[u],w;for(w in m)if(m.hasOwnProperty(w)&&w in Xf)return co[u]=m[w];return u}var Wm=Ed("animationend"),Ri=Ed("animationiteration"),eh=Ed("animationstart"),th=Ed("transitionend"),ac=new Map,$m="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ci(u,m){ac.set(u,m),a(m,[u])}for(var el=0;el<$m.length;el++){var Eu=$m[el],Hm=Eu.toLowerCase(),Uy=Eu[0].toUpperCase()+Eu.slice(1);ci(Hm,"on"+Uy)}ci(Wm,"onAnimationEnd"),ci(Ri,"onAnimationIteration"),ci(eh,"onAnimationStart"),ci("dblclick","onDoubleClick"),ci("focusin","onFocus"),ci("focusout","onBlur"),ci(th,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ym=new Set("cancel close invalid load scroll toggle".split(" ").concat(oc));function nh(u,m,w){var k=u.type||"unknown-event";u.currentTarget=w,Do(k,m,void 0,u),u.currentTarget=null}function rh(u,m){m=(m&4)!==0;for(var w=0;w<u.length;w++){var k=u[w],R=k.event;k=k.listeners;e:{var z=void 0;if(m)for(var J=k.length-1;0<=J;J--){var fe=k[J],ge=fe.instance,Oe=fe.currentTarget;if(fe=fe.listener,ge!==z&&R.isPropagationStopped())break e;nh(R,fe,Oe),z=ge}else for(J=0;J<k.length;J++){if(fe=k[J],ge=fe.instance,Oe=fe.currentTarget,fe=fe.listener,ge!==z&&R.isPropagationStopped())break e;nh(R,fe,Oe),z=ge}}}if(ia)throw u=za,ia=!1,za=null,u}function Tn(u,m){var w=m[uc];w===void 0&&(w=m[uc]=new Set);var k=u+"__bubble";w.has(k)||(Gm(m,u,2,!1),w.add(k))}function sh(u,m,w){var k=0;m&&(k|=4),Gm(w,u,k,m)}var Dd="_reactListening"+Math.random().toString(36).slice(2);function lc(u){if(!u[Dd]){u[Dd]=!0,r.forEach(function(w){w!=="selectionchange"&&(Ym.has(w)||sh(w,!1,u),sh(w,!0,u))});var m=u.nodeType===9?u:u.ownerDocument;m===null||m[Dd]||(m[Dd]=!0,sh("selectionchange",!1,m))}}function Gm(u,m,w,k){switch(Ht(m)){case 1:var R=xd;break;case 4:R=Bl;break;default:R=ha}w=R.bind(null,m,w,u),R=void 0,!Eo||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(R=!0),k?R!==void 0?u.addEventListener(m,w,{capture:!0,passive:R}):u.addEventListener(m,w,!0):R!==void 0?u.addEventListener(m,w,{passive:R}):u.addEventListener(m,w,!1)}function f(u,m,w,k,R){var z=k;if((m&1)===0&&(m&2)===0&&k!==null)e:for(;;){if(k===null)return;var J=k.tag;if(J===3||J===4){var fe=k.stateNode.containerInfo;if(fe===R||fe.nodeType===8&&fe.parentNode===R)break;if(J===4)for(J=k.return;J!==null;){var ge=J.tag;if((ge===3||ge===4)&&(ge=J.stateNode.containerInfo,ge===R||ge.nodeType===8&&ge.parentNode===R))return;J=J.return}for(;fe!==null;){if(J=nl(fe),J===null)return;if(ge=J.tag,ge===5||ge===6){k=z=J;continue e}fe=fe.parentNode}}k=k.return}Er(function(){var Oe=z,Ge=sr(w),Ke=[];e:{var Ye=ac.get(u);if(Ye!==void 0){var at=Uo,ut=u;switch(u){case"keypress":if(Qa(w)===0)break e;case"keydown":case"keyup":at=Yl;break;case"focusin":ut="focus",at=Xa;break;case"focusout":ut="blur",at=Xa;break;case"beforeblur":case"afterblur":at=Xa;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=Vo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=Wo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=Go;break;case Wm:case Ri:case eh:at=bd;break;case th:at=Nd;break;case"scroll":at=yd;break;case"wheel":at=Cd;break;case"copy":case"cut":case"paste":at=$o;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=Zl}var mt=(m&4)!==0,ar=!mt&&u==="scroll",Ce=mt?Ye!==null?Ye+"Capture":null:Ye;mt=[];for(var ve=Oe,Me;ve!==null;){Me=ve;var Je=Me.stateNode;if(Me.tag===5&&Je!==null&&(Me=Je,Ce!==null&&(Je=ei(ve,Ce),Je!=null&&mt.push(y(ve,Je,Me)))),ar)break;ve=ve.return}0<mt.length&&(Ye=new at(Ye,ut,null,w,Ge),Ke.push({event:Ye,listeners:mt}))}}if((m&7)===0){e:{if(Ye=u==="mouseover"||u==="pointerover",at=u==="mouseout"||u==="pointerout",Ye&&w!==qn&&(ut=w.relatedTarget||w.fromElement)&&(nl(ut)||ut[wn]))break e;if((at||Ye)&&(Ye=Ge.window===Ge?Ge:(Ye=Ge.ownerDocument)?Ye.defaultView||Ye.parentWindow:window,at?(ut=w.relatedTarget||w.toElement,at=Oe,ut=ut?nl(ut):null,ut!==null&&(ar=Ds(ut),ut!==ar||ut.tag!==5&&ut.tag!==6)&&(ut=null)):(at=null,ut=Oe),at!==ut)){if(mt=Vo,Je="onMouseLeave",Ce="onMouseEnter",ve="mouse",(u==="pointerout"||u==="pointerover")&&(mt=Zl,Je="onPointerLeave",Ce="onPointerEnter",ve="pointer"),ar=at==null?Ye:sl(at),Me=ut==null?Ye:sl(ut),Ye=new mt(Je,ve+"leave",at,w,Ge),Ye.target=ar,Ye.relatedTarget=Me,Je=null,nl(Ge)===Oe&&(mt=new mt(Ce,ve+"enter",ut,w,Ge),mt.target=Me,mt.relatedTarget=ar,Je=mt),ar=Je,at&&ut)t:{for(mt=at,Ce=ut,ve=0,Me=mt;Me;Me=A(Me))ve++;for(Me=0,Je=Ce;Je;Je=A(Je))Me++;for(;0<ve-Me;)mt=A(mt),ve--;for(;0<Me-ve;)Ce=A(Ce),Me--;for(;ve--;){if(mt===Ce||Ce!==null&&mt===Ce.alternate)break t;mt=A(mt),Ce=A(Ce)}mt=null}else mt=null;at!==null&&V(Ke,Ye,at,mt,!1),ut!==null&&ar!==null&&V(Ke,ar,ut,mt,!0)}}e:{if(Ye=Oe?sl(Oe):window,at=Ye.nodeName&&Ye.nodeName.toLowerCase(),at==="select"||at==="input"&&Ye.type==="file")var gt=Pd;else if(Xl(Ye))if(Xr)gt=Ko;else{gt=Ai;var Tt=ao}else(at=Ye.nodeName)&&at.toLowerCase()==="input"&&(Ye.type==="checkbox"||Ye.type==="radio")&&(gt=oo);if(gt&&(gt=gt(u,Oe))){no(Ke,gt,w,Ge);break e}Tt&&Tt(u,Ye,Oe),u==="focusout"&&(Tt=Ye._wrapperState)&&Tt.controlled&&Ye.type==="number"&&Ve(Ye,"number",Ye.value)}switch(Tt=Oe?sl(Oe):window,u){case"focusin":(Xl(Tt)||Tt.contentEditable==="true")&&(rc=Tt,sc=Oe,Md=null);break;case"focusout":Md=sc=rc=null;break;case"mousedown":Mu=!0;break;case"contextmenu":case"mouseup":case"dragend":Mu=!1,Vm(Ke,w,Ge);break;case"selectionchange":if(Pu)break;case"keydown":case"keyup":Vm(Ke,w,Ge)}var kt;if(As)e:{switch(u){case"compositionstart":var Rt="onCompositionStart";break e;case"compositionend":Rt="onCompositionEnd";break e;case"compositionupdate":Rt="onCompositionUpdate";break e}Rt=void 0}else gs?Oi(u,w)&&(Rt="onCompositionEnd"):u==="keydown"&&w.keyCode===229&&(Rt="onCompositionStart");Rt&&(Jl&&w.locale!=="ko"&&(gs||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&gs&&(kt=zo()):(Os=Ge,_r="value"in Os?Os.value:Os.textContent,gs=!0)),Tt=T(Oe,Rt),0<Tt.length&&(Rt=new Ho(Rt,u,null,w,Ge),Ke.push({event:Rt,listeners:Tt}),kt?Rt.data=kt:(kt=Zo(w),kt!==null&&(Rt.data=kt)))),(kt=ps?Td(u,w):Rs(u,w))&&(Oe=T(Oe,"onBeforeInput"),0<Oe.length&&(Ge=new Ho("onBeforeInput","beforeinput",null,w,Ge),Ke.push({event:Ge,listeners:Oe}),Ge.data=kt))}rh(Ke,m)})}function y(u,m,w){return{instance:u,listener:m,currentTarget:w}}function T(u,m){for(var w=m+"Capture",k=[];u!==null;){var R=u,z=R.stateNode;R.tag===5&&z!==null&&(R=z,z=ei(u,w),z!=null&&k.unshift(y(u,z,R)),z=ei(u,m),z!=null&&k.push(y(u,z,R))),u=u.return}return k}function A(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function V(u,m,w,k,R){for(var z=m._reactName,J=[];w!==null&&w!==k;){var fe=w,ge=fe.alternate,Oe=fe.stateNode;if(ge!==null&&ge===k)break;fe.tag===5&&Oe!==null&&(fe=Oe,R?(ge=ei(w,z),ge!=null&&J.unshift(y(w,ge,fe))):R||(ge=ei(w,z),ge!=null&&J.push(y(w,ge,fe)))),w=w.return}J.length!==0&&u.push({event:m,listeners:J})}var Q=/\r\n?/g,me=/\u0000|\uFFFD/g;function Ne(u){return(typeof u=="string"?u:""+u).replace(Q,`
`).replace(me,"")}function De(u,m,w){if(m=Ne(m),Ne(u)!==m&&w)throw Error(t(425))}function Be(){}var rt=null,St=null;function $t(u,m){return u==="textarea"||u==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var Sr=typeof setTimeout=="function"?setTimeout:void 0,pr=typeof clearTimeout=="function"?clearTimeout:void 0,ys=typeof Promise=="function"?Promise:void 0,es=typeof queueMicrotask=="function"?queueMicrotask:typeof ys<"u"?function(u){return ys.resolve(null).then(u).catch(cc)}:Sr;function cc(u){setTimeout(function(){throw u})}function ih(u,m){var w=m,k=0;do{var R=w.nextSibling;if(u.removeChild(w),R&&R.nodeType===8)if(w=R.data,w==="/$"){if(k===0){u.removeChild(R),Ur(m);return}k--}else w!=="$"&&w!=="$?"&&w!=="$!"||k++;w=R}while(w);Ur(m)}function uo(u){for(;u!=null;u=u.nextSibling){var m=u.nodeType;if(m===1||m===3)break;if(m===8){if(m=u.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return u}function Zm(u){u=u.previousSibling;for(var m=0;u;){if(u.nodeType===8){var w=u.data;if(w==="$"||w==="$!"||w==="$?"){if(m===0)return u;m--}else w==="/$"&&m++}u=u.previousSibling}return null}var tl=Math.random().toString(36).slice(2),Li="__reactFiber$"+tl,dc="__reactProps$"+tl,wn="__reactContainer$"+tl,uc="__reactEvents$"+tl,By="__reactListeners$"+tl,Vy="__reactHandles$"+tl;function nl(u){var m=u[Li];if(m)return m;for(var w=u.parentNode;w;){if(m=w[wn]||w[Li]){if(w=m.alternate,m.child!==null||w!==null&&w.child!==null)for(u=Zm(u);u!==null;){if(w=u[Li])return w;u=Zm(u)}return m}u=w,w=u.parentNode}return null}function rl(u){return u=u[Li]||u[wn],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function sl(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function Du(u){return u[dc]||null}var Wy=[],Ou=-1;function fc(u){return{current:u}}function zn(u){0>Ou||(u.current=Wy[Ou],Wy[Ou]=null,Ou--)}function Rn(u,m){Ou++,Wy[Ou]=u.current,u.current=m}var hc={},ts=fc(hc),Fs=fc(!1),Od=hc;function Iu(u,m){var w=u.type.contextTypes;if(!w)return hc;var k=u.stateNode;if(k&&k.__reactInternalMemoizedUnmaskedChildContext===m)return k.__reactInternalMemoizedMaskedChildContext;var R={},z;for(z in w)R[z]=m[z];return k&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=m,u.__reactInternalMemoizedMaskedChildContext=R),R}function qs(u){return u=u.childContextTypes,u!=null}function Km(){zn(Fs),zn(ts)}function N1(u,m,w){if(ts.current!==hc)throw Error(t(168));Rn(ts,m),Rn(Fs,w)}function C1(u,m,w){var k=u.stateNode;if(m=m.childContextTypes,typeof k.getChildContext!="function")return w;k=k.getChildContext();for(var R in k)if(!(R in m))throw Error(t(108,re(u)||"Unknown",R));return te({},w,k)}function Jm(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||hc,Od=ts.current,Rn(ts,u),Rn(Fs,Fs.current),!0}function T1(u,m,w){var k=u.stateNode;if(!k)throw Error(t(169));w?(u=C1(u,m,Od),k.__reactInternalMemoizedMergedChildContext=u,zn(Fs),zn(ts),Rn(ts,u)):zn(Fs),Rn(Fs,w)}var il=null,Qm=!1,$y=!1;function k1(u){il===null?il=[u]:il.push(u)}function nq(u){Qm=!0,k1(u)}function mc(){if(!$y&&il!==null){$y=!0;var u=0,m=Jt;try{var w=il;for(Jt=1;u<w.length;u++){var k=w[u];do k=k(!0);while(k!==null)}il=null,Qm=!1}catch(R){throw il!==null&&(il=il.slice(u+1)),ql(Ao,mc),R}finally{Jt=m,$y=!1}}return null}var Au=[],Ru=0,Xm=null,ep=0,Fi=[],qi=0,Id=null,al=1,ol="";function Ad(u,m){Au[Ru++]=ep,Au[Ru++]=Xm,Xm=u,ep=m}function P1(u,m,w){Fi[qi++]=al,Fi[qi++]=ol,Fi[qi++]=Id,Id=u;var k=al;u=ol;var R=32-Dt(k)-1;k&=~(1<<R),w+=1;var z=32-Dt(m)+R;if(30<z){var J=R-R%5;z=(k&(1<<J)-1).toString(32),k>>=J,R-=J,al=1<<32-Dt(m)+R|w<<R|k,ol=z+u}else al=1<<z|w<<R|k,ol=u}function Hy(u){u.return!==null&&(Ad(u,1),P1(u,1,0))}function Yy(u){for(;u===Xm;)Xm=Au[--Ru],Au[Ru]=null,ep=Au[--Ru],Au[Ru]=null;for(;u===Id;)Id=Fi[--qi],Fi[qi]=null,ol=Fi[--qi],Fi[qi]=null,al=Fi[--qi],Fi[qi]=null}var di=null,ui=null,$n=!1,xa=null;function M1(u,m){var w=Vi(5,null,null,0);w.elementType="DELETED",w.stateNode=m,w.return=u,m=u.deletions,m===null?(u.deletions=[w],u.flags|=16):m.push(w)}function E1(u,m){switch(u.tag){case 5:var w=u.type;return m=m.nodeType!==1||w.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(u.stateNode=m,di=u,ui=uo(m.firstChild),!0):!1;case 6:return m=u.pendingProps===""||m.nodeType!==3?null:m,m!==null?(u.stateNode=m,di=u,ui=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(w=Id!==null?{id:al,overflow:ol}:null,u.memoizedState={dehydrated:m,treeContext:w,retryLane:1073741824},w=Vi(18,null,null,0),w.stateNode=m,w.return=u,u.child=w,di=u,ui=null,!0):!1;default:return!1}}function Gy(u){return(u.mode&1)!==0&&(u.flags&128)===0}function Zy(u){if($n){var m=ui;if(m){var w=m;if(!E1(u,m)){if(Gy(u))throw Error(t(418));m=uo(w.nextSibling);var k=di;m&&E1(u,m)?M1(k,w):(u.flags=u.flags&-4097|2,$n=!1,di=u)}}else{if(Gy(u))throw Error(t(418));u.flags=u.flags&-4097|2,$n=!1,di=u}}}function D1(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;di=u}function tp(u){if(u!==di)return!1;if(!$n)return D1(u),$n=!0,!1;var m;if((m=u.tag!==3)&&!(m=u.tag!==5)&&(m=u.type,m=m!=="head"&&m!=="body"&&!$t(u.type,u.memoizedProps)),m&&(m=ui)){if(Gy(u))throw O1(),Error(t(418));for(;m;)M1(u,m),m=uo(m.nextSibling)}if(D1(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,m=0;u;){if(u.nodeType===8){var w=u.data;if(w==="/$"){if(m===0){ui=uo(u.nextSibling);break e}m--}else w!=="$"&&w!=="$!"&&w!=="$?"||m++}u=u.nextSibling}ui=null}}else ui=di?uo(u.stateNode.nextSibling):null;return!0}function O1(){for(var u=ui;u;)u=uo(u.nextSibling)}function Lu(){ui=di=null,$n=!1}function Ky(u){xa===null?xa=[u]:xa.push(u)}var rq=M.ReactCurrentBatchConfig;function ah(u,m,w){if(u=w.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(t(309));var k=w.stateNode}if(!k)throw Error(t(147,u));var R=k,z=""+u;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===z?m.ref:(m=function(J){var fe=R.refs;J===null?delete fe[z]:fe[z]=J},m._stringRef=z,m)}if(typeof u!="string")throw Error(t(284));if(!w._owner)throw Error(t(290,u))}return u}function np(u,m){throw u=Object.prototype.toString.call(m),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":u))}function I1(u){var m=u._init;return m(u._payload)}function A1(u){function m(Ce,ve){if(u){var Me=Ce.deletions;Me===null?(Ce.deletions=[ve],Ce.flags|=16):Me.push(ve)}}function w(Ce,ve){if(!u)return null;for(;ve!==null;)m(Ce,ve),ve=ve.sibling;return null}function k(Ce,ve){for(Ce=new Map;ve!==null;)ve.key!==null?Ce.set(ve.key,ve):Ce.set(ve.index,ve),ve=ve.sibling;return Ce}function R(Ce,ve){return Ce=_c(Ce,ve),Ce.index=0,Ce.sibling=null,Ce}function z(Ce,ve,Me){return Ce.index=Me,u?(Me=Ce.alternate,Me!==null?(Me=Me.index,Me<ve?(Ce.flags|=2,ve):Me):(Ce.flags|=2,ve)):(Ce.flags|=1048576,ve)}function J(Ce){return u&&Ce.alternate===null&&(Ce.flags|=2),Ce}function fe(Ce,ve,Me,Je){return ve===null||ve.tag!==6?(ve=Uv(Me,Ce.mode,Je),ve.return=Ce,ve):(ve=R(ve,Me),ve.return=Ce,ve)}function ge(Ce,ve,Me,Je){var gt=Me.type;return gt===F?Ge(Ce,ve,Me.props.children,Je,Me.key):ve!==null&&(ve.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===X&&I1(gt)===ve.type)?(Je=R(ve,Me.props),Je.ref=ah(Ce,ve,Me),Je.return=Ce,Je):(Je=Cp(Me.type,Me.key,Me.props,null,Ce.mode,Je),Je.ref=ah(Ce,ve,Me),Je.return=Ce,Je)}function Oe(Ce,ve,Me,Je){return ve===null||ve.tag!==4||ve.stateNode.containerInfo!==Me.containerInfo||ve.stateNode.implementation!==Me.implementation?(ve=Bv(Me,Ce.mode,Je),ve.return=Ce,ve):(ve=R(ve,Me.children||[]),ve.return=Ce,ve)}function Ge(Ce,ve,Me,Je,gt){return ve===null||ve.tag!==7?(ve=Vd(Me,Ce.mode,Je,gt),ve.return=Ce,ve):(ve=R(ve,Me),ve.return=Ce,ve)}function Ke(Ce,ve,Me){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return ve=Uv(""+ve,Ce.mode,Me),ve.return=Ce,ve;if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case D:return Me=Cp(ve.type,ve.key,ve.props,null,Ce.mode,Me),Me.ref=ah(Ce,null,ve),Me.return=Ce,Me;case I:return ve=Bv(ve,Ce.mode,Me),ve.return=Ce,ve;case X:var Je=ve._init;return Ke(Ce,Je(ve._payload),Me)}if(ee(ve)||K(ve))return ve=Vd(ve,Ce.mode,Me,null),ve.return=Ce,ve;np(Ce,ve)}return null}function Ye(Ce,ve,Me,Je){var gt=ve!==null?ve.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number")return gt!==null?null:fe(Ce,ve,""+Me,Je);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case D:return Me.key===gt?ge(Ce,ve,Me,Je):null;case I:return Me.key===gt?Oe(Ce,ve,Me,Je):null;case X:return gt=Me._init,Ye(Ce,ve,gt(Me._payload),Je)}if(ee(Me)||K(Me))return gt!==null?null:Ge(Ce,ve,Me,Je,null);np(Ce,Me)}return null}function at(Ce,ve,Me,Je,gt){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return Ce=Ce.get(Me)||null,fe(ve,Ce,""+Je,gt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case D:return Ce=Ce.get(Je.key===null?Me:Je.key)||null,ge(ve,Ce,Je,gt);case I:return Ce=Ce.get(Je.key===null?Me:Je.key)||null,Oe(ve,Ce,Je,gt);case X:var Tt=Je._init;return at(Ce,ve,Me,Tt(Je._payload),gt)}if(ee(Je)||K(Je))return Ce=Ce.get(Me)||null,Ge(ve,Ce,Je,gt,null);np(ve,Je)}return null}function ut(Ce,ve,Me,Je){for(var gt=null,Tt=null,kt=ve,Rt=ve=0,Rr=null;kt!==null&&Rt<Me.length;Rt++){kt.index>Rt?(Rr=kt,kt=null):Rr=kt.sibling;var fn=Ye(Ce,kt,Me[Rt],Je);if(fn===null){kt===null&&(kt=Rr);break}u&&kt&&fn.alternate===null&&m(Ce,kt),ve=z(fn,ve,Rt),Tt===null?gt=fn:Tt.sibling=fn,Tt=fn,kt=Rr}if(Rt===Me.length)return w(Ce,kt),$n&&Ad(Ce,Rt),gt;if(kt===null){for(;Rt<Me.length;Rt++)kt=Ke(Ce,Me[Rt],Je),kt!==null&&(ve=z(kt,ve,Rt),Tt===null?gt=kt:Tt.sibling=kt,Tt=kt);return $n&&Ad(Ce,Rt),gt}for(kt=k(Ce,kt);Rt<Me.length;Rt++)Rr=at(kt,Ce,Rt,Me[Rt],Je),Rr!==null&&(u&&Rr.alternate!==null&&kt.delete(Rr.key===null?Rt:Rr.key),ve=z(Rr,ve,Rt),Tt===null?gt=Rr:Tt.sibling=Rr,Tt=Rr);return u&&kt.forEach(function(jc){return m(Ce,jc)}),$n&&Ad(Ce,Rt),gt}function mt(Ce,ve,Me,Je){var gt=K(Me);if(typeof gt!="function")throw Error(t(150));if(Me=gt.call(Me),Me==null)throw Error(t(151));for(var Tt=gt=null,kt=ve,Rt=ve=0,Rr=null,fn=Me.next();kt!==null&&!fn.done;Rt++,fn=Me.next()){kt.index>Rt?(Rr=kt,kt=null):Rr=kt.sibling;var jc=Ye(Ce,kt,fn.value,Je);if(jc===null){kt===null&&(kt=Rr);break}u&&kt&&jc.alternate===null&&m(Ce,kt),ve=z(jc,ve,Rt),Tt===null?gt=jc:Tt.sibling=jc,Tt=jc,kt=Rr}if(fn.done)return w(Ce,kt),$n&&Ad(Ce,Rt),gt;if(kt===null){for(;!fn.done;Rt++,fn=Me.next())fn=Ke(Ce,fn.value,Je),fn!==null&&(ve=z(fn,ve,Rt),Tt===null?gt=fn:Tt.sibling=fn,Tt=fn);return $n&&Ad(Ce,Rt),gt}for(kt=k(Ce,kt);!fn.done;Rt++,fn=Me.next())fn=at(kt,Ce,Rt,fn.value,Je),fn!==null&&(u&&fn.alternate!==null&&kt.delete(fn.key===null?Rt:fn.key),ve=z(fn,ve,Rt),Tt===null?gt=fn:Tt.sibling=fn,Tt=fn);return u&&kt.forEach(function(Rq){return m(Ce,Rq)}),$n&&Ad(Ce,Rt),gt}function ar(Ce,ve,Me,Je){if(typeof Me=="object"&&Me!==null&&Me.type===F&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case D:e:{for(var gt=Me.key,Tt=ve;Tt!==null;){if(Tt.key===gt){if(gt=Me.type,gt===F){if(Tt.tag===7){w(Ce,Tt.sibling),ve=R(Tt,Me.props.children),ve.return=Ce,Ce=ve;break e}}else if(Tt.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===X&&I1(gt)===Tt.type){w(Ce,Tt.sibling),ve=R(Tt,Me.props),ve.ref=ah(Ce,Tt,Me),ve.return=Ce,Ce=ve;break e}w(Ce,Tt);break}else m(Ce,Tt);Tt=Tt.sibling}Me.type===F?(ve=Vd(Me.props.children,Ce.mode,Je,Me.key),ve.return=Ce,Ce=ve):(Je=Cp(Me.type,Me.key,Me.props,null,Ce.mode,Je),Je.ref=ah(Ce,ve,Me),Je.return=Ce,Ce=Je)}return J(Ce);case I:e:{for(Tt=Me.key;ve!==null;){if(ve.key===Tt)if(ve.tag===4&&ve.stateNode.containerInfo===Me.containerInfo&&ve.stateNode.implementation===Me.implementation){w(Ce,ve.sibling),ve=R(ve,Me.children||[]),ve.return=Ce,Ce=ve;break e}else{w(Ce,ve);break}else m(Ce,ve);ve=ve.sibling}ve=Bv(Me,Ce.mode,Je),ve.return=Ce,Ce=ve}return J(Ce);case X:return Tt=Me._init,ar(Ce,ve,Tt(Me._payload),Je)}if(ee(Me))return ut(Ce,ve,Me,Je);if(K(Me))return mt(Ce,ve,Me,Je);np(Ce,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"?(Me=""+Me,ve!==null&&ve.tag===6?(w(Ce,ve.sibling),ve=R(ve,Me),ve.return=Ce,Ce=ve):(w(Ce,ve),ve=Uv(Me,Ce.mode,Je),ve.return=Ce,Ce=ve),J(Ce)):w(Ce,ve)}return ar}var Fu=A1(!0),R1=A1(!1),rp=fc(null),sp=null,qu=null,Jy=null;function Qy(){Jy=qu=sp=null}function Xy(u){var m=rp.current;zn(rp),u._currentValue=m}function ev(u,m,w){for(;u!==null;){var k=u.alternate;if((u.childLanes&m)!==m?(u.childLanes|=m,k!==null&&(k.childLanes|=m)):k!==null&&(k.childLanes&m)!==m&&(k.childLanes|=m),u===w)break;u=u.return}}function zu(u,m){sp=u,Jy=qu=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&m)!==0&&(zs=!0),u.firstContext=null)}function zi(u){var m=u._currentValue;if(Jy!==u)if(u={context:u,memoizedValue:m,next:null},qu===null){if(sp===null)throw Error(t(308));qu=u,sp.dependencies={lanes:0,firstContext:u}}else qu=qu.next=u;return m}var Rd=null;function tv(u){Rd===null?Rd=[u]:Rd.push(u)}function L1(u,m,w,k){var R=m.interleaved;return R===null?(w.next=w,tv(m)):(w.next=R.next,R.next=w),m.interleaved=w,ll(u,k)}function ll(u,m){u.lanes|=m;var w=u.alternate;for(w!==null&&(w.lanes|=m),w=u,u=u.return;u!==null;)u.childLanes|=m,w=u.alternate,w!==null&&(w.childLanes|=m),w=u,u=u.return;return w.tag===3?w.stateNode:null}var pc=!1;function nv(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function F1(u,m){u=u.updateQueue,m.updateQueue===u&&(m.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function cl(u,m){return{eventTime:u,lane:m,tag:0,payload:null,callback:null,next:null}}function gc(u,m,w){var k=u.updateQueue;if(k===null)return null;if(k=k.shared,(cn&2)!==0){var R=k.pending;return R===null?m.next=m:(m.next=R.next,R.next=m),k.pending=m,ll(u,w)}return R=k.interleaved,R===null?(m.next=m,tv(k)):(m.next=R.next,R.next=m),k.interleaved=m,ll(u,w)}function ip(u,m,w){if(m=m.updateQueue,m!==null&&(m=m.shared,(w&4194240)!==0)){var k=m.lanes;k&=u.pendingLanes,w|=k,m.lanes=w,hs(u,w)}}function q1(u,m){var w=u.updateQueue,k=u.alternate;if(k!==null&&(k=k.updateQueue,w===k)){var R=null,z=null;if(w=w.firstBaseUpdate,w!==null){do{var J={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};z===null?R=z=J:z=z.next=J,w=w.next}while(w!==null);z===null?R=z=m:z=z.next=m}else R=z=m;w={baseState:k.baseState,firstBaseUpdate:R,lastBaseUpdate:z,shared:k.shared,effects:k.effects},u.updateQueue=w;return}u=w.lastBaseUpdate,u===null?w.firstBaseUpdate=m:u.next=m,w.lastBaseUpdate=m}function ap(u,m,w,k){var R=u.updateQueue;pc=!1;var z=R.firstBaseUpdate,J=R.lastBaseUpdate,fe=R.shared.pending;if(fe!==null){R.shared.pending=null;var ge=fe,Oe=ge.next;ge.next=null,J===null?z=Oe:J.next=Oe,J=ge;var Ge=u.alternate;Ge!==null&&(Ge=Ge.updateQueue,fe=Ge.lastBaseUpdate,fe!==J&&(fe===null?Ge.firstBaseUpdate=Oe:fe.next=Oe,Ge.lastBaseUpdate=ge))}if(z!==null){var Ke=R.baseState;J=0,Ge=Oe=ge=null,fe=z;do{var Ye=fe.lane,at=fe.eventTime;if((k&Ye)===Ye){Ge!==null&&(Ge=Ge.next={eventTime:at,lane:0,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null});e:{var ut=u,mt=fe;switch(Ye=m,at=w,mt.tag){case 1:if(ut=mt.payload,typeof ut=="function"){Ke=ut.call(at,Ke,Ye);break e}Ke=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=mt.payload,Ye=typeof ut=="function"?ut.call(at,Ke,Ye):ut,Ye==null)break e;Ke=te({},Ke,Ye);break e;case 2:pc=!0}}fe.callback!==null&&fe.lane!==0&&(u.flags|=64,Ye=R.effects,Ye===null?R.effects=[fe]:Ye.push(fe))}else at={eventTime:at,lane:Ye,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},Ge===null?(Oe=Ge=at,ge=Ke):Ge=Ge.next=at,J|=Ye;if(fe=fe.next,fe===null){if(fe=R.shared.pending,fe===null)break;Ye=fe,fe=Ye.next,Ye.next=null,R.lastBaseUpdate=Ye,R.shared.pending=null}}while(!0);if(Ge===null&&(ge=Ke),R.baseState=ge,R.firstBaseUpdate=Oe,R.lastBaseUpdate=Ge,m=R.shared.interleaved,m!==null){R=m;do J|=R.lane,R=R.next;while(R!==m)}else z===null&&(R.shared.lanes=0);qd|=J,u.lanes=J,u.memoizedState=Ke}}function z1(u,m,w){if(u=m.effects,m.effects=null,u!==null)for(m=0;m<u.length;m++){var k=u[m],R=k.callback;if(R!==null){if(k.callback=null,k=w,typeof R!="function")throw Error(t(191,R));R.call(k)}}}var oh={},fo=fc(oh),lh=fc(oh),ch=fc(oh);function Ld(u){if(u===oh)throw Error(t(174));return u}function rv(u,m){switch(Rn(ch,m),Rn(lh,u),Rn(fo,oh),u=m.nodeType,u){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:Xe(null,"");break;default:u=u===8?m.parentNode:m,m=u.namespaceURI||null,u=u.tagName,m=Xe(m,u)}zn(fo),Rn(fo,m)}function Uu(){zn(fo),zn(lh),zn(ch)}function U1(u){Ld(ch.current);var m=Ld(fo.current),w=Xe(m,u.type);m!==w&&(Rn(lh,u),Rn(fo,w))}function sv(u){lh.current===u&&(zn(fo),zn(lh))}var Zn=fc(0);function op(u){for(var m=u;m!==null;){if(m.tag===13){var w=m.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||w.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===u)break;for(;m.sibling===null;){if(m.return===null||m.return===u)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var iv=[];function av(){for(var u=0;u<iv.length;u++)iv[u]._workInProgressVersionPrimary=null;iv.length=0}var lp=M.ReactCurrentDispatcher,ov=M.ReactCurrentBatchConfig,Fd=0,Kn=null,Nr=null,Ir=null,cp=!1,dh=!1,uh=0,sq=0;function ns(){throw Error(t(321))}function lv(u,m){if(m===null)return!1;for(var w=0;w<m.length&&w<u.length;w++)if(!Wr(u[w],m[w]))return!1;return!0}function cv(u,m,w,k,R,z){if(Fd=z,Kn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,lp.current=u===null||u.memoizedState===null?lq:cq,u=w(k,R),dh){z=0;do{if(dh=!1,uh=0,25<=z)throw Error(t(301));z+=1,Ir=Nr=null,m.updateQueue=null,lp.current=dq,u=w(k,R)}while(dh)}if(lp.current=fp,m=Nr!==null&&Nr.next!==null,Fd=0,Ir=Nr=Kn=null,cp=!1,m)throw Error(t(300));return u}function dv(){var u=uh!==0;return uh=0,u}function ho(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ir===null?Kn.memoizedState=Ir=u:Ir=Ir.next=u,Ir}function Ui(){if(Nr===null){var u=Kn.alternate;u=u!==null?u.memoizedState:null}else u=Nr.next;var m=Ir===null?Kn.memoizedState:Ir.next;if(m!==null)Ir=m,Nr=u;else{if(u===null)throw Error(t(310));Nr=u,u={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},Ir===null?Kn.memoizedState=Ir=u:Ir=Ir.next=u}return Ir}function fh(u,m){return typeof m=="function"?m(u):m}function uv(u){var m=Ui(),w=m.queue;if(w===null)throw Error(t(311));w.lastRenderedReducer=u;var k=Nr,R=k.baseQueue,z=w.pending;if(z!==null){if(R!==null){var J=R.next;R.next=z.next,z.next=J}k.baseQueue=R=z,w.pending=null}if(R!==null){z=R.next,k=k.baseState;var fe=J=null,ge=null,Oe=z;do{var Ge=Oe.lane;if((Fd&Ge)===Ge)ge!==null&&(ge=ge.next={lane:0,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null}),k=Oe.hasEagerState?Oe.eagerState:u(k,Oe.action);else{var Ke={lane:Ge,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null};ge===null?(fe=ge=Ke,J=k):ge=ge.next=Ke,Kn.lanes|=Ge,qd|=Ge}Oe=Oe.next}while(Oe!==null&&Oe!==z);ge===null?J=k:ge.next=fe,Wr(k,m.memoizedState)||(zs=!0),m.memoizedState=k,m.baseState=J,m.baseQueue=ge,w.lastRenderedState=k}if(u=w.interleaved,u!==null){R=u;do z=R.lane,Kn.lanes|=z,qd|=z,R=R.next;while(R!==u)}else R===null&&(w.lanes=0);return[m.memoizedState,w.dispatch]}function fv(u){var m=Ui(),w=m.queue;if(w===null)throw Error(t(311));w.lastRenderedReducer=u;var k=w.dispatch,R=w.pending,z=m.memoizedState;if(R!==null){w.pending=null;var J=R=R.next;do z=u(z,J.action),J=J.next;while(J!==R);Wr(z,m.memoizedState)||(zs=!0),m.memoizedState=z,m.baseQueue===null&&(m.baseState=z),w.lastRenderedState=z}return[z,k]}function B1(){}function V1(u,m){var w=Kn,k=Ui(),R=m(),z=!Wr(k.memoizedState,R);if(z&&(k.memoizedState=R,zs=!0),k=k.queue,hv(H1.bind(null,w,k,u),[u]),k.getSnapshot!==m||z||Ir!==null&&Ir.memoizedState.tag&1){if(w.flags|=2048,hh(9,$1.bind(null,w,k,R,m),void 0,null),Ar===null)throw Error(t(349));(Fd&30)!==0||W1(w,m,R)}return R}function W1(u,m,w){u.flags|=16384,u={getSnapshot:m,value:w},m=Kn.updateQueue,m===null?(m={lastEffect:null,stores:null},Kn.updateQueue=m,m.stores=[u]):(w=m.stores,w===null?m.stores=[u]:w.push(u))}function $1(u,m,w,k){m.value=w,m.getSnapshot=k,Y1(m)&&G1(u)}function H1(u,m,w){return w(function(){Y1(m)&&G1(u)})}function Y1(u){var m=u.getSnapshot;u=u.value;try{var w=m();return!Wr(u,w)}catch{return!0}}function G1(u){var m=ll(u,1);m!==null&&wa(m,u,1,-1)}function Z1(u){var m=ho();return typeof u=="function"&&(u=u()),m.memoizedState=m.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fh,lastRenderedState:u},m.queue=u,u=u.dispatch=oq.bind(null,Kn,u),[m.memoizedState,u]}function hh(u,m,w,k){return u={tag:u,create:m,destroy:w,deps:k,next:null},m=Kn.updateQueue,m===null?(m={lastEffect:null,stores:null},Kn.updateQueue=m,m.lastEffect=u.next=u):(w=m.lastEffect,w===null?m.lastEffect=u.next=u:(k=w.next,w.next=u,u.next=k,m.lastEffect=u)),u}function K1(){return Ui().memoizedState}function dp(u,m,w,k){var R=ho();Kn.flags|=u,R.memoizedState=hh(1|m,w,void 0,k===void 0?null:k)}function up(u,m,w,k){var R=Ui();k=k===void 0?null:k;var z=void 0;if(Nr!==null){var J=Nr.memoizedState;if(z=J.destroy,k!==null&&lv(k,J.deps)){R.memoizedState=hh(m,w,z,k);return}}Kn.flags|=u,R.memoizedState=hh(1|m,w,z,k)}function J1(u,m){return dp(8390656,8,u,m)}function hv(u,m){return up(2048,8,u,m)}function Q1(u,m){return up(4,2,u,m)}function X1(u,m){return up(4,4,u,m)}function eT(u,m){if(typeof m=="function")return u=u(),m(u),function(){m(null)};if(m!=null)return u=u(),m.current=u,function(){m.current=null}}function tT(u,m,w){return w=w!=null?w.concat([u]):null,up(4,4,eT.bind(null,m,u),w)}function mv(){}function nT(u,m){var w=Ui();m=m===void 0?null:m;var k=w.memoizedState;return k!==null&&m!==null&&lv(m,k[1])?k[0]:(w.memoizedState=[u,m],u)}function rT(u,m){var w=Ui();m=m===void 0?null:m;var k=w.memoizedState;return k!==null&&m!==null&&lv(m,k[1])?k[0]:(u=u(),w.memoizedState=[u,m],u)}function sT(u,m,w){return(Fd&21)===0?(u.baseState&&(u.baseState=!1,zs=!0),u.memoizedState=w):(Wr(w,m)||(w=Ul(),Kn.lanes|=w,qd|=w,u.baseState=!0),m)}function iq(u,m){var w=Jt;Jt=w!==0&&4>w?w:4,u(!0);var k=ov.transition;ov.transition={};try{u(!1),m()}finally{Jt=w,ov.transition=k}}function iT(){return Ui().memoizedState}function aq(u,m,w){var k=bc(u);if(w={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null},aT(u))oT(m,w);else if(w=L1(u,m,w,k),w!==null){var R=bs();wa(w,u,k,R),lT(w,m,k)}}function oq(u,m,w){var k=bc(u),R={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null};if(aT(u))oT(m,R);else{var z=u.alternate;if(u.lanes===0&&(z===null||z.lanes===0)&&(z=m.lastRenderedReducer,z!==null))try{var J=m.lastRenderedState,fe=z(J,w);if(R.hasEagerState=!0,R.eagerState=fe,Wr(fe,J)){var ge=m.interleaved;ge===null?(R.next=R,tv(m)):(R.next=ge.next,ge.next=R),m.interleaved=R;return}}catch{}finally{}w=L1(u,m,R,k),w!==null&&(R=bs(),wa(w,u,k,R),lT(w,m,k))}}function aT(u){var m=u.alternate;return u===Kn||m!==null&&m===Kn}function oT(u,m){dh=cp=!0;var w=u.pending;w===null?m.next=m:(m.next=w.next,w.next=m),u.pending=m}function lT(u,m,w){if((w&4194240)!==0){var k=m.lanes;k&=u.pendingLanes,w|=k,m.lanes=w,hs(u,w)}}var fp={readContext:zi,useCallback:ns,useContext:ns,useEffect:ns,useImperativeHandle:ns,useInsertionEffect:ns,useLayoutEffect:ns,useMemo:ns,useReducer:ns,useRef:ns,useState:ns,useDebugValue:ns,useDeferredValue:ns,useTransition:ns,useMutableSource:ns,useSyncExternalStore:ns,useId:ns,unstable_isNewReconciler:!1},lq={readContext:zi,useCallback:function(u,m){return ho().memoizedState=[u,m===void 0?null:m],u},useContext:zi,useEffect:J1,useImperativeHandle:function(u,m,w){return w=w!=null?w.concat([u]):null,dp(4194308,4,eT.bind(null,m,u),w)},useLayoutEffect:function(u,m){return dp(4194308,4,u,m)},useInsertionEffect:function(u,m){return dp(4,2,u,m)},useMemo:function(u,m){var w=ho();return m=m===void 0?null:m,u=u(),w.memoizedState=[u,m],u},useReducer:function(u,m,w){var k=ho();return m=w!==void 0?w(m):m,k.memoizedState=k.baseState=m,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:m},k.queue=u,u=u.dispatch=aq.bind(null,Kn,u),[k.memoizedState,u]},useRef:function(u){var m=ho();return u={current:u},m.memoizedState=u},useState:Z1,useDebugValue:mv,useDeferredValue:function(u){return ho().memoizedState=u},useTransition:function(){var u=Z1(!1),m=u[0];return u=iq.bind(null,u[1]),ho().memoizedState=u,[m,u]},useMutableSource:function(){},useSyncExternalStore:function(u,m,w){var k=Kn,R=ho();if($n){if(w===void 0)throw Error(t(407));w=w()}else{if(w=m(),Ar===null)throw Error(t(349));(Fd&30)!==0||W1(k,m,w)}R.memoizedState=w;var z={value:w,getSnapshot:m};return R.queue=z,J1(H1.bind(null,k,z,u),[u]),k.flags|=2048,hh(9,$1.bind(null,k,z,w,m),void 0,null),w},useId:function(){var u=ho(),m=Ar.identifierPrefix;if($n){var w=ol,k=al;w=(k&~(1<<32-Dt(k)-1)).toString(32)+w,m=":"+m+"R"+w,w=uh++,0<w&&(m+="H"+w.toString(32)),m+=":"}else w=sq++,m=":"+m+"r"+w.toString(32)+":";return u.memoizedState=m},unstable_isNewReconciler:!1},cq={readContext:zi,useCallback:nT,useContext:zi,useEffect:hv,useImperativeHandle:tT,useInsertionEffect:Q1,useLayoutEffect:X1,useMemo:rT,useReducer:uv,useRef:K1,useState:function(){return uv(fh)},useDebugValue:mv,useDeferredValue:function(u){var m=Ui();return sT(m,Nr.memoizedState,u)},useTransition:function(){var u=uv(fh)[0],m=Ui().memoizedState;return[u,m]},useMutableSource:B1,useSyncExternalStore:V1,useId:iT,unstable_isNewReconciler:!1},dq={readContext:zi,useCallback:nT,useContext:zi,useEffect:hv,useImperativeHandle:tT,useInsertionEffect:Q1,useLayoutEffect:X1,useMemo:rT,useReducer:fv,useRef:K1,useState:function(){return fv(fh)},useDebugValue:mv,useDeferredValue:function(u){var m=Ui();return Nr===null?m.memoizedState=u:sT(m,Nr.memoizedState,u)},useTransition:function(){var u=fv(fh)[0],m=Ui().memoizedState;return[u,m]},useMutableSource:B1,useSyncExternalStore:V1,useId:iT,unstable_isNewReconciler:!1};function ya(u,m){if(u&&u.defaultProps){m=te({},m),u=u.defaultProps;for(var w in u)m[w]===void 0&&(m[w]=u[w]);return m}return m}function pv(u,m,w,k){m=u.memoizedState,w=w(k,m),w=w==null?m:te({},m,w),u.memoizedState=w,u.lanes===0&&(u.updateQueue.baseState=w)}var hp={isMounted:function(u){return(u=u._reactInternals)?Ds(u)===u:!1},enqueueSetState:function(u,m,w){u=u._reactInternals;var k=bs(),R=bc(u),z=cl(k,R);z.payload=m,w!=null&&(z.callback=w),m=gc(u,z,R),m!==null&&(wa(m,u,R,k),ip(m,u,R))},enqueueReplaceState:function(u,m,w){u=u._reactInternals;var k=bs(),R=bc(u),z=cl(k,R);z.tag=1,z.payload=m,w!=null&&(z.callback=w),m=gc(u,z,R),m!==null&&(wa(m,u,R,k),ip(m,u,R))},enqueueForceUpdate:function(u,m){u=u._reactInternals;var w=bs(),k=bc(u),R=cl(w,k);R.tag=2,m!=null&&(R.callback=m),m=gc(u,R,k),m!==null&&(wa(m,u,k,w),ip(m,u,k))}};function cT(u,m,w,k,R,z,J){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(k,z,J):m.prototype&&m.prototype.isPureReactComponent?!Ls(w,k)||!Ls(R,z):!0}function dT(u,m,w){var k=!1,R=hc,z=m.contextType;return typeof z=="object"&&z!==null?z=zi(z):(R=qs(m)?Od:ts.current,k=m.contextTypes,z=(k=k!=null)?Iu(u,R):hc),m=new m(w,z),u.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=hp,u.stateNode=m,m._reactInternals=u,k&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=R,u.__reactInternalMemoizedMaskedChildContext=z),m}function uT(u,m,w,k){u=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(w,k),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(w,k),m.state!==u&&hp.enqueueReplaceState(m,m.state,null)}function gv(u,m,w,k){var R=u.stateNode;R.props=w,R.state=u.memoizedState,R.refs={},nv(u);var z=m.contextType;typeof z=="object"&&z!==null?R.context=zi(z):(z=qs(m)?Od:ts.current,R.context=Iu(u,z)),R.state=u.memoizedState,z=m.getDerivedStateFromProps,typeof z=="function"&&(pv(u,m,z,w),R.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(m=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),m!==R.state&&hp.enqueueReplaceState(R,R.state,null),ap(u,w,R,k),R.state=u.memoizedState),typeof R.componentDidMount=="function"&&(u.flags|=4194308)}function Bu(u,m){try{var w="",k=m;do w+=ie(k),k=k.return;while(k);var R=w}catch(z){R=`
Error generating stack: `+z.message+`
`+z.stack}return{value:u,source:m,stack:R,digest:null}}function xv(u,m,w){return{value:u,source:null,stack:w??null,digest:m??null}}function yv(u,m){try{console.error(m.value)}catch(w){setTimeout(function(){throw w})}}var uq=typeof WeakMap=="function"?WeakMap:Map;function fT(u,m,w){w=cl(-1,w),w.tag=3,w.payload={element:null};var k=m.value;return w.callback=function(){bp||(bp=!0,Ov=k),yv(u,m)},w}function hT(u,m,w){w=cl(-1,w),w.tag=3;var k=u.type.getDerivedStateFromError;if(typeof k=="function"){var R=m.value;w.payload=function(){return k(R)},w.callback=function(){yv(u,m)}}var z=u.stateNode;return z!==null&&typeof z.componentDidCatch=="function"&&(w.callback=function(){yv(u,m),typeof k!="function"&&(yc===null?yc=new Set([this]):yc.add(this));var J=m.stack;this.componentDidCatch(m.value,{componentStack:J!==null?J:""})}),w}function mT(u,m,w){var k=u.pingCache;if(k===null){k=u.pingCache=new uq;var R=new Set;k.set(m,R)}else R=k.get(m),R===void 0&&(R=new Set,k.set(m,R));R.has(w)||(R.add(w),u=Nq.bind(null,u,m,w),m.then(u,u))}function pT(u){do{var m;if((m=u.tag===13)&&(m=u.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return u;u=u.return}while(u!==null);return null}function gT(u,m,w,k,R){return(u.mode&1)===0?(u===m?u.flags|=65536:(u.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(m=cl(-1,1),m.tag=2,gc(w,m,1))),w.lanes|=1),u):(u.flags|=65536,u.lanes=R,u)}var fq=M.ReactCurrentOwner,zs=!1;function vs(u,m,w,k){m.child=u===null?R1(m,null,w,k):Fu(m,u.child,w,k)}function xT(u,m,w,k,R){w=w.render;var z=m.ref;return zu(m,R),k=cv(u,m,w,k,z,R),w=dv(),u!==null&&!zs?(m.updateQueue=u.updateQueue,m.flags&=-2053,u.lanes&=~R,dl(u,m,R)):($n&&w&&Hy(m),m.flags|=1,vs(u,m,k,R),m.child)}function yT(u,m,w,k,R){if(u===null){var z=w.type;return typeof z=="function"&&!zv(z)&&z.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(m.tag=15,m.type=z,vT(u,m,z,k,R)):(u=Cp(w.type,null,k,m,m.mode,R),u.ref=m.ref,u.return=m,m.child=u)}if(z=u.child,(u.lanes&R)===0){var J=z.memoizedProps;if(w=w.compare,w=w!==null?w:Ls,w(J,k)&&u.ref===m.ref)return dl(u,m,R)}return m.flags|=1,u=_c(z,k),u.ref=m.ref,u.return=m,m.child=u}function vT(u,m,w,k,R){if(u!==null){var z=u.memoizedProps;if(Ls(z,k)&&u.ref===m.ref)if(zs=!1,m.pendingProps=k=z,(u.lanes&R)!==0)(u.flags&131072)!==0&&(zs=!0);else return m.lanes=u.lanes,dl(u,m,R)}return vv(u,m,w,k,R)}function bT(u,m,w){var k=m.pendingProps,R=k.children,z=u!==null?u.memoizedState:null;if(k.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rn(Wu,fi),fi|=w;else{if((w&1073741824)===0)return u=z!==null?z.baseLanes|w:w,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:u,cachePool:null,transitions:null},m.updateQueue=null,Rn(Wu,fi),fi|=u,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},k=z!==null?z.baseLanes:w,Rn(Wu,fi),fi|=k}else z!==null?(k=z.baseLanes|w,m.memoizedState=null):k=w,Rn(Wu,fi),fi|=k;return vs(u,m,R,w),m.child}function wT(u,m){var w=m.ref;(u===null&&w!==null||u!==null&&u.ref!==w)&&(m.flags|=512,m.flags|=2097152)}function vv(u,m,w,k,R){var z=qs(w)?Od:ts.current;return z=Iu(m,z),zu(m,R),w=cv(u,m,w,k,z,R),k=dv(),u!==null&&!zs?(m.updateQueue=u.updateQueue,m.flags&=-2053,u.lanes&=~R,dl(u,m,R)):($n&&k&&Hy(m),m.flags|=1,vs(u,m,w,R),m.child)}function _T(u,m,w,k,R){if(qs(w)){var z=!0;Jm(m)}else z=!1;if(zu(m,R),m.stateNode===null)pp(u,m),dT(m,w,k),gv(m,w,k,R),k=!0;else if(u===null){var J=m.stateNode,fe=m.memoizedProps;J.props=fe;var ge=J.context,Oe=w.contextType;typeof Oe=="object"&&Oe!==null?Oe=zi(Oe):(Oe=qs(w)?Od:ts.current,Oe=Iu(m,Oe));var Ge=w.getDerivedStateFromProps,Ke=typeof Ge=="function"||typeof J.getSnapshotBeforeUpdate=="function";Ke||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(fe!==k||ge!==Oe)&&uT(m,J,k,Oe),pc=!1;var Ye=m.memoizedState;J.state=Ye,ap(m,k,J,R),ge=m.memoizedState,fe!==k||Ye!==ge||Fs.current||pc?(typeof Ge=="function"&&(pv(m,w,Ge,k),ge=m.memoizedState),(fe=pc||cT(m,w,fe,k,Ye,ge,Oe))?(Ke||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(m.flags|=4194308)):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=k,m.memoizedState=ge),J.props=k,J.state=ge,J.context=Oe,k=fe):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),k=!1)}else{J=m.stateNode,F1(u,m),fe=m.memoizedProps,Oe=m.type===m.elementType?fe:ya(m.type,fe),J.props=Oe,Ke=m.pendingProps,Ye=J.context,ge=w.contextType,typeof ge=="object"&&ge!==null?ge=zi(ge):(ge=qs(w)?Od:ts.current,ge=Iu(m,ge));var at=w.getDerivedStateFromProps;(Ge=typeof at=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(fe!==Ke||Ye!==ge)&&uT(m,J,k,ge),pc=!1,Ye=m.memoizedState,J.state=Ye,ap(m,k,J,R);var ut=m.memoizedState;fe!==Ke||Ye!==ut||Fs.current||pc?(typeof at=="function"&&(pv(m,w,at,k),ut=m.memoizedState),(Oe=pc||cT(m,w,Oe,k,Ye,ut,ge)||!1)?(Ge||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(k,ut,ge),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(k,ut,ge)),typeof J.componentDidUpdate=="function"&&(m.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof J.componentDidUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=1024),m.memoizedProps=k,m.memoizedState=ut),J.props=k,J.state=ut,J.context=ge,k=Oe):(typeof J.componentDidUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=1024),k=!1)}return bv(u,m,w,k,z,R)}function bv(u,m,w,k,R,z){wT(u,m);var J=(m.flags&128)!==0;if(!k&&!J)return R&&T1(m,w,!1),dl(u,m,z);k=m.stateNode,fq.current=m;var fe=J&&typeof w.getDerivedStateFromError!="function"?null:k.render();return m.flags|=1,u!==null&&J?(m.child=Fu(m,u.child,null,z),m.child=Fu(m,null,fe,z)):vs(u,m,fe,z),m.memoizedState=k.state,R&&T1(m,w,!0),m.child}function jT(u){var m=u.stateNode;m.pendingContext?N1(u,m.pendingContext,m.pendingContext!==m.context):m.context&&N1(u,m.context,!1),rv(u,m.containerInfo)}function ST(u,m,w,k,R){return Lu(),Ky(R),m.flags|=256,vs(u,m,w,k),m.child}var wv={dehydrated:null,treeContext:null,retryLane:0};function _v(u){return{baseLanes:u,cachePool:null,transitions:null}}function NT(u,m,w){var k=m.pendingProps,R=Zn.current,z=!1,J=(m.flags&128)!==0,fe;if((fe=J)||(fe=u!==null&&u.memoizedState===null?!1:(R&2)!==0),fe?(z=!0,m.flags&=-129):(u===null||u.memoizedState!==null)&&(R|=1),Rn(Zn,R&1),u===null)return Zy(m),u=m.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((m.mode&1)===0?m.lanes=1:u.data==="$!"?m.lanes=8:m.lanes=1073741824,null):(J=k.children,u=k.fallback,z?(k=m.mode,z=m.child,J={mode:"hidden",children:J},(k&1)===0&&z!==null?(z.childLanes=0,z.pendingProps=J):z=Tp(J,k,0,null),u=Vd(u,k,w,null),z.return=m,u.return=m,z.sibling=u,m.child=z,m.child.memoizedState=_v(w),m.memoizedState=wv,u):jv(m,J));if(R=u.memoizedState,R!==null&&(fe=R.dehydrated,fe!==null))return hq(u,m,J,k,fe,R,w);if(z){z=k.fallback,J=m.mode,R=u.child,fe=R.sibling;var ge={mode:"hidden",children:k.children};return(J&1)===0&&m.child!==R?(k=m.child,k.childLanes=0,k.pendingProps=ge,m.deletions=null):(k=_c(R,ge),k.subtreeFlags=R.subtreeFlags&14680064),fe!==null?z=_c(fe,z):(z=Vd(z,J,w,null),z.flags|=2),z.return=m,k.return=m,k.sibling=z,m.child=k,k=z,z=m.child,J=u.child.memoizedState,J=J===null?_v(w):{baseLanes:J.baseLanes|w,cachePool:null,transitions:J.transitions},z.memoizedState=J,z.childLanes=u.childLanes&~w,m.memoizedState=wv,k}return z=u.child,u=z.sibling,k=_c(z,{mode:"visible",children:k.children}),(m.mode&1)===0&&(k.lanes=w),k.return=m,k.sibling=null,u!==null&&(w=m.deletions,w===null?(m.deletions=[u],m.flags|=16):w.push(u)),m.child=k,m.memoizedState=null,k}function jv(u,m){return m=Tp({mode:"visible",children:m},u.mode,0,null),m.return=u,u.child=m}function mp(u,m,w,k){return k!==null&&Ky(k),Fu(m,u.child,null,w),u=jv(m,m.pendingProps.children),u.flags|=2,m.memoizedState=null,u}function hq(u,m,w,k,R,z,J){if(w)return m.flags&256?(m.flags&=-257,k=xv(Error(t(422))),mp(u,m,J,k)):m.memoizedState!==null?(m.child=u.child,m.flags|=128,null):(z=k.fallback,R=m.mode,k=Tp({mode:"visible",children:k.children},R,0,null),z=Vd(z,R,J,null),z.flags|=2,k.return=m,z.return=m,k.sibling=z,m.child=k,(m.mode&1)!==0&&Fu(m,u.child,null,J),m.child.memoizedState=_v(J),m.memoizedState=wv,z);if((m.mode&1)===0)return mp(u,m,J,null);if(R.data==="$!"){if(k=R.nextSibling&&R.nextSibling.dataset,k)var fe=k.dgst;return k=fe,z=Error(t(419)),k=xv(z,k,void 0),mp(u,m,J,k)}if(fe=(J&u.childLanes)!==0,zs||fe){if(k=Ar,k!==null){switch(J&-J){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(k.suspendedLanes|J))!==0?0:R,R!==0&&R!==z.retryLane&&(z.retryLane=R,ll(u,R),wa(k,u,R,-1))}return qv(),k=xv(Error(t(421))),mp(u,m,J,k)}return R.data==="$?"?(m.flags|=128,m.child=u.child,m=Cq.bind(null,u),R._reactRetry=m,null):(u=z.treeContext,ui=uo(R.nextSibling),di=m,$n=!0,xa=null,u!==null&&(Fi[qi++]=al,Fi[qi++]=ol,Fi[qi++]=Id,al=u.id,ol=u.overflow,Id=m),m=jv(m,k.children),m.flags|=4096,m)}function CT(u,m,w){u.lanes|=m;var k=u.alternate;k!==null&&(k.lanes|=m),ev(u.return,m,w)}function Sv(u,m,w,k,R){var z=u.memoizedState;z===null?u.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:k,tail:w,tailMode:R}:(z.isBackwards=m,z.rendering=null,z.renderingStartTime=0,z.last=k,z.tail=w,z.tailMode=R)}function TT(u,m,w){var k=m.pendingProps,R=k.revealOrder,z=k.tail;if(vs(u,m,k.children,w),k=Zn.current,(k&2)!==0)k=k&1|2,m.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=m.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&CT(u,w,m);else if(u.tag===19)CT(u,w,m);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===m)break e;for(;u.sibling===null;){if(u.return===null||u.return===m)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}k&=1}if(Rn(Zn,k),(m.mode&1)===0)m.memoizedState=null;else switch(R){case"forwards":for(w=m.child,R=null;w!==null;)u=w.alternate,u!==null&&op(u)===null&&(R=w),w=w.sibling;w=R,w===null?(R=m.child,m.child=null):(R=w.sibling,w.sibling=null),Sv(m,!1,R,w,z);break;case"backwards":for(w=null,R=m.child,m.child=null;R!==null;){if(u=R.alternate,u!==null&&op(u)===null){m.child=R;break}u=R.sibling,R.sibling=w,w=R,R=u}Sv(m,!0,w,null,z);break;case"together":Sv(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function pp(u,m){(m.mode&1)===0&&u!==null&&(u.alternate=null,m.alternate=null,m.flags|=2)}function dl(u,m,w){if(u!==null&&(m.dependencies=u.dependencies),qd|=m.lanes,(w&m.childLanes)===0)return null;if(u!==null&&m.child!==u.child)throw Error(t(153));if(m.child!==null){for(u=m.child,w=_c(u,u.pendingProps),m.child=w,w.return=m;u.sibling!==null;)u=u.sibling,w=w.sibling=_c(u,u.pendingProps),w.return=m;w.sibling=null}return m.child}function mq(u,m,w){switch(m.tag){case 3:jT(m),Lu();break;case 5:U1(m);break;case 1:qs(m.type)&&Jm(m);break;case 4:rv(m,m.stateNode.containerInfo);break;case 10:var k=m.type._context,R=m.memoizedProps.value;Rn(rp,k._currentValue),k._currentValue=R;break;case 13:if(k=m.memoizedState,k!==null)return k.dehydrated!==null?(Rn(Zn,Zn.current&1),m.flags|=128,null):(w&m.child.childLanes)!==0?NT(u,m,w):(Rn(Zn,Zn.current&1),u=dl(u,m,w),u!==null?u.sibling:null);Rn(Zn,Zn.current&1);break;case 19:if(k=(w&m.childLanes)!==0,(u.flags&128)!==0){if(k)return TT(u,m,w);m.flags|=128}if(R=m.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),Rn(Zn,Zn.current),k)break;return null;case 22:case 23:return m.lanes=0,bT(u,m,w)}return dl(u,m,w)}var kT,Nv,PT,MT;kT=function(u,m){for(var w=m.child;w!==null;){if(w.tag===5||w.tag===6)u.appendChild(w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===m)break;for(;w.sibling===null;){if(w.return===null||w.return===m)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},Nv=function(){},PT=function(u,m,w,k){var R=u.memoizedProps;if(R!==k){u=m.stateNode,Ld(fo.current);var z=null;switch(w){case"input":R=qe(u,R),k=qe(u,k),z=[];break;case"select":R=te({},R,{value:void 0}),k=te({},k,{value:void 0}),z=[];break;case"textarea":R=xe(u,R),k=xe(u,k),z=[];break;default:typeof R.onClick!="function"&&typeof k.onClick=="function"&&(u.onclick=Be)}rn(w,k);var J;w=null;for(Oe in R)if(!k.hasOwnProperty(Oe)&&R.hasOwnProperty(Oe)&&R[Oe]!=null)if(Oe==="style"){var fe=R[Oe];for(J in fe)fe.hasOwnProperty(J)&&(w||(w={}),w[J]="")}else Oe!=="dangerouslySetInnerHTML"&&Oe!=="children"&&Oe!=="suppressContentEditableWarning"&&Oe!=="suppressHydrationWarning"&&Oe!=="autoFocus"&&(s.hasOwnProperty(Oe)?z||(z=[]):(z=z||[]).push(Oe,null));for(Oe in k){var ge=k[Oe];if(fe=R?.[Oe],k.hasOwnProperty(Oe)&&ge!==fe&&(ge!=null||fe!=null))if(Oe==="style")if(fe){for(J in fe)!fe.hasOwnProperty(J)||ge&&ge.hasOwnProperty(J)||(w||(w={}),w[J]="");for(J in ge)ge.hasOwnProperty(J)&&fe[J]!==ge[J]&&(w||(w={}),w[J]=ge[J])}else w||(z||(z=[]),z.push(Oe,w)),w=ge;else Oe==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,fe=fe?fe.__html:void 0,ge!=null&&fe!==ge&&(z=z||[]).push(Oe,ge)):Oe==="children"?typeof ge!="string"&&typeof ge!="number"||(z=z||[]).push(Oe,""+ge):Oe!=="suppressContentEditableWarning"&&Oe!=="suppressHydrationWarning"&&(s.hasOwnProperty(Oe)?(ge!=null&&Oe==="onScroll"&&Tn("scroll",u),z||fe===ge||(z=[])):(z=z||[]).push(Oe,ge))}w&&(z=z||[]).push("style",w);var Oe=z;(m.updateQueue=Oe)&&(m.flags|=4)}},MT=function(u,m,w,k){w!==k&&(m.flags|=4)};function mh(u,m){if(!$n)switch(u.tailMode){case"hidden":m=u.tail;for(var w=null;m!==null;)m.alternate!==null&&(w=m),m=m.sibling;w===null?u.tail=null:w.sibling=null;break;case"collapsed":w=u.tail;for(var k=null;w!==null;)w.alternate!==null&&(k=w),w=w.sibling;k===null?m||u.tail===null?u.tail=null:u.tail.sibling=null:k.sibling=null}}function rs(u){var m=u.alternate!==null&&u.alternate.child===u.child,w=0,k=0;if(m)for(var R=u.child;R!==null;)w|=R.lanes|R.childLanes,k|=R.subtreeFlags&14680064,k|=R.flags&14680064,R.return=u,R=R.sibling;else for(R=u.child;R!==null;)w|=R.lanes|R.childLanes,k|=R.subtreeFlags,k|=R.flags,R.return=u,R=R.sibling;return u.subtreeFlags|=k,u.childLanes=w,m}function pq(u,m,w){var k=m.pendingProps;switch(Yy(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rs(m),null;case 1:return qs(m.type)&&Km(),rs(m),null;case 3:return k=m.stateNode,Uu(),zn(Fs),zn(ts),av(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(u===null||u.child===null)&&(tp(m)?m.flags|=4:u===null||u.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,xa!==null&&(Rv(xa),xa=null))),Nv(u,m),rs(m),null;case 5:sv(m);var R=Ld(ch.current);if(w=m.type,u!==null&&m.stateNode!=null)PT(u,m,w,k,R),u.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!k){if(m.stateNode===null)throw Error(t(166));return rs(m),null}if(u=Ld(fo.current),tp(m)){k=m.stateNode,w=m.type;var z=m.memoizedProps;switch(k[Li]=m,k[dc]=z,u=(m.mode&1)!==0,w){case"dialog":Tn("cancel",k),Tn("close",k);break;case"iframe":case"object":case"embed":Tn("load",k);break;case"video":case"audio":for(R=0;R<oc.length;R++)Tn(oc[R],k);break;case"source":Tn("error",k);break;case"img":case"image":case"link":Tn("error",k),Tn("load",k);break;case"details":Tn("toggle",k);break;case"input":He(k,z),Tn("invalid",k);break;case"select":k._wrapperState={wasMultiple:!!z.multiple},Tn("invalid",k);break;case"textarea":ke(k,z),Tn("invalid",k)}rn(w,z),R=null;for(var J in z)if(z.hasOwnProperty(J)){var fe=z[J];J==="children"?typeof fe=="string"?k.textContent!==fe&&(z.suppressHydrationWarning!==!0&&De(k.textContent,fe,u),R=["children",fe]):typeof fe=="number"&&k.textContent!==""+fe&&(z.suppressHydrationWarning!==!0&&De(k.textContent,fe,u),R=["children",""+fe]):s.hasOwnProperty(J)&&fe!=null&&J==="onScroll"&&Tn("scroll",k)}switch(w){case"input":Te(k),Ue(k,z,!0);break;case"textarea":Te(k),Re(k);break;case"select":case"option":break;default:typeof z.onClick=="function"&&(k.onclick=Be)}k=R,m.updateQueue=k,k!==null&&(m.flags|=4)}else{J=R.nodeType===9?R:R.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=nt(w)),u==="http://www.w3.org/1999/xhtml"?w==="script"?(u=J.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof k.is=="string"?u=J.createElement(w,{is:k.is}):(u=J.createElement(w),w==="select"&&(J=u,k.multiple?J.multiple=!0:k.size&&(J.size=k.size))):u=J.createElementNS(u,w),u[Li]=m,u[dc]=k,kT(u,m,!1,!1),m.stateNode=u;e:{switch(J=Et(w,k),w){case"dialog":Tn("cancel",u),Tn("close",u),R=k;break;case"iframe":case"object":case"embed":Tn("load",u),R=k;break;case"video":case"audio":for(R=0;R<oc.length;R++)Tn(oc[R],u);R=k;break;case"source":Tn("error",u),R=k;break;case"img":case"image":case"link":Tn("error",u),Tn("load",u),R=k;break;case"details":Tn("toggle",u),R=k;break;case"input":He(u,k),R=qe(u,k),Tn("invalid",u);break;case"option":R=k;break;case"select":u._wrapperState={wasMultiple:!!k.multiple},R=te({},k,{value:void 0}),Tn("invalid",u);break;case"textarea":ke(u,k),R=xe(u,k),Tn("invalid",u);break;default:R=k}rn(w,R),fe=R;for(z in fe)if(fe.hasOwnProperty(z)){var ge=fe[z];z==="style"?Gt(u,ge):z==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,ge!=null&&Bt(u,ge)):z==="children"?typeof ge=="string"?(w!=="textarea"||ge!=="")&&lt(u,ge):typeof ge=="number"&&lt(u,""+ge):z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&z!=="autoFocus"&&(s.hasOwnProperty(z)?ge!=null&&z==="onScroll"&&Tn("scroll",u):ge!=null&&O(u,z,ge,J))}switch(w){case"input":Te(u),Ue(u,k,!1);break;case"textarea":Te(u),Re(u);break;case"option":k.value!=null&&u.setAttribute("value",""+de(k.value));break;case"select":u.multiple=!!k.multiple,z=k.value,z!=null?se(u,!!k.multiple,z,!1):k.defaultValue!=null&&se(u,!!k.multiple,k.defaultValue,!0);break;default:typeof R.onClick=="function"&&(u.onclick=Be)}switch(w){case"button":case"input":case"select":case"textarea":k=!!k.autoFocus;break e;case"img":k=!0;break e;default:k=!1}}k&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return rs(m),null;case 6:if(u&&m.stateNode!=null)MT(u,m,u.memoizedProps,k);else{if(typeof k!="string"&&m.stateNode===null)throw Error(t(166));if(w=Ld(ch.current),Ld(fo.current),tp(m)){if(k=m.stateNode,w=m.memoizedProps,k[Li]=m,(z=k.nodeValue!==w)&&(u=di,u!==null))switch(u.tag){case 3:De(k.nodeValue,w,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&De(k.nodeValue,w,(u.mode&1)!==0)}z&&(m.flags|=4)}else k=(w.nodeType===9?w:w.ownerDocument).createTextNode(k),k[Li]=m,m.stateNode=k}return rs(m),null;case 13:if(zn(Zn),k=m.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if($n&&ui!==null&&(m.mode&1)!==0&&(m.flags&128)===0)O1(),Lu(),m.flags|=98560,z=!1;else if(z=tp(m),k!==null&&k.dehydrated!==null){if(u===null){if(!z)throw Error(t(318));if(z=m.memoizedState,z=z!==null?z.dehydrated:null,!z)throw Error(t(317));z[Li]=m}else Lu(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;rs(m),z=!1}else xa!==null&&(Rv(xa),xa=null),z=!0;if(!z)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=w,m):(k=k!==null,k!==(u!==null&&u.memoizedState!==null)&&k&&(m.child.flags|=8192,(m.mode&1)!==0&&(u===null||(Zn.current&1)!==0?Cr===0&&(Cr=3):qv())),m.updateQueue!==null&&(m.flags|=4),rs(m),null);case 4:return Uu(),Nv(u,m),u===null&&lc(m.stateNode.containerInfo),rs(m),null;case 10:return Xy(m.type._context),rs(m),null;case 17:return qs(m.type)&&Km(),rs(m),null;case 19:if(zn(Zn),z=m.memoizedState,z===null)return rs(m),null;if(k=(m.flags&128)!==0,J=z.rendering,J===null)if(k)mh(z,!1);else{if(Cr!==0||u!==null&&(u.flags&128)!==0)for(u=m.child;u!==null;){if(J=op(u),J!==null){for(m.flags|=128,mh(z,!1),k=J.updateQueue,k!==null&&(m.updateQueue=k,m.flags|=4),m.subtreeFlags=0,k=w,w=m.child;w!==null;)z=w,u=k,z.flags&=14680066,J=z.alternate,J===null?(z.childLanes=0,z.lanes=u,z.child=null,z.subtreeFlags=0,z.memoizedProps=null,z.memoizedState=null,z.updateQueue=null,z.dependencies=null,z.stateNode=null):(z.childLanes=J.childLanes,z.lanes=J.lanes,z.child=J.child,z.subtreeFlags=0,z.deletions=null,z.memoizedProps=J.memoizedProps,z.memoizedState=J.memoizedState,z.updateQueue=J.updateQueue,z.type=J.type,u=J.dependencies,z.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),w=w.sibling;return Rn(Zn,Zn.current&1|2),m.child}u=u.sibling}z.tail!==null&&Pn()>$u&&(m.flags|=128,k=!0,mh(z,!1),m.lanes=4194304)}else{if(!k)if(u=op(J),u!==null){if(m.flags|=128,k=!0,w=u.updateQueue,w!==null&&(m.updateQueue=w,m.flags|=4),mh(z,!0),z.tail===null&&z.tailMode==="hidden"&&!J.alternate&&!$n)return rs(m),null}else 2*Pn()-z.renderingStartTime>$u&&w!==1073741824&&(m.flags|=128,k=!0,mh(z,!1),m.lanes=4194304);z.isBackwards?(J.sibling=m.child,m.child=J):(w=z.last,w!==null?w.sibling=J:m.child=J,z.last=J)}return z.tail!==null?(m=z.tail,z.rendering=m,z.tail=m.sibling,z.renderingStartTime=Pn(),m.sibling=null,w=Zn.current,Rn(Zn,k?w&1|2:w&1),m):(rs(m),null);case 22:case 23:return Fv(),k=m.memoizedState!==null,u!==null&&u.memoizedState!==null!==k&&(m.flags|=8192),k&&(m.mode&1)!==0?(fi&1073741824)!==0&&(rs(m),m.subtreeFlags&6&&(m.flags|=8192)):rs(m),null;case 24:return null;case 25:return null}throw Error(t(156,m.tag))}function gq(u,m){switch(Yy(m),m.tag){case 1:return qs(m.type)&&Km(),u=m.flags,u&65536?(m.flags=u&-65537|128,m):null;case 3:return Uu(),zn(Fs),zn(ts),av(),u=m.flags,(u&65536)!==0&&(u&128)===0?(m.flags=u&-65537|128,m):null;case 5:return sv(m),null;case 13:if(zn(Zn),u=m.memoizedState,u!==null&&u.dehydrated!==null){if(m.alternate===null)throw Error(t(340));Lu()}return u=m.flags,u&65536?(m.flags=u&-65537|128,m):null;case 19:return zn(Zn),null;case 4:return Uu(),null;case 10:return Xy(m.type._context),null;case 22:case 23:return Fv(),null;case 24:return null;default:return null}}var gp=!1,ss=!1,xq=typeof WeakSet=="function"?WeakSet:Set,ct=null;function Vu(u,m){var w=u.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(k){nr(u,m,k)}else w.current=null}function Cv(u,m,w){try{w()}catch(k){nr(u,m,k)}}var ET=!1;function yq(u,m){if(rt=fa,u=Qo(),Xo(u)){if("selectionStart"in u)var w={start:u.selectionStart,end:u.selectionEnd};else e:{w=(w=u.ownerDocument)&&w.defaultView||window;var k=w.getSelection&&w.getSelection();if(k&&k.rangeCount!==0){w=k.anchorNode;var R=k.anchorOffset,z=k.focusNode;k=k.focusOffset;try{w.nodeType,z.nodeType}catch{w=null;break e}var J=0,fe=-1,ge=-1,Oe=0,Ge=0,Ke=u,Ye=null;t:for(;;){for(var at;Ke!==w||R!==0&&Ke.nodeType!==3||(fe=J+R),Ke!==z||k!==0&&Ke.nodeType!==3||(ge=J+k),Ke.nodeType===3&&(J+=Ke.nodeValue.length),(at=Ke.firstChild)!==null;)Ye=Ke,Ke=at;for(;;){if(Ke===u)break t;if(Ye===w&&++Oe===R&&(fe=J),Ye===z&&++Ge===k&&(ge=J),(at=Ke.nextSibling)!==null)break;Ke=Ye,Ye=Ke.parentNode}Ke=at}w=fe===-1||ge===-1?null:{start:fe,end:ge}}else w=null}w=w||{start:0,end:0}}else w=null;for(St={focusedElem:u,selectionRange:w},fa=!1,ct=m;ct!==null;)if(m=ct,u=m.child,(m.subtreeFlags&1028)!==0&&u!==null)u.return=m,ct=u;else for(;ct!==null;){m=ct;try{var ut=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(ut!==null){var mt=ut.memoizedProps,ar=ut.memoizedState,Ce=m.stateNode,ve=Ce.getSnapshotBeforeUpdate(m.elementType===m.type?mt:ya(m.type,mt),ar);Ce.__reactInternalSnapshotBeforeUpdate=ve}break;case 3:var Me=m.stateNode.containerInfo;Me.nodeType===1?Me.textContent="":Me.nodeType===9&&Me.documentElement&&Me.removeChild(Me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Je){nr(m,m.return,Je)}if(u=m.sibling,u!==null){u.return=m.return,ct=u;break}ct=m.return}return ut=ET,ET=!1,ut}function ph(u,m,w){var k=m.updateQueue;if(k=k!==null?k.lastEffect:null,k!==null){var R=k=k.next;do{if((R.tag&u)===u){var z=R.destroy;R.destroy=void 0,z!==void 0&&Cv(m,w,z)}R=R.next}while(R!==k)}}function xp(u,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var w=m=m.next;do{if((w.tag&u)===u){var k=w.create;w.destroy=k()}w=w.next}while(w!==m)}}function Tv(u){var m=u.ref;if(m!==null){var w=u.stateNode;switch(u.tag){case 5:u=w;break;default:u=w}typeof m=="function"?m(u):m.current=u}}function DT(u){var m=u.alternate;m!==null&&(u.alternate=null,DT(m)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(m=u.stateNode,m!==null&&(delete m[Li],delete m[dc],delete m[uc],delete m[By],delete m[Vy])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function OT(u){return u.tag===5||u.tag===3||u.tag===4}function IT(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||OT(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function kv(u,m,w){var k=u.tag;if(k===5||k===6)u=u.stateNode,m?w.nodeType===8?w.parentNode.insertBefore(u,m):w.insertBefore(u,m):(w.nodeType===8?(m=w.parentNode,m.insertBefore(u,w)):(m=w,m.appendChild(u)),w=w._reactRootContainer,w!=null||m.onclick!==null||(m.onclick=Be));else if(k!==4&&(u=u.child,u!==null))for(kv(u,m,w),u=u.sibling;u!==null;)kv(u,m,w),u=u.sibling}function Pv(u,m,w){var k=u.tag;if(k===5||k===6)u=u.stateNode,m?w.insertBefore(u,m):w.appendChild(u);else if(k!==4&&(u=u.child,u!==null))for(Pv(u,m,w),u=u.sibling;u!==null;)Pv(u,m,w),u=u.sibling}var $r=null,va=!1;function xc(u,m,w){for(w=w.child;w!==null;)AT(u,m,w),w=w.sibling}function AT(u,m,w){if(Fr&&typeof Fr.onCommitFiberUnmount=="function")try{Fr.onCommitFiberUnmount(aa,w)}catch{}switch(w.tag){case 5:ss||Vu(w,m);case 6:var k=$r,R=va;$r=null,xc(u,m,w),$r=k,va=R,$r!==null&&(va?(u=$r,w=w.stateNode,u.nodeType===8?u.parentNode.removeChild(w):u.removeChild(w)):$r.removeChild(w.stateNode));break;case 18:$r!==null&&(va?(u=$r,w=w.stateNode,u.nodeType===8?ih(u.parentNode,w):u.nodeType===1&&ih(u,w),Ur(u)):ih($r,w.stateNode));break;case 4:k=$r,R=va,$r=w.stateNode.containerInfo,va=!0,xc(u,m,w),$r=k,va=R;break;case 0:case 11:case 14:case 15:if(!ss&&(k=w.updateQueue,k!==null&&(k=k.lastEffect,k!==null))){R=k=k.next;do{var z=R,J=z.destroy;z=z.tag,J!==void 0&&((z&2)!==0||(z&4)!==0)&&Cv(w,m,J),R=R.next}while(R!==k)}xc(u,m,w);break;case 1:if(!ss&&(Vu(w,m),k=w.stateNode,typeof k.componentWillUnmount=="function"))try{k.props=w.memoizedProps,k.state=w.memoizedState,k.componentWillUnmount()}catch(fe){nr(w,m,fe)}xc(u,m,w);break;case 21:xc(u,m,w);break;case 22:w.mode&1?(ss=(k=ss)||w.memoizedState!==null,xc(u,m,w),ss=k):xc(u,m,w);break;default:xc(u,m,w)}}function RT(u){var m=u.updateQueue;if(m!==null){u.updateQueue=null;var w=u.stateNode;w===null&&(w=u.stateNode=new xq),m.forEach(function(k){var R=Tq.bind(null,u,k);w.has(k)||(w.add(k),k.then(R,R))})}}function ba(u,m){var w=m.deletions;if(w!==null)for(var k=0;k<w.length;k++){var R=w[k];try{var z=u,J=m,fe=J;e:for(;fe!==null;){switch(fe.tag){case 5:$r=fe.stateNode,va=!1;break e;case 3:$r=fe.stateNode.containerInfo,va=!0;break e;case 4:$r=fe.stateNode.containerInfo,va=!0;break e}fe=fe.return}if($r===null)throw Error(t(160));AT(z,J,R),$r=null,va=!1;var ge=R.alternate;ge!==null&&(ge.return=null),R.return=null}catch(Oe){nr(R,m,Oe)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)LT(m,u),m=m.sibling}function LT(u,m){var w=u.alternate,k=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(ba(m,u),mo(u),k&4){try{ph(3,u,u.return),xp(3,u)}catch(mt){nr(u,u.return,mt)}try{ph(5,u,u.return)}catch(mt){nr(u,u.return,mt)}}break;case 1:ba(m,u),mo(u),k&512&&w!==null&&Vu(w,w.return);break;case 5:if(ba(m,u),mo(u),k&512&&w!==null&&Vu(w,w.return),u.flags&32){var R=u.stateNode;try{lt(R,"")}catch(mt){nr(u,u.return,mt)}}if(k&4&&(R=u.stateNode,R!=null)){var z=u.memoizedProps,J=w!==null?w.memoizedProps:z,fe=u.type,ge=u.updateQueue;if(u.updateQueue=null,ge!==null)try{fe==="input"&&z.type==="radio"&&z.name!=null&&ze(R,z),Et(fe,J);var Oe=Et(fe,z);for(J=0;J<ge.length;J+=2){var Ge=ge[J],Ke=ge[J+1];Ge==="style"?Gt(R,Ke):Ge==="dangerouslySetInnerHTML"?Bt(R,Ke):Ge==="children"?lt(R,Ke):O(R,Ge,Ke,Oe)}switch(fe){case"input":be(R,z);break;case"textarea":Ie(R,z);break;case"select":var Ye=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!z.multiple;var at=z.value;at!=null?se(R,!!z.multiple,at,!1):Ye!==!!z.multiple&&(z.defaultValue!=null?se(R,!!z.multiple,z.defaultValue,!0):se(R,!!z.multiple,z.multiple?[]:"",!1))}R[dc]=z}catch(mt){nr(u,u.return,mt)}}break;case 6:if(ba(m,u),mo(u),k&4){if(u.stateNode===null)throw Error(t(162));R=u.stateNode,z=u.memoizedProps;try{R.nodeValue=z}catch(mt){nr(u,u.return,mt)}}break;case 3:if(ba(m,u),mo(u),k&4&&w!==null&&w.memoizedState.isDehydrated)try{Ur(m.containerInfo)}catch(mt){nr(u,u.return,mt)}break;case 4:ba(m,u),mo(u);break;case 13:ba(m,u),mo(u),R=u.child,R.flags&8192&&(z=R.memoizedState!==null,R.stateNode.isHidden=z,!z||R.alternate!==null&&R.alternate.memoizedState!==null||(Dv=Pn())),k&4&&RT(u);break;case 22:if(Ge=w!==null&&w.memoizedState!==null,u.mode&1?(ss=(Oe=ss)||Ge,ba(m,u),ss=Oe):ba(m,u),mo(u),k&8192){if(Oe=u.memoizedState!==null,(u.stateNode.isHidden=Oe)&&!Ge&&(u.mode&1)!==0)for(ct=u,Ge=u.child;Ge!==null;){for(Ke=ct=Ge;ct!==null;){switch(Ye=ct,at=Ye.child,Ye.tag){case 0:case 11:case 14:case 15:ph(4,Ye,Ye.return);break;case 1:Vu(Ye,Ye.return);var ut=Ye.stateNode;if(typeof ut.componentWillUnmount=="function"){k=Ye,w=Ye.return;try{m=k,ut.props=m.memoizedProps,ut.state=m.memoizedState,ut.componentWillUnmount()}catch(mt){nr(k,w,mt)}}break;case 5:Vu(Ye,Ye.return);break;case 22:if(Ye.memoizedState!==null){zT(Ke);continue}}at!==null?(at.return=Ye,ct=at):zT(Ke)}Ge=Ge.sibling}e:for(Ge=null,Ke=u;;){if(Ke.tag===5){if(Ge===null){Ge=Ke;try{R=Ke.stateNode,Oe?(z=R.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none"):(fe=Ke.stateNode,ge=Ke.memoizedProps.style,J=ge!=null&&ge.hasOwnProperty("display")?ge.display:null,fe.style.display=Qt("display",J))}catch(mt){nr(u,u.return,mt)}}}else if(Ke.tag===6){if(Ge===null)try{Ke.stateNode.nodeValue=Oe?"":Ke.memoizedProps}catch(mt){nr(u,u.return,mt)}}else if((Ke.tag!==22&&Ke.tag!==23||Ke.memoizedState===null||Ke===u)&&Ke.child!==null){Ke.child.return=Ke,Ke=Ke.child;continue}if(Ke===u)break e;for(;Ke.sibling===null;){if(Ke.return===null||Ke.return===u)break e;Ge===Ke&&(Ge=null),Ke=Ke.return}Ge===Ke&&(Ge=null),Ke.sibling.return=Ke.return,Ke=Ke.sibling}}break;case 19:ba(m,u),mo(u),k&4&&RT(u);break;case 21:break;default:ba(m,u),mo(u)}}function mo(u){var m=u.flags;if(m&2){try{e:{for(var w=u.return;w!==null;){if(OT(w)){var k=w;break e}w=w.return}throw Error(t(160))}switch(k.tag){case 5:var R=k.stateNode;k.flags&32&&(lt(R,""),k.flags&=-33);var z=IT(u);Pv(u,z,R);break;case 3:case 4:var J=k.stateNode.containerInfo,fe=IT(u);kv(u,fe,J);break;default:throw Error(t(161))}}catch(ge){nr(u,u.return,ge)}u.flags&=-3}m&4096&&(u.flags&=-4097)}function vq(u,m,w){ct=u,FT(u)}function FT(u,m,w){for(var k=(u.mode&1)!==0;ct!==null;){var R=ct,z=R.child;if(R.tag===22&&k){var J=R.memoizedState!==null||gp;if(!J){var fe=R.alternate,ge=fe!==null&&fe.memoizedState!==null||ss;fe=gp;var Oe=ss;if(gp=J,(ss=ge)&&!Oe)for(ct=R;ct!==null;)J=ct,ge=J.child,J.tag===22&&J.memoizedState!==null?UT(R):ge!==null?(ge.return=J,ct=ge):UT(R);for(;z!==null;)ct=z,FT(z),z=z.sibling;ct=R,gp=fe,ss=Oe}qT(u)}else(R.subtreeFlags&8772)!==0&&z!==null?(z.return=R,ct=z):qT(u)}}function qT(u){for(;ct!==null;){var m=ct;if((m.flags&8772)!==0){var w=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:ss||xp(5,m);break;case 1:var k=m.stateNode;if(m.flags&4&&!ss)if(w===null)k.componentDidMount();else{var R=m.elementType===m.type?w.memoizedProps:ya(m.type,w.memoizedProps);k.componentDidUpdate(R,w.memoizedState,k.__reactInternalSnapshotBeforeUpdate)}var z=m.updateQueue;z!==null&&z1(m,z,k);break;case 3:var J=m.updateQueue;if(J!==null){if(w=null,m.child!==null)switch(m.child.tag){case 5:w=m.child.stateNode;break;case 1:w=m.child.stateNode}z1(m,J,w)}break;case 5:var fe=m.stateNode;if(w===null&&m.flags&4){w=fe;var ge=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":ge.autoFocus&&w.focus();break;case"img":ge.src&&(w.src=ge.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var Oe=m.alternate;if(Oe!==null){var Ge=Oe.memoizedState;if(Ge!==null){var Ke=Ge.dehydrated;Ke!==null&&Ur(Ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ss||m.flags&512&&Tv(m)}catch(Ye){nr(m,m.return,Ye)}}if(m===u){ct=null;break}if(w=m.sibling,w!==null){w.return=m.return,ct=w;break}ct=m.return}}function zT(u){for(;ct!==null;){var m=ct;if(m===u){ct=null;break}var w=m.sibling;if(w!==null){w.return=m.return,ct=w;break}ct=m.return}}function UT(u){for(;ct!==null;){var m=ct;try{switch(m.tag){case 0:case 11:case 15:var w=m.return;try{xp(4,m)}catch(ge){nr(m,w,ge)}break;case 1:var k=m.stateNode;if(typeof k.componentDidMount=="function"){var R=m.return;try{k.componentDidMount()}catch(ge){nr(m,R,ge)}}var z=m.return;try{Tv(m)}catch(ge){nr(m,z,ge)}break;case 5:var J=m.return;try{Tv(m)}catch(ge){nr(m,J,ge)}}}catch(ge){nr(m,m.return,ge)}if(m===u){ct=null;break}var fe=m.sibling;if(fe!==null){fe.return=m.return,ct=fe;break}ct=m.return}}var bq=Math.ceil,yp=M.ReactCurrentDispatcher,Mv=M.ReactCurrentOwner,Bi=M.ReactCurrentBatchConfig,cn=0,Ar=null,gr=null,Hr=0,fi=0,Wu=fc(0),Cr=0,gh=null,qd=0,vp=0,Ev=0,xh=null,Us=null,Dv=0,$u=1/0,ul=null,bp=!1,Ov=null,yc=null,wp=!1,vc=null,_p=0,yh=0,Iv=null,jp=-1,Sp=0;function bs(){return(cn&6)!==0?Pn():jp!==-1?jp:jp=Pn()}function bc(u){return(u.mode&1)===0?1:(cn&2)!==0&&Hr!==0?Hr&-Hr:rq.transition!==null?(Sp===0&&(Sp=Ul()),Sp):(u=Jt,u!==0||(u=window.event,u=u===void 0?16:Ht(u.type)),u)}function wa(u,m,w,k){if(50<yh)throw yh=0,Iv=null,Error(t(185));qr(u,w,k),((cn&2)===0||u!==Ar)&&(u===Ar&&((cn&2)===0&&(vp|=w),Cr===4&&wc(u,Hr)),Bs(u,k),w===1&&cn===0&&(m.mode&1)===0&&($u=Pn()+500,Qm&&mc()))}function Bs(u,m){var w=u.callbackNode;Wa(u,m);var k=bn(u,u===Ar?Hr:0);if(k===0)w!==null&&Io(w),u.callbackNode=null,u.callbackPriority=0;else if(m=k&-k,u.callbackPriority!==m){if(w!=null&&Io(w),m===1)u.tag===0?nq(VT.bind(null,u)):k1(VT.bind(null,u)),es(function(){(cn&6)===0&&mc()}),w=null;else{switch(ki(k)){case 1:w=Ao;break;case 4:w=zl;break;case 16:w=Ba;break;case 536870912:w=Si;break;default:w=Ba}w=JT(w,BT.bind(null,u))}u.callbackPriority=m,u.callbackNode=w}}function BT(u,m){if(jp=-1,Sp=0,(cn&6)!==0)throw Error(t(327));var w=u.callbackNode;if(Hu()&&u.callbackNode!==w)return null;var k=bn(u,u===Ar?Hr:0);if(k===0)return null;if((k&30)!==0||(k&u.expiredLanes)!==0||m)m=Np(u,k);else{m=k;var R=cn;cn|=2;var z=$T();(Ar!==u||Hr!==m)&&(ul=null,$u=Pn()+500,Ud(u,m));do try{jq();break}catch(fe){WT(u,fe)}while(!0);Qy(),yp.current=z,cn=R,gr!==null?m=0:(Ar=null,Hr=0,m=Cr)}if(m!==0){if(m===2&&(R=hr(u),R!==0&&(k=R,m=Av(u,R))),m===1)throw w=gh,Ud(u,0),wc(u,k),Bs(u,Pn()),w;if(m===6)wc(u,k);else{if(R=u.current.alternate,(k&30)===0&&!wq(R)&&(m=Np(u,k),m===2&&(z=hr(u),z!==0&&(k=z,m=Av(u,z))),m===1))throw w=gh,Ud(u,0),wc(u,k),Bs(u,Pn()),w;switch(u.finishedWork=R,u.finishedLanes=k,m){case 0:case 1:throw Error(t(345));case 2:Bd(u,Us,ul);break;case 3:if(wc(u,k),(k&130023424)===k&&(m=Dv+500-Pn(),10<m)){if(bn(u,0)!==0)break;if(R=u.suspendedLanes,(R&k)!==k){bs(),u.pingedLanes|=u.suspendedLanes&R;break}u.timeoutHandle=Sr(Bd.bind(null,u,Us,ul),m);break}Bd(u,Us,ul);break;case 4:if(wc(u,k),(k&4194240)===k)break;for(m=u.eventTimes,R=-1;0<k;){var J=31-Dt(k);z=1<<J,J=m[J],J>R&&(R=J),k&=~z}if(k=R,k=Pn()-k,k=(120>k?120:480>k?480:1080>k?1080:1920>k?1920:3e3>k?3e3:4320>k?4320:1960*bq(k/1960))-k,10<k){u.timeoutHandle=Sr(Bd.bind(null,u,Us,ul),k);break}Bd(u,Us,ul);break;case 5:Bd(u,Us,ul);break;default:throw Error(t(329))}}}return Bs(u,Pn()),u.callbackNode===w?BT.bind(null,u):null}function Av(u,m){var w=xh;return u.current.memoizedState.isDehydrated&&(Ud(u,m).flags|=256),u=Np(u,m),u!==2&&(m=Us,Us=w,m!==null&&Rv(m)),u}function Rv(u){Us===null?Us=u:Us.push.apply(Us,u)}function wq(u){for(var m=u;;){if(m.flags&16384){var w=m.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var k=0;k<w.length;k++){var R=w[k],z=R.getSnapshot;R=R.value;try{if(!Wr(z(),R))return!1}catch{return!1}}}if(w=m.child,m.subtreeFlags&16384&&w!==null)w.return=m,m=w;else{if(m===u)break;for(;m.sibling===null;){if(m.return===null||m.return===u)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function wc(u,m){for(m&=~Ev,m&=~vp,u.suspendedLanes|=m,u.pingedLanes&=~m,u=u.expirationTimes;0<m;){var w=31-Dt(m),k=1<<w;u[w]=-1,m&=~k}}function VT(u){if((cn&6)!==0)throw Error(t(327));Hu();var m=bn(u,0);if((m&1)===0)return Bs(u,Pn()),null;var w=Np(u,m);if(u.tag!==0&&w===2){var k=hr(u);k!==0&&(m=k,w=Av(u,k))}if(w===1)throw w=gh,Ud(u,0),wc(u,m),Bs(u,Pn()),w;if(w===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=m,Bd(u,Us,ul),Bs(u,Pn()),null}function Lv(u,m){var w=cn;cn|=1;try{return u(m)}finally{cn=w,cn===0&&($u=Pn()+500,Qm&&mc())}}function zd(u){vc!==null&&vc.tag===0&&(cn&6)===0&&Hu();var m=cn;cn|=1;var w=Bi.transition,k=Jt;try{if(Bi.transition=null,Jt=1,u)return u()}finally{Jt=k,Bi.transition=w,cn=m,(cn&6)===0&&mc()}}function Fv(){fi=Wu.current,zn(Wu)}function Ud(u,m){u.finishedWork=null,u.finishedLanes=0;var w=u.timeoutHandle;if(w!==-1&&(u.timeoutHandle=-1,pr(w)),gr!==null)for(w=gr.return;w!==null;){var k=w;switch(Yy(k),k.tag){case 1:k=k.type.childContextTypes,k!=null&&Km();break;case 3:Uu(),zn(Fs),zn(ts),av();break;case 5:sv(k);break;case 4:Uu();break;case 13:zn(Zn);break;case 19:zn(Zn);break;case 10:Xy(k.type._context);break;case 22:case 23:Fv()}w=w.return}if(Ar=u,gr=u=_c(u.current,null),Hr=fi=m,Cr=0,gh=null,Ev=vp=qd=0,Us=xh=null,Rd!==null){for(m=0;m<Rd.length;m++)if(w=Rd[m],k=w.interleaved,k!==null){w.interleaved=null;var R=k.next,z=w.pending;if(z!==null){var J=z.next;z.next=R,k.next=J}w.pending=k}Rd=null}return u}function WT(u,m){do{var w=gr;try{if(Qy(),lp.current=fp,cp){for(var k=Kn.memoizedState;k!==null;){var R=k.queue;R!==null&&(R.pending=null),k=k.next}cp=!1}if(Fd=0,Ir=Nr=Kn=null,dh=!1,uh=0,Mv.current=null,w===null||w.return===null){Cr=1,gh=m,gr=null;break}e:{var z=u,J=w.return,fe=w,ge=m;if(m=Hr,fe.flags|=32768,ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var Oe=ge,Ge=fe,Ke=Ge.tag;if((Ge.mode&1)===0&&(Ke===0||Ke===11||Ke===15)){var Ye=Ge.alternate;Ye?(Ge.updateQueue=Ye.updateQueue,Ge.memoizedState=Ye.memoizedState,Ge.lanes=Ye.lanes):(Ge.updateQueue=null,Ge.memoizedState=null)}var at=pT(J);if(at!==null){at.flags&=-257,gT(at,J,fe,z,m),at.mode&1&&mT(z,Oe,m),m=at,ge=Oe;var ut=m.updateQueue;if(ut===null){var mt=new Set;mt.add(ge),m.updateQueue=mt}else ut.add(ge);break e}else{if((m&1)===0){mT(z,Oe,m),qv();break e}ge=Error(t(426))}}else if($n&&fe.mode&1){var ar=pT(J);if(ar!==null){(ar.flags&65536)===0&&(ar.flags|=256),gT(ar,J,fe,z,m),Ky(Bu(ge,fe));break e}}z=ge=Bu(ge,fe),Cr!==4&&(Cr=2),xh===null?xh=[z]:xh.push(z),z=J;do{switch(z.tag){case 3:z.flags|=65536,m&=-m,z.lanes|=m;var Ce=fT(z,ge,m);q1(z,Ce);break e;case 1:fe=ge;var ve=z.type,Me=z.stateNode;if((z.flags&128)===0&&(typeof ve.getDerivedStateFromError=="function"||Me!==null&&typeof Me.componentDidCatch=="function"&&(yc===null||!yc.has(Me)))){z.flags|=65536,m&=-m,z.lanes|=m;var Je=hT(z,fe,m);q1(z,Je);break e}}z=z.return}while(z!==null)}YT(w)}catch(gt){m=gt,gr===w&&w!==null&&(gr=w=w.return);continue}break}while(!0)}function $T(){var u=yp.current;return yp.current=fp,u===null?fp:u}function qv(){(Cr===0||Cr===3||Cr===2)&&(Cr=4),Ar===null||(qd&268435455)===0&&(vp&268435455)===0||wc(Ar,Hr)}function Np(u,m){var w=cn;cn|=2;var k=$T();(Ar!==u||Hr!==m)&&(ul=null,Ud(u,m));do try{_q();break}catch(R){WT(u,R)}while(!0);if(Qy(),cn=w,yp.current=k,gr!==null)throw Error(t(261));return Ar=null,Hr=0,Cr}function _q(){for(;gr!==null;)HT(gr)}function jq(){for(;gr!==null&&!pd();)HT(gr)}function HT(u){var m=KT(u.alternate,u,fi);u.memoizedProps=u.pendingProps,m===null?YT(u):gr=m,Mv.current=null}function YT(u){var m=u;do{var w=m.alternate;if(u=m.return,(m.flags&32768)===0){if(w=pq(w,m,fi),w!==null){gr=w;return}}else{if(w=gq(w,m),w!==null){w.flags&=32767,gr=w;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{Cr=6,gr=null;return}}if(m=m.sibling,m!==null){gr=m;return}gr=m=u}while(m!==null);Cr===0&&(Cr=5)}function Bd(u,m,w){var k=Jt,R=Bi.transition;try{Bi.transition=null,Jt=1,Sq(u,m,w,k)}finally{Bi.transition=R,Jt=k}return null}function Sq(u,m,w,k){do Hu();while(vc!==null);if((cn&6)!==0)throw Error(t(327));w=u.finishedWork;var R=u.finishedLanes;if(w===null)return null;if(u.finishedWork=null,u.finishedLanes=0,w===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var z=w.lanes|w.childLanes;if(An(u,z),u===Ar&&(gr=Ar=null,Hr=0),(w.subtreeFlags&2064)===0&&(w.flags&2064)===0||wp||(wp=!0,JT(Ba,function(){return Hu(),null})),z=(w.flags&15990)!==0,(w.subtreeFlags&15990)!==0||z){z=Bi.transition,Bi.transition=null;var J=Jt;Jt=1;var fe=cn;cn|=4,Mv.current=null,yq(u,w),LT(w,u),g(St),fa=!!rt,St=rt=null,u.current=w,vq(w),Ua(),cn=fe,Jt=J,Bi.transition=z}else u.current=w;if(wp&&(wp=!1,vc=u,_p=R),z=u.pendingLanes,z===0&&(yc=null),oa(w.stateNode),Bs(u,Pn()),m!==null)for(k=u.onRecoverableError,w=0;w<m.length;w++)R=m[w],k(R.value,{componentStack:R.stack,digest:R.digest});if(bp)throw bp=!1,u=Ov,Ov=null,u;return(_p&1)!==0&&u.tag!==0&&Hu(),z=u.pendingLanes,(z&1)!==0?u===Iv?yh++:(yh=0,Iv=u):yh=0,mc(),null}function Hu(){if(vc!==null){var u=ki(_p),m=Bi.transition,w=Jt;try{if(Bi.transition=null,Jt=16>u?16:u,vc===null)var k=!1;else{if(u=vc,vc=null,_p=0,(cn&6)!==0)throw Error(t(331));var R=cn;for(cn|=4,ct=u.current;ct!==null;){var z=ct,J=z.child;if((ct.flags&16)!==0){var fe=z.deletions;if(fe!==null){for(var ge=0;ge<fe.length;ge++){var Oe=fe[ge];for(ct=Oe;ct!==null;){var Ge=ct;switch(Ge.tag){case 0:case 11:case 15:ph(8,Ge,z)}var Ke=Ge.child;if(Ke!==null)Ke.return=Ge,ct=Ke;else for(;ct!==null;){Ge=ct;var Ye=Ge.sibling,at=Ge.return;if(DT(Ge),Ge===Oe){ct=null;break}if(Ye!==null){Ye.return=at,ct=Ye;break}ct=at}}}var ut=z.alternate;if(ut!==null){var mt=ut.child;if(mt!==null){ut.child=null;do{var ar=mt.sibling;mt.sibling=null,mt=ar}while(mt!==null)}}ct=z}}if((z.subtreeFlags&2064)!==0&&J!==null)J.return=z,ct=J;else e:for(;ct!==null;){if(z=ct,(z.flags&2048)!==0)switch(z.tag){case 0:case 11:case 15:ph(9,z,z.return)}var Ce=z.sibling;if(Ce!==null){Ce.return=z.return,ct=Ce;break e}ct=z.return}}var ve=u.current;for(ct=ve;ct!==null;){J=ct;var Me=J.child;if((J.subtreeFlags&2064)!==0&&Me!==null)Me.return=J,ct=Me;else e:for(J=ve;ct!==null;){if(fe=ct,(fe.flags&2048)!==0)try{switch(fe.tag){case 0:case 11:case 15:xp(9,fe)}}catch(gt){nr(fe,fe.return,gt)}if(fe===J){ct=null;break e}var Je=fe.sibling;if(Je!==null){Je.return=fe.return,ct=Je;break e}ct=fe.return}}if(cn=R,mc(),Fr&&typeof Fr.onPostCommitFiberRoot=="function")try{Fr.onPostCommitFiberRoot(aa,u)}catch{}k=!0}return k}finally{Jt=w,Bi.transition=m}}return!1}function GT(u,m,w){m=Bu(w,m),m=fT(u,m,1),u=gc(u,m,1),m=bs(),u!==null&&(qr(u,1,m),Bs(u,m))}function nr(u,m,w){if(u.tag===3)GT(u,u,w);else for(;m!==null;){if(m.tag===3){GT(m,u,w);break}else if(m.tag===1){var k=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(yc===null||!yc.has(k))){u=Bu(w,u),u=hT(m,u,1),m=gc(m,u,1),u=bs(),m!==null&&(qr(m,1,u),Bs(m,u));break}}m=m.return}}function Nq(u,m,w){var k=u.pingCache;k!==null&&k.delete(m),m=bs(),u.pingedLanes|=u.suspendedLanes&w,Ar===u&&(Hr&w)===w&&(Cr===4||Cr===3&&(Hr&130023424)===Hr&&500>Pn()-Dv?Ud(u,0):Ev|=w),Bs(u,m)}function ZT(u,m){m===0&&((u.mode&1)===0?m=1:(m=Ci,Ci<<=1,(Ci&130023424)===0&&(Ci=4194304)));var w=bs();u=ll(u,m),u!==null&&(qr(u,m,w),Bs(u,w))}function Cq(u){var m=u.memoizedState,w=0;m!==null&&(w=m.retryLane),ZT(u,w)}function Tq(u,m){var w=0;switch(u.tag){case 13:var k=u.stateNode,R=u.memoizedState;R!==null&&(w=R.retryLane);break;case 19:k=u.stateNode;break;default:throw Error(t(314))}k!==null&&k.delete(m),ZT(u,w)}var KT;KT=function(u,m,w){if(u!==null)if(u.memoizedProps!==m.pendingProps||Fs.current)zs=!0;else{if((u.lanes&w)===0&&(m.flags&128)===0)return zs=!1,mq(u,m,w);zs=(u.flags&131072)!==0}else zs=!1,$n&&(m.flags&1048576)!==0&&P1(m,ep,m.index);switch(m.lanes=0,m.tag){case 2:var k=m.type;pp(u,m),u=m.pendingProps;var R=Iu(m,ts.current);zu(m,w),R=cv(null,m,k,u,R,w);var z=dv();return m.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,qs(k)?(z=!0,Jm(m)):z=!1,m.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,nv(m),R.updater=hp,m.stateNode=R,R._reactInternals=m,gv(m,k,u,w),m=bv(null,m,k,!0,z,w)):(m.tag=0,$n&&z&&Hy(m),vs(null,m,R,w),m=m.child),m;case 16:k=m.elementType;e:{switch(pp(u,m),u=m.pendingProps,R=k._init,k=R(k._payload),m.type=k,R=m.tag=Pq(k),u=ya(k,u),R){case 0:m=vv(null,m,k,u,w);break e;case 1:m=_T(null,m,k,u,w);break e;case 11:m=xT(null,m,k,u,w);break e;case 14:m=yT(null,m,k,ya(k.type,u),w);break e}throw Error(t(306,k,""))}return m;case 0:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ya(k,R),vv(u,m,k,R,w);case 1:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ya(k,R),_T(u,m,k,R,w);case 3:e:{if(jT(m),u===null)throw Error(t(387));k=m.pendingProps,z=m.memoizedState,R=z.element,F1(u,m),ap(m,k,null,w);var J=m.memoizedState;if(k=J.element,z.isDehydrated)if(z={element:k,isDehydrated:!1,cache:J.cache,pendingSuspenseBoundaries:J.pendingSuspenseBoundaries,transitions:J.transitions},m.updateQueue.baseState=z,m.memoizedState=z,m.flags&256){R=Bu(Error(t(423)),m),m=ST(u,m,k,w,R);break e}else if(k!==R){R=Bu(Error(t(424)),m),m=ST(u,m,k,w,R);break e}else for(ui=uo(m.stateNode.containerInfo.firstChild),di=m,$n=!0,xa=null,w=R1(m,null,k,w),m.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if(Lu(),k===R){m=dl(u,m,w);break e}vs(u,m,k,w)}m=m.child}return m;case 5:return U1(m),u===null&&Zy(m),k=m.type,R=m.pendingProps,z=u!==null?u.memoizedProps:null,J=R.children,$t(k,R)?J=null:z!==null&&$t(k,z)&&(m.flags|=32),wT(u,m),vs(u,m,J,w),m.child;case 6:return u===null&&Zy(m),null;case 13:return NT(u,m,w);case 4:return rv(m,m.stateNode.containerInfo),k=m.pendingProps,u===null?m.child=Fu(m,null,k,w):vs(u,m,k,w),m.child;case 11:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ya(k,R),xT(u,m,k,R,w);case 7:return vs(u,m,m.pendingProps,w),m.child;case 8:return vs(u,m,m.pendingProps.children,w),m.child;case 12:return vs(u,m,m.pendingProps.children,w),m.child;case 10:e:{if(k=m.type._context,R=m.pendingProps,z=m.memoizedProps,J=R.value,Rn(rp,k._currentValue),k._currentValue=J,z!==null)if(Wr(z.value,J)){if(z.children===R.children&&!Fs.current){m=dl(u,m,w);break e}}else for(z=m.child,z!==null&&(z.return=m);z!==null;){var fe=z.dependencies;if(fe!==null){J=z.child;for(var ge=fe.firstContext;ge!==null;){if(ge.context===k){if(z.tag===1){ge=cl(-1,w&-w),ge.tag=2;var Oe=z.updateQueue;if(Oe!==null){Oe=Oe.shared;var Ge=Oe.pending;Ge===null?ge.next=ge:(ge.next=Ge.next,Ge.next=ge),Oe.pending=ge}}z.lanes|=w,ge=z.alternate,ge!==null&&(ge.lanes|=w),ev(z.return,w,m),fe.lanes|=w;break}ge=ge.next}}else if(z.tag===10)J=z.type===m.type?null:z.child;else if(z.tag===18){if(J=z.return,J===null)throw Error(t(341));J.lanes|=w,fe=J.alternate,fe!==null&&(fe.lanes|=w),ev(J,w,m),J=z.sibling}else J=z.child;if(J!==null)J.return=z;else for(J=z;J!==null;){if(J===m){J=null;break}if(z=J.sibling,z!==null){z.return=J.return,J=z;break}J=J.return}z=J}vs(u,m,R.children,w),m=m.child}return m;case 9:return R=m.type,k=m.pendingProps.children,zu(m,w),R=zi(R),k=k(R),m.flags|=1,vs(u,m,k,w),m.child;case 14:return k=m.type,R=ya(k,m.pendingProps),R=ya(k.type,R),yT(u,m,k,R,w);case 15:return vT(u,m,m.type,m.pendingProps,w);case 17:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ya(k,R),pp(u,m),m.tag=1,qs(k)?(u=!0,Jm(m)):u=!1,zu(m,w),dT(m,k,R),gv(m,k,R,w),bv(null,m,k,!0,u,w);case 19:return TT(u,m,w);case 22:return bT(u,m,w)}throw Error(t(156,m.tag))};function JT(u,m){return ql(u,m)}function kq(u,m,w,k){this.tag=u,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vi(u,m,w,k){return new kq(u,m,w,k)}function zv(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Pq(u){if(typeof u=="function")return zv(u)?1:0;if(u!=null){if(u=u.$$typeof,u===Y)return 11;if(u===oe)return 14}return 2}function _c(u,m){var w=u.alternate;return w===null?(w=Vi(u.tag,m,u.key,u.mode),w.elementType=u.elementType,w.type=u.type,w.stateNode=u.stateNode,w.alternate=u,u.alternate=w):(w.pendingProps=m,w.type=u.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=u.flags&14680064,w.childLanes=u.childLanes,w.lanes=u.lanes,w.child=u.child,w.memoizedProps=u.memoizedProps,w.memoizedState=u.memoizedState,w.updateQueue=u.updateQueue,m=u.dependencies,w.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},w.sibling=u.sibling,w.index=u.index,w.ref=u.ref,w}function Cp(u,m,w,k,R,z){var J=2;if(k=u,typeof u=="function")zv(u)&&(J=1);else if(typeof u=="string")J=5;else e:switch(u){case F:return Vd(w.children,R,z,m);case q:J=8,R|=8;break;case U:return u=Vi(12,w,m,R|2),u.elementType=U,u.lanes=z,u;case G:return u=Vi(13,w,m,R),u.elementType=G,u.lanes=z,u;case Z:return u=Vi(19,w,m,R),u.elementType=Z,u.lanes=z,u;case he:return Tp(w,R,z,m);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case B:J=10;break e;case W:J=9;break e;case Y:J=11;break e;case oe:J=14;break e;case X:J=16,k=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return m=Vi(J,w,m,R),m.elementType=u,m.type=k,m.lanes=z,m}function Vd(u,m,w,k){return u=Vi(7,u,k,m),u.lanes=w,u}function Tp(u,m,w,k){return u=Vi(22,u,k,m),u.elementType=he,u.lanes=w,u.stateNode={isHidden:!1},u}function Uv(u,m,w){return u=Vi(6,u,null,m),u.lanes=w,u}function Bv(u,m,w){return m=Vi(4,u.children!==null?u.children:[],u.key,m),m.lanes=w,m.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},m}function Mq(u,m,w,k,R){this.tag=m,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ti(0),this.expirationTimes=Ti(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ti(0),this.identifierPrefix=k,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function Vv(u,m,w,k,R,z,J,fe,ge){return u=new Mq(u,m,w,fe,ge),m===1?(m=1,z===!0&&(m|=8)):m=0,z=Vi(3,null,null,m),u.current=z,z.stateNode=u,z.memoizedState={element:k,isDehydrated:w,cache:null,transitions:null,pendingSuspenseBoundaries:null},nv(z),u}function Eq(u,m,w){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:k==null?null:""+k,children:u,containerInfo:m,implementation:w}}function QT(u){if(!u)return hc;u=u._reactInternals;e:{if(Ds(u)!==u||u.tag!==1)throw Error(t(170));var m=u;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(qs(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(t(171))}if(u.tag===1){var w=u.type;if(qs(w))return C1(u,w,m)}return m}function XT(u,m,w,k,R,z,J,fe,ge){return u=Vv(w,k,!0,u,R,z,J,fe,ge),u.context=QT(null),w=u.current,k=bs(),R=bc(w),z=cl(k,R),z.callback=m??null,gc(w,z,R),u.current.lanes=R,qr(u,R,k),Bs(u,k),u}function kp(u,m,w,k){var R=m.current,z=bs(),J=bc(R);return w=QT(w),m.context===null?m.context=w:m.pendingContext=w,m=cl(z,J),m.payload={element:u},k=k===void 0?null:k,k!==null&&(m.callback=k),u=gc(R,m,J),u!==null&&(wa(u,R,J,z),ip(u,R,J)),J}function Pp(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function ek(u,m){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var w=u.retryLane;u.retryLane=w!==0&&w<m?w:m}}function Wv(u,m){ek(u,m),(u=u.alternate)&&ek(u,m)}function Dq(){return null}var tk=typeof reportError=="function"?reportError:function(u){console.error(u)};function $v(u){this._internalRoot=u}Mp.prototype.render=$v.prototype.render=function(u){var m=this._internalRoot;if(m===null)throw Error(t(409));kp(u,m,null,null)},Mp.prototype.unmount=$v.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var m=u.containerInfo;zd(function(){kp(null,u,null,null)}),m[wn]=null}};function Mp(u){this._internalRoot=u}Mp.prototype.unstable_scheduleHydration=function(u){if(u){var m=Ya();u={blockedOn:null,target:u,priority:m};for(var w=0;w<Gn.length&&m!==0&&m<Gn[w].priority;w++);Gn.splice(w,0,u),w===0&&Ga(u)}};function Hv(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function Ep(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function nk(){}function Oq(u,m,w,k,R){if(R){if(typeof k=="function"){var z=k;k=function(){var Oe=Pp(J);z.call(Oe)}}var J=XT(m,k,u,0,null,!1,!1,"",nk);return u._reactRootContainer=J,u[wn]=J.current,lc(u.nodeType===8?u.parentNode:u),zd(),J}for(;R=u.lastChild;)u.removeChild(R);if(typeof k=="function"){var fe=k;k=function(){var Oe=Pp(ge);fe.call(Oe)}}var ge=Vv(u,0,!1,null,null,!1,!1,"",nk);return u._reactRootContainer=ge,u[wn]=ge.current,lc(u.nodeType===8?u.parentNode:u),zd(function(){kp(m,ge,w,k)}),ge}function Dp(u,m,w,k,R){var z=w._reactRootContainer;if(z){var J=z;if(typeof R=="function"){var fe=R;R=function(){var ge=Pp(J);fe.call(ge)}}kp(m,J,u,R)}else J=Oq(w,m,u,R,k);return Pp(J)}$a=function(u){switch(u.tag){case 3:var m=u.stateNode;if(m.current.memoizedState.isDehydrated){var w=Mt(m.pendingLanes);w!==0&&(hs(m,w|1),Bs(m,Pn()),(cn&6)===0&&($u=Pn()+500,mc()))}break;case 13:zd(function(){var k=ll(u,1);if(k!==null){var R=bs();wa(k,u,1,R)}}),Wv(u,1)}},ni=function(u){if(u.tag===13){var m=ll(u,134217728);if(m!==null){var w=bs();wa(m,u,134217728,w)}Wv(u,134217728)}},Ha=function(u){if(u.tag===13){var m=bc(u),w=ll(u,m);if(w!==null){var k=bs();wa(w,u,m,k)}Wv(u,m)}},Ya=function(){return Jt},la=function(u,m){var w=Jt;try{return Jt=u,m()}finally{Jt=w}},vn=function(u,m,w){switch(m){case"input":if(be(u,w),m=w.name,w.type==="radio"&&m!=null){for(w=u;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<w.length;m++){var k=w[m];if(k!==u&&k.form===u.form){var R=Du(k);if(!R)throw Error(t(90));Se(k),be(k,R)}}}break;case"textarea":Ie(u,w);break;case"select":m=w.value,m!=null&&se(u,!!w.multiple,m,!1)}},In=Lv,Ms=zd;var Iq={usingClientEntryPoint:!1,Events:[rl,sl,Du,ks,Ps,Lv]},vh={findFiberByHostInstance:nl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Aq={bundleType:vh.bundleType,version:vh.version,rendererPackageName:vh.rendererPackageName,rendererConfig:vh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Ll(u),u===null?null:u.stateNode},findFiberByHostInstance:vh.findFiberByHostInstance||Dq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Op=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Op.isDisabled&&Op.supportsFiber)try{aa=Op.inject(Aq),Fr=Op}catch{}}return Vs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Iq,Vs.createPortal=function(u,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hv(m))throw Error(t(200));return Eq(u,m,null,w)},Vs.createRoot=function(u,m){if(!Hv(u))throw Error(t(299));var w=!1,k="",R=tk;return m!=null&&(m.unstable_strictMode===!0&&(w=!0),m.identifierPrefix!==void 0&&(k=m.identifierPrefix),m.onRecoverableError!==void 0&&(R=m.onRecoverableError)),m=Vv(u,1,!1,null,null,w,!1,k,R),u[wn]=m.current,lc(u.nodeType===8?u.parentNode:u),new $v(m)},Vs.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var m=u._reactInternals;if(m===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Ll(m),u=u===null?null:u.stateNode,u},Vs.flushSync=function(u){return zd(u)},Vs.hydrate=function(u,m,w){if(!Ep(m))throw Error(t(200));return Dp(null,u,m,!0,w)},Vs.hydrateRoot=function(u,m,w){if(!Hv(u))throw Error(t(405));var k=w!=null&&w.hydratedSources||null,R=!1,z="",J=tk;if(w!=null&&(w.unstable_strictMode===!0&&(R=!0),w.identifierPrefix!==void 0&&(z=w.identifierPrefix),w.onRecoverableError!==void 0&&(J=w.onRecoverableError)),m=XT(m,null,u,1,w??null,R,!1,z,J),u[wn]=m.current,lc(u),k)for(u=0;u<k.length;u++)w=k[u],R=w._getVersion,R=R(w._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[w,R]:m.mutableSourceEagerHydrationData.push(w,R);return new Mp(m)},Vs.render=function(u,m,w){if(!Ep(m))throw Error(t(200));return Dp(null,u,m,!1,w)},Vs.unmountComponentAtNode=function(u){if(!Ep(u))throw Error(t(40));return u._reactRootContainer?(zd(function(){Dp(null,null,u,!1,function(){u._reactRootContainer=null,u[wn]=null})}),!0):!1},Vs.unstable_batchedUpdates=Lv,Vs.unstable_renderSubtreeIntoContainer=function(u,m,w,k){if(!Ep(w))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return Dp(u,m,w,!1,k)},Vs.version="18.3.1-next-f1338f8080-20240426",Vs}var dk;function s4(){if(dk)return Zv.exports;dk=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Zv.exports=Bq(),Zv.exports}var uk;function Vq(){if(uk)return Ip;uk=1;var n=s4();return Ip.createRoot=n.createRoot,Ip.hydrateRoot=n.hydrateRoot,Ip}var Wq=Vq();const $q=wu(Wq);var i4=s4();function lm(){return lm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},lm.apply(this,arguments)}var Rc;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Rc||(Rc={}));const fk="popstate";function Hq(n){n===void 0&&(n={});function e(s,a){let{pathname:o="/",search:l="",hash:c=""}=_u(s.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),VS("",{pathname:o,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,d=c.indexOf("#");l=d===-1?c:c.slice(0,d)}return l+"#"+(typeof a=="string"?a:yx(a))}function r(s,a){Jx(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(a)+")")}return Gq(e,t,r,n)}function tr(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Jx(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Yq(){return Math.random().toString(36).substr(2,8)}function hk(n,e){return{usr:n.state,key:n.key,idx:e}}function VS(n,e,t,r){return t===void 0&&(t=null),lm({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?_u(e):e,{state:t,key:e&&e.key||r||Yq()})}function yx(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function _u(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function Gq(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:a=!1}=r,o=s.history,l=Rc.Pop,c=null,d=h();d==null&&(d=0,o.replaceState(lm({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function p(){l=Rc.Pop;let j=h(),C=j==null?null:j-d;d=j,c&&c({action:l,location:_.location,delta:C})}function x(j,C){l=Rc.Push;let P=VS(_.location,j,C);t&&t(P,j),d=h()+1;let O=hk(P,d),M=_.createHref(P);try{o.pushState(O,"",M)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(M)}a&&c&&c({action:l,location:_.location,delta:1})}function v(j,C){l=Rc.Replace;let P=VS(_.location,j,C);t&&t(P,j),d=h();let O=hk(P,d),M=_.createHref(P);o.replaceState(O,"",M),a&&c&&c({action:l,location:_.location,delta:0})}function b(j){let C=s.location.origin!=="null"?s.location.origin:s.location.href,P=typeof j=="string"?j:yx(j);return P=P.replace(/ $/,"%20"),tr(C,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,C)}let _={get action(){return l},get location(){return n(s,o)},listen(j){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(fk,p),c=j,()=>{s.removeEventListener(fk,p),c=null}},createHref(j){return e(s,j)},createURL:b,encodeLocation(j){let C=b(j);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:x,replace:v,go(j){return o.go(j)}};return _}var mk;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(mk||(mk={}));function Zq(n,e,t){return t===void 0&&(t="/"),Kq(n,e,t)}function Kq(n,e,t,r){let s=typeof e=="string"?_u(e):e,a=jf(s.pathname||"/",t);if(a==null)return null;let o=a4(n);Jq(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=lz(a);l=az(o[c],d)}return l}function a4(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(tr(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=Uc([r,c.relativePath]),h=t.concat(c);a.children&&a.children.length>0&&(tr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),a4(a.children,e,h,d)),!(a.path==null&&!a.index)&&e.push({path:d,score:sz(d,a.index),routesMeta:h})};return n.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,o);else for(let c of o4(a.path))s(a,o,c)}),e}function o4(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let o=o4(r.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function Jq(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:iz(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Qq=/^:[\w-]+$/,Xq=3,ez=2,tz=1,nz=10,rz=-2,pk=n=>n==="*";function sz(n,e){let t=n.split("/"),r=t.length;return t.some(pk)&&(r+=rz),e&&(r+=ez),t.filter(s=>!pk(s)).reduce((s,a)=>s+(Qq.test(a)?Xq:a===""?tz:nz),r)}function iz(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function az(n,e,t){let{routesMeta:r}=n,s={},a="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=WS({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),x=c.route;if(!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:Uc([a,p.pathname]),pathnameBase:hz(Uc([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=Uc([a,p.pathnameBase]))}return o}function WS(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=oz(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,h,p)=>{let{paramName:x,isOptional:v}=h;if(x==="*"){let _=l[p]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const b=l[p];return v&&!b?d[x]=void 0:d[x]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function oz(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Jx(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function lz(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Jx(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function jf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const cz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dz=n=>cz.test(n);function uz(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?_u(n):n,a;if(t)if(dz(t))a=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Jx(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+t))}t.startsWith("/")?a=gk(t.substring(1),"/"):a=gk(t,e)}else a=e;return{pathname:a,search:mz(r),hash:pz(s)}}function gk(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Qv(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function fz(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function iC(n,e){let t=fz(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function aC(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=_u(n):(s=lm({},n),tr(!s.pathname||!s.pathname.includes("?"),Qv("?","pathname","search",s)),tr(!s.pathname||!s.pathname.includes("#"),Qv("#","pathname","hash",s)),tr(!s.search||!s.search.includes("#"),Qv("#","search","hash",s)));let a=n===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),p-=1;s.pathname=x.join("/")}l=p>=0?e[p]:"/"}let c=uz(s,l),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const Uc=n=>n.join("/").replace(/\/\/+/g,"/"),hz=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),mz=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,pz=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function gz(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const l4=["post","put","patch","delete"];new Set(l4);const xz=["get",...l4];new Set(xz);function cm(){return cm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},cm.apply(this,arguments)}const Qx=E.createContext(null),c4=E.createContext(null),El=E.createContext(null),Xx=E.createContext(null),Po=E.createContext({outlet:null,matches:[],isDataRoute:!1}),d4=E.createContext(null);function yz(n,e){let{relative:t}=e===void 0?{}:e;Vf()||tr(!1);let{basename:r,navigator:s}=E.useContext(El),{hash:a,pathname:o,search:l}=ey(n,{relative:t}),c=o;return r!=="/"&&(c=o==="/"?r:Uc([r,o])),s.createHref({pathname:c,search:l,hash:a})}function Vf(){return E.useContext(Xx)!=null}function Zr(){return Vf()||tr(!1),E.useContext(Xx).location}function u4(n){E.useContext(El).static||E.useLayoutEffect(n)}function Nt(){let{isDataRoute:n}=E.useContext(Po);return n?Dz():vz()}function vz(){Vf()||tr(!1);let n=E.useContext(Qx),{basename:e,future:t,navigator:r}=E.useContext(El),{matches:s}=E.useContext(Po),{pathname:a}=Zr(),o=JSON.stringify(iC(s,t.v7_relativeSplatPath)),l=E.useRef(!1);return u4(()=>{l.current=!0}),E.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let p=aC(d,JSON.parse(o),a,h.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Uc([e,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[e,r,o,a,n])}const f4=E.createContext(null);function ji(){return E.useContext(f4)}function bz(n){let e=E.useContext(Po).outlet;return e&&E.createElement(f4.Provider,{value:n},e)}function Wf(){let{matches:n}=E.useContext(Po),e=n[n.length-1];return e?e.params:{}}function ey(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=E.useContext(El),{matches:s}=E.useContext(Po),{pathname:a}=Zr(),o=JSON.stringify(iC(s,r.v7_relativeSplatPath));return E.useMemo(()=>aC(n,JSON.parse(o),a,t==="path"),[n,o,a,t])}function wz(n,e){return _z(n,e)}function _z(n,e,t,r){Vf()||tr(!1);let{navigator:s}=E.useContext(El),{matches:a}=E.useContext(Po),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=Zr(),h;if(e){var p;let j=typeof e=="string"?_u(e):e;c==="/"||(p=j.pathname)!=null&&p.startsWith(c)||tr(!1),h=j}else h=d;let x=h.pathname||"/",v=x;if(c!=="/"){let j=c.replace(/^\//,"").split("/");v="/"+x.replace(/^\//,"").split("/").slice(j.length).join("/")}let b=Zq(n,{pathname:v}),_=Tz(b&&b.map(j=>Object.assign({},j,{params:Object.assign({},l,j.params),pathname:Uc([c,s.encodeLocation?s.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?c:Uc([c,s.encodeLocation?s.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),a,t,r);return e&&_?E.createElement(Xx.Provider,{value:{location:cm({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Rc.Pop}},_):_}function jz(){let n=Ez(),e=gz(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),t?E.createElement("pre",{style:s},t):null,null)}const Sz=E.createElement(jz,null);class Nz extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?E.createElement(Po.Provider,{value:this.props.routeContext},E.createElement(d4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Cz(n){let{routeContext:e,match:t,children:r}=n,s=E.useContext(Qx);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),E.createElement(Po.Provider,{value:e},r)}function Tz(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var a;if(!t)return null;if(t.errors)n=t.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,l=(s=t)==null?void 0:s.errors;if(l!=null){let h=o.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);h>=0||tr(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,d=-1;if(t&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:x,errors:v}=t,b=p.route.loader&&x[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||b){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,p,x)=>{let v,b=!1,_=null,j=null;t&&(v=l&&p.route.id?l[p.route.id]:void 0,_=p.route.errorElement||Sz,c&&(d<0&&x===0?(Oz("route-fallback"),b=!0,j=null):d===x&&(b=!0,j=p.route.hydrateFallbackElement||null)));let C=e.concat(o.slice(0,x+1)),P=()=>{let O;return v?O=_:b?O=j:p.route.Component?O=E.createElement(p.route.Component,null):p.route.element?O=p.route.element:O=h,E.createElement(Cz,{match:p,routeContext:{outlet:h,matches:C,isDataRoute:t!=null},children:O})};return t&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?E.createElement(Nz,{location:t.location,revalidation:t.revalidation,component:_,error:v,children:P(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):P()},null)}var h4=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(h4||{}),m4=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(m4||{});function kz(n){let e=E.useContext(Qx);return e||tr(!1),e}function Pz(n){let e=E.useContext(c4);return e||tr(!1),e}function Mz(n){let e=E.useContext(Po);return e||tr(!1),e}function p4(n){let e=Mz(),t=e.matches[e.matches.length-1];return t.route.id||tr(!1),t.route.id}function Ez(){var n;let e=E.useContext(d4),t=Pz(),r=p4();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Dz(){let{router:n}=kz(h4.UseNavigateStable),e=p4(m4.UseNavigateStable),t=E.useRef(!1);return u4(()=>{t.current=!0}),E.useCallback(function(s,a){a===void 0&&(a={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,cm({fromRouteId:e},a)))},[n,e])}const xk={};function Oz(n,e,t){xk[n]||(xk[n]=!0)}function Iz(n,e){n?.v7_startTransition,n?.v7_relativeSplatPath}function wl(n){let{to:e,replace:t,state:r,relative:s}=n;Vf()||tr(!1);let{future:a,static:o}=E.useContext(El),{matches:l}=E.useContext(Po),{pathname:c}=Zr(),d=Nt(),h=aC(e,iC(l,a.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(h);return E.useEffect(()=>d(JSON.parse(p),{replace:t,state:r,relative:s}),[d,p,s,t,r]),null}function Sf(n){return bz(n.context)}function $e(n){tr(!1)}function Az(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Rc.Pop,navigator:a,static:o=!1,future:l}=n;Vf()&&tr(!1);let c=e.replace(/^\/*/,"/"),d=E.useMemo(()=>({basename:c,navigator:a,static:o,future:cm({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof r=="string"&&(r=_u(r));let{pathname:h="/",search:p="",hash:x="",state:v=null,key:b="default"}=r,_=E.useMemo(()=>{let j=jf(h,c);return j==null?null:{location:{pathname:j,search:p,hash:x,state:v,key:b},navigationType:s}},[c,h,p,x,v,b,s]);return _==null?null:E.createElement(El.Provider,{value:d},E.createElement(Xx.Provider,{children:t,value:_}))}function Rz(n){let{children:e,location:t}=n;return wz($S(e),t)}new Promise(()=>{});function $S(n,e){e===void 0&&(e=[]);let t=[];return E.Children.forEach(n,(r,s)=>{if(!E.isValidElement(r))return;let a=[...e,s];if(r.type===E.Fragment){t.push.apply(t,$S(r.props.children,a));return}r.type!==$e&&tr(!1),!r.props.index||!r.props.children||tr(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=$S(r.props.children,a)),t.push(o)}),t}function vx(){return vx=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},vx.apply(this,arguments)}function g4(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,a;for(a=0;a<r.length;a++)s=r[a],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function Lz(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Fz(n,e){return n.button===0&&(!e||e==="_self")&&!Lz(n)}function HS(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(s=>[t,s]):[[t,r]])},[]))}function qz(n,e){let t=HS(n);return e&&e.forEach((r,s)=>{t.has(s)||e.getAll(s).forEach(a=>{t.append(s,a)})}),t}const zz=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Uz=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Bz="6";try{window.__reactRouterVersion=Bz}catch{}const Vz=E.createContext({isTransitioning:!1}),Wz="startTransition",yk=qq[Wz];function $z(n){let{basename:e,children:t,future:r,window:s}=n,a=E.useRef();a.current==null&&(a.current=Hq({window:s,v5Compat:!0}));let o=a.current,[l,c]=E.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=E.useCallback(p=>{d&&yk?yk(()=>c(p)):c(p)},[c,d]);return E.useLayoutEffect(()=>o.listen(h),[o,h]),E.useEffect(()=>Iz(r),[r]),E.createElement(Az,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:r})}const Hz=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Yz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Oa=E.forwardRef(function(e,t){let{onClick:r,relative:s,reloadDocument:a,replace:o,state:l,target:c,to:d,preventScrollReset:h,viewTransition:p}=e,x=g4(e,zz),{basename:v}=E.useContext(El),b,_=!1;if(typeof d=="string"&&Yz.test(d)&&(b=d,Hz))try{let O=new URL(window.location.href),M=d.startsWith("//")?new URL(O.protocol+d):new URL(d),D=jf(M.pathname,v);M.origin===O.origin&&D!=null?d=D+M.search+M.hash:_=!0}catch{}let j=yz(d,{relative:s}),C=Zz(d,{replace:o,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:p});function P(O){r&&r(O),O.defaultPrevented||C(O)}return E.createElement("a",vx({},x,{href:b||j,onClick:_||a?r:P,ref:t,target:c}))}),x4=E.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:s=!1,className:a="",end:o=!1,style:l,to:c,viewTransition:d,children:h}=e,p=g4(e,Uz),x=ey(c,{relative:p.relative}),v=Zr(),b=E.useContext(c4),{navigator:_,basename:j}=E.useContext(El),C=b!=null&&Kz(x)&&d===!0,P=_.encodeLocation?_.encodeLocation(x).pathname:x.pathname,O=v.pathname,M=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;s||(O=O.toLowerCase(),M=M?M.toLowerCase():null,P=P.toLowerCase()),M&&j&&(M=jf(M,j)||M);const D=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let I=O===P||!o&&O.startsWith(P)&&O.charAt(D)==="/",F=M!=null&&(M===P||!o&&M.startsWith(P)&&M.charAt(P.length)==="/"),q={isActive:I,isPending:F,isTransitioning:C},U=I?r:void 0,B;typeof a=="function"?B=a(q):B=[a,I?"active":null,F?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let W=typeof l=="function"?l(q):l;return E.createElement(Oa,vx({},p,{"aria-current":U,className:B,ref:t,style:W,to:c,viewTransition:d}),typeof h=="function"?h(q):h)});var YS;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(YS||(YS={}));var vk;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(vk||(vk={}));function Gz(n){let e=E.useContext(Qx);return e||tr(!1),e}function Zz(n,e){let{target:t,replace:r,state:s,preventScrollReset:a,relative:o,viewTransition:l}=e===void 0?{}:e,c=Nt(),d=Zr(),h=ey(n,{relative:o});return E.useCallback(p=>{if(Fz(p,t)){p.preventDefault();let x=r!==void 0?r:yx(d)===yx(h);c(n,{replace:x,state:s,preventScrollReset:a,relative:o,viewTransition:l})}},[d,c,h,r,s,t,n,a,o,l])}function y4(n){let e=E.useRef(HS(n)),t=E.useRef(!1),r=Zr(),s=E.useMemo(()=>qz(r.search,t.current?null:e.current),[r.search]),a=Nt(),o=E.useCallback((l,c)=>{const d=HS(typeof l=="function"?l(s):l);t.current=!0,a("?"+d,c)},[a,s]);return[s,o]}function Kz(n,e){e===void 0&&(e={});let t=E.useContext(Vz);t==null&&tr(!1);let{basename:r}=Gz(YS.useViewTransitionState),s=ey(n,{relative:e.relative});if(!t.isTransitioning)return!1;let a=jf(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=jf(t.nextLocation.pathname,r)||t.nextLocation.pathname;return WS(s.pathname,o)!=null||WS(s.pathname,a)!=null}const Jz={},bk=n=>{let e;const t=new Set,r=(h,p)=>{const x=typeof h=="function"?h(e):h;if(!Object.is(x,e)){const v=e;e=p??(typeof x!="object"||x===null)?x:Object.assign({},e,x),t.forEach(b=>b(e,v))}},s=()=>e,c={setState:r,getState:s,getInitialState:()=>d,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(Jz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=n(r,s,c);return c},Qz=n=>n?bk(n):bk;var Xv={exports:{}},eb={},tb={exports:{}},nb={};var wk;function Xz(){if(wk)return nb;wk=1;var n=Qs();function e(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,a=n.useLayoutEffect,o=n.useDebugValue;function l(p,x){var v=x(),b=r({inst:{value:v,getSnapshot:x}}),_=b[0].inst,j=b[1];return a(function(){_.value=v,_.getSnapshot=x,c(_)&&j({inst:_})},[p,v,x]),s(function(){return c(_)&&j({inst:_}),p(function(){c(_)&&j({inst:_})})},[p]),o(v),v}function c(p){var x=p.getSnapshot;p=p.value;try{var v=x();return!t(p,v)}catch{return!0}}function d(p,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return nb.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,nb}var _k;function eU(){return _k||(_k=1,tb.exports=Xz()),tb.exports}var jk;function tU(){if(jk)return eb;jk=1;var n=Qs(),e=eU();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,a=n.useRef,o=n.useEffect,l=n.useMemo,c=n.useDebugValue;return eb.useSyncExternalStoreWithSelector=function(d,h,p,x,v){var b=a(null);if(b.current===null){var _={hasValue:!1,value:null};b.current=_}else _=b.current;b=l(function(){function C(I){if(!P){if(P=!0,O=I,I=x(I),v!==void 0&&_.hasValue){var F=_.value;if(v(F,I))return M=F}return M=I}if(F=M,r(O,I))return F;var q=x(I);return v!==void 0&&v(F,q)?(O=I,F):(O=I,M=q)}var P=!1,O,M,D=p===void 0?null:p;return[function(){return C(h())},D===null?void 0:function(){return C(D())}]},[h,p,x,v]);var j=s(d,b[0],b[1]);return o(function(){_.hasValue=!0,_.value=j},[j]),c(j),j},eb}var Sk;function nU(){return Sk||(Sk=1,Xv.exports=tU()),Xv.exports}var rU=nU();const sU=wu(rU),v4={},{useDebugValue:iU}=ot,{useSyncExternalStoreWithSelector:aU}=sU;let Nk=!1;const oU=n=>n;function lU(n,e=oU,t){(v4?"production":void 0)!=="production"&&t&&!Nk&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Nk=!0);const r=aU(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return iU(r),r}const Ck=n=>{(v4?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?Qz(n):n,t=(r,s)=>lU(e,r,s);return Object.assign(t,e),t},ea=n=>n?Ck(n):Ck;var GS=function(n,e){return GS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},GS(n,e)};function oC(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");GS(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var xr=function(){return xr=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},xr.apply(this,arguments)};function $f(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function b4(n,e,t,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var l=n.length-1;l>=0;l--)(o=n[l])&&(a=(s<3?o(a):s>3?o(e,t,a):o(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a}function w4(n,e){return function(t,r){e(t,r,n)}}function _4(n,e,t,r,s,a){function o(C){if(C!==void 0&&typeof C!="function")throw new TypeError("Function expected");return C}for(var l=r.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&n?r.static?n:n.prototype:null,h=e||(d?Object.getOwnPropertyDescriptor(d,r.name):{}),p,x=!1,v=t.length-1;v>=0;v--){var b={};for(var _ in r)b[_]=_==="access"?{}:r[_];for(var _ in r.access)b.access[_]=r.access[_];b.addInitializer=function(C){if(x)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(C||null))};var j=(0,t[v])(l==="accessor"?{get:h.get,set:h.set}:h[c],b);if(l==="accessor"){if(j===void 0)continue;if(j===null||typeof j!="object")throw new TypeError("Object expected");(p=o(j.get))&&(h.get=p),(p=o(j.set))&&(h.set=p),(p=o(j.init))&&s.unshift(p)}else(p=o(j))&&(l==="field"?s.unshift(p):h[c]=p)}d&&Object.defineProperty(d,r.name,h),x=!0}function j4(n,e,t){for(var r=arguments.length>2,s=0;s<e.length;s++)t=r?e[s].call(n,t):e[s].call(n);return r?t:void 0}function S4(n){return typeof n=="symbol"?n:"".concat(n)}function N4(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function C4(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function bt(n,e,t,r){function s(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(h){try{d(r.next(h))}catch(p){o(p)}}function c(h){try{d(r.throw(h))}catch(p){o(p)}}function d(h){h.done?a(h.value):s(h.value).then(l,c)}d((r=r.apply(n,e||[])).next())})}function T4(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(h){return c([d,h])}}function c(d){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(t=0)),t;)try{if(r=1,s&&(a=d[0]&2?s.return:d[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,d[1])).done)return a;switch(s=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,s=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){t.label=d[1];break}if(d[0]===6&&t.label<a[1]){t.label=a[1],a=d;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(d);break}a[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(h){d=[6,h],s=0}finally{r=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var ty=Object.create?(function(n,e,t,r){r===void 0&&(r=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,s)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]});function k4(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ty(e,n,t)}function bx(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function lC(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(l){o={error:l}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function P4(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(lC(arguments[e]));return n}function M4(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),s=0,e=0;e<t;e++)for(var a=arguments[e],o=0,l=a.length;o<l;o++,s++)r[s]=a[o];return r}function E4(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,a;r<s;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function Nf(n){return this instanceof Nf?(this.v=n,this):new Nf(n)}function D4(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(v){return function(b){return Promise.resolve(b).then(v,p)}}function l(v,b){r[v]&&(s[v]=function(_){return new Promise(function(j,C){a.push([v,_,j,C])>1||c(v,_)})},b&&(s[v]=b(s[v])))}function c(v,b){try{d(r[v](b))}catch(_){x(a[0][3],_)}}function d(v){v.value instanceof Nf?Promise.resolve(v.value.v).then(h,p):x(a[0][2],v)}function h(v){c("next",v)}function p(v){c("throw",v)}function x(v,b){v(b),a.shift(),a.length&&c(a[0][0],a[0][1])}}function O4(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,a){e[s]=n[s]?function(o){return(t=!t)?{value:Nf(n[s](o)),done:!1}:a?a(o):o}:a}}function I4(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof bx=="function"?bx(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(l,c){o=n[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},o)}}function A4(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var cU=Object.create?(function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}):function(n,e){n.default=e},ZS=function(n){return ZS=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},ZS(n)};function R4(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=ZS(n),r=0;r<t.length;r++)t[r]!=="default"&&ty(e,n,t[r]);return cU(e,n),e}function L4(n){return n&&n.__esModule?n:{default:n}}function F4(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function q4(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t}function z4(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function U4(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,s;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var dU=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function B4(n){function e(a){n.error=n.hasError?new dU(a,n.error,"An error was suppressed during disposal."):a,n.hasError=!0}var t,r=0;function s(){for(;t=n.stack.pop();)try{if(!t.async&&r===1)return r=0,n.stack.push(t),Promise.resolve().then(s);if(t.dispose){var a=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(a).then(s,function(o){return e(o),s()})}else r|=1}catch(o){e(o)}if(r===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return s()}function V4(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,s,a,o){return r?e?".jsx":".js":s&&(!a||!o)?t:s+a+"."+o.toLowerCase()+"js"}):n}const uU={__extends:oC,__assign:xr,__rest:$f,__decorate:b4,__param:w4,__esDecorate:_4,__runInitializers:j4,__propKey:S4,__setFunctionName:N4,__metadata:C4,__awaiter:bt,__generator:T4,__createBinding:ty,__exportStar:k4,__values:bx,__read:lC,__spread:P4,__spreadArrays:M4,__spreadArray:E4,__await:Nf,__asyncGenerator:D4,__asyncDelegator:O4,__asyncValues:I4,__makeTemplateObject:A4,__importStar:R4,__importDefault:L4,__classPrivateFieldGet:F4,__classPrivateFieldSet:q4,__classPrivateFieldIn:z4,__addDisposableResource:U4,__disposeResources:B4,__rewriteRelativeImportExtension:V4},fU=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:U4,get __assign(){return xr},__asyncDelegator:O4,__asyncGenerator:D4,__asyncValues:I4,__await:Nf,__awaiter:bt,__classPrivateFieldGet:F4,__classPrivateFieldIn:z4,__classPrivateFieldSet:q4,__createBinding:ty,__decorate:b4,__disposeResources:B4,__esDecorate:_4,__exportStar:k4,__extends:oC,__generator:T4,__importDefault:L4,__importStar:R4,__makeTemplateObject:A4,__metadata:C4,__param:w4,__propKey:S4,__read:lC,__rest:$f,__rewriteRelativeImportExtension:V4,__runInitializers:j4,__setFunctionName:N4,__spread:P4,__spreadArray:E4,__spreadArrays:M4,__values:bx,default:uU},Symbol.toStringTag,{value:"Module"})),hU=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class cC extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class mU extends cC{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Tk extends cC{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class kk extends cC{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var KS;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(KS||(KS={}));class pU{constructor(e,{headers:t={},customFetch:r,region:s=KS.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=hU(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return bt(this,arguments,void 0,function*(t,r={}){var s;let a,o;try{const{headers:l,method:c,body:d,signal:h,timeout:p}=r;let x={},{region:v}=r;v||(v=this.region);const b=new URL(`${this.url}/${t}`);v&&v!=="any"&&(x["x-region"]=v,b.searchParams.set("forceFunctionRegion",v));let _;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(x["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(x["Content-Type"]="application/json",_=JSON.stringify(d)):_=d;let j=h;p&&(o=new AbortController,a=setTimeout(()=>o.abort(),p),h?(j=o.signal,h.addEventListener("abort",()=>o.abort())):j=o.signal);const C=yield this.fetch(b.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),l),body:_,signal:j}).catch(D=>{throw new mU(D)}),P=C.headers.get("x-relay-error");if(P&&P==="true")throw new Tk(C);if(!C.ok)throw new kk(C);let O=((s=C.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),M;return O==="application/json"?M=yield C.json():O==="application/octet-stream"||O==="application/pdf"?M=yield C.blob():O==="text/event-stream"?M=C:O==="multipart/form-data"?M=yield C.formData():M=yield C.text(),{data:M,error:null,response:C}}catch(l){return{data:null,error:l,response:l instanceof kk||l instanceof Tk?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var is={};const Hf=n4(fU);var Ap={},Rp={},Lp={},Fp={},qp={},zp={},Pk;function W4(){if(Pk)return zp;Pk=1,Object.defineProperty(zp,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return zp.default=n,zp}var Mk;function $4(){if(Mk)return qp;Mk=1,Object.defineProperty(qp,"__esModule",{value:!0});const e=Hf.__importDefault(W4());class t{constructor(s){var a,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(a=s.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=s.signal,this.isMaybeSingle=(o=s.isMaybeSingle)!==null&&o!==void 0?o:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,a){return this.headers=new Headers(this.headers),this.headers.set(s,a),this}then(s,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,h,p,x;let v=null,b=null,_=null,j=c.status,C=c.statusText;if(c.ok){if(this.method!=="HEAD"){const D=await c.text();D===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?b=D:b=JSON.parse(D))}const O=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),M=(p=c.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");O&&M&&M.length>1&&(_=parseInt(M[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(v={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,_=null,j=406,C="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const O=await c.text();try{v=JSON.parse(O),Array.isArray(v)&&c.status===404&&(b=[],v=null,j=200,C="OK")}catch{c.status===404&&O===""?(j=204,C="No Content"):v={message:O}}if(v&&this.isMaybeSingle&&(!((x=v?.details)===null||x===void 0)&&x.includes("0 rows"))&&(v=null,j=200,C="OK"),v&&this.shouldThrowOnError)throw new e.default(v)}return{error:v,data:b,count:_,status:j,statusText:C}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,h,p;return{error:{message:`${(d=c?.name)!==null&&d!==void 0?d:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(p=c?.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,a)}returns(){return this}overrideTypes(){return this}}return qp.default=t,qp}var Ek;function H4(){if(Ek)return Fp;Ek=1,Object.defineProperty(Fp,"__esModule",{value:!0});const e=Hf.__importDefault($4());class t extends e.default{select(s){let a=!1;const o=(s??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:a=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",h=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${h?`${h},`:""}${s}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this}range(s,a,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(d,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:a=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var h;const p=[s?"analyze":null,a?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),x=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${x}"; options=${p};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Fp.default=t,Fp}var Dk;function dC(){if(Dk)return Lp;Dk=1,Object.defineProperty(Lp,"__esModule",{value:!0});const e=Hf.__importDefault(H4()),t=new RegExp("[,()]");class r extends e.default{eq(a,o){return this.url.searchParams.append(a,`eq.${o}`),this}neq(a,o){return this.url.searchParams.append(a,`neq.${o}`),this}gt(a,o){return this.url.searchParams.append(a,`gt.${o}`),this}gte(a,o){return this.url.searchParams.append(a,`gte.${o}`),this}lt(a,o){return this.url.searchParams.append(a,`lt.${o}`),this}lte(a,o){return this.url.searchParams.append(a,`lte.${o}`),this}like(a,o){return this.url.searchParams.append(a,`like.${o}`),this}likeAllOf(a,o){return this.url.searchParams.append(a,`like(all).{${o.join(",")}}`),this}likeAnyOf(a,o){return this.url.searchParams.append(a,`like(any).{${o.join(",")}}`),this}ilike(a,o){return this.url.searchParams.append(a,`ilike.${o}`),this}ilikeAllOf(a,o){return this.url.searchParams.append(a,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(a,o){return this.url.searchParams.append(a,`ilike(any).{${o.join(",")}}`),this}is(a,o){return this.url.searchParams.append(a,`is.${o}`),this}in(a,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&t.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cs.{${o.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(o)}`),this}containedBy(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cd.{${o.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(o)}`),this}rangeGt(a,o){return this.url.searchParams.append(a,`sr.${o}`),this}rangeGte(a,o){return this.url.searchParams.append(a,`nxl.${o}`),this}rangeLt(a,o){return this.url.searchParams.append(a,`sl.${o}`),this}rangeLte(a,o){return this.url.searchParams.append(a,`nxr.${o}`),this}rangeAdjacent(a,o){return this.url.searchParams.append(a,`adj.${o}`),this}overlaps(a,o){return typeof o=="string"?this.url.searchParams.append(a,`ov.${o}`):this.url.searchParams.append(a,`ov.{${o.join(",")}}`),this}textSearch(a,o,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${h}.${o}`),this}match(a){return Object.entries(a).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(a,o,l){return this.url.searchParams.append(a,`not.${o}.${l}`),this}or(a,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,o,l){return this.url.searchParams.append(a,`${o}.${l}`),this}}return Lp.default=r,Lp}var Ok;function Y4(){if(Ok)return Rp;Ok=1,Object.defineProperty(Rp,"__esModule",{value:!0});const e=Hf.__importDefault(dC());class t{constructor(s,{headers:a={},schema:o,fetch:l}){this.url=s,this.headers=new Headers(a),this.schema=o,this.fetch=l}select(s,a){const{head:o=!1,count:l}=a??{},c=o?"HEAD":"GET";let d=!1;const h=(s??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",h),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:a,defaultToNull:o=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(d.length>0){const h=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(s,{onConflict:a,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var d;const h="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const p=s.reduce((x,v)=>x.concat(Object.keys(v)),[]);if(p.length>0){const x=[...new Set(p)].map(v=>`"${v}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(s,{count:a}={}){var o;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var a;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return Rp.default=t,Rp}var Ik;function gU(){if(Ik)return Ap;Ik=1,Object.defineProperty(Ap,"__esModule",{value:!0});const n=Hf,e=n.__importDefault(Y4()),t=n.__importDefault(dC());class r{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new r(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:d}={}){var h;let p;const x=new URL(`${this.url}/rpc/${a}`);let v;l||c?(p=l?"HEAD":"GET",Object.entries(o).filter(([_,j])=>j!==void 0).map(([_,j])=>[_,Array.isArray(j)?`{${j.join(",")}}`:`${j}`]).forEach(([_,j])=>{x.searchParams.append(_,j)})):(p="POST",v=o);const b=new Headers(this.headers);return d&&b.set("Prefer",`count=${d}`),new t.default({method:p,url:x,headers:b,schema:this.schemaName,body:v,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return Ap.default=r,Ap}var Ak;function xU(){if(Ak)return is;Ak=1,Object.defineProperty(is,"__esModule",{value:!0}),is.PostgrestError=is.PostgrestBuilder=is.PostgrestTransformBuilder=is.PostgrestFilterBuilder=is.PostgrestQueryBuilder=is.PostgrestClient=void 0;const n=Hf,e=n.__importDefault(gU());is.PostgrestClient=e.default;const t=n.__importDefault(Y4());is.PostgrestQueryBuilder=t.default;const r=n.__importDefault(dC());is.PostgrestFilterBuilder=r.default;const s=n.__importDefault(H4());is.PostgrestTransformBuilder=s.default;const a=n.__importDefault($4());is.PostgrestBuilder=a.default;const o=n.__importDefault(W4());return is.PostgrestError=o.default,is.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:a.default,PostgrestError:o.default},is}var G4=xU();const Z4=wu(G4),yU=t4({__proto__:null,default:Z4},[G4]),{PostgrestClient:vU,PostgrestQueryBuilder:Nfe,PostgrestFilterBuilder:Cfe,PostgrestTransformBuilder:Tfe,PostgrestBuilder:kfe,PostgrestError:Pfe}=Z4||yU;class bU{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const wU="2.81.1",_U=`realtime-js/${wU}`,K4="1.0.0",jU="2.0.0",Rk=K4,JS=1e4,SU=1e3,NU=100;var su;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(su||(su={}));var Tr;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Tr||(Tr={}));var Yi;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Yi||(Yi={}));var QS;(function(n){n.websocket="websocket"})(QS||(QS={}));var iu;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(iu||(iu={}));class CU{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(e,t){if(this._isArrayBuffer(e.payload))return t(this._binaryEncodePush(e));if(e.event===this.BROADCAST&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodePush(e){const{join_ref:t,ref:r,event:s,topic:a,payload:o}=e,l=this.META_LENGTH+t.length+r.length+a.length+s.length,c=new ArrayBuffer(this.HEADER_LENGTH+l);let d=new DataView(c),h=0;d.setUint8(h++,this.KINDS.push),d.setUint8(h++,t.length),d.setUint8(h++,r.length),d.setUint8(h++,a.length),d.setUint8(h++,s.length),Array.from(t,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(r,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(a,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(s,x=>d.setUint8(h++,x.charCodeAt(0)));var p=new Uint8Array(c.byteLength+o.byteLength);return p.set(new Uint8Array(c),0),p.set(new Uint8Array(o),c.byteLength),p.buffer}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const{join_ref:s,ref:a,topic:o}=e,l=e.payload.event,c=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:new ArrayBuffer(0),d=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+o.length+l.length,h=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(h),x=0;p.setUint8(x++,this.KINDS.userBroadcastPush),p.setUint8(x++,s.length),p.setUint8(x++,a.length),p.setUint8(x++,o.length),p.setUint8(x++,l.length),p.setUint8(x++,this.BINARY_ENCODING),Array.from(s,b=>p.setUint8(x++,b.charCodeAt(0))),Array.from(a,b=>p.setUint8(x++,b.charCodeAt(0))),Array.from(o,b=>p.setUint8(x++,b.charCodeAt(0))),Array.from(l,b=>p.setUint8(x++,b.charCodeAt(0)));var v=new Uint8Array(h.byteLength+c.byteLength);return v.set(new Uint8Array(h),0),v.set(new Uint8Array(c),h.byteLength),v.buffer}_encodeJsonUserBroadcastPush(e){var t,r;const{join_ref:s,ref:a,topic:o}=e,l=e.payload.event,c=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:{},h=new TextEncoder().encode(JSON.stringify(c)).buffer,p=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+o.length+l.length,x=new ArrayBuffer(this.HEADER_LENGTH+p);let v=new DataView(x),b=0;v.setUint8(b++,this.KINDS.userBroadcastPush),v.setUint8(b++,s.length),v.setUint8(b++,a.length),v.setUint8(b++,o.length),v.setUint8(b++,l.length),v.setUint8(b++,this.JSON_ENCODING),Array.from(s,j=>v.setUint8(b++,j.charCodeAt(0))),Array.from(a,j=>v.setUint8(b++,j.charCodeAt(0))),Array.from(o,j=>v.setUint8(b++,j.charCodeAt(0))),Array.from(l,j=>v.setUint8(b++,j.charCodeAt(0)));var _=new Uint8Array(x.byteLength+h.byteLength);return _.set(new Uint8Array(x),0),_.set(new Uint8Array(h),x.byteLength),_.buffer}decode(e,t){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return t(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,a,o,l,c]=r;return t({join_ref:s,ref:a,topic:o,event:l,payload:c})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.push:return this._decodePush(e,t,s);case this.KINDS.reply:return this._decodeReply(e,t,s);case this.KINDS.broadcast:return this._decodeBroadcast(e,t,s);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,s)}}_decodePush(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3);let l=this.HEADER_LENGTH+this.META_LENGTH-1;const c=r.decode(e.slice(l,l+s));l=l+s;const d=r.decode(e.slice(l,l+a));l=l+a;const h=r.decode(e.slice(l,l+o));l=l+o;const p=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{join_ref:c,ref:null,topic:d,event:h,payload:p}}_decodeReply(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+this.META_LENGTH;const d=r.decode(e.slice(c,c+s));c=c+s;const h=r.decode(e.slice(c,c+a));c=c+a;const p=r.decode(e.slice(c,c+o));c=c+o;const x=r.decode(e.slice(c,c+l));c=c+l;const v=JSON.parse(r.decode(e.slice(c,e.byteLength))),b={status:x,response:v};return{join_ref:d,ref:h,topic:p,event:Yi.reply,payload:b}}_decodeBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+s));o=o+s;const c=r.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{join_ref:null,ref:null,topic:l,event:c,payload:d}}_decodeUserBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+4;const d=r.decode(e.slice(c,c+s));c=c+s;const h=r.decode(e.slice(c,c+a));c=c+a;const p=r.decode(e.slice(c,c+o));c=c+o;const x=e.slice(c,e.byteLength),v=l===this.JSON_ENCODING?JSON.parse(r.decode(x)):x,b={type:this.BROADCAST,event:h,payload:v};return o>0&&(b.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST,payload:b}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}}class J4{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ln;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ln||(Ln={}));const Lk=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((a,o)=>(a[o]=TU(o,n,e,s),a),{}):{}},TU=(n,e,t,r)=>{const s=e.find(l=>l.name===n),a=s?.type,o=t[n];return a&&!r.includes(a)?Q4(a,o):XS(o)},Q4=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return EU(e,t)}switch(n){case Ln.bool:return kU(e);case Ln.float4:case Ln.float8:case Ln.int2:case Ln.int4:case Ln.int8:case Ln.numeric:case Ln.oid:return PU(e);case Ln.json:case Ln.jsonb:return MU(e);case Ln.timestamp:return DU(e);case Ln.abstime:case Ln.date:case Ln.daterange:case Ln.int4range:case Ln.int8range:case Ln.money:case Ln.reltime:case Ln.text:case Ln.time:case Ln.timestamptz:case Ln.timetz:case Ln.tsrange:case Ln.tstzrange:return XS(e);default:return XS(e)}},XS=n=>n,kU=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},PU=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},MU=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},EU=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let a;const o=n.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Q4(e,l))}return n},DU=n=>typeof n=="string"?n.replace(" ","T"):n,X4=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class rb{constructor(e,t,r={},s=JS){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Fk;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Fk||(Fk={}));class Xh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Xh.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=Xh.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Xh.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const a=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(a,(d,h)=>{o[d]||(c[d]=h)}),this.map(o,(d,h)=>{const p=a[d];if(p){const x=h.map(j=>j.presence_ref),v=p.map(j=>j.presence_ref),b=h.filter(j=>v.indexOf(j.presence_ref)<0),_=p.filter(j=>x.indexOf(j.presence_ref)<0);b.length>0&&(l[d]=b),_.length>0&&(c[d]=_)}else l[d]=h}),this.syncDiff(a,{joins:l,leaves:c},r,s)}static syncDiff(e,t,r,s){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var d;const h=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),h.length>0){const p=e[l].map(v=>v.presence_ref),x=h.filter(v=>p.indexOf(v.presence_ref)<0);e[l].unshift(...x)}r(l,h,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const h=c.map(p=>p.presence_ref);d=d.filter(p=>h.indexOf(p.presence_ref)<0),e[l]=d,s(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var qk;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(qk||(qk={}));var em;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(em||(em={}));var yl;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(yl||(yl={}));class uC{constructor(e,t={config:{}},r){var s,a;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Tr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new rb(this,Yi.join,this.params,this.timeout),this.rejoinTimer=new J4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Tr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Tr.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Tr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Tr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Tr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yi.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Xh(this),this.broadcastEndpointURL=X4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Tr.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(v=>v.filter))!==null&&s!==void 0?s:[],h=!!this.bindings[em.PRESENCE]&&this.bindings[em.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,p={},x={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(yl.CHANNEL_ERROR,v)),this._onClose(()=>e?.(yl.CLOSED)),this.updateJoinPayload(Object.assign({config:x},p)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var b;if(this.socket.setAuth(),v===void 0){e?.(yl.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,j=(b=_?.length)!==null&&b!==void 0?b:0,C=[];for(let P=0;P<j;P++){const O=_[P],{filter:{event:M,schema:D,table:I,filter:F}}=O,q=v&&v[P];if(q&&q.event===M&&q.schema===D&&q.table===I&&q.filter===F)C.push(Object.assign(Object.assign({},O),{id:q.id}));else{this.unsubscribe(),this.state=Tr.errored,e?.(yl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=C,e&&e(yl.SUBSCRIBED);return}}).receive("error",v=>{this.state=Tr.errored,e?.(yl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(yl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===Tr.joined&&e===em.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var s;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Tr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yi.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new rb(this,Yi.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Tr.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,a=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new rb(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>NU){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:h}=Yi;if(r&&[l,c,d,h].indexOf(o)>=0&&r!==this._joinRef())return;let x=this._onMessage(o,t,r);if(t&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var b,_,j;return((b=v.filter)===null||b===void 0?void 0:b.event)==="*"||((j=(_=v.filter)===null||_===void 0?void 0:_.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===o}).map(v=>v.callback(x,r)):(a=this.bindings[o])===null||a===void 0||a.filter(v=>{var b,_,j,C,P,O;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const M=v.id,D=(b=v.filter)===null||b===void 0?void 0:b.event;return M&&((_=t.ids)===null||_===void 0?void 0:_.includes(M))&&(D==="*"||D?.toLocaleLowerCase()===((j=t.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const M=(P=(C=v?.filter)===null||C===void 0?void 0:C.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return M==="*"||M===((O=t?.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof x=="object"&&"ids"in x){const b=x.data,{schema:_,table:j,commit_timestamp:C,type:P,errors:O}=b;x=Object.assign(Object.assign({},{schema:_,table:j,commit_timestamp:C,eventType:P,new:{},old:{},errors:O}),this._getPayloadRecords(b))}v.callback(x,r)})}_isClosed(){return this.state===Tr.closed}_isJoined(){return this.state===Tr.joined}_isJoining(){return this.state===Tr.joining}_isLeaving(){return this.state===Tr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&uC.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Yi.close,{},e)}_onError(e){this._on(Yi.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Tr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Lk(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Lk(e.columns,e.old_record)),t}}const sb=()=>{},Up={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},OU=[1e3,2e3,5e3,1e4],IU=1e4,AU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class RU{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=JS,this.transport=null,this.heartbeatIntervalMs=Up.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=sb,this.ref=0,this.reconnectTimer=null,this.vsn=Rk,this.logger=sb,this.conn=null,this.sendBuffer=[],this.serializer=new CU,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${QS.websocket}`,this.httpEndpoint=X4(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=bU.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case su.connecting:return iu.Connecting;case su.open:return iu.Open;case su.closing:return iu.Closing;default:return iu.Closed}}isConnected(){return this.connectionState()===iu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(a=>a.topic===r);if(s)return s;{const a=new uC(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:r,payload:s,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${r} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(SU,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Up.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:a,ref:o}=t,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${r} ${s} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(s,a,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===su.open||this.conn.readyState===su.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Yi.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([AU],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:_U};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Yi.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new J4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Up.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,a,o,l,c,d,h,p,x,v;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:JS,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:Up.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:sb,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:Rk,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(b=>OU[b-1]||IU),this.vsn){case K4:this.encode=(h=e?.encode)!==null&&h!==void 0?h:((b,_)=>_(JSON.stringify(b))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:((b,_)=>_(JSON.parse(b)));break;case jU:this.encode=(x=e?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(v=e?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class fC extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Qn(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class LU extends fC{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class eN extends fC{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const hC=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),FU=()=>Response,tN=n=>{if(Array.isArray(n))return n.map(t=>tN(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[s]=tN(r)}),e},qU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},ib=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},zU=(n,e,t)=>bt(void 0,void 0,void 0,function*(){const r=yield FU();n instanceof r&&!t?.noResolveJson?n.json().then(s=>{const a=n.status||500,o=s?.statusCode||a+"";e(new LU(ib(s),a,o))}).catch(s=>{e(new eN(ib(s),s))}):e(new eN(ib(n),n))}),UU=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||!r?s:(qU(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,e?.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function Dm(n,e,t,r,s,a){return bt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,UU(e,r,s,a)).then(c=>{if(!c.ok)throw c;return r?.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>zU(c,l,r))})})}function dm(n,e,t,r){return bt(this,void 0,void 0,function*(){return Dm(n,"GET",e,t,r)})}function Na(n,e,t,r,s){return bt(this,void 0,void 0,function*(){return Dm(n,"POST",e,r,s,t)})}function nN(n,e,t,r,s){return bt(this,void 0,void 0,function*(){return Dm(n,"PUT",e,r,s,t)})}function BU(n,e,t,r){return bt(this,void 0,void 0,function*(){return Dm(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function mC(n,e,t,r,s){return bt(this,void 0,void 0,function*(){return Dm(n,"DELETE",e,r,s,t)})}class VU{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return bt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Qn(e))return{data:null,error:e};throw e}})}}var eF;class WU{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[eF]="BlobDownloadBuilder",this.promise=null}asStream(){return new VU(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return bt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Qn(e))return{data:null,error:e};throw e}})}}eF=Symbol.toStringTag;const $U={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},zk={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class HU{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=hC(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return bt(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},zk),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),s?.headers&&(l=Object.assign(Object.assign({},l),s.headers));const d=this._removeEmptyFolders(t),h=this._getFinalPath(d),p=yield(e=="PUT"?nN:Na)(this.fetch,`${this.url}/object/${h}`,a,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Qn(a))return{data:null,error:a};throw a}})}upload(e,t,r){return bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return bt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:zk.upsert},s),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const p=yield nN(this.fetch,l.toString(),c,{headers:h});return{data:{path:a,fullPath:p.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Qn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return bt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");const a=yield Na(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new fC("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}update(e,t,r){return bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return bt(this,void 0,void 0,function*(){try{return{data:yield Na(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}copy(e,t,r){return bt(this,void 0,void 0,function*(){try{return{data:{path:(yield Na(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return bt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),a=yield Na(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return bt(this,void 0,void 0,function*(){try{const s=yield Na(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}download(e,t){const s=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),o=a?`?${a}`:"",l=this._getFinalPath(e),c=()=>dm(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new WU(c,this.shouldThrowOnError)}info(e){return bt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield dm(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:tN(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}exists(e){return bt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield BU(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r)&&r instanceof eN){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return bt(this,void 0,void 0,function*(){try{return{data:yield mC(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}list(e,t,r){return bt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},$U),t),{prefix:e||""});return{data:yield Na(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}listV2(e,t){return bt(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Na(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const tF="2.81.1",nF={"X-Client-Info":`storage-js/${tF}`};class YU{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},nF),t),this.fetch=hC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return bt(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield dm(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}getBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield dm(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}createBucket(e){return bt(this,arguments,void 0,function*(t,r={public:!1}){try{return{data:yield Na(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return bt(this,void 0,void 0,function*(){try{return{data:yield nN(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield Na(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield mC(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}class GU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},nF),t),this.fetch=hC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield Na(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}listBuckets(e){return bt(this,void 0,void 0,function*(){try{const t=new URLSearchParams;e?.limit!==void 0&&t.set("limit",e.limit.toString()),e?.offset!==void 0&&t.set("offset",e.offset.toString()),e?.sortColumn&&t.set("sortColumn",e.sortColumn),e?.sortOrder&&t.set("sortOrder",e.sortOrder),e?.search&&t.set("search",e.search);const r=t.toString(),s=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield dm(this.fetch,s,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield mC(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}}const pC={"X-Client-Info":`storage-js/${tF}`,"Content-Type":"application/json"};class rF extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function gi(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}class ab extends rF{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ZU extends rF{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var Uk;(function(n){n.InternalError="InternalError",n.S3VectorConflictException="S3VectorConflictException",n.S3VectorNotFoundException="S3VectorNotFoundException",n.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",n.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",n.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Uk||(Uk={}));const gC=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),KU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Bk=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),JU=(n,e,t)=>bt(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!t?.noResolveJson){const s=n.status||500,a=n;if(typeof a.json=="function")a.json().then(o=>{const l=o?.statusCode||o?.code||s+"";e(new ab(Bk(o),s,l))}).catch(()=>{const o=s+"",l=a.statusText||`HTTP ${s} error`;e(new ab(l,s,o))});else{const o=s+"",l=a.statusText||`HTTP ${s} error`;e(new ab(l,s,o))}}else e(new ZU(Bk(n),n))}),QU=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return r?(KU(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,Object.assign(Object.assign({},s),t)):s};function XU(n,e,t,r,s,a){return bt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,QU(e,r,s,a)).then(c=>{if(!c.ok)throw c;if(r?.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>JU(c,l,r))})})}function xi(n,e,t,r,s){return bt(this,void 0,void 0,function*(){return XU(n,"POST",e,r,s,t)})}class eB{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pC),t),this.fetch=gC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return bt(this,void 0,void 0,function*(){try{return{data:(yield xi(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}getIndex(e,t){return bt(this,void 0,void 0,function*(){try{return{data:yield xi(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(gi(r))return{data:null,error:r};throw r}})}listIndexes(e){return bt(this,void 0,void 0,function*(){try{return{data:yield xi(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return bt(this,void 0,void 0,function*(){try{return{data:(yield xi(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(gi(r))return{data:null,error:r};throw r}})}}class tB{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pC),t),this.fetch=gC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return bt(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield xi(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}getVectors(e){return bt(this,void 0,void 0,function*(){try{return{data:yield xi(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}listVectors(e){return bt(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield xi(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}queryVectors(e){return bt(this,void 0,void 0,function*(){try{return{data:yield xi(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}deleteVectors(e){return bt(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield xi(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}}class nB{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pC),t),this.fetch=gC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:(yield xi(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}getBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield xi(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}listBuckets(){return bt(this,arguments,void 0,function*(e={}){try{return{data:yield xi(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}deleteBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:(yield xi(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(gi(t))return{data:null,error:t};throw t}})}}class rB extends nB{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new sB(this.url,this.headers,e,this.fetch)}}class sB extends eB{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return bt(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return bt(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return bt(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return bt(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new iB(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class iB extends tB{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return bt(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return bt(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return bt(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return bt(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return bt(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class aB extends YU{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new HU(this.url,this.headers,e,this.fetch)}get vectors(){return new rB(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new GU(this.url+"/iceberg",this.headers,this.fetch)}}const oB="2.81.1";let $h="";typeof Deno<"u"?$h="deno":typeof document<"u"?$h="web":typeof navigator<"u"&&navigator.product==="ReactNative"?$h="react-native":$h="node";const lB={"X-Client-Info":`supabase-js-${$h}/${oB}`},cB={headers:lB},dB={schema:"public"},uB={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},fB={},hB=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),mB=()=>Headers,pB=(n,e,t)=>{const r=hB(t),s=mB();return async(a,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:n;let d=new s(o?.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(a,Object.assign(Object.assign({},o),{headers:d}))}};function gB(n){return n.endsWith("/")?n:n+"/"}function xB(n,e){var t,r;const{db:s,auth:a,realtime:o,global:l}=n,{db:c,auth:d,realtime:h,global:p}=e,x={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},h),o),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(t=p?.headers)!==null&&t!==void 0?t:{}),(r=l?.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return n.accessToken?x.accessToken=n.accessToken:delete x.accessToken,x}function yB(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(gB(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const sF="2.81.1",af=30*1e3,rN=3,ob=rN*af,vB="http://localhost:9999",bB="supabase.auth.token",wB={"X-Client-Info":`gotrue-js/${sF}`},sN="X-Supabase-Api-Version",iF={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},_B=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jB=600*1e3;class um extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function wt(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class SB extends um{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function NB(n){return wt(n)&&n.name==="AuthApiError"}class au extends um{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Kc extends um{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class ja extends Kc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function CB(n){return wt(n)&&n.name==="AuthSessionMissingError"}class Yu extends Kc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Bp extends Kc{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Vp extends Kc{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function TB(n){return wt(n)&&n.name==="AuthImplicitGrantRedirectError"}class Vk extends Kc{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class iN extends Kc{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function lb(n){return wt(n)&&n.name==="AuthRetryableFetchError"}class Wk extends Kc{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class aN extends Kc{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const wx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),$k=` 	
\r=`.split(""),kB=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<$k.length;e+=1)n[$k[e].charCodeAt(0)]=-2;for(let e=0;e<wx.length;e+=1)n[wx[e].charCodeAt(0)]=e;return n})();function Hk(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(wx[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(wx[r]),e.queuedBits-=6}}function aF(n,e,t){const r=kB[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Yk(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{EB(o,r,t)};for(let o=0;o<n.length;o+=1)aF(n.charCodeAt(o),s,a);return e.join("")}function PB(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function MB(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}PB(r,e)}}function EB(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function pf(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)aF(n.charCodeAt(s),t,r);return new Uint8Array(e)}function DB(n){const e=[];return MB(n,t=>e.push(t)),new Uint8Array(e)}function ou(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>Hk(s,t,r)),Hk(null,t,r),e.join("")}function OB(n){return Math.round(Date.now()/1e3)+n}function IB(){return Symbol("auth-callback")}const Yr=()=>typeof window<"u"&&typeof document<"u",Wd={tested:!1,writable:!1},oF=()=>{if(!Yr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Wd.tested)return Wd.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Wd.tested=!0,Wd.writable=!0}catch{Wd.tested=!0,Wd.writable=!1}return Wd.writable};function AB(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,a)=>{e[a]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const lF=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),RB=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",of=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},$d=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Sc=async(n,e)=>{await n.removeItem(e)};class ny{constructor(){this.promise=new ny.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}ny.promiseConstructor=Promise;function cb(n){const e=n.split(".");if(e.length!==3)throw new aN("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!_B.test(e[r]))throw new aN("JWT not in base64url format");return{header:JSON.parse(Yk(e[0])),payload:JSON.parse(Yk(e[1])),signature:pf(e[2]),raw:{header:e[0],payload:e[1]}}}async function LB(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function FB(n,e){return new Promise((r,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await n(a);if(!e(a,null,o)){r(o);return}}catch(o){if(!e(a,o)){s(o);return}}})()})}function qB(n){return("0"+n.toString(16)).substr(-2)}function zB(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let a=0;a<56;a++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,qB).join("")}async function UB(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function BB(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await UB(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Gu(n,e,t=!1){const r=zB();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await of(n,`${e}-code-verifier`,s);const a=await BB(r);return[a,r===a?"plain":"s256"]}const VB=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function WB(n){const e=n.headers.get(sN);if(!e||!e.match(VB))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function $B(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function HB(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const YB=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Zu(n){if(!YB.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function db(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function GB(n,e){return new Proxy(n,{get:(t,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,r,s)}})}function Gk(n){return JSON.parse(JSON.stringify(n))}const eu=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ZB=[502,503,504];async function Zk(n){var e;if(!RB(n))throw new iN(eu(n),0);if(ZB.includes(n.status))throw new iN(eu(n),n.status);let t;try{t=await n.json()}catch(a){throw new au(eu(a),a)}let r;const s=WB(n);if(s&&s.getTime()>=iF["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Wk(eu(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ja}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Wk(eu(t),n.status,t.weak_password.reasons);throw new SB(eu(t),n.status||500,r)}const KB=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function It(n,e,t,r){var s;const a=Object.assign({},r?.headers);a[sN]||(a[sN]=iF["2024-01-01"].name),r?.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const o=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await JB(n,e,t+l,{headers:a,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(c):{data:Object.assign({},c),error:null}}async function JB(n,e,t,r,s,a){const o=KB(e,r,s,a);let l;try{l=await n(t,Object.assign({},o))}catch(c){throw console.error(c),new iN(eu(c),0)}if(l.ok||await Zk(l),r?.noResolveJson)return l;try{return await l.json()}catch(c){await Zk(c)}}function Sa(n){var e;let t=null;eV(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=OB(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function Kk(n){const e=Sa(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Ac(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function QB(n){return{data:n,error:null}}function XB(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a}=n,o=$f(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Jk(n){return n}function eV(n){return n.access_token&&n.refresh_token&&n.expires_in}const ub=["global","local","others"];class tV{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=lF(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=ub[0]){if(ub.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ub.join(", ")}`);try{return await It(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(wt(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await It(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ac})}catch(r){if(wt(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=$f(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await It(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:XB,redirectTo:t?.redirectTo})}catch(t){if(wt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await It(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ac})}catch(t){if(wt(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await It(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:Jk});if(h.error)throw h.error;const p=await h.json(),x=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(b.split(";")[1].split("=")[1]);d[`${j}Page`]=_}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(wt(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Zu(e);try{return await It(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ac})}catch(t){if(wt(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Zu(e);try{return await It(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ac})}catch(r){if(wt(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Zu(e);try{return await It(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ac})}catch(r){if(wt(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Zu(e.userId);try{const{data:t,error:r}=await It(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Zu(e.userId),Zu(e.id);try{return{data:await It(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await It(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:Jk});if(h.error)throw h.error;const p=await h.json(),x=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(b.split(";")[1].split("=")[1]);d[`${j}Page`]=_}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(wt(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await It(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await It(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await It(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(wt(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await It(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await It(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}}function Qk(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Ku={debug:!!(globalThis&&oF()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cF extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class nV extends cF{}async function rV(n,e,t){Ku.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Ku.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Ku.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Ku.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Ku.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new nV(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Ku.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function sV(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function dF(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function iV(n){return parseInt(n,16)}function aV(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function oV(n){var e;const{chainId:t,domain:r,expirationTime:s,issuedAt:a=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:h,uri:p,version:x}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const v=dF(n.address),b=h?`${h}://${r}`:r,_=n.statement?`${n.statement}
`:"",j=`${b} wants you to sign in with your Ethereum account:
${v}

${_}`;let C=`URI: ${p}
Version: ${x}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(s&&(C+=`
Expiration Time: ${s.toISOString()}`),l&&(C+=`
Not Before: ${l.toISOString()}`),c&&(C+=`
Request ID: ${c}`),d){let P=`
Resources:`;for(const O of d){if(!O||typeof O!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${O}`);P+=`
- ${O}`}C+=P}return`${j}
${C}`}class yr extends Error{constructor({message:e,code:t,cause:r,name:s}){var a;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(a=s??(r instanceof Error?r.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=t}}class _x extends yr{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function lV({error:n,options:e}){var t,r,s;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new yr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=a.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new yr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((r=a.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new yr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new yr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new yr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new yr({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new yr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new yr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(uF(o)){if(a.rp.id!==o)return new yr({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new yr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new yr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new yr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new yr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function cV({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new yr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new yr({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const r=window.location.hostname;if(uF(r)){if(t.rpId!==r)return new yr({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new yr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new yr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new yr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class dV{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const uV=new dV;function fV(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:r}=n,s=$f(n,["challenge","user","excludeCredentials"]),a=pf(e).buffer,o=Object.assign(Object.assign({},t),{id:pf(t.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:a,user:o});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const d=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:pf(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function hV(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,r=$f(n,["challenge","allowCredentials"]),s=pf(e).buffer,a=Object.assign(Object.assign({},r),{challenge:s});if(t&&t.length>0){a.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const l=t[o];a.allowCredentials[o]=Object.assign(Object.assign({},l),{id:pf(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function mV(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:ou(new Uint8Array(n.response.attestationObject)),clientDataJSON:ou(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function pV(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,r=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:ou(new Uint8Array(s.authenticatorData)),clientDataJSON:ou(new Uint8Array(s.clientDataJSON)),signature:ou(new Uint8Array(s.signature)),userHandle:s.userHandle?ou(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function uF(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Xk(){var n,e;return!!(Yr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function gV(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new _x("Browser returned unexpected credential type",e)}:{data:null,error:new _x("Empty credential response",e)}}catch(e){return{data:null,error:lV({error:e,options:n})}}}async function xV(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new _x("Browser returned unexpected credential type",e)}:{data:null,error:new _x("Empty credential response",e)}}catch(e){return{data:null,error:cV({error:e,options:n})}}}const yV={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},vV={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function jx(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of n)if(s)for(const a in s){const o=s[a];if(o!==void 0)if(Array.isArray(o))r[a]=o;else if(t(o))r[a]=o;else if(e(o)){const l=r[a];e(l)?r[a]=jx(l,o):r[a]=jx(o)}else r[a]=o}return r}function bV(n,e){return jx(yV,n,e||{})}function wV(n,e){return jx(vV,n,e||{})}class _V{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},a){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:l};const c=s??uV.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=bV(o.webauthn.credential_options.publicKey,a?.create),{data:h,error:p}=await gV({publicKey:d,signal:c});return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}case"request":{const d=wV(o.webauthn.credential_options.publicKey,a?.request),{data:h,error:p}=await xV(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:c}));return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}}}catch(o){return wt(o)?{data:null,error:o}:{data:null,error:new au("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new um("rpId is required for WebAuthn authentication")};try{if(!Xk())return{data:null,error:new au("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:a});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:r,credential_response:c.credential_response}})}catch(o){return wt(o)?{data:null,error:o}:{data:null,error:new au("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new um("rpId is required for WebAuthn registration")};try{if(!Xk())return{data:null,error:new au("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(h=>{var p;return(p=h.data)===null||p===void 0?void 0:p.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:a});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return wt(o)?{data:null,error:o}:{data:null,error:new au("Unexpected error in register",o)}}}}sV();const jV={url:vB,storageKey:bB,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wB,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function eP(n,e,t){return await t()}const Ju={};class fm{get jwks(){var e,t;return(t=(e=Ju[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Ju[this.storageKey]=Object.assign(Object.assign({},Ju[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Ju[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ju[this.storageKey]=Object.assign(Object.assign({},Ju[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},jV),e);if(this.storageKey=a.storageKey,this.instanceID=(t=fm.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,fm.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&Yr()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new tV({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=lF(a.fetch),this.lock=a.lock||eP,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:Yr()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=rV:this.lock=eP,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new _V(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:oF()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Qk(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Qk(this.memoryStorage)),Yr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${sF}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},r="none";if(Yr()&&(t=AB(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),Yr()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),TB(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return wt(t)?this._returnResult({error:t}):this._returnResult({error:new au("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const a=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:Sa}),{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(wt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,r,s;try{let a;if("email"in e){const{email:h,password:p,options:x}=e;let v=null,b=null;this.flowType==="pkce"&&([v,b]=await Gu(this.storage,this.storageKey)),a=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:h,password:p,data:(t=x?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:v,code_challenge_method:b},xform:Sa})}else if("phone"in e){const{phone:h,password:p,options:x}=e;a=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:p,data:(r=x?.data)!==null&&r!==void 0?r:{},channel:(s=x?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Sa})}else throw new Bp("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(wt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:l}=e;t=await It(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Kk})}else if("phone"in e){const{phone:a,password:o,options:l}=e;t=await It(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Kk})}else throw new Bp("You must provide either an email or phone number and a password");const{data:r,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const a=new Yu;return this._returnResult({data:{user:null,session:null},error:a})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,a,o,l,c,d,h,p,x;let v,b;if("message"in e)v=e.message,b=e.signature;else{const{chain:_,wallet:j,statement:C,options:P}=e;let O;if(Yr())if(typeof j=="object")O=j;else{const U=window;if("ethereum"in U&&typeof U.ethereum=="object"&&"request"in U.ethereum&&typeof U.ethereum.request=="function")O=U.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!P?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=j}const M=new URL((t=P?.url)!==null&&t!==void 0?t:window.location.href),D=await O.request({method:"eth_requestAccounts"}).then(U=>U).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!D||D.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=dF(D[0]);let F=(r=P?.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!F){const U=await O.request({method:"eth_chainId"});F=iV(U)}const q={domain:M.host,address:I,statement:C,uri:M.href,version:"1",chainId:F,nonce:(s=P?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(a=P?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=P?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=P?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=P?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(h=P?.signInWithEthereum)===null||h===void 0?void 0:h.resources};v=oV(q),b=await O.request({method:"personal_sign",params:[aV(v),I]})}try{const{data:_,error:j}=await It(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:b},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Sa});if(j)throw j;if(!_||!_.session||!_.user){const C=new Yu;return this._returnResult({data:{user:null,session:null},error:C})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:j})}catch(_){if(wt(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var t,r,s,a,o,l,c,d,h,p,x,v;let b,_;if("message"in e)b=e.message,_=e.signature;else{const{chain:j,wallet:C,statement:P,options:O}=e;let M;if(Yr())if(typeof C=="object")M=C;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))M=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!O?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=C}const D=new URL((t=O?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in M&&M.signIn){const I=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},O?.signInWithSolana),{version:"1",domain:D.host,uri:D.href}),P?{statement:P}:null));let F;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")F=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)F=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)b=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),_=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${D.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...P?["",P,""]:[""],"Version: 1",`URI: ${D.href}`,`Issued At: ${(s=(r=O?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=O?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${O.signInWithSolana.notBefore}`]:[],...!((o=O?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${O.signInWithSolana.expirationTime}`]:[],...!((l=O?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${O.signInWithSolana.chainId}`]:[],...!((c=O?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${O.signInWithSolana.nonce}`]:[],...!((d=O?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${O.signInWithSolana.requestId}`]:[],...!((p=(h=O?.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||p===void 0)&&p.length?["Resources",...O.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const I=await M.signMessage(new TextEncoder().encode(b),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=I}}try{const{data:j,error:C}=await It(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:ou(_)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Sa});if(C)throw C;if(!j||!j.session||!j.user){const P=new Yu;return this._returnResult({data:{user:null,session:null},error:P})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:C})}catch(j){if(wt(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async _exchangeCodeForSession(e){const t=await $d(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:a,error:o}=await It(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Sa});if(await Sc(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const l=new Yu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(wt(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:a,nonce:o}=e,l=await It(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Sa}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const h=new Yu;return this._returnResult({data:{user:null,session:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,s,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Gu(this.storage,this.storageKey));const{error:p}=await It(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c?.data)!==null&&t!==void 0?t:{},create_user:(r=c?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:h}=await It(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(a=c?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(o=c?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:h})}throw new Bp("You must provide either an email or phone number.")}catch(l){if(wt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,r;try{let s,a;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await It(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:Sa});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(wt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,r,s,a,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Gu(this.storage,this.storageKey));const d=await It(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:QB});return!((a=d.data)===null||a===void 0)&&a.url&&Yr()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(wt(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ja;const{error:s}=await It(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(wt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:a}=e,{error:o}=await It(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:s,options:a}=e,{data:o,error:l}=await It(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new Bp("You must provide either an email or phone number and a type")}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await $d(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<ob:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await $d(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=db()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=GB(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await It(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ac}):await this._useSession(async t=>{var r,s,a;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ja}:await It(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Ac})})}catch(t){if(wt(t))return CB(t)&&(await this._removeSession(),await Sc(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new ja;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Gu(this.storage,this.storageKey));const{data:d,error:h}=await It(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Ac});if(h)throw h;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(wt(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ja;const t=Date.now()/1e3;let r=t,s=!0,a=null;const{payload:o}=cb(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(wt(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new ja;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Yr())throw new Vp("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Vp(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Vk("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vp("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Vk("No code detected.");const{data:P,error:O}=await this._exchangeCodeForSession(e.code);if(O)throw O;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new Vp("No session defined in URL");const h=Math.round(Date.now()/1e3),p=parseInt(l);let x=h+p;c&&(x=parseInt(c));const v=x-h;v*1e3<=af&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${p}s`);const b=x-p;h-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,x,h):h-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,x,h);const{data:_,error:j}=await this._getUser(a);if(j)throw j;const C={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:p,expires_at:x,refresh_token:o,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:C,redirectType:e.type},error:null})}catch(r){if(wt(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await $d(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({error:a});const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(NB(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await Sc(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=IB(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:a},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Gu(this.storage,this.storageKey,!0));try{return await It(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(wt(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:s}=await this._useSession(async a=>{var o,l,c,d,h;const{data:p,error:x}=a;if(x)throw x;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await It(this.fetch,"GET",v,{headers:this.headers,jwt:(h=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return Yr()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),this._returnResult({data:{provider:e.provider,url:r?.url},error:null})}catch(r){if(wt(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:s,data:{session:a}}=t;if(s)throw s;const{options:o,provider:l,token:c,access_token:d,nonce:h}=e,p=await It(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=a?.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:d,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Sa}),{data:x,error:v}=p;return v?this._returnResult({data:{user:null,session:null},error:v}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Yu}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:v}))}catch(s){if(wt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:o}=t;if(o)throw o;return await It(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await FB(async s=>(s>0&&await LB(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await It(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Sa})),(s,a)=>{const o=200*Math.pow(2,s);return a&&lb(a)&&Date.now()+o-r<af})}catch(r){if(this._debug(t,"error",r),wt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Yr()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await $d(this.storage,this.storageKey);if(s&&this.userStorage){let o=await $d(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await of(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:db()}else if(s&&!s.user&&!s.user){const o=await $d(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await Sc(this.storage,this.storageKey+"-user"),await of(this.storage,this.storageKey,s)):s.user=db()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const a=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<ob;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${ob}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),lb(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ja;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new ny;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new ja;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),wt(a)){const o={data:null,error:a};return lb(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await of(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const a=Gk(s);await of(this.storage,this.storageKey,a)}else{const s=Gk(t);await of(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Sc(this.storage,this.storageKey),await Sc(this.storage,this.storageKey+"-code-verifier"),await Sc(this.storage,this.storageKey+"-user"),this.userStorage&&await Sc(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Yr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),af);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/af);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${af}ms, refresh threshold is ${rN} ticks`),s<=rN&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof cF)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Yr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,o]=await Gu(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r?.queryParams){const a=new URLSearchParams(r.queryParams);s.push(a.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;return a?this._returnResult({data:null,error:a}):await It(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await It(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=a?.session)===null||r===void 0?void 0:r.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?mV(e.webauthn.credential_response):pV(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await It(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=await It(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:fV(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:hV(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=cb(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((t=(e=r.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await It(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ja})})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ja});const o=await It(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Yr()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(wt(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ja});const o=await It(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Yr()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(wt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(l=>l.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+jB>s)return r;const{data:a,error:o}=await It(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,r=a.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:v,error:b}=await this.getSession();if(b||!v.session)return this._returnResult({data:null,error:b});r=v.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=cb(r);t?.allowExpired||$B(a.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:v}=await this.getUser(r);if(v)throw v;return{data:{claims:a,header:s,signature:o},error:null}}const h=HB(s.alg),p=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,p,o,DB(`${l}.${c}`)))throw new aN("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(r){if(wt(r))return this._returnResult({data:null,error:r});throw r}}}fm.nextInstanceID={};const SV=fm;class NV extends SV{constructor(e){super(e)}}class CV{constructor(e,t,r){var s,a,o;this.supabaseUrl=e,this.supabaseKey=t;const l=yB(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:dB,realtime:fB,auth:Object.assign(Object.assign({},uB),{storageKey:c}),global:cB},h=xB(r??{},d);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=pB(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new vU(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new aB(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new pU(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:o,flowType:l,lock:c,debug:d,throwOnError:h},p,x){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new NV({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),p),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:l,lock:c,debug:d,throwOnError:h,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new RU(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const TV=(n,e,t)=>new CV(n,e,t);function kV(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}kV()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const fF="https://nuvbqinadhtrontvyuuh.supabase.co",hF="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im51dmJxaW5hZGh0cm9udHZ5dXVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NzAyODIsImV4cCI6MjA4MTA0NjI4Mn0.vH-QCahvp-Btc3118cz8S0K_zH8yncMpnHcZPW7a8hk",PV=fF,MV=hF,Ee=TV(PV,MV,{auth:{persistSession:!0,storage:window.localStorage,autoRefreshToken:!0,detectSessionInUrl:!0},global:{multiTab:!1}}),EV=Object.freeze(Object.defineProperty({__proto__:null,supabase:Ee,supabaseAnonKey:hF,supabaseUrl:fF},Symbol.toStringTag,{value:"Module"})),DV=async n=>{try{let{data:e,error:t}=await Ee.from("users").select("*, role_id").eq("id",n.id).single();if(t&&t.code==="PGRST116"){const r={id:n.id,name:n.user_metadata.name||"New User",email:n.email,role_id:"unverified"},{data:s,error:a}=await Ee.from("users").insert(r).select("*, role_id").single();if(a)return console.error("Error creating user profile on-the-fly:",a.message,a),null;e=s,t=null}return t?(console.error("Error fetching app profile:",t.message,t),null):{id:e.id,name:e.name,email:n.email||"",phone:e.phone,role:e.role_id,organizationId:e.organization_id,organizationName:e.organization_name,reportingManagerId:e.reporting_manager_id,photoUrl:e.photo_url}}catch(e){return console.error("Exception fetching profile:",e),null}},OV=async(n,e)=>await Ee.auth.signInWithPassword({email:n,password:e}),IV=async n=>{const{email:e,password:t,options:r}=n;return await Ee.auth.signUp({email:e,password:t,options:{...r,emailRedirectTo:`${window.location.origin}/`}})},AV=async(n,e)=>await Ee.from("users").update({role_id:e}).eq("id",n),RV=async()=>await Ee.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}}),LV=async()=>{const{error:n}=await Ee.auth.signOut();n&&console.error("Error signing out:",n.message)},FV=async n=>{const e=window.location.origin;return await Ee.auth.resetPasswordForEmail(n,{redirectTo:e})},qV=async n=>await Ee.auth.updateUser({password:n}),Ca={getAppUserProfile:DV,signInWithPassword:OV,signUpWithPassword:IV,signInWithGoogle:RV,signOut:LV,resetPasswordForEmail:FV,updateUserPassword:qV,approveUser:AV},zV="modulepreload",UV=function(n,e){return new URL(n,e).href},tP={},Cf=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let d=function(h){return Promise.all(h.map(p=>Promise.resolve(p).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");s=d(t.map(h=>{if(h=UV(h,r),h in tP)return;tP[h]=!0;const p=h.endsWith(".css"),x=p?'[rel="stylesheet"]':"";if(r)for(let b=o.length-1;b>=0;b--){const _=o[b];if(_.href===h&&(!p||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${x}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":zV,p||(v.as="script"),v.crossOrigin="",v.href=h,c&&v.setAttribute("nonce",c),document.head.appendChild(v),p)return new Promise((b,_)=>{v.addEventListener("load",b),v.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function Ft(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function Vn(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function vl(n,e){const t=Ft(n);return isNaN(e)?Vn(n,NaN):(e&&t.setDate(t.getDate()+e),t)}function ry(n,e){const t=Ft(n);if(isNaN(e))return Vn(n,NaN);if(!e)return t;const r=t.getDate(),s=Vn(n,t.getTime());s.setMonth(t.getMonth()+e+1,0);const a=s.getDate();return r>=a?s:(t.setFullYear(s.getFullYear(),s.getMonth(),r),t)}const mF=6048e5,BV=864e5,pF=6e4,VV=36e5,WV=1e3,Wp=43200,nP=1440;let $V={};function Jc(){return $V}function To(n,e){const t=Jc(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=Ft(n),a=s.getDay(),o=(a<r?7:0)+a-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function Tf(n){return To(n,{weekStartsOn:1})}function gF(n){const e=Ft(n),t=e.getFullYear(),r=Vn(n,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const s=Tf(r),a=Vn(n,0);a.setFullYear(t,0,4),a.setHours(0,0,0,0);const o=Tf(a);return e.getTime()>=s.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function Wc(n){const e=Ft(n);return e.setHours(0,0,0,0),e}function kf(n){const e=Ft(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function Om(n,e){const t=Wc(n),r=Wc(e),s=+t-kf(t),a=+r-kf(r);return Math.round((s-a)/BV)}function HV(n){const e=gF(n),t=Vn(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),Tf(t)}function ax(n,e){const t=Ft(n),r=Ft(e),s=t.getTime()-r.getTime();return s<0?-1:s>0?1:s}function YV(n){return Vn(n,Date.now())}function gf(n,e){const t=Wc(n),r=Wc(e);return+t==+r}function GV(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function ZV(n){if(!GV(n)&&typeof n!="number")return!1;const e=Ft(n);return!isNaN(Number(e))}function KV(n,e){const t=Ft(n),r=Ft(e),s=t.getFullYear()-r.getFullYear(),a=t.getMonth()-r.getMonth();return s*12+a}function JV(n,e){const t=Ft(n),r=Ft(e),s=rP(t,r),a=Math.abs(Om(t,r));t.setDate(t.getDate()-s*a);const o=+(rP(t,r)===-s),l=s*(a-o);return l===0?0:l}function rP(n,e){const t=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function xF(n){return e=>{const r=(n?Math[n]:Math.trunc)(e);return r===0?0:r}}function yF(n,e){return+Ft(n)-+Ft(e)}function xf(n,e,t){const r=yF(n,e)/pF;return xF(t?.roundingMethod)(r)}function xC(n){const e=Ft(n);return e.setHours(23,59,59,999),e}function Ma(n){const e=Ft(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function QV(n){const e=Ft(n);return+xC(e)==+Ma(e)}function XV(n,e){const t=Ft(n),r=Ft(e),s=ax(t,r),a=Math.abs(KV(t,r));let o;if(a<1)o=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-s*a);let l=ax(t,r)===-s;QV(Ft(n))&&a===1&&ax(n,r)===1&&(l=!1),o=s*(a-Number(l))}return o===0?0:o}function eW(n,e,t){const r=yF(n,e)/1e3;return xF(t?.roundingMethod)(r)}function vo(n,e){const t=Ft(n.start),r=Ft(n.end);let s=+t>+r;const a=s?+t:+r,o=s?r:t;o.setHours(0,0,0,0);let l=1;const c=[];for(;+o<=a;)c.push(Ft(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return s?c.reverse():c}function vi(n){const e=Ft(n);return e.setDate(1),e.setHours(0,0,0,0),e}function tW(n){const e=Ft(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function vF(n){const e=Ft(n),t=Vn(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function sP(n,e){const t=Jc(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=Ft(n),a=s.getDay(),o=(a<r?-7:0)+6-(a-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function fb(){return xC(Date.now())}const nW={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},rW=(n,e,t)=>{let r;const s=nW[n];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function hb(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const sW={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},iW={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},aW={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},oW={date:hb({formats:sW,defaultWidth:"full"}),time:hb({formats:iW,defaultWidth:"full"}),dateTime:hb({formats:aW,defaultWidth:"full"})},lW={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},cW=(n,e,t,r)=>lW[n];function wh(n){return(e,t)=>{const r=t?.context?String(t.context):"standalone";let s;if(r==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,l=t?.width?String(t.width):o;s=n.formattingValues[l]||n.formattingValues[o]}else{const o=n.defaultWidth,l=t?.width?String(t.width):n.defaultWidth;s=n.values[l]||n.values[o]}const a=n.argumentCallback?n.argumentCallback(e):e;return s[a]}}const dW={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},uW={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},fW={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},hW={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},mW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},pW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},gW=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},xW={ordinalNumber:gW,era:wh({values:dW,defaultWidth:"wide"}),quarter:wh({values:uW,defaultWidth:"wide",argumentCallback:n=>n-1}),month:wh({values:fW,defaultWidth:"wide"}),day:wh({values:hW,defaultWidth:"wide"}),dayPeriod:wh({values:mW,defaultWidth:"wide",formattingValues:pW,defaultFormattingWidth:"wide"})};function _h(n){return(e,t={})=>{const r=t.width,s=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],a=e.match(s);if(!a)return null;const o=a[0],l=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(l)?vW(l,p=>p.test(o)):yW(l,p=>p.test(o));let d;d=n.valueCallback?n.valueCallback(c):c,d=t.valueCallback?t.valueCallback(d):d;const h=e.slice(o.length);return{value:d,rest:h}}}function yW(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function vW(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function bW(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const s=r[0],a=e.match(n.parsePattern);if(!a)return null;let o=n.valueCallback?n.valueCallback(a[0]):a[0];o=t.valueCallback?t.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const wW=/^(\d+)(th|st|nd|rd)?/i,_W=/\d+/i,jW={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},SW={any:[/^b/i,/^(a|c)/i]},NW={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},CW={any:[/1/i,/2/i,/3/i,/4/i]},TW={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},kW={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},PW={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},MW={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},EW={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},DW={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},OW={ordinalNumber:bW({matchPattern:wW,parsePattern:_W,valueCallback:n=>parseInt(n,10)}),era:_h({matchPatterns:jW,defaultMatchWidth:"wide",parsePatterns:SW,defaultParseWidth:"any"}),quarter:_h({matchPatterns:NW,defaultMatchWidth:"wide",parsePatterns:CW,defaultParseWidth:"any",valueCallback:n=>n+1}),month:_h({matchPatterns:TW,defaultMatchWidth:"wide",parsePatterns:kW,defaultParseWidth:"any"}),day:_h({matchPatterns:PW,defaultMatchWidth:"wide",parsePatterns:MW,defaultParseWidth:"any"}),dayPeriod:_h({matchPatterns:EW,defaultMatchWidth:"any",parsePatterns:DW,defaultParseWidth:"any"})},yC={code:"en-US",formatDistance:rW,formatLong:oW,formatRelative:cW,localize:xW,match:OW,options:{weekStartsOn:0,firstWeekContainsDate:1}};function IW(n){const e=Ft(n);return Om(e,vF(e))+1}function bF(n){const e=Ft(n),t=+Tf(e)-+HV(e);return Math.round(t/mF)+1}function vC(n,e){const t=Ft(n),r=t.getFullYear(),s=Jc(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=Vn(n,0);o.setFullYear(r+1,0,a),o.setHours(0,0,0,0);const l=To(o,e),c=Vn(n,0);c.setFullYear(r,0,a),c.setHours(0,0,0,0);const d=To(c,e);return t.getTime()>=l.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function AW(n,e){const t=Jc(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,s=vC(n,e),a=Vn(n,0);return a.setFullYear(s,0,r),a.setHours(0,0,0,0),To(a,e)}function wF(n,e){const t=Ft(n),r=+To(t,e)-+AW(t,e);return Math.round(r/mF)+1}function Sn(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const Nc={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return Sn(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):Sn(t+1,2)},d(n,e){return Sn(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return Sn(n.getHours()%12||12,e.length)},H(n,e){return Sn(n.getHours(),e.length)},m(n,e){return Sn(n.getMinutes(),e.length)},s(n,e){return Sn(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),s=Math.trunc(r*Math.pow(10,t-3));return Sn(s,e.length)}},Qu={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},iP={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),s=r>0?r:1-r;return t.ordinalNumber(s,{unit:"year"})}return Nc.y(n,e)},Y:function(n,e,t,r){const s=vC(n,r),a=s>0?s:1-s;if(e==="YY"){const o=a%100;return Sn(o,2)}return e==="Yo"?t.ordinalNumber(a,{unit:"year"}):Sn(a,e.length)},R:function(n,e){const t=gF(n);return Sn(t,e.length)},u:function(n,e){const t=n.getFullYear();return Sn(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return Sn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return Sn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return Nc.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return Sn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const s=wF(n,r);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):Sn(s,e.length)},I:function(n,e,t){const r=bF(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):Sn(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Nc.d(n,e)},D:function(n,e,t){const r=IW(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Sn(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const s=n.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return Sn(a,2);case"eo":return t.ordinalNumber(a,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const s=n.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return Sn(a,e.length);case"co":return t.ordinalNumber(a,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return Sn(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const s=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let s;switch(r===12?s=Qu.noon:r===0?s=Qu.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let s;switch(r>=17?s=Qu.evening:r>=12?s=Qu.afternoon:r>=4?s=Qu.morning:s=Qu.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Nc.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Nc.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Sn(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):Sn(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Nc.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Nc.s(n,e)},S:function(n,e){return Nc.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return oP(r);case"XXXX":case"XX":return tu(r);case"XXXXX":case"XXX":default:return tu(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return oP(r);case"xxxx":case"xx":return tu(r);case"xxxxx":case"xxx":default:return tu(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+aP(r,":");case"OOOO":default:return"GMT"+tu(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+aP(r,":");case"zzzz":default:return"GMT"+tu(r,":")}},t:function(n,e,t){const r=Math.trunc(n.getTime()/1e3);return Sn(r,e.length)},T:function(n,e,t){const r=n.getTime();return Sn(r,e.length)}};function aP(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Math.trunc(r/60),a=r%60;return a===0?t+String(s):t+String(s)+e+Sn(a,2)}function oP(n,e){return n%60===0?(n>0?"-":"+")+Sn(Math.abs(n)/60,2):tu(n,e)}function tu(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Sn(Math.trunc(r/60),2),a=Sn(r%60,2);return t+s+e+a}const lP=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},_F=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},RW=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],s=t[2];if(!s)return lP(n,e);let a;switch(r){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",lP(r,e)).replace("{{time}}",_F(s,e))},oN={p:_F,P:RW},LW=/^D+$/,FW=/^Y+$/,qW=["D","DD","YY","YYYY"];function jF(n){return LW.test(n)}function SF(n){return FW.test(n)}function lN(n,e,t){const r=zW(n,e,t);if(console.warn(r),qW.includes(n))throw new RangeError(r)}function zW(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const UW=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,BW=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,VW=/^'([^]*?)'?$/,WW=/''/g,$W=/[a-zA-Z]/;function We(n,e,t){const r=Jc(),s=r.locale??yC,a=r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,l=Ft(n);if(!ZV(l))throw new RangeError("Invalid time value");let c=e.match(BW).map(h=>{const p=h[0];if(p==="p"||p==="P"){const x=oN[p];return x(h,s.formatLong)}return h}).join("").match(UW).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const p=h[0];if(p==="'")return{isToken:!1,value:HW(h)};if(iP[p])return{isToken:!0,value:h};if(p.match($W))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:h}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const d={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(h=>{if(!h.isToken)return h.value;const p=h.value;(SF(p)||jF(p))&&lN(p,e,String(n));const x=iP[p[0]];return x(l,p,s.localize,d)}).join("")}function HW(n){const e=n.match(VW);return e?e[1].replace(WW,"'"):n}function YW(n,e,t){const r=Jc(),s=t?.locale??r.locale??yC,a=2520,o=ax(n,e);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:o});let c,d;o>0?(c=Ft(e),d=Ft(n)):(c=Ft(n),d=Ft(e));const h=eW(d,c),p=(kf(d)-kf(c))/1e3,x=Math.round((h-p)/60);let v;if(x<2)return t?.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,l):h<10?s.formatDistance("lessThanXSeconds",10,l):h<20?s.formatDistance("lessThanXSeconds",20,l):h<40?s.formatDistance("halfAMinute",0,l):h<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):x===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",x,l);if(x<45)return s.formatDistance("xMinutes",x,l);if(x<90)return s.formatDistance("aboutXHours",1,l);if(x<nP){const b=Math.round(x/60);return s.formatDistance("aboutXHours",b,l)}else{if(x<a)return s.formatDistance("xDays",1,l);if(x<Wp){const b=Math.round(x/nP);return s.formatDistance("xDays",b,l)}else if(x<Wp*2)return v=Math.round(x/Wp),s.formatDistance("aboutXMonths",v,l)}if(v=XV(d,c),v<12){const b=Math.round(x/Wp);return s.formatDistance("xMonths",b,l)}else{const b=v%12,_=Math.trunc(v/12);return b<3?s.formatDistance("aboutXYears",_,l):b<9?s.formatDistance("overXYears",_,l):s.formatDistance("almostXYears",_+1,l)}}function mu(n,e){return YW(n,YV(n),e)}function bC(n){return Ft(n).getDay()}function GW(){return Object.assign({},Jc())}function ZW(n){let t=Ft(n).getDay();return t===0&&(t=7),t}function KW(n,e){const t=Ft(n),r=Ft(e);return t.getTime()>r.getTime()}function JW(n,e){const t=e instanceof Date?Vn(e,0):new e(0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),t}const QW=10;let NF=class{subPriority=0;validate(e,t){return!0}};class XW extends NF{constructor(e,t,r,s,a){super(),this.value=e,this.validateValue=t,this.setValue=r,this.priority=s,a&&(this.subPriority=a)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,r){return this.setValue(e,t,this.value,r)}}class e$ extends NF{priority=QW;subPriority=-1;set(e,t){return t.timestampIsSet?e:Vn(e,JW(e,Date))}}let xn=class{run(e,t,r,s){const a=this.parse(e,t,r,s);return a?{setter:new XW(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(e,t,r){return!0}},t$=class extends xn{priority=140;parse(e,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"});case"GGGGG":return r.era(e,{width:"narrow"});case"GGGG":default:return r.era(e,{width:"wide"})||r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"})}}set(e,t,r){return t.era=r,e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]};const lr={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},bo={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function cr(n,e){return n&&{value:e(n.value),rest:n.rest}}function Xn(n,e){const t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function wo(n,e){const t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const r=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,a=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:r*(s*VV+a*pF+o*WV),rest:e.slice(t[0].length)}}function CF(n){return Xn(lr.anyDigitsSigned,n)}function rr(n,e){switch(n){case 1:return Xn(lr.singleDigit,e);case 2:return Xn(lr.twoDigits,e);case 3:return Xn(lr.threeDigits,e);case 4:return Xn(lr.fourDigits,e);default:return Xn(new RegExp("^\\d{1,"+n+"}"),e)}}function Sx(n,e){switch(n){case 1:return Xn(lr.singleDigitSigned,e);case 2:return Xn(lr.twoDigitsSigned,e);case 3:return Xn(lr.threeDigitsSigned,e);case 4:return Xn(lr.fourDigitsSigned,e);default:return Xn(new RegExp("^-?\\d{1,"+n+"}"),e)}}function wC(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function TF(n,e){const t=e>0,r=t?e:1-e;let s;if(r<=50)s=n||100;else{const a=r+50,o=Math.trunc(a/100)*100,l=n>=a%100;s=n+o-(l?100:0)}return t?s:1-s}function kF(n){return n%400===0||n%4===0&&n%100!==0}let n$=class extends xn{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,t,r){const s=a=>({year:a,isTwoDigitYear:t==="yy"});switch(t){case"y":return cr(rr(4,e),s);case"yo":return cr(r.ordinalNumber(e,{unit:"year"}),s);default:return cr(rr(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r){const s=e.getFullYear();if(r.isTwoDigitYear){const o=TF(r.year,s);return e.setFullYear(o,0,1),e.setHours(0,0,0,0),e}const a=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}},r$=class extends xn{priority=130;parse(e,t,r){const s=a=>({year:a,isTwoDigitYear:t==="YY"});switch(t){case"Y":return cr(rr(4,e),s);case"Yo":return cr(r.ordinalNumber(e,{unit:"year"}),s);default:return cr(rr(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r,s){const a=vC(e,s);if(r.isTwoDigitYear){const l=TF(r.year,a);return e.setFullYear(l,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),To(e,s)}const o=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(o,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),To(e,s)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},s$=class extends xn{priority=130;parse(e,t){return Sx(t==="R"?4:t.length,e)}set(e,t,r){const s=Vn(e,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),Tf(s)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},i$=class extends xn{priority=130;parse(e,t){return Sx(t==="u"?4:t.length,e)}set(e,t,r){return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]},a$=class extends xn{priority=120;parse(e,t,r){switch(t){case"Q":case"QQ":return rr(t.length,e);case"Qo":return r.ordinalNumber(e,{unit:"quarter"});case"QQQ":return r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(e,{width:"wide",context:"formatting"})||r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},o$=class extends xn{priority=120;parse(e,t,r){switch(t){case"q":case"qq":return rr(t.length,e);case"qo":return r.ordinalNumber(e,{unit:"quarter"});case"qqq":return r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(e,{width:"wide",context:"standalone"})||r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},l$=class extends xn{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,t,r){const s=a=>a-1;switch(t){case"M":return cr(Xn(lr.month,e),s);case"MM":return cr(rr(2,e),s);case"Mo":return cr(r.ordinalNumber(e,{unit:"month"}),s);case"MMM":return r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(e,{width:"wide",context:"formatting"})||r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}},c$=class extends xn{priority=110;parse(e,t,r){const s=a=>a-1;switch(t){case"L":return cr(Xn(lr.month,e),s);case"LL":return cr(rr(2,e),s);case"Lo":return cr(r.ordinalNumber(e,{unit:"month"}),s);case"LLL":return r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(e,{width:"wide",context:"standalone"})||r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};function d$(n,e,t){const r=Ft(n),s=wF(r,t)-e;return r.setDate(r.getDate()-s*7),r}let u$=class extends xn{priority=100;parse(e,t,r){switch(t){case"w":return Xn(lr.week,e);case"wo":return r.ordinalNumber(e,{unit:"week"});default:return rr(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r,s){return To(d$(e,r,s),s)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};function f$(n,e){const t=Ft(n),r=bF(t)-e;return t.setDate(t.getDate()-r*7),t}let h$=class extends xn{priority=100;parse(e,t,r){switch(t){case"I":return Xn(lr.week,e);case"Io":return r.ordinalNumber(e,{unit:"week"});default:return rr(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r){return Tf(f$(e,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};const m$=[31,28,31,30,31,30,31,31,30,31,30,31],p$=[31,29,31,30,31,30,31,31,30,31,30,31];let g$=class extends xn{priority=90;subPriority=1;parse(e,t,r){switch(t){case"d":return Xn(lr.date,e);case"do":return r.ordinalNumber(e,{unit:"date"});default:return rr(t.length,e)}}validate(e,t){const r=e.getFullYear(),s=kF(r),a=e.getMonth();return s?t>=1&&t<=p$[a]:t>=1&&t<=m$[a]}set(e,t,r){return e.setDate(r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]},x$=class extends xn{priority=90;subpriority=1;parse(e,t,r){switch(t){case"D":case"DD":return Xn(lr.dayOfYear,e);case"Do":return r.ordinalNumber(e,{unit:"date"});default:return rr(t.length,e)}}validate(e,t){const r=e.getFullYear();return kF(r)?t>=1&&t<=366:t>=1&&t<=365}set(e,t,r){return e.setMonth(0,r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};function _C(n,e,t){const r=Jc(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=Ft(n),o=a.getDay(),c=(e%7+7)%7,d=7-s,h=e<0||e>6?e-(o+d)%7:(c+d)%7-(o+d)%7;return vl(a,h)}let y$=class extends xn{priority=90;parse(e,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=_C(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]},v$=class extends xn{priority=90;parse(e,t,r,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(t){case"e":case"ee":return cr(rr(t.length,e),a);case"eo":return cr(r.ordinalNumber(e,{unit:"day"}),a);case"eee":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeeee":return r.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=_C(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},b$=class extends xn{priority=90;parse(e,t,r,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(t){case"c":case"cc":return cr(rr(t.length,e),a);case"co":return cr(r.ordinalNumber(e,{unit:"day"}),a);case"ccc":return r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"ccccc":return r.day(e,{width:"narrow",context:"standalone"});case"cccccc":return r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(e,{width:"wide",context:"standalone"})||r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=_C(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};function w$(n,e){const t=Ft(n),r=ZW(t),s=e-r;return vl(t,s)}let _$=class extends xn{priority=90;parse(e,t,r){const s=a=>a===0?7:a;switch(t){case"i":case"ii":return rr(t.length,e);case"io":return r.ordinalNumber(e,{unit:"day"});case"iii":return cr(r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s);case"iiiii":return cr(r.day(e,{width:"narrow",context:"formatting"}),s);case"iiiiii":return cr(r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s);case"iiii":default:return cr(r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s)}}validate(e,t){return t>=1&&t<=7}set(e,t,r){return e=w$(e,r),e.setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},j$=class extends xn{priority=80;parse(e,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(wC(r),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]},S$=class extends xn{priority=80;parse(e,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(wC(r),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]},N$=class extends xn{priority=80;parse(e,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(wC(r),0,0,0),e}incompatibleTokens=["a","b","t","T"]},C$=class extends xn{priority=70;parse(e,t,r){switch(t){case"h":return Xn(lr.hour12h,e);case"ho":return r.ordinalNumber(e,{unit:"hour"});default:return rr(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,r){const s=e.getHours()>=12;return s&&r<12?e.setHours(r+12,0,0,0):!s&&r===12?e.setHours(0,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]},T$=class extends xn{priority=70;parse(e,t,r){switch(t){case"H":return Xn(lr.hour23h,e);case"Ho":return r.ordinalNumber(e,{unit:"hour"});default:return rr(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,r){return e.setHours(r,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]},k$=class extends xn{priority=70;parse(e,t,r){switch(t){case"K":return Xn(lr.hour11h,e);case"Ko":return r.ordinalNumber(e,{unit:"hour"});default:return rr(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.getHours()>=12&&r<12?e.setHours(r+12,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]},P$=class extends xn{priority=70;parse(e,t,r){switch(t){case"k":return Xn(lr.hour24h,e);case"ko":return r.ordinalNumber(e,{unit:"hour"});default:return rr(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,r){const s=r<=24?r%24:r;return e.setHours(s,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]},M$=class extends xn{priority=60;parse(e,t,r){switch(t){case"m":return Xn(lr.minute,e);case"mo":return r.ordinalNumber(e,{unit:"minute"});default:return rr(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setMinutes(r,0,0),e}incompatibleTokens=["t","T"]},E$=class extends xn{priority=50;parse(e,t,r){switch(t){case"s":return Xn(lr.second,e);case"so":return r.ordinalNumber(e,{unit:"second"});default:return rr(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setSeconds(r,0),e}incompatibleTokens=["t","T"]},D$=class extends xn{priority=30;parse(e,t){const r=s=>Math.trunc(s*Math.pow(10,-t.length+3));return cr(rr(t.length,e),r)}set(e,t,r){return e.setMilliseconds(r),e}incompatibleTokens=["t","T"]},O$=class extends xn{priority=10;parse(e,t){switch(t){case"X":return wo(bo.basicOptionalMinutes,e);case"XX":return wo(bo.basic,e);case"XXXX":return wo(bo.basicOptionalSeconds,e);case"XXXXX":return wo(bo.extendedOptionalSeconds,e);case"XXX":default:return wo(bo.extended,e)}}set(e,t,r){return t.timestampIsSet?e:Vn(e,e.getTime()-kf(e)-r)}incompatibleTokens=["t","T","x"]},I$=class extends xn{priority=10;parse(e,t){switch(t){case"x":return wo(bo.basicOptionalMinutes,e);case"xx":return wo(bo.basic,e);case"xxxx":return wo(bo.basicOptionalSeconds,e);case"xxxxx":return wo(bo.extendedOptionalSeconds,e);case"xxx":default:return wo(bo.extended,e)}}set(e,t,r){return t.timestampIsSet?e:Vn(e,e.getTime()-kf(e)-r)}incompatibleTokens=["t","T","X"]},A$=class extends xn{priority=40;parse(e){return CF(e)}set(e,t,r){return[Vn(e,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"},R$=class extends xn{priority=20;parse(e){return CF(e)}set(e,t,r){return[Vn(e,r),{timestampIsSet:!0}]}incompatibleTokens="*"};const L$={G:new t$,y:new n$,Y:new r$,R:new s$,u:new i$,Q:new a$,q:new o$,M:new l$,L:new c$,w:new u$,I:new h$,d:new g$,D:new x$,E:new y$,e:new v$,c:new b$,i:new _$,a:new j$,b:new S$,B:new N$,h:new C$,H:new T$,K:new k$,k:new P$,m:new M$,s:new E$,S:new D$,X:new O$,x:new I$,t:new A$,T:new R$},F$=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,q$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,z$=/^'([^]*?)'?$/,U$=/''/g,B$=/\S/,V$=/[a-zA-Z]/;function W$(n,e,t,r){const s=GW(),a=s.locale??yC,o=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,l=s.weekStartsOn??s.locale?.options?.weekStartsOn??0;if(e==="")return n===""?Ft(t):Vn(t,NaN);const c={firstWeekContainsDate:o,weekStartsOn:l,locale:a},d=[new e$],h=e.match(q$).map(_=>{const j=_[0];if(j in oN){const C=oN[j];return C(_,a.formatLong)}return _}).join("").match(F$),p=[];for(let _ of h){SF(_)&&lN(_,e,n),jF(_)&&lN(_,e,n);const j=_[0],C=L$[j];if(C){const{incompatibleTokens:P}=C;if(Array.isArray(P)){const M=p.find(D=>P.includes(D.token)||D.token===j);if(M)throw new RangeError(`The format string mustn't contain \`${M.fullToken}\` and \`${_}\` at the same time`)}else if(C.incompatibleTokens==="*"&&p.length>0)throw new RangeError(`The format string mustn't contain \`${_}\` and any other token at the same time`);p.push({token:j,fullToken:_});const O=C.run(n,_,a.match,c);if(!O)return Vn(t,NaN);d.push(O.setter),n=O.rest}else{if(j.match(V$))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");if(_==="''"?_="'":j==="'"&&(_=$$(_)),n.indexOf(_)===0)n=n.slice(_.length);else return Vn(t,NaN)}}if(n.length>0&&B$.test(n))return Vn(t,NaN);const x=d.map(_=>_.priority).sort((_,j)=>j-_).filter((_,j,C)=>C.indexOf(_)===j).map(_=>d.filter(j=>j.priority===_).sort((j,C)=>C.subPriority-j.subPriority)).map(_=>_[0]);let v=Ft(t);if(isNaN(v.getTime()))return Vn(t,NaN);const b={};for(const _ of x){if(!_.validate(v,c))return Vn(t,NaN);const j=_.set(v,b,c);Array.isArray(j)?(v=j[0],Object.assign(b,j[1])):v=j}return Vn(t,v)}function $$(n){return n.match(z$)[1].replace(U$,"'")}function yf(n,e){return vl(n,-e)}function ox(){return Wc(Date.now())}function jC(n,e){return ry(n,-1)}var mn;(function(n){n.assertEqual=s=>{};function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const a={};for(const o of s)a[o]=o;return a},n.getValidEnumValues=s=>{const a=n.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),o={};for(const l of a)o[l]=s[l];return n.objectValues(o)},n.objectValues=s=>n.objectKeys(s).map(function(a){return s[a]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&a.push(o);return a},n.find=(s,a)=>{for(const o of s)if(a(o))return o},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}n.joinValues=r,n.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(mn||(mn={}));var cP;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(cP||(cP={}));const ft=mn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ic=n=>{switch(typeof n){case"undefined":return ft.undefined;case"string":return ft.string;case"number":return Number.isNaN(n)?ft.nan:ft.number;case"boolean":return ft.boolean;case"function":return ft.function;case"bigint":return ft.bigint;case"symbol":return ft.symbol;case"object":return Array.isArray(n)?ft.array:n===null?ft.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?ft.promise:typeof Map<"u"&&n instanceof Map?ft.map:typeof Set<"u"&&n instanceof Set?ft.set:typeof Date<"u"&&n instanceof Date?ft.date:ft.object;default:return ft.unknown}},Qe=mn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Cl extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},r={_errors:[]},s=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let l=r,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(t(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return s(this),r}static assert(e){if(!(e instanceof Cl))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,mn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];t[a]=t[a]||[],t[a].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Cl.create=n=>new Cl(n);const cN=(n,e)=>{let t;switch(n.code){case Qe.invalid_type:n.received===ft.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case Qe.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,mn.jsonStringifyReplacer)}`;break;case Qe.unrecognized_keys:t=`Unrecognized key(s) in object: ${mn.joinValues(n.keys,", ")}`;break;case Qe.invalid_union:t="Invalid input";break;case Qe.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${mn.joinValues(n.options)}`;break;case Qe.invalid_enum_value:t=`Invalid enum value. Expected ${mn.joinValues(n.options)}, received '${n.received}'`;break;case Qe.invalid_arguments:t="Invalid function arguments";break;case Qe.invalid_return_type:t="Invalid function return type";break;case Qe.invalid_date:t="Invalid date";break;case Qe.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:mn.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case Qe.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case Qe.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case Qe.custom:t="Invalid input";break;case Qe.invalid_intersection_types:t="Intersection results could not be merged";break;case Qe.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case Qe.not_finite:t="Number must be finite";break;default:t=e.defaultError,mn.assertNever(n)}return{message:t}};let H$=cN;function Y$(){return H$}const G$=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,a=[...t,...s.path||[]],o={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let l="";const c=r.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:e,defaultError:l}).message;return{...s,path:a,message:l}};function st(n,e){const t=Y$(),r=G$({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===cN?void 0:cN].filter(s=>!!s)});n.common.issues.push(r)}class Ss{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return zt;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t){const a=await s.key,o=await s.value;r.push({key:a,value:o})}return Ss.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:a,value:o}=s;if(a.status==="aborted"||o.status==="aborted")return zt;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[a.value]=o.value)}return{status:e.value,value:r}}}const zt=Object.freeze({status:"aborted"}),Hh=n=>({status:"dirty",value:n}),ta=n=>({status:"valid",value:n}),dP=n=>n.status==="aborted",uP=n=>n.status==="dirty",Pf=n=>n.status==="valid",Nx=n=>typeof Promise<"u"&&n instanceof Promise;var yt;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message})(yt||(yt={}));class ko{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const fP=(n,e)=>{if(Pf(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Cl(n.common.issues);return this._error=t,this._error}}};function Kt(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,l)=>{const{message:c}=n;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??r??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??t??l.defaultError}},description:s}}class an{get description(){return this._def.description}_getType(e){return Ic(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Ic(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ss,ctx:{common:e.parent.common,data:e.data,parsedType:Ic(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Nx(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ic(e)},s=this._parseSync({data:e,path:r.path,parent:r});return fP(r,s)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ic(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:t});return Pf(r)?{value:r.value}:{issues:t.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>Pf(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ic(e)},s=this._parse({data:e,path:r.path,parent:r}),a=await(Nx(s)?s:Promise.resolve(s));return fP(r,a)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,a)=>{const o=e(s),l=()=>a.addIssue({code:Qe.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new Df({schema:this,typeName:qt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Bc.create(this,this._def)}nullable(){return Of.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return No.create(this)}promise(){return Mx.create(this,this._def)}or(e){return Tx.create([this,e],this._def)}and(e){return kx.create(this,e,this._def)}transform(e){return new Df({...Kt(this._def),schema:this,typeName:qt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new hN({...Kt(this._def),innerType:this,defaultValue:t,typeName:qt.ZodDefault})}brand(){return new x8({typeName:qt.ZodBranded,type:this,...Kt(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new mN({...Kt(this._def),innerType:this,catchValue:t,typeName:qt.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return SC.create(this,e)}readonly(){return pN.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Z$=/^c[^\s-]{8,}$/i,K$=/^[0-9a-z]+$/,J$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Q$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,X$=/^[a-z0-9_-]{21}$/i,e8=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,t8=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,n8=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,r8="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let mb;const s8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,i8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,a8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,l8=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,c8=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,PF="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",d8=new RegExp(`^${PF}$`);function MF(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function u8(n){return new RegExp(`^${MF(n)}$`)}function f8(n){let e=`${PF}T${MF(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function h8(n,e){return!!((e==="v4"||!e)&&s8.test(n)||(e==="v6"||!e)&&a8.test(n))}function m8(n,e){if(!e8.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function p8(n,e){return!!((e==="v4"||!e)&&i8.test(n)||(e==="v6"||!e)&&o8.test(n))}class _o extends an{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ft.string){const a=this._getOrReturnCtx(e);return st(a,{code:Qe.invalid_type,expected:ft.string,received:a.parsedType}),zt}const r=new Ss;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),st(s,{code:Qe.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),st(s,{code:Qe.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const o=e.data.length>a.value,l=e.data.length<a.value;(o||l)&&(s=this._getOrReturnCtx(e,s),o?st(s,{code:Qe.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):l&&st(s,{code:Qe.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")n8.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"email",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")mb||(mb=new RegExp(r8,"u")),mb.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"emoji",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")Q$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"uuid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")X$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"nanoid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")Z$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"cuid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")K$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"cuid2",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")J$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"ulid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),st(s,{validation:"url",code:Qe.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"regex",code:Qe.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),st(s,{code:Qe.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),st(s,{code:Qe.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),st(s,{code:Qe.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?f8(a).test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{code:Qe.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?d8.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{code:Qe.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?u8(a).test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{code:Qe.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?t8.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"duration",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?h8(e.data,a.version)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"ip",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?m8(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"jwt",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?p8(e.data,a.version)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"cidr",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?l8.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"base64",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?c8.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"base64url",code:Qe.invalid_string,message:a.message}),r.dirty()):mn.assertNever(a);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(s=>e.test(s),{validation:t,code:Qe.invalid_string,...yt.errToObj(r)})}_addCheck(e){return new _o({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...yt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...yt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...yt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...yt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...yt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...yt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...yt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...yt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...yt.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...yt.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...yt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...yt.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...yt.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...yt.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...yt.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...yt.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...yt.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...yt.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...yt.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...yt.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...yt.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...yt.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...yt.errToObj(t)})}nonempty(e){return this.min(1,yt.errToObj(e))}trim(){return new _o({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new _o({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new _o({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}_o.create=n=>new _o({checks:[],typeName:qt.ZodString,coerce:n?.coerce??!1,...Kt(n)});function g8(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,a=Number.parseInt(n.toFixed(s).replace(".","")),o=Number.parseInt(e.toFixed(s).replace(".",""));return a%o/10**s}class pu extends an{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ft.number){const a=this._getOrReturnCtx(e);return st(a,{code:Qe.invalid_type,expected:ft.number,received:a.parsedType}),zt}let r;const s=new Ss;for(const a of this._def.checks)a.kind==="int"?mn.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),st(r,{code:Qe.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),st(r,{code:Qe.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),st(r,{code:Qe.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?g8(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),st(r,{code:Qe.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),st(r,{code:Qe.not_finite,message:a.message}),s.dirty()):mn.assertNever(a);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,yt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,yt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,yt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,yt.toString(t))}setLimit(e,t,r,s){return new pu({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:yt.toString(s)}]})}_addCheck(e){return new pu({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:yt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:yt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:yt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:yt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:yt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:yt.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:yt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:yt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:yt.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&mn.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}pu.create=n=>new pu({checks:[],typeName:qt.ZodNumber,coerce:n?.coerce||!1,...Kt(n)});class gu extends an{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ft.bigint)return this._getInvalidInput(e);let r;const s=new Ss;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),st(r,{code:Qe.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),st(r,{code:Qe.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),st(r,{code:Qe.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):mn.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return st(t,{code:Qe.invalid_type,expected:ft.bigint,received:t.parsedType}),zt}gte(e,t){return this.setLimit("min",e,!0,yt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,yt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,yt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,yt.toString(t))}setLimit(e,t,r,s){return new gu({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:yt.toString(s)}]})}_addCheck(e){return new gu({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:yt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:yt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:yt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:yt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:yt.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}gu.create=n=>new gu({checks:[],typeName:qt.ZodBigInt,coerce:n?.coerce??!1,...Kt(n)});class Cx extends an{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ft.boolean){const r=this._getOrReturnCtx(e);return st(r,{code:Qe.invalid_type,expected:ft.boolean,received:r.parsedType}),zt}return ta(e.data)}}Cx.create=n=>new Cx({typeName:qt.ZodBoolean,coerce:n?.coerce||!1,...Kt(n)});class Mf extends an{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ft.date){const a=this._getOrReturnCtx(e);return st(a,{code:Qe.invalid_type,expected:ft.date,received:a.parsedType}),zt}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return st(a,{code:Qe.invalid_date}),zt}const r=new Ss;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),st(s,{code:Qe.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),st(s,{code:Qe.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):mn.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Mf({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:yt.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:yt.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Mf.create=n=>new Mf({checks:[],coerce:n?.coerce||!1,typeName:qt.ZodDate,...Kt(n)});class hP extends an{_parse(e){if(this._getType(e)!==ft.symbol){const r=this._getOrReturnCtx(e);return st(r,{code:Qe.invalid_type,expected:ft.symbol,received:r.parsedType}),zt}return ta(e.data)}}hP.create=n=>new hP({typeName:qt.ZodSymbol,...Kt(n)});class mP extends an{_parse(e){if(this._getType(e)!==ft.undefined){const r=this._getOrReturnCtx(e);return st(r,{code:Qe.invalid_type,expected:ft.undefined,received:r.parsedType}),zt}return ta(e.data)}}mP.create=n=>new mP({typeName:qt.ZodUndefined,...Kt(n)});class pP extends an{_parse(e){if(this._getType(e)!==ft.null){const r=this._getOrReturnCtx(e);return st(r,{code:Qe.invalid_type,expected:ft.null,received:r.parsedType}),zt}return ta(e.data)}}pP.create=n=>new pP({typeName:qt.ZodNull,...Kt(n)});class gP extends an{constructor(){super(...arguments),this._any=!0}_parse(e){return ta(e.data)}}gP.create=n=>new gP({typeName:qt.ZodAny,...Kt(n)});class dN extends an{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ta(e.data)}}dN.create=n=>new dN({typeName:qt.ZodUnknown,...Kt(n)});class $c extends an{_parse(e){const t=this._getOrReturnCtx(e);return st(t,{code:Qe.invalid_type,expected:ft.never,received:t.parsedType}),zt}}$c.create=n=>new $c({typeName:qt.ZodNever,...Kt(n)});class xP extends an{_parse(e){if(this._getType(e)!==ft.undefined){const r=this._getOrReturnCtx(e);return st(r,{code:Qe.invalid_type,expected:ft.void,received:r.parsedType}),zt}return ta(e.data)}}xP.create=n=>new xP({typeName:qt.ZodVoid,...Kt(n)});class No extends an{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==ft.array)return st(t,{code:Qe.invalid_type,expected:ft.array,received:t.parsedType}),zt;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,l=t.data.length<s.exactLength.value;(o||l)&&(st(t,{code:o?Qe.too_big:Qe.too_small,minimum:l?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(st(t,{code:Qe.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(st(t,{code:Qe.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,l)=>s.type._parseAsync(new ko(t,o,t.path,l)))).then(o=>Ss.mergeArray(r,o));const a=[...t.data].map((o,l)=>s.type._parseSync(new ko(t,o,t.path,l)));return Ss.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new No({...this._def,minLength:{value:e,message:yt.toString(t)}})}max(e,t){return new No({...this._def,maxLength:{value:e,message:yt.toString(t)}})}length(e,t){return new No({...this._def,exactLength:{value:e,message:yt.toString(t)}})}nonempty(e){return this.min(1,e)}}No.create=(n,e)=>new No({type:n,minLength:null,maxLength:null,exactLength:null,typeName:qt.ZodArray,...Kt(e)});function lf(n){if(n instanceof vr){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=Bc.create(lf(r))}return new vr({...n._def,shape:()=>e})}else return n instanceof No?new No({...n._def,type:lf(n.element)}):n instanceof Bc?Bc.create(lf(n.unwrap())):n instanceof Of?Of.create(lf(n.unwrap())):n instanceof xu?xu.create(n.items.map(e=>lf(e))):n}class vr extends an{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=mn.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==ft.object){const d=this._getOrReturnCtx(e);return st(d,{code:Qe.invalid_type,expected:ft.object,received:d.parsedType}),zt}const{status:r,ctx:s}=this._processInputParams(e),{shape:a,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof $c&&this._def.unknownKeys==="strip"))for(const d in s.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const h=a[d],p=s.data[d];c.push({key:{status:"valid",value:d},value:h._parse(new ko(s,p,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof $c){const d=this._def.unknownKeys;if(d==="passthrough")for(const h of l)c.push({key:{status:"valid",value:h},value:{status:"valid",value:s.data[h]}});else if(d==="strict")l.length>0&&(st(s,{code:Qe.unrecognized_keys,keys:l}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const h of l){const p=s.data[h];c.push({key:{status:"valid",value:h},value:d._parse(new ko(s,p,s.path,h)),alwaysSet:h in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const h of c){const p=await h.key,x=await h.value;d.push({key:p,value:x,alwaysSet:h.alwaysSet})}return d}).then(d=>Ss.mergeObjectSync(r,d)):Ss.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return yt.errToObj,new vr({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{const s=this._def.errorMap?.(t,r).message??r.defaultError;return t.code==="unrecognized_keys"?{message:yt.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new vr({...this._def,unknownKeys:"strip"})}passthrough(){return new vr({...this._def,unknownKeys:"passthrough"})}extend(e){return new vr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new vr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:qt.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new vr({...this._def,catchall:e})}pick(e){const t={};for(const r of mn.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new vr({...this._def,shape:()=>t})}omit(e){const t={};for(const r of mn.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new vr({...this._def,shape:()=>t})}deepPartial(){return lf(this)}partial(e){const t={};for(const r of mn.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}return new vr({...this._def,shape:()=>t})}required(e){const t={};for(const r of mn.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Bc;)a=a._def.innerType;t[r]=a}return new vr({...this._def,shape:()=>t})}keyof(){return EF(mn.objectKeys(this.shape))}}vr.create=(n,e)=>new vr({shape:()=>n,unknownKeys:"strip",catchall:$c.create(),typeName:qt.ZodObject,...Kt(e)});vr.strictCreate=(n,e)=>new vr({shape:()=>n,unknownKeys:"strict",catchall:$c.create(),typeName:qt.ZodObject,...Kt(e)});vr.lazycreate=(n,e)=>new vr({shape:n,unknownKeys:"strip",catchall:$c.create(),typeName:qt.ZodObject,...Kt(e)});class Tx extends an{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(a){for(const l of a)if(l.result.status==="valid")return l.result;for(const l of a)if(l.result.status==="dirty")return t.common.issues.push(...l.ctx.common.issues),l.result;const o=a.map(l=>new Cl(l.ctx.common.issues));return st(t,{code:Qe.invalid_union,unionErrors:o}),zt}if(t.common.async)return Promise.all(r.map(async a=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let a;const o=[];for(const c of r){const d={...t,common:{...t.common,issues:[]},parent:null},h=c._parseSync({data:t.data,path:t.path,parent:d});if(h.status==="valid")return h;h.status==="dirty"&&!a&&(a={result:h,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const l=o.map(c=>new Cl(c));return st(t,{code:Qe.invalid_union,unionErrors:l}),zt}}get options(){return this._def.options}}Tx.create=(n,e)=>new Tx({options:n,typeName:qt.ZodUnion,...Kt(e)});function uN(n,e){const t=Ic(n),r=Ic(e);if(n===e)return{valid:!0,data:n};if(t===ft.object&&r===ft.object){const s=mn.objectKeys(e),a=mn.objectKeys(n).filter(l=>s.indexOf(l)!==-1),o={...n,...e};for(const l of a){const c=uN(n[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(t===ft.array&&r===ft.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<n.length;a++){const o=n[a],l=e[a],c=uN(o,l);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===ft.date&&r===ft.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class kx extends an{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(a,o)=>{if(dP(a)||dP(o))return zt;const l=uN(a.value,o.value);return l.valid?((uP(a)||uP(o))&&t.dirty(),{status:t.value,value:l.data}):(st(r,{code:Qe.invalid_intersection_types}),zt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,o])=>s(a,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}kx.create=(n,e,t)=>new kx({left:n,right:e,typeName:qt.ZodIntersection,...Kt(t)});class xu extends an{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.array)return st(r,{code:Qe.invalid_type,expected:ft.array,received:r.parsedType}),zt;if(r.data.length<this._def.items.length)return st(r,{code:Qe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),zt;!this._def.rest&&r.data.length>this._def.items.length&&(st(r,{code:Qe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...r.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new ko(r,o,r.path,l)):null}).filter(o=>!!o);return r.common.async?Promise.all(a).then(o=>Ss.mergeArray(t,o)):Ss.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new xu({...this._def,rest:e})}}xu.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new xu({items:n,typeName:qt.ZodTuple,rest:null,...Kt(e)})};class Px extends an{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.object)return st(r,{code:Qe.invalid_type,expected:ft.object,received:r.parsedType}),zt;const s=[],a=this._def.keyType,o=this._def.valueType;for(const l in r.data)s.push({key:a._parse(new ko(r,l,r.path,l)),value:o._parse(new ko(r,r.data[l],r.path,l)),alwaysSet:l in r.data});return r.common.async?Ss.mergeObjectAsync(t,s):Ss.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof an?new Px({keyType:e,valueType:t,typeName:qt.ZodRecord,...Kt(r)}):new Px({keyType:_o.create(),valueType:e,typeName:qt.ZodRecord,...Kt(t)})}}class yP extends an{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.map)return st(r,{code:Qe.invalid_type,expected:ft.map,received:r.parsedType}),zt;const s=this._def.keyType,a=this._def.valueType,o=[...r.data.entries()].map(([l,c],d)=>({key:s._parse(new ko(r,l,r.path,[d,"key"])),value:a._parse(new ko(r,c,r.path,[d,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,h=await c.value;if(d.status==="aborted"||h.status==="aborted")return zt;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),l.set(d.value,h.value)}return{status:t.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,h=c.value;if(d.status==="aborted"||h.status==="aborted")return zt;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),l.set(d.value,h.value)}return{status:t.value,value:l}}}}yP.create=(n,e,t)=>new yP({valueType:e,keyType:n,typeName:qt.ZodMap,...Kt(t)});class hm extends an{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.set)return st(r,{code:Qe.invalid_type,expected:ft.set,received:r.parsedType}),zt;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(st(r,{code:Qe.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(st(r,{code:Qe.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const a=this._def.valueType;function o(c){const d=new Set;for(const h of c){if(h.status==="aborted")return zt;h.status==="dirty"&&t.dirty(),d.add(h.value)}return{status:t.value,value:d}}const l=[...r.data.values()].map((c,d)=>a._parse(new ko(r,c,r.path,d)));return r.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,t){return new hm({...this._def,minSize:{value:e,message:yt.toString(t)}})}max(e,t){return new hm({...this._def,maxSize:{value:e,message:yt.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}hm.create=(n,e)=>new hm({valueType:n,minSize:null,maxSize:null,typeName:qt.ZodSet,...Kt(e)});class fN extends an{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}fN.create=(n,e)=>new fN({getter:n,typeName:qt.ZodLazy,...Kt(e)});class vP extends an{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return st(t,{received:t.data,code:Qe.invalid_literal,expected:this._def.value}),zt}return{status:"valid",value:e.data}}get value(){return this._def.value}}vP.create=(n,e)=>new vP({value:n,typeName:qt.ZodLiteral,...Kt(e)});function EF(n,e){return new Ef({values:n,typeName:qt.ZodEnum,...Kt(e)})}class Ef extends an{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return st(t,{expected:mn.joinValues(r),received:t.parsedType,code:Qe.invalid_type}),zt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return st(t,{received:t.data,code:Qe.invalid_enum_value,options:r}),zt}return ta(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ef.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ef.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}Ef.create=EF;class bP extends an{_parse(e){const t=mn.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ft.string&&r.parsedType!==ft.number){const s=mn.objectValues(t);return st(r,{expected:mn.joinValues(s),received:r.parsedType,code:Qe.invalid_type}),zt}if(this._cache||(this._cache=new Set(mn.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=mn.objectValues(t);return st(r,{received:r.data,code:Qe.invalid_enum_value,options:s}),zt}return ta(e.data)}get enum(){return this._def.values}}bP.create=(n,e)=>new bP({values:n,typeName:qt.ZodNativeEnum,...Kt(e)});class Mx extends an{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ft.promise&&t.common.async===!1)return st(t,{code:Qe.invalid_type,expected:ft.promise,received:t.parsedType}),zt;const r=t.parsedType===ft.promise?t.data:Promise.resolve(t.data);return ta(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Mx.create=(n,e)=>new Mx({type:n,typeName:qt.ZodPromise,...Kt(e)});class Df extends an{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===qt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:o=>{st(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const o=s.transform(r.data,a);if(r.common.async)return Promise.resolve(o).then(async l=>{if(t.value==="aborted")return zt;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?zt:c.status==="dirty"||t.value==="dirty"?Hh(c.value):c});{if(t.value==="aborted")return zt;const l=this._def.schema._parseSync({data:o,path:r.path,parent:r});return l.status==="aborted"?zt:l.status==="dirty"||t.value==="dirty"?Hh(l.value):l}}if(s.type==="refinement"){const o=l=>{const c=s.refinement(l,a);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?zt:(l.status==="dirty"&&t.dirty(),o(l.value),{status:t.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?zt:(l.status==="dirty"&&t.dirty(),o(l.value).then(()=>({status:t.value,value:l.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Pf(o))return zt;const l=s.transform(o.value,a);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Pf(o)?Promise.resolve(s.transform(o.value,a)).then(l=>({status:t.value,value:l})):zt);mn.assertNever(s)}}Df.create=(n,e,t)=>new Df({schema:n,typeName:qt.ZodEffects,effect:e,...Kt(t)});Df.createWithPreprocess=(n,e,t)=>new Df({schema:e,effect:{type:"preprocess",transform:n},typeName:qt.ZodEffects,...Kt(t)});class Bc extends an{_parse(e){return this._getType(e)===ft.undefined?ta(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Bc.create=(n,e)=>new Bc({innerType:n,typeName:qt.ZodOptional,...Kt(e)});class Of extends an{_parse(e){return this._getType(e)===ft.null?ta(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Of.create=(n,e)=>new Of({innerType:n,typeName:qt.ZodNullable,...Kt(e)});class hN extends an{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===ft.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}hN.create=(n,e)=>new hN({innerType:n,typeName:qt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Kt(e)});class mN extends an{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Nx(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Cl(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Cl(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}mN.create=(n,e)=>new mN({innerType:n,typeName:qt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Kt(e)});class wP extends an{_parse(e){if(this._getType(e)!==ft.nan){const r=this._getOrReturnCtx(e);return st(r,{code:Qe.invalid_type,expected:ft.nan,received:r.parsedType}),zt}return{status:"valid",value:e.data}}}wP.create=n=>new wP({typeName:qt.ZodNaN,...Kt(n)});class x8 extends an{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class SC extends an{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?zt:a.status==="dirty"?(t.dirty(),Hh(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?zt:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new SC({in:e,out:t,typeName:qt.ZodPipeline})}}class pN extends an{_parse(e){const t=this._def.innerType._parse(e),r=s=>(Pf(s)&&(s.value=Object.freeze(s.value)),s);return Nx(t)?t.then(s=>r(s)):r(t)}unwrap(){return this._def.innerType}}pN.create=(n,e)=>new pN({innerType:n,typeName:qt.ZodReadonly,...Kt(e)});var qt;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(qt||(qt={}));const Hd=_o.create,_P=pu.create;gu.create;const y8=Cx.create;Mf.create;const jP=dN.create;$c.create;const Yh=No.create,v8=vr.create,b8=Tx.create;kx.create;xu.create;const w8=Px.create,_8=fN.create,j8=Ef.create;Mx.create;Bc.create;Of.create;const Xu={string:(n=>_o.create({...n,coerce:!0})),number:(n=>pu.create({...n,coerce:!0})),boolean:(n=>Cx.create({...n,coerce:!0})),bigint:(n=>gu.create({...n,coerce:!0})),date:(n=>Mf.create({...n,coerce:!0}))};let S8,N8;function C8(){return{geminiUrl:S8,vertexUrl:N8}}function T8(n,e,t){var r,s,a;if(!(!((r=n.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=C8();return n.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(a=o.geminiUrl)!==null&&a!==void 0?a:t}return n.httpOptions.baseUrl}class Im{}function Lt(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const a=e[s];return a!=null?String(a):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function N(n,e,t){for(let a=0;a<e.length-1;a++){const o=e[a];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in n))if(Array.isArray(t))n[l]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[l])){const c=n[l];if(Array.isArray(t))for(let d=0;d<c.length;d++){const h=c[d];N(h,e.slice(a+1),t[d])}else for(const d of c)N(d,e.slice(a+1),t)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in n||(n[l]=[{}]);const c=n[l];N(c[0],e.slice(a+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const r=e[e.length-1],s=n[r];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else n[r]=t}function S(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const r=e[t];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in n){const a=n[s];return Array.isArray(a)?a.map(o=>S(o,e.slice(t+1))):void 0}else return}else n=n[r]}return n}catch(t){if(t instanceof TypeError)return;throw t}}var SP;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(SP||(SP={}));var NP;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(NP||(NP={}));var CP;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(CP||(CP={}));var TP;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(TP||(TP={}));var kP;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(kP||(kP={}));var et;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(et||(et={}));var PP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(PP||(PP={}));var MP;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(MP||(MP={}));var EP;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(EP||(EP={}));var DP;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(DP||(DP={}));var OP;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(OP||(OP={}));var IP;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(IP||(IP={}));var AP;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(AP||(AP={}));var mm;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(mm||(mm={}));var RP;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(RP||(RP={}));var gN;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(gN||(gN={}));var LP;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(LP||(LP={}));var FP;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(FP||(FP={}));var qP;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(qP||(qP={}));var zP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(zP||(zP={}));var UP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(UP||(UP={}));var BP;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(BP||(BP={}));var VP;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(VP||(VP={}));var WP;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(WP||(WP={}));var $P;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})($P||($P={}));var HP;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(HP||(HP={}));var YP;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(YP||(YP={}));var GP;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(GP||(GP={}));var ZP;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(ZP||(ZP={}));var KP;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(KP||(KP={}));var JP;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(JP||(JP={}));var QP;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(QP||(QP={}));var XP;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(XP||(XP={}));var eM;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(eM||(eM={}));var tM;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(tM||(tM={}));var nM;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(nM||(nM={}));var rM;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(rM||(rM={}));var sM;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(sM||(sM={}));var iM;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY"})(iM||(iM={}));var df;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(df||(df={}));class jh{get text(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const p=[];for(const x of(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[v,b]of Object.entries(x))v!=="text"&&v!=="thought"&&(b!==null||b!==void 0)&&p.push(v);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;h=!0,d+=x.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const p of(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[x,v]of Object.entries(p))x!=="inlineData"&&(v!==null||v!==void 0)&&h.push(x);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if(d?.length!==0)return d}get executableCode(){var e,t,r,s,a,o,l,c,d;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if(h?.length!==0)return(d=h?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,r,s,a,o,l,c,d;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if(h?.length!==0)return(d=h?.[0])===null||d===void 0?void 0:d.output}}class aM{}class oM{}class k8{}class P8{}class lM{}class cM{}class dM{}class M8{}class uM{}class fM{}class hM{}class E8{}class xN{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class D8{}class O8{}class I8{get text(){var e,t,r;let s="",a=!1;const o=[];for(const l of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(l))c!=="text"&&c!=="thought"&&d!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;a=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?s:void 0}get data(){var e,t,r;let s="";const a=[];for(const o of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&a.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class A8{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function Wn(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function DF(n,e){const t=Wn(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function OF(n,e){return Array.isArray(e)?e.map(t=>Ex(n,t)):[Ex(n,e)]}function Ex(n,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function R8(n,e){const t=Ex(n,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function L8(n,e){const t=Ex(n,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function mM(n,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function IF(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>mM(n,t)):[mM(n,e)]}function yN(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function pM(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function gM(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Gs(n,e){if(e==null)throw new Error("ContentUnion is required");return yN(e)?e:{role:"user",parts:IF(n,e)}}function AF(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=Gs(n,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=Gs(n,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Gs(n,t)):[Gs(n,e)]}function Ea(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(pM(e)||gM(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Gs(n,e)]}const t=[],r=[],s=yN(e[0]);for(const a of e){const o=yN(a);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(a);else{if(pM(a)||gM(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(a)}}return s||t.push({role:"user",parts:IF(n,r)}),t}const xM=j8(["string","number","integer","object","array","boolean","null"]),F8=b8([xM,Yh(xM)]);function q8(n=!0){const e=_8(()=>{const t=v8({type:F8.optional(),format:Hd().optional(),title:Hd().optional(),description:Hd().optional(),default:jP().optional(),items:e.optional(),minItems:Xu.string().optional(),maxItems:Xu.string().optional(),enum:Yh(jP()).optional(),properties:w8(Hd(),e).optional(),required:Yh(Hd()).optional(),minProperties:Xu.string().optional(),maxProperties:Xu.string().optional(),propertyOrdering:Yh(Hd()).optional(),minimum:_P().optional(),maximum:_P().optional(),minLength:Xu.string().optional(),maxLength:Xu.string().optional(),pattern:Hd().optional(),anyOf:Yh(e).optional(),additionalProperties:y8().optional()});return n?t.strict():t});return e}function z8(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.keys(et).includes(t[0].toUpperCase())?et[t[0].toUpperCase()]:et.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.keys(et).includes(r.toUpperCase())?et[r.toUpperCase()]:et.TYPE_UNSPECIFIED})}}function tm(n){const e={},t=["items"],r=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&z8(n.type,e);for(const[o,l]of Object.entries(n))if(l!=null)if(o=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;e.type=Object.keys(et).includes(l.toUpperCase())?l.toUpperCase():et.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=tm(l);else if(r.includes(o)){const c=[];for(const d of l){if(d.type=="null"){e.nullable=!0;continue}c.push(tm(d))}e[o]=c}else if(s.includes(o)){const c={};for(const[d,h]of Object.entries(l))c[d]=tm(h);e[o]=c}else{if(o==="additionalProperties")continue;e[o]=l}return e}function Dx(n,e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=q8().parse(e);return tm(t)}else return tm(e)}function RF(n,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function LF(n,e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function sy(n,e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=Dx(n,t.parameters)),t.response&&(t.response=Dx(n,t.response));return e}function iy(n,e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const r of e)t.push(r);return t}function U8(n,e,t,r=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Qc(n,e){if(typeof e!="string")throw new Error("name must be a string");return U8(n,e,"cachedContents")}function FF(n,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Xc(n,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function B8(n){return n!=null&&typeof n=="object"&&"name"in n}function V8(n){return n!=null&&typeof n=="object"&&"video"in n}function W8(n){return n!=null&&typeof n=="object"&&"uri"in n}function qF(n,e){var t;let r;if(B8(e)&&(r=e.name),!(W8(e)&&(r=e.uri,r===void 0))&&!(V8(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const a=r.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${r}`);r=a[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function zF(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function UF(n,e){for(const t of["models","tunedModels","publisherModels"])if($8(e,t))return e[t];return[]}function $8(n,e){return n!==null&&typeof n=="object"&&e in n}function H8(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function Y8(n,e){const t={};if(S(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function G8(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],H8(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],Y8(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const h=S(e,["functionResponse"]);h!=null&&N(t,["functionResponse"],h);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function yM(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>G8(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function Z8(n,e){const t={},r=S(e,["behavior"]);r!=null&&N(t,["behavior"],r);const s=S(e,["description"]);s!=null&&N(t,["description"],s);const a=S(e,["name"]);a!=null&&N(t,["name"],a);const o=S(e,["parameters"]);o!=null&&N(t,["parameters"],o);const l=S(e,["response"]);return l!=null&&N(t,["response"],l),t}function K8(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function J8(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],K8(n,r)),t}function Q8(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function X8(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],Q8(n,r)),t}function eH(){return{}}function tH(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>Z8(n,d))),N(t,["functionDeclarations"],c)}if(S(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=S(e,["googleSearch"]);s!=null&&N(t,["googleSearch"],J8(n,s));const a=S(e,["googleSearchRetrieval"]);if(a!=null&&N(t,["googleSearchRetrieval"],X8(n,a)),S(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(S(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");S(e,["urlContext"])!=null&&N(t,["urlContext"],eH());const l=S(e,["codeExecution"]);return l!=null&&N(t,["codeExecution"],l),t}function nH(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["allowedFunctionNames"]);return s!=null&&N(t,["allowedFunctionNames"],s),t}function rH(n,e){const t={},r=S(e,["latitude"]);r!=null&&N(t,["latitude"],r);const s=S(e,["longitude"]);return s!=null&&N(t,["longitude"],s),t}function sH(n,e){const t={},r=S(e,["latLng"]);return r!=null&&N(t,["latLng"],rH(n,r)),t}function iH(n,e){const t={},r=S(e,["functionCallingConfig"]);r!=null&&N(t,["functionCallingConfig"],nH(n,r));const s=S(e,["retrievalConfig"]);return s!=null&&N(t,["retrievalConfig"],sH(n,s)),t}function aH(n,e,t){const r={},s=S(e,["ttl"]);t!==void 0&&s!=null&&N(t,["ttl"],s);const a=S(e,["expireTime"]);t!==void 0&&a!=null&&N(t,["expireTime"],a);const o=S(e,["displayName"]);t!==void 0&&o!=null&&N(t,["displayName"],o);const l=S(e,["contents"]);if(t!==void 0&&l!=null){let p=Ea(n,l);Array.isArray(p)&&(p=p.map(x=>yM(n,x))),N(t,["contents"],p)}const c=S(e,["systemInstruction"]);t!==void 0&&c!=null&&N(t,["systemInstruction"],yM(n,Gs(n,c)));const d=S(e,["tools"]);if(t!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(x=>tH(n,x))),N(t,["tools"],p)}const h=S(e,["toolConfig"]);if(t!==void 0&&h!=null&&N(t,["toolConfig"],iH(n,h)),S(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return r}function oH(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["model"],DF(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],aH(n,s,t)),t}function lH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Qc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function cH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Qc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function dH(n,e,t){const r={},s=S(e,["ttl"]);t!==void 0&&s!=null&&N(t,["ttl"],s);const a=S(e,["expireTime"]);return t!==void 0&&a!=null&&N(t,["expireTime"],a),r}function uH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Qc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],dH(n,s,t)),t}function fH(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);return t!==void 0&&a!=null&&N(t,["_query","pageToken"],a),r}function hH(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],fH(n,r,t)),t}function mH(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function pH(n,e){const t={},r=S(e,["displayName"]);r!=null&&N(t,["displayName"],r);const s=S(e,["data"]);s!=null&&N(t,["data"],s);const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function gH(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],mH(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],pH(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const h=S(e,["functionResponse"]);h!=null&&N(t,["functionResponse"],h);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function vM(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>gH(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function xH(n,e){const t={};if(S(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=S(e,["description"]);r!=null&&N(t,["description"],r);const s=S(e,["name"]);s!=null&&N(t,["name"],s);const a=S(e,["parameters"]);a!=null&&N(t,["parameters"],a);const o=S(e,["response"]);return o!=null&&N(t,["response"],o),t}function yH(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function vH(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],yH(n,r)),t}function bH(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function wH(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],bH(n,r)),t}function _H(){return{}}function jH(n,e){const t={},r=S(e,["apiKeyString"]);return r!=null&&N(t,["apiKeyString"],r),t}function SH(n,e){const t={},r=S(e,["apiKeyConfig"]);r!=null&&N(t,["apiKeyConfig"],jH(n,r));const s=S(e,["authType"]);s!=null&&N(t,["authType"],s);const a=S(e,["googleServiceAccountConfig"]);a!=null&&N(t,["googleServiceAccountConfig"],a);const o=S(e,["httpBasicAuthConfig"]);o!=null&&N(t,["httpBasicAuthConfig"],o);const l=S(e,["oauthConfig"]);l!=null&&N(t,["oauthConfig"],l);const c=S(e,["oidcConfig"]);return c!=null&&N(t,["oidcConfig"],c),t}function NH(n,e){const t={},r=S(e,["authConfig"]);return r!=null&&N(t,["authConfig"],SH(n,r)),t}function CH(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>xH(n,p))),N(t,["functionDeclarations"],h)}const s=S(e,["retrieval"]);s!=null&&N(t,["retrieval"],s);const a=S(e,["googleSearch"]);a!=null&&N(t,["googleSearch"],vH(n,a));const o=S(e,["googleSearchRetrieval"]);o!=null&&N(t,["googleSearchRetrieval"],wH(n,o)),S(e,["enterpriseWebSearch"])!=null&&N(t,["enterpriseWebSearch"],_H());const c=S(e,["googleMaps"]);if(c!=null&&N(t,["googleMaps"],NH(n,c)),S(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=S(e,["codeExecution"]);return d!=null&&N(t,["codeExecution"],d),t}function TH(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["allowedFunctionNames"]);return s!=null&&N(t,["allowedFunctionNames"],s),t}function kH(n,e){const t={},r=S(e,["latitude"]);r!=null&&N(t,["latitude"],r);const s=S(e,["longitude"]);return s!=null&&N(t,["longitude"],s),t}function PH(n,e){const t={},r=S(e,["latLng"]);return r!=null&&N(t,["latLng"],kH(n,r)),t}function MH(n,e){const t={},r=S(e,["functionCallingConfig"]);r!=null&&N(t,["functionCallingConfig"],TH(n,r));const s=S(e,["retrievalConfig"]);return s!=null&&N(t,["retrievalConfig"],PH(n,s)),t}function EH(n,e,t){const r={},s=S(e,["ttl"]);t!==void 0&&s!=null&&N(t,["ttl"],s);const a=S(e,["expireTime"]);t!==void 0&&a!=null&&N(t,["expireTime"],a);const o=S(e,["displayName"]);t!==void 0&&o!=null&&N(t,["displayName"],o);const l=S(e,["contents"]);if(t!==void 0&&l!=null){let x=Ea(n,l);Array.isArray(x)&&(x=x.map(v=>vM(n,v))),N(t,["contents"],x)}const c=S(e,["systemInstruction"]);t!==void 0&&c!=null&&N(t,["systemInstruction"],vM(n,Gs(n,c)));const d=S(e,["tools"]);if(t!==void 0&&d!=null){let x=d;Array.isArray(x)&&(x=x.map(v=>CH(n,v))),N(t,["tools"],x)}const h=S(e,["toolConfig"]);t!==void 0&&h!=null&&N(t,["toolConfig"],MH(n,h));const p=S(e,["kmsKeyName"]);return t!==void 0&&p!=null&&N(t,["encryption_spec","kmsKeyName"],p),r}function DH(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["model"],DF(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],EH(n,s,t)),t}function OH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Qc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function IH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Qc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function AH(n,e,t){const r={},s=S(e,["ttl"]);t!==void 0&&s!=null&&N(t,["ttl"],s);const a=S(e,["expireTime"]);return t!==void 0&&a!=null&&N(t,["expireTime"],a),r}function RH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Qc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],AH(n,s,t)),t}function LH(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);return t!==void 0&&a!=null&&N(t,["_query","pageToken"],a),r}function FH(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],LH(n,r,t)),t}function lx(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["model"]);a!=null&&N(t,["model"],a);const o=S(e,["createTime"]);o!=null&&N(t,["createTime"],o);const l=S(e,["updateTime"]);l!=null&&N(t,["updateTime"],l);const c=S(e,["expireTime"]);c!=null&&N(t,["expireTime"],c);const d=S(e,["usageMetadata"]);return d!=null&&N(t,["usageMetadata"],d),t}function qH(){return{}}function zH(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>lx(n,o))),N(t,["cachedContents"],a)}return t}function cx(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["model"]);a!=null&&N(t,["model"],a);const o=S(e,["createTime"]);o!=null&&N(t,["createTime"],o);const l=S(e,["updateTime"]);l!=null&&N(t,["updateTime"],l);const c=S(e,["expireTime"]);c!=null&&N(t,["expireTime"],c);const d=S(e,["usageMetadata"]);return d!=null&&N(t,["usageMetadata"],d),t}function UH(){return{}}function BH(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>cx(n,o))),N(t,["cachedContents"],a)}return t}var If;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(If||(If={}));class ay{constructor(e,t,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,s)}init(e,t,r){var s,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(a=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class VH extends Im{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ay(If.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=DH(this.apiClient,e);return l=Lt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>cx(this.apiClient,h))}else{const d=oH(this.apiClient,e);return l=Lt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>lx(this.apiClient,h))}}async get(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=OH(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>cx(this.apiClient,h))}else{const d=lH(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>lx(this.apiClient,h))}}async delete(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=IH(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=UH(),p=new fM;return Object.assign(p,h),p})}else{const d=cH(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(()=>{const h=qH(),p=new fM;return Object.assign(p,h),p})}}async update(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=RH(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>cx(this.apiClient,h))}else{const d=uH(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>lx(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=FH(this.apiClient,e);return l=Lt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=BH(this.apiClient,h),x=new hM;return Object.assign(x,p),x})}else{const d=hH(this.apiClient,e);return l=Lt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=zH(this.apiClient,h),x=new hM;return Object.assign(x,p),x})}}}function bM(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jn(n){return this instanceof Jn?(this.v=n,this):new Jn(n)}function nm(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(v){return function(b){return Promise.resolve(b).then(v,p)}}function l(v,b){r[v]&&(s[v]=function(_){return new Promise(function(j,C){a.push([v,_,j,C])>1||c(v,_)})},b&&(s[v]=b(s[v])))}function c(v,b){try{d(r[v](b))}catch(_){x(a[0][3],_)}}function d(v){v.value instanceof Jn?Promise.resolve(v.value.v).then(h,p):x(a[0][2],v)}function h(v){c("next",v)}function p(v){c("throw",v)}function x(v,b){v(b),a.shift(),a.length&&c(a[0][0],a[0][1])}}function dx(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof bM=="function"?bM(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(l,c){o=n[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},o)}}function WH(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:BF(t)}function BF(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function $H(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function wM(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const s=[];let a=!0;for(;r<t&&n[r].role==="model";)s.push(n[r]),a&&!BF(n[r])&&(a=!1),r++;a?e.push(...s):e.pop()}return e}class HH{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new YH(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class YH{constructor(e,t,r,s={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=s,this.history=a,this.sendPromise=Promise.resolve(),$H(a)}async sendMessage(e){var t;await this.sendPromise;const r=Gs(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,o,l;const c=await s,d=(o=(a=c.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content,h=c.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let x=[];h!=null&&(x=(l=h.slice(p))!==null&&l!==void 0?l:[]);const v=d?[d]:[];this.recordHistory(r,v,x)})(),await this.sendPromise,s}async sendMessageStream(e){var t;await this.sendPromise;const r=Gs(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const a=await s;return this.processStreamResponse(a,r)}getHistory(e=!1){const t=e?wM(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var r,s;return nm(this,arguments,function*(){var o,l,c,d;const h=[];try{for(var p=!0,x=dx(e),v;v=yield Jn(x.next()),o=v.done,!o;p=!0){d=v.value,p=!1;const b=d;if(WH(b)){const _=(s=(r=b.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;_!==void 0&&h.push(_)}yield yield Jn(b)}}catch(b){l={error:b}}finally{try{!p&&!o&&(c=x.return)&&(yield Jn(c.call(x)))}finally{if(l)throw l.error}}this.recordHistory(t,h)})}recordHistory(e,t,r){let s=[];t.length>0&&t.every(a=>a.role!==void 0)?s=t:s.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...wM(r)):this.history.push(e),this.history.push(...s)}}function GH(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);return t!==void 0&&a!=null&&N(t,["_query","pageToken"],a),r}function ZH(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],GH(n,r,t)),t}function KH(n,e){const t={},r=S(e,["details"]);r!=null&&N(t,["details"],r);const s=S(e,["message"]);s!=null&&N(t,["message"],s);const a=S(e,["code"]);return a!=null&&N(t,["code"],a),t}function JH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["mimeType"]);a!=null&&N(t,["mimeType"],a);const o=S(e,["sizeBytes"]);o!=null&&N(t,["sizeBytes"],o);const l=S(e,["createTime"]);l!=null&&N(t,["createTime"],l);const c=S(e,["expirationTime"]);c!=null&&N(t,["expirationTime"],c);const d=S(e,["updateTime"]);d!=null&&N(t,["updateTime"],d);const h=S(e,["sha256Hash"]);h!=null&&N(t,["sha256Hash"],h);const p=S(e,["uri"]);p!=null&&N(t,["uri"],p);const x=S(e,["downloadUri"]);x!=null&&N(t,["downloadUri"],x);const v=S(e,["state"]);v!=null&&N(t,["state"],v);const b=S(e,["source"]);b!=null&&N(t,["source"],b);const _=S(e,["videoMetadata"]);_!=null&&N(t,["videoMetadata"],_);const j=S(e,["error"]);return j!=null&&N(t,["error"],KH(n,j)),t}function QH(n,e){const t={},r=S(e,["file"]);r!=null&&N(t,["file"],JH(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function XH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","file"],qF(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function e7(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","file"],qF(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function t7(n,e){const t={},r=S(e,["details"]);r!=null&&N(t,["details"],r);const s=S(e,["message"]);s!=null&&N(t,["message"],s);const a=S(e,["code"]);return a!=null&&N(t,["code"],a),t}function vN(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["mimeType"]);a!=null&&N(t,["mimeType"],a);const o=S(e,["sizeBytes"]);o!=null&&N(t,["sizeBytes"],o);const l=S(e,["createTime"]);l!=null&&N(t,["createTime"],l);const c=S(e,["expirationTime"]);c!=null&&N(t,["expirationTime"],c);const d=S(e,["updateTime"]);d!=null&&N(t,["updateTime"],d);const h=S(e,["sha256Hash"]);h!=null&&N(t,["sha256Hash"],h);const p=S(e,["uri"]);p!=null&&N(t,["uri"],p);const x=S(e,["downloadUri"]);x!=null&&N(t,["downloadUri"],x);const v=S(e,["state"]);v!=null&&N(t,["state"],v);const b=S(e,["source"]);b!=null&&N(t,["source"],b);const _=S(e,["videoMetadata"]);_!=null&&N(t,["videoMetadata"],_);const j=S(e,["error"]);return j!=null&&N(t,["error"],t7(n,j)),t}function n7(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["files"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>vN(n,o))),N(t,["files"],a)}return t}function r7(){return{}}function s7(){return{}}let i7=class extends Im{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ay(If.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>vN(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=ZH(this.apiClient,e);return a=Lt("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=n7(this.apiClient,c),h=new E8;return Object.assign(h,d),h})}}async createInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=QH(this.apiClient,e);return a=Lt("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=r7(),d=new D8;return Object.assign(d,c),d})}}async get(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=XH(this.apiClient,e);return a=Lt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>vN(this.apiClient,c))}}async delete(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=e7(this.apiClient,e);return a=Lt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=s7(),d=new O8;return Object.assign(d,c),d})}}};function a7(n,e){const t={},r=S(e,["voiceName"]);return r!=null&&N(t,["voiceName"],r),t}function o7(n,e){const t={},r=S(e,["voiceName"]);return r!=null&&N(t,["voiceName"],r),t}function VF(n,e){const t={},r=S(e,["prebuiltVoiceConfig"]);return r!=null&&N(t,["prebuiltVoiceConfig"],a7(n,r)),t}function l7(n,e){const t={},r=S(e,["prebuiltVoiceConfig"]);return r!=null&&N(t,["prebuiltVoiceConfig"],o7(n,r)),t}function c7(n,e){const t={},r=S(e,["speaker"]);r!=null&&N(t,["speaker"],r);const s=S(e,["voiceConfig"]);return s!=null&&N(t,["voiceConfig"],VF(n,s)),t}function d7(n,e){const t={},r=S(e,["speakerVoiceConfigs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>c7(n,a))),N(t,["speakerVoiceConfigs"],s)}return t}function u7(n,e){const t={},r=S(e,["voiceConfig"]);r!=null&&N(t,["voiceConfig"],VF(n,r));const s=S(e,["multiSpeakerVoiceConfig"]);s!=null&&N(t,["multiSpeakerVoiceConfig"],d7(n,s));const a=S(e,["languageCode"]);return a!=null&&N(t,["languageCode"],a),t}function f7(n,e){const t={},r=S(e,["voiceConfig"]);if(r!=null&&N(t,["voiceConfig"],l7(n,r)),S(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=S(e,["languageCode"]);return s!=null&&N(t,["languageCode"],s),t}function h7(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function m7(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function p7(n,e){const t={};if(S(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function g7(n,e){const t={},r=S(e,["displayName"]);r!=null&&N(t,["displayName"],r);const s=S(e,["data"]);s!=null&&N(t,["data"],s);const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function x7(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],h7(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],p7(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const h=S(e,["functionResponse"]);h!=null&&N(t,["functionResponse"],h);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function y7(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],m7(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],g7(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const h=S(e,["functionResponse"]);h!=null&&N(t,["functionResponse"],h);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function v7(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>x7(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function b7(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>y7(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function w7(n,e){const t={},r=S(e,["behavior"]);r!=null&&N(t,["behavior"],r);const s=S(e,["description"]);s!=null&&N(t,["description"],s);const a=S(e,["name"]);a!=null&&N(t,["name"],a);const o=S(e,["parameters"]);o!=null&&N(t,["parameters"],o);const l=S(e,["response"]);return l!=null&&N(t,["response"],l),t}function _7(n,e){const t={};if(S(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=S(e,["description"]);r!=null&&N(t,["description"],r);const s=S(e,["name"]);s!=null&&N(t,["name"],s);const a=S(e,["parameters"]);a!=null&&N(t,["parameters"],a);const o=S(e,["response"]);return o!=null&&N(t,["response"],o),t}function j7(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function S7(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function N7(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],j7(n,r)),t}function C7(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],S7(n,r)),t}function T7(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function k7(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function P7(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],T7(n,r)),t}function M7(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],k7(n,r)),t}function E7(){return{}}function D7(n,e){const t={},r=S(e,["apiKeyString"]);return r!=null&&N(t,["apiKeyString"],r),t}function O7(n,e){const t={},r=S(e,["apiKeyConfig"]);r!=null&&N(t,["apiKeyConfig"],D7(n,r));const s=S(e,["authType"]);s!=null&&N(t,["authType"],s);const a=S(e,["googleServiceAccountConfig"]);a!=null&&N(t,["googleServiceAccountConfig"],a);const o=S(e,["httpBasicAuthConfig"]);o!=null&&N(t,["httpBasicAuthConfig"],o);const l=S(e,["oauthConfig"]);l!=null&&N(t,["oauthConfig"],l);const c=S(e,["oidcConfig"]);return c!=null&&N(t,["oidcConfig"],c),t}function I7(n,e){const t={},r=S(e,["authConfig"]);return r!=null&&N(t,["authConfig"],O7(n,r)),t}function A7(){return{}}function R7(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>w7(n,d))),N(t,["functionDeclarations"],c)}if(S(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=S(e,["googleSearch"]);s!=null&&N(t,["googleSearch"],N7(n,s));const a=S(e,["googleSearchRetrieval"]);if(a!=null&&N(t,["googleSearchRetrieval"],P7(n,a)),S(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(S(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");S(e,["urlContext"])!=null&&N(t,["urlContext"],A7());const l=S(e,["codeExecution"]);return l!=null&&N(t,["codeExecution"],l),t}function L7(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>_7(n,p))),N(t,["functionDeclarations"],h)}const s=S(e,["retrieval"]);s!=null&&N(t,["retrieval"],s);const a=S(e,["googleSearch"]);a!=null&&N(t,["googleSearch"],C7(n,a));const o=S(e,["googleSearchRetrieval"]);o!=null&&N(t,["googleSearchRetrieval"],M7(n,o)),S(e,["enterpriseWebSearch"])!=null&&N(t,["enterpriseWebSearch"],E7());const c=S(e,["googleMaps"]);if(c!=null&&N(t,["googleMaps"],I7(n,c)),S(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=S(e,["codeExecution"]);return d!=null&&N(t,["codeExecution"],d),t}function F7(n,e){const t={},r=S(e,["handle"]);if(r!=null&&N(t,["handle"],r),S(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function q7(n,e){const t={},r=S(e,["handle"]);r!=null&&N(t,["handle"],r);const s=S(e,["transparent"]);return s!=null&&N(t,["transparent"],s),t}function _M(){return{}}function jM(){return{}}function z7(n,e){const t={},r=S(e,["disabled"]);r!=null&&N(t,["disabled"],r);const s=S(e,["startOfSpeechSensitivity"]);s!=null&&N(t,["startOfSpeechSensitivity"],s);const a=S(e,["endOfSpeechSensitivity"]);a!=null&&N(t,["endOfSpeechSensitivity"],a);const o=S(e,["prefixPaddingMs"]);o!=null&&N(t,["prefixPaddingMs"],o);const l=S(e,["silenceDurationMs"]);return l!=null&&N(t,["silenceDurationMs"],l),t}function U7(n,e){const t={},r=S(e,["disabled"]);r!=null&&N(t,["disabled"],r);const s=S(e,["startOfSpeechSensitivity"]);s!=null&&N(t,["startOfSpeechSensitivity"],s);const a=S(e,["endOfSpeechSensitivity"]);a!=null&&N(t,["endOfSpeechSensitivity"],a);const o=S(e,["prefixPaddingMs"]);o!=null&&N(t,["prefixPaddingMs"],o);const l=S(e,["silenceDurationMs"]);return l!=null&&N(t,["silenceDurationMs"],l),t}function B7(n,e){const t={},r=S(e,["automaticActivityDetection"]);r!=null&&N(t,["automaticActivityDetection"],z7(n,r));const s=S(e,["activityHandling"]);s!=null&&N(t,["activityHandling"],s);const a=S(e,["turnCoverage"]);return a!=null&&N(t,["turnCoverage"],a),t}function V7(n,e){const t={},r=S(e,["automaticActivityDetection"]);r!=null&&N(t,["automaticActivityDetection"],U7(n,r));const s=S(e,["activityHandling"]);s!=null&&N(t,["activityHandling"],s);const a=S(e,["turnCoverage"]);return a!=null&&N(t,["turnCoverage"],a),t}function W7(n,e){const t={},r=S(e,["targetTokens"]);return r!=null&&N(t,["targetTokens"],r),t}function $7(n,e){const t={},r=S(e,["targetTokens"]);return r!=null&&N(t,["targetTokens"],r),t}function H7(n,e){const t={},r=S(e,["triggerTokens"]);r!=null&&N(t,["triggerTokens"],r);const s=S(e,["slidingWindow"]);return s!=null&&N(t,["slidingWindow"],W7(n,s)),t}function Y7(n,e){const t={},r=S(e,["triggerTokens"]);r!=null&&N(t,["triggerTokens"],r);const s=S(e,["slidingWindow"]);return s!=null&&N(t,["slidingWindow"],$7(n,s)),t}function G7(n,e){const t={},r=S(e,["proactiveAudio"]);return r!=null&&N(t,["proactiveAudio"],r),t}function Z7(n,e){const t={},r=S(e,["proactiveAudio"]);return r!=null&&N(t,["proactiveAudio"],r),t}function K7(n,e,t){const r={},s=S(e,["generationConfig"]);t!==void 0&&s!=null&&N(t,["setup","generationConfig"],s);const a=S(e,["responseModalities"]);t!==void 0&&a!=null&&N(t,["setup","generationConfig","responseModalities"],a);const o=S(e,["temperature"]);t!==void 0&&o!=null&&N(t,["setup","generationConfig","temperature"],o);const l=S(e,["topP"]);t!==void 0&&l!=null&&N(t,["setup","generationConfig","topP"],l);const c=S(e,["topK"]);t!==void 0&&c!=null&&N(t,["setup","generationConfig","topK"],c);const d=S(e,["maxOutputTokens"]);t!==void 0&&d!=null&&N(t,["setup","generationConfig","maxOutputTokens"],d);const h=S(e,["mediaResolution"]);t!==void 0&&h!=null&&N(t,["setup","generationConfig","mediaResolution"],h);const p=S(e,["seed"]);t!==void 0&&p!=null&&N(t,["setup","generationConfig","seed"],p);const x=S(e,["speechConfig"]);t!==void 0&&x!=null&&N(t,["setup","generationConfig","speechConfig"],u7(n,LF(n,x)));const v=S(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&N(t,["setup","generationConfig","enableAffectiveDialog"],v);const b=S(e,["systemInstruction"]);t!==void 0&&b!=null&&N(t,["setup","systemInstruction"],v7(n,Gs(n,b)));const _=S(e,["tools"]);if(t!==void 0&&_!=null){let I=iy(n,_);Array.isArray(I)&&(I=I.map(F=>R7(n,sy(n,F)))),N(t,["setup","tools"],I)}const j=S(e,["sessionResumption"]);t!==void 0&&j!=null&&N(t,["setup","sessionResumption"],F7(n,j));const C=S(e,["inputAudioTranscription"]);t!==void 0&&C!=null&&N(t,["setup","inputAudioTranscription"],_M());const P=S(e,["outputAudioTranscription"]);t!==void 0&&P!=null&&N(t,["setup","outputAudioTranscription"],_M());const O=S(e,["realtimeInputConfig"]);t!==void 0&&O!=null&&N(t,["setup","realtimeInputConfig"],B7(n,O));const M=S(e,["contextWindowCompression"]);t!==void 0&&M!=null&&N(t,["setup","contextWindowCompression"],H7(n,M));const D=S(e,["proactivity"]);return t!==void 0&&D!=null&&N(t,["setup","proactivity"],G7(n,D)),r}function J7(n,e,t){const r={},s=S(e,["generationConfig"]);t!==void 0&&s!=null&&N(t,["setup","generationConfig"],s);const a=S(e,["responseModalities"]);t!==void 0&&a!=null&&N(t,["setup","generationConfig","responseModalities"],a);const o=S(e,["temperature"]);t!==void 0&&o!=null&&N(t,["setup","generationConfig","temperature"],o);const l=S(e,["topP"]);t!==void 0&&l!=null&&N(t,["setup","generationConfig","topP"],l);const c=S(e,["topK"]);t!==void 0&&c!=null&&N(t,["setup","generationConfig","topK"],c);const d=S(e,["maxOutputTokens"]);t!==void 0&&d!=null&&N(t,["setup","generationConfig","maxOutputTokens"],d);const h=S(e,["mediaResolution"]);t!==void 0&&h!=null&&N(t,["setup","generationConfig","mediaResolution"],h);const p=S(e,["seed"]);t!==void 0&&p!=null&&N(t,["setup","generationConfig","seed"],p);const x=S(e,["speechConfig"]);t!==void 0&&x!=null&&N(t,["setup","generationConfig","speechConfig"],f7(n,LF(n,x)));const v=S(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&N(t,["setup","generationConfig","enableAffectiveDialog"],v);const b=S(e,["systemInstruction"]);t!==void 0&&b!=null&&N(t,["setup","systemInstruction"],b7(n,Gs(n,b)));const _=S(e,["tools"]);if(t!==void 0&&_!=null){let I=iy(n,_);Array.isArray(I)&&(I=I.map(F=>L7(n,sy(n,F)))),N(t,["setup","tools"],I)}const j=S(e,["sessionResumption"]);t!==void 0&&j!=null&&N(t,["setup","sessionResumption"],q7(n,j));const C=S(e,["inputAudioTranscription"]);t!==void 0&&C!=null&&N(t,["setup","inputAudioTranscription"],jM());const P=S(e,["outputAudioTranscription"]);t!==void 0&&P!=null&&N(t,["setup","outputAudioTranscription"],jM());const O=S(e,["realtimeInputConfig"]);t!==void 0&&O!=null&&N(t,["setup","realtimeInputConfig"],V7(n,O));const M=S(e,["contextWindowCompression"]);t!==void 0&&M!=null&&N(t,["setup","contextWindowCompression"],Y7(n,M));const D=S(e,["proactivity"]);return t!==void 0&&D!=null&&N(t,["setup","proactivity"],Z7(n,D)),r}function Q7(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["setup","model"],Wn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],K7(n,s,t)),t}function X7(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["setup","model"],Wn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],J7(n,s,t)),t}function e9(){return{}}function t9(){return{}}function n9(){return{}}function r9(){return{}}function s9(n,e){const t={},r=S(e,["media"]);r!=null&&N(t,["mediaChunks"],OF(n,r));const s=S(e,["audio"]);s!=null&&N(t,["audio"],L8(n,s));const a=S(e,["audioStreamEnd"]);a!=null&&N(t,["audioStreamEnd"],a);const o=S(e,["video"]);o!=null&&N(t,["video"],R8(n,o));const l=S(e,["text"]);return l!=null&&N(t,["text"],l),S(e,["activityStart"])!=null&&N(t,["activityStart"],e9()),S(e,["activityEnd"])!=null&&N(t,["activityEnd"],n9()),t}function i9(n,e){const t={},r=S(e,["media"]);if(r!=null&&N(t,["mediaChunks"],OF(n,r)),S(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=S(e,["audioStreamEnd"]);if(s!=null&&N(t,["audioStreamEnd"],s),S(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(S(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return S(e,["activityStart"])!=null&&N(t,["activityStart"],t9()),S(e,["activityEnd"])!=null&&N(t,["activityEnd"],r9()),t}function WF(n,e){const t={},r=S(e,["text"]);r!=null&&N(t,["text"],r);const s=S(e,["weight"]);return s!=null&&N(t,["weight"],s),t}function a9(n,e){const t={},r=S(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>WF(n,a))),N(t,["weightedPrompts"],s)}return t}function $F(n,e){const t={},r=S(e,["temperature"]);r!=null&&N(t,["temperature"],r);const s=S(e,["topK"]);s!=null&&N(t,["topK"],s);const a=S(e,["seed"]);a!=null&&N(t,["seed"],a);const o=S(e,["guidance"]);o!=null&&N(t,["guidance"],o);const l=S(e,["bpm"]);l!=null&&N(t,["bpm"],l);const c=S(e,["density"]);c!=null&&N(t,["density"],c);const d=S(e,["brightness"]);d!=null&&N(t,["brightness"],d);const h=S(e,["scale"]);h!=null&&N(t,["scale"],h);const p=S(e,["muteBass"]);p!=null&&N(t,["muteBass"],p);const x=S(e,["muteDrums"]);x!=null&&N(t,["muteDrums"],x);const v=S(e,["onlyBassAndDrums"]);v!=null&&N(t,["onlyBassAndDrums"],v);const b=S(e,["musicGenerationMode"]);return b!=null&&N(t,["musicGenerationMode"],b),t}function o9(n,e){const t={},r=S(e,["musicGenerationConfig"]);return r!=null&&N(t,["musicGenerationConfig"],$F(n,r)),t}function HF(n,e){const t={},r=S(e,["model"]);return r!=null&&N(t,["model"],r),t}function YF(n,e){const t={},r=S(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>WF(n,a))),N(t,["weightedPrompts"],s)}return t}function bN(n,e){const t={},r=S(e,["setup"]);r!=null&&N(t,["setup"],HF(n,r));const s=S(e,["clientContent"]);s!=null&&N(t,["clientContent"],YF(n,s));const a=S(e,["musicGenerationConfig"]);a!=null&&N(t,["musicGenerationConfig"],$F(n,a));const o=S(e,["playbackControl"]);return o!=null&&N(t,["playbackControl"],o),t}function l9(){return{}}function c9(){return{}}function d9(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function u9(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function f9(n,e){const t={},r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function h9(n,e){const t={},r=S(e,["displayName"]);r!=null&&N(t,["displayName"],r);const s=S(e,["data"]);s!=null&&N(t,["data"],s);const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function m9(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],d9(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],f9(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const h=S(e,["functionResponse"]);h!=null&&N(t,["functionResponse"],h);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function p9(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],u9(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],h9(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const h=S(e,["functionResponse"]);h!=null&&N(t,["functionResponse"],h);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function g9(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>m9(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function x9(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>p9(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function SM(n,e){const t={},r=S(e,["text"]);r!=null&&N(t,["text"],r);const s=S(e,["finished"]);return s!=null&&N(t,["finished"],s),t}function NM(n,e){const t={},r=S(e,["text"]);r!=null&&N(t,["text"],r);const s=S(e,["finished"]);return s!=null&&N(t,["finished"],s),t}function y9(n,e){const t={},r=S(e,["retrievedUrl"]);r!=null&&N(t,["retrievedUrl"],r);const s=S(e,["urlRetrievalStatus"]);return s!=null&&N(t,["urlRetrievalStatus"],s),t}function v9(n,e){const t={},r=S(e,["urlMetadata"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>y9(n,a))),N(t,["urlMetadata"],s)}return t}function b9(n,e){const t={},r=S(e,["modelTurn"]);r!=null&&N(t,["modelTurn"],g9(n,r));const s=S(e,["turnComplete"]);s!=null&&N(t,["turnComplete"],s);const a=S(e,["interrupted"]);a!=null&&N(t,["interrupted"],a);const o=S(e,["groundingMetadata"]);o!=null&&N(t,["groundingMetadata"],o);const l=S(e,["generationComplete"]);l!=null&&N(t,["generationComplete"],l);const c=S(e,["inputTranscription"]);c!=null&&N(t,["inputTranscription"],SM(n,c));const d=S(e,["outputTranscription"]);d!=null&&N(t,["outputTranscription"],SM(n,d));const h=S(e,["urlContextMetadata"]);return h!=null&&N(t,["urlContextMetadata"],v9(n,h)),t}function w9(n,e){const t={},r=S(e,["modelTurn"]);r!=null&&N(t,["modelTurn"],x9(n,r));const s=S(e,["turnComplete"]);s!=null&&N(t,["turnComplete"],s);const a=S(e,["interrupted"]);a!=null&&N(t,["interrupted"],a);const o=S(e,["groundingMetadata"]);o!=null&&N(t,["groundingMetadata"],o);const l=S(e,["generationComplete"]);l!=null&&N(t,["generationComplete"],l);const c=S(e,["inputTranscription"]);c!=null&&N(t,["inputTranscription"],NM(n,c));const d=S(e,["outputTranscription"]);return d!=null&&N(t,["outputTranscription"],NM(n,d)),t}function _9(n,e){const t={},r=S(e,["id"]);r!=null&&N(t,["id"],r);const s=S(e,["args"]);s!=null&&N(t,["args"],s);const a=S(e,["name"]);return a!=null&&N(t,["name"],a),t}function j9(n,e){const t={},r=S(e,["args"]);r!=null&&N(t,["args"],r);const s=S(e,["name"]);return s!=null&&N(t,["name"],s),t}function S9(n,e){const t={},r=S(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>_9(n,a))),N(t,["functionCalls"],s)}return t}function N9(n,e){const t={},r=S(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>j9(n,a))),N(t,["functionCalls"],s)}return t}function C9(n,e){const t={},r=S(e,["ids"]);return r!=null&&N(t,["ids"],r),t}function T9(n,e){const t={},r=S(e,["ids"]);return r!=null&&N(t,["ids"],r),t}function $p(n,e){const t={},r=S(e,["modality"]);r!=null&&N(t,["modality"],r);const s=S(e,["tokenCount"]);return s!=null&&N(t,["tokenCount"],s),t}function Hp(n,e){const t={},r=S(e,["modality"]);r!=null&&N(t,["modality"],r);const s=S(e,["tokenCount"]);return s!=null&&N(t,["tokenCount"],s),t}function k9(n,e){const t={},r=S(e,["promptTokenCount"]);r!=null&&N(t,["promptTokenCount"],r);const s=S(e,["cachedContentTokenCount"]);s!=null&&N(t,["cachedContentTokenCount"],s);const a=S(e,["responseTokenCount"]);a!=null&&N(t,["responseTokenCount"],a);const o=S(e,["toolUsePromptTokenCount"]);o!=null&&N(t,["toolUsePromptTokenCount"],o);const l=S(e,["thoughtsTokenCount"]);l!=null&&N(t,["thoughtsTokenCount"],l);const c=S(e,["totalTokenCount"]);c!=null&&N(t,["totalTokenCount"],c);const d=S(e,["promptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(b=>$p(n,b))),N(t,["promptTokensDetails"],v)}const h=S(e,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(b=>$p(n,b))),N(t,["cacheTokensDetails"],v)}const p=S(e,["responseTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(b=>$p(n,b))),N(t,["responseTokensDetails"],v)}const x=S(e,["toolUsePromptTokensDetails"]);if(x!=null){let v=x;Array.isArray(v)&&(v=v.map(b=>$p(n,b))),N(t,["toolUsePromptTokensDetails"],v)}return t}function P9(n,e){const t={},r=S(e,["promptTokenCount"]);r!=null&&N(t,["promptTokenCount"],r);const s=S(e,["cachedContentTokenCount"]);s!=null&&N(t,["cachedContentTokenCount"],s);const a=S(e,["candidatesTokenCount"]);a!=null&&N(t,["responseTokenCount"],a);const o=S(e,["toolUsePromptTokenCount"]);o!=null&&N(t,["toolUsePromptTokenCount"],o);const l=S(e,["thoughtsTokenCount"]);l!=null&&N(t,["thoughtsTokenCount"],l);const c=S(e,["totalTokenCount"]);c!=null&&N(t,["totalTokenCount"],c);const d=S(e,["promptTokensDetails"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(_=>Hp(n,_))),N(t,["promptTokensDetails"],b)}const h=S(e,["cacheTokensDetails"]);if(h!=null){let b=h;Array.isArray(b)&&(b=b.map(_=>Hp(n,_))),N(t,["cacheTokensDetails"],b)}const p=S(e,["candidatesTokensDetails"]);if(p!=null){let b=p;Array.isArray(b)&&(b=b.map(_=>Hp(n,_))),N(t,["responseTokensDetails"],b)}const x=S(e,["toolUsePromptTokensDetails"]);if(x!=null){let b=x;Array.isArray(b)&&(b=b.map(_=>Hp(n,_))),N(t,["toolUsePromptTokensDetails"],b)}const v=S(e,["trafficType"]);return v!=null&&N(t,["trafficType"],v),t}function M9(n,e){const t={},r=S(e,["timeLeft"]);return r!=null&&N(t,["timeLeft"],r),t}function E9(n,e){const t={},r=S(e,["timeLeft"]);return r!=null&&N(t,["timeLeft"],r),t}function D9(n,e){const t={},r=S(e,["newHandle"]);r!=null&&N(t,["newHandle"],r);const s=S(e,["resumable"]);s!=null&&N(t,["resumable"],s);const a=S(e,["lastConsumedClientMessageIndex"]);return a!=null&&N(t,["lastConsumedClientMessageIndex"],a),t}function O9(n,e){const t={},r=S(e,["newHandle"]);r!=null&&N(t,["newHandle"],r);const s=S(e,["resumable"]);s!=null&&N(t,["resumable"],s);const a=S(e,["lastConsumedClientMessageIndex"]);return a!=null&&N(t,["lastConsumedClientMessageIndex"],a),t}function I9(n,e){const t={};S(e,["setupComplete"])!=null&&N(t,["setupComplete"],l9());const s=S(e,["serverContent"]);s!=null&&N(t,["serverContent"],b9(n,s));const a=S(e,["toolCall"]);a!=null&&N(t,["toolCall"],S9(n,a));const o=S(e,["toolCallCancellation"]);o!=null&&N(t,["toolCallCancellation"],C9(n,o));const l=S(e,["usageMetadata"]);l!=null&&N(t,["usageMetadata"],k9(n,l));const c=S(e,["goAway"]);c!=null&&N(t,["goAway"],M9(n,c));const d=S(e,["sessionResumptionUpdate"]);return d!=null&&N(t,["sessionResumptionUpdate"],D9(n,d)),t}function A9(n,e){const t={};S(e,["setupComplete"])!=null&&N(t,["setupComplete"],c9());const s=S(e,["serverContent"]);s!=null&&N(t,["serverContent"],w9(n,s));const a=S(e,["toolCall"]);a!=null&&N(t,["toolCall"],N9(n,a));const o=S(e,["toolCallCancellation"]);o!=null&&N(t,["toolCallCancellation"],T9(n,o));const l=S(e,["usageMetadata"]);l!=null&&N(t,["usageMetadata"],P9(n,l));const c=S(e,["goAway"]);c!=null&&N(t,["goAway"],E9(n,c));const d=S(e,["sessionResumptionUpdate"]);return d!=null&&N(t,["sessionResumptionUpdate"],O9(n,d)),t}function R9(){return{}}function L9(n,e){const t={},r=S(e,["text"]);r!=null&&N(t,["text"],r);const s=S(e,["weight"]);return s!=null&&N(t,["weight"],s),t}function F9(n,e){const t={},r=S(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>L9(n,a))),N(t,["weightedPrompts"],s)}return t}function q9(n,e){const t={},r=S(e,["temperature"]);r!=null&&N(t,["temperature"],r);const s=S(e,["topK"]);s!=null&&N(t,["topK"],s);const a=S(e,["seed"]);a!=null&&N(t,["seed"],a);const o=S(e,["guidance"]);o!=null&&N(t,["guidance"],o);const l=S(e,["bpm"]);l!=null&&N(t,["bpm"],l);const c=S(e,["density"]);c!=null&&N(t,["density"],c);const d=S(e,["brightness"]);d!=null&&N(t,["brightness"],d);const h=S(e,["scale"]);h!=null&&N(t,["scale"],h);const p=S(e,["muteBass"]);p!=null&&N(t,["muteBass"],p);const x=S(e,["muteDrums"]);x!=null&&N(t,["muteDrums"],x);const v=S(e,["onlyBassAndDrums"]);v!=null&&N(t,["onlyBassAndDrums"],v);const b=S(e,["musicGenerationMode"]);return b!=null&&N(t,["musicGenerationMode"],b),t}function z9(n,e){const t={},r=S(e,["clientContent"]);r!=null&&N(t,["clientContent"],F9(n,r));const s=S(e,["musicGenerationConfig"]);return s!=null&&N(t,["musicGenerationConfig"],q9(n,s)),t}function U9(n,e){const t={},r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);s!=null&&N(t,["mimeType"],s);const a=S(e,["sourceMetadata"]);return a!=null&&N(t,["sourceMetadata"],z9(n,a)),t}function B9(n,e){const t={},r=S(e,["audioChunks"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>U9(n,a))),N(t,["audioChunks"],s)}return t}function V9(n,e){const t={},r=S(e,["text"]);r!=null&&N(t,["text"],r);const s=S(e,["filteredReason"]);return s!=null&&N(t,["filteredReason"],s),t}function W9(n,e){const t={};S(e,["setupComplete"])!=null&&N(t,["setupComplete"],R9());const s=S(e,["serverContent"]);s!=null&&N(t,["serverContent"],B9(n,s));const a=S(e,["filteredPrompt"]);return a!=null&&N(t,["filteredPrompt"],V9(n,a)),t}function $9(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function H9(n,e){const t={};if(S(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function Y9(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],$9(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],H9(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const h=S(e,["functionResponse"]);h!=null&&N(t,["functionResponse"],h);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function oy(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Y9(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function G9(n,e){const t={};if(S(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=S(e,["category"]);r!=null&&N(t,["category"],r);const s=S(e,["threshold"]);return s!=null&&N(t,["threshold"],s),t}function Z9(n,e){const t={},r=S(e,["behavior"]);r!=null&&N(t,["behavior"],r);const s=S(e,["description"]);s!=null&&N(t,["description"],s);const a=S(e,["name"]);a!=null&&N(t,["name"],a);const o=S(e,["parameters"]);o!=null&&N(t,["parameters"],o);const l=S(e,["response"]);return l!=null&&N(t,["response"],l),t}function K9(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function J9(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],K9(n,r)),t}function Q9(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function X9(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],Q9(n,r)),t}function eY(){return{}}function tY(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>Z9(n,d))),N(t,["functionDeclarations"],c)}if(S(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=S(e,["googleSearch"]);s!=null&&N(t,["googleSearch"],J9(n,s));const a=S(e,["googleSearchRetrieval"]);if(a!=null&&N(t,["googleSearchRetrieval"],X9(n,a)),S(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(S(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");S(e,["urlContext"])!=null&&N(t,["urlContext"],eY());const l=S(e,["codeExecution"]);return l!=null&&N(t,["codeExecution"],l),t}function nY(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["allowedFunctionNames"]);return s!=null&&N(t,["allowedFunctionNames"],s),t}function rY(n,e){const t={},r=S(e,["latitude"]);r!=null&&N(t,["latitude"],r);const s=S(e,["longitude"]);return s!=null&&N(t,["longitude"],s),t}function sY(n,e){const t={},r=S(e,["latLng"]);return r!=null&&N(t,["latLng"],rY(n,r)),t}function iY(n,e){const t={},r=S(e,["functionCallingConfig"]);r!=null&&N(t,["functionCallingConfig"],nY(n,r));const s=S(e,["retrievalConfig"]);return s!=null&&N(t,["retrievalConfig"],sY(n,s)),t}function aY(n,e){const t={},r=S(e,["voiceName"]);return r!=null&&N(t,["voiceName"],r),t}function GF(n,e){const t={},r=S(e,["prebuiltVoiceConfig"]);return r!=null&&N(t,["prebuiltVoiceConfig"],aY(n,r)),t}function oY(n,e){const t={},r=S(e,["speaker"]);r!=null&&N(t,["speaker"],r);const s=S(e,["voiceConfig"]);return s!=null&&N(t,["voiceConfig"],GF(n,s)),t}function lY(n,e){const t={},r=S(e,["speakerVoiceConfigs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>oY(n,a))),N(t,["speakerVoiceConfigs"],s)}return t}function cY(n,e){const t={},r=S(e,["voiceConfig"]);r!=null&&N(t,["voiceConfig"],GF(n,r));const s=S(e,["multiSpeakerVoiceConfig"]);s!=null&&N(t,["multiSpeakerVoiceConfig"],lY(n,s));const a=S(e,["languageCode"]);return a!=null&&N(t,["languageCode"],a),t}function dY(n,e){const t={},r=S(e,["includeThoughts"]);r!=null&&N(t,["includeThoughts"],r);const s=S(e,["thinkingBudget"]);return s!=null&&N(t,["thinkingBudget"],s),t}function uY(n,e,t){const r={},s=S(e,["systemInstruction"]);t!==void 0&&s!=null&&N(t,["systemInstruction"],oy(n,Gs(n,s)));const a=S(e,["temperature"]);a!=null&&N(r,["temperature"],a);const o=S(e,["topP"]);o!=null&&N(r,["topP"],o);const l=S(e,["topK"]);l!=null&&N(r,["topK"],l);const c=S(e,["candidateCount"]);c!=null&&N(r,["candidateCount"],c);const d=S(e,["maxOutputTokens"]);d!=null&&N(r,["maxOutputTokens"],d);const h=S(e,["stopSequences"]);h!=null&&N(r,["stopSequences"],h);const p=S(e,["responseLogprobs"]);p!=null&&N(r,["responseLogprobs"],p);const x=S(e,["logprobs"]);x!=null&&N(r,["logprobs"],x);const v=S(e,["presencePenalty"]);v!=null&&N(r,["presencePenalty"],v);const b=S(e,["frequencyPenalty"]);b!=null&&N(r,["frequencyPenalty"],b);const _=S(e,["seed"]);_!=null&&N(r,["seed"],_);const j=S(e,["responseMimeType"]);j!=null&&N(r,["responseMimeType"],j);const C=S(e,["responseSchema"]);if(C!=null&&N(r,["responseSchema"],Dx(n,C)),S(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(S(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=S(e,["safetySettings"]);if(t!==void 0&&P!=null){let B=P;Array.isArray(B)&&(B=B.map(W=>G9(n,W))),N(t,["safetySettings"],B)}const O=S(e,["tools"]);if(t!==void 0&&O!=null){let B=iy(n,O);Array.isArray(B)&&(B=B.map(W=>tY(n,sy(n,W)))),N(t,["tools"],B)}const M=S(e,["toolConfig"]);if(t!==void 0&&M!=null&&N(t,["toolConfig"],iY(n,M)),S(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const D=S(e,["cachedContent"]);t!==void 0&&D!=null&&N(t,["cachedContent"],Qc(n,D));const I=S(e,["responseModalities"]);I!=null&&N(r,["responseModalities"],I);const F=S(e,["mediaResolution"]);F!=null&&N(r,["mediaResolution"],F);const q=S(e,["speechConfig"]);if(q!=null&&N(r,["speechConfig"],cY(n,RF(n,q))),S(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=S(e,["thinkingConfig"]);return U!=null&&N(r,["thinkingConfig"],dY(n,U)),r}function CM(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["contents"]);if(s!=null){let o=Ea(n,s);Array.isArray(o)&&(o=o.map(l=>oy(n,l))),N(t,["contents"],o)}const a=S(e,["config"]);return a!=null&&N(t,["generationConfig"],uY(n,a,t)),t}function fY(n,e,t){const r={},s=S(e,["taskType"]);t!==void 0&&s!=null&&N(t,["requests[]","taskType"],s);const a=S(e,["title"]);t!==void 0&&a!=null&&N(t,["requests[]","title"],a);const o=S(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&N(t,["requests[]","outputDimensionality"],o),S(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(S(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function hY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["contents"]);s!=null&&N(t,["requests[]","content"],AF(n,s));const a=S(e,["config"]);a!=null&&N(t,["config"],fY(n,a,t));const o=S(e,["model"]);return o!==void 0&&N(t,["requests[]","model"],Wn(n,o)),t}function mY(n,e,t){const r={};if(S(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(S(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=S(e,["numberOfImages"]);t!==void 0&&s!=null&&N(t,["parameters","sampleCount"],s);const a=S(e,["aspectRatio"]);t!==void 0&&a!=null&&N(t,["parameters","aspectRatio"],a);const o=S(e,["guidanceScale"]);if(t!==void 0&&o!=null&&N(t,["parameters","guidanceScale"],o),S(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=S(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&N(t,["parameters","safetySetting"],l);const c=S(e,["personGeneration"]);t!==void 0&&c!=null&&N(t,["parameters","personGeneration"],c);const d=S(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&N(t,["parameters","includeSafetyAttributes"],d);const h=S(e,["includeRaiReason"]);t!==void 0&&h!=null&&N(t,["parameters","includeRaiReason"],h);const p=S(e,["language"]);t!==void 0&&p!=null&&N(t,["parameters","language"],p);const x=S(e,["outputMimeType"]);t!==void 0&&x!=null&&N(t,["parameters","outputOptions","mimeType"],x);const v=S(e,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&N(t,["parameters","outputOptions","compressionQuality"],v),S(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(S(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function pY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["prompt"]);s!=null&&N(t,["instances[0]","prompt"],s);const a=S(e,["config"]);return a!=null&&N(t,["config"],mY(n,a,t)),t}function gY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","name"],Wn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function xY(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);t!==void 0&&a!=null&&N(t,["_query","pageToken"],a);const o=S(e,["filter"]);t!==void 0&&o!=null&&N(t,["_query","filter"],o);const l=S(e,["queryBase"]);return t!==void 0&&l!=null&&N(t,["_url","models_url"],zF(n,l)),r}function yY(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],xY(n,r,t)),t}function vY(n,e,t){const r={},s=S(e,["displayName"]);t!==void 0&&s!=null&&N(t,["displayName"],s);const a=S(e,["description"]);t!==void 0&&a!=null&&N(t,["description"],a);const o=S(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&N(t,["defaultCheckpointId"],o),r}function bY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","name"],Wn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],vY(n,s,t)),t}function wY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","name"],Wn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function _Y(n,e){const t={};if(S(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(S(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(S(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function jY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["contents"]);if(s!=null){let o=Ea(n,s);Array.isArray(o)&&(o=o.map(l=>oy(n,l))),N(t,["contents"],o)}const a=S(e,["config"]);return a!=null&&N(t,["config"],_Y(n,a)),t}function SY(n,e){const t={};if(S(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=S(e,["imageBytes"]);r!=null&&N(t,["bytesBase64Encoded"],Xc(n,r));const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function NY(n,e,t){const r={},s=S(e,["numberOfVideos"]);if(t!==void 0&&s!=null&&N(t,["parameters","sampleCount"],s),S(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(S(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=S(e,["durationSeconds"]);if(t!==void 0&&a!=null&&N(t,["parameters","durationSeconds"],a),S(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=S(e,["aspectRatio"]);if(t!==void 0&&o!=null&&N(t,["parameters","aspectRatio"],o),S(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=S(e,["personGeneration"]);if(t!==void 0&&l!=null&&N(t,["parameters","personGeneration"],l),S(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=S(e,["negativePrompt"]);if(t!==void 0&&c!=null&&N(t,["parameters","negativePrompt"],c),S(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function CY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["prompt"]);s!=null&&N(t,["instances[0]","prompt"],s);const a=S(e,["image"]);a!=null&&N(t,["instances[0]","image"],SY(n,a));const o=S(e,["config"]);return o!=null&&N(t,["config"],NY(n,o,t)),t}function TY(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function kY(n,e){const t={},r=S(e,["displayName"]);r!=null&&N(t,["displayName"],r);const s=S(e,["data"]);s!=null&&N(t,["data"],s);const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function PY(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],TY(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],kY(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const h=S(e,["functionResponse"]);h!=null&&N(t,["functionResponse"],h);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function Yf(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>PY(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function MY(n,e){const t={},r=S(e,["featureSelectionPreference"]);return r!=null&&N(t,["featureSelectionPreference"],r),t}function EY(n,e){const t={},r=S(e,["method"]);r!=null&&N(t,["method"],r);const s=S(e,["category"]);s!=null&&N(t,["category"],s);const a=S(e,["threshold"]);return a!=null&&N(t,["threshold"],a),t}function DY(n,e){const t={};if(S(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=S(e,["description"]);r!=null&&N(t,["description"],r);const s=S(e,["name"]);s!=null&&N(t,["name"],s);const a=S(e,["parameters"]);a!=null&&N(t,["parameters"],a);const o=S(e,["response"]);return o!=null&&N(t,["response"],o),t}function OY(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function IY(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],OY(n,r)),t}function AY(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function RY(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],AY(n,r)),t}function LY(){return{}}function FY(n,e){const t={},r=S(e,["apiKeyString"]);return r!=null&&N(t,["apiKeyString"],r),t}function qY(n,e){const t={},r=S(e,["apiKeyConfig"]);r!=null&&N(t,["apiKeyConfig"],FY(n,r));const s=S(e,["authType"]);s!=null&&N(t,["authType"],s);const a=S(e,["googleServiceAccountConfig"]);a!=null&&N(t,["googleServiceAccountConfig"],a);const o=S(e,["httpBasicAuthConfig"]);o!=null&&N(t,["httpBasicAuthConfig"],o);const l=S(e,["oauthConfig"]);l!=null&&N(t,["oauthConfig"],l);const c=S(e,["oidcConfig"]);return c!=null&&N(t,["oidcConfig"],c),t}function zY(n,e){const t={},r=S(e,["authConfig"]);return r!=null&&N(t,["authConfig"],qY(n,r)),t}function ZF(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>DY(n,p))),N(t,["functionDeclarations"],h)}const s=S(e,["retrieval"]);s!=null&&N(t,["retrieval"],s);const a=S(e,["googleSearch"]);a!=null&&N(t,["googleSearch"],IY(n,a));const o=S(e,["googleSearchRetrieval"]);o!=null&&N(t,["googleSearchRetrieval"],RY(n,o)),S(e,["enterpriseWebSearch"])!=null&&N(t,["enterpriseWebSearch"],LY());const c=S(e,["googleMaps"]);if(c!=null&&N(t,["googleMaps"],zY(n,c)),S(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=S(e,["codeExecution"]);return d!=null&&N(t,["codeExecution"],d),t}function UY(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["allowedFunctionNames"]);return s!=null&&N(t,["allowedFunctionNames"],s),t}function BY(n,e){const t={},r=S(e,["latitude"]);r!=null&&N(t,["latitude"],r);const s=S(e,["longitude"]);return s!=null&&N(t,["longitude"],s),t}function VY(n,e){const t={},r=S(e,["latLng"]);return r!=null&&N(t,["latLng"],BY(n,r)),t}function WY(n,e){const t={},r=S(e,["functionCallingConfig"]);r!=null&&N(t,["functionCallingConfig"],UY(n,r));const s=S(e,["retrievalConfig"]);return s!=null&&N(t,["retrievalConfig"],VY(n,s)),t}function $Y(n,e){const t={},r=S(e,["voiceName"]);return r!=null&&N(t,["voiceName"],r),t}function HY(n,e){const t={},r=S(e,["prebuiltVoiceConfig"]);return r!=null&&N(t,["prebuiltVoiceConfig"],$Y(n,r)),t}function YY(n,e){const t={},r=S(e,["voiceConfig"]);if(r!=null&&N(t,["voiceConfig"],HY(n,r)),S(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=S(e,["languageCode"]);return s!=null&&N(t,["languageCode"],s),t}function GY(n,e){const t={},r=S(e,["includeThoughts"]);r!=null&&N(t,["includeThoughts"],r);const s=S(e,["thinkingBudget"]);return s!=null&&N(t,["thinkingBudget"],s),t}function ZY(n,e,t){const r={},s=S(e,["systemInstruction"]);t!==void 0&&s!=null&&N(t,["systemInstruction"],Yf(n,Gs(n,s)));const a=S(e,["temperature"]);a!=null&&N(r,["temperature"],a);const o=S(e,["topP"]);o!=null&&N(r,["topP"],o);const l=S(e,["topK"]);l!=null&&N(r,["topK"],l);const c=S(e,["candidateCount"]);c!=null&&N(r,["candidateCount"],c);const d=S(e,["maxOutputTokens"]);d!=null&&N(r,["maxOutputTokens"],d);const h=S(e,["stopSequences"]);h!=null&&N(r,["stopSequences"],h);const p=S(e,["responseLogprobs"]);p!=null&&N(r,["responseLogprobs"],p);const x=S(e,["logprobs"]);x!=null&&N(r,["logprobs"],x);const v=S(e,["presencePenalty"]);v!=null&&N(r,["presencePenalty"],v);const b=S(e,["frequencyPenalty"]);b!=null&&N(r,["frequencyPenalty"],b);const _=S(e,["seed"]);_!=null&&N(r,["seed"],_);const j=S(e,["responseMimeType"]);j!=null&&N(r,["responseMimeType"],j);const C=S(e,["responseSchema"]);C!=null&&N(r,["responseSchema"],Dx(n,C));const P=S(e,["routingConfig"]);P!=null&&N(r,["routingConfig"],P);const O=S(e,["modelSelectionConfig"]);O!=null&&N(r,["modelConfig"],MY(n,O));const M=S(e,["safetySettings"]);if(t!==void 0&&M!=null){let Z=M;Array.isArray(Z)&&(Z=Z.map(oe=>EY(n,oe))),N(t,["safetySettings"],Z)}const D=S(e,["tools"]);if(t!==void 0&&D!=null){let Z=iy(n,D);Array.isArray(Z)&&(Z=Z.map(oe=>ZF(n,sy(n,oe)))),N(t,["tools"],Z)}const I=S(e,["toolConfig"]);t!==void 0&&I!=null&&N(t,["toolConfig"],WY(n,I));const F=S(e,["labels"]);t!==void 0&&F!=null&&N(t,["labels"],F);const q=S(e,["cachedContent"]);t!==void 0&&q!=null&&N(t,["cachedContent"],Qc(n,q));const U=S(e,["responseModalities"]);U!=null&&N(r,["responseModalities"],U);const B=S(e,["mediaResolution"]);B!=null&&N(r,["mediaResolution"],B);const W=S(e,["speechConfig"]);W!=null&&N(r,["speechConfig"],YY(n,RF(n,W)));const Y=S(e,["audioTimestamp"]);Y!=null&&N(r,["audioTimestamp"],Y);const G=S(e,["thinkingConfig"]);return G!=null&&N(r,["thinkingConfig"],GY(n,G)),r}function TM(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["contents"]);if(s!=null){let o=Ea(n,s);Array.isArray(o)&&(o=o.map(l=>Yf(n,l))),N(t,["contents"],o)}const a=S(e,["config"]);return a!=null&&N(t,["generationConfig"],ZY(n,a,t)),t}function KY(n,e,t){const r={},s=S(e,["taskType"]);t!==void 0&&s!=null&&N(t,["instances[]","task_type"],s);const a=S(e,["title"]);t!==void 0&&a!=null&&N(t,["instances[]","title"],a);const o=S(e,["outputDimensionality"]);t!==void 0&&o!=null&&N(t,["parameters","outputDimensionality"],o);const l=S(e,["mimeType"]);t!==void 0&&l!=null&&N(t,["instances[]","mimeType"],l);const c=S(e,["autoTruncate"]);return t!==void 0&&c!=null&&N(t,["parameters","autoTruncate"],c),r}function JY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["contents"]);s!=null&&N(t,["instances[]","content"],AF(n,s));const a=S(e,["config"]);return a!=null&&N(t,["config"],KY(n,a,t)),t}function QY(n,e,t){const r={},s=S(e,["outputGcsUri"]);t!==void 0&&s!=null&&N(t,["parameters","storageUri"],s);const a=S(e,["negativePrompt"]);t!==void 0&&a!=null&&N(t,["parameters","negativePrompt"],a);const o=S(e,["numberOfImages"]);t!==void 0&&o!=null&&N(t,["parameters","sampleCount"],o);const l=S(e,["aspectRatio"]);t!==void 0&&l!=null&&N(t,["parameters","aspectRatio"],l);const c=S(e,["guidanceScale"]);t!==void 0&&c!=null&&N(t,["parameters","guidanceScale"],c);const d=S(e,["seed"]);t!==void 0&&d!=null&&N(t,["parameters","seed"],d);const h=S(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&N(t,["parameters","safetySetting"],h);const p=S(e,["personGeneration"]);t!==void 0&&p!=null&&N(t,["parameters","personGeneration"],p);const x=S(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&N(t,["parameters","includeSafetyAttributes"],x);const v=S(e,["includeRaiReason"]);t!==void 0&&v!=null&&N(t,["parameters","includeRaiReason"],v);const b=S(e,["language"]);t!==void 0&&b!=null&&N(t,["parameters","language"],b);const _=S(e,["outputMimeType"]);t!==void 0&&_!=null&&N(t,["parameters","outputOptions","mimeType"],_);const j=S(e,["outputCompressionQuality"]);t!==void 0&&j!=null&&N(t,["parameters","outputOptions","compressionQuality"],j);const C=S(e,["addWatermark"]);t!==void 0&&C!=null&&N(t,["parameters","addWatermark"],C);const P=S(e,["enhancePrompt"]);return t!==void 0&&P!=null&&N(t,["parameters","enhancePrompt"],P),r}function XY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["prompt"]);s!=null&&N(t,["instances[0]","prompt"],s);const a=S(e,["config"]);return a!=null&&N(t,["config"],QY(n,a,t)),t}function NC(n,e){const t={},r=S(e,["gcsUri"]);r!=null&&N(t,["gcsUri"],r);const s=S(e,["imageBytes"]);s!=null&&N(t,["bytesBase64Encoded"],Xc(n,s));const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function eG(n,e){const t={},r=S(e,["maskMode"]);r!=null&&N(t,["maskMode"],r);const s=S(e,["segmentationClasses"]);s!=null&&N(t,["maskClasses"],s);const a=S(e,["maskDilation"]);return a!=null&&N(t,["dilation"],a),t}function tG(n,e){const t={},r=S(e,["controlType"]);r!=null&&N(t,["controlType"],r);const s=S(e,["enableControlImageComputation"]);return s!=null&&N(t,["computeControl"],s),t}function nG(n,e){const t={},r=S(e,["styleDescription"]);return r!=null&&N(t,["styleDescription"],r),t}function rG(n,e){const t={},r=S(e,["subjectType"]);r!=null&&N(t,["subjectType"],r);const s=S(e,["subjectDescription"]);return s!=null&&N(t,["subjectDescription"],s),t}function sG(n,e){const t={},r=S(e,["referenceImage"]);r!=null&&N(t,["referenceImage"],NC(n,r));const s=S(e,["referenceId"]);s!=null&&N(t,["referenceId"],s);const a=S(e,["referenceType"]);a!=null&&N(t,["referenceType"],a);const o=S(e,["maskImageConfig"]);o!=null&&N(t,["maskImageConfig"],eG(n,o));const l=S(e,["controlImageConfig"]);l!=null&&N(t,["controlImageConfig"],tG(n,l));const c=S(e,["styleImageConfig"]);c!=null&&N(t,["styleImageConfig"],nG(n,c));const d=S(e,["subjectImageConfig"]);return d!=null&&N(t,["subjectImageConfig"],rG(n,d)),t}function iG(n,e,t){const r={},s=S(e,["outputGcsUri"]);t!==void 0&&s!=null&&N(t,["parameters","storageUri"],s);const a=S(e,["negativePrompt"]);t!==void 0&&a!=null&&N(t,["parameters","negativePrompt"],a);const o=S(e,["numberOfImages"]);t!==void 0&&o!=null&&N(t,["parameters","sampleCount"],o);const l=S(e,["aspectRatio"]);t!==void 0&&l!=null&&N(t,["parameters","aspectRatio"],l);const c=S(e,["guidanceScale"]);t!==void 0&&c!=null&&N(t,["parameters","guidanceScale"],c);const d=S(e,["seed"]);t!==void 0&&d!=null&&N(t,["parameters","seed"],d);const h=S(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&N(t,["parameters","safetySetting"],h);const p=S(e,["personGeneration"]);t!==void 0&&p!=null&&N(t,["parameters","personGeneration"],p);const x=S(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&N(t,["parameters","includeSafetyAttributes"],x);const v=S(e,["includeRaiReason"]);t!==void 0&&v!=null&&N(t,["parameters","includeRaiReason"],v);const b=S(e,["language"]);t!==void 0&&b!=null&&N(t,["parameters","language"],b);const _=S(e,["outputMimeType"]);t!==void 0&&_!=null&&N(t,["parameters","outputOptions","mimeType"],_);const j=S(e,["outputCompressionQuality"]);t!==void 0&&j!=null&&N(t,["parameters","outputOptions","compressionQuality"],j);const C=S(e,["editMode"]);t!==void 0&&C!=null&&N(t,["parameters","editMode"],C);const P=S(e,["baseSteps"]);return t!==void 0&&P!=null&&N(t,["parameters","editConfig","baseSteps"],P),r}function aG(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["prompt"]);s!=null&&N(t,["instances[0]","prompt"],s);const a=S(e,["referenceImages"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>sG(n,c))),N(t,["instances[0]","referenceImages"],l)}const o=S(e,["config"]);return o!=null&&N(t,["config"],iG(n,o,t)),t}function oG(n,e,t){const r={},s=S(e,["includeRaiReason"]);t!==void 0&&s!=null&&N(t,["parameters","includeRaiReason"],s);const a=S(e,["outputMimeType"]);t!==void 0&&a!=null&&N(t,["parameters","outputOptions","mimeType"],a);const o=S(e,["outputCompressionQuality"]);t!==void 0&&o!=null&&N(t,["parameters","outputOptions","compressionQuality"],o);const l=S(e,["numberOfImages"]);t!==void 0&&l!=null&&N(t,["parameters","sampleCount"],l);const c=S(e,["mode"]);return t!==void 0&&c!=null&&N(t,["parameters","mode"],c),r}function lG(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["image"]);s!=null&&N(t,["instances[0]","image"],NC(n,s));const a=S(e,["upscaleFactor"]);a!=null&&N(t,["parameters","upscaleConfig","upscaleFactor"],a);const o=S(e,["config"]);return o!=null&&N(t,["config"],oG(n,o,t)),t}function cG(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","name"],Wn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function dG(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);t!==void 0&&a!=null&&N(t,["_query","pageToken"],a);const o=S(e,["filter"]);t!==void 0&&o!=null&&N(t,["_query","filter"],o);const l=S(e,["queryBase"]);return t!==void 0&&l!=null&&N(t,["_url","models_url"],zF(n,l)),r}function uG(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],dG(n,r,t)),t}function fG(n,e,t){const r={},s=S(e,["displayName"]);t!==void 0&&s!=null&&N(t,["displayName"],s);const a=S(e,["description"]);t!==void 0&&a!=null&&N(t,["description"],a);const o=S(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&N(t,["defaultCheckpointId"],o),r}function hG(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],fG(n,s,t)),t}function mG(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","name"],Wn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function pG(n,e,t){const r={},s=S(e,["systemInstruction"]);t!==void 0&&s!=null&&N(t,["systemInstruction"],Yf(n,Gs(n,s)));const a=S(e,["tools"]);if(t!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>ZF(n,c))),N(t,["tools"],l)}const o=S(e,["generationConfig"]);return t!==void 0&&o!=null&&N(t,["generationConfig"],o),r}function gG(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["contents"]);if(s!=null){let o=Ea(n,s);Array.isArray(o)&&(o=o.map(l=>Yf(n,l))),N(t,["contents"],o)}const a=S(e,["config"]);return a!=null&&N(t,["config"],pG(n,a,t)),t}function xG(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["contents"]);if(s!=null){let o=Ea(n,s);Array.isArray(o)&&(o=o.map(l=>Yf(n,l))),N(t,["contents"],o)}const a=S(e,["config"]);return a!=null&&N(t,["config"],a),t}function yG(n,e,t){const r={},s=S(e,["numberOfVideos"]);t!==void 0&&s!=null&&N(t,["parameters","sampleCount"],s);const a=S(e,["outputGcsUri"]);t!==void 0&&a!=null&&N(t,["parameters","storageUri"],a);const o=S(e,["fps"]);t!==void 0&&o!=null&&N(t,["parameters","fps"],o);const l=S(e,["durationSeconds"]);t!==void 0&&l!=null&&N(t,["parameters","durationSeconds"],l);const c=S(e,["seed"]);t!==void 0&&c!=null&&N(t,["parameters","seed"],c);const d=S(e,["aspectRatio"]);t!==void 0&&d!=null&&N(t,["parameters","aspectRatio"],d);const h=S(e,["resolution"]);t!==void 0&&h!=null&&N(t,["parameters","resolution"],h);const p=S(e,["personGeneration"]);t!==void 0&&p!=null&&N(t,["parameters","personGeneration"],p);const x=S(e,["pubsubTopic"]);t!==void 0&&x!=null&&N(t,["parameters","pubsubTopic"],x);const v=S(e,["negativePrompt"]);t!==void 0&&v!=null&&N(t,["parameters","negativePrompt"],v);const b=S(e,["enhancePrompt"]);return t!==void 0&&b!=null&&N(t,["parameters","enhancePrompt"],b),r}function vG(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],Wn(n,r));const s=S(e,["prompt"]);s!=null&&N(t,["instances[0]","prompt"],s);const a=S(e,["image"]);a!=null&&N(t,["instances[0]","image"],NC(n,a));const o=S(e,["config"]);return o!=null&&N(t,["config"],yG(n,o,t)),t}function bG(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function wG(n,e){const t={},r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function _G(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],bG(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],wG(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const h=S(e,["functionResponse"]);h!=null&&N(t,["functionResponse"],h);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function jG(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>_G(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function SG(n,e){const t={},r=S(e,["citationSources"]);return r!=null&&N(t,["citations"],r),t}function NG(n,e){const t={},r=S(e,["retrievedUrl"]);r!=null&&N(t,["retrievedUrl"],r);const s=S(e,["urlRetrievalStatus"]);return s!=null&&N(t,["urlRetrievalStatus"],s),t}function CG(n,e){const t={},r=S(e,["urlMetadata"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>NG(n,a))),N(t,["urlMetadata"],s)}return t}function TG(n,e){const t={},r=S(e,["content"]);r!=null&&N(t,["content"],jG(n,r));const s=S(e,["citationMetadata"]);s!=null&&N(t,["citationMetadata"],SG(n,s));const a=S(e,["tokenCount"]);a!=null&&N(t,["tokenCount"],a);const o=S(e,["finishReason"]);o!=null&&N(t,["finishReason"],o);const l=S(e,["urlContextMetadata"]);l!=null&&N(t,["urlContextMetadata"],CG(n,l));const c=S(e,["avgLogprobs"]);c!=null&&N(t,["avgLogprobs"],c);const d=S(e,["groundingMetadata"]);d!=null&&N(t,["groundingMetadata"],d);const h=S(e,["index"]);h!=null&&N(t,["index"],h);const p=S(e,["logprobsResult"]);p!=null&&N(t,["logprobsResult"],p);const x=S(e,["safetyRatings"]);return x!=null&&N(t,["safetyRatings"],x),t}function kM(n,e){const t={},r=S(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>TG(n,c))),N(t,["candidates"],l)}const s=S(e,["modelVersion"]);s!=null&&N(t,["modelVersion"],s);const a=S(e,["promptFeedback"]);a!=null&&N(t,["promptFeedback"],a);const o=S(e,["usageMetadata"]);return o!=null&&N(t,["usageMetadata"],o),t}function kG(n,e){const t={},r=S(e,["values"]);return r!=null&&N(t,["values"],r),t}function PG(){return{}}function MG(n,e){const t={},r=S(e,["embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>kG(n,o))),N(t,["embeddings"],a)}return S(e,["metadata"])!=null&&N(t,["metadata"],PG()),t}function EG(n,e){const t={},r=S(e,["bytesBase64Encoded"]);r!=null&&N(t,["imageBytes"],Xc(n,r));const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function KF(n,e){const t={},r=S(e,["safetyAttributes","categories"]);r!=null&&N(t,["categories"],r);const s=S(e,["safetyAttributes","scores"]);s!=null&&N(t,["scores"],s);const a=S(e,["contentType"]);return a!=null&&N(t,["contentType"],a),t}function DG(n,e){const t={},r=S(e,["_self"]);r!=null&&N(t,["image"],EG(n,r));const s=S(e,["raiFilteredReason"]);s!=null&&N(t,["raiFilteredReason"],s);const a=S(e,["_self"]);return a!=null&&N(t,["safetyAttributes"],KF(n,a)),t}function OG(n,e){const t={},r=S(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>DG(n,o))),N(t,["generatedImages"],a)}const s=S(e,["positivePromptSafetyAttributes"]);return s!=null&&N(t,["positivePromptSafetyAttributes"],KF(n,s)),t}function IG(n,e){const t={},r=S(e,["baseModel"]);r!=null&&N(t,["baseModel"],r);const s=S(e,["createTime"]);s!=null&&N(t,["createTime"],s);const a=S(e,["updateTime"]);return a!=null&&N(t,["updateTime"],a),t}function wN(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["description"]);a!=null&&N(t,["description"],a);const o=S(e,["version"]);o!=null&&N(t,["version"],o);const l=S(e,["_self"]);l!=null&&N(t,["tunedModelInfo"],IG(n,l));const c=S(e,["inputTokenLimit"]);c!=null&&N(t,["inputTokenLimit"],c);const d=S(e,["outputTokenLimit"]);d!=null&&N(t,["outputTokenLimit"],d);const h=S(e,["supportedGenerationMethods"]);return h!=null&&N(t,["supportedActions"],h),t}function AG(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["_self"]);if(s!=null){let a=UF(n,s);Array.isArray(a)&&(a=a.map(o=>wN(n,o))),N(t,["models"],a)}return t}function RG(){return{}}function LG(n,e){const t={},r=S(e,["totalTokens"]);r!=null&&N(t,["totalTokens"],r);const s=S(e,["cachedContentTokenCount"]);return s!=null&&N(t,["cachedContentTokenCount"],s),t}function FG(n,e){const t={},r=S(e,["video","uri"]);r!=null&&N(t,["uri"],r);const s=S(e,["video","encodedVideo"]);s!=null&&N(t,["videoBytes"],Xc(n,s));const a=S(e,["encoding"]);return a!=null&&N(t,["mimeType"],a),t}function qG(n,e){const t={},r=S(e,["_self"]);return r!=null&&N(t,["video"],FG(n,r)),t}function zG(n,e){const t={},r=S(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>qG(n,l))),N(t,["generatedVideos"],o)}const s=S(e,["raiMediaFilteredCount"]);s!=null&&N(t,["raiMediaFilteredCount"],s);const a=S(e,["raiMediaFilteredReasons"]);return a!=null&&N(t,["raiMediaFilteredReasons"],a),t}function UG(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["metadata"]);s!=null&&N(t,["metadata"],s);const a=S(e,["done"]);a!=null&&N(t,["done"],a);const o=S(e,["error"]);o!=null&&N(t,["error"],o);const l=S(e,["response","generateVideoResponse"]);return l!=null&&N(t,["response"],zG(n,l)),t}function BG(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function VG(n,e){const t={},r=S(e,["displayName"]);r!=null&&N(t,["displayName"],r);const s=S(e,["data"]);s!=null&&N(t,["data"],s);const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function WG(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],BG(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],VG(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const h=S(e,["functionResponse"]);h!=null&&N(t,["functionResponse"],h);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function $G(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>WG(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function HG(n,e){const t={},r=S(e,["citations"]);return r!=null&&N(t,["citations"],r),t}function YG(n,e){const t={},r=S(e,["content"]);r!=null&&N(t,["content"],$G(n,r));const s=S(e,["citationMetadata"]);s!=null&&N(t,["citationMetadata"],HG(n,s));const a=S(e,["finishMessage"]);a!=null&&N(t,["finishMessage"],a);const o=S(e,["finishReason"]);o!=null&&N(t,["finishReason"],o);const l=S(e,["avgLogprobs"]);l!=null&&N(t,["avgLogprobs"],l);const c=S(e,["groundingMetadata"]);c!=null&&N(t,["groundingMetadata"],c);const d=S(e,["index"]);d!=null&&N(t,["index"],d);const h=S(e,["logprobsResult"]);h!=null&&N(t,["logprobsResult"],h);const p=S(e,["safetyRatings"]);return p!=null&&N(t,["safetyRatings"],p),t}function PM(n,e){const t={},r=S(e,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>YG(n,h))),N(t,["candidates"],d)}const s=S(e,["createTime"]);s!=null&&N(t,["createTime"],s);const a=S(e,["responseId"]);a!=null&&N(t,["responseId"],a);const o=S(e,["modelVersion"]);o!=null&&N(t,["modelVersion"],o);const l=S(e,["promptFeedback"]);l!=null&&N(t,["promptFeedback"],l);const c=S(e,["usageMetadata"]);return c!=null&&N(t,["usageMetadata"],c),t}function GG(n,e){const t={},r=S(e,["truncated"]);r!=null&&N(t,["truncated"],r);const s=S(e,["token_count"]);return s!=null&&N(t,["tokenCount"],s),t}function ZG(n,e){const t={},r=S(e,["values"]);r!=null&&N(t,["values"],r);const s=S(e,["statistics"]);return s!=null&&N(t,["statistics"],GG(n,s)),t}function KG(n,e){const t={},r=S(e,["billableCharacterCount"]);return r!=null&&N(t,["billableCharacterCount"],r),t}function JG(n,e){const t={},r=S(e,["predictions[]","embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>ZG(n,o))),N(t,["embeddings"],a)}const s=S(e,["metadata"]);return s!=null&&N(t,["metadata"],KG(n,s)),t}function QG(n,e){const t={},r=S(e,["gcsUri"]);r!=null&&N(t,["gcsUri"],r);const s=S(e,["bytesBase64Encoded"]);s!=null&&N(t,["imageBytes"],Xc(n,s));const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function JF(n,e){const t={},r=S(e,["safetyAttributes","categories"]);r!=null&&N(t,["categories"],r);const s=S(e,["safetyAttributes","scores"]);s!=null&&N(t,["scores"],s);const a=S(e,["contentType"]);return a!=null&&N(t,["contentType"],a),t}function CC(n,e){const t={},r=S(e,["_self"]);r!=null&&N(t,["image"],QG(n,r));const s=S(e,["raiFilteredReason"]);s!=null&&N(t,["raiFilteredReason"],s);const a=S(e,["_self"]);a!=null&&N(t,["safetyAttributes"],JF(n,a));const o=S(e,["prompt"]);return o!=null&&N(t,["enhancedPrompt"],o),t}function XG(n,e){const t={},r=S(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>CC(n,o))),N(t,["generatedImages"],a)}const s=S(e,["positivePromptSafetyAttributes"]);return s!=null&&N(t,["positivePromptSafetyAttributes"],JF(n,s)),t}function eZ(n,e){const t={},r=S(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>CC(n,a))),N(t,["generatedImages"],s)}return t}function tZ(n,e){const t={},r=S(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>CC(n,a))),N(t,["generatedImages"],s)}return t}function nZ(n,e){const t={},r=S(e,["endpoint"]);r!=null&&N(t,["name"],r);const s=S(e,["deployedModelId"]);return s!=null&&N(t,["deployedModelId"],s),t}function rZ(n,e){const t={},r=S(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&N(t,["baseModel"],r);const s=S(e,["createTime"]);s!=null&&N(t,["createTime"],s);const a=S(e,["updateTime"]);return a!=null&&N(t,["updateTime"],a),t}function sZ(n,e){const t={},r=S(e,["checkpointId"]);r!=null&&N(t,["checkpointId"],r);const s=S(e,["epoch"]);s!=null&&N(t,["epoch"],s);const a=S(e,["step"]);return a!=null&&N(t,["step"],a),t}function _N(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["description"]);a!=null&&N(t,["description"],a);const o=S(e,["versionId"]);o!=null&&N(t,["version"],o);const l=S(e,["deployedModels"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(v=>nZ(n,v))),N(t,["endpoints"],x)}const c=S(e,["labels"]);c!=null&&N(t,["labels"],c);const d=S(e,["_self"]);d!=null&&N(t,["tunedModelInfo"],rZ(n,d));const h=S(e,["defaultCheckpointId"]);h!=null&&N(t,["defaultCheckpointId"],h);const p=S(e,["checkpoints"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(v=>sZ(n,v))),N(t,["checkpoints"],x)}return t}function iZ(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["_self"]);if(s!=null){let a=UF(n,s);Array.isArray(a)&&(a=a.map(o=>_N(n,o))),N(t,["models"],a)}return t}function aZ(){return{}}function oZ(n,e){const t={},r=S(e,["totalTokens"]);return r!=null&&N(t,["totalTokens"],r),t}function lZ(n,e){const t={},r=S(e,["tokensInfo"]);return r!=null&&N(t,["tokensInfo"],r),t}function cZ(n,e){const t={},r=S(e,["gcsUri"]);r!=null&&N(t,["uri"],r);const s=S(e,["bytesBase64Encoded"]);s!=null&&N(t,["videoBytes"],Xc(n,s));const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function dZ(n,e){const t={},r=S(e,["_self"]);return r!=null&&N(t,["video"],cZ(n,r)),t}function uZ(n,e){const t={},r=S(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>dZ(n,l))),N(t,["generatedVideos"],o)}const s=S(e,["raiMediaFilteredCount"]);s!=null&&N(t,["raiMediaFilteredCount"],s);const a=S(e,["raiMediaFilteredReasons"]);return a!=null&&N(t,["raiMediaFilteredReasons"],a),t}function fZ(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["metadata"]);s!=null&&N(t,["metadata"],s);const a=S(e,["done"]);a!=null&&N(t,["done"],a);const o=S(e,["error"]);o!=null&&N(t,["error"],o);const l=S(e,["response"]);return l!=null&&N(t,["response"],uZ(n,l)),t}const hZ="Content-Type",mZ="X-Server-Timeout",pZ="User-Agent",jN="x-goog-api-client",gZ="0.15.0",xZ=`google-genai-sdk/${gZ}`,yZ="v1beta1",vZ="v1beta",MM=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class QF extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class SN extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class bZ{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:yZ,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:vZ,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const s=[this.getRequestUrlInternal(t)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.unaryApiCall(s,a,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[s,a]of Object.entries(t))typeof a=="object"?r[s]=Object.assign(Object.assign({},r[s]),a):a!==void 0&&(r[s]=a);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.streamApiCall(s,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r){if(t&&t.timeout||r){const s=new AbortController,a=s.signal;t.timeout&&t?.timeout>0&&setTimeout(()=>s.abort(),t.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=a}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async s=>(await EM(s),new xN(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async s=>(await EM(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return nm(this,arguments,function*(){const s=(t=e?.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield Jn(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=a.decode(c);try{const p=JSON.parse(d);if("error"in p){const x=JSON.parse(JSON.stringify(p.error)),v=x.status,b=x.code,_=`got status: ${v}. ${JSON.stringify(p)}`;if(b>=400&&b<500)throw new QF(_);if(b>=500&&b<600)throw new SN(_)}}catch(p){const x=p;if(x.name==="ClientError"||x.name==="ServerError")throw p}o+=d;let h=o.match(MM);for(;h;){const p=h[1];try{const x=new Response(p,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Jn(new xN(x)),o=o.slice(h[0].length),h=o.match(MM)}catch(x){throw new Error(`exception parsing stream chunk ${p}. ${x}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=xZ+" "+this.clientOptions.userAgentExtra;return e[pZ]=t,e[jN]=t,e[hZ]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))t.append(r,s);e.timeout&&e.timeout>0&&t.append(mZ,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var r;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const a=this.clientOptions.uploader,o=await a.stat(e);s.sizeBytes=String(o.size);const l=(r=t?.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,t);return a.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var r;let s={};t?.httpOptions?s=t.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const a={file:e},o=await this.request({path:Lt("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:s});if(!o||!o?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o?.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function EM(n){var e;if(n===void 0)throw new SN("response is undefined");if(!n.ok){const t=n.status,r=n.statusText;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const a=`got status: ${t} ${r}. ${JSON.stringify(s)}`;throw t>=400&&t<500?new QF(a):t>=500&&t<600?new SN(a):new Error(a)}}const wZ="mcp_used/unknown";function NN(n){for(const e of n)if(TC(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function CN(n){var e;n[jN]=(((e=n[jN])!==null&&e!==void 0?e:"")+` ${wZ}`).trimStart()}function _Z(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>TC(s)))!==null&&r!==void 0?r:!1}function jZ(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>!TC(s)))!==null&&r!==void 0?r:!1}function TC(n){return n!==null&&typeof n=="object"&&"tool"in n&&"callTool"in n}async function SZ(n,e,t){const r=new A8,s=JSON.parse(t.data),a=W9(n,s);Object.assign(r,a),e(r)}class NZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),o=kZ(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),c=`${s}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${l}`;let d=()=>{};const h=new Promise(O=>{d=O}),p=e.callbacks,x=function(){d({})},v=this.apiClient,b={onopen:x,onmessage:O=>{SZ(v,p.onmessage,O)},onerror:(t=p?.onerror)!==null&&t!==void 0?t:function(O){},onclose:(r=p?.onclose)!==null&&r!==void 0?r:function(O){}},_=this.webSocketFactory.create(c,TZ(o),b);_.connect(),await h;const j=Wn(this.apiClient,e.model),C=HF(this.apiClient,{model:j}),P=bN(this.apiClient,{setup:C});return _.send(JSON.stringify(P)),new CZ(_,this.apiClient)}}class CZ{constructor(e,t){this.conn=e,this.apiClient=t}async setClientContent(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=a9(this.apiClient,e),r=YF(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=o9(this.apiClient,e),r=bN(this.apiClient,t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const t=bN(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(df.PLAY)}pause(){this.sendPlaybackControl(df.PAUSE)}stop(){this.sendPlaybackControl(df.STOP)}resetContext(){this.sendPlaybackControl(df.RESET_CONTEXT)}close(){this.conn.close()}}function TZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function kZ(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const PZ="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function MZ(n,e,t){const r=new I8;let s;if(t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),n.isVertexAI()){const a=A9(n,s);Object.assign(r,a)}else{const a=I9(n,s);Object.assign(r,a)}e(r)}class EZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new NZ(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,s,a,o,l;const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const p=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&NN(e.config.tools)&&CN(p);const x=AZ(p);if(this.apiClient.isVertexAI())h=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x);else{const U=this.apiClient.getApiKey();h=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${U}`}let v=()=>{};const b=new Promise(U=>{v=U}),_=e.callbacks,j=function(){var U;(U=_?.onopen)===null||U===void 0||U.call(_),v({})},C=this.apiClient,P={onopen:j,onmessage:U=>{MZ(C,_.onmessage,U)},onerror:(t=_?.onerror)!==null&&t!==void 0?t:function(U){},onclose:(r=_?.onclose)!==null&&r!==void 0?r:function(U){}},O=this.webSocketFactory.create(h,IZ(x),P);O.connect(),await b;let M=Wn(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&M.startsWith("publishers/")){const U=this.apiClient.getProject(),B=this.apiClient.getLocation();M=`projects/${U}/locations/${B}/`+M}let D={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[mm.AUDIO]}:e.config.responseModalities=[mm.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I=(l=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[],F=[];for(const U of I)if(this.isCallableTool(U)){const B=U;F.push(await B.tool())}else F.push(U);F.length>0&&(e.config.tools=F);const q={model:M,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?D=X7(this.apiClient,q):D=Q7(this.apiClient,q),delete D.config,O.send(JSON.stringify(D)),new OZ(O,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const DZ={turnComplete:!0};class OZ{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=Ea(e,t.turns),e.isVertexAI()?r=r.map(s=>Yf(e,s)):r=r.map(s=>oy(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const a of r){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(PZ)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},DZ),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:i9(this.apiClient,e)}:t={realtimeInput:s9(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function IZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function AZ(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const DM=10;function OM(n){var e,t,r;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const o of(t=n?.tools)!==null&&t!==void 0?t:[])if(ux(o)){s=!0;break}if(!s)return!0;const a=(r=n?.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function ux(n){return"callTool"in n&&typeof n.callTool=="function"}function IM(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class RZ extends Im{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,s,a,o,l;if(t.config&&t.config.tools&&NN(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),CN(t.config.httpOptions.headers)),!_Z(t)||OM(t.config))return await this.generateContentInternal(t);if(jZ(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");const c=await this.transformCallableTools(t);let d,h;const p=Ea(this.apiClient,c.contents),x=(a=(s=(r=c.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&a!==void 0?a:DM;let v=0;for(;v<x&&(d=await this.generateContentInternal(c),!(!d.functionCalls||d.functionCalls.length===0));){const b=d.candidates[0].content,_=[];for(const j of(l=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[])if(ux(j)){const P=await j.callTool(d.functionCalls);_.push(...P)}v++,h={role:"user",parts:_},c.contents=Ea(this.apiClient,c.contents),c.contents.push(b),c.contents.push(h),IM(c.config)&&(p.push(b),p.push(h))}return IM(c.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async t=>{if(t.config&&t.config.tools&&NN(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),CN(t.config.httpOptions.headers)),OM(t.config)){const r=await this.transformCallableTools(t);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var s;let a;const o=[];if(r?.generatedImages)for(const c of r.generatedImages)c&&c?.safetyAttributes&&((s=c?.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?a=c?.safetyAttributes:o.push(c);let l;return a?l={generatedImages:o,positivePromptSafetyAttributes:a}:l={generatedImages:o},l}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new ay(If.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async transformCallableTools(e){var t;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const s=await Promise.all(r.map(async o=>ux(o)?await o.tool():o)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};return a.config.tools=s,a}async initAfcToolsMap(e){var t,r,s;const a=new Map;for(const o of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(ux(o)){const l=o,c=await l.tool();for(const d of(s=c.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(a.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);a.set(d.name,l)}}return a}async processAfcStream(e){var t,r,s;const a=(s=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:DM;let o=!1,l=0;const c=await this.initAfcToolsMap(e);return(function(d,h,p){var x,v;return nm(this,arguments,function*(){for(var b,_,j,C;l<a;){o&&(l++,o=!1);const D=yield Jn(d.transformCallableTools(p)),I=yield Jn(d.generateContentStreamInternal(D)),F=[],q=[];try{for(var P=!0,O=(_=void 0,dx(I)),M;M=yield Jn(O.next()),b=M.done,!b;P=!0){C=M.value,P=!1;const U=C;if(yield yield Jn(U),U.candidates&&(!((x=U.candidates[0])===null||x===void 0)&&x.content)){q.push(U.candidates[0].content);for(const B of(v=U.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(l<a&&B.functionCall){if(!B.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(B.functionCall.name)){const W=yield Jn(h.get(B.functionCall.name).callTool([B.functionCall]));F.push(...W)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${B.functionCall.name}`)}}}}catch(U){_={error:U}}finally{try{!P&&!b&&(j=O.return)&&(yield Jn(j.call(O)))}finally{if(_)throw _.error}}if(F.length>0){o=!0;const U=new jh;U.candidates=[{content:{role:"user",parts:F}}],yield yield Jn(U);const B=[];B.push(...q),B.push({role:"user",parts:F});const W=Ea(d.apiClient,p.contents).concat(B);p.contents=W}else break}})})(this,c,e)}async generateContentInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=TM(this.apiClient,e);return l=Lt("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=PM(this.apiClient,h),x=new jh;return Object.assign(x,p),x})}else{const d=CM(this.apiClient,e);return l=Lt("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=kM(this.apiClient,h),x=new jh;return Object.assign(x,p),x})}}async generateContentStreamInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=TM(this.apiClient,e);l=Lt("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return nm(this,arguments,function*(){var x,v,b,_;try{for(var j=!0,C=dx(p),P;P=yield Jn(C.next()),x=P.done,!x;j=!0){_=P.value,j=!1;const M=PM(h,yield Jn(_.json())),D=new jh;Object.assign(D,M),yield yield Jn(D)}}catch(O){v={error:O}}finally{try{!j&&!x&&(b=C.return)&&(yield Jn(b.call(C)))}finally{if(v)throw v.error}}})})}else{const d=CM(this.apiClient,e);l=Lt("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),o.then(function(p){return nm(this,arguments,function*(){var x,v,b,_;try{for(var j=!0,C=dx(p),P;P=yield Jn(C.next()),x=P.done,!x;j=!0){_=P.value,j=!1;const M=kM(h,yield Jn(_.json())),D=new jh;Object.assign(D,M),yield yield Jn(D)}}catch(O){v={error:O}}finally{try{!j&&!x&&(b=C.return)&&(yield Jn(b.call(C)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=JY(this.apiClient,e);return l=Lt("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=JG(this.apiClient,h),x=new aM;return Object.assign(x,p),x})}else{const d=hY(this.apiClient,e);return l=Lt("{model}:batchEmbedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=MG(this.apiClient,h),x=new aM;return Object.assign(x,p),x})}}async generateImagesInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=XY(this.apiClient,e);return l=Lt("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=XG(this.apiClient,h),x=new oM;return Object.assign(x,p),x})}else{const d=pY(this.apiClient,e);return l=Lt("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=OG(this.apiClient,h),x=new oM;return Object.assign(x,p),x})}}async editImageInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=aG(this.apiClient,e);return a=Lt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=eZ(this.apiClient,c),h=new k8;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=lG(this.apiClient,e);return a=Lt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=tZ(this.apiClient,c),h=new P8;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=cG(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>_N(this.apiClient,h))}else{const d=gY(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>wN(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=uG(this.apiClient,e);return l=Lt("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=iZ(this.apiClient,h),x=new lM;return Object.assign(x,p),x})}else{const d=yY(this.apiClient,e);return l=Lt("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=AG(this.apiClient,h),x=new lM;return Object.assign(x,p),x})}}async update(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=hG(this.apiClient,e);return l=Lt("{model}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>_N(this.apiClient,h))}else{const d=bY(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>wN(this.apiClient,h))}}async delete(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=mG(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=aZ(),p=new cM;return Object.assign(p,h),p})}else{const d=wY(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(()=>{const h=RG(),p=new cM;return Object.assign(p,h),p})}}async countTokens(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=gG(this.apiClient,e);return l=Lt("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=oZ(this.apiClient,h),x=new dM;return Object.assign(x,p),x})}else{const d=jY(this.apiClient,e);return l=Lt("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=LG(this.apiClient,h),x=new dM;return Object.assign(x,p),x})}}async computeTokens(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=xG(this.apiClient,e);return a=Lt("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=lZ(this.apiClient,c),h=new M8;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=vG(this.apiClient,e);return l=Lt("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>fZ(this.apiClient,h))}else{const d=CY(this.apiClient,e);return l=Lt("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>UG(this.apiClient,h))}}}function LZ(n,e){const t={},r=S(e,["operationName"]);r!=null&&N(t,["_url","operationName"],r);const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function FZ(n,e){const t={},r=S(e,["operationName"]);r!=null&&N(t,["_url","operationName"],r);const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function qZ(n,e){const t={},r=S(e,["operationName"]);r!=null&&N(t,["operationName"],r);const s=S(e,["resourceName"]);s!=null&&N(t,["_url","resourceName"],s);const a=S(e,["config"]);return a!=null&&N(t,["config"],a),t}function zZ(n,e){const t={},r=S(e,["video","uri"]);r!=null&&N(t,["uri"],r);const s=S(e,["video","encodedVideo"]);s!=null&&N(t,["videoBytes"],Xc(n,s));const a=S(e,["encoding"]);return a!=null&&N(t,["mimeType"],a),t}function UZ(n,e){const t={},r=S(e,["_self"]);return r!=null&&N(t,["video"],zZ(n,r)),t}function BZ(n,e){const t={},r=S(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>UZ(n,l))),N(t,["generatedVideos"],o)}const s=S(e,["raiMediaFilteredCount"]);s!=null&&N(t,["raiMediaFilteredCount"],s);const a=S(e,["raiMediaFilteredReasons"]);return a!=null&&N(t,["raiMediaFilteredReasons"],a),t}function VZ(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["metadata"]);s!=null&&N(t,["metadata"],s);const a=S(e,["done"]);a!=null&&N(t,["done"],a);const o=S(e,["error"]);o!=null&&N(t,["error"],o);const l=S(e,["response","generateVideoResponse"]);return l!=null&&N(t,["response"],BZ(n,l)),t}function WZ(n,e){const t={},r=S(e,["gcsUri"]);r!=null&&N(t,["uri"],r);const s=S(e,["bytesBase64Encoded"]);s!=null&&N(t,["videoBytes"],Xc(n,s));const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function $Z(n,e){const t={},r=S(e,["_self"]);return r!=null&&N(t,["video"],WZ(n,r)),t}function HZ(n,e){const t={},r=S(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>$Z(n,l))),N(t,["generatedVideos"],o)}const s=S(e,["raiMediaFilteredCount"]);s!=null&&N(t,["raiMediaFilteredCount"],s);const a=S(e,["raiMediaFilteredReasons"]);return a!=null&&N(t,["raiMediaFilteredReasons"],a),t}function AM(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["metadata"]);s!=null&&N(t,["metadata"],s);const a=S(e,["done"]);a!=null&&N(t,["done"],a);const o=S(e,["error"]);o!=null&&N(t,["error"],o);const l=S(e,["response"]);return l!=null&&N(t,["response"],HZ(n,l)),t}class YZ extends Im{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;return r&&"httpOptions"in r&&(a=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=FZ(this.apiClient,e);return l=Lt("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>AM(this.apiClient,h))}else{const d=LZ(this.apiClient,e);return l=Lt("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>VZ(this.apiClient,h))}}async fetchPredictVideosOperationInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=qZ(this.apiClient,e);return a=Lt("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>AM(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}function GZ(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],r);const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function ZZ(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);t!==void 0&&a!=null&&N(t,["_query","pageToken"],a);const o=S(e,["filter"]);return t!==void 0&&o!=null&&N(t,["_query","filter"],o),r}function KZ(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],ZZ(n,r,t)),t}function JZ(n,e){const t={},r=S(e,["textInput"]);r!=null&&N(t,["textInput"],r);const s=S(e,["output"]);return s!=null&&N(t,["output"],s),t}function QZ(n,e){const t={};if(S(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=S(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>JZ(n,a))),N(t,["examples","examples"],s)}return t}function XZ(n,e,t){const r={};if(S(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=S(e,["tunedModelDisplayName"]);if(t!==void 0&&s!=null&&N(t,["displayName"],s),S(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=S(e,["epochCount"]);t!==void 0&&a!=null&&N(t,["tuningTask","hyperparameters","epochCount"],a);const o=S(e,["learningRateMultiplier"]);if(o!=null&&N(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),S(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(S(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=S(e,["batchSize"]);t!==void 0&&l!=null&&N(t,["tuningTask","hyperparameters","batchSize"],l);const c=S(e,["learningRate"]);return t!==void 0&&c!=null&&N(t,["tuningTask","hyperparameters","learningRate"],c),r}function eK(n,e){const t={},r=S(e,["baseModel"]);r!=null&&N(t,["baseModel"],r);const s=S(e,["trainingDataset"]);s!=null&&N(t,["tuningTask","trainingData"],QZ(n,s));const a=S(e,["config"]);return a!=null&&N(t,["config"],XZ(n,a,t)),t}function tK(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],r);const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function nK(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);t!==void 0&&a!=null&&N(t,["_query","pageToken"],a);const o=S(e,["filter"]);return t!==void 0&&o!=null&&N(t,["_query","filter"],o),r}function rK(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],nK(n,r,t)),t}function sK(n,e,t){const r={},s=S(e,["gcsUri"]);if(t!==void 0&&s!=null&&N(t,["supervisedTuningSpec","trainingDatasetUri"],s),S(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function iK(n,e){const t={},r=S(e,["gcsUri"]);return r!=null&&N(t,["validationDatasetUri"],r),t}function aK(n,e,t){const r={},s=S(e,["validationDataset"]);t!==void 0&&s!=null&&N(t,["supervisedTuningSpec"],iK(n,s));const a=S(e,["tunedModelDisplayName"]);t!==void 0&&a!=null&&N(t,["tunedModelDisplayName"],a);const o=S(e,["description"]);t!==void 0&&o!=null&&N(t,["description"],o);const l=S(e,["epochCount"]);t!==void 0&&l!=null&&N(t,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=S(e,["learningRateMultiplier"]);t!==void 0&&c!=null&&N(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=S(e,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&N(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=S(e,["adapterSize"]);if(t!==void 0&&h!=null&&N(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),S(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(S(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function oK(n,e){const t={},r=S(e,["baseModel"]);r!=null&&N(t,["baseModel"],r);const s=S(e,["trainingDataset"]);s!=null&&N(t,["supervisedTuningSpec","trainingDatasetUri"],sK(n,s,t));const a=S(e,["config"]);return a!=null&&N(t,["config"],aK(n,a,t)),t}function lK(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["model"],r);const s=S(e,["name"]);return s!=null&&N(t,["endpoint"],s),t}function XF(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["state"]);s!=null&&N(t,["state"],FF(n,s));const a=S(e,["createTime"]);a!=null&&N(t,["createTime"],a);const o=S(e,["tuningTask","startTime"]);o!=null&&N(t,["startTime"],o);const l=S(e,["tuningTask","completeTime"]);l!=null&&N(t,["endTime"],l);const c=S(e,["updateTime"]);c!=null&&N(t,["updateTime"],c);const d=S(e,["description"]);d!=null&&N(t,["description"],d);const h=S(e,["baseModel"]);h!=null&&N(t,["baseModel"],h);const p=S(e,["_self"]);p!=null&&N(t,["tunedModel"],lK(n,p));const x=S(e,["distillationSpec"]);x!=null&&N(t,["distillationSpec"],x);const v=S(e,["experiment"]);v!=null&&N(t,["experiment"],v);const b=S(e,["labels"]);b!=null&&N(t,["labels"],b);const _=S(e,["pipelineJob"]);_!=null&&N(t,["pipelineJob"],_);const j=S(e,["tunedModelDisplayName"]);return j!=null&&N(t,["tunedModelDisplayName"],j),t}function cK(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["tunedModels"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>XF(n,o))),N(t,["tuningJobs"],a)}return t}function dK(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["metadata"]);s!=null&&N(t,["metadata"],s);const a=S(e,["done"]);a!=null&&N(t,["done"],a);const o=S(e,["error"]);return o!=null&&N(t,["error"],o),t}function uK(n,e){const t={},r=S(e,["checkpointId"]);r!=null&&N(t,["checkpointId"],r);const s=S(e,["epoch"]);s!=null&&N(t,["epoch"],s);const a=S(e,["step"]);a!=null&&N(t,["step"],a);const o=S(e,["endpoint"]);return o!=null&&N(t,["endpoint"],o),t}function fK(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["model"],r);const s=S(e,["endpoint"]);s!=null&&N(t,["endpoint"],s);const a=S(e,["checkpoints"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>uK(n,l))),N(t,["checkpoints"],o)}return t}function TN(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["state"]);s!=null&&N(t,["state"],FF(n,s));const a=S(e,["createTime"]);a!=null&&N(t,["createTime"],a);const o=S(e,["startTime"]);o!=null&&N(t,["startTime"],o);const l=S(e,["endTime"]);l!=null&&N(t,["endTime"],l);const c=S(e,["updateTime"]);c!=null&&N(t,["updateTime"],c);const d=S(e,["error"]);d!=null&&N(t,["error"],d);const h=S(e,["description"]);h!=null&&N(t,["description"],h);const p=S(e,["baseModel"]);p!=null&&N(t,["baseModel"],p);const x=S(e,["tunedModel"]);x!=null&&N(t,["tunedModel"],fK(n,x));const v=S(e,["supervisedTuningSpec"]);v!=null&&N(t,["supervisedTuningSpec"],v);const b=S(e,["tuningDataStats"]);b!=null&&N(t,["tuningDataStats"],b);const _=S(e,["encryptionSpec"]);_!=null&&N(t,["encryptionSpec"],_);const j=S(e,["partnerModelTuningSpec"]);j!=null&&N(t,["partnerModelTuningSpec"],j);const C=S(e,["distillationSpec"]);C!=null&&N(t,["distillationSpec"],C);const P=S(e,["experiment"]);P!=null&&N(t,["experiment"],P);const O=S(e,["labels"]);O!=null&&N(t,["labels"],O);const M=S(e,["pipelineJob"]);M!=null&&N(t,["pipelineJob"],M);const D=S(e,["tunedModelDisplayName"]);return D!=null&&N(t,["tunedModelDisplayName"],D),t}function hK(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["tuningJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>TN(n,o))),N(t,["tuningJobs"],a)}return t}class mK extends Im{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new ay(If.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:gN.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=tK(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>TN(this.apiClient,h))}else{const d=GZ(this.apiClient,e);return l=Lt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>XF(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=rK(this.apiClient,e);return l=Lt("tuningJobs",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=hK(this.apiClient,h),x=new uM;return Object.assign(x,p),x})}else{const d=KZ(this.apiClient,e);return l=Lt("tunedModels",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=cK(this.apiClient,h),x=new uM;return Object.assign(x,p),x})}}async tuneInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=oK(this.apiClient,e);return a=Lt("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>TN(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=eK(this.apiClient,e);return a=Lt("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>dK(this.apiClient,c))}}}class pK{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const gK=1024*1024*8,xK=3,yK=1e3,vK=2,pb="x-goog-upload-status";async function bK(n,e,t){var r,s,a;let o=0,l=0,c=new xN(new Response),d="upload";for(o=n.size;l<o;){const p=Math.min(gK,o-l),x=n.slice(l,l+p);l+p>=o&&(d+=", finalize");let v=0,b=yK;for(;v<xK&&(c=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(p)}}}),!(!((r=c?.headers)===null||r===void 0)&&r[pb]));)v++,await _K(b),b=b*vK;if(l+=p,((s=c?.headers)===null||s===void 0?void 0:s[pb])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await c?.json();if(((a=c?.headers)===null||a===void 0?void 0:a[pb])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function wK(n){return{size:n.size,type:n.type}}function _K(n){return new Promise(e=>setTimeout(e,n))}class jK{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await bK(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await wK(e)}}class SK{create(e,t,r){return new NK(e,t,r)}}class NK{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const RM="x-goog-api-key";class CK{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(RM)===null&&e.append(RM,this.apiKey)}}const TK="gl-node/";class kK{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=T8(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new CK(this.apiKey);this.apiClient=new bZ({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:TK+"web",uploader:new jK,downloader:new pK}),this.models=new RZ(this.apiClient),this.live=new EZ(this.apiClient,s,new SK),this.chats=new HH(this.models,this.apiClient),this.caches=new VH(this.apiClient),this.files=new i7(this.apiClient),this.operations=new YZ(this.apiClient),this.tunings=new mK(this.apiClient)}}const pm="onboarding-documents",kN="avatars",LM="support-attachments",Sh="logo",Nh="background",PK="task-attachments",MK="your-google-genai-api-key";let pl=null;pl=new kK({apiKey:MK});const PN=n=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(PN);const e={...n};if(typeof e.name=="string"&&typeof e.path=="string"){const t=e.path.startsWith("avatars/")?kN:pm,{data:{publicUrl:r}}=Ee.storage.from(t).getPublicUrl(e.path);e.preview=r,e.url=r}for(const t in e)e[t]=PN(e[t]);return e},MN=async(n,e,t)=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return Promise.all(n.map(s=>MN(s,e,t)));const r={...n};if(r.file instanceof File){const s=r.file,a=`${e}/documents/${Date.now()}_${s.name}`,{error:o}=await Ee.storage.from(pm).upload(a,s);if(o)throw o;try{await Ee.from("user_documents").insert({user_id:e,submission_id:t||null,name:r.name||s.name,bucket:pm,path:a,file_type:s.type,file_size:s.size})}catch(l){console.error("Failed to record uploaded document:",l)}return{name:r.name||s.name,type:s.type,size:s.size,path:a}}if(typeof r.name=="string"&&r.path)return{name:r.name,type:r.type,size:r.size,path:r.path};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(r[s]=await MN(r[s],e,t));return r},EK=async n=>await(await fetch(n)).blob(),hn=n=>{if(Array.isArray(n))return n.map(e=>hn(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)&&!(n instanceof File)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/[A-Z]/g,s=>`_${s.toLowerCase()}`);e[r]=hn(n[t])}return e}return n},xt=n=>{if(Array.isArray(n))return n.map(e=>xt(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/_([a-z])/g,s=>s[1].toUpperCase());e[r]=xt(n[t])}return PN(e)}return n},ce={getInitialAppData:async()=>{const{data:n,error:e}=await Ee.from("settings").select("*").eq("id","singleton").single();if(e)throw new Error("Failed to fetch core application settings.");const{data:t,error:r}=await Ee.from("roles").select("*");if(r)throw new Error("Failed to fetch user roles.");const{data:s,error:a}=await Ee.from("holidays").select("*");if(a)throw new Error("Failed to fetch holidays.");return{settings:xt(n),roles:(t||[]).map(xt),holidays:(s||[]).map(xt)}},updateSettings:async n=>{const{error:e}=await Ee.from("settings").update(hn(n)).eq("id","singleton");if(e)throw e},getVerificationSubmissions:async(n,e)=>{let t=Ee.from("onboarding_submissions").select("*");n&&(t=t.eq("status",n)),e&&(t=t.eq("organization_id",e));const{data:r,error:s}=await t.order("created_at",{ascending:!1});if(s)throw s;return(r||[]).map(xt)},getOnboardingDataById:async n=>{const{data:e,error:t}=await Ee.from("onboarding_submissions").select("*").eq("id",n).single();if(t&&t.code!=="PGRST116")throw t;return e?xt(e):null},_saveSubmission:async(n,e)=>{const{data:{session:t}}=await Ee.auth.getSession();if(!t?.user)throw new Error("User not authenticated");const r=n.id&&!n.id.startsWith("draft_")?n.id:crypto.randomUUID(),s=await MN(n,t.user.id,r),a={...hn(s),id:r,user_id:t.user.id,status:e?"draft":n.status};delete a.file,delete a.confirm_account_number;const{data:o,error:l}=await Ee.from("onboarding_submissions").upsert(a,{onConflict:"id"}).select("id").single();if(l)throw l;return{draftId:o.id}},saveDraft:async n=>ce._saveSubmission(n,!0),submitOnboarding:async n=>{const{draftId:e}=await ce._saveSubmission(n,!1),t=await ce.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve submitted data.");return t},updateOnboarding:async n=>{const{draftId:e}=await ce._saveSubmission(n,n.status==="draft"),t=await ce.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve updated data.");return t},verifySubmission:async n=>{const{error:e}=await Ee.from("onboarding_submissions").update({status:"verified",portal_sync_status:"pending_sync"}).eq("id",n);if(e)throw e},requestChanges:async(n,e)=>{const{error:t}=await Ee.from("onboarding_submissions").update({status:"rejected"}).eq("id",n);if(t)throw t},syncPortals:async n=>{const{data:e,error:t}=await Ee.functions.invoke("sync-portals",{body:{submissionId:n}});if(t)throw t;return xt(e)},deleteFile:async n=>{const{error:e}=await Ee.storage.from(pm).remove([n]);if(e)throw e},uploadDocument:async(n,e=pm,t,r)=>{const{data:{session:s}}=await Ee.auth.getSession(),a=s?.user?.id||"anonymous_user",o=`${a}/documents/${Date.now()}_${n.name}`,{error:l}=await Ee.storage.from(e).upload(o,n);if(l)throw l;const{data:c}=Ee.storage.from(e).getPublicUrl(o);if(!c.publicUrl)throw new Error("Could not get public URL for uploaded file.");try{await Ee.from("user_documents").insert({user_id:a,submission_id:t||null,name:r||n.name,bucket:e,path:o,file_type:n.type,file_size:n.size})}catch(d){console.error("Failed to insert user_documents record:",d)}return{url:c.publicUrl,path:o}},getUsers:async()=>{const{data:n,error:e}=await Ee.from("users").select("*, role_id");if(e)throw e;return(n||[]).map(t=>xt({...t,role:t.role_id}))},getUsersWithManagers:async()=>{const{data:n,error:e}=await Ee.from("users").select("*, reporting_manager_id, role_id");if(e)throw e;const t=(n||[]).map(s=>xt({...s,role:s.role_id})),r=new Map(t.map(s=>[s.id,s.name]));return t.map(s=>({...s,managerName:s.reportingManagerId?r.get(s.reportingManagerId):void 0}))},getFieldOfficers:async()=>ce.getUsers().then(n=>n.filter(e=>e.role==="field_officer")),getNearbyUsers:async()=>{const n=await ce.getUsers();let e={};try{const t=new Date;t.setHours(0,0,0,0);const r=new Date,s=await ce.getAllAttendanceEvents(t.toISOString(),r.toISOString()),a={};s.forEach(o=>{const{userId:l,type:c,timestamp:d}=o;l&&(!a[l]||new Date(d)>new Date(a[l].timestamp))&&(a[l]={type:c.toLowerCase(),timestamp:d})}),e=Object.fromEntries(Object.entries(a).map(([o,l])=>{const c=l.type.toLowerCase().replace(/[-_\s]/g,""),d=c==="checkin";return console.log(`User ${o}: latest event type = "${l.type}", normalized = "${c}", isCheckIn = ${d}`),[o,d]}))}catch(t){console.warn("Failed to compute user availability:",t)}return n.map(t=>({...t,isAvailable:e[t.id]??!1}))},updateUser:async(n,e)=>{const{role:t,...r}=e,s=hn(r);if(t&&(s.role_id=t),"photo_url"in s){const{data:{session:l}}=await Ee.auth.getSession();if(!l?.user)throw new Error("User not authenticated for photo upload");const c=l.user.id,{data:d}=await Ee.from("users").select("photo_url").eq("id",n).single(),h=d?.photo_url,p=async x=>{if(x)try{const b=new URL(x).pathname.split("/public/")[1];if(b){const[_,...j]=b.split("/"),C=j.join("/");C&&await Ee.storage.from(_).remove([C])}}catch(v){console.error("Failed to process old avatar URL for deletion:",v)}};if(s.photo_url&&s.photo_url.startsWith("data:")){await p(h);const x=await EK(s.photo_url),v=s.photo_url.split(";")[0].split("/")[1]||"jpg",b=`${c}/${Date.now()}.${v}`,{error:_}=await Ee.storage.from(kN).upload(b,x,{upsert:!0});if(_)throw _;const{data:{publicUrl:j}}=Ee.storage.from(kN).getPublicUrl(b);s.photo_url=j}else s.photo_url===null&&await p(h)}const{data:a,error:o}=await Ee.from("users").update(s).eq("id",n).select().single();if(o)throw o;return xt({...a,role:a.role_id})},createUser:async n=>{const{role:e,...t}=n,r=hn(t);e&&(r.role_id=e);const{data:s,error:a}=await Ee.from("users").insert(r).select().single();if(a)throw a;return xt({...s,role:s.role_id})},deleteUser:async n=>{const{error:e}=await Ee.from("users").delete().eq("id",n);if(e)throw e},updateUserReportingManager:async(n,e)=>{const{error:t}=await Ee.from("users").update({reporting_manager_id:e}).eq("id",n);if(t)throw t},getOrganizations:async()=>{const{data:n,error:e}=await Ee.from("organizations").select("*").order("short_name");if(e)throw e;return(n||[]).map(xt)},createOrganization:async n=>{const{data:e,error:t}=await Ee.from("organizations").insert(hn(n)).select().single();if(t)throw t;return xt(e)},getOrganizationStructure:async()=>{const{data:n,error:e}=await Ee.from("organization_groups").select("*");if(e)throw e;const{data:t,error:r}=await Ee.from("companies").select("*");if(r)throw r;const{data:s,error:a}=await Ee.from("entities").select("*");if(a)throw a;const o=(n||[]).map(xt),l=(t||[]).map(xt),c=(s||[]).map(xt),d=new Map;return l.forEach(h=>{const p={...h,entities:c.filter(x=>x.companyId===h.id)};d.has(h.groupId)||d.set(h.groupId,[]),d.get(h.groupId).push(p)}),o.map(h=>({...h,companies:d.get(h.id)||[],locations:[]}))},getSiteConfigurations:async()=>{const{data:n,error:e}=await Ee.from("site_configurations").select("*");if(e)throw e;return(n||[]).map(xt)},bulkUploadOrganizations:async n=>{const{count:e,error:t}=await Ee.from("organizations").upsert(hn(n),{onConflict:"id"});if(t)throw t;return{count:e||0}},getModules:async()=>{const{data:n,error:e}=await Ee.from("app_modules").select("*");if(e)throw e;return(n||[]).map(xt)},saveModules:async n=>{const{error:e}=await Ee.from("app_modules").upsert(hn(n));if(e)throw e},getRoles:async()=>{const{data:n,error:e}=await Ee.from("roles").select("*");if(e)throw e;return(n||[]).map(xt)},saveRoles:async n=>{const{error:e}=await Ee.from("roles").upsert(hn(n));if(e)throw e},getHolidays:async()=>{const{data:n,error:e}=await Ee.from("holidays").select("*");if(e)throw e;return(n||[]).map(xt)},addHoliday:async n=>{const{data:e,error:t}=await Ee.from("holidays").insert(hn(n)).select().single();if(t)throw t;return xt(e)},removeHoliday:async n=>{const{error:e}=await Ee.from("holidays").delete().eq("id",n);if(e)throw e},getAttendanceEvents:async(n,e,t)=>{const{data:r,error:s}=await Ee.from("attendance_events").select("*").eq("user_id",n).gte("timestamp",e).lte("timestamp",t);if(s)throw s;return(r||[]).map(xt)},getAllAttendanceEvents:async(n,e)=>{const{data:t,error:r}=await Ee.from("attendance_events").select("*").gte("timestamp",n).lte("timestamp",e);if(r)throw r;return(t||[]).map(xt)},getAttendanceDashboardData:async(n,e,t,r="UTC")=>{const{data:s,error:a}=await Ee.rpc("get_attendance_dashboard_data",{start_date_iso:We(n,"yyyy-MM-dd"),end_date_iso:We(e,"yyyy-MM-dd"),current_date_iso:We(t,"yyyy-MM-dd"),p_timezone:r});if(a)throw new Error("Could not load attendance dashboard data from the database function.");return s},addAttendanceEvent:async n=>{const{error:e}=await Ee.from("attendance_events").insert(hn(n));if(e)throw e},getLocations:async()=>{const{data:n,error:e}=await Ee.from("locations").select("*, created_by_user:created_by (id, name)");if(e)throw e;return(n||[]).map(t=>{const r=xt(t),a=r.createdByUser?.name||void 0,{createdByUser:o,...l}=r;return{...l,createdByName:a}})},getUserLocations:async n=>{const{data:e,error:t}=await Ee.from("user_locations").select("location_id:location_id (*), id").eq("user_id",n);if(t)throw t;return(e||[]).map(r=>{const s=r.location_id||{};return xt(s)})},createLocation:async n=>{const e=hn(n),{data:t,error:r}=await Ee.from("locations").insert(e).select("*").single();if(r)throw r;return xt(t)},assignLocationToUser:async(n,e)=>{const{error:t}=await Ee.from("user_locations").insert({user_id:n,location_id:e});if(t)throw t},updateLocation:async(n,e)=>{const t=hn(e),{data:r,error:s}=await Ee.from("locations").update(t).eq("id",n).select("*").single();if(s)throw s;return xt(r)},deleteLocation:async n=>{const{error:e}=await Ee.from("locations").delete().eq("id",n);if(e)throw e},unassignLocationFromUser:async(n,e)=>{const{error:t}=await Ee.from("user_locations").delete().match({user_id:n,location_id:e});if(t)throw t},uploadLogo:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await Ee.storage.from(Sh).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:s}}=Ee.storage.from(Sh).getPublicUrl(t);return s},getLogos:async()=>{const{data:n,error:e}=await Ee.storage.from(Sh).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=Ee.storage.from(Sh).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteLogo:async n=>{const{error:e}=await Ee.storage.from(Sh).remove([n]);if(e)throw e},uploadBackground:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await Ee.storage.from(Nh).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:s}}=Ee.storage.from(Nh).getPublicUrl(t);return s},getBackgroundImages:async()=>{const{data:n,error:e}=await Ee.storage.from(Nh).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=Ee.storage.from(Nh).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteBackground:async n=>{const{error:e}=await Ee.storage.from(Nh).remove([n]);if(e)throw e},getAttendanceSettings:async()=>{const{data:n,error:e}=await Ee.from("settings").select("attendance_settings").eq("id","singleton").single();if(e)throw e;if(!n?.attendance_settings)throw new Error("Attendance settings are not configured.");return xt(n.attendance_settings)},saveAttendanceSettings:async n=>{const{error:e}=await Ee.from("settings").upsert({id:"singleton",attendance_settings:hn(n),updated_at:new Date().toISOString()},{onConflict:"id"});if(e)throw console.error("Error saving attendance settings:",e),e},getRecurringHolidays:async()=>{const{data:n,error:e}=await Ee.from("recurring_holidays").select("*");if(e)throw e;return(n||[]).map(t=>({id:t.id,type:t.role_type,day:t.day,n:t.occurrence}))},addRecurringHoliday:async n=>{const e={role_type:n.type||"office",day:n.day,occurrence:n.n},{data:t,error:r}=await Ee.from("recurring_holidays").insert(e).select().single();if(r)throw r;return{id:t.id,type:t.role_type,day:t.day,n:t.occurrence}},deleteRecurringHoliday:async n=>{const{error:e}=await Ee.from("recurring_holidays").delete().eq("id",n);if(e)throw e},createAssignment:async(n,e,t)=>{const r=(await ce.getOrganizations()).find(s=>s.id===e);await ce.createTask({name:`Visit ${r?.shortName||"site"} for verification`,description:`Perform on-site duties and verification tasks for ${r?.shortName}.`,dueDate:t,priority:"Medium",assignedToId:n})},getLeaveBalancesForUser:async n=>{const e=_=>["hr","admin","finance"].includes(_)?"office":"field",{data:t,error:r}=await Ee.from("settings").select("attendance_settings").eq("id","singleton").single();if(r||!t?.attendance_settings)throw new Error("Could not load attendance rules.");const{data:s,error:a}=await Ee.from("users").select("role_id").eq("id",n).single();if(a)throw a;const o=e(s.role_id),l=xt(t.attendance_settings)[o],[{data:c,error:d},{data:h,error:p},{data:x,error:v}]=await Promise.all([Ee.from("leave_requests").select("leave_type, start_date, end_date, day_option").eq("user_id",n).eq("status","approved"),Ee.from("comp_off_logs").select("*").eq("user_id",n),Ee.from("extra_work_logs").select("hours_worked").eq("user_id",n).eq("claim_type","OT").eq("status","Approved").gte("work_date",We(vi(new Date),"yyyy-MM-dd")).lte("work_date",We(Ma(new Date),"yyyy-MM-dd"))]);if(d||p||v)throw new Error("Failed to fetch all leave balance data.");const b={userId:n,earnedTotal:l.annualEarnedLeaves||0,earnedUsed:0,sickTotal:l.annualSickLeaves||0,sickUsed:0,floatingTotal:(l.monthlyFloatingLeaves||0)*12,floatingUsed:0,compOffTotal:(h||[]).length,compOffUsed:(h||[]).filter(_=>_.status==="used").length,otHoursThisMonth:(x||[]).reduce((_,j)=>_+(j.hours_worked||0),0)};return(c||[]).forEach(_=>{const j=_.day_option==="half"?.5:Om(new Date(_.end_date),new Date(_.start_date))+1;_.leave_type==="Earned"&&(b.earnedUsed+=j),_.leave_type==="Sick"&&(b.sickUsed+=j),_.leave_type==="Floating"&&(b.floatingUsed+=j)}),b},submitLeaveRequest:async n=>{const{data:e,error:t}=await Ee.from("users").select("reporting_manager_id").eq("id",n.userId).single();if(t)throw t;const{data:r,error:s}=await Ee.from("leave_requests").insert({...hn(n),status:"pending_manager_approval",current_approver_id:e.reporting_manager_id||null,approval_history:[]}).select("*").single();if(s)throw s;return xt(r)},getLeaveRequests:async n=>{let e=Ee.from("leave_requests").select("*");n?.userId&&(e=e.eq("user_id",n.userId)),n?.userIds&&(e=e.in("user_id",n.userIds)),n?.status&&(e=e.eq("status",n.status)),n?.forApproverId&&(e=e.eq("current_approver_id",n.forApproverId)),n?.startDate&&n?.endDate&&(e=e.lte("start_date",n.endDate).gte("end_date",n.startDate));const{data:t,error:r}=await e.order("start_date",{ascending:!1});if(r)throw r;return(t||[]).map(xt)},getTasks:async()=>{const{data:n,error:e}=await Ee.from("tasks").select("*").order("created_at",{ascending:!1});if(e)throw e;return(n||[]).map(xt)},createTask:async n=>{const{data:e,error:t}=await Ee.from("tasks").insert(hn({...n,status:"To Do",escalationStatus:"None"})).select().single();if(t)throw t;return xt(e)},updateTask:async(n,e)=>{if(e?.completionPhoto&&e.completionPhoto.file){const s=e.completionPhoto,a=s.file;try{const{path:o}=await ce.uploadDocument(a,PK);e.completionPhoto={name:s.name,type:s.type,size:s.size,path:o}}catch(o){console.error("Failed to upload task completion photo:",o),delete e.completionPhoto}}const{data:t,error:r}=await Ee.from("tasks").update(hn(e)).eq("id",n).select().single();if(r)throw r;return xt(t)},deleteTask:async n=>{const{error:e}=await Ee.from("tasks").delete().eq("id",n);if(e)throw e},runAutomaticEscalations:async()=>{const{data:n,error:e}=await Ee.functions.invoke("run-escalations");if(e)throw e;return xt(n)},getNotifications:async n=>{const{data:e,error:t}=await Ee.from("notifications").select("*").eq("user_id",n).order("created_at",{ascending:!1});if(t)throw t;return(e||[]).map(xt)},createNotification:async n=>{const{data:e,error:t}=await Ee.from("notifications").insert(hn(n)).select().single();if(t)throw t;return xt(e)},markNotificationAsRead:async n=>{await Ee.from("notifications").update({is_read:!0}).eq("id",n)},markAllNotificationsAsRead:async n=>{await Ee.from("notifications").update({is_read:!0}).eq("user_id",n).eq("is_read",!1)},createAuthUser:async n=>{const{name:e,email:t,password:r,role:s}=n;try{const{error:a}=await Ee.functions.invoke("admin-create-user",{body:{name:e,email:t,password:r,role:s}});if(a)throw a;const l=(await ce.getUsers()).find(c=>c.email===t);if(l)return l;console.warn("admin-create-user completed but user not found; falling back to client side signup")}catch(a){const o=typeof a?.message=="string"?a.message:String(a);if(!o.toLowerCase().includes("failed to send a request")&&!o.toLowerCase().includes("edge function"))throw a;console.warn("Edge function not reachable, falling back to client side signup");const{data:l,error:c}=await Ee.auth.signUp({email:t,password:r,options:{data:{name:e}}});if(c||!l?.user)throw c||new Error("Failed to sign up user");const d=l.user;try{await Ee.from("users").upsert({id:d.id,name:e,email:t,role_id:s},{onConflict:"id"})}catch(h){console.warn("Failed to upsert user profile after fallback signup:",h)}return{id:d.id,name:e,email:t,role:s,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}}return{id:"",name:e,email:t,role:s,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}},getPolicies:async()=>{const{data:n,error:e}=await Ee.from("policies").select("*");if(e)throw e;return(n||[]).map(xt)},createPolicy:async n=>{const{data:e,error:t}=await Ee.from("policies").insert(hn(n)).select().single();if(t)throw t;return xt(e)},getInsurances:async()=>{const{data:n,error:e}=await Ee.from("insurances").select("*");if(e)throw e;return(n||[]).map(xt)},createInsurance:async n=>{const{data:e,error:t}=await Ee.from("insurances").insert(hn(n)).select().single();if(t)throw t;return xt(e)},getApprovalWorkflowSettings:async()=>{const{data:n,error:e}=await Ee.from("settings").select("approval_workflow_settings").eq("id","singleton").single();if(e)throw e;if(!n?.approval_workflow_settings)throw new Error("Approval workflow settings are not configured.");return xt(n.approval_workflow_settings)},updateApprovalWorkflowSettings:async n=>{const{error:e}=await Ee.from("settings").update({approval_workflow_settings:hn({finalConfirmationRole:n})}).eq("id","singleton");if(e)throw e},approveLeaveRequest:async(n,e)=>{const{data:t,error:r}=await Ee.from("leave_requests").select("approval_history").eq("id",n).single();if(r)throw r;const{finalConfirmationRole:s}=await ce.getApprovalWorkflowSettings(),{data:a}=await Ee.from("users").select("id").eq("role_id",s).limit(1).single(),{data:o,error:l}=await Ee.from("users").select("name").eq("id",e).single();if(l)throw l;const c={approver_id:e,approver_name:o.name,status:"approved",timestamp:new Date().toISOString()},d=[...t.approval_history||[],c],{error:h}=await Ee.from("leave_requests").update({status:"pending_hr_confirmation",current_approver_id:a?.id,approval_history:d}).eq("id",n);if(h)throw h},rejectLeaveRequest:async(n,e,t="")=>{const{data:r,error:s}=await Ee.from("leave_requests").select("approval_history").eq("id",n).single();if(s)throw s;const{data:a,error:o}=await Ee.from("users").select("name").eq("id",e).single();if(o)throw o;const l={approver_id:e,approver_name:a.name,status:"rejected",timestamp:new Date().toISOString(),comments:t},c=[...r.approval_history||[],l],{error:d}=await Ee.from("leave_requests").update({status:"rejected",current_approver_id:null,approval_history:c}).eq("id",n);if(d)throw d},confirmLeaveByHR:async(n,e)=>{const{data:t,error:r}=await Ee.from("leave_requests").select("leave_type, user_id, approval_history").eq("id",n).single();if(r)throw r;const{data:s,error:a}=await Ee.from("users").select("name").eq("id",e).single();if(a)throw a;const o={approver_id:e,approver_name:s.name,status:"approved",timestamp:new Date().toISOString(),comments:"Final approval."},l=[...t.approval_history||[],o],{error:c}=await Ee.from("leave_requests").update({status:"approved",current_approver_id:null,approval_history:l}).eq("id",n);if(c)throw c;if(t.leave_type==="Comp Off"){const{data:d,error:h}=await Ee.from("comp_off_logs").select("id").eq("user_id",t.user_id).eq("status","earned").limit(1).single();if(h&&h.code!=="PGRST116")throw h;d&&await Ee.from("comp_off_logs").update({status:"used",leave_request_id:n}).eq("id",d.id)}},submitExtraWorkClaim:async n=>{const{error:e}=await Ee.from("extra_work_logs").insert(hn({...n,status:"Pending"}));if(e)throw e},getExtraWorkLogs:async n=>{let e=Ee.from("extra_work_logs").select("*");n?e=e.eq("user_id",n):e=e.eq("status","Pending");const{data:t,error:r}=await e.order("work_date",{ascending:!1});if(r)throw r;return(t||[]).map(xt)},approveExtraWorkClaim:async(n,e)=>{const{data:t,error:r}=await Ee.from("users").select("name").eq("id",e).single();if(r)throw r;const{data:s,error:a}=await Ee.from("extra_work_logs").select("*").eq("id",n).single();if(a)throw a;if(!s)throw new Error("Claim not found.");const{error:o}=await Ee.from("extra_work_logs").update({status:"Approved",approver_id:e,approver_name:t.name,approved_at:new Date().toISOString()}).eq("id",n);if(o)throw o;s.claim_type==="Comp Off"&&await ce.addCompOffLog({userId:s.user_id,userName:s.user_name,dateEarned:s.work_date,reason:`Claim approved: ${s.reason}`,status:"earned",grantedById:e,grantedByName:t.name})},rejectExtraWorkClaim:async(n,e,t)=>{const{data:r,error:s}=await Ee.from("users").select("name").eq("id",e).single();if(s)throw s;const{error:a}=await Ee.from("extra_work_logs").update({status:"Rejected",approver_id:e,approver_name:r.name,rejection_reason:t}).eq("id",n);if(a)throw a},getManpowerDetails:async n=>{const{data:e,error:t}=await Ee.rpc("get_manpower_details",{site_id_param:n});if(t)throw t;return xt(e)},addCompOffLog:async n=>{const{data:e,error:t}=await Ee.from("comp_off_logs").insert(hn(n)).select().single();if(t)throw t;return xt(e)},exportAllData:async()=>{const n=["users","organizations","onboarding_submissions","settings"],e={};for(const t of n){const{data:r,error:s}=await Ee.from(t).select("*");if(s)throw new Error(`Failed to export ${t}`);e[t]=r}return xt(e)},getPincodeDetails:async n=>new Promise(e=>setTimeout(()=>e({city:"Bengaluru",state:"Karnataka"}),500)),suggestDepartmentForDesignation:async n=>{const e={"Security Guard":"Security","Housekeeping Staff":"Housekeeping","Site Manager":"Management"},t=Object.keys(e).find(r=>n.toLowerCase().includes(r.toLowerCase()));return Promise.resolve(t?e[t]:null)},verifyBankAccountWithPerfios:async n=>{console.log("Mock verifying bank account:",n),await new Promise(t=>setTimeout(t,1500));const e=Math.random()>.1;return{success:e,message:e?"Bank account verified successfully.":"Account holder name did not match.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:e,uan:null,esi:null,accountHolderName:e,accountNumber:e,ifscCode:!0}}},verifyAadhaar:async n=>{console.log("Mock verifying Aadhaar:",n),await new Promise(t=>setTimeout(t,1e3));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"Aadhaar details verified.":"Invalid Aadhaar number.",verifiedFields:{name:null,dob:null,aadhaar:e,bank:null,uan:null,esi:null}}},lookupUan:async n=>{console.log("Mock looking up UAN:",n),await new Promise(t=>setTimeout(t,1200));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"UAN found and linked.":"UAN not found in EPFO database.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:null,uan:e,esi:null}}},extractDataFromImage:async(n,e,t,r)=>{if(!pl)return console.warn("AI feature disabled: cannot extract data from image. Returning empty result."),{};const a=(await pl.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:`Extract the structured data from this document image. It is a ${r||"document"}.`},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:t}})).text.trim();return JSON.parse(a)},crossVerifyNames:async(n,e)=>{if(!pl){const s=n.trim().toLowerCase()===e.trim().toLowerCase();return{isMatch:s,reason:s?"Names are identical (case-insensitive match) without AI.":"AI disabled; simple case-insensitive comparison used."}}const r=(await pl.models.generateContent({model:"gemini-2.5-flash",contents:`Are these two names referring to the same person? Name 1: "${n}", Name 2: "${e}". Respond in JSON format with two keys: "isMatch" (boolean) and "reason" (a brief string explanation).`,config:{responseMimeType:"application/json",responseSchema:{type:et.OBJECT,properties:{isMatch:{type:et.BOOLEAN},reason:{type:et.STRING}}}}})).text.trim();return JSON.parse(r)},verifyFingerprintImage:async(n,e)=>{if(!pl)return{containsFingerprints:!1,reason:"AI disabled; cannot detect fingerprints."};const r=(await pl.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:'Does this image contain one or more human fingerprints? The image might be a scan from paper. Respond in JSON with "containsFingerprints" (boolean) and "reason" (string).'},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:{type:et.OBJECT,properties:{containsFingerprints:{type:et.BOOLEAN},reason:{type:et.STRING}}}}})).text.trim();return JSON.parse(r)},enhanceDocumentPhoto:async(n,e)=>{if(!pl)return console.warn("AI disabled; returning original document photo without enhancement."),n;const t=await pl.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{text:"Enhance this document photo. Improve contrast, correct perspective to be flat, and make text as clear as possible. Return only the enhanced image."},{inlineData:{data:n,mimeType:e}}]},config:{responseModalities:[mm.IMAGE]}});for(const r of t.candidates[0].content.parts)if(r.inlineData)return r.inlineData.data;throw new Error("AI did not return an enhanced image.")},getSiteStaffDesignations:async()=>{const{data:n,error:e}=await Ee.from("site_staff_designations").select("*");if(e)throw e;return(n||[]).map(xt)},updateManpowerDetails:async(n,e)=>{console.log("Mock updating manpower for",n,e),await new Promise(t=>setTimeout(t,500))},getCompOffLogs:async n=>{const{data:e,error:t}=await Ee.from("comp_off_logs").select("*").eq("user_id",n).order("date_earned",{ascending:!1});if(t)throw t;return(e||[]).map(xt)},checkCompOffTableExists:async()=>{const{error:n}=await Ee.from("comp_off_logs").select("id").limit(1);if(n)throw n},getAllSiteAssets:async()=>Promise.resolve({}),updateSiteAssets:async(n,e)=>(console.log("Mock updating assets for site",n,e),Promise.resolve()),getBackOfficeIdSeries:async()=>{const{data:n,error:e}=await Ee.from("settings").select("back_office_id_series").eq("id","singleton").single();if(e)throw e;return n?.back_office_id_series?xt(n.back_office_id_series):[]},updateBackOfficeIdSeries:async n=>{const{error:e}=await Ee.from("settings").update({back_office_id_series:hn(n)}).eq("id","singleton");if(e)throw e},updateSiteStaffDesignations:async n=>{const{error:e}=await Ee.from("site_staff_designations").upsert(hn(n),{onConflict:"id"});if(e)throw e},getAllSiteIssuedTools:async()=>Promise.resolve({}),getToolsList:async()=>Promise.resolve({}),updateSiteIssuedTools:async(n,e)=>{console.log("Mock updating tools for site",n,e)},getAllSiteGentsUniforms:async()=>Promise.resolve({}),getMasterGentsUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteGentsUniforms:async(n,e)=>{console.log("Mock updating gents uniforms for",n,e)},getAllSiteUniformDetails:async()=>Promise.resolve({}),updateSiteUniformDetails:async(n,e)=>{console.log("Mock updating uniform details for",n,e)},getAllSiteLadiesUniforms:async()=>Promise.resolve({}),getMasterLadiesUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteLadiesUniforms:async(n,e)=>{console.log("Mock updating ladies uniforms for",n,e)},getUniformRequests:async()=>{const{data:n,error:e}=await Ee.from("uniform_requests").select("*");if(e)throw e;return(n||[]).map(xt)},submitUniformRequest:async n=>{const{data:e,error:t}=await Ee.from("uniform_requests").insert(hn(n)).select().single();if(t)throw t;return xt(e)},updateUniformRequest:async n=>{const{data:e,error:t}=await Ee.from("uniform_requests").update(hn(n)).eq("id",n.id).select().single();if(t)throw t;return xt(e)},deleteUniformRequest:async n=>{const{error:e}=await Ee.from("uniform_requests").delete().eq("id",n);if(e)throw e},getInvoiceStatuses:async n=>(console.log("Mock fetching invoice statuses for",n),Promise.resolve({})),getInvoiceSummaryData:async(n,e)=>(console.log("Mock fetching invoice data for",n,e),Promise.resolve({siteName:"Mock Site",siteAddress:"Mock Address",invoiceNumber:"INV-001",invoiceDate:"2023-01-31",statementMonth:"January-2023",lineItems:[]})),getSupportTickets:async()=>{const{data:n,error:e}=await Ee.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))");if(e)throw e;return(n||[]).map(xt)},getSupportTicketById:async n=>{const{data:e,error:t}=await Ee.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))").eq("id",n).single();if(t)throw t;return xt(e)},createSupportTicket:async n=>{const e=n.attachment;if(e&&e.file instanceof File)try{const{path:s}=await ce.uploadDocument(e.file,LM);n.attachment={name:e.name,type:e.type,size:e.size,path:s}}catch(s){console.error("Failed to upload support ticket attachment:",s),delete n.attachment}const{data:t,error:r}=await Ee.from("support_tickets").insert(hn(n)).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(r)throw r;return xt(t)},updateSupportTicket:async(n,e)=>{const t=e.attachment;if(t&&t.file instanceof File)try{const{path:a}=await ce.uploadDocument(t.file,LM);e.attachment={name:t.name,type:t.type,size:t.size,path:a}}catch(a){console.error("Failed to upload updated support ticket attachment:",a),delete e.attachment}const{data:r,error:s}=await Ee.from("support_tickets").update(hn(e)).eq("id",n).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(s)throw s;return xt(r)},addTicketPost:async(n,e)=>{const{data:t,error:r}=await Ee.from("ticket_posts").insert(hn(e)).select("*, comments:ticket_comments(*)").single();if(r)throw r;return xt(t)},togglePostLike:async(n,e)=>{const{data:t,error:r}=await Ee.from("ticket_posts").select("likes").eq("id",n).single();if(r)throw r;const s=t.likes||[],a=s.includes(e)?s.filter(l=>l!==e):[...s,e],{error:o}=await Ee.from("ticket_posts").update({likes:a}).eq("id",n);if(o)throw o},addPostComment:async(n,e)=>{const{data:t,error:r}=await Ee.from("ticket_comments").insert(hn(e)).select().single();if(r)throw r;return xt(t)},getVerificationCostBreakdown:async(n,e)=>{const{data:t,error:r}=await Ee.from("onboarding_submissions").select("id, employee_id, personal, enrollment_date, verification_usage").gte("enrollment_date",n).lte("enrollment_date",e);if(r)throw r;return(t||[]).map(s=>{const a=xt(s);return{id:a.id,employeeId:a.personal.employeeId,employeeName:`${a.personal.firstName} ${a.personal.lastName}`,enrollmentDate:a.enrollmentDate,totalCost:0,breakdown:a.verificationUsage||[]}})},generatePdf:async(n,e)=>{try{const t=(await Cf(async()=>{const{default:r}=await import("./html2pdf-CJ3l1iig.js").then(s=>s.h);return{default:r}},[],import.meta.url)).default;await t().set(e).from(n).save()}catch(t){throw console.error("PDF generation failed:",t),t}},batchResolveAddresses:async n=>{if(n.length===0)return{};const e=c=>parseFloat(c.toFixed(6)),t=Array.from(new Set(n.map(c=>`${e(c.lat)},${e(c.lon)}`))).map(c=>{const[d,h]=c.split(",").map(Number);return{lat:d,lon:h}}),r={},s=[],a=t.map(c=>c.lat),{data:o,error:l}=await Ee.from("location_cache").select("*").in("latitude",a);!l&&o&&o.forEach(c=>{const d=e(parseFloat(c.latitude)),h=e(parseFloat(c.longitude)),p=`${d},${h}`;t.some(x=>e(x.lat)===d&&e(x.lon)===h)&&(r[p]=c.address)}),t.forEach(c=>{const d=`${e(c.lat)},${e(c.lon)}`;r[d]||s.push(c)}),console.log("Geocoding API: Found",Object.keys(r).length,"cached,",s.length,"missing");for(const c of s)try{const d=await Cf(()=>Promise.resolve().then(()=>OK),void 0,import.meta.url).then(p=>p.reverseGeocode(c.lat,c.lon)),h=`${e(c.lat)},${e(c.lon)}`;r[h]=d,await Ee.from("location_cache").insert({latitude:e(c.lat),longitude:e(c.lon),address:d}),console.log("Geocoding API: Fetched and cached",h,"->",d),await new Promise(p=>setTimeout(p,1e3))}catch(d){console.error(`Failed to resolve address for ${c.lat},${c.lon}`,d);const h=`${e(c.lat)},${e(c.lon)}`;r[h]=`${c.lat.toFixed(4)}, ${c.lon.toFixed(4)}`}return r},sendSecurityAlert:async(n,e,t,r)=>{const{data:s,error:a}=await Ee.from("users").select("reporting_manager_id").eq("id",n).single();if(a||!s?.reporting_manager_id){console.warn("Could not find reporting manager for security alert");return}const o=t==="developer_mode"?"attempted to access the application with Developer Mode enabled":"attempted to access the application with Location Spoofing detected",l=r?` using device: ${r}`:"";await ce.createNotification({userId:s.reporting_manager_id,title:" Security Alert",message:`${e} ${o}${l}. Access was blocked for security reasons.`,type:"security",link:"/user-management"})},sendDeviceChangeAlert:async(n,e,t,r)=>{const{data:s,error:a}=await Ee.from("users").select("reporting_manager_id").eq("id",n).single();if(a||!s?.reporting_manager_id){console.warn("Could not find reporting manager for device change alert");return}await ce.createNotification({userId:s.reporting_manager_id,title:" Device Change Detected",message:`${e} logged in from a new device. Previous device: ${t}, New device: ${r}`,type:"info",link:"/user-management"})}},DK=(n,e,t="Operation timed out")=>{const r=new Promise((s,a)=>{setTimeout(()=>a(new Error(t)),e)});return Promise.race([n,r])};function EN(n,e,t,r){const s=h=>h*Math.PI/180,o=s(t-n),l=s(r-e),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(s(n))*Math.cos(s(t))*Math.sin(l/2)*Math.sin(l/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}async function gm(n,e){const t=`${n.toFixed(4)}, ${e.toFixed(4)}`;try{const{supabase:r}=await Cf(async()=>{const{supabase:l}=await Promise.resolve().then(()=>EV);return{supabase:l}},void 0,import.meta.url),s=Math.round(n*1e4)/1e4,a=Math.round(e*1e4)/1e4,{data:o}=await r.from("location_cache").select("address").eq("latitude",s).eq("longitude",a).maybeSingle();return o?.address?o.address:t}catch(r){return console.warn("Reverse geocode failed:",r),t}}function ly(n=50,e=1e4){return new Promise((t,r)=>{if(!("geolocation"in navigator))return r(new Error("Geolocation is not supported by this browser."));let s=null;const a=setTimeout(()=>{s?(navigator.geolocation.clearWatch(o),t(s)):(navigator.geolocation.clearWatch(o),r(new Error("Unable to acquire a precise position within the timeout period")))},e),o=navigator.geolocation.watchPosition(l=>{(!s||l.coords.accuracy<s.coords.accuracy)&&(s=l),l.coords.accuracy<=n&&(clearTimeout(a),navigator.geolocation.clearWatch(o),t(l))},l=>{clearTimeout(a),navigator.geolocation.clearWatch(o),r(l)},{enableHighAccuracy:!0,maximumAge:0})})}const OK=Object.freeze(Object.defineProperty({__proto__:null,calculateDistanceMeters:EN,getPrecisePosition:ly,reverseGeocode:gm},Symbol.toStringTag,{value:"Module"})),Yp=n=>{const e=n.toLowerCase();return e.includes("timed out")?"The request took too long. Please check your internet connection and try again.":e.includes("invalid api key")||e.includes("configuration")?"System configuration error. Please contact support.":e.includes("failed to fetch")||e.includes("network")?"Unable to connect. Please check your internet connection.":e.includes("invalid login credentials")?'Incorrect email or password. If you use Google Sign-In, please click "Sign in with Google".':e.includes("user already registered")||e.includes("already exists")?"This email is already registered. Please sign in.":e.includes("email not confirmed")?"Please verify your email address. Check your inbox for the confirmation link.":e.includes("too many requests")||e.includes("rate limit")?"Too many attempts. Please wait a few minutes before trying again.":e.includes("weak password")?"Password is too weak. Please use a stronger password.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again or contact support.")},gb=()=>{const n=new Date().getHours();return n<12?"Good Morning":n<17?"Good Afternoon":"Good Evening"},jt=ea()((n,e)=>({user:null,isInitialized:!1,isCheckedIn:!1,isAttendanceLoading:!0,lastCheckInTime:null,lastCheckOutTime:null,error:null,loading:!1,isLoginAnimationPending:!1,setLoginAnimationPending:t=>n({isLoginAnimationPending:t}),setUser:t=>n({user:t,error:null,loading:!1}),setInitialized:t=>n({isInitialized:t}),setLoading:t=>n({loading:t}),resetAttendance:()=>n({isCheckedIn:!1,isAttendanceLoading:!1,lastCheckInTime:null,lastCheckOutTime:null,isLoginAnimationPending:!1}),setError:t=>n({error:t}),loginWithEmail:async(t,r,s)=>{n({error:null,loading:!0});try{await Ca.signOut()}catch{}try{const{data:a,error:o}=await DK(Ca.signInWithPassword(t,r),2e4,"Login attempt timed out. Please check your network connection.").catch(c=>({data:{user:null,session:null},error:{message:c.message}}));if(o||!a.user||!a.session){const c=Yp(o?.message||"Invalid login credentials");return n({error:c,loading:!1}),{error:{message:c}}}s?(localStorage.setItem("rememberedEmail",t),localStorage.setItem("supabase.auth.rememberMe",a.session.refresh_token)):(localStorage.removeItem("rememberedEmail"),localStorage.removeItem("supabase.auth.rememberMe"));const l=await Ca.getAppUserProfile(a.user);if(l){n({user:l,error:null,loading:!1});try{const c=`greetingSent_${l.id}`,d=gb();await ce.createNotification({userId:l.id,message:`${d}, ${l.name||"there"}! Welcome back to Paradigm Services.`,type:"greeting"})}catch(c){console.error("Failed to send login greeting notification",c)}return{error:null}}else{await Ca.signOut();const c="Login successful, but failed to retrieve user profile. Please try again.";return n({user:null,error:c,loading:!1}),{error:{message:c}}}}catch(a){console.error("Unexpected error during login flow:",a);const o=Yp("Unexpected error during login flow");return n({user:null,error:o,loading:!1}),{error:{message:o}}}},signUp:async(t,r,s)=>{n({error:null,loading:!0});const{error:a}=await Ca.signUpWithPassword({email:r,password:s,options:{data:{name:t}}});if(a){const o=Yp(a.message);return n({error:o,loading:!1}),{error:{message:o}}}return n({loading:!1}),{error:null}},loginWithGoogle:async()=>{n({error:null,loading:!0});const{error:t}=await Ca.signInWithGoogle();if(t){const r=Yp(t.message);return n({error:r,loading:!1}),{error:{message:r}}}return n({loading:!1}),{error:null}},sendPasswordReset:async t=>{const{error:r}=await Ca.resetPasswordForEmail(t);return r?{error:{message:r.message}}:{error:null}},logout:async()=>{const t=e().user;if(t)try{const r=gb(),s=new Date().getHours()>=20?"Good Night":r;await ce.createNotification({userId:t.id,message:`${s}, ${t.name||"there"}! Thanks for your hard work today.`,type:"greeting"})}catch(r){console.error("Failed to send logout farewell notification",r)}localStorage.removeItem("supabase.auth.rememberMe"),await Ca.signOut()},updateUserProfile:t=>n(r=>({user:r.user?{...r.user,...t}:null})),checkAttendanceStatus:async()=>{const{user:t}=e();if(!t){n({isAttendanceLoading:!1});return}n({isAttendanceLoading:!0});try{const r=new Date,s=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0).toISOString(),a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999).toISOString(),o=await ce.getAttendanceEvents(t.id,s,a);if(o.length===0){n({isCheckedIn:!1,lastCheckInTime:null,lastCheckOutTime:null,isAttendanceLoading:!1});return}o.sort((h,p)=>new Date(h.timestamp).getTime()-new Date(p.timestamp).getTime());const l=o.find(h=>h.type==="check-in"),c=[...o].reverse().find(h=>h.type==="check-out"),d=o[o.length-1];n({isCheckedIn:d?.type==="check-in",lastCheckInTime:l?l.timestamp:null,lastCheckOutTime:c?c.timestamp:null,isAttendanceLoading:!1})}catch(r){console.error("Failed to check attendance status:",r),n({isAttendanceLoading:!1})}},toggleCheckInStatus:async()=>{const{user:t,isCheckedIn:r}=e();if(!t)return{success:!1,message:"User not found"};const s=r?"check-out":"check-in";try{let a=null;try{a=await ly()}catch{}(!a||!a.coords)&&(a=await new Promise(p=>{navigator.geolocation.getCurrentPosition(x=>p(x),()=>p(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}));const o=async(p,x,v)=>{await ce.addAttendanceEvent({userId:t.id,timestamp:new Date().toISOString(),type:s,latitude:p,longitude:x,locationId:v}),await e().checkAttendanceStatus();try{const b=gb(),_=s==="check-in"?"checking in":"checking out";await ce.createNotification({userId:t.id,message:`${b}, ${t.name||"there"}! Thanks for ${_}.`,type:"greeting"})}catch(b){console.warn("Failed to send user attendance notification",b)}try{const b=await ce.getAttendanceSettings();if((["admin","hr","finance","developer"].includes(t.role)?b?.office:b?.field)?.enableAttendanceNotifications){const C=[];t.reportingManagerId&&C.push({id:t.reportingManagerId});const P=await ce.getNearbyUsers();for(const I of P)C.find(F=>F.id===I.id)||C.push({id:I.id});const O=t.name||"An employee",M=v?"":p&&x?` at ${p.toFixed(4)}, ${x.toFixed(4)}`:"",D=`${O} ${s.replace("-"," ")}${M}`;await Promise.all(C.map(I=>ce.createNotification({userId:I.id,message:D,type:"greeting"})))}}catch(b){console.warn("Failed to create manager notifications:",b)}return{success:!0,message:`Successfully ${s.replace("-"," ")}!`}};if(!a||!a.coords)return await o(void 0,void 0,null);const{latitude:l,longitude:c,accuracy:d}=a.coords;if(typeof d=="number"&&d>1e3)return await o(l,c,null);let h=null;try{const p=await ce.getUserLocations(t.id);for(const x of p)if(EN(l,c,x.latitude,x.longitude)<=x.radius){h=x.id;break}if(!h){const x=await ce.getLocations();for(const v of x)if(EN(l,c,v.latitude,v.longitude)<=v.radius){h=v.id;try{await ce.assignLocationToUser(t.id,v.id)}catch(_){console.warn("Failed to autoassign location to user:",_)}break}}}catch(p){console.warn("Geofencing check failed:",p)}if(!h)try{let p=null;try{p=await gm(l,c)}catch(b){console.warn("Reverse geocode failed for new location:",b)}const v=await ce.createLocation({name:p||null,latitude:l,longitude:c,radius:100,address:p||null,createdBy:t.id});try{await ce.assignLocationToUser(t.id,v.id)}catch(b){console.warn("Failed to autoassign new location to user:",b)}h=v.id}catch(p){console.warn("Failed to create a new geofence location:",p),h=null}return await o(l,c,h)}catch(a){return console.error("Error during attendance update:",a),{success:!1,message:"Failed to update attendance."}}}})),IK={};function ed(n,e){let t;try{t=n()}catch{return}return{getItem:s=>{var a;const o=c=>c===null?null:JSON.parse(c,void 0),l=(a=t.getItem(s))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(s,a)=>t.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>t.removeItem(s)}}const xm=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return xm(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return xm(r)(t)}}}},AK=(n,e)=>(t,r,s)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:j=>j,version:0,merge:(j,C)=>({...C,...j}),...e},o=!1;const l=new Set,c=new Set;let d;try{d=a.getStorage()}catch{}if(!d)return n((...j)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...j)},r,s);const h=xm(a.serialize),p=()=>{const j=a.partialize({...r()});let C;const P=h({state:j,version:a.version}).then(O=>d.setItem(a.name,O)).catch(O=>{C=O});if(C)throw C;return P},x=s.setState;s.setState=(j,C)=>{x(j,C),p()};const v=n((...j)=>{t(...j),p()},r,s);let b;const _=()=>{var j;if(!d)return;o=!1,l.forEach(P=>P(r()));const C=((j=a.onRehydrateStorage)==null?void 0:j.call(a,r()))||void 0;return xm(d.getItem.bind(d))(a.name).then(P=>{if(P)return a.deserialize(P)}).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==a.version){if(a.migrate)return a.migrate(P.state,P.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return P.state}).then(P=>{var O;return b=a.merge(P,(O=r())!=null?O:v),t(b,!0),p()}).then(()=>{C?.(b,void 0),o=!0,c.forEach(P=>P(b))}).catch(P=>{C?.(void 0,P)})};return s.persist={setOptions:j=>{a={...a,...j},j.getStorage&&(d=j.getStorage())},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:j=>(l.add(j),()=>{l.delete(j)}),onFinishHydration:j=>(c.add(j),()=>{c.delete(j)})},_(),b||v},RK=(n,e)=>(t,r,s)=>{let a={storage:ed(()=>localStorage),partialize:_=>_,version:0,merge:(_,j)=>({...j,..._}),...e},o=!1;const l=new Set,c=new Set;let d=a.storage;if(!d)return n((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(..._)},r,s);const h=()=>{const _=a.partialize({...r()});return d.setItem(a.name,{state:_,version:a.version})},p=s.setState;s.setState=(_,j)=>{p(_,j),h()};const x=n((..._)=>{t(..._),h()},r,s);s.getInitialState=()=>x;let v;const b=()=>{var _,j;if(!d)return;o=!1,l.forEach(P=>{var O;return P((O=r())!=null?O:x)});const C=((j=a.onRehydrateStorage)==null?void 0:j.call(a,(_=r())!=null?_:x))||void 0;return xm(d.getItem.bind(d))(a.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==a.version){if(a.migrate)return[!0,a.migrate(P.state,P.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var O;const[M,D]=P;if(v=a.merge(D,(O=r())!=null?O:x),t(v,!0),M)return h()}).then(()=>{C?.(v,void 0),v=r(),o=!0,c.forEach(P=>P(v))}).catch(P=>{C?.(void 0,P)})};return s.persist={setOptions:_=>{a={...a,..._},_.storage&&(d=_.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>b(),hasHydrated:()=>o,onHydrate:_=>(l.add(_),()=>{l.delete(_)}),onFinishHydration:_=>(c.add(_),()=>{c.delete(_)})},a.skipHydration||b(),v||x},LK=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((IK?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),AK(n,e)):RK(n,e),ju=LK,td=ea(ju(n=>({theme:"light",isAutomatic:!0,setTheme:e=>n({theme:e,isAutomatic:!1}),setAutomatic:e=>n({isAutomatic:e}),_setThemeInternal:e=>n({theme:e})}),{name:"paradigm-app-theme",storage:ed(()=>localStorage)})),FK={esiCtcThreshold:21e3,enforceManpowerLimit:!1,manpowerLimitRule:"warn",allowSalaryEdit:!1,salaryThreshold:21e3,defaultPolicySingle:"1L",defaultPolicyMarried:"2L",enableEsiRule:!1,enableGmcRule:!1,enforceFamilyValidation:!0,rulesByDesignation:{}},nd=ea()(n=>({...FK,init:e=>{e&&n(e)},updateRules:e=>n(t=>({...t,...e}))})),qK={unverified:[],admin:["view_all_submissions","manage_users","manage_sites","view_entity_management","view_developer_settings","view_operations_dashboard","view_site_dashboard","create_enrollment","manage_roles_and_permissions","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_approval_workflow","download_attendance_report","manage_tasks","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","view_field_officer_tracking","manage_modules","access_support_desk"],hr:["view_all_submissions","manage_users","manage_sites","view_entity_management","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","download_attendance_report","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","access_support_desk"],finance:["view_invoice_summary","view_verification_costing","view_own_attendance","apply_for_leave"],developer:["view_developer_settings"],operation_manager:["view_operations_dashboard","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_tasks","access_support_desk"],site_manager:["view_site_dashboard","create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"],field_officer:["create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"]},na=ea(ju((n,e)=>({permissions:qK,initRoles:t=>{if(!t)return;const s={...e().permissions};let a=!1;t.forEach(o=>{s[o.id]||(s[o.id]=[],a=!0)}),a&&n({permissions:s})},addRolePermissionEntry:t=>{n(r=>({permissions:{...r.permissions,[t.id]:[]}}))},removeRolePermissionEntry:t=>{n(r=>{const s={...r.permissions};return delete s[t],{permissions:s}})},renameRolePermissionEntry:(t,r)=>{n(s=>{const a={...s.permissions};return a[t]&&(a[r]=a[t],delete a[t]),{permissions:a}})},setRolePermissions:(t,r)=>{n(s=>({permissions:{...s.permissions,[t]:r}}))}}),{name:"paradigm_app_permissions_v2",storage:ed(()=>localStorage)})),zK={enablePincodeVerification:!0},UK={office:{minimumHoursFullDay:8,minimumHoursHalfDay:4,annualEarnedLeaves:5,annualSickLeaves:12,monthlyFloatingLeaves:1,annualCompOffLeaves:5,enableAttendanceNotifications:!1,sickLeaveCertificateThreshold:2},field:{minimumHoursFullDay:9,minimumHoursHalfDay:5,annualEarnedLeaves:10,annualSickLeaves:10,monthlyFloatingLeaves:0,annualCompOffLeaves:10,enableAttendanceNotifications:!0,sickLeaveCertificateThreshold:3}},BK={applicability:"Optional - Opt-in Default",optInDisclaimer:"Please note that currently the GMC facility covers only spouse and two children. If you would like to continue, please select below relationships and submit.",coverageDetails:"Spouse and two children",optOutDisclaimer:"Please note that you are opting out of the GMC Facility. You will have to submit a declaration to the company towards the same along with proof of your existing insurance.",requireAlternateInsurance:!0,collectProvider:!0,collectStartDate:!0,collectEndDate:!0,collectExtentOfCover:!0},VK={enabled:!0,clientId:"",clientSecret:""},WK={enabled:!0},$K={enabled:!0},HK={email:{enabled:!1}},YK=[{id:"cost_1",name:"Profile Picture",cost:0},{id:"cost_2",name:"Mobile to Form Prefill",cost:7},{id:"cost_3",name:"KYC OCR (Plus)",cost:1.5},{id:"cost_4",name:"Aadhaar Mobile Link",cost:2.5},{id:"cost_5",name:"EPF UAN Lookup",cost:2.5},{id:"cost_6",name:"Cheque OCR",cost:3},{id:"cost_7",name:"Bank AC Verification Advanced",cost:2.25},{id:"cost_8",name:"PAN Profile Detailed",cost:5},{id:"cost_9",name:"Aadhaar Verification",cost:1.75},{id:"cost_10",name:"Voter ID OCR",cost:1.5},{id:"cost_11",name:"Driving License OCR",cost:1.5},{id:"cost_12",name:"Education Certificate OCR",cost:2},{id:"cost_13",name:"Experience/Salary Slip OCR",cost:2},{id:"cost_14",name:"ESI Card OCR",cost:1.5}],GK={enableProvisionalSites:!1},bi=ea()(ju(n=>({address:zK,attendance:UK,officeHolidays:[],fieldHolidays:[],recurringHolidays:[],gmcPolicy:BK,perfiosApi:VK,geminiApi:WK,otp:$K,notifications:HK,verificationCosts:YK,siteManagement:GK,initSettings:e=>{if(e){const{holidays:t,attendanceSettings:r,recurringHolidays:s}=e,a=t.filter(l=>l.type==="office"),o=t.filter(l=>l.type==="field");n({officeHolidays:a,fieldHolidays:o,attendance:r,recurringHolidays:s||[]})}},updateAddressSettings:e=>n(t=>({address:{...t.address,...e}})),updateAttendanceSettings:e=>n({attendance:e}),updateGmcPolicySettings:e=>n(t=>({gmcPolicy:{...t.gmcPolicy,...e}})),updatePerfiosApiSettings:e=>n(t=>({perfiosApi:{...t.perfiosApi,...e}})),updateGeminiApiSettings:e=>n(t=>({geminiApi:{...t.geminiApi,...e}})),updateOtpSettings:e=>n(t=>({otp:{...t.otp,...e}})),updateNotificationSettings:e=>n(t=>({notifications:{...t.notifications,...e,email:{...t.notifications.email,...e.email}}})),updateVerificationCosts:e=>n({verificationCosts:e}),updateSiteManagementSettings:e=>n(t=>({siteManagement:{...t.siteManagement,...e}})),addHoliday:async(e,t)=>{const r=await ce.addHoliday({...t,type:e});n(s=>{const a=e==="office"?"officeHolidays":"fieldHolidays",o=[...s[a],r].sort((l,c)=>new Date(l.date).getTime()-new Date(c.date).getTime());return{[a]:o}})},removeHoliday:async(e,t)=>{await ce.removeHoliday(t),n(r=>{const s=e==="office"?"officeHolidays":"fieldHolidays";return{[s]:r[s].filter(a=>a.id!==t)}})},addRecurringHoliday:async e=>{const t=await ce.addRecurringHoliday(e);n(r=>({recurringHolidays:[...r.recurringHolidays,t]}))},removeRecurringHoliday:async e=>{await ce.deleteRecurringHoliday(e),n(t=>({recurringHolidays:t.recurringHolidays.filter(r=>r.id!==e)}))}}),{name:"paradigm_app_settings",storage:ed(()=>localStorage)})),on=ea()(ju(n=>({colorScheme:"green",appTitle:"Paradigm Employee Onboarding",setColorScheme:e=>n({colorScheme:e}),setAppTitle:e=>n({appTitle:e}),initBranding:(e,t)=>n(r=>({colorScheme:e,appTitle:t||r.appTitle}))}),{name:"paradigm-branding",storage:ed(()=>localStorage)})),uf="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",ZK="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",KK="/SouthWall-Logo.jpg",kC=n=>n==="blue"||n==="professional-blue"?KK:ZK,JK=n=>n==="blue"||n==="professional-blue"?"SouthWall Security":"Paradigm Services",Am=ea(ju(n=>({currentLogo:uf,defaultLogo:uf,setCurrentLogo:e=>n({currentLogo:e}),setDefaultLogo:()=>n(e=>({defaultLogo:e.currentLogo})),resetToDefault:()=>n(e=>({currentLogo:e.defaultLogo})),resetToOriginal:()=>n({currentLogo:uf,defaultLogo:uf})}),{name:"paradigm-app-logo",storage:ed(()=>localStorage)})),At=n=>{const[e,t]=E.useState(window.matchMedia(n).matches);return E.useEffect(()=>{const r=window.matchMedia(n),s=()=>t(r.matches);try{r.addEventListener("change",s)}catch{r.addListener(s)}return()=>{try{r.removeEventListener("change",s)}catch{r.removeListener(s)}}},[n]),e},FM=()=>({id:`draft_${Date.now()}`,status:"draft",enrollmentDate:new Date().toISOString().split("T")[0],personal:{employeeId:`PARA-${Math.floor(1e3+Math.random()*9e3)}`,firstName:"",lastName:"",dob:"",gender:"",maritalStatus:"",bloodGroup:"",mobile:"",alternateMobile:"",email:"",emergencyContactName:"",emergencyContactNumber:"",relationship:"",salary:null,verifiedStatus:{}},address:{present:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},permanent:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},sameAsPresent:!0},family:[],education:[],bank:{accountHolderName:"",accountNumber:"",confirmAccountNumber:"",ifscCode:"",bankName:"",branchName:"",verifiedStatus:{}},uan:{hasPreviousPf:!1,verifiedStatus:{},salarySlip:null},esi:{hasEsi:!1,verifiedStatus:{}},gmc:{isOptedIn:null,policyAmount:"",nomineeName:"",nomineeRelation:"",selectedSpouseId:"",selectedChildIds:[],gmcPolicyCopy:null,declarationAccepted:!1},organization:{designation:"",department:"",reportingManager:"",organizationId:"",organizationName:"",joiningDate:We(new Date,"yyyy-MM-dd"),workType:"Full-time",defaultSalary:null},uniforms:[],biometrics:{signatureImage:null,fingerprints:{leftThumb:null,leftIndex:null,leftMiddle:null,leftRing:null,leftLittle:null,rightThumb:null,rightIndex:null,rightMiddle:null,rightRing:null,rightLittle:null}},salaryChangeRequest:null,requiresManualVerification:!1,formsGenerated:!1,verificationUsage:[]}),Yn=ea(n=>({data:FM(),setData:e=>n({data:e}),updatePersonal:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,...e}}})),setPersonalVerifiedStatus:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,verifiedStatus:{...t.data.personal.verifiedStatus,...e}}}})),updateAddress:e=>n(t=>({data:{...t.data,address:{...t.data.address,...e}}})),setAddressVerifiedStatus:(e,t)=>n(r=>({data:{...r.data,address:{...r.data.address,[e]:{...r.data.address[e],verifiedStatus:{...r.data.address[e].verifiedStatus,...t}}}}})),updateFamily:e=>n(t=>({data:{...t.data,family:e}})),updateEducation:e=>n(t=>({data:{...t.data,education:e}})),updateBank:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,...e}}})),setBankVerifiedStatus:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,verifiedStatus:{...t.data.bank.verifiedStatus,...e}}}})),updateUan:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,...e}}})),setUanVerifiedStatus:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,verifiedStatus:{...t.data.uan.verifiedStatus,...e}}}})),updateEsi:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,...e}}})),setEsiVerifiedStatus:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,verifiedStatus:{...t.data.esi.verifiedStatus,...e}}}})),updateGmc:e=>n(t=>({data:{...t.data,gmc:{...t.data.gmc,...e}}})),updateOrganization:e=>n(t=>({data:{...t.data,organization:{...t.data.organization,...e}}})),updateUniforms:e=>n(t=>({data:{...t.data,uniforms:e}})),updateBiometrics:e=>n(t=>({data:{...t.data,biometrics:{...t.data.biometrics,...e}}})),setSalaryChangeRequest:e=>n(t=>({data:{...t.data,salaryChangeRequest:e}})),setRequiresManualVerification:e=>n(t=>({data:{...t.data,requiresManualVerification:e}})),setFormsGenerated:e=>n(t=>({data:{...t.data,formsGenerated:e}})),logVerificationUsage:e=>n(t=>{const r=JSON.parse(JSON.stringify(t.data.verificationUsage||[])),s=r.find(a=>a.name===e);return s?s.count+=1:r.push({name:e,count:1}),{data:{...t.data,verificationUsage:r}}}),reset:()=>n({data:FM()}),addFamilyMember:()=>n(e=>({data:{...e.data,family:[...e.data.family,{id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""}]}})),updateFamilyMember:(e,t)=>n(r=>({data:{...r.data,family:r.data.family.map(s=>s.id===e?{...s,...t}:s)}})),removeFamilyMember:e=>n(t=>({data:{...t.data,family:t.data.family.filter(r=>r.id!==e)}})),addEducationRecord:()=>n(e=>({data:{...e.data,education:[...e.data.education,{id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""}]}})),updateEducationRecord:(e,t)=>n(r=>({data:{...r.data,education:r.data.education.map(s=>s.id===e?{...s,...t}:s)}})),removeEducationRecord:e=>n(t=>({data:{...t.data,education:t.data.education.filter(r=>r.id!==e)}})),addOrUpdateEmergencyContactAsFamilyMember:()=>n(e=>{const{personal:t,family:r}=e.data,{emergencyContactName:s,emergencyContactNumber:a,relationship:o}=t;if(s&&["Spouse","Child","Father","Mother"].includes(o)){const c=r.find(d=>d.name.toLowerCase()===s.toLowerCase()&&d.relation===o);if(c){if(c.phone!==a){const d=r.map(h=>h.id===c.id?{...h,phone:a}:h);return{data:{...e.data,family:d}}}}else{const d={id:`fam_emergency_${Date.now()}`,name:s,relation:o,phone:a,dob:"",gender:"",dependent:!1,idProof:null,occupation:""};return{data:{...e.data,family:[...r,d]}}}}return e})}));const QK=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),e3=(...n)=>n.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");var XK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const eJ=E.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:a,iconNode:o,...l},c)=>E.createElement("svg",{ref:c,...XK,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:e3("lucide",s),...l},[...o.map(([d,h])=>E.createElement(d,h)),...Array.isArray(a)?a:[a]]));const Le=(n,e)=>{const t=E.forwardRef(({className:r,...s},a)=>E.createElement(eJ,{ref:a,iconNode:e,className:e3(`lucide-${QK(n)}`,r),...s}));return t.displayName=`${n}`,t};const Gh=Le("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const tJ=Le("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);const Fa=Le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const nJ=Le("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const rJ=Le("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const sJ=Le("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);const iJ=Le("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const aJ=Le("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);const Af=Le("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);const oJ=Le("BriefcaseBusiness",[["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2",key:"1ksdt3"}],["path",{d:"M22 13a18.15 18.15 0 0 1-20 0",key:"12hx5q"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const t3=Le("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const Ki=Le("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const lJ=Le("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);const cJ=Le("CalendarCheck2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]]);const dJ=Le("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);const uJ=Le("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);const fJ=Le("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);const Da=Le("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const PC=Le("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);const hJ=Le("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);const Sl=Le("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const Su=Le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const cy=Le("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Rf=Le("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const mJ=Le("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const pJ=Le("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);const gJ=Le("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);const n3=Le("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const Ji=Le("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const qM=Le("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const zM=Le("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const xJ=Le("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const ym=Le("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const r3=Le("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);const s3=Le("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);const Hc=Le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const yJ=Le("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);const i3=Le("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);const vJ=Le("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);const DN=Le("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);const _i=Le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);const bJ=Le("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);const Tl=Le("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const wJ=Le("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);const _J=Le("FileDigit",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["rect",{width:"4",height:"6",x:"2",y:"12",rx:"2",key:"jm304g"}],["path",{d:"M10 12h2v6",key:"12zw74"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);const a3=Le("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);const ON=Le("FilePenLine",[["path",{d:"m18 5-3-3H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"h0fsxq"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.4 9.6a2 2 0 1 1 3 3L17 17l-4 1 1-4Z",key:"dyo8mm"}]]);const ds=Le("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const jJ=Le("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);const SJ=Le("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);const NJ=Le("Files",[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]]);const o3=Le("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);const UM=Le("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);const CJ=Le("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);const TJ=Le("GitPullRequest",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]]);const l3=Le("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const kJ=Le("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6h0",key:"1uc279"}],["path",{d:"M14 6h0a6 6 0 0 1 6 6v3",key:"1j9mnm"}]]);const MC=Le("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);const EC=Le("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);const PJ=Le("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);const c3=Le("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const kl=Le("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);const du=Le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const MJ=Le("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);const d3=Le("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);const EJ=Le("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);const Ox=Le("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);const DC=Le("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);const DJ=Le("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);const _t=Le("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const IN=Le("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const Ix=Le("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);const jo=Le("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const u3=Le("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);const Gf=Le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const Pl=Le("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const f3=Le("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);const AN=Le("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const BM=Le("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]);const vm=Le("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);const OJ=Le("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const IJ=Le("MousePointerClick",[["path",{d:"m9 9 5 12 1.8-5.2L21 14Z",key:"1b76lo"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}]]);const AJ=Le("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);const RJ=Le("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);const LJ=Le("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);const bm=Le("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);const FJ=Le("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);const qJ=Le("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);const Lf=Le("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const h3=Le("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);const zJ=Le("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);const Ut=Le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const RN=Le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const UJ=Le("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);const Ns=Le("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const Ia=Le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const OC=Le("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);const Rm=Le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const m3=Le("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);const dy=Le("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const p3=Le("ShieldHalf",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 22V2",key:"zs6s6o"}]]);const BJ=Le("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);const wm=Le("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const Ff=Le("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);const VJ=Le("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);const _m=Le("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);const ur=Le("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);const g3=Le("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const x3=Le("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);const y3=Le("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);const v3=Le("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const WJ=Le("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);const $J=Le("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);const sn=Le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const VM=Le("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const Aa=Le("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const Yc=Le("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const yu=Le("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);const Gc=Le("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const Ax=Le("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);const Ml=Le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const Qi=Le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const b3=Le("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);const w3=Le("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);const wi=Le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const HJ=Le("ZapOff",[["path",{d:"M10.513 4.856 13.12 2.17a.5.5 0 0 1 .86.46l-1.377 4.317",key:"193nxd"}],["path",{d:"M15.656 10H20a1 1 0 0 1 .78 1.63l-1.72 1.773",key:"27a7lr"}],["path",{d:"M16.273 16.273 10.88 21.83a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4a1 1 0 0 1-.78-1.63l4.507-4.643",key:"1e0qe9"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const LN=Le("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);const IC=Le("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);const AC=Le("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Xi=({className:n="",localPath:e})=>{const{colorScheme:t}=on(),{currentLogo:r}=Am(),s=r&&r!==uf,a=(()=>{switch(t){case"purple":return"#5B21B6";case"red":return"#991B1B";case"amber":return"#B45309";default:return"#006B3F"}})();return s?i.jsx("img",{src:r,alt:"Logo",className:`object-contain ${n}`}):i.jsxs("div",{className:`flex items-center gap-2 ${n}`,children:[i.jsx("div",{className:"relative",children:i.jsx(EJ,{className:"w-8 h-8",style:{color:a}})}),i.jsx("div",{className:"flex flex-col leading-tight",children:i.jsxs("span",{className:"font-bold text-lg tracking-wide",style:{color:a},children:["PARADIGM SER",i.jsx("span",{className:"text-xs align-super",children:"vi"}),"CES"]})})]})},ne=({children:n,className:e="",variant:t="primary",size:r="md",isLoading:s=!1,...a})=>{const l=`btn-${t}`,c=`btn-${r}`,{colorScheme:d}=on(),h=()=>t==="primary"?{backgroundColor:"#006B3F",borderColor:"#005632",color:"#FFFFFF"}:t==="outline"?{borderColor:"#006B3F",color:"#006B3F"}:{};return i.jsx("button",{className:`btn ${l} ${c} ${e}`,disabled:s||a.disabled,style:{...h(),...a.style},...a,children:s?i.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):n})},_3=ea(ju(n=>({autoClickOnHover:!0,autoScrollOnHover:!0,setAutoClickOnHover:e=>n({autoClickOnHover:e}),setAutoScrollOnHover:e=>n({autoScrollOnHover:e})}),{name:"paradigm-ui-settings",storage:ed(()=>localStorage)})),uy=ea((n,e)=>({notifications:[],unreadCount:0,isLoading:!1,error:null,fetchNotifications:async()=>{const t=jt.getState().user;if(t){n({isLoading:!0,error:null});try{const r=await ce.getNotifications(t.id),s=r.filter(a=>!a.isRead).length;n({notifications:r,unreadCount:s,isLoading:!1})}catch{n({error:"Failed to fetch notifications.",isLoading:!1})}}},markAsRead:async t=>{const r=e().notifications.find(s=>s.id===t);if(!(r&&r.isRead))try{await ce.markNotificationAsRead(t),n(s=>({notifications:s.notifications.map(a=>a.id===t?{...a,isRead:!0}:a),unreadCount:Math.max(0,s.unreadCount-1)}))}catch(s){console.error("Failed to mark notification as read",s)}},markAllAsRead:async()=>{const t=jt.getState().user;if(t&&e().unreadCount!==0)try{await ce.markAllNotificationsAsRead(t.id),n(r=>({notifications:r.notifications.map(s=>({...s,isRead:!0})),unreadCount:0}))}catch(r){console.error("Failed to mark all notifications as read",r)}}})),WM={green:{id:"green",label:"Paradigm Green",isDark:!1,colors:{sidebarBg:"#041b0f",sidebarBorder:"#1f3d2b",activeItemBg:"#006B3F",activeItemText:"#ffffff",mobileBg:"#041b0f",primary:"#22c55e",secondary:"#1f3d2b"}},purple:{id:"purple",label:"Royal Purple",isDark:!1,colors:{sidebarBg:"#3B0764",sidebarBorder:"#4C1D95",activeItemBg:"#5B21B6",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#5B21B6",secondary:"#E9D5FF"}},red:{id:"red",label:"Crimson Red",isDark:!1,colors:{sidebarBg:"#450A0A",sidebarBorder:"#7F1D1D",activeItemBg:"#991B1B",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#991B1B",secondary:"#FECACA"}},amber:{id:"amber",label:"Amber Gold",isDark:!1,colors:{sidebarBg:"#451A03",sidebarBorder:"#92400E",activeItemBg:"#B45309",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#B45309",secondary:"#FDE68A"}},"professional-blue":{id:"professional-blue",label:"Professional Blue",isDark:!1,colors:{sidebarBg:"#172554",sidebarBorder:"#1E3A8A",activeItemBg:"#2563EB",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#2563EB",secondary:"#BFDBFE"}},"dark-saas":{id:"dark-saas",label:"Dark SaaS",isDark:!0,colors:{sidebarBg:"#020617",sidebarBorder:"#1E293B",activeItemBg:"#22D3EE",activeItemText:"#020617",mobileBg:"#020617",primary:"#22D3EE",secondary:"#1E293B"}},"teal-mint":{id:"teal-mint",label:"Teal & Mint",isDark:!1,colors:{sidebarBg:"#042F2E",sidebarBorder:"#115E59",activeItemBg:"#0D9488",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#0D9488",secondary:"#99F6E4"}},"indigo-violet":{id:"indigo-violet",label:"Indigo & Violet",isDark:!1,colors:{sidebarBg:"#1E1B4B",sidebarBorder:"#3730A3",activeItemBg:"#4F46E5",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#4F46E5",secondary:"#C7D2FE"}},"green-finance":{id:"green-finance",label:"Green Finance",isDark:!1,colors:{sidebarBg:"#052E16",sidebarBorder:"#065F46",activeItemBg:"#15803D",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#15803D",secondary:"#BBF7D0"}},"orange-energy":{id:"orange-energy",label:"Orange Energy",isDark:!1,colors:{sidebarBg:"#431407",sidebarBorder:"#9A3412",activeItemBg:"#EA580C",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#EA580C",secondary:"#FED7AA"}},"red-alert":{id:"red-alert",label:"Red Alert",isDark:!1,colors:{sidebarBg:"#450A0A",sidebarBorder:"#7F1D1D",activeItemBg:"#DC2626",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#DC2626",secondary:"#FECACA"}},"neutral-gray":{id:"neutral-gray",label:"Neutral Gray",isDark:!1,colors:{sidebarBg:"#111827",sidebarBorder:"#374151",activeItemBg:"#374151",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#374151",secondary:"#E5E7EB"}},"cyan-tech":{id:"cyan-tech",label:"Cyan Tech",isDark:!1,colors:{sidebarBg:"#083344",sidebarBorder:"#155E75",activeItemBg:"#0891B2",activeItemText:"#ffffff",mobileBg:"#ffffff",primary:"#0891B2",secondary:"#A5F3FC"}},"black-gold":{id:"black-gold",label:"Premium Black & Gold",isDark:!0,colors:{sidebarBg:"#020617",sidebarBorder:"#FACC15",activeItemBg:"#FACC15",activeItemText:"#000000",mobileBg:"#0B0F19",primary:"#FACC15",secondary:"#1F2937"}}},qa=n=>{const e=WM[n]||WM.green;return{...e.colors,isDark:e.isDark}},YJ=({type:n})=>{const e={task_assigned:Gc,task_escalated:Aa,provisional_site_reminder:r3,security:wm,info:du,greeting:v3},t={task_assigned:"text-blue-500 dark:text-blue-400",task_escalated:"text-orange-500 dark:text-orange-400",provisional_site_reminder:"text-purple-500 dark:text-purple-400",security:"text-red-500 dark:text-red-400",info:"text-blue-400 dark:text-blue-300",greeting:"text-yellow-500 dark:text-yellow-400"},r=e[n]||Af;return i.jsx(r,{className:`h-5 w-5 ${t[n]}`})},GJ=({className:n=""})=>{const{notifications:e,unreadCount:t,markAsRead:r,markAllAsRead:s}=uy(),{colorScheme:a}=on();At("(max-width: 767px)");const[o,l]=E.useState(!1),c=E.useRef(null),d=E.useRef(null),h=Nt();E.useEffect(()=>{const v=b=>{c.current&&!c.current.contains(b.target)&&d.current&&!d.current.contains(b.target)&&l(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const p=v=>{r(v.id),v.linkTo&&h(v.linkTo),l(!1)},x=()=>{s()};return i.jsxs("div",{className:`relative notification-bell ${n}`,children:[i.jsxs("button",{ref:d,onClick:()=>l(!o),className:"btn-icon relative p-2 rounded-full hover:bg-page text-muted","aria-label":`Notifications (${t} unread)`,children:[i.jsx(Af,{className:"h-5 w-5"}),t>0&&i.jsx("span",{className:"notification-dot absolute top-0 right-0 block h-2.5 w-2.5 rounded-full bg-red-500"})]}),o&&i4.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[90] md:hidden",onClick:()=>l(!1)}),i.jsxs("div",{ref:c,className:"fixed inset-x-4 top-20 bottom-20 z-[100] flex flex-col bg-white dark:!bg-[#0d1f12] rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-800 md:absolute md:inset-auto md:top-16 md:right-4 md:mt-2 md:w-[400px] md:h-auto md:max-h-[600px] md:bottom-auto animate-in fade-in zoom-in-95 duration-200 overflow-hidden",style:{position:window.innerWidth>=768?"absolute":"fixed"},children:[i.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 dark:border-white/10 bg-gray-50 dark:!bg-[#0d1f12]",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-lg text-gray-900 dark:text-white",children:"Notifications"}),i.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:["You have ",t," unread messages"]})]}),i.jsx("div",{className:"flex items-center gap-2",children:t>0&&i.jsx("span",{onClick:x,className:"relative isolate overflow-hidden before:!content-none after:!content-none text-xs h-8 px-4 flex items-center justify-center rounded-3xl !bg-[#32CD32] hover:!bg-[#28a428] !text-[#0D1A0D] !font-bold cursor-pointer transition-colors",style:{backgroundImage:"none"},children:i.jsx("span",{className:"relative z-10",children:"Mark all read"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-white dark:!bg-[#0d1f12] dark:[color-scheme:dark]",children:e.slice(0,10).length>0?i.jsx("div",{className:"divide-y divide-gray-100 dark:divide-white/20",children:e.slice(0,10).map(v=>i.jsxs("div",{onClick:()=>p(v),className:`group flex items-start gap-4 p-5 cursor-pointer transition-all duration-200 ${v.isRead?"bg-white dark:!bg-[#0d1f12] hover:bg-gray-50 dark:hover:!bg-[#152b1b]":"bg-emerald-50 dark:!bg-[#0d1f12] hover:bg-emerald-100 dark:hover:!bg-[#152b1b]"}`,children:[i.jsx("div",{className:`flex-shrink-0 p-2.5 rounded-full ${v.isRead?"bg-gray-100 dark:bg-[#1a2e1a]":"bg-white dark:bg-[#1a2e1a] shadow-sm"}`,children:i.jsx(YJ,{type:v.type})}),i.jsxs("div",{className:"flex-1 min-w-0 pt-1",children:[i.jsx("p",{className:`text-sm font-medium leading-snug mb-1.5 ${v.isRead?"text-gray-600 dark:text-gray-300":"text-gray-900 dark:text-white"}`,children:v.message}),i.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 flex items-center gap-1",children:mu(new Date(v.createdAt),{addSuffix:!0})})]}),!v.isRead&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 mt-2.5 flex-shrink-0 shadow-[0_0_8px_rgba(16,185,129,0.5)]"})]},v.id))}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center p-8",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-[#1a2e1a] rounded-full flex items-center justify-center mb-4",children:i.jsx(Af,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),i.jsx("h5",{className:"text-gray-900 dark:text-white font-medium mb-1",children:"No notifications"}),i.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"You're all caught up! Check back later."})]})})]})]}),document.body)]})},Kr=({isOpen:n,onClose:e,onConfirm:t,title:r,children:s,confirmButtonVariant:a="danger",confirmButtonText:o="Confirm",isConfirming:l=!1,isLoading:c})=>{if(!n)return null;const d=c!==void 0?c:l;return i.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black bg-opacity-50","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card shadow-card flex flex-col animate-fade-in-scale overflow-hidden w-full h-full sm:w-full sm:h-full sm:max-w-full sm:rounded-none md:w-auto md:h-auto md:max-w-md md:max-h-[90vh] md:rounded-xl",children:[i.jsx("div",{className:"flex-shrink-0 p-6 border-b border-border",children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:r})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsx("div",{className:"text-sm text-muted",children:s})}),i.jsx("div",{className:"flex-shrink-0 p-6 border-t border-border bg-card",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx(ne,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),i.jsx(ne,{onClick:t,variant:a,isLoading:d,children:o})]})})]})})},ZJ=({className:n})=>i.jsxs("svg",{viewBox:"0 0 144 144",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:n,children:[i.jsx("circle",{cx:"72",cy:"72",r:"72",fill:"#F0EBE3"}),i.jsx("path",{d:"M109.5 144H34.5C34.5 119.464 51.18 99 72 99C92.82 99 109.5 119.464 109.5 144Z",fill:"white"}),i.jsx("path",{d:"M84 99C84 105.627 78.6274 111 72 111C65.3726 111 60 105.627 60 99H84Z",fill:"#E1C699"}),i.jsx("path",{d:"M96 87C96 70.4315 85.3726 57 72 57C58.6274 57 48 70.4315 48 87H96Z",fill:"#4A4A4A"}),i.jsx("rect",{x:"62",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"}),i.jsx("rect",{x:"77",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"})]}),xb=[ZJ],Zi=({className:n,photoUrl:e,seed:t})=>{const{user:r}=jt();if(e)return i.jsx("img",{src:e,alt:"Profile",className:`object-cover ${n||""}`});const s=t||r?.id;if(!s){const l=xb[0];return i.jsx(l,{className:`text-muted/60 ${n||""}`})}const a=s.charCodeAt(s.length-1)%xb.length,o=xb[a];return i.jsx(o,{className:n||""})},j3=({setIsMobileMenuOpen:n})=>{const{user:e,logout:t}=jt(),{permissions:r}=na(),{colorScheme:s}=on(),a=Nt(),[o,l]=E.useState(!1),[c,d]=E.useState(!1),h=E.useRef(null),p=At("(max-width: 767px)");Zr(),E.useEffect(()=>{const j=C=>{h.current&&!h.current.contains(C.target)&&l(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]);const x=j=>j.replace(/_/g," ").replace(/\b\w/g,C=>C.toUpperCase()),v=()=>{n?.(!1),l(!1),d(!0)},b=async()=>{d(!1),await t(),a("/auth/login",{replace:!0})},_=qa(s);return i.jsxs(i.Fragment,{children:[i.jsx(Kr,{isOpen:c,onClose:()=>d(!1),onConfirm:b,title:"Confirm Log Out",children:"Are you sure you want to log out?"}),i.jsx("header",{className:`sticky top-0 z-40 ${p?"":"md:bg-gray-50/50 md:border-gray-200/50"} backdrop-blur-md border-b transition-all duration-200`,style:{paddingTop:"env(safe-area-inset-top)",backgroundColor:p?_.sidebarBg:void 0,borderColor:p?_.sidebarBorder:void 0,color:p?"white":void 0},children:i.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center h-16",children:[i.jsx("div",{className:"flex-1 flex justify-center md:justify-start min-w-0 px-2",children:p&&i.jsx("div",{className:"flex items-center justify-center bg-transparent p-2 border-0",children:i.jsx(Xi,{className:"border-0 h-[52px]"})})}),i.jsx("div",{className:"flex-none flex justify-end w-auto min-w-10",children:i.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[i.jsx(GJ,{}),!p&&e&&i.jsxs("div",{className:"relative",ref:h,children:[i.jsxs("button",{onClick:()=>l(!o),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-page transition-colors","aria-expanded":o,"aria-haspopup":"true",children:[i.jsx(Zi,{photoUrl:e.photoUrl,seed:e.id,className:"h-8 w-8 rounded-lg"}),i.jsxs("div",{className:"text-left hidden sm:block",children:[i.jsx("span",{className:"text-sm font-semibold",children:e.name}),i.jsx("span",{className:"text-xs text-muted block",children:x(e.role)})]}),i.jsx(Su,{className:"h-4 w-4 text-muted"})]}),o&&i.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-card rounded-xl shadow-card border border-border py-1 z-40 animate-fade-in-down",role:"menu",children:[i.jsxs(Oa,{to:"/profile",onClick:()=>l(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(Ml,{className:"mr-2 h-4 w-4"}),"Profile"]}),e&&r[e.role]?.includes("apply_for_leave")&&i.jsxs(Oa,{to:"/leaves/dashboard",onClick:()=>l(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(DN,{className:"mr-2 h-4 w-4"}),"Tracker"]}),i.jsxs("button",{onClick:v,className:"flex items-center w-full text-left px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(jo,{className:"mr-2 h-4 w-4"}),"Log Out"]})]})]})]})})]})})})]})},S3=[{to:"/verification/dashboard",label:"All Submissions",icon:d3,permission:"view_all_submissions"},{to:"/developer/api",label:"API Settings",icon:Rm,permission:"view_developer_settings"},{to:"/attendance/dashboard",label:"Attendance",icon:Da,permission:"view_own_attendance"},{to:"/hr/attendance-settings",label:"Attendance Rules",icon:cJ,permission:"manage_attendance_rules"},{to:"/support",label:"Backend Support",icon:Ox,permission:"access_support_desk"},{to:"/hr/entities",label:"Client Management",icon:t3,permission:"view_entity_management"},{to:"/hr/enrollment-rules",label:"Enrollment Rules",icon:r3,permission:"manage_enrollment_rules"},{to:"/hr/policies-and-insurance",label:"Insurance Management",icon:p3,permission:"manage_insurance"},{to:"/billing/summary",label:"Invoice Summary",icon:_J,permission:"view_invoice_summary"},{to:"/billing/cost-analysis",label:"Verification Costing",icon:kl,permission:"view_verification_costing"},{to:"/admin/approval-workflow",label:"Leave Approval Settings",icon:CJ,permission:"manage_approval_workflow"},{to:"/hr/leave-management",label:"Leave Management",icon:TJ,permission:"manage_leave_requests"},{to:"/admin/modules",label:"Module Management",icon:LJ,permission:"manage_modules"},{to:"/onboarding",label:"New Enrollment",icon:Gc,permission:"create_enrollment"},{to:"/operations/dashboard",label:"Operations",icon:oJ,permission:"view_operations_dashboard"},{to:"/profile",label:"Profile",icon:Ml,permission:"view_own_attendance"},{to:"/admin/roles",label:"Role Management",icon:dy,permission:"manage_roles_and_permissions"},{to:"/site/dashboard",label:"Site Dashboard",icon:EC,permission:"view_site_dashboard"},{to:"/admin/sites",label:"Site Management",icon:Ki,permission:"manage_sites"},{to:"/tasks",label:"Task Management",icon:DC,permission:"manage_tasks"},{to:"/uniforms",label:"Uniform Management",icon:Ff,permission:"manage_uniforms"},{to:"/admin/users",label:"User Management",icon:Qi,permission:"manage_users"},{to:"/hr/field-officer-tracking",label:"User Activity Tracking",icon:f3,permission:"view_field_officer_tracking"},{to:"/hr/locations",label:"Geo Locations",icon:Pl,permission:"manage_attendance_rules"},{to:"/attendance/locations",label:"My Locations",icon:AJ,permission:"view_own_attendance"}],KJ=({isCollapsed:n,onLinkClick:e,onExpand:t,hideHeader:r=!1,mode:s="light",isMobile:a=!1})=>{const{user:o}=jt(),{permissions:l}=na(),{colorScheme:c}=on(),{currentLogo:d}=Am();Zr();const h=d&&d!==uf,p=o?S3.filter(b=>l[o.role]?.includes(b.permission)).sort((b,_)=>b.label.localeCompare(_.label)):[],x=qa(c),v=b=>{if(a&&n&&t){b.preventDefault(),t();return}e&&e()};return i.jsxs("div",{className:"flex flex-col",children:[r&&n&&i.jsx("div",{className:"p-4 border-b flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",style:{borderColor:x.sidebarBorder,backgroundColor:x.sidebarBg},children:i.jsxs("button",{onClick:()=>window.location.href="/#/profile",className:"btn-icon inline-flex items-center justify-center p-2 rounded-md text-white hover:bg-white/10 focus:outline-none","aria-label":"Go to profile page",children:[i.jsx("span",{className:"sr-only",children:"Go to profile"}),i.jsx(Fa,{className:"block h-6 w-6"})]})}),r&&!n&&i.jsx("div",{className:"p-4 border-b flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",style:{borderColor:x.sidebarBorder,backgroundColor:x.sidebarBg}}),!r&&i.jsx("div",{className:"p-4 border-b border-gray-200 bg-white flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0 overlay-hidden",children:n?i.jsx("div",{className:"h-8 w-8 overflow-hidden flex items-center justify-center",children:h?i.jsx("img",{src:d,alt:"Logo",className:"h-8 w-auto object-contain"}):i.jsx(Xi,{className:"h-8 max-w-none object-left object-cover"})}):h?i.jsx("img",{src:d,alt:"Logo",className:"h-14 lg:h-16 w-auto object-contain"}):i.jsx(Xi,{className:"h-14 lg:h-16"})}),i.jsx("nav",{className:"px-3 py-4 space-y-1.5",children:p.map(b=>i.jsx(x4,{to:b.to,onClick:v,className:({isActive:_})=>`group flex items-center px-3 py-3 rounded-xl text-sm font-medium transition-all duration-200 ease-in-out ${n?"justify-center":""} ${s==="light"?_?"!text-white shadow-sm border bg-accent":"text-slate-700 hover:bg-gray-100 hover:text-slate-900":_?"!text-white shadow-sm border border-white/5":"text-white hover:bg-white/10 hover:text-white"} ${_&&s==="light"?"nav-active-white":""}`,style:({isActive:_})=>_?s==="light"?{backgroundColor:x.activeItemBg,borderColor:x.sidebarBorder,color:"#ffffff"}:{backgroundColor:x.activeItemBg,color:x.activeItemText}:{},title:b.label,children:({isActive:_})=>i.jsxs(i.Fragment,{children:[i.jsx(b.icon,{className:`h-5 w-5 flex-shrink-0 transition-colors duration-200 ${s==="light"?_?"text-white":"text-slate-500 group-hover:text-slate-700":_?"text-white":"text-white group-hover:text-white"} ${n?"":"mr-3"}`}),!n&&i.jsx("span",{className:_&&s==="light"?"!text-white":"",style:_&&s==="light"?{color:"#ffffff"}:{},children:b.label})]})},b.to))}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .nav-active-white,
                .nav-active-white *,
                a[aria-current="page"] span,
                a[aria-current="page"] svg {
                    color: #ffffff !important;
                }
            `}})]})},JJ=()=>{const{user:n}=jt(),{fetchNotifications:e}=uy(),{permissions:t}=na(),{autoScrollOnHover:r}=_3(),{colorScheme:s}=on();Zr();const a=At("(max-width: 767px)"),o=E.useRef(null),l=E.useRef(null),[c,d]=E.useState(!0),[h,p]=E.useState(0),[x,v]=E.useState(!1);E.useEffect(()=>{d(a)},[a]);const b=E.useCallback(()=>{l.current!==null&&(clearInterval(l.current),l.current=null)},[]),_=E.useCallback(C=>{b();const P=o.current;if(!P)return;const O=()=>{P.scrollBy({top:C==="up"?-window.innerHeight*.8:window.innerHeight*.8,behavior:"smooth"})};O(),l.current=window.setInterval(O,300)},[b]);if(E.useEffect(()=>{const C=()=>{const O=o.current;O&&(v(O.scrollHeight>O.clientHeight),p(O.scrollTop))},P=o.current;return P?.addEventListener("scroll",C,{passive:!0}),window.addEventListener("resize",C),C(),()=>{P?.removeEventListener("scroll",C),window.removeEventListener("resize",C),b()}},[b]),E.useEffect(()=>{n&&e()},[n,e]),!n)return i.jsx(wl,{to:"/auth/login",replace:!0});const j=qa(s);return i.jsxs("div",{className:`flex min-h-screen ${a?j.mobileBg:"bg-page"} ${a?"":"p-4 md:p-6 lg:p-8 gap-4 md:gap-6 lg:gap-8"}`,style:a&&j.isDark?{backgroundColor:j.mobileBg}:{},children:[a&&!c&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 transition-opacity duration-300",onClick:()=>d(!0)}),i.jsxs("aside",{className:`flex flex-col flex-shrink-0 transition-all duration-300 ease-in-out ${a?c?"w-16":"w-64":c?"w-20":"w-72"} ${a?"border-r":"bg-white border-r border-gray-200/60"} ${a?"fixed left-0 top-0 bottom-0 z-50":""}`,style:a?{backgroundColor:j.sidebarBg,borderRightColor:j.sidebarBorder}:void 0,children:[i.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:i.jsx(KJ,{isCollapsed:c,mode:a?"dark":"light",onLinkClick:a?()=>d(!0):void 0,onExpand:()=>d(!1),hideHeader:a,isMobile:a})}),i.jsx("div",{className:`flex-shrink-0 px-2 pt-2 mt-auto flex items-center ${a?"border-t":"border-t border-border"}`,style:a?{borderColor:j.sidebarBorder}:void 0,children:i.jsx("button",{onClick:()=>d(!c),className:`flex-1 flex items-center justify-center p-2 rounded-lg transition-colors ${a?"text-white/70 hover:bg-white/10":"text-muted hover:bg-page"}`,title:c?"Expand sidebar":"Collapse sidebar",children:c?i.jsx(gJ,{className:"h-5 w-5"}):i.jsx(pJ,{className:"h-5 w-5"})})})]}),i.jsxs("div",{className:`flex-1 flex flex-col ${a?"":"bg-gray-50/50"} ${a&&c?"ml-16":""}`,style:a?{backgroundColor:j.mobileBg}:void 0,children:[i.jsx(j3,{}),i.jsx("main",{ref:o,className:`flex-1 overflow-y-auto ${a?"":"bg-page"}`,style:a&&j.isDark?{backgroundColor:j.mobileBg}:void 0,children:i.jsx("div",{className:"p-4",children:i.jsx(Sf,{})})})]}),x&&!a&&i.jsxs("div",{className:"fixed bottom-8 right-8 z-50 flex flex-col gap-2 no-print",children:[i.jsx(ne,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:r?()=>_("up"):void 0,onMouseLeave:b,onMouseDown:()=>_("up"),onMouseUp:b,onTouchStart:()=>_("up"),onTouchEnd:b,disabled:h<=0,"aria-label":"Scroll Up",children:i.jsx(mJ,{className:"h-5 w-5"})}),i.jsx(ne,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:r?()=>_("down"):void 0,onMouseLeave:b,onMouseDown:()=>_("down"),onMouseUp:b,onTouchStart:()=>_("down"),onTouchEnd:b,disabled:o.current?Math.ceil(o.current.clientHeight+h)>=o.current.scrollHeight:!1,"aria-label":"Scroll Down",children:i.jsx(Su,{className:"h-5 w-5"})})]})]})},QJ=()=>{const{user:n}=jt(),{permissions:e}=na(),{colorScheme:t}=on();if(!n)return null;const r=e[n.role]||[],s=[{to:"/mobile-home",label:"Home",icon:EC,show:!0},{to:"/attendance/dashboard",label:"Attendance",icon:dJ,show:r.includes("view_own_attendance")},{to:"/tasks",label:"Tasks",icon:DC,show:r.includes("manage_tasks")},{to:"/profile",label:"Profile",icon:Ml,show:!0}],a=t!=="green"?{bg:"#FFFFFF",border:"#e2e8f0",activeText:"#1a3a6e",inactiveText:"text-slate-400"}:{bg:"#041b0f",border:"#1f3d2b",activeText:"#22c55e",inactiveText:"text-gray-400"};return i.jsx("nav",{id:"mobile-bottom-nav",className:"fixed bottom-0 left-0 right-0 z-40 transition-colors duration-300",style:{paddingBottom:"env(safe-area-inset-bottom)",backgroundColor:a.bg,borderTopColor:a.border,borderTopWidth:"1px"},children:i.jsx("div",{className:"flex justify-around items-center h-16",children:s.filter(o=>o.show).map(o=>i.jsxs(x4,{to:o.to,className:({isActive:l})=>`flex flex-col items-center justify-center flex-1 h-full transition-colors ${l?"":a.inactiveText}`,style:({isActive:l})=>l?{color:a.activeText}:{},children:[i.jsx(o.icon,{className:"w-6 h-6"}),i.jsx("span",{className:"text-xs mt-1",children:o.label})]},o.to))})})},XJ=()=>{const{colorScheme:n}=on(),[e,t]=E.useState(!0),r=E.useRef(0),s=E.useRef(!1);E.useEffect(()=>{const o=()=>{s.current||(window.requestAnimationFrame(()=>{const l=window.scrollY;l<r.current||l<10?t(!0):l>r.current&&l>10&&t(!1),r.current=l,s.current=!1}),s.current=!0)};return window.addEventListener("scroll",o,{passive:!0}),()=>window.removeEventListener("scroll",o)},[]);const a=qa(n);return i.jsxs("div",{className:"flex flex-col min-h-screen",style:{backgroundColor:a.mobileBg},children:[i.jsx("div",{className:`sticky top-0 z-50 transition-transform duration-200 ${e?"translate-y-0":"-translate-y-full"}`,children:i.jsx(j3,{})}),i.jsx("main",{className:"flex-1 overflow-y-auto px-4 pt-2",style:{paddingBottom:"calc(9.1rem + env(safe-area-inset-bottom))",backgroundColor:a.mobileBg},children:i.jsx(Sf,{})}),i.jsx(QJ,{})]})},eQ=["https://picsum.photos/seed/corporate_campus/1200/900","https://picsum.photos/seed/luxury_complex/1200/900","https://picsum.photos/seed/office_interior/1200/900","https://picsum.photos/seed/landscaping/1200/900","https://picsum.photos/seed/lobby_design/1200/900"],N3=ea(ju((n,e)=>({backgroundImages:eQ,addBackgroundImage:t=>{const r=e();return r.backgroundImages.includes(t)?!1:(n({backgroundImages:[...r.backgroundImages,t]}),!0)},removeBackgroundImage:t=>n(r=>({backgroundImages:r.backgroundImages.filter((s,a)=>a!==t)}))}),{name:"paradigm-auth-layout-settings",storage:ed(()=>localStorage)})),tQ=()=>{const{backgroundImages:n}=N3(),[e,t]=E.useState(0),r=Zr();E.useEffect(()=>{if(n.length>1){const o=setInterval(()=>{t(l=>(l+1)%n.length)},5e3);return()=>clearInterval(o)}},[n.length]);const s=E.useMemo(()=>n&&n.length>0?n:["https://picsum.photos/seed/default_fallback_1/1200/900"],[n]),a=E.useMemo(()=>r.pathname.includes("signup")?{title:"Create an Account",subtitle:"Join our platform to get started."}:r.pathname.includes("forgot-password")?{title:"Forgot Password?",subtitle:"No worries, we'll send you reset instructions."}:r.pathname.includes("update-password")?{title:"Set a New Password",subtitle:"Please enter your new password."}:{title:"Sign In",subtitle:"Enter your credentials to access your account."},[r.pathname]);return i.jsxs("div",{className:"min-h-screen font-sans flex items-center justify-center bg-page relative overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[s.map((o,l)=>i.jsx("div",{className:`absolute inset-0 w-full h-full bg-cover bg-center transition-opacity duration-1000 ease-in-out ${l===e?"opacity-100":"opacity-0"}`,style:{backgroundImage:`url(${o})`}},l)),i.jsx("div",{className:"absolute inset-0 bg-black/30"})," "]}),i.jsx("div",{className:"relative w-full max-w-3xl lg:max-w-4xl xl:max-w-5xl p-4",children:i.jsxs("div",{className:"auth-card-container w-full grid md:grid-cols-2 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-md bg-black/40 border border-white/10",children:[i.jsxs("div",{className:"hidden md:flex flex-col justify-between p-6 lg:p-10 xl:p-16 bg-gradient-to-br from-black/40 to-black/70",children:[i.jsxs("div",{className:"flex flex-col items-center text-center",children:[i.jsx(Xi,{className:"h-10 lg:h-14 xl:h-24"}),i.jsx("h1",{className:"text-xl lg:text-2xl xl:text-4xl font-bold !text-white mt-6 lg:mt-8 leading-tight drop-shadow-lg relative z-10",style:{color:"#ffffff",textShadow:"0 2px 4px rgba(0,0,0,0.5)"},children:"Welcome to the Future of Onboarding."}),i.jsx("p",{className:"!text-white mt-4 max-w-md drop-shadow-lg text-xs lg:text-sm xl:text-base relative z-10",style:{color:"#ffffff",textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:"Streamlining the journey for every new member of the Paradigm family."})]}),i.jsx("div",{children:i.jsxs("p",{className:"!text-white text-[10px] lg:text-xs mt-4",style:{color:"#ffffff"},children:[" ",new Date().getFullYear()," Paradigm Services. All rights reserved."]})})]}),i.jsx("div",{className:"p-6 lg:p-10 xl:p-16 flex flex-col justify-center bg-[#050505]/85 backdrop-blur-xl border-l border-white/10 !text-white",children:i.jsxs("div",{className:"w-full max-w-md mx-auto",children:[i.jsx("div",{className:"md:hidden flex justify-center mb-8",children:i.jsx(Xi,{className:"h-12"})}),i.jsx("h2",{className:"text-xl lg:text-2xl xl:text-3xl font-bold !text-white mb-2",style:{color:"#ffffff"},children:a.title}),i.jsx("p",{className:"!text-white mb-4 lg:mb-6 xl:mb-8 text-xs lg:text-sm xl:text-base",style:{color:"#ffffff"},children:a.subtitle}),i.jsx(Sf,{})]})})]})})]})};function nQ(){const[n,e]=E.useState({isSecure:!0,issues:[],developerModeEnabled:!1,locationSpoofingDetected:!1});return E.useEffect(()=>{const t=()=>{const s=[];let a=!1,o=!1;("geolocation"in navigator,!1)&&(o=!0,s.push("Location spoofing detected. Please disable location mocking apps to continue."));const c=s.length===0;e({isSecure:c,issues:s,developerModeEnabled:a,locationSpoofingDetected:o})};t();const r=setInterval(t,2e3);return window.addEventListener("resize",t),()=>{clearInterval(r),window.removeEventListener("resize",t)}},[]),n}const rQ=({issues:n,onDismiss:e})=>{const[t,r]=E.useState(!1);return E.useEffect(()=>{const s=()=>{r(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),t?i.jsx("div",{className:"fixed inset-0 z-50 bg-white overflow-y-auto",children:i.jsxs("div",{className:"min-h-screen p-4 flex flex-col",children:[i.jsx("div",{className:"flex justify-center mt-8 mb-6",children:i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(wm,{className:"w-8 h-8 text-red-600"})})}),i.jsx("h2",{className:"text-xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),i.jsxs("div",{className:"space-y-3 mb-4",children:[i.jsx("p",{className:"text-gray-700 text-center text-sm",children:"Access to this application has been temporarily blocked for security reasons:"}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:i.jsx("ul",{className:"space-y-2",children:n.map((s,a)=>i.jsxs("li",{className:"flex items-start gap-2 text-xs text-red-800",children:[i.jsx(Aa,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:s})]},a))})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2 text-sm",children:"To continue:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs text-blue-800",children:[i.jsx("li",{children:"Close browser developer tools (F12)"}),i.jsx("li",{children:"Disable any location spoofing apps or extensions"}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:i.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&i.jsx(ne,{onClick:e,variant:"outline",className:"w-full mt-auto",size:"sm",children:"I Understand"})]})}):i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 animate-in fade-in zoom-in duration-300",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(wm,{className:"w-10 h-10 text-red-600"})})}),i.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),i.jsxs("div",{className:"space-y-3 mb-6",children:[i.jsx("p",{className:"text-gray-700 text-center",children:"Access to this application has been temporarily blocked for security reasons:"}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsx("ul",{className:"space-y-2",children:n.map((s,a)=>i.jsxs("li",{className:"flex items-start gap-2 text-sm text-red-800",children:[i.jsx(Aa,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:s})]},a))})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"To continue:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[i.jsx("li",{children:"Close browser developer tools (F12)"}),i.jsx("li",{children:"Disable any location spoofing apps or extensions"}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6",children:i.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&i.jsx(ne,{onClick:e,variant:"outline",className:"w-full",children:"I Understand"})]})})},sQ=({children:n})=>{const{user:e}=jt(),t=nQ(),[r,s]=E.useState(!1),a=e&&(e.role==="admin"||e.role==="developer");return E.useEffect(()=>{if(e&&!a&&!t.isSecure&&!r){const o=t.developerModeEnabled?"developer_mode":"location_spoofing";ce.sendSecurityAlert(e.id,e.name,o,void 0).catch(l=>console.error("Failed to send security alert:",l)),s(!0)}},[e,t,r,a]),e&&!a&&!t.isSecure?i.jsx(rQ,{issues:t.issues}):i.jsx(i.Fragment,{children:n})};var qf;(function(n){n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE"})(qf||(qf={}));class vf extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const iQ=n=>{var e,t;return n?.androidBridge?"android":!((t=(e=n?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},aQ=n=>{const e=n.CapacitorCustomPlatform||null,t=n.Capacitor||{},r=t.Plugins=t.Plugins||{},s=()=>e!==null?e.name:iQ(n),a=()=>s()!=="web",o=p=>{const x=d.get(p);return!!(x?.platforms.has(s())||l(p))},l=p=>{var x;return(x=t.PluginHeaders)===null||x===void 0?void 0:x.find(v=>v.name===p)},c=p=>n.console.error(p),d=new Map,h=(p,x={})=>{const v=d.get(p);if(v)return console.warn(`Capacitor plugin "${p}" already registered. Cannot register plugins twice.`),v.proxy;const b=s(),_=l(p);let j;const C=async()=>(!j&&b in x?j=typeof x[b]=="function"?j=await x[b]():j=x[b]:e!==null&&!j&&"web"in x&&(j=typeof x.web=="function"?j=await x.web():j=x.web),j),P=(q,U)=>{var B,W;if(_){const Y=_?.methods.find(G=>U===G.name);if(Y)return Y.rtype==="promise"?G=>t.nativePromise(p,U.toString(),G):(G,Z)=>t.nativeCallback(p,U.toString(),G,Z);if(q)return(B=q[U])===null||B===void 0?void 0:B.bind(q)}else{if(q)return(W=q[U])===null||W===void 0?void 0:W.bind(q);throw new vf(`"${p}" plugin is not implemented on ${b}`,qf.Unimplemented)}},O=q=>{let U;const B=(...W)=>{const Y=C().then(G=>{const Z=P(G,q);if(Z){const oe=Z(...W);return U=oe?.remove,oe}else throw new vf(`"${p}.${q}()" is not implemented on ${b}`,qf.Unimplemented)});return q==="addListener"&&(Y.remove=async()=>U()),Y};return B.toString=()=>`${q.toString()}() { [capacitor code] }`,Object.defineProperty(B,"name",{value:q,writable:!1,configurable:!1}),B},M=O("addListener"),D=O("removeListener"),I=(q,U)=>{const B=M({eventName:q},U),W=async()=>{const G=await B;D({eventName:q,callbackId:G},U)},Y=new Promise(G=>B.then(()=>G({remove:W})));return Y.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await W()},Y},F=new Proxy({},{get(q,U){switch(U){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return _?I:M;case"removeListener":return D;default:return O(U)}}});return r[p]=F,d.set(p,{name:p,proxy:F,platforms:new Set([...Object.keys(x),..._?[b]:[]])}),F};return t.convertFileSrc||(t.convertFileSrc=p=>p),t.getPlatform=s,t.handleError=c,t.isNativePlatform=a,t.isPluginAvailable=o,t.registerPlugin=h,t.Exception=vf,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},oQ=n=>n.Capacitor=aQ(n),Rx=oQ(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),rd=Rx.registerPlugin;class RC{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,t);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const s=this.listeners[e];if(!s){if(r){let a=this.retainedEventArguments[e];a||(a=[]),a.push(t),this.retainedEventArguments[e]=a}return}s.forEach(a=>a(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new Rx.Exception(e,qf.Unimplemented)}unavailable(e="not available"){return new Rx.Exception(e,qf.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const s=r.indexOf(t);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}}const $M=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),HM=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class lQ extends RC{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,a]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=HM(s).trim(),a=HM(a).trim(),t[s]=a}),t}async setCookie(e){try{const t=$M(e.key),r=$M(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,a=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${s}; path=${a}; ${o};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}rd("CapacitorCookies",{web:()=>new lQ});const cQ=async n=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>t(s),r.readAsDataURL(n)}),dQ=(n={})=>{const e=Object.keys(n);return Object.keys(n).map(s=>s.toLocaleLowerCase()).reduce((s,a,o)=>(s[a]=n[e[o]],s),{})},uQ=(n,e=!0)=>n?Object.entries(n).reduce((r,s)=>{const[a,o]=s;let l,c;return Array.isArray(o)?(c="",o.forEach(d=>{l=e?encodeURIComponent(d):d,c+=`${a}=${l}&`}),c.slice(0,-1)):(l=e?encodeURIComponent(o):o,c=`${a}=${l}`),`${r}&${c}`},"").substr(1):null,fQ=(n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),s=dQ(n.headers)["content-type"]||"";if(typeof n.data=="string")t.body=n.data;else if(s.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[o,l]of Object.entries(n.data||{}))a.set(o,l);t.body=a.toString()}else if(s.includes("multipart/form-data")||n.data instanceof FormData){const a=new FormData;if(n.data instanceof FormData)n.data.forEach((l,c)=>{a.append(c,l)});else for(const l of Object.keys(n.data))a.append(l,n.data[l]);t.body=a;const o=new Headers(t.headers);o.delete("content-type"),t.headers=o}else(s.includes("application/json")||typeof n.data=="object")&&(t.body=JSON.stringify(n.data));return t};class hQ extends RC{async request(e){const t=fQ(e,e.webFetchExtra),r=uQ(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,a=await fetch(s,t),o=a.headers.get("content-type")||"";let{responseType:l="text"}=a.ok?e:{};o.includes("application/json")&&(l="json");let c,d;switch(l){case"arraybuffer":case"blob":d=await a.blob(),c=await cQ(d);break;case"json":c=await a.json();break;case"document":case"text":default:c=await a.text()}const h={};return a.headers.forEach((p,x)=>{h[x]=p}),{data:c,headers:h,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}rd("CapacitorHttp",{web:()=>new hQ});function mQ(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return new Proxy({},{get(r,s){return(a,o,l)=>{const c=n.Capacitor.Plugins[t];if(c===void 0){l(new Error(`Capacitor plugin ${t} not found`));return}if(typeof c[s]!="function"){l(new Error(`Method ${s} not found in Capacitor plugin ${t}`));return}(async()=>{try{const d=await c[s](a);o(d)}catch(d){l(d)}})()}}})}})}function pQ(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return n.cordova.plugins[t]}})}function C3(n=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!n?mQ(window):window.cordova!==void 0&&pQ(window))}const gQ=rd("Geolocation",{web:()=>Cf(()=>import("./web-ryl8Y7_a.js"),[],import.meta.url).then(n=>new n.GeolocationWeb)});C3();var ff;(function(n){n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS"})(ff||(ff={}));var rm;(function(n){n.Rear="REAR",n.Front="FRONT"})(rm||(rm={}));var YM;(function(n){n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl"})(YM||(YM={}));class xQ extends RC{async getPhoto(e){return new Promise(async(t,r)=>{if(e.webUseInput||e.source===ff.Photos)this.fileInputExperience(e,t,r);else if(e.source===ff.Prompt){let s=document.querySelector("pwa-action-sheet");s||(s=document.createElement("pwa-action-sheet"),document.body.appendChild(s)),s.header=e.promptLabelHeader||"Photo",s.cancelable=!1,s.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],s.addEventListener("onSelection",async a=>{a.detail===0?this.fileInputExperience(e,t,r):this.cameraExperience(e,t,r)})}else this.cameraExperience(e,t,r)})}async pickImages(e){return new Promise(async(t,r)=>{this.multipleFileInputExperience(t,r)})}async cameraExperience(e,t,r){if(customElements.get("pwa-camera-modal")){const s=document.createElement("pwa-camera-modal");s.facingMode=e.direction===rm.Front?"user":"environment",document.body.appendChild(s);try{await s.componentOnReady(),s.addEventListener("onPhoto",async a=>{const o=a.detail;o===null?r(new vf("User cancelled photos app")):o instanceof Error?r(o):t(await this._getCameraPhoto(o,e)),s.dismiss(),document.body.removeChild(s)}),s.present()}catch{this.fileInputExperience(e,t,r)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,t,r)}fileInputExperience(e,t,r){let s=document.querySelector("#_capacitor-camera-input");const a=()=>{var o;(o=s.parentNode)===null||o===void 0||o.removeChild(s)};s||(s=document.createElement("input"),s.id="_capacitor-camera-input",s.type="file",s.hidden=!0,document.body.appendChild(s),s.addEventListener("change",o=>{const l=s.files[0];let c="jpeg";if(l.type==="image/png"?c="png":l.type==="image/gif"&&(c="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){const d=new FileReader;d.addEventListener("load",()=>{if(e.resultType==="dataUrl")t({dataUrl:d.result,format:c});else if(e.resultType==="base64"){const h=d.result.split(",")[1];t({base64String:h,format:c})}a()}),d.readAsDataURL(l)}else t({webPath:URL.createObjectURL(l),format:c}),a()}),s.addEventListener("cancel",o=>{r(new vf("User cancelled photos app")),a()})),s.accept="image/*",s.capture=!0,e.source===ff.Photos||e.source===ff.Prompt?s.removeAttribute("capture"):e.direction===rm.Front?s.capture="user":e.direction===rm.Rear&&(s.capture="environment"),s.click()}multipleFileInputExperience(e,t){let r=document.querySelector("#_capacitor-camera-input-multiple");const s=()=>{var a;(a=r.parentNode)===null||a===void 0||a.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input-multiple",r.type="file",r.hidden=!0,r.multiple=!0,document.body.appendChild(r),r.addEventListener("change",a=>{const o=[];for(let l=0;l<r.files.length;l++){const c=r.files[l];let d="jpeg";c.type==="image/png"?d="png":c.type==="image/gif"&&(d="gif"),o.push({webPath:URL.createObjectURL(c),format:d})}e({photos:o}),s()}),r.addEventListener("cancel",a=>{t(new vf("User cancelled photos app")),s()})),r.accept="image/*",r.click()}_getCameraPhoto(e,t){return new Promise((r,s)=>{const a=new FileReader,o=e.type.split("/")[1];t.resultType==="uri"?r({webPath:URL.createObjectURL(e),format:o,saved:!1}):(a.readAsDataURL(e),a.onloadend=()=>{const l=a.result;t.resultType==="dataUrl"?r({dataUrl:l,format:o,saved:!1}):r({base64String:l.split(",")[1],format:o,saved:!1})},a.onerror=l=>{s(l)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const yQ=rd("Camera",{web:()=>new xQ}),vQ=rd("PushNotifications",{});var GM;(function(n){n.Documents="DOCUMENTS",n.Data="DATA",n.Library="LIBRARY",n.Cache="CACHE",n.External="EXTERNAL",n.ExternalStorage="EXTERNAL_STORAGE",n.ExternalCache="EXTERNAL_CACHE",n.LibraryNoCloud="LIBRARY_NO_CLOUD",n.Temporary="TEMPORARY"})(GM||(GM={}));var ZM;(function(n){n.UTF8="utf8",n.ASCII="ascii",n.UTF16="utf16"})(ZM||(ZM={}));const bQ=rd("Filesystem",{web:()=>Cf(()=>import("./web-BDQw4jJx.js"),[],import.meta.url).then(n=>new n.FilesystemWeb)});C3();const KM=rd("App",{web:()=>Cf(()=>import("./web-DGTvdw-b.js"),[],import.meta.url).then(n=>new n.AppWeb)}),wQ=rd("SecurityCheck"),_Q=({children:n})=>{const[e,t]=E.useState({location:!1,camera:!1,notification:!1,microphone:!1,storage:!1,calendar:!1,contacts:!1,activity:!1}),[r,s]=E.useState({developerMode:!1}),[a,o]=E.useState(!0),l=Rx.isNativePlatform(),c=async()=>{if(!l){o(!1);return}try{let p=!1,x=!1,v=!1,b=!1,_=!1,j=!1;try{const U=await wQ.getSecurityStatus();p=U.developerMode,x=U.microphoneGranted===!0,v=U.calendarGranted===!0,b=U.contactsGranted===!0,_=U.filesGranted===!0,j=U.activityGranted===!0}catch(U){console.warn("Failed to check security status or plugin not available",U)}const C=await gQ.checkPermissions(),P=C.location==="granted"||C.coarseLocation==="granted",O=await yQ.checkPermissions(),M=O.camera==="granted"||O.photos==="granted";let D=!1;try{D=(await vQ.checkPermissions()).receive==="granted"}catch(U){console.warn("Push details not available or failed",U)}const F=(await bQ.checkPermissions()).publicStorage==="granted";t({location:P,camera:M,notification:D,storage:F,microphone:x,calendar:v,contacts:b,activity:j}),s({developerMode:p})}catch(p){console.error("Error checking permissions:",p)}finally{o(!1)}};if(E.useEffect(()=>{c();const p=KM.addListener("appStateChange",({isActive:x})=>{x&&c()});return()=>{p.then(x=>x.remove())}},[l]),!l)return i.jsx(i.Fragment,{children:n});if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})});if(r.developerMode)return i.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-50 px-6 text-center animate-fade-in",children:i.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl max-w-sm w-full border-2 border-red-500",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-red-50 ring-8 ring-red-50/50",children:i.jsx("svg",{className:"h-10 w-10 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})}),i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Security Alert"}),i.jsx("p",{className:"text-gray-600 mb-6 text-sm leading-relaxed",children:"Developer Options are enabled on this device."}),i.jsxs("div",{className:"bg-red-50 rounded-lg p-4 mb-6 text-left border border-red-100",children:[i.jsx("p",{className:"text-xs text-red-800 font-medium mb-1",children:"Action Required"}),i.jsxs("p",{className:"text-xs text-red-600",children:["Please disable ",i.jsx("strong",{children:"Developer Options"})," in your device settings to continue using the application securely."]})]}),i.jsx("button",{onClick:()=>c(),className:"w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-3.5 px-4 rounded-xl shadow-lg shadow-red-600/20 transition-all duration-200 active:scale-[0.98]",children:"Retry Check"})]})});if(e.location&&e.camera&&e.notification&&e.storage&&e.microphone&&e.calendar&&e.contacts&&e.activity)return i.jsx(i.Fragment,{children:n});const h=async()=>{try{await KM.openAppSettings()}catch(p){console.error("Failed to open settings",p)}};return i.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-900 px-6 text-center animate-fade-in",children:i.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-2xl max-w-sm w-full border-4 border-red-600 relative overflow-hidden",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-red-50 ring-8 ring-red-50/50",children:i.jsx("svg",{className:"h-10 w-10 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})}),i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Permissions Access"}),i.jsx("p",{className:"text-gray-500 mb-6 text-sm leading-relaxed",children:"This app requires full access to function. Please grant the following permissions in Settings."}),i.jsxs("div",{className:"w-full space-y-3 mb-8 text-left text-sm max-h-[320px] overflow-y-auto pr-1",children:[i.jsx(Cc,{label:"Location",granted:e.location}),i.jsx(Cc,{label:"Camera",granted:e.camera}),i.jsx(Cc,{label:"Notifications",granted:e.notification}),i.jsx(Cc,{label:"Microphone",granted:e.microphone}),i.jsx(Cc,{label:"Files & Media",granted:e.storage}),i.jsx(Cc,{label:"Calendar",granted:e.calendar}),i.jsx(Cc,{label:"Contacts",granted:e.contacts}),i.jsx(Cc,{label:"Physical Activity",granted:e.activity})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:h,className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-4 rounded-xl shadow-lg shadow-red-600/20 transition-all duration-200 active:scale-[0.98] uppercase tracking-wide text-sm",children:"Grant Access"}),i.jsx("button",{onClick:c,className:"text-gray-500 text-xs hover:text-gray-700 underline underline-offset-2",children:"I have granted them, Check Again"})]})]})})},Cc=({label:n,granted:e})=>i.jsxs("div",{className:"flex justify-between items-center py-2.5 px-3 rounded-lg bg-gray-50 border border-gray-100",children:[i.jsx("span",{className:"font-medium text-gray-700 text-sm",children:n}),e?i.jsx("svg",{className:"h-5 w-5 text-emerald-500",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):i.jsx("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded-full bg-red-100 text-red-600 tracking-wide uppercase",children:"Required"})]}),jQ=({onComplete:n})=>{const e=At("(max-width: 767px)"),{colorScheme:t}=on(),[r,s]=E.useState("prompt"),[a,o]=E.useState("prompt"),[l,c]=E.useState(!1),[d,h]=E.useState(null),p=r==="granted"&&a==="granted",x=t==="blue",v=x?"bg-[#1a3a6e]":"bg-white",b=x?"text-white":"text-gray-600",_=x?"text-white":"text-gray-900",j=x?"bg-white/10 border-white/20":"bg-gray-100 border-gray-300",C=x?"text-white":"text-gray-900",P=x?"text-gray-300":"text-gray-600";E.useEffect(()=>{(!e||p)&&n()},[e,p,n]);const O=async()=>{c(!0),h(null);try{try{const M=await navigator.mediaDevices.getUserMedia({video:!0});o("granted"),M.getTracks().forEach(D=>D.stop())}catch{throw o("denied"),new Error("Camera permission was denied.")}try{await new Promise((M,D)=>{navigator.geolocation.getCurrentPosition(()=>{s("granted"),M(!0)},()=>{s("denied"),D(new Error("Location permission was denied."))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})}catch{throw new Error("Location permission was denied.")}n()}catch(M){h(M.message||"Permissions are required to use this app.")}finally{c(!1)}};return e?i.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center p-4 text-center ${v}`,children:[i.jsx("div",{className:"splash-logo",children:i.jsx(Xi,{className:"h-16 mb-8"})}),i.jsxs("div",{className:"max-w-md",children:[i.jsx("h1",{className:`text-2xl font-bold mb-4 ${_}`,children:"Permissions Required"}),i.jsx("p",{className:`mb-8 ${b}`,children:"To ensure the best experience and enable features like location-based check-ins and photo uploads, we need access to your device's Camera and Location."}),i.jsxs("div",{className:"space-y-4 mb-8",children:[i.jsxs("div",{className:`p-4 rounded-lg border ${r==="granted"?"bg-emerald-500/20 border-emerald-500 text-emerald-100":j}`,children:[i.jsx("p",{className:`font-semibold ${C}`,children:"Location Access"}),i.jsx("p",{className:`text-sm ${P}`,children:r==="granted"?"Permission Granted":"Needed for check-in/out"})]}),i.jsxs("div",{className:`p-4 rounded-lg border ${a==="granted"?"bg-emerald-500/20 border-emerald-500 text-emerald-100":j}`,children:[i.jsx("p",{className:`font-semibold ${C}`,children:"Camera Access"}),i.jsx("p",{className:`text-sm ${P}`,children:a==="granted"?"Permission Granted":"Needed for identity verification"})]})]}),i.jsx(ne,{onClick:O,disabled:l,className:x?"w-full bg-white text-[#1a3a6e] hover:bg-gray-100":"w-full",children:l?"Requesting...":"Grant Permissions"}),d&&i.jsx("p",{className:"text-red-500 mt-4",children:d}),i.jsx("p",{className:`text-xs mt-8 ${x?"text-white/50":"text-gray-500"}`,children:"You can manage these permissions in your device settings at any time."})]})]}):null},SQ=()=>{const[n,e]=E.useState(!1),t=()=>{e(!0)};return n?i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4",children:[i.jsx("div",{className:"splash-logo",children:i.jsx(Xi,{className:"h-16 mb-8"})}),i.jsx("p",{className:"text-gray-600",children:"Loading Application..."})]}):i.jsx(jQ,{onComplete:t})},NQ=()=>{const{user:n,logout:e}=jt(),{permissions:t}=na(),{colorScheme:r}=on(),s=Nt(),a=qa(r);if(!n)return null;const o=S3.filter(c=>t[n.role]?.includes(c.permission)).sort((c,d)=>c.label.localeCompare(d.label)),l=async()=>{await e(),s("/auth/login")};return i.jsxs("div",{className:"min-h-[calc(100vh-180px)] flex flex-col pb-4",style:{backgroundColor:a.mobileBg},children:[i.jsx("div",{className:"border p-6 rounded-3xl shadow-lg -mx-4 mb-6",style:{backgroundColor:a.sidebarBg,borderColor:a.sidebarBorder},children:i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"rounded-full border-2",style:{borderColor:a.primary},children:i.jsx(Zi,{photoUrl:n.photoUrl,seed:n.id,className:"h-14 w-14 rounded-full"})}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold text-white",children:["Hi, ",n.name.split(" ")[0]]}),i.jsx("p",{className:"text-xs text-white/70 uppercase tracking-wider",children:n.role.replace(/_/g," ")})]})]})})}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsx("h2",{className:"text-lg font-semibold mb-4 px-2",style:{color:a.isDark?"white":"#111827"},children:"Apps & Features"}),i.jsx("div",{className:"grid grid-cols-3 gap-3 px-2 flex-1 content-start",children:o.map(c=>i.jsxs("div",{onClick:()=>s(c.to),className:"flex flex-col items-center justify-center p-4 border rounded-2xl active:scale-95 transition-transform duration-150 shadow-md min-h-[110px]",style:{backgroundColor:a.sidebarBg,borderColor:a.sidebarBorder},children:[i.jsx("div",{className:"p-3 rounded-full mb-2",style:{backgroundColor:a.mobileBg==="#ffffff"?a.activeItemBg+"20":a.mobileBg,color:a.primary},children:i.jsx(c.icon,{className:"w-7 h-7"})}),i.jsx("span",{className:"text-xs text-center font-medium leading-tight",style:{color:a.isDark||a.sidebarBg!=="#ffffff"?"white":"#1e293b"},children:c.label})]},c.to))})]}),i.jsx("div",{className:"px-2 mt-6",children:i.jsxs("button",{onClick:l,className:"w-full flex items-center justify-center space-x-2 p-4 rounded-xl font-semibold active:scale-95 transition-all text-white shadow-lg",style:{backgroundColor:"#1f2937"},children:[i.jsx(jo,{className:"w-5 h-5"}),i.jsx("span",{children:"Log Out"})]})})]})};var Lm=n=>n.type==="checkbox",lu=n=>n instanceof Date,Hs=n=>n==null;const T3=n=>typeof n=="object";var wr=n=>!Hs(n)&&!Array.isArray(n)&&T3(n)&&!lu(n),k3=n=>wr(n)&&n.target?Lm(n.target)?n.target.checked:n.target.value:n,CQ=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,P3=(n,e)=>n.has(CQ(e)),TQ=n=>{const e=n.constructor&&n.constructor.prototype;return wr(e)&&e.hasOwnProperty("isPrototypeOf")},LC=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Un(n){let e;const t=Array.isArray(n),r=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(LC&&(n instanceof Blob||r))&&(t||wr(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!TQ(n))e=n;else for(const s in n)n.hasOwnProperty(s)&&(e[s]=Un(n[s]));else return n;return e}var fy=n=>/^\w*$/.test(n),Fn=n=>n===void 0,hy=n=>Array.isArray(n)?n.filter(Boolean):[],FC=n=>hy(n.replace(/["|']|\]/g,"").split(/\.|\[/)),tt=(n,e,t)=>{if(!e||!wr(n))return t;const r=(fy(e)?[e]:FC(e)).reduce((s,a)=>Hs(s)?s:s[a],n);return Fn(r)||r===n?Fn(n[e])?t:n[e]:r},mi=n=>typeof n=="boolean",gn=(n,e,t)=>{let r=-1;const s=fy(e)?[e]:FC(e),a=s.length,o=a-1;for(;++r<a;){const l=s[r];let c=t;if(r!==o){const d=n[l];c=wr(d)||Array.isArray(d)?d:isNaN(+s[r+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=c,n=n[l]}};const Lx={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Gi={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},fl={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},M3=ot.createContext(null);M3.displayName="HookFormContext";const my=()=>ot.useContext(M3);var E3=(n,e,t,r=!0)=>{const s={defaultValues:e._defaultValues};for(const a in n)Object.defineProperty(s,a,{get:()=>{const o=a;return e._proxyFormState[o]!==Gi.all&&(e._proxyFormState[o]=!r||Gi.all),t&&(t[o]=!0),n[o]}});return s};const py=typeof window<"u"?ot.useLayoutEffect:ot.useEffect;function kQ(n){const e=my(),{control:t=e.control,disabled:r,name:s,exact:a}=n||{},[o,l]=ot.useState(t._formState),c=ot.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return py(()=>t._subscribe({name:s,formState:c.current,exact:a,callback:d=>{!r&&l({...t._formState,...d})}}),[s,r,a]),ot.useEffect(()=>{c.current.isValid&&t._setValid(!0)},[t]),ot.useMemo(()=>E3(o,t,c.current,!1),[o,t])}var yi=n=>typeof n=="string",FN=(n,e,t,r,s)=>yi(n)?(r&&e.watch.add(n),tt(t,n,s)):Array.isArray(n)?n.map(a=>(r&&e.watch.add(a),tt(t,a))):(r&&(e.watchAll=!0),t),qN=n=>Hs(n)||!T3(n);function Ta(n,e,t=new WeakSet){if(qN(n)||qN(e))return n===e;if(lu(n)&&lu(e))return n.getTime()===e.getTime();const r=Object.keys(n),s=Object.keys(e);if(r.length!==s.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const a of r){const o=n[a];if(!s.includes(a))return!1;if(a!=="ref"){const l=e[a];if(lu(o)&&lu(l)||wr(o)&&wr(l)||Array.isArray(o)&&Array.isArray(l)?!Ta(o,l,t):o!==l)return!1}}return!0}function uu(n){const e=my(),{control:t=e.control,name:r,defaultValue:s,disabled:a,exact:o,compute:l}=n||{},c=ot.useRef(s),d=ot.useRef(l),h=ot.useRef(void 0),p=ot.useRef(t),x=ot.useRef(r);d.current=l;const[v,b]=ot.useState(()=>{const M=t._getWatch(r,c.current);return d.current?d.current(M):M}),_=ot.useCallback(M=>{const D=FN(r,t._names,M||t._formValues,!1,c.current);return d.current?d.current(D):D},[t._formValues,t._names,r]),j=ot.useCallback(M=>{if(!a){const D=FN(r,t._names,M||t._formValues,!1,c.current);if(d.current){const I=d.current(D);Ta(I,h.current)||(b(I),h.current=I)}else b(D)}},[t._formValues,t._names,a,r]);py(()=>((p.current!==t||!Ta(x.current,r))&&(p.current=t,x.current=r,j()),t._subscribe({name:r,formState:{values:!0},exact:o,callback:M=>{j(M.values)}})),[t,o,r,j]),ot.useEffect(()=>t._removeUnmounted());const C=p.current!==t,P=x.current,O=ot.useMemo(()=>{if(a)return null;const M=!C&&!Ta(P,r);return C||M?_():null},[a,C,r,P,_]);return O!==null?O:v}function PQ(n){const e=my(),{name:t,disabled:r,control:s=e.control,shouldUnregister:a,defaultValue:o}=n,l=P3(s._names.array,t),c=ot.useMemo(()=>tt(s._formValues,t,tt(s._defaultValues,t,o)),[s,t,o]),d=uu({control:s,name:t,defaultValue:c,exact:!0}),h=kQ({control:s,name:t,exact:!0}),p=ot.useRef(n),x=ot.useRef(void 0),v=ot.useRef(s.register(t,{...n.rules,value:d,...mi(n.disabled)?{disabled:n.disabled}:{}}));p.current=n;const b=ot.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!tt(h.errors,t)},isDirty:{enumerable:!0,get:()=>!!tt(h.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!tt(h.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!tt(h.validatingFields,t)},error:{enumerable:!0,get:()=>tt(h.errors,t)}}),[h,t]),_=ot.useCallback(O=>v.current.onChange({target:{value:k3(O),name:t},type:Lx.CHANGE}),[t]),j=ot.useCallback(()=>v.current.onBlur({target:{value:tt(s._formValues,t),name:t},type:Lx.BLUR}),[t,s._formValues]),C=ot.useCallback(O=>{const M=tt(s._fields,t);M&&O&&(M._f.ref={focus:()=>O.focus&&O.focus(),select:()=>O.select&&O.select(),setCustomValidity:D=>O.setCustomValidity(D),reportValidity:()=>O.reportValidity()})},[s._fields,t]),P=ot.useMemo(()=>({name:t,value:d,...mi(r)||h.disabled?{disabled:h.disabled||r}:{},onChange:_,onBlur:j,ref:C}),[t,r,h.disabled,_,j,C,d]);return ot.useEffect(()=>{const O=s._options.shouldUnregister||a,M=x.current;M&&M!==t&&!l&&s.unregister(M),s.register(t,{...p.current.rules,...mi(p.current.disabled)?{disabled:p.current.disabled}:{}});const D=(I,F)=>{const q=tt(s._fields,I);q&&q._f&&(q._f.mount=F)};if(D(t,!0),O){const I=Un(tt(s._options.defaultValues,t,p.current.defaultValue));gn(s._defaultValues,t,I),Fn(tt(s._formValues,t))&&gn(s._formValues,t,I)}return!l&&s.register(t),x.current=t,()=>{(l?O&&!s._state.action:O)?s.unregister(t):D(t,!1)}},[t,s,l,a]),ot.useEffect(()=>{s._setDisabledField({disabled:r,name:t})},[r,t,s]),ot.useMemo(()=>({field:P,formState:h,fieldState:b}),[P,h,b])}const _e=n=>n.render(PQ(n));var D3=(n,e,t,r,s)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[r]:s||!0}}:{},Zs=n=>Array.isArray(n)?n:[n],JM=()=>{let n=[];return{get observers(){return n},next:s=>{for(const a of n)a.next&&a.next(s)},subscribe:s=>(n.push(s),{unsubscribe:()=>{n=n.filter(a=>a!==s)}}),unsubscribe:()=>{n=[]}}};function O3(n,e){const t={};for(const r in n)if(n.hasOwnProperty(r)){const s=n[r],a=e[r];if(s&&wr(s)&&a){const o=O3(s,a);wr(o)&&(t[r]=o)}else n[r]&&(t[r]=a)}return t}var as=n=>wr(n)&&!Object.keys(n).length,qC=n=>n.type==="file",ka=n=>typeof n=="function",Fx=n=>{if(!LC)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},I3=n=>n.type==="select-multiple",zC=n=>n.type==="radio",MQ=n=>zC(n)||Lm(n),yb=n=>Fx(n)&&n.isConnected;function EQ(n,e){const t=e.slice(0,-1).length;let r=0;for(;r<t;)n=Fn(n)?r++:n[e[r++]];return n}function DQ(n){for(const e in n)if(n.hasOwnProperty(e)&&!Fn(n[e]))return!1;return!0}function or(n,e){const t=Array.isArray(e)?e:fy(e)?[e]:FC(e),r=t.length===1?n:EQ(n,t),s=t.length-1,a=t[s];return r&&delete r[a],s!==0&&(wr(r)&&as(r)||Array.isArray(r)&&DQ(r))&&or(n,t.slice(0,-1)),n}var OQ=n=>{for(const e in n)if(ka(n[e]))return!0;return!1};function A3(n){return Array.isArray(n)||wr(n)&&!OQ(n)}function zN(n,e={}){for(const t in n)A3(n[t])?(e[t]=Array.isArray(n[t])?[]:{},zN(n[t],e[t])):Fn(n[t])||(e[t]=!0);return e}function cf(n,e,t){t||(t=zN(e));for(const r in n)A3(n[r])?Fn(e)||qN(t[r])?t[r]=zN(n[r],Array.isArray(n[r])?[]:{}):cf(n[r],Hs(e)?{}:e[r],t[r]):t[r]=!Ta(n[r],e[r]);return t}const QM={value:!1,isValid:!1},XM={value:!0,isValid:!0};var R3=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!Fn(n[0].attributes.value)?Fn(n[0].value)||n[0].value===""?XM:{value:n[0].value,isValid:!0}:XM:QM}return QM},L3=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:r})=>Fn(n)?n:e?n===""?NaN:n&&+n:t&&yi(n)?new Date(n):r?r(n):n;const eE={isValid:!1,value:null};var F3=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,eE):eE;function tE(n){const e=n.ref;return qC(e)?e.files:zC(e)?F3(n.refs).value:I3(e)?[...e.selectedOptions].map(({value:t})=>t):Lm(e)?R3(n.refs).value:L3(Fn(e.value)?n.ref.value:e.value,n)}var IQ=(n,e,t,r)=>{const s={};for(const a of n){const o=tt(e,a);o&&gn(s,a,o._f)}return{criteriaMode:t,names:[...n],fields:s,shouldUseNativeValidation:r}},qx=n=>n instanceof RegExp,Ch=n=>Fn(n)?n:qx(n)?n.source:wr(n)?qx(n.value)?n.value.source:n.value:n,hf=n=>({isOnSubmit:!n||n===Gi.onSubmit,isOnBlur:n===Gi.onBlur,isOnChange:n===Gi.onChange,isOnAll:n===Gi.all,isOnTouch:n===Gi.onTouched});const nE="AsyncFunction";var AQ=n=>!!n&&!!n.validate&&!!(ka(n.validate)&&n.validate.constructor.name===nE||wr(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===nE)),RQ=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),UN=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(r=>n.startsWith(r)&&/^\.\w+/.test(n.slice(r.length))));const bf=(n,e,t,r)=>{for(const s of t||Object.keys(n)){const a=tt(n,s);if(a){const{_f:o,...l}=a;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],s)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(bf(l,e))break}else if(wr(l)&&bf(l,e))break}}};function rE(n,e,t){const r=tt(n,t);if(r||fy(t))return{error:r,name:t};const s=t.split(".");for(;s.length;){const a=s.join("."),o=tt(e,a),l=tt(n,a);if(o&&!Array.isArray(o)&&t!==a)return{name:t};if(l&&l.type)return{name:a,error:l};if(l&&l.root&&l.root.type)return{name:`${a}.root`,error:l.root};s.pop()}return{name:t}}var LQ=(n,e,t,r)=>{t(n);const{name:s,...a}=n;return as(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(o=>e[o]===(!r||Gi.all))},FQ=(n,e,t)=>!n||!e||n===e||Zs(n).some(r=>r&&(t?r===e:r.startsWith(e)||e.startsWith(r))),qQ=(n,e,t,r,s)=>s.isOnAll?!1:!t&&s.isOnTouch?!(e||n):(t?r.isOnBlur:s.isOnBlur)?!n:(t?r.isOnChange:s.isOnChange)?n:!0,zQ=(n,e)=>!hy(tt(n,e)).length&&or(n,e),q3=(n,e,t)=>{const r=Zs(tt(n,t));return gn(r,"root",e[t]),gn(n,t,r),n};function sE(n,e,t="validate"){if(yi(n)||Array.isArray(n)&&n.every(yi)||mi(n)&&!n)return{type:t,message:yi(n)?n:"",ref:e}}var ef=n=>wr(n)&&!qx(n)?n:{value:n,message:""},BN=async(n,e,t,r,s,a)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:h,min:p,max:x,pattern:v,validate:b,name:_,valueAsNumber:j,mount:C}=n._f,P=tt(t,_);if(!C||e.has(_))return{};const O=l?l[0]:o,M=Y=>{s&&O.reportValidity&&(O.setCustomValidity(mi(Y)?"":Y||""),O.reportValidity())},D={},I=zC(o),F=Lm(o),q=I||F,U=(j||qC(o))&&Fn(o.value)&&Fn(P)||Fx(o)&&o.value===""||P===""||Array.isArray(P)&&!P.length,B=D3.bind(null,_,r,D),W=(Y,G,Z,oe=fl.maxLength,X=fl.minLength)=>{const he=Y?G:Z;D[_]={type:Y?oe:X,message:he,ref:o,...B(Y?oe:X,he)}};if(a?!Array.isArray(P)||!P.length:c&&(!q&&(U||Hs(P))||mi(P)&&!P||F&&!R3(l).isValid||I&&!F3(l).isValid)){const{value:Y,message:G}=yi(c)?{value:!!c,message:c}:ef(c);if(Y&&(D[_]={type:fl.required,message:G,ref:O,...B(fl.required,G)},!r))return M(G),D}if(!U&&(!Hs(p)||!Hs(x))){let Y,G;const Z=ef(x),oe=ef(p);if(!Hs(P)&&!isNaN(P)){const X=o.valueAsNumber||P&&+P;Hs(Z.value)||(Y=X>Z.value),Hs(oe.value)||(G=X<oe.value)}else{const X=o.valueAsDate||new Date(P),he=te=>new Date(new Date().toDateString()+" "+te),$=o.type=="time",K=o.type=="week";yi(Z.value)&&P&&(Y=$?he(P)>he(Z.value):K?P>Z.value:X>new Date(Z.value)),yi(oe.value)&&P&&(G=$?he(P)<he(oe.value):K?P<oe.value:X<new Date(oe.value))}if((Y||G)&&(W(!!Y,Z.message,oe.message,fl.max,fl.min),!r))return M(D[_].message),D}if((d||h)&&!U&&(yi(P)||a&&Array.isArray(P))){const Y=ef(d),G=ef(h),Z=!Hs(Y.value)&&P.length>+Y.value,oe=!Hs(G.value)&&P.length<+G.value;if((Z||oe)&&(W(Z,Y.message,G.message),!r))return M(D[_].message),D}if(v&&!U&&yi(P)){const{value:Y,message:G}=ef(v);if(qx(Y)&&!P.match(Y)&&(D[_]={type:fl.pattern,message:G,ref:o,...B(fl.pattern,G)},!r))return M(G),D}if(b){if(ka(b)){const Y=await b(P,t),G=sE(Y,O);if(G&&(D[_]={...G,...B(fl.validate,G.message)},!r))return M(G.message),D}else if(wr(b)){let Y={};for(const G in b){if(!as(Y)&&!r)break;const Z=sE(await b[G](P,t),O,G);Z&&(Y={...Z,...B(G,Z.message)},M(Z.message),r&&(D[_]=Y))}if(!as(Y)&&(D[_]={ref:O,...Y},!r))return D}}return M(!0),D};const UQ={mode:Gi.onSubmit,reValidateMode:Gi.onChange,shouldFocusError:!0};function BQ(n={}){let e={...UQ,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:ka(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},s=wr(e.defaultValues)||wr(e.values)?Un(e.defaultValues||e.values)||{}:{},a=e.shouldUnregister?{}:Un(s),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...h};const x={array:JM(),state:JM()},v=e.criteriaMode===Gi.all,b=ee=>se=>{clearTimeout(d),d=setTimeout(ee,se)},_=async ee=>{if(!e.disabled&&(h.isValid||p.isValid||ee)){const se=e.resolver?as((await F()).errors):await U(r,!0);se!==t.isValid&&x.state.next({isValid:se})}},j=(ee,se)=>{!e.disabled&&(h.isValidating||h.validatingFields||p.isValidating||p.validatingFields)&&((ee||Array.from(l.mount)).forEach(xe=>{xe&&(se?gn(t.validatingFields,xe,se):or(t.validatingFields,xe))}),x.state.next({validatingFields:t.validatingFields,isValidating:!as(t.validatingFields)}))},C=(ee,se=[],xe,ke,Ie=!0,Re=!0)=>{if(ke&&xe&&!e.disabled){if(o.action=!0,Re&&Array.isArray(tt(r,ee))){const nt=xe(tt(r,ee),ke.argA,ke.argB);Ie&&gn(r,ee,nt)}if(Re&&Array.isArray(tt(t.errors,ee))){const nt=xe(tt(t.errors,ee),ke.argA,ke.argB);Ie&&gn(t.errors,ee,nt),zQ(t.errors,ee)}if((h.touchedFields||p.touchedFields)&&Re&&Array.isArray(tt(t.touchedFields,ee))){const nt=xe(tt(t.touchedFields,ee),ke.argA,ke.argB);Ie&&gn(t.touchedFields,ee,nt)}(h.dirtyFields||p.dirtyFields)&&(t.dirtyFields=cf(s,a)),x.state.next({name:ee,isDirty:W(ee,se),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else gn(a,ee,se)},P=(ee,se)=>{gn(t.errors,ee,se),x.state.next({errors:t.errors})},O=ee=>{t.errors=ee,x.state.next({errors:t.errors,isValid:!1})},M=(ee,se,xe,ke)=>{const Ie=tt(r,ee);if(Ie){const Re=tt(a,ee,Fn(xe)?tt(s,ee):xe);Fn(Re)||ke&&ke.defaultChecked||se?gn(a,ee,se?Re:tE(Ie._f)):Z(ee,Re),o.mount&&_()}},D=(ee,se,xe,ke,Ie)=>{let Re=!1,nt=!1;const Xe={name:ee};if(!e.disabled){if(!xe||ke){(h.isDirty||p.isDirty)&&(nt=t.isDirty,t.isDirty=Xe.isDirty=W(),Re=nt!==Xe.isDirty);const ht=Ta(tt(s,ee),se);nt=!!tt(t.dirtyFields,ee),ht?or(t.dirtyFields,ee):gn(t.dirtyFields,ee,!0),Xe.dirtyFields=t.dirtyFields,Re=Re||(h.dirtyFields||p.dirtyFields)&&nt!==!ht}if(xe){const ht=tt(t.touchedFields,ee);ht||(gn(t.touchedFields,ee,xe),Xe.touchedFields=t.touchedFields,Re=Re||(h.touchedFields||p.touchedFields)&&ht!==xe)}Re&&Ie&&x.state.next(Xe)}return Re?Xe:{}},I=(ee,se,xe,ke)=>{const Ie=tt(t.errors,ee),Re=(h.isValid||p.isValid)&&mi(se)&&t.isValid!==se;if(e.delayError&&xe?(c=b(()=>P(ee,xe)),c(e.delayError)):(clearTimeout(d),c=null,xe?gn(t.errors,ee,xe):or(t.errors,ee)),(xe?!Ta(Ie,xe):Ie)||!as(ke)||Re){const nt={...ke,...Re&&mi(se)?{isValid:se}:{},errors:t.errors,name:ee};t={...t,...nt},x.state.next(nt)}},F=async ee=>{j(ee,!0);const se=await e.resolver(a,e.context,IQ(ee||l.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return j(ee),se},q=async ee=>{const{errors:se}=await F(ee);if(ee)for(const xe of ee){const ke=tt(se,xe);ke?gn(t.errors,xe,ke):or(t.errors,xe)}else t.errors=se;return se},U=async(ee,se,xe={valid:!0})=>{for(const ke in ee){const Ie=ee[ke];if(Ie){const{_f:Re,...nt}=Ie;if(Re){const Xe=l.array.has(Re.name),ht=Ie._f&&AQ(Ie._f);ht&&h.validatingFields&&j([Re.name],!0);const Bt=await BN(Ie,l.disabled,a,v,e.shouldUseNativeValidation&&!se,Xe);if(ht&&h.validatingFields&&j([Re.name]),Bt[Re.name]&&(xe.valid=!1,se))break;!se&&(tt(Bt,Re.name)?Xe?q3(t.errors,Bt,Re.name):gn(t.errors,Re.name,Bt[Re.name]):or(t.errors,Re.name))}!as(nt)&&await U(nt,se,xe)}}return xe.valid},B=()=>{for(const ee of l.unMount){const se=tt(r,ee);se&&(se._f.refs?se._f.refs.every(xe=>!yb(xe)):!yb(se._f.ref))&&re(ee)}l.unMount=new Set},W=(ee,se)=>!e.disabled&&(ee&&se&&gn(a,ee,se),!Ta(te(),s)),Y=(ee,se,xe)=>FN(ee,l,{...o.mount?a:Fn(se)?s:yi(ee)?{[ee]:se}:se},xe,se),G=ee=>hy(tt(o.mount?a:s,ee,e.shouldUnregister?tt(s,ee,[]):[])),Z=(ee,se,xe={})=>{const ke=tt(r,ee);let Ie=se;if(ke){const Re=ke._f;Re&&(!Re.disabled&&gn(a,ee,L3(se,Re)),Ie=Fx(Re.ref)&&Hs(se)?"":se,I3(Re.ref)?[...Re.ref.options].forEach(nt=>nt.selected=Ie.includes(nt.value)):Re.refs?Lm(Re.ref)?Re.refs.forEach(nt=>{(!nt.defaultChecked||!nt.disabled)&&(Array.isArray(Ie)?nt.checked=!!Ie.find(Xe=>Xe===nt.value):nt.checked=Ie===nt.value||!!Ie)}):Re.refs.forEach(nt=>nt.checked=nt.value===Ie):qC(Re.ref)?Re.ref.value="":(Re.ref.value=Ie,Re.ref.type||x.state.next({name:ee,values:Un(a)})))}(xe.shouldDirty||xe.shouldTouch)&&D(ee,Ie,xe.shouldTouch,xe.shouldDirty,!0),xe.shouldValidate&&K(ee)},oe=(ee,se,xe)=>{for(const ke in se){if(!se.hasOwnProperty(ke))return;const Ie=se[ke],Re=ee+"."+ke,nt=tt(r,Re);(l.array.has(ee)||wr(Ie)||nt&&!nt._f)&&!lu(Ie)?oe(Re,Ie,xe):Z(Re,Ie,xe)}},X=(ee,se,xe={})=>{const ke=tt(r,ee),Ie=l.array.has(ee),Re=Un(se);gn(a,ee,Re),Ie?(x.array.next({name:ee,values:Un(a)}),(h.isDirty||h.dirtyFields||p.isDirty||p.dirtyFields)&&xe.shouldDirty&&x.state.next({name:ee,dirtyFields:cf(s,a),isDirty:W(ee,Re)})):ke&&!ke._f&&!Hs(Re)?oe(ee,Re,xe):Z(ee,Re,xe),UN(ee,l)&&x.state.next({...t,name:ee}),x.state.next({name:o.mount?ee:void 0,values:Un(a)})},he=async ee=>{o.mount=!0;const se=ee.target;let xe=se.name,ke=!0;const Ie=tt(r,xe),Re=ht=>{ke=Number.isNaN(ht)||lu(ht)&&isNaN(ht.getTime())||Ta(ht,tt(a,xe,ht))},nt=hf(e.mode),Xe=hf(e.reValidateMode);if(Ie){let ht,Bt;const lt=se.type?tE(Ie._f):k3(ee),Wt=ee.type===Lx.BLUR||ee.type===Lx.FOCUS_OUT,Yt=!RQ(Ie._f)&&!e.resolver&&!tt(t.errors,xe)&&!Ie._f.deps||qQ(Wt,tt(t.touchedFields,xe),t.isSubmitted,Xe,nt),Qt=UN(xe,l,Wt);gn(a,xe,lt),Wt?(!se||!se.readOnly)&&(Ie._f.onBlur&&Ie._f.onBlur(ee),c&&c(0)):Ie._f.onChange&&Ie._f.onChange(ee);const Gt=D(xe,lt,Wt),ln=!as(Gt)||Qt;if(!Wt&&x.state.next({name:xe,type:ee.type,values:Un(a)}),Yt)return(h.isValid||p.isValid)&&(e.mode==="onBlur"?Wt&&_():Wt||_()),ln&&x.state.next({name:xe,...Qt?{}:Gt});if(!Wt&&Qt&&x.state.next({...t}),e.resolver){const{errors:rn}=await F([xe]);if(Re(lt),ke){const Et=rE(t.errors,r,xe),qn=rE(rn,r,Et.name||xe);ht=qn.error,xe=qn.name,Bt=as(rn)}}else j([xe],!0),ht=(await BN(Ie,l.disabled,a,v,e.shouldUseNativeValidation))[xe],j([xe]),Re(lt),ke&&(ht?Bt=!1:(h.isValid||p.isValid)&&(Bt=await U(r,!0)));ke&&(Ie._f.deps&&(!Array.isArray(Ie._f.deps)||Ie._f.deps.length>0)&&K(Ie._f.deps),I(xe,Bt,ht,Gt))}},$=(ee,se)=>{if(tt(t.errors,se)&&ee.focus)return ee.focus(),1},K=async(ee,se={})=>{let xe,ke;const Ie=Zs(ee);if(e.resolver){const Re=await q(Fn(ee)?ee:Ie);xe=as(Re),ke=ee?!Ie.some(nt=>tt(Re,nt)):xe}else ee?(ke=(await Promise.all(Ie.map(async Re=>{const nt=tt(r,Re);return await U(nt&&nt._f?{[Re]:nt}:nt)}))).every(Boolean),!(!ke&&!t.isValid)&&_()):ke=xe=await U(r);return x.state.next({...!yi(ee)||(h.isValid||p.isValid)&&xe!==t.isValid?{}:{name:ee},...e.resolver||!ee?{isValid:xe}:{},errors:t.errors}),se.shouldFocus&&!ke&&bf(r,$,ee?Ie:l.mount),ke},te=(ee,se)=>{let xe={...o.mount?a:s};return se&&(xe=O3(se.dirtyFields?t.dirtyFields:t.touchedFields,xe)),Fn(ee)?xe:yi(ee)?tt(xe,ee):ee.map(ke=>tt(xe,ke))},H=(ee,se)=>({invalid:!!tt((se||t).errors,ee),isDirty:!!tt((se||t).dirtyFields,ee),error:tt((se||t).errors,ee),isValidating:!!tt(t.validatingFields,ee),isTouched:!!tt((se||t).touchedFields,ee)}),ae=ee=>{ee&&Zs(ee).forEach(se=>or(t.errors,se)),x.state.next({errors:ee?t.errors:{}})},le=(ee,se,xe)=>{const ke=(tt(r,ee,{_f:{}})._f||{}).ref,Ie=tt(t.errors,ee)||{},{ref:Re,message:nt,type:Xe,...ht}=Ie;gn(t.errors,ee,{...ht,...se,ref:ke}),x.state.next({name:ee,errors:t.errors,isValid:!1}),xe&&xe.shouldFocus&&ke&&ke.focus&&ke.focus()},ue=(ee,se)=>ka(ee)?x.state.subscribe({next:xe=>"values"in xe&&ee(Y(void 0,se),xe)}):Y(ee,se,!0),ie=ee=>x.state.subscribe({next:se=>{FQ(ee.name,se.name,ee.exact)&&LQ(se,ee.formState||h,be,ee.reRenderRoot)&&ee.callback({values:{...a},...t,...se,defaultValues:s})}}).unsubscribe,pe=ee=>(o.mount=!0,p={...p,...ee.formState},ie({...ee,formState:p})),re=(ee,se={})=>{for(const xe of ee?Zs(ee):l.mount)l.mount.delete(xe),l.array.delete(xe),se.keepValue||(or(r,xe),or(a,xe)),!se.keepError&&or(t.errors,xe),!se.keepDirty&&or(t.dirtyFields,xe),!se.keepTouched&&or(t.touchedFields,xe),!se.keepIsValidating&&or(t.validatingFields,xe),!e.shouldUnregister&&!se.keepDefaultValue&&or(s,xe);x.state.next({values:Un(a)}),x.state.next({...t,...se.keepDirty?{isDirty:W()}:{}}),!se.keepIsValid&&_()},de=({disabled:ee,name:se})=>{(mi(ee)&&o.mount||ee||l.disabled.has(se))&&(ee?l.disabled.add(se):l.disabled.delete(se))},je=(ee,se={})=>{let xe=tt(r,ee);const ke=mi(se.disabled)||mi(e.disabled);return gn(r,ee,{...xe||{},_f:{...xe&&xe._f?xe._f:{ref:{name:ee}},name:ee,mount:!0,...se}}),l.mount.add(ee),xe?de({disabled:mi(se.disabled)?se.disabled:e.disabled,name:ee}):M(ee,!0,se.value),{...ke?{disabled:se.disabled||e.disabled}:{},...e.progressive?{required:!!se.required,min:Ch(se.min),max:Ch(se.max),minLength:Ch(se.minLength),maxLength:Ch(se.maxLength),pattern:Ch(se.pattern)}:{},name:ee,onChange:he,onBlur:he,ref:Ie=>{if(Ie){je(ee,se),xe=tt(r,ee);const Re=Fn(Ie.value)&&Ie.querySelectorAll&&Ie.querySelectorAll("input,select,textarea")[0]||Ie,nt=MQ(Re),Xe=xe._f.refs||[];if(nt?Xe.find(ht=>ht===Re):Re===xe._f.ref)return;gn(r,ee,{_f:{...xe._f,...nt?{refs:[...Xe.filter(yb),Re,...Array.isArray(tt(s,ee))?[{}]:[]],ref:{type:Re.type,name:ee}}:{ref:Re}}}),M(ee,!1,void 0,Re)}else xe=tt(r,ee,{}),xe._f&&(xe._f.mount=!1),(e.shouldUnregister||se.shouldUnregister)&&!(P3(l.array,ee)&&o.action)&&l.unMount.add(ee)}}},Ae=()=>e.shouldFocusError&&bf(r,$,l.mount),Te=ee=>{mi(ee)&&(x.state.next({disabled:ee}),bf(r,(se,xe)=>{const ke=tt(r,xe);ke&&(se.disabled=ke._f.disabled||ee,Array.isArray(ke._f.refs)&&ke._f.refs.forEach(Ie=>{Ie.disabled=ke._f.disabled||ee}))},0,!1))},Se=(ee,se)=>async xe=>{let ke;xe&&(xe.preventDefault&&xe.preventDefault(),xe.persist&&xe.persist());let Ie=Un(a);if(x.state.next({isSubmitting:!0}),e.resolver){const{errors:Re,values:nt}=await F();t.errors=Re,Ie=Un(nt)}else await U(r);if(l.disabled.size)for(const Re of l.disabled)or(Ie,Re);if(or(t.errors,"root"),as(t.errors)){x.state.next({errors:{}});try{await ee(Ie,xe)}catch(Re){ke=Re}}else se&&await se({...t.errors},xe),Ae(),setTimeout(Ae);if(x.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:as(t.errors)&&!ke,submitCount:t.submitCount+1,errors:t.errors}),ke)throw ke},Pe=(ee,se={})=>{tt(r,ee)&&(Fn(se.defaultValue)?X(ee,Un(tt(s,ee))):(X(ee,se.defaultValue),gn(s,ee,Un(se.defaultValue))),se.keepTouched||or(t.touchedFields,ee),se.keepDirty||(or(t.dirtyFields,ee),t.isDirty=se.defaultValue?W(ee,Un(tt(s,ee))):W()),se.keepError||(or(t.errors,ee),h.isValid&&_()),x.state.next({...t}))},qe=(ee,se={})=>{const xe=ee?Un(ee):s,ke=Un(xe),Ie=as(ee),Re=Ie?s:ke;if(se.keepDefaultValues||(s=xe),!se.keepValues){if(se.keepDirtyValues){const nt=new Set([...l.mount,...Object.keys(cf(s,a))]);for(const Xe of Array.from(nt))tt(t.dirtyFields,Xe)?gn(Re,Xe,tt(a,Xe)):X(Xe,tt(Re,Xe))}else{if(LC&&Fn(ee))for(const nt of l.mount){const Xe=tt(r,nt);if(Xe&&Xe._f){const ht=Array.isArray(Xe._f.refs)?Xe._f.refs[0]:Xe._f.ref;if(Fx(ht)){const Bt=ht.closest("form");if(Bt){Bt.reset();break}}}}if(se.keepFieldsRef)for(const nt of l.mount)X(nt,tt(Re,nt));else r={}}a=e.shouldUnregister?se.keepDefaultValues?Un(s):{}:Un(Re),x.array.next({values:{...Re}}),x.state.next({values:{...Re}})}l={mount:se.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!h.isValid||!!se.keepIsValid||!!se.keepDirtyValues||!e.shouldUnregister&&!as(Re),o.watch=!!e.shouldUnregister,x.state.next({submitCount:se.keepSubmitCount?t.submitCount:0,isDirty:Ie?!1:se.keepDirty?t.isDirty:!!(se.keepDefaultValues&&!Ta(ee,s)),isSubmitted:se.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:Ie?{}:se.keepDirtyValues?se.keepDefaultValues&&a?cf(s,a):t.dirtyFields:se.keepDefaultValues&&ee?cf(s,ee):se.keepDirty?t.dirtyFields:{},touchedFields:se.keepTouched?t.touchedFields:{},errors:se.keepErrors?t.errors:{},isSubmitSuccessful:se.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},He=(ee,se)=>qe(ka(ee)?ee(a):ee,se),ze=(ee,se={})=>{const xe=tt(r,ee),ke=xe&&xe._f;if(ke){const Ie=ke.refs?ke.refs[0]:ke.ref;Ie.focus&&(Ie.focus(),se.shouldSelect&&ka(Ie.select)&&Ie.select())}},be=ee=>{t={...t,...ee}},Ve={control:{register:je,unregister:re,getFieldState:H,handleSubmit:Se,setError:le,_subscribe:ie,_runSchema:F,_focusError:Ae,_getWatch:Y,_getDirty:W,_setValid:_,_setFieldArray:C,_setDisabledField:de,_setErrors:O,_getFieldArray:G,_reset:qe,_resetDefaultValues:()=>ka(e.defaultValues)&&e.defaultValues().then(ee=>{He(ee,e.resetOptions),x.state.next({isLoading:!1})}),_removeUnmounted:B,_disableForm:Te,_subjects:x,_proxyFormState:h,get _fields(){return r},get _formValues(){return a},get _state(){return o},set _state(ee){o=ee},get _defaultValues(){return s},get _names(){return l},set _names(ee){l=ee},get _formState(){return t},get _options(){return e},set _options(ee){e={...e,...ee}}},subscribe:pe,trigger:K,register:je,handleSubmit:Se,watch:ue,setValue:X,getValues:te,reset:He,resetField:Pe,clearErrors:ae,unregister:re,setError:le,setFocus:ze,getFieldState:H};return{...Ve,formControl:Ve}}var Tc=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const n=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=(Math.random()*16+n)%16|0;return(e=="x"?t:t&3|8).toString(16)})},vb=(n,e,t={})=>t.shouldFocus||Fn(t.shouldFocus)?t.focusName||`${n}.${Fn(t.focusIndex)?e:t.focusIndex}.`:"",bb=(n,e)=>[...n,...Zs(e)],wb=n=>Array.isArray(n)?n.map(()=>{}):void 0;function _b(n,e,t){return[...n.slice(0,e),...Zs(t),...n.slice(e)]}var jb=(n,e,t)=>Array.isArray(n)?(Fn(n[t])&&(n[t]=void 0),n.splice(t,0,n.splice(e,1)[0]),n):[],Sb=(n,e)=>[...Zs(e),...Zs(n)];function VQ(n,e){let t=0;const r=[...n];for(const s of e)r.splice(s-t,1),t++;return hy(r).length?r:[]}var Nb=(n,e)=>Fn(e)?[]:VQ(n,Zs(e).sort((t,r)=>t-r)),Cb=(n,e,t)=>{[n[e],n[t]]=[n[t],n[e]]},iE=(n,e,t)=>(n[e]=t,n);function js(n){const e=my(),{control:t=e.control,name:r,keyName:s="id",shouldUnregister:a,rules:o}=n,[l,c]=ot.useState(t._getFieldArray(r)),d=ot.useRef(t._getFieldArray(r).map(Tc)),h=ot.useRef(!1);t._names.array.add(r),ot.useMemo(()=>o&&l.length>=0&&t.register(r,o),[t,r,l.length,o]),py(()=>t._subjects.array.subscribe({next:({values:M,name:D})=>{if(D===r||!D){const I=tt(M,r);Array.isArray(I)&&(c(I),d.current=I.map(Tc))}}}).unsubscribe,[t,r]);const p=ot.useCallback(M=>{h.current=!0,t._setFieldArray(r,M)},[t,r]),x=(M,D)=>{const I=Zs(Un(M)),F=bb(t._getFieldArray(r),I);t._names.focus=vb(r,F.length-1,D),d.current=bb(d.current,I.map(Tc)),p(F),c(F),t._setFieldArray(r,F,bb,{argA:wb(M)})},v=(M,D)=>{const I=Zs(Un(M)),F=Sb(t._getFieldArray(r),I);t._names.focus=vb(r,0,D),d.current=Sb(d.current,I.map(Tc)),p(F),c(F),t._setFieldArray(r,F,Sb,{argA:wb(M)})},b=M=>{const D=Nb(t._getFieldArray(r),M);d.current=Nb(d.current,M),p(D),c(D),!Array.isArray(tt(t._fields,r))&&gn(t._fields,r,void 0),t._setFieldArray(r,D,Nb,{argA:M})},_=(M,D,I)=>{const F=Zs(Un(D)),q=_b(t._getFieldArray(r),M,F);t._names.focus=vb(r,M,I),d.current=_b(d.current,M,F.map(Tc)),p(q),c(q),t._setFieldArray(r,q,_b,{argA:M,argB:wb(D)})},j=(M,D)=>{const I=t._getFieldArray(r);Cb(I,M,D),Cb(d.current,M,D),p(I),c(I),t._setFieldArray(r,I,Cb,{argA:M,argB:D},!1)},C=(M,D)=>{const I=t._getFieldArray(r);jb(I,M,D),jb(d.current,M,D),p(I),c(I),t._setFieldArray(r,I,jb,{argA:M,argB:D},!1)},P=(M,D)=>{const I=Un(D),F=iE(t._getFieldArray(r),M,I);d.current=[...F].map((q,U)=>!q||U===M?Tc():d.current[U]),p(F),c([...F]),t._setFieldArray(r,F,iE,{argA:M,argB:I},!0,!1)},O=M=>{const D=Zs(Un(M));d.current=D.map(Tc),p([...D]),c([...D]),t._setFieldArray(r,[...D],I=>I,{},!0,!1)};return ot.useEffect(()=>{if(t._state.action=!1,UN(r,t._names)&&t._subjects.state.next({...t._formState}),h.current&&(!hf(t._options.mode).isOnSubmit||t._formState.isSubmitted)&&!hf(t._options.reValidateMode).isOnSubmit)if(t._options.resolver)t._runSchema([r]).then(M=>{const D=tt(M.errors,r),I=tt(t._formState.errors,r);(I?!D&&I.type||D&&(I.type!==D.type||I.message!==D.message):D&&D.type)&&(D?gn(t._formState.errors,r,D):or(t._formState.errors,r),t._subjects.state.next({errors:t._formState.errors}))});else{const M=tt(t._fields,r);M&&M._f&&!(hf(t._options.reValidateMode).isOnSubmit&&hf(t._options.mode).isOnSubmit)&&BN(M,t._names.disabled,t._formValues,t._options.criteriaMode===Gi.all,t._options.shouldUseNativeValidation,!0).then(D=>!as(D)&&t._subjects.state.next({errors:q3(t._formState.errors,D,r)}))}t._subjects.state.next({name:r,values:Un(t._formValues)}),t._names.focus&&bf(t._fields,(M,D)=>{if(t._names.focus&&D.startsWith(t._names.focus)&&M.focus)return M.focus(),1}),t._names.focus="",t._setValid(),h.current=!1},[l,r,t]),ot.useEffect(()=>(!tt(t._formValues,r)&&t._setFieldArray(r),()=>{const M=(D,I)=>{const F=tt(t._fields,D);F&&F._f&&(F._f.mount=I)};t._options.shouldUnregister||a?t.unregister(r):M(r,!1)}),[r,t,s,a]),{swap:ot.useCallback(j,[p,r,t]),move:ot.useCallback(C,[p,r,t]),prepend:ot.useCallback(v,[p,r,t]),append:ot.useCallback(x,[p,r,t]),remove:ot.useCallback(b,[p,r,t]),insert:ot.useCallback(_,[p,r,t]),update:ot.useCallback(P,[p,r,t]),replace:ot.useCallback(O,[p,r,t]),fields:ot.useMemo(()=>l.map((M,D)=>({...M,[s]:d.current[D]||Tc()})),[l,s])}}function tn(n={}){const e=ot.useRef(void 0),t=ot.useRef(void 0),[r,s]=ot.useState({isDirty:!1,isValidating:!1,isLoading:ka(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:ka(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:r},n.defaultValues&&!ka(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=BQ(n);e.current={...l,formState:r}}const a=e.current.control;return a._options=n,py(()=>{const o=a._subscribe({formState:a._proxyFormState,callback:()=>s({...a._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),a._formState.isReady=!0,o},[a]),ot.useEffect(()=>a._disableForm(n.disabled),[a,n.disabled]),ot.useEffect(()=>{n.mode&&(a._options.mode=n.mode),n.reValidateMode&&(a._options.reValidateMode=n.reValidateMode)},[a,n.mode,n.reValidateMode]),ot.useEffect(()=>{n.errors&&(a._setErrors(n.errors),a._focusError())},[a,n.errors]),ot.useEffect(()=>{n.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,n.shouldUnregister]),ot.useEffect(()=>{if(a._proxyFormState.isDirty){const o=a._getDirty();o!==r.isDirty&&a._subjects.state.next({isDirty:o})}},[a,r.isDirty]),ot.useEffect(()=>{n.values&&!Ta(n.values,t.current)?(a._reset(n.values,{keepFieldsRef:!0,...a._options.resetOptions}),t.current=n.values,s(o=>({...o}))):a._resetDefaultValues()},[a,n.values]),ot.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),e.current.formState=E3(r,a),e.current}const aE=(n,e,t)=>{if(n&&"reportValidity"in n){const r=tt(t,e);n.setCustomValidity(r&&r.message||""),n.reportValidity()}},z3=(n,e)=>{for(const t in e.fields){const r=e.fields[t];r&&r.ref&&"reportValidity"in r.ref?aE(r.ref,t,n):r.refs&&r.refs.forEach(s=>aE(s,t,n))}},WQ=(n,e)=>{e.shouldUseNativeValidation&&z3(n,e);const t={};for(const r in n){const s=tt(e.fields,r),a=Object.assign(n[r]||{},{ref:s&&s.ref});if($Q(e.names||Object.keys(n),r)){const o=Object.assign({},tt(t,r));gn(o,"root",a),gn(t,r,o)}else gn(t,r,a)}return t},$Q=(n,e)=>n.some(t=>t.startsWith(e+"."));function On(n,e,t){return e===void 0&&(e={}),t===void 0&&(t={}),function(r,s,a){try{return Promise.resolve((function(o,l){try{var c=(e.context,Promise.resolve(n[t.mode==="sync"?"validateSync":"validate"](r,Object.assign({abortEarly:!1},e,{context:s}))).then(function(d){return a.shouldUseNativeValidation&&z3({},a),{values:t.raw?r:d,errors:{}}}))}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c})(0,function(o){if(!o.inner)throw o;return{values:{},errors:WQ((l=o,c=!a.shouldUseNativeValidation&&a.criteriaMode==="all",(l.inner||[]).reduce(function(d,h){if(d[h.path]||(d[h.path]={message:h.message,type:h.type}),c){var p=d[h.path].types,x=p&&p[h.type];d[h.path]=D3(h.path,c,d,h.type,x?[].concat(x,h.message):h.message)}return d},{})),a)};var l,c}))}catch(o){return Promise.reject(o)}}}var Tb,oE;function HQ(){if(oE)return Tb;oE=1;function n(C){this._maxSize=C,this.clear()}n.prototype.clear=function(){this._size=0,this._values=Object.create(null)},n.prototype.get=function(C){return this._values[C]},n.prototype.set=function(C,P){return this._size>=this._maxSize&&this.clear(),C in this._values||this._size++,this._values[C]=P};var e=/[^.^\]^[]+|(?=\[\]|\.\.)/g,t=/^\d+$/,r=/^\d/,s=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,a=/^\s*(['"]?)(.*?)(\1)\s*$/,o=512,l=new n(o),c=new n(o),d=new n(o);Tb={Cache:n,split:p,normalizePath:h,setter:function(C){var P=h(C);return c.get(C)||c.set(C,function(M,D){for(var I=0,F=P.length,q=M;I<F-1;){var U=P[I];if(U==="__proto__"||U==="constructor"||U==="prototype")return M;q=q[P[I++]]}q[P[I]]=D})},getter:function(C,P){var O=h(C);return d.get(C)||d.set(C,function(D){for(var I=0,F=O.length;I<F;)if(D!=null||!P)D=D[O[I++]];else return;return D})},join:function(C){return C.reduce(function(P,O){return P+(v(O)||t.test(O)?"["+O+"]":(P?".":"")+O)},"")},forEach:function(C,P,O){x(Array.isArray(C)?C:p(C),P,O)}};function h(C){return l.get(C)||l.set(C,p(C).map(function(P){return P.replace(a,"$2")}))}function p(C){return C.match(e)||[""]}function x(C,P,O){var M=C.length,D,I,F,q;for(I=0;I<M;I++)D=C[I],D&&(j(D)&&(D='"'+D+'"'),q=v(D),F=!q&&/^\d+$/.test(D),P.call(O,D,q,F,I,C))}function v(C){return typeof C=="string"&&C&&["'",'"'].indexOf(C.charAt(0))!==-1}function b(C){return C.match(r)&&!C.match(t)}function _(C){return s.test(C)}function j(C){return!v(C)&&(b(C)||_(C))}return Tb}var fu=HQ(),kb,lE;function YQ(){if(lE)return kb;lE=1;const n=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,e=h=>h.match(n)||[],t=h=>h[0].toUpperCase()+h.slice(1),r=(h,p)=>e(h).join(p).toLowerCase(),s=h=>e(h).reduce((p,x)=>`${p}${p?x[0].toUpperCase()+x.slice(1).toLowerCase():x.toLowerCase()}`,"");return kb={words:e,upperFirst:t,camelCase:s,pascalCase:h=>t(s(h)),snakeCase:h=>r(h,"_"),kebabCase:h=>r(h,"-"),sentenceCase:h=>t(r(h," ")),titleCase:h=>e(h).map(t).join(" ")},kb}var Pb=YQ(),Gp={exports:{}},cE;function GQ(){if(cE)return Gp.exports;cE=1,Gp.exports=function(s){return n(e(s),s)},Gp.exports.array=n;function n(s,a){var o=s.length,l=new Array(o),c={},d=o,h=t(a),p=r(s);for(a.forEach(function(v){if(!p.has(v[0])||!p.has(v[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});d--;)c[d]||x(s[d],d,new Set);return l;function x(v,b,_){if(_.has(v)){var j;try{j=", node was:"+JSON.stringify(v)}catch{j=""}throw new Error("Cyclic dependency"+j)}if(!p.has(v))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(v));if(!c[b]){c[b]=!0;var C=h.get(v)||new Set;if(C=Array.from(C),b=C.length){_.add(v);do{var P=C[--b];x(P,p.get(P),_)}while(b);_.delete(v)}l[--o]=v}}}function e(s){for(var a=new Set,o=0,l=s.length;o<l;o++){var c=s[o];a.add(c[0]),a.add(c[1])}return Array.from(a)}function t(s){for(var a=new Map,o=0,l=s.length;o<l;o++){var c=s[o];a.has(c[0])||a.set(c[0],new Set),a.has(c[1])||a.set(c[1],new Set),a.get(c[0]).add(c[1])}return a}function r(s){for(var a=new Map,o=0,l=s.length;o<l;o++)a.set(s[o],o);return a}return Gp.exports}var ZQ=GQ();const KQ=wu(ZQ),JQ=Object.prototype.toString,QQ=Error.prototype.toString,XQ=RegExp.prototype.toString,eX=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",tX=/^Symbol\((.*)\)(.*)$/;function nX(n){return n!=+n?"NaN":n===0&&1/n<0?"-0":""+n}function dE(n,e=!1){if(n==null||n===!0||n===!1)return""+n;const t=typeof n;if(t==="number")return nX(n);if(t==="string")return e?`"${n}"`:n;if(t==="function")return"[Function "+(n.name||"anonymous")+"]";if(t==="symbol")return eX.call(n).replace(tX,"Symbol($1)");const r=JQ.call(n).slice(8,-1);return r==="Date"?isNaN(n.getTime())?""+n:n.toISOString(n):r==="Error"||n instanceof Error?"["+QQ.call(n)+"]":r==="RegExp"?XQ.call(n):null}function Nl(n,e){let t=dE(n,e);return t!==null?t:JSON.stringify(n,function(r,s){let a=dE(this[r],e);return a!==null?a:s},2)}function U3(n){return n==null?[]:[].concat(n)}let B3,V3,W3,rX=/\$\{\s*(\w+)\s*\}/g;B3=Symbol.toStringTag;class uE{constructor(e,t,r,s){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[B3]="Error",this.name="ValidationError",this.value=t,this.path=r,this.type=s,this.errors=[],this.inner=[],U3(e).forEach(a=>{if(ws.isError(a)){this.errors.push(...a.errors);const o=a.inner.length?a.inner:[a];this.inner.push(...o)}else this.errors.push(a)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}V3=Symbol.hasInstance;W3=Symbol.toStringTag;class ws extends Error{static formatError(e,t){const r=t.label||t.path||"this";return t=Object.assign({},t,{path:r,originalPath:t.path}),typeof e=="string"?e.replace(rX,(s,a)=>Nl(t[a])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,r,s,a){const o=new uE(e,t,r,s);if(a)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[W3]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,ws)}static[V3](e){return uE[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let yo={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:n,type:e,value:t,originalValue:r})=>{const s=r!=null&&r!==t?` (cast from the value \`${Nl(r,!0)}\`).`:".";return e!=="mixed"?`${n} must be a \`${e}\` type, but the final value was: \`${Nl(t,!0)}\``+s:`${n} must match the configured type. The validated value was: \`${Nl(t,!0)}\``+s}},$s={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},Oc={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},VN={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},WN={isValue:"${path} field must be ${value}"},fx={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},hx={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},sX={notType:n=>{const{path:e,value:t,spec:r}=n,s=r.types.length;if(Array.isArray(t)){if(t.length<s)return`${e} tuple value has too few items, expected a length of ${s} but got ${t.length} for value: \`${Nl(t,!0)}\``;if(t.length>s)return`${e} tuple value has too many items, expected a length of ${s} but got ${t.length} for value: \`${Nl(t,!0)}\``}return ws.formatError(yo.notType,n)}};Object.assign(Object.create(null),{mixed:yo,string:$s,number:Oc,date:VN,object:fx,array:hx,boolean:WN,tuple:sX});const gy=n=>n&&n.__isYupSchema__;class zx{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:r,then:s,otherwise:a}=t,o=typeof r=="function"?r:(...l)=>l.every(c=>c===r);return new zx(e,(l,c)=>{var d;let h=o(...l)?s:a;return(d=h?.(c))!=null?d:c})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let r=this.refs.map(a=>a.getValue(t?.value,t?.parent,t?.context)),s=this.fn(r,e,t);if(s===void 0||s===e)return e;if(!gy(s))throw new TypeError("conditions must return a schema object");return s.resolve(t)}}const Zp={context:"$",value:"."};function UC(n,e){return new sd(n,e)}class sd{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===Zp.context,this.isValue=this.key[0]===Zp.value,this.isSibling=!this.isContext&&!this.isValue;let r=this.isContext?Zp.context:this.isValue?Zp.value:"";this.path=this.key.slice(r.length),this.getter=this.path&&fu.getter(this.path,!0),this.map=t.map}getValue(e,t,r){let s=this.isContext?r:this.isValue?e:t;return this.getter&&(s=this.getter(s||{})),this.map&&(s=this.map(s)),s}cast(e,t){return this.getValue(e,t?.parent,t?.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}sd.prototype.__isYupRef=!0;const Pa=n=>n==null;function tf(n){function e({value:t,path:r="",options:s,originalValue:a,schema:o},l,c){const{name:d,test:h,params:p,message:x,skipAbsent:v}=n;let{parent:b,context:_,abortEarly:j=o.spec.abortEarly,disableStackTrace:C=o.spec.disableStackTrace}=s;const P={value:t,parent:b,context:_};function O(W={}){const Y=$3(Object.assign({value:t,originalValue:a,label:o.spec.label,path:W.path||r,spec:o.spec,disableStackTrace:W.disableStackTrace||C},p,W.params),P),G=new ws(ws.formatError(W.message||x,Y),t,Y.path,W.type||d,Y.disableStackTrace);return G.params=Y,G}const M=j?l:c;let D={path:r,parent:b,type:d,from:s.from,createError:O,resolve(W){return H3(W,P)},options:s,originalValue:a,schema:o};const I=W=>{ws.isError(W)?M(W):W?c(null):M(O())},F=W=>{ws.isError(W)?M(W):l(W)};if(v&&Pa(t))return I(!0);let U;try{var B;if(U=h.call(D,t,D),typeof((B=U)==null?void 0:B.then)=="function"){if(s.sync)throw new Error(`Validation test of type: "${D.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(U).then(I,F)}}catch(W){F(W);return}I(U)}return e.OPTIONS=n,e}function $3(n,e){if(!n)return n;for(const t of Object.keys(n))n[t]=H3(n[t],e);return n}function H3(n,e){return sd.isRef(n)?n.getValue(e.value,e.parent,e.context):n}function iX(n,e,t,r=t){let s,a,o;return e?(fu.forEach(e,(l,c,d)=>{let h=c?l.slice(1,l.length-1):l;n=n.resolve({context:r,parent:s,value:t});let p=n.type==="tuple",x=d?parseInt(h,10):0;if(n.innerType||p){if(p&&!d)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&x>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${l}, in the path: ${e}. because there is no value at that index. `);s=t,t=t&&t[x],n=p?n.spec.types[x]:n.innerType}if(!d){if(!n.fields||!n.fields[h])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${n.type}")`);s=t,t=t&&t[h],n=n.fields[h]}a=h,o=c?"["+l+"]":"."+l}),{schema:n,parent:s,parentPath:a}):{parent:s,parentPath:e,schema:n}}class Ux extends Set{describe(){const e=[];for(const t of this.values())e.push(sd.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const r of this.values())t.push(e(r));return t}clone(){return new Ux(this.values())}merge(e,t){const r=this.clone();return e.forEach(s=>r.add(s)),t.forEach(s=>r.delete(s)),r}}function mf(n,e=new Map){if(gy(n)||!n||typeof n!="object")return n;if(e.has(n))return e.get(n);let t;if(n instanceof Date)t=new Date(n.getTime()),e.set(n,t);else if(n instanceof RegExp)t=new RegExp(n),e.set(n,t);else if(Array.isArray(n)){t=new Array(n.length),e.set(n,t);for(let r=0;r<n.length;r++)t[r]=mf(n[r],e)}else if(n instanceof Map){t=new Map,e.set(n,t);for(const[r,s]of n.entries())t.set(r,mf(s,e))}else if(n instanceof Set){t=new Set,e.set(n,t);for(const r of n)t.add(mf(r,e))}else if(n instanceof Object){t={},e.set(n,t);for(const[r,s]of Object.entries(n))t[r]=mf(s,e)}else throw Error(`Unable to clone ${n}`);return t}function aX(n){if(!(n!=null&&n.length))return;const e=[];let t="",r=!1,s=!1;for(let a=0;a<n.length;a++){const o=n[a];if(o==="["&&!s){t&&(e.push(...t.split(".").filter(Boolean)),t=""),r=!0;continue}if(o==="]"&&!s){t&&(/^\d+$/.test(t)?e.push(t):e.push(t.replace(/^"|"$/g,"")),t=""),r=!1;continue}if(o==='"'){s=!s;continue}if(o==="."&&!r&&!s){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(...t.split(".").filter(Boolean)),e}function oX(n,e){const t=e?`${e}.${n.path}`:n.path;return n.errors.map(r=>({message:r,path:aX(t)}))}function Y3(n,e){var t;if(!((t=n.inner)!=null&&t.length)&&n.errors.length)return oX(n,e);const r=e?`${e}.${n.path}`:n.path;return n.inner.flatMap(s=>Y3(s,r))}class Js{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new Ux,this._blacklist=new Ux,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(yo.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e?.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=mf(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let r=e(this);return this._mutate=t,r}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,r=e.clone();const s=Object.assign({},t.spec,r.spec);return r.spec=s,r.internalTests=Object.assign({},t.internalTests,r.internalTests),r._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),r._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),r.tests=t.tests,r.exclusiveTests=t.exclusiveTests,r.withMutation(a=>{e.tests.forEach(o=>{a.test(o.OPTIONS)})}),r.transforms=[...t.transforms,...r.transforms],r}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let r=t.conditions;t=t.clone(),t.conditions=[],t=r.reduce((s,a)=>a.resolve(s,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,r,s,a;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(r=e.abortEarly)!=null?r:this.spec.abortEarly,recursive:(s=e.recursive)!=null?s:this.spec.recursive,disableStackTrace:(a=e.disableStackTrace)!=null?a:this.spec.disableStackTrace})}cast(e,t={}){let r=this.resolve(Object.assign({},t,{value:e})),s=t.assert==="ignore-optionality",a=r._cast(e,t);if(t.assert!==!1&&!r.isType(a)){if(s&&Pa(a))return a;let o=Nl(e),l=Nl(a);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${r.type}". 

attempted value: ${o} 
`+(l!==o?`result of cast: ${l}`:""))}return a}_cast(e,t){let r=e===void 0?e:this.transforms.reduce((s,a)=>a.call(this,s,e,this,t),e);return r===void 0&&(r=this.getDefault(t)),r}_validate(e,t={},r,s){let{path:a,originalValue:o=e,strict:l=this.spec.strict}=t,c=e;l||(c=this._cast(c,Object.assign({assert:!1},t)));let d=[];for(let h of Object.values(this.internalTests))h&&d.push(h);this.runTests({path:a,value:c,originalValue:o,options:t,tests:d},r,h=>{if(h.length)return s(h,c);this.runTests({path:a,value:c,originalValue:o,options:t,tests:this.tests},r,s)})}runTests(e,t,r){let s=!1,{tests:a,value:o,originalValue:l,path:c,options:d}=e,h=_=>{s||(s=!0,t(_,o))},p=_=>{s||(s=!0,r(_,o))},x=a.length,v=[];if(!x)return p([]);let b={value:o,originalValue:l,path:c,options:d,schema:this};for(let _=0;_<a.length;_++){const j=a[_];j(b,h,function(P){P&&(Array.isArray(P)?v.push(...P):v.push(P)),--x<=0&&p(v)})}}asNestedTest({key:e,index:t,parent:r,parentPath:s,originalParent:a,options:o}){const l=e??t;if(l==null)throw TypeError("Must include `key` or `index` for nested validations");const c=typeof l=="number";let d=r[l];const h=Object.assign({},o,{strict:!0,parent:r,value:d,originalValue:a[l],key:void 0,[c?"index":"key"]:l,path:c||l.includes(".")?`${s||""}[${c?l:`"${l}"`}]`:(s?`${s}.`:"")+e});return(p,x,v)=>this.resolve(h)._validate(d,h,x,v)}validate(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),a=(r=t?.disableStackTrace)!=null?r:s.spec.disableStackTrace;return new Promise((o,l)=>s._validate(e,t,(c,d)=>{ws.isError(c)&&(c.value=d),l(c)},(c,d)=>{c.length?l(new ws(c,d,void 0,void 0,a)):o(d)}))}validateSync(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),a,o=(r=t?.disableStackTrace)!=null?r:s.spec.disableStackTrace;return s._validate(e,Object.assign({},t,{sync:!0}),(l,c)=>{throw ws.isError(l)&&(l.value=c),l},(l,c)=>{if(l.length)throw new ws(l,e,void 0,void 0,o);a=c}),a}isValid(e,t){return this.validate(e,t).then(()=>!0,r=>{if(ws.isError(r))return!1;throw r})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(r){if(ws.isError(r))return!1;throw r}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):mf(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const r=this.clone({nullable:e});return r.internalTests.nullable=tf({message:t,name:"nullable",test(s){return s===null?this.schema.spec.nullable:!0}}),r}optionality(e,t){const r=this.clone({optional:e});return r.internalTests.optionality=tf({message:t,name:"optionality",test(s){return s===void 0?this.schema.spec.optional:!0}}),r}optional(){return this.optionality(!0)}defined(e=yo.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=yo.notNull){return this.nullability(!1,e)}required(e=yo.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=yo.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let r=this.clone(),s=tf(t),a=t.exclusive||t.name&&r.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(r.exclusiveTests[t.name]=!!t.exclusive),r.tests=r.tests.filter(o=>!(o.OPTIONS.name===t.name&&(a||o.OPTIONS.test===s.OPTIONS.test))),r.tests.push(s),r}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let r=this.clone(),s=U3(e).map(a=>new sd(a));return s.forEach(a=>{a.isSibling&&r.deps.push(a.key)}),r.conditions.push(typeof t=="function"?new zx(s,t):zx.fromOptions(s,t)),r}typeError(e){let t=this.clone();return t.internalTests.typeError=tf({message:e,name:"typeError",skipAbsent:!0,test(r){return this.schema._typeCheck(r)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=yo.oneOf){let r=this.clone();return e.forEach(s=>{r._whitelist.add(s),r._blacklist.delete(s)}),r.internalTests.whiteList=tf({message:t,name:"oneOf",skipAbsent:!0,test(s){let a=this.schema._whitelist,o=a.resolveAll(this.resolve);return o.includes(s)?!0:this.createError({params:{values:Array.from(a).join(", "),resolved:o}})}}),r}notOneOf(e,t=yo.notOneOf){let r=this.clone();return e.forEach(s=>{r._blacklist.add(s),r._whitelist.delete(s)}),r.internalTests.blacklist=tf({message:t,name:"notOneOf",test(s){let a=this.schema._blacklist,o=a.resolveAll(this.resolve);return o.includes(s)?this.createError({params:{values:Array.from(a).join(", "),resolved:o}}):!0}}),r}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:r,meta:s,optional:a,nullable:o}=t.spec;return{meta:s,label:r,optional:a,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.filter((c,d,h)=>h.findIndex(p=>p.OPTIONS.name===c.OPTIONS.name)===d).map(c=>{const d=c.OPTIONS.params&&e?$3(Object.assign({},c.OPTIONS.params),e):c.OPTIONS.params;return{name:c.OPTIONS.name,params:d}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(r){try{return{value:await e.validate(r,{abortEarly:!1})}}catch(s){if(s instanceof ws)return{issues:Y3(s)};throw s}}}}}Js.prototype.__isYupSchema__=!0;for(const n of["validate","validateSync"])Js.prototype[`${n}At`]=function(e,t,r={}){const{parent:s,parentPath:a,schema:o}=iX(this,e,t,r.context);return o[n](s&&s[a],Object.assign({},r,{parent:s,path:e}))};for(const n of["equals","is"])Js.prototype[n]=Js.prototype.oneOf;for(const n of["not","nope"])Js.prototype[n]=Js.prototype.notOneOf;const lX=()=>!0;function Vt(n){return new G3(n)}class G3 extends Js{constructor(e){super(typeof e=="function"?{type:"mixed",check:e}:Object.assign({type:"mixed",check:lX},e))}}Vt.prototype=G3.prototype;function os(){return new Z3}class Z3 extends Js{constructor(){super({type:"boolean",check(e){return e instanceof Boolean&&(e=e.valueOf()),typeof e=="boolean"}}),this.withMutation(()=>{this.transform((e,t)=>{if(this.spec.coerce&&!this.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e})})}isTrue(e=WN.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test(t){return Pa(t)||t===!0}})}isFalse(e=WN.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test(t){return Pa(t)||t===!1}})}default(e){return super.default(e)}defined(e){return super.defined(e)}optional(){return super.optional()}required(e){return super.required(e)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(e){return super.nonNullable(e)}strip(e){return super.strip(e)}}os.prototype=Z3.prototype;const cX=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function dX(n){const e=$N(n);if(!e)return Date.parse?Date.parse(n):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function $N(n){var e,t;const r=cX.exec(n);return r?{year:hl(r[1]),month:hl(r[2],1)-1,day:hl(r[3],1),hour:hl(r[4]),minute:hl(r[5]),second:hl(r[6]),millisecond:r[7]?hl(r[7].substring(0,3)):0,precision:(e=(t=r[7])==null?void 0:t.length)!=null?e:void 0,z:r[8]||void 0,plusMinus:r[9]||void 0,hourOffset:hl(r[10]),minuteOffset:hl(r[11])}:null}function hl(n,e=0){return Number(n)||e}let uX=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,fX=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,hX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,mX="^\\d{4}-\\d{2}-\\d{2}",pX="\\d{2}:\\d{2}:\\d{2}",gX="(([+-]\\d{2}(:?\\d{2})?)|Z)",xX=new RegExp(`${mX}T${pX}(\\.\\d+)?${gX}$`),yX=n=>Pa(n)||n===n.trim(),vX={}.toString();function ye(){return new K3}class K3 extends Js{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce||this.isType(e)||Array.isArray(e))return e;const r=e!=null&&e.toString?e.toString():e;return r===vX?e:r})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||yo.required,name:"required",skipAbsent:!0,test:r=>!!r.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=$s.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t=$s.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t=$s.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}matches(e,t){let r=!1,s,a;return t&&(typeof t=="object"?{excludeEmptyString:r=!1,message:s,name:a}=t:s=t),this.test({name:a||"matches",message:s||$s.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&r||o.search(e)!==-1})}email(e=$s.email){return this.matches(uX,{name:"email",message:e,excludeEmptyString:!0})}url(e=$s.url){return this.matches(fX,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=$s.uuid){return this.matches(hX,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",r,s;return e&&(typeof e=="object"?{message:t="",allowOffset:r=!1,precision:s=void 0}=e:t=e),this.matches(xX,{name:"datetime",message:t||$s.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||$s.datetime_offset,params:{allowOffset:r},skipAbsent:!0,test:a=>{if(!a||r)return!0;const o=$N(a);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||$s.datetime_precision,params:{precision:s},skipAbsent:!0,test:a=>{if(!a||s==null)return!0;const o=$N(a);return o?o.precision===s:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=$s.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:yX})}lowercase(e=$s.lowercase){return this.transform(t=>Pa(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Pa(t)||t===t.toLowerCase()})}uppercase(e=$s.uppercase){return this.transform(t=>Pa(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Pa(t)||t===t.toUpperCase()})}}ye.prototype=K3.prototype;let bX=n=>n!=+n;function ls(){return new J3}class J3 extends Js{constructor(){super({type:"number",check(e){return e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&!bX(e)}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce)return e;let r=e;if(typeof r=="string"){if(r=r.replace(/\s/g,""),r==="")return NaN;r=+r}return this.isType(r)||r===null?r:parseFloat(r)})})}min(e,t=Oc.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r>=this.resolve(e)}})}max(e,t=Oc.max){return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r<=this.resolve(e)}})}lessThan(e,t=Oc.lessThan){return this.test({message:t,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test(r){return r<this.resolve(e)}})}moreThan(e,t=Oc.moreThan){return this.test({message:t,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test(r){return r>this.resolve(e)}})}positive(e=Oc.positive){return this.moreThan(0,e)}negative(e=Oc.negative){return this.lessThan(0,e)}integer(e=Oc.integer){return this.test({name:"integer",message:e,skipAbsent:!0,test:t=>Number.isInteger(t)})}truncate(){return this.transform(e=>Pa(e)?e:e|0)}round(e){var t;let r=["ceil","floor","round","trunc"];if(e=((t=e)==null?void 0:t.toLowerCase())||"round",e==="trunc")return this.truncate();if(r.indexOf(e.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+r.join(", "));return this.transform(s=>Pa(s)?s:Math[e](s))}}ls.prototype=J3.prototype;let wX=new Date(""),_X=n=>Object.prototype.toString.call(n)==="[object Date]";class BC extends Js{constructor(){super({type:"date",check(e){return _X(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t)=>!this.spec.coerce||this.isType(e)||e===null?e:(e=dX(e),isNaN(e)?BC.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let r;if(sd.isRef(e))r=e;else{let s=this.cast(e);if(!this._typeCheck(s))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);r=s}return r}min(e,t=VN.min){let r=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s>=this.resolve(r)}})}max(e,t=VN.max){let r=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(s){return s<=this.resolve(r)}})}}BC.INVALID_DATE=wX;function jX(n,e=[]){let t=[],r=new Set,s=new Set(e.map(([o,l])=>`${o}-${l}`));function a(o,l){let c=fu.split(o)[0];r.add(c),s.has(`${l}-${c}`)||t.push([l,c])}for(const o of Object.keys(n)){let l=n[o];r.add(o),sd.isRef(l)&&l.isSibling?a(l.path,o):gy(l)&&"deps"in l&&l.deps.forEach(c=>a(c,o))}return KQ.array(Array.from(r),t).reverse()}function fE(n,e){let t=1/0;return n.some((r,s)=>{var a;if((a=e.path)!=null&&a.includes(r))return t=s,!0}),t}function Q3(n){return(e,t)=>fE(n,e)-fE(n,t)}const X3=(n,e,t)=>{if(typeof n!="string")return n;let r=n;try{r=JSON.parse(n)}catch{}return t.isType(r)?r:n};function mx(n){if("fields"in n){const e={};for(const[t,r]of Object.entries(n.fields))e[t]=mx(r);return n.setFields(e)}if(n.type==="array"){const e=n.optional();return e.innerType&&(e.innerType=mx(e.innerType)),e}return n.type==="tuple"?n.optional().clone({types:n.spec.types.map(mx)}):"optional"in n?n.optional():n}const SX=(n,e)=>{const t=[...fu.normalizePath(e)];if(t.length===1)return t[0]in n;let r=t.pop(),s=fu.getter(fu.join(t),!0)(n);return!!(s&&r in s)};let hE=n=>Object.prototype.toString.call(n)==="[object Object]";function mE(n,e){let t=Object.keys(n.fields);return Object.keys(e).filter(r=>t.indexOf(r)===-1)}const NX=Q3([]);function Pt(n){return new e5(n)}class e5 extends Js{constructor(e){super({type:"object",check(t){return hE(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=NX,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var r;let s=super._cast(e,t);if(s===void 0)return this.getDefault(t);if(!this._typeCheck(s))return s;let a=this.fields,o=(r=t.stripUnknown)!=null?r:this.spec.noUnknown,l=[].concat(this._nodes,Object.keys(s).filter(p=>!this._nodes.includes(p))),c={},d=Object.assign({},t,{parent:c,__validating:t.__validating||!1}),h=!1;for(const p of l){let x=a[p],v=p in s,b=s[p];if(x){let _;d.path=(t.path?`${t.path}.`:"")+p,x=x.resolve({value:b,context:t.context,parent:c});let j=x instanceof Js?x.spec:void 0,C=j?.strict;if(j!=null&&j.strip){h=h||p in s;continue}_=!t.__validating||!C?x.cast(b,d):b,_!==void 0&&(c[p]=_)}else v&&!o&&(c[p]=b);(v!==p in c||c[p]!==b)&&(h=!0)}return h?c:s}_validate(e,t={},r,s){let{from:a=[],originalValue:o=e,recursive:l=this.spec.recursive}=t;t.from=[{schema:this,value:o},...a],t.__validating=!0,t.originalValue=o,super._validate(e,t,r,(c,d)=>{if(!l||!hE(d)){s(c,d);return}o=o||d;let h=[];for(let p of this._nodes){let x=this.fields[p];!x||sd.isRef(x)||h.push(x.asNestedTest({options:t,key:p,parent:d,parentPath:t.path,originalParent:o}))}this.runTests({tests:h,value:d,originalValue:o,options:t},r,p=>{s(p.sort(this._sortErrors).concat(c),d)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),r=t.fields;for(let[s,a]of Object.entries(this.fields)){const o=r[s];r[s]=o===void 0?a:o}return t.withMutation(s=>s.setFields(r,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(r=>{var s;const a=this.fields[r];let o=e;(s=o)!=null&&s.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[r]})),t[r]=a&&"getDefault"in a?a.getDefault(o):void 0}),t}setFields(e,t){let r=this.clone();return r.fields=e,r._nodes=jX(e,t),r._sortErrors=Q3(Object.keys(e)),t&&(r._excludedEdges=t),r}shape(e,t=[]){return this.clone().withMutation(r=>{let s=r._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),s=[...r._excludedEdges,...t]),r.setFields(Object.assign(r.fields,e),s)})}partial(){const e={};for(const[t,r]of Object.entries(this.fields))e[t]="optional"in r&&r.optional instanceof Function?r.optional():r;return this.setFields(e)}deepPartial(){return mx(this)}pick(e){const t={};for(const r of e)this.fields[r]&&(t[r]=this.fields[r]);return this.setFields(t,this._excludedEdges.filter(([r,s])=>e.includes(r)&&e.includes(s)))}omit(e){const t=[];for(const r of Object.keys(this.fields))e.includes(r)||t.push(r);return this.pick(t)}from(e,t,r){let s=fu.getter(e,!0);return this.transform(a=>{if(!a)return a;let o=a;return SX(a,e)&&(o=Object.assign({},a),r||delete o[e],o[t]=s(a)),o})}json(){return this.transform(X3)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||fx.exact,test(t){if(t==null)return!0;const r=mE(this.schema,t);return r.length===0||this.createError({params:{properties:r.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=fx.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let r=this.test({name:"noUnknown",exclusive:!0,message:t,test(s){if(s==null)return!0;const a=mE(this.schema,s);return!e||a.length===0||this.createError({params:{unknown:a.join(", ")}})}});return r.spec.noUnknown=e,r}unknown(e=!0,t=fx.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const r={};for(const s of Object.keys(t))r[e(s)]=t[s];return r})}camelCase(){return this.transformKeys(Pb.camelCase)}snakeCase(){return this.transformKeys(Pb.snakeCase)}constantCase(){return this.transformKeys(e=>Pb.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);r.fields={};for(const[a,o]of Object.entries(t.fields)){var s;let l=e;(s=l)!=null&&s.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[a]})),r.fields[a]=o.describe(l)}return r}}Pt.prototype=e5.prototype;function _s(n){return new t5(n)}class t5 extends Js{constructor(e){super({type:"array",spec:{types:e},check(t){return Array.isArray(t)}}),this.innerType=void 0,this.innerType=e}_cast(e,t){const r=super._cast(e,t);if(!this._typeCheck(r)||!this.innerType)return r;let s=!1;const a=r.map((o,l)=>{const c=this.innerType.cast(o,Object.assign({},t,{path:`${t.path||""}[${l}]`,parent:r,originalValue:o,value:o,index:l}));return c!==o&&(s=!0),c});return s?a:r}_validate(e,t={},r,s){var a;let o=this.innerType,l=(a=t.recursive)!=null?a:this.spec.recursive;t.originalValue!=null&&t.originalValue,super._validate(e,t,r,(c,d)=>{var h;if(!l||!o||!this._typeCheck(d)){s(c,d);return}let p=new Array(d.length);for(let v=0;v<d.length;v++){var x;p[v]=o.asNestedTest({options:t,index:v,parent:d,parentPath:t.path,originalParent:(x=t.originalValue)!=null?x:e})}this.runTests({value:d,tests:p,originalValue:(h=t.originalValue)!=null?h:e,options:t},r,v=>s(v.concat(c),d))})}clone(e){const t=super.clone(e);return t.innerType=this.innerType,t}json(){return this.transform(X3)}concat(e){let t=super.concat(e);return t.innerType=this.innerType,e.innerType&&(t.innerType=t.innerType?t.innerType.concat(e.innerType):e.innerType),t}of(e){let t=this.clone();if(!gy(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+Nl(e));return t.innerType=e,t.spec=Object.assign({},t.spec,{types:e}),t}length(e,t=hx.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t){return t=t||hx.min,this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t){return t=t||hx.max,this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}ensure(){return this.default(()=>[]).transform((e,t)=>this._typeCheck(e)?e:t==null?[]:[].concat(t))}compact(e){let t=e?(r,s,a)=>!e(r,s,a):r=>!!r;return this.transform(r=>r!=null?r.filter(t):r)}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);if(t.innerType){var s;let a=e;(s=a)!=null&&s.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[0]})),r.innerType=t.innerType.describe(a)}return r}}_s.prototype=t5.prototype;const we=E.forwardRef(({label:n,id:e,error:t,registration:r,className:s,labelClassName:a,...o},l)=>{const h=`form-input ${t?"form-input--error":""} ${s||""}`;return i.jsxs("div",{children:[n&&i.jsx("label",{htmlFor:e,className:`block text-sm font-medium text-muted ${a||""}`,children:n}),i.jsx("div",{className:n?"mt-1":"",children:i.jsx("input",{ref:l,id:e,className:h,"aria-invalid":!!t,...r,...o})}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})});we.displayName="Input";const kn=E.forwardRef(({id:n,label:e,description:t,className:r,labelClassName:s,inputClassName:a,...o},l)=>{const c=n||o.name;return i.jsxs("div",{className:`relative flex items-start ${r}`,children:[i.jsx("div",{className:"flex h-6 items-center",children:i.jsx("input",{id:c,"aria-describedby":t?`${c}-description`:void 0,type:"checkbox",ref:l,className:`h-4 w-4 rounded border-gray-300 text-accent focus:ring-accent cursor-pointer ${a||""}`,...o})}),i.jsxs("div",{className:"ml-3 text-sm leading-6",children:[i.jsx("label",{htmlFor:c,className:`font-medium text-primary-text cursor-pointer ${s}`,children:e}),t&&i.jsx("p",{id:`${c}-description`,className:"text-muted",children:t})]})]})});kn.displayName="Checkbox";function CX(){const[n,e]=E.useState(null),[t,r]=E.useState(!1),[s,a]=E.useState(null);return E.useEffect(()=>{const l=(()=>{const p=navigator.userAgent,x=`${window.screen.width}x${window.screen.height}`,v=Intl.DateTimeFormat().resolvedOptions().timeZone,b=navigator.language,_=navigator.platform,j=navigator.hardwareConcurrency||0,C=`${p}|${x}|${v}|${b}|${_}|${j}`;let P=0;for(let I=0;I<C.length;I++){const F=C.charCodeAt(I);P=(P<<5)-P+F,P=P&P}const O="dev_"+Math.abs(P).toString(36),M=()=>p.indexOf("Chrome")>-1?"Chrome":p.indexOf("Firefox")>-1?"Firefox":p.indexOf("Safari")>-1?"Safari":p.indexOf("Edge")>-1?"Edge":"Unknown",D=()=>p.indexOf("Win")>-1?"Windows":p.indexOf("Mac")>-1?"MacOS":p.indexOf("Linux")>-1?"Linux":p.indexOf("Android")>-1?"Android":p.indexOf("iOS")>-1?"iOS":"Unknown";return{deviceId:O,deviceName:`${D()} - ${M()}`,browser:M(),os:D(),timestamp:new Date().toISOString()}})();e(l);const c=localStorage.getItem("device_id"),d=localStorage.getItem("device_name"),h=localStorage.getItem("device_timestamp");c&&c!==l.deviceId&&(r(!0),a({deviceId:c,deviceName:d||"Unknown Device",browser:"",os:"",timestamp:h||new Date().toISOString()})),localStorage.setItem("device_id",l.deviceId),localStorage.setItem("device_name",l.deviceName),localStorage.setItem("device_timestamp",l.timestamp)},[]),{deviceInfo:n,isNewDevice:t,previousDevice:s}}const TX=Pt({email:ye().email("Must be a valid email").required("Email is required"),password:ye().required("Password is required"),rememberMe:os().optional()}).defined(),kX=n=>n.role==="unverified"?"/pending-approval":"/profile",PX=()=>{const{user:n,loginWithEmail:e,loginWithGoogle:t,error:r,setError:s,loading:a,setLoginAnimationPending:o,isLoginAnimationPending:l}=jt(),{colorScheme:c}=on(),d=Nt(),h=Zr(),{deviceInfo:p,isNewDevice:x,previousDevice:v}=CX(),[b,_]=E.useState(!1),[j,C]=E.useState(!1);E.useEffect(()=>{s(null);const U=new URLSearchParams(h.hash.substring(1)),B=U.get("error_code"),W=U.get("error_description");B==="otp_expired"&&W&&(s("Email confirmation link has expired or is invalid. Please try signing up again or request a new confirmation email."),d("/auth/login",{replace:!0}))},[s,h,d]),E.useEffect(()=>{n&&x&&v&&!b&&(ce.sendDeviceChangeAlert(n.id,n.name,v.deviceName,p?.deviceName||"Unknown Device").catch(U=>console.error("Failed to send device change alert:",U)),_(!0))},[n,x,v,b,p]),E.useEffect(()=>{n&&!l&&d(kX(n),{replace:!0})},[n,d,l]);const{register:P,handleSubmit:O,setValue:M,formState:{errors:D}}=tn({resolver:On(TX)});E.useEffect(()=>{const U=localStorage.getItem("rememberedEmail");U&&(M("email",U),M("rememberMe",!0)),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&M("rememberMe",!0)},[M]);const I=async U=>{o(!0);const W=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:U.rememberMe||!1;(await e(U.email,U.password,W)).error?o(!1):(C(!0),setTimeout(()=>{o(!1)},1500))},F=async()=>{await t()},q=a||j;return i.jsxs(i.Fragment,{children:[i.jsxs("form",{onSubmit:O(I),className:"space-y-3",children:[i.jsxs("fieldset",{disabled:q,className:"space-y-3",children:[i.jsxs("div",{className:"relative group",children:[i.jsx(Gf,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),i.jsx(we,{id:"email",type:"email",autoComplete:"email",placeholder:"Email",registration:P("email"),error:D.email?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),i.jsxs("div",{className:"relative group",children:[i.jsx(IN,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),i.jsx(we,{id:"password",type:"password",autoComplete:"current-password",placeholder:"Password",registration:P("password"),error:D.password?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-center justify-between gap-3",children:[i.jsxs("div",{className:"flex-shrink-0 login-checkbox-container",children:[i.jsx(kn,{id:"rememberMe",label:"Remember me",labelClassName:"!text-white font-medium",...P("rememberMe"),inputClassName:"text-[#22c55e] focus:ring-[#22c55e] border-white/20 rounded bg-black/40"}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
                                .login-checkbox-container label {
                                    color: #ffffff !important;
                                    opacity: 1 !important;
                                    pointer-events: auto !important;
                                    position: relative !important;
                                    z-index: 10 !important;
                                }
                            `}})]}),i.jsx(Oa,{to:"/auth/forgot-password",className:`text-sm font-medium !text-white hover:text-gray-200 transition-colors auth-link ${q?"pointer-events-none opacity-50":""}`,"aria-disabled":q,onClick:U=>{q&&U.preventDefault()},style:{color:"#ffffff"},children:"Forgot your password?"})]})]}),i.jsx("div",{className:"min-h-[24px] flex items-center justify-center",children:r&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-400 text-center p-2 bg-red-500/10 rounded-lg border border-red-500/20",children:[i.jsx(Aa,{className:"h-4 w-4 flex-shrink-0"}),i.jsx("span",{children:r})]})}),i.jsx(ne,{type:"submit",className:`w-full !font-bold !py-3 !rounded-full shadow-lg transition-all transform hover:scale-[1.02] signin-btn ${j?"!bg-[#22c55e] !border-[#22c55e] !text-white hover:!bg-[#22c55e]":"!bg-[#22c55e] border border-[#22c55e] !text-white hover:!bg-[#16a34a] hover:!border-[#16a34a] hover:!text-white shadow-green-500/20"}`,isLoading:a&&!j,size:"lg",disabled:q&&!j,children:j?i.jsx(Sl,{className:"w-6 h-6 animate-bounce"}):"Sign In"})]}),i.jsxs("div",{className:"flex items-center my-6",children:[i.jsx("div",{className:"flex-1 border-t border-white/10"}),i.jsx("span",{className:"px-4 text-sm !text-white font-medium",children:"OR"}),i.jsx("div",{className:"flex-1 border-t border-white/10"})]}),i.jsxs("button",{type:"button",onClick:F,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 hover:bg-gray-100 font-bold py-3 rounded-full transition-all transform hover:scale-[1.02] shadow-lg google-btn",disabled:q,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 48 48",children:[i.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),i.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),i.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.519-3.487-11.181-8.264l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),i.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C39.99,35.508,44,30.021,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),"Sign in with Google"]}),i.jsx("div",{className:"text-center mt-4",children:i.jsxs("p",{className:"text-sm !text-white",style:{color:"#ffffff"},children:["Don't have an account?"," ",i.jsx(Oa,{to:"/auth/signup",className:"font-medium !text-white hover:text-gray-200 auth-link",style:{color:"#ffffff"},children:"Sign Up"})]})})]})},MX=Pt({name:ye().required("Your name is required"),email:ye().email("Must be a valid email").required("Email is required"),password:ye().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:ye().oneOf([UC("password")],"Passwords must match").required("Please confirm your password")}).defined(),EX=()=>{const{signUp:n}=jt(),[e,t]=E.useState(""),[r,s]=E.useState(!1),{register:a,handleSubmit:o,formState:{errors:l,isSubmitting:c}}=tn({resolver:On(MX)}),d=async h=>{t("");const{error:p}=await n(h.name,h.email,h.password);p?t(p.message):s(!0)};return r?i.jsxs("div",{className:"text-center",children:[i.jsx(u3,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",style:{color:"#ffffff"},children:"Confirm your email"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",style:{color:"#ffffff"},children:"We've sent a confirmation link to your email address. Please click the link to activate your account."}),i.jsx("div",{className:"mt-6",children:i.jsx(Oa,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",style:{color:"#ffffff"},children:" Back to Login"})})]}):i.jsxs("form",{onSubmit:o(d),className:"space-y-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Ml,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(we,{id:"name",type:"text",placeholder:"Full Name",registration:a("name"),error:l.name?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Gf,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(we,{id:"email",type:"email",placeholder:"Email Address",registration:a("email"),error:l.email?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(IN,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(we,{id:"password",type:"password",placeholder:"Password",registration:a("password"),error:l.password?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(IN,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(we,{id:"confirmPassword",type:"password",placeholder:"Confirm Password",registration:a("confirmPassword"),error:l.confirmPassword?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),e&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),i.jsx("div",{className:"pt-2",children:i.jsx(ne,{type:"submit",className:"w-full",isLoading:c,size:"lg",children:"Sign Up"})}),i.jsx("div",{className:"text-center pt-2",children:i.jsx(Oa,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",style:{color:"#ffffff"},children:"Already have an account? Sign In"})})]})},DX=Pt({email:ye().email("Must be a valid email").required("Email is required")}).defined(),OX=()=>{const{sendPasswordReset:n}=jt(),[e,t]=E.useState(""),[r,s]=E.useState(!1),a=Nt();E.useEffect(()=>{if(r){const p=setTimeout(()=>{a("/auth/login",{replace:!0})},3e3);return()=>clearTimeout(p)}},[r,a]);const{register:o,handleSubmit:l,formState:{errors:c,isSubmitting:d}}=tn({resolver:On(DX)}),h=async p=>{t("");const{error:x}=await n(p.email);x&&x.message.includes("rate limit")?t("Too many attempts. Please wait a few minutes before trying again."):s(!0)};return r?i.jsxs("div",{className:"text-center",children:[i.jsx(u3,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",style:{color:"#ffffff"},children:"Check your email"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",style:{color:"#ffffff"},children:"If an account exists for the email you provided, we've sent password reset instructions. Redirecting to login..."})]}):i.jsx(i.Fragment,{children:i.jsxs("form",{onSubmit:l(h),className:"space-y-6",children:[i.jsxs("div",{className:"relative group",children:[i.jsx(Gf,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none z-10"}),i.jsx(we,{id:"email",type:"email",autoComplete:"email",placeholder:"Email Address",registration:o("email"),error:c.email?.message,className:"!pl-12 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-400 focus:!border-[#22c55e] !py-3 !rounded-xl transition-all"})]}),e&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),i.jsx("div",{children:i.jsx(ne,{type:"submit",className:"w-full",isLoading:d,size:"lg",children:"Send Reset Link"})}),i.jsx("div",{className:"text-center",children:i.jsx(Oa,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",style:{color:"#ffffff"},children:" Back to Login"})})]})})},IX=Pt({password:ye().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:ye().oneOf([UC("password")],"Passwords must match").required("Please confirm your password")}).defined(),AX=n=>{const e=n.toLowerCase();return e.includes("weak password")?"Password is too weak. Please use at least 6 characters.":e.includes("requires a recent login")?"For your security, please sign in again to continue.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again.")},RX=()=>{const[n,e]=E.useState(""),[t,r]=E.useState(!1),s=Nt(),{user:a,logout:o}=jt();E.useEffect(()=>{a||e("Invalid or expired password reset session. Please request a new password reset link.")},[a]);const{register:l,handleSubmit:c,formState:{errors:d,isSubmitting:h}}=tn({resolver:On(IX)}),p=async x=>{e("");const{error:v}=await Ca.updateUserPassword(x.password);v?e(AX(v.message)):(r(!0),await o(),setTimeout(()=>s("/auth/login",{replace:!0}),2e3))};return t?i.jsxs("div",{className:"text-center",children:[i.jsx(Ji,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Password Updated!"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"Your password has been changed successfully. You will be redirected to the login page shortly."}),i.jsx("div",{className:"mt-6",children:i.jsx(Oa,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",children:" Back to Login Now"})})]}):n&&!a?i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-3xl font-bold text-white",children:"Link Expired"}),i.jsx("p",{className:"text-sm text-gray-300 mt-1",children:"This password reset link is no longer valid."}),i.jsxs("div",{className:"mt-6 flex flex-col gap-4",children:[i.jsx(Oa,{to:"/auth/forgot-password",className:"font-medium text-white/80 hover:text-white",children:"Request a new link"}),i.jsx("div",{className:"auth-separator",children:"OR"}),i.jsx(ne,{onClick:()=>s("/auth/login"),className:"w-full",size:"lg",children:"Back to Sign In"})]})]}):i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm text-center text-gray-300 -mt-6 mb-6",children:["for ",i.jsx("span",{className:"font-semibold text-white",children:a?.email}),"."]}),i.jsxs("form",{onSubmit:c(p),className:"space-y-6",children:[i.jsx(we,{id:"password",type:"password",placeholder:"New Password",autoComplete:"new-password",registration:l("password"),error:d.password?.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),i.jsx(we,{id:"confirmPassword",type:"password",placeholder:"Confirm New Password",autoComplete:"new-password",registration:l("confirmPassword"),error:d.confirmPassword?.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),n&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:n}),i.jsx("div",{children:i.jsx(ne,{type:"submit",className:"w-full",isLoading:h,size:"lg",disabled:!a,children:"Update Password"})})]})]})},LX=()=>{const n=Nt(),{logout:e}=jt(),t=async()=>{await e(),n("/auth/login",{replace:!0})},r=()=>{n(-1)};return i.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 relative",children:i.jsxs("div",{className:"w-full max-w-md bg-card rounded-2xl shadow-card p-8 text-center relative z-10",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"p-4 rounded-full bg-red-100",children:i.jsx(jo,{className:"h-10 w-10 text-red-600"})})}),i.jsx("h1",{className:"text-2xl font-bold text-primary-text mb-2",children:"Log Out"}),i.jsx("p",{className:"text-muted mb-8",children:"Are you sure you want to log out? You will need to sign in again to access your account."}),i.jsxs("div",{className:"flex flex-col gap-3",children:[i.jsx(ne,{onClick:t,variant:"danger",className:"w-full !py-3 !text-lg shadow-lg shadow-red-100",children:"Yes, Log Out"}),i.jsx(ne,{onClick:r,variant:"secondary",className:"w-full !py-3",children:"Cancel"})]})]})})},FX=()=>{const{logout:n,user:e}=jt(),t=Nt(),r=async()=>{await n(),t("/auth/login",{replace:!0})};return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:i.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[i.jsx(Xi,{className:"h-10 mx-auto mb-6"}),i.jsx(PJ,{className:"h-16 w-16 text-accent mx-auto mb-4"}),i.jsx("h2",{className:"text-2xl font-bold text-primary-text mb-2",children:"Account Pending Approval"}),i.jsxs("p",{className:"text-muted mb-6",children:["Welcome, ",e?.name||"user","! Your account has been created successfully and is pending approval. An administrator will review your details and perform a security check before activating your account."]}),i.jsx("div",{className:"flex justify-center",children:i.jsxs(ne,{onClick:r,variant:"secondary",children:[i.jsx(jo,{className:"mr-2 h-4 w-4"}),"Log Out"]})})]})})},qX=()=>{const n=Nt();return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:i.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx(m3,{className:"h-16 w-16 text-red-500"})}),i.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Access Denied"}),i.jsx("p",{className:"text-muted mb-6",children:"You do not have the necessary permissions to view this page. If you believe this is an error, please contact your administrator."}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx(ne,{onClick:()=>n(-1),variant:"secondary",children:"Go Back"}),i.jsx(ne,{onClick:async()=>{await jt.getState().logout(),n("/auth/login")},children:"Login"})]})]})})},zX=()=>{const n=Nt(),{data:e,reset:t}=Yn(),{user:r}=jt(),s=e.personal.firstName||e.personal.lastName,a=At("(max-width: 767px)"),o=()=>{t(),n("/onboarding/select-organization")},l=()=>{n("/onboarding/add/personal")};return a?i.jsx("div",{className:"flex flex-col items-center justify-center text-center relative min-h-[70vh]",children:i.jsxs("div",{className:"p-8 max-w-sm w-full bg-transparent",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"p-4 rounded-full bg-black/20",children:i.jsx(ON,{className:"h-10 w-10 text-emerald-400"})})}),i.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to Employee Onboarding"}),i.jsx("p",{className:"text-gray-400 text-sm mb-8",children:"We need to collect some information to get you set up. This should only take a few minutes."}),i.jsxs("div",{className:"flex flex-col gap-3",children:[s&&i.jsx(ne,{onClick:l,variant:"secondary",className:"w-full !py-3",children:"Continue Previous Application"}),i.jsx(ne,{onClick:o,variant:"primary",className:"w-full !py-3 !text-lg",children:"Start New Application"})]})]})}):i.jsx("div",{className:"h-full flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-card p-8 sm:p-12 rounded-2xl shadow-card text-center w-full",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"bg-accent-light p-4 rounded-full",children:i.jsx(ON,{className:"h-12 w-12 text-accent-dark"})})}),i.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Welcome to Employee Onboarding"}),i.jsx("p",{className:"text-muted mb-8 max-w-md mx-auto",children:"We need to collect some information to get you set up. This should only take a few minutes."}),i.jsxs("div",{className:"mt-10 flex justify-center items-center gap-4 flex-wrap",children:[s&&i.jsx(ne,{onClick:l,variant:"secondary",children:"Continue Draft"}),i.jsx(ne,{onClick:o,variant:"primary",children:s?"Start Fresh":"Start New Application"})]})]})})},Ze=E.forwardRef(({label:n,id:e,error:t,registration:r,children:s,className:a,...o},l)=>{const h=`form-input ${t?"form-input--error":""} ${a||""}`;return i.jsxs("div",{children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsx("div",{className:n?"mt-1":"",children:i.jsx("select",{ref:l,id:e,className:h,"aria-invalid":!!t,...r,...o,children:s})}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})});Ze.displayName="Select";const UX=()=>{const n=Nt(),{updateOrganization:e,updatePersonal:t}=Yn(),{enforceManpowerLimit:r,manpowerLimitRule:s}=nd(),{user:a}=jt(),[o,l]=E.useState(!0),[c,d]=E.useState([]),[h,p]=E.useState([]),[x,v]=E.useState([]),[b,_]=E.useState(""),[j,C]=E.useState(""),[P,O]=E.useState(""),[M,D]=E.useState(""),[I,F]=E.useState([]),[q,U]=E.useState(window.innerWidth<768);E.useEffect(()=>{const K=()=>U(window.innerWidth<768);return window.addEventListener("resize",K),()=>window.removeEventListener("resize",K)},[]);const[B,W]=E.useState({isOverLimit:!1,message:""}),Y=a?.role==="field_officer"&&q;E.useEffect(()=>{(async()=>{l(!0);try{const[te,H,ae]=await Promise.all([ce.getOrganizationStructure(),ce.getOrganizations(),ce.getSiteStaffDesignations()]);d(te),p(H),v(ae)}catch(te){console.error("Failed to fetch organization structure",te)}finally{l(!1)}})()},[]);const G=E.useMemo(()=>c.find(K=>K.id===b),[c,b]),Z=E.useMemo(()=>G?.companies||[],[G]),oe=E.useMemo(()=>Z.find(K=>K.id===j),[Z,j]),X=E.useMemo(()=>oe?.entities||[],[oe]);E.useEffect(()=>{D("");const K=X.find(te=>te.id===P);F(K?x:[])},[P,X,x]),E.useEffect(()=>{(async()=>{if(W({isOverLimit:!1,message:""}),!P||!r)return;const H=X.find(ue=>ue.id===P)?.organizationId;if(!H)return;const le=h.find(ue=>ue.id===H)?.manpowerApprovedCount;if(le==null){W({isOverLimit:!1,message:"Manpower limit not set for this site."});return}try{const ie=(await ce.getVerificationSubmissions()).filter(pe=>pe.organizationId===H&&(pe.status==="verified"||pe.status==="pending")).length;if(ie>=le){const pe=`Manpower limit of ${le} reached (${ie} deployed).`;W({isOverLimit:!0,message:pe})}else{const pe=`Manpower: ${ie} / ${le} deployed.`;W({isOverLimit:!1,message:pe})}}catch{W({isOverLimit:!1,message:"Could not verify manpower count."})}})()},[P,h,X,r]);const he=()=>{const K=X.find(te=>te.id===P);if(K?.organizationId){const te=h.find(ae=>ae.id===K.organizationId),H=x.find(ae=>ae.designation===M);te&&H?(e({organizationId:te.id,organizationName:te.shortName,joiningDate:We(new Date,"yyyy-MM-dd"),workType:"Full-time",designation:M,department:H.department,defaultSalary:H.monthlySalary||null}),t({salary:H.monthlySalary||null}),n("/onboarding/pre-upload")):console.error("Organization or Designation details not found.")}};if(o)return i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})});const $=!P||!M||B.isOverLimit&&s==="block";return Y?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header text-white",children:[i.jsx("button",{onClick:()=>n("/onboarding"),"aria-label":"Go back",className:"text-white",children:i.jsx(Fa,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-xl font-bold",children:"New Enrollment"})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Ki,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Select Site"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Choose the client and site for the new employee."})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("select",{value:b,onChange:K=>{_(K.target.value),C(""),O("")},className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs("select",{value:j,onChange:K=>{C(K.target.value),O("")},disabled:!b,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Company --"}),Z.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs("select",{value:P,onChange:K=>O(K.target.value),disabled:!j,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Client/Site --"}),X.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs("select",{value:M,onChange:K=>D(K.target.value),disabled:!P,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Designation --"}),I.map(K=>i.jsx("option",{value:K.designation,children:K.designation},K.id))]}),B.message&&i.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${B.isOverLimit?"bg-red-900/50 text-red-300 border border-red-500/50":"bg-green-900/50 text-green-300 border border-green-500/50"}`,children:B.message})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center justify-between gap-4",children:[i.jsx("button",{onClick:()=>n("/onboarding"),className:"fo-btn-secondary px-6",children:"Back"}),i.jsx("button",{onClick:he,disabled:$,className:"fo-btn-primary flex-1",children:"Continue"})]})]}):i.jsx("div",{className:"p-4 md:p-0",children:i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Ki,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Select Site"}),i.jsx("p",{className:"text-muted",children:"Choose the client and site for the new employee."})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs(Ze,{label:"Company Group",id:"group",value:b,onChange:K=>{_(K.target.value),C(""),O("")},children:[i.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs(Ze,{label:"Company",id:"company",value:j,onChange:K=>{C(K.target.value),O("")},disabled:!b,children:[i.jsx("option",{value:"",children:"-- Select a Company --"}),Z.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs(Ze,{label:"Client / Site",id:"entity",value:P,onChange:K=>O(K.target.value),disabled:!j,children:[i.jsx("option",{value:"",children:"-- Select a Client/Site --"}),X.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs(Ze,{label:"Designation",id:"designation",value:M,onChange:K=>D(K.target.value),disabled:!P,children:[i.jsx("option",{value:"",children:"-- Select a Designation --"}),I.map(K=>i.jsx("option",{value:K.designation,children:K.designation},K.id))]})]}),B.message&&i.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${B.isOverLimit?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:B.message}),i.jsx("div",{className:"mt-8 pt-6 border-t flex justify-end",children:i.jsxs(ne,{onClick:he,disabled:$,children:["Continue ",i.jsx(nJ,{className:"ml-2 h-4 w-4"})]})})]})})},pE=({steps:n,currentStepIndex:e,onStepClick:t,highestStepReached:r,isMobileOptimized:s=!1})=>{const[a,o]=E.useState(0),l=4,c=Math.ceil(n.length/l);E.useEffect(()=>{if(s){const x=Math.floor(e/l);o(x)}},[e,s,l]);const d=()=>{o(x=>Math.min(x+1,c-1))},h=()=>{o(x=>Math.max(x-1,0))},p=E.useMemo(()=>{if(!s)return[];const x=a*l,v=x+l;return Array.from({length:n.length},(b,_)=>_).slice(x,v)},[a,l,n.length,s]);if(!s){const x=e>0?e/(n.length-1)*100:0,b=100/n.length/2;return i.jsx("nav",{"aria-label":"Onboarding Progress",className:"py-4",children:i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"absolute top-4 h-1",style:{left:`${b}%`,right:`${b}%`},children:[i.jsx("div",{className:"w-full h-full bg-border rounded-full"}),i.jsx("div",{className:"absolute top-0 left-0 h-full bg-accent rounded-full transition-all duration-500 ease-in-out",style:{width:`${x}%`}})]}),i.jsx("ol",{role:"list",className:"relative flex items-center",children:n.map((_,j)=>{const C=j<e,P=j===e,O=j<=r;return i.jsx("li",{className:"flex-1",children:i.jsxs("div",{className:"relative flex flex-col items-center group",children:[i.jsx("button",{type:"button",onClick:()=>O&&t(j),disabled:!O,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-accent-dark rounded-full disabled:cursor-not-allowed","aria-current":P?"step":void 0,title:_.label,children:i.jsx("div",{className:`relative flex items-center justify-center w-9 h-9 rounded-full transition-all duration-300 border-2 z-10 ${C?"bg-accent border-accent text-white":""} ${P?"bg-card border-accent text-accent scale-110":""} ${!C&&!P?"bg-card border-border text-muted":""} ${O?"group-hover:border-accent-dark":""}`,children:C?i.jsx(Sl,{className:"w-5 h-5"}):ot.createElement(_.icon,{className:"w-5 h-5"})})}),i.jsx("span",{className:`hidden sm:block absolute top-12 w-24 text-center text-xs transition-colors duration-300 ${P?"text-accent font-bold":"text-muted"} ${O?"group-hover:text-primary-text":""}`,children:_.label})]})},_.key)})})]})})}return i.jsxs("nav",{"aria-label":"Onboarding Progress",className:"bg-card rounded-2xl mx-4 my-2 p-2 flex items-center gap-1",children:[i.jsx("button",{type:"button",onClick:h,disabled:a===0,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Previous steps",children:i.jsx(cy,{className:"h-6 w-6"})}),i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx("ol",{role:"list",className:"flex items-center justify-around",children:p.map(x=>{const v=n[x],b=x<e,_=x===e,j=x<=r;return i.jsx("li",{className:"flex-shrink-0",children:i.jsx("div",{className:"relative flex flex-col items-center group",children:i.jsx("button",{type:"button",onClick:()=>j&&t(x),disabled:!j,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-full disabled:cursor-not-allowed","aria-current":_?"step":void 0,title:v.label,children:i.jsx("div",{className:`relative flex items-center justify-center w-10 h-10 rounded-full transition-all duration-300 border-2 z-10
                      ${b?"bg-green-600 border-green-600 text-white":""}
                      ${_?"bg-transparent border-green-500 text-white scale-110":""}
                      ${!b&&!_?`bg-transparent ${j?"border-gray-500 text-gray-400 group-hover:border-emerald-400":"border-gray-700 text-gray-600 opacity-50"}`:""}`,children:b?i.jsx(Sl,{className:"w-6 h-6 text-white"}):ot.createElement(v.icon,{className:"w-6 h-6"})})})})},v.key)})})}),i.jsx("button",{type:"button",onClick:d,disabled:a>=c-1,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Next steps",children:i.jsx(Rf,{className:"h-6 w-6"})})]})},pt=({message:n,type:e,onDismiss:t})=>{E.useEffect(()=>{const a=setTimeout(()=>{t()},5e3);return()=>{clearTimeout(a)}},[t]);const r=e==="error"?"bg-red-500":"bg-accent",s=e==="success"?Ji:ym;return i.jsxs("div",{className:`fixed top-5 right-5 z-50 flex items-center p-4 rounded-lg text-white shadow-lg ${r}`,children:[i.jsx(s,{className:"h-6 w-6 mr-3"}),i.jsx("span",{className:"text-sm font-medium",children:n}),i.jsx("button",{onClick:t,className:"ml-4 -mr-2 p-1.5 rounded-md hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white",children:i.jsx(wi,{className:"h-5 w-5"})})]})},n5=[{key:"personal",label:"Personal",icon:Ml},{key:"address",label:"Address",icon:Pl},{key:"organization",label:"Organization",icon:Ki},{key:"family",label:"Family",icon:Qi},{key:"education",label:"Education",icon:l3},{key:"bank",label:"Bank",icon:kl},{key:"uan",label:"UAN/PF",icon:rJ},{key:"esi",label:"ESI",icon:BJ},{key:"gmc",label:"GMC",icon:MC},{key:"uniform",label:"Uniform",icon:Ff},{key:"documents",label:"Documents",icon:NJ},{key:"biometrics",label:"Biometrics",icon:o3},{key:"review",label:"Review",icon:wJ}],Wi=n5.map(n=>n.key),BX=()=>{const n=Nt(),e=Zr(),{data:t,reset:r,setData:s}=Yn(),{user:a}=jt(),{salaryThreshold:o}=nd(),[l,c]=E.useState(!1),[d,h]=E.useState(!0),[p,x]=E.useState(null),[v]=y4(),[b,_]=E.useState(!1),[j,C]=E.useState("idle"),P=E.useRef(null),O=At("(max-width: 767px)"),M=E.useRef(null),D=e.pathname.split("/").pop(),I=E.useMemo(()=>Wi.indexOf(D),[D]),[F,q]=E.useState(0);E.useEffect(()=>{const $=t.personal.firstName==="Ravi"&&t.status==="draft";if(t.status!=="draft"||$){q(Wi.length-1);return}const K=sessionStorage.getItem(`onboarding_progress_${t.id}`),te=K?parseInt(K,10):0,H=Math.max(te,I);q(H),I>te&&sessionStorage.setItem(`onboarding_progress_${t.id}`,String(I))},[t,I]);const U=E.useMemo(()=>n5.map(($,K)=>({...$,status:K<I?"complete":K===I?"current":"upcoming"})),[I]);E.useEffect(()=>{const $=v.get("id");$?(async te=>{h(!0);try{const H=await ce.getOnboardingDataById(te);H?(s(H),C("saved")):(x({message:"Could not find submission data.",type:"error"}),r())}catch(H){console.error("Failed to fetch submission data",H),x({message:"Failed to load submission data.",type:"error"}),r()}finally{h(!1)}})($):h(!1)},[v,s,r]);const B=E.useCallback(async()=>{C("saving");try{const{draftId:$}=await ce.saveDraft(t);$!==t.id&&s({...t,id:$}),C("saved")}catch{x({message:"Auto-save failed. Check your connection.",type:"error"}),C("dirty")}},[t,s]);E.useEffect(()=>((!t.id||t.id.startsWith("draft_")||t.status==="draft")&&!d&&(j!=="saving"&&C("dirty"),P.current&&clearTimeout(P.current),P.current=window.setTimeout(()=>{B()},2e3)),()=>{P.current&&clearTimeout(P.current)}),[t,d,B,j]);const W=async()=>{P.current&&clearTimeout(P.current),await B();const $=M.current;if(M.current=null,$)n(`/onboarding/add/${$}`);else if(I<Wi.length-1){let K=I+1;D==="esi"&&Wi[K]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||K++),K<Wi.length&&n(`/onboarding/add/${Wi[K]}`)}},Y=$=>{$<=F&&n(`/onboarding/add/${Wi[$]}`)},G=()=>{if(I>0){let $=I-1;D==="uniform"&&Wi[$]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||$--),$>=0?n(`/onboarding/add/${Wi[$]}`):n("/onboarding/select-organization")}else n("/onboarding/select-organization")},Z=async()=>{c(!0);const $={...t,status:"pending"};try{!!t.id&&!t.id.startsWith("draft_")?(await ce.updateOnboarding($),x({message:"Application updated successfully!",type:"success"})):(await ce.submitOnboarding($),x({message:"Application submitted successfully!",type:"success"})),setTimeout(()=>{r(),a?.role==="site_manager"?n("/site/dashboard"):n("/onboarding")},2e3)}catch{x({message:"Failed to submit application.",type:"error"}),c(!1)}},oe=()=>{sessionStorage.removeItem(`onboarding_progress_${t.id}`),r(),_(!1),n("/onboarding/add/personal",{replace:!0}),x({message:"Form has been cleared.",type:"success"})},X=$=>{if($.key!=="ArrowUp"&&$.key!=="ArrowDown"&&$.key!=="Enter")return;const K=$.target;if($.key==="Enter"&&K.tagName!=="TEXTAREA"&&K.tagName!=="BUTTON"&&$.preventDefault(),$.key==="Enter"&&K.tagName==="BUTTON"||($.key==="ArrowUp"||$.key==="ArrowDown")&&(K.tagName==="TEXTAREA"||K.type==="number"))return;const te=$.currentTarget,H=Array.from(te.querySelectorAll('input:not([type="hidden"]):not([readonly]), select, textarea, button')).filter(ue=>!ue.hasAttribute("disabled")&&ue.offsetParent!==null),ae=H.indexOf(document.activeElement);if(ae===-1)return;($.key==="ArrowUp"||$.key==="ArrowDown")&&$.preventDefault();let le=ae;if($.key==="ArrowUp"?le=ae-1:le=ae+1,le>=0&&le<H.length)H[le].focus();else if($.key==="Enter"&&le>=H.length){const ue=document.getElementById("save-and-next-button");ue&&ue.click()}};if(d)return i.jsxs("div",{className:"flex justify-center items-center h-full text-muted",children:[i.jsx(_t,{className:"h-8 w-8 animate-spin mr-4"}),i.jsx("p",{children:"Loading application data..."})]});const he=Wi[I]==="review";return O?i.jsxs("div",{className:"h-full flex flex-col",children:[p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(pE,{steps:U,currentStepIndex:I,onStepClick:Y,highestStepReached:F,isMobileOptimized:!0}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4 pb-28",onKeyDown:X,children:i.jsx("div",{className:"bg-card p-6 rounded-2xl",children:i.jsx(Sf,{context:{onValidated:W,onSubmit:Z,isSubmitting:l,setToast:x}})})}),i.jsxs("footer",{className:"fixed bottom-0 left-0 right-0 p-4 flex items-center justify-between gap-2 bg-card border-t border-[#123820] z-10",children:[i.jsx(ne,{type:"button",onClick:G,variant:"secondary",children:"Back"}),i.jsx(ne,{type:"button",onClick:()=>n("/onboarding"),variant:"secondary",className:"!p-3 !rounded-full","aria-label":"Go to Home",children:i.jsx(EC,{className:"h-5 w-5"})}),i.jsx(ne,{id:"save-and-next-button",type:"submit",form:`${Wi[I]}-form`,children:he?"Submit":"Next"})]})]}):i.jsx("div",{className:"p-4 md:p-0",children:i.jsxs("div",{className:`transition-opacity duration-300 ${l?"opacity-50 pointer-events-none":""}`,children:[p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Kr,{isOpen:b,onClose:()=>_(!1),onConfirm:oe,title:"Confirm Clear Form",children:"Are you sure you want to clear all data entered in this form? This action cannot be undone."}),i.jsx(pE,{steps:U,currentStepIndex:I,onStepClick:Y,highestStepReached:F,isMobileOptimized:O}),i.jsx("div",{className:"mt-8 bg-card p-6 sm:p-8 rounded-xl shadow-card",onKeyDown:X,children:i.jsx(Sf,{context:{onValidated:W,onSubmit:Z,isSubmitting:l,setToast:x}})}),i.jsxs("div",{className:"mt-8 flex justify-between items-center",children:[i.jsx(ne,{onClick:G,disabled:I===0,variant:"secondary",children:"Back"}),i.jsxs("div",{className:"flex flex-wrap gap-4 justify-end items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted italic transition-opacity duration-300 min-h-[20px]",children:[j==="saving"&&i.jsxs(i.Fragment,{children:[i.jsx(_t,{className:"h-4 w-4 animate-spin"}),i.jsx("span",{children:"Saving..."})]}),j==="saved"&&i.jsxs(i.Fragment,{children:[i.jsx(Ji,{className:"h-4 w-4 text-accent"}),i.jsx("span",{children:"Draft saved"})]}),j==="dirty"&&i.jsx("span",{className:"text-gray-500",children:"Unsaved changes"})]}),!he&&i.jsx(ne,{id:"save-and-next-button",type:"submit",form:`${Wi[I]}-form`,children:"Save & Next"})]})]})]})})},VC=({status:n})=>{const t={pending:"status-chip--pending",verified:"status-chip--verified",rejected:"status-chip--rejected",draft:"status-chip--draft"}[n]||"status-chip--draft";return i.jsx("span",{className:`status-chip ${t}`,children:n})},Gr=({className:n=""})=>i.jsx("div",{className:`skeleton-pulse rounded-md ${n}`}),VX=({rows:n,cols:e})=>i.jsx("div",{className:"space-y-4",children:Array.from({length:n}).map((t,r)=>i.jsx("div",{className:"bg-card rounded-2xl border border-border p-4 space-y-3",children:Array.from({length:e}).map((s,a)=>i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx(Gr,{className:"h-4 w-1/4"}),i.jsx(Gr,{className:"h-4 w-1/2"})]},a))},r))}),WX=({rows:n,cols:e})=>i.jsx(i.Fragment,{children:Array.from({length:n}).map((t,r)=>i.jsx("tr",{children:Array.from({length:e}).map((s,a)=>i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"space-y-2",children:[i.jsx(Gr,{className:`h-4 ${a===0?"w-3/4":"w-full"}`}),a===0&&i.jsx(Gr,{className:"h-3 w-1/2"})]})},a))},r))}),Ra=({rows:n=5,cols:e=4,isMobile:t=!1,mobileCols:r})=>t?i.jsx(VX,{rows:n,cols:r||e}):i.jsx(WX,{rows:n,cols:e}),$X=({submission:n,isSyncing:e})=>{if(n.status!=="verified"||!n.portalSyncStatus)return i.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});if(e)return i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[i.jsx(_t,{className:"h-4 w-4 animate-spin"})," Syncing..."]});const t=n.uan?.hasPreviousPf,r=[{label:"Aadhaar",verified:n.personal?.verifiedStatus?.idProofNumber},{label:"Bank",verified:n.bank?.verifiedStatus?.accountNumber},...t?[{label:"UAN",verified:n.uan?.verifiedStatus?.uanNumber}]:[]],s=n.portalSyncStatus==="synced"||n.portalSyncStatus==="failed",a=({label:o,status:l})=>{const c=s&&l===!0,d=s&&l===!1,h=c?_m:d?g3:x3,p=c?"text-green-600":d?"text-red-600":"text-muted",x=c?"Verified":d?"Failed":"Pending Verification";return i.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-medium ${p}`,title:x,children:[i.jsx(h,{className:"h-4 w-4"}),i.jsx("span",{children:o})]})};return i.jsx("div",{className:"flex flex-row gap-3 items-center",children:r.map(o=>i.jsx(a,{label:o.label,status:o.verified},o.label))})},HX=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState("all"),[o,l]=E.useState(""),[c,d]=E.useState(null),[h,p]=E.useState(null),x=Nt(),v=At("(max-width: 767px)"),b=E.useCallback(async()=>{r(!0);try{const M=await ce.getVerificationSubmissions(s==="all"?void 0:s);e(M)}catch(M){console.error("Failed to fetch submissions",M)}finally{r(!1)}},[s]);E.useEffect(()=>{b();const M=Ee.channel("submissions-feed").on("postgres_changes",{event:"*",schema:"public",table:"onboarding_submissions"},D=>{console.log("Real-time change received!",D),b()}).subscribe();return()=>{Ee.removeChannel(M)}},[b]);const _=E.useMemo(()=>n?n.filter(M=>M.personal.firstName?.toLowerCase().includes(o.toLowerCase())||M.personal.lastName?.toLowerCase().includes(o.toLowerCase())||M.personal.employeeId?.toLowerCase().includes(o.toLowerCase())||M.organizationName?.toLowerCase().includes(o.toLowerCase())):[],[n,o]),j=async(M,D)=>{e(I=>I.map(F=>F.id===D?{...F,status:M==="approve"?"verified":"rejected",portalSyncStatus:M==="approve"?"pending_sync":void 0}:F));try{M==="approve"?await ce.verifySubmission(D):await ce.requestChanges(D,"Changes requested by admin.")}catch(I){console.error(`Failed to ${M} submission`,I)}},C=async M=>{d(M);try{const D=await ce.syncPortals(M);e(I=>I.map(F=>F.id===M?D:F)),D.portalSyncStatus==="synced"?p({message:"Portals synced successfully!",type:"success"}):p({message:"Portal sync failed. Check details.",type:"error"})}catch{p({message:"An error occurred during sync.",type:"error"})}finally{d(null)}},P=["all","pending","verified","rejected"],O=s==="verified"?4:5;return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx("h2",{className:"text-2xl font-semibold text-primary-text mb-6",children:"Onboarding Forms"}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[i.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:i.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:P.map(M=>i.jsx("button",{onClick:()=>a(M),className:`${s===M?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize`,children:M},M))})}),i.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ia,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name, ID, site...",value:o,onChange:M=>l(M.target.value),className:"form-input block w-full pl-10 pr-3 py-2 border-border rounded-lg leading-5 placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site"}),s!=="verified"&&i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Verification"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-card md:divide-y-0",children:t?v?i.jsx("tr",{children:i.jsx("td",{colSpan:O,children:i.jsx(Ra,{rows:3,cols:4,isMobile:!0})})}):i.jsx(Ra,{rows:5,cols:O}):_.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:O,className:"text-center py-10 text-white",children:"No submissions found."})}):_.map(M=>i.jsxs("tr",{className:M.requiresManualVerification?"bg-orange-50":"",children:[i.jsx("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[M.requiresManualVerification&&i.jsx("span",{title:"Manual verification required due to data mismatch.",children:i.jsx(Aa,{className:"h-4 w-4 text-orange-500 mr-2 flex-shrink-0"})}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[M.personal.firstName," ",M.personal.lastName]}),i.jsx("div",{className:"text-sm text-muted",children:M.personal.employeeId})]})]})}),i.jsx("td",{"data-label":"Site",className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-primary-text",children:M.organizationName}),s!=="verified"&&i.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(VC,{status:M.status})}),i.jsx("td",{"data-label":"Portal Verification",className:"px-6 py-4 whitespace-nowrap",children:i.jsx($X,{submission:M,isSyncing:c===M.id})}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>x(`/onboarding/add/personal?id=${M.id}`),title:"View Details","aria-label":`View details for ${M.personal.firstName}`,children:i.jsx(Tl,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>x(`/onboarding/pdf/${M.id}`),title:"Download Forms","aria-label":`Download forms for ${M.personal.firstName}`,children:i.jsx(ds,{className:"h-4 w-4"})}),M.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>j("approve",M.id),title:"Verify","aria-label":`Verify submission for ${M.personal.firstName}`,children:i.jsx(_m,{className:"h-4 w-4 text-green-600"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>j("reject",M.id),title:"Request Changes","aria-label":`Request changes for ${M.personal.firstName}`,children:i.jsx(g3,{className:"h-4 w-4 text-red-600"})})]}),M.status==="verified"&&(M.portalSyncStatus==="pending_sync"||M.portalSyncStatus==="failed")&&i.jsxs(ne,{variant:"outline",size:"sm",onClick:()=>C(M.id),isLoading:c===M.id,title:"Push data to government portals",children:[c!==M.id&&i.jsx(OC,{className:"h-4 w-4 mr-1"}),"Sync Portals"]})]})})]},M.id))})]})})]})},ra=({title:n,children:e})=>i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:n}),e&&i.jsx("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:e})]}),YX=({isOpen:n,onClose:e,onApprove:t,user:r,isConfirming:s})=>{const[a,o]=E.useState([]),[l,c]=E.useState(""),[d,h]=E.useState(!0);E.useEffect(()=>{n&&(h(!0),ce.getRoles().then(x=>{const v=x.filter(b=>b.id!=="unverified"&&b.id!=="admin");o(v),v.length>0&&c(v[0].id),h(!1)}))},[n]);const p=()=>{r&&l&&t(r.id,l)};return!n||!r?null:i.jsx(Kr,{isOpen:n,onClose:e,onConfirm:p,title:"Approve User Account",confirmButtonText:"Confirm Approval",confirmButtonVariant:"primary",isConfirming:s,children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{children:["You are approving the account for ",i.jsx("strong",{className:"text-primary-text",children:r.name})," (",r.email,")."]}),i.jsx("p",{children:"Please assign a role to activate their account."}),d?i.jsx("p",{children:"Loading roles..."}):i.jsx(Ze,{label:"Assign Role",id:"approval-role",value:l,onChange:x=>c(x.target.value),children:a.map(x=>i.jsx("option",{value:x.id,children:x.displayName},x.id))})]})})},GX=({isOpen:n,onClose:e,userId:t,userName:r,onSuccess:s})=>{const[a,o]=E.useState([]),[l,c]=E.useState([]),[d,h]=E.useState(!0),[p,x]=E.useState(!1),[v,b]=E.useState(""),[_,j]=E.useState(null);E.useEffect(()=>{n&&t&&C()},[n,t]);const C=async()=>{h(!0);try{const[I,F]=await Promise.all([ce.getUserLocations(t),ce.getLocations()]);o(I),c(F)}catch(I){console.error("Failed to load locations:",I),j({message:"Failed to load locations.",type:"error"})}finally{h(!1)}},P=async I=>{x(!0);try{await ce.assignLocationToUser(t,I);const F=await ce.getUserLocations(t);o(F),j({message:"Location assigned successfully!",type:"success"}),s?.()}catch(F){console.error("Failed to assign location:",F),j({message:F.message||"Failed to assign location.",type:"error"})}finally{x(!1)}},O=async I=>{x(!0);try{await ce.unassignLocationFromUser(t,I);const F=await ce.getUserLocations(t);o(F),j({message:"Location unassigned successfully!",type:"success"}),s?.()}catch(F){console.error("Failed to unassign location:",F),j({message:F.message||"Failed to unassign location.",type:"error"})}finally{x(!1)}},M=I=>a.some(F=>F.id===I),D=l.filter(I=>!M(I.id)).filter(I=>v===""||I.name?.toLowerCase().includes(v.toLowerCase())||I.address?.toLowerCase().includes(v.toLowerCase()));return i.jsxs(i.Fragment,{children:[_&&i.jsx(pt,{message:_.message,type:_.type,onDismiss:()=>j(null)}),i.jsx(Kr,{isOpen:n,onClose:e,title:`Manage Locations for ${r}`,children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-primary-text mb-3",children:["Assigned Locations (",a.length,")"]}),d?i.jsx("p",{className:"text-sm text-muted",children:"Loading..."}):a.length===0?i.jsx("p",{className:"text-sm text-muted bg-gray-50 p-3 rounded-lg",children:"No locations assigned yet."}):i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:a.map(I=>i.jsxs("div",{className:"flex items-start justify-between bg-accent/10 border border-accent/30 rounded-lg p-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm text-primary-text",children:I.name||"Unnamed"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:I.address||"No address"})]}),i.jsx("button",{type:"button",onClick:()=>O(I.id),disabled:p,className:"text-red-500 hover:text-red-700 disabled:opacity-50 p-1",title:"Remove",children:i.jsx(wi,{className:"h-5 w-5"})})]},I.id))})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-primary-text mb-3",children:["Available Locations (",D.length,")"]}),i.jsx(we,{type:"text",placeholder:"Search locations...",value:v,onChange:I=>b(I.target.value),className:"mb-3"}),d?i.jsx("p",{className:"text-sm text-muted",children:"Loading..."}):D.length===0?i.jsx("p",{className:"text-sm text-muted bg-gray-50 p-3 rounded-lg",children:v?"No locations found.":"All assigned."}):i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:D.map(I=>i.jsxs("div",{className:"flex items-start justify-between border border-border rounded-lg p-3 hover:bg-gray-50",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm text-primary-text",children:I.name||"Unnamed"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:I.address||"No address"}),i.jsxs("p",{className:"text-xs text-muted mt-1",children:[I.latitude.toFixed(4),", ",I.longitude.toFixed(4),"  Radius: ",I.radius,"m"]})]}),i.jsx("button",{type:"button",onClick:()=>P(I.id),disabled:p,className:"text-accent hover:text-accent-dark disabled:opacity-50 p-1",title:"Assign",children:i.jsx(Ut,{className:"h-5 w-5"})})]},I.id))})]}),i.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:i.jsx(ne,{onClick:e,variant:"secondary",children:"Done"})})]})})]})},ZX=()=>{const n=Nt(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[d,h]=E.useState(!1),[p,x]=E.useState(!1),[v,b]=E.useState(null),[_,j]=E.useState(null),[C,P]=E.useState(null),O=At("(max-width: 767px)"),M=E.useCallback(async()=>{s(!0);try{const Y=await ce.getUsers();t(Y)}catch{P({message:"Failed to fetch users.",type:"error"})}finally{s(!1)}},[]);E.useEffect(()=>{M()},[M]);const D=()=>{n("/admin/users/add")},I=Y=>{n(`/admin/users/edit/${Y.id}`)},F=Y=>{b(Y),h(!0)},q=Y=>{b(Y),c(!0)},U=async(Y,G)=>{o(!0);try{await ce.updateUser(Y,{role:G}),P({message:"User approved successfully!",type:"success"}),h(!1),M()}catch{P({message:"Failed to approve user.",type:"error"})}finally{o(!1)}},B=async()=>{if(v){o(!0);try{await ce.deleteUser(v.id),P({message:"User deleted. Remember to also remove them from Supabase Auth.",type:"success"}),c(!1),M()}catch{P({message:"Failed to delete user.",type:"error"})}finally{o(!1)}}},W=Y=>Y?Y.replace(/_/g," ").replace(/\b\w/g,G=>G.toUpperCase()):"N/A";return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[C&&i.jsx(pt,{message:C.message,type:C.type,onDismiss:()=>P(null)}),i.jsx(YX,{isOpen:d,onClose:()=>h(!1),onApprove:U,user:v,isConfirming:a}),i.jsxs(Kr,{isOpen:l,onClose:()=>c(!1),onConfirm:B,title:"Confirm Deletion",isConfirming:a,children:['Are you sure you want to delete the user "',v?.name,'"? This action cannot be undone.']}),i.jsx(GX,{isOpen:p,onClose:()=>x(!1),userId:_?.id||"",userName:_?.name||""}),i.jsx(ra,{title:"User Management",children:i.jsxs(ne,{onClick:D,children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add User"]})}),i.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 text-blue-800 p-4 rounded-lg text-sm",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(du,{className:"h-5 w-5 mr-3 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold",children:"Adding New Users"}),i.jsxs("p",{className:"mt-1",children:["Use the ",i.jsx("strong",{children:"Add User"})," button below to create a new user. Provide their name, email, role and a temporary password. The system will automatically provision their login, send them a verification email and create their profile."]}),i.jsx("p",{className:"mt-2",children:"Once they confirm their email they can sign in using the password you set. You can edit or delete users at any time from this page."})]})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Email"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:r?O?i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsx(Ra,{rows:3,cols:4,isMobile:!0})})}):i.jsx(Ra,{rows:5,cols:4}):e.map(Y=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Name",className:"px-6 py-4 font-medium",children:Y.name}),i.jsx("td",{"data-label":"Email",className:"px-6 py-4 text-sm text-muted",children:Y.email}),i.jsxs("td",{"data-label":"Role",className:"px-6 py-4 text-sm text-muted",children:[i.jsxs("div",{className:"flex items-center md:justify-start justify-end",children:[i.jsx(dy,{className:"h-4 w-4 mr-2 text-accent"}),W(Y.role)]}),Y.role==="unverified"&&i.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800 ml-2",children:"Pending Approval"})]}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[Y.role==="unverified"&&i.jsxs(ne,{variant:"outline",size:"sm",onClick:()=>F(Y),"aria-label":`Approve user ${Y.name}`,title:`Approve user ${Y.name}`,children:[i.jsx(yu,{className:"h-4 w-4 mr-2"}),"Approve"]}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>I(Y),"aria-label":`Edit user ${Y.name}`,title:`Edit user ${Y.name}`,children:i.jsx(ur,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",onClick:()=>q(Y),"aria-label":`Delete user ${Y.name}`,title:`Delete user ${Y.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(sn,{className:"h-5 w-5 text-red-500"})})]})})]},Y.id))})]})})]})};var Mb,gE;function KX(){if(gE)return Mb;gE=1;var n=!1,e,t,r,s,a,o,l,c,d,h,p,x,v,b,_;function j(){if(!n){n=!0;var P=navigator.userAgent,O=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(P),M=/(Mac OS X)|(Windows)|(Linux)/.exec(P);if(x=/\b(iPhone|iP[ao]d)/.exec(P),v=/\b(iP[ao]d)/.exec(P),h=/Android/i.exec(P),b=/FBAN\/\w+;/i.exec(P),_=/Mobile/i.exec(P),p=!!/Win64/.exec(P),O){e=O[1]?parseFloat(O[1]):O[5]?parseFloat(O[5]):NaN,e&&document&&document.documentMode&&(e=document.documentMode);var D=/(?:Trident\/(\d+.\d+))/.exec(P);o=D?parseFloat(D[1])+4:e,t=O[2]?parseFloat(O[2]):NaN,r=O[3]?parseFloat(O[3]):NaN,s=O[4]?parseFloat(O[4]):NaN,s?(O=/(?:Chrome\/(\d+\.\d+))/.exec(P),a=O&&O[1]?parseFloat(O[1]):NaN):a=NaN}else e=t=r=a=s=NaN;if(M){if(M[1]){var I=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(P);l=I?parseFloat(I[1].replace("_",".")):!0}else l=!1;c=!!M[2],d=!!M[3]}else l=c=d=!1}}var C={ie:function(){return j()||e},ieCompatibilityMode:function(){return j()||o>e},ie64:function(){return C.ie()&&p},firefox:function(){return j()||t},opera:function(){return j()||r},webkit:function(){return j()||s},safari:function(){return C.webkit()},chrome:function(){return j()||a},windows:function(){return j()||c},osx:function(){return j()||l},linux:function(){return j()||d},iphone:function(){return j()||x},mobile:function(){return j()||x||v||h||_},nativeApp:function(){return j()||b},android:function(){return j()||h},ipad:function(){return j()||v}};return Mb=C,Mb}var Eb,xE;function JX(){if(xE)return Eb;xE=1;var n=!!(typeof window<"u"&&window.document&&window.document.createElement),e={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};return Eb=e,Eb}var Db,yE;function QX(){if(yE)return Db;yE=1;var n=JX(),e;n.canUseDOM&&(e=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function t(r,s){if(!n.canUseDOM||s&&!("addEventListener"in document))return!1;var a="on"+r,o=a in document;if(!o){var l=document.createElement("div");l.setAttribute(a,"return;"),o=typeof l[a]=="function"}return!o&&e&&r==="wheel"&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o}return Db=t,Db}var Ob,vE;function XX(){if(vE)return Ob;vE=1;var n=KX(),e=QX(),t=10,r=40,s=800;function a(o){var l=0,c=0,d=0,h=0;return"detail"in o&&(c=o.detail),"wheelDelta"in o&&(c=-o.wheelDelta/120),"wheelDeltaY"in o&&(c=-o.wheelDeltaY/120),"wheelDeltaX"in o&&(l=-o.wheelDeltaX/120),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(l=c,c=0),d=l*t,h=c*t,"deltaY"in o&&(h=o.deltaY),"deltaX"in o&&(d=o.deltaX),(d||h)&&o.deltaMode&&(o.deltaMode==1?(d*=r,h*=r):(d*=s,h*=s)),d&&!l&&(l=d<1?-1:1),h&&!c&&(c=h<1?-1:1),{spinX:l,spinY:c,pixelX:d,pixelY:h}}return a.getEventType=function(){return n.firefox()?"DOMMouseScroll":e("wheel")?"wheel":"mousewheel"},Ob=a,Ob}var Ib,bE;function eee(){return bE||(bE=1,Ib=XX()),Ib}var tee=eee();const nee=wu(tee);function ree(n,e,t,r,s,a){a===void 0&&(a=0);var o=zf(n,e,a),l=o.width,c=o.height,d=Math.min(l,t),h=Math.min(c,r);return d>h*s?{width:h*s,height:h}:{width:d,height:d/s}}function see(n){return n.width>n.height?n.width/n.naturalWidth:n.height/n.naturalHeight}function Th(n,e,t,r,s){s===void 0&&(s=0);var a=zf(e.width,e.height,s),o=a.width,l=a.height;return{x:wE(n.x,o,t.width,r),y:wE(n.y,l,t.height,r)}}function wE(n,e,t,r){var s=e*r/2-t/2;return xy(n,-s,s)}function _E(n,e){return Math.sqrt(Math.pow(n.y-e.y,2)+Math.pow(n.x-e.x,2))}function jE(n,e){return Math.atan2(e.y-n.y,e.x-n.x)*180/Math.PI}function iee(n,e,t,r,s,a,o){a===void 0&&(a=0),o===void 0&&(o=!0);var l=o?aee:oee,c=zf(e.width,e.height,a),d=zf(e.naturalWidth,e.naturalHeight,a),h={x:l(100,((c.width-t.width/s)/2-n.x/s)/c.width*100),y:l(100,((c.height-t.height/s)/2-n.y/s)/c.height*100),width:l(100,t.width/c.width*100/s),height:l(100,t.height/c.height*100/s)},p=Math.round(l(d.width,h.width*d.width/100)),x=Math.round(l(d.height,h.height*d.height/100)),v=d.width>=d.height*r,b=v?{width:Math.round(x*r),height:x}:{width:p,height:Math.round(p/r)},_=xr(xr({},b),{x:Math.round(l(d.width-b.width,h.x*d.width/100)),y:Math.round(l(d.height-b.height,h.y*d.height/100))});return{croppedAreaPercentages:h,croppedAreaPixels:_}}function aee(n,e){return Math.min(n,Math.max(0,e))}function oee(n,e){return e}function lee(n,e,t,r,s,a){var o=zf(e.width,e.height,t),l=xy(r.width/o.width*(100/n.width),s,a),c={x:l*o.width/2-r.width/2-o.width*l*(n.x/100),y:l*o.height/2-r.height/2-o.height*l*(n.y/100)};return{crop:c,zoom:l}}function cee(n,e,t){var r=see(e);return t.height>t.width?t.height/(n.height*r):t.width/(n.width*r)}function dee(n,e,t,r,s,a){t===void 0&&(t=0);var o=zf(e.naturalWidth,e.naturalHeight,t),l=xy(cee(n,e,r),s,a),c=r.height>r.width?r.height/n.height:r.width/n.width,d={x:((o.width-n.width)/2-n.x)*c,y:((o.height-n.height)/2-n.y)*c};return{crop:d,zoom:l}}function SE(n,e){return{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}function uee(n){return n*Math.PI/180}function zf(n,e,t){var r=uee(t);return{width:Math.abs(Math.cos(r)*n)+Math.abs(Math.sin(r)*e),height:Math.abs(Math.sin(r)*n)+Math.abs(Math.cos(r)*e)}}function xy(n,e,t){return Math.min(Math.max(n,e),t)}function Kp(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.filter(function(t){return typeof t=="string"&&t.length>0}).join(" ").trim()}var fee=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,hee=1,mee=3,pee=1,gee=(function(n){oC(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.cropperRef=E.createRef(),t.imageRef=E.createRef(),t.videoRef=E.createRef(),t.containerPosition={x:0,y:0},t.containerRef=null,t.styleRef=null,t.containerRect=null,t.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},t.dragStartPosition={x:0,y:0},t.dragStartCrop={x:0,y:0},t.gestureZoomStart=0,t.gestureRotationStart=0,t.isTouching=!1,t.lastPinchDistance=0,t.lastPinchRotation=0,t.rafDragTimeout=null,t.rafPinchTimeout=null,t.wheelTimer=null,t.currentDoc=typeof document<"u"?document:null,t.currentWindow=typeof window<"u"?window:null,t.resizeObserver=null,t.previousCropSize=null,t.isInitialized=!1,t.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},t.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!t.containerRef)){var r=!0;t.resizeObserver=new window.ResizeObserver(function(s){if(r){r=!1;return}t.computeSizes()}),t.resizeObserver.observe(t.containerRef)}},t.preventZoomSafari=function(r){return r.preventDefault()},t.cleanEvents=function(){t.currentDoc&&(t.currentDoc.removeEventListener("mousemove",t.onMouseMove),t.currentDoc.removeEventListener("mouseup",t.onDragStopped),t.currentDoc.removeEventListener("touchmove",t.onTouchMove),t.currentDoc.removeEventListener("touchend",t.onDragStopped),t.currentDoc.removeEventListener("gesturechange",t.onGestureChange),t.currentDoc.removeEventListener("gestureend",t.onGestureEnd),t.currentDoc.removeEventListener("scroll",t.onScroll))},t.clearScrollEvent=function(){t.containerRef&&t.containerRef.removeEventListener("wheel",t.onWheel),t.wheelTimer&&clearTimeout(t.wheelTimer)},t.onMediaLoad=function(){var r=t.computeSizes();r&&(t.previousCropSize=r,t.emitCropData(),t.setInitialCrop(r),t.isInitialized=!0),t.props.onMediaLoaded&&t.props.onMediaLoaded(t.mediaSize)},t.setInitialCrop=function(r){if(t.props.initialCroppedAreaPercentages){var s=lee(t.props.initialCroppedAreaPercentages,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),a=s.crop,o=s.zoom;t.props.onCropChange(a),t.props.onZoomChange&&t.props.onZoomChange(o)}else if(t.props.initialCroppedAreaPixels){var l=dee(t.props.initialCroppedAreaPixels,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),a=l.crop,o=l.zoom;t.props.onCropChange(a),t.props.onZoomChange&&t.props.onZoomChange(o)}},t.computeSizes=function(){var r,s,a,o,l,c,d=t.imageRef.current||t.videoRef.current;if(d&&t.containerRef){t.containerRect=t.containerRef.getBoundingClientRect(),t.saveContainerPosition();var h=t.containerRect.width/t.containerRect.height,p=((r=t.imageRef.current)===null||r===void 0?void 0:r.naturalWidth)||((s=t.videoRef.current)===null||s===void 0?void 0:s.videoWidth)||0,x=((a=t.imageRef.current)===null||a===void 0?void 0:a.naturalHeight)||((o=t.videoRef.current)===null||o===void 0?void 0:o.videoHeight)||0,v=d.offsetWidth<p||d.offsetHeight<x,b=p/x,_=void 0;if(v)switch(t.state.mediaObjectFit){default:case"contain":_=h>b?{width:t.containerRect.height*b,height:t.containerRect.height}:{width:t.containerRect.width,height:t.containerRect.width/b};break;case"horizontal-cover":_={width:t.containerRect.width,height:t.containerRect.width/b};break;case"vertical-cover":_={width:t.containerRect.height*b,height:t.containerRect.height};break}else _={width:d.offsetWidth,height:d.offsetHeight};t.mediaSize=xr(xr({},_),{naturalWidth:p,naturalHeight:x}),t.props.setMediaSize&&t.props.setMediaSize(t.mediaSize);var j=t.props.cropSize?t.props.cropSize:ree(t.mediaSize.width,t.mediaSize.height,t.containerRect.width,t.containerRect.height,t.props.aspect,t.props.rotation);return(((l=t.state.cropSize)===null||l===void 0?void 0:l.height)!==j.height||((c=t.state.cropSize)===null||c===void 0?void 0:c.width)!==j.width)&&t.props.onCropSizeChange&&t.props.onCropSizeChange(j),t.setState({cropSize:j},t.recomputeCropPosition),t.props.setCropSize&&t.props.setCropSize(j),j}},t.saveContainerPosition=function(){if(t.containerRef){var r=t.containerRef.getBoundingClientRect();t.containerPosition={x:r.left,y:r.top}}},t.onMouseDown=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("mousemove",t.onMouseMove),t.currentDoc.addEventListener("mouseup",t.onDragStopped),t.saveContainerPosition(),t.onDragStart(e.getMousePoint(r)))},t.onMouseMove=function(r){return t.onDrag(e.getMousePoint(r))},t.onScroll=function(r){t.currentDoc&&(r.preventDefault(),t.saveContainerPosition())},t.onTouchStart=function(r){t.currentDoc&&(t.isTouching=!0,!(t.props.onTouchRequest&&!t.props.onTouchRequest(r))&&(t.currentDoc.addEventListener("touchmove",t.onTouchMove,{passive:!1}),t.currentDoc.addEventListener("touchend",t.onDragStopped),t.saveContainerPosition(),r.touches.length===2?t.onPinchStart(r):r.touches.length===1&&t.onDragStart(e.getTouchPoint(r.touches[0]))))},t.onTouchMove=function(r){r.preventDefault(),r.touches.length===2?t.onPinchMove(r):r.touches.length===1&&t.onDrag(e.getTouchPoint(r.touches[0]))},t.onGestureStart=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("gesturechange",t.onGestureChange),t.currentDoc.addEventListener("gestureend",t.onGestureEnd),t.gestureZoomStart=t.props.zoom,t.gestureRotationStart=t.props.rotation)},t.onGestureChange=function(r){if(r.preventDefault(),!t.isTouching){var s=e.getMousePoint(r),a=t.gestureZoomStart-1+r.scale;if(t.setNewZoom(a,s,{shouldUpdatePosition:!0}),t.props.onRotationChange){var o=t.gestureRotationStart+r.rotation;t.props.onRotationChange(o)}}},t.onGestureEnd=function(r){t.cleanEvents()},t.onDragStart=function(r){var s,a,o=r.x,l=r.y;t.dragStartPosition={x:o,y:l},t.dragStartCrop=xr({},t.props.crop),(a=(s=t.props).onInteractionStart)===null||a===void 0||a.call(s)},t.onDrag=function(r){var s=r.x,a=r.y;t.currentWindow&&(t.rafDragTimeout&&t.currentWindow.cancelAnimationFrame(t.rafDragTimeout),t.rafDragTimeout=t.currentWindow.requestAnimationFrame(function(){if(t.state.cropSize&&!(s===void 0||a===void 0)){var o=s-t.dragStartPosition.x,l=a-t.dragStartPosition.y,c={x:t.dragStartCrop.x+o,y:t.dragStartCrop.y+l},d=t.props.restrictPosition?Th(c,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):c;t.props.onCropChange(d)}}))},t.onDragStopped=function(){var r,s;t.isTouching=!1,t.cleanEvents(),t.emitCropData(),(s=(r=t.props).onInteractionEnd)===null||s===void 0||s.call(r)},t.onWheel=function(r){if(t.currentWindow&&!(t.props.onWheelRequest&&!t.props.onWheelRequest(r))){r.preventDefault();var s=e.getMousePoint(r),a=nee(r).pixelY,o=t.props.zoom-a*t.props.zoomSpeed/200;t.setNewZoom(o,s,{shouldUpdatePosition:!0}),t.state.hasWheelJustStarted||t.setState({hasWheelJustStarted:!0},function(){var l,c;return(c=(l=t.props).onInteractionStart)===null||c===void 0?void 0:c.call(l)}),t.wheelTimer&&clearTimeout(t.wheelTimer),t.wheelTimer=t.currentWindow.setTimeout(function(){return t.setState({hasWheelJustStarted:!1},function(){var l,c;return(c=(l=t.props).onInteractionEnd)===null||c===void 0?void 0:c.call(l)})},250)}},t.getPointOnContainer=function(r,s){var a=r.x,o=r.y;if(!t.containerRect)throw new Error("The Cropper is not mounted");return{x:t.containerRect.width/2-(a-s.x),y:t.containerRect.height/2-(o-s.y)}},t.getPointOnMedia=function(r){var s=r.x,a=r.y,o=t.props,l=o.crop,c=o.zoom;return{x:(s+l.x)/c,y:(a+l.y)/c}},t.setNewZoom=function(r,s,a){var o=a===void 0?{}:a,l=o.shouldUpdatePosition,c=l===void 0?!0:l;if(!(!t.state.cropSize||!t.props.onZoomChange)){var d=xy(r,t.props.minZoom,t.props.maxZoom);if(c){var h=t.getPointOnContainer(s,t.containerPosition),p=t.getPointOnMedia(h),x={x:p.x*d-h.x,y:p.y*d-h.y},v=t.props.restrictPosition?Th(x,t.mediaSize,t.state.cropSize,d,t.props.rotation):x;t.props.onCropChange(v)}t.props.onZoomChange(d)}},t.getCropData=function(){if(!t.state.cropSize)return null;var r=t.props.restrictPosition?Th(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;return iee(r,t.mediaSize,t.state.cropSize,t.getAspect(),t.props.zoom,t.props.rotation,t.props.restrictPosition)},t.emitCropData=function(){var r=t.getCropData();if(r){var s=r.croppedAreaPercentages,a=r.croppedAreaPixels;t.props.onCropComplete&&t.props.onCropComplete(s,a),t.props.onCropAreaChange&&t.props.onCropAreaChange(s,a)}},t.emitCropAreaChange=function(){var r=t.getCropData();if(r){var s=r.croppedAreaPercentages,a=r.croppedAreaPixels;t.props.onCropAreaChange&&t.props.onCropAreaChange(s,a)}},t.recomputeCropPosition=function(){if(t.state.cropSize){var r=t.props.crop;if(t.isInitialized&&t.previousCropSize){var s=Math.abs(t.previousCropSize.width-t.state.cropSize.width)>1e-6||Math.abs(t.previousCropSize.height-t.state.cropSize.height)>1e-6;if(s){var a=t.state.cropSize.width/t.previousCropSize.width,o=t.state.cropSize.height/t.previousCropSize.height;r={x:t.props.crop.x*a,y:t.props.crop.y*o}}}var l=t.props.restrictPosition?Th(r,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):r;t.previousCropSize=t.state.cropSize,t.props.onCropChange(l),t.emitCropData()}},t.onKeyDown=function(r){var s,a,o=t.props,l=o.crop,c=o.onCropChange,d=o.keyboardStep,h=o.zoom,p=o.rotation,x=d;if(t.state.cropSize){r.shiftKey&&(x*=.2);var v=xr({},l);switch(r.key){case"ArrowUp":v.y-=x,r.preventDefault();break;case"ArrowDown":v.y+=x,r.preventDefault();break;case"ArrowLeft":v.x-=x,r.preventDefault();break;case"ArrowRight":v.x+=x,r.preventDefault();break;default:return}t.props.restrictPosition&&(v=Th(v,t.mediaSize,t.state.cropSize,h,p)),r.repeat||(a=(s=t.props).onInteractionStart)===null||a===void 0||a.call(s),c(v)}},t.onKeyUp=function(r){var s,a;switch(r.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":r.preventDefault();break;default:return}t.emitCropData(),(a=(s=t.props).onInteractionEnd)===null||a===void 0||a.call(s)},t}return e.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=fee,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},e.prototype.componentWillUnmount=function(){var t,r;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((r=this.styleRef.parentNode)===null||r===void 0||r.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},e.prototype.componentDidUpdate=function(t){var r,s,a,o,l,c,d,h,p;t.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):t.aspect!==this.props.aspect?this.computeSizes():t.objectFit!==this.props.objectFit?this.computeSizes():t.zoom!==this.props.zoom?this.recomputeCropPosition():((r=t.cropSize)===null||r===void 0?void 0:r.height)!==((s=this.props.cropSize)===null||s===void 0?void 0:s.height)||((a=t.cropSize)===null||a===void 0?void 0:a.width)!==((o=this.props.cropSize)===null||o===void 0?void 0:o.width)?this.computeSizes():(((l=t.crop)===null||l===void 0?void 0:l.x)!==((c=this.props.crop)===null||c===void 0?void 0:c.x)||((d=t.crop)===null||d===void 0?void 0:d.y)!==((h=this.props.crop)===null||h===void 0?void 0:h.y))&&this.emitCropAreaChange(),t.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),t.video!==this.props.video&&((p=this.videoRef.current)===null||p===void 0||p.load());var x=this.getObjectFit();x!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:x},this.computeSizes)},e.prototype.getAspect=function(){var t=this.props,r=t.cropSize,s=t.aspect;return r?r.width/r.height:s},e.prototype.getObjectFit=function(){var t,r,s,a;if(this.props.objectFit==="cover"){var o=this.imageRef.current||this.videoRef.current;if(o&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var l=this.containerRect.width/this.containerRect.height,c=((t=this.imageRef.current)===null||t===void 0?void 0:t.naturalWidth)||((r=this.videoRef.current)===null||r===void 0?void 0:r.videoWidth)||0,d=((s=this.imageRef.current)===null||s===void 0?void 0:s.naturalHeight)||((a=this.videoRef.current)===null||a===void 0?void 0:a.videoHeight)||0,h=c/d;return h<l?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},e.prototype.onPinchStart=function(t){var r=e.getTouchPoint(t.touches[0]),s=e.getTouchPoint(t.touches[1]);this.lastPinchDistance=_E(r,s),this.lastPinchRotation=jE(r,s),this.onDragStart(SE(r,s))},e.prototype.onPinchMove=function(t){var r=this;if(!(!this.currentDoc||!this.currentWindow)){var s=e.getTouchPoint(t.touches[0]),a=e.getTouchPoint(t.touches[1]),o=SE(s,a);this.onDrag(o),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var l=_E(s,a),c=r.props.zoom*(l/r.lastPinchDistance);r.setNewZoom(c,o,{shouldUpdatePosition:!1}),r.lastPinchDistance=l;var d=jE(s,a),h=r.props.rotation+(d-r.lastPinchRotation);r.props.onRotationChange&&r.props.onRotationChange(h),r.lastPinchRotation=d})}},e.prototype.render=function(){var t=this,r,s=this.props,a=s.image,o=s.video,l=s.mediaProps,c=s.cropperProps,d=s.transform,h=s.crop,p=h.x,x=h.y,v=s.rotation,b=s.zoom,_=s.cropShape,j=s.showGrid,C=s.roundCropAreaPixels,P=s.style,O=P.containerStyle,M=P.cropAreaStyle,D=P.mediaStyle,I=s.classes,F=I.containerClassName,q=I.cropAreaClassName,U=I.mediaClassName,B=(r=this.state.mediaObjectFit)!==null&&r!==void 0?r:this.getObjectFit();return E.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(Y){return t.containerRef=Y},"data-testid":"container",style:O,className:Kp("reactEasyCrop_Container",F)},a?E.createElement("img",xr({alt:"",className:Kp("reactEasyCrop_Image",B==="contain"&&"reactEasyCrop_Contain",B==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",B==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",U)},l,{src:a,ref:this.imageRef,style:xr(xr({},D),{transform:d||"translate(".concat(p,"px, ").concat(x,"px) rotate(").concat(v,"deg) scale(").concat(b,")")}),onLoad:this.onMediaLoad})):o&&E.createElement("video",xr({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:Kp("reactEasyCrop_Video",B==="contain"&&"reactEasyCrop_Contain",B==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",B==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",U)},l,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:xr(xr({},D),{transform:d||"translate(".concat(p,"px, ").concat(x,"px) rotate(").concat(v,"deg) scale(").concat(b,")")}),controls:!1}),(Array.isArray(o)?o:[{src:o}]).map(function(W){return E.createElement("source",xr({key:W.src},W))})),this.state.cropSize&&E.createElement("div",xr({ref:this.cropperRef,style:xr(xr({},M),{width:C?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:C?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:Kp("reactEasyCrop_CropArea",_==="round"&&"reactEasyCrop_CropAreaRound",j&&"reactEasyCrop_CropAreaGrid",q)},c)))},e.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:mee,minZoom:hee,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:pee},e.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e})(E.Component);const xee=n=>new Promise((e,t)=>{const r=new Image;r.addEventListener("load",()=>e(r)),r.addEventListener("error",s=>t(s)),r.src=n});async function yee(n,e){const t=await xee(n),r=document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("No 2d context");return r.width=e.width,r.height=e.height,s.drawImage(t,e.x,e.y,e.width,e.height,0,0,e.width,e.height),r.toDataURL("image/jpeg",.9)}const r5=({isOpen:n,onClose:e,onCapture:t,captureGuidance:r="none"})=>{const s=E.useRef(null),a=E.useRef(null),o=E.useRef(null),[l,c]=E.useState(null),[d,h]=E.useState(null),[p,x]=E.useState(!1),[v,b]=E.useState(""),[_,j]=E.useState(!1),[C,P]=E.useState({x:0,y:0}),[O,M]=E.useState(1),[D,I]=E.useState(null),[F,q]=E.useState(null),[U,B]=E.useState([]),[W,Y]=E.useState(0),[G,Z]=E.useState(!1),[oe,X]=E.useState(!1),[he,$]=E.useState(!1),[K,te]=E.useState(!1),[H,ae]=E.useState(),le=E.useCallback(()=>{o.current&&(o.current.getTracks().forEach(ze=>ze.stop()),o.current=null)},[]),ue=E.useCallback(async ze=>{le(),c(null),j(!1),Z(!1);try{const be={video:ze?{deviceId:{exact:ze}}:{facingMode:"environment"}},Ue=await navigator.mediaDevices.getUserMedia(be);o.current=Ue,s.current&&(s.current.srcObject=Ue),h(null);const Ve=Ue.getVideoTracks()[0];if(Ve){const ee=Ve.getCapabilities();X(!!ee.torch),ae(Ve.getSettings().facingMode)}else X(!1)}catch(be){console.error("Error accessing camera:",be),h("Could not access camera. Please check permissions.")}},[le]);E.useEffect(()=>{if(!n){le();return}let ze=!1;return(async()=>{try{const Ue=await navigator.mediaDevices.getUserMedia({video:!0});if(ze){Ue.getTracks().forEach(se=>se.stop());return}const ee=(await navigator.mediaDevices.enumerateDevices()).filter(se=>se.kind==="videoinput");if(Ue.getTracks().forEach(se=>se.stop()),ze)return;if(B(ee),ee.length>0){let se=W;se>=ee.length&&(se=0),await ue(ee[se].deviceId)}else h("No camera found.")}catch(Ue){console.error(Ue),h("Could not access camera.")}})(),()=>{ze=!0,le()}},[n,W,ue,le]);const ie=()=>{if(s.current&&a.current){const ze=s.current,be=a.current;be.width=ze.videoWidth,be.height=ze.videoHeight,be.getContext("2d")?.drawImage(ze,0,0,ze.videoWidth,ze.videoHeight),c(be.toDataURL("image/jpeg",.9)),le()}},pe=()=>{H==="user"&&he?(te(!0),setTimeout(()=>{ie(),te(!1)},100)):ie()},re=()=>{h(null),c(null),q(null),j(!1),M(1)},de=async()=>{if(!o.current||!oe)return;const ze=o.current.getVideoTracks()[0];try{await ze.applyConstraints({advanced:[{torch:!G}]}),Z(!G)}catch(be){console.error("Failed to toggle flash",be)}},je=E.useCallback((ze,be)=>{I(be)},[]),Ae=()=>{j(!0),M(1)},Te=async()=>{try{if(l&&D){const ze=await yee(l,D);q(ze),j(!1)}}catch(ze){console.error(ze),h("Failed to crop image")}},Se=()=>{j(!1),M(1),q(null)},Pe=async()=>{const ze=F||l;if(ze){x(!0);try{const be=ze.split(",")[1];b("Enhancing photo...");const Ve=(r==="document"?await ce.enhanceDocumentPhoto(be,"image/jpeg"):null)||be;t(Ve,"image/jpeg"),e()}catch(be){h(be.message||"Processing failed.")}finally{x(!1)}}},qe=()=>{le(),e()};if(!n)return null;const He=F||l;return i.jsxs("div",{className:"fixed inset-0 z-[200] flex flex-col bg-black text-white",children:[K&&i.jsx("div",{className:"absolute inset-0 bg-white z-50"}),p&&i.jsxs("div",{className:"absolute inset-0 z-40 flex flex-col items-center justify-center bg-black/80",children:[i.jsx(_t,{className:"h-12 w-12 animate-spin text-white"}),i.jsx("p",{className:"mt-4 text-lg font-semibold",children:v})]}),i.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 bg-gradient-to-b from-black/70 to-transparent z-30 flex justify-between items-center",children:[i.jsx(ne,{variant:"icon",className:"!text-white hover:!bg-white/20 !p-2",onClick:qe,children:i.jsx(Fa,{className:"h-6 w-6"})}),i.jsx("h3",{className:"text-lg font-bold flex-1 text-center",children:_?"Crop Photo":l?"Preview":"Capture Photo"}),i.jsx("div",{className:"w-10"})]}),i.jsxs("div",{className:"flex-grow relative flex items-center justify-center overflow-hidden bg-black",children:[d&&!l&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white p-4 text-center bg-black/50 z-10",children:d}),_&&l?i.jsx("div",{className:"absolute inset-0",children:i.jsx(gee,{image:l,crop:C,zoom:O,aspect:r==="profile"?1:4/3,onCropChange:P,onCropComplete:je,onZoomChange:M,cropShape:r==="profile"?"round":"rect",style:{containerStyle:{backgroundColor:"transparent"},mediaStyle:{objectFit:"contain"}},classes:{containerClassName:"bg-black/30"}})}):i.jsxs(i.Fragment,{children:[i.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,muted:!0,className:`w-full h-full object-cover ${l?"hidden":""}`}),He&&i.jsx("img",{src:He,alt:"Preview",className:"w-full h-full object-contain"})]}),i.jsx("canvas",{ref:a,className:"hidden"})]}),i.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent z-30",children:[d&&!l&&i.jsx("div",{className:"mb-2 p-3 bg-red-500/30 text-white text-sm rounded-lg text-center",children:d}),_&&i.jsx("div",{className:"mb-4 px-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(AC,{className:"h-5 w-5 text-white/70"}),i.jsx("input",{type:"range",min:1,max:3,step:.1,value:O,onChange:ze=>M(Number(ze.target.value)),className:"flex-1 h-1 bg-white/20 rounded-lg"}),i.jsx(IC,{className:"h-5 w-5 text-white/70"})]})}),i.jsx("div",{className:"flex justify-around items-center",children:_?i.jsxs(i.Fragment,{children:[i.jsx(ne,{onClick:Se,variant:"secondary",size:"lg",className:"!rounded-full !px-6",children:"Cancel"}),i.jsxs(ne,{onClick:Te,size:"lg",className:"!rounded-full !px-6",children:[i.jsx(Sl,{className:"h-5 w-5 mr-2"})," Apply"]})]}):l?i.jsxs(i.Fragment,{children:[i.jsx(ne,{onClick:re,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:i.jsx(RN,{className:"h-6 w-6"})}),i.jsx(ne,{onClick:Ae,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:i.jsx(vJ,{className:"h-6 w-6"})}),i.jsx(ne,{onClick:Pe,size:"lg",className:"!rounded-full !p-4",children:i.jsx(Sl,{className:"h-6 w-6"})})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"w-16 h-16 flex items-center justify-center",children:[H==="environment"&&oe&&i.jsx(ne,{onClick:de,variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3",children:G?i.jsx(HJ,{className:"h-6 w-6"}):i.jsx(LN,{className:"h-6 w-6"})}),H==="user"&&i.jsx(ne,{onClick:()=>$(!he),variant:"icon",className:`!rounded-full !p-3 ${he?"!text-yellow-400":"!text-white"} hover:!bg-white/20`,children:i.jsx(v3,{className:"h-6 w-6"})})]}),i.jsx(ne,{onClick:pe,disabled:!!d||!o.current,size:"lg",className:"!rounded-full !w-20 !h-20",children:i.jsx(PC,{className:"h-8 w-8"})}),i.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:U.length>1&&i.jsx(ne,{onClick:()=>Y(ze=>(ze+1)%U.length),variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3",children:i.jsx(RN,{className:"h-6 w-6"})})})]})})]})]})},vee=({isOpen:n,onClose:e,imageUrl:t})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 p-4",onClick:e,role:"dialog","aria-modal":"true",children:i.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",onClick:r=>r.stopPropagation(),children:[i.jsx("img",{src:t,alt:"Document Preview",className:"max-w-full max-h-full object-contain rounded-lg"}),i.jsx("button",{onClick:e,className:"absolute top-0 right-0 m-2 p-2 bg-black/50 rounded-full text-white hover:bg-black/80 transition-colors","aria-label":"Close image preview",children:i.jsx(wi,{className:"h-6 w-6"})})]})}):null,vt=({label:n,file:e,onFileChange:t,allowedTypes:r=["image/jpeg","image/png","application/pdf"],error:s,allowCapture:a=!1,costingItemName:o,verificationStatus:l,onOcrComplete:c,ocrSchema:d,setToast:h,docType:p,onVerification:x})=>{const[v,b]=E.useState(!1),[_,j]=E.useState(""),[C,P]=E.useState(!1),[O,M]=E.useState(!1),{logVerificationUsage:D}=Yn.getState(),I=E.useMemo(()=>{const Z=n.toLowerCase();return Z.includes("photo")?"profile":["proof","document","card","slip","passbook","cheque","certificate"].some(oe=>Z.includes(oe))?"document":"none"},[n]),F=E.useCallback(async Z=>{if(!r.includes(Z.type)){j(`Invalid file type. Allowed: ${r.join(", ")}.`);return}if(Z.size>5*1024*1024){j("File size must be less than 5MB.");return}j(""),b(!0);const oe=URL.createObjectURL(Z);let X={name:Z.name,type:Z.type,size:Z.size,preview:oe,file:Z};t(X),o&&D(o);try{const he=new FileReader;he.readAsDataURL(Z),he.onloadend=async()=>{try{const $=he.result.split(",")[1];if(x){const K=await x($,Z.type);if(!K.success){j(K.reason),b(!1);return}}if(c&&d&&h)try{const K=await ce.extractDataFromImage($,Z.type,d,p);c(K)}catch(K){console.error("OCR failed:",K),h({message:"AI extraction failed. Please check the document.",type:"error"})}}catch($){j($.message||"Processing failed.")}finally{b(!1)}},he.onerror=()=>{throw new Error("Could not read file for processing.")}}catch(he){j(he.message||"Processing failed."),b(!1)}},[r,t,o,D,c,d,h,p,x]),q=E.useCallback(async(Z,oe)=>{const X=await(await fetch(`data:${oe};base64,${Z}`)).blob(),he=new File([X],`capture-${Date.now()}.jpg`,{type:oe});F(he)},[F]),U=()=>{e&&URL.revokeObjectURL(e.preview),t(null),j("")},B=`file-upload-${n.replace(/\s+/g,"-")}`,W=s||_,G=(Z=>{const oe=Z.toLowerCase();return oe.includes("profile photo")?Ml:oe.includes("id proof")||oe.includes("aadhaar")||oe.includes("pan")||oe.includes("voter")?i3:oe.includes("bank proof")?kl:oe.includes("signature")?ON:oe.includes("fingerprint")?o3:oe.includes("certificate")?l3:ds})(n);return i.jsxs("div",{className:"w-full",children:[i.jsx(vee,{isOpen:O,onClose:()=>M(!1),imageUrl:e?.preview||""}),C&&i.jsx(r5,{isOpen:C,onClose:()=>P(!1),onCapture:q,captureGuidance:I}),i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("label",{className:"block text-sm font-medium text-muted",htmlFor:B,children:n}),l===!0&&i.jsx("span",{title:"Verified",children:i.jsx(Ji,{className:"h-4 w-4 text-green-400"})}),l===!1&&i.jsx("span",{title:"Verification Failed",children:i.jsx(ym,{className:"h-4 w-4 text-red-400"})})]}),i.jsx("div",{className:"w-full text-center transition-all duration-300",children:e?i.jsxs("div",{className:"w-full flex flex-col h-full bg-page p-2 border border-border rounded-lg relative pro-dark-theme:bg-[#0d2c18] pro-dark-theme:border-[#123820]",children:[i.jsxs("div",{className:"flex-grow w-full rounded-md overflow-hidden group relative bg-black/10 flex items-center justify-center min-h-[100px]",children:[v?i.jsxs("div",{className:"flex flex-col items-center text-muted",children:[i.jsx(_t,{className:"h-8 w-8 animate-spin"}),i.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):e.type.startsWith("image/")?i.jsx("img",{src:e.preview,alt:"preview",className:"max-w-full max-h-28 object-contain"}):i.jsxs("div",{className:"text-muted p-2",children:[i.jsx(SJ,{className:"h-10 w-10 mx-auto"}),i.jsx("span",{className:"text-xs mt-1 block break-all",children:e.name})]}),i.jsx("label",{htmlFor:B,className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-md cursor-pointer",children:i.jsx(RN,{className:"h-6 w-6 text-white"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 flex-shrink-0",children:[e.type.startsWith("image/")&&i.jsxs("button",{type:"button",onClick:()=>M(!0),className:"text-xs font-medium text-accent hover:underline flex items-center gap-1 p-1",children:[i.jsx(Tl,{className:"h-3 w-3"})," View"]}),i.jsxs("button",{type:"button",onClick:U,className:"text-xs font-medium text-red-500 hover:underline flex items-center gap-1 p-1",children:[i.jsx(sn,{className:"h-3 w-3"})," Remove"]})]})]}):i.jsxs("label",{htmlFor:B,className:`
                        cursor-pointer flex flex-col items-center justify-center
                        p-6 border-2 border-dashed rounded-lg transition-colors
                        border-border hover:border-accent hover:bg-accent-light
                        pro-dark-theme:border-gray-600 pro-dark-theme:hover:border-accent pro-dark-theme:hover:bg-accent-light
                        ${W?"!border-red-500":""}
                    `,children:[i.jsx("div",{className:"p-3 bg-accent-light rounded-full text-accent-dark pro-dark-theme:bg-accent/20 pro-dark-theme:text-accent",children:i.jsx(G,{className:"h-8 w-8"})}),i.jsx("p",{className:"font-semibold text-primary-text mt-2",children:"Click to upload"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:"or drag & drop"}),a&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-xs text-muted my-2",children:"OR"}),i.jsxs(ne,{type:"button",onClick:Z=>{Z.preventDefault(),P(!0)},variant:"secondary",size:"sm",children:[i.jsx(PC,{className:"h-4 w-4 mr-2"}),"Capture with Camera"]})]})]})}),i.jsx("input",{id:B,type:"file",className:"sr-only",onChange:Z=>Z.target.files?.[0]&&F(Z.target.files[0]),accept:r.join(",")}),i.jsx("div",{className:"text-center mt-1 min-h-[16px]",children:W&&i.jsx("p",{className:"text-xs text-red-500",children:W})})]})};var Ab={},kh={},Rb={exports:{}},Lb,NE;function bee(){if(NE)return Lb;NE=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Lb=n,Lb}var Fb,CE;function wee(){if(CE)return Fb;CE=1;var n=bee();function e(){}function t(){}return t.resetWarningCache=e,Fb=function(){function r(o,l,c,d,h,p){if(p!==n){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}r.isRequired=r;function s(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:t,resetWarningCache:e};return a.PropTypes=a,a},Fb}var TE;function Dl(){return TE||(TE=1,Rb.exports=wee()()),Rb.exports}var Ph={},Yd={},qb={exports:{}};var kE;function Nu(){return kE||(kE=1,(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var a="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(a=s(a,r(l)))}return a}function r(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return t.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var o="";for(var l in a)e.call(a,l)&&a[l]&&(o=s(o,l));return o}function s(a,o){return o?a?a+" "+o:a+o:a}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(qb)),qb.exports}var zb={},Ub={},Bb={},Vb={},PE;function Fe(){if(PE)return Vb;PE=1,Vb.toDate=n;function n(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}return Vb}var Wb={},ME;function pn(){if(ME)return Wb;ME=1,Wb.constructFrom=n;function n(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}return Wb}var EE;function Ol(){if(EE)return Bb;EE=1,Bb.addDays=t;var n=Fe(),e=pn();function t(r,s){const a=(0,n.toDate)(r);return isNaN(s)?(0,e.constructFrom)(r,NaN):(s&&a.setDate(a.getDate()+s),a)}return Bb}var $b={},DE;function Fm(){if(DE)return $b;DE=1,$b.addMonths=t;var n=Fe(),e=pn();function t(r,s){const a=(0,n.toDate)(r);if(isNaN(s))return(0,e.constructFrom)(r,NaN);if(!s)return a;const o=a.getDate(),l=(0,e.constructFrom)(r,a.getTime());l.setMonth(a.getMonth()+s+1,0);const c=l.getDate();return o>=c?l:(a.setFullYear(l.getFullYear(),l.getMonth(),o),a)}return $b}var OE;function s5(){if(OE)return Ub;OE=1,Ub.add=s;var n=Ol(),e=Fm(),t=pn(),r=Fe();function s(a,o){const{years:l=0,months:c=0,weeks:d=0,days:h=0,hours:p=0,minutes:x=0,seconds:v=0}=o,b=(0,r.toDate)(a),_=c||l?(0,e.addMonths)(b,c+l*12):b,j=h||d?(0,n.addDays)(_,h+d*7):_,C=x+p*60,O=(v+C*60)*1e3;return(0,t.constructFrom)(a,j.getTime()+O)}return Ub}var Hb={},Yb={},IE;function i5(){if(IE)return Yb;IE=1,Yb.isSaturday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===6}return Yb}var Gb={},AE;function a5(){if(AE)return Gb;AE=1,Gb.isSunday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===0}return Gb}var Zb={},RE;function yy(){if(RE)return Zb;RE=1,Zb.isWeekend=e;var n=Fe();function e(t){const r=(0,n.toDate)(t).getDay();return r===0||r===6}return Zb}var LE;function o5(){if(LE)return Hb;LE=1,Hb.addBusinessDays=a;var n=pn(),e=i5(),t=a5(),r=yy(),s=Fe();function a(o,l){const c=(0,s.toDate)(o),d=(0,r.isWeekend)(c);if(isNaN(l))return(0,n.constructFrom)(o,NaN);const h=c.getHours(),p=l<0?-1:1,x=Math.trunc(l/5);c.setDate(c.getDate()+x*7);let v=Math.abs(l%5);for(;v>0;)c.setDate(c.getDate()+p),(0,r.isWeekend)(c)||(v-=1);return d&&(0,r.isWeekend)(c)&&l!==0&&((0,e.isSaturday)(c)&&c.setDate(c.getDate()+(p<0?2:-1)),(0,t.isSunday)(c)&&c.setDate(c.getDate()+(p<0?1:-2))),c.setHours(h),c}return Hb}var Kb={},Jb={},FE;function qm(){if(FE)return Jb;FE=1,Jb.addMilliseconds=t;var n=Fe(),e=pn();function t(r,s){const a=+(0,n.toDate)(r);return(0,e.constructFrom)(r,a+s)}return Jb}var Ot={},qE;function en(){if(qE)return Ot;qE=1,Ot.secondsInYear=Ot.secondsInWeek=Ot.secondsInQuarter=Ot.secondsInMonth=Ot.secondsInMinute=Ot.secondsInHour=Ot.secondsInDay=Ot.quartersInYear=Ot.monthsInYear=Ot.monthsInQuarter=Ot.minutesInYear=Ot.minutesInMonth=Ot.minutesInHour=Ot.minutesInDay=Ot.minTime=Ot.millisecondsInWeek=Ot.millisecondsInSecond=Ot.millisecondsInMinute=Ot.millisecondsInHour=Ot.millisecondsInDay=Ot.maxTime=Ot.daysInYear=Ot.daysInWeek=void 0,Ot.daysInWeek=7;const n=Ot.daysInYear=365.2425,e=Ot.maxTime=Math.pow(10,8)*24*60*60*1e3;Ot.minTime=-e,Ot.millisecondsInWeek=6048e5,Ot.millisecondsInDay=864e5,Ot.millisecondsInMinute=6e4,Ot.millisecondsInHour=36e5,Ot.millisecondsInSecond=1e3,Ot.minutesInYear=525600,Ot.minutesInMonth=43200,Ot.minutesInDay=1440,Ot.minutesInHour=60,Ot.monthsInQuarter=3,Ot.monthsInYear=12,Ot.quartersInYear=4;const t=Ot.secondsInHour=3600;Ot.secondsInMinute=60;const r=Ot.secondsInDay=t*24;Ot.secondsInWeek=r*7;const s=Ot.secondsInYear=r*n,a=Ot.secondsInMonth=s/12;return Ot.secondsInQuarter=a*3,Ot}var zE;function WC(){if(zE)return Kb;zE=1,Kb.addHours=t;var n=qm(),e=en();function t(r,s){return(0,n.addMilliseconds)(r,s*e.millisecondsInHour)}return Kb}var Qb={},Xb={},e0={},t0={},Jp={},UE;function Cs(){if(UE)return Jp;UE=1,Jp.getDefaultOptions=e,Jp.setDefaultOptions=t;let n={};function e(){return n}function t(r){n=r}return Jp}var BE;function Mo(){if(BE)return t0;BE=1,t0.startOfWeek=t;var n=Fe(),e=Cs();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?7:0)+c-o;return l.setDate(l.getDate()-d),l.setHours(0,0,0,0),l}return t0}var VE;function Il(){if(VE)return e0;VE=1,e0.startOfISOWeek=e;var n=Mo();function e(t){return(0,n.startOfWeek)(t,{weekStartsOn:1})}return e0}var WE;function Cu(){if(WE)return Xb;WE=1,Xb.getISOWeekYear=r;var n=pn(),e=Il(),t=Fe();function r(s){const a=(0,t.toDate)(s),o=a.getFullYear(),l=(0,n.constructFrom)(s,0);l.setFullYear(o+1,0,4),l.setHours(0,0,0,0);const c=(0,e.startOfISOWeek)(l),d=(0,n.constructFrom)(s,0);d.setFullYear(o,0,4),d.setHours(0,0,0,0);const h=(0,e.startOfISOWeek)(d);return a.getTime()>=c.getTime()?o+1:a.getTime()>=h.getTime()?o:o-1}return Xb}var n0={},r0={},s0={},$E;function vy(){if($E)return s0;$E=1,s0.startOfDay=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setHours(0,0,0,0),r}return s0}var i0={},HE;function id(){if(HE)return i0;HE=1,i0.getTimezoneOffsetInMilliseconds=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+t-+s}return i0}var YE;function ad(){if(YE)return r0;YE=1,r0.differenceInCalendarDays=r;var n=en(),e=vy(),t=id();function r(s,a){const o=(0,e.startOfDay)(s),l=(0,e.startOfDay)(a),c=+o-(0,t.getTimezoneOffsetInMilliseconds)(o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l);return Math.round((c-d)/n.millisecondsInDay)}return r0}var a0={},GE;function zm(){if(GE)return a0;GE=1,a0.startOfISOWeekYear=r;var n=Cu(),e=Il(),t=pn();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);return o.setFullYear(a,0,4),o.setHours(0,0,0,0),(0,e.startOfISOWeek)(o)}return a0}var ZE;function l5(){if(ZE)return n0;ZE=1,n0.setISOWeekYear=s;var n=pn(),e=ad(),t=zm(),r=Fe();function s(a,o){let l=(0,r.toDate)(a);const c=(0,e.differenceInCalendarDays)(l,(0,t.startOfISOWeekYear)(l)),d=(0,n.constructFrom)(a,0);return d.setFullYear(o,0,4),d.setHours(0,0,0,0),l=(0,t.startOfISOWeekYear)(d),l.setDate(l.getDate()+c),l}return n0}var KE;function c5(){if(KE)return Qb;KE=1,Qb.addISOWeekYears=t;var n=Cu(),e=l5();function t(r,s){return(0,e.setISOWeekYear)(r,(0,n.getISOWeekYear)(r)+s)}return Qb}var o0={},JE;function $C(){if(JE)return o0;JE=1,o0.addMinutes=t;var n=qm(),e=en();function t(r,s){return(0,n.addMilliseconds)(r,s*e.millisecondsInMinute)}return o0}var l0={},QE;function HC(){if(QE)return l0;QE=1,l0.addQuarters=e;var n=Fm();function e(t,r){const s=r*3;return(0,n.addMonths)(t,s)}return l0}var c0={},XE;function d5(){if(XE)return c0;XE=1,c0.addSeconds=e;var n=qm();function e(t,r){return(0,n.addMilliseconds)(t,r*1e3)}return c0}var d0={},e2;function by(){if(e2)return d0;e2=1,d0.addWeeks=e;var n=Ol();function e(t,r){const s=r*7;return(0,n.addDays)(t,s)}return d0}var u0={},t2;function u5(){if(t2)return u0;t2=1,u0.addYears=e;var n=Fm();function e(t,r){return(0,n.addMonths)(t,r*12)}return u0}var f0={},n2;function _ee(){if(n2)return f0;n2=1,f0.areIntervalsOverlapping=e;var n=Fe();function e(t,r,s){const[a,o]=[+(0,n.toDate)(t.start),+(0,n.toDate)(t.end)].sort((d,h)=>d-h),[l,c]=[+(0,n.toDate)(r.start),+(0,n.toDate)(r.end)].sort((d,h)=>d-h);return s?.inclusive?a<=c&&l<=o:a<c&&l<o}return f0}var h0={},m0={},r2;function f5(){if(r2)return m0;r2=1,m0.max=e;var n=Fe();function e(t){let r;return t.forEach(function(s){const a=(0,n.toDate)(s);(r===void 0||r<a||isNaN(Number(a)))&&(r=a)}),r||new Date(NaN)}return m0}var p0={},s2;function h5(){if(s2)return p0;s2=1,p0.min=e;var n=Fe();function e(t){let r;return t.forEach(s=>{const a=(0,n.toDate)(s);(!r||r>a||isNaN(+a))&&(r=a)}),r||new Date(NaN)}return p0}var i2;function jee(){if(i2)return h0;i2=1,h0.clamp=t;var n=f5(),e=h5();function t(r,s){return(0,e.min)([(0,n.max)([r,s.start]),s.end])}return h0}var g0={},a2;function See(){if(a2)return g0;a2=1,g0.closestIndexTo=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);if(isNaN(Number(s)))return NaN;const a=s.getTime();let o,l;return r.forEach(function(c,d){const h=(0,n.toDate)(c);if(isNaN(Number(h))){o=NaN,l=NaN;return}const p=Math.abs(a-h.getTime());(o==null||p<l)&&(o=d,l=p)}),o}return g0}var x0={},o2;function Nee(){if(o2)return x0;o2=1,x0.closestTo=t;var n=pn(),e=Fe();function t(r,s){const a=(0,e.toDate)(r);if(isNaN(Number(a)))return(0,n.constructFrom)(r,NaN);const o=a.getTime();let l,c;return s.forEach(d=>{const h=(0,e.toDate)(d);if(isNaN(Number(h))){l=(0,n.constructFrom)(r,NaN),c=NaN;return}const p=Math.abs(o-h.getTime());(l==null||p<c)&&(l=h,c=p)}),l}return x0}var y0={},l2;function Zf(){if(l2)return y0;l2=1,y0.compareAsc=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getTime()-a.getTime();return o<0?-1:o>0?1:o}return y0}var v0={},c2;function Cee(){if(c2)return v0;c2=1,v0.compareDesc=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getTime()-a.getTime();return o>0?-1:o<0?1:o}return v0}var b0={},d2;function Xs(){if(d2)return b0;d2=1,b0.constructNow=e;var n=pn();function e(t){return(0,n.constructFrom)(t,Date.now())}return b0}var w0={},u2;function Tee(){if(u2)return w0;u2=1,w0.daysToWeeks=e;var n=en();function e(t){const r=t/n.daysInWeek,s=Math.trunc(r);return s===0?0:s}return w0}var _0={},j0={},f2;function Um(){if(f2)return j0;f2=1,j0.isSameDay=e;var n=vy();function e(t,r){const s=(0,n.startOfDay)(t),a=(0,n.startOfDay)(r);return+s==+a}return j0}var S0={},N0={},h2;function m5(){if(h2)return N0;h2=1,N0.isDate=n;function n(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}return N0}var m2;function od(){if(m2)return S0;m2=1,S0.isValid=t;var n=m5(),e=Fe();function t(r){if(!(0,n.isDate)(r)&&typeof r!="number")return!1;const s=(0,e.toDate)(r);return!isNaN(Number(s))}return S0}var p2;function kee(){if(p2)return _0;p2=1,_0.differenceInBusinessDays=o;var n=Ol(),e=ad(),t=Um(),r=od(),s=yy(),a=Fe();function o(l,c){const d=(0,a.toDate)(l);let h=(0,a.toDate)(c);if(!(0,r.isValid)(d)||!(0,r.isValid)(h))return NaN;const p=(0,e.differenceInCalendarDays)(d,h),x=p<0?-1:1,v=Math.trunc(p/7);let b=v*5;for(h=(0,n.addDays)(h,v*7);!(0,t.isSameDay)(d,h);)b+=(0,s.isWeekend)(h)?0:x,h=(0,n.addDays)(h,x);return b===0?0:b}return _0}var C0={},g2;function p5(){if(g2)return C0;g2=1,C0.differenceInCalendarISOWeekYears=e;var n=Cu();function e(t,r){return(0,n.getISOWeekYear)(t)-(0,n.getISOWeekYear)(r)}return C0}var T0={},x2;function Pee(){if(x2)return T0;x2=1,T0.differenceInCalendarISOWeeks=r;var n=en(),e=Il(),t=id();function r(s,a){const o=(0,e.startOfISOWeek)(s),l=(0,e.startOfISOWeek)(a),c=+o-(0,t.getTimezoneOffsetInMilliseconds)(o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l);return Math.round((c-d)/n.millisecondsInWeek)}return T0}var k0={},y2;function YC(){if(y2)return k0;y2=1,k0.differenceInCalendarMonths=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getFullYear()-a.getFullYear(),l=s.getMonth()-a.getMonth();return o*12+l}return k0}var P0={},M0={},v2;function g5(){if(v2)return M0;v2=1,M0.getQuarter=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return Math.trunc(r.getMonth()/3)+1}return M0}var b2;function x5(){if(b2)return P0;b2=1,P0.differenceInCalendarQuarters=t;var n=g5(),e=Fe();function t(r,s){const a=(0,e.toDate)(r),o=(0,e.toDate)(s),l=a.getFullYear()-o.getFullYear(),c=(0,n.getQuarter)(a)-(0,n.getQuarter)(o);return l*4+c}return P0}var E0={},w2;function GC(){if(w2)return E0;w2=1,E0.differenceInCalendarWeeks=r;var n=en(),e=Mo(),t=id();function r(s,a,o){const l=(0,e.startOfWeek)(s,o),c=(0,e.startOfWeek)(a,o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l),h=+c-(0,t.getTimezoneOffsetInMilliseconds)(c);return Math.round((d-h)/n.millisecondsInWeek)}return E0}var D0={},_2;function ZC(){if(_2)return D0;_2=1,D0.differenceInCalendarYears=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()-a.getFullYear()}return D0}var O0={},j2;function KC(){if(j2)return O0;j2=1,O0.differenceInDays=t;var n=ad(),e=Fe();function t(s,a){const o=(0,e.toDate)(s),l=(0,e.toDate)(a),c=r(o,l),d=Math.abs((0,n.differenceInCalendarDays)(o,l));o.setDate(o.getDate()-c*d);const h=+(r(o,l)===-c),p=c*(d-h);return p===0?0:p}function r(s,a){const o=s.getFullYear()-a.getFullYear()||s.getMonth()-a.getMonth()||s.getDate()-a.getDate()||s.getHours()-a.getHours()||s.getMinutes()-a.getMinutes()||s.getSeconds()-a.getSeconds()||s.getMilliseconds()-a.getMilliseconds();return o<0?-1:o>0?1:o}return O0}var I0={},A0={},S2;function ld(){if(S2)return A0;S2=1,A0.getRoundingMethod=n;function n(e){return t=>{const s=(e?Math[e]:Math.trunc)(t);return s===0?0:s}}return A0}var R0={},N2;function wy(){if(N2)return R0;N2=1,R0.differenceInMilliseconds=e;var n=Fe();function e(t,r){return+(0,n.toDate)(t)-+(0,n.toDate)(r)}return R0}var C2;function JC(){if(C2)return I0;C2=1,I0.differenceInHours=r;var n=ld(),e=en(),t=wy();function r(s,a,o){const l=(0,t.differenceInMilliseconds)(s,a)/e.millisecondsInHour;return(0,n.getRoundingMethod)(o?.roundingMethod)(l)}return I0}var L0={},F0={},T2;function y5(){if(T2)return F0;T2=1,F0.subISOWeekYears=e;var n=c5();function e(t,r){return(0,n.addISOWeekYears)(t,-r)}return F0}var k2;function Mee(){if(k2)return L0;k2=1,L0.differenceInISOWeekYears=s;var n=Zf(),e=p5(),t=y5(),r=Fe();function s(a,o){let l=(0,r.toDate)(a);const c=(0,r.toDate)(o),d=(0,n.compareAsc)(l,c),h=Math.abs((0,e.differenceInCalendarISOWeekYears)(l,c));l=(0,t.subISOWeekYears)(l,d*h);const p=+((0,n.compareAsc)(l,c)===-d),x=d*(h-p);return x===0?0:x}return L0}var q0={},P2;function QC(){if(P2)return q0;P2=1,q0.differenceInMinutes=r;var n=ld(),e=en(),t=wy();function r(s,a,o){const l=(0,t.differenceInMilliseconds)(s,a)/e.millisecondsInMinute;return(0,n.getRoundingMethod)(o?.roundingMethod)(l)}return q0}var z0={},U0={},B0={},M2;function XC(){if(M2)return B0;M2=1,B0.endOfDay=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setHours(23,59,59,999),r}return B0}var V0={},E2;function e1(){if(E2)return V0;E2=1,V0.endOfMonth=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(23,59,59,999),r}return V0}var D2;function v5(){if(D2)return U0;D2=1,U0.isLastDayOfMonth=r;var n=XC(),e=e1(),t=Fe();function r(s){const a=(0,t.toDate)(s);return+(0,n.endOfDay)(a)==+(0,e.endOfMonth)(a)}return U0}var O2;function _y(){if(O2)return z0;O2=1,z0.differenceInMonths=s;var n=Zf(),e=YC(),t=v5(),r=Fe();function s(a,o){const l=(0,r.toDate)(a),c=(0,r.toDate)(o),d=(0,n.compareAsc)(l,c),h=Math.abs((0,e.differenceInCalendarMonths)(l,c));let p;if(h<1)p=0;else{l.getMonth()===1&&l.getDate()>27&&l.setDate(30),l.setMonth(l.getMonth()-d*h);let x=(0,n.compareAsc)(l,c)===-d;(0,t.isLastDayOfMonth)((0,r.toDate)(a))&&h===1&&(0,n.compareAsc)(a,c)===1&&(x=!1),p=d*(h-Number(x))}return p===0?0:p}return z0}var W0={},I2;function Eee(){if(I2)return W0;I2=1,W0.differenceInQuarters=t;var n=ld(),e=_y();function t(r,s,a){const o=(0,e.differenceInMonths)(r,s)/3;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return W0}var $0={},A2;function jy(){if(A2)return $0;A2=1,$0.differenceInSeconds=t;var n=ld(),e=wy();function t(r,s,a){const o=(0,e.differenceInMilliseconds)(r,s)/1e3;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return $0}var H0={},R2;function Dee(){if(R2)return H0;R2=1,H0.differenceInWeeks=t;var n=ld(),e=KC();function t(r,s,a){const o=(0,e.differenceInDays)(r,s)/7;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return H0}var Y0={},L2;function b5(){if(L2)return Y0;L2=1,Y0.differenceInYears=r;var n=Zf(),e=ZC(),t=Fe();function r(s,a){const o=(0,t.toDate)(s),l=(0,t.toDate)(a),c=(0,n.compareAsc)(o,l),d=Math.abs((0,e.differenceInCalendarYears)(o,l));o.setFullYear(1584),l.setFullYear(1584);const h=(0,n.compareAsc)(o,l)===-c,p=c*(d-+h);return p===0?0:p}return Y0}var G0={},F2;function w5(){if(F2)return G0;F2=1,G0.eachDayOfInterval=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setDate(c.getDate()+d),c.setHours(0,0,0,0);return o?h.reverse():h}return G0}var Z0={},q2;function Oee(){if(q2)return Z0;q2=1,Z0.eachHourOfInterval=t;var n=WC(),e=Fe();function t(r,s){const a=(0,e.toDate)(r.start),o=(0,e.toDate)(r.end);let l=+a>+o;const c=l?+a:+o;let d=l?o:a;d.setMinutes(0,0,0);let h=s?.step??1;if(!h)return[];h<0&&(h=-h,l=!l);const p=[];for(;+d<=c;)p.push((0,e.toDate)(d)),d=(0,n.addHours)(d,h);return l?p.reverse():p}return Z0}var K0={},J0={},z2;function t1(){if(z2)return J0;z2=1,J0.startOfMinute=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setSeconds(0,0),r}return J0}var U2;function Iee(){if(U2)return K0;U2=1,K0.eachMinuteOfInterval=r;var n=$C(),e=t1(),t=Fe();function r(s,a){const o=(0,e.startOfMinute)((0,t.toDate)(s.start)),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?+o:+l;let h=c?l:o,p=a?.step??1;if(!p)return[];p<0&&(p=-p,c=!c);const x=[];for(;+h<=d;)x.push((0,t.toDate)(h)),h=(0,n.addMinutes)(h,p);return c?x.reverse():x}return K0}var Q0={},B2;function Aee(){if(B2)return Q0;B2=1,Q0.eachMonthOfInterval=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0),c.setDate(1);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setMonth(c.getMonth()+d);return o?h.reverse():h}return Q0}var X0={},ew={},V2;function n1(){if(V2)return ew;V2=1,ew.startOfQuarter=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3;return r.setMonth(a,1),r.setHours(0,0,0,0),r}return ew}var W2;function Ree(){if(W2)return X0;W2=1,X0.eachQuarterOfInterval=r;var n=HC(),e=n1(),t=Fe();function r(s,a){const o=(0,t.toDate)(s.start),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?+(0,e.startOfQuarter)(o):+(0,e.startOfQuarter)(l);let h=c?(0,e.startOfQuarter)(l):(0,e.startOfQuarter)(o),p=a?.step??1;if(!p)return[];p<0&&(p=-p,c=!c);const x=[];for(;+h<=d;)x.push((0,t.toDate)(h)),h=(0,n.addQuarters)(h,p);return c?x.reverse():x}return X0}var tw={},$2;function Lee(){if($2)return tw;$2=1,tw.eachWeekOfInterval=r;var n=by(),e=Mo(),t=Fe();function r(s,a){const o=(0,t.toDate)(s.start),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?(0,e.startOfWeek)(l,a):(0,e.startOfWeek)(o,a),h=c?(0,e.startOfWeek)(o,a):(0,e.startOfWeek)(l,a);d.setHours(15),h.setHours(15);const p=+h.getTime();let x=d,v=a?.step??1;if(!v)return[];v<0&&(v=-v,c=!c);const b=[];for(;+x<=p;)x.setHours(0),b.push((0,t.toDate)(x)),x=(0,n.addWeeks)(x,v),x.setHours(15);return c?b.reverse():b}return tw}var nw={},H2;function r1(){if(H2)return nw;H2=1,nw.eachWeekendOfInterval=t;var n=w5(),e=yy();function t(r){const s=(0,n.eachDayOfInterval)(r),a=[];let o=0;for(;o<s.length;){const l=s[o++];(0,e.isWeekend)(l)&&a.push(l)}return a}return nw}var rw={},sw={},Y2;function Sy(){if(Y2)return sw;Y2=1,sw.startOfMonth=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setDate(1),r.setHours(0,0,0,0),r}return sw}var G2;function Fee(){if(G2)return rw;G2=1,rw.eachWeekendOfMonth=r;var n=r1(),e=e1(),t=Sy();function r(s){const a=(0,t.startOfMonth)(s),o=(0,e.endOfMonth)(s);return(0,n.eachWeekendOfInterval)({start:a,end:o})}return rw}var iw={},aw={},Z2;function _5(){if(Z2)return aw;Z2=1,aw.endOfYear=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(23,59,59,999),r}return aw}var ow={},K2;function s1(){if(K2)return ow;K2=1,ow.startOfYear=t;var n=Fe(),e=pn();function t(r){const s=(0,n.toDate)(r),a=(0,e.constructFrom)(r,0);return a.setFullYear(s.getFullYear(),0,1),a.setHours(0,0,0,0),a}return ow}var J2;function qee(){if(J2)return iw;J2=1,iw.eachWeekendOfYear=r;var n=r1(),e=_5(),t=s1();function r(s){const a=(0,t.startOfYear)(s),o=(0,e.endOfYear)(s);return(0,n.eachWeekendOfInterval)({start:a,end:o})}return iw}var lw={},Q2;function zee(){if(Q2)return lw;Q2=1,lw.eachYearOfInterval=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0),c.setMonth(0,1);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setFullYear(c.getFullYear()+d);return o?h.reverse():h}return lw}var cw={},X2;function Uee(){if(X2)return cw;X2=1,cw.endOfDecade=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=9+Math.floor(s/10)*10;return r.setFullYear(a,11,31),r.setHours(23,59,59,999),r}return cw}var dw={},eD;function Bee(){if(eD)return dw;eD=1,dw.endOfHour=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setMinutes(59,59,999),r}return dw}var uw={},fw={},tD;function j5(){if(tD)return fw;tD=1,fw.endOfWeek=t;var n=Fe(),e=Cs();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?-7:0)+6-(c-o);return l.setDate(l.getDate()+d),l.setHours(23,59,59,999),l}return fw}var nD;function Vee(){if(nD)return uw;nD=1,uw.endOfISOWeek=e;var n=j5();function e(t){return(0,n.endOfWeek)(t,{weekStartsOn:1})}return uw}var hw={},rD;function Wee(){if(rD)return hw;rD=1,hw.endOfISOWeekYear=r;var n=Cu(),e=Il(),t=pn();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const l=(0,e.startOfISOWeek)(o);return l.setMilliseconds(l.getMilliseconds()-1),l}return hw}var mw={},sD;function $ee(){if(sD)return mw;sD=1,mw.endOfMinute=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setSeconds(59,999),r}return mw}var pw={},iD;function Hee(){if(iD)return pw;iD=1,pw.endOfQuarter=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3+3;return r.setMonth(a,0),r.setHours(23,59,59,999),r}return pw}var gw={},aD;function Yee(){if(aD)return gw;aD=1,gw.endOfSecond=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setMilliseconds(999),r}return gw}var xw={},oD;function Gee(){if(oD)return xw;oD=1,xw.endOfToday=e;var n=XC();function e(){return(0,n.endOfDay)(Date.now())}return xw}var yw={},lD;function Zee(){if(lD)return yw;lD=1,yw.endOfTomorrow=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s+1),a.setHours(23,59,59,999),a}return yw}var vw={},cD;function Kee(){if(cD)return vw;cD=1,vw.endOfYesterday=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s-1),a.setHours(23,59,59,999),a}return vw}var bw={},ww={},Qp={},Xp={},dD;function Jee(){if(dD)return Xp;dD=1,Xp.formatDistance=void 0;const n={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},e=(t,r,s)=>{let a;const o=n[t];return typeof o=="string"?a=o:r===1?a=o.one:a=o.other.replace("{{count}}",r.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};return Xp.formatDistance=e,Xp}var eg={},_w={},uD;function Qee(){if(uD)return _w;uD=1,_w.buildFormatLongFn=n;function n(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}return _w}var fD;function Xee(){if(fD)return eg;fD=1,eg.formatLong=void 0;var n=Qee();const e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},t={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},r={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"};return eg.formatLong={date:(0,n.buildFormatLongFn)({formats:e,defaultWidth:"full"}),time:(0,n.buildFormatLongFn)({formats:t,defaultWidth:"full"}),dateTime:(0,n.buildFormatLongFn)({formats:r,defaultWidth:"full"})},eg}var tg={},hD;function ete(){if(hD)return tg;hD=1,tg.formatRelative=void 0;const n={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},e=(t,r,s,a)=>n[t];return tg.formatRelative=e,tg}var ng={},jw={},mD;function tte(){if(mD)return jw;mD=1,jw.buildLocalizeFn=n;function n(e){return(t,r)=>{const s=r?.context?String(r.context):"standalone";let a;if(s==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=r?.width?String(r.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=r?.width?String(r.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(t):t;return a[o]}}return jw}var pD;function nte(){if(pD)return ng;pD=1,ng.localize=void 0;var n=tte();const e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},t={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},r={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},s={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},a={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},o={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},l=(c,d)=>{const h=Number(c),p=h%100;if(p>20||p<10)switch(p%10){case 1:return h+"st";case 2:return h+"nd";case 3:return h+"rd"}return h+"th"};return ng.localize={ordinalNumber:l,era:(0,n.buildLocalizeFn)({values:e,defaultWidth:"wide"}),quarter:(0,n.buildLocalizeFn)({values:t,defaultWidth:"wide",argumentCallback:c=>c-1}),month:(0,n.buildLocalizeFn)({values:r,defaultWidth:"wide"}),day:(0,n.buildLocalizeFn)({values:s,defaultWidth:"wide"}),dayPeriod:(0,n.buildLocalizeFn)({values:a,defaultWidth:"wide",formattingValues:o,defaultFormattingWidth:"wide"})},ng}var rg={},Sw={},gD;function rte(){if(gD)return Sw;gD=1,Sw.buildMatchFn=n;function n(r){return(s,a={})=>{const o=a.width,l=o&&r.matchPatterns[o]||r.matchPatterns[r.defaultMatchWidth],c=s.match(l);if(!c)return null;const d=c[0],h=o&&r.parsePatterns[o]||r.parsePatterns[r.defaultParseWidth],p=Array.isArray(h)?t(h,b=>b.test(d)):e(h,b=>b.test(d));let x;x=r.valueCallback?r.valueCallback(p):p,x=a.valueCallback?a.valueCallback(x):x;const v=s.slice(d.length);return{value:x,rest:v}}}function e(r,s){for(const a in r)if(Object.prototype.hasOwnProperty.call(r,a)&&s(r[a]))return a}function t(r,s){for(let a=0;a<r.length;a++)if(s(r[a]))return a}return Sw}var Nw={},xD;function ste(){if(xD)return Nw;xD=1,Nw.buildMatchPatternFn=n;function n(e){return(t,r={})=>{const s=t.match(e.matchPattern);if(!s)return null;const a=s[0],o=t.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=r.valueCallback?r.valueCallback(l):l;const c=t.slice(a.length);return{value:l,rest:c}}}return Nw}var yD;function ite(){if(yD)return rg;yD=1,rg.match=void 0;var n=rte(),e=ste();const t=/^(\d+)(th|st|nd|rd)?/i,r=/\d+/i,s={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},a={any:[/^b/i,/^(a|c)/i]},o={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},l={any:[/1/i,/2/i,/3/i,/4/i]},c={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},d={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},h={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},p={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},x={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},v={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}};return rg.match={ordinalNumber:(0,e.buildMatchPatternFn)({matchPattern:t,parsePattern:r,valueCallback:b=>parseInt(b,10)}),era:(0,n.buildMatchFn)({matchPatterns:s,defaultMatchWidth:"wide",parsePatterns:a,defaultParseWidth:"any"}),quarter:(0,n.buildMatchFn)({matchPatterns:o,defaultMatchWidth:"wide",parsePatterns:l,defaultParseWidth:"any",valueCallback:b=>b+1}),month:(0,n.buildMatchFn)({matchPatterns:c,defaultMatchWidth:"wide",parsePatterns:d,defaultParseWidth:"any"}),day:(0,n.buildMatchFn)({matchPatterns:h,defaultMatchWidth:"wide",parsePatterns:p,defaultParseWidth:"any"}),dayPeriod:(0,n.buildMatchFn)({matchPatterns:x,defaultMatchWidth:"any",parsePatterns:v,defaultParseWidth:"any"})},rg}var vD;function S5(){if(vD)return Qp;vD=1,Qp.enUS=void 0;var n=Jee(),e=Xee(),t=ete(),r=nte(),s=ite();return Qp.enUS={code:"en-US",formatDistance:n.formatDistance,formatLong:e.formatLong,formatRelative:t.formatRelative,localize:r.localize,match:s.match,options:{weekStartsOn:0,firstWeekContainsDate:1}},Qp}var bD;function Kf(){return bD||(bD=1,(function(n){Object.defineProperty(n,"defaultLocale",{enumerable:!0,get:function(){return e.enUS}});var e=S5()})(ww)),ww}var sg={},Cw={},wD;function N5(){if(wD)return Cw;wD=1,Cw.getDayOfYear=r;var n=ad(),e=s1(),t=Fe();function r(s){const a=(0,t.toDate)(s);return(0,n.differenceInCalendarDays)(a,(0,e.startOfYear)(a))+1}return Cw}var Tw={},_D;function i1(){if(_D)return Tw;_D=1,Tw.getISOWeek=s;var n=en(),e=Il(),t=zm(),r=Fe();function s(a){const o=(0,r.toDate)(a),l=+(0,e.startOfISOWeek)(o)-+(0,t.startOfISOWeekYear)(o);return Math.round(l/n.millisecondsInWeek)+1}return Tw}var kw={},Pw={},Mw={},jD;function Ny(){if(jD)return Mw;jD=1,Mw.getWeekYear=s;var n=pn(),e=Mo(),t=Fe(),r=Cs();function s(a,o){const l=(0,t.toDate)(a),c=l.getFullYear(),d=(0,r.getDefaultOptions)(),h=o?.firstWeekContainsDate??o?.locale?.options?.firstWeekContainsDate??d.firstWeekContainsDate??d.locale?.options?.firstWeekContainsDate??1,p=(0,n.constructFrom)(a,0);p.setFullYear(c+1,0,h),p.setHours(0,0,0,0);const x=(0,e.startOfWeek)(p,o),v=(0,n.constructFrom)(a,0);v.setFullYear(c,0,h),v.setHours(0,0,0,0);const b=(0,e.startOfWeek)(v,o);return l.getTime()>=x.getTime()?c+1:l.getTime()>=b.getTime()?c:c-1}return Mw}var SD;function a1(){if(SD)return Pw;SD=1,Pw.startOfWeekYear=s;var n=pn(),e=Ny(),t=Mo(),r=Cs();function s(a,o){const l=(0,r.getDefaultOptions)(),c=o?.firstWeekContainsDate??o?.locale?.options?.firstWeekContainsDate??l.firstWeekContainsDate??l.locale?.options?.firstWeekContainsDate??1,d=(0,e.getWeekYear)(a,o),h=(0,n.constructFrom)(a,0);return h.setFullYear(d,0,c),h.setHours(0,0,0,0),(0,t.startOfWeek)(h,o)}return Pw}var ND;function o1(){if(ND)return kw;ND=1,kw.getWeek=s;var n=en(),e=Mo(),t=a1(),r=Fe();function s(a,o){const l=(0,r.toDate)(a),c=+(0,e.startOfWeek)(l,o)-+(0,t.startOfWeekYear)(l,o);return Math.round(c/n.millisecondsInWeek)+1}return kw}var Ew={},CD;function Jf(){if(CD)return Ew;CD=1,Ew.addLeadingZeros=n;function n(e,t){const r=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return r+s}return Ew}var ig={},TD;function C5(){if(TD)return ig;TD=1,ig.lightFormatters=void 0;var n=Jf();return ig.lightFormatters={y(e,t){const r=e.getFullYear(),s=r>0?r:1-r;return(0,n.addLeadingZeros)(t==="yy"?s%100:s,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):(0,n.addLeadingZeros)(r+1,2)},d(e,t){return(0,n.addLeadingZeros)(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return(0,n.addLeadingZeros)(e.getHours()%12||12,t.length)},H(e,t){return(0,n.addLeadingZeros)(e.getHours(),t.length)},m(e,t){return(0,n.addLeadingZeros)(e.getMinutes(),t.length)},s(e,t){return(0,n.addLeadingZeros)(e.getSeconds(),t.length)},S(e,t){const r=t.length,s=e.getMilliseconds(),a=Math.trunc(s*Math.pow(10,r-3));return(0,n.addLeadingZeros)(a,t.length)}},ig}var kD;function ate(){if(kD)return sg;kD=1,sg.formatters=void 0;var n=N5(),e=i1(),t=Cu(),r=o1(),s=Ny(),a=Jf(),o=C5();const l={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"};sg.formatters={G:function(p,x,v){const b=p.getFullYear()>0?1:0;switch(x){case"G":case"GG":case"GGG":return v.era(b,{width:"abbreviated"});case"GGGGG":return v.era(b,{width:"narrow"});case"GGGG":default:return v.era(b,{width:"wide"})}},y:function(p,x,v){if(x==="yo"){const b=p.getFullYear(),_=b>0?b:1-b;return v.ordinalNumber(_,{unit:"year"})}return o.lightFormatters.y(p,x)},Y:function(p,x,v,b){const _=(0,s.getWeekYear)(p,b),j=_>0?_:1-_;if(x==="YY"){const C=j%100;return(0,a.addLeadingZeros)(C,2)}return x==="Yo"?v.ordinalNumber(j,{unit:"year"}):(0,a.addLeadingZeros)(j,x.length)},R:function(p,x){const v=(0,t.getISOWeekYear)(p);return(0,a.addLeadingZeros)(v,x.length)},u:function(p,x){const v=p.getFullYear();return(0,a.addLeadingZeros)(v,x.length)},Q:function(p,x,v){const b=Math.ceil((p.getMonth()+1)/3);switch(x){case"Q":return String(b);case"QQ":return(0,a.addLeadingZeros)(b,2);case"Qo":return v.ordinalNumber(b,{unit:"quarter"});case"QQQ":return v.quarter(b,{width:"abbreviated",context:"formatting"});case"QQQQQ":return v.quarter(b,{width:"narrow",context:"formatting"});case"QQQQ":default:return v.quarter(b,{width:"wide",context:"formatting"})}},q:function(p,x,v){const b=Math.ceil((p.getMonth()+1)/3);switch(x){case"q":return String(b);case"qq":return(0,a.addLeadingZeros)(b,2);case"qo":return v.ordinalNumber(b,{unit:"quarter"});case"qqq":return v.quarter(b,{width:"abbreviated",context:"standalone"});case"qqqqq":return v.quarter(b,{width:"narrow",context:"standalone"});case"qqqq":default:return v.quarter(b,{width:"wide",context:"standalone"})}},M:function(p,x,v){const b=p.getMonth();switch(x){case"M":case"MM":return o.lightFormatters.M(p,x);case"Mo":return v.ordinalNumber(b+1,{unit:"month"});case"MMM":return v.month(b,{width:"abbreviated",context:"formatting"});case"MMMMM":return v.month(b,{width:"narrow",context:"formatting"});case"MMMM":default:return v.month(b,{width:"wide",context:"formatting"})}},L:function(p,x,v){const b=p.getMonth();switch(x){case"L":return String(b+1);case"LL":return(0,a.addLeadingZeros)(b+1,2);case"Lo":return v.ordinalNumber(b+1,{unit:"month"});case"LLL":return v.month(b,{width:"abbreviated",context:"standalone"});case"LLLLL":return v.month(b,{width:"narrow",context:"standalone"});case"LLLL":default:return v.month(b,{width:"wide",context:"standalone"})}},w:function(p,x,v,b){const _=(0,r.getWeek)(p,b);return x==="wo"?v.ordinalNumber(_,{unit:"week"}):(0,a.addLeadingZeros)(_,x.length)},I:function(p,x,v){const b=(0,e.getISOWeek)(p);return x==="Io"?v.ordinalNumber(b,{unit:"week"}):(0,a.addLeadingZeros)(b,x.length)},d:function(p,x,v){return x==="do"?v.ordinalNumber(p.getDate(),{unit:"date"}):o.lightFormatters.d(p,x)},D:function(p,x,v){const b=(0,n.getDayOfYear)(p);return x==="Do"?v.ordinalNumber(b,{unit:"dayOfYear"}):(0,a.addLeadingZeros)(b,x.length)},E:function(p,x,v){const b=p.getDay();switch(x){case"E":case"EE":case"EEE":return v.day(b,{width:"abbreviated",context:"formatting"});case"EEEEE":return v.day(b,{width:"narrow",context:"formatting"});case"EEEEEE":return v.day(b,{width:"short",context:"formatting"});case"EEEE":default:return v.day(b,{width:"wide",context:"formatting"})}},e:function(p,x,v,b){const _=p.getDay(),j=(_-b.weekStartsOn+8)%7||7;switch(x){case"e":return String(j);case"ee":return(0,a.addLeadingZeros)(j,2);case"eo":return v.ordinalNumber(j,{unit:"day"});case"eee":return v.day(_,{width:"abbreviated",context:"formatting"});case"eeeee":return v.day(_,{width:"narrow",context:"formatting"});case"eeeeee":return v.day(_,{width:"short",context:"formatting"});case"eeee":default:return v.day(_,{width:"wide",context:"formatting"})}},c:function(p,x,v,b){const _=p.getDay(),j=(_-b.weekStartsOn+8)%7||7;switch(x){case"c":return String(j);case"cc":return(0,a.addLeadingZeros)(j,x.length);case"co":return v.ordinalNumber(j,{unit:"day"});case"ccc":return v.day(_,{width:"abbreviated",context:"standalone"});case"ccccc":return v.day(_,{width:"narrow",context:"standalone"});case"cccccc":return v.day(_,{width:"short",context:"standalone"});case"cccc":default:return v.day(_,{width:"wide",context:"standalone"})}},i:function(p,x,v){const b=p.getDay(),_=b===0?7:b;switch(x){case"i":return String(_);case"ii":return(0,a.addLeadingZeros)(_,x.length);case"io":return v.ordinalNumber(_,{unit:"day"});case"iii":return v.day(b,{width:"abbreviated",context:"formatting"});case"iiiii":return v.day(b,{width:"narrow",context:"formatting"});case"iiiiii":return v.day(b,{width:"short",context:"formatting"});case"iiii":default:return v.day(b,{width:"wide",context:"formatting"})}},a:function(p,x,v){const _=p.getHours()/12>=1?"pm":"am";switch(x){case"a":case"aa":return v.dayPeriod(_,{width:"abbreviated",context:"formatting"});case"aaa":return v.dayPeriod(_,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return v.dayPeriod(_,{width:"narrow",context:"formatting"});case"aaaa":default:return v.dayPeriod(_,{width:"wide",context:"formatting"})}},b:function(p,x,v){const b=p.getHours();let _;switch(b===12?_=l.noon:b===0?_=l.midnight:_=b/12>=1?"pm":"am",x){case"b":case"bb":return v.dayPeriod(_,{width:"abbreviated",context:"formatting"});case"bbb":return v.dayPeriod(_,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return v.dayPeriod(_,{width:"narrow",context:"formatting"});case"bbbb":default:return v.dayPeriod(_,{width:"wide",context:"formatting"})}},B:function(p,x,v){const b=p.getHours();let _;switch(b>=17?_=l.evening:b>=12?_=l.afternoon:b>=4?_=l.morning:_=l.night,x){case"B":case"BB":case"BBB":return v.dayPeriod(_,{width:"abbreviated",context:"formatting"});case"BBBBB":return v.dayPeriod(_,{width:"narrow",context:"formatting"});case"BBBB":default:return v.dayPeriod(_,{width:"wide",context:"formatting"})}},h:function(p,x,v){if(x==="ho"){let b=p.getHours()%12;return b===0&&(b=12),v.ordinalNumber(b,{unit:"hour"})}return o.lightFormatters.h(p,x)},H:function(p,x,v){return x==="Ho"?v.ordinalNumber(p.getHours(),{unit:"hour"}):o.lightFormatters.H(p,x)},K:function(p,x,v){const b=p.getHours()%12;return x==="Ko"?v.ordinalNumber(b,{unit:"hour"}):(0,a.addLeadingZeros)(b,x.length)},k:function(p,x,v){let b=p.getHours();return b===0&&(b=24),x==="ko"?v.ordinalNumber(b,{unit:"hour"}):(0,a.addLeadingZeros)(b,x.length)},m:function(p,x,v){return x==="mo"?v.ordinalNumber(p.getMinutes(),{unit:"minute"}):o.lightFormatters.m(p,x)},s:function(p,x,v){return x==="so"?v.ordinalNumber(p.getSeconds(),{unit:"second"}):o.lightFormatters.s(p,x)},S:function(p,x){return o.lightFormatters.S(p,x)},X:function(p,x,v){const b=p.getTimezoneOffset();if(b===0)return"Z";switch(x){case"X":return d(b);case"XXXX":case"XX":return h(b);case"XXXXX":case"XXX":default:return h(b,":")}},x:function(p,x,v){const b=p.getTimezoneOffset();switch(x){case"x":return d(b);case"xxxx":case"xx":return h(b);case"xxxxx":case"xxx":default:return h(b,":")}},O:function(p,x,v){const b=p.getTimezoneOffset();switch(x){case"O":case"OO":case"OOO":return"GMT"+c(b,":");case"OOOO":default:return"GMT"+h(b,":")}},z:function(p,x,v){const b=p.getTimezoneOffset();switch(x){case"z":case"zz":case"zzz":return"GMT"+c(b,":");case"zzzz":default:return"GMT"+h(b,":")}},t:function(p,x,v){const b=Math.trunc(p.getTime()/1e3);return(0,a.addLeadingZeros)(b,x.length)},T:function(p,x,v){const b=p.getTime();return(0,a.addLeadingZeros)(b,x.length)}};function c(p,x=""){const v=p>0?"-":"+",b=Math.abs(p),_=Math.trunc(b/60),j=b%60;return j===0?v+String(_):v+String(_)+x+(0,a.addLeadingZeros)(j,2)}function d(p,x){return p%60===0?(p>0?"-":"+")+(0,a.addLeadingZeros)(Math.abs(p)/60,2):h(p,x)}function h(p,x=""){const v=p>0?"-":"+",b=Math.abs(p),_=(0,a.addLeadingZeros)(Math.trunc(b/60),2),j=(0,a.addLeadingZeros)(b%60,2);return v+_+x+j}return sg}var ag={},PD;function T5(){if(PD)return ag;PD=1,ag.longFormatters=void 0;const n=(r,s)=>{switch(r){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},e=(r,s)=>{switch(r){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},t=(r,s)=>{const a=r.match(/(P+)(p+)?/)||[],o=a[1],l=a[2];if(!l)return n(r,s);let c;switch(o){case"P":c=s.dateTime({width:"short"});break;case"PP":c=s.dateTime({width:"medium"});break;case"PPP":c=s.dateTime({width:"long"});break;case"PPPP":default:c=s.dateTime({width:"full"});break}return c.replace("{{date}}",n(o,s)).replace("{{time}}",e(l,s))};return ag.longFormatters={p:e,P:t},ag}var Mh={},MD;function k5(){if(MD)return Mh;MD=1,Mh.isProtectedDayOfYearToken=r,Mh.isProtectedWeekYearToken=s,Mh.warnOrThrowProtectedError=a;const n=/^D+$/,e=/^Y+$/,t=["D","DD","YY","YYYY"];function r(l){return n.test(l)}function s(l){return e.test(l)}function a(l,c,d){const h=o(l,c,d);if(console.warn(h),t.includes(l))throw new RangeError(h)}function o(l,c,d){const h=l[0]==="Y"?"years":"days of the month";return`Use \`${l.toLowerCase()}\` instead of \`${l}\` (in \`${c}\`) for formatting ${h} to the input \`${d}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}return Mh}var ED;function P5(){return ED||(ED=1,(function(n){n.format=n.formatDate=v,Object.defineProperty(n,"formatters",{enumerable:!0,get:function(){return r.formatters}}),Object.defineProperty(n,"longFormatters",{enumerable:!0,get:function(){return s.longFormatters}});var e=Kf(),t=Cs(),r=ate(),s=T5(),a=k5(),o=od(),l=Fe();const c=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,d=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,h=/^'([^]*?)'?$/,p=/''/g,x=/[a-zA-Z]/;function v(_,j,C){const P=(0,t.getDefaultOptions)(),O=C?.locale??P.locale??e.defaultLocale,M=C?.firstWeekContainsDate??C?.locale?.options?.firstWeekContainsDate??P.firstWeekContainsDate??P.locale?.options?.firstWeekContainsDate??1,D=C?.weekStartsOn??C?.locale?.options?.weekStartsOn??P.weekStartsOn??P.locale?.options?.weekStartsOn??0,I=(0,l.toDate)(_);if(!(0,o.isValid)(I))throw new RangeError("Invalid time value");let F=j.match(d).map(U=>{const B=U[0];if(B==="p"||B==="P"){const W=s.longFormatters[B];return W(U,O.formatLong)}return U}).join("").match(c).map(U=>{if(U==="''")return{isToken:!1,value:"'"};const B=U[0];if(B==="'")return{isToken:!1,value:b(U)};if(r.formatters[B])return{isToken:!0,value:U};if(B.match(x))throw new RangeError("Format string contains an unescaped latin alphabet character `"+B+"`");return{isToken:!1,value:U}});O.localize.preprocessor&&(F=O.localize.preprocessor(I,F));const q={firstWeekContainsDate:M,weekStartsOn:D,locale:O};return F.map(U=>{if(!U.isToken)return U.value;const B=U.value;(!C?.useAdditionalWeekYearTokens&&(0,a.isProtectedWeekYearToken)(B)||!C?.useAdditionalDayOfYearTokens&&(0,a.isProtectedDayOfYearToken)(B))&&(0,a.warnOrThrowProtectedError)(B,j,String(_));const W=r.formatters[B[0]];return W(I,B,O.localize,q)}).join("")}function b(_){const j=_.match(h);return j?j[1].replace(p,"'"):_}})(bw)),bw}var Dw={},DD;function M5(){if(DD)return Dw;DD=1,Dw.formatDistance=c;var n=Zf(),e=en(),t=_y(),r=jy(),s=Fe(),a=Kf(),o=Cs(),l=id();function c(d,h,p){const x=(0,o.getDefaultOptions)(),v=p?.locale??x.locale??a.defaultLocale,b=2520,_=(0,n.compareAsc)(d,h);if(isNaN(_))throw new RangeError("Invalid time value");const j=Object.assign({},p,{addSuffix:p?.addSuffix,comparison:_});let C,P;_>0?(C=(0,s.toDate)(h),P=(0,s.toDate)(d)):(C=(0,s.toDate)(d),P=(0,s.toDate)(h));const O=(0,r.differenceInSeconds)(P,C),M=((0,l.getTimezoneOffsetInMilliseconds)(P)-(0,l.getTimezoneOffsetInMilliseconds)(C))/1e3,D=Math.round((O-M)/60);let I;if(D<2)return p?.includeSeconds?O<5?v.formatDistance("lessThanXSeconds",5,j):O<10?v.formatDistance("lessThanXSeconds",10,j):O<20?v.formatDistance("lessThanXSeconds",20,j):O<40?v.formatDistance("halfAMinute",0,j):O<60?v.formatDistance("lessThanXMinutes",1,j):v.formatDistance("xMinutes",1,j):D===0?v.formatDistance("lessThanXMinutes",1,j):v.formatDistance("xMinutes",D,j);if(D<45)return v.formatDistance("xMinutes",D,j);if(D<90)return v.formatDistance("aboutXHours",1,j);if(D<e.minutesInDay){const F=Math.round(D/60);return v.formatDistance("aboutXHours",F,j)}else{if(D<b)return v.formatDistance("xDays",1,j);if(D<e.minutesInMonth){const F=Math.round(D/e.minutesInDay);return v.formatDistance("xDays",F,j)}else if(D<e.minutesInMonth*2)return I=Math.round(D/e.minutesInMonth),v.formatDistance("aboutXMonths",I,j)}if(I=(0,t.differenceInMonths)(P,C),I<12){const F=Math.round(D/e.minutesInMonth);return v.formatDistance("xMonths",F,j)}else{const F=I%12,q=Math.trunc(I/12);return F<3?v.formatDistance("aboutXYears",q,j):F<9?v.formatDistance("overXYears",q,j):v.formatDistance("almostXYears",q+1,j)}}return Dw}var Ow={},OD;function E5(){if(OD)return Ow;OD=1,Ow.formatDistanceStrict=l;var n=Kf(),e=Cs(),t=ld(),r=id(),s=Zf(),a=en(),o=Fe();function l(c,d,h){const p=(0,e.getDefaultOptions)(),x=h?.locale??p.locale??n.defaultLocale,v=(0,s.compareAsc)(c,d);if(isNaN(v))throw new RangeError("Invalid time value");const b=Object.assign({},h,{addSuffix:h?.addSuffix,comparison:v});let _,j;v>0?(_=(0,o.toDate)(d),j=(0,o.toDate)(c)):(_=(0,o.toDate)(c),j=(0,o.toDate)(d));const C=(0,t.getRoundingMethod)(h?.roundingMethod??"round"),P=j.getTime()-_.getTime(),O=P/a.millisecondsInMinute,M=(0,r.getTimezoneOffsetInMilliseconds)(j)-(0,r.getTimezoneOffsetInMilliseconds)(_),D=(P-M)/a.millisecondsInMinute,I=h?.unit;let F;if(I?F=I:O<1?F="second":O<60?F="minute":O<a.minutesInDay?F="hour":D<a.minutesInMonth?F="day":D<a.minutesInYear?F="month":F="year",F==="second"){const q=C(P/1e3);return x.formatDistance("xSeconds",q,b)}else if(F==="minute"){const q=C(O);return x.formatDistance("xMinutes",q,b)}else if(F==="hour"){const q=C(O/60);return x.formatDistance("xHours",q,b)}else if(F==="day"){const q=C(D/a.minutesInDay);return x.formatDistance("xDays",q,b)}else if(F==="month"){const q=C(D/a.minutesInMonth);return q===12&&I!=="month"?x.formatDistance("xYears",1,b):x.formatDistance("xMonths",q,b)}else{const q=C(D/a.minutesInYear);return x.formatDistance("xYears",q,b)}}return Ow}var Iw={},ID;function ote(){if(ID)return Iw;ID=1,Iw.formatDistanceToNow=t;var n=Xs(),e=M5();function t(r,s){return(0,e.formatDistance)(r,(0,n.constructNow)(r),s)}return Iw}var Aw={},AD;function lte(){if(AD)return Aw;AD=1,Aw.formatDistanceToNowStrict=t;var n=E5(),e=Xs();function t(r,s){return(0,n.formatDistanceStrict)(r,(0,e.constructNow)(r),s)}return Aw}var Rw={},RD;function cte(){if(RD)return Rw;RD=1,Rw.formatDuration=r;var n=Kf(),e=Cs();const t=["years","months","weeks","days","hours","minutes","seconds"];function r(s,a){const o=(0,e.getDefaultOptions)(),l=a?.locale??o.locale??n.defaultLocale,c=a?.format??t,d=a?.zero??!1,h=a?.delimiter??" ";return l.formatDistance?c.reduce((x,v)=>{const b=`x${v.replace(/(^.)/,j=>j.toUpperCase())}`,_=s[v];return _!==void 0&&(d||s[v])?x.concat(l.formatDistance(b,_)):x},[]).join(h):""}return Rw}var Lw={},LD;function dte(){if(LD)return Lw;LD=1,Lw.formatISO=t;var n=Fe(),e=Jf();function t(r,s){const a=(0,n.toDate)(r);if(isNaN(a.getTime()))throw new RangeError("Invalid time value");const o=s?.format??"extended",l=s?.representation??"complete";let c="",d="";const h=o==="extended"?"-":"",p=o==="extended"?":":"";if(l!=="time"){const x=(0,e.addLeadingZeros)(a.getDate(),2),v=(0,e.addLeadingZeros)(a.getMonth()+1,2);c=`${(0,e.addLeadingZeros)(a.getFullYear(),4)}${h}${v}${h}${x}`}if(l!=="date"){const x=a.getTimezoneOffset();if(x!==0){const P=Math.abs(x),O=(0,e.addLeadingZeros)(Math.trunc(P/60),2),M=(0,e.addLeadingZeros)(P%60,2);d=`${x<0?"+":"-"}${O}:${M}`}else d="Z";const v=(0,e.addLeadingZeros)(a.getHours(),2),b=(0,e.addLeadingZeros)(a.getMinutes(),2),_=(0,e.addLeadingZeros)(a.getSeconds(),2),j=c===""?"":"T",C=[v,b,_].join(p);c=`${c}${j}${C}${d}`}return c}return Lw}var Fw={},FD;function ute(){if(FD)return Fw;FD=1,Fw.formatISO9075=r;var n=od(),e=Fe(),t=Jf();function r(s,a){const o=(0,e.toDate)(s);if(!(0,n.isValid)(o))throw new RangeError("Invalid time value");const l=a?.format??"extended",c=a?.representation??"complete";let d="";const h=l==="extended"?"-":"",p=l==="extended"?":":"";if(c!=="time"){const x=(0,t.addLeadingZeros)(o.getDate(),2),v=(0,t.addLeadingZeros)(o.getMonth()+1,2);d=`${(0,t.addLeadingZeros)(o.getFullYear(),4)}${h}${v}${h}${x}`}if(c!=="date"){const x=(0,t.addLeadingZeros)(o.getHours(),2),v=(0,t.addLeadingZeros)(o.getMinutes(),2),b=(0,t.addLeadingZeros)(o.getSeconds(),2);d=`${d}${d===""?"":" "}${x}${p}${v}${p}${b}`}return d}return Fw}var qw={},qD;function fte(){if(qD)return qw;qD=1,qw.formatISODuration=n;function n(e){const{years:t=0,months:r=0,days:s=0,hours:a=0,minutes:o=0,seconds:l=0}=e;return`P${t}Y${r}M${s}DT${a}H${o}M${l}S`}return qw}var zw={},zD;function hte(){if(zD)return zw;zD=1,zw.formatRFC3339=r;var n=od(),e=Fe(),t=Jf();function r(s,a){const o=(0,e.toDate)(s);if(!(0,n.isValid)(o))throw new RangeError("Invalid time value");const l=a?.fractionDigits??0,c=(0,t.addLeadingZeros)(o.getDate(),2),d=(0,t.addLeadingZeros)(o.getMonth()+1,2),h=o.getFullYear(),p=(0,t.addLeadingZeros)(o.getHours(),2),x=(0,t.addLeadingZeros)(o.getMinutes(),2),v=(0,t.addLeadingZeros)(o.getSeconds(),2);let b="";if(l>0){const C=o.getMilliseconds(),P=Math.trunc(C*Math.pow(10,l-3));b="."+(0,t.addLeadingZeros)(P,l)}let _="";const j=o.getTimezoneOffset();if(j!==0){const C=Math.abs(j),P=(0,t.addLeadingZeros)(Math.trunc(C/60),2),O=(0,t.addLeadingZeros)(C%60,2);_=`${j<0?"+":"-"}${P}:${O}`}else _="Z";return`${h}-${d}-${c}T${p}:${x}:${v}${b}${_}`}return zw}var Uw={},UD;function mte(){if(UD)return Uw;UD=1,Uw.formatRFC7231=a;var n=od(),e=Fe(),t=Jf();const r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function a(o){const l=(0,e.toDate)(o);if(!(0,n.isValid)(l))throw new RangeError("Invalid time value");const c=r[l.getUTCDay()],d=(0,t.addLeadingZeros)(l.getUTCDate(),2),h=s[l.getUTCMonth()],p=l.getUTCFullYear(),x=(0,t.addLeadingZeros)(l.getUTCHours(),2),v=(0,t.addLeadingZeros)(l.getUTCMinutes(),2),b=(0,t.addLeadingZeros)(l.getUTCSeconds(),2);return`${c}, ${d} ${h} ${p} ${x}:${v}:${b} GMT`}return Uw}var Bw={},BD;function pte(){if(BD)return Bw;BD=1,Bw.formatRelative=a;var n=ad(),e=P5(),t=Fe(),r=Kf(),s=Cs();function a(o,l,c){const d=(0,t.toDate)(o),h=(0,t.toDate)(l),p=(0,s.getDefaultOptions)(),x=c?.locale??p.locale??r.defaultLocale,v=c?.weekStartsOn??c?.locale?.options?.weekStartsOn??p.weekStartsOn??p.locale?.options?.weekStartsOn??0,b=(0,n.differenceInCalendarDays)(d,h);if(isNaN(b))throw new RangeError("Invalid time value");let _;b<-6?_="other":b<-1?_="lastWeek":b<0?_="yesterday":b<1?_="today":b<2?_="tomorrow":b<7?_="nextWeek":_="other";const j=x.formatRelative(_,d,h,{locale:x,weekStartsOn:v});return(0,e.format)(d,j,{locale:x,weekStartsOn:v})}return Bw}var Vw={},VD;function gte(){if(VD)return Vw;VD=1,Vw.fromUnixTime=e;var n=Fe();function e(t){return(0,n.toDate)(t*1e3)}return Vw}var Ww={},WD;function D5(){if(WD)return Ww;WD=1,Ww.getDate=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDate()}return Ww}var $w={},$D;function Cy(){if($D)return $w;$D=1,$w.getDay=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()}return $w}var Hw={},HD;function O5(){if(HD)return Hw;HD=1,Hw.getDaysInMonth=t;var n=Fe(),e=pn();function t(r){const s=(0,n.toDate)(r),a=s.getFullYear(),o=s.getMonth(),l=(0,e.constructFrom)(r,0);return l.setFullYear(a,o+1,0),l.setHours(0,0,0,0),l.getDate()}return Hw}var Yw={},Gw={},YD;function I5(){if(YD)return Gw;YD=1,Gw.isLeapYear=e;var n=Fe();function e(t){const s=(0,n.toDate)(t).getFullYear();return s%400===0||s%4===0&&s%100!==0}return Gw}var GD;function xte(){if(GD)return Yw;GD=1,Yw.getDaysInYear=t;var n=I5(),e=Fe();function t(r){const s=(0,e.toDate)(r);return String(new Date(s))==="Invalid Date"?NaN:(0,n.isLeapYear)(s)?366:365}return Yw}var Zw={},ZD;function yte(){if(ZD)return Zw;ZD=1,Zw.getDecade=e;var n=Fe();function e(t){const s=(0,n.toDate)(t).getFullYear();return Math.floor(s/10)*10}return Zw}var Kw={},KD;function A5(){if(KD)return Kw;KD=1,Kw.getDefaultOptions=e;var n=Cs();function e(){return Object.assign({},(0,n.getDefaultOptions)())}return Kw}var Jw={},JD;function vte(){if(JD)return Jw;JD=1,Jw.getHours=e;var n=Fe();function e(t){return(0,n.toDate)(t).getHours()}return Jw}var Qw={},QD;function R5(){if(QD)return Qw;QD=1,Qw.getISODay=e;var n=Fe();function e(t){let s=(0,n.toDate)(t).getDay();return s===0&&(s=7),s}return Qw}var Xw={},XD;function bte(){if(XD)return Xw;XD=1,Xw.getISOWeeksInYear=r;var n=by(),e=en(),t=zm();function r(s){const a=(0,t.startOfISOWeekYear)(s),l=+(0,t.startOfISOWeekYear)((0,n.addWeeks)(a,60))-+a;return Math.round(l/e.millisecondsInWeek)}return Xw}var e_={},eO;function wte(){if(eO)return e_;eO=1,e_.getMilliseconds=e;var n=Fe();function e(t){return(0,n.toDate)(t).getMilliseconds()}return e_}var t_={},tO;function _te(){if(tO)return t_;tO=1,t_.getMinutes=e;var n=Fe();function e(t){return(0,n.toDate)(t).getMinutes()}return t_}var n_={},nO;function jte(){if(nO)return n_;nO=1,n_.getMonth=e;var n=Fe();function e(t){return(0,n.toDate)(t).getMonth()}return n_}var r_={},rO;function Ste(){if(rO)return r_;rO=1,r_.getOverlappingDaysInIntervals=r;var n=id(),e=en(),t=Fe();function r(s,a){const[o,l]=[+(0,t.toDate)(s.start),+(0,t.toDate)(s.end)].sort((_,j)=>_-j),[c,d]=[+(0,t.toDate)(a.start),+(0,t.toDate)(a.end)].sort((_,j)=>_-j);if(!(o<d&&c<l))return 0;const p=c<o?o:c,x=p-(0,n.getTimezoneOffsetInMilliseconds)(p),v=d>l?l:d,b=v-(0,n.getTimezoneOffsetInMilliseconds)(v);return Math.ceil((b-x)/e.millisecondsInDay)}return r_}var s_={},sO;function Nte(){if(sO)return s_;sO=1,s_.getSeconds=e;var n=Fe();function e(t){return(0,n.toDate)(t).getSeconds()}return s_}var i_={},iO;function Cte(){if(iO)return i_;iO=1,i_.getTime=e;var n=Fe();function e(t){return(0,n.toDate)(t).getTime()}return i_}var a_={},aO;function Tte(){if(aO)return a_;aO=1,a_.getUnixTime=e;var n=Fe();function e(t){return Math.trunc(+(0,n.toDate)(t)/1e3)}return a_}var o_={},oO;function kte(){if(oO)return o_;oO=1,o_.getWeekOfMonth=s;var n=D5(),e=Cy(),t=Sy(),r=Cs();function s(a,o){const l=(0,r.getDefaultOptions)(),c=o?.weekStartsOn??o?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,d=(0,n.getDate)(a);if(isNaN(d))return NaN;const h=(0,e.getDay)((0,t.startOfMonth)(a));let p=c-h;p<=0&&(p+=7);const x=d-p;return Math.ceil(x/7)+1}return o_}var l_={},c_={},lO;function L5(){if(lO)return c_;lO=1,c_.lastDayOfMonth=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(0,0,0,0),r}return c_}var cO;function Pte(){if(cO)return l_;cO=1,l_.getWeeksInMonth=r;var n=GC(),e=L5(),t=Sy();function r(s,a){return(0,n.differenceInCalendarWeeks)((0,e.lastDayOfMonth)(s),(0,t.startOfMonth)(s),a)+1}return l_}var d_={},dO;function Mte(){if(dO)return d_;dO=1,d_.getYear=e;var n=Fe();function e(t){return(0,n.toDate)(t).getFullYear()}return d_}var u_={},uO;function Ete(){if(uO)return u_;uO=1,u_.hoursToMilliseconds=e;var n=en();function e(t){return Math.trunc(t*n.millisecondsInHour)}return u_}var f_={},fO;function Dte(){if(fO)return f_;fO=1,f_.hoursToMinutes=e;var n=en();function e(t){return Math.trunc(t*n.minutesInHour)}return f_}var h_={},hO;function Ote(){if(hO)return h_;hO=1,h_.hoursToSeconds=e;var n=en();function e(t){return Math.trunc(t*n.secondsInHour)}return h_}var m_={},mO;function Ite(){if(mO)return m_;mO=1,m_.interval=e;var n=Fe();function e(t,r,s){const a=(0,n.toDate)(t);if(isNaN(+a))throw new TypeError("Start date is invalid");const o=(0,n.toDate)(r);if(isNaN(+o))throw new TypeError("End date is invalid");if(s?.assertPositive&&+a>+o)throw new TypeError("End date must be after start date");return{start:a,end:o}}return m_}var p_={},pO;function Ate(){if(pO)return p_;pO=1,p_.intervalToDuration=c;var n=s5(),e=KC(),t=JC(),r=QC(),s=_y(),a=jy(),o=b5(),l=Fe();function c(d){const h=(0,l.toDate)(d.start),p=(0,l.toDate)(d.end),x={},v=(0,o.differenceInYears)(p,h);v&&(x.years=v);const b=(0,n.add)(h,{years:x.years}),_=(0,s.differenceInMonths)(p,b);_&&(x.months=_);const j=(0,n.add)(b,{months:x.months}),C=(0,e.differenceInDays)(p,j);C&&(x.days=C);const P=(0,n.add)(j,{days:x.days}),O=(0,t.differenceInHours)(p,P);O&&(x.hours=O);const M=(0,n.add)(P,{hours:x.hours}),D=(0,r.differenceInMinutes)(p,M);D&&(x.minutes=D);const I=(0,n.add)(M,{minutes:x.minutes}),F=(0,a.differenceInSeconds)(p,I);return F&&(x.seconds=F),x}return p_}var g_={},gO;function Rte(){if(gO)return g_;gO=1,g_.intlFormat=e;var n=Fe();function e(r,s,a){let o;return t(s)?o=s:a=s,new Intl.DateTimeFormat(a?.locale,o).format((0,n.toDate)(r))}function t(r){return r!==void 0&&!("locale"in r)}return g_}var x_={},xO;function Lte(){if(xO)return x_;xO=1,x_.intlFormatDistance=h;var n=en(),e=ad(),t=YC(),r=x5(),s=GC(),a=ZC(),o=JC(),l=QC(),c=jy(),d=Fe();function h(p,x,v){let b=0,_;const j=(0,d.toDate)(p),C=(0,d.toDate)(x);if(v?.unit)_=v?.unit,_==="second"?b=(0,c.differenceInSeconds)(j,C):_==="minute"?b=(0,l.differenceInMinutes)(j,C):_==="hour"?b=(0,o.differenceInHours)(j,C):_==="day"?b=(0,e.differenceInCalendarDays)(j,C):_==="week"?b=(0,s.differenceInCalendarWeeks)(j,C):_==="month"?b=(0,t.differenceInCalendarMonths)(j,C):_==="quarter"?b=(0,r.differenceInCalendarQuarters)(j,C):_==="year"&&(b=(0,a.differenceInCalendarYears)(j,C));else{const O=(0,c.differenceInSeconds)(j,C);Math.abs(O)<n.secondsInMinute?(b=(0,c.differenceInSeconds)(j,C),_="second"):Math.abs(O)<n.secondsInHour?(b=(0,l.differenceInMinutes)(j,C),_="minute"):Math.abs(O)<n.secondsInDay&&Math.abs((0,e.differenceInCalendarDays)(j,C))<1?(b=(0,o.differenceInHours)(j,C),_="hour"):Math.abs(O)<n.secondsInWeek&&(b=(0,e.differenceInCalendarDays)(j,C))&&Math.abs(b)<7?_="day":Math.abs(O)<n.secondsInMonth?(b=(0,s.differenceInCalendarWeeks)(j,C),_="week"):Math.abs(O)<n.secondsInQuarter?(b=(0,t.differenceInCalendarMonths)(j,C),_="month"):Math.abs(O)<n.secondsInYear&&(0,r.differenceInCalendarQuarters)(j,C)<4?(b=(0,r.differenceInCalendarQuarters)(j,C),_="quarter"):(b=(0,a.differenceInCalendarYears)(j,C),_="year")}return new Intl.RelativeTimeFormat(v?.locale,{localeMatcher:v?.localeMatcher,numeric:v?.numeric||"auto",style:v?.style}).format(b,_)}return x_}var y_={},yO;function Fte(){if(yO)return y_;yO=1,y_.isAfter=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getTime()>a.getTime()}return y_}var v_={},vO;function qte(){if(vO)return v_;vO=1,v_.isBefore=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return+s<+a}return v_}var b_={},bO;function zte(){if(bO)return b_;bO=1,b_.isEqual=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return+s==+a}return b_}var w_={},wO;function Ute(){if(wO)return w_;wO=1,w_.isExists=n;function n(e,t,r){const s=new Date(e,t,r);return s.getFullYear()===e&&s.getMonth()===t&&s.getDate()===r}return w_}var __={},_O;function Bte(){if(_O)return __;_O=1,__.isFirstDayOfMonth=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDate()===1}return __}var j_={},jO;function Vte(){if(jO)return j_;jO=1,j_.isFriday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===5}return j_}var S_={},SO;function Wte(){if(SO)return S_;SO=1,S_.isFuture=e;var n=Fe();function e(t){return+(0,n.toDate)(t)>Date.now()}return S_}var N_={},C_={},og={},lg={},cg={},kc={},T_={},NO;function F5(){if(NO)return T_;NO=1,T_.transpose=e;var n=pn();function e(t,r){const s=r instanceof Date?(0,n.constructFrom)(r,0):new r(0);return s.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),s.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),s}return T_}var CO;function q5(){if(CO)return kc;CO=1,kc.ValueSetter=kc.Setter=kc.DateToSystemTimezoneSetter=void 0;var n=F5(),e=pn();const t=10;let r=class{subPriority=0;validate(l,c){return!0}};kc.Setter=r;class s extends r{constructor(l,c,d,h,p){super(),this.value=l,this.validateValue=c,this.setValue=d,this.priority=h,p&&(this.subPriority=p)}validate(l,c){return this.validateValue(l,this.value,c)}set(l,c,d){return this.setValue(l,c,this.value,d)}}kc.ValueSetter=s;class a extends r{priority=t;subPriority=-1;set(l,c){return c.timestampIsSet?l:(0,e.constructFrom)(l,(0,n.transpose)(l,Date))}}return kc.DateToSystemTimezoneSetter=a,kc}var TO;function yn(){if(TO)return cg;TO=1,cg.Parser=void 0;var n=q5();let e=class{run(r,s,a,o){const l=this.parse(r,s,a,o);return l?{setter:new n.ValueSetter(l.value,this.validate,this.set,this.priority,this.subPriority),rest:l.rest}:null}validate(r,s,a){return!0}};return cg.Parser=e,cg}var kO;function $te(){if(kO)return lg;kO=1,lg.EraParser=void 0;var n=yn();let e=class extends n.Parser{priority=140;parse(r,s,a){switch(s){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,s,a){return s.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}incompatibleTokens=["R","u","t","T"]};return lg.EraParser=e,lg}var dg={},_a={},nf={},PO;function Ts(){return PO||(PO=1,nf.timezonePatterns=nf.numericPatterns=void 0,nf.numericPatterns={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},nf.timezonePatterns={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/}),nf}var MO;function Cn(){if(MO)return _a;MO=1,_a.dayPeriodEnumToHours=c,_a.isLeapYearIndex=h,_a.mapValue=t,_a.normalizeTwoDigitYear=d,_a.parseAnyDigitsSigned=a,_a.parseNDigits=o,_a.parseNDigitsSigned=l,_a.parseNumericPattern=r,_a.parseTimezonePattern=s;var n=en(),e=Ts();function t(p,x){return p&&{value:x(p.value),rest:p.rest}}function r(p,x){const v=x.match(p);return v?{value:parseInt(v[0],10),rest:x.slice(v[0].length)}:null}function s(p,x){const v=x.match(p);if(!v)return null;if(v[0]==="Z")return{value:0,rest:x.slice(1)};const b=v[1]==="+"?1:-1,_=v[2]?parseInt(v[2],10):0,j=v[3]?parseInt(v[3],10):0,C=v[5]?parseInt(v[5],10):0;return{value:b*(_*n.millisecondsInHour+j*n.millisecondsInMinute+C*n.millisecondsInSecond),rest:x.slice(v[0].length)}}function a(p){return r(e.numericPatterns.anyDigitsSigned,p)}function o(p,x){switch(p){case 1:return r(e.numericPatterns.singleDigit,x);case 2:return r(e.numericPatterns.twoDigits,x);case 3:return r(e.numericPatterns.threeDigits,x);case 4:return r(e.numericPatterns.fourDigits,x);default:return r(new RegExp("^\\d{1,"+p+"}"),x)}}function l(p,x){switch(p){case 1:return r(e.numericPatterns.singleDigitSigned,x);case 2:return r(e.numericPatterns.twoDigitsSigned,x);case 3:return r(e.numericPatterns.threeDigitsSigned,x);case 4:return r(e.numericPatterns.fourDigitsSigned,x);default:return r(new RegExp("^-?\\d{1,"+p+"}"),x)}}function c(p){switch(p){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function d(p,x){const v=x>0,b=v?x:1-x;let _;if(b<=50)_=p||100;else{const j=b+50,C=Math.trunc(j/100)*100,P=p>=j%100;_=p+C-(P?100:0)}return v?_:1-_}function h(p){return p%400===0||p%4===0&&p%100!==0}return _a}var EO;function Hte(){if(EO)return dg;EO=1,dg.YearParser=void 0;var n=yn(),e=Cn();let t=class extends n.Parser{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(s,a,o){const l=c=>({year:c,isTwoDigitYear:a==="yy"});switch(a){case"y":return(0,e.mapValue)((0,e.parseNDigits)(4,s),l);case"yo":return(0,e.mapValue)(o.ordinalNumber(s,{unit:"year"}),l);default:return(0,e.mapValue)((0,e.parseNDigits)(a.length,s),l)}}validate(s,a){return a.isTwoDigitYear||a.year>0}set(s,a,o){const l=s.getFullYear();if(o.isTwoDigitYear){const d=(0,e.normalizeTwoDigitYear)(o.year,l);return s.setFullYear(d,0,1),s.setHours(0,0,0,0),s}const c=!("era"in a)||a.era===1?o.year:1-o.year;return s.setFullYear(c,0,1),s.setHours(0,0,0,0),s}};return dg.YearParser=t,dg}var ug={},DO;function Yte(){if(DO)return ug;DO=1,ug.LocalWeekYearParser=void 0;var n=Ny(),e=Mo(),t=yn(),r=Cn();let s=class extends t.Parser{priority=130;parse(o,l,c){const d=h=>({year:h,isTwoDigitYear:l==="YY"});switch(l){case"Y":return(0,r.mapValue)((0,r.parseNDigits)(4,o),d);case"Yo":return(0,r.mapValue)(c.ordinalNumber(o,{unit:"year"}),d);default:return(0,r.mapValue)((0,r.parseNDigits)(l.length,o),d)}}validate(o,l){return l.isTwoDigitYear||l.year>0}set(o,l,c,d){const h=(0,n.getWeekYear)(o,d);if(c.isTwoDigitYear){const x=(0,r.normalizeTwoDigitYear)(c.year,h);return o.setFullYear(x,0,d.firstWeekContainsDate),o.setHours(0,0,0,0),(0,e.startOfWeek)(o,d)}const p=!("era"in l)||l.era===1?c.year:1-c.year;return o.setFullYear(p,0,d.firstWeekContainsDate),o.setHours(0,0,0,0),(0,e.startOfWeek)(o,d)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]};return ug.LocalWeekYearParser=s,ug}var fg={},OO;function Gte(){if(OO)return fg;OO=1,fg.ISOWeekYearParser=void 0;var n=Il(),e=pn(),t=yn(),r=Cn();let s=class extends t.Parser{priority=130;parse(o,l){return l==="R"?(0,r.parseNDigitsSigned)(4,o):(0,r.parseNDigitsSigned)(l.length,o)}set(o,l,c){const d=(0,e.constructFrom)(o,0);return d.setFullYear(c,0,4),d.setHours(0,0,0,0),(0,n.startOfISOWeek)(d)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]};return fg.ISOWeekYearParser=s,fg}var hg={},IO;function Zte(){if(IO)return hg;IO=1,hg.ExtendedYearParser=void 0;var n=yn(),e=Cn();let t=class extends n.Parser{priority=130;parse(s,a){return a==="u"?(0,e.parseNDigitsSigned)(4,s):(0,e.parseNDigitsSigned)(a.length,s)}set(s,a,o){return s.setFullYear(o,0,1),s.setHours(0,0,0,0),s}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]};return hg.ExtendedYearParser=t,hg}var mg={},AO;function Kte(){if(AO)return mg;AO=1,mg.QuarterParser=void 0;var n=yn(),e=Cn();let t=class extends n.Parser{priority=120;parse(s,a,o){switch(a){case"Q":case"QQ":return(0,e.parseNDigits)(a.length,s);case"Qo":return o.ordinalNumber(s,{unit:"quarter"});case"QQQ":return o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(s,{width:"wide",context:"formatting"})||o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"})}}validate(s,a){return a>=1&&a<=4}set(s,a,o){return s.setMonth((o-1)*3,1),s.setHours(0,0,0,0),s}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]};return mg.QuarterParser=t,mg}var pg={},RO;function Jte(){if(RO)return pg;RO=1,pg.StandAloneQuarterParser=void 0;var n=yn(),e=Cn();let t=class extends n.Parser{priority=120;parse(s,a,o){switch(a){case"q":case"qq":return(0,e.parseNDigits)(a.length,s);case"qo":return o.ordinalNumber(s,{unit:"quarter"});case"qqq":return o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(s,{width:"wide",context:"standalone"})||o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"})}}validate(s,a){return a>=1&&a<=4}set(s,a,o){return s.setMonth((o-1)*3,1),s.setHours(0,0,0,0),s}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]};return pg.StandAloneQuarterParser=t,pg}var gg={},LO;function Qte(){if(LO)return gg;LO=1,gg.MonthParser=void 0;var n=Ts(),e=yn(),t=Cn();let r=class extends e.Parser{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(a,o,l){const c=d=>d-1;switch(o){case"M":return(0,t.mapValue)((0,t.parseNumericPattern)(n.numericPatterns.month,a),c);case"MM":return(0,t.mapValue)((0,t.parseNDigits)(2,a),c);case"Mo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"month"}),c);case"MMM":return l.month(a,{width:"abbreviated",context:"formatting"})||l.month(a,{width:"narrow",context:"formatting"});case"MMMMM":return l.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return l.month(a,{width:"wide",context:"formatting"})||l.month(a,{width:"abbreviated",context:"formatting"})||l.month(a,{width:"narrow",context:"formatting"})}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.setMonth(l,1),a.setHours(0,0,0,0),a}};return gg.MonthParser=r,gg}var xg={},FO;function Xte(){if(FO)return xg;FO=1,xg.StandAloneMonthParser=void 0;var n=Ts(),e=yn(),t=Cn();let r=class extends e.Parser{priority=110;parse(a,o,l){const c=d=>d-1;switch(o){case"L":return(0,t.mapValue)((0,t.parseNumericPattern)(n.numericPatterns.month,a),c);case"LL":return(0,t.mapValue)((0,t.parseNDigits)(2,a),c);case"Lo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"month"}),c);case"LLL":return l.month(a,{width:"abbreviated",context:"standalone"})||l.month(a,{width:"narrow",context:"standalone"});case"LLLLL":return l.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return l.month(a,{width:"wide",context:"standalone"})||l.month(a,{width:"abbreviated",context:"standalone"})||l.month(a,{width:"narrow",context:"standalone"})}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.setMonth(l,1),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};return xg.StandAloneMonthParser=r,xg}var yg={},k_={},qO;function z5(){if(qO)return k_;qO=1,k_.setWeek=t;var n=o1(),e=Fe();function t(r,s,a){const o=(0,e.toDate)(r),l=(0,n.getWeek)(o,a)-s;return o.setDate(o.getDate()-l*7),o}return k_}var zO;function ene(){if(zO)return yg;zO=1,yg.LocalWeekParser=void 0;var n=z5(),e=Mo(),t=Ts(),r=yn(),s=Cn();let a=class extends r.Parser{priority=100;parse(l,c,d){switch(c){case"w":return(0,s.parseNumericPattern)(t.numericPatterns.week,l);case"wo":return d.ordinalNumber(l,{unit:"week"});default:return(0,s.parseNDigits)(c.length,l)}}validate(l,c){return c>=1&&c<=53}set(l,c,d,h){return(0,e.startOfWeek)((0,n.setWeek)(l,d,h),h)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};return yg.LocalWeekParser=a,yg}var vg={},P_={},UO;function U5(){if(UO)return P_;UO=1,P_.setISOWeek=t;var n=i1(),e=Fe();function t(r,s){const a=(0,e.toDate)(r),o=(0,n.getISOWeek)(a)-s;return a.setDate(a.getDate()-o*7),a}return P_}var BO;function tne(){if(BO)return vg;BO=1,vg.ISOWeekParser=void 0;var n=U5(),e=Il(),t=Ts(),r=yn(),s=Cn();let a=class extends r.Parser{priority=100;parse(l,c,d){switch(c){case"I":return(0,s.parseNumericPattern)(t.numericPatterns.week,l);case"Io":return d.ordinalNumber(l,{unit:"week"});default:return(0,s.parseNDigits)(c.length,l)}}validate(l,c){return c>=1&&c<=53}set(l,c,d){return(0,e.startOfISOWeek)((0,n.setISOWeek)(l,d))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};return vg.ISOWeekParser=a,vg}var bg={},VO;function nne(){if(VO)return bg;VO=1,bg.DateParser=void 0;var n=Ts(),e=yn(),t=Cn();const r=[31,28,31,30,31,30,31,31,30,31,30,31],s=[31,29,31,30,31,30,31,31,30,31,30,31];let a=class extends e.Parser{priority=90;subPriority=1;parse(l,c,d){switch(c){case"d":return(0,t.parseNumericPattern)(n.numericPatterns.date,l);case"do":return d.ordinalNumber(l,{unit:"date"});default:return(0,t.parseNDigits)(c.length,l)}}validate(l,c){const d=l.getFullYear(),h=(0,t.isLeapYearIndex)(d),p=l.getMonth();return h?c>=1&&c<=s[p]:c>=1&&c<=r[p]}set(l,c,d){return l.setDate(d),l.setHours(0,0,0,0),l}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]};return bg.DateParser=a,bg}var wg={},WO;function rne(){if(WO)return wg;WO=1,wg.DayOfYearParser=void 0;var n=Ts(),e=yn(),t=Cn();let r=class extends e.Parser{priority=90;subpriority=1;parse(a,o,l){switch(o){case"D":case"DD":return(0,t.parseNumericPattern)(n.numericPatterns.dayOfYear,a);case"Do":return l.ordinalNumber(a,{unit:"date"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){const l=a.getFullYear();return(0,t.isLeapYearIndex)(l)?o>=1&&o<=366:o>=1&&o<=365}set(a,o,l){return a.setMonth(0,l),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};return wg.DayOfYearParser=r,wg}var _g={},M_={},$O;function Ty(){if($O)return M_;$O=1,M_.setDay=r;var n=Ol(),e=Fe(),t=Cs();function r(s,a,o){const l=(0,t.getDefaultOptions)(),c=o?.weekStartsOn??o?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,d=(0,e.toDate)(s),h=d.getDay(),x=(a%7+7)%7,v=7-c,b=a<0||a>6?a-(h+v)%7:(x+v)%7-(h+v)%7;return(0,n.addDays)(d,b)}return M_}var HO;function sne(){if(HO)return _g;HO=1,_g.DayParser=void 0;var n=Ty(),e=yn();let t=class extends e.Parser{priority=90;parse(s,a,o){switch(a){case"E":case"EE":case"EEE":return o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(s,{width:"wide",context:"formatting"})||o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"})}}validate(s,a){return a>=0&&a<=6}set(s,a,o,l){return s=(0,n.setDay)(s,o,l),s.setHours(0,0,0,0),s}incompatibleTokens=["D","i","e","c","t","T"]};return _g.DayParser=t,_g}var jg={},YO;function ine(){if(YO)return jg;YO=1,jg.LocalDayParser=void 0;var n=Ty(),e=yn(),t=Cn();let r=class extends e.Parser{priority=90;parse(a,o,l,c){const d=h=>{const p=Math.floor((h-1)/7)*7;return(h+c.weekStartsOn+6)%7+p};switch(o){case"e":case"ee":return(0,t.mapValue)((0,t.parseNDigits)(o.length,a),d);case"eo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"day"}),d);case"eee":return l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"});case"eeeee":return l.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"});case"eeee":default:return l.day(a,{width:"wide",context:"formatting"})||l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"})}}validate(a,o){return o>=0&&o<=6}set(a,o,l,c){return a=(0,n.setDay)(a,l,c),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]};return jg.LocalDayParser=r,jg}var Sg={},GO;function ane(){if(GO)return Sg;GO=1,Sg.StandAloneLocalDayParser=void 0;var n=Ty(),e=yn(),t=Cn();let r=class extends e.Parser{priority=90;parse(a,o,l,c){const d=h=>{const p=Math.floor((h-1)/7)*7;return(h+c.weekStartsOn+6)%7+p};switch(o){case"c":case"cc":return(0,t.mapValue)((0,t.parseNDigits)(o.length,a),d);case"co":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"day"}),d);case"ccc":return l.day(a,{width:"abbreviated",context:"standalone"})||l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"});case"ccccc":return l.day(a,{width:"narrow",context:"standalone"});case"cccccc":return l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"});case"cccc":default:return l.day(a,{width:"wide",context:"standalone"})||l.day(a,{width:"abbreviated",context:"standalone"})||l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"})}}validate(a,o){return o>=0&&o<=6}set(a,o,l,c){return a=(0,n.setDay)(a,l,c),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};return Sg.StandAloneLocalDayParser=r,Sg}var Ng={},E_={},ZO;function B5(){if(ZO)return E_;ZO=1,E_.setISODay=r;var n=Ol(),e=R5(),t=Fe();function r(s,a){const o=(0,t.toDate)(s),l=(0,e.getISODay)(o),c=a-l;return(0,n.addDays)(o,c)}return E_}var KO;function one(){if(KO)return Ng;KO=1,Ng.ISODayParser=void 0;var n=B5(),e=yn(),t=Cn();let r=class extends e.Parser{priority=90;parse(a,o,l){const c=d=>d===0?7:d;switch(o){case"i":case"ii":return(0,t.parseNDigits)(o.length,a);case"io":return l.ordinalNumber(a,{unit:"day"});case"iii":return(0,t.mapValue)(l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c);case"iiiii":return(0,t.mapValue)(l.day(a,{width:"narrow",context:"formatting"}),c);case"iiiiii":return(0,t.mapValue)(l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c);case"iiii":default:return(0,t.mapValue)(l.day(a,{width:"wide",context:"formatting"})||l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c)}}validate(a,o){return o>=1&&o<=7}set(a,o,l){return a=(0,n.setISODay)(a,l),a.setHours(0,0,0,0),a}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]};return Ng.ISODayParser=r,Ng}var Cg={},JO;function lne(){if(JO)return Cg;JO=1,Cg.AMPMParser=void 0;var n=yn(),e=Cn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"a":case"aa":case"aaa":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["b","B","H","k","t","T"]};return Cg.AMPMParser=t,Cg}var Tg={},QO;function cne(){if(QO)return Tg;QO=1,Tg.AMPMMidnightParser=void 0;var n=yn(),e=Cn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"b":case"bb":case"bbb":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["a","B","H","k","t","T"]};return Tg.AMPMMidnightParser=t,Tg}var kg={},XO;function dne(){if(XO)return kg;XO=1,kg.DayPeriodParser=void 0;var n=yn(),e=Cn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"B":case"BB":case"BBB":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["a","b","t","T"]};return kg.DayPeriodParser=t,kg}var Pg={},eI;function une(){if(eI)return Pg;eI=1,Pg.Hour1to12Parser=void 0;var n=Ts(),e=yn(),t=Cn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"h":return(0,t.parseNumericPattern)(n.numericPatterns.hour12h,a);case"ho":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=1&&o<=12}set(a,o,l){const c=a.getHours()>=12;return c&&l<12?a.setHours(l+12,0,0,0):!c&&l===12?a.setHours(0,0,0,0):a.setHours(l,0,0,0),a}incompatibleTokens=["H","K","k","t","T"]};return Pg.Hour1to12Parser=r,Pg}var Mg={},tI;function fne(){if(tI)return Mg;tI=1,Mg.Hour0to23Parser=void 0;var n=Ts(),e=yn(),t=Cn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"H":return(0,t.parseNumericPattern)(n.numericPatterns.hour23h,a);case"Ho":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=23}set(a,o,l){return a.setHours(l,0,0,0),a}incompatibleTokens=["a","b","h","K","k","t","T"]};return Mg.Hour0to23Parser=r,Mg}var Eg={},nI;function hne(){if(nI)return Eg;nI=1,Eg.Hour0To11Parser=void 0;var n=Ts(),e=yn(),t=Cn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"K":return(0,t.parseNumericPattern)(n.numericPatterns.hour11h,a);case"Ko":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.getHours()>=12&&l<12?a.setHours(l+12,0,0,0):a.setHours(l,0,0,0),a}incompatibleTokens=["h","H","k","t","T"]};return Eg.Hour0To11Parser=r,Eg}var Dg={},rI;function mne(){if(rI)return Dg;rI=1,Dg.Hour1To24Parser=void 0;var n=Ts(),e=yn(),t=Cn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"k":return(0,t.parseNumericPattern)(n.numericPatterns.hour24h,a);case"ko":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=1&&o<=24}set(a,o,l){const c=l<=24?l%24:l;return a.setHours(c,0,0,0),a}incompatibleTokens=["a","b","h","H","K","t","T"]};return Dg.Hour1To24Parser=r,Dg}var Og={},sI;function pne(){if(sI)return Og;sI=1,Og.MinuteParser=void 0;var n=Ts(),e=yn(),t=Cn();let r=class extends e.Parser{priority=60;parse(a,o,l){switch(o){case"m":return(0,t.parseNumericPattern)(n.numericPatterns.minute,a);case"mo":return l.ordinalNumber(a,{unit:"minute"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=59}set(a,o,l){return a.setMinutes(l,0,0),a}incompatibleTokens=["t","T"]};return Og.MinuteParser=r,Og}var Ig={},iI;function gne(){if(iI)return Ig;iI=1,Ig.SecondParser=void 0;var n=Ts(),e=yn(),t=Cn();let r=class extends e.Parser{priority=50;parse(a,o,l){switch(o){case"s":return(0,t.parseNumericPattern)(n.numericPatterns.second,a);case"so":return l.ordinalNumber(a,{unit:"second"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=59}set(a,o,l){return a.setSeconds(l,0),a}incompatibleTokens=["t","T"]};return Ig.SecondParser=r,Ig}var Ag={},aI;function xne(){if(aI)return Ag;aI=1,Ag.FractionOfSecondParser=void 0;var n=yn(),e=Cn();let t=class extends n.Parser{priority=30;parse(s,a){const o=l=>Math.trunc(l*Math.pow(10,-a.length+3));return(0,e.mapValue)((0,e.parseNDigits)(a.length,s),o)}set(s,a,o){return s.setMilliseconds(o),s}incompatibleTokens=["t","T"]};return Ag.FractionOfSecondParser=t,Ag}var Rg={},oI;function yne(){if(oI)return Rg;oI=1,Rg.ISOTimezoneWithZParser=void 0;var n=pn(),e=id(),t=Ts(),r=yn(),s=Cn();let a=class extends r.Parser{priority=10;parse(l,c){switch(c){case"X":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalMinutes,l);case"XX":return(0,s.parseTimezonePattern)(t.timezonePatterns.basic,l);case"XXXX":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalSeconds,l);case"XXXXX":return(0,s.parseTimezonePattern)(t.timezonePatterns.extendedOptionalSeconds,l);case"XXX":default:return(0,s.parseTimezonePattern)(t.timezonePatterns.extended,l)}}set(l,c,d){return c.timestampIsSet?l:(0,n.constructFrom)(l,l.getTime()-(0,e.getTimezoneOffsetInMilliseconds)(l)-d)}incompatibleTokens=["t","T","x"]};return Rg.ISOTimezoneWithZParser=a,Rg}var Lg={},lI;function vne(){if(lI)return Lg;lI=1,Lg.ISOTimezoneParser=void 0;var n=pn(),e=id(),t=Ts(),r=yn(),s=Cn();let a=class extends r.Parser{priority=10;parse(l,c){switch(c){case"x":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalMinutes,l);case"xx":return(0,s.parseTimezonePattern)(t.timezonePatterns.basic,l);case"xxxx":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalSeconds,l);case"xxxxx":return(0,s.parseTimezonePattern)(t.timezonePatterns.extendedOptionalSeconds,l);case"xxx":default:return(0,s.parseTimezonePattern)(t.timezonePatterns.extended,l)}}set(l,c,d){return c.timestampIsSet?l:(0,n.constructFrom)(l,l.getTime()-(0,e.getTimezoneOffsetInMilliseconds)(l)-d)}incompatibleTokens=["t","T","X"]};return Lg.ISOTimezoneParser=a,Lg}var Fg={},cI;function bne(){if(cI)return Fg;cI=1,Fg.TimestampSecondsParser=void 0;var n=pn(),e=yn(),t=Cn();let r=class extends e.Parser{priority=40;parse(a){return(0,t.parseAnyDigitsSigned)(a)}set(a,o,l){return[(0,n.constructFrom)(a,l*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"};return Fg.TimestampSecondsParser=r,Fg}var qg={},dI;function wne(){if(dI)return qg;dI=1,qg.TimestampMillisecondsParser=void 0;var n=pn(),e=yn(),t=Cn();let r=class extends e.Parser{priority=20;parse(a){return(0,t.parseAnyDigitsSigned)(a)}set(a,o,l){return[(0,n.constructFrom)(a,l),{timestampIsSet:!0}]}incompatibleTokens="*"};return qg.TimestampMillisecondsParser=r,qg}var uI;function _ne(){if(uI)return og;uI=1,og.parsers=void 0;var n=$te(),e=Hte(),t=Yte(),r=Gte(),s=Zte(),a=Kte(),o=Jte(),l=Qte(),c=Xte(),d=ene(),h=tne(),p=nne(),x=rne(),v=sne(),b=ine(),_=ane(),j=one(),C=lne(),P=cne(),O=dne(),M=une(),D=fne(),I=hne(),F=mne(),q=pne(),U=gne(),B=xne(),W=yne(),Y=vne(),G=bne(),Z=wne();return og.parsers={G:new n.EraParser,y:new e.YearParser,Y:new t.LocalWeekYearParser,R:new r.ISOWeekYearParser,u:new s.ExtendedYearParser,Q:new a.QuarterParser,q:new o.StandAloneQuarterParser,M:new l.MonthParser,L:new c.StandAloneMonthParser,w:new d.LocalWeekParser,I:new h.ISOWeekParser,d:new p.DateParser,D:new x.DayOfYearParser,E:new v.DayParser,e:new b.LocalDayParser,c:new _.StandAloneLocalDayParser,i:new j.ISODayParser,a:new C.AMPMParser,b:new P.AMPMMidnightParser,B:new O.DayPeriodParser,h:new M.Hour1to12Parser,H:new D.Hour0to23Parser,K:new I.Hour0To11Parser,k:new F.Hour1To24Parser,m:new q.MinuteParser,s:new U.SecondParser,S:new B.FractionOfSecondParser,X:new W.ISOTimezoneWithZParser,x:new Y.ISOTimezoneParser,t:new G.TimestampSecondsParser,T:new Z.TimestampMillisecondsParser},og}var fI;function V5(){return fI||(fI=1,(function(n){Object.defineProperty(n,"longFormatters",{enumerable:!0,get:function(){return a.longFormatters}}),n.parse=_,Object.defineProperty(n,"parsers",{enumerable:!0,get:function(){return l.parsers}});var e=pn(),t=A5(),r=Kf(),s=Fe(),a=T5(),o=k5(),l=_ne(),c=q5();const d=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,h=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,p=/^'([^]*?)'?$/,x=/''/g,v=/\S/,b=/[a-zA-Z]/;function _(C,P,O,M){const D=(0,t.getDefaultOptions)(),I=M?.locale??D.locale??r.defaultLocale,F=M?.firstWeekContainsDate??M?.locale?.options?.firstWeekContainsDate??D.firstWeekContainsDate??D.locale?.options?.firstWeekContainsDate??1,q=M?.weekStartsOn??M?.locale?.options?.weekStartsOn??D.weekStartsOn??D.locale?.options?.weekStartsOn??0;if(P==="")return C===""?(0,s.toDate)(O):(0,e.constructFrom)(O,NaN);const U={firstWeekContainsDate:F,weekStartsOn:q,locale:I},B=[new c.DateToSystemTimezoneSetter],W=P.match(h).map(X=>{const he=X[0];if(he in a.longFormatters){const $=a.longFormatters[he];return $(X,I.formatLong)}return X}).join("").match(d),Y=[];for(let X of W){!M?.useAdditionalWeekYearTokens&&(0,o.isProtectedWeekYearToken)(X)&&(0,o.warnOrThrowProtectedError)(X,P,C),!M?.useAdditionalDayOfYearTokens&&(0,o.isProtectedDayOfYearToken)(X)&&(0,o.warnOrThrowProtectedError)(X,P,C);const he=X[0],$=l.parsers[he];if($){const{incompatibleTokens:K}=$;if(Array.isArray(K)){const H=Y.find(ae=>K.includes(ae.token)||ae.token===he);if(H)throw new RangeError(`The format string mustn't contain \`${H.fullToken}\` and \`${X}\` at the same time`)}else if($.incompatibleTokens==="*"&&Y.length>0)throw new RangeError(`The format string mustn't contain \`${X}\` and any other token at the same time`);Y.push({token:he,fullToken:X});const te=$.run(C,X,I.match,U);if(!te)return(0,e.constructFrom)(O,NaN);B.push(te.setter),C=te.rest}else{if(he.match(b))throw new RangeError("Format string contains an unescaped latin alphabet character `"+he+"`");if(X==="''"?X="'":he==="'"&&(X=j(X)),C.indexOf(X)===0)C=C.slice(X.length);else return(0,e.constructFrom)(O,NaN)}}if(C.length>0&&v.test(C))return(0,e.constructFrom)(O,NaN);const G=B.map(X=>X.priority).sort((X,he)=>he-X).filter((X,he,$)=>$.indexOf(X)===he).map(X=>B.filter(he=>he.priority===X).sort((he,$)=>$.subPriority-he.subPriority)).map(X=>X[0]);let Z=(0,s.toDate)(O);if(isNaN(Z.getTime()))return(0,e.constructFrom)(O,NaN);const oe={};for(const X of G){if(!X.validate(Z,U))return(0,e.constructFrom)(O,NaN);const he=X.set(Z,oe,U);Array.isArray(he)?(Z=he[0],Object.assign(oe,he[1])):Z=he}return(0,e.constructFrom)(O,Z)}function j(C){return C.match(p)[1].replace(x,"'")}})(C_)),C_}var hI;function jne(){if(hI)return N_;hI=1,N_.isMatch=t;var n=od(),e=V5();function t(r,s,a){return(0,n.isValid)((0,e.parse)(r,s,new Date,a))}return N_}var D_={},mI;function Sne(){if(mI)return D_;mI=1,D_.isMonday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===1}return D_}var O_={},pI;function Nne(){if(pI)return O_;pI=1,O_.isPast=e;var n=Fe();function e(t){return+(0,n.toDate)(t)<Date.now()}return O_}var I_={},A_={},gI;function W5(){if(gI)return A_;gI=1,A_.startOfHour=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setMinutes(0,0,0),r}return A_}var xI;function $5(){if(xI)return I_;xI=1,I_.isSameHour=e;var n=W5();function e(t,r){const s=(0,n.startOfHour)(t),a=(0,n.startOfHour)(r);return+s==+a}return I_}var R_={},L_={},yI;function l1(){if(yI)return L_;yI=1,L_.isSameWeek=e;var n=Mo();function e(t,r,s){const a=(0,n.startOfWeek)(t,s),o=(0,n.startOfWeek)(r,s);return+a==+o}return L_}var vI;function H5(){if(vI)return R_;vI=1,R_.isSameISOWeek=e;var n=l1();function e(t,r){return(0,n.isSameWeek)(t,r,{weekStartsOn:1})}return R_}var F_={},bI;function Cne(){if(bI)return F_;bI=1,F_.isSameISOWeekYear=e;var n=zm();function e(t,r){const s=(0,n.startOfISOWeekYear)(t),a=(0,n.startOfISOWeekYear)(r);return+s==+a}return F_}var q_={},wI;function Y5(){if(wI)return q_;wI=1,q_.isSameMinute=e;var n=t1();function e(t,r){const s=(0,n.startOfMinute)(t),a=(0,n.startOfMinute)(r);return+s==+a}return q_}var z_={},_I;function G5(){if(_I)return z_;_I=1,z_.isSameMonth=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()}return z_}var U_={},jI;function Z5(){if(jI)return U_;jI=1,U_.isSameQuarter=e;var n=n1();function e(t,r){const s=(0,n.startOfQuarter)(t),a=(0,n.startOfQuarter)(r);return+s==+a}return U_}var B_={},V_={},SI;function K5(){if(SI)return V_;SI=1,V_.startOfSecond=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setMilliseconds(0),r}return V_}var NI;function J5(){if(NI)return B_;NI=1,B_.isSameSecond=e;var n=K5();function e(t,r){const s=(0,n.startOfSecond)(t),a=(0,n.startOfSecond)(r);return+s==+a}return B_}var W_={},CI;function Q5(){if(CI)return W_;CI=1,W_.isSameYear=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()===a.getFullYear()}return W_}var $_={},TI;function Tne(){if(TI)return $_;TI=1,$_.isThisHour=t;var n=Xs(),e=$5();function t(r){return(0,e.isSameHour)(r,(0,n.constructNow)(r))}return $_}var H_={},kI;function kne(){if(kI)return H_;kI=1,H_.isThisISOWeek=t;var n=Xs(),e=H5();function t(r){return(0,e.isSameISOWeek)(r,(0,n.constructNow)(r))}return H_}var Y_={},PI;function Pne(){if(PI)return Y_;PI=1,Y_.isThisMinute=t;var n=Xs(),e=Y5();function t(r){return(0,e.isSameMinute)(r,(0,n.constructNow)(r))}return Y_}var G_={},MI;function Mne(){if(MI)return G_;MI=1,G_.isThisMonth=t;var n=Xs(),e=G5();function t(r){return(0,e.isSameMonth)(r,(0,n.constructNow)(r))}return G_}var Z_={},EI;function Ene(){if(EI)return Z_;EI=1,Z_.isThisQuarter=t;var n=Xs(),e=Z5();function t(r){return(0,e.isSameQuarter)(r,(0,n.constructNow)(r))}return Z_}var K_={},DI;function Dne(){if(DI)return K_;DI=1,K_.isThisSecond=t;var n=Xs(),e=J5();function t(r){return(0,e.isSameSecond)(r,(0,n.constructNow)(r))}return K_}var J_={},OI;function One(){if(OI)return J_;OI=1,J_.isThisWeek=t;var n=Xs(),e=l1();function t(r,s){return(0,e.isSameWeek)(r,(0,n.constructNow)(r),s)}return J_}var Q_={},II;function Ine(){if(II)return Q_;II=1,Q_.isThisYear=t;var n=Xs(),e=Q5();function t(r){return(0,e.isSameYear)(r,(0,n.constructNow)(r))}return Q_}var X_={},AI;function Ane(){if(AI)return X_;AI=1,X_.isThursday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===4}return X_}var ej={},RI;function Rne(){if(RI)return ej;RI=1,ej.isToday=t;var n=Xs(),e=Um();function t(r){return(0,e.isSameDay)(r,(0,n.constructNow)(r))}return ej}var tj={},LI;function Lne(){if(LI)return tj;LI=1,tj.isTomorrow=r;var n=Ol(),e=Xs(),t=Um();function r(s){return(0,t.isSameDay)(s,(0,n.addDays)((0,e.constructNow)(s),1))}return tj}var nj={},FI;function Fne(){if(FI)return nj;FI=1,nj.isTuesday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===2}return nj}var rj={},qI;function qne(){if(qI)return rj;qI=1,rj.isWednesday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===3}return rj}var sj={},zI;function zne(){if(zI)return sj;zI=1,sj.isWithinInterval=e;var n=Fe();function e(t,r){const s=+(0,n.toDate)(t),[a,o]=[+(0,n.toDate)(r.start),+(0,n.toDate)(r.end)].sort((l,c)=>l-c);return s>=a&&s<=o}return sj}var ij={},aj={},UI;function ky(){if(UI)return aj;UI=1,aj.subDays=e;var n=Ol();function e(t,r){return(0,n.addDays)(t,-r)}return aj}var BI;function Une(){if(BI)return ij;BI=1,ij.isYesterday=r;var n=Xs(),e=Um(),t=ky();function r(s){return(0,e.isSameDay)(s,(0,t.subDays)((0,n.constructNow)(s),1))}return ij}var oj={},VI;function Bne(){if(VI)return oj;VI=1,oj.lastDayOfDecade=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=9+Math.floor(s/10)*10;return r.setFullYear(a+1,0,0),r.setHours(0,0,0,0),r}return oj}var lj={},cj={},WI;function X5(){if(WI)return cj;WI=1,cj.lastDayOfWeek=t;var n=Fe(),e=Cs();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?-7:0)+6-(c-o);return l.setHours(0,0,0,0),l.setDate(l.getDate()+d),l}return cj}var $I;function Vne(){if($I)return lj;$I=1,lj.lastDayOfISOWeek=e;var n=X5();function e(t){return(0,n.lastDayOfWeek)(t,{weekStartsOn:1})}return lj}var dj={},HI;function Wne(){if(HI)return dj;HI=1,dj.lastDayOfISOWeekYear=r;var n=Cu(),e=Il(),t=pn();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const l=(0,e.startOfISOWeek)(o);return l.setDate(l.getDate()-1),l}return dj}var uj={},YI;function $ne(){if(YI)return uj;YI=1,uj.lastDayOfQuarter=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3+3;return r.setMonth(a,0),r.setHours(0,0,0,0),r}return uj}var fj={},GI;function Hne(){if(GI)return fj;GI=1,fj.lastDayOfYear=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(0,0,0,0),r}return fj}var hj={},ZI;function Yne(){return ZI||(ZI=1,(function(n){n.lightFormat=c,Object.defineProperty(n,"lightFormatters",{enumerable:!0,get:function(){return r.lightFormatters}});var e=od(),t=Fe(),r=C5();const s=/(\w)\1*|''|'(''|[^'])+('|$)|./g,a=/^'([^]*?)'?$/,o=/''/g,l=/[a-zA-Z]/;function c(h,p){const x=(0,t.toDate)(h);if(!(0,e.isValid)(x))throw new RangeError("Invalid time value");const v=p.match(s);return v?v.map(_=>{if(_==="''")return"'";const j=_[0];if(j==="'")return d(_);const C=r.lightFormatters[j];if(C)return C(x,_);if(j.match(l))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");return _}).join(""):""}function d(h){const p=h.match(a);return p?p[1].replace(o,"'"):h}})(hj)),hj}var mj={},KI;function Gne(){if(KI)return mj;KI=1,mj.milliseconds=e;var n=en();function e({years:t,months:r,weeks:s,days:a,hours:o,minutes:l,seconds:c}){let d=0;t&&(d+=t*n.daysInYear),r&&(d+=r*(n.daysInYear/12)),s&&(d+=s*7),a&&(d+=a);let h=d*24*60*60;return o&&(h+=o*60*60),l&&(h+=l*60),c&&(h+=c),Math.trunc(h*1e3)}return mj}var pj={},JI;function Zne(){if(JI)return pj;JI=1,pj.millisecondsToHours=e;var n=en();function e(t){const r=t/n.millisecondsInHour;return Math.trunc(r)}return pj}var gj={},QI;function Kne(){if(QI)return gj;QI=1,gj.millisecondsToMinutes=e;var n=en();function e(t){const r=t/n.millisecondsInMinute;return Math.trunc(r)}return gj}var xj={},XI;function Jne(){if(XI)return xj;XI=1,xj.millisecondsToSeconds=e;var n=en();function e(t){const r=t/n.millisecondsInSecond;return Math.trunc(r)}return xj}var yj={},eA;function Qne(){if(eA)return yj;eA=1,yj.minutesToHours=e;var n=en();function e(t){const r=t/n.minutesInHour;return Math.trunc(r)}return yj}var vj={},tA;function Xne(){if(tA)return vj;tA=1,vj.minutesToMilliseconds=e;var n=en();function e(t){return Math.trunc(t*n.millisecondsInMinute)}return vj}var bj={},nA;function ere(){if(nA)return bj;nA=1,bj.minutesToSeconds=e;var n=en();function e(t){return Math.trunc(t*n.secondsInMinute)}return bj}var wj={},rA;function tre(){if(rA)return wj;rA=1,wj.monthsToQuarters=e;var n=en();function e(t){const r=t/n.monthsInQuarter;return Math.trunc(r)}return wj}var _j={},sA;function nre(){if(sA)return _j;sA=1,_j.monthsToYears=e;var n=en();function e(t){const r=t/n.monthsInYear;return Math.trunc(r)}return _j}var jj={},iA;function cd(){if(iA)return jj;iA=1,jj.nextDay=t;var n=Ol(),e=Cy();function t(r,s){let a=s-(0,e.getDay)(r);return a<=0&&(a+=7),(0,n.addDays)(r,a)}return jj}var Sj={},aA;function rre(){if(aA)return Sj;aA=1,Sj.nextFriday=e;var n=cd();function e(t){return(0,n.nextDay)(t,5)}return Sj}var Nj={},oA;function sre(){if(oA)return Nj;oA=1,Nj.nextMonday=e;var n=cd();function e(t){return(0,n.nextDay)(t,1)}return Nj}var Cj={},lA;function ire(){if(lA)return Cj;lA=1,Cj.nextSaturday=e;var n=cd();function e(t){return(0,n.nextDay)(t,6)}return Cj}var Tj={},cA;function are(){if(cA)return Tj;cA=1,Tj.nextSunday=e;var n=cd();function e(t){return(0,n.nextDay)(t,0)}return Tj}var kj={},dA;function ore(){if(dA)return kj;dA=1,kj.nextThursday=e;var n=cd();function e(t){return(0,n.nextDay)(t,4)}return kj}var Pj={},uA;function lre(){if(uA)return Pj;uA=1,Pj.nextTuesday=e;var n=cd();function e(t){return(0,n.nextDay)(t,2)}return Pj}var Mj={},fA;function cre(){if(fA)return Mj;fA=1,Mj.nextWednesday=e;var n=cd();function e(t){return(0,n.nextDay)(t,3)}return Mj}var Ej={},hA;function dre(){if(hA)return Ej;hA=1,Ej.parseISO=e;var n=en();function e(D,I){const F=I?.additionalDigits??2,q=o(D);let U;if(q.date){const G=l(q.date,F);U=c(G.restDateString,G.year)}if(!U||isNaN(U.getTime()))return new Date(NaN);const B=U.getTime();let W=0,Y;if(q.time&&(W=h(q.time),isNaN(W)))return new Date(NaN);if(q.timezone){if(Y=x(q.timezone),isNaN(Y))return new Date(NaN)}else{const G=new Date(B+W),Z=new Date(0);return Z.setFullYear(G.getUTCFullYear(),G.getUTCMonth(),G.getUTCDate()),Z.setHours(G.getUTCHours(),G.getUTCMinutes(),G.getUTCSeconds(),G.getUTCMilliseconds()),Z}return new Date(B+W+Y)}const t={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},r=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,s=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,a=/^([+-])(\d{2})(?::?(\d{2}))?$/;function o(D){const I={},F=D.split(t.dateTimeDelimiter);let q;if(F.length>2)return I;if(/:/.test(F[0])?q=F[0]:(I.date=F[0],q=F[1],t.timeZoneDelimiter.test(I.date)&&(I.date=D.split(t.timeZoneDelimiter)[0],q=D.substr(I.date.length,D.length))),q){const U=t.timezone.exec(q);U?(I.time=q.replace(U[1],""),I.timezone=U[1]):I.time=q}return I}function l(D,I){const F=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+I)+"})|(\\d{2}|[+-]\\d{"+(2+I)+"})$)"),q=D.match(F);if(!q)return{year:NaN,restDateString:""};const U=q[1]?parseInt(q[1]):null,B=q[2]?parseInt(q[2]):null;return{year:B===null?U:B*100,restDateString:D.slice((q[1]||q[2]).length)}}function c(D,I){if(I===null)return new Date(NaN);const F=D.match(r);if(!F)return new Date(NaN);const q=!!F[4],U=d(F[1]),B=d(F[2])-1,W=d(F[3]),Y=d(F[4]),G=d(F[5])-1;if(q)return P(I,Y,G)?v(I,Y,G):new Date(NaN);{const Z=new Date(0);return!j(I,B,W)||!C(I,U)?new Date(NaN):(Z.setUTCFullYear(I,B,Math.max(U,W)),Z)}}function d(D){return D?parseInt(D):1}function h(D){const I=D.match(s);if(!I)return NaN;const F=p(I[1]),q=p(I[2]),U=p(I[3]);return O(F,q,U)?F*n.millisecondsInHour+q*n.millisecondsInMinute+U*1e3:NaN}function p(D){return D&&parseFloat(D.replace(",","."))||0}function x(D){if(D==="Z")return 0;const I=D.match(a);if(!I)return 0;const F=I[1]==="+"?-1:1,q=parseInt(I[2]),U=I[3]&&parseInt(I[3])||0;return M(q,U)?F*(q*n.millisecondsInHour+U*n.millisecondsInMinute):NaN}function v(D,I,F){const q=new Date(0);q.setUTCFullYear(D,0,4);const U=q.getUTCDay()||7,B=(I-1)*7+F+1-U;return q.setUTCDate(q.getUTCDate()+B),q}const b=[31,null,31,30,31,30,31,31,30,31,30,31];function _(D){return D%400===0||D%4===0&&D%100!==0}function j(D,I,F){return I>=0&&I<=11&&F>=1&&F<=(b[I]||(_(D)?29:28))}function C(D,I){return I>=1&&I<=(_(D)?366:365)}function P(D,I,F){return I>=1&&I<=53&&F>=0&&F<=6}function O(D,I,F){return D===24?I===0&&F===0:F>=0&&F<60&&I>=0&&I<60&&D>=0&&D<25}function M(D,I){return I>=0&&I<=59}return Ej}var Dj={},mA;function ure(){if(mA)return Dj;mA=1,Dj.parseJSON=n;function n(e){const t=e.match(/(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})(?:\.(\d{0,7}))?(?:Z|(.)(\d{2}):?(\d{2})?)?/);return t?new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4]-(+t[9]||0)*(t[8]=="-"?-1:1),+t[5]-(+t[10]||0)*(t[8]=="-"?-1:1),+t[6],+((t[7]||"0")+"00").substring(0,3))):new Date(NaN)}return Dj}var Oj={},pA;function dd(){if(pA)return Oj;pA=1,Oj.previousDay=t;var n=Cy(),e=ky();function t(r,s){let a=(0,n.getDay)(r)-s;return a<=0&&(a+=7),(0,e.subDays)(r,a)}return Oj}var Ij={},gA;function fre(){if(gA)return Ij;gA=1,Ij.previousFriday=e;var n=dd();function e(t){return(0,n.previousDay)(t,5)}return Ij}var Aj={},xA;function hre(){if(xA)return Aj;xA=1,Aj.previousMonday=e;var n=dd();function e(t){return(0,n.previousDay)(t,1)}return Aj}var Rj={},yA;function mre(){if(yA)return Rj;yA=1,Rj.previousSaturday=e;var n=dd();function e(t){return(0,n.previousDay)(t,6)}return Rj}var Lj={},vA;function pre(){if(vA)return Lj;vA=1,Lj.previousSunday=e;var n=dd();function e(t){return(0,n.previousDay)(t,0)}return Lj}var Fj={},bA;function gre(){if(bA)return Fj;bA=1,Fj.previousThursday=e;var n=dd();function e(t){return(0,n.previousDay)(t,4)}return Fj}var qj={},wA;function xre(){if(wA)return qj;wA=1,qj.previousTuesday=e;var n=dd();function e(t){return(0,n.previousDay)(t,2)}return qj}var zj={},_A;function yre(){if(_A)return zj;_A=1,zj.previousWednesday=e;var n=dd();function e(t){return(0,n.previousDay)(t,3)}return zj}var Uj={},jA;function vre(){if(jA)return Uj;jA=1,Uj.quartersToMonths=e;var n=en();function e(t){return Math.trunc(t*n.monthsInQuarter)}return Uj}var Bj={},SA;function bre(){if(SA)return Bj;SA=1,Bj.quartersToYears=e;var n=en();function e(t){const r=t/n.quartersInYear;return Math.trunc(r)}return Bj}var Vj={},NA;function wre(){if(NA)return Vj;NA=1,Vj.roundToNearestHours=r;var n=ld(),e=pn(),t=Fe();function r(s,a){const o=a?.nearestTo??1;if(o<1||o>12)return(0,e.constructFrom)(s,NaN);const l=(0,t.toDate)(s),c=l.getMinutes()/60,d=l.getSeconds()/60/60,h=l.getMilliseconds()/1e3/60/60,p=l.getHours()+c+d+h,x=a?.roundingMethod??"round",b=(0,n.getRoundingMethod)(x)(p/o)*o,_=(0,e.constructFrom)(s,l);return _.setHours(b,0,0,0),_}return Vj}var Wj={},CA;function _re(){if(CA)return Wj;CA=1,Wj.roundToNearestMinutes=r;var n=ld(),e=pn(),t=Fe();function r(s,a){const o=a?.nearestTo??1;if(o<1||o>30)return(0,e.constructFrom)(s,NaN);const l=(0,t.toDate)(s),c=l.getSeconds()/60,d=l.getMilliseconds()/1e3/60,h=l.getMinutes()+c+d,p=a?.roundingMethod??"round",v=(0,n.getRoundingMethod)(p)(h/o)*o,b=(0,e.constructFrom)(s,l);return b.setMinutes(v,0,0),b}return Wj}var $j={},TA;function jre(){if(TA)return $j;TA=1,$j.secondsToHours=e;var n=en();function e(t){const r=t/n.secondsInHour;return Math.trunc(r)}return $j}var Hj={},kA;function Sre(){if(kA)return Hj;kA=1,Hj.secondsToMilliseconds=e;var n=en();function e(t){return t*n.millisecondsInSecond}return Hj}var Yj={},PA;function Nre(){if(PA)return Yj;PA=1,Yj.secondsToMinutes=e;var n=en();function e(t){const r=t/n.secondsInMinute;return Math.trunc(r)}return Yj}var Gj={},Zj={},MA;function c1(){if(MA)return Zj;MA=1,Zj.setMonth=r;var n=pn(),e=O5(),t=Fe();function r(s,a){const o=(0,t.toDate)(s),l=o.getFullYear(),c=o.getDate(),d=(0,n.constructFrom)(s,0);d.setFullYear(l,a,15),d.setHours(0,0,0,0);const h=(0,e.getDaysInMonth)(d);return o.setMonth(a,Math.min(c,h)),o}return Zj}var EA;function Cre(){if(EA)return Gj;EA=1,Gj.set=r;var n=pn(),e=c1(),t=Fe();function r(s,a){let o=(0,t.toDate)(s);return isNaN(+o)?(0,n.constructFrom)(s,NaN):(a.year!=null&&o.setFullYear(a.year),a.month!=null&&(o=(0,e.setMonth)(o,a.month)),a.date!=null&&o.setDate(a.date),a.hours!=null&&o.setHours(a.hours),a.minutes!=null&&o.setMinutes(a.minutes),a.seconds!=null&&o.setSeconds(a.seconds),a.milliseconds!=null&&o.setMilliseconds(a.milliseconds),o)}return Gj}var Kj={},DA;function Tre(){if(DA)return Kj;DA=1,Kj.setDate=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setDate(r),s}return Kj}var Jj={},OA;function kre(){if(OA)return Jj;OA=1,Jj.setDayOfYear=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setMonth(0),s.setDate(r),s}return Jj}var Qj={},IA;function Pre(){if(IA)return Qj;IA=1,Qj.setDefaultOptions=e;var n=Cs();function e(t){const r={},s=(0,n.getDefaultOptions)();for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&(r[a]=s[a]);for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(t[a]===void 0?delete r[a]:r[a]=t[a]);(0,n.setDefaultOptions)(r)}return Qj}var Xj={},AA;function Mre(){if(AA)return Xj;AA=1,Xj.setHours=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setHours(r),s}return Xj}var eS={},RA;function Ere(){if(RA)return eS;RA=1,eS.setMilliseconds=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setMilliseconds(r),s}return eS}var tS={},LA;function Dre(){if(LA)return tS;LA=1,tS.setMinutes=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setMinutes(r),s}return tS}var nS={},FA;function Ore(){if(FA)return nS;FA=1,nS.setQuarter=t;var n=c1(),e=Fe();function t(r,s){const a=(0,e.toDate)(r),o=Math.trunc(a.getMonth()/3)+1,l=s-o;return(0,n.setMonth)(a,a.getMonth()+l*3)}return nS}var rS={},qA;function Ire(){if(qA)return rS;qA=1,rS.setSeconds=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setSeconds(r),s}return rS}var sS={},zA;function Are(){if(zA)return sS;zA=1,sS.setWeekYear=a;var n=pn(),e=ad(),t=a1(),r=Fe(),s=Cs();function a(o,l,c){const d=(0,s.getDefaultOptions)(),h=c?.firstWeekContainsDate??c?.locale?.options?.firstWeekContainsDate??d.firstWeekContainsDate??d.locale?.options?.firstWeekContainsDate??1;let p=(0,r.toDate)(o);const x=(0,e.differenceInCalendarDays)(p,(0,t.startOfWeekYear)(p,c)),v=(0,n.constructFrom)(o,0);return v.setFullYear(l,0,h),v.setHours(0,0,0,0),p=(0,t.startOfWeekYear)(v,c),p.setDate(p.getDate()+x),p}return sS}var iS={},UA;function Rre(){if(UA)return iS;UA=1,iS.setYear=t;var n=pn(),e=Fe();function t(r,s){const a=(0,e.toDate)(r);return isNaN(+a)?(0,n.constructFrom)(r,NaN):(a.setFullYear(s),a)}return iS}var aS={},BA;function Lre(){if(BA)return aS;BA=1,aS.startOfDecade=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=Math.floor(s/10)*10;return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}return aS}var oS={},VA;function Fre(){if(VA)return oS;VA=1,oS.startOfToday=e;var n=vy();function e(){return(0,n.startOfDay)(Date.now())}return oS}var lS={},WA;function qre(){if(WA)return lS;WA=1,lS.startOfTomorrow=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s+1),a.setHours(0,0,0,0),a}return lS}var cS={},$A;function zre(){if($A)return cS;$A=1,cS.startOfYesterday=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s-1),a.setHours(0,0,0,0),a}return cS}var dS={},uS={},HA;function e6(){if(HA)return uS;HA=1,uS.subMonths=e;var n=Fm();function e(t,r){return(0,n.addMonths)(t,-r)}return uS}var YA;function Ure(){if(YA)return dS;YA=1,dS.sub=r;var n=ky(),e=e6(),t=pn();function r(s,a){const{years:o=0,months:l=0,weeks:c=0,days:d=0,hours:h=0,minutes:p=0,seconds:x=0}=a,v=(0,e.subMonths)(s,l+o*12),b=(0,n.subDays)(v,d+c*7),_=p+h*60,C=(x+_*60)*1e3;return(0,t.constructFrom)(s,b.getTime()-C)}return dS}var fS={},GA;function Bre(){if(GA)return fS;GA=1,fS.subBusinessDays=e;var n=o5();function e(t,r){return(0,n.addBusinessDays)(t,-r)}return fS}var hS={},ZA;function Vre(){if(ZA)return hS;ZA=1,hS.subHours=e;var n=WC();function e(t,r){return(0,n.addHours)(t,-r)}return hS}var mS={},KA;function Wre(){if(KA)return mS;KA=1,mS.subMilliseconds=e;var n=qm();function e(t,r){return(0,n.addMilliseconds)(t,-r)}return mS}var pS={},JA;function $re(){if(JA)return pS;JA=1,pS.subMinutes=e;var n=$C();function e(t,r){return(0,n.addMinutes)(t,-r)}return pS}var gS={},QA;function Hre(){if(QA)return gS;QA=1,gS.subQuarters=e;var n=HC();function e(t,r){return(0,n.addQuarters)(t,-r)}return gS}var xS={},XA;function Yre(){if(XA)return xS;XA=1,xS.subSeconds=e;var n=d5();function e(t,r){return(0,n.addSeconds)(t,-r)}return xS}var yS={},eR;function Gre(){if(eR)return yS;eR=1,yS.subWeeks=e;var n=by();function e(t,r){return(0,n.addWeeks)(t,-r)}return yS}var vS={},tR;function Zre(){if(tR)return vS;tR=1,vS.subYears=e;var n=u5();function e(t,r){return(0,n.addYears)(t,-r)}return vS}var bS={},nR;function Kre(){if(nR)return bS;nR=1,bS.weeksToDays=e;var n=en();function e(t){return Math.trunc(t*n.daysInWeek)}return bS}var wS={},rR;function Jre(){if(rR)return wS;rR=1,wS.yearsToDays=e;var n=en();function e(t){return Math.trunc(t*n.daysInYear)}return wS}var _S={},sR;function Qre(){if(sR)return _S;sR=1,_S.yearsToMonths=e;var n=en();function e(t){return Math.trunc(t*n.monthsInYear)}return _S}var jS={},iR;function Xre(){if(iR)return jS;iR=1,jS.yearsToQuarters=e;var n=en();function e(t){return Math.trunc(t*n.quartersInYear)}return jS}var aR;function Tu(){return aR||(aR=1,(function(n){var e=s5();Object.keys(e).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===e[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return e[g]}})});var t=o5();Object.keys(t).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===t[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return t[g]}})});var r=Ol();Object.keys(r).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===r[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return r[g]}})});var s=WC();Object.keys(s).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===s[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return s[g]}})});var a=c5();Object.keys(a).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===a[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return a[g]}})});var o=qm();Object.keys(o).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===o[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return o[g]}})});var l=$C();Object.keys(l).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===l[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return l[g]}})});var c=Fm();Object.keys(c).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===c[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return c[g]}})});var d=HC();Object.keys(d).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===d[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return d[g]}})});var h=d5();Object.keys(h).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===h[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return h[g]}})});var p=by();Object.keys(p).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===p[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return p[g]}})});var x=u5();Object.keys(x).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===x[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return x[g]}})});var v=_ee();Object.keys(v).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===v[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return v[g]}})});var b=jee();Object.keys(b).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===b[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return b[g]}})});var _=See();Object.keys(_).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _[g]}})});var j=Nee();Object.keys(j).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===j[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return j[g]}})});var C=Zf();Object.keys(C).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===C[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return C[g]}})});var P=Cee();Object.keys(P).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===P[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return P[g]}})});var O=pn();Object.keys(O).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===O[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return O[g]}})});var M=Xs();Object.keys(M).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===M[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return M[g]}})});var D=Tee();Object.keys(D).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===D[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return D[g]}})});var I=kee();Object.keys(I).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===I[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return I[g]}})});var F=ad();Object.keys(F).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===F[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return F[g]}})});var q=p5();Object.keys(q).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===q[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return q[g]}})});var U=Pee();Object.keys(U).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===U[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return U[g]}})});var B=YC();Object.keys(B).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===B[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return B[g]}})});var W=x5();Object.keys(W).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===W[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return W[g]}})});var Y=GC();Object.keys(Y).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Y[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Y[g]}})});var G=ZC();Object.keys(G).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===G[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return G[g]}})});var Z=KC();Object.keys(Z).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Z[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Z[g]}})});var oe=JC();Object.keys(oe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oe[g]}})});var X=Mee();Object.keys(X).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===X[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return X[g]}})});var he=wy();Object.keys(he).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===he[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return he[g]}})});var $=QC();Object.keys($).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $[g]}})});var K=_y();Object.keys(K).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===K[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return K[g]}})});var te=Eee();Object.keys(te).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===te[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return te[g]}})});var H=jy();Object.keys(H).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===H[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return H[g]}})});var ae=Dee();Object.keys(ae).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ae[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ae[g]}})});var le=b5();Object.keys(le).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===le[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return le[g]}})});var ue=w5();Object.keys(ue).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ue[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ue[g]}})});var ie=Oee();Object.keys(ie).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ie[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ie[g]}})});var pe=Iee();Object.keys(pe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pe[g]}})});var re=Aee();Object.keys(re).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===re[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return re[g]}})});var de=Ree();Object.keys(de).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===de[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return de[g]}})});var je=Lee();Object.keys(je).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===je[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return je[g]}})});var Ae=r1();Object.keys(Ae).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ae[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ae[g]}})});var Te=Fee();Object.keys(Te).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Te[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Te[g]}})});var Se=qee();Object.keys(Se).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Se[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Se[g]}})});var Pe=zee();Object.keys(Pe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pe[g]}})});var qe=XC();Object.keys(qe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qe[g]}})});var He=Uee();Object.keys(He).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===He[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return He[g]}})});var ze=Bee();Object.keys(ze).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ze[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ze[g]}})});var be=Vee();Object.keys(be).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===be[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return be[g]}})});var Ue=Wee();Object.keys(Ue).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ue[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ue[g]}})});var Ve=$ee();Object.keys(Ve).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ve[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ve[g]}})});var ee=e1();Object.keys(ee).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ee[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ee[g]}})});var se=Hee();Object.keys(se).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===se[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return se[g]}})});var xe=Yee();Object.keys(xe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xe[g]}})});var ke=Gee();Object.keys(ke).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ke[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ke[g]}})});var Ie=Zee();Object.keys(Ie).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ie[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ie[g]}})});var Re=j5();Object.keys(Re).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Re[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Re[g]}})});var nt=_5();Object.keys(nt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===nt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return nt[g]}})});var Xe=Kee();Object.keys(Xe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xe[g]}})});var ht=P5();Object.keys(ht).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ht[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ht[g]}})});var Bt=M5();Object.keys(Bt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bt[g]}})});var lt=E5();Object.keys(lt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===lt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return lt[g]}})});var Wt=ote();Object.keys(Wt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wt[g]}})});var Yt=lte();Object.keys(Yt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yt[g]}})});var Qt=cte();Object.keys(Qt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qt[g]}})});var Gt=dte();Object.keys(Gt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gt[g]}})});var ln=ute();Object.keys(ln).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ln[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ln[g]}})});var rn=fte();Object.keys(rn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===rn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return rn[g]}})});var Et=hte();Object.keys(Et).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Et[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Et[g]}})});var qn=mte();Object.keys(qn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qn[g]}})});var sr=pte();Object.keys(sr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===sr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return sr[g]}})});var vn=gte();Object.keys(vn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vn[g]}})});var it=D5();Object.keys(it).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===it[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return it[g]}})});var dn=Cy();Object.keys(dn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dn[g]}})});var ir=N5();Object.keys(ir).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ir[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ir[g]}})});var ks=O5();Object.keys(ks).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ks[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ks[g]}})});var Ps=xte();Object.keys(Ps).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ps[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ps[g]}})});var In=yte();Object.keys(In).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===In[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return In[g]}})});var Ms=A5();Object.keys(Ms).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ms[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ms[g]}})});var Es=vte();Object.keys(Es).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Es[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Es[g]}})});var Er=R5();Object.keys(Er).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Er[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Er[g]}})});var ei=i1();Object.keys(ei).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ei[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ei[g]}})});var Eo=Cu();Object.keys(Eo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Eo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Eo[g]}})});var sa=bte();Object.keys(sa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===sa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return sa[g]}})});var hd=wte();Object.keys(hd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hd[g]}})});var fr=_te();Object.keys(fr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fr[g]}})});var dt=jte();Object.keys(dt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dt[g]}})});var ia=Ste();Object.keys(ia).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ia[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ia[g]}})});var za=g5();Object.keys(za).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===za[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return za[g]}})});var Al=Nte();Object.keys(Al).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Al[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Al[g]}})});var Rl=Cte();Object.keys(Rl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rl[g]}})});var Do=Tte();Object.keys(Do).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Do[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Do[g]}})});var Ds=o1();Object.keys(Ds).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ds[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ds[g]}})});var ti=kte();Object.keys(ti).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ti[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ti[g]}})});var Oo=Ny();Object.keys(Oo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oo[g]}})});var md=Pte();Object.keys(md).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===md[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return md[g]}})});var Ll=Mte();Object.keys(Ll).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ll[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ll[g]}})});var Fl=Ete();Object.keys(Fl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fl[g]}})});var ql=Dte();Object.keys(ql).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ql[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ql[g]}})});var Io=Ote();Object.keys(Io).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Io[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Io[g]}})});var pd=Ite();Object.keys(pd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pd[g]}})});var Ua=Ate();Object.keys(Ua).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ua[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ua[g]}})});var Pn=Rte();Object.keys(Pn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pn[g]}})});var gd=Lte();Object.keys(gd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gd[g]}})});var Ao=Fte();Object.keys(Ao).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ao[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ao[g]}})});var zl=qte();Object.keys(zl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zl[g]}})});var Ba=m5();Object.keys(Ba).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ba[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ba[g]}})});var Ro=zte();Object.keys(Ro).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ro[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ro[g]}})});var Si=Ute();Object.keys(Si).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Si[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Si[g]}})});var aa=Bte();Object.keys(aa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===aa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return aa[g]}})});var Fr=Vte();Object.keys(Fr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fr[g]}})});var oa=Wte();Object.keys(oa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oa[g]}})});var Dt=v5();Object.keys(Dt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Dt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Dt[g]}})});var jn=I5();Object.keys(jn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===jn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return jn[g]}})});var Va=jne();Object.keys(Va).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Va[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Va[g]}})});var Ni=Sne();Object.keys(Ni).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ni[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ni[g]}})});var fs=Nne();Object.keys(fs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fs[g]}})});var Ci=Um();Object.keys(Ci).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ci[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ci[g]}})});var Mt=$5();Object.keys(Mt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mt[g]}})});var bn=H5();Object.keys(bn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bn[g]}})});var Lo=Cne();Object.keys(Lo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Lo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Lo[g]}})});var Wa=Y5();Object.keys(Wa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wa[g]}})});var hr=G5();Object.keys(hr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hr[g]}})});var Ul=Z5();Object.keys(Ul).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ul[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ul[g]}})});var Ti=J5();Object.keys(Ti).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ti[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ti[g]}})});var qr=l1();Object.keys(qr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qr[g]}})});var An=Q5();Object.keys(An).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===An[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return An[g]}})});var hs=i5();Object.keys(hs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hs[g]}})});var Jt=a5();Object.keys(Jt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jt[g]}})});var ki=Tne();Object.keys(ki).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ki[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ki[g]}})});var $a=kne();Object.keys($a).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$a[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $a[g]}})});var ni=Pne();Object.keys(ni).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ni[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ni[g]}})});var Ha=Mne();Object.keys(Ha).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ha[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ha[g]}})});var Ya=Ene();Object.keys(Ya).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ya[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ya[g]}})});var la=Dne();Object.keys(la).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===la[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return la[g]}})});var ca=One();Object.keys(ca).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ca[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ca[g]}})});var Pi=Ine();Object.keys(Pi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pi[g]}})});var zr=Ane();Object.keys(zr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zr[g]}})});var ms=Rne();Object.keys(ms).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ms[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ms[g]}})});var Jr=Lne();Object.keys(Jr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jr[g]}})});var da=Fne();Object.keys(da).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===da[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return da[g]}})});var Ct=od();Object.keys(Ct).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ct[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ct[g]}})});var Gn=qne();Object.keys(Gn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gn[g]}})});var un=yy();Object.keys(un).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===un[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return un[g]}})});var Fo=zne();Object.keys(Fo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fo[g]}})});var ri=Une();Object.keys(ri).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ri[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ri[g]}})});var qo=Bne();Object.keys(qo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qo[g]}})});var Ga=Vne();Object.keys(Ga).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ga[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ga[g]}})});var Qr=Wne();Object.keys(Qr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qr[g]}})});var Za=L5();Object.keys(Za).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Za[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Za[g]}})});var ua=$ne();Object.keys(ua).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ua[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ua[g]}})});var Mn=X5();Object.keys(Mn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mn[g]}})});var Ur=Hne();Object.keys(Ur).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ur[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ur[g]}})});var si=Yne();Object.keys(si).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===si[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return si[g]}})});var fa=f5();Object.keys(fa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fa[g]}})});var xd=Gne();Object.keys(xd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xd[g]}})});var Bl=Zne();Object.keys(Bl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bl[g]}})});var ha=Kne();Object.keys(ha).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ha[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ha[g]}})});var Ka=Jne();Object.keys(Ka).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ka[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ka[g]}})});var Ja=h5();Object.keys(Ja).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ja[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ja[g]}})});var Ht=Qne();Object.keys(Ht).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ht[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ht[g]}})});var Os=Xne();Object.keys(Os).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Os[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Os[g]}})});var _r=ere();Object.keys(_r).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_r[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _r[g]}})});var Is=tre();Object.keys(Is).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Is[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Is[g]}})});var zo=nre();Object.keys(zo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zo[g]}})});var Qa=cd();Object.keys(Qa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qa[g]}})});var Mi=rre();Object.keys(Mi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mi[g]}})});var Vl=sre();Object.keys(Vl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vl[g]}})});var mr=ire();Object.keys(mr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===mr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return mr[g]}})});var Ei=are();Object.keys(Ei).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ei[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ei[g]}})});var Uo=ore();Object.keys(Uo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Uo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Uo[g]}})});var ii=lre();Object.keys(ii).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ii[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ii[g]}})});var yd=cre();Object.keys(yd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===yd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return yd[g]}})});var Dr=V5();Object.keys(Dr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Dr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Dr[g]}})});var Bo=dre();Object.keys(Bo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bo[g]}})});var Di=ure();Object.keys(Di).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Di[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Di[g]}})});var Br=dd();Object.keys(Br).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Br[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Br[g]}})});var Vo=fre();Object.keys(Vo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vo[g]}})});var Wl=hre();Object.keys(Wl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wl[g]}})});var Wo=mre();Object.keys(Wo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wo[g]}})});var vd=pre();Object.keys(vd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vd[g]}})});var Xa=gre();Object.keys(Xa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xa[g]}})});var $l=xre();Object.keys($l).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$l[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $l[g]}})});var bd=yre();Object.keys(bd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bd[g]}})});var wd=vre();Object.keys(wd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wd[g]}})});var $o=bre();Object.keys($o).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$o[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $o[g]}})});var _d=wre();Object.keys(_d).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_d[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _d[g]}})});var Ho=_re();Object.keys(Ho).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ho[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ho[g]}})});var Hl=jre();Object.keys(Hl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Hl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Hl[g]}})});var eo=Sre();Object.keys(eo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===eo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return eo[g]}})});var ai=Nre();Object.keys(ai).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ai[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ai[g]}})});var jd=Cre();Object.keys(jd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===jd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return jd[g]}})});var oi=Tre();Object.keys(oi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oi[g]}})});var Or=Ty();Object.keys(Or).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Or[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Or[g]}})});var Yl=kre();Object.keys(Yl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yl[g]}})});var Gl=Pre();Object.keys(Gl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gl[g]}})});var Zl=Mre();Object.keys(Zl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zl[g]}})});var Yo=B5();Object.keys(Yo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yo[g]}})});var Go=U5();Object.keys(Go).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Go[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Go[g]}})});var Sd=l5();Object.keys(Sd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Sd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Sd[g]}})});var Nd=Ere();Object.keys(Nd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Nd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Nd[g]}})});var Kl=Dre();Object.keys(Kl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Kl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Kl[g]}})});var Cd=c1();Object.keys(Cd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Cd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Cd[g]}})});var Vr=Ore();Object.keys(Vr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vr[g]}})});var As=Ire();Object.keys(As).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===As[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return As[g]}})});var ma=z5();Object.keys(ma).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ma[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ma[g]}})});var ps=Are();Object.keys(ps).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ps[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ps[g]}})});var Jl=Rre();Object.keys(Jl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jl[g]}})});var li=vy();Object.keys(li).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===li[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return li[g]}})});var Ql=Lre();Object.keys(Ql).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ql[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ql[g]}})});var Oi=W5();Object.keys(Oi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oi[g]}})});var Zo=Il();Object.keys(Zo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zo[g]}})});var gs=zm();Object.keys(gs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gs[g]}})});var Td=t1();Object.keys(Td).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Td[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Td[g]}})});var Rs=Sy();Object.keys(Rs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rs[g]}})});var to=n1();Object.keys(to).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===to[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return to[g]}})});var Xl=K5();Object.keys(Xl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xl[g]}})});var no=Fre();Object.keys(no).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===no[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return no[g]}})});var pa=qre();Object.keys(pa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pa[g]}})});var jr=Mo();Object.keys(jr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===jr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return jr[g]}})});var kd=a1();Object.keys(kd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===kd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return kd[g]}})});var xs=s1();Object.keys(xs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xs[g]}})});var Pd=zre();Object.keys(Pd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pd[g]}})});var Xr=Ure();Object.keys(Xr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xr[g]}})});var Ii=Bre();Object.keys(Ii).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ii[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ii[g]}})});var ro=ky();Object.keys(ro).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ro[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ro[g]}})});var so=Vre();Object.keys(so).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===so[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return so[g]}})});var ga=y5();Object.keys(ga).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ga[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ga[g]}})});var io=Wre();Object.keys(io).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===io[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return io[g]}})});var ao=$re();Object.keys(ao).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ao[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ao[g]}})});var Ai=e6();Object.keys(Ai).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ai[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ai[g]}})});var oo=Hre();Object.keys(oo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oo[g]}})});var Ko=Yre();Object.keys(Ko).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ko[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ko[g]}})});var ec=Gre();Object.keys(ec).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ec[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ec[g]}})});var Wr=Zre();Object.keys(Wr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wr[g]}})});var Ls=Fe();Object.keys(Ls).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ls[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ls[g]}})});var tc=F5();Object.keys(tc).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===tc[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return tc[g]}})});var Jo=Kre();Object.keys(Jo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jo[g]}})});var nc=Jre();Object.keys(nc).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===nc[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return nc[g]}})});var Qo=Qre();Object.keys(Qo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qo[g]}})});var Xo=Xre();Object.keys(Xo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xo[g]}})})})(zb)),zb}var oR;function Py(){if(oR)return Yd;oR=1,Object.defineProperty(Yd,"__esModule",{value:!0}),Yd.rangeShape=Yd.default=void 0;var n=o(Qs()),e=s(Dl()),t=s(Nu()),r=Tu();function s(v){return v&&v.__esModule?v:{default:v}}function a(v){if(typeof WeakMap!="function")return null;var b=new WeakMap,_=new WeakMap;return(a=function(j){return j?_:b})(v)}function o(v,b){if(v&&v.__esModule)return v;if(v===null||typeof v!="object"&&typeof v!="function")return{default:v};var _=a(b);if(_&&_.has(v))return _.get(v);var j={__proto__:null},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in v)if(P!=="default"&&Object.prototype.hasOwnProperty.call(v,P)){var O=C?Object.getOwnPropertyDescriptor(v,P):null;O&&(O.get||O.set)?Object.defineProperty(j,P,O):j[P]=v[P]}return j.default=v,_&&_.set(v,j),j}function l(){return l=Object.assign?Object.assign.bind():function(v){for(var b=1;b<arguments.length;b++){var _=arguments[b];for(var j in _)Object.prototype.hasOwnProperty.call(_,j)&&(v[j]=_[j])}return v},l.apply(this,arguments)}function c(v,b,_){return b=d(b),b in v?Object.defineProperty(v,b,{value:_,enumerable:!0,configurable:!0,writable:!0}):v[b]=_,v}function d(v){var b=h(v,"string");return typeof b=="symbol"?b:String(b)}function h(v,b){if(typeof v!="object"||!v)return v;var _=v[Symbol.toPrimitive];if(_!==void 0){var j=_.call(v,b);if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(b==="string"?String:Number)(v)}let p=class extends n.Component{constructor(b,_){super(b,_),c(this,"handleKeyEvent",j=>{const{day:C,onMouseDown:P,onMouseUp:O}=this.props;[13,32].includes(j.keyCode)&&(j.type==="keydown"?P(C):O(C))}),c(this,"handleMouseEvent",j=>{const{day:C,disabled:P,onPreviewChange:O,onMouseEnter:M,onMouseDown:D,onMouseUp:I}=this.props,F={};if(P){O();return}switch(j.type){case"mouseenter":M(C),O(C),F.hover=!0;break;case"blur":case"mouseleave":F.hover=!1;break;case"mousedown":F.active=!0,D(C);break;case"mouseup":j.stopPropagation(),F.active=!1,I(C);break;case"focus":O(C);break}Object.keys(F).length&&this.setState(F)}),c(this,"getClassNames",()=>{const{isPassive:j,isToday:C,isWeekend:P,isStartOfWeek:O,isEndOfWeek:M,isStartOfMonth:D,isEndOfMonth:I,disabled:F,styles:q}=this.props;return(0,t.default)(q.day,{[q.dayPassive]:j,[q.dayDisabled]:F,[q.dayToday]:C,[q.dayWeekend]:P,[q.dayStartOfWeek]:O,[q.dayEndOfWeek]:M,[q.dayStartOfMonth]:D,[q.dayEndOfMonth]:I,[q.dayHovered]:this.state.hover,[q.dayActive]:this.state.active})}),c(this,"renderPreviewPlaceholder",()=>{const{preview:j,day:C,styles:P}=this.props;if(!j)return null;const O=j.startDate?(0,r.endOfDay)(j.startDate):null,M=j.endDate?(0,r.startOfDay)(j.endDate):null,D=(!O||(0,r.isAfter)(C,O))&&(!M||(0,r.isBefore)(C,M)),I=!D&&(0,r.isSameDay)(C,O),F=!D&&(0,r.isSameDay)(C,M);return n.default.createElement("span",{className:(0,t.default)({[P.dayStartPreview]:I,[P.dayInPreview]:D,[P.dayEndPreview]:F}),style:{color:j.color}})}),c(this,"renderSelectionPlaceholders",()=>{const{styles:j,ranges:C,day:P}=this.props;return this.props.displayMode==="date"?(0,r.isSameDay)(this.props.day,this.props.date)?n.default.createElement("span",{className:j.selected,style:{color:this.props.color}}):null:C.reduce((M,D)=>{let I=D.startDate,F=D.endDate;I&&F&&(0,r.isBefore)(F,I)&&([I,F]=[F,I]),I=I?(0,r.endOfDay)(I):null,F=F?(0,r.startOfDay)(F):null;const q=(!I||(0,r.isAfter)(P,I))&&(!F||(0,r.isBefore)(P,F)),U=!q&&(0,r.isSameDay)(P,I),B=!q&&(0,r.isSameDay)(P,F);return q||U||B?[...M,{isStartEdge:U,isEndEdge:B,isInRange:q,...D}]:M},[]).map((M,D)=>n.default.createElement("span",{key:D,className:(0,t.default)({[j.startEdge]:M.isStartEdge,[j.endEdge]:M.isEndEdge,[j.inRange]:M.isInRange}),style:{color:M.color||this.props.color}}))}),this.state={hover:!1,active:!1}}render(){const{dayContentRenderer:b}=this.props;return n.default.createElement("button",l({type:"button",onMouseEnter:this.handleMouseEvent,onMouseLeave:this.handleMouseEvent,onFocus:this.handleMouseEvent,onMouseDown:this.handleMouseEvent,onMouseUp:this.handleMouseEvent,onBlur:this.handleMouseEvent,onPauseCapture:this.handleMouseEvent,onKeyDown:this.handleKeyEvent,onKeyUp:this.handleKeyEvent,className:this.getClassNames(this.props.styles)},this.props.disabled||this.props.isPassive?{tabIndex:-1}:{},{style:{color:this.props.color}}),this.renderSelectionPlaceholders(),this.renderPreviewPlaceholder(),n.default.createElement("span",{className:this.props.styles.dayNumber},b?.(this.props.day)||n.default.createElement("span",null,(0,r.format)(this.props.day,this.props.dayDisplayFormat))))}};p.defaultProps={};const x=Yd.rangeShape=e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string,key:e.default.string,autoFocus:e.default.bool,disabled:e.default.bool,showDateDisplay:e.default.bool});return p.propTypes={day:e.default.object.isRequired,dayDisplayFormat:e.default.string,date:e.default.object,ranges:e.default.arrayOf(x),preview:e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string}),onPreviewChange:e.default.func,previewColor:e.default.string,disabled:e.default.bool,isPassive:e.default.bool,isToday:e.default.bool,isWeekend:e.default.bool,isStartOfWeek:e.default.bool,isEndOfWeek:e.default.bool,isStartOfMonth:e.default.bool,isEndOfMonth:e.default.bool,color:e.default.string,displayMode:e.default.oneOf(["dateRange","date"]),styles:e.default.object,onMouseDown:e.default.func,onMouseUp:e.default.func,onMouseEnter:e.default.func,dayContentRenderer:e.default.func},Yd.default=p,Yd}var Eh={},Gd={},lR;function My(){if(lR)return Gd;lR=1,Object.defineProperty(Gd,"__esModule",{value:!0}),Gd.calcFocusDate=r,Gd.findNextRangeIndex=s,Gd.generateStyles=o,Gd.getMonthDisplayRange=a;var n=t(Nu()),e=Tu();function t(l){return l&&l.__esModule?l:{default:l}}function r(l,c){const{shownDate:d,date:h,months:p,ranges:x,focusedRange:v,displayMode:b}=c;let _;if(b==="dateRange"){const C=x[v[0]]||{};_={start:C.startDate,end:C.endDate}}else _={start:h,end:h};_.start=(0,e.startOfMonth)(_.start||new Date),_.end=(0,e.endOfMonth)(_.end||_.start);const j=_.start||_.end||d||new Date;return l?(0,e.differenceInCalendarMonths)(_.start,_.end)>p?l:j:d||j}function s(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const d=l.findIndex((h,p)=>p>c&&h.autoFocus!==!1&&!h.disabled);return d!==-1?d:l.findIndex(h=>h.autoFocus!==!1&&!h.disabled)}function a(l,c,d){const h=(0,e.startOfMonth)(l,c),p=(0,e.endOfMonth)(l,c),x=(0,e.startOfWeek)(h,c);let v=(0,e.endOfWeek)(p,c);return d&&(0,e.differenceInCalendarDays)(v,x)<=34&&(v=(0,e.addDays)(v,7)),{start:x,end:v,startDateOfMonth:h,endDateOfMonth:p}}function o(l){return l.length?l.filter(d=>!!d).reduce((d,h)=>(Object.keys(h).forEach(p=>{d[p]=(0,n.default)(d[p],h[p])}),d),{}):{}}return Gd}var cR;function ese(){if(cR)return Eh;cR=1,Object.defineProperty(Eh,"__esModule",{value:!0}),Eh.default=void 0;var n=l(Qs()),e=a(Dl()),t=l(Py()),r=Tu(),s=My();function a(p){return p&&p.__esModule?p:{default:p}}function o(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(o=function(b){return b?v:x})(p)}function l(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=o(x);if(v&&v.has(p))return v.get(p);var b={__proto__:null},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var C=_?Object.getOwnPropertyDescriptor(p,j):null;C&&(C.get||C.set)?Object.defineProperty(b,j,C):b[j]=p[j]}return b.default=p,v&&v.set(p,b),b}function c(){return c=Object.assign?Object.assign.bind():function(p){for(var x=1;x<arguments.length;x++){var v=arguments[x];for(var b in v)Object.prototype.hasOwnProperty.call(v,b)&&(p[b]=v[b])}return p},c.apply(this,arguments)}function d(p,x,v){const b=new Date;return n.default.createElement("div",{className:p.weekDays},(0,r.eachDayOfInterval)({start:(0,r.startOfWeek)(b,x),end:(0,r.endOfWeek)(b,x)}).map((_,j)=>n.default.createElement("span",{className:p.weekDay,key:j},(0,r.format)(_,v,x))))}let h=class extends n.PureComponent{render(){const x=new Date,{displayMode:v,focusedRange:b,drag:_,styles:j,disabledDates:C,disabledDay:P}=this.props,O=this.props.minDate&&(0,r.startOfDay)(this.props.minDate),M=this.props.maxDate&&(0,r.endOfDay)(this.props.maxDate),D=(0,s.getMonthDisplayRange)(this.props.month,this.props.dateOptions,this.props.fixedHeight);let I=this.props.ranges;if(v==="dateRange"&&_.status){let{startDate:q,endDate:U}=_.range;I=I.map((B,W)=>W!==b[0]?B:{...B,startDate:q,endDate:U})}const F=this.props.showPreview&&!_.disablePreview;return n.default.createElement("div",{className:j.month,style:this.props.style},this.props.showMonthName?n.default.createElement("div",{className:j.monthName},(0,r.format)(this.props.month,this.props.monthDisplayFormat,this.props.dateOptions)):null,this.props.showWeekDays&&d(j,this.props.dateOptions,this.props.weekdayDisplayFormat),n.default.createElement("div",{className:j.days,onMouseLeave:this.props.onMouseLeave},(0,r.eachDayOfInterval)({start:D.start,end:D.end}).map((q,U)=>{const B=(0,r.isSameDay)(q,D.startDateOfMonth),W=(0,r.isSameDay)(q,D.endDateOfMonth),Y=O&&(0,r.isBefore)(q,O)||M&&(0,r.isAfter)(q,M),G=C.some(oe=>(0,r.isSameDay)(oe,q)),Z=P(q);return n.default.createElement(t.default,c({},this.props,{ranges:I,day:q,preview:F?this.props.preview:null,isWeekend:(0,r.isWeekend)(q,this.props.dateOptions),isToday:(0,r.isSameDay)(q,x),isStartOfWeek:(0,r.isSameDay)(q,(0,r.startOfWeek)(q,this.props.dateOptions)),isEndOfWeek:(0,r.isSameDay)(q,(0,r.endOfWeek)(q,this.props.dateOptions)),isStartOfMonth:B,isEndOfMonth:W,key:U,disabled:Y||G||Z,isPassive:!(0,r.isWithinInterval)(q,{start:D.startDateOfMonth,end:D.endDateOfMonth}),styles:j,onMouseDown:this.props.onDragSelectionStart,onMouseUp:this.props.onDragSelectionEnd,onMouseEnter:this.props.onDragSelectionMove,dragRange:_.range,drag:_.status}))})))}};return h.defaultProps={},h.propTypes={style:e.default.object,styles:e.default.object,month:e.default.object,drag:e.default.object,dateOptions:e.default.object,disabledDates:e.default.array,disabledDay:e.default.func,preview:e.default.shape({startDate:e.default.object,endDate:e.default.object}),showPreview:e.default.bool,displayMode:e.default.oneOf(["dateRange","date"]),minDate:e.default.object,maxDate:e.default.object,ranges:e.default.arrayOf(t.rangeShape),focusedRange:e.default.arrayOf(e.default.number),onDragSelectionStart:e.default.func,onDragSelectionEnd:e.default.func,onDragSelectionMove:e.default.func,onMouseLeave:e.default.func,monthDisplayFormat:e.default.string,weekdayDisplayFormat:e.default.string,dayDisplayFormat:e.default.string,showWeekDays:e.default.bool,showMonthName:e.default.bool,fixedHeight:e.default.bool},Eh.default=h,Eh}var Dh={},dR;function tse(){if(dR)return Dh;dR=1,Object.defineProperty(Dh,"__esModule",{value:!0}),Dh.default=void 0;var n=o(Qs()),e=s(Dl()),t=s(Nu()),r=Tu();function s(p){return p&&p.__esModule?p:{default:p}}function a(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(a=function(b){return b?v:x})(p)}function o(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=a(x);if(v&&v.has(p))return v.get(p);var b={__proto__:null},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var C=_?Object.getOwnPropertyDescriptor(p,j):null;C&&(C.get||C.set)?Object.defineProperty(b,j,C):b[j]=p[j]}return b.default=p,v&&v.set(p,b),b}function l(p,x,v){return x=c(x),x in p?Object.defineProperty(p,x,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[x]=v,p}function c(p){var x=d(p,"string");return typeof x=="symbol"?x:String(x)}function d(p,x){if(typeof p!="object"||!p)return p;var v=p[Symbol.toPrimitive];if(v!==void 0){var b=v.call(p,x);if(typeof b!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(p)}let h=class extends n.PureComponent{constructor(x,v){super(x,v),l(this,"onKeyDown",b=>{const{value:_}=this.state;b.key==="Enter"&&this.update(_)}),l(this,"onChange",b=>{this.setState({value:b.target.value,changed:!0,invalid:!1})}),l(this,"onBlur",()=>{const{value:b}=this.state;this.update(b)}),this.state={invalid:!1,changed:!1,value:this.formatDate(x)}}componentDidUpdate(x){const{value:v}=x;(0,r.isEqual)(v,this.props.value)||this.setState({value:this.formatDate(this.props)})}formatDate(x){let{value:v,dateDisplayFormat:b,dateOptions:_}=x;return v&&(0,r.isValid)(v)?(0,r.format)(v,b,_):""}update(x){const{invalid:v,changed:b}=this.state;if(v||!b||!x)return;const{onChange:_,dateDisplayFormat:j,dateOptions:C}=this.props,P=(0,r.parse)(x,j,new Date,C);(0,r.isValid)(P)?this.setState({changed:!1},()=>_(P)):this.setState({invalid:!0})}render(){const{className:x,readOnly:v,placeholder:b,ariaLabel:_,disabled:j,onFocus:C}=this.props,{value:P,invalid:O}=this.state;return n.default.createElement("span",{className:(0,t.default)("rdrDateInput",x)},n.default.createElement("input",{readOnly:v,disabled:j,value:P,placeholder:b,"aria-label":_,onKeyDown:this.onKeyDown,onChange:this.onChange,onBlur:this.onBlur,onFocus:C}),O&&n.default.createElement("span",{className:"rdrWarning"},""))}};return h.propTypes={value:e.default.object,placeholder:e.default.string,disabled:e.default.bool,readOnly:e.default.bool,dateOptions:e.default.object,dateDisplayFormat:e.default.string,ariaLabel:e.default.string,className:e.default.string,onFocus:e.default.func.isRequired,onChange:e.default.func.isRequired},h.defaultProps={readOnly:!0,disabled:!1,dateDisplayFormat:"MMM D, YYYY"},Dh.default=h,Dh}var zg={},uR;function nse(){return uR||(uR=1,(function(n){(function(e,t){t(n,Qs(),r4())})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:zg,function(e,t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function s(ae){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(le){return typeof le}:function(le){return le&&typeof Symbol=="function"&&le.constructor===Symbol&&le!==Symbol.prototype?"symbol":typeof le},s(ae)}function a(ae,le){if(!(ae instanceof le))throw new TypeError("Cannot call a class as a function")}function o(ae,le){for(var ue=0;ue<le.length;ue++){var ie=le[ue];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(ae,P(ie.key),ie)}}function l(ae,le,ue){return le&&o(ae.prototype,le),ue&&o(ae,ue),Object.defineProperty(ae,"prototype",{writable:!1}),ae}function c(ae,le,ue){return le=x(le),d(ae,p()?Reflect.construct(le,ue||[],x(ae).constructor):le.apply(ae,ue))}function d(ae,le){if(le&&(s(le)=="object"||typeof le=="function"))return le;if(le!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(ae)}function h(ae){if(ae===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ae}function p(){try{var ae=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(p=function(){return!!ae})()}function x(ae){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(le){return le.__proto__||Object.getPrototypeOf(le)},x(ae)}function v(ae,le){if(typeof le!="function"&&le!==null)throw new TypeError("Super expression must either be null or a function");ae.prototype=Object.create(le&&le.prototype,{constructor:{value:ae,writable:!0,configurable:!0}}),Object.defineProperty(ae,"prototype",{writable:!1}),le&&b(ae,le)}function b(ae,le){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ue,ie){return ue.__proto__=ie,ue},b(ae,le)}function _(ae,le){var ue=Object.keys(ae);if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(ae);le&&(ie=ie.filter(function(pe){return Object.getOwnPropertyDescriptor(ae,pe).enumerable})),ue.push.apply(ue,ie)}return ue}function j(ae){for(var le=1;le<arguments.length;le++){var ue=arguments[le]!=null?arguments[le]:{};le%2?_(Object(ue),!0).forEach(function(ie){C(ae,ie,ue[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ae,Object.getOwnPropertyDescriptors(ue)):_(Object(ue)).forEach(function(ie){Object.defineProperty(ae,ie,Object.getOwnPropertyDescriptor(ue,ie))})}return ae}function C(ae,le,ue){return(le=P(le))in ae?Object.defineProperty(ae,le,{value:ue,enumerable:!0,configurable:!0,writable:!0}):ae[le]=ue,ae}function P(ae){var le=O(ae,"string");return s(le)=="symbol"?le:le+""}function O(ae,le){if(s(ae)!="object"||!ae)return ae;var ue=ae[Symbol.toPrimitive];if(ue!==void 0){var ie=ue.call(ae,le);if(s(ie)!="object")return ie;throw new TypeError("@@toPrimitive must return a primitive value.")}return(le==="string"?String:Number)(ae)}var M={x:"clientWidth",y:"clientHeight"},D={x:"clientTop",y:"clientLeft"},I={x:"innerWidth",y:"innerHeight"},F={x:"offsetWidth",y:"offsetHeight"},q={x:"offsetLeft",y:"offsetTop"},U={x:"overflowX",y:"overflowY"},B={x:"scrollWidth",y:"scrollHeight"},W={x:"scrollLeft",y:"scrollTop"},Y={x:"width",y:"height"},G=function(){},Z=(function(){if(typeof window>"u")return!1;var ae=!1;try{document.createElement("div").addEventListener("test",G,{get passive(){return ae=!0,!1}})}catch{}return ae})()?{passive:!0}:!1,oe="ReactList failed to reach a stable state.",X=40,he=function(le,ue){for(var ie in ue)if(le[ie]!==ue[ie])return!1;return!0},$=function(le){for(var ue=le.props.axis,ie=le.getEl(),pe=U[ue];ie=ie.parentElement;)switch(window.getComputedStyle(ie)[pe]){case"auto":case"scroll":case"overlay":return ie}return window},K=function(le){var ue=le.props.axis,ie=le.scrollParent;return ie===window?window[I[ue]]:ie[M[ue]]},te=function(le,ue){var ie=le.length,pe=le.minSize,re=le.type,de=ue.from,je=ue.size,Ae=ue.itemsPerRow;je=Math.max(je,pe);var Te=je%Ae;return Te&&(je+=Ae-Te),je>ie&&(je=ie),de=re==="simple"||!de?0:Math.max(Math.min(de,ie-je),0),(Te=de%Ae)&&(de-=Te,je+=Te),de===ue.from&&je===ue.size?ue:j(j({},ue),{},{from:de,size:je})},H=e.default=(function(ae){function le(ue){var ie;return a(this,le),ie=c(this,le,[ue]),ie.state=te(ue,{itemsPerRow:1,from:ue.initialIndex,size:0}),ie.cache={},ie.cachedScrollPosition=null,ie.prevPrevState={},ie.unstable=!1,ie.updateCounter=0,ie}return v(le,ae),l(le,[{key:"componentDidMount",value:function(){this.updateFrameAndClearCache=this.updateFrameAndClearCache.bind(this),window.addEventListener("resize",this.updateFrameAndClearCache),this.updateFrame(this.scrollTo.bind(this,this.props.initialIndex))}},{key:"componentDidUpdate",value:function(ie){var pe=this;if(this.props.axis!==ie.axis&&this.clearSizeCache(),!this.unstable){if(++this.updateCounter>X)return this.unstable=!0,console.error(oe);this.updateCounterTimeoutId||(this.updateCounterTimeoutId=setTimeout(function(){pe.updateCounter=0,delete pe.updateCounterTimeoutId},0)),this.updateFrame()}}},{key:"maybeSetState",value:function(ie,pe){if(he(this.state,ie))return pe();this.setState(ie,pe)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateFrameAndClearCache),this.scrollParent.removeEventListener("scroll",this.updateFrameAndClearCache,Z),this.scrollParent.removeEventListener("mousewheel",G,Z)}},{key:"getOffset",value:function(ie){var pe=this.props.axis,re=ie[D[pe]]||0,de=q[pe];do re+=ie[de]||0;while(ie=ie.offsetParent);return re}},{key:"getEl",value:function(){return this.el||this.items}},{key:"getScrollPosition",value:function(){if(typeof this.cachedScrollPosition=="number")return this.cachedScrollPosition;var ie=this.scrollParent,pe=this.props.axis,re=W[pe],de=ie===window?document.body[re]||document.documentElement[re]:ie[re],je=this.getScrollSize()-this.props.scrollParentViewportSizeGetter(this),Ae=Math.max(0,Math.min(de,je)),Te=this.getEl();return this.cachedScrollPosition=this.getOffset(ie)+Ae-this.getOffset(Te),this.cachedScrollPosition}},{key:"setScroll",value:function(ie){var pe=this.scrollParent,re=this.props.axis;if(ie+=this.getOffset(this.getEl()),pe===window)return window.scrollTo(0,ie);ie-=this.getOffset(this.scrollParent),pe[W[re]]=ie}},{key:"getScrollSize",value:function(){var ie=this.scrollParent,pe=document,re=pe.body,de=pe.documentElement,je=B[this.props.axis];return ie===window?Math.max(re[je],de[je]):ie[je]}},{key:"hasDeterminateSize",value:function(){var ie=this.props,pe=ie.itemSizeGetter,re=ie.type;return re==="uniform"||pe}},{key:"getStartAndEnd",value:function(){var ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.threshold,pe=this.getScrollPosition(),re=Math.max(0,pe-ie),de=pe+this.props.scrollParentViewportSizeGetter(this)+ie;return this.hasDeterminateSize()&&(de=Math.min(de,this.getSpaceBefore(this.props.length))),{start:re,end:de}}},{key:"getItemSizeAndItemsPerRow",value:function(){var ie=this.props,pe=ie.axis,re=ie.useStaticSize,de=this.state,je=de.itemSize,Ae=de.itemsPerRow;if(re&&je&&Ae)return{itemSize:je,itemsPerRow:Ae};var Te=this.items.children;if(!Te.length)return{};var Se=Te[0],Pe=Se[F[pe]],qe=Math.abs(Pe-je);if((isNaN(qe)||qe>=1)&&(je=Pe),!je)return{};var He=q[pe],ze=Se[He];Ae=1;for(var be=Te[Ae];be&&be[He]===ze;be=Te[Ae])++Ae;return{itemSize:je,itemsPerRow:Ae}}},{key:"clearSizeCache",value:function(){this.cachedScrollPosition=null}},{key:"updateFrameAndClearCache",value:function(ie){return this.clearSizeCache(),this.updateFrame(ie)}},{key:"updateFrame",value:function(ie){switch(this.updateScrollParent(),typeof ie!="function"&&(ie=G),this.props.type){case"simple":return this.updateSimpleFrame(ie);case"variable":return this.updateVariableFrame(ie);case"uniform":return this.updateUniformFrame(ie)}}},{key:"updateScrollParent",value:function(){var ie=this.scrollParent;this.scrollParent=this.props.scrollParentGetter(this),ie!==this.scrollParent&&(ie&&(ie.removeEventListener("scroll",this.updateFrameAndClearCache),ie.removeEventListener("mousewheel",G)),this.clearSizeCache(),this.scrollParent.addEventListener("scroll",this.updateFrameAndClearCache,Z),this.scrollParent.addEventListener("mousewheel",G,Z))}},{key:"updateSimpleFrame",value:function(ie){var pe=this.getStartAndEnd(),re=pe.end,de=this.items.children,je=0;if(de.length){var Ae=this.props.axis,Te=de[0],Se=de[de.length-1];je=this.getOffset(Se)+Se[F[Ae]]-this.getOffset(Te)}if(je>re)return ie();var Pe=this.props,qe=Pe.pageSize,He=Pe.length,ze=Math.min(this.state.size+qe,He);this.maybeSetState({size:ze},ie)}},{key:"updateVariableFrame",value:function(ie){this.props.itemSizeGetter||this.cacheSizes();for(var pe=this.getStartAndEnd(),re=pe.start,de=pe.end,je=this.props,Ae=je.length,Te=je.pageSize,Se=0,Pe=0,qe=0,He=Ae-1;Pe<He;){var ze=this.getSizeOfItem(Pe);if(ze==null||Se+ze>re)break;Se+=ze,++Pe}for(var be=Ae-Pe;qe<be&&Se<de;){var Ue=this.getSizeOfItem(Pe+qe);if(Ue==null){qe=Math.min(qe+Te,be);break}Se+=Ue,++qe}this.maybeSetState(te(this.props,{from:Pe,itemsPerRow:1,size:qe}),ie)}},{key:"updateUniformFrame",value:function(ie){var pe=this.getItemSizeAndItemsPerRow(),re=pe.itemSize,de=pe.itemsPerRow;if(!re||!de)return ie();var je=this.getStartAndEnd(),Ae=je.start,Te=je.end,Se=te(this.props,{from:Math.floor(Ae/re)*de,size:(Math.ceil((Te-Ae)/re)+1)*de,itemsPerRow:de}),Pe=Se.from,qe=Se.size;return this.maybeSetState({itemsPerRow:de,from:Pe,itemSize:re,size:qe},ie)}},{key:"getSpaceBefore",value:function(ie){var pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(pe[ie]!=null)return pe[ie];var re=this.state,de=re.itemSize,je=re.itemsPerRow;if(de)return pe[ie]=Math.floor(ie/je)*de;for(var Ae=ie;Ae>0&&pe[--Ae]==null;);for(var Te=pe[Ae]||0,Se=Ae;Se<ie;++Se){pe[Se]=Te;var Pe=this.getSizeOfItem(Se);if(Pe==null)break;Te+=Pe}return pe[ie]=Te}},{key:"cacheSizes",value:function(){for(var ie=this.cache,pe=this.state.from,re=this.items.children,de=F[this.props.axis],je=0,Ae=re.length;je<Ae;++je)ie[pe+je]=re[je][de]}},{key:"getSizeOfItem",value:function(ie){var pe=this.cache,re=this.items,de=this.props,je=de.axis,Ae=de.itemSizeGetter,Te=de.itemSizeEstimator,Se=de.type,Pe=this.state,qe=Pe.from,He=Pe.itemSize,ze=Pe.size;if(He)return He;if(Ae)return Ae(ie);if(ie in pe)return pe[ie];if(Se==="simple"&&ie>=qe&&ie<qe+ze&&re){var be=re.children[ie-qe];if(be)return be[F[je]]}if(Te)return Te(ie,pe)}},{key:"scrollTo",value:function(ie){ie!=null&&this.setScroll(this.getSpaceBefore(ie))}},{key:"scrollAround",value:function(ie){var pe=this.getScrollPosition(),re=this.getSpaceBefore(ie),de=re-this.props.scrollParentViewportSizeGetter(this)+this.getSizeOfItem(ie),je=Math.min(de,re),Ae=Math.max(de,re);if(pe<=je)return this.setScroll(je);if(pe>Ae)return this.setScroll(Ae)}},{key:"getVisibleRange",value:function(){for(var ie=this.state,pe=ie.from,re=ie.size,de=this.getStartAndEnd(0),je=de.start,Ae=de.end,Te={},Se,Pe,qe=pe;qe<pe+re;++qe){var He=this.getSpaceBefore(qe,Te),ze=He+this.getSizeOfItem(qe);Se==null&&ze>je&&(Se=qe),Se!=null&&He<Ae&&(Pe=qe)}return[Se,Pe]}},{key:"renderItems",value:function(){for(var ie=this,pe=this.props,re=pe.itemRenderer,de=pe.itemsRenderer,je=this.state,Ae=je.from,Te=je.size,Se=[],Pe=0;Pe<Te;++Pe)Se.push(re(Ae+Pe,Pe));return de(Se,function(qe){return ie.items=qe})}},{key:"render",value:function(){var ie=this,pe=this.props,re=pe.axis,de=pe.length,je=pe.type,Ae=pe.useTranslate3d,Te=this.state,Se=Te.from,Pe=Te.itemsPerRow,qe=this.renderItems();if(je==="simple")return qe;var He={position:"relative"},ze={},be=Math.ceil(de/Pe)*Pe,Ue=this.getSpaceBefore(be,ze);Ue&&(He[Y[re]]=Ue,re==="x"&&(He.overflowX="hidden"));var Ve=this.getSpaceBefore(Se,ze),ee=re==="x"?Ve:0,se=re==="y"?Ve:0,xe=Ae?"translate3d(".concat(ee,"px, ").concat(se,"px, 0)"):"translate(".concat(ee,"px, ").concat(se,"px)"),ke={msTransform:xe,WebkitTransform:xe,transform:xe};return(0,r.jsx)("div",{style:He,ref:function(Re){return ie.el=Re},children:(0,r.jsx)("div",{style:ke,children:qe})})}}],[{key:"getDerivedStateFromProps",value:function(ie,pe){var re=te(ie,pe);return re===pe?null:re}}])})(t.Component);C(H,"displayName","ReactList"),C(H,"defaultProps",{axis:"y",itemRenderer:function(le,ue){return(0,r.jsx)("div",{children:le},ue)},itemsRenderer:function(le,ue){return(0,r.jsx)("div",{ref:ue,children:le})},length:0,minSize:1,pageSize:10,scrollParentGetter:$,scrollParentViewportSizeGetter:K,threshold:100,type:"simple",useStaticSize:!1,useTranslate3d:!1})})})(zg)),zg}function rse(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=Object.keys(n),r=Object.keys(e),s=t.length;if(r.length!==s)return!1;for(var a=0;a<s;a++){var o=t[a];if(n[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}function sse(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=n.length;if(e.length!==t)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}const ise=Object.freeze(Object.defineProperty({__proto__:null,shallowEqualArrays:sse,shallowEqualObjects:rse},Symbol.toStringTag,{value:"Module"})),ase=n4(ise);var Oh={},fR;function Ey(){return fR||(fR=1,Object.defineProperty(Oh,"__esModule",{value:!0}),Oh.default=void 0,Oh.default={dateRangeWrapper:"rdrDateRangeWrapper",calendarWrapper:"rdrCalendarWrapper",dateDisplay:"rdrDateDisplay",dateDisplayItem:"rdrDateDisplayItem",dateDisplayItemActive:"rdrDateDisplayItemActive",monthAndYearWrapper:"rdrMonthAndYearWrapper",monthAndYearPickers:"rdrMonthAndYearPickers",nextPrevButton:"rdrNextPrevButton",month:"rdrMonth",weekDays:"rdrWeekDays",weekDay:"rdrWeekDay",days:"rdrDays",day:"rdrDay",dayNumber:"rdrDayNumber",dayPassive:"rdrDayPassive",dayToday:"rdrDayToday",dayStartOfWeek:"rdrDayStartOfWeek",dayEndOfWeek:"rdrDayEndOfWeek",daySelected:"rdrDaySelected",dayDisabled:"rdrDayDisabled",dayStartOfMonth:"rdrDayStartOfMonth",dayEndOfMonth:"rdrDayEndOfMonth",dayWeekend:"rdrDayWeekend",dayStartPreview:"rdrDayStartPreview",dayInPreview:"rdrDayInPreview",dayEndPreview:"rdrDayEndPreview",dayHovered:"rdrDayHovered",dayActive:"rdrDayActive",inRange:"rdrInRange",endEdge:"rdrEndEdge",startEdge:"rdrStartEdge",prevButton:"rdrPprevButton",nextButton:"rdrNextButton",selected:"rdrSelected",months:"rdrMonths",monthPicker:"rdrMonthPicker",yearPicker:"rdrYearPicker",dateDisplayWrapper:"rdrDateDisplayWrapper",definedRangesWrapper:"rdrDefinedRangesWrapper",staticRanges:"rdrStaticRanges",staticRange:"rdrStaticRange",inputRanges:"rdrInputRanges",inputRange:"rdrInputRange",inputRangeInput:"rdrInputRangeInput",dateRangePickerWrapper:"rdrDateRangePickerWrapper",staticRangeLabel:"rdrStaticRangeLabel",staticRangeSelected:"rdrStaticRangeSelected",monthName:"rdrMonthName",infiniteMonths:"rdrInfiniteMonths",monthsVertical:"rdrMonthsVertical",monthsHorizontal:"rdrMonthsHorizontal"}),Oh}var Ih={},hR;function ose(){if(hR)return Ih;hR=1,Object.defineProperty(Ih,"__esModule",{value:!0}),Ih.ariaLabelsShape=void 0;var n=e(Dl());function e(t){return t&&t.__esModule?t:{default:t}}return Ih.ariaLabelsShape=n.default.shape({dateInput:n.default.objectOf(n.default.shape({startDate:n.default.string,endDate:n.default.string})),monthPicker:n.default.string,yearPicker:n.default.string,prevButton:n.default.string,nextButton:n.default.string}),Ih}var mR;function t6(){if(mR)return Ph;mR=1,Object.defineProperty(Ph,"__esModule",{value:!0}),Ph.default=void 0;var n=_(Qs()),e=v(Dl()),t=Py(),r=v(ese()),s=v(tse()),a=My(),o=v(Nu()),l=v(nse()),c=ase,d=Tu(),h=S5(),p=v(Ey()),x=ose();function v(D){return D&&D.__esModule?D:{default:D}}function b(D){if(typeof WeakMap!="function")return null;var I=new WeakMap,F=new WeakMap;return(b=function(q){return q?F:I})(D)}function _(D,I){if(D&&D.__esModule)return D;if(D===null||typeof D!="object"&&typeof D!="function")return{default:D};var F=b(I);if(F&&F.has(D))return F.get(D);var q={__proto__:null},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in D)if(B!=="default"&&Object.prototype.hasOwnProperty.call(D,B)){var W=U?Object.getOwnPropertyDescriptor(D,B):null;W&&(W.get||W.set)?Object.defineProperty(q,B,W):q[B]=D[B]}return q.default=D,F&&F.set(D,q),q}function j(){return j=Object.assign?Object.assign.bind():function(D){for(var I=1;I<arguments.length;I++){var F=arguments[I];for(var q in F)Object.prototype.hasOwnProperty.call(F,q)&&(D[q]=F[q])}return D},j.apply(this,arguments)}function C(D,I,F){return I=P(I),I in D?Object.defineProperty(D,I,{value:F,enumerable:!0,configurable:!0,writable:!0}):D[I]=F,D}function P(D){var I=O(D,"string");return typeof I=="symbol"?I:String(I)}function O(D,I){if(typeof D!="object"||!D)return D;var F=D[Symbol.toPrimitive];if(F!==void 0){var q=F.call(D,I);if(typeof q!="object")return q;throw new TypeError("@@toPrimitive must return a primitive value.")}return(I==="string"?String:Number)(D)}let M=class HN extends n.PureComponent{constructor(I,F){var q;super(I,F),q=this,C(this,"focusToDate",function(U){let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:q.props,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!B.scroll.enabled){if(W&&B.preventSnapRefocus){const Z=(0,d.differenceInCalendarMonths)(U,q.state.focusedDate),oe=B.calendarFocus==="forwards"&&Z>=0,X=B.calendarFocus==="backwards"&&Z<=0;if((oe||X)&&Math.abs(Z)<B.months)return}q.setState({focusedDate:U});return}const Y=(0,d.differenceInCalendarMonths)(U,B.minDate,q.dateOptions),G=q.list.getVisibleRange();W&&G.includes(Y)||(q.isFirstRender=!0,q.list.scrollTo(Y),q.setState({focusedDate:U}))}),C(this,"updateShownDate",function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:q.props;const B=U.scroll.enabled?{...U,months:q.list.getVisibleRange().length}:U,W=(0,a.calcFocusDate)(q.state.focusedDate,B);q.focusToDate(W,B)}),C(this,"updatePreview",U=>{if(!U){this.setState({preview:null});return}const B={startDate:U,endDate:U,color:this.props.color};this.setState({preview:B})}),C(this,"changeShownDate",function(U){let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"set";const{focusedDate:W}=q.state,{onShownDateChange:Y,minDate:G,maxDate:Z}=q.props,oe={monthOffset:()=>(0,d.addMonths)(W,U),setMonth:()=>(0,d.setMonth)(W,U),setYear:()=>(0,d.setYear)(W,U),set:()=>U},X=(0,d.min)([(0,d.max)([oe[B](),G]),Z]);q.focusToDate(X,q.props,!1),Y&&Y(X)}),C(this,"handleRangeFocusChange",(U,B)=>{this.props.onRangeFocusChange&&this.props.onRangeFocusChange([U,B])}),C(this,"handleScroll",()=>{const{onShownDateChange:U,minDate:B}=this.props,{focusedDate:W}=this.state,{isFirstRender:Y}=this,G=this.list.getVisibleRange();if(G[0]===void 0)return;const Z=(0,d.addMonths)(B,G[0]||0);!(0,d.isSameMonth)(Z,W)&&!Y&&(this.setState({focusedDate:Z}),U&&U(Z)),this.isFirstRender=!1}),C(this,"renderMonthAndYear",(U,B,W)=>{const{showMonthArrow:Y,minDate:G,maxDate:Z,showMonthAndYearPickers:oe,ariaLabels:X}=W,he=(Z||HN.defaultProps.maxDate).getFullYear(),$=(G||HN.defaultProps.minDate).getFullYear(),K=this.styles;return n.default.createElement("div",{onMouseUp:te=>te.stopPropagation(),className:K.monthAndYearWrapper},Y?n.default.createElement("button",{type:"button",className:(0,o.default)(K.nextPrevButton,K.prevButton),onClick:()=>B(-1,"monthOffset"),"aria-label":X.prevButton},n.default.createElement("i",null)):null,oe?n.default.createElement("span",{className:K.monthAndYearPickers},n.default.createElement("span",{className:K.monthPicker},n.default.createElement("select",{value:U.getMonth(),onChange:te=>B(te.target.value,"setMonth"),"aria-label":X.monthPicker},this.state.monthNames.map((te,H)=>n.default.createElement("option",{key:H,value:H},te)))),n.default.createElement("span",{className:K.monthAndYearDivider}),n.default.createElement("span",{className:K.yearPicker},n.default.createElement("select",{value:U.getFullYear(),onChange:te=>B(te.target.value,"setYear"),"aria-label":X.yearPicker},new Array(he-$+1).fill(he).map((te,H)=>{const ae=te-H;return n.default.createElement("option",{key:ae,value:ae},ae)})))):n.default.createElement("span",{className:K.monthAndYearPickers},this.state.monthNames[U.getMonth()]," ",U.getFullYear()),Y?n.default.createElement("button",{type:"button",className:(0,o.default)(K.nextPrevButton,K.nextButton),onClick:()=>B(1,"monthOffset"),"aria-label":X.nextButton},n.default.createElement("i",null)):null)}),C(this,"renderDateDisplay",()=>{const{focusedRange:U,color:B,ranges:W,rangeColors:Y,dateDisplayFormat:G,editableDateInputs:Z,startDatePlaceholder:oe,endDatePlaceholder:X,ariaLabels:he}=this.props,$=Y[U[0]]||B,K=this.styles;return n.default.createElement("div",{className:K.dateDisplayWrapper},W.map((te,H)=>te.showDateDisplay===!1||te.disabled&&!te.showDateDisplay?null:n.default.createElement("div",{className:K.dateDisplay,key:H,style:{color:te.color||$}},n.default.createElement(s.default,{className:(0,o.default)(K.dateDisplayItem,{[K.dateDisplayItemActive]:U[0]===H&&U[1]===0}),readOnly:!Z,disabled:te.disabled,value:te.startDate,placeholder:oe,dateOptions:this.dateOptions,dateDisplayFormat:G,ariaLabel:he.dateInput&&he.dateInput[te.key]&&he.dateInput[te.key].startDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(H,0)}),n.default.createElement(s.default,{className:(0,o.default)(K.dateDisplayItem,{[K.dateDisplayItemActive]:U[0]===H&&U[1]===1}),readOnly:!Z,disabled:te.disabled,value:te.endDate,placeholder:X,dateOptions:this.dateOptions,dateDisplayFormat:G,ariaLabel:he.dateInput&&he.dateInput[te.key]&&he.dateInput[te.key].endDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(H,1)}))))}),C(this,"onDragSelectionStart",U=>{const{onChange:B,dragSelectionEnabled:W}=this.props;W?this.setState({drag:{status:!0,range:{startDate:U,endDate:U},disablePreview:!0}}):B&&B(U)}),C(this,"onDragSelectionEnd",U=>{const{updateRange:B,displayMode:W,onChange:Y,dragSelectionEnabled:G}=this.props;if(!G)return;if(W==="date"||!this.state.drag.status){Y&&Y(U);return}const Z={startDate:this.state.drag.range.startDate,endDate:U};W!=="dateRange"||(0,d.isSameDay)(Z.startDate,U)?this.setState({drag:{status:!1,range:{}}},()=>Y&&Y(U)):this.setState({drag:{status:!1,range:{}}},()=>{B&&B(Z)})}),C(this,"onDragSelectionMove",U=>{const{drag:B}=this.state;!B.status||!this.props.dragSelectionEnabled||this.setState({drag:{status:B.status,range:{startDate:B.range.startDate,endDate:U},disablePreview:!0}})}),C(this,"estimateMonthSize",(U,B)=>{const{direction:W,minDate:Y}=this.props,{scrollArea:G}=this.state;if(B&&(this.listSizeCache=B,B[U]))return B[U];if(W==="horizontal")return G.monthWidth;const Z=(0,d.addMonths)(Y,U),{start:oe,end:X}=(0,a.getMonthDisplayRange)(Z,this.dateOptions);return(0,d.differenceInDays)(X,oe,this.dateOptions)+1>35?G.longMonthHeight:G.monthHeight}),this.dateOptions={locale:I.locale},I.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=I.weekStartsOn),this.styles=(0,a.generateStyles)([p.default,I.classNames]),this.listSizeCache={},this.isFirstRender=!0,this.state={monthNames:this.getMonthNames(),focusedDate:(0,a.calcFocusDate)(null,I),drag:{status:!1,range:{startDate:null,endDate:null},disablePreview:!1},scrollArea:this.calcScrollArea(I)}}getMonthNames(){return[...Array(12).keys()].map(I=>this.props.locale.localize.month(I))}calcScrollArea(I){const{direction:F,months:q,scroll:U}=I;if(!U.enabled)return{enabled:!1};const B=U.longMonthHeight||U.monthHeight;return F==="vertical"?{enabled:!0,monthHeight:U.monthHeight||220,longMonthHeight:B||260,calendarWidth:"auto",calendarHeight:(U.calendarHeight||B||240)*q}:{enabled:!0,monthWidth:U.monthWidth||332,calendarWidth:(U.calendarWidth||U.monthWidth||332)*q,monthHeight:B||300,calendarHeight:B||300}}componentDidMount(){this.props.scroll.enabled&&setTimeout(()=>this.focusToDate(this.state.focusedDate))}componentDidUpdate(I){const q={dateRange:"ranges",date:"date"}[this.props.displayMode];this.props[q]!==I[q]&&this.updateShownDate(this.props),(I.locale!==this.props.locale||I.weekStartsOn!==this.props.weekStartsOn)&&(this.dateOptions={locale:this.props.locale},this.props.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=this.props.weekStartsOn),this.setState({monthNames:this.getMonthNames()})),(0,c.shallowEqualObjects)(I.scroll,this.props.scroll)||this.setState({scrollArea:this.calcScrollArea(this.props)})}renderWeekdays(){const I=new Date;return n.default.createElement("div",{className:this.styles.weekDays},(0,d.eachDayOfInterval)({start:(0,d.startOfWeek)(I,this.dateOptions),end:(0,d.endOfWeek)(I,this.dateOptions)}).map((F,q)=>n.default.createElement("span",{className:this.styles.weekDay,key:q},(0,d.format)(F,this.props.weekdayDisplayFormat,this.dateOptions))))}render(){const{showDateDisplay:I,onPreviewChange:F,scroll:q,direction:U,disabledDates:B,disabledDay:W,maxDate:Y,minDate:G,rangeColors:Z,color:oe,navigatorRenderer:X,className:he,preview:$}=this.props,{scrollArea:K,focusedDate:te}=this.state,H=U==="vertical",ae=X||this.renderMonthAndYear,le=this.props.ranges.map((ue,ie)=>({...ue,color:ue.color||Z[ie]||oe}));return n.default.createElement("div",{className:(0,o.default)(this.styles.calendarWrapper,he),onMouseUp:()=>this.setState({drag:{status:!1,range:{}}}),onMouseLeave:()=>{this.setState({drag:{status:!1,range:{}}})}},I&&this.renderDateDisplay(),ae(te,this.changeShownDate,this.props),q.enabled?n.default.createElement("div",null,H&&this.renderWeekdays(this.dateOptions),n.default.createElement("div",{className:(0,o.default)(this.styles.infiniteMonths,H?this.styles.monthsVertical:this.styles.monthsHorizontal),onMouseLeave:()=>F&&F(),style:{width:K.calendarWidth+11,height:K.calendarHeight+11},onScroll:this.handleScroll},n.default.createElement(l.default,{length:(0,d.differenceInCalendarMonths)((0,d.endOfMonth)(Y),(0,d.addDays)((0,d.startOfMonth)(G),-1),this.dateOptions),treshold:500,type:"variable",ref:ue=>this.list=ue,itemSizeEstimator:this.estimateMonthSize,axis:H?"y":"x",itemRenderer:(ue,ie)=>{const pe=(0,d.addMonths)(G,ue);return n.default.createElement(r.default,j({},this.props,{onPreviewChange:F||this.updatePreview,preview:$||this.state.preview,ranges:le,key:ie,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:B,disabledDay:W,month:pe,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>F&&F(),styles:this.styles,style:H?{height:this.estimateMonthSize(ue)}:{height:K.monthHeight,width:this.estimateMonthSize(ue)},showMonthName:!0,showWeekDays:!H}))}}))):n.default.createElement("div",{className:(0,o.default)(this.styles.months,H?this.styles.monthsVertical:this.styles.monthsHorizontal)},new Array(this.props.months).fill(null).map((ue,ie)=>{let pe=(0,d.addMonths)(this.state.focusedDate,ie);return this.props.calendarFocus==="backwards"&&(pe=(0,d.subMonths)(this.state.focusedDate,this.props.months-1-ie)),n.default.createElement(r.default,j({},this.props,{onPreviewChange:F||this.updatePreview,preview:$||this.state.preview,ranges:le,key:ie,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:B,disabledDay:W,month:pe,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>F&&F(),styles:this.styles,showWeekDays:!H||ie===0,showMonthName:!H||ie>0}))})))}};return M.defaultProps={showMonthArrow:!0,showMonthAndYearPickers:!0,disabledDates:[],disabledDay:()=>{},classNames:{},locale:h.enUS,ranges:[],focusedRange:[0,0],dateDisplayFormat:"MMM d, yyyy",monthDisplayFormat:"MMM yyyy",weekdayDisplayFormat:"E",dayDisplayFormat:"d",showDateDisplay:!0,showPreview:!0,displayMode:"date",months:1,color:"#3d91ff",scroll:{enabled:!1},direction:"vertical",maxDate:(0,d.addYears)(new Date,20),minDate:(0,d.addYears)(new Date,-100),rangeColors:["#3d91ff","#3ecf8e","#fed14c"],startDatePlaceholder:"Early",endDatePlaceholder:"Continuous",editableDateInputs:!1,dragSelectionEnabled:!0,fixedHeight:!1,calendarFocus:"forwards",preventSnapRefocus:!1,ariaLabels:{}},M.propTypes={showMonthArrow:e.default.bool,showMonthAndYearPickers:e.default.bool,disabledDates:e.default.array,disabledDay:e.default.func,minDate:e.default.object,maxDate:e.default.object,date:e.default.object,onChange:e.default.func,onPreviewChange:e.default.func,onRangeFocusChange:e.default.func,classNames:e.default.object,locale:e.default.object,shownDate:e.default.object,onShownDateChange:e.default.func,ranges:e.default.arrayOf(t.rangeShape),preview:e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string}),dateDisplayFormat:e.default.string,monthDisplayFormat:e.default.string,weekdayDisplayFormat:e.default.string,weekStartsOn:e.default.number,dayDisplayFormat:e.default.string,focusedRange:e.default.arrayOf(e.default.number),initialFocusedRange:e.default.arrayOf(e.default.number),months:e.default.number,className:e.default.string,showDateDisplay:e.default.bool,showPreview:e.default.bool,displayMode:e.default.oneOf(["dateRange","date"]),color:e.default.string,updateRange:e.default.func,scroll:e.default.shape({enabled:e.default.bool,monthHeight:e.default.number,longMonthHeight:e.default.number,monthWidth:e.default.number,calendarWidth:e.default.number,calendarHeight:e.default.number}),direction:e.default.oneOf(["vertical","horizontal"]),startDatePlaceholder:e.default.string,endDatePlaceholder:e.default.string,navigatorRenderer:e.default.func,rangeColors:e.default.arrayOf(e.default.string),editableDateInputs:e.default.bool,dragSelectionEnabled:e.default.bool,fixedHeight:e.default.bool,calendarFocus:e.default.string,preventSnapRefocus:e.default.bool,ariaLabels:x.ariaLabelsShape},Ph.default=M,Ph}var pR;function n6(){if(pR)return kh;pR=1,Object.defineProperty(kh,"__esModule",{value:!0}),kh.default=void 0;var n=h(Qs()),e=c(Dl()),t=c(t6()),r=Py(),s=My(),a=Tu(),o=c(Nu()),l=c(Ey());function c(j){return j&&j.__esModule?j:{default:j}}function d(j){if(typeof WeakMap!="function")return null;var C=new WeakMap,P=new WeakMap;return(d=function(O){return O?P:C})(j)}function h(j,C){if(j&&j.__esModule)return j;if(j===null||typeof j!="object"&&typeof j!="function")return{default:j};var P=d(C);if(P&&P.has(j))return P.get(j);var O={__proto__:null},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in j)if(D!=="default"&&Object.prototype.hasOwnProperty.call(j,D)){var I=M?Object.getOwnPropertyDescriptor(j,D):null;I&&(I.get||I.set)?Object.defineProperty(O,D,I):O[D]=j[D]}return O.default=j,P&&P.set(j,O),O}function p(){return p=Object.assign?Object.assign.bind():function(j){for(var C=1;C<arguments.length;C++){var P=arguments[C];for(var O in P)Object.prototype.hasOwnProperty.call(P,O)&&(j[O]=P[O])}return j},p.apply(this,arguments)}function x(j,C,P){return C=v(C),C in j?Object.defineProperty(j,C,{value:P,enumerable:!0,configurable:!0,writable:!0}):j[C]=P,j}function v(j){var C=b(j,"string");return typeof C=="symbol"?C:String(C)}function b(j,C){if(typeof j!="object"||!j)return j;var P=j[Symbol.toPrimitive];if(P!==void 0){var O=P.call(j,C);if(typeof O!="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return(C==="string"?String:Number)(j)}let _=class extends n.Component{constructor(C,P){var O;super(C,P),O=this,x(this,"calcNewSelection",function(M){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const I=O.props.focusedRange||O.state.focusedRange,{ranges:F,onChange:q,maxDate:U,moveRangeOnFirstSelection:B,retainEndDateOnFirstSelection:W,disabledDates:Y}=O.props,G=I[0],Z=F[G];if(!Z||!q)return{};let{startDate:oe,endDate:X}=Z;const he=new Date;let $;if(!D)oe=M.startDate,X=M.endDate;else if(I[1]===0){const H=(0,a.differenceInCalendarDays)(X||he,oe),ae=()=>B?(0,a.addDays)(M,H):W?!X||(0,a.isBefore)(M,X)?X:M:M||he;oe=M,X=ae(),U&&(X=(0,a.min)([X,U])),$=[I[0],1]}else X=M;let K=I[1]===0;(0,a.isBefore)(X,oe)&&(K=!K,[oe,X]=[X,oe]);const te=Y.filter(H=>(0,a.isWithinInterval)(H,{start:oe,end:X}));return te.length>0&&(K?oe=(0,a.addDays)((0,a.max)(te),1):X=(0,a.addDays)((0,a.min)(te),-1)),$||($=[(0,s.findNextRangeIndex)(O.props.ranges,I[0]),0]),{wasValid:!(te.length>0),range:{startDate:oe,endDate:X},nextFocusRange:$}}),x(this,"setSelection",(M,D)=>{const{onChange:I,ranges:F,onRangeFocusChange:q}=this.props,B=(this.props.focusedRange||this.state.focusedRange)[0],W=F[B];if(!W)return;const Y=this.calcNewSelection(M,D);I({[W.key||`range${B+1}`]:{...W,...Y.range}}),this.setState({focusedRange:Y.nextFocusRange,preview:null}),q&&q(Y.nextFocusRange)}),x(this,"handleRangeFocusChange",M=>{this.setState({focusedRange:M}),this.props.onRangeFocusChange&&this.props.onRangeFocusChange(M)}),x(this,"updatePreview",M=>{if(!M){this.setState({preview:null});return}const{rangeColors:D,ranges:I}=this.props,F=this.props.focusedRange||this.state.focusedRange,q=I[F[0]]?.color||D[F[0]]||q;this.setState({preview:{...M.range,color:q}})}),this.state={focusedRange:C.initialFocusedRange||[(0,s.findNextRangeIndex)(C.ranges),0],preview:null},this.styles=(0,s.generateStyles)([l.default,C.classNames])}render(){return n.default.createElement(t.default,p({focusedRange:this.state.focusedRange,onRangeFocusChange:this.handleRangeFocusChange,preview:this.state.preview,onPreviewChange:C=>{this.updatePreview(C?this.calcNewSelection(C):null)}},this.props,{displayMode:"dateRange",className:(0,o.default)(this.styles.dateRangeWrapper,this.props.className),onChange:this.setSelection,updateRange:C=>this.setSelection(C,!1),ref:C=>{this.calendar=C}}))}};return _.defaultProps={classNames:{},ranges:[],moveRangeOnFirstSelection:!1,retainEndDateOnFirstSelection:!1,rangeColors:["#3d91ff","#3ecf8e","#fed14c"],disabledDates:[]},_.propTypes={...t.default.propTypes,onChange:e.default.func,onRangeFocusChange:e.default.func,className:e.default.string,ranges:e.default.arrayOf(r.rangeShape),moveRangeOnFirstSelection:e.default.bool,retainEndDateOnFirstSelection:e.default.bool},kh.default=_,kh}var Ah={},Rh={},Pc={},gR;function r6(){if(gR)return Pc;gR=1,Object.defineProperty(Pc,"__esModule",{value:!0}),Pc.createStaticRanges=r,Pc.defaultStaticRanges=Pc.defaultInputRanges=void 0;var n=Tu();const e={startOfWeek:(0,n.startOfWeek)(new Date),endOfWeek:(0,n.endOfWeek)(new Date),startOfLastWeek:(0,n.startOfWeek)((0,n.addDays)(new Date,-7)),endOfLastWeek:(0,n.endOfWeek)((0,n.addDays)(new Date,-7)),startOfToday:(0,n.startOfDay)(new Date),endOfToday:(0,n.endOfDay)(new Date),startOfYesterday:(0,n.startOfDay)((0,n.addDays)(new Date,-1)),endOfYesterday:(0,n.endOfDay)((0,n.addDays)(new Date,-1)),startOfMonth:(0,n.startOfMonth)(new Date),endOfMonth:(0,n.endOfMonth)(new Date),startOfLastMonth:(0,n.startOfMonth)((0,n.addMonths)(new Date,-1)),endOfLastMonth:(0,n.endOfMonth)((0,n.addMonths)(new Date,-1))},t={range:{},isSelected(s){const a=this.range();return(0,n.isSameDay)(s.startDate,a.startDate)&&(0,n.isSameDay)(s.endDate,a.endDate)}};function r(s){return s.map(a=>({...t,...a}))}return Pc.defaultStaticRanges=r([{label:"Today",range:()=>({startDate:e.startOfToday,endDate:e.endOfToday})},{label:"Yesterday",range:()=>({startDate:e.startOfYesterday,endDate:e.endOfYesterday})},{label:"This Week",range:()=>({startDate:e.startOfWeek,endDate:e.endOfWeek})},{label:"Last Week",range:()=>({startDate:e.startOfLastWeek,endDate:e.endOfLastWeek})},{label:"This Month",range:()=>({startDate:e.startOfMonth,endDate:e.endOfMonth})},{label:"Last Month",range:()=>({startDate:e.startOfLastMonth,endDate:e.endOfLastMonth})}]),Pc.defaultInputRanges=[{label:"days up to today",range(s){return{startDate:(0,n.addDays)(e.startOfToday,(Math.max(Number(s),1)-1)*-1),endDate:e.endOfToday}},getCurrentValue(s){return(0,n.isSameDay)(s.endDate,e.endOfToday)?s.startDate?(0,n.differenceInCalendarDays)(e.endOfToday,s.startDate)+1:"":"-"}},{label:"days starting today",range(s){const a=new Date;return{startDate:a,endDate:(0,n.addDays)(a,Math.max(Number(s),1)-1)}},getCurrentValue(s){return(0,n.isSameDay)(s.startDate,e.startOfToday)?s.endDate?(0,n.differenceInCalendarDays)(s.endDate,e.startOfToday)+1:"":"-"}}],Pc}var Lh={},xR;function lse(){if(xR)return Lh;xR=1,Object.defineProperty(Lh,"__esModule",{value:!0}),Lh.default=void 0;var n=s(Qs()),e=t(Dl());function t(p){return p&&p.__esModule?p:{default:p}}function r(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(r=function(b){return b?v:x})(p)}function s(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=r(x);if(v&&v.has(p))return v.get(p);var b={__proto__:null},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var C=_?Object.getOwnPropertyDescriptor(p,j):null;C&&(C.get||C.set)?Object.defineProperty(b,j,C):b[j]=p[j]}return b.default=p,v&&v.set(p,b),b}function a(p,x,v){return x=o(x),x in p?Object.defineProperty(p,x,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[x]=v,p}function o(p){var x=l(p,"string");return typeof x=="symbol"?x:String(x)}function l(p,x){if(typeof p!="object"||!p)return p;var v=p[Symbol.toPrimitive];if(v!==void 0){var b=v.call(p,x);if(typeof b!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(p)}const c=0,d=99999;let h=class extends n.Component{constructor(x,v){super(x,v),a(this,"onChange",b=>{const{onChange:_}=this.props;let j=parseInt(b.target.value,10);j=isNaN(j)?0:Math.max(Math.min(d,j),c),_(j)})}shouldComponentUpdate(x){const{value:v,label:b,placeholder:_}=this.props;return v!==x.value||b!==x.label||_!==x.placeholder}render(){const{label:x,placeholder:v,value:b,styles:_,onBlur:j,onFocus:C}=this.props;return n.default.createElement("div",{className:_.inputRange},n.default.createElement("input",{className:_.inputRangeInput,placeholder:v,value:b,min:c,max:d,onChange:this.onChange,onFocus:C,onBlur:j}),n.default.createElement("span",{className:_.inputRangeLabel},x))}};return h.propTypes={value:e.default.oneOfType([e.default.string,e.default.number]),label:e.default.oneOfType([e.default.element,e.default.node]).isRequired,placeholder:e.default.string,styles:e.default.shape({inputRange:e.default.string,inputRangeInput:e.default.string,inputRangeLabel:e.default.string}).isRequired,onBlur:e.default.func.isRequired,onFocus:e.default.func.isRequired,onChange:e.default.func.isRequired},h.defaultProps={value:"",placeholder:"-"},Lh.default=h,Lh}var yR;function s6(){if(yR)return Rh;yR=1,Object.defineProperty(Rh,"__esModule",{value:!0}),Rh.default=void 0;var n=d(Qs()),e=l(Dl()),t=l(Ey()),r=r6(),s=Py(),a=l(lse()),o=l(Nu());function l(b){return b&&b.__esModule?b:{default:b}}function c(b){if(typeof WeakMap!="function")return null;var _=new WeakMap,j=new WeakMap;return(c=function(C){return C?j:_})(b)}function d(b,_){if(b&&b.__esModule)return b;if(b===null||typeof b!="object"&&typeof b!="function")return{default:b};var j=c(_);if(j&&j.has(b))return j.get(b);var C={__proto__:null},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in b)if(O!=="default"&&Object.prototype.hasOwnProperty.call(b,O)){var M=P?Object.getOwnPropertyDescriptor(b,O):null;M&&(M.get||M.set)?Object.defineProperty(C,O,M):C[O]=b[O]}return C.default=b,j&&j.set(b,C),C}function h(b,_,j){return _=p(_),_ in b?Object.defineProperty(b,_,{value:j,enumerable:!0,configurable:!0,writable:!0}):b[_]=j,b}function p(b){var _=x(b,"string");return typeof _=="symbol"?_:String(_)}function x(b,_){if(typeof b!="object"||!b)return b;var j=b[Symbol.toPrimitive];if(j!==void 0){var C=j.call(b,_);if(typeof C!="object")return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(b)}let v=class extends n.Component{constructor(_){super(_),h(this,"handleRangeChange",j=>{const{onChange:C,ranges:P,focusedRange:O}=this.props,M=P[O[0]];!C||!M||C({[M.key||`range${O[0]+1}`]:{...M,...j}})}),this.state={rangeOffset:0,focusedInput:-1}}getRangeOptionValue(_){const{ranges:j=[],focusedRange:C=[]}=this.props;if(typeof _.getCurrentValue!="function")return"";const P=j[C[0]]||{};return _.getCurrentValue(P)||""}getSelectedRange(_,j){const C=_.findIndex(O=>!O.startDate||!O.endDate||O.disabled?!1:j.isSelected(O));return{selectedRange:_[C],focusedRangeIndex:C}}render(){const{headerContent:_,footerContent:j,onPreviewChange:C,inputRanges:P,staticRanges:O,ranges:M,renderStaticRangeLabel:D,rangeColors:I,className:F}=this.props;return n.default.createElement("div",{className:(0,o.default)(t.default.definedRangesWrapper,F)},_,n.default.createElement("div",{className:t.default.staticRanges},O.map((q,U)=>{const{selectedRange:B,focusedRangeIndex:W}=this.getSelectedRange(M,q);let Y;return q.hasCustomRendering?Y=D(q):Y=q.label,n.default.createElement("button",{type:"button",className:(0,o.default)(t.default.staticRange,{[t.default.staticRangeSelected]:!!B}),style:{color:B?B.color||I[W]:null},key:U,onClick:()=>this.handleRangeChange(q.range(this.props)),onFocus:()=>C&&C(q.range(this.props)),onMouseOver:()=>C&&C(q.range(this.props)),onMouseLeave:()=>{C&&C()}},n.default.createElement("span",{tabIndex:-1,className:t.default.staticRangeLabel},Y))})),n.default.createElement("div",{className:t.default.inputRanges},P.map((q,U)=>n.default.createElement(a.default,{key:U,styles:t.default,label:q.label,onFocus:()=>this.setState({focusedInput:U,rangeOffset:0}),onBlur:()=>this.setState({rangeOffset:0}),onChange:B=>this.handleRangeChange(q.range(B,this.props)),value:this.getRangeOptionValue(q)}))),j)}};return v.propTypes={inputRanges:e.default.array,staticRanges:e.default.array,ranges:e.default.arrayOf(s.rangeShape),focusedRange:e.default.arrayOf(e.default.number),onPreviewChange:e.default.func,onChange:e.default.func,footerContent:e.default.any,headerContent:e.default.any,rangeColors:e.default.arrayOf(e.default.string),className:e.default.string,renderStaticRangeLabel:e.default.func},v.defaultProps={inputRanges:r.defaultInputRanges,staticRanges:r.defaultStaticRanges,ranges:[],rangeColors:["#3d91ff","#3ecf8e","#fed14c"],focusedRange:[0,0]},Rh.default=v,Rh}var vR;function cse(){if(vR)return Ah;vR=1,Object.defineProperty(Ah,"__esModule",{value:!0}),Ah.default=void 0;var n=d(Qs()),e=l(Dl()),t=l(n6()),r=l(s6()),s=My(),a=l(Nu()),o=l(Ey());function l(x){return x&&x.__esModule?x:{default:x}}function c(x){if(typeof WeakMap!="function")return null;var v=new WeakMap,b=new WeakMap;return(c=function(_){return _?b:v})(x)}function d(x,v){if(x&&x.__esModule)return x;if(x===null||typeof x!="object"&&typeof x!="function")return{default:x};var b=c(v);if(b&&b.has(x))return b.get(x);var _={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in x)if(C!=="default"&&Object.prototype.hasOwnProperty.call(x,C)){var P=j?Object.getOwnPropertyDescriptor(x,C):null;P&&(P.get||P.set)?Object.defineProperty(_,C,P):_[C]=x[C]}return _.default=x,b&&b.set(x,_),_}function h(){return h=Object.assign?Object.assign.bind():function(x){for(var v=1;v<arguments.length;v++){var b=arguments[v];for(var _ in b)Object.prototype.hasOwnProperty.call(b,_)&&(x[_]=b[_])}return x},h.apply(this,arguments)}let p=class extends n.Component{constructor(v){super(v),this.state={focusedRange:[(0,s.findNextRangeIndex)(v.ranges),0]},this.styles=(0,s.generateStyles)([o.default,v.classNames])}render(){const{focusedRange:v}=this.state;return n.default.createElement("div",{className:(0,a.default)(this.styles.dateRangePickerWrapper,this.props.className)},n.default.createElement(r.default,h({focusedRange:v,onPreviewChange:b=>this.dateRange.updatePreview(b?this.dateRange.calcNewSelection(b,typeof b=="string"):null)},this.props,{range:this.props.ranges[v[0]],className:void 0})),n.default.createElement(t.default,h({onRangeFocusChange:b=>this.setState({focusedRange:b}),focusedRange:v},this.props,{ref:b=>this.dateRange=b,className:void 0})))}};return p.defaultProps={},p.propTypes={...t.default.propTypes,...r.default.propTypes,className:e.default.string},Ah.default=p,Ah}var bR;function dse(){return bR||(bR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Calendar",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"DateRange",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"DateRangePicker",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"DefinedRange",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"createStaticRanges",{enumerable:!0,get:function(){return a.createStaticRanges}}),Object.defineProperty(n,"defaultInputRanges",{enumerable:!0,get:function(){return a.defaultInputRanges}}),Object.defineProperty(n,"defaultStaticRanges",{enumerable:!0,get:function(){return a.defaultStaticRanges}});var e=o(n6()),t=o(t6()),r=o(cse()),s=o(s6()),a=r6();function o(l){return l&&l.__esModule?l:{default:l}}})(Ab)),Ab}var jm=dse();const En=({label:n,id:e,error:t,value:r,onChange:s,maxDate:a,minDate:o,...l})=>{const[c,d]=E.useState(!1),[h,p]=E.useState(!1),x=E.useRef(null),{theme:v}=td(),b=v==="dark";E.useEffect(()=>{p(document.body.classList.contains("field-officer-dark-theme"))},[]);const _=I=>{s&&s(We(I,"yyyy-MM-dd")),d(!1)};E.useEffect(()=>{const I=F=>{x.current&&!x.current.contains(F.target)&&d(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]);const{className:j,...C}=l,M=`${h?"fo-input":"form-input"} ${t?h?"fo-input--error":"form-input--error":""} flex justify-between items-center cursor-pointer ${j||""}`,D=r?new Date(r+"T12:00:00"):new Date;return i.jsxs("div",{ref:x,children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsxs("div",{className:n?"mt-1 relative":"relative",children:[i.jsxs("div",{id:e,className:M,onClick:()=>d(!c),role:"button","aria-haspopup":"dialog","aria-expanded":c,"aria-label":`Date picker for ${n}`,children:[i.jsx("span",{className:r?"":"text-muted",children:r?We(D,"dd MMM, yyyy"):"Select date"}),i.jsx(Da,{className:"h-4 w-4 text-muted"})]}),c&&i.jsx("div",{className:`absolute z-50 mt-1 rounded-lg shadow-lg overflow-hidden ${b?"dark-calendar bg-[#041b0f] border border-[#1f3d2b]":"bg-white border border-gray-200"}`,children:i.jsx(jm.Calendar,{date:D,onChange:_,maxDate:a,minDate:o,color:b?"#10B981":"#005D22"})})]}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},i6=["Apartment","Villa","Vilament","Rowhouse","Combined","Commercial Office","Commercial Retail","Commercial","Public",""],use=Pt({organizationId:ye().required(),location:ye().optional().nullable(),entityId:ye().optional(),billingName:ye().optional().nullable(),registeredAddress:ye().optional().nullable(),gstNumber:ye().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,{message:"Invalid GST Number format",excludeEmptyString:!0}),panNumber:ye().optional().nullable().transform(n=>n?.toUpperCase()||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,{message:"Invalid PAN format",excludeEmptyString:!0}),email1:ye().email("Invalid email format").optional().nullable(),email2:ye().email("Invalid email format").optional().nullable(),email3:ye().email("Invalid email format").optional().nullable(),eShramNumber:ye().optional().nullable(),shopAndEstablishmentCode:ye().optional().nullable(),keyAccountManager:ye().optional(),siteAreaSqFt:ls().typeError("Must be a number").nullable().optional(),projectType:ye().oneOf(i6).optional(),apartmentCount:ls().typeError("Must be a number").nullable().optional(),agreementDetails:Pt({fromDate:ye().optional().nullable(),toDate:ye().optional().nullable().test("is-after-from","To Date must be after From Date",function(n){const{fromDate:e}=this.parent;return!e||!n?!0:new Date(n.replace(/-/g,"/"))>=new Date(e.replace(/-/g,"/"))}),renewalIntervalDays:ls().typeError("Must be a number").nullable().optional().min(0,"Cannot be negative"),softCopy:Vt().nullable().optional(),scannedCopy:Vt().nullable().optional(),agreementDate:ye().optional().nullable(),addendum1Date:ye().optional().nullable(),addendum2Date:ye().optional().nullable()}).optional(),siteOperations:Pt({form6Applicable:os().default(!1),form6RenewalTaskCreation:os().optional(),form6ValidityFrom:ye().nullable().when("form6Applicable",{is:!0,then:n=>n.required("From Date is required")}),form6ValidityTo:ye().nullable().when("form6Applicable",{is:!0,then:n=>n.required("To Date is required")}),form6Document:Vt().nullable().when("form6Applicable",{is:!0,then:n=>n.required("Document is required")}),minWageRevisionApplicable:os().default(!1),minWageRevisionTaskCreation:os().optional(),minWageRevisionValidityFrom:ye().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("From Date is required")}),minWageRevisionValidityTo:ye().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("To Date is required")}),minWageRevisionDocument:Vt().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("Document is required")}),holidays:Pt({numberOfDays:ls().nullable().min(0),list:_s().of(Pt({id:ye(),date:ye().required(),description:ye().required()})),salaryPayment:ye().oneOf(["Full Payment","Duty Payment","Nil Payment",""]),billing:ye().oneOf(["Full Payment","Duty Payment","Nil Payment",""])}).optional(),costingSheetLink:ye().url("Must be a valid URL").nullable().optional(),tools:Pt({dcCopy1:Vt().nullable().optional(),dcCopy2:Vt().nullable().optional(),list:_s().of(Pt({id:ye(),name:ye().required(),brand:ye().optional(),size:ye().optional(),quantity:ls().nullable().min(0),issueDate:ye().required(),picture:Vt().nullable().optional()}))}).optional(),sims:Pt({issuedCount:ls().nullable().min(0),details:_s().of(Pt({id:ye(),mobileNumber:ye().required().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),allocatedTo:ye().optional(),plan:ye().optional(),ownerName:ye().optional()}))}).optional(),equipment:Pt({issued:_s().of(Pt({id:ye(),name:ye().required(),brand:ye().optional(),modelNumber:ye().optional(),serialNumber:ye().optional(),accessories:ye().optional(),condition:ye().oneOf(["New","Old",""]),issueDate:ye().required(),picture:Vt().nullable().optional()})),intermittent:Pt({billing:ye().oneOf(["To Be Billed","Not to be Billed",""]),frequency:ye().oneOf(["Monthly","Bi-Monthly","Quarterly","Half Yearly","Yearly",""]),taskCreation:os().default(!1),durationDays:ls().nullable().min(0)}).optional()}).optional(),billingCycleFrom:ye().nullable().optional(),uniformDeductions:os().default(!1)}).optional(),insuranceStatus:Pt({isCompliant:os().required()}).optional().nullable(),assets:_s().optional(),issuedTools:_s().optional()}).defined(),wR=({title:n,children:e})=>{const[t,r]=E.useState(!1);return i.jsxs("div",{className:"border border-border rounded-lg bg-page",children:[i.jsxs("button",{type:"button",onClick:()=>r(!t),className:"w-full flex justify-between items-center p-3 font-medium text-left text-primary-text",children:[i.jsx("span",{children:n}),i.jsx(Su,{className:`h-5 w-5 transform transition-transform ${t?"rotate-180":""}`})]}),t&&i.jsx("div",{className:"p-4 border-t border-border bg-card",children:e})]})},a6=({isOpen:n,onClose:e,onSave:t,organization:r,allClients:s,initialData:a})=>{const[o,l]=E.useState("General"),c=At("(max-width: 767px)"),{register:d,handleSubmit:h,control:p,watch:x,setValue:v,formState:{errors:b},reset:_}=tn({resolver:On(use),defaultValues:{siteOperations:{form6Applicable:!1,minWageRevisionApplicable:!1,uniformDeductions:!1}}}),{fields:j,append:C,remove:P}=js({control:p,name:"siteOperations.holidays.list"});js({control:p,name:"siteOperations.tools.list"}),js({control:p,name:"siteOperations.sims.details"}),js({control:p,name:"siteOperations.equipment.issued"}),E.useEffect(()=>{n&&_(a||{organizationId:r.id})},[n,a,r.id,_]);const O=x("entityId"),M=x("siteOperations.form6Applicable"),D=x("siteOperations.minWageRevisionApplicable");E.useEffect(()=>{if(O){const q=s.find(U=>U.id===O);q&&(v("registeredAddress",q.registeredAddress||""),v("gstNumber",q.gstNumber||""),v("panNumber",q.panNumber||""),v("email1",q.email||""),v("eShramNumber",q.eShramNumber||""),v("shopAndEstablishmentCode",q.shopAndEstablishmentCode||""))}},[O,s,v]);const I=q=>{t(r.id,q)},F=({tabName:q})=>i.jsx("button",{type:"button",onClick:()=>l(q),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${o===q?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:q});return n?i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4 flex items-center justify-center",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale",onClick:q=>q.stopPropagation(),children:i.jsxs("form",{onSubmit:h(I),className:"p-6",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Site Configuration"}),i.jsxs("p",{className:"text-sm text-muted mb-4",children:["For: ",r.shortName]}),i.jsx("div",{className:"mb-6",children:c?i.jsxs(Ze,{label:"Configuration Section",id:"site-config-tabs",value:o,onChange:q=>l(q.target.value),className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"General",children:"General"}),i.jsx("option",{value:"Compliance",children:"Compliance"}),i.jsx("option",{value:"Agreement",children:"Agreement"}),i.jsx("option",{value:"Site Operations",children:"Site Operations"})]}):i.jsx("div",{className:"border-b border-border",children:i.jsxs("nav",{className:"-mb-px flex space-x-4",children:[i.jsx(F,{tabName:"General"}),i.jsx(F,{tabName:"Compliance"}),i.jsx(F,{tabName:"Agreement"}),i.jsx(F,{tabName:"Site Operations"})]})})}),i.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2 space-y-4",children:[o==="General"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(we,{label:"Location",id:"location",registration:d("location"),error:b.location?.message}),i.jsx(we,{label:"Billing Name",id:"billingName",registration:d("billingName"),error:b.billingName?.message}),i.jsx(we,{label:"Key Account Manager",id:"keyAccountManager",registration:d("keyAccountManager"),error:b.keyAccountManager?.message}),i.jsx(we,{label:"Site Area (Sq.ft)",id:"siteAreaSqFt",type:"number",registration:d("siteAreaSqFt"),error:b.siteAreaSqFt?.message}),i.jsxs(Ze,{label:"Type of Project",id:"projectType",registration:d("projectType"),error:b.projectType?.message,children:[i.jsx("option",{value:"",children:"-- Select Type --"}),i6.filter(Boolean).map(q=>i.jsx("option",{value:q,children:q},q))]}),i.jsx(we,{label:"No of Apartments/Villas",id:"apartmentCount",type:"number",registration:d("apartmentCount"),error:b.apartmentCount?.message})]}),o==="Compliance"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx("div",{className:"md:col-span-2",children:i.jsx(_e,{name:"entityId",control:p,render:({field:q})=>i.jsxs(Ze,{label:"Link to Client (Prefills data)",id:"entityId",...q,error:b.entityId?.message,children:[i.jsx("option",{value:"",children:"-- Select Client --"}),s.map(U=>i.jsxs("option",{value:U.id,children:[U.name," (",U.companyName,")"]},U.id))]})})}),i.jsx(we,{label:"GST Number",id:"gstNumber",registration:d("gstNumber"),error:b.gstNumber?.message}),i.jsx(we,{label:"PAN Number",id:"panNumber",registration:d("panNumber"),error:b.panNumber?.message}),i.jsx(we,{label:"Email Address 1",id:"email1",registration:d("email1"),error:b.email1?.message}),i.jsx(we,{label:"Email Address 2",id:"email2",registration:d("email2"),error:b.email2?.message}),i.jsx(we,{label:"Email Address 3",id:"email3",registration:d("email3"),error:b.email3?.message}),i.jsx(we,{label:"E-Shram Number",id:"eShramNumber",registration:d("eShramNumber"),error:b.eShramNumber?.message}),i.jsx(we,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:d("shopAndEstablishmentCode"),error:b.shopAndEstablishmentCode?.message})]}),o==="Agreement"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(_e,{name:"agreementDetails.fromDate",control:p,render:({field:q})=>i.jsx(En,{label:"From Date",id:"agreementDetails.fromDate",value:q.value,onChange:q.onChange,error:b.agreementDetails?.fromDate?.message})}),i.jsx(_e,{name:"agreementDetails.toDate",control:p,render:({field:q})=>i.jsx(En,{label:"To Date",id:"agreementDetails.toDate",value:q.value,onChange:q.onChange,error:b.agreementDetails?.toDate?.message})}),i.jsx(we,{label:"Renewal Interval (Days)",id:"agreementDetails.renewalIntervalDays",type:"number",registration:d("agreementDetails.renewalIntervalDays"),error:b.agreementDetails?.renewalIntervalDays?.message}),i.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(_e,{name:"agreementDetails.softCopy",control:p,render:({field:q})=>i.jsx(vt,{label:"Soft Copy",file:q.value,onFileChange:q.onChange})}),i.jsx(_e,{name:"agreementDetails.scannedCopy",control:p,render:({field:q})=>i.jsx(vt,{label:"Scanned Copy",file:q.value,onFileChange:q.onChange})})]}),i.jsx(_e,{name:"agreementDetails.agreementDate",control:p,render:({field:q})=>i.jsx(En,{label:"Agreement Dated",id:"agreementDetails.agreementDate",value:q.value,onChange:q.onChange,error:b.agreementDetails?.agreementDate?.message})}),i.jsx(_e,{name:"agreementDetails.addendum1Date",control:p,render:({field:q})=>i.jsx(En,{label:"Addendum 1 Dated",id:"agreementDetails.addendum1Date",value:q.value,onChange:q.onChange,error:b.agreementDetails?.addendum1Date?.message})}),i.jsx(_e,{name:"agreementDetails.addendum2Date",control:p,render:({field:q})=>i.jsx(En,{label:"Addendum 2 Dated",id:"agreementDetails.addendum2Date",value:q.value,onChange:q.onChange,error:b.agreementDetails?.addendum2Date?.message})})]}),o==="Site Operations"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(wR,{title:"Compliance Forms",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(_e,{name:"siteOperations.form6Applicable",control:p,render:({field:q})=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:q.value,onChange:q.onChange})," Form 6 Applicable"]})}),M&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[i.jsx(_e,{name:"siteOperations.form6ValidityFrom",control:p,render:({field:q})=>i.jsx(En,{label:"Valid From",id:"form6from",value:q.value,onChange:q.onChange,error:b.siteOperations?.form6ValidityFrom?.message})}),i.jsx(_e,{name:"siteOperations.form6ValidityTo",control:p,render:({field:q})=>i.jsx(En,{label:"Valid To",id:"form6to",value:q.value,onChange:q.onChange,error:b.siteOperations?.form6ValidityTo?.message})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(_e,{name:"siteOperations.form6Document",control:p,render:({field:q})=>i.jsx(vt,{label:"Form 6 Document",file:q.value,onFileChange:q.onChange,error:b.siteOperations?.form6Document?.message})})})]})]}),i.jsxs("div",{children:[i.jsx(_e,{name:"siteOperations.minWageRevisionApplicable",control:p,render:({field:q})=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:q.value,onChange:q.onChange})," Min. Wage Revision Applicable"]})}),D&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[i.jsx(_e,{name:"siteOperations.minWageRevisionValidityFrom",control:p,render:({field:q})=>i.jsx(En,{label:"Valid From",id:"minwagefrom",value:q.value,onChange:q.onChange,error:b.siteOperations?.minWageRevisionValidityFrom?.message})}),i.jsx(_e,{name:"siteOperations.minWageRevisionValidityTo",control:p,render:({field:q})=>i.jsx(En,{label:"Valid To",id:"minwageto",value:q.value,onChange:q.onChange,error:b.siteOperations?.minWageRevisionValidityTo?.message})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(_e,{name:"siteOperations.minWageRevisionDocument",control:p,render:({field:q})=>i.jsx(vt,{label:"Min. Wage Document",file:q.value,onFileChange:q.onChange,error:b.siteOperations?.minWageRevisionDocument?.message})})})]})]})]})}),i.jsx(wR,{title:"Holidays",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx(we,{label:"Number of National & Festival Holidays",id:"holiday-count",type:"number",registration:d("siteOperations.holidays.numberOfDays")}),i.jsxs(Ze,{label:"Salary Payment for Holiday",id:"holiday-salary",registration:d("siteOperations.holidays.salaryPayment"),children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Full Payment"}),i.jsx("option",{children:"Duty Payment"}),i.jsx("option",{children:"Nil Payment"})]}),i.jsxs(Ze,{label:"Billing for Holiday",id:"holiday-billing",registration:d("siteOperations.holidays.billing"),children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Full Payment"}),i.jsx("option",{children:"Duty Payment"}),i.jsx("option",{children:"Nil Payment"})]}),i.jsx("h5",{className:"font-semibold pt-2 border-t",children:"Holiday List"}),j.map((q,U)=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[i.jsx("div",{className:"col-span-6",children:i.jsx(we,{label:"Description",id:`holiday-desc-${U}`,...d(`siteOperations.holidays.list.${U}.description`)})}),i.jsx("div",{className:"col-span-5",children:i.jsx(_e,{name:`siteOperations.holidays.list.${U}.date`,control:p,render:({field:B})=>i.jsx(En,{label:"Date",id:`holiday-date-${U}`,value:B.value,onChange:B.onChange})})}),i.jsx("div",{className:"col-span-1",children:i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>P(U),children:i.jsx(sn,{className:"h-4 text-red-500"})})})]},q.id)),i.jsxs(ne,{type:"button",variant:"outline",size:"sm",onClick:()=>C({id:`hol_${Date.now()}`,date:"",description:""}),children:[i.jsx(Ut,{className:"h-4 mr-1"})," Add Holiday"]})]})})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[i.jsx(ne,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ne,{type:"submit",children:"Save Configuration"})]})]})})}):null},fse=({isOpen:n,onClose:e,siteName:t,details:r,isLoading:s,onSave:a,designations:o})=>{const[l,c]=E.useState([]),[d,h]=E.useState(!1),p=E.useRef(null),[x,v]=E.useState(!1),b=E.useMemo(()=>{const I=new Set;return o.filter(F=>I.has(F.designation)?!1:(I.add(F.designation),!0)).sort((F,q)=>F.designation.localeCompare(q.designation))},[o]),_=()=>{const I=p.current;if(I){const F=I.scrollHeight>I.clientHeight,q=I.scrollHeight-I.scrollTop<=I.clientHeight+1;v(F&&!q)}else v(!1)};E.useEffect(()=>{if(n){c(JSON.parse(JSON.stringify(r)));const I=setTimeout(_,150);return()=>clearTimeout(I)}},[r,n,s]);const j=(I,F,q)=>{const U=[...l],B=U[I];if(F==="count"){const W=Number(q);B.count=isNaN(W)?0:W}else B.designation=String(q);c(U)},C=()=>{c([...l,{designation:"",count:0,tempId:`new_${Date.now()}`}]),setTimeout(_,50)},P=I=>{const F=l.filter((q,U)=>U!==I);c(F),setTimeout(_,50)},O=async()=>{h(!0);const I=l.filter(F=>F.designation.trim()!=="").map(({tempId:F,...q})=>q);await a(I),h(!1)},M=ot.useMemo(()=>l.reduce((I,F)=>I+(Number(F.count)||0),0),[l]),D=I=>{if(I.key!=="ArrowUp"&&I.key!=="ArrowDown")return;const F=I.target;if(F.tagName!=="INPUT"&&F.tagName!=="SELECT")return;const q=F.getAttribute("data-row-index"),U=F.getAttribute("data-col-index");if(!q||!U||F.type==="number")return;I.preventDefault();const B=I.currentTarget,W=parseInt(q,10),Y=parseInt(U,10),G=I.key==="ArrowUp"?W-1:W+1,Z=B.querySelector(`[data-row-index="${G}"][data-col-index="${Y}"]`);Z&&Z.focus()};return n?i4.createPortal(i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm sm:max-w-lg md:max-w-2xl m-4 animate-fade-in-scale flex flex-col",onClick:I=>I.stopPropagation(),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Allocate Manpower"}),i.jsxs("p",{className:"text-sm text-muted mb-4",children:["For site: ",t]}),i.jsxs("div",{className:"flex-grow relative overflow-hidden",children:[i.jsx("div",{ref:p,onScroll:_,onKeyDown:D,className:"overflow-y-auto pr-2 min-h-[300px] max-h-[60vh] h-full",children:s?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-12 gap-4 sticky top-0 bg-page p-2 rounded-t-lg z-10",children:[i.jsx("div",{className:"col-span-6 font-medium text-sm text-muted",children:"Designation"}),i.jsx("div",{className:"col-span-4 font-medium text-sm text-muted",children:"Count"}),i.jsx("div",{className:"col-span-2"})]}),l.length>0?l.map((I,F)=>i.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[i.jsx("div",{className:"col-span-6",children:i.jsxs(Ze,{id:`designation-${F}`,value:I.designation,onChange:q=>j(F,"designation",q.target.value),className:"py-1.5","data-row-index":F,"data-col-index":0,"aria-label":`Designation for row ${F+1}`,children:[i.jsx("option",{value:"",children:"Select Designation"}),b.map(q=>i.jsx("option",{value:q.designation,children:q.designation},q.id))]})}),i.jsx("div",{className:"col-span-4",children:i.jsx(we,{id:`count-${F}`,type:"number",value:I.count,onChange:q=>j(F,"count",q.target.value),min:"0",step:"0.01",className:"py-1.5","data-row-index":F,"data-col-index":1,"aria-label":`Count for row ${F+1}`})}),i.jsx("div",{className:"col-span-2 text-right",children:i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>P(F),title:"Remove row","aria-label":`Remove row ${F+1}`,children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})})})]},I.tempId||F)):i.jsx("p",{className:"text-center text-muted py-10",children:"No designations added yet. Click below to start."}),i.jsxs(ne,{variant:"outline",size:"sm",onClick:C,className:"mt-4",children:[i.jsx(Ut,{className:"h-4 w-4 mr-2"})," Add Designation"]})]})}),x&&i.jsx("div",{className:"absolute bottom-0 left-0 right-2 h-16 bg-gradient-to-t from-card to-transparent pointer-events-none"})]}),i.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-between items-center",children:[i.jsxs("div",{className:"font-semibold",children:["Total Manpower: ",i.jsx("span",{className:"text-accent",children:M.toFixed(2)})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx(ne,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),i.jsx(ne,{onClick:O,isLoading:d,disabled:s,children:"Save Changes"})]})]})]})}),document.getElementById("modal-root")):null},SS=["id","shortName","fullName","address","manpowerApprovedCount","reportingManagerName","managerName","fieldOfficerNames","backendFieldOfficerNames"],hse=(n,e)=>{const t=e.join(","),r=n.map(s=>e.map(a=>{let o=s[a];return Array.isArray(o)&&(o=o.join(";")),o=o==null?"":String(o),o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...r].join(`
`)},mse=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,"")),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),a[l]=d}),r.push(a)}return r},pse=()=>{const n=Nt(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState([]),[d,h]=E.useState(!0),[p,x]=E.useState(!1),[v,b]=E.useState(!1),[_,j]=E.useState(!1),[C,P]=E.useState(null),[O,M]=E.useState(null),[D,I]=E.useState(null),[F,q]=E.useState([]),[U,B]=E.useState(!1),W=E.useRef(null),Y=At("(max-width: 767px)"),{siteManagement:G}=bi(),Z=E.useCallback(async()=>{h(!0);try{const[le,ue,ie,pe]=await Promise.all([ce.getOrganizations().catch(de=>(console.error("Failed to fetch organizations:",de),[])),ce.getOrganizationStructure().catch(de=>(console.error("Failed to fetch organization structure:",de),[])),ce.getSiteConfigurations().catch(de=>(console.error("Failed to fetch site configurations:",de),[])),ce.getSiteStaffDesignations().catch(de=>(console.error("Failed to fetch site staff designations:",de),I({message:"Could not load designation list. Manpower editing may be affected.",type:"error"}),[]))]);t(le),s(ie),c(pe);const re=ue.flatMap(de=>de.companies.flatMap(je=>je.entities.map(Ae=>({...Ae,companyName:je.name}))));o(re)}catch{I({message:"An unexpected error occurred while fetching data.",type:"error"})}finally{h(!1)}},[]);E.useEffect(()=>{Z()},[Z]);const oe=le=>{P(le),x(!0)},X=le=>{M(le),b(!0)},he=(le,ue)=>{s(ie=>{const pe=[...ie],re=pe.findIndex(de=>de.organizationId===le);return re>-1?pe[re]=ue:pe.push(ue),pe}),I({message:"Site configuration saved.",type:"success"}),x(!1)},$=async()=>{O&&(t(le=>le.filter(ue=>ue.id!==O.id)),s(le=>le.filter(ue=>ue.organizationId!==O.id)),I({message:"Site deleted.",type:"success"}),b(!1))},K=async le=>{M(le),B(!0),j(!0);try{const ue=await ce.getManpowerDetails(le.id);q(ue)}catch{I({message:"Could not load manpower details.",type:"error"})}finally{B(!1)}},te=async le=>{if(O)try{await ce.updateManpowerDetails(O.id,le);const ue=le.reduce((ie,pe)=>ie+(Number(pe.count)||0),0);t(ie=>ie.map(pe=>pe.id===O.id?{...pe,manpowerApprovedCount:ue}:pe)),j(!1),I({message:"Manpower details updated successfully.",type:"success"})}catch{I({message:"Failed to save manpower details.",type:"error"})}},H=()=>{const le=hse(e,SS),ue=new Blob([le],{type:"text/csv;charset=utf-8;"}),ie=document.createElement("a");ie.href=URL.createObjectURL(ue),ie.setAttribute("download","sites_export.csv"),document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),I({message:"Sites exported successfully.",type:"success"})},ae=le=>{const ue=le.target.files?.[0];if(!ue)return;const ie=new FileReader;ie.onload=async pe=>{try{const re=pe.target?.result;if(!re)throw new Error("File is empty or could not be read.");const de=mse(re);if(de.length===0)throw new Error("No data rows found in the CSV file.");const je=Object.keys(de[0]);if(!SS.every(Pe=>je.includes(Pe)))throw new Error(`CSV is missing headers. Required: ${SS.join(", ")}`);const Te=de.map(Pe=>({id:Pe.id,shortName:Pe.shortName,fullName:Pe.fullName,address:Pe.address,manpowerApprovedCount:parseFloat(Pe.manpowerApprovedCount)||0,reportingManagerName:Pe.reportingManagerName||void 0,managerName:Pe.managerName||void 0,fieldOfficerNames:Pe.fieldOfficerNames?Pe.fieldOfficerNames.split(";").map(qe=>qe.trim()).filter(qe=>qe):void 0,backendFieldOfficerNames:Pe.backendFieldOfficerNames?Pe.backendFieldOfficerNames.split(";").map(qe=>qe.trim()).filter(qe=>qe):void 0})),{count:Se}=await ce.bulkUploadOrganizations(Te);I({message:`${Se} sites imported/updated successfully.`,type:"success"}),Z()}catch(re){I({message:re.message||"Failed to import CSV.",type:"error"})}finally{le.target&&(le.target.value="")}},ie.readAsText(ue)};return i.jsxs("div",{className:"p-4 md:p-8",children:[D&&i.jsx(pt,{message:D.message,type:D.type,onDismiss:()=>I(null)}),i.jsx("input",{type:"file",ref:W,className:"hidden",accept:".csv",onChange:ae}),i.jsx("input",{type:"file",ref:W,className:"hidden",accept:".csv",onChange:ae}),p&&C&&i.jsx(a6,{isOpen:p,onClose:()=>x(!1),onSave:he,organization:C,allClients:a,initialData:r.find(le=>le.organizationId===C.id)}),O&&i.jsx(fse,{isOpen:_,onClose:()=>j(!1),siteName:O.shortName,details:F,isLoading:U,onSave:te,designations:l}),i.jsxs(Kr,{isOpen:v,onClose:()=>b(!1),onConfirm:$,title:"Confirm Deletion",children:['Are you sure you want to delete the site "',O?.shortName,'"? This action cannot be undone.']}),i.jsxs("div",{className:"bg-card p-4 rounded-2xl mb-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Site Management"}),!Y&&i.jsxs("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:[i.jsxs(ne,{variant:"outline",onClick:()=>n("/admin/sites/quick-add"),className:"mr-2 hover:bg-gray-100",children:[i.jsx(Ut,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),i.jsxs(ne,{onClick:()=>n("/admin/sites/add"),className:"mr-2 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[i.jsx(Ut,{className:"w-5 h-5 mr-2"}),"Add Site"]}),i.jsxs(ne,{variant:"outline",onClick:()=>W.current?.click(),className:"mr-2 hover:bg-gray-100",children:[i.jsx(Yc,{className:"w-5 h-5 mr-2"}),"Import"]}),i.jsxs(ne,{variant:"outline",onClick:H,className:"hover:bg-gray-100",children:[i.jsx(_i,{className:"w-5 h-5 mr-2"}),"Export"]})]})]}),Y&&i.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[i.jsxs(ne,{onClick:()=>n("/admin/sites/add"),className:"w-full justify-center bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[i.jsx(Ut,{className:"w-5 h-5 mr-2"}),"Add Site"]}),i.jsxs(ne,{variant:"outline",onClick:()=>n("/admin/sites/quick-add"),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(Ut,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs(ne,{variant:"outline",onClick:()=>W.current?.click(),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(Yc,{className:"w-5 h-5 mr-2"}),"Import"]}),i.jsxs(ne,{variant:"outline",onClick:H,className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(_i,{className:"w-5 h-5 mr-2"}),"Export"]})]})]})]}),i.jsx("div",{className:"bg-card rounded-2xl shadow-sm border border-border overflow-hidden",children:d?i.jsx("div",{className:"overflow-x-auto",children:i.jsx("table",{className:"w-full",children:i.jsx("tbody",{className:"divide-y divide-border",children:i.jsx(Ra,{cols:5,rows:5})})})}):e.length===0?i.jsxs("div",{className:"p-8 text-center text-muted",children:[i.jsx(Ki,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),i.jsx("p",{children:"No sites found. Add a new site to get started."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-muted/50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Location"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-muted uppercase tracking-wider",children:"Manpower"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Key Staff"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:e.map(le=>{r.find(pe=>pe.organizationId===le.id);const ue=!!le.provisionalCreationDate,ie=ue&&le.provisionalCreationDate?90-JV(new Date,new Date(le.provisionalCreationDate)):0;return i.jsxs("tr",{className:"hover:bg-muted/5 transition-colors",children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center",children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-primary-text",children:le.shortName}),i.jsx("div",{className:"text-xs text-muted",children:le.fullName}),ue&&i.jsxs("div",{className:`mt-1 text-xs px-2 py-0.5 rounded-full inline-flex items-center gap-1 ${ie>30?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[i.jsx(n3,{className:"w-3 h-3"}),ie>0?`${ie} days left`:"Expired"]})]})})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"text-sm text-primary-text max-w-xs truncate",title:le.address,children:le.address})}),i.jsx("td",{className:"px-6 py-4 text-center",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:le.manpowerApprovedCount||0})}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"text-xs space-y-1",children:[le.reportingManagerName&&i.jsxs("div",{className:"flex items-center gap-1",title:"Reporting Manager",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:"RM:"})," ",le.reportingManagerName]}),le.managerName&&i.jsxs("div",{className:"flex items-center gap-1",title:"Site Manager",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:"SM:"})," ",le.managerName]}),le.fieldOfficerNames&&le.fieldOfficerNames.length>0&&i.jsxs("div",{className:"flex items-start gap-1",title:"Field Officers",children:[i.jsx("span",{className:"font-semibold text-primary-text whitespace-nowrap",children:"FO:"}),i.jsx("span",{className:"truncate max-w-[150px]",children:le.fieldOfficerNames.join(", ")})]}),le.backendFieldOfficerNames&&le.backendFieldOfficerNames.length>0&&i.jsxs("div",{className:"flex items-start gap-1",title:"Backend Field Officers",children:[i.jsx("span",{className:"font-semibold text-primary-text whitespace-nowrap",children:"BFO:"}),i.jsx("span",{className:"truncate max-w-[150px]",children:le.backendFieldOfficerNames.join(", ")})]})]})}),i.jsx("td",{className:"px-6 py-4 text-right whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>K(le),title:"Manpower Details",children:i.jsx(Qi,{className:"w-4 h-4 text-blue-600"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>oe(le),title:"Configure Site",children:i.jsx(Rm,{className:"w-4 h-4 text-gray-600"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>X(le),title:"Delete Site",children:i.jsx(sn,{className:"w-4 h-4 text-red-600"})})]})})]},le.id)})})]})})})]})},gse=({isOpen:n,onClose:e,onSave:t,title:r,initialName:s=""})=>{const[a,o]=E.useState(s),[l,c]=E.useState("");E.useEffect(()=>{n&&(o(s),c(""))},[n,s]);const d=()=>{if(!a.trim()){c("Role name cannot be empty.");return}t(a.trim()),e()};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm m-4 animate-fade-in-scale",onClick:h=>h.stopPropagation(),children:i.jsxs("form",{onSubmit:h=>{h.preventDefault(),d()},children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-4",children:r}),i.jsx(we,{label:"Role Display Name",id:"role-name",value:a,onChange:h=>o(h.target.value),error:l,autoFocus:!0}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ne,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ne,{type:"submit",children:"Save"})]})]})})}):null},Sm=[{key:"apply_for_leave",name:"Apply for Leave",description:"Allows users to request time off."},{key:"create_enrollment",name:"Create Enrollment",description:"Access the multi-step form to onboard new employees."},{key:"view_developer_settings",name:"Developer Settings",description:"Access API settings and other developer tools."},{key:"download_attendance_report",name:"Download Attendance Report",description:"Generate and download attendance reports in CSV format."},{key:"manage_approval_workflow",name:"Manage Approval Workflow",description:"Set up reporting managers for leave approvals."},{key:"manage_attendance_rules",name:"Manage Attendance Rules",description:"Set work hours, holidays, and leave allocations."},{key:"manage_enrollment_rules",name:"Manage Enrollment Rules",description:"Set rules for ESI/GMC, manpower limits, and documents."},{key:"manage_insurance",name:"Manage Insurance",description:"Create and manage company insurance plans."},{key:"manage_leave_requests",name:"Manage Leave Requests",description:"Approve or reject leave requests for employees."},{key:"manage_modules",name:"Manage Modules",description:"Create, edit, and group permissions into modules."},{key:"manage_policies",name:"Manage Policies",description:"Create and manage company policies."},{key:"manage_roles_and_permissions",name:"Manage Roles & Permissions",description:"Access this page to edit role permissions."},{key:"manage_sites",name:"Manage Sites",description:"Create, edit, and delete organizations/sites."},{key:"manage_tasks",name:"Manage Tasks",description:"Create, assign, and manage all organizational tasks, including escalations."},{key:"manage_uniforms",name:"Manage Uniforms",description:"Manage uniform requests and site configurations."},{key:"manage_users",name:"Manage Users",description:"Create, edit, and delete user accounts."},{key:"view_operations_dashboard",name:"Operations Dashboard",description:"View the operations management dashboard."},{key:"view_site_dashboard",name:"Site Dashboard",description:"View the dashboard for a specific site/organization."},{key:"view_all_attendance",name:"View All Attendance",description:"Allows users to see attendance records for all employees."},{key:"view_all_submissions",name:"View All Submissions",description:"Access the main dashboard to view all employee submissions."},{key:"view_entity_management",name:"View Entity Management",description:"Access the HR dashboard for managing company entities."},{key:"view_field_officer_tracking",name:"View Field Officer Tracking",description:"Track user check-in/out locations and activity on a map."},{key:"view_invoice_summary",name:"View Invoice Summary",description:"View and generate monthly invoices for sites."},{key:"view_own_attendance",name:"View Own Attendance",description:"Allows users to see their own attendance records."},{key:"view_verification_costing",name:"View Verification Costing",description:"Analyze costs associated with third-party document verifications."}].sort((n,e)=>n.name.localeCompare(e.name)),xse=()=>{const n=Nt(),{permissions:e,setRolePermissions:t,addRolePermissionEntry:r,removeRolePermissionEntry:s,renameRolePermissionEntry:a}=na(),[o,l]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState(!0),[x,v]=E.useState(null),[b,_]=E.useState(!1),[j,C]=E.useState(!1),[P,O]=E.useState(null),[M,D]=E.useState(!1),[I,F]=E.useState(null),q=E.useRef(null),U=At("(max-width: 767px)");E.useEffect(()=>{(async()=>{p(!0);try{const[he,$]=await Promise.all([ce.getRoles(),ce.getModules()]);l(he),d($.sort((K,te)=>K.name.localeCompare(te.name)))}catch(he){console.error("Failed to load data",he),v({message:"Failed to load page data.",type:"error"})}finally{p(!1)}})()},[]),E.useEffect(()=>{const X=he=>{q.current&&!q.current.contains(he.target)&&F(null)};return document.addEventListener("mousedown",X),()=>document.removeEventListener("mousedown",X)},[]);const B=(X,he,$)=>{const K=e[X]||[],te=$?[...K,he]:K.filter(H=>H!==he);t(X,te)},W=async X=>{const he=X.toLowerCase().replace(/\s+/g,"_");if(M&&P){if(P.id==="admin"){v({message:"The Admin role cannot be renamed.",type:"error"});return}if(o.some(K=>K.id===he&&K.id!==P.id)){v({message:`A role with ID '${he}' already exists.`,type:"error"});return}const $=o.map(K=>K.id===P.id?{...K,displayName:X,id:he}:K);await ce.saveRoles($),l($),a(P.id,he),v({message:"Role renamed.",type:"success"})}else{if(o.some(te=>te.id===he)){v({message:`A role with ID '${he}' already exists.`,type:"error"});return}const $={id:he,displayName:X},K=[...o,$];await ce.saveRoles(K),l(K),r($),v({message:"Role added successfully.",type:"success"})}},Y=async()=>{if(!P||P.id==="admin"){v({message:"This role cannot be deleted.",type:"error"}),C(!1);return}const X=o.filter(he=>he.id!==P.id);await ce.saveRoles(X),l(X),s(P.id),v({message:`Role '${P.displayName}' deleted.`,type:"success"}),C(!1)},G=E.useMemo(()=>new Map(Sm.map(X=>[X.key,X])),[]),Z=E.useMemo(()=>{const X=new Set(c.flatMap(he=>he.permissions));return Sm.filter(he=>!X.has(he.key))},[c]),oe=X=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Permission",className:"px-4 py-4",children:i.jsxs("div",{className:"flex flex-col items-end text-right md:items-start md:text-left",children:[i.jsx("div",{className:"font-semibold text-primary-text",children:X.name}),i.jsx("div",{className:"text-xs text-muted",children:X.description})]})}),o.map(he=>{const $=e[he.id]?.includes(X.key),K=he.id==="admin",te=K?"Admin role has all permissions by default and cannot be changed.":"";return i.jsx("td",{"data-label":he.displayName,className:"px-4 py-4 text-center align-middle",children:i.jsx("div",{className:"flex justify-center",children:i.jsxs("label",{className:`relative flex items-center justify-center w-5 h-5 ${K?"cursor-not-allowed":"cursor-pointer"}`,children:[i.jsx("input",{type:"checkbox",className:"sr-only peer",checked:$,onChange:H=>B(he.id,X.key,H.target.checked),disabled:K,title:te}),i.jsx("span",{className:`w-5 h-5 bg-white border border-gray-300 rounded flex items-center justify-center peer-focus-visible:ring-2 peer-focus-visible:ring-offset-2 peer-focus-visible:ring-accent-dark peer-checked:border-accent ${K?"opacity-50":""}`,children:$?i.jsx(Sl,{className:"w-4 h-4 text-accent"}):i.jsx(wi,{className:"w-4 h-4 text-red-500"})})]})})},he.id)})]},X.key);return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>v(null)}),i.jsx(gse,{isOpen:b,onClose:()=>_(!1),onSave:W,title:M?"Rename Role":"Add New Role",initialName:M?P?.displayName:""}),i.jsxs(Kr,{isOpen:j,onClose:()=>C(!1),onConfirm:Y,title:"Confirm Deletion",children:['Are you sure you want to delete the role "',P?.displayName,'"? This action cannot be undone.']}),i.jsx(ra,{title:"Role & Permission Management",children:i.jsxs("button",{onClick:()=>n("/admin/roles/add"),className:"btn btn-primary btn-md",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Role"]})}),i.jsx("p",{className:"text-muted text-sm -mt-4 mb-6",children:"Assign permissions to user roles. Changes are saved automatically."}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-4 py-3 text-left font-bold text-primary-text",children:"Permission"}),o.map(X=>i.jsx("th",{scope:"col",className:"px-4 py-3 text-center font-bold text-primary-text w-40",children:i.jsxs("div",{className:"flex items-center justify-center gap-1",children:[i.jsx("span",{children:X.displayName}),X.id!=="admin"&&i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>F(X.id===I?null:X.id),children:i.jsx(bJ,{className:"h-4 w-4 text-muted"})}),I===X.id&&i.jsxs("div",{ref:q,className:"absolute right-0 mt-2 w-32 bg-card border rounded-md shadow-lg z-10",children:[i.jsxs("button",{onClick:()=>{n(`/admin/roles/edit/${X.id}`),F(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center",children:[i.jsx(ur,{className:"mr-2 h-4 w-4"}),"Edit"]}),i.jsxs("button",{onClick:()=>{O(X),C(!0),F(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center text-red-600",children:[i.jsx(sn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})},X.id))]})}),h?i.jsx("tbody",{children:U?i.jsx("tr",{children:i.jsx("td",{colSpan:o.length+1||2,children:i.jsx(Ra,{rows:3,cols:2,isMobile:!0})})}):i.jsx(Ra,{rows:10,cols:o.length+1||5})}):i.jsxs(i.Fragment,{children:[c.map(X=>i.jsxs("tbody",{className:"divide-y divide-border",children:[i.jsx("tr",{className:"bg-page/50",children:i.jsx("td",{colSpan:o.length+1,className:"p-2 font-bold text-primary-text",children:X.name})}),X.permissions.map(he=>{const $=G.get(he);return $?oe($):null})]},X.id)),Z.length>0&&i.jsxs("tbody",{className:"divide-y divide-border",children:[i.jsx("tr",{className:"bg-page/50",children:i.jsx("td",{colSpan:o.length+1,className:"p-2 font-bold text-primary-text",children:"Uncategorized"})}),Z.map(oe)]})]})]})})]})},yse=Pt({id:ye().required(),name:ye().required("Module name is required"),description:ye().required("Description is required"),permissions:_s().of(ye().required()).min(1,"At least one permission must be selected")}).defined(),vse=({isOpen:n,onClose:e,onSave:t,initialData:r})=>{const{register:s,handleSubmit:a,control:o,reset:l,formState:{errors:c}}=tn({resolver:On(yse)});return E.useEffect(()=>{n&&l(r||{id:`mod_${Date.now()}`,name:"",description:"",permissions:[]})},[n,r,l]),n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-2xl my-8 animate-fade-in-scale flex flex-col",onClick:d=>d.stopPropagation(),children:i.jsxs("form",{onSubmit:a(t),children:[i.jsx("div",{className:"p-4 border-b",children:i.jsxs("h3",{className:"text-xl font-bold",children:[r?"Edit":"Add"," Module"]})}),i.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[i.jsx(we,{label:"Module Name",...s("name"),error:c.name?.message}),i.jsx(we,{label:"Description",...s("description"),error:c.description?.message}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Permissions"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 p-4 border rounded-lg h-64 overflow-y-auto bg-page",children:i.jsx(_e,{name:"permissions",control:o,render:({field:d})=>i.jsx(i.Fragment,{children:Sm.map(h=>i.jsx(kn,{id:`perm-${h.key}`,label:h.name,checked:d.value?.includes(h.key)||!1,onChange:p=>{const x=p?[...d.value||[],h.key]:(d.value||[]).filter(v=>v!==h.key);d.onChange(x)}},h.key))})})}),c.permissions&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:Array.isArray(c.permissions)?c.permissions[0]?.message:c.permissions.message})]})]}),i.jsxs("div",{className:"p-4 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(ne,{type:"submit",children:"Save Module"})]})]})})}):null},bse=({count:n=6})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:n}).map((e,t)=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Gr,{className:"h-5 w-5 rounded-full"}),i.jsx(Gr,{className:"h-5 w-1/2"})]}),i.jsx(Gr,{className:"h-4 w-full"}),i.jsx(Gr,{className:"h-4 w-3/4"}),i.jsx(Gr,{className:"h-3 w-1/4"})]},t))}),wse=()=>{const n=Nt(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(null),[l,c]=E.useState(!1),[d,h]=E.useState(!1),[p,x]=E.useState(null);E.useEffect(()=>{(async()=>{s(!0);try{const j=await ce.getModules();t(j)}catch{o({message:"Failed to load modules.",type:"error"})}finally{s(!1)}})()},[]);const v=async _=>{const j=[...e],C=j.findIndex(P=>P.id===_.id);C>-1?j[C]=_:j.push(_);try{await ce.saveModules(j),t(j.sort((P,O)=>P.name.localeCompare(O.name))),o({message:`Module '${_.name}' saved.`,type:"success"}),c(!1)}catch{o({message:"Failed to save module.",type:"error"})}},b=async()=>{if(!p)return;const _=e.filter(j=>j.id!==p.id);try{await ce.saveModules(_),t(_),o({message:`Module '${p.name}' deleted.`,type:"success"}),h(!1)}catch{o({message:"Failed to delete module.",type:"error"})}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a&&i.jsx(pt,{...a,onDismiss:()=>o(null)}),i.jsx(vse,{isOpen:l,onClose:()=>c(!1),onSave:v,initialData:p}),i.jsxs(Kr,{isOpen:d,onClose:()=>h(!1),onConfirm:b,title:"Confirm Deletion",children:['Are you sure you want to delete the module "',p?.name,'"?']}),i.jsx(ra,{title:"Module Management",children:i.jsxs(ne,{onClick:()=>n("/admin/modules/add"),children:[i.jsx(Ut,{className:"mr-2 h-4"})," Add Module"]})}),r?i.jsx(bse,{count:6}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(_=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col",children:[i.jsxs("div",{className:"flex-grow",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx(bm,{className:"h-5 w-5 text-accent"}),i.jsx("h4",{className:"font-bold text-primary-text",children:_.name})]}),i.jsx("p",{className:"text-sm text-muted mb-3",children:_.description}),i.jsxs("p",{className:"text-xs font-semibold text-muted",children:[_.permissions.length," permissions"]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border flex justify-end gap-2",children:[i.jsx(ne,{variant:"icon",onClick:()=>{x(_),c(!0)},title:`Edit ${_.name}`,className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(ur,{className:"h-5 w-5"})}),i.jsx(ne,{variant:"icon",onClick:()=>{x(_),h(!0)},title:`Delete ${_.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(sn,{className:"h-5 w-5 text-red-500"})})]})]},_.id))})]})},NS=({title:n,icon:e,children:t})=>i.jsxs("div",{className:"bg-page p-4 rounded-lg",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(e,{className:"h-5 w-5 text-accent-dark mr-3"}),i.jsx("h4",{className:"font-semibold text-primary-text",children:n})]}),i.jsx("div",{className:"space-y-4",children:t})]}),_se=({isOpen:n,onClose:e})=>{const{currentLogo:t,defaultLogo:r,setCurrentLogo:s,setDefaultLogo:a,resetToDefault:o,resetToOriginal:l}=Am(),{backgroundImages:c,addBackgroundImage:d,removeBackgroundImage:h}=N3(),p=_3(),{appTitle:x,setAppTitle:v}=on(),[b,_]=E.useState(x),[j,C]=E.useState(null);ot.useEffect(()=>{_(x)},[x]);const P=async()=>{v(b);try{const{settings:q}=await ce.getInitialAppData(),U=q.apiSettings||{};await ce.updateSettings({apiSettings:{...U,appTitle:b}}),C({message:"Application title updated globally.",type:"success"})}catch(q){console.error("Failed to save app title:",q),C({message:"Title set locally, but failed to save globally.",type:"error"})}},O=q=>{if(q){const U=new FileReader;U.readAsDataURL(q.file),U.onloadend=()=>{const B=U.result;s(B),C({message:"Active logo updated!",type:"success"})},U.onerror=()=>{C({message:"Failed to read logo file.",type:"error"})}}},M=async()=>{a();try{const{settings:q}=await ce.getInitialAppData(),U=q.apiSettings||{};await ce.updateSettings({apiSettings:{...U,globalLogo:t}}),C({message:"Active logo has been set as the global default.",type:"success"})}catch(q){console.error("Failed to save global logo:",q),C({message:"Logo set locally, but failed to save globally.",type:"error"})}},D=()=>{o(),C({message:"Logo has been reset to your default.",type:"success"})},I=()=>{l(),C({message:"Logo has been reset to the system original.",type:"success"})},F=q=>{if(q&&!q.url){const U=new FileReader;U.readAsDataURL(q.file),U.onloadend=()=>{const B=U.result,W=d(B);C(W?{message:"Background image added.",type:"success"}:{message:"This image has already been added.",type:"error"})},U.onerror=()=>{C({message:"Failed to read image file.",type:"error"})}}};return n?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:[j&&i.jsx(pt,{message:j.message,type:j.type,onDismiss:()=>C(null)}),i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale flex flex-col",onClick:q=>q.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Page Interface Settings"}),i.jsx(ne,{variant:"icon",onClick:e,children:i.jsx(wi,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[75vh]",children:[i.jsxs(NS,{title:"Branding & Logo",icon:c3,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the active and default logos for your application."}),i.jsxs("div",{className:"pt-2 pb-4 border-b mb-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:"Application Title"}),i.jsxs("div",{className:"flex gap-2 items-end",children:[i.jsx("div",{className:"flex-grow",children:i.jsx(we,{value:b,onChange:q=>_(q.target.value),placeholder:"Enter App Title (e.g. Paradigm Employee Onboarding)"})}),i.jsx(ne,{onClick:P,children:"Save Title"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pt-4 items-start",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Active Logo"}),i.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:i.jsx("img",{src:t,alt:"Current Active Logo",className:"max-h-24 w-auto"})}),i.jsx(vt,{label:"Change Active Logo",file:null,onFileChange:O,allowedTypes:["image/jpeg","image/png"]})]}),i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Default Logo"}),i.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:i.jsx("img",{src:r,alt:"Default Logo",className:"max-h-24 w-auto"})})]}),i.jsx("div",{className:"flex-grow"}),i.jsxs("div",{className:"space-y-2 mt-4",children:[i.jsx(ne,{type:"button",className:"w-full",onClick:M,children:"Set Active Logo as Default"}),i.jsx(ne,{type:"button",className:"w-full",variant:"outline",onClick:D,children:"Use Default Logo"}),i.jsx("div",{className:"text-center pt-2",children:i.jsx("button",{type:"button",onClick:I,className:"text-xs text-muted hover:text-primary-text underline",children:"Reset to System Original"})})]})]})]})]}),i.jsxs(NS,{title:"Login Screen Background",icon:d3,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the background images for the login screen carousel."}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:c.map((q,U)=>i.jsxs("div",{className:"relative group aspect-video bg-page rounded-md overflow-hidden",children:[i.jsx("img",{src:q,className:"w-full h-full object-cover",alt:`Background ${U+1}`}),i.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:i.jsx(ne,{variant:"icon",onClick:()=>h(U),className:"!rounded-full !bg-white/20 hover:!bg-white/40",children:i.jsx(sn,{className:"h-5 w-5 text-white"})})})]},`${q.substring(0,30)}-${U}`))}),i.jsx("div",{className:"mt-4",children:i.jsx(vt,{label:"Add new background image",file:null,onFileChange:F,allowedTypes:["image/jpeg","image/png","image/webp"]})})]}),i.jsxs(NS,{title:"Interaction Settings",icon:IJ,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize hover and auto-scroll behaviors for easier navigation."}),i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsx(kn,{id:"auto-click-hover-modal",label:"Enable Auto-Click on Hover",description:"Automatically switch tabs or pages by hovering over them.",checked:p.autoClickOnHover,onChange:q=>p.setAutoClickOnHover(q.target.checked)}),i.jsx(kn,{id:"auto-scroll-hover-modal",label:"Enable Auto-Scroll on Hover",description:"Automatically scroll the page by hovering over the up/down arrows.",checked:p.autoScrollOnHover,onChange:q=>p.setAutoScrollOnHover(q.target.checked)})]})]})]}),i.jsx("div",{className:"p-4 border-t flex justify-end",children:i.jsx(ne,{variant:"primary",onClick:e,children:"Done"})})]})]}):null},Zd=({title:n,icon:e,children:t,className:r})=>i.jsxs("div",{className:`border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card ${r||""}`,children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(e,{className:"h-6 w-6 text-accent-dark"})}),i.jsx("div",{children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:n})})]}),i.jsx("div",{className:"space-y-4",children:t})]}),jse=()=>{const n=bi(),{colorScheme:e,setColorScheme:t}=on(),[r,s]=E.useState(!1),[a,o]=E.useState(null),[l,c]=E.useState(!1),[d,h]=E.useState(!1),p=async()=>{s(!0),o(null);try{const b=await ce.exportAllData(),_=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(b,null,2))}`,j=document.createElement("a");j.href=_,j.download=`paradigm_backup_${new Date().toISOString()}.json`,document.body.appendChild(j),j.click(),document.body.removeChild(j),o({message:"Data exported successfully!",type:"success"})}catch{o({message:"Failed to export data.",type:"error"})}finally{s(!1)}},x={green:"Paradigm Green",purple:"Royal Purple",red:"Crimson Red",amber:"Amber Gold","professional-blue":"Professional Blue","dark-saas":"Dark SaaS","teal-mint":"Teal & Mint","indigo-violet":"Indigo & Violet","green-finance":"Green Finance","orange-energy":"Orange Energy","red-alert":"Red Alert","neutral-gray":"Neutral Gray","cyan-tech":"Cyan Tech","black-gold":"Premium Black & Gold"},v=async b=>{if(t(b),d)try{const{settings:_}=await ce.getInitialAppData(),j=_.apiSettings||{};await ce.updateSettings({apiSettings:{...j,colorScheme:b}}),o({message:`Global theme updated to ${x[b]}!`,type:"success"})}catch(_){console.error("Failed to save theme globally:",_),o({message:"Failed to save theme setting globally.",type:"error"})}else o({message:`Color scheme changed to ${x[b]}!`,type:"success"})};return i.jsxs("div",{className:"space-y-8 p-4 md:p-0",children:[a&&i.jsx(pt,{message:a.message,type:a.type,onDismiss:()=>o(null)}),i.jsx(_se,{isOpen:l,onClose:()=>c(!1)}),i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"System Settings"})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[i.jsxs("div",{className:"space-y-8",children:[i.jsxs(Zd,{title:"Color Scheme",icon:FJ,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Choose the application's primary color scheme."}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4",children:[[{id:"green",label:"Paradigm Green",desc:"Nature theme",color:"#006B3F",border:"border-green-500",bg:"bg-green-50",ring:"ring-green-200",icon:"P"},{id:"professional-blue",label:"Professional Blue",desc:"Enterprise / Admin",color:"#2563EB",border:"border-blue-600",bg:"bg-blue-50",ring:"ring-blue-200",icon:"B"},{id:"purple",label:"Royal Purple",desc:"Premium theme",color:"#5B21B6",border:"border-purple-500",bg:"bg-purple-50",ring:"ring-purple-200",icon:"R"},{id:"red",label:"Crimson Red",desc:"Bold theme",color:"#991B1B",border:"border-red-500",bg:"bg-red-50",ring:"ring-red-200",icon:"C"},{id:"amber",label:"Amber Gold",desc:"Warm theme",color:"#B45309",border:"border-orange-500",bg:"bg-orange-50",ring:"ring-orange-200",icon:"A"},{id:"dark-saas",label:"Dark SaaS",desc:"Modern / Developer",color:"#0F172A",border:"border-slate-800",bg:"bg-slate-900",ring:"ring-slate-700",icon:"D"},{id:"teal-mint",label:"Teal & Mint",desc:"Health / Facility",color:"#0D9488",border:"border-teal-500",bg:"bg-teal-50",ring:"ring-teal-200",icon:"T"},{id:"indigo-violet",label:"Indigo & Violet",desc:"HR / Productivity",color:"#4F46E5",border:"border-indigo-500",bg:"bg-indigo-50",ring:"ring-indigo-200",icon:"I"},{id:"green-finance",label:"Green Finance",desc:"Billing / Payroll",color:"#15803D",border:"border-emerald-600",bg:"bg-emerald-50",ring:"ring-emerald-200",icon:"G"},{id:"orange-energy",label:"Orange Energy",desc:"Operations / Field",color:"#EA580C",border:"border-orange-600",bg:"bg-orange-50",ring:"ring-orange-200",icon:"O"},{id:"red-alert",label:"Red Alert",desc:"Security / Critical",color:"#DC2626",border:"border-red-600",bg:"bg-red-50",ring:"ring-red-200",icon:"R"},{id:"neutral-gray",label:"Neutral Gray",desc:"Minimal / Data",color:"#374151",border:"border-gray-500",bg:"bg-gray-50",ring:"ring-gray-200",icon:"N"},{id:"cyan-tech",label:"Cyan Tech",desc:"Smart Systems",color:"#0891B2",border:"border-cyan-500",bg:"bg-cyan-50",ring:"ring-cyan-200",icon:"C"},{id:"black-gold",label:"Premium Black & Gold",desc:"Management / Exec",color:"#111827",border:"border-yellow-600",bg:"bg-gray-900",ring:"ring-yellow-500",icon:"G"}].map(b=>i.jsxs("button",{type:"button",onClick:()=>v(b.id),className:`flex items-center gap-3 p-4 rounded-xl border-2 transition-all ${e===b.id?`${b.border} ${b.bg} ring-2 ${b.ring}`:"border-border hover:border-gray-300"}`,children:[i.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:b.color},children:i.jsx("span",{className:`font-bold text-sm ${["dark-saas","black-gold"].includes(b.id),"text-white"}`,children:b.icon})}),i.jsxs("div",{className:"text-left",children:[i.jsx("p",{className:`font-semibold ${["dark-saas","black-gold"].includes(b.id)&&e===b.id,"text-primary-text"}`,children:b.label}),i.jsx("p",{className:"text-xs text-muted",children:b.desc})]})]},b.id)),i.jsx("div",{className:"col-span-1 sm:col-span-2 mt-4 pt-4 border-t border-border",children:i.jsx(kn,{id:"global-theme-default",label:"Set as Global Default",description:"If checked, the selected color scheme will be applied to all users who haven't set a preference.",checked:d,onChange:b=>h(b.target.checked)})})]})]}),i.jsxs(Zd,{title:"Page Interface",icon:c3,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize the application's branding, login screen, and user interaction settings."}),i.jsx("div",{className:"pt-4",children:i.jsx(ne,{type:"button",onClick:()=>c(!0),children:"Open Interface Settings"})})]}),i.jsxs(Zd,{title:"Verification APIs",icon:dy,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure third-party services for employee verification."}),i.jsxs("div",{className:"space-y-6 pt-4",children:[i.jsx("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:i.jsx(kn,{id:"gemini-enabled",label:"Enable Gemini API OCR Verification",description:"Use Google's Gemini API for document data extraction. This is a powerful fallback or primary OCR. API key must be configured on the backend.",checked:n.geminiApi.enabled,onChange:b=>n.updateGeminiApiSettings({enabled:b.target.checked})})}),i.jsxs("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:[i.jsx(kn,{id:"perfios-enabled",label:"Enable Perfios API Verification",description:"Use Perfios for Bank, Aadhaar, and UAN verification.",checked:n.perfiosApi.enabled,onChange:b=>n.updatePerfiosApiSettings({enabled:b.target.checked})}),i.jsxs("div",{className:`mt-4 space-y-4 transition-opacity ${n.perfiosApi.enabled?"opacity-100":"opacity-50 pointer-events-none"}`,children:[i.jsx(we,{label:"Perfios Client ID",value:n.perfiosApi.clientId,onChange:b=>n.updatePerfiosApiSettings({clientId:b.target.value})}),i.jsx(we,{label:"Perfios Client Secret",type:"password",value:n.perfiosApi.clientSecret,onChange:b=>n.updatePerfiosApiSettings({clientSecret:b.target.value})})]})]})]})]}),i.jsxs(Zd,{title:"Authentication Settings",icon:Lf,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage how users sign in to the application."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(kn,{id:"otp-enabled",label:"Enable OTP Phone Sign-In",description:"Allow users to sign in using a one-time password sent via SMS.",checked:n.otp.enabled,onChange:b=>n.updateOtpSettings({enabled:b.target.checked})})})]})]}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs(Zd,{title:"Client & Site Management",icon:Ki,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Control workflows for site creation and management."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(kn,{id:"enable-provisional-sites",label:"Enable Provisional Site Creation",description:"Allows HR/Admins to create a site with just a name, providing a 90-day grace period to complete the full configuration for easier onboarding.",checked:n.siteManagement.enableProvisionalSites,onChange:b=>n.updateSiteManagementSettings({enableProvisionalSites:b.target.checked})})})]}),i.jsxs(Zd,{title:"System & Data",icon:Rm,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage core system settings and data operations."}),i.jsxs("div",{className:"space-y-6 pt-4",children:[i.jsx(kn,{id:"pincode-verification",label:"Enable Pincode API Verification",description:"Auto-fill City/State from pincode during onboarding.",checked:n.address.enablePincodeVerification,onChange:b=>n.updateAddressSettings({enablePincodeVerification:b.target.checked})}),i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:"Backup & Export"}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Download all data from the active data source (Mock Data)."}),i.jsxs(ne,{type:"button",variant:"outline",onClick:p,isLoading:r,children:[i.jsx(_i,{className:"mr-2 h-4 w-4"})," Export All Data"]})]})]})]}),i.jsxs(Zd,{title:"Notification Settings",icon:Gf,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure how the system sends notifications."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(kn,{id:"email-notif-enabled",label:"Enable Email Notifications",description:"Send emails for important events like task assignments. SMTP must be configured on the backend.",checked:n.notifications.email.enabled,onChange:b=>n.updateNotificationSettings({email:{enabled:b.target.checked}})})})]})]})]})]})},Mr=({title:n,subtitle:e})=>i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text form-header-title",children:n}),i.jsx("p",{className:"mt-2 text-sm text-muted",children:e})]}),Sse=({title:n,value:e,icon:t})=>i.jsxs("div",{className:"p-4 rounded-2xl flex flex-col md:flex-row items-start md:items-center col-span-1 gap-3 md:gap-0 transition-colors bg-card shadow-sm",children:[i.jsx("div",{className:"p-3 rounded-full md:mr-4 bg-accent-light",children:i.jsx(t,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted",children:n}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:e})]})]}),So=ot.memo(Sse),Nse=()=>{const n=Nt(),{colorScheme:e}=on(),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState([]),[c,d]=E.useState(!0),[h,p]=E.useState(null),[x,v]=E.useState([{startDate:new Date(new Date().setMonth(new Date().getMonth()-1)),endDate:new Date,key:"selection"}]),[b,_]=E.useState(!1),[j,C]=E.useState(""),[P,O]=E.useState(""),[M,D]=E.useState(We(new Date,"yyyy-MM-dd"));E.useEffect(()=>{(async()=>{d(!0);try{const[W,Y,G]=await Promise.all([ce.getVerificationSubmissions(),ce.getFieldOfficers(),ce.getOrganizations()]);r(W),a(Y),l(G)}catch{p({message:"Failed to load dashboard data.",type:"error"})}finally{d(!1)}})()},[]);const I=E.useMemo(()=>{const B=x[0].startDate,W=x[0].endDate;if(!B||!W)return t;const Y=new Date(W);return Y.setHours(23,59,59,999),t.filter(G=>{const Z=new Date(G.enrollmentDate.replace(/-/g,"/"));return Z>=B&&Z<=Y})},[t,x]),F=E.useMemo(()=>({total:I.length,verified:I.filter(B=>B.status==="verified").length,rejected:I.filter(B=>B.status==="rejected").length}),[I]),q=async B=>{if(B.preventDefault(),!j||!P||!M){p({message:"Please fill all fields for assignment.",type:"error"});return}try{await ce.createAssignment(j,P,M),p({message:"Assignment created successfully (mocked).",type:"success"})}catch{p({message:"Failed to create assignment.",type:"error"})}},U=x[0].startDate&&x[0].endDate?`${We(x[0].startDate,"MMM d, yyyy")} - ${We(x[0].endDate,"MMM d, yyyy")}`:"Select Date";return i.jsxs("div",{className:"p-4 space-y-8",children:[h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx("div",{className:"bg-card p-4 rounded-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Operations Dashboard"}),i.jsxs("div",{className:"relative",children:[i.jsxs(ne,{variant:"outline",onClick:()=>_(!b),children:[i.jsx(Da,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:U})]}),b&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:i.jsx(jm.DateRangePicker,{onChange:B=>{v([B.selection]),_(!1)},months:1,ranges:x,direction:"horizontal"})})]})]})}),i.jsx("div",{className:"bg-gradient-to-br from-accent/10 to-accent/5 border-2 border-accent/30 rounded-2xl p-6 cursor-pointer hover:border-accent hover:shadow-lg transition-all group",onClick:()=>n("/operations/team-activity"),children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"bg-accent rounded-xl p-3 group-hover:scale-110 transition-transform",children:i.jsx(Gh,{className:"h-6 w-6 text-white"})}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Team Activity Monitor"})]}),i.jsx("p",{className:"text-muted mb-4",children:"Track your field team in real-time. Monitor check-ins, working hours, locations, and communicate instantly with your team members."}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("span",{className:"px-3 py-1 bg-green-500/10 text-green-600 rounded-full text-xs font-medium",children:"Real-time tracking"}),i.jsx("span",{className:"px-3 py-1 bg-blue-500/10 text-blue-600 rounded-full text-xs font-medium",children:"Location monitoring"}),i.jsx("span",{className:"px-3 py-1 bg-purple-500/10 text-purple-600 rounded-full text-xs font-medium",children:"Quick communication"})]})]}),i.jsx("div",{className:"flex-shrink-0 ml-4",children:i.jsx(ne,{onClick:B=>{B.stopPropagation(),n("/operations/team-activity")},style:{backgroundColor:e==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF"},children:"View Team Activity "})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsx(So,{title:"Total Submissions",value:F.total,icon:ds}),i.jsx(So,{title:"Verified Employees",value:F.verified,icon:yu}),i.jsx(So,{title:"Rejected Applications",value:F.rejected,icon:Ax})]}),i.jsxs("div",{className:"bg-card p-6 rounded-2xl",children:[i.jsx(Mr,{title:"Assign Field Officer",subtitle:"Assign a field officer to an organization for a specific date."}),i.jsxs("form",{onSubmit:q,className:"grid grid-cols-1 md:grid-cols-4 gap-6 items-end",children:[i.jsx("div",{className:"md:col-span-1",children:i.jsxs(Ze,{label:"Field Officer",id:"officer",value:j,onChange:B=>C(B.target.value),children:[i.jsx("option",{value:"",children:"Select Officer"}),s.map(B=>i.jsx("option",{value:B.id,children:B.name},B.id))]})}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs(Ze,{label:"Organization/Site",id:"site",value:P,onChange:B=>O(B.target.value),children:[i.jsx("option",{value:"",children:"Select Site"}),o.map(B=>i.jsx("option",{value:B.id,children:B.shortName},B.id))]})}),i.jsx("div",{className:"md:col-span-1",children:i.jsx(En,{label:"Assignment Date",id:"assignmentDate",value:M,onChange:D})}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs(ne,{type:"submit",className:"w-full",children:[i.jsx(OC,{className:"mr-2 h-4 w-4"}),"Assign"]})})]})]})]})},Cse=()=>{const{user:n}=jt(),{colorScheme:e}=on(),[t,r]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(null),c=At("(max-width: 767px)");E.useEffect(()=>{d();const _=setInterval(d,3e4);return()=>clearInterval(_)},[n]);const d=async()=>{if(n)try{a(!0);const _=await ce.getUsers();let j=[];n.role==="admin"||n.role==="developer"?j=_.filter(M=>M.role==="operation_manager"||M.role==="field_officer"):n.role==="operation_manager"&&(j=_.filter(M=>M.role==="field_officer"&&M.reportingManagerId===n.id));const C=new Date;C.setHours(0,0,0,0);const P=new Date;P.setHours(23,59,59,999);const O=await Promise.all(j.map(async M=>{try{const I=(await ce.getAttendanceEvents(M.id,C.toISOString(),P.toISOString())).sort((G,Z)=>new Date(Z.timestamp).getTime()-new Date(G.timestamp).getTime()),F=I.filter(G=>G.type.toLowerCase().replace(/[-_\s]/g,"")==="checkin"),q=I.filter(G=>G.type.toLowerCase().replace(/[-_\s]/g,"")==="checkout"),U=F[0],B=q[0];let W=0;for(let G=0;G<q.length;G++){const Z=q[G],oe=F.find(X=>new Date(X.timestamp)<new Date(Z.timestamp));if(oe){const X=new Date(Z.timestamp).getTime()-new Date(oe.timestamp).getTime();W+=X/(1e3*60*60)}}const Y=U&&(!B||new Date(U.timestamp)>new Date(B.timestamp));if(Y&&U){const G=Date.now()-new Date(U.timestamp).getTime();W+=G/(1e3*60*60)}return{...M,lastCheckIn:U?.timestamp,lastCheckOut:B?.timestamp,currentLocation:U?{latitude:U.latitude||0,longitude:U.longitude||0,address:U.address||void 0}:void 0,todayWorkingHours:W,todayTravelDistance:0,isCurrentlyWorking:Y,isPresent:F.length>0}}catch(D){return console.error(`Error fetching data for ${M.name}:`,D),{...M,isPresent:!1,isCurrentlyWorking:!1}}}));r(O)}catch(_){console.error("Error fetching team members:",_)}finally{a(!1)}},h=_=>{if(!_)return;const j=_.replace(/\D/g,"").slice(-10);window.location.href=`tel:+91${j}`},p=_=>{if(!_)return;const j=_.replace(/\D/g,"").slice(-10);window.location.href=`sms:+91${j}`},x=_=>{if(!_)return"0h 0m";const j=Math.floor(_),C=Math.floor((_-j)*60);return`${j}h ${C}m`};if(s)return i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})});const v=({member:_})=>i.jsx("div",{className:"bg-card border border-border rounded-xl p-4 hover:border-accent transition-all cursor-pointer",onClick:()=>l(_),children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Zi,{photoUrl:_.photoUrl,seed:_.id,className:"w-12 h-12 rounded-full"}),i.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ring-2 ring-white ${_.isCurrentlyWorking?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":_.isPresent?"bg-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.8)]":"bg-gray-400"}`})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-primary-text truncate",children:_.name}),i.jsx("p",{className:"text-xs text-muted",children:_.role.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())}),i.jsxs("div",{className:"mt-2 space-y-1",children:[i.jsx("div",{className:"flex items-center gap-2 text-xs",children:_.isCurrentlyWorking?i.jsxs(i.Fragment,{children:[i.jsx(Gh,{className:"h-3 w-3 text-green-500"}),i.jsx("span",{className:"text-green-500 font-medium",children:"Working"})]}):_.isPresent?i.jsxs(i.Fragment,{children:[i.jsx(qM,{className:"h-3 w-3 text-yellow-500"}),i.jsx("span",{className:"text-yellow-500",children:"Checked Out"})]}):i.jsxs(i.Fragment,{children:[i.jsx(ym,{className:"h-3 w-3 text-gray-400"}),i.jsx("span",{className:"text-gray-400",children:"Absent"})]})}),_.todayWorkingHours>0&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted",children:[i.jsx(Hc,{className:"h-3 w-3"}),i.jsx("span",{children:x(_.todayWorkingHours)})]})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:j=>{j.stopPropagation(),h(_.phone)},className:"hover:bg-accent/10",style:{backgroundColor:e==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF"},children:i.jsx(Lf,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:j=>{j.stopPropagation(),p(_.phone)},className:"hover:bg-accent/10",style:{backgroundColor:e==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF"},children:i.jsx(vm,{className:"h-4 w-4"})})]})]})}),b=({member:_})=>i.jsxs("div",{className:"bg-card border border-border rounded-xl p-6",children:[i.jsxs("div",{className:"flex items-start justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Zi,{photoUrl:_.photoUrl,seed:_.id,className:"w-16 h-16 rounded-full"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:_.name}),i.jsx("p",{className:"text-sm text-muted",children:_.role.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())})]})]}),c&&i.jsx(ne,{variant:"secondary",size:"sm",onClick:()=>l(null),children:"Close"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Ix,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Last Check In"})]}),i.jsx("p",{className:"text-sm font-bold text-primary-text",children:_.lastCheckIn?We(new Date(_.lastCheckIn),"hh:mm a"):"Not checked in"}),_.lastCheckIn&&i.jsx("p",{className:"text-xs text-muted mt-1",children:mu(new Date(_.lastCheckIn),{addSuffix:!0})})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(jo,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Last Check Out"})]}),i.jsx("p",{className:"text-sm font-bold text-primary-text",children:_.lastCheckOut?We(new Date(_.lastCheckOut),"hh:mm a"):"Not checked out"}),_.lastCheckOut&&i.jsx("p",{className:"text-xs text-muted mt-1",children:mu(new Date(_.lastCheckOut),{addSuffix:!0})})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Hc,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Working Hours Today"})]}),i.jsx("p",{className:"text-lg font-bold text-primary-text",children:x(_.todayWorkingHours)})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Gh,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Status"})]}),i.jsx("p",{className:`text-lg font-bold ${_.isCurrentlyWorking?"text-green-500":_.isPresent?"text-yellow-500":"text-gray-400"}`,children:_.isCurrentlyWorking?"Working":_.isPresent?"Checked Out":"Absent"})]})]}),_.currentLocation&&i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Pl,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Current Location"})]}),i.jsx("p",{className:"text-sm text-primary-text",children:_.currentLocation.address||"Location not available"}),_.currentLocation.latitude!==0&&i.jsx("a",{href:`https://www.google.com/maps?q=${_.currentLocation.latitude},${_.currentLocation.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-accent hover:underline mt-2 inline-block",children:"View on map "})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(ne,{onClick:()=>h(_.phone),className:"flex-1",style:{backgroundColor:e==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF"},children:[i.jsx(Lf,{className:"h-4 w-4 mr-2"}),"Call"]}),i.jsxs(ne,{onClick:()=>p(_.phone),className:"flex-1",style:{backgroundColor:e==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF"},children:[i.jsx(vm,{className:"h-4 w-4 mr-2"}),"Message"]})]})]});return i.jsxs("div",{className:"p-4 lg:p-8 space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-primary-text",children:"Team Activity"}),i.jsx("p",{className:"text-sm text-muted mt-1",children:n?.role==="operation_manager"?"Monitor your field team in real-time":"Monitor all operation managers and field officers"})]}),i.jsxs(ne,{onClick:d,variant:"secondary",size:"sm",children:[i.jsx(Gh,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Ml,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Total Team"})]}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:t.length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Gh,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Working Now"})]}),i.jsx("p",{className:"text-2xl font-bold text-green-500",children:t.filter(_=>_.isCurrentlyWorking).length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(qM,{className:"h-4 w-4 text-yellow-500"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Present"})]}),i.jsx("p",{className:"text-2xl font-bold text-yellow-500",children:t.filter(_=>_.isPresent).length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(ym,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Absent"})]}),i.jsx("p",{className:"text-2xl font-bold text-gray-400",children:t.filter(_=>!_.isPresent).length})]})]}),c&&o?i.jsx(b,{member:o}):i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-2 space-y-3",children:t.length===0?i.jsxs("div",{className:"bg-card border border-border rounded-xl p-12 text-center",children:[i.jsx(Ml,{className:"h-12 w-12 mx-auto text-muted mb-4 opacity-50"}),i.jsx("p",{className:"text-muted",children:"No team members found"})]}):t.map(_=>i.jsx(v,{member:_},_.id))}),!c&&o&&i.jsx("div",{className:"lg:col-span-1 sticky top-6 self-start",children:i.jsx(b,{member:o})})]})]})},Tse=({status:n})=>{if(!n)return i.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});const e={pending_sync:"sync-chip--pending_sync",synced:"sync-chip--synced",failed:"sync-chip--failed"},t={pending_sync:"Pending Sync",synced:"Synced",failed:"Failed"},r=e[n];return i.jsx("span",{className:`sync-chip ${r}`,children:t[n]})},kse=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState("all"),[o,l]=E.useState(""),[c,d]=E.useState(null),h=Nt(),{user:p}=jt(),x=At("(max-width: 767px)"),{colorScheme:v}=on(),[b,_]=E.useState([]),[j,C]=E.useState(p?.organizationId),P=p&&p.role==="admin";E.useEffect(()=>{P&&ce.getOrganizations().then(F=>{_(F),F.length>0&&!j&&C(F[0].id)})},[P,j]);const O=E.useCallback(async()=>{if(!j){p?.organizationId&&r(!1);return}r(!0);try{const F=await ce.getVerificationSubmissions(s==="all"?void 0:s,j);e(F)}catch(F){console.error("Failed to fetch submissions",F)}finally{r(!1)}},[s,j,p?.organizationId]);E.useEffect(()=>{O()},[O]);const M=E.useMemo(()=>n.filter(F=>F.personal.firstName.toLowerCase().includes(o.toLowerCase())||F.personal.lastName.toLowerCase().includes(o.toLowerCase())||F.personal.employeeId.toLowerCase().includes(o.toLowerCase())),[n,o]),D=b.find(F=>F.id===j)?.shortName||p?.organizationName,I=["all","pending","verified","rejected"];return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[c&&i.jsx(pt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Site Dashboard"}),i.jsxs("p",{className:"text-muted",children:["Viewing submissions for site: ",i.jsx("span",{className:"font-semibold text-accent-dark",children:D||"N/A"})]})]}),!x&&i.jsxs("div",{className:"flex items-center gap-4",children:[P&&i.jsx("div",{className:"w-full sm:w-56",children:i.jsxs(Ze,{label:"",id:"org-selector",value:j||"",onChange:F=>C(F.target.value),children:[i.jsx("option",{value:"",children:"Select a Site"}),b.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]})}),i.jsxs(ne,{onClick:()=>h("/onboarding/select-organization"),style:{backgroundColor:v==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:v==="blue"?"#0f264a":"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Gc,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]})]}),x&&i.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[P&&i.jsxs(Ze,{label:"Select Site",id:"org-selector-mobile",value:j||"",onChange:F=>C(F.target.value),children:[i.jsx("option",{value:"",children:"Select a Site"}),b.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]}),i.jsxs(ne,{onClick:()=>h("/onboarding/select-organization"),style:{backgroundColor:v==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:v==="blue"?"#0f264a":"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Gc,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center my-6 gap-4",children:[i.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:i.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:I.map(F=>i.jsx("button",{onClick:()=>a(F),className:`${s===F?"border-emerald-500 text-emerald-700":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize transition-colors duration-200`,children:F},F))})}),i.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ia,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name or ID...",value:o,onChange:F=>l(F.target.value),className:"block w-full pl-10 pr-3 py-2 border border-border rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Sync"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading submissions..."})}):j?M.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No submissions found for this site."})}):M.map(F=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:[i.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[F.personal.firstName," ",F.personal.lastName]}),i.jsx("div",{className:"text-sm text-muted",children:F.personal.employeeId})]}),i.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(VC,{status:F.status})}),i.jsx("td",{"data-label":"Portal Sync",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(Tse,{status:F.portalSyncStatus})}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>h(`/onboarding/add/personal?id=${F.id}`),title:"View/Edit Details",children:i.jsx(Tl,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>h(`/onboarding/pdf/${F.id}`),title:"Download Forms",children:i.jsx(ds,{className:"h-4 w-4"})})]})})]},F.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Please select a site to view submissions."})})})]})})]})},YN=({file:n,onFileChange:e})=>{const[t,r]=E.useState(!1),[s,a]=E.useState(""),[o,l]=E.useState(!1),c=E.useCallback(async v=>{if(v&&v.type.startsWith("image/")){a("");const b={name:v.name,type:v.type,size:v.size,preview:URL.createObjectURL(v),file:v};e(b)}},[e]),d=async v=>{const b=v.target.files?.[0];b&&c(b)},h=E.useCallback(async(v,b)=>{const _=await(await fetch(`data:${b};base64,${v}`)).blob(),j=new File([_],`capture-${Date.now()}.jpg`,{type:b});c(j)},[c]),p=()=>{n&&URL.revokeObjectURL(n.preview),e(null),a("")},x="avatar-upload";return i.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[o&&i.jsx(r5,{isOpen:o,onClose:()=>l(!1),onCapture:h,captureGuidance:"profile"}),i.jsxs("div",{className:"relative w-40 h-40",children:[i.jsx("div",{className:`w-full h-full rounded-full bg-page flex items-center justify-center overflow-hidden border-2 transition-colors ${s?"border-red-500":"border-border"}`,children:t?i.jsxs("div",{className:"flex flex-col items-center text-muted",children:[i.jsx(_t,{className:"h-8 w-8 animate-spin"}),i.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):n?.preview?i.jsx("img",{src:n.preview,alt:"Profile preview",className:"w-full h-full object-cover"}):i.jsx(Zi,{})}),n&&!t&&i.jsx("button",{type:"button",onClick:p,id:"avatar-delete-button",className:"avatar-delete-btn btn-icon absolute top-2 right-2 p-1.5 rounded-full transition-colors !bg-white/90 !text-red-600 hover:!bg-red-100","aria-label":"Remove photo",children:i.jsx(sn,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("label",{htmlFor:x,className:`cursor-pointer inline-flex items-center justify-center font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200 rounded-full bg-accent text-white hover:bg-accent-dark focus:ring-accent px-4 py-2 text-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[i.jsx(ur,{className:"w-4 h-4 mr-2"}),n?"Change":"Upload"]}),i.jsx("input",{id:x,name:x,type:"file",className:"sr-only",onChange:d,accept:"image/*",disabled:t}),i.jsxs("button",{type:"button",onClick:()=>l(!0),disabled:t,className:`avatar-capture-btn inline-flex items-center justify-center px-4 py-2 font-semibold rounded-full transition-colors duration-200 text-sm border border-red-200 !text-red-600 hover:!bg-red-50 !bg-card/70 backdrop-blur-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[i.jsx(PC,{className:"w-4 h-4 mr-2"}),"Capture"]})]}),s&&i.jsxs("p",{className:"text-xs text-red-600 text-center max-w-[160px] flex items-center gap-1",children:[i.jsx(Aa,{className:"h-3 w-3 flex-shrink-0"})," ",s]})]})},Pse=Pt({name:ye().required("Name is required"),email:ye().email("Must be a valid email").required("Email is required"),phone:ye().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number").optional().nullable()}).defined(),Mse=()=>{const{user:n,updateUserProfile:e,isCheckedIn:t,isAttendanceLoading:r,toggleCheckInStatus:s,logout:a,lastCheckInTime:o,lastCheckOutTime:l,checkAttendanceStatus:c}=jt(),{permissions:d}=na(),h=Nt(),{theme:p,setTheme:x,isAutomatic:v,setAutomatic:b}=td(),{colorScheme:_}=on(),j=qa(_),[C,P]=E.useState(!1),[O,M]=E.useState(!1),[D,I]=E.useState(null),[F,q]=E.useState("prompt"),B=At("(max-width: 767px)");E.useEffect(()=>{const ie=async()=>{if(!navigator.permissions?.query){q("prompt");return}try{const pe=await navigator.permissions.query({name:"camera"}),re=await navigator.permissions.query({name:"geolocation"});pe.state==="granted"&&re.state==="granted"?q("granted"):pe.state==="denied"||re.state==="denied"?q("denied"):q("prompt");const de=()=>ie();pe.onchange=de,re.onchange=de}catch(pe){console.warn("Permissions API not fully supported. Defaulting to 'prompt'.",pe),q("prompt")}};ie()},[]);const{register:W,handleSubmit:Y,formState:{errors:G,isDirty:Z},getValues:oe,trigger:X,reset:he}=tn({resolver:On(Pse),defaultValues:{name:n?.name||"",email:n?.email||"",phone:n?.phone||""}});E.useEffect(()=>{n&&he({name:n.name||"",email:n.email||"",phone:n.phone||""})},[n,he]);const $=async ie=>{if(!n)return;const pe=n.photoUrl;e({photoUrl:ie?.preview});try{let re=null;ie&&ie.file&&(re=await new Promise((je,Ae)=>{const Te=new FileReader;Te.onloadend=()=>je(Te.result),Te.onerror=Ae,Te.readAsDataURL(ie.file)}));const de=await ce.updateUser(n.id,{photoUrl:re});e(de),I({message:`Profile photo ${re?"updated":"removed"}.`,type:"success"})}catch(re){console.error(re),I({message:"Failed to save photo.",type:"error"}),e({photoUrl:pe})}},K=async ie=>{if(n){P(!0);try{const pe=await ce.updateUser(n.id,ie);e(pe),he(ie),I({message:"Profile updated successfully!",type:"success"})}catch{I({message:"Failed to update profile.",type:"error"})}finally{P(!1)}}},te=O,H=()=>{h("/auth/logout")},ae=ie=>ie?We(new Date(ie),"hh:mm a"):"--:--";n&&d[n.role]?.includes("manage_tasks");const le=ie=>ie.replace(/_/g," ").replace(/\b\w/g,pe=>pe.toUpperCase());if(!n)return i.jsx("div",{children:"Loading user profile..."});const ue=n.photoUrl?{preview:n.photoUrl,name:"Profile Photo",type:"image/jpeg",size:0}:null;return B?i.jsxs("div",{className:"p-4 space-y-8 md:bg-transparent",style:{backgroundColor:j.mobileBg},children:[D&&i.jsx(pt,{message:D.message,type:D.type,onDismiss:()=>I(null)}),i.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[i.jsx(YN,{file:ue,onFileChange:$}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold",style:{color:j.isDark?"white":"#111827"},children:n.name}),i.jsx("p",{style:{color:j.isDark?"#9ca3af":"#6b7280"},children:n.role.replace(/_/g," ").replace(/\b\w/g,ie=>ie.toUpperCase())})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"fo-section-title mb-4",style:{color:j.isDark?"white":"#111827",borderColor:j.isDark?"#374151":"#e5e7eb"},children:"Profile Details"}),i.jsxs("form",{onSubmit:Y(K),className:"space-y-4",children:[i.jsx(we,{label:"Full Name",id:"name",error:G.name?.message,registration:W("name"),className:"",style:{backgroundColor:j.isDark?"#1f2937":"#f9fafb",borderColor:j.isDark?"#374151":"#e5e7eb",color:j.isDark?"white":"#111827"},labelClassName:j.isDark?"text-gray-300":"text-gray-700"}),i.jsx(we,{label:"Email Address",id:"email",type:"email",error:G.email?.message,registration:W("email"),readOnly:!0,className:"",style:{backgroundColor:j.isDark?"#374151":"#f3f4f6",borderColor:j.isDark?"#4b5563":"#e5e7eb",color:j.isDark?"#9ca3af":"#6b7280"},labelClassName:j.isDark?"text-gray-300":"text-gray-700"}),i.jsx(we,{label:"Phone Number",id:"phone",type:"tel",error:G.phone?.message,registration:W("phone"),className:"",style:{backgroundColor:j.isDark?"#1f2937":"#f9fafb",borderColor:j.isDark?"#374151":"#e5e7eb",color:j.isDark?"white":"#111827"},labelClassName:j.isDark?"text-gray-300":"text-gray-700"}),i.jsx("div",{className:"flex justify-end pt-2",children:i.jsx(ne,{type:"submit",isLoading:C,disabled:!Z,children:"Save Changes"})})]})]}),i.jsxs("section",{className:"hidden md:block",children:[i.jsx("h3",{className:`fo-section-title mb-4 ${j.isDark?"":"text-gray-900"}`,children:"Appearance"}),i.jsxs("div",{className:"p-4 rounded-lg border space-y-4",style:{backgroundColor:j.isDark?j.sidebarBg:"#f9fafb",borderColor:j.isDark?"#374151":"#e5e7eb"},children:[i.jsx(kn,{id:"theme-automatic-mobile",label:"Automatic",description:"Switch themes based on screen size.",checked:v,onChange:ie=>b(ie.target.checked)}),i.jsx(kn,{id:"theme-dark-mode-mobile",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:p==="dark",onChange:ie=>x(ie.target.checked?"dark":"light"),disabled:v})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:`fo-section-title mb-4 ${j.isDark?"":"text-gray-900 border-gray-200"}`,children:"Work Hours Tracking"}),i.jsxs("div",{className:"fo-attendance-card space-y-4",style:{backgroundColor:j.isDark?"transparent":"#f9fafb",borderColor:j.isDark?void 0:"#e5e7eb",borderWidth:j.isDark?0:1},children:[i.jsxs("div",{className:"flex justify-around",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"fo-attendance-time",style:{color:j.isDark?void 0:"#6b7280"},children:"Last Check In"}),i.jsx("p",{className:"fo-attendance-time",style:{color:j.isDark?void 0:"#111827"},children:i.jsx("strong",{children:ae(o)})})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"fo-attendance-time",style:{color:j.isDark?void 0:"#6b7280"},children:"Last Check Out"}),i.jsx("p",{className:"fo-attendance-time",style:{color:j.isDark?void 0:"#111827"},children:i.jsx("strong",{children:ae(l)})})]})]}),r?i.jsx("div",{className:"flex items-center justify-center text-muted h-[56px]",children:i.jsx(_t,{className:"h-6 w-6 animate-spin"})}):i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(ne,{onClick:()=>h("/attendance/check-in"),variant:"primary",className:"flex-1 !py-4 text-lg font-bold shadow-lg transition-all rounded-2xl",disabled:t||te,children:[i.jsx(Ix,{className:"mr-3 h-6 w-6"})," Check In"]}),i.jsxs(ne,{onClick:()=>h("/attendance/check-out"),variant:"danger",className:"flex-1 !py-4 text-lg font-bold shadow-lg transition-all rounded-2xl",disabled:!t||te,children:[i.jsx(jo,{className:"mr-3 h-6 w-6"})," Check Out"]})]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:`fo-section-title mb-4 ${j.isDark?"":"text-gray-900 border-gray-200"}`,children:"Account Actions"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(ne,{onClick:()=>h("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center !py-3",style:j.isDark?{}:{backgroundColor:"#f3f4f6",color:"#1f2937"},title:"View your leave history and balances",children:[i.jsx(DN,{className:"mr-2 h-5 w-5"})," Leave Tracker"]}),i.jsxs(ne,{onClick:H,variant:"danger",className:"w-full justify-center !py-3",children:[i.jsx(jo,{className:"mr-2 h-5 w-5"})," Log Out"]})]})]})]})]}):i.jsxs("div",{className:"w-full space-y-8",children:[D&&i.jsx(pt,{message:D.message,type:D.type,onDismiss:()=>I(null)}),i.jsxs("div",{className:"relative overflow-hidden md:bg-white md:p-6 md:rounded-2xl md:shadow-lg flex flex-col md:flex-row items-center gap-6 border border-gray-100",children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-32 border-b-4 shadow-lg",style:{backgroundColor:j.mobileBg,borderColor:j.sidebarBorder||j.mobileBg}}),i.jsx("div",{className:"relative z-10",children:i.jsx(YN,{file:ue,onFileChange:$})}),i.jsxs("div",{className:"text-center md:text-left relative z-10 flex-1 mt-16 md:mt-0",children:[i.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-primary-text tracking-tight",children:n.name}),i.jsx("div",{className:"flex items-center justify-center md:justify-start gap-2 mt-1.5",children:i.jsx("span",{className:"px-2.5 py-0.5 rounded-full bg-emerald-100 text-emerald-800 border border-emerald-200 text-xs md:text-sm font-medium",children:le(n.role)})}),i.jsx("p",{className:"text-gray-500 mt-1.5 font-medium text-sm md:text-base",children:n.email})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[i.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-blue-50 rounded-lg",children:i.jsx(Ml,{className:"h-5 w-5 text-blue-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Profile Details"})]}),i.jsxs("form",{onSubmit:Y(K),className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[i.jsx(we,{label:"Full Name",id:"name",error:G.name?.message,registration:W("name"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),i.jsx(we,{label:"Phone Number",id:"phone",type:"tel",error:G.phone?.message,registration:W("phone"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(we,{label:"Email Address",id:"email",type:"email",error:G.email?.message,registration:W("email"),readOnly:!0,className:"bg-gray-100/50 text-gray-500 cursor-not-allowed border-gray-200"})})]}),i.jsx("div",{className:"flex justify-end pt-3 border-t border-gray-100",children:i.jsx(ne,{type:"submit",isLoading:C,disabled:!Z,className:"px-6",children:"Save Changes"})})]})]}),i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-purple-50 rounded-lg",children:i.jsx(s3,{className:"h-5 w-5 text-purple-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Work Hours Tracking"})]}),i.jsxs("div",{className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[i.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[i.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check In"}),i.jsx("p",{className:"text-2xl md:text-3xl font-bold text-emerald-600",children:ae(o)})]}),i.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[i.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check Out"}),i.jsx("p",{className:"text-2xl md:text-3xl font-bold text-rose-600",children:ae(l)})]})]}),r?i.jsx("div",{className:"flex items-center justify-center h-[56px] bg-gray-50 rounded-xl",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-gray-400"})}):i.jsxs("div",{className:"flex gap-4",children:[i.jsxs(ne,{onClick:()=>h("/attendance/check-in"),variant:"primary",className:"flex-1 !py-3 text-base md:text-lg shadow-lg shadow-emerald-100 hover:shadow-emerald-200 transition-all",disabled:t||te,children:[i.jsx(Ix,{className:"mr-2 h-5 w-5"})," Check In"]}),i.jsxs(ne,{onClick:()=>h("/attendance/check-out"),variant:"danger",className:"flex-1 !py-3 text-base md:text-lg shadow-lg shadow-red-100 hover:shadow-red-200 transition-all",disabled:!t||te,children:[i.jsx(jo,{className:"mr-2 h-5 w-5"})," Check Out"]})]})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Appearance"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:i.jsx(kn,{id:"theme-automatic-desktop",label:"Automatic",description:"Switch themes based on screen size.",checked:v,onChange:ie=>b(ie.target.checked)})}),i.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:i.jsx(kn,{id:"theme-dark-mode-desktop",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:p==="dark",onChange:ie=>x(ie.target.checked?"dark":"light"),disabled:v})})]})]}),i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Account Actions"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs(ne,{onClick:()=>h("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center py-3 bg-gray-50 hover:bg-gray-100 border-gray-200",title:"View your leave history and balances",children:[i.jsx(DN,{className:"mr-2 h-4 w-4"})," Leave Tracker"]}),i.jsxs(ne,{onClick:H,variant:"danger",className:"w-full justify-center py-3",isLoading:C,children:[i.jsx(jo,{className:"mr-2 h-4 w-4"})," Log Out"]})]})]})]})]})]})};function Bm(n){return n+.5|0}const Lc=(n,e,t)=>Math.max(Math.min(n,t),e);function Zh(n){return Lc(Bm(n*2.55),0,255)}function Vc(n){return Lc(Bm(n*255),0,255)}function bl(n){return Lc(Bm(n/2.55)/100,0,1)}function _R(n){return Lc(Bm(n*100),0,100)}const $i={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},GN=[..."0123456789ABCDEF"],Ese=n=>GN[n&15],Dse=n=>GN[(n&240)>>4]+GN[n&15],Ug=n=>(n&240)>>4===(n&15),Ose=n=>Ug(n.r)&&Ug(n.g)&&Ug(n.b)&&Ug(n.a);function Ise(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&$i[n[1]]*17,g:255&$i[n[2]]*17,b:255&$i[n[3]]*17,a:e===5?$i[n[4]]*17:255}:(e===7||e===9)&&(t={r:$i[n[1]]<<4|$i[n[2]],g:$i[n[3]]<<4|$i[n[4]],b:$i[n[5]]<<4|$i[n[6]],a:e===9?$i[n[7]]<<4|$i[n[8]]:255})),t}const Ase=(n,e)=>n<255?e(n):"";function Rse(n){var e=Ose(n)?Ese:Dse;return n?"#"+e(n.r)+e(n.g)+e(n.b)+Ase(n.a,e):void 0}const Lse=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function o6(n,e,t){const r=e*Math.min(t,1-t),s=(a,o=(a+n/30)%12)=>t-r*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function Fse(n,e,t){const r=(s,a=(s+n/60)%6)=>t-t*e*Math.max(Math.min(a,4-a,1),0);return[r(5),r(3),r(1)]}function qse(n,e,t){const r=o6(n,1,.5);let s;for(e+t>1&&(s=1/(e+t),e*=s,t*=s),s=0;s<3;s++)r[s]*=1-e-t,r[s]+=e;return r}function zse(n,e,t,r,s){return n===s?(e-t)/r+(e<t?6:0):e===s?(t-n)/r+2:(n-e)/r+4}function d1(n){const t=n.r/255,r=n.g/255,s=n.b/255,a=Math.max(t,r,s),o=Math.min(t,r,s),l=(a+o)/2;let c,d,h;return a!==o&&(h=a-o,d=l>.5?h/(2-a-o):h/(a+o),c=zse(t,r,s,h,a),c=c*60+.5),[c|0,d||0,l]}function u1(n,e,t,r){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,r)).map(Vc)}function f1(n,e,t){return u1(o6,n,e,t)}function Use(n,e,t){return u1(qse,n,e,t)}function Bse(n,e,t){return u1(Fse,n,e,t)}function l6(n){return(n%360+360)%360}function Vse(n){const e=Lse.exec(n);let t=255,r;if(!e)return;e[5]!==r&&(t=e[6]?Zh(+e[5]):Vc(+e[5]));const s=l6(+e[2]),a=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=Use(s,a,o):e[1]==="hsv"?r=Bse(s,a,o):r=f1(s,a,o),{r:r[0],g:r[1],b:r[2],a:t}}function Wse(n,e){var t=d1(n);t[0]=l6(t[0]+e),t=f1(t),n.r=t[0],n.g=t[1],n.b=t[2]}function $se(n){if(!n)return;const e=d1(n),t=e[0],r=_R(e[1]),s=_R(e[2]);return n.a<255?`hsla(${t}, ${r}%, ${s}%, ${bl(n.a)})`:`hsl(${t}, ${r}%, ${s}%)`}const jR={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},SR={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Hse(){const n={},e=Object.keys(SR),t=Object.keys(jR);let r,s,a,o,l;for(r=0;r<e.length;r++){for(o=l=e[r],s=0;s<t.length;s++)a=t[s],l=l.replace(a,jR[a]);a=parseInt(SR[o],16),n[l]=[a>>16&255,a>>8&255,a&255]}return n}let Bg;function Yse(n){Bg||(Bg=Hse(),Bg.transparent=[0,0,0,0]);const e=Bg[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const Gse=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Zse(n){const e=Gse.exec(n);let t=255,r,s,a;if(e){if(e[7]!==r){const o=+e[7];t=e[8]?Zh(o):Lc(o*255,0,255)}return r=+e[1],s=+e[3],a=+e[5],r=255&(e[2]?Zh(r):Lc(r,0,255)),s=255&(e[4]?Zh(s):Lc(s,0,255)),a=255&(e[6]?Zh(a):Lc(a,0,255)),{r,g:s,b:a,a:t}}}function Kse(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${bl(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const CS=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,rf=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function Jse(n,e,t){const r=rf(bl(n.r)),s=rf(bl(n.g)),a=rf(bl(n.b));return{r:Vc(CS(r+t*(rf(bl(e.r))-r))),g:Vc(CS(s+t*(rf(bl(e.g))-s))),b:Vc(CS(a+t*(rf(bl(e.b))-a))),a:n.a+t*(e.a-n.a)}}function Vg(n,e,t){if(n){let r=d1(n);r[e]=Math.max(0,Math.min(r[e]+r[e]*t,e===0?360:1)),r=f1(r),n.r=r[0],n.g=r[1],n.b=r[2]}}function c6(n,e){return n&&Object.assign(e||{},n)}function NR(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Vc(n[3]))):(e=c6(n,{r:0,g:0,b:0,a:1}),e.a=Vc(e.a)),e}function Qse(n){return n.charAt(0)==="r"?Zse(n):Vse(n)}class Nm{constructor(e){if(e instanceof Nm)return e;const t=typeof e;let r;t==="object"?r=NR(e):t==="string"&&(r=Ise(e)||Yse(e)||Qse(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=c6(this._rgb);return e&&(e.a=bl(e.a)),e}set rgb(e){this._rgb=NR(e)}rgbString(){return this._valid?Kse(this._rgb):void 0}hexString(){return this._valid?Rse(this._rgb):void 0}hslString(){return this._valid?$se(this._rgb):void 0}mix(e,t){if(e){const r=this.rgb,s=e.rgb;let a;const o=t===a?.5:t,l=2*o-1,c=r.a-s.a,d=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;a=1-d,r.r=255&d*r.r+a*s.r+.5,r.g=255&d*r.g+a*s.g+.5,r.b=255&d*r.b+a*s.b+.5,r.a=o*r.a+(1-o)*s.a,this.rgb=r}return this}interpolate(e,t){return e&&(this._rgb=Jse(this._rgb,e._rgb,t)),this}clone(){return new Nm(this.rgb)}alpha(e){return this._rgb.a=Vc(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Bm(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Vg(this._rgb,2,e),this}darken(e){return Vg(this._rgb,2,-e),this}saturate(e){return Vg(this._rgb,1,e),this}desaturate(e){return Vg(this._rgb,1,-e),this}rotate(e){return Wse(this._rgb,e),this}}function ml(){}const Xse=(()=>{let n=0;return()=>n++})();function _n(n){return n==null}function kr(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function nn(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function us(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function po(n,e){return us(n)?n:e}function Zt(n,e){return typeof n>"u"?e:n}const eie=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,d6=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Bn(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function Nn(n,e,t,r){let s,a,o;if(kr(n))for(a=n.length,s=0;s<a;s++)e.call(t,n[s],s);else if(nn(n))for(o=Object.keys(n),a=o.length,s=0;s<a;s++)e.call(t,n[o[s]],o[s])}function Bx(n,e){let t,r,s,a;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(s=n[t],a=e[t],s.datasetIndex!==a.datasetIndex||s.index!==a.index)return!1;return!0}function Vx(n){if(kr(n))return n.map(Vx);if(nn(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let s=0;for(;s<r;++s)e[t[s]]=Vx(n[t[s]]);return e}return n}function u6(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function tie(n,e,t,r){if(!u6(n))return;const s=e[n],a=t[n];nn(s)&&nn(a)?Cm(s,a,r):e[n]=Vx(a)}function Cm(n,e,t){const r=kr(e)?e:[e],s=r.length;if(!nn(n))return n;t=t||{};const a=t.merger||tie;let o;for(let l=0;l<s;++l){if(o=r[l],!nn(o))continue;const c=Object.keys(o);for(let d=0,h=c.length;d<h;++d)a(c[d],n,o,t)}return n}function sm(n,e){return Cm(n,e,{merger:nie})}function nie(n,e,t){if(!u6(n))return;const r=e[n],s=t[n];nn(r)&&nn(s)?sm(r,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Vx(s))}const CR={"":n=>n,x:n=>n.x,y:n=>n.y};function rie(n){const e=n.split("."),t=[];let r="";for(const s of e)r+=s,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}function sie(n){const e=rie(n);return t=>{for(const r of e){if(r==="")break;t=t&&t[r]}return t}}function vu(n,e){return(CR[e]||(CR[e]=sie(e)))(n)}function h1(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Tm=n=>typeof n<"u",Zc=n=>typeof n=="function",TR=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function iie(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Dn=Math.PI,er=2*Dn,aie=er+Dn,Wx=Number.POSITIVE_INFINITY,oie=Dn/180,Pr=Dn/2,Kd=Dn/4,kR=Dn*2/3,f6=Math.log10,Co=Math.sign;function im(n,e,t){return Math.abs(n-e)<t}function PR(n){const e=Math.round(n);n=im(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(f6(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function lie(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r===0&&(e.push(r),e.push(n/r));return t===(t|0)&&e.push(t),e.sort((s,a)=>s-a).pop(),e}function cie(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function km(n){return!cie(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function die(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function uie(n,e,t){let r,s,a;for(r=0,s=n.length;r<s;r++)a=n[r][t],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function _l(n){return n*(Dn/180)}function fie(n){return n*(180/Dn)}function MR(n){if(!us(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function h6(n,e){const t=e.x-n.x,r=e.y-n.y,s=Math.sqrt(t*t+r*r);let a=Math.atan2(r,t);return a<-.5*Dn&&(a+=er),{angle:a,distance:s}}function ZN(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function hie(n,e){return(n-e+aie)%er-Dn}function pi(n){return(n%er+er)%er}function Pm(n,e,t,r){const s=pi(n),a=pi(e),o=pi(t),l=pi(a-s),c=pi(o-s),d=pi(s-a),h=pi(s-o);return s===a||s===o||r&&a===o||l>c&&d<h}function cs(n,e,t){return Math.max(e,Math.min(t,n))}function mie(n){return cs(n,-32768,32767)}function jl(n,e,t,r=1e-6){return n>=Math.min(e,t)-r&&n<=Math.max(e,t)+r}function m1(n,e,t){t=t||(o=>n[o]<e);let r=n.length-1,s=0,a;for(;r-s>1;)a=s+r>>1,t(a)?s=a:r=a;return{lo:s,hi:r}}const cu=(n,e,t,r)=>m1(n,t,r?s=>{const a=n[s][e];return a<t||a===t&&n[s+1][e]===t}:s=>n[s][e]<t),pie=(n,e,t)=>m1(n,t,r=>n[r][e]>=t);function gie(n,e,t){let r=0,s=n.length;for(;r<s&&n[r]<e;)r++;for(;s>r&&n[s-1]>t;)s--;return r>0||s<n.length?n.slice(r,s):n}const m6=["push","pop","shift","splice","unshift"];function xie(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),m6.forEach(t=>{const r="_onData"+h1(t),s=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...a){const o=s.apply(this,a);return n._chartjs.listeners.forEach(l=>{typeof l[r]=="function"&&l[r](...a)}),o}})})}function ER(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,s=r.indexOf(e);s!==-1&&r.splice(s,1),!(r.length>0)&&(m6.forEach(a=>{delete n[a]}),delete n._chartjs)}function p6(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const g6=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function x6(n,e){let t=[],r=!1;return function(...s){t=s,r||(r=!0,g6.call(window,()=>{r=!1,n.apply(e,t)}))}}function yie(n,e){let t;return function(...r){return e?(clearTimeout(t),t=setTimeout(n,e,r)):n.apply(this,r),e}}const y6=n=>n==="start"?"left":n==="end"?"right":"center",hi=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,vie=(n,e,t,r)=>n===(r?"left":"right")?t:n==="center"?(e+t)/2:e;function bie(n,e,t){const r=e.length;let s=0,a=r;if(n._sorted){const{iScale:o,vScale:l,_parsed:c}=n,d=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,h=o.axis,{min:p,max:x,minDefined:v,maxDefined:b}=o.getUserBounds();if(v){if(s=Math.min(cu(c,h,p).lo,t?r:cu(e,h,o.getPixelForValue(p)).lo),d){const _=c.slice(0,s+1).reverse().findIndex(j=>!_n(j[l.axis]));s-=Math.max(0,_)}s=cs(s,0,r-1)}if(b){let _=Math.max(cu(c,o.axis,x,!0).hi+1,t?0:cu(e,h,o.getPixelForValue(x),!0).hi+1);if(d){const j=c.slice(_-1).findIndex(C=>!_n(C[l.axis]));_+=Math.max(0,j)}a=cs(_,s,r)-s}else a=r-s}return{start:s,count:a}}function wie(n){const{xScale:e,yScale:t,_scaleRanges:r}=n,s={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!r)return n._scaleRanges=s,!0;const a=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,s),a}const Wg=n=>n===0||n===1,DR=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*er/t)),OR=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*er/t)+1,am={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Pr)+1,easeOutSine:n=>Math.sin(n*Pr),easeInOutSine:n=>-.5*(Math.cos(Dn*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Wg(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Wg(n)?n:DR(n,.075,.3),easeOutElastic:n=>Wg(n)?n:OR(n,.075,.3),easeInOutElastic(n){return Wg(n)?n:n<.5?.5*DR(n*2,.1125,.45):.5+.5*OR(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-am.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?am.easeInBounce(n*2)*.5:am.easeOutBounce(n*2-1)*.5+.5};function p1(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function IR(n){return p1(n)?n:new Nm(n)}function TS(n){return p1(n)?n:new Nm(n).saturate(.5).darken(.1).hexString()}const _ie=["x","y","borderWidth","radius","tension"],jie=["color","borderColor","backgroundColor"];function Sie(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:jie},numbers:{type:"number",properties:_ie}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Nie(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const AR=new Map;function Cie(n,e){e=e||{};const t=n+JSON.stringify(e);let r=AR.get(t);return r||(r=new Intl.NumberFormat(n,e),AR.set(t,r)),r}function g1(n,e,t){return Cie(e,t).format(n)}const Tie={values(n){return kr(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const r=this.chart.options.locale;let s,a=n;if(t.length>1){const d=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(d<1e-4||d>1e15)&&(s="scientific"),a=kie(n,t)}const o=f6(Math.abs(a)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:s,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),g1(n,r,c)}};function kie(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var v6={formatters:Tie};function Pie(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:v6.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const bu=Object.create(null),KN=Object.create(null);function om(n,e){if(!e)return n;const t=e.split(".");for(let r=0,s=t.length;r<s;++r){const a=t[r];n=n[a]||(n[a]=Object.create(null))}return n}function kS(n,e,t){return typeof e=="string"?Cm(om(n,e),t):Cm(om(n,""),e)}class Mie{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,s)=>TS(s.backgroundColor),this.hoverBorderColor=(r,s)=>TS(s.borderColor),this.hoverColor=(r,s)=>TS(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return kS(this,e,t)}get(e){return om(this,e)}describe(e,t){return kS(KN,e,t)}override(e,t){return kS(bu,e,t)}route(e,t,r,s){const a=om(this,e),o=om(this,r),l="_"+t;Object.defineProperties(a,{[l]:{value:a[t],writable:!0},[t]:{enumerable:!0,get(){const c=this[l],d=o[s];return nn(c)?Object.assign({},d,c):Zt(c,d)},set(c){this[l]=c}}})}apply(e){e.forEach(t=>t(this))}}var dr=new Mie({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Sie,Nie,Pie]);function Eie(n){return!n||_n(n.size)||_n(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function RR(n,e,t,r,s){let a=e[s];return a||(a=e[s]=n.measureText(s).width,t.push(s)),a>r&&(r=a),r}function Jd(n,e,t){const r=n.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*r)/r+s}function LR(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function JN(n,e,t,r){b6(n,e,t,r,null)}function b6(n,e,t,r,s){let a,o,l,c,d,h,p,x;const v=e.pointStyle,b=e.rotation,_=e.radius;let j=(b||0)*oie;if(v&&typeof v=="object"&&(a=v.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){n.save(),n.translate(t,r),n.rotate(j),n.drawImage(v,-v.width/2,-v.height/2,v.width,v.height),n.restore();return}if(!(isNaN(_)||_<=0)){switch(n.beginPath(),v){default:s?n.ellipse(t,r,s/2,_,0,0,er):n.arc(t,r,_,0,er),n.closePath();break;case"triangle":h=s?s/2:_,n.moveTo(t+Math.sin(j)*h,r-Math.cos(j)*_),j+=kR,n.lineTo(t+Math.sin(j)*h,r-Math.cos(j)*_),j+=kR,n.lineTo(t+Math.sin(j)*h,r-Math.cos(j)*_),n.closePath();break;case"rectRounded":d=_*.516,c=_-d,o=Math.cos(j+Kd)*c,p=Math.cos(j+Kd)*(s?s/2-d:c),l=Math.sin(j+Kd)*c,x=Math.sin(j+Kd)*(s?s/2-d:c),n.arc(t-p,r-l,d,j-Dn,j-Pr),n.arc(t+x,r-o,d,j-Pr,j),n.arc(t+p,r+l,d,j,j+Pr),n.arc(t-x,r+o,d,j+Pr,j+Dn),n.closePath();break;case"rect":if(!b){c=Math.SQRT1_2*_,h=s?s/2:c,n.rect(t-h,r-c,2*h,2*c);break}j+=Kd;case"rectRot":p=Math.cos(j)*(s?s/2:_),o=Math.cos(j)*_,l=Math.sin(j)*_,x=Math.sin(j)*(s?s/2:_),n.moveTo(t-p,r-l),n.lineTo(t+x,r-o),n.lineTo(t+p,r+l),n.lineTo(t-x,r+o),n.closePath();break;case"crossRot":j+=Kd;case"cross":p=Math.cos(j)*(s?s/2:_),o=Math.cos(j)*_,l=Math.sin(j)*_,x=Math.sin(j)*(s?s/2:_),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o);break;case"star":p=Math.cos(j)*(s?s/2:_),o=Math.cos(j)*_,l=Math.sin(j)*_,x=Math.sin(j)*(s?s/2:_),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o),j+=Kd,p=Math.cos(j)*(s?s/2:_),o=Math.cos(j)*_,l=Math.sin(j)*_,x=Math.sin(j)*(s?s/2:_),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o);break;case"line":o=s?s/2:Math.cos(j)*_,l=Math.sin(j)*_,n.moveTo(t-o,r-l),n.lineTo(t+o,r+l);break;case"dash":n.moveTo(t,r),n.lineTo(t+Math.cos(j)*(s?s/2:_),r+Math.sin(j)*_);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function Mm(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Dy(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function Oy(n){n.restore()}function Die(n,e,t,r,s){if(!e)return n.lineTo(t.x,t.y);if(s==="middle"){const a=(e.x+t.x)/2;n.lineTo(a,e.y),n.lineTo(a,t.y)}else s==="after"!=!!r?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function Oie(n,e,t,r){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function Iie(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),_n(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function Aie(n,e,t,r,s){if(s.strikethrough||s.underline){const a=n.measureText(r),o=e-a.actualBoundingBoxLeft,l=e+a.actualBoundingBoxRight,c=t-a.actualBoundingBoxAscent,d=t+a.actualBoundingBoxDescent,h=s.strikethrough?(c+d)/2:d;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(o,h),n.lineTo(l,h),n.stroke()}}function Rie(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function $x(n,e,t,r,s,a={}){const o=kr(e)?e:[e],l=a.strokeWidth>0&&a.strokeColor!=="";let c,d;for(n.save(),n.font=s.string,Iie(n,a),c=0;c<o.length;++c)d=o[c],a.backdrop&&Rie(n,a.backdrop),l&&(a.strokeColor&&(n.strokeStyle=a.strokeColor),_n(a.strokeWidth)||(n.lineWidth=a.strokeWidth),n.strokeText(d,t,r,a.maxWidth)),n.fillText(d,t,r,a.maxWidth),Aie(n,t,r,d,a),r+=Number(s.lineHeight);n.restore()}function Hx(n,e){const{x:t,y:r,w:s,h:a,radius:o}=e;n.arc(t+o.topLeft,r+o.topLeft,o.topLeft,1.5*Dn,Dn,!0),n.lineTo(t,r+a-o.bottomLeft),n.arc(t+o.bottomLeft,r+a-o.bottomLeft,o.bottomLeft,Dn,Pr,!0),n.lineTo(t+s-o.bottomRight,r+a),n.arc(t+s-o.bottomRight,r+a-o.bottomRight,o.bottomRight,Pr,0,!0),n.lineTo(t+s,r+o.topRight),n.arc(t+s-o.topRight,r+o.topRight,o.topRight,0,-Pr,!0),n.lineTo(t+o.topLeft,r)}const Lie=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Fie=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function qie(n,e){const t=(""+n).match(Lie);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const zie=n=>+n||0;function x1(n,e){const t={},r=nn(e),s=r?Object.keys(e):e,a=nn(n)?r?o=>Zt(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of s)t[o]=zie(a(o));return t}function w6(n){return x1(n,{top:"y",right:"x",bottom:"y",left:"x"})}function wf(n){return x1(n,["topLeft","topRight","bottomLeft","bottomRight"])}function La(n){const e=w6(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ks(n,e){n=n||{},e=e||dr.font;let t=Zt(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let r=Zt(n.style,e.style);r&&!(""+r).match(Fie)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const s={family:Zt(n.family,e.family),lineHeight:qie(Zt(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:Zt(n.weight,e.weight),string:""};return s.string=Eie(s),s}function $g(n,e,t,r){let s,a,o;for(s=0,a=n.length;s<a;++s)if(o=n[s],o!==void 0&&o!==void 0)return o}function Uie(n,e,t){const{min:r,max:s}=n,a=d6(e,(s-r)/2),o=(l,c)=>t&&l===0?0:l+c;return{min:o(r,-Math.abs(a)),max:o(s,a)}}function ku(n,e){return Object.assign(Object.create(n),e)}function y1(n,e=[""],t,r,s=()=>n[0]){const a=t||n;typeof r>"u"&&(r=N6("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:a,_fallback:r,_getTarget:s,override:l=>y1([l,...n],e,a,r)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete n[0][c],!0},get(l,c){return j6(l,c,()=>Zie(c,e,n,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(l,c){return qR(l).includes(c)},ownKeys(l){return qR(l)},set(l,c,d){const h=l._storage||(l._storage=s());return l[c]=h[c]=d,delete l._keys,!0}})}function Uf(n,e,t,r){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:_6(n,r),setContext:a=>Uf(n,a,t,r),override:a=>Uf(n.override(a),e,t,r)};return new Proxy(s,{deleteProperty(a,o){return delete a[o],delete n[o],!0},get(a,o,l){return j6(a,o,()=>Vie(a,o,l))},getOwnPropertyDescriptor(a,o){return a._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(a,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(a,o,l){return n[o]=l,delete a[o],!0}})}function _6(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:t,indexable:r,isScriptable:Zc(t)?t:()=>t,isIndexable:Zc(r)?r:()=>r}}const Bie=(n,e)=>n?n+h1(e):e,v1=(n,e)=>nn(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function j6(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const r=t();return n[e]=r,r}function Vie(n,e,t){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=n;let l=r[e];return Zc(l)&&o.isScriptable(e)&&(l=Wie(e,l,n,t)),kr(l)&&l.length&&(l=$ie(e,l,n,o.isIndexable)),v1(e,l)&&(l=Uf(l,s,a&&a[e],o)),l}function Wie(n,e,t,r){const{_proxy:s,_context:a,_subProxy:o,_stack:l}=t;if(l.has(n))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+n);l.add(n);let c=e(a,o||r);return l.delete(n),v1(n,c)&&(c=b1(s._scopes,s,n,c)),c}function $ie(n,e,t,r){const{_proxy:s,_context:a,_subProxy:o,_descriptors:l}=t;if(typeof a.index<"u"&&r(n))return e[a.index%e.length];if(nn(e[0])){const c=e,d=s._scopes.filter(h=>h!==c);e=[];for(const h of c){const p=b1(d,s,n,h);e.push(Uf(p,a,o&&o[n],l))}}return e}function S6(n,e,t){return Zc(n)?n(e,t):n}const Hie=(n,e)=>n===!0?e:typeof n=="string"?vu(e,n):void 0;function Yie(n,e,t,r,s){for(const a of e){const o=Hie(t,a);if(o){n.add(o);const l=S6(o._fallback,t,s);if(typeof l<"u"&&l!==t&&l!==r)return l}else if(o===!1&&typeof r<"u"&&t!==r)return null}return!1}function b1(n,e,t,r){const s=e._rootScopes,a=S6(e._fallback,t,r),o=[...n,...s],l=new Set;l.add(r);let c=FR(l,o,t,a||t,r);return c===null||typeof a<"u"&&a!==t&&(c=FR(l,o,a,c,r),c===null)?!1:y1(Array.from(l),[""],s,a,()=>Gie(e,t,r))}function FR(n,e,t,r,s){for(;t;)t=Yie(n,e,t,r,s);return t}function Gie(n,e,t){const r=n._getTarget();e in r||(r[e]={});const s=r[e];return kr(s)&&nn(t)?t:s||{}}function Zie(n,e,t,r){let s;for(const a of e)if(s=N6(Bie(a,n),t),typeof s<"u")return v1(n,s)?b1(t,r,n,s):s}function N6(n,e){for(const t of e){if(!t)continue;const r=t[n];if(typeof r<"u")return r}}function qR(n){let e=n._keys;return e||(e=n._keys=Kie(n._scopes)),e}function Kie(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(r);return Array.from(e)}const Jie=Number.EPSILON||1e-14,Bf=(n,e)=>e<n.length&&!n[e].skip&&n[e],C6=n=>n==="x"?"y":"x";function Qie(n,e,t,r){const s=n.skip?e:n,a=e,o=t.skip?e:t,l=ZN(a,s),c=ZN(o,a);let d=l/(l+c),h=c/(l+c);d=isNaN(d)?0:d,h=isNaN(h)?0:h;const p=r*d,x=r*h;return{previous:{x:a.x-p*(o.x-s.x),y:a.y-p*(o.y-s.y)},next:{x:a.x+x*(o.x-s.x),y:a.y+x*(o.y-s.y)}}}function Xie(n,e,t){const r=n.length;let s,a,o,l,c,d=Bf(n,0);for(let h=0;h<r-1;++h)if(c=d,d=Bf(n,h+1),!(!c||!d)){if(im(e[h],0,Jie)){t[h]=t[h+1]=0;continue}s=t[h]/e[h],a=t[h+1]/e[h],l=Math.pow(s,2)+Math.pow(a,2),!(l<=9)&&(o=3/Math.sqrt(l),t[h]=s*o*e[h],t[h+1]=a*o*e[h])}}function eae(n,e,t="x"){const r=C6(t),s=n.length;let a,o,l,c=Bf(n,0);for(let d=0;d<s;++d){if(o=l,l=c,c=Bf(n,d+1),!l)continue;const h=l[t],p=l[r];o&&(a=(h-o[t])/3,l[`cp1${t}`]=h-a,l[`cp1${r}`]=p-a*e[d]),c&&(a=(c[t]-h)/3,l[`cp2${t}`]=h+a,l[`cp2${r}`]=p+a*e[d])}}function tae(n,e="x"){const t=C6(e),r=n.length,s=Array(r).fill(0),a=Array(r);let o,l,c,d=Bf(n,0);for(o=0;o<r;++o)if(l=c,c=d,d=Bf(n,o+1),!!c){if(d){const h=d[e]-c[e];s[o]=h!==0?(d[t]-c[t])/h:0}a[o]=l?d?Co(s[o-1])!==Co(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}Xie(n,s,a),eae(n,a,e)}function Hg(n,e,t){return Math.max(Math.min(n,t),e)}function nae(n,e){let t,r,s,a,o,l=Mm(n[0],e);for(t=0,r=n.length;t<r;++t)o=a,a=l,l=t<r-1&&Mm(n[t+1],e),a&&(s=n[t],o&&(s.cp1x=Hg(s.cp1x,e.left,e.right),s.cp1y=Hg(s.cp1y,e.top,e.bottom)),l&&(s.cp2x=Hg(s.cp2x,e.left,e.right),s.cp2y=Hg(s.cp2y,e.top,e.bottom)))}function rae(n,e,t,r,s){let a,o,l,c;if(e.spanGaps&&(n=n.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")tae(n,s);else{let d=r?n[n.length-1]:n[0];for(a=0,o=n.length;a<o;++a)l=n[a],c=Qie(d,l,n[Math.min(a+1,o-(r?0:1))%o],e.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,d=l}e.capBezierPoints&&nae(n,t)}function w1(){return typeof window<"u"&&typeof document<"u"}function _1(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Yx(n,e,t){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*e.parentNode[t])):r=n,r}const Iy=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function sae(n,e){return Iy(n).getPropertyValue(e)}const iae=["top","right","bottom","left"];function hu(n,e,t){const r={};t=t?"-"+t:"";for(let s=0;s<4;s++){const a=iae[s];r[a]=parseFloat(n[e+"-"+a+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const aae=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function oae(n,e){const t=n.touches,r=t&&t.length?t[0]:n,{offsetX:s,offsetY:a}=r;let o=!1,l,c;if(aae(s,a,n.target))l=s,c=a;else{const d=e.getBoundingClientRect();l=r.clientX-d.left,c=r.clientY-d.top,o=!0}return{x:l,y:c,box:o}}function nu(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:r}=e,s=Iy(t),a=s.boxSizing==="border-box",o=hu(s,"padding"),l=hu(s,"border","width"),{x:c,y:d,box:h}=oae(n,t),p=o.left+(h&&l.left),x=o.top+(h&&l.top);let{width:v,height:b}=e;return a&&(v-=o.width+l.width,b-=o.height+l.height),{x:Math.round((c-p)/v*t.width/r),y:Math.round((d-x)/b*t.height/r)}}function lae(n,e,t){let r,s;if(e===void 0||t===void 0){const a=n&&_1(n);if(!a)e=n.clientWidth,t=n.clientHeight;else{const o=a.getBoundingClientRect(),l=Iy(a),c=hu(l,"border","width"),d=hu(l,"padding");e=o.width-d.width-c.width,t=o.height-d.height-c.height,r=Yx(l.maxWidth,a,"clientWidth"),s=Yx(l.maxHeight,a,"clientHeight")}}return{width:e,height:t,maxWidth:r||Wx,maxHeight:s||Wx}}const Fc=n=>Math.round(n*10)/10;function cae(n,e,t,r){const s=Iy(n),a=hu(s,"margin"),o=Yx(s.maxWidth,n,"clientWidth")||Wx,l=Yx(s.maxHeight,n,"clientHeight")||Wx,c=lae(n,e,t);let{width:d,height:h}=c;if(s.boxSizing==="content-box"){const x=hu(s,"border","width"),v=hu(s,"padding");d-=v.width+x.width,h-=v.height+x.height}return d=Math.max(0,d-a.width),h=Math.max(0,r?d/r:h-a.height),d=Fc(Math.min(d,o,c.maxWidth)),h=Fc(Math.min(h,l,c.maxHeight)),d&&!h&&(h=Fc(d/2)),(e!==void 0||t!==void 0)&&r&&c.height&&h>c.height&&(h=c.height,d=Fc(Math.floor(h*r))),{width:d,height:h}}function zR(n,e,t){const r=e||1,s=Fc(n.height*r),a=Fc(n.width*r);n.height=Fc(n.height),n.width=Fc(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==r||o.height!==s||o.width!==a?(n.currentDevicePixelRatio=r,o.height=s,o.width=a,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const dae=(function(){let n=!1;try{const e={get passive(){return n=!0,!1}};w1()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n})();function UR(n,e){const t=sae(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function ru(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function uae(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:r==="middle"?t<.5?n.y:e.y:r==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function fae(n,e,t,r){const s={x:n.cp2x,y:n.cp2y},a={x:e.cp1x,y:e.cp1y},o=ru(n,s,t),l=ru(s,a,t),c=ru(a,e,t),d=ru(o,l,t),h=ru(l,c,t);return ru(d,h,t)}const hae=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,r){return t-r},leftForLtr(t,r){return t-r}}},mae=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function _f(n,e,t){return n?hae(e,t):mae()}function T6(n,e){let t,r;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=r)}function k6(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function P6(n){return n==="angle"?{between:Pm,compare:hie,normalize:pi}:{between:jl,compare:(e,t)=>e-t,normalize:e=>e}}function BR({start:n,end:e,count:t,loop:r,style:s}){return{start:n%t,end:e%t,loop:r&&(e-n+1)%t===0,style:s}}function pae(n,e,t){const{property:r,start:s,end:a}=t,{between:o,normalize:l}=P6(r),c=e.length;let{start:d,end:h,loop:p}=n,x,v;if(p){for(d+=c,h+=c,x=0,v=c;x<v&&o(l(e[d%c][r]),s,a);++x)d--,h--;d%=c,h%=c}return h<d&&(h+=c),{start:d,end:h,loop:p,style:n.style}}function M6(n,e,t){if(!t)return[n];const{property:r,start:s,end:a}=t,o=e.length,{compare:l,between:c,normalize:d}=P6(r),{start:h,end:p,loop:x,style:v}=pae(n,e,t),b=[];let _=!1,j=null,C,P,O;const M=()=>c(s,O,C)&&l(s,O)!==0,D=()=>l(a,C)===0||c(a,O,C),I=()=>_||M(),F=()=>!_||D();for(let q=h,U=h;q<=p;++q)P=e[q%o],!P.skip&&(C=d(P[r]),C!==O&&(_=c(C,s,a),j===null&&I()&&(j=l(C,s)===0?q:U),j!==null&&F()&&(b.push(BR({start:j,end:q,loop:x,count:o,style:v})),j=null),U=q,O=C));return j!==null&&b.push(BR({start:j,end:p,loop:x,count:o,style:v})),b}function E6(n,e){const t=[],r=n.segments;for(let s=0;s<r.length;s++){const a=M6(r[s],n.points,e);a.length&&t.push(...a)}return t}function gae(n,e,t,r){let s=0,a=e-1;if(t&&!r)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,t&&(a+=s);a>s&&n[a%e].skip;)a--;return a%=e,{start:s,end:a}}function xae(n,e,t,r){const s=n.length,a=[];let o=e,l=n[e],c;for(c=e+1;c<=t;++c){const d=n[c%s];d.skip||d.stop?l.skip||(r=!1,a.push({start:e%s,end:(c-1)%s,loop:r}),e=o=d.stop?c:null):(o=c,l.skip&&(e=c)),l=d}return o!==null&&a.push({start:e%s,end:o%s,loop:r}),a}function yae(n,e){const t=n.points,r=n.options.spanGaps,s=t.length;if(!s)return[];const a=!!n._loop,{start:o,end:l}=gae(t,s,a,r);if(r===!0)return VR(n,[{start:o,end:l,loop:a}],t,e);const c=l<o?l+s:l,d=!!n._fullLoop&&o===0&&l===s-1;return VR(n,xae(t,o,c,d),t,e)}function VR(n,e,t,r){return!r||!r.setContext||!t?e:vae(n,e,t,r)}function vae(n,e,t,r){const s=n._chart.getContext(),a=WR(n.options),{_datasetIndex:o,options:{spanGaps:l}}=n,c=t.length,d=[];let h=a,p=e[0].start,x=p;function v(b,_,j,C){const P=l?-1:1;if(b!==_){for(b+=c;t[b%c].skip;)b-=P;for(;t[_%c].skip;)_+=P;b%c!==_%c&&(d.push({start:b%c,end:_%c,loop:j,style:C}),h=C,p=_%c)}}for(const b of e){p=l?p:b.start;let _=t[p%c],j;for(x=p+1;x<=b.end;x++){const C=t[x%c];j=WR(r.setContext(ku(s,{type:"segment",p0:_,p1:C,p0DataIndex:(x-1)%c,p1DataIndex:x%c,datasetIndex:o}))),bae(j,h)&&v(p,x-1,b.loop,h),_=C,h=j}p<x-1&&v(p,x-1,b.loop,h)}return d}function WR(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function bae(n,e){if(!e)return!1;const t=[],r=function(s,a){return p1(a)?(t.includes(a)||t.push(a),t.indexOf(a)):a};return JSON.stringify(n,r)!==JSON.stringify(e,r)}function Yg(n,e,t){return n.options.clip?n[t]:e[t]}function wae(n,e){const{xScale:t,yScale:r}=n;return t&&r?{left:Yg(t,e,"left"),right:Yg(t,e,"right"),top:Yg(r,e,"top"),bottom:Yg(r,e,"bottom")}:e}function D6(n,e){const t=e._clip;if(t.disabled)return!1;const r=wae(e,n.chartArea);return{left:t.left===!1?0:r.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:r.right+(t.right===!0?0:t.right),top:t.top===!1?0:r.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:r.bottom+(t.bottom===!0?0:t.bottom)}}class _ae{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,s){const a=t.listeners[s],o=t.duration;a.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(r-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=g6.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,s)=>{if(!r.running||!r.items.length)return;const a=r.items;let o=a.length-1,l=!1,c;for(;o>=0;--o)c=a[o],c._active?(c._total>r.duration&&(r.duration=c._total),c.tick(e),l=!0):(a[o]=a[a.length-1],a.pop());l&&(s.draw(),this._notify(s,r,e,"progress")),a.length||(r.running=!1,this._notify(s,r,e,"complete"),r.initial=!1),t+=a.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,s)=>Math.max(r,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let s=r.length-1;for(;s>=0;--s)r[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var gl=new _ae;const $R="transparent",jae={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const r=IR(n||$R),s=r.valid&&IR(e||$R);return s&&s.valid?s.mix(r,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class Sae{constructor(e,t,r,s){const a=t[r];s=$g([e.to,s,a,e.from]);const o=$g([e.from,a,s]);this._active=!0,this._fn=e.fn||jae[e.type||typeof o],this._easing=am[e.easing]||am.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const s=this._target[this._prop],a=r-this._start,o=this._duration-a;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=$g([e.to,t,s,e.from]),this._from=$g([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,s=this._prop,a=this._from,o=this._loop,l=this._to;let c;if(this._active=a!==l&&(o||t<r),!this._active){this._target[s]=l,this._notify(!0);return}if(t<0){this._target[s]=a;return}c=t/r%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[s]=this._fn(a,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let s=0;s<r.length;s++)r[s][t]()}}class O6{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!nn(e))return;const t=Object.keys(dr.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const a=e[s];if(!nn(a))return;const o={};for(const l of t)o[l]=a[l];(kr(a.properties)&&a.properties||[s]).forEach(l=>{(l===s||!r.has(l))&&r.set(l,o)})})}_animateOptions(e,t){const r=t.options,s=Cae(e,r);if(!s)return[];const a=this._createAnimations(s,r);return r.$shared&&Nae(e.options.$animations,r).then(()=>{e.options=r},()=>{}),a}_createAnimations(e,t){const r=this._properties,s=[],a=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const d=o[c];if(d.charAt(0)==="$")continue;if(d==="options"){s.push(...this._animateOptions(e,t));continue}const h=t[d];let p=a[d];const x=r.get(d);if(p)if(x&&p.active()){p.update(x,h,l);continue}else p.cancel();if(!x||!x.duration){e[d]=h;continue}a[d]=p=new Sae(x,e,d,h),s.push(p)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return gl.add(this._chart,r),!0}}function Nae(n,e){const t=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const a=n[r[s]];a&&a.active()&&t.push(a.wait())}return Promise.all(t)}function Cae(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function HR(n,e){const t=n&&n.options||{},r=t.reverse,s=t.min===void 0?e:0,a=t.max===void 0?e:0;return{start:r?a:s,end:r?s:a}}function Tae(n,e,t){if(t===!1)return!1;const r=HR(n,t),s=HR(e,t);return{top:s.end,right:r.end,bottom:s.start,left:r.start}}function kae(n){let e,t,r,s;return nn(n)?(e=n.top,t=n.right,r=n.bottom,s=n.left):e=t=r=s=n,{top:e,right:t,bottom:r,left:s,disabled:n===!1}}function I6(n,e){const t=[],r=n._getSortedDatasetMetas(e);let s,a;for(s=0,a=r.length;s<a;++s)t.push(r[s].index);return t}function YR(n,e,t,r={}){const s=n.keys,a=r.mode==="single";let o,l,c,d;if(e===null)return;let h=!1;for(o=0,l=s.length;o<l;++o){if(c=+s[o],c===t){if(h=!0,r.all)continue;break}d=n.values[c],us(d)&&(a||e===0||Co(e)===Co(d))&&(e+=d)}return!h&&!r.all?0:e}function Pae(n,e){const{iScale:t,vScale:r}=e,s=t.axis==="x"?"x":"y",a=r.axis==="x"?"x":"y",o=Object.keys(n),l=new Array(o.length);let c,d,h;for(c=0,d=o.length;c<d;++c)h=o[c],l[c]={[s]:h,[a]:n[h]};return l}function PS(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function Mae(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function Eae(n){const{min:e,max:t,minDefined:r,maxDefined:s}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function Dae(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function GR(n,e,t,r){for(const s of e.getMatchingVisibleMetas(r).reverse()){const a=n[s.index];if(t&&a>0||!t&&a<0)return s.index}return null}function ZR(n,e){const{chart:t,_cachedMeta:r}=n,s=t._stacks||(t._stacks={}),{iScale:a,vScale:o,index:l}=r,c=a.axis,d=o.axis,h=Mae(a,o,r),p=e.length;let x;for(let v=0;v<p;++v){const b=e[v],{[c]:_,[d]:j}=b,C=b._stacks||(b._stacks={});x=C[d]=Dae(s,h,_),x[l]=j,x._top=GR(x,o,!0,r.type),x._bottom=GR(x,o,!1,r.type);const P=x._visualValues||(x._visualValues={});P[l]=j}}function MS(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function Oae(n,e){return ku(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Iae(n,e,t){return ku(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Fh(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const s of e){const a=s._stacks;if(!a||a[r]===void 0||a[r][t]===void 0)return;delete a[r][t],a[r]._visualValues!==void 0&&a[r]._visualValues[t]!==void 0&&delete a[r]._visualValues[t]}}}const ES=n=>n==="reset"||n==="none",KR=(n,e)=>e?n:Object.assign({},n),Aae=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:I6(t,!0),values:null};class Ay{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=PS(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Fh(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),s=(p,x,v,b)=>p==="x"?x:p==="r"?b:v,a=t.xAxisID=Zt(r.xAxisID,MS(e,"x")),o=t.yAxisID=Zt(r.yAxisID,MS(e,"y")),l=t.rAxisID=Zt(r.rAxisID,MS(e,"r")),c=t.indexAxis,d=t.iAxisID=s(c,a,o,l),h=t.vAxisID=s(c,o,a,l);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(d),t.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&ER(this._data,this),e._stacked&&Fh(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(nn(t)){const s=this._cachedMeta;this._data=Pae(t,s)}else if(r!==t){if(r){ER(r,this);const s=this._cachedMeta;Fh(s),s._parsed=[]}t&&Object.isExtensible(t)&&xie(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let s=!1;this._dataCheck();const a=t._stacked;t._stacked=PS(t.vScale,t),t.stack!==r.stack&&(s=!0,Fh(t),t.stack=r.stack),this._resyncElements(e),(s||a!==t._stacked)&&(ZR(this,t._parsed),t._stacked=PS(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:s}=this,{iScale:a,_stacked:o}=r,l=a.axis;let c=e===0&&t===s.length?!0:r._sorted,d=e>0&&r._parsed[e-1],h,p,x;if(this._parsing===!1)r._parsed=s,r._sorted=!0,x=s;else{kr(s[e])?x=this.parseArrayData(r,s,e,t):nn(s[e])?x=this.parseObjectData(r,s,e,t):x=this.parsePrimitiveData(r,s,e,t);const v=()=>p[l]===null||d&&p[l]<d[l];for(h=0;h<t;++h)r._parsed[h+e]=p=x[h],c&&(v()&&(c=!1),d=p);r._sorted=c}o&&ZR(this,x)}parsePrimitiveData(e,t,r,s){const{iScale:a,vScale:o}=e,l=a.axis,c=o.axis,d=a.getLabels(),h=a===o,p=new Array(s);let x,v,b;for(x=0,v=s;x<v;++x)b=x+r,p[x]={[l]:h||a.parse(d[b],b),[c]:o.parse(t[b],b)};return p}parseArrayData(e,t,r,s){const{xScale:a,yScale:o}=e,l=new Array(s);let c,d,h,p;for(c=0,d=s;c<d;++c)h=c+r,p=t[h],l[c]={x:a.parse(p[0],h),y:o.parse(p[1],h)};return l}parseObjectData(e,t,r,s){const{xScale:a,yScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=new Array(s);let h,p,x,v;for(h=0,p=s;h<p;++h)x=h+r,v=t[x],d[h]={x:a.parse(vu(v,l),x),y:o.parse(vu(v,c),x)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const s=this.chart,a=this._cachedMeta,o=t[e.axis],l={keys:I6(s,!0),values:t._stacks[e.axis]._visualValues};return YR(l,o,a.index,{mode:r})}updateRangeFromParsed(e,t,r,s){const a=r[t.axis];let o=a===null?NaN:a;const l=s&&r._stacks[t.axis];s&&l&&(s.values=l,o=YR(s,a,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const r=this._cachedMeta,s=r._parsed,a=r._sorted&&e===r.iScale,o=s.length,l=this._getOtherScale(e),c=Aae(t,r,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:p}=Eae(l);let x,v;function b(){v=s[x];const _=v[l.axis];return!us(v[e.axis])||h>_||p<_}for(x=0;x<o&&!(!b()&&(this.updateRangeFromParsed(d,e,v,c),a));++x);if(a){for(x=o-1;x>=0;--x)if(!b()){this.updateRangeFromParsed(d,e,v,c);break}}return d}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let s,a,o;for(s=0,a=t.length;s<a;++s)o=t[s][e.axis],us(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,s=t.vScale,a=this.getParsed(e);return{label:r?""+r.getLabelForValue(a[r.axis]):"",value:s?""+s.getLabelForValue(a[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=kae(Zt(this.options.clip,Tae(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,s=r.data||[],a=t.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||s.length-l,d=this.options.drawActiveElementsOnTop;let h;for(r.dataset&&r.dataset.draw(e,a,l,c),h=l;h<l+c;++h){const p=s[h];p.hidden||(p.active&&d?o.push(p):p.draw(e,a))}for(h=0;h<o.length;++h)o[h].draw(e,a)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const s=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];a=o.$context||(o.$context=Iae(this.getContext(),e,o)),a.parsed=this.getParsed(e),a.raw=s.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=Oae(this.chart.getContext(),this.index)),a.dataset=s,a.index=a.datasetIndex=this.index;return a.active=!!t,a.mode=r,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const s=t==="active",a=this._cachedDataOpts,o=e+"-"+t,l=a[o],c=this.enableOptionSharing&&Tm(r);if(l)return KR(l,c);const d=this.chart.config,h=d.datasetElementScopeKeys(this._type,e),p=s?[`${e}Hover`,"hover",e,""]:[e,""],x=d.getOptionScopes(this.getDataset(),h),v=Object.keys(dr.elements[e]),b=()=>this.getContext(r,s,t),_=d.resolveNamedOptions(x,v,b,p);return _.$shared&&(_.$shared=c,a[o]=Object.freeze(KR(_,c))),_}_resolveAnimations(e,t,r){const s=this.chart,a=this._cachedDataOpts,o=`animation-${t}`,l=a[o];if(l)return l;let c;if(s.options.animation!==!1){const h=this.chart.config,p=h.datasetAnimationScopeKeys(this._type,t),x=h.getOptionScopes(this.getDataset(),p);c=h.createResolver(x,this.getContext(e,r,t))}const d=new O6(s,c&&c.animations);return c&&c._cacheable&&(a[o]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||ES(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),s=this._sharedOptions,a=this.getSharedOptions(r),o=this.includeOptions(t,a)||a!==s;return this.updateSharedOptions(a,t,r),{sharedOptions:a,includeOptions:o}}updateElement(e,t,r,s){ES(s)?Object.assign(e,r):this._resolveAnimations(t,s).update(e,r)}updateSharedOptions(e,t,r){e&&!ES(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,s){e.active=s;const a=this.getStyle(t,s);this._resolveAnimations(t,r,s).update(e,{options:!s&&this.getSharedOptions(a)||a})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[l,c,d]of this._syncList)this[l](c,d);this._syncList=[];const s=r.length,a=t.length,o=Math.min(a,s);o&&this.parse(0,o),a>s?this._insertElements(s,a-s,e):a<s&&this._removeElements(a,s-a)}_insertElements(e,t,r=!0){const s=this._cachedMeta,a=s.data,o=e+t;let l;const c=d=>{for(d.length+=t,l=d.length-1;l>=o;l--)d[l]=d[l-t]};for(c(a),l=e;l<o;++l)a[l]=new this.dataElementType;this._parsing&&c(s._parsed),this.parse(e,t),r&&this.updateElements(a,e,t,"reset")}updateElements(e,t,r,s){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const s=r._parsed.splice(e,t);r._stacked&&Fh(r,s)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,s]=e;this[t](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Rae(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let r=[];for(let s=0,a=t.length;s<a;s++)r=r.concat(t[s].controller.getAllParsedValues(n));n._cache.$bar=p6(r.sort((s,a)=>s-a))}return n._cache.$bar}function Lae(n){const e=n.iScale,t=Rae(e,n.type);let r=e._length,s,a,o,l;const c=()=>{o===32767||o===-32768||(Tm(l)&&(r=Math.min(r,Math.abs(o-l)||r)),l=o)};for(s=0,a=t.length;s<a;++s)o=e.getPixelForValue(t[s]),c();for(l=void 0,s=0,a=e.ticks.length;s<a;++s)o=e.getPixelForTick(s),c();return r}function Fae(n,e,t,r){const s=t.barThickness;let a,o;return _n(s)?(a=e.min*t.categoryPercentage,o=t.barPercentage):(a=s*r,o=1),{chunk:a/r,ratio:o,start:e.pixels[n]-a/2}}function qae(n,e,t,r){const s=e.pixels,a=s[n];let o=n>0?s[n-1]:null,l=n<s.length-1?s[n+1]:null;const c=t.categoryPercentage;o===null&&(o=a-(l===null?e.end-e.start:l-a)),l===null&&(l=a+a-o);const d=a-(a-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/r,ratio:t.barPercentage,start:d}}function zae(n,e,t,r){const s=t.parse(n[0],r),a=t.parse(n[1],r),o=Math.min(s,a),l=Math.max(s,a);let c=o,d=l;Math.abs(o)>Math.abs(l)&&(c=l,d=o),e[t.axis]=d,e._custom={barStart:c,barEnd:d,start:s,end:a,min:o,max:l}}function A6(n,e,t,r){return kr(n)?zae(n,e,t,r):e[t.axis]=t.parse(n,r),e}function JR(n,e,t,r){const s=n.iScale,a=n.vScale,o=s.getLabels(),l=s===a,c=[];let d,h,p,x;for(d=t,h=t+r;d<h;++d)x=e[d],p={},p[s.axis]=l||s.parse(o[d],d),c.push(A6(x,p,a,d));return c}function DS(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function Uae(n,e,t){return n!==0?Co(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function Bae(n){let e,t,r,s,a;return n.horizontal?(e=n.base>n.x,t="left",r="right"):(e=n.base<n.y,t="bottom",r="top"),e?(s="end",a="start"):(s="start",a="end"),{start:t,end:r,reverse:e,top:s,bottom:a}}function Vae(n,e,t,r){let s=e.borderSkipped;const a={};if(!s){n.borderSkipped=a;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:d,bottom:h}=Bae(n);s==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===r?s=d:(t._bottom||0)===r?s=h:(a[QR(h,o,l,c)]=!0,s=d)),a[QR(s,o,l,c)]=!0,n.borderSkipped=a}function QR(n,e,t,r){return r?(n=Wae(n,e,t),n=XR(n,t,e)):n=XR(n,e,t),n}function Wae(n,e,t){return n===e?t:n===t?e:n}function XR(n,e,t){return n==="start"?e:n==="end"?t:n}function $ae(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class Hae extends Ay{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,r,s){return JR(e,t,r,s)}parseArrayData(e,t,r,s){return JR(e,t,r,s)}parseObjectData(e,t,r,s){const{iScale:a,vScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=a.axis==="x"?l:c,h=o.axis==="x"?l:c,p=[];let x,v,b,_;for(x=r,v=r+s;x<v;++x)_=t[x],b={},b[a.axis]=a.parse(vu(_,d),x),p.push(A6(vu(_,h),b,o,x));return p}updateRangeFromParsed(e,t,r,s){super.updateRangeFromParsed(e,t,r,s);const a=r._custom;a&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:s}=t,a=this.getParsed(e),o=a._custom,l=DS(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(a[s.axis]);return{label:""+r.getLabelForValue(a[r.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,s){const a=s==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),d=l.isHorizontal(),h=this._getRuler(),{sharedOptions:p,includeOptions:x}=this._getSharedOptions(t,s);for(let v=t;v<t+r;v++){const b=this.getParsed(v),_=a||_n(b[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(v),j=this._calculateBarIndexPixels(v,h),C=(b._stacks||{})[l.axis],P={horizontal:d,base:_.base,enableBorderRadius:!C||DS(b._custom)||o===C._top||o===C._bottom,x:d?_.head:j.center,y:d?j.center:_.head,height:d?j.size:Math.abs(_.size),width:d?Math.abs(_.size):j.size};x&&(P.options=p||this.resolveDataElementOptions(v,e[v].active?"active":s));const O=P.options||e[v].options;Vae(P,O,C,o),$ae(P,O,h.ratio),this.updateElement(e[v],v,P,s)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),a=r.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),c=l&&l[r.axis],d=h=>{const p=h._parsed.find(v=>v[r.axis]===c),x=p&&p[h.vScale.axis];if(_n(x)||isNaN(x))return!0};for(const h of s)if(!(t!==void 0&&d(h))&&((a===!1||o.indexOf(h.stack)===-1||a===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[Zt(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,r){const s=this._getStacks(e,r),a=t!==void 0?s.indexOf(t):-1;return a===-1?s.length-1:a}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,s=[];let a,o;for(a=0,o=t.data.length;a<o;++a)s.push(r.getPixelForValue(this.getParsed(a)[r.axis],a));const l=e.barThickness;return{min:l||Lae(t),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:s},options:{base:a,minBarLength:o}}=this,l=a||0,c=this.getParsed(e),d=c._custom,h=DS(d);let p=c[t.axis],x=0,v=r?this.applyStack(t,c,r):p,b,_;v!==p&&(x=v-p,v=p),h&&(p=d.barStart,v=d.barEnd-d.barStart,p!==0&&Co(p)!==Co(d.barEnd)&&(x=0),x+=p);const j=!_n(a)&&!h?a:x;let C=t.getPixelForValue(j);if(this.chart.getDataVisibility(e)?b=t.getPixelForValue(x+v):b=C,_=b-C,Math.abs(_)<o){_=Uae(_,t,l)*o,p===l&&(C-=_/2);const P=t.getPixelForDecimal(0),O=t.getPixelForDecimal(1),M=Math.min(P,O),D=Math.max(P,O);C=Math.max(Math.min(C,D),M),b=C+_,r&&!h&&(c._stacks[t.axis]._visualValues[s]=t.getValueForPixel(b)-t.getValueForPixel(C))}if(C===t.getPixelForValue(l)){const P=Co(_)*t.getLineWidthForValue(l)/2;C+=P,_-=P}return{size:_,base:C,head:b,center:b+_/2}}_calculateBarIndexPixels(e,t){const r=t.scale,s=this.options,a=s.skipNull,o=Zt(s.maxBarThickness,1/0);let l,c;const d=this._getAxisCount();if(t.grouped){const h=a?this._getStackCount(e):t.stackCount,p=s.barThickness==="flex"?qae(e,t,s,h*d):Fae(e,t,s,h*d),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,v=this._getAxis().indexOf(Zt(x,this.getFirstScaleIdForIndexAxis())),b=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+v;l=p.start+p.chunk*b+p.chunk/2,c=Math.min(o,p.chunk*p.ratio)}else l=r.getPixelForValue(this.getParsed(e)[r.axis],e),c=Math.min(o,t.min*t.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,s=r.length;let a=0;for(;a<s;++a)this.getParsed(a)[t.axis]!==null&&!r[a].hidden&&r[a].draw(this._ctx)}}function Yae(n,e,t){let r=1,s=1,a=0,o=0;if(e<er){const l=n,c=l+e,d=Math.cos(l),h=Math.sin(l),p=Math.cos(c),x=Math.sin(c),v=(O,M,D)=>Pm(O,l,c,!0)?1:Math.max(M,M*t,D,D*t),b=(O,M,D)=>Pm(O,l,c,!0)?-1:Math.min(M,M*t,D,D*t),_=v(0,d,p),j=v(Pr,h,x),C=b(Dn,d,p),P=b(Dn+Pr,h,x);r=(_-C)/2,s=(j-P)/2,a=-(_+C)/2,o=-(j+P)/2}return{ratioX:r,ratioY:s,offsetX:a,offsetY:o}}class Gae extends Ay{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:r,textAlign:s,color:a,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((c,d)=>{const p=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:p.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(d),lineDash:p.borderDash,lineDashOffset:p.borderDashOffset,lineJoin:p.borderJoinStyle,lineWidth:p.borderWidth,strokeStyle:p.borderColor,textAlign:s,pointStyle:r,borderRadius:o&&(l||p.borderRadius),index:d}}):[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=r;else{let a=c=>+r[c];if(nn(r[e])){const{key:c="value"}=this._parsing;a=d=>+vu(r[d],c)}let o,l;for(o=e,l=e+t;o<l;++o)s._parsed[o]=a(o)}}_getRotation(){return _l(this.options.rotation-90)}_getCircumference(){return _l(this.options.circumference)}_getRotationExtents(){let e=er,t=-er;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const s=this.chart.getDatasetMeta(r).controller,a=s._getRotation(),o=s._getCircumference();e=Math.min(e,a),t=Math.max(t,a+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,s=this._cachedMeta,a=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,l=Math.max((Math.min(r.width,r.height)-o)/2,0),c=Math.min(eie(this.options.cutout,l),1),d=this._getRingWeight(this.index),{circumference:h,rotation:p}=this._getRotationExtents(),{ratioX:x,ratioY:v,offsetX:b,offsetY:_}=Yae(p,h,c),j=(r.width-o)/x,C=(r.height-o)/v,P=Math.max(Math.min(j,C)/2,0),O=d6(this.options.radius,P),M=Math.max(O*c,0),D=(O-M)/this._getVisibleDatasetWeightTotal();this.offsetX=b*O,this.offsetY=_*O,s.total=this.calculateTotal(),this.outerRadius=O-D*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-D*d,0),this.updateElements(a,0,a.length,e)}_circumference(e,t){const r=this.options,s=this._cachedMeta,a=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*a/er)}updateElements(e,t,r,s){const a=s==="reset",o=this.chart,l=o.chartArea,d=o.options.animation,h=(l.left+l.right)/2,p=(l.top+l.bottom)/2,x=a&&d.animateScale,v=x?0:this.innerRadius,b=x?0:this.outerRadius,{sharedOptions:_,includeOptions:j}=this._getSharedOptions(t,s);let C=this._getRotation(),P;for(P=0;P<t;++P)C+=this._circumference(P,a);for(P=t;P<t+r;++P){const O=this._circumference(P,a),M=e[P],D={x:h+this.offsetX,y:p+this.offsetY,startAngle:C,endAngle:C+O,circumference:O,outerRadius:b,innerRadius:v};j&&(D.options=_||this.resolveDataElementOptions(P,M.active?"active":s)),C+=O,this.updateElement(M,P,D,s)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r=0,s;for(s=0;s<t.length;s++){const a=e._parsed[s];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(s)&&!t[s].hidden&&(r+=Math.abs(a))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?er*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,s=r.data.labels||[],a=g1(t._parsed[e],r.options.locale);return{label:s[e]||"",value:a}}getMaxBorderWidth(e){let t=0;const r=this.chart;let s,a,o,l,c;if(!e){for(s=0,a=r.data.datasets.length;s<a;++s)if(r.isDatasetVisible(s)){o=r.getDatasetMeta(s),e=o.data,l=o.controller;break}}if(!e)return 0;for(s=0,a=e.length;s<a;++s)c=l.resolveDataElementOptions(s),c.borderAlign!=="inner"&&(t=Math.max(t,c.borderWidth||0,c.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,s=e.length;r<s;++r){const a=this.resolveDataElementOptions(r);t=Math.max(t,a.offset||0,a.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(Zt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class Zae extends Ay{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:s=[],_dataset:a}=t,o=this.chart._animationsDisabled;let{start:l,count:c}=bie(t,s,o);this._drawStart=l,this._drawCount=c,wie(t)&&(l=0,c=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!a._decimated,r.points=s;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:d},e),this.updateElements(s,l,c,e)}updateElements(e,t,r,s){const a=s==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:d}=this._cachedMeta,{sharedOptions:h,includeOptions:p}=this._getSharedOptions(t,s),x=o.axis,v=l.axis,{spanGaps:b,segment:_}=this.options,j=km(b)?b:Number.POSITIVE_INFINITY,C=this.chart._animationsDisabled||a||s==="none",P=t+r,O=e.length;let M=t>0&&this.getParsed(t-1);for(let D=0;D<O;++D){const I=e[D],F=C?I:{};if(D<t||D>=P){F.skip=!0;continue}const q=this.getParsed(D),U=_n(q[v]),B=F[x]=o.getPixelForValue(q[x],D),W=F[v]=a||U?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,q,c):q[v],D);F.skip=isNaN(B)||isNaN(W)||U,F.stop=D>0&&Math.abs(q[x]-M[x])>j,_&&(F.parsed=q,F.raw=d.data[D]),p&&(F.options=h||this.resolveDataElementOptions(D,I.active?"active":s)),C||this.updateElement(I,D,F,s),M=q}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,s=e.data||[];if(!s.length)return r;const a=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,a,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}function Qd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class j1{static override(e){Object.assign(j1.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Qd()}parse(){return Qd()}format(){return Qd()}add(){return Qd()}diff(){return Qd()}startOf(){return Qd()}endOf(){return Qd()}}var Kae={_date:j1};function Jae(n,e,t,r){const{controller:s,data:a,_sorted:o}=n,l=s._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&a.length){const d=l._reversePixels?pie:cu;if(r){if(s._sharedOptions){const h=a[0],p=typeof h.getRange=="function"&&h.getRange(e);if(p){const x=d(a,e,t-p),v=d(a,e,t+p);return{lo:x.lo,hi:v.hi}}}}else{const h=d(a,e,t);if(c){const{vScale:p}=s._cachedMeta,{_parsed:x}=n,v=x.slice(0,h.lo+1).reverse().findIndex(_=>!_n(_[p.axis]));h.lo-=Math.max(0,v);const b=x.slice(h.hi).findIndex(_=>!_n(_[p.axis]));h.hi+=Math.max(0,b)}return h}}return{lo:0,hi:a.length-1}}function Ry(n,e,t,r,s){const a=n.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,c=a.length;l<c;++l){const{index:d,data:h}=a[l],{lo:p,hi:x}=Jae(a[l],e,o,s);for(let v=p;v<=x;++v){const b=h[v];b.skip||r(b,d,v)}}}function Qae(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(r,s){const a=e?Math.abs(r.x-s.x):0,o=t?Math.abs(r.y-s.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}function OS(n,e,t,r,s){const a=[];return!s&&!n.isPointInArea(e)||Ry(n,t,e,function(l,c,d){!s&&!Mm(l,n.chartArea,0)||l.inRange(e.x,e.y,r)&&a.push({element:l,datasetIndex:c,index:d})},!0),a}function Xae(n,e,t,r){let s=[];function a(o,l,c){const{startAngle:d,endAngle:h}=o.getProps(["startAngle","endAngle"],r),{angle:p}=h6(o,{x:e.x,y:e.y});Pm(p,d,h)&&s.push({element:o,datasetIndex:l,index:c})}return Ry(n,t,e,a),s}function eoe(n,e,t,r,s,a){let o=[];const l=Qae(t);let c=Number.POSITIVE_INFINITY;function d(h,p,x){const v=h.inRange(e.x,e.y,s);if(r&&!v)return;const b=h.getCenterPoint(s);if(!(!!a||n.isPointInArea(b))&&!v)return;const j=l(e,b);j<c?(o=[{element:h,datasetIndex:p,index:x}],c=j):j===c&&o.push({element:h,datasetIndex:p,index:x})}return Ry(n,t,e,d),o}function IS(n,e,t,r,s,a){return!a&&!n.isPointInArea(e)?[]:t==="r"&&!r?Xae(n,e,t,s):eoe(n,e,t,r,s,a)}function eL(n,e,t,r,s){const a=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return Ry(n,t,e,(c,d,h)=>{c[o]&&c[o](e[t],s)&&(a.push({element:c,datasetIndex:d,index:h}),l=l||c.inRange(e.x,e.y,s))}),r&&!l?[]:a}var toe={modes:{index(n,e,t,r){const s=nu(e,n),a=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?OS(n,s,a,r,o):IS(n,s,a,!1,r,o),c=[];return l.length?(n.getSortedVisibleDatasetMetas().forEach(d=>{const h=l[0].index,p=d.data[h];p&&!p.skip&&c.push({element:p,datasetIndex:d.index,index:h})}),c):[]},dataset(n,e,t,r){const s=nu(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?OS(n,s,a,r,o):IS(n,s,a,!1,r,o);if(l.length>0){const c=l[0].datasetIndex,d=n.getDatasetMeta(c).data;l=[];for(let h=0;h<d.length;++h)l.push({element:d[h],datasetIndex:c,index:h})}return l},point(n,e,t,r){const s=nu(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return OS(n,s,a,r,o)},nearest(n,e,t,r){const s=nu(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return IS(n,s,a,t.intersect,r,o)},x(n,e,t,r){const s=nu(e,n);return eL(n,s,"x",t.intersect,r)},y(n,e,t,r){const s=nu(e,n);return eL(n,s,"y",t.intersect,r)}}};const R6=["left","top","right","bottom"];function qh(n,e){return n.filter(t=>t.pos===e)}function tL(n,e){return n.filter(t=>R6.indexOf(t.pos)===-1&&t.box.axis===e)}function zh(n,e){return n.sort((t,r)=>{const s=e?r:t,a=e?t:r;return s.weight===a.weight?s.index-a.index:s.weight-a.weight})}function noe(n){const e=[];let t,r,s,a,o,l;for(t=0,r=(n||[]).length;t<r;++t)s=n[t],{position:a,options:{stack:o,stackWeight:l=1}}=s,e.push({index:t,box:s,pos:a,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&a+o,stackWeight:l});return e}function roe(n){const e={};for(const t of n){const{stack:r,pos:s,stackWeight:a}=t;if(!r||!R6.includes(s))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=a}return e}function soe(n,e){const t=roe(n),{vBoxMaxWidth:r,hBoxMaxHeight:s}=e;let a,o,l;for(a=0,o=n.length;a<o;++a){l=n[a];const{fullSize:c}=l.box,d=t[l.stack],h=d&&l.stackWeight/d.weight;l.horizontal?(l.width=h?h*r:c&&e.availableWidth,l.height=s):(l.width=r,l.height=h?h*s:c&&e.availableHeight)}return t}function ioe(n){const e=noe(n),t=zh(e.filter(d=>d.box.fullSize),!0),r=zh(qh(e,"left"),!0),s=zh(qh(e,"right")),a=zh(qh(e,"top"),!0),o=zh(qh(e,"bottom")),l=tL(e,"x"),c=tL(e,"y");return{fullSize:t,leftAndTop:r.concat(a),rightAndBottom:s.concat(c).concat(o).concat(l),chartArea:qh(e,"chartArea"),vertical:r.concat(s).concat(c),horizontal:a.concat(o).concat(l)}}function nL(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function L6(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function aoe(n,e,t,r){const{pos:s,box:a}=t,o=n.maxPadding;if(!nn(s)){t.size&&(n[s]-=t.size);const p=r[t.stack]||{size:0,count:1};p.size=Math.max(p.size,t.horizontal?a.height:a.width),t.size=p.size/p.count,n[s]+=t.size}a.getPadding&&L6(o,a.getPadding());const l=Math.max(0,e.outerWidth-nL(o,n,"left","right")),c=Math.max(0,e.outerHeight-nL(o,n,"top","bottom")),d=l!==n.w,h=c!==n.h;return n.w=l,n.h=c,t.horizontal?{same:d,other:h}:{same:h,other:d}}function ooe(n){const e=n.maxPadding;function t(r){const s=Math.max(e[r]-n[r],0);return n[r]+=s,s}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function loe(n,e){const t=e.maxPadding;function r(s){const a={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{a[o]=Math.max(e[o],t[o])}),a}return r(n?["left","right"]:["top","bottom"])}function Kh(n,e,t,r){const s=[];let a,o,l,c,d,h;for(a=0,o=n.length,d=0;a<o;++a){l=n[a],c=l.box,c.update(l.width||e.w,l.height||e.h,loe(l.horizontal,e));const{same:p,other:x}=aoe(e,t,l,r);d|=p&&s.length,h=h||x,c.fullSize||s.push(l)}return d&&Kh(s,e,t,r)||h}function Gg(n,e,t,r,s){n.top=t,n.left=e,n.right=e+r,n.bottom=t+s,n.width=r,n.height=s}function rL(n,e,t,r){const s=t.padding;let{x:a,y:o}=e;for(const l of n){const c=l.box,d=r[l.stack]||{placed:0,weight:1},h=l.stackWeight/d.weight||1;if(l.horizontal){const p=e.w*h,x=d.size||c.height;Tm(d.start)&&(o=d.start),c.fullSize?Gg(c,s.left,o,t.outerWidth-s.right-s.left,x):Gg(c,e.left+d.placed,o,p,x),d.start=o,d.placed+=p,o=c.bottom}else{const p=e.h*h,x=d.size||c.width;Tm(d.start)&&(a=d.start),c.fullSize?Gg(c,a,s.top,x,t.outerHeight-s.bottom-s.top):Gg(c,a,e.top+d.placed,x,p),d.start=a,d.placed+=p,a=c.right}}e.x=a,e.y=o}var qc={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const s=La(n.options.layout.padding),a=Math.max(e-s.width,0),o=Math.max(t-s.height,0),l=ioe(n.boxes),c=l.vertical,d=l.horizontal;Nn(n.boxes,_=>{typeof _.beforeLayout=="function"&&_.beforeLayout()});const h=c.reduce((_,j)=>j.box.options&&j.box.options.display===!1?_:_+1,0)||1,p=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:a,availableHeight:o,vBoxMaxWidth:a/2/h,hBoxMaxHeight:o/2}),x=Object.assign({},s);L6(x,La(r));const v=Object.assign({maxPadding:x,w:a,h:o,x:s.left,y:s.top},s),b=soe(c.concat(d),p);Kh(l.fullSize,v,p,b),Kh(c,v,p,b),Kh(d,v,p,b)&&Kh(c,v,p,b),ooe(v),rL(l.leftAndTop,v,p,b),v.x+=v.w,v.y+=v.h,rL(l.rightAndBottom,v,p,b),n.chartArea={left:v.left,top:v.top,right:v.left+v.w,bottom:v.top+v.h,height:v.h,width:v.w},Nn(l.chartArea,_=>{const j=_.box;Object.assign(j,n.chartArea),j.update(v.w,v.h,{left:0,top:0,right:0,bottom:0})})}};class F6{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,s){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):r)}}isAttached(e){return!0}updateConfig(e){}}class coe extends F6{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const px="$chartjs",doe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},sL=n=>n===null||n==="";function uoe(n,e){const t=n.style,r=n.getAttribute("height"),s=n.getAttribute("width");if(n[px]={initial:{height:r,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",sL(s)){const a=UR(n,"width");a!==void 0&&(n.width=a)}if(sL(r))if(n.style.height==="")n.height=n.width/(e||2);else{const a=UR(n,"height");a!==void 0&&(n.height=a)}return n}const q6=dae?{passive:!0}:!1;function foe(n,e,t){n&&n.addEventListener(e,t,q6)}function hoe(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,q6)}function moe(n,e){const t=doe[n.type]||n.type,{x:r,y:s}=nu(n,e);return{type:t,chart:e,native:n,x:r!==void 0?r:null,y:s!==void 0?s:null}}function Gx(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function poe(n,e,t){const r=n.canvas,s=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||Gx(l.addedNodes,r),o=o&&!Gx(l.removedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function goe(n,e,t){const r=n.canvas,s=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||Gx(l.removedNodes,r),o=o&&!Gx(l.addedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const Em=new Map;let iL=0;function z6(){const n=window.devicePixelRatio;n!==iL&&(iL=n,Em.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function xoe(n,e){Em.size||window.addEventListener("resize",z6),Em.set(n,e)}function yoe(n){Em.delete(n),Em.size||window.removeEventListener("resize",z6)}function voe(n,e,t){const r=n.canvas,s=r&&_1(r);if(!s)return;const a=x6((l,c)=>{const d=s.clientWidth;t(l,c),d<s.clientWidth&&t()},window),o=new ResizeObserver(l=>{const c=l[0],d=c.contentRect.width,h=c.contentRect.height;d===0&&h===0||a(d,h)});return o.observe(s),xoe(n,a),o}function AS(n,e,t){t&&t.disconnect(),e==="resize"&&yoe(n)}function boe(n,e,t){const r=n.canvas,s=x6(a=>{n.ctx!==null&&t(moe(a,n))},n);return foe(r,e,s),s}class woe extends F6{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(uoe(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[px])return!1;const r=t[px].initial;["height","width"].forEach(a=>{const o=r[a];_n(o)?t.removeAttribute(a):t.setAttribute(a,o)});const s=r.style||{};return Object.keys(s).forEach(a=>{t.style[a]=s[a]}),t.width=t.width,delete t[px],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),o={attach:poe,detach:goe,resize:voe}[t]||boe;s[t]=o(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),s=r[t];if(!s)return;({attach:AS,detach:AS,resize:AS}[t]||hoe)(e,t,s),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,s){return cae(e,t,r,s)}isAttached(e){const t=e&&_1(e);return!!(t&&t.isConnected)}}function _oe(n){return!w1()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?coe:woe}let ud=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return km(this.x)&&km(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const s={};return e.forEach(a=>{s[a]=r[a]&&r[a].active()?r[a]._to:this[a]}),s}};function joe(n,e){const t=n.options.ticks,r=Soe(n),s=Math.min(t.maxTicksLimit||r,r),a=t.major.enabled?Coe(e):[],o=a.length,l=a[0],c=a[o-1],d=[];if(o>s)return Toe(e,d,a,o/s),d;const h=Noe(a,e,s);if(o>0){let p,x;const v=o>1?Math.round((c-l)/(o-1)):null;for(Zg(e,d,h,_n(v)?0:l-v,l),p=0,x=o-1;p<x;p++)Zg(e,d,h,a[p],a[p+1]);return Zg(e,d,h,c,_n(v)?e.length:c+v),d}return Zg(e,d,h),d}function Soe(n){const e=n.options.offset,t=n._tickSize(),r=n._length/t+(e?0:1),s=n._maxLength/t;return Math.floor(Math.min(r,s))}function Noe(n,e,t){const r=koe(n),s=e.length/t;if(!r)return Math.max(s,1);const a=lie(r);for(let o=0,l=a.length-1;o<l;o++){const c=a[o];if(c>s)return c}return Math.max(s,1)}function Coe(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}function Toe(n,e,t,r){let s=0,a=t[0],o;for(r=Math.ceil(r),o=0;o<n.length;o++)o===a&&(e.push(n[o]),s++,a=t[s*r])}function Zg(n,e,t,r,s){const a=Zt(r,0),o=Math.min(Zt(s,n.length),n.length);let l=0,c,d,h;for(t=Math.ceil(t),s&&(c=s-r,t=c/Math.floor(c/t)),h=a;h<0;)l++,h=Math.round(a+l*t);for(d=Math.max(a,0);d<o;d++)d===h&&(e.push(n[d]),l++,h=Math.round(a+l*t))}function koe(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}const Poe=n=>n==="left"?"right":n==="right"?"left":n,aL=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,oL=(n,e)=>Math.min(e||n,n);function lL(n,e){const t=[],r=n.length/e,s=n.length;let a=0;for(;a<s;a+=r)t.push(n[Math.floor(a)]);return t}function Moe(n,e,t){const r=n.ticks.length,s=Math.min(e,r-1),a=n._startPixel,o=n._endPixel,l=1e-6;let c=n.getPixelForTick(s),d;if(!(t&&(r===1?d=Math.max(c-a,o-c):e===0?d=(n.getPixelForTick(1)-c)/2:d=(c-n.getPixelForTick(s-1))/2,c+=s<e?d:-d,c<a-l||c>o+l)))return c}function Eoe(n,e){Nn(n,t=>{const r=t.gc,s=r.length/2;let a;if(s>e){for(a=0;a<s;++a)delete t.data[r[a]];r.splice(0,s)}})}function Uh(n){return n.drawTicks?n.tickLength:0}function cL(n,e){if(!n.display)return 0;const t=Ks(n.font,e),r=La(n.padding);return(kr(n.text)?n.text.length:1)*t.lineHeight+r.height}function Doe(n,e){return ku(n,{scale:e,type:"scale"})}function Ooe(n,e,t){return ku(n,{tick:t,index:e,type:"tick"})}function Ioe(n,e,t){let r=y6(n);return(t&&e!=="right"||!t&&e==="right")&&(r=Poe(r)),r}function Aoe(n,e,t,r){const{top:s,left:a,bottom:o,right:l,chart:c}=n,{chartArea:d,scales:h}=c;let p=0,x,v,b;const _=o-s,j=l-a;if(n.isHorizontal()){if(v=hi(r,a,l),nn(t)){const C=Object.keys(t)[0],P=t[C];b=h[C].getPixelForValue(P)+_-e}else t==="center"?b=(d.bottom+d.top)/2+_-e:b=aL(n,t,e);x=l-a}else{if(nn(t)){const C=Object.keys(t)[0],P=t[C];v=h[C].getPixelForValue(P)-j+e}else t==="center"?v=(d.left+d.right)/2-j+e:v=aL(n,t,e);b=hi(r,o,s),p=t==="left"?-Pr:Pr}return{titleX:v,titleY:b,maxWidth:x,rotation:p}}class Qf extends ud{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:s}=this;return e=po(e,Number.POSITIVE_INFINITY),t=po(t,Number.NEGATIVE_INFINITY),r=po(r,Number.POSITIVE_INFINITY),s=po(s,Number.NEGATIVE_INFINITY),{min:po(e,r),max:po(t,s),minDefined:us(e),maxDefined:us(t)}}getMinMax(e){let{min:t,max:r,minDefined:s,maxDefined:a}=this.getUserBounds(),o;if(s&&a)return{min:t,max:r};const l=this.getMatchingVisibleMetas();for(let c=0,d=l.length;c<d;++c)o=l[c].controller.getMinMax(this,e),s||(t=Math.min(t,o.min)),a||(r=Math.max(r,o.max));return t=a&&t>r?r:t,r=s&&t>r?t:r,{min:po(t,po(r,t)),max:po(r,po(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Bn(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:s,grace:a,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Uie(this,a,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?lL(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=joe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,r;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,e=!e),this._startPixel=t,this._endPixel=r,this._reversePixels=e,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Bn(this.options.afterUpdate,[this])}beforeSetDimensions(){Bn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Bn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Bn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Bn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,s,a;for(r=0,s=e.length;r<s;r++)a=e[r],a.label=Bn(t.callback,[a.value,r,e],this)}afterTickToLabelConversion(){Bn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Bn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=oL(this.ticks.length,e.ticks.maxTicksLimit),s=t.minRotation||0,a=t.maxRotation;let o=s,l,c,d;if(!this._isVisible()||!t.display||s>=a||r<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),p=h.widest.width,x=h.highest.height,v=cs(this.chart.width-p,0,this.maxWidth);l=e.offset?this.maxWidth/r:v/(r-1),p+6>l&&(l=v/(r-(e.offset?.5:1)),c=this.maxHeight-Uh(e.grid)-t.padding-cL(e.title,this.chart.options.font),d=Math.sqrt(p*p+x*x),o=fie(Math.min(Math.asin(cs((h.highest.height+6)/l,-1,1)),Math.asin(cs(c/d,-1,1))-Math.asin(cs(x/d,-1,1)))),o=Math.max(s,Math.min(a,o))),this.labelRotation=o}afterCalculateLabelRotation(){Bn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Bn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:s,grid:a}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=cL(s,t.options.font);if(l?(e.width=this.maxWidth,e.height=Uh(a)+c):(e.height=this.maxHeight,e.width=Uh(a)+c),r.display&&this.ticks.length){const{first:d,last:h,widest:p,highest:x}=this._getLabelSizes(),v=r.padding*2,b=_l(this.labelRotation),_=Math.cos(b),j=Math.sin(b);if(l){const C=r.mirror?0:j*p.width+_*x.height;e.height=Math.min(this.maxHeight,e.height+C+v)}else{const C=r.mirror?0:_*p.width+j*x.height;e.width=Math.min(this.maxWidth,e.width+C+v)}this._calculatePadding(d,h,j,_)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,s){const{ticks:{align:a,padding:o},position:l}=this.options,c=this.labelRotation!==0,d=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,p=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,v=0;c?d?(x=s*e.width,v=r*t.height):(x=r*e.height,v=s*t.width):a==="start"?v=t.width:a==="end"?x=e.width:a!=="inner"&&(x=e.width/2,v=t.width/2),this.paddingLeft=Math.max((x-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((v-p+o)*this.width/(this.width-p),0)}else{let h=t.height/2,p=e.height/2;a==="start"?(h=0,p=e.height):a==="end"&&(h=t.height,p=0),this.paddingTop=h+o,this.paddingBottom=p+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Bn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,r;for(t=0,r=e.length;t<r;t++)_n(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=lL(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:s,_longestTextCache:a}=this,o=[],l=[],c=Math.floor(t/oL(t,r));let d=0,h=0,p,x,v,b,_,j,C,P,O,M,D;for(p=0;p<t;p+=c){if(b=e[p].label,_=this._resolveTickFontOptions(p),s.font=j=_.string,C=a[j]=a[j]||{data:{},gc:[]},P=_.lineHeight,O=M=0,!_n(b)&&!kr(b))O=RR(s,C.data,C.gc,O,b),M=P;else if(kr(b))for(x=0,v=b.length;x<v;++x)D=b[x],!_n(D)&&!kr(D)&&(O=RR(s,C.data,C.gc,O,D),M+=P);o.push(O),l.push(M),d=Math.max(O,d),h=Math.max(M,h)}Eoe(a,t);const I=o.indexOf(d),F=l.indexOf(h),q=U=>({width:o[U]||0,height:l[U]||0});return{first:q(0),last:q(t-1),widest:q(I),highest:q(F),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return mie(this._alignToPixels?Jd(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=Ooe(this.getContext(),e,r))}return this.$context||(this.$context=Doe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=_l(this.labelRotation),r=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),a=this._getLabelSizes(),o=e.autoSkipPadding||0,l=a?a.widest.width+o:0,c=a?a.highest.height+o:0;return this.isHorizontal()?c*r>l*s?l/r:c/s:c*s<l*r?c/r:l/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,s=this.options,{grid:a,position:o,border:l}=s,c=a.offset,d=this.isHorizontal(),p=this.ticks.length+(c?1:0),x=Uh(a),v=[],b=l.setContext(this.getContext()),_=b.display?b.width:0,j=_/2,C=function(X){return Jd(r,X,_)};let P,O,M,D,I,F,q,U,B,W,Y,G;if(o==="top")P=C(this.bottom),F=this.bottom-x,U=P-j,W=C(e.top)+j,G=e.bottom;else if(o==="bottom")P=C(this.top),W=e.top,G=C(e.bottom)-j,F=P+j,U=this.top+x;else if(o==="left")P=C(this.right),I=this.right-x,q=P-j,B=C(e.left)+j,Y=e.right;else if(o==="right")P=C(this.left),B=e.left,Y=C(e.right)-j,I=P+j,q=this.left+x;else if(t==="x"){if(o==="center")P=C((e.top+e.bottom)/2+.5);else if(nn(o)){const X=Object.keys(o)[0],he=o[X];P=C(this.chart.scales[X].getPixelForValue(he))}W=e.top,G=e.bottom,F=P+j,U=F+x}else if(t==="y"){if(o==="center")P=C((e.left+e.right)/2);else if(nn(o)){const X=Object.keys(o)[0],he=o[X];P=C(this.chart.scales[X].getPixelForValue(he))}I=P-j,q=I-x,B=e.left,Y=e.right}const Z=Zt(s.ticks.maxTicksLimit,p),oe=Math.max(1,Math.ceil(p/Z));for(O=0;O<p;O+=oe){const X=this.getContext(O),he=a.setContext(X),$=l.setContext(X),K=he.lineWidth,te=he.color,H=$.dash||[],ae=$.dashOffset,le=he.tickWidth,ue=he.tickColor,ie=he.tickBorderDash||[],pe=he.tickBorderDashOffset;M=Moe(this,O,c),M!==void 0&&(D=Jd(r,M,K),d?I=q=B=Y=D:F=U=W=G=D,v.push({tx1:I,ty1:F,tx2:q,ty2:U,x1:B,y1:W,x2:Y,y2:G,width:K,color:te,borderDash:H,borderDashOffset:ae,tickWidth:le,tickColor:ue,tickBorderDash:ie,tickBorderDashOffset:pe}))}return this._ticksLength=p,this._borderValue=P,v}_computeLabelItems(e){const t=this.axis,r=this.options,{position:s,ticks:a}=r,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:h,mirror:p}=a,x=Uh(r.grid),v=x+h,b=p?-h:v,_=-_l(this.labelRotation),j=[];let C,P,O,M,D,I,F,q,U,B,W,Y,G="middle";if(s==="top")I=this.bottom-b,F=this._getXAxisLabelAlignment();else if(s==="bottom")I=this.top+b,F=this._getXAxisLabelAlignment();else if(s==="left"){const oe=this._getYAxisLabelAlignment(x);F=oe.textAlign,D=oe.x}else if(s==="right"){const oe=this._getYAxisLabelAlignment(x);F=oe.textAlign,D=oe.x}else if(t==="x"){if(s==="center")I=(e.top+e.bottom)/2+v;else if(nn(s)){const oe=Object.keys(s)[0],X=s[oe];I=this.chart.scales[oe].getPixelForValue(X)+v}F=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")D=(e.left+e.right)/2-v;else if(nn(s)){const oe=Object.keys(s)[0],X=s[oe];D=this.chart.scales[oe].getPixelForValue(X)}F=this._getYAxisLabelAlignment(x).textAlign}t==="y"&&(c==="start"?G="top":c==="end"&&(G="bottom"));const Z=this._getLabelSizes();for(C=0,P=l.length;C<P;++C){O=l[C],M=O.label;const oe=a.setContext(this.getContext(C));q=this.getPixelForTick(C)+a.labelOffset,U=this._resolveTickFontOptions(C),B=U.lineHeight,W=kr(M)?M.length:1;const X=W/2,he=oe.color,$=oe.textStrokeColor,K=oe.textStrokeWidth;let te=F;o?(D=q,F==="inner"&&(C===P-1?te=this.options.reverse?"left":"right":C===0?te=this.options.reverse?"right":"left":te="center"),s==="top"?d==="near"||_!==0?Y=-W*B+B/2:d==="center"?Y=-Z.highest.height/2-X*B+B:Y=-Z.highest.height+B/2:d==="near"||_!==0?Y=B/2:d==="center"?Y=Z.highest.height/2-X*B:Y=Z.highest.height-W*B,p&&(Y*=-1),_!==0&&!oe.showLabelBackdrop&&(D+=B/2*Math.sin(_))):(I=q,Y=(1-W)*B/2);let H;if(oe.showLabelBackdrop){const ae=La(oe.backdropPadding),le=Z.heights[C],ue=Z.widths[C];let ie=Y-ae.top,pe=0-ae.left;switch(G){case"middle":ie-=le/2;break;case"bottom":ie-=le;break}switch(F){case"center":pe-=ue/2;break;case"right":pe-=ue;break;case"inner":C===P-1?pe-=ue:C>0&&(pe-=ue/2);break}H={left:pe,top:ie,width:ue+ae.width,height:le+ae.height,color:oe.backdropColor}}j.push({label:M,font:U,textOffset:Y,options:{rotation:_,color:he,strokeColor:$,strokeWidth:K,textAlign:te,textBaseline:G,translation:[D,I],backdrop:H}})}return j}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-_l(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:s,padding:a}}=this.options,o=this._getLabelSizes(),l=e+a,c=o.widest.width;let d,h;return t==="left"?s?(h=this.right+a,r==="near"?d="left":r==="center"?(d="center",h+=c/2):(d="right",h+=c)):(h=this.right-l,r==="near"?d="right":r==="center"?(d="center",h-=c/2):(d="left",h=this.left)):t==="right"?s?(h=this.left+a,r==="near"?d="right":r==="center"?(d="center",h-=c/2):(d="left",h-=c)):(h=this.left+l,r==="near"?d="left":r==="center"?(d="center",h+=c/2):(d="right",h=this.right)):d="right",{textAlign:d,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:s,width:a,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,s,a,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(a=>a.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,r=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,o;const l=(c,d,h)=>{!h.width||!h.color||(r.save(),r.lineWidth=h.width,r.strokeStyle=h.color,r.setLineDash(h.borderDash||[]),r.lineDashOffset=h.borderDashOffset,r.beginPath(),r.moveTo(c.x,c.y),r.lineTo(d.x,d.y),r.stroke(),r.restore())};if(t.display)for(a=0,o=s.length;a<o;++a){const c=s[a];t.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),t.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:s}}=this,a=r.setContext(this.getContext()),o=r.display?a.width:0;if(!o)return;const l=s.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,h,p,x;this.isHorizontal()?(d=Jd(e,this.left,o)-o/2,h=Jd(e,this.right,l)+l/2,p=x=c):(p=Jd(e,this.top,o)-o/2,x=Jd(e,this.bottom,l)+l/2,d=h=c),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(d,p),t.lineTo(h,x),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,s=this._computeLabelArea();s&&Dy(r,s);const a=this.getLabelItems(e);for(const o of a){const l=o.options,c=o.font,d=o.label,h=o.textOffset;$x(r,d,0,h,c,l)}s&&Oy(r)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:s}}=this;if(!r.display)return;const a=Ks(r.font),o=La(r.padding),l=r.align;let c=a.lineHeight/2;t==="bottom"||t==="center"||nn(t)?(c+=o.bottom,kr(r.text)&&(c+=a.lineHeight*(r.text.length-1))):c+=o.top;const{titleX:d,titleY:h,maxWidth:p,rotation:x}=Aoe(this,c,t,l);$x(e,r.text,0,0,a,{color:r.color,maxWidth:p,rotation:x,textAlign:Ioe(l,t,s),textBaseline:"middle",translation:[d,h]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=Zt(e.grid&&e.grid.z,-1),s=Zt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Qf.prototype.draw?[{z:t,draw:a=>{this.draw(a)}}]:[{z:r,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:t,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",s=[];let a,o;for(a=0,o=t.length;a<o;++a){const l=t[a];l[r]===this.id&&(!e||l.type===e)&&s.push(l)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Ks(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Kg{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;Foe(t)&&(r=this.register(t));const s=this.items,a=e.id,o=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in s||(s[a]=e,Roe(e,o,r),this.override&&dr.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,s=this.scope;r in t&&delete t[r],s&&r in dr[s]&&(delete dr[s][r],this.override&&delete bu[r])}}function Roe(n,e,t){const r=Cm(Object.create(null),[t?dr.get(t):{},dr.get(e),n.defaults]);dr.set(e,r),n.defaultRoutes&&Loe(e,n.defaultRoutes),n.descriptors&&dr.describe(e,n.descriptors)}function Loe(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),s=r.pop(),a=[n].concat(r).join("."),o=e[t].split("."),l=o.pop(),c=o.join(".");dr.route(a,s,c,l)})}function Foe(n){return"id"in n&&"defaults"in n}class qoe{constructor(){this.controllers=new Kg(Ay,"datasets",!0),this.elements=new Kg(ud,"elements"),this.plugins=new Kg(Object,"plugins"),this.scales=new Kg(Qf,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(s=>{const a=r||this._getRegistryForType(s);r||a.isForType(s)||a===this.plugins&&s.id?this._exec(e,a,s):Nn(s,o=>{const l=r||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,r){const s=h1(e);Bn(r["before"+s],[],r),t[e](r),Bn(r["after"+s],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return s}}var xo=new qoe;class zoe{constructor(){this._init=void 0}notify(e,t,r,s){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=s?this._descriptors(e).filter(s):this._descriptors(e),o=this._notify(a,e,t,r);return t==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,r,s){s=s||{};for(const a of e){const o=a.plugin,l=o[r],c=[t,s,a.options];if(Bn(l,c,o)===!1&&s.cancelable)return!1}return!0}invalidate(){_n(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,s=Zt(r.options&&r.options.plugins,{}),a=Uoe(r);return s===!1&&!t?[]:Voe(e,a,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,s=(a,o)=>a.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(s(t,r),e,"stop"),this._notify(s(r,t),e,"start")}}function Uoe(n){const e={},t=[],r=Object.keys(xo.plugins.items);for(let a=0;a<r.length;a++)t.push(xo.getPlugin(r[a]));const s=n.plugins||[];for(let a=0;a<s.length;a++){const o=s[a];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function Boe(n,e){return!e&&n===!1?null:n===!0?{}:n}function Voe(n,{plugins:e,localIds:t},r,s){const a=[],o=n.getContext();for(const l of e){const c=l.id,d=Boe(r[c],s);d!==null&&a.push({plugin:l,options:Woe(n.config,{plugin:l,local:t[c]},d,o)})}return a}function Woe(n,{plugin:e,local:t},r,s){const a=n.pluginScopeKeys(e),o=n.getOptionScopes(r,a);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function QN(n,e){const t=dr.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function $oe(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function Hoe(n,e){return n===e?"_index_":"_value_"}function dL(n){if(n==="x"||n==="y"||n==="r")return n}function Yoe(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function XN(n,...e){if(dL(n))return n;for(const t of e){const r=t.axis||Yoe(t.position)||n.length>1&&dL(n[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function uL(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function Goe(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(r=>r.xAxisID===n||r.yAxisID===n);if(t.length)return uL(n,"x",t[0])||uL(n,"y",t[0])}return{}}function Zoe(n,e){const t=bu[n.type]||{scales:{}},r=e.scales||{},s=QN(n.type,e),a=Object.create(null);return Object.keys(r).forEach(o=>{const l=r[o];if(!nn(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=XN(o,l,Goe(o,n),dr.scales[l.type]),d=Hoe(c,s),h=t.scales||{};a[o]=sm(Object.create(null),[{axis:c},l,h[c],h[d]])}),n.data.datasets.forEach(o=>{const l=o.type||n.type,c=o.indexAxis||QN(l,e),h=(bu[l]||{}).scales||{};Object.keys(h).forEach(p=>{const x=$oe(p,c),v=o[x+"AxisID"]||x;a[v]=a[v]||Object.create(null),sm(a[v],[{axis:x},r[v],h[p]])})}),Object.keys(a).forEach(o=>{const l=a[o];sm(l,[dr.scales[l.type],dr.scale])}),a}function U6(n){const e=n.options||(n.options={});e.plugins=Zt(e.plugins,{}),e.scales=Zoe(n,e)}function B6(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function Koe(n){return n=n||{},n.data=B6(n.data),U6(n),n}const fL=new Map,V6=new Set;function Jg(n,e){let t=fL.get(n);return t||(t=e(),fL.set(n,t),V6.add(t)),t}const Bh=(n,e,t)=>{const r=vu(e,t);r!==void 0&&n.add(r)};class Joe{constructor(e){this._config=Koe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=B6(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),U6(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Jg(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Jg(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Jg(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return Jg(`${r}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let s=r.get(e);return(!s||t)&&(s=new Map,r.set(e,s)),s}getOptionScopes(e,t,r){const{options:s,type:a}=this,o=this._cachedScopes(e,r),l=o.get(t);if(l)return l;const c=new Set;t.forEach(h=>{e&&(c.add(e),h.forEach(p=>Bh(c,e,p))),h.forEach(p=>Bh(c,s,p)),h.forEach(p=>Bh(c,bu[a]||{},p)),h.forEach(p=>Bh(c,dr,p)),h.forEach(p=>Bh(c,KN,p))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),V6.has(t)&&o.set(t,d),d}chartOptionScopes(){const{options:e,type:t}=this;return[e,bu[t]||{},dr.datasets[t]||{},{type:t},dr,KN]}resolveNamedOptions(e,t,r,s=[""]){const a={$shared:!0},{resolver:o,subPrefixes:l}=hL(this._resolverCache,e,s);let c=o;if(Xoe(o,t)){a.$shared=!1,r=Zc(r)?r():r;const d=this.createResolver(e,r,l);c=Uf(o,r,d)}for(const d of t)a[d]=c[d];return a}createResolver(e,t,r=[""],s){const{resolver:a}=hL(this._resolverCache,e,r);return nn(t)?Uf(a,t,void 0,s):a}}function hL(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const s=t.join();let a=r.get(s);return a||(a={resolver:y1(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},r.set(s,a)),a}const Qoe=n=>nn(n)&&Object.getOwnPropertyNames(n).some(e=>Zc(n[e]));function Xoe(n,e){const{isScriptable:t,isIndexable:r}=_6(n);for(const s of e){const a=t(s),o=r(s),l=(o||a)&&n[s];if(a&&(Zc(l)||Qoe(l))||o&&kr(l))return!0}return!1}var ele="4.5.1";const tle=["top","bottom","left","right","chartArea"];function mL(n,e){return n==="top"||n==="bottom"||tle.indexOf(n)===-1&&e==="x"}function pL(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function gL(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Bn(t&&t.onComplete,[n],e)}function nle(n){const e=n.chart,t=e.options.animation;Bn(t&&t.onProgress,[n],e)}function W6(n){return w1()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const gx={},xL=n=>{const e=W6(n);return Object.values(gx).filter(t=>t.canvas===e).pop()};function rle(n,e,t){const r=Object.keys(n);for(const s of r){const a=+s;if(a>=e){const o=n[s];delete n[s],(t>0||a>e)&&(n[a+t]=o)}}}function sle(n,e,t,r){return!t||n.type==="mouseout"?null:r?e:n}class Ly{static defaults=dr;static instances=gx;static overrides=bu;static registry=xo;static version=ele;static getChart=xL;static register(...e){xo.add(...e),yL()}static unregister(...e){xo.remove(...e),yL()}constructor(e,t){const r=this.config=new Joe(t),s=W6(e),a=xL(s);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||_oe(s)),this.platform.updateConfig(r);const l=this.platform.acquireContext(s,o.aspectRatio),c=l&&l.canvas,d=c&&c.height,h=c&&c.width;if(this.id=Xse(),this.ctx=l,this.canvas=c,this.width=h,this.height=d,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new zoe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=yie(p=>this.update(p),o.resizeDelay||0),this._dataChanges=[],gx[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}gl.listen(this,"complete",gL),gl.listen(this,"progress",nle),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:s,_aspectRatio:a}=this;return _n(e)?t&&a?a:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return xo}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():zR(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return LR(this.canvas,this.ctx),this}stop(){return gl.stop(this),this}resize(e,t){gl.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,s=this.canvas,a=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,e,t,a),l=r.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,zR(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Bn(r.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};Nn(t,(r,s)=>{r.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,s=Object.keys(r).reduce((o,l)=>(o[l]=!1,o),{});let a=[];t&&(a=a.concat(Object.keys(t).map(o=>{const l=t[o],c=XN(o,l),d=c==="r",h=c==="x";return{options:l,dposition:d?"chartArea":h?"bottom":"left",dtype:d?"radialLinear":h?"category":"linear"}}))),Nn(a,o=>{const l=o.options,c=l.id,d=XN(c,l),h=Zt(l.type,o.dtype);(l.position===void 0||mL(l.position,d)!==mL(o.dposition))&&(l.position=o.dposition),s[c]=!0;let p=null;if(c in r&&r[c].type===h)p=r[c];else{const x=xo.getScale(h);p=new x({id:c,type:h,ctx:this.ctx,chart:this}),r[p.id]=p}p.init(l,e)}),Nn(s,(o,l)=>{o||delete r[l]}),Nn(r,o=>{qc.configure(this,o,o.options),qc.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((s,a)=>s.index-a.index),r>t){for(let s=t;s<r;++s)this._destroyDatasetMeta(s);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(pL("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,s)=>{t.filter(a=>a===r._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,s;for(this._removeUnreferencedMetasets(),r=0,s=t.length;r<s;r++){const a=t[r];let o=this.getDatasetMeta(r);const l=a.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=l,o.indexAxis=a.indexAxis||QN(l,this.options),o.order=a.order||0,o.index=r,o.label=""+a.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const c=xo.getController(l),{datasetElementType:d,dataElementType:h}=dr.datasets[l];Object.assign(c,{dataElementType:xo.getElement(h),datasetElementType:d&&xo.getElement(d)}),o.controller=new c(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Nn(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let d=0,h=this.data.datasets.length;d<h;d++){const{controller:p}=this.getDatasetMeta(d),x=!s&&a.indexOf(p)===-1;p.buildOrUpdateElements(x),o=Math.max(+p.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),s||Nn(a,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(pL("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){Nn(this.scales,e=>{qc.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!TR(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:s,count:a}of t){const o=r==="_removeElements"?-a:a;rle(e,s,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=a=>new Set(e.filter(o=>o[0]===a).map((o,l)=>l+","+o.splice(1).join(","))),s=r(0);for(let a=1;a<t;a++)if(!TR(s,r(a)))return;return Array.from(s).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;qc.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],Nn(this.boxes,s=>{r&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,a)=>{s._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,Zc(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),s={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(r.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(gl.has(this)?this.attached&&!gl.running(this)&&gl.start(this):(this.draw(),gL({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let s,a;for(s=0,a=t.length;s<a;++s){const o=t[s];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r={meta:e,index:e.index,cancelable:!0},s=D6(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(s&&Dy(t,s),e.controller.draw(),s&&Oy(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return Mm(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,s){const a=toe.modes[t];return typeof a=="function"?a(this,e,r,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let s=r.filter(a=>a&&a._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=ku(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const s=r?"show":"hide",a=this.getDatasetMeta(e),o=a.controller._resolveAnimations(void 0,s);Tm(t)?(a.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(a,{visible:r}),this.update(l=>l.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),gl.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),LR(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete gx[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(a,o)=>{t.addEventListener(this,a,o),e[a]=o},s=(a,o,l)=>{a.offsetX=o,a.offsetY=l,this._eventHandler(a)};Nn(this.options.events,a=>r(a,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(c,d)=>{t.addEventListener(this,c,d),e[c]=d},s=(c,d)=>{e[c]&&(t.removeEventListener(this,c,d),delete e[c])},a=(c,d)=>{this.canvas&&this.resize(c,d)};let o;const l=()=>{s("attach",l),this.attached=!0,this.resize(),r("resize",a),r("detach",o)};o=()=>{this.attached=!1,s("resize",a),this._stop(),this._resize(0,0),r("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){Nn(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},Nn(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const s=r?"set":"remove";let a,o,l,c;for(t==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+s+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){o=e[l];const d=o&&this.getDatasetMeta(o.datasetIndex).controller;d&&d[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:a,index:o})=>{const l=this.getDatasetMeta(a);if(!l)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:l.data[o],index:o}});!Bx(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const s=this.options.hover,a=(c,d)=>c.filter(h=>!d.some(p=>h.datasetIndex===p.datasetIndex&&h.index===p.index)),o=a(t,e),l=r?e:a(e,t);o.length&&this.updateHoverStyle(o,s.mode,!1),l.length&&s.mode&&this.updateHoverStyle(l,s.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,s)===!1)return;const a=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(a||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:s=[],options:a}=this,o=t,l=this._getActiveElements(e,s,r,o),c=iie(e),d=sle(e,this._lastEvent,r,c);r&&(this._lastEvent=null,Bn(a.onHover,[e,l,this],this),c&&Bn(a.onClick,[e,l,this],this));const h=!Bx(l,s);return(h||t)&&(this._active=l,this._updateHoverStyles(l,s,t)),this._lastEvent=d,h}_getActiveElements(e,t,r,s){if(e.type==="mouseout")return[];if(!r)return t;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,s)}}function yL(){return Nn(Ly.instances,n=>n._plugins.invalidate())}function ile(n,e,t){const{startAngle:r,x:s,y:a,outerRadius:o,innerRadius:l,options:c}=e,{borderWidth:d,borderJoinStyle:h}=c,p=Math.min(d/o,pi(r-t));if(n.beginPath(),n.arc(s,a,o-d/2,r+p/2,t-p/2),l>0){const x=Math.min(d/l,pi(r-t));n.arc(s,a,l+d/2,t-x/2,r+x/2,!0)}else{const x=Math.min(d/2,o*pi(r-t));if(h==="round")n.arc(s,a,x,t-Dn/2,r+Dn/2,!0);else if(h==="bevel"){const v=2*x*x,b=-v*Math.cos(t+Dn/2)+s,_=-v*Math.sin(t+Dn/2)+a,j=v*Math.cos(r+Dn/2)+s,C=v*Math.sin(r+Dn/2)+a;n.lineTo(b,_),n.lineTo(j,C)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function ale(n,e,t){const{startAngle:r,pixelMargin:s,x:a,y:o,outerRadius:l,innerRadius:c}=e;let d=s/l;n.beginPath(),n.arc(a,o,l,r-d,t+d),c>s?(d=s/c,n.arc(a,o,c,t+d,r-d,!0)):n.arc(a,o,s,t+Pr,r-Pr),n.closePath(),n.clip()}function ole(n){return x1(n,["outerStart","outerEnd","innerStart","innerEnd"])}function lle(n,e,t,r){const s=ole(n.options.borderRadius),a=(t-e)/2,o=Math.min(a,r*e/2),l=c=>{const d=(t-Math.min(a,c))*r/2;return cs(c,0,Math.min(a,d))};return{outerStart:l(s.outerStart),outerEnd:l(s.outerEnd),innerStart:cs(s.innerStart,0,o),innerEnd:cs(s.innerEnd,0,o)}}function sf(n,e,t,r){return{x:t+n*Math.cos(e),y:r+n*Math.sin(e)}}function Zx(n,e,t,r,s,a){const{x:o,y:l,startAngle:c,pixelMargin:d,innerRadius:h}=e,p=Math.max(e.outerRadius+r+t-d,0),x=h>0?h+r+t+d:0;let v=0;const b=s-c;if(r){const oe=h>0?h-r:0,X=p>0?p-r:0,he=(oe+X)/2,$=he!==0?b*he/(he+r):b;v=(b-$)/2}const _=Math.max(.001,b*p-t/Dn)/p,j=(b-_)/2,C=c+j+v,P=s-j-v,{outerStart:O,outerEnd:M,innerStart:D,innerEnd:I}=lle(e,x,p,P-C),F=p-O,q=p-M,U=C+O/F,B=P-M/q,W=x+D,Y=x+I,G=C+D/W,Z=P-I/Y;if(n.beginPath(),a){const oe=(U+B)/2;if(n.arc(o,l,p,U,oe),n.arc(o,l,p,oe,B),M>0){const K=sf(q,B,o,l);n.arc(K.x,K.y,M,B,P+Pr)}const X=sf(Y,P,o,l);if(n.lineTo(X.x,X.y),I>0){const K=sf(Y,Z,o,l);n.arc(K.x,K.y,I,P+Pr,Z+Math.PI)}const he=(P-I/x+(C+D/x))/2;if(n.arc(o,l,x,P-I/x,he,!0),n.arc(o,l,x,he,C+D/x,!0),D>0){const K=sf(W,G,o,l);n.arc(K.x,K.y,D,G+Math.PI,C-Pr)}const $=sf(F,C,o,l);if(n.lineTo($.x,$.y),O>0){const K=sf(F,U,o,l);n.arc(K.x,K.y,O,C-Pr,U)}}else{n.moveTo(o,l);const oe=Math.cos(U)*p+o,X=Math.sin(U)*p+l;n.lineTo(oe,X);const he=Math.cos(B)*p+o,$=Math.sin(B)*p+l;n.lineTo(he,$)}n.closePath()}function cle(n,e,t,r,s){const{fullCircles:a,startAngle:o,circumference:l}=e;let c=e.endAngle;if(a){Zx(n,e,t,r,c,s);for(let d=0;d<a;++d)n.fill();isNaN(l)||(c=o+(l%er||er))}return Zx(n,e,t,r,c,s),n.fill(),c}function dle(n,e,t,r,s){const{fullCircles:a,startAngle:o,circumference:l,options:c}=e,{borderWidth:d,borderJoinStyle:h,borderDash:p,borderDashOffset:x,borderRadius:v}=c,b=c.borderAlign==="inner";if(!d)return;n.setLineDash(p||[]),n.lineDashOffset=x,b?(n.lineWidth=d*2,n.lineJoin=h||"round"):(n.lineWidth=d,n.lineJoin=h||"bevel");let _=e.endAngle;if(a){Zx(n,e,t,r,_,s);for(let j=0;j<a;++j)n.stroke();isNaN(l)||(_=o+(l%er||er))}b&&ale(n,e,_),c.selfJoin&&_-o>=Dn&&v===0&&h!=="miter"&&ile(n,e,_),a||(Zx(n,e,t,r,_,s),n.stroke())}class ule extends ud{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,r){const s=this.getProps(["x","y"],r),{angle:a,distance:o}=h6(s,{x:e,y:t}),{startAngle:l,endAngle:c,innerRadius:d,outerRadius:h,circumference:p}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),x=(this.options.spacing+this.options.borderWidth)/2,v=Zt(p,c-l),b=Pm(a,l,c)&&l!==c,_=v>=er||b,j=jl(o,d+x,h+x);return _&&j}getCenterPoint(e){const{x:t,y:r,startAngle:s,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:d}=this.options,h=(s+a)/2,p=(o+l+d+c)/2;return{x:t+Math.cos(h)*p,y:r+Math.sin(h)*p}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:r}=this,s=(t.offset||0)/4,a=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=r>er?Math.floor(r/er):0,r===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*s,Math.sin(l)*s);const c=1-Math.sin(Math.min(Dn,r||0)),d=s*c;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,cle(e,this,d,a,o),dle(e,this,d,a,o),e.restore()}}function $6(n,e,t=e){n.lineCap=Zt(t.borderCapStyle,e.borderCapStyle),n.setLineDash(Zt(t.borderDash,e.borderDash)),n.lineDashOffset=Zt(t.borderDashOffset,e.borderDashOffset),n.lineJoin=Zt(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Zt(t.borderWidth,e.borderWidth),n.strokeStyle=Zt(t.borderColor,e.borderColor)}function fle(n,e,t){n.lineTo(t.x,t.y)}function hle(n){return n.stepped?Die:n.tension||n.cubicInterpolationMode==="monotone"?Oie:fle}function H6(n,e,t={}){const r=n.length,{start:s=0,end:a=r-1}=t,{start:o,end:l}=e,c=Math.max(s,o),d=Math.min(a,l),h=s<o&&a<o||s>l&&a>l;return{count:r,start:c,loop:e.loop,ilen:d<c&&!h?r+d-c:d-c}}function mle(n,e,t,r){const{points:s,options:a}=e,{count:o,start:l,loop:c,ilen:d}=H6(s,t,r),h=hle(a);let{move:p=!0,reverse:x}=r||{},v,b,_;for(v=0;v<=d;++v)b=s[(l+(x?d-v:v))%o],!b.skip&&(p?(n.moveTo(b.x,b.y),p=!1):h(n,_,b,x,a.stepped),_=b);return c&&(b=s[(l+(x?d:0))%o],h(n,_,b,x,a.stepped)),!!c}function ple(n,e,t,r){const s=e.points,{count:a,start:o,ilen:l}=H6(s,t,r),{move:c=!0,reverse:d}=r||{};let h=0,p=0,x,v,b,_,j,C;const P=M=>(o+(d?l-M:M))%a,O=()=>{_!==j&&(n.lineTo(h,j),n.lineTo(h,_),n.lineTo(h,C))};for(c&&(v=s[P(0)],n.moveTo(v.x,v.y)),x=0;x<=l;++x){if(v=s[P(x)],v.skip)continue;const M=v.x,D=v.y,I=M|0;I===b?(D<_?_=D:D>j&&(j=D),h=(p*h+M)/++p):(O(),n.lineTo(M,D),b=I,p=0,_=j=D),C=D}O()}function eC(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?ple:mle}function gle(n){return n.stepped?uae:n.tension||n.cubicInterpolationMode==="monotone"?fae:ru}function xle(n,e,t,r){let s=e._path;s||(s=e._path=new Path2D,e.path(s,t,r)&&s.closePath()),$6(n,e.options),n.stroke(s)}function yle(n,e,t,r){const{segments:s,options:a}=e,o=eC(e);for(const l of s)$6(n,a,l.style),n.beginPath(),o(n,e,l,{start:t,end:t+r-1})&&n.closePath(),n.stroke()}const vle=typeof Path2D=="function";function ble(n,e,t,r){vle&&!e.options.segment?xle(n,e,t,r):yle(n,e,t,r)}class Fy extends ud{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const s=r.spanGaps?this._loop:this._fullLoop;rae(this._points,r,e,s,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=yae(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,s=e[t],a=this.points,o=E6(this,{property:t,start:s,end:s});if(!o.length)return;const l=[],c=gle(r);let d,h;for(d=0,h=o.length;d<h;++d){const{start:p,end:x}=o[d],v=a[p],b=a[x];if(v===b){l.push(v);continue}const _=Math.abs((s-v[t])/(b[t]-v[t])),j=c(v,b,_,r.stepped);j[t]=e[t],l.push(j)}return l.length===1?l[0]:l}pathSegment(e,t,r){return eC(this)(e,this,t,r)}path(e,t,r){const s=this.segments,a=eC(this);let o=this._loop;t=t||0,r=r||this.points.length-t;for(const l of s)o&=a(e,this,l,{start:t,end:t+r-1});return!!o}draw(e,t,r,s){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),ble(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function vL(n,e,t,r){const s=n.options,{[t]:a}=n.getProps([t],r);return Math.abs(e-a)<s.radius+s.hitRadius}class wle extends ud{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,r){const s=this.options,{x:a,y:o}=this.getProps(["x","y"],r);return Math.pow(e-a,2)+Math.pow(t-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,t){return vL(this,e,"x",t)}inYRange(e,t){return vL(this,e,"y",t)}getCenterPoint(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const r=t&&e.borderWidth||0;return(t+r)*2}draw(e,t){const r=this.options;this.skip||r.radius<.1||!Mm(this,t,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,JN(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Y6(n,e){const{x:t,y:r,base:s,width:a,height:o}=n.getProps(["x","y","base","width","height"],e);let l,c,d,h,p;return n.horizontal?(p=o/2,l=Math.min(t,s),c=Math.max(t,s),d=r-p,h=r+p):(p=a/2,l=t-p,c=t+p,d=Math.min(r,s),h=Math.max(r,s)),{left:l,top:d,right:c,bottom:h}}function zc(n,e,t,r){return n?0:cs(e,t,r)}function _le(n,e,t){const r=n.options.borderWidth,s=n.borderSkipped,a=w6(r);return{t:zc(s.top,a.top,0,t),r:zc(s.right,a.right,0,e),b:zc(s.bottom,a.bottom,0,t),l:zc(s.left,a.left,0,e)}}function jle(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,a=wf(s),o=Math.min(e,t),l=n.borderSkipped,c=r||nn(s);return{topLeft:zc(!c||l.top||l.left,a.topLeft,0,o),topRight:zc(!c||l.top||l.right,a.topRight,0,o),bottomLeft:zc(!c||l.bottom||l.left,a.bottomLeft,0,o),bottomRight:zc(!c||l.bottom||l.right,a.bottomRight,0,o)}}function Sle(n){const e=Y6(n),t=e.right-e.left,r=e.bottom-e.top,s=_le(n,t/2,r/2),a=jle(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:a},inner:{x:e.left+s.l,y:e.top+s.t,w:t-s.l-s.r,h:r-s.t-s.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,a.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(s.b,s.r))}}}}function RS(n,e,t,r){const s=e===null,a=t===null,l=n&&!(s&&a)&&Y6(n,r);return l&&(s||jl(e,l.left,l.right))&&(a||jl(t,l.top,l.bottom))}function Nle(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Cle(n,e){n.rect(e.x,e.y,e.w,e.h)}function LS(n,e,t={}){const r=n.x!==t.x?-e:0,s=n.y!==t.y?-e:0,a=(n.x+n.w!==t.x+t.w?e:0)-r,o=(n.y+n.h!==t.y+t.h?e:0)-s;return{x:n.x+r,y:n.y+s,w:n.w+a,h:n.h+o,radius:n.radius}}class Tle extends ud{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:s}}=this,{inner:a,outer:o}=Sle(this),l=Nle(o.radius)?Hx:Cle;e.save(),(o.w!==a.w||o.h!==a.h)&&(e.beginPath(),l(e,LS(o,t,a)),e.clip(),l(e,LS(a,-t,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),l(e,LS(a,t)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,t,r){return RS(this,e,t,r)}inXRange(e,t){return RS(this,e,null,t)}inYRange(e,t){return RS(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:s,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(t+s)/2:t,y:a?r:(r+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}function kle(n,e,t){const r=n.segments,s=n.points,a=e.points,o=[];for(const l of r){let{start:c,end:d}=l;d=qy(c,d,s);const h=tC(t,s[c],s[d],l.loop);if(!e.segments){o.push({source:l,target:h,start:s[c],end:s[d]});continue}const p=E6(e,h);for(const x of p){const v=tC(t,a[x.start],a[x.end],x.loop),b=M6(l,s,v);for(const _ of b)o.push({source:_,target:x,start:{[t]:bL(h,v,"start",Math.max)},end:{[t]:bL(h,v,"end",Math.min)}})}}return o}function tC(n,e,t,r){if(r)return;let s=e[n],a=t[n];return n==="angle"&&(s=pi(s),a=pi(a)),{property:n,start:s,end:a}}function Ple(n,e){const{x:t=null,y:r=null}=n||{},s=e.points,a=[];return e.segments.forEach(({start:o,end:l})=>{l=qy(o,l,s);const c=s[o],d=s[l];r!==null?(a.push({x:c.x,y:r}),a.push({x:d.x,y:r})):t!==null&&(a.push({x:t,y:c.y}),a.push({x:t,y:d.y}))}),a}function qy(n,e,t){for(;e>n;e--){const r=t[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function bL(n,e,t,r){return n&&e?r(n[t],e[t]):n?n[t]:e?e[t]:0}function G6(n,e){let t=[],r=!1;return kr(n)?(r=!0,t=n):t=Ple(n,e),t.length?new Fy({points:t,options:{tension:0},_loop:r,_fullLoop:r}):null}function wL(n){return n&&n.fill!==!1}function Mle(n,e,t){let s=n[e].fill;const a=[e];let o;if(!t)return s;for(;s!==!1&&a.indexOf(s)===-1;){if(!us(s))return s;if(o=n[s],!o)return!1;if(o.visible)return s;a.push(s),s=o.fill}return!1}function Ele(n,e,t){const r=Ale(n);if(nn(r))return isNaN(r.value)?!1:r;let s=parseFloat(r);return us(s)&&Math.floor(s)===s?Dle(r[0],e,s,t):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function Dle(n,e,t,r){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=r?!1:t}function Ole(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:nn(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function Ile(n,e,t){let r;return n==="start"?r=t:n==="end"?r=e.options.reverse?e.min:e.max:nn(n)?r=n.value:r=e.getBaseValue(),r}function Ale(n){const e=n.options,t=e.fill;let r=Zt(t&&t.target,t);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function Rle(n){const{scale:e,index:t,line:r}=n,s=[],a=r.segments,o=r.points,l=Lle(e,t);l.push(G6({x:null,y:e.bottom},r));for(let c=0;c<a.length;c++){const d=a[c];for(let h=d.start;h<=d.end;h++)Fle(s,o[h],l)}return new Fy({points:s,options:{}})}function Lle(n,e){const t=[],r=n.getMatchingVisibleMetas("line");for(let s=0;s<r.length;s++){const a=r[s];if(a.index===e)break;a.hidden||t.unshift(a.dataset)}return t}function Fle(n,e,t){const r=[];for(let s=0;s<t.length;s++){const a=t[s],{first:o,last:l,point:c}=qle(a,e,"x");if(!(!c||o&&l)){if(o)r.unshift(c);else if(n.push(c),!l)break}}n.push(...r)}function qle(n,e,t){const r=n.interpolate(e,t);if(!r)return{};const s=r[t],a=n.segments,o=n.points;let l=!1,c=!1;for(let d=0;d<a.length;d++){const h=a[d],p=o[h.start][t],x=o[h.end][t];if(jl(s,p,x)){l=s===p,c=s===x;break}}return{first:l,last:c,point:r}}class Z6{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,r){const{x:s,y:a,radius:o}=this;return t=t||{start:0,end:er},e.arc(s,a,o,t.end,t.start,!0),!r.bounds}interpolate(e){const{x:t,y:r,radius:s}=this,a=e.angle;return{x:t+Math.cos(a)*s,y:r+Math.sin(a)*s,angle:a}}}function zle(n){const{chart:e,fill:t,line:r}=n;if(us(t))return Ule(e,t);if(t==="stack")return Rle(n);if(t==="shape")return!0;const s=Ble(n);return s instanceof Z6?s:G6(s,r)}function Ule(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function Ble(n){return(n.scale||{}).getPointPositionForValue?Wle(n):Vle(n)}function Vle(n){const{scale:e={},fill:t}=n,r=Ole(t,e);if(us(r)){const s=e.isHorizontal();return{x:s?r:null,y:s?null:r}}return null}function Wle(n){const{scale:e,fill:t}=n,r=e.options,s=e.getLabels().length,a=r.reverse?e.max:e.min,o=Ile(t,e,a),l=[];if(r.grid.circular){const c=e.getPointPositionForValue(0,a);return new Z6({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(o)})}for(let c=0;c<s;++c)l.push(e.getPointPositionForValue(c,o));return l}function FS(n,e,t){const r=zle(e),{chart:s,index:a,line:o,scale:l,axis:c}=e,d=o.options,h=d.fill,p=d.backgroundColor,{above:x=p,below:v=p}=h||{},b=s.getDatasetMeta(a),_=D6(s,b);r&&o.points.length&&(Dy(n,t),$le(n,{line:o,target:r,above:x,below:v,area:t,scale:l,axis:c,clip:_}),Oy(n))}function $le(n,e){const{line:t,target:r,above:s,below:a,area:o,scale:l,clip:c}=e,d=t._loop?"angle":e.axis;n.save();let h=a;a!==s&&(d==="x"?(_L(n,r,o.top),qS(n,{line:t,target:r,color:s,scale:l,property:d,clip:c}),n.restore(),n.save(),_L(n,r,o.bottom)):d==="y"&&(jL(n,r,o.left),qS(n,{line:t,target:r,color:a,scale:l,property:d,clip:c}),n.restore(),n.save(),jL(n,r,o.right),h=s)),qS(n,{line:t,target:r,color:h,scale:l,property:d,clip:c}),n.restore()}function _L(n,e,t){const{segments:r,points:s}=e;let a=!0,o=!1;n.beginPath();for(const l of r){const{start:c,end:d}=l,h=s[c],p=s[qy(c,d,s)];a?(n.moveTo(h.x,h.y),a=!1):(n.lineTo(h.x,t),n.lineTo(h.x,h.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(p.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function jL(n,e,t){const{segments:r,points:s}=e;let a=!0,o=!1;n.beginPath();for(const l of r){const{start:c,end:d}=l,h=s[c],p=s[qy(c,d,s)];a?(n.moveTo(h.x,h.y),a=!1):(n.lineTo(t,h.y),n.lineTo(h.x,h.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(t,p.y)}n.lineTo(t,e.first().y),n.closePath(),n.clip()}function qS(n,e){const{line:t,target:r,property:s,color:a,scale:o,clip:l}=e,c=kle(t,r,s);for(const{source:d,target:h,start:p,end:x}of c){const{style:{backgroundColor:v=a}={}}=d,b=r!==!0;n.save(),n.fillStyle=v,Hle(n,o,l,b&&tC(s,p,x)),n.beginPath();const _=!!t.pathSegment(n,d);let j;if(b){_?n.closePath():SL(n,r,x,s);const C=!!r.pathSegment(n,h,{move:_,reverse:!0});j=_&&C,j||SL(n,r,p,s)}n.closePath(),n.fill(j?"evenodd":"nonzero"),n.restore()}}function Hle(n,e,t,r){const s=e.chart.chartArea,{property:a,start:o,end:l}=r||{};if(a==="x"||a==="y"){let c,d,h,p;a==="x"?(c=o,d=s.top,h=l,p=s.bottom):(c=s.left,d=o,h=s.right,p=l),n.beginPath(),t&&(c=Math.max(c,t.left),h=Math.min(h,t.right),d=Math.max(d,t.top),p=Math.min(p,t.bottom)),n.rect(c,d,h-c,p-d),n.clip()}}function SL(n,e,t,r){const s=e.interpolate(t,r);s&&n.lineTo(s.x,s.y)}var Yle={id:"filler",afterDatasetsUpdate(n,e,t){const r=(n.data.datasets||[]).length,s=[];let a,o,l,c;for(o=0;o<r;++o)a=n.getDatasetMeta(o),l=a.dataset,c=null,l&&l.options&&l instanceof Fy&&(c={visible:n.isDatasetVisible(o),index:o,fill:Ele(l,o,r),chart:n,axis:a.controller.options.indexAxis,scale:a.vScale,line:l}),a.$filler=c,s.push(c);for(o=0;o<r;++o)c=s[o],!(!c||c.fill===!1)&&(c.fill=Mle(s,o,t.propagate))},beforeDraw(n,e,t){const r=t.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),a=n.chartArea;for(let o=s.length-1;o>=0;--o){const l=s[o].$filler;l&&(l.line.updateControlPoints(a,l.axis),r&&l.fill&&FS(n.ctx,l,a))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const r=n.getSortedVisibleDatasetMetas();for(let s=r.length-1;s>=0;--s){const a=r[s].$filler;wL(a)&&FS(n.ctx,a,n.chartArea)}},beforeDatasetDraw(n,e,t){const r=e.meta.$filler;!wL(r)||t.drawTime!=="beforeDatasetDraw"||FS(n.ctx,r,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const NL=(n,e)=>{let{boxHeight:t=e,boxWidth:r=e}=n;return n.usePointStyle&&(t=Math.min(t,e),r=n.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(e,t)}},Gle=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class CL extends ud{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Bn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(r=>e.filter(r,this.chart.data))),e.sort&&(t=t.sort((r,s)=>e.sort(r,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,s=Ks(r.font),a=s.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=NL(r,a);let d,h;t.font=s.string,this.isHorizontal()?(d=this.maxWidth,h=this._fitRows(o,a,l,c)+10):(h=this.maxHeight,d=this._fitCols(o,s,l,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(h,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,s){const{ctx:a,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],h=s+l;let p=e;a.textAlign="left",a.textBaseline="middle";let x=-1,v=-h;return this.legendItems.forEach((b,_)=>{const j=r+t/2+a.measureText(b.text).width;(_===0||d[d.length-1]+j+2*l>o)&&(p+=h,d[d.length-(_>0?0:1)]=0,v+=h,x++),c[_]={left:0,top:v,row:x,width:j,height:s},d[d.length-1]+=j+l}),p}_fitCols(e,t,r,s){const{ctx:a,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],h=o-e;let p=l,x=0,v=0,b=0,_=0;return this.legendItems.forEach((j,C)=>{const{itemWidth:P,itemHeight:O}=Zle(r,t,a,j,s);C>0&&v+O+2*l>h&&(p+=x+l,d.push({width:x,height:v}),b+=x+l,_++,x=v=0),c[C]={left:b,top:v,col:_,width:P,height:O},x=Math.max(x,P),v+=O+l}),p+=x,d.push({width:x,height:v}),p}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:s},rtl:a}}=this,o=_f(a,this.left,this.width);if(this.isHorizontal()){let l=0,c=hi(r,this.left+s,this.right-this.lineWidths[l]);for(const d of t)l!==d.row&&(l=d.row,c=hi(r,this.left+s,this.right-this.lineWidths[l])),d.top+=this.top+e+s,d.left=o.leftForLtr(o.x(c),d.width),c+=d.width+s}else{let l=0,c=hi(r,this.top+e+s,this.bottom-this.columnSizes[l].height);for(const d of t)d.col!==l&&(l=d.col,c=hi(r,this.top+e+s,this.bottom-this.columnSizes[l].height)),d.top=c,d.left+=this.left+s,d.left=o.leftForLtr(o.x(d.left),d.width),c+=d.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Dy(e,this),this._draw(),Oy(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:s}=this,{align:a,labels:o}=e,l=dr.color,c=_f(e.rtl,this.left,this.width),d=Ks(o.font),{padding:h}=o,p=d.size,x=p/2;let v;this.drawTitle(),s.textAlign=c.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=d.string;const{boxWidth:b,boxHeight:_,itemHeight:j}=NL(o,p),C=function(I,F,q){if(isNaN(b)||b<=0||isNaN(_)||_<0)return;s.save();const U=Zt(q.lineWidth,1);if(s.fillStyle=Zt(q.fillStyle,l),s.lineCap=Zt(q.lineCap,"butt"),s.lineDashOffset=Zt(q.lineDashOffset,0),s.lineJoin=Zt(q.lineJoin,"miter"),s.lineWidth=U,s.strokeStyle=Zt(q.strokeStyle,l),s.setLineDash(Zt(q.lineDash,[])),o.usePointStyle){const B={radius:_*Math.SQRT2/2,pointStyle:q.pointStyle,rotation:q.rotation,borderWidth:U},W=c.xPlus(I,b/2),Y=F+x;b6(s,B,W,Y,o.pointStyleWidth&&b)}else{const B=F+Math.max((p-_)/2,0),W=c.leftForLtr(I,b),Y=wf(q.borderRadius);s.beginPath(),Object.values(Y).some(G=>G!==0)?Hx(s,{x:W,y:B,w:b,h:_,radius:Y}):s.rect(W,B,b,_),s.fill(),U!==0&&s.stroke()}s.restore()},P=function(I,F,q){$x(s,q.text,I,F+j/2,d,{strikethrough:q.hidden,textAlign:c.textAlign(q.textAlign)})},O=this.isHorizontal(),M=this._computeTitleHeight();O?v={x:hi(a,this.left+h,this.right-r[0]),y:this.top+h+M,line:0}:v={x:this.left+h,y:hi(a,this.top+M+h,this.bottom-t[0].height),line:0},T6(this.ctx,e.textDirection);const D=j+h;this.legendItems.forEach((I,F)=>{s.strokeStyle=I.fontColor,s.fillStyle=I.fontColor;const q=s.measureText(I.text).width,U=c.textAlign(I.textAlign||(I.textAlign=o.textAlign)),B=b+x+q;let W=v.x,Y=v.y;c.setWidth(this.width),O?F>0&&W+B+h>this.right&&(Y=v.y+=D,v.line++,W=v.x=hi(a,this.left+h,this.right-r[v.line])):F>0&&Y+D>this.bottom&&(W=v.x=W+t[v.line].width+h,v.line++,Y=v.y=hi(a,this.top+M+h,this.bottom-t[v.line].height));const G=c.x(W);if(C(G,Y,I),W=vie(U,W+b+x,O?W+B:this.right,e.rtl),P(c.x(W),Y,I),O)v.x+=B+h;else if(typeof I.text!="string"){const Z=d.lineHeight;v.y+=K6(I,Z)+h}else v.y+=D}),k6(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=Ks(t.font),s=La(t.padding);if(!t.display)return;const a=_f(e.rtl,this.left,this.width),o=this.ctx,l=t.position,c=r.size/2,d=s.top+c;let h,p=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),h=this.top+d,p=hi(e.align,p,this.right-x);else{const b=this.columnSizes.reduce((_,j)=>Math.max(_,j.height),0);h=d+hi(e.align,this.top,this.bottom-b-e.labels.padding-this._computeTitleHeight())}const v=hi(l,p,p+x);o.textAlign=a.textAlign(y6(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=r.string,$x(o,t.text,v,h,r)}_computeTitleHeight(){const e=this.options.title,t=Ks(e.font),r=La(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,s,a;if(jl(e,this.left,this.right)&&jl(t,this.top,this.bottom)){for(a=this.legendHitBoxes,r=0;r<a.length;++r)if(s=a[r],jl(e,s.left,s.left+s.width)&&jl(t,s.top,s.top+s.height))return this.legendItems[r]}return null}handleEvent(e){const t=this.options;if(!Qle(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,a=Gle(s,r);s&&!a&&Bn(t.onLeave,[e,s,this],this),this._hoveredItem=r,r&&!a&&Bn(t.onHover,[e,r,this],this)}else r&&Bn(t.onClick,[e,r,this],this)}}function Zle(n,e,t,r,s){const a=Kle(r,n,e,t),o=Jle(s,r,e.lineHeight);return{itemWidth:a,itemHeight:o}}function Kle(n,e,t,r){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((a,o)=>a.length>o.length?a:o)),e+t.size/2+r.measureText(s).width}function Jle(n,e,t){let r=n;return typeof e.text!="string"&&(r=K6(e,t)),r}function K6(n,e){const t=n.text?n.text.length:0;return e*t}function Qle(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var Xle={id:"legend",_element:CL,start(n,e,t){const r=n.legend=new CL({ctx:n.ctx,options:t,chart:n});qc.configure(n,r,t),qc.addBox(n,r)},stop(n){qc.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const r=n.legend;qc.configure(n,r,t),r.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const r=e.datasetIndex,s=t.chart;s.isDatasetVisible(r)?(s.hide(r),e.hidden=!0):(s.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:s,color:a,useBorderRadius:o,borderRadius:l}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(t?0:void 0),h=La(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:a,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:d.borderColor,pointStyle:r||d.pointStyle,rotation:d.rotation,textAlign:s||d.textAlign,borderRadius:o&&(l||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};const Jh={average(n){if(!n.length)return!1;let e,t,r=new Set,s=0,a=0;for(e=0,t=n.length;e<t;++e){const l=n[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();r.add(c.x),s+=c.y,++a}}return a===0||r.size===0?!1:{x:[...r].reduce((l,c)=>l+c)/r.size,y:s/a}},nearest(n,e){if(!n.length)return!1;let t=e.x,r=e.y,s=Number.POSITIVE_INFINITY,a,o,l;for(a=0,o=n.length;a<o;++a){const c=n[a].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),h=ZN(e,d);h<s&&(s=h,l=c)}}if(l){const c=l.tooltipPosition();t=c.x,r=c.y}return{x:t,y:r}}};function go(n,e){return e&&(kr(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function xl(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function ece(n,e){const{element:t,datasetIndex:r,index:s}=e,a=n.getDatasetMeta(r).controller,{label:o,value:l}=a.getLabelAndValue(s);return{chart:n,label:o,parsed:a.getParsed(s),raw:n.data.datasets[r].data[s],formattedValue:l,dataset:a.getDataset(),dataIndex:s,datasetIndex:r,element:t}}function TL(n,e){const t=n.chart.ctx,{body:r,footer:s,title:a}=n,{boxWidth:o,boxHeight:l}=e,c=Ks(e.bodyFont),d=Ks(e.titleFont),h=Ks(e.footerFont),p=a.length,x=s.length,v=r.length,b=La(e.padding);let _=b.height,j=0,C=r.reduce((M,D)=>M+D.before.length+D.lines.length+D.after.length,0);if(C+=n.beforeBody.length+n.afterBody.length,p&&(_+=p*d.lineHeight+(p-1)*e.titleSpacing+e.titleMarginBottom),C){const M=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;_+=v*M+(C-v)*c.lineHeight+(C-1)*e.bodySpacing}x&&(_+=e.footerMarginTop+x*h.lineHeight+(x-1)*e.footerSpacing);let P=0;const O=function(M){j=Math.max(j,t.measureText(M).width+P)};return t.save(),t.font=d.string,Nn(n.title,O),t.font=c.string,Nn(n.beforeBody.concat(n.afterBody),O),P=e.displayColors?o+2+e.boxPadding:0,Nn(r,M=>{Nn(M.before,O),Nn(M.lines,O),Nn(M.after,O)}),P=0,t.font=h.string,Nn(n.footer,O),t.restore(),j+=b.width,{width:j,height:_}}function tce(n,e){const{y:t,height:r}=e;return t<r/2?"top":t>n.height-r/2?"bottom":"center"}function nce(n,e,t,r){const{x:s,width:a}=r,o=t.caretSize+t.caretPadding;if(n==="left"&&s+a+o>e.width||n==="right"&&s-a-o<0)return!0}function rce(n,e,t,r){const{x:s,width:a}=t,{width:o,chartArea:{left:l,right:c}}=n;let d="center";return r==="center"?d=s<=(l+c)/2?"left":"right":s<=a/2?d="left":s>=o-a/2&&(d="right"),nce(d,n,e,t)&&(d="center"),d}function kL(n,e,t){const r=t.yAlign||e.yAlign||tce(n,t);return{xAlign:t.xAlign||e.xAlign||rce(n,e,t,r),yAlign:r}}function sce(n,e){let{x:t,width:r}=n;return e==="right"?t-=r:e==="center"&&(t-=r/2),t}function ice(n,e,t){let{y:r,height:s}=n;return e==="top"?r+=t:e==="bottom"?r-=s+t:r-=s/2,r}function PL(n,e,t,r){const{caretSize:s,caretPadding:a,cornerRadius:o}=n,{xAlign:l,yAlign:c}=t,d=s+a,{topLeft:h,topRight:p,bottomLeft:x,bottomRight:v}=wf(o);let b=sce(e,l);const _=ice(e,c,d);return c==="center"?l==="left"?b+=d:l==="right"&&(b-=d):l==="left"?b-=Math.max(h,x)+s:l==="right"&&(b+=Math.max(p,v)+s),{x:cs(b,0,r.width-e.width),y:cs(_,0,r.height-e.height)}}function Qg(n,e,t){const r=La(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-r.right:n.x+r.left}function ML(n){return go([],xl(n))}function ace(n,e,t){return ku(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function EL(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const J6={beforeTitle:ml,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:ml,beforeBody:ml,beforeLabel:ml,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return _n(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ml,afterBody:ml,beforeFooter:ml,footer:ml,afterFooter:ml};function Ws(n,e,t,r){const s=n[e].call(t,r);return typeof s>"u"?J6[e].call(t,r):s}class DL extends ud{static positioners=Jh;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&t.options.animation&&r.animations,a=new O6(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=ace(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:r}=t,s=Ws(r,"beforeTitle",this,e),a=Ws(r,"title",this,e),o=Ws(r,"afterTitle",this,e);let l=[];return l=go(l,xl(s)),l=go(l,xl(a)),l=go(l,xl(o)),l}getBeforeBody(e,t){return ML(Ws(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,s=[];return Nn(e,a=>{const o={before:[],lines:[],after:[]},l=EL(r,a);go(o.before,xl(Ws(l,"beforeLabel",this,a))),go(o.lines,Ws(l,"label",this,a)),go(o.after,xl(Ws(l,"afterLabel",this,a))),s.push(o)}),s}getAfterBody(e,t){return ML(Ws(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,s=Ws(r,"beforeFooter",this,e),a=Ws(r,"footer",this,e),o=Ws(r,"afterFooter",this,e);let l=[];return l=go(l,xl(s)),l=go(l,xl(a)),l=go(l,xl(o)),l}_createItems(e){const t=this._active,r=this.chart.data,s=[],a=[],o=[];let l=[],c,d;for(c=0,d=t.length;c<d;++c)l.push(ece(this.chart,t[c]));return e.filter&&(l=l.filter((h,p,x)=>e.filter(h,p,x,r))),e.itemSort&&(l=l.sort((h,p)=>e.itemSort(h,p,r))),Nn(l,h=>{const p=EL(e.callbacks,h);s.push(Ws(p,"labelColor",this,h)),a.push(Ws(p,"labelPointStyle",this,h)),o.push(Ws(p,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const r=this.options.setContext(this.getContext()),s=this._active;let a,o=[];if(!s.length)this.opacity!==0&&(a={opacity:0});else{const l=Jh[r.position].call(this,s,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const c=this._size=TL(this,r),d=Object.assign({},l,c),h=kL(this.chart,r,d),p=PL(r,d,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,a={opacity:1,x:p.x,y:p.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,s){const a=this.getCaretPosition(e,r,s);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}getCaretPosition(e,t,r){const{xAlign:s,yAlign:a}=this,{caretSize:o,cornerRadius:l}=r,{topLeft:c,topRight:d,bottomLeft:h,bottomRight:p}=wf(l),{x,y:v}=e,{width:b,height:_}=t;let j,C,P,O,M,D;return a==="center"?(M=v+_/2,s==="left"?(j=x,C=j-o,O=M+o,D=M-o):(j=x+b,C=j+o,O=M-o,D=M+o),P=j):(s==="left"?C=x+Math.max(c,h)+o:s==="right"?C=x+b-Math.max(d,p)-o:C=this.caretX,a==="top"?(O=v,M=O-o,j=C-o,P=C+o):(O=v+_,M=O+o,j=C+o,P=C-o),D=O),{x1:j,x2:C,x3:P,y1:O,y2:M,y3:D}}drawTitle(e,t,r){const s=this.title,a=s.length;let o,l,c;if(a){const d=_f(r.rtl,this.x,this.width);for(e.x=Qg(this,r.titleAlign,r),t.textAlign=d.textAlign(r.titleAlign),t.textBaseline="middle",o=Ks(r.titleFont),l=r.titleSpacing,t.fillStyle=r.titleColor,t.font=o.string,c=0;c<a;++c)t.fillText(s[c],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,c+1===a&&(e.y+=r.titleMarginBottom-l)}}_drawColorBox(e,t,r,s,a){const o=this.labelColors[r],l=this.labelPointStyles[r],{boxHeight:c,boxWidth:d}=a,h=Ks(a.bodyFont),p=Qg(this,"left",a),x=s.x(p),v=c<h.lineHeight?(h.lineHeight-c)/2:0,b=t.y+v;if(a.usePointStyle){const _={radius:Math.min(d,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},j=s.leftForLtr(x,d)+d/2,C=b+c/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,JN(e,_,j,C),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,JN(e,_,j,C)}else{e.lineWidth=nn(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const _=s.leftForLtr(x,d),j=s.leftForLtr(s.xPlus(x,1),d-2),C=wf(o.borderRadius);Object.values(C).some(P=>P!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,Hx(e,{x:_,y:b,w:d,h:c,radius:C}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Hx(e,{x:j,y:b+1,w:d-2,h:c-2,radius:C}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(_,b,d,c),e.strokeRect(_,b,d,c),e.fillStyle=o.backgroundColor,e.fillRect(j,b+1,d-2,c-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:s}=this,{bodySpacing:a,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:d,boxPadding:h}=r,p=Ks(r.bodyFont);let x=p.lineHeight,v=0;const b=_f(r.rtl,this.x,this.width),_=function(q){t.fillText(q,b.x(e.x+v),e.y+x/2),e.y+=x+a},j=b.textAlign(o);let C,P,O,M,D,I,F;for(t.textAlign=o,t.textBaseline="middle",t.font=p.string,e.x=Qg(this,j,r),t.fillStyle=r.bodyColor,Nn(this.beforeBody,_),v=l&&j!=="right"?o==="center"?d/2+h:d+2+h:0,M=0,I=s.length;M<I;++M){for(C=s[M],P=this.labelTextColors[M],t.fillStyle=P,Nn(C.before,_),O=C.lines,l&&O.length&&(this._drawColorBox(t,e,M,b,r),x=Math.max(p.lineHeight,c)),D=0,F=O.length;D<F;++D)_(O[D]),x=p.lineHeight;Nn(C.after,_)}v=0,x=p.lineHeight,Nn(this.afterBody,_),e.y-=a}drawFooter(e,t,r){const s=this.footer,a=s.length;let o,l;if(a){const c=_f(r.rtl,this.x,this.width);for(e.x=Qg(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=c.textAlign(r.footerAlign),t.textBaseline="middle",o=Ks(r.footerFont),t.fillStyle=r.footerColor,t.font=o.string,l=0;l<a;++l)t.fillText(s[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,t,r,s){const{xAlign:a,yAlign:o}=this,{x:l,y:c}=e,{width:d,height:h}=r,{topLeft:p,topRight:x,bottomLeft:v,bottomRight:b}=wf(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(l+p,c),o==="top"&&this.drawCaret(e,t,r,s),t.lineTo(l+d-x,c),t.quadraticCurveTo(l+d,c,l+d,c+x),o==="center"&&a==="right"&&this.drawCaret(e,t,r,s),t.lineTo(l+d,c+h-b),t.quadraticCurveTo(l+d,c+h,l+d-b,c+h),o==="bottom"&&this.drawCaret(e,t,r,s),t.lineTo(l+v,c+h),t.quadraticCurveTo(l,c+h,l,c+h-v),o==="center"&&a==="left"&&this.drawCaret(e,t,r,s),t.lineTo(l,c+p),t.quadraticCurveTo(l,c,l+p,c),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,s=r&&r.x,a=r&&r.y;if(s||a){const o=Jh[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=TL(this,e),c=Object.assign({},o,this._size),d=kL(t,e,c),h=PL(e,c,d,t);(s._to!==h.x||a._to!==h.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},a={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=La(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=r,this.drawBackground(a,e,s,t),T6(e,t.textDirection),a.y+=o.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),k6(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,s=e.map(({datasetIndex:l,index:c})=>{const d=this.chart.getDatasetMeta(l);if(!d)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:d.data[c],index:c}}),a=!Bx(r,s),o=this._positionChanged(s,t);(a||o)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,a=this._active||[],o=this._getActiveElements(e,a,t,r),l=this._positionChanged(o,e),c=t||!Bx(o,a)||l;return c&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),c}_getActiveElements(e,t,r,s){const a=this.options;if(e.type==="mouseout")return[];if(!s)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,a.mode,a,r);return a.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:r,caretY:s,options:a}=this,o=Jh[a.position].call(this,e,t);return o!==!1&&(r!==o.x||s!==o.y)}}var oce={id:"tooltip",_element:DL,positioners:Jh,afterInit(n,e,t){t&&(n.tooltip=new DL({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:J6},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const lce=(n,e,t,r)=>(typeof e=="string"?(t=n.push(e)-1,r.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function cce(n,e,t,r){const s=n.indexOf(e);if(s===-1)return lce(n,e,t,r);const a=n.lastIndexOf(e);return s!==a?t:s}const dce=(n,e)=>n===null?null:cs(Math.round(n),0,e);function OL(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class uce extends Qf{static id="category";static defaults={ticks:{callback:OL}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const r=this.getLabels();for(const{index:s,label:a}of t)r[s]===a&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(_n(e))return null;const r=this.getLabels();return t=isFinite(t)&&r[t]===e?t:cce(r,e,Zt(t,e),this._addedLabels),dce(t,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),t||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,s=[];let a=this.getLabels();a=e===0&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=t;o++)s.push({value:o});return s}getLabelForValue(e){return OL.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function fce(n,e){const t=[],{bounds:s,step:a,min:o,max:l,precision:c,count:d,maxTicks:h,maxDigits:p,includeBounds:x}=n,v=a||1,b=h-1,{min:_,max:j}=e,C=!_n(o),P=!_n(l),O=!_n(d),M=(j-_)/(p+1);let D=PR((j-_)/b/v)*v,I,F,q,U;if(D<1e-14&&!C&&!P)return[{value:_},{value:j}];U=Math.ceil(j/D)-Math.floor(_/D),U>b&&(D=PR(U*D/b/v)*v),_n(c)||(I=Math.pow(10,c),D=Math.ceil(D*I)/I),s==="ticks"?(F=Math.floor(_/D)*D,q=Math.ceil(j/D)*D):(F=_,q=j),C&&P&&a&&die((l-o)/a,D/1e3)?(U=Math.round(Math.min((l-o)/D,h)),D=(l-o)/U,F=o,q=l):O?(F=C?o:F,q=P?l:q,U=d-1,D=(q-F)/U):(U=(q-F)/D,im(U,Math.round(U),D/1e3)?U=Math.round(U):U=Math.ceil(U));const B=Math.max(MR(D),MR(F));I=Math.pow(10,_n(c)?B:c),F=Math.round(F*I)/I,q=Math.round(q*I)/I;let W=0;for(C&&(x&&F!==o?(t.push({value:o}),F<o&&W++,im(Math.round((F+W*D)*I)/I,o,IL(o,M,n))&&W++):F<o&&W++);W<U;++W){const Y=Math.round((F+W*D)*I)/I;if(P&&Y>l)break;t.push({value:Y})}return P&&x&&q!==l?t.length&&im(t[t.length-1].value,l,IL(l,M,n))?t[t.length-1].value=l:t.push({value:l}):(!P||q===l)&&t.push({value:q}),t}function IL(n,e,{horizontal:t,minRotation:r}){const s=_l(r),a=(t?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+n).length;return Math.min(e/a,o)}class hce extends Qf{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return _n(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:s,max:a}=this;const o=c=>s=t?s:c,l=c=>a=r?a:c;if(e){const c=Co(s),d=Co(a);c<0&&d<0?l(0):c>0&&d>0&&o(0)}if(s===a){let c=a===0?1:Math.abs(a*.05);l(a+c),e||o(s-c)}this.min=s,this.max=a}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,s;return r?(s=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),t=t||11),t&&(s=Math.min(t,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const s={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},a=this._range||this,o=fce(s,a);return e.bounds==="ticks"&&uie(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const s=(r-t)/Math.max(e.length-1,1)/2;t-=s,r+=s}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return g1(e,this.chart.options.locale,this.options.ticks.format)}}class mce extends hce{static id="linear";static defaults={ticks:{callback:v6.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=us(e)?e:0,this.max=us(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=_l(this.options.ticks.minRotation),s=(e?Math.sin(r):Math.cos(r))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const zy={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ys=Object.keys(zy);function AL(n,e){return n-e}function RL(n,e){if(_n(e))return null;const t=n._adapter,{parser:r,round:s,isoWeekday:a}=n._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),us(o)||(o=typeof r=="string"?t.parse(o,r):t.parse(o)),o===null?null:(s&&(o=s==="week"&&(km(a)||a===!0)?t.startOf(o,"isoWeek",a):t.startOf(o,s)),+o)}function LL(n,e,t,r){const s=Ys.length;for(let a=Ys.indexOf(n);a<s-1;++a){const o=zy[Ys[a]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=r)return Ys[a]}return Ys[s-1]}function pce(n,e,t,r,s){for(let a=Ys.length-1;a>=Ys.indexOf(t);a--){const o=Ys[a];if(zy[o].common&&n._adapter.diff(s,r,o)>=e-1)return o}return Ys[t?Ys.indexOf(t):0]}function gce(n){for(let e=Ys.indexOf(n)+1,t=Ys.length;e<t;++e)if(zy[Ys[e]].common)return Ys[e]}function FL(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:r,hi:s}=m1(t,e),a=t[r]>=e?t[r]:t[s];n[a]=!0}}function xce(n,e,t,r){const s=n._adapter,a=+s.startOf(e[0].value,r),o=e[e.length-1].value;let l,c;for(l=a;l<=o;l=+s.add(l,1,r))c=t[l],c>=0&&(e[c].major=!0);return e}function qL(n,e,t){const r=[],s={},a=e.length;let o,l;for(o=0;o<a;++o)l=e[o],s[l]=o,r.push({value:l,major:!1});return a===0||!t?r:xce(n,r,s,t)}class zL extends Qf{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),s=this._adapter=new Kae._date(e.adapters.date);s.init(t),sm(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:RL(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:s,max:a,minDefined:o,maxDefined:l}=this.getUserBounds();function c(d){!o&&!isNaN(d.min)&&(s=Math.min(s,d.min)),!l&&!isNaN(d.max)&&(a=Math.max(a,d.max))}(!o||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),s=us(s)&&!isNaN(s)?s:+t.startOf(Date.now(),r),a=us(a)&&!isNaN(a)?a:+t.endOf(Date.now(),r)+1,this.min=Math.min(s,a-1),this.max=Math.max(s+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,s=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const a=this.min,o=this.max,l=gie(s,a,o);return this._unit=t.unit||(r.autoSkip?LL(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):pce(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:gce(this._unit),this.initOffsets(s),e.reverse&&l.reverse(),qL(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,s,a;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?r=a:r=(a-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=cs(t,0,o),r=cs(r,0,o),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,s=this.options,a=s.time,o=a.unit||LL(a.minUnit,t,r,this._getLabelCapacity(t)),l=Zt(s.ticks.stepSize,1),c=o==="week"?a.isoWeekday:!1,d=km(c)||c===!0,h={};let p=t,x,v;if(d&&(p=+e.startOf(p,"isoWeek",c)),p=+e.startOf(p,d?"day":o),e.diff(r,t,o)>1e5*l)throw new Error(t+" and "+r+" are too far apart with stepSize of "+l+" "+o);const b=s.ticks.source==="data"&&this.getDataTimestamps();for(x=p,v=0;x<r;x=+e.add(x,l,o),v++)FL(h,x,b);return(x===r||s.bounds==="ticks"||v===1)&&FL(h,x,b),Object.keys(h).sort(AL).map(_=>+_)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,a=this._unit,o=t||s[a];return this._adapter.format(e,o)}_tickFormatFunction(e,t,r,s){const a=this.options,o=a.ticks.callback;if(o)return Bn(o,[e,t,r],this);const l=a.time.displayFormats,c=this._unit,d=this._majorUnit,h=c&&l[c],p=d&&l[d],x=r[t],v=d&&p&&x&&x.major;return this._adapter.format(e,s||(v?p:h))}generateTickLabels(e){let t,r,s;for(t=0,r=e.length;t<r;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,s=_l(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(s),o=Math.sin(s),l=this._resolveTickFontOptions(0).size;return{w:r*a+l*o,h:r*o+l*a}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,s=r[t.unit]||r.millisecond,a=this._tickFormatFunction(e,0,qL(this,[e],this._majorUnit),s),o=this._getLabelSize(a),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,r=s.length;t<r;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const s=this.getLabels();for(t=0,r=s.length;t<r;++t)e.push(RL(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return p6(e.sort(AL))}}function Xg(n,e,t){let r=0,s=n.length-1,a,o,l,c;t?(e>=n[r].pos&&e<=n[s].pos&&({lo:r,hi:s}=cu(n,"pos",e)),{pos:a,time:l}=n[r],{pos:o,time:c}=n[s]):(e>=n[r].time&&e<=n[s].time&&({lo:r,hi:s}=cu(n,"time",e)),{time:a,pos:l}=n[r],{time:o,pos:c}=n[s]);const d=o-a;return d?l+(c-l)*(e-a)/d:l}class Jhe extends zL{static id="timeseries";static defaults=zL.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Xg(t,this.min),this._tableRange=Xg(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,s=[],a=[];let o,l,c,d,h;for(o=0,l=e.length;o<l;++o)d=e[o],d>=t&&d<=r&&s.push(d);if(s.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(o=0,l=s.length;o<l;++o)h=s[o+1],c=s[o-1],d=s[o],Math.round((h+c)/2)!==d&&a.push({time:d,pos:o/(l-1)});return a}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(t)||r.length===1)&&r.push(t),r.sort((s,a)=>s-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Xg(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return Xg(this._table,r*this._tableRange+this._minPos,!0)}}Ly.register(Hae,Tle,uce,mce,Zae,Fy,wle,Gae,ule,oce,Xle,Yle);const yce=n=>{const e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;n=n.replace(e,(r,s,a,o)=>s+s+a+a+o+o);const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return t?`${parseInt(t[1],16)}, ${parseInt(t[2],16)}, ${parseInt(t[3],16)}`:"0, 0, 0"},UL=({title:n,icon:e,children:t})=>i.jsxs("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card col-span-1",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(e,{className:"h-5 w-5 mr-3 text-muted"}),i.jsx("h3",{className:"font-semibold text-primary-text",children:n})]}),i.jsx("div",{className:"h-64 md:h-80 relative",children:t})]}),vce=({data:n})=>{const e=E.useRef(null),t=E.useRef(null),{colorScheme:r}=on();return E.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const s=e.current.getContext("2d");if(s){const a=qa(r),o=a.activeItemBg,l=a.sidebarBorder;t.current=new Ly(s,{type:"bar",data:{labels:n.labels,datasets:[{label:"Present",data:n.present,backgroundColor:o,borderColor:l,borderWidth:1,borderRadius:4},{label:"Absent",data:n.absent,backgroundColor:"#EF4444",borderColor:"#DC2626",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}})}}return()=>{t.current&&t.current.destroy()}},[n,r]),i.jsx("div",{className:"h-full w-full flex flex-col",children:i.jsx("div",{className:"flex-grow relative",children:i.jsx("canvas",{ref:e})})})},bce=({data:n})=>{const e=E.useRef(null),t=E.useRef(null),{colorScheme:r}=on();return E.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const s=e.current.getContext("2d");if(s){const o=qa(r).activeItemBg,l=yce(o),c=s.createLinearGradient(0,0,0,200);c.addColorStop(0,`rgba(${l}, 0.4)`),c.addColorStop(1,`rgba(${l}, 0)`),t.current=new Ly(s,{type:"line",data:{labels:n.labels,datasets:[{label:"Average Hours Worked",data:n.hours,borderColor:o,backgroundColor:c,fill:!0,tension:.4,pointBackgroundColor:o,pointRadius:0,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"},ticks:{stepSize:1,precision:0,callback:d=>{const h=typeof d=="string"?parseFloat(d):d;return Math.round(h)}}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}})}}return()=>{t.current&&t.current.destroy()}},[n,r]),i.jsx("div",{className:"h-full w-full flex flex-col",children:i.jsx("div",{className:"flex-grow relative",children:i.jsx("canvas",{ref:e})})})},wce=({data:n,dateRange:e,colorScheme:t})=>i.jsxs("div",{className:"p-8 font-sans text-sm text-black bg-white",children:[i.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-6",children:[i.jsx(Xi,{className:"h-10",localPath:kC(t)}),i.jsxs("div",{className:"text-right",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Attendance Log"}),i.jsxs("p",{className:"text-gray-600",children:[We(e.startDate,"dd MMM yyyy")," to ",We(e.endDate,"dd MMM yyyy")]})]})]}),i.jsxs("table",{className:"w-full mt-6 text-left border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"p-2 border border-gray-300",children:"User"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Date"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Time"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Event"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Location"})]})}),i.jsx("tbody",{children:n.map((r,s)=>i.jsxs("tr",{className:"border-b",children:[i.jsx("td",{className:"p-2 border border-gray-300",children:r.userName}),i.jsx("td",{className:"p-2 border border-gray-300",children:r.date}),i.jsx("td",{className:"p-2 border border-gray-300",children:r.time}),i.jsx("td",{className:"p-2 border border-gray-300 capitalize",children:r.type.replace("-"," ")}),i.jsx("td",{className:"p-2 border border-gray-300",children:r.locationName||(r.latitude?`${r.latitude?.toFixed(4)}, ${r.longitude?.toFixed(4)}`:"N/A")})]},`${r.userName}-${r.date}-${r.time}-${s}`))})]})]}),_ce=({data:n,dateRange:e,colorScheme:t})=>{const s=[];for(let a=0;a<n.length;a+=15)s.push(n.slice(a,a+15));return s.length===0?null:i.jsx("div",{children:s.map((a,o)=>{const l=15-a.length,c=o===s.length-1;return i.jsxs("div",{style:{padding:o===0?"40px":"0px 40px 40px 40px",paddingTop:o===0?"40px":"0px",marginTop:o===0?"0px":"-40px",fontFamily:'"Courier New", Courier, monospace',fontSize:"14px",color:"#000",backgroundColor:"#fff",width:"1123px",height:"794px",boxSizing:"border-box",letterSpacing:"0.5px",pageBreakAfter:c?"auto":"always",position:"relative",display:"flex",flexDirection:"column"},children:[i.jsx("table",{style:{width:"100%",borderBottom:"2px solid #000",marginBottom:"16px",paddingBottom:"8px"},children:i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{style:{width:"50%",verticalAlign:"top",textAlign:"left"},children:i.jsx(Xi,{className:"h-14",localPath:kC(t)})}),i.jsxs("td",{style:{width:"50%",verticalAlign:"top",textAlign:"right"},children:[i.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"1px"},children:"Basic Attendance Report"}),i.jsxs("div",{style:{fontSize:"12px",color:"#333",marginBottom:"4px"},children:[We(e.startDate,"dd MMM yyyy")," -"," ",We(e.endDate,"dd MMM yyyy")]}),i.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["Generated: ",We(new Date,"dd MMM yyyy HH:mm")]})]})]})})}),i.jsx("div",{style:{flexGrow:1},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #000",tableLayout:"fixed"},children:[i.jsx("thead",{style:{display:"table-header-group"},children:i.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"28%",fontSize:"11px",fontWeight:"bold"},children:"Employee Name"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Date"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Status"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check In"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check Out"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"15%",fontSize:"11px",fontWeight:"bold"},children:"Hours"})]})}),i.jsxs("tbody",{children:[a.map((d,h)=>i.jsxs("tr",{style:{backgroundColor:h%2===0?"#fff":"#fafafa"},children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle",wordWrap:"break-word",whiteSpace:"normal",lineHeight:"1.4"},children:d.userName}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:We(new Date(String(d.date).replace(/-/g,"/")),"dd MMM yyyy")}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:d.status}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:d.checkIn||"-"}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:d.checkOut||"-"}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:d.duration||"-"})]},`${d.userName}-${d.date}-${h}`)),Array.from({length:l}).map((d,h)=>i.jsxs("tr",{style:{backgroundColor:"#fff"},children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",height:"33px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""})]},`empty-${h}`))]})]})}),i.jsxs("div",{style:{marginTop:"10px",borderTop:"1px solid #ccc",paddingTop:"8px",textAlign:"center",fontSize:"10px",color:"#888"},children:[JK(t)," - Confidential Report - Page ",o+1," of ",s.length]})]},o)})})},jce=({data:n,dateRange:e,colorScheme:t})=>{const r=vo({start:e.startDate,end:e.endDate});return i.jsxs("div",{className:"p-8 font-sans text-[9px] text-black bg-white",children:[i.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-4",children:[i.jsx(Xi,{className:"h-8",localPath:kC(t)}),i.jsxs("div",{className:"text-right",children:[i.jsx("h1",{className:"text-lg font-bold",children:"Monthly Attendance Report"}),i.jsxs("p",{className:"text-gray-600",children:[We(e.startDate,"dd MMM yyyy")," to ",We(e.endDate,"dd MMM yyyy")]})]})]}),i.jsxs("table",{className:"w-full border-collapse border border-gray-400 text-center",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-200 font-bold",children:[i.jsx("td",{className:"border p-1 border-gray-400 text-left",children:"Employee Name"}),r.map((s,a)=>i.jsx("td",{className:"border p-1 border-gray-400",children:We(s,"d")},a)),i.jsx("td",{className:"border p-1 border-gray-400",children:"P"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"1/2P"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"A"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"WO"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"H"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"WOP"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"HP"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"Total"})]})}),i.jsx("tbody",{children:n.map((s,a)=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1 border-gray-400 text-left",children:s.userName}),s.statuses.map((o,l)=>i.jsx("td",{className:"border p-1 border-gray-400",children:o},l)),i.jsx("td",{className:"border p-1 border-gray-400",children:s.presentDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.halfDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.absentDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.weekOffs}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.holidays}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.weekendPresents}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.holidayPresents}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.totalPayableDays})]},a))})]})]})},Sce=()=>{const n=At("(max-width: 639px)"),{user:e}=jt(),{permissions:t}=na(),{recurringHolidays:r}=bi(),{colorScheme:s}=on(),a=qa(s),[o,l]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState(null),[x,v]=E.useState(!0),[b,_]=E.useState({startDate:ox(),endDate:fb(),key:"selection"}),j=E.useMemo(()=>[b],[b]),[C,P]=E.useState("Today"),[O,M]=E.useState(!1),D=E.useRef(null),[I,F]=E.useState("all"),[q,U]=E.useState("all"),[B,W]=E.useState("all"),[Y,G]=E.useState("basic"),[Z,oe]=E.useState(!1),[X,he]=E.useState(null),[$,K]=E.useState({}),te=E.useRef(null),H=e&&t[e.role]?.includes("download_attendance_report"),le=!(e&&t[e.role]?.includes("view_all_attendance")),[ue,ie]=E.useState({present:0,absent:0,ot:0,compOff:0}),[pe,re]=E.useState([]);E.useEffect(()=>{const be=Ue=>{D.current&&!D.current.contains(Ue.target)&&M(!1)};return document.addEventListener("mousedown",be),()=>document.removeEventListener("mousedown",be)},[]),E.useEffect(()=>{H&&ce.getUsers().then(l)},[H]),E.useEffect(()=>{(async()=>{if(!(!le||!e||!b.startDate||!b.endDate)){v(!0);try{const Ue=yf(b.startDate,7),Ve=Ue.toISOString(),ee=b.endDate.toISOString(),[se,xe]=await Promise.all([ce.getAttendanceEvents(e.id,Ve,ee),ce.getCompOffLogs(e.id)]);let Ie=vo({start:Ue,end:b.endDate}).map(lt=>{const Wt=We(lt,"yyyy-MM-dd"),Yt=se.filter(vn=>We(new Date(vn.timestamp),"yyyy-MM-dd")===Wt);let Qt="Absent",Gt="-",ln="-",rn=0;const Et=We(lt,"EEEE"),qn=Et==="Sunday";if(r.some(vn=>{if(vn.day.toLowerCase()!==Et.toLowerCase())return!1;const it=Math.ceil(lt.getDate()/7),dn=e.role==="field_officer"?"field":"office";return vn.n===it&&(vn.type||"office")===dn})?Qt="Holiday":qn&&(Qt="Weekend"),Yt.length>0){Qt="Present",Yt.sort((dn,ir)=>new Date(dn.timestamp).getTime()-new Date(ir.timestamp).getTime());const vn=Yt.find(dn=>dn.type==="check-in"),it=[...Yt].reverse().find(dn=>dn.type==="check-out");if(vn&&(Gt=We(new Date(vn.timestamp),"hh:mm a")),it&&(ln=We(new Date(it.timestamp),"hh:mm a"),vn)){const ir=xf(new Date(it.timestamp),new Date(vn.timestamp))/60;ir>8&&(rn=Math.round((ir-8)*10)/10)}}return{rawDate:lt,date:We(lt,"dd MMM, yyyy"),day:Et,checkIn:Gt,checkOut:ln,status:Qt,ot:rn}});Ie.forEach((lt,Wt)=>{if(lt.status==="Weekend"&&lt.day==="Sunday"){let Yt=0;const Qt=Math.max(0,Wt-6);for(let Gt=Wt-1;Gt>=Qt;Gt--)Ie[Gt].status==="Absent"&&Yt++;Yt>=4&&(lt.status="Absent")}});const Re=Ie.filter(lt=>lt.rawDate>=b.startDate),nt=Re.filter(lt=>lt.status==="Present").length,Xe=Re.filter(lt=>lt.status==="Absent"&&lt.rawDate<=new Date).length,ht=Re.reduce((lt,Wt)=>lt+Wt.ot,0),Bt=xe.filter(lt=>{const Wt=new Date(lt.dateEarned);return Wt>=b.startDate&&Wt<=b.endDate&&lt.status==="earned"}).length;ie({present:nt,absent:Xe,ot:Math.round(ht*10)/10,compOff:Bt}),re(Re.reverse())}catch(Ue){console.error("Failed to fetch employee attendance",Ue)}finally{v(!1)}}})()},[le,e,b,r]);const de=E.useCallback(async(be,Ue)=>{v(!0);try{let Ve=o;Ve.length===0&&(Ve=await ce.getUsers(),l(Ve));const ee=new Date,se=be<ee?be:ox(),xe=Ue>ee?Ue:fb(),[ke,Ie]=await Promise.all([ce.getAllAttendanceEvents(se.toISOString(),xe.toISOString()),ce.getLeaveRequests({startDate:se.toISOString(),endDate:xe.toISOString(),status:"approved"})]);d(ke);const Re=We(ee,"yyyy-MM-dd"),nt=ke.filter(Et=>We(new Date(Et.timestamp),"yyyy-MM-dd")===Re),Xe=new Set(nt.map(Et=>Et.userId)).size,ht=Ie.filter(Et=>{const qn=new Date(Et.startDate),sr=new Date(Et.endDate);return ee>=qn&&ee<=sr}),Bt=new Set(ht.map(Et=>Et.userId)).size,lt=Ve.length,Wt=Math.max(0,lt-Xe-Bt),Yt=vo({start:be,end:Ue}),Qt=Yt.map(Et=>We(Et,"dd MMM")),Gt=[],ln=[],rn=[];Yt.forEach(Et=>{const qn=We(Et,"yyyy-MM-dd"),sr=ke.filter(In=>We(new Date(In.timestamp),"yyyy-MM-dd")===qn),vn=new Set(sr.map(In=>In.userId)).size,it=Ie.filter(In=>{const Ms=new Date(In.startDate),Es=new Date(In.endDate);return Et>=Ms&&Et<=Es}),dn=new Set(it.map(In=>In.userId)).size,ir=Math.max(0,lt-vn-dn);Gt.push(vn),ln.push(ir);let ks=0;const Ps={};sr.forEach(In=>{Ps[In.userId]||(Ps[In.userId]=[]),Ps[In.userId].push(In)}),Object.values(Ps).forEach(In=>{In.sort((Er,ei)=>new Date(Er.timestamp).getTime()-new Date(ei.timestamp).getTime());const Ms=In.find(Er=>Er.type==="check-in"),Es=[...In].reverse().find(Er=>Er.type==="check-out");if(Ms&&Es){const Er=xf(new Date(Es.timestamp),new Date(Ms.timestamp));ks+=Er/60}}),rn.push(vn>0?parseFloat((ks/vn).toFixed(1)):0)}),p({totalEmployees:lt,presentToday:Xe,absentToday:Wt,onLeaveToday:Bt,attendanceTrend:{labels:Qt,present:Gt,absent:ln},productivityTrend:{labels:Qt,hours:rn}})}catch(Ve){console.error("Failed to load dashboard data",Ve)}finally{v(!1)}},[o]);E.useEffect(()=>{b.startDate&&b.endDate&&de(b.startDate,b.endDate)},[b,de]),E.useEffect(()=>{if(Y!=="log"||!b.startDate||!b.endDate)return;const be=Ve=>parseFloat(Ve.toFixed(6));(async()=>{const Ve=I==="all"?o:o.filter(ke=>ke.id===I),ee=new Set(Ve.map(ke=>ke.id)),se=c.filter(ke=>{if(!ee.has(ke.userId)||new Date(ke.timestamp)<b.startDate||new Date(ke.timestamp)>b.endDate||ke.locationName||!ke.latitude||!ke.longitude)return!1;const Ie=`${be(ke.latitude)},${be(ke.longitude)}`;return!$[Ie]});if(console.log("Geocoding: Events to process:",se.length),se.length===0)return;const xe=se.map(ke=>({lat:ke.latitude,lon:ke.longitude}));console.log("Geocoding: Fetching addresses for",xe.length,"unique coordinates");try{const ke=await ce.batchResolveAddresses(xe);console.log("Geocoding: Resolved addresses:",Object.keys(ke).length),K(Ie=>({...Ie,...ke}))}catch(ke){console.error("Batch geocoding failed:",ke)}})()},[c,b,I,Y,o]);const je=be=>{P(be);const Ue=new Date;let Ve=ox(),ee=fb();be==="This Month"?(Ve=vi(Ue),ee=Ma(Ue)):be==="This Year"?(Ve=vF(Ue),ee=tW(Ue)):be==="Last 7 Days"?Ve=yf(Ue,6):be==="Last 30 Days"&&(Ve=yf(Ue,29)),ee>Ue&&(ee=Ue),_({startDate:Ve,endDate:ee,key:"selection"})},Ae=be=>{_(be.selection),P("Custom"),M(!1)},Te=E.useMemo(()=>{const be=b.endDate,Ue=new Date;return We(be,"yyyy-MM-dd")===We(Ue,"yyyy-MM-dd")?"Today":`on ${We(be,"MMM d")}`},[b]),Se=E.useMemo(()=>{if(!b.startDate||!b.endDate)return[];const be=[],Ue=vo({start:b.startDate,end:b.endDate});(I==="all"?o:o.filter(se=>se.id===I)).forEach(se=>{Ue.forEach(xe=>{const ke=We(xe,"yyyy-MM-dd"),Ie=c.filter(Yt=>Yt.userId===se.id&&We(new Date(Yt.timestamp),"yyyy-MM-dd")===ke);let Re="Absent",nt="",Xe="",ht="";const Bt=We(xe,"EEEE"),lt=Bt==="Sunday";if(r.some(Yt=>{if(Yt.day.toLowerCase()!==Bt.toLowerCase())return!1;const Qt=xe.getDate(),Gt=Math.ceil(Qt/7),ln=se.role==="field_staff"?"field":"office",rn=Yt.type||"office";return Yt.n===Gt&&rn===ln})?Re="Holiday":lt&&(Re="Weekend"),Ie.length>0){const Yt=[...Ie].sort((ln,rn)=>new Date(ln.timestamp).getTime()-new Date(rn.timestamp).getTime()),Qt=Yt.find(ln=>ln.type==="check-in"),Gt=[...Yt].reverse().find(ln=>ln.type==="check-out");if(Qt&&(Re="Present",nt=We(new Date(Qt.timestamp),"HH:mm")),Gt&&(Xe=We(new Date(Gt.timestamp),"HH:mm")),Qt&&Gt){const ln=new Date(Qt.timestamp),rn=new Date(Gt.timestamp),Et=xf(rn,ln),qn=Math.floor(Et/60),sr=Et%60;ht=`${qn}h ${sr}m`}}be.push({userName:se.name,date:ke,status:Re,checkIn:nt,checkOut:Xe,duration:ht})})});let ee=q==="all"?be:be.filter(se=>se.status===q);return B!=="all"&&(ee=ee.filter(se=>{const xe=se.checkIn&&se.checkIn!=="-"&&se.checkIn!=="",ke=se.checkOut&&se.checkOut!=="-"&&se.checkOut!=="";switch(B){case"complete":return xe&&ke;case"missing_checkout":return xe&&!ke;case"missing_checkin":return!xe&&ke;case"incomplete":return!xe||!ke;default:return!0}})),ee},[o,c,b,I,q,B,r]),Pe=E.useMemo(()=>{if(!b.startDate||!b.endDate)return[];const be=ee=>parseFloat(ee.toFixed(6)),Ue=I==="all"?o:o.filter(ee=>ee.id===I),Ve=new Set(Ue.map(ee=>ee.id));return c.filter(ee=>Ve.has(ee.userId)).map(ee=>{const se=o.find(Ie=>Ie.id===ee.userId),xe=ee.latitude&&ee.longitude?`${be(ee.latitude)},${be(ee.longitude)}`:"",ke=$[xe];return{userName:se?.name||"Unknown",date:We(new Date(ee.timestamp),"yyyy-MM-dd"),time:We(new Date(ee.timestamp),"HH:mm:ss"),type:ee.type,locationName:ee.locationName||ke||(ee.latitude?`${ee.latitude.toFixed(4)}, ${ee.longitude.toFixed(4)}`:"N/A"),latitude:ee.latitude,longitude:ee.longitude}}).sort((ee,se)=>ee.date!==se.date?ee.date.localeCompare(se.date):ee.time.localeCompare(se.time))},[o,c,b,I,$]),qe=E.useMemo(()=>{if(!b.startDate||!b.endDate)return[];const be=vo({start:b.startDate,end:b.endDate});return(I==="all"?o:o.filter(Ve=>Ve.id===I)).map(Ve=>{const ee=[];let se=0,xe=0,ke=0,Ie=0,Re=0,nt=0,Xe=0;be.forEach(Bt=>{const lt=We(Bt,"yyyy-MM-dd"),Yt=c.filter(Et=>Et.userId===Ve.id&&We(new Date(Et.timestamp),"yyyy-MM-dd")===lt).some(Et=>Et.type==="check-in"),Qt=We(Bt,"EEEE"),Gt=Qt==="Sunday",ln=r.some(Et=>{if(Et.day.toLowerCase()!==Qt.toLowerCase())return!1;const qn=Bt.getDate(),sr=Math.ceil(qn/7),vn=Ve.role==="field_staff"?"field":"office",it=Et.type||"office";return Et.n===sr&&it===vn});let rn="";Yt?ln?(rn="HP",Xe++):Gt?(rn="WOP",nt++):(rn="P",se++):ln?(rn="H",Re++):Gt?(rn="WO",Ie++):(rn="A",xe++),ee.push(rn)});const ht=se+Ie+Re+nt+Xe+ke*.5;return{userName:Ve.name,statuses:ee,presentDays:se,absentDays:xe,halfDays:ke,weekOffs:Ie,holidays:Re,weekendPresents:nt,holidayPresents:Xe,totalPayableDays:ht}})},[o,c,b,I,r]),He=E.useMemo(()=>Y==="basic"?i.jsx(_ce,{data:Se,dateRange:b,colorScheme:s}):Y==="log"?i.jsx(wce,{data:Pe,dateRange:b,colorScheme:s}):Y==="monthly"?i.jsx(jce,{data:qe,dateRange:b,colorScheme:s}):null,[Y,Se,Pe,qe,b,s]),ze=()=>{oe(!0);try{let be="data:text/csv;charset=utf-8,",Ue=`Attendance_Report_${We(new Date,"yyyy-MM-dd")}.csv`;if(Y==="basic")be+=`Employee Name,Date,Status,Check In,Check Out,Hours
`,Se.forEach(se=>{be+=`"${se.userName}","${se.date}","${se.status}","${se.checkIn}","${se.checkOut}","${se.duration}"
`});else if(Y==="log")be+=`User,Date,Time,Event,Location,Latitude,Longitude
`,Pe.forEach(se=>{be+=`"${se.userName}","${se.date}","${se.time}","${se.type}","${se.locationName||""}","${se.latitude||""}","${se.longitude||""}"
`});else if(Y==="monthly"){const xe=vo({start:b.startDate,end:b.endDate}).map(ke=>We(ke,"dd MMM")).join(",");be+=`Employee Name,${xe},Present,Absent,Half Days,Week Offs,Holidays,Weekend Presents,Holiday Presents,Total Payable Days
`,qe.forEach(ke=>{const Ie=ke.statuses.join(",");be+=`"${ke.userName}",${Ie},"${ke.presentDays}","${ke.absentDays}","${ke.halfDays}","${ke.weekOffs}","${ke.holidays}","${ke.weekendPresents}","${ke.holidayPresents}","${ke.totalPayableDays}"
`})}const Ve=encodeURI(be),ee=document.createElement("a");ee.setAttribute("href",Ve),ee.setAttribute("download",Ue),document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),he({message:"CSV downloaded successfully.",type:"success"})}catch(be){console.error("CSV generation failed:",be),he({message:"Failed to generate CSV.",type:"error"})}finally{oe(!1)}};return x&&!h&&!le?i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):le?i.jsxs("div",{className:"p-4 space-y-6 pb-24 md:bg-transparent",style:{backgroundColor:n?a.mobileBg:void 0},children:[i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Attendance"}),i.jsxs("div",{className:"bg-card p-3 rounded-xl shadow-sm border border-border flex flex-wrap items-center gap-2",children:[["Today","This Month","Last 30 Days"].map(be=>i.jsx(ne,{type:"button",variant:C===be?"primary":"outline",onClick:()=>je(be),className:C===be?"!text-white shadow-md border":"bg-card text-primary-text border border-border hover:bg-accent-light",style:C===be?{backgroundColor:a.activeItemBg,borderColor:a.sidebarBorder}:{},children:be},be)),i.jsxs("div",{className:"relative",ref:D,children:[i.jsxs(ne,{type:"button",variant:C==="Custom"?"primary":"outline",onClick:()=>M(!O),className:C==="Custom"?"!text-white shadow-md border":"bg-card text-primary-text border border-border hover:bg-accent-light",style:C==="Custom"?{backgroundColor:a.activeItemBg,borderColor:a.sidebarBorder}:{},children:[i.jsx(Da,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:C==="Custom"?`${We(b.startDate,"dd MMM")} - ${We(b.endDate,"dd MMM")}`:"Custom"})]}),O&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-50 bg-white dark:bg-gray-950 border border-border rounded-lg shadow-xl w-[300px] sm:w-auto overflow-hidden",children:i.jsx("div",{className:"text-gray-900",children:i.jsx(jm.DateRangePicker,{onChange:Ae,months:1,ranges:j,direction:"horizontal",maxDate:new Date})})})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow bg-card",children:[i.jsx("div",{className:"p-4 rounded-full mb-3 shadow-lg text-white",style:{backgroundColor:a.activeItemBg},children:i.jsx(yu,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm font-medium mb-1 text-muted",children:"Present"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:ue.present})]}),i.jsxs("div",{className:"p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow bg-card",children:[i.jsx("div",{className:"p-4 rounded-full mb-3 shadow-lg text-white",style:{backgroundColor:a.activeItemBg},children:i.jsx(Ax,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm font-medium mb-1 text-muted",children:"Absent"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:ue.absent})]}),i.jsxs("div",{className:"p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow bg-card",children:[i.jsx("div",{className:"p-4 rounded-full mb-3 shadow-lg text-white",style:{backgroundColor:a.activeItemBg},children:i.jsx(Hc,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm font-medium mb-1 text-muted",children:"Overtime"}),i.jsxs("p",{className:"text-2xl font-bold text-primary-text",children:[ue.ot,"h"]})]}),i.jsxs("div",{className:"p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow bg-card",children:[i.jsx("div",{className:"p-4 rounded-full mb-3 shadow-lg text-white",style:{backgroundColor:a.activeItemBg},children:i.jsx(VM,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm font-medium mb-1 text-muted",children:"Comp Offs"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:ue.compOff})]})]}),i.jsxs("div",{className:"bg-card rounded-xl shadow-sm border border-border overflow-hidden",children:[i.jsx("div",{className:"p-4 border-b border-border font-semibold text-primary-text",children:"Attendance Logs"}),i.jsx("div",{className:"divide-y divide-border",children:x?i.jsx("div",{className:"p-8 text-center text-muted",children:i.jsx(_t,{className:"h-6 w-6 animate-spin mx-auto"})}):pe.length===0?i.jsx("div",{className:"p-8 text-center text-muted",children:"No records found for this period."}):pe.map((be,Ue)=>i.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-900/50 transition-colors",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-primary-text",children:be.date}),i.jsx("p",{className:"text-xs text-muted",children:be.day})]}),i.jsxs("div",{className:"flex flex-col items-end gap-1.5",children:[i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider shadow-sm
                                            ${be.status==="Present"?"bg-emerald-500 text-white dark:bg-emerald-600":be.status==="Absent"?"bg-rose-500 text-white dark:bg-rose-600":be.status==="Holiday"?"bg-amber-500 text-white dark:bg-amber-600":be.status==="Weekend"?"bg-indigo-500 text-white dark:bg-indigo-600":"bg-gray-500 text-white dark:bg-gray-600"}`,children:be.status}),(be.checkIn!=="-"||be.checkOut!=="-")&&i.jsxs("div",{className:"text-xs text-muted font-medium",children:[be.checkIn," - ",be.checkOut]}),be.ot>0&&i.jsxs("span",{className:"text-[10px] text-blue-600 dark:text-blue-400 font-bold",children:["+",be.ot,"h OT"]})]})]},Ue))})]})]}):i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Attendance Dashboard"})}),i.jsxs("div",{className:"hidden md:flex bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex-wrap items-end gap-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Today","Last 7 Days","This Month"].map(be=>i.jsx(ne,{type:"button",onClick:()=>je(be),className:C===be?"!text-white shadow-md border":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50",style:C===be?{backgroundColor:a.activeItemBg,borderColor:a.sidebarBorder}:{},children:be},be)),i.jsxs("div",{className:"relative",ref:D,children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>M(!O),className:"hover:bg-gray-100",children:[i.jsx(Da,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:C==="Custom"?`${We(b.startDate,"dd MMM, yyyy")} - ${We(b.endDate,"dd MMM, yyyy")}`:"Custom Range"})]}),O&&i.jsxs("div",{className:"absolute top-full left-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 p-3",children:[i.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:We(b.startDate,"yyyy-MM-dd"),max:We(new Date,"yyyy-MM-dd"),onChange:be=>{const Ue=new Date(be.target.value);let Ve=b.endDate;Ue>Ve&&(Ve=Ue),_({startDate:Ue,endDate:Ve,key:"selection"}),P("Custom")}}),i.jsx("span",{className:"text-sm",children:"to"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:We(b.endDate,"yyyy-MM-dd"),max:We(new Date,"yyyy-MM-dd"),onChange:be=>{const Ue=new Date(be.target.value);let Ve=b.startDate;Ue<Ve&&(Ve=Ue),_({startDate:Ve,endDate:Ue,key:"selection"}),P("Custom")}})]}),i.jsx(jm.DateRangePicker,{onChange:Ae,months:n?1:2,ranges:j,direction:"horizontal",maxDate:new Date})]})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Report Type"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 outline-none",style:{borderColor:"transparent"},value:Y,onChange:be=>G(be.target.value),children:[i.jsx("option",{value:"basic",children:"Basic Report"}),i.jsx("option",{value:"log",children:"Attendance Log"}),i.jsx("option",{value:"monthly",children:"Monthly Report"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Employee"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 outline-none max-w-[200px]",value:I,onChange:be=>F(be.target.value),children:[i.jsx("option",{value:"all",children:"All Employees"}),o.map(be=>i.jsx("option",{value:be.id,children:be.name},be.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Status"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 outline-none max-w-[200px]",value:q,onChange:be=>U(be.target.value),children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"Present",children:"Present"}),i.jsx("option",{value:"Half Day",children:"Half Day"}),i.jsx("option",{value:"Absent",children:"Absent"}),i.jsx("option",{value:"On Leave (Full)",children:"On Leave (Full)"}),i.jsx("option",{value:"On Leave (Half)",children:"On Leave (Half)"}),i.jsx("option",{value:"Holiday",children:"Holiday"}),i.jsx("option",{value:"Weekend",children:"Weekend"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Record Type"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 outline-none max-w-[200px]",value:B,onChange:be=>W(be.target.value),children:[i.jsx("option",{value:"all",children:"All Records"}),i.jsx("option",{value:"complete",children:"Complete (Check-in & Check-out)"}),i.jsx("option",{value:"missing_checkout",children:"Missing Check-out"}),i.jsx("option",{value:"missing_checkin",children:"Missing Check-in"}),i.jsx("option",{value:"incomplete",children:"Incomplete (Any Missing)"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(So,{title:"Total Employees",value:h?.totalEmployees||0,icon:Qi}),i.jsx(So,{title:`Present ${Te}`,value:h?.presentToday||0,icon:yu}),i.jsx(So,{title:`Absent ${Te}`,value:h?.absentToday||0,icon:Ax}),i.jsx(So,{title:`On Leave ${Te}`,value:h?.onLeaveToday||0,icon:Hc})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx(UL,{title:"Attendance Trend",icon:iJ,children:h?i.jsx(vce,{data:h.attendanceTrend}):i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})}),i.jsx(UL,{title:"Productivity Trend (Avg. Hours)",icon:VM,children:h?i.jsx(bce,{data:h.productivityTrend}):i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})})]}),i.jsx("div",{style:{position:"fixed",top:"0",left:"0",width:"1123px",zIndex:-1e3,opacity:0,pointerEvents:"none"},children:i.jsx("div",{ref:te,className:"w-full bg-white",children:He})}),i.jsxs("div",{className:"hidden md:block bg-white p-6 rounded-xl shadow-sm border border-gray-100 overflow-auto max-h-[600px]",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold",children:"Report Preview"}),H&&i.jsxs(ne,{type:"button",onClick:ze,disabled:Z,style:{backgroundColor:a.activeItemBg,color:"#FFFFFF",borderColor:a.sidebarBorder},className:"border hover:opacity-90 !text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[Z?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(a3,{className:"mr-2 h-4 w-4"}),Z?"Generating...":"Download CSV"]})]}),i.jsx("div",{className:"border p-4 rounded bg-gray-50",children:He})]}),X&&i.jsx(pt,{message:X.message,type:X.type,onDismiss:()=>he(null)})]})},Nce=n=>n.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),Cce=(n,e,t,r)=>{const a=n*Math.PI/180,o=t*Math.PI/180,l=(t-n)*Math.PI/180,c=(r-e)*Math.PI/180,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},Tce=()=>{const{user:n}=jt(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState(!0),[l,c]=E.useState(!1),[d,h]=E.useState(null),[p,x]=E.useState(""),[v,b]=E.useState(""),[_,j]=E.useState(""),[C,P]=E.useState(""),[O,M]=E.useState(null),[D,I]=E.useState([]),[F,q]=E.useState(!1),[U,B]=E.useState(""),W=n&&["admin","hr"].includes(n.role);E.useEffect(()=>{(async()=>{if(n)try{const[ae,le]=await Promise.all([ce.getUserLocations(n.id),ce.getLocations()]);t(ae),s(le)}catch(ae){console.error(ae),h({message:"Failed to load locations.",type:"error"})}finally{o(!1)}})()},[n]);const Y=H=>{const ae=H.target.value,le=Nce(ae);x(le)},G=async()=>{c(!0);try{const H=await ly().catch(()=>null);let ae,le;if(H&&H.coords&&(ae=H.coords.latitude,le=H.coords.longitude),ae===void 0||le===void 0){const ue=await new Promise(ie=>{navigator.geolocation.getCurrentPosition(pe=>ie(pe),()=>ie(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})});ue&&ue.coords&&(ae=ue.coords.latitude,le=ue.coords.longitude)}if(ae===void 0||le===void 0)throw new Error("Unable to retrieve current location.");b(ae.toString()),j(le.toString());try{const ue=await gm(ae,le);P(ue)}catch(ue){console.warn("Reverse geocode failed:",ue)}h({message:"Coordinates and address filled. Please enter a location name.",type:"success"})}catch(H){console.error(H),h({message:H.message||"Failed to get current location.",type:"error"})}finally{c(!1)}},Z=async()=>{if(!n||D.length===0){h({message:"Please select at least one location.",type:"error"});return}q(!0);try{await Promise.all(D.map(ae=>ce.assignLocationToUser(n.id,ae))),h({message:"Locations assigned successfully!",type:"success"}),I([]);const H=await ce.getUserLocations(n.id);t(H)}catch(H){console.error(H),h({message:H.message||"Failed to assign locations.",type:"error"})}finally{q(!1)}},oe=H=>{I(ae=>ae.includes(H)?ae.filter(le=>le!==H):[...ae,H])},X=async()=>{if(!n)return;if(!O&&!W){h({message:"You do not have permission to add locations.",type:"error"});return}if(!p.trim()){h({message:"Please enter a location name.",type:"error"});return}const H=parseFloat(v),ae=parseFloat(_);if(isNaN(H)||isNaN(ae)){h({message:"Please provide valid coordinates.",type:"error"});return}if(r.find(ue=>ue.id!==O&&ue.name?.toLowerCase()===p.toLowerCase())){h({message:`Location "${p}" already exists. Please use a different name.`,type:"error"});return}if(!O&&r.find(ie=>Cce(H,ae,ie.latitude,ie.longitude)<10)){h({message:"A location already exists at these coordinates.",type:"error"});return}c(!0);try{if(O)await ce.updateLocation(O,{name:p,latitude:H,longitude:ae,radius:100,address:C||null}),h({message:"Location updated successfully.",type:"success"});else{const re=await ce.createLocation({name:p,latitude:H,longitude:ae,radius:100,address:C||null,createdBy:n.id});await ce.assignLocationToUser(n.id,re.id),h({message:"Location added successfully.",type:"success"})}const[ie,pe]=await Promise.all([ce.getUserLocations(n.id),ce.getLocations()]);t(ie),s(pe),K()}catch(ue){console.error(ue),h({message:ue.message||"Failed to save location.",type:"error"})}finally{c(!1)}},he=H=>{M(H.id),x(H.name||""),b(H.latitude.toString()),j(H.longitude.toString()),P(H.address||""),window.scrollTo({top:0,behavior:"smooth"})},$=async H=>{if(!n||!W){h({message:"You do not have permission to delete locations.",type:"error"});return}if(window.confirm("Are you sure you want to delete this location? It will be removed from all users."))try{await ce.deleteLocation(H),h({message:"Location deleted successfully.",type:"success"});const[ae,le]=await Promise.all([ce.getUserLocations(n.id),ce.getLocations()]);t(ae),s(le)}catch(ae){console.error(ae),h({message:ae.message||"Failed to delete location.",type:"error"})}},K=()=>{x(""),b(""),j(""),P(""),M(null)},te=e.filter((H,ae,le)=>H.address?ae===le.findIndex(ue=>ue.address===H.address):!0);return i.jsxs("div",{className:"p-4 md:p-6 w-full",children:[d&&i.jsx(pt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center",children:[i.jsx(Pl,{className:"h-6 w-6 mr-2"})," My Locations"]}),i.jsxs("p",{className:"text-muted mb-6",children:["These are the geofenced locations assigned to you. You may check in/out only when within one of these locations. ",W?"Use the form below to add a new location.":"You can edit location names by clicking the edit button."]}),(W||O)&&i.jsxs("div",{className:"bg-gray-50 border border-border rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:O?"Edit Location":"Add New Location"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(we,{label:"Location Name (required) *",id:"locationName",value:p,onChange:Y,placeholder:"e.g. Office HQ",required:!0}),i.jsx(we,{label:"Latitude",id:"latitude",type:"number",value:v,onChange:H=>b(H.target.value),placeholder:"12.9716",step:"any",disabled:O&&!W}),i.jsx(we,{label:"Longitude",id:"longitude",type:"number",value:_,onChange:H=>j(H.target.value),placeholder:"77.5946",step:"any",disabled:O&&!W}),i.jsx(we,{label:"Address (optional)",id:"address",value:C,onChange:H=>P(H.target.value),placeholder:"Street, City, State",disabled:O&&!W})]}),i.jsxs("div",{className:"flex gap-4 flex-wrap",children:[W&&i.jsxs(ne,{onClick:G,variant:"secondary",isLoading:l,disabled:l,children:[i.jsx(h3,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),i.jsx(ne,{onClick:X,isLoading:l,disabled:l||!p.trim(),children:O?"Save Changes":"Add Location"}),O&&i.jsx(ne,{onClick:K,variant:"secondary",children:"Cancel"})]})]})]}),i.jsx("div",{className:"mt-6",children:a?i.jsx("p",{children:"Loading locations..."}):e.length===0?i.jsx("div",{children:W?i.jsx("p",{className:"text-muted text-center md:text-left",children:"No locations assigned. Use the form above to add one."}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Select Your Locations"}),i.jsx("p",{className:"text-sm text-blue-800 mb-4",children:"You don't have any locations assigned yet. Please select the locations where you'll be working from the list below."})]}),r.length===0?i.jsx("p",{className:"text-muted text-center",children:"No locations available. Contact your administrator."}):i.jsxs("div",{children:[i.jsx("div",{className:"mb-4",children:i.jsx(we,{type:"text",placeholder:"Search by name or address...",value:U,onChange:H=>B(H.target.value)})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:r.filter(H=>U===""||H.name?.toLowerCase().includes(U.toLowerCase())||H.address?.toLowerCase().includes(U.toLowerCase())).map(H=>i.jsx("div",{onClick:()=>oe(H.id),className:`border rounded-lg p-4 cursor-pointer transition-all ${D.includes(H.id)?"border-accent bg-accent/10 shadow-md":"border-border hover:border-accent/50 hover:bg-gray-50"}`,children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("input",{type:"checkbox",checked:D.includes(H.id),onChange:()=>{},className:"mt-1 mr-3 h-5 w-5 text-accent rounded focus:ring-accent"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:H.name||"Unnamed Location"}),i.jsx("button",{type:"button",onClick:ae=>{ae.stopPropagation(),he(H)},className:"text-blue-600 hover:text-blue-800 p-1",title:"Edit Name",children:i.jsx(ur,{className:"h-4 w-4"})})]}),i.jsx("p",{className:"text-sm text-muted mt-1",children:H.address||"No address"}),i.jsxs("p",{className:"text-xs text-muted mt-2",children:["Coordinates: ",H.latitude.toFixed(4),", ",H.longitude.toFixed(4),"  Radius: ",H.radius,"m"]})]})]})},H.id))}),i.jsx("div",{className:"flex justify-center",children:i.jsx(ne,{onClick:Z,isLoading:F,disabled:F||D.length===0,children:D.length===0?"Select Locations Above":`Assign ${D.length} Location${D.length>1?"s":""}`})})]})]})}):i.jsxs("div",{className:"space-y-4 md:space-y-0 md:grid md:grid-cols-1 md:gap-4",children:[i.jsx("div",{className:"md:hidden space-y-4",children:te.map(H=>i.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-primary-text",children:H.name||H.address||"Unnamed Location"}),i.jsx("p",{className:"text-sm text-muted",children:H.address})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-500 hover:text-blue-700 p-1",title:W?"Edit Location":"Edit Name",onClick:()=>he(H),children:i.jsx(ur,{className:"h-5 w-5"})}),W&&i.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 p-1",title:"Delete Location",onClick:()=>$(H.id),children:i.jsx(sn,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Radius"}),i.jsxs("p",{children:[H.radius,"m"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Coordinates"}),i.jsxs("p",{children:[H.latitude?.toFixed(4),", ",H.longitude?.toFixed(4)]})]})]})]},H.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[i.jsx("thead",{className:"bg-page text-primary-text",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),i.jsx("tbody",{children:te.map(H=>i.jsxs("tr",{className:"border-b border-border",children:[i.jsx("td",{className:"p-3",children:H.name||"-"}),i.jsx("td",{className:"p-3",children:H.radius}),i.jsxs("td",{className:"p-3",children:[H.latitude?.toFixed(4),", ",H.longitude?.toFixed(4)]}),i.jsx("td",{className:"p-3",children:H.address||"-"}),i.jsxs("td",{className:"p-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-800",title:W?"Edit Location":"Edit Name",onClick:()=>he(H),children:i.jsx(ur,{className:"h-4 w-4"})}),W&&i.jsx("button",{type:"button",className:"text-red-600 hover:text-red-800",title:"Delete Location",onClick:()=>$(H.id),children:i.jsx(sn,{className:"h-4 w-4"})})]})]},H.id))})]})})]})})]})},BL=()=>{const n=Nt(),e=Zr(),{toggleCheckInStatus:t,isCheckedIn:r}=jt(),[s,a]=E.useState(!1),[o,l]=E.useState(null),c=e.pathname.includes("check-in"),d=c?"Check In":"Check Out",h=c?Ix:jo,p=c?"bg-emerald-100":"bg-red-100",x=c?"text-emerald-600":"text-red-600",v=async()=>{a(!0);const{success:_,message:j}=await t();l({message:j,type:_?"success":"error"}),a(!1),_&&setTimeout(()=>{n("/profile",{replace:!0})},1500)},b=()=>{n(-1)};return i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 relative",children:[o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)}),i.jsxs("div",{className:"w-full max-w-md bg-card rounded-2xl shadow-card p-8 text-center relative z-10",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:`p-4 rounded-full ${p}`,children:i.jsx(h,{className:`h-10 w-10 ${x}`})})}),i.jsx("h1",{className:"text-2xl font-bold text-primary-text mb-2",children:d}),i.jsxs("p",{className:"text-muted mb-8",children:["Are you sure you want to ",d.toLowerCase(),"?"]}),i.jsxs("div",{className:"flex flex-col gap-3",children:[i.jsxs(ne,{onClick:v,variant:c?"primary":"danger",className:"w-full !py-3 !text-lg shadow-lg",isLoading:s,children:["Yes, ",d]}),i.jsx(ne,{onClick:b,variant:"secondary",className:"w-full !py-3",disabled:s,children:"Cancel"})]})]})]})},kce=()=>{const{attendance:n,officeHolidays:e,fieldHolidays:t,recurringHolidays:r,addHoliday:s,removeHoliday:a,addRecurringHoliday:o,removeRecurringHoliday:l,updateAttendanceSettings:c}=bi(),d={minimumHoursFullDay:8,minimumHoursHalfDay:4,annualEarnedLeaves:5,annualSickLeaves:12,monthlyFloatingLeaves:1,annualCompOffLeaves:5,enableAttendanceNotifications:!1,sickLeaveCertificateThreshold:2},h={office:{...d,...n?.office},field:{...d,...n?.field}},[p,x]=E.useState(h),[v,b]=E.useState(!1),[_,j]=E.useState(!1),[C,P]=E.useState("office"),[O,M]=E.useState(""),[D,I]=E.useState(""),[F,q]=E.useState(3),[U,B]=E.useState("Saturday"),[W,Y]=E.useState(null);E.useEffect(()=>{x({office:{...d,...n?.office},field:{...d,...n?.field}})},[n]),E.useEffect(()=>{b(JSON.stringify(p)!==JSON.stringify(n))},[p,n]);const G=p[C],Z=C==="office"?e:t,oe=async $=>{if($.preventDefault(),O&&D){if(Z.some(K=>K.date===D)){Y({message:"A holiday for this date already exists.",type:"error"});return}try{await s(C,{name:O,date:D}),M(""),I(""),Y({message:"Holiday added successfully.",type:"success"})}catch{Y({message:"Failed to add holiday.",type:"error"})}}else Y({message:"Please provide both a name and a date.",type:"error"})},X=($,K)=>{x(te=>({...te,[C]:{...te[C],[$]:K}}))},he=async()=>{j(!0);try{await ce.saveAttendanceSettings(p),c(p),Y({message:"Attendance rules saved successfully!",type:"success"})}catch{Y({message:"Failed to save attendance rules.",type:"error"})}finally{j(!1)}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full pb-40",children:[W&&i.jsx(pt,{message:W.message,type:W.type,onDismiss:()=>Y(null)}),i.jsx(ra,{title:"Attendance & Leave Rules",children:i.jsxs(ne,{onClick:he,isLoading:_,disabled:!v,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),i.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Set company-wide rules for attendance and leave calculation."}),i.jsx("div",{className:"mb-6 border-b border-border",children:i.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[i.jsx("button",{onClick:()=>P("office"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${C==="office"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Office Staff"}),i.jsx("button",{onClick:()=>P("field"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${C==="field"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Field Staff"})]})}),C==="office"&&i.jsx("p",{className:"text-sm text-white -mt-4 mb-4",children:"These rules apply to Admin, HR, and Finance roles."}),C==="field"&&i.jsx("p",{className:"text-sm text-white -mt-4 mb-4",children:"These rules apply to all other roles (e.g., Field Officers, Managers)."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Hc,{className:"mr-2 h-5 w-5 text-muted"}),"Work Hours"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx(we,{label:"Minimum Hours for Full Day",id:"minHoursFull",type:"number",value:G.minimumHoursFullDay,onChange:$=>X("minimumHoursFullDay",parseFloat($.target.value)||0)}),i.jsx(we,{label:"Minimum Hours for Half Day",id:"minHoursHalf",type:"number",value:G.minimumHoursHalfDay,onChange:$=>X("minimumHoursHalfDay",parseFloat($.target.value)||0)})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Ox,{className:"mr-2 h-5 w-5 text-muted"}),"Leave Allocation"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx(we,{label:"Annual Earned Leaves",id:"annualEarnedLeaves",type:"number",value:G.annualEarnedLeaves,onChange:$=>X("annualEarnedLeaves",parseInt($.target.value,10)||0)}),i.jsx(we,{label:"Annual Sick Leaves",id:"annualSickLeaves",type:"number",value:G.annualSickLeaves,onChange:$=>X("annualSickLeaves",parseInt($.target.value,10)||0)}),i.jsx(we,{label:"Monthly Floating Holidays",id:"monthlyFloatingLeaves",type:"number",value:G.monthlyFloatingLeaves,onChange:$=>X("monthlyFloatingLeaves",parseInt($.target.value,10)||0)}),i.jsx(we,{label:"Annual Compensatory Off",id:"annualCompOffLeaves",type:"number",value:G.annualCompOffLeaves,onChange:$=>X("annualCompOffLeaves",parseInt($.target.value,10)||0)}),i.jsx(we,{label:"Sick Leave Cert. After (Days)",id:"sickLeaveCertThreshold",type:"number",value:G.sickLeaveCertificateThreshold,onChange:$=>X("sickLeaveCertificateThreshold",parseInt($.target.value,10)||0),title:"Require a doctor's certificate if total sick leave taken exceeds this number of days."})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Af,{className:"mr-2 h-5 w-5 text-muted"}),"Notifications"]}),i.jsx(kn,{id:"attendance-notifications",label:"Enable Check-in/Check-out Notifications",description:"Send a notification to Site Managers, Ops Managers, and HR when a Field Officer checks in or out.",checked:G.enableAttendanceNotifications,onChange:$=>X("enableAttendanceNotifications",$.target.checked)})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Da,{className:"mr-2 h-5 w-5 text-muted"}),"Recurring Holidays"]}),i.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Add Recurring Holiday"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[i.jsxs(Ze,{label:"Occurrence",value:F,onChange:$=>q(parseInt($.target.value)),children:[i.jsx("option",{value:1,children:"1st"}),i.jsx("option",{value:2,children:"2nd"}),i.jsx("option",{value:3,children:"3rd"}),i.jsx("option",{value:4,children:"4th"}),i.jsx("option",{value:5,children:"5th"})]}),i.jsxs(Ze,{label:"Day",value:U,onChange:$=>B($.target.value),children:[i.jsx("option",{value:"Monday",children:"Monday"}),i.jsx("option",{value:"Tuesday",children:"Tuesday"}),i.jsx("option",{value:"Wednesday",children:"Wednesday"}),i.jsx("option",{value:"Thursday",children:"Thursday"}),i.jsx("option",{value:"Friday",children:"Friday"}),i.jsx("option",{value:"Saturday",children:"Saturday"}),i.jsx("option",{value:"Sunday",children:"Sunday"})]}),i.jsxs(ne,{type:"button",onClick:async()=>{try{await o({day:U,n:F,type:C}),Y({message:"Recurring holiday added successfully.",type:"success"})}catch{Y({message:"Failed to add recurring holiday.",type:"error"})}},size:"sm",className:"w-full sm:w-auto",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Rule"]})]})]}),i.jsxs("div",{className:"mt-4 space-y-2",children:[r.filter($=>($.type||"office")===C).map(($,K)=>i.jsxs("div",{className:"flex justify-between items-start p-4 pr-6 border border-white/10 rounded-lg bg-white/5 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("p",{className:"font-medium text-primary-text truncate",children:[$.n===1?"1st":$.n===2?"2nd":$.n===3?"3rd":$.n+"th"," ",$.day]}),i.jsx("p",{className:"text-sm text-muted",children:"Repeats every month"})]}),i.jsx("div",{className:"ml-4 shrink-0",children:i.jsx(ne,{variant:"icon",onClick:async()=>{if($.id)try{await l($.id),Y({message:"Recurring holiday removed successfully.",type:"success"})}catch{Y({message:"Failed to remove recurring holiday.",type:"error"})}},className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(sn,{className:"h-5 w-5 text-red-500"})})})]},$.id||K)),r.filter($=>($.type||"office")===C).length===0&&i.jsx("p",{className:"text-center text-muted py-4",children:"No recurring holidays configured."})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Da,{className:"mr-2 h-5 w-5 text-muted"}),"Holiday List"]}),i.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Add New Holiday"}),i.jsxs("form",{onSubmit:oe,className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[i.jsx(we,{label:"Holiday Name",id:"holidayName",value:O,onChange:$=>M($.target.value)}),i.jsx(En,{label:"Date",id:"holidayDate",value:D,onChange:I}),i.jsxs(ne,{type:"submit",size:"sm",className:"w-full sm:w-auto",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add"]})]})]}),i.jsx("div",{className:"mt-4 space-y-2",children:Z.length>0?Z.map($=>i.jsxs("div",{className:"flex justify-between items-start p-4 pr-6 border border-white/10 rounded-lg bg-white/5 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium text-primary-text truncate",children:$.name}),i.jsx("p",{className:"text-sm text-muted",children:new Date($.date.replace(/-/g,"/")).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})})]}),i.jsx("div",{className:"ml-4 shrink-0",children:i.jsx(ne,{variant:"icon",onClick:()=>a(C,$.id),"aria-label":`Remove ${$.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(sn,{className:"h-5 w-5 text-red-500"})})})]},$.id)):i.jsxs("p",{className:"text-center text-muted py-4",children:["No holidays added yet for ",C," staff."]})})]})]})]})},Pce=()=>{const{user:n}=jt(),{officeHolidays:e,fieldHolidays:t,attendance:r,recurringHolidays:s}=bi(),[a,o]=E.useState(new Date),[l,c]=E.useState([]),[d,h]=E.useState(!1),p=E.useMemo(()=>n?.role==="field_officer"?t:e,[n,t,e]),x=E.useMemo(()=>{const O=n?.role==="field_officer"?"field":"office";return s.filter(M=>(M.type||"office")===O)},[n,s]);E.useEffect(()=>{console.log("Active Recurring Rules:",x)},[x]);const v=E.useMemo(()=>{const O=[],M=vi(a),D=Ma(a),I=vo({start:M,end:D}),F=(n?.role==="field_officer"?r?.field?.monthlyFloatingLeaves:r?.office?.monthlyFloatingLeaves)??0;let q=0;return x.forEach(U=>{if(q>=F)return;let B=0;for(const W of I)if(We(W,"EEEE").toLowerCase()===U.day.toLowerCase()&&(B++,B===U.n)){O.push(W),q++;break}}),O},[a,x,r,n]);E.useEffect(()=>{console.log("Calculated Recurring Holiday Dates:",v)},[v]),E.useEffect(()=>{const O=async()=>{if(n){h(!0);try{const I=vi(a).toISOString(),F=Ma(a).toISOString(),q=await ce.getAttendanceEvents(n.id,I,F);c(q)}catch(I){console.error("Failed to fetch attendance events",I)}finally{h(!1)}}},M=async()=>{try{console.log("Fetching attendance settings...");const I=await ce.getAttendanceSettings();console.log("Fetched settings:",I),bi.getState().updateAttendanceSettings(I)}catch(I){console.error("Failed to fetch attendance settings",I)}},D=async()=>{try{console.log("Fetching recurring holidays...");const I=await ce.getRecurringHolidays();console.log("Fetched recurring holidays:",I),bi.setState({recurringHolidays:I})}catch(I){console.error("Failed to fetch recurring holidays",I)}};O(),M(),D()},[n,a]);const b=E.useMemo(()=>vo({start:vi(a),end:Ma(a)}),[a]),_=O=>{const M=l.some(q=>gf(new Date(q.timestamp),O)&&(q.type.toLowerCase().includes("check")||q.type.toLowerCase().includes("in"))),D=v.some(q=>gf(q,O)),I=p.some(q=>gf(new Date(q.date),O));return(D||I)&&M?"holiday-present":D?"floating-holiday":I?"holiday":M?"present":KW(Wc(new Date),Wc(O))?"absent":"neutral"},j=O=>{switch(O){case"present":return"bg-emerald-500 text-white border-emerald-600 shadow-sm";case"absent":return"bg-rose-500 text-white border-rose-600 shadow-sm";case"holiday":return"bg-red-600 text-white border-red-700 shadow-sm";case"floating-holiday":return"bg-amber-500 text-white border-amber-600 shadow-sm";case"holiday-present":return"bg-violet-600 text-white border-violet-700 shadow-sm";default:return"bg-gray-50 text-gray-400 border-gray-100"}},C=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],P=bC(vi(a));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-none bg-transparent p-3 rounded-xl shadow-none w-full md:w-full md:max-w-[320px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Attendance Calendar"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>o(jC(a)),children:i.jsx(cy,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-sm",children:We(a,"MMMM yyyy")}),i.jsx(ne,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>o(ry(a,1)),children:i.jsx(Rf,{className:"h-3 w-3"})})]})]}),d?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(_t,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[C.map(O=>i.jsx("div",{className:"text-center text-xs font-medium text-muted py-1",children:O},O)),Array.from({length:P}).map((O,M)=>i.jsx("div",{className:"aspect-square"},`empty-${M}`)),b.map(O=>{const M=_(O),D=j(M);return i.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${D} transition-colors`,children:i.jsx("span",{className:"text-sm font-semibold",children:We(O,"d")})},O.toISOString())})]}),i.jsxs("div",{className:"mt-3 flex gap-3 text-xs text-muted justify-center flex-wrap",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-emerald-500 border border-emerald-600 rounded-sm"})," Present"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-rose-500 border border-rose-600 rounded-sm"})," Absent"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-red-600 border border-red-700 rounded-sm"})," Holiday"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-amber-500 border border-amber-600 rounded-sm"})," Floating Holiday"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-violet-600 border border-violet-700 rounded-sm"})," Holiday Present"]})]})]})},Mce=({logs:n,isLoading:e=!1})=>{const{colorScheme:t}=on(),[r,s]=E.useState(new Date),a=E.useMemo(()=>vo({start:vi(r),end:Ma(r)}),[r]),o=h=>n.some(x=>{const v=new Date(x.dateEarned.replace(/-/g,"/"));return gf(v,h)})?"earned":"neutral",l=h=>{switch(h){case"earned":return t==="blue"?"bg-blue-600 text-white border-blue-700 shadow-sm":"bg-[#006B3F] text-white border-[#005632] shadow-sm";default:return"bg-gray-50 text-gray-400 border-gray-100"}},c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d=bC(vi(r));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-none bg-transparent p-3 rounded-xl shadow-none w-full md:w-full md:max-w-[320px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Comp Off Tracker"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>s(jC(r)),children:i.jsx(cy,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-sm",children:We(r,"MMMM yyyy")}),i.jsx(ne,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>s(ry(r,1)),children:i.jsx(Rf,{className:"h-3 w-3"})})]})]}),e?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(_t,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[c.map(h=>i.jsx("div",{className:"text-center text-xs font-medium text-muted py-1",children:h},h)),Array.from({length:d}).map((h,p)=>i.jsx("div",{className:"aspect-square"},`empty-${p}`)),a.map(h=>{const p=o(h),x=l(p);return i.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${x} transition-colors`,children:i.jsx("span",{className:"text-sm font-semibold",children:We(h,"d")})},h.toISOString())})]}),i.jsx("div",{className:"mt-3 flex gap-3 text-xs text-muted justify-center",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:`w-2 h-2 ${t==="blue"?"bg-blue-600 border-blue-700":"bg-[#006B3F] border-[#005632]"} border rounded-sm`})," Comp Off Earned"]})})]})},Ece=()=>{const{colorScheme:n}=on(),{user:e}=jt(),[t,r]=E.useState(new Date),[s,a]=E.useState([]),[o,l]=E.useState(!1);E.useEffect(()=>{(async()=>{if(e){l(!0);try{const v=vi(t).toISOString(),b=Ma(t).toISOString(),_=await ce.getAttendanceEvents(e.id,v,b);a(_)}catch(v){console.error("Failed to fetch attendance events",v)}finally{l(!1)}}})()},[e,t]);const c=E.useMemo(()=>vo({start:vi(t),end:Ma(t)}),[t]),d=x=>{const v=s.filter(O=>gf(new Date(O.timestamp),x));if(v.length===0)return 0;const b=[...v].sort((O,M)=>new Date(O.timestamp).getTime()-new Date(M.timestamp).getTime());let _=0,j=null;b.forEach(O=>{const M=new Date(O.timestamp);O.type==="check-in"?j=M:O.type==="check-out"&&j&&(_+=xf(M,j),j=null)});const C=_/60,P=Math.max(0,C-8);return parseFloat(P.toFixed(1))},h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],p=bC(vi(t));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-0 bg-transparent p-3 rounded-xl shadow-none w-full",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"OT Calendar"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>r(jC(t)),children:i.jsx(cy,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-xs",children:We(t,"MMMM yyyy")}),i.jsx(ne,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>r(ry(t,1)),children:i.jsx(Rf,{className:"h-3 w-3"})})]})]}),o?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(_t,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[h.map(x=>i.jsx("div",{className:"text-center text-[10px] font-medium text-muted py-1",children:x},x)),Array.from({length:p}).map((x,v)=>i.jsx("div",{className:"aspect-square"},`empty-${v}`)),c.map(x=>{const v=d(x),b=v>0;return i.jsxs("div",{className:`aspect-square rounded border flex flex-col items-center justify-center transition-colors ${b?n==="blue"?"bg-blue-600 text-white border-blue-700 shadow-sm":"bg-[#006B3F] text-white border-[#005632] shadow-sm":"bg-gray-50 text-gray-400 border-gray-100"}`,children:[i.jsx("span",{className:"text-xs font-semibold",children:We(x,"d")}),b&&i.jsxs("span",{className:"text-[8px] font-bold",children:["+",v,"h"]})]},x.toISOString())})]}),i.jsx("div",{className:"mt-3 flex gap-3 text-[10px] text-muted justify-center flex-wrap",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:`w-2 h-2 ${n==="blue"?"bg-blue-600 border-blue-700":"bg-[#006B3F] border-[#005632]"} border rounded-sm`})," Overtime (>8h)"]})})]})},Dce=()=>{const{user:n}=jt(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState("day"),[l,c]=E.useState(new Date),[d,h]=E.useState({});At("(max-width: 767px)");const p=async()=>{if(n){s(!0);try{let C,P;switch(a){case"day":C=Wc(l),P=xC(l);break;case"week":C=To(l,{weekStartsOn:1}),P=sP(l,{weekStartsOn:1});break;case"month":C=vi(l),P=Ma(l);break}const O=await ce.getAttendanceEvents(n.id,C.toISOString(),P.toISOString());t(O);const M=O.filter(D=>D.latitude&&D.longitude).map(D=>({lat:D.latitude,lon:D.longitude}));if(M.length>0)try{const D=await ce.batchResolveAddresses(M);h(D)}catch(D){console.error("Failed to fetch location addresses:",D)}}catch(C){console.error("Failed to fetch attendance events:",C)}finally{s(!1)}}};E.useEffect(()=>{p()},[n,a,l]);const x=E.useMemo(()=>{const C={};return e.forEach(P=>{const O=We(new Date(P.timestamp),"yyyy-MM-dd");C[O]||(C[O]={date:O,events:[],checkIns:[],checkOuts:[],totalMinutes:0}),C[O].events.push(P),P.type==="check-in"?C[O].checkIns.push(P):P.type==="check-out"&&C[O].checkOuts.push(P)}),Object.values(C).forEach(P=>{const O=[...P.events].sort((I,F)=>new Date(I.timestamp).getTime()-new Date(F.timestamp).getTime());let M=0,D=null;O.forEach(I=>{const F=new Date(I.timestamp);I.type==="check-in"?D=F:I.type==="check-out"&&D&&(M+=xf(F,D),D=null)}),P.totalMinutes=M}),Object.values(C).sort((P,O)=>O.date.localeCompare(P.date))},[e]),v=C=>{const P=Math.floor(C/60),O=C%60;return`${P}h ${O}m`},b=C=>{o(C)},_=C=>{const P=new Date(l);switch(a){case"day":P.setDate(P.getDate()+(C==="next"?1:-1));break;case"week":P.setDate(P.getDate()+(C==="next"?7:-7));break;case"month":P.setMonth(P.getMonth()+(C==="next"?1:-1));break}c(P)},j=()=>{switch(a){case"day":return We(l,"dd MMM, yyyy");case"week":const C=To(l,{weekStartsOn:1}),P=sP(l,{weekStartsOn:1});return`${We(C,"dd MMM")} - ${We(P,"dd MMM, yyyy")}`;case"month":return We(l,"MMMM yyyy")}};return n?i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-indigo-50 rounded-lg",children:i.jsx(Hc,{className:"h-5 w-5 text-indigo-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Employee Log"})]}),i.jsxs("div",{className:"mb-6 space-y-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>b("day"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="day"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Day"}),i.jsx("button",{onClick:()=>b("week"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="week"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Week"}),i.jsx("button",{onClick:()=>b("month"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="month"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Month"})]}),i.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[i.jsx("button",{onClick:()=>_("prev"),className:"px-3 py-1 bg-white rounded-md shadow-sm hover:bg-gray-100 transition-colors",children:""}),i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-gray-900",children:[i.jsx(Da,{className:"h-4 w-4"}),i.jsx("span",{children:j()})]}),i.jsx("button",{onClick:()=>_("next"),className:"px-3 py-1 bg-white rounded-md shadow-sm hover:bg-gray-100 transition-colors",children:""})]})]}),i.jsx("div",{className:"space-y-4",children:r?i.jsx("div",{className:"flex items-center justify-center py-10",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-indigo-600"})}):x.length===0?i.jsxs("div",{className:"text-center py-10 text-gray-500",children:[i.jsx(Da,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{className:"font-medium",children:"No attendance records found"}),i.jsx("p",{className:"text-sm mt-1",children:"Check-in to start tracking your attendance"})]}):x.map(C=>i.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl border border-gray-200 overflow-hidden",children:[i.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-500 px-4 py-3 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 text-white",children:[i.jsx(Da,{className:"h-4 w-4"}),i.jsx("span",{className:"font-semibold",children:We(new Date(C.date),"EEEE, dd MMMM yyyy")})]}),i.jsx("div",{className:"text-white text-sm font-medium bg-white/20 px-3 py-1 rounded-full",children:v(C.totalMinutes)})]}),i.jsx("div",{className:"p-4 space-y-3",children:C.events.sort((P,O)=>new Date(P.timestamp).getTime()-new Date(O.timestamp).getTime()).map((P,O)=>i.jsx("div",{className:`p-3 rounded-lg border-l-4 ${P.type==="check-in"?"bg-emerald-50 border-emerald-500":"bg-rose-50 border-rose-500"}`,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`p-2 rounded-lg ${P.type==="check-in"?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:i.jsx(Hc,{className:"h-4 w-4"})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900 capitalize",children:P.type.replace("-"," ")}),i.jsx("div",{className:"text-sm text-gray-600",children:We(new Date(P.timestamp),"hh:mm a")})]})]}),P.latitude&&P.longitude&&i.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-600 bg-white px-3 py-1.5 rounded-lg border border-gray-200 max-w-md",children:[i.jsx(Pl,{className:"h-4 w-4 text-indigo-600 flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-xs break-words",children:d[`${P.latitude.toFixed(6)},${P.longitude.toFixed(6)}`]||`${P.latitude.toFixed(4)}, ${P.longitude.toFixed(4)}`})]})]})},`${P.timestamp}-${O}`))}),i.jsx("div",{className:"bg-gray-50 px-4 py-3 border-t border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Check-ins:"}),i.jsx("span",{className:"ml-2 font-semibold text-emerald-600",children:C.checkIns.length})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Check-outs:"}),i.jsx("span",{className:"ml-2 font-semibold text-rose-600",children:C.checkOuts.length})]})]})})]},C.date))})]}):null},VL=({title:n,value:e,icon:t})=>i.jsxs("div",{className:"bg-card p-3 md:p-4 rounded-xl flex flex-col md:flex-row items-center md:items-center gap-2 md:gap-4 border border-border text-center md:text-left w-full",children:[i.jsx("div",{className:"bg-accent-light p-2 md:p-3 rounded-full flex-shrink-0",children:i.jsx(t,{className:"h-5 w-5 md:h-6 md:w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-xs md:text-sm text-muted font-medium",children:n}),i.jsx("p",{className:"text-lg md:text-2xl font-bold text-primary-text",children:e})]})]}),Oce=({status:n})=>{const e={pending_manager_approval:"leave-status-chip--pending_manager_approval",pending_hr_confirmation:"leave-status-chip--pending_hr_confirmation",approved:"leave-status-chip--approved",rejected:"leave-status-chip--rejected"},t=n.replace(/_/g," ");return i.jsx("span",{className:`leave-status-chip ${e[n]}`,children:t})},Ice=n=>Pt({leaveType:ye().oneOf(["Earned","Sick","Floating","Comp Off"]).required("Leave type is required"),startDate:ye().required("Start date is required"),endDate:ye().required("End date is required").test("is-after-start","End date must be on or after start date",function(e){const{startDate:t}=this.parent;return!t||!e?!0:new Date(e.replace(/-/g,"/"))>=new Date(t.replace(/-/g,"/"))}),reason:ye().required("A reason for the leave is required").min(10,"Please provide a more detailed reason."),dayOption:ye().oneOf(["full","half"]).optional(),doctorCertificate:Vt().when(["leaveType","startDate","endDate"],{is:(e,t,r)=>e!=="Sick"||!t||!r?!1:Om(new Date(r.replace(/-/g,"/")),new Date(t.replace(/-/g,"/")))+1>n,then:e=>e.required(`A doctor's certificate is required for sick leave longer than ${n} days.`),otherwise:e=>e.nullable().optional()})}),Ace=({isOpen:n,onClose:e,onSuccess:t,user:r,isMobile:s,setToast:a})=>{const{attendance:{office:{sickLeaveCertificateThreshold:o}}}=bi(),l=E.useMemo(()=>Ice(o),[o]),{register:c,control:d,handleSubmit:h,watch:p,formState:{errors:x},reset:v}=tn({resolver:On(l),defaultValues:{leaveType:"Earned",startDate:We(new Date,"yyyy-MM-dd"),endDate:We(new Date,"yyyy-MM-dd"),dayOption:"full"}}),b=p("startDate"),_=p("endDate"),j=p("leaveType"),P=E.useMemo(()=>!b||!_?!1:gf(new Date(b.replace(/-/g,"/")),new Date(_.replace(/-/g,"/"))),[b,_])&&j==="Earned",O=E.useMemo(()=>j!=="Sick"||!b||!_?!1:Om(new Date(_.replace(/-/g,"/")),new Date(b.replace(/-/g,"/")))+1>o,[j,b,_,o]),M=async D=>{try{await ce.submitLeaveRequest({...D,userId:r.id,userName:r.name}),t()}catch{a({message:"Failed to submit leave request.",type:"error"})}};return n?i.jsx("div",{className:`fixed inset-0 z-40 bg-card ${s?"flex flex-col":"flex items-center justify-center bg-black/50 p-4"}`,children:i.jsxs("div",{className:`w-full ${s?"flex flex-col h-full":"max-w-2xl bg-card rounded-xl shadow-lg"}`,children:[i.jsxs("header",{className:`p-4 flex-shrink-0 flex items-center gap-4 ${s?"fo-mobile-header":"border-b"}`,children:[i.jsx(ne,{variant:"icon",onClick:e,"aria-label":"Go back",children:i.jsx(Fa,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-lg font-semibold",children:s?"New Leave Request":"Submit a New Leave Request"})]}),i.jsxs("form",{id:"leave-form",onSubmit:h(M),className:"flex-grow overflow-y-auto p-4 space-y-4",children:[i.jsx(_e,{name:"leaveType",control:d,render:({field:D})=>i.jsxs(Ze,{label:"Leave Type",...D,error:x.leaveType?.message,className:s?"pro-select pro-select-arrow":"",children:[i.jsx("option",{children:"Earned"}),i.jsx("option",{children:"Sick"}),i.jsx("option",{children:"Floating"}),i.jsx("option",{children:"Comp Off"})]})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(_e,{name:"startDate",control:d,render:({field:D})=>i.jsx(En,{label:"Start Date",id:"startDate",value:D.value,onChange:D.onChange,error:x.startDate?.message})}),i.jsx(_e,{name:"endDate",control:d,render:({field:D})=>i.jsx(En,{label:"End Date",id:"endDate",value:D.value,onChange:D.onChange,error:x.endDate?.message})})]}),P&&i.jsx(_e,{name:"dayOption",control:d,render:({field:D})=>i.jsxs(Ze,{label:"Day Option",...D,className:s?"pro-select pro-select-arrow":"",children:[i.jsx("option",{value:"full",children:"Full Day"}),i.jsx("option",{value:"half",children:"Half Day"})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Reason"}),i.jsx("textarea",{...c("reason"),rows:4,className:`mt-1 form-input ${x.reason?"form-input--error":""}`}),x.reason&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.reason.message})]}),O&&i.jsx(_e,{name:"doctorCertificate",control:d,render:({field:D,fieldState:I})=>i.jsx(vt,{label:"Doctor's Certificate (Required)",file:D.value,onFileChange:D.onChange,error:I.error?.message,allowCapture:!0})})]}),i.jsxs("footer",{className:`p-4 flex-shrink-0 flex items-center justify-end gap-2 ${s?"":"border-t"}`,children:[i.jsx(ne,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(ne,{type:"submit",form:"leave-form",children:"Submit Request"})]})]})}):null},Rce=()=>{const{user:n}=jt(),[e,t]=E.useState(null),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState(!1),[p,x]=E.useState("all"),[v,b]=E.useState(null),_=At("(max-width: 767px)"),[j,C]=E.useState(!1),[P,O]=E.useState(0),M=E.useCallback(async()=>{if(n){c(!0),h(!1);try{const[U,B,W]=await Promise.all([ce.getLeaveBalancesForUser(n.id),ce.getLeaveRequests({userId:n.id,status:p==="all"?void 0:p}),ce.getCompOffLogs(n.id).catch(Y=>{if(Y&&Y.message&&(Y.message.includes("comp_off_logs")||Y.message.includes('relation "public.comp_off_logs" does not exist')))return h(!0),[];throw Y})]);if(t(U),s(B),o(W),n.role==="field_officer"){const Y=new Date,G=vi(Y).toISOString(),Z=Ma(Y).toISOString(),oe=await ce.getAttendanceEvents(n.id,G,Z),X={};oe.forEach($=>{const K=We(new Date($.timestamp),"yyyy-MM-dd");X[K]||(X[K]=[]),X[K].push($)});let he=0;Object.values(X).forEach($=>{const K=[...$].sort((le,ue)=>new Date(le.timestamp).getTime()-new Date(ue.timestamp).getTime());let te=0,H=null;K.forEach(le=>{const ue=new Date(le.timestamp);le.type==="check-in"?H=ue:le.type==="check-out"&&H&&(te+=xf(ue,H),H=null)});const ae=te/60;ae>8&&(he+=ae-8)}),O(parseFloat(he.toFixed(1)))}}catch(U){let B="Failed to load leave data.";U&&typeof U.message=="string"&&U.message.includes('relation "leave_requests" does not exist')&&(B='Database setup error: The "leave_requests" table is missing.'),console.error("Failed to load leave data",U),d||b({message:B,type:"error"})}finally{c(!1)}}},[n,p]);E.useEffect(()=>{M()},[M]);const D=()=>{b({message:"Leave request submitted successfully!",type:"success"}),C(!1),M()},I=U=>U.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase()),F=["all","pending_manager_approval","pending_hr_confirmation","approved","rejected"],q=e?[{title:"Earned Leave",value:`${e.earnedTotal-e.earnedUsed} / ${e.earnedTotal}`,icon:t3},{title:"Sick Leave",value:`${e.sickTotal-e.sickUsed} / ${e.sickTotal}`,icon:MC},{title:"Floating Holiday",value:`${e.floatingTotal-e.floatingUsed} / ${e.floatingTotal}`,icon:zJ},{title:"Compensatory Off",value:`${e.compOffTotal-e.compOffUsed} / ${e.compOffTotal}`,icon:uJ}]:[];return i.jsxs("div",{className:"p-4 space-y-6",children:[v&&i.jsx(pt,{message:v.message,type:v.type,onDismiss:()=>b(null)}),n&&i.jsx(Ace,{isOpen:j,onClose:()=>C(!1),onSuccess:D,user:n,isMobile:_,setToast:b}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Leave Requests"}),!_&&i.jsxs(ne,{onClick:()=>C(!0),children:[i.jsx(Ut,{className:"mr-2 h-4"})," New Request"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6 justify-items-center md:justify-items-start",children:[q.map(U=>i.jsx(VL,{...U},U.title)),n?.role==="field_officer"&&i.jsx(VL,{title:"Overtime Hours",value:`${P} hrs`,icon:Hc})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[i.jsx(Pce,{}),i.jsx(Mce,{logs:a,isLoading:l}),n?.role==="field_officer"&&i.jsx(Ece,{})]}),_&&i.jsx("div",{className:"my-4 w-full",children:i.jsxs(ne,{onClick:()=>C(!0),size:"lg",className:"w-full justify-center text-lg",children:[i.jsx(Ut,{className:"mr-2 h-5"})," New Request"]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full md:w-full",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:i.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 space-y-2 md:space-y-0","aria-label":"Tabs",children:F.map(U=>i.jsx("button",{onClick:()=>x(U),className:`whitespace-nowrap font-medium text-base rounded-lg md:rounded-none w-full md:w-auto text-left px-4 py-2 md:px-1 md:py-3 md:bg-transparent md:border-b-2
                                    ${p===U?"bg-accent-light text-accent-dark md:border-accent":"text-muted hover:bg-accent-light hover:text-accent-dark md:border-transparent md:hover:border-accent"}`,children:I(U)},U))})})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Dates"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted text-lg",children:"No requests found."})}):r.map(U=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Type",className:"px-4 py-3 font-medium text-base",children:[U.leaveType," ",U.dayOption&&`(${U.dayOption})`]}),i.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted text-base",children:[We(new Date(U.startDate.replace(/-/g,"/")),"dd MMM")," - ",We(new Date(U.endDate.replace(/-/g,"/")),"dd MMM")]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate text-base",children:U.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3 text-base",children:i.jsx(Oce,{status:U.status})})]},U.id))})]})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full md:w-full",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Compensatory Off Tracker"}),d?i.jsxs("div",{className:"text-center py-10 text-muted bg-page rounded-lg",children:[i.jsx(Aa,{className:"h-8 w-8 mx-auto mb-2 text-yellow-500"}),i.jsx("p",{className:"font-semibold",children:"Feature Unavailable"}),i.jsx("p",{className:"text-sm",children:"The Compensatory Off feature is disabled because the required 'comp_off_logs' table is missing in the database."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date Earned"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason for Comp-Off"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Granted By"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted text-lg",children:"No comp-off history found."})}):a.map(U=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Date Earned",className:"px-4 py-3 font-medium",children:We(new Date(U.dateEarned.replace(/-/g,"/")),"dd MMM, yyyy")}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted",children:U.reason}),i.jsx("td",{"data-label":"Granted By",className:"px-4 py-3 text-muted",children:U.grantedByName||"-"}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full capitalize ${U.status==="earned"?"bg-blue-100 text-blue-800":"bg-gray-200 text-gray-800"}`,children:U.status})})]},U.id))})]})})]}),i.jsx(Dce,{})]})},Lce=({isOpen:n,onClose:e,onConfirm:t,isConfirming:r})=>{const[s,a]=E.useState(""),[o,l]=E.useState(""),c=()=>{if(!s.trim()){l("A reason for rejection is required.");return}t(s)},d=()=>{a(""),l(""),e()};return n?i.jsx(Kr,{isOpen:n,onClose:d,onConfirm:c,title:"Reject Claim",confirmButtonText:"Confirm Rejection",isConfirming:r,children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{children:"Please provide a reason for rejecting this claim. This will be visible to the employee."}),i.jsxs("div",{children:[i.jsx("textarea",{value:s,onChange:h=>{a(h.target.value),o&&l("")},rows:3,className:`mt-1 form-input ${o?"form-input--error":""}`,placeholder:"e.g., Overtime was not pre-approved."}),o&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:o})]})]})}):null},Fce=({status:n})=>{const e={pending_manager_approval:"bg-yellow-100 text-yellow-800",pending_hr_confirmation:"bg-blue-100 text-blue-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},t=n.replace(/_/g," ");return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:t})},qce=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},zce=()=>{const n=Nt(),{user:e}=jt(),{colorScheme:t}=on(),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState("pending_manager_approval"),[p,x]=E.useState(null),[v,b]=E.useState(null),_=At("(max-width: 767px)"),[j,C]=E.useState(!0),[P,O]=E.useState(!1),[M,D]=E.useState(null);E.useEffect(()=>{(async()=>{try{await ce.checkCompOffTableExists(),C(!0)}catch{C(!1)}})()},[]);const I=E.useCallback(async()=>{if(e){c(!0);try{const G=["admin","hr","operation_manager","site_manager"].includes(e.role),[Z,oe]=await Promise.all([ce.getLeaveRequests({forApproverId:e.id,status:d!=="all"&&d!=="claims"?d:void 0}),G?ce.getExtraWorkLogs():Promise.resolve([])]);s(Z),o(oe)}catch{x({message:"Failed to load approval data.",type:"error"})}finally{c(!1)}}},[e,d]);E.useEffect(()=>{I()},[I]);const F=async(G,Z)=>{if(e){b(G);try{switch(Z){case"approve":await ce.approveLeaveRequest(G,e.id);break;case"reject":await ce.rejectLeaveRequest(G,e.id);break;case"confirm":await ce.confirmLeaveByHR(G,e.id);break}x({message:"Request actioned successfully.",type:"success"}),I()}catch{x({message:"Failed to update request.",type:"error"})}finally{b(null)}}},q=async G=>{if(e){b(G);try{await ce.approveExtraWorkClaim(G,e.id),x({message:"Claim approved successfully.",type:"success"}),I()}catch{x({message:"Failed to approve claim.",type:"error"})}finally{b(null)}}},U=async G=>{if(!(!e||!M)){b(M.id);try{await ce.rejectExtraWorkClaim(M.id,e.id,G),x({message:"Claim rejected successfully.",type:"success"}),I()}catch{x({message:"Failed to reject claim.",type:"error"})}finally{b(null),O(!1),D(null)}}},B=["pending_manager_approval","claims","pending_hr_confirmation","approved","rejected","all"],W=({request:G})=>{if(!e||G.status==="approved"||G.status==="rejected")return null;if(G.currentApproverId===e.id){if(G.status==="pending_manager_approval")return i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>F(G.id,"approve"),disabled:v===G.id,title:"Approve","aria-label":"Approve request",children:i.jsx(Sl,{className:"h-4 w-4 text-green-600"})}),i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>F(G.id,"reject"),disabled:v===G.id,title:"Reject","aria-label":"Reject request",children:i.jsx(wi,{className:"h-4 w-4 text-red-600"})})]});if(G.status==="pending_hr_confirmation"&&(e.role==="hr"||e.role==="admin"))return i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>F(G.id,"confirm"),disabled:v===G.id,title:"Confirm & Finalize","aria-label":"Confirm and finalize request",children:i.jsx(Sl,{className:"h-4 w-4 text-blue-600"})}),i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>F(G.id,"reject"),disabled:v===G.id,title:"Reject","aria-label":"Reject request",children:i.jsx(wi,{className:"h-4 w-4 text-red-600"})})]})}return null},Y=G=>G.replace(/_/g," ").replace(/\b\w/g,Z=>Z.toUpperCase());return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Lce,{isOpen:P,onClose:()=>{O(!1),D(null)},onConfirm:U,isConfirming:!!v}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Leave Approval Inbox"}),!_&&i.jsxs(ne,{onClick:()=>n("/hr/leave-management/grant-comp-off"),disabled:!j,title:j?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:t==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:t==="blue"?"#0f264a":"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})]}),_&&i.jsx("div",{className:"mb-6",children:i.jsxs(ne,{onClick:()=>n("/hr/leave-management/grant-comp-off"),disabled:!j,title:j?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:t==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:t==="blue"?"#0f264a":"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})}),i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:i.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 md:overflow-x-auto space-y-1 md:space-y-0","aria-label":"Tabs",children:B.map(G=>i.jsx("button",{onClick:()=>h(G),className:`whitespace-nowrap font-medium text-sm rounded-lg md:rounded-none w-full md:w-auto text-left md:text-center px-4 py-3 md:px-1 md:py-3 md:bg-transparent md:border-b-2 transition-colors duration-200
                                ${d===G?"bg-emerald-50 text-emerald-700 md:border-emerald-500 md:bg-transparent":"text-muted hover:bg-emerald-50 hover:text-emerald-700 md:border-transparent md:hover:border-emerald-500"}`,children:Y(G)},G))})})}),d==="claims"?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date & Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Claim"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10",children:i.jsx(_t,{className:"h-6 w-6 animate-spin mx-auto"})})}):a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No pending claims found."})}):a.map(G=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:G.userName}),i.jsxs("td",{"data-label":"Date & Type",className:"px-4 py-3 text-muted",children:[We(new Date(G.workDate),"dd MMM, yyyy")," (",G.workType,")"]}),i.jsxs("td",{"data-label":"Claim",className:"px-4 py-3 text-muted",children:[G.claimType,G.claimType==="OT"?` (${G.hoursWorked} hrs)`:""]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:G.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(qce,{status:G.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex md:justify-start justify-end gap-2",children:[i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>q(G.id),disabled:v===G.id,title:"Approve Claim",children:i.jsx(Sl,{className:"h-4 w-4 text-green-600"})}),i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>{D(G),O(!0)},disabled:v===G.id,title:"Reject Claim",children:i.jsx(wi,{className:"h-4 w-4 text-red-600"})})]})})]},G.id))})]})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Dates"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?_?i.jsx("tr",{children:i.jsx("td",{colSpan:6,children:i.jsx(Ra,{rows:3,cols:6,isMobile:!0})})}):i.jsx(Ra,{rows:5,cols:6}):r.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No requests found for this filter."})}):r.map(G=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:G.userName}),i.jsxs("td",{"data-label":"Type",className:"px-4 py-3 text-muted",children:[G.leaveType," ",G.dayOption&&`(${G.dayOption})`]}),i.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted",children:[We(new Date(G.startDate.replace(/-/g,"/")),"dd MMM")," - ",We(new Date(G.endDate.replace(/-/g,"/")),"dd MMM")]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:G.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(Fce,{status:G.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsx("div",{className:"flex md:justify-start justify-end",children:v===G.id?i.jsx(_t,{className:"h-4 w-4 animate-spin"}):i.jsx(W,{request:G})})})]},G.id))})]})})]})},Q6=({users:n,externalSearchQuery:e,externalZoom:t,showControls:r=!0})=>{const s=E.useRef(null),a=E.useRef(null),[o,l]=E.useState(null),[c,d]=E.useState(null),[h,p]=E.useState({x:0,y:0}),[x,v]=E.useState(""),[b,_]=E.useState(1),[j,C]=E.useState({x:0,y:0}),P=e!==void 0?e:x,O=t!==void 0?t:b,M=v,D=_,I=E.useRef(null),F=E.useRef(!1),q=E.useRef({x:0,y:0}),U=E.useRef(!1),B=E.useRef({x:0,y:0}),W=E.useRef(0),Y=E.useRef(new Map),G=E.useRef(window.devicePixelRatio||1);E.useEffect(()=>{n.forEach(re=>{if(re.photoUrl&&!Y.current.has(re.id)){const de=new Image;de.crossOrigin="anonymous",de.src=re.photoUrl,de.onload=()=>{Y.current.set(re.id,de)}}})},[n]);const Z=()=>{const re=new Map;n.forEach(je=>{re.set(je.id,{...je,children:[]})});const de=[];return n.forEach(je=>{const Ae=re.get(je.id);if(je.reportingManagerId){const Te=re.get(je.reportingManagerId);Te?Te.children.push(Ae):de.push(Ae)}else de.push(Ae)}),de},oe=(re,de=50,je=50,Ae=0)=>{let He=de;const ze=[];let be=1/0,Ue=-1/0,Ve=1/0,ee=-1/0;re.forEach(xe=>{if(xe.level=Ae,xe.children&&xe.children.length>0){const ke=oe(xe.children,He,je+120+120,Ae+1),Ie=ke.width,Re=He+Ie/2-180/2;xe.x=Re,xe.y=je,ze.push(xe),ze.push(...ke.nodes),be=Math.min(be,Re,ke.bounds.minX),Ue=Math.max(Ue,Re+180,ke.bounds.maxX),Ve=Math.min(Ve,je,ke.bounds.minY),ee=Math.max(ee,je+120,ke.bounds.maxY),He+=Ie+20}else xe.x=He,xe.y=je,ze.push(xe),be=Math.min(be,He),Ue=Math.max(Ue,He+180),Ve=Math.min(Ve,je),ee=Math.max(ee,je+120),He+=200});const se=Math.max(0,He-de-20);return{width:Math.max(se,180),nodes:ze,bounds:{minX:isFinite(be)?be:0,maxX:isFinite(Ue)?Ue:180,minY:isFinite(Ve)?Ve:0,maxY:isFinite(ee)?ee:300}}},X=(re,de,je,Ae)=>{if(de.x===void 0||de.y===void 0||je.x===void 0||je.y===void 0)return;const Te=(de.x+90)*O+j.x,Se=(de.y+120)*O+j.y,Pe=(je.x+90)*O+j.x,qe=je.y*O+j.y,He=re.createLinearGradient(Te,Se,Pe,qe),ze=Ae*5e-4%1;He.addColorStop(0,"#E0E7FF"),He.addColorStop(ze,"#818CF8"),He.addColorStop(1,"#E0E7FF"),re.save(),re.strokeStyle=He,re.lineWidth=2*O,re.lineCap="round",re.shadowColor="rgba(99, 102, 241, 0.2)",re.shadowBlur=4,re.beginPath(),re.moveTo(Te,Se);const be=(Se+qe)/2;re.bezierCurveTo(Te,be,Pe,be,Pe,qe),re.stroke(),re.restore();const Ve=(Ae*5e-4+de.id.charCodeAt(0)*.1)%1,ee={x:Te,y:Se},se={x:Te,y:(Se+qe)/2},xe={x:Pe,y:(Se+qe)/2},ke={x:Pe,y:qe},Ie=3*(se.x-ee.x),Re=3*(xe.x-se.x)-Ie,nt=ke.x-ee.x-Ie-Re,Xe=3*(se.y-ee.y),ht=3*(xe.y-se.y)-Xe,Bt=ke.y-ee.y-Xe-ht,lt=nt*Ve*Ve*Ve+Re*Ve*Ve+Ie*Ve+ee.x,Wt=Bt*Ve*Ve*Ve+ht*Ve*Ve+Xe*Ve+ee.y;re.save(),re.fillStyle="#6366F1",re.shadowColor="#6366F1",re.shadowBlur=8,re.beginPath(),re.arc(lt,Wt,3*O,0,Math.PI*2),re.fill(),re.restore()},he=(re,de,je,Ae,Te)=>{if(de.x===void 0||de.y===void 0)return null;const Se=de.x*O+j.x,Pe=de.y*O+j.y,qe=180*O,He=120*O,ze=48*O,be=!!P&&de.name.toLowerCase().includes(P.toLowerCase());re.save(),re.shadowColor=Ae?"rgba(99, 102, 241, 0.4)":"rgba(0, 0, 0, 0.08)",re.shadowBlur=(Ae?24:12)*O,re.shadowOffsetY=(Ae?8:4)*O;const Ue=re.createLinearGradient(Se,Pe,Se,Pe+He);Ue.addColorStop(0,"#FFFFFF"),Ue.addColorStop(1,"#FAFAFA"),re.fillStyle=Ue;const Ve=16*O;re.beginPath(),re.roundRect?re.roundRect(Se,Pe,qe,He,Ve):(re.moveTo(Se+Ve,Pe),re.lineTo(Se+qe-Ve,Pe),re.quadraticCurveTo(Se+qe,Pe,Se+qe,Pe+Ve),re.lineTo(Se+qe,Pe+He-Ve),re.quadraticCurveTo(Se+qe,Pe+He,Se+qe-Ve,Pe+He),re.lineTo(Se+Ve,Pe+He),re.quadraticCurveTo(Se,Pe+He,Se,Pe+He-Ve),re.lineTo(Se,Pe+Ve),re.quadraticCurveTo(Se,Pe,Se+Ve,Pe)),re.fill(),re.lineWidth=(Ae?2:1)*O,re.strokeStyle=Ae?"#6366F1":je?"#A5B4FC":be?"#22C55E":"#E5E7EB",re.stroke(),re.restore(),(Ae||be)&&(re.save(),re.globalAlpha=.05,re.fillStyle=Ae?"#6366F1":"#22C55E",re.beginPath(),re.roundRect&&re.roundRect(Se,Pe,qe,He,Ve),re.fill(),re.restore());const ee=Se+(qe-ze)/2,se=Pe+16*O;re.save(),re.beginPath(),re.arc(ee+ze/2,se+ze/2,ze/2,0,Math.PI*2),re.clip();const xe=Y.current.get(de.id);if(xe&&xe.complete)re.drawImage(xe,ee,se,ze,ze);else{const ht=re.createLinearGradient(ee,se,ee+ze,se+ze);ht.addColorStop(0,"#818CF8"),ht.addColorStop(1,"#4F46E5"),re.fillStyle=ht,re.fillRect(ee,se,ze,ze),re.fillStyle="#FFF",re.font=`600 ${Math.max(12,16*O)}px "Inter", sans-serif`,re.textAlign="center",re.textBaseline="middle";const Bt=de.name.split(" ").map(lt=>lt[0]).join("").substring(0,2).toUpperCase();re.fillText(Bt,ee+ze/2,se+ze/2+1*O)}if(re.restore(),re.save(),re.strokeStyle=Ae?"#6366F1":"#FFF",re.lineWidth=2*O,re.beginPath(),re.arc(ee+ze/2,se+ze/2,ze/2,0,Math.PI*2),re.stroke(),re.restore(),de.level!==void 0&&de.level>0){const ht=18*O,Bt=ee+ze-ht/2,lt=se+ze-ht/2;re.save(),re.fillStyle="#10B981",re.shadowColor="rgba(16, 185, 129, 0.4)",re.shadowBlur=4*O,re.beginPath(),re.arc(Bt,lt,ht/2,0,Math.PI*2),re.fill(),re.fillStyle="#FFF",re.font=`700 ${Math.max(8,9*O)}px "Inter", sans-serif`,re.textAlign="center",re.textBaseline="middle",re.fillText(`L${de.level}`,Bt,lt+1*O),re.restore()}re.save(),re.fillStyle="#111827",re.font=`600 ${Math.max(11,13*O)}px "Inter", sans-serif`,re.textAlign="center",re.textBaseline="top";const ke=se+ze+12*O;let Ie=de.name;const Re=qe-24*O;if(re.measureText(Ie).width>Re){for(;re.measureText(Ie+"...").width>Re&&Ie.length>0;)Ie=Ie.substring(0,Ie.length-1);Ie+="..."}re.fillText(Ie,Se+qe/2,ke),re.fillStyle="#6B7280",re.font=`500 ${Math.max(9,11*O)}px "Inter", sans-serif`;const nt=ke+18*O;let Xe=(de.role||"").replace(/_/g," ");if(Xe=Xe?Xe.charAt(0).toUpperCase()+Xe.slice(1).toLowerCase():"",re.measureText(Xe).width>Re){for(;re.measureText(Xe+"...").width>Re&&Xe.length>0;)Xe=Xe.substring(0,Xe.length-1);Xe+="..."}return re.fillText(Xe,Se+qe/2,nt),re.restore(),{x:Se,y:Pe,width:qe,height:He}},$=(re,de)=>{const je=Z(),Ae=oe(je),Te=new Map;return Ae.nodes.forEach(Se=>{Se.children&&Se.children.forEach(Pe=>{X(re,Se,Pe,de)})}),Ae.nodes.forEach(Se=>{const Pe=o?.id===Se.id,qe=c?.id===Se.id,He=he(re,Se,Pe,qe);He&&Te.set(Se.id,He)}),{nodePositions:Te,layout:Ae}},K=re=>{const de=re??s.current;if(!de)return;const je=de.getBoundingClientRect(),Ae=Z(),Se=oe(Ae).bounds,Pe=180,qe=120,He=Math.max(1,Se.maxX-Se.minX+Pe),ze=Math.max(1,Se.maxY-Se.minY+qe),be=Se.minX+He/2,Ue=Se.minY+ze/2,Ve=.98,ee=je.width*Ve/He,se=je.height*Ve/ze;let xe=Math.min(ee,se);xe=Math.max(.3,Math.min(xe,1.5));const ke=t!==void 0?t:xe,Ie=je.width/2-be*ke,Re=je.height/2-Ue*ke;t===void 0&&D(xe),C({x:Ie,y:Re})};E.useEffect(()=>{if(n.length>0){const re=setTimeout(()=>K(),100);return()=>clearTimeout(re)}},[n.length]),E.useEffect(()=>{t!==void 0&&n.length>0&&K()},[t]),E.useEffect(()=>{const re=()=>{const de=s.current,je=a.current;if(!de||!je)return;const Ae=window.devicePixelRatio||1;G.current=Ae;const Te=je.getBoundingClientRect(),Se=Math.max(1,Te.width),Pe=Math.max(1,Te.height);de.width=Math.round(Se*Ae),de.height=Math.round(Pe*Ae),de.style.width=`${Se}px`,de.style.height=`${Pe}px`;const qe=de.getContext("2d");qe&&(qe.setTransform(Ae,0,0,Ae,0,0),K(de))};return re(),window.addEventListener("resize",re),()=>window.removeEventListener("resize",re)},[n]),E.useEffect(()=>{const re=s.current,de=re?.getContext("2d");if(!re||!de)return;const je=G.current;let Ae=0;const Te=()=>{W.current+=16,de.clearRect(0,0,re.width/je,re.height/je);const Se=re.width/je,Pe=re.height/je,qe=de.createLinearGradient(0,0,Se,Pe);qe.addColorStop(0,"#FAFAFA"),qe.addColorStop(1,"#F3F4F6"),de.fillStyle=qe,de.fillRect(0,0,Se,Pe);const{nodePositions:He}=$(de,W.current);let ze=!1;for(const[be,Ue]of He.entries())if(h.x>=Ue.x&&h.x<=Ue.x+Ue.width&&h.y>=Ue.y&&h.y<=Ue.y+Ue.height){const Ve=n.find(ee=>ee.id===be);if(Ve){l(Ve),ze=!0;break}}!ze&&o&&l(null),Ae=requestAnimationFrame(Te),I.current=Ae};return I.current=requestAnimationFrame(Te),()=>{I.current&&cancelAnimationFrame(I.current)}},[n,o,c,h,O,j,P]);const te=re=>{F.current=!0,U.current=!1;const de=re.nativeEvent.offsetX,je=re.nativeEvent.offsetY;B.current={x:de,y:je},q.current={x:de,y:je}},H=re=>{const de=re.nativeEvent.offsetX,je=re.nativeEvent.offsetY;if(p({x:de,y:je}),F.current){const Ae=(de-B.current.x)*1.3,Te=(je-B.current.y)*1.3;Math.sqrt(Math.pow(de-q.current.x,2)+Math.pow(je-q.current.y,2))>5&&(U.current=!0),C(Pe=>({x:Pe.x+Ae,y:Pe.y+Te})),B.current={x:de,y:je}}},ae=()=>{F.current=!1},le=()=>{o&&!U.current&&d(c?.id===o.id?null:o),U.current=!1},ue=()=>D(re=>Math.min(re+.2,2.5)),ie=()=>D(re=>Math.max(re-.2,.4)),pe=()=>{K(),d(null),M("")};return i.jsxs("div",{className:"relative w-full h-full bg-gradient-to-br from-slate-50 to-slate-100",ref:a,children:[r&&i.jsxs("div",{className:"absolute top-4 left-4 z-20 flex flex-col gap-3",children:[i.jsxs("div",{className:"bg-white/90 backdrop-blur-md border border-slate-200 rounded-xl shadow-xl p-3 min-w-[280px]",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),i.jsx("input",{type:"text",placeholder:"Search employees...",value:P,onChange:re=>M(re.target.value),className:"w-full pl-10 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),P&&i.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:[n.filter(re=>re.name.toLowerCase().includes(P.toLowerCase())).length," results"]})]}),i.jsxs("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 rounded-2xl shadow-lg p-3 flex flex-col gap-3 min-w-[240px]",children:[i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsx("button",{onClick:ie,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Zoom Out",children:i.jsx(AC,{className:"w-5 h-5"})}),i.jsx("div",{className:"flex-1 px-2",children:i.jsx("input",{type:"range",min:"40",max:"250",value:Math.round(O*100),onChange:re=>D(parseInt(re.target.value)/100),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-indigo-500 [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-md [&::-webkit-slider-thumb]:transition-transform [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-indigo-500 [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:border-0 [&::-moz-range-thumb]:shadow-md",title:"Zoom Slider"})}),i.jsx("button",{onClick:ue,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Zoom In",children:i.jsx(IC,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"px-2 min-w-[60px] text-center font-semibold text-slate-700 text-sm tabular-nums bg-slate-100 rounded-lg py-1",children:[Math.round(O*100),"%"]}),i.jsx("div",{className:"w-px h-6 bg-slate-200"}),i.jsx("button",{onClick:pe,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Reset View",children:i.jsx(AN,{className:"w-5 h-5"})})]})]})]}),i.jsx("canvas",{ref:s,className:"w-full h-full cursor-grab active:cursor-grabbing",onMouseDown:te,onMouseMove:H,onMouseUp:ae,onMouseLeave:ae,onClick:le}),o&&o.x!==void 0&&o.y!==void 0&&i.jsx("div",{className:"absolute pointer-events-none z-10 transform -translate-x-1/2 transition-all duration-200",style:{left:`${o.x*O+j.x+90*O}px`,top:`${Math.max(10,o.y*O+j.y-10)}px`},children:i.jsx("div",{className:"bg-white/95 backdrop-blur-xl border border-indigo-200 rounded-2xl shadow-2xl p-5 min-w-[320px] animate-fade-in-scale",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsxs("div",{className:"flex-shrink-0 relative",children:[o.photoUrl?i.jsx("img",{src:o.photoUrl,alt:o.name,className:"w-20 h-20 rounded-2xl object-cover border-3 border-indigo-500 shadow-lg"}):i.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-indigo-600 flex items-center justify-center text-white font-bold text-2xl border-3 border-white shadow-lg",children:o.name.split(" ").map(re=>re[0]).join("").substring(0,2).toUpperCase()}),o.level!==void 0&&o.level>0&&i.jsxs("div",{className:"absolute -bottom-2 -right-2 bg-emerald-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg",children:["L",o.level]})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-slate-900 text-xl mb-1 truncate",children:o.name}),i.jsx("p",{className:"text-sm text-indigo-600 font-medium capitalize mb-3 truncate",children:o.role.replace(/_/g," ")}),i.jsxs("div",{className:"space-y-2",children:[o.email&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(Gf,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{className:"truncate",children:o.email})]}),o.phone&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(Lf,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{children:o.phone})]}),o.managerName&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(Qi,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsxs("span",{className:"truncate",children:["Reports to: ",i.jsx("strong",{children:o.managerName})]})]})]}),i.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200",children:i.jsxs("p",{className:"text-xs text-slate-500 italic",children:["Click to ",c?.id===o.id?"deselect":"select and focus"]})})]})]})})}),r&&i.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-white/90 backdrop-blur-md px-6 py-3 rounded-full border border-slate-200 shadow-xl",children:i.jsxs("p",{className:"text-sm text-slate-700 font-medium flex items-center gap-3",children:[i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),"Drag to pan"]}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Hover for details"}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Click to select"})]})}),r&&i.jsxs("div",{className:"absolute top-4 right-4 bg-white/90 backdrop-blur-md border border-slate-200 rounded-2xl shadow-xl p-4 max-w-[200px]",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-900 mb-3 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),"Org Hierarchy"]}),i.jsxs("div",{className:"space-y-2.5",children:[i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded bg-gradient-to-br from-purple-500 to-indigo-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Team Member"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded bg-gradient-to-br from-emerald-400 to-emerald-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Search Match"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-8 h-0.5 bg-gradient-to-r from-indigo-400 to-purple-500 flex-shrink-0 shadow-sm"}),i.jsx("span",{children:"Reports To"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-emerald-500 text-white text-[8px] font-bold flex items-center justify-center flex-shrink-0",children:"L2"}),i.jsx("span",{children:"Level Badge"})]})]}),c&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[i.jsx("p",{className:"text-xs font-semibold text-indigo-600 mb-1",children:"Selected:"}),i.jsx("p",{className:"text-xs text-slate-700 font-medium truncate",children:c.name})]})]}),i.jsxs("div",{className:"absolute bottom-6 right-6 bg-slate-900/80 backdrop-blur-sm text-white text-xs px-3 py-2 rounded-full font-mono",children:[n.length," employees"]})]})},Uce=({users:n})=>{const[e,t]=E.useState(!1),[r,s]=E.useState(""),[a,o]=E.useState(null),[l,c]=E.useState(!0),d=()=>{s(""),o(null),setTimeout(()=>{},100)},h=()=>o(v=>Math.min((v??80)+10,250)),p=()=>o(v=>Math.max((v??80)-10,40)),x=i.jsxs("div",{className:`flex flex-col ${e?"h-screen":"h-[75vh] min-h-[500px]"}`,children:[i.jsx("div",{className:"flex-shrink-0 bg-white border-b border-slate-200 px-4 py-3",children:i.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3",children:[i.jsxs("div",{className:"relative flex-shrink-0 w-full md:w-64",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),i.jsx("input",{type:"text",placeholder:"Search employees...",value:r,onChange:v=>s(v.target.value),className:"w-full pl-10 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),i.jsx("div",{className:"flex-1"}),i.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 rounded-lg px-3 py-2 border border-slate-200",children:[i.jsx("button",{onClick:p,className:"p-1.5 hover:bg-slate-200/60 rounded-md transition-colors text-slate-600 hover:text-slate-900",title:"Zoom Out",children:i.jsx(AC,{className:"w-4 h-4"})}),i.jsx("input",{type:"range",min:"40",max:"250",value:a??80,disabled:a===null,onChange:v=>o(parseInt(v.target.value)),className:"w-24 h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-primary [&::-webkit-slider-thumb]:cursor-pointer [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-primary [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:border-0"}),i.jsx("span",{className:"text-xs font-semibold text-slate-700 min-w-[45px] text-center",children:a?`${a}%`:"Auto"}),i.jsx("button",{onClick:h,className:"p-1.5 hover:bg-slate-200/60 rounded-md transition-colors text-slate-600 hover:text-slate-900",title:"Zoom In",children:i.jsx(IC,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:d,className:"px-3 py-2 text-sm font-medium text-slate-700 hover:text-slate-900 bg-slate-50 hover:bg-slate-100 border border-slate-200 rounded-lg transition-colors flex items-center gap-2",children:[i.jsx(AN,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Reset"})]}),i.jsxs("button",{onClick:()=>t(!e),className:"px-3 py-2 text-sm font-medium text-white bg-primary hover:bg-primary/90 rounded-lg transition-colors flex items-center gap-2",children:[e?i.jsx(OJ,{className:"w-4 h-4"}):i.jsx(AN,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:e?"Exit":"Full Screen"})]})]})]})}),i.jsxs("div",{className:"flex-1 bg-slate-50 relative overflow-hidden",children:[i.jsx(Q6,{users:n,externalSearchQuery:r,externalZoom:a!==null?a/100:void 0,showControls:!1}),i.jsx("div",{className:`absolute bottom-4 right-4 z-20 ${l?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"bg-white/95 backdrop-blur-sm border border-slate-200 rounded-xl shadow-lg px-4 py-3 min-w-[200px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h4",{className:"text-xs font-bold text-slate-900 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),"Legend"]}),i.jsx("button",{onClick:()=>c(!l),className:"md:hidden text-slate-400 hover:text-slate-600",children:i.jsx(du,{className:"w-3 h-3"})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-purple-500 to-indigo-600 border border-white shadow-sm flex-shrink-0"}),i.jsx("span",{children:"Team Member"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-emerald-400 to-emerald-600 border border-white shadow-sm flex-shrink-0"}),i.jsx("span",{children:"Search Match"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-6 h-0.5 bg-gradient-to-r from-indigo-400 to-purple-500 flex-shrink-0 shadow-sm"}),i.jsx("span",{children:"Reports To"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded-full bg-emerald-500 text-white text-[8px] font-bold flex items-center justify-center flex-shrink-0",children:"L2"}),i.jsx("span",{children:"Level Badge"})]})]})]})}),i.jsx("button",{onClick:()=>c(!l),className:"md:hidden absolute bottom-4 right-4 z-30 bg-white border border-slate-200 rounded-full p-2 shadow-lg",children:i.jsx(du,{className:"w-5 h-5 text-slate-600"})})]}),r&&i.jsx("div",{className:"flex-shrink-0 bg-white border-t border-slate-200 px-4 py-2",children:i.jsxs("p",{className:"text-xs text-slate-600",children:[n.filter(v=>v.name.toLowerCase().includes(r.toLowerCase())).length," results found"]})})]});return e?i.jsx("div",{className:"fixed inset-0 z-50 bg-white",children:x}):i.jsx("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:x})},Bce=()=>{Nt();const[n,e]=E.useState([]),[t,r]=E.useState([]),[s,a]=E.useState("hr"),[o,l]=E.useState(!0),[c,d]=E.useState(!1),[h,p]=E.useState(null),[x,v]=E.useState("table"),b=E.useCallback(async()=>{l(!0);try{const[C,P,O]=await Promise.all([ce.getUsersWithManagers(),ce.getApprovalWorkflowSettings(),ce.getRoles()]);e(C),a(P.finalConfirmationRole),r(O.filter(M=>["admin","hr","operation_manager"].includes(M.id)))}catch{p({message:"Failed to load workflow data.",type:"error"})}finally{l(!1)}},[]);E.useEffect(()=>{b()},[b]);const _=(C,P)=>{e(O=>O.map(M=>M.id===C?{...M,reportingManagerId:P||void 0}:M))},j=async()=>{d(!0);try{await Promise.all(n.map(C=>ce.updateUserReportingManager(C.id,C.reportingManagerId||null))),await ce.updateApprovalWorkflowSettings(s),p({message:"Workflow saved successfully!",type:"success"}),b()}catch{p({message:"Failed to save workflow.",type:"error"})}finally{d(!1)}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(ra,{title:"Leave Approval Settings",children:i.jsxs(ne,{onClick:j,isLoading:c,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Workflow"]})}),i.jsxs("section",{className:"mb-8",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text mb-2",children:"Final Confirmation Step"}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Select the role responsible for the final confirmation of a leave request after it has been approved by the reporting manager chain."}),i.jsx("div",{className:"max-w-xs",children:i.jsx(Ze,{label:"Final Confirmation Role",id:"final-approver",value:s,onChange:C=>a(C.target.value),children:t.map(C=>i.jsx("option",{value:C.id,children:C.displayName},C.id))})})]}),i.jsxs("section",{children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-1",children:"Reporting Structure"}),i.jsx("p",{className:"text-sm text-muted",children:"View and manage organizational hierarchy"})]})}),i.jsx("div",{className:"border-b border-border mb-6",children:i.jsxs("div",{className:"flex gap-1 overflow-x-auto",children:[i.jsxs("button",{onClick:()=>v("table"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="table"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(WJ,{className:"w-4 h-4"}),"Table View"]}),i.jsxs("button",{onClick:()=>v("2d"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="2d"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(RJ,{className:"w-4 h-4"}),"2D Workflow Chart"]})]})}),o?i.jsx("div",{className:"flex justify-center items-center py-10",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted"})}):i.jsxs(i.Fragment,{children:[x==="table"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-muted mb-4",children:"For each employee, assign a reporting manager. Leave requests will be sent to this manager for first-level approval."}),i.jsx("div",{className:"overflow-x-auto hidden md:block border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase w-1/2",children:"Reporting Manager"})]})}),i.jsx("tbody",{className:"bg-card divide-y divide-border",children:n.map(C=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 font-medium text-primary-text",children:C.name}),i.jsx("td",{className:"px-6 py-4 text-sm text-muted capitalize",children:t.find(P=>P.id===C.role)?.displayName||C.role.replace(/_/g," ")}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs(Ze,{label:"",id:`manager-for-desktop-${C.id}`,value:C.reportingManagerId||"",onChange:P=>_(C.id,P.target.value),className:"w-full",children:[i.jsx("option",{value:"",children:"None (Reports to Final Approver)"}),n.filter(P=>P.id!==C.id).map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})})]},C.id))})]})}),i.jsx("div",{className:"space-y-3 md:hidden",children:n.map(C=>i.jsxs("div",{className:"bg-card rounded-lg border border-border overflow-hidden",children:[i.jsxs("div",{className:"p-3",children:[i.jsx("p",{className:"font-semibold text-primary-text",children:C.name}),i.jsx("p",{className:"text-sm text-muted capitalize",children:t.find(P=>P.id===C.role)?.displayName||C.role.replace(/_/g," ")})]}),i.jsxs("div",{className:"p-3 border-t border-border",children:[i.jsx("label",{className:"text-sm text-muted block mb-1",children:"Manager"}),i.jsxs(Ze,{id:`manager-for-mobile-${C.id}`,value:C.reportingManagerId||"",onChange:P=>_(C.id,P.target.value),children:[i.jsx("option",{value:"",children:"None"}),n.filter(P=>P.id!==C.id).map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})]})]},C.id))})]}),x==="2d"&&i.jsx(Uce,{users:n})]})]})]})},Vce=()=>{const n=Nt(),[e,t]=E.useState([]),[r,s]=E.useState(!0);E.useEffect(()=>{(async()=>{try{const l=await ce.getUsersWithManagers();t(l)}catch(l){console.error("Failed to load users",l)}finally{s(!1)}})()},[]);const a=()=>{n("/admin/approval-workflow")};return r?i.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-slate-50",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-primary"})}):i.jsxs("div",{className:"w-screen h-screen relative bg-slate-50 overflow-hidden",children:[i.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-50 p-3 bg-white rounded-full shadow-xl hover:bg-gray-50 transition-all duration-200 border border-gray-200 group",title:"Close Full Screen",children:i.jsx(wi,{className:"h-6 w-6 text-gray-600 group-hover:text-red-500 transition-colors"})}),i.jsx(Q6,{users:e})]})},S1=ea(n=>({tasks:[],isLoading:!1,error:null,fetchTasks:async()=>{n({isLoading:!0,error:null});try{const e=await ce.getTasks();n({tasks:e,isLoading:!1})}catch{n({error:"Failed to fetch tasks.",isLoading:!1})}},createTask:async e=>{try{const t=await ce.createTask(e);n(r=>({tasks:[t,...r.tasks]}))}catch(t){throw console.error("Failed to create task",t),new Error("Failed to create task.")}},updateTask:async(e,t)=>{try{const r=await ce.updateTask(e,t);n(s=>({tasks:s.tasks.map(a=>a.id===e?r:a)}))}catch(r){throw console.error("Failed to update task",r),new Error("Failed to update task.")}},deleteTask:async e=>{try{await ce.deleteTask(e),n(t=>({tasks:t.tasks.filter(r=>r.id!==e)}))}catch(t){throw console.error("Failed to delete task",t),new Error("Failed to delete task.")}},runAutomaticEscalations:async()=>{try{const{updatedTasks:e,newNotifications:t}=await ce.runAutomaticEscalations();if(e.length>0&&n(r=>({tasks:r.tasks.map(s=>e.find(a=>a.id===s.id)||s)})),t.length>0){const r=t.map(s=>ce.createNotification(s));await Promise.all(r),uy.getState().fetchNotifications()}}catch(e){console.error("Failed to run automatic escalations",e)}}})),Wce=Pt({completionNotes:ye().required("Completion notes are required").min(10,"Please provide more detail."),completionPhoto:Vt().required("A photo proof of completion is required.").nullable()}).defined(),$ce=({isOpen:n,onClose:e,task:t,setToast:r})=>{const{updateTask:s}=S1(),[a,o]=ot.useState(!1),{handleSubmit:l,formState:{errors:c},reset:d,control:h}=tn({resolver:On(Wce),defaultValues:{completionNotes:"",completionPhoto:null}}),p=async x=>{o(!0);try{await s(t.id,{...x,status:"Done"}),r({message:"Task completed successfully!",type:"success"}),e()}catch{r({message:"Failed to complete task.",type:"error"})}finally{o(!1)}};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:x=>x.stopPropagation(),children:i.jsxs("form",{onSubmit:l(p),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Complete Task: ",t.name]}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Provide a summary and photo proof of your work."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"completionNotes",className:"block text-sm font-medium text-muted",children:"Completion Notes"}),i.jsx("textarea",{id:"completionNotes",rows:4,...h.register("completionNotes"),className:`mt-1 bg-card border ${c.completionNotes?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`}),c.completionNotes&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionNotes.message})]}),i.jsx(_e,{name:"completionPhoto",control:h,render:({field:x})=>i.jsx(vt,{label:"Upload Photo Proof",file:x.value,onFileChange:x.onChange,allowedTypes:["image/jpeg","image/png"]})}),c.completionPhoto&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionPhoto.message})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ne,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:a,children:"Mark as Done"})]})]})})}):null},Hce=n=>{const e=new Date;e.setHours(0,0,0,0);const t=o=>o?new Date(o):null;if(n.status==="Done"||!n.dueDate)return{date:n.dueDate?We(t(n.dueDate),"dd MMM, yyyy"):"-",isOverdue:!1};let r=null;const s=t(n.dueDate);switch(n.escalationStatus){case"None":r=n.escalationLevel1DurationDays?vl(s,n.escalationLevel1DurationDays):s;break;case"Level 1":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays){const o=vl(s,n.escalationLevel1DurationDays);r=vl(o,n.escalationLevel2DurationDays)}break;case"Level 2":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays&&n.escalationEmailDurationDays){const o=vl(s,n.escalationLevel1DurationDays),l=vl(o,n.escalationLevel2DurationDays);r=vl(l,n.escalationEmailDurationDays)}break}r||(r=s);const a=r?r<e:!1;return{date:We(r,"dd MMM, yyyy"),isOverdue:a}},Yce=()=>{const n=Nt(),{user:e}=jt(),{tasks:t,isLoading:r,error:s,fetchTasks:a,deleteTask:o,runAutomaticEscalations:l}=S1(),{theme:c}=td(),{colorScheme:d}=on(),h=qa(d),p=c==="dark"||h.isDark,x="!text-white",v={backgroundColor:h.primary},b="text-white transition-colors",_={backgroundColor:h.activeItemBg},[j,C]=E.useState(!1),[P,O]=E.useState(!1),[M,D]=E.useState(null),[I,F]=E.useState(null),[q,U]=E.useState([]),[B,W]=E.useState("all"),[Y,G]=E.useState("all"),[Z,oe]=E.useState("all"),X=At("(max-width: 767px)");E.useEffect(()=>{(async()=>{ce.getUsers().then(U),await a(),await l()})()},[a,l]);const he=()=>{n("/tasks/add")},$=de=>{n(`/tasks/edit/${de.id}`)},K=de=>{D(de),C(!0)},te=de=>{D(de),O(!0)},H=async()=>{if(M)try{await o(M.id),F({message:"Task deleted.",type:"success"}),O(!1)}catch{F({message:"Failed to delete task.",type:"error"})}},ae=E.useMemo(()=>t.filter(de=>{if(B!=="all"&&de.status!==B||Y!=="all"&&de.priority!==Y)return!1;if(Z==="unassigned"){if(de.assignedToId)return!1}else if(Z!=="all"&&de.assignedToId!==Z)return!1;return!0}),[t,B,Y,Z]),le=()=>{W("all"),G("all"),oe("all")},ue=B!=="all"||Y!=="all"||Z!=="all",ie=de=>{const je={High:p?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800",Medium:p?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800",Low:p?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${je[de]}`,children:de})},pe=de=>{const je={"To Do":p?"bg-gray-500/20 text-gray-300":"bg-gray-100 text-gray-800","In Progress":p?"bg-indigo-500/20 text-indigo-300":"bg-indigo-100 text-indigo-800",Done:p?"bg-green-500/20 text-green-300":"bg-green-100 text-green-800"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${je[de]}`,children:de})},re=de=>{if(de==="None")return null;const je={None:"","Level 1":p?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-800","Level 2":p?"bg-amber-500/20 text-amber-400":"bg-amber-100 text-amber-800","Email Sent":p?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${je[de]}`,children:de})};return i.jsxs("div",{className:`min-h-screen p-4 pb-24 md:p-6 md:rounded-xl md:shadow-card ${!X&&!p?"md:bg-card":""} ${X||p?"border border-white/10":""}`,style:{backgroundColor:X||p?h.mobileBg:void 0,color:X||p?h.isDark?"white":"#111827":void 0},children:[I&&i.jsx(pt,{message:I.message,type:I.type,onDismiss:()=>F(null)}),j&&M&&i.jsx($ce,{isOpen:j,onClose:()=>C(!1),task:M,setToast:F}),i.jsxs(Kr,{isOpen:P,onClose:()=>O(!1),onConfirm:H,title:"Confirm Deletion",children:['Are you sure you want to delete the task "',M?.name,'"?']}),i.jsx("div",{className:"mb-6",children:i.jsx("h1",{className:`text-2xl font-bold ${X||p||h.isDark?"text-white":"text-gray-900"}`,style:{color:X||p||h.isDark?"white":"#111827"},children:"Task Management"})}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 md:items-end justify-between",children:[i.jsxs("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-medium",style:{color:X||p?"white":"#374151"},children:"Filter by Status"}),i.jsxs("select",{className:"w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500",style:{backgroundColor:X||p?h.sidebarBg:"white",borderColor:X||p?h.sidebarBorder:"#d1d5db",color:X||p?"white":"#111827"},value:B,onChange:de=>W(de.target.value),children:[i.jsx("option",{value:"all",style:{backgroundColor:h.sidebarBg},children:"All Statuses"}),i.jsx("option",{value:"To Do",style:{backgroundColor:h.sidebarBg},children:"To Do"}),i.jsx("option",{value:"In Progress",style:{backgroundColor:h.sidebarBg},children:"In Progress"}),i.jsx("option",{value:"Done",style:{backgroundColor:h.sidebarBg},children:"Done"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-medium",style:{color:X||p?"white":"#374151"},children:"Filter by Priority"}),i.jsxs("select",{className:"w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500",style:{backgroundColor:X||p?h.sidebarBg:"white",borderColor:X||p?h.sidebarBorder:"#d1d5db",color:X||p?"white":"#111827"},value:Y,onChange:de=>G(de.target.value),children:[i.jsx("option",{value:"all",style:{backgroundColor:h.sidebarBg},children:"All Priorities"}),i.jsx("option",{value:"Low",style:{backgroundColor:h.sidebarBg},children:"Low"}),i.jsx("option",{value:"Medium",style:{backgroundColor:h.sidebarBg},children:"Medium"}),i.jsx("option",{value:"High",style:{backgroundColor:h.sidebarBg},children:"High"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-medium",style:{color:X||p?"white":"#374151"},children:"Filter by Assignee"}),i.jsxs("select",{className:"w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500",style:{backgroundColor:X||p?h.sidebarBg:"white",borderColor:X||p?h.sidebarBorder:"#d1d5db",color:X||p?"white":"#111827"},value:Z,onChange:de=>oe(de.target.value),children:[i.jsx("option",{value:"all",style:{backgroundColor:h.sidebarBg},children:"All Users"}),i.jsx("option",{value:"unassigned",style:{backgroundColor:h.sidebarBg},children:"Unassigned"}),q.map(de=>i.jsx("option",{value:de.id,style:{backgroundColor:h.sidebarBg},children:de.name},de.id))]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 mt-4 md:mt-0",children:[ue&&i.jsxs(ne,{variant:"secondary",onClick:le,className:X?"!bg-card !border-border":"!text-white !border-white/10",style:!X&&p?{backgroundColor:h.sidebarBg}:{},children:[i.jsx(wi,{className:"mr-2 h-4 w-4"})," Clear Filters"]}),i.jsxs("button",{onClick:he,className:`flex items-center justify-center transition-colors ${X?x+" !font-bold !border-none shadow-none text-sm py-3 px-6 rounded-xl":b+" rounded-lg px-6 py-2.5 font-medium"}`,style:X?v:_,children:[i.jsx(Ut,{className:"mr-2 h-5 w-5"})," Add Task"]})]})]}),s&&i.jsx("p",{className:"text-red-500 mb-4",children:s}),i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:X?"hidden":"bg-transparent border-b",style:{backgroundColor:!X&&p?"rgba(255,255,255,0.05)":void 0,color:X||p?"white":"#6b7280",borderColor:X||p?"rgba(255,255,255,0.1)":"#e5e7eb"},children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Task Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Priority"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Next Due Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Assigned To"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Escalation"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:`divide-y md:divide-y-0 ${X?"space-y-4 block":""}`,style:{borderColor:X||p?"rgba(255,255,255,0.1)":"#e5e7eb"},children:r?X?i.jsx("tr",{children:i.jsx("td",{colSpan:7,children:i.jsx(Ra,{rows:3,cols:7,isMobile:!0})})}):i.jsx(Ra,{rows:5,cols:7}):ae.map(de=>{const{date:je,isOverdue:Ae}=Hce(de);return X?i.jsxs("div",{className:"p-4 rounded-xl border mb-4",style:{backgroundColor:p?"rgba(255,255,255,0.05)":"white",borderColor:p?"rgba(255,255,255,0.1)":"#e5e7eb",color:p?"white":"#111827"},children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-lg",children:de.name}),i.jsxs("p",{className:"text-sm mt-1",style:{color:p?"#9ca3af":"#6b7280"},children:["Due: ",i.jsx("span",{className:Ae?"text-red-400 font-bold":"",children:je||"-"})]})]}),ie(de.priority)]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"block text-xs",style:{color:p?"#9ca3af":"#6b7280"},children:"Assigned To"}),i.jsx("span",{className:"",children:de.assignedToName||"-"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"block text-xs",style:{color:p?"#9ca3af":"#6b7280"},children:"Status"}),i.jsx("span",{className:"",children:de.status})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 border-t pt-3",style:{borderColor:p?"rgba(255,255,255,0.1)":"#e5e7eb"},children:[i.jsx("button",{onClick:()=>$(de),className:"p-2 rounded-lg transition-colors",style:{backgroundColor:p?"rgba(255,255,255,0.05)":"#f3f4f6",color:p?"#d1d5db":"#6b7280"},children:i.jsx(ur,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>te(de),className:"p-2 rounded-lg transition-colors",style:{backgroundColor:p?"rgba(239,68,68,0.1)":"#fef2f2",color:p?"#f87171":"#dc2626"},children:i.jsx(sn,{className:"h-4 w-4"})}),de.assignedToId===e?.id&&de.status!=="Done"&&i.jsxs("button",{onClick:()=>K(de),className:"flex items-center px-3 py-2 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:h.primary+"20",color:h.primary},children:[i.jsx(Ji,{className:"h-4 w-4 mr-1.5"})," Complete"]})]})]},de.id):i.jsxs("tr",{className:`${Ae?"bg-red-50":"hover:bg-black/5"} transition-colors`,style:!Ae&&p?{backgroundColor:"transparent"}:{},children:[i.jsx("td",{"data-label":"Task Name",className:"px-6 py-4 font-medium",style:{color:p?"white":"#111827"},children:de.name}),i.jsx("td",{"data-label":"Priority",className:"px-6 py-4",children:ie(de.priority)}),i.jsx("td",{"data-label":"Next Due Date",className:`px-6 py-4 text-sm ${Ae?"font-bold text-red-600":""}`,style:{color:Ae?void 0:p?"#9ca3af":"#6b7280"},children:je||"-"}),i.jsx("td",{"data-label":"Assigned To",className:"px-6 py-4 text-sm",style:{color:p?"#9ca3af":"#6b7280"},children:de.assignedToName||"-"}),i.jsx("td",{"data-label":"Status",className:"px-6 py-4 text-sm",style:{color:p?"#9ca3af":"#6b7280"},children:pe(de.status)}),i.jsx("td",{"data-label":"Escalation",className:"px-6 py-4 text-sm",style:{color:p?"#9ca3af":"#6b7280"},children:re(de.escalationStatus)}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>$(de),title:"Edit Task",children:i.jsx(ur,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>te(de),title:"Delete Task",children:i.jsx(sn,{className:"h-4 w-4 text-red-600"})}),de.assignedToId===e?.id&&de.status!=="Done"&&i.jsxs(ne,{variant:"outline",size:"sm",onClick:()=>K(de),style:{borderColor:h.primary,color:h.primary},children:[i.jsx(Ji,{className:"h-4 w-4 mr-2"})," Complete"]})]})})]},de.id)})})]}),!r&&ae.length===0&&i.jsxs("div",{className:"text-center py-10 text-muted",children:[i.jsx("p",{className:X||p?"text-gray-400":"",children:"No tasks found matching your criteria."}),ue&&i.jsx(ne,{variant:"secondary",size:"sm",className:"mt-2",onClick:le,children:"Clear filters"})]})]})]})},Gce=Pt({id:ye().required(),name:ye().required("Client name is required"),organizationId:ye().optional(),location:ye().optional(),registeredAddress:ye().optional(),registrationType:ye().oneOf(["CIN","ROC","ROF","Society","Trust",""]).optional(),registrationNumber:ye().optional(),gstNumber:ye().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,"Invalid GST Number format").optional(),panNumber:ye().transform(n=>n?.toUpperCase()||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,"Invalid PAN format").optional(),email:ye().email("Invalid email format").optional(),eShramNumber:ye().optional(),shopAndEstablishmentCode:ye().optional(),epfoCode:ye().optional(),esicCode:ye().optional(),psaraLicenseNumber:ye().optional(),psaraValidTill:ye().optional().nullable(),insuranceIds:_s().of(ye().required()).optional(),policyIds:_s().of(ye().required()).optional()}).defined(),Zce=({isOpen:n,onClose:e,onSave:t,initialData:r,companyName:s})=>{const[a,o]=E.useState("General"),[l,c]=E.useState([]),[d,h]=E.useState([]),[p,x]=E.useState(!0),{register:v,handleSubmit:b,formState:{errors:_},reset:j,control:C}=tn({resolver:On(Gce)}),P=!!r;E.useEffect(()=>{n&&(x(!0),Promise.all([ce.getPolicies(),ce.getInsurances()]).then(([D,I])=>{c(D),h(I),x(!1)}),j(r||{id:`new_${Date.now()}`,name:"",location:"",registeredAddress:"",registrationType:"",registrationNumber:"",gstNumber:"",panNumber:"",email:"",eShramNumber:"",shopAndEstablishmentCode:"",epfoCode:"",esicCode:"",psaraLicenseNumber:"",psaraValidTill:"",insuranceIds:[],policyIds:[]}))},[r,j,n]);const O=D=>{t(D)};if(!n)return null;const M=({tabName:D})=>i.jsx("button",{type:"button",onClick:()=>o(D),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${a===D?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:D});return i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-3xl my-8 mx-auto animate-fade-in-scale",onClick:D=>D.stopPropagation(),children:i.jsxs("form",{onSubmit:b(O),children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:P?"Edit Client":"Add New Client"}),i.jsxs("p",{className:"text-sm text-muted",children:["for ",s]})]}),i.jsx("div",{className:"border-b border-border mb-6",children:i.jsxs("nav",{className:"-mb-px flex space-x-4",children:[i.jsx(M,{tabName:"General"}),i.jsx(M,{tabName:"Registration"}),i.jsx(M,{tabName:"Compliance"}),i.jsx(M,{tabName:"Policies & Insurance"})]})}),i.jsxs("div",{className:"space-y-6 min-h-[300px]",children:[a==="General"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(we,{label:"Client Name (as per document)",id:"name",registration:v("name"),error:_.name?.message}),i.jsx(we,{label:"Location / City",id:"location",registration:v("location"),error:_.location?.message}),i.jsx(we,{label:"Registered Address",id:"registeredAddress",registration:v("registeredAddress"),error:_.registeredAddress?.message})]}),a==="Registration"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsxs(Ze,{label:"Registration Type",id:"registrationType",registration:v("registrationType"),error:_.registrationType?.message,children:[i.jsx("option",{value:"",children:"Select Type"}),i.jsx("option",{value:"CIN",children:"CIN"}),i.jsx("option",{value:"ROC",children:"ROC"}),i.jsx("option",{value:"ROF",children:"ROF"}),i.jsx("option",{value:"Society",children:"Society"}),i.jsx("option",{value:"Trust",children:"Trust"})]}),i.jsx(we,{label:"Registration Number",id:"registrationNumber",registration:v("registrationNumber"),error:_.registrationNumber?.message}),i.jsx(we,{label:"GST Number",id:"gstNumber",registration:v("gstNumber"),error:_.gstNumber?.message}),i.jsx(we,{label:"PAN Number",id:"panNumber",registration:v("panNumber"),error:_.panNumber?.message}),i.jsx(we,{label:"Email Address",id:"email",type:"email",registration:v("email"),error:_.email?.message})]}),a==="Compliance"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(we,{label:"E-Shram Number",id:"eShramNumber",registration:v("eShramNumber"),error:_.eShramNumber?.message}),i.jsx(we,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:v("shopAndEstablishmentCode"),error:_.shopAndEstablishmentCode?.message}),i.jsx(we,{label:"EPFO Code",id:"epfoCode",registration:v("epfoCode"),error:_.epfoCode?.message}),i.jsx(we,{label:"ESIC Code",id:"esicCode",registration:v("esicCode"),error:_.esicCode?.message}),i.jsx(we,{label:"PSARA License Number",id:"psaraLicenseNumber",registration:v("psaraLicenseNumber"),error:_.psaraLicenseNumber?.message}),i.jsx(_e,{name:"psaraValidTill",control:C,render:({field:D})=>i.jsx(En,{label:"PSARA Valid Till",id:"psaraValidTill",value:D.value,onChange:D.onChange,error:_.psaraValidTill?.message})})]}),a==="Policies & Insurance"&&(p?i.jsx(_t,{className:"mx-auto h-6 w-6 animate-spin text-muted"}):i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsx(_e,{name:"policyIds",control:C,render:({field:D})=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Policies"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:l.map(I=>i.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:D.value?.includes(I.id),onChange:F=>{const q=F.target.checked?[...D.value||[],I.id]:(D.value||[]).filter(U=>U!==I.id);D.onChange(q)}}),i.jsx("span",{className:"ml-3 text-sm",children:I.name})]},I.id))})]})}),i.jsx(_e,{name:"insuranceIds",control:C,render:({field:D})=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Insurance"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:d.map(I=>i.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:D.value?.includes(I.id),onChange:F=>{const q=F.target.checked?[...D.value||[],I.id]:(D.value||[]).filter(U=>U!==I.id);D.onChange(q)}}),i.jsxs("span",{className:"ml-3 text-sm",children:[I.type," - ",I.provider]})]},I.id))})]})})]}))]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[i.jsx(ne,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ne,{type:"submit",children:P?"Save Changes":"Add Client"})]})]})})})},ex=({number:n,title:e,children:t})=>i.jsxs("div",{children:[i.jsxs("h4",{className:"font-bold text-lg text-primary-text mb-2",children:["Step ",n,": ",e]}),i.jsx("div",{className:"text-sm text-muted space-y-2",children:t})]}),Kce=({isOpen:n,onClose:e})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-3xl my-8 animate-fade-in-scale flex flex-col",onClick:t=>t.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex items-center gap-3",children:[i.jsx(ds,{className:"h-6 w-6 text-accent"}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"How to Use Import Templates"})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[70vh]",children:[i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(Aa,{className:"h-5 w-5 text-red-500 mr-3 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-red-800",children:"The Golden Rule: Do Not Modify the Template Structure"}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:"You must **NEVER** add, delete, rename, or reorder columns. Any changes to the header row will cause the import to fail. This rule ensures data integrity."})]})]})}),i.jsxs(ex,{number:1,title:"Get the Template",children:[i.jsx("p",{children:"You have two options for getting a file to work with:"}),i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(ds,{className:"h-4 w-4"})," Download Template:"]}),i.jsx("span",{children:"Provides a blank CSV file with only the correct header row. Use this for adding **new** records in bulk."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(a3,{className:"h-4 w-4"})," Export Data:"]}),i.jsx("span",{children:"Provides a CSV file filled with all the current data from the system. Use this for **updating existing** records in bulk."})]})]})]}),i.jsx(ex,{number:2,title:"Edit Your Data",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(ur,{className:"h-4 w-4"})," To Update Existing Data:"]}),i.jsx("span",{children:"Use the file from **Export Data**. Find the row you want to change and edit its values. Do **NOT** edit the ID columns (e.g., `GroupId`, `EntityId`). These are used by the system to identify records."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(Ut,{className:"h-4 w-4"})," To Add New Data:"]}),i.jsx("span",{children:"Add a new row at the bottom of the file. Leave the ID columns blank; the system will generate them automatically. Fill in all other required information."})]}),i.jsxs("li",{children:[i.jsx("strong",{className:"text-primary-text",children:"Complex Data (JSON):"}),i.jsx("span",{children:"For Site Configuration, some columns like `agreementDetails` contain complex data. This is exported as a JSON text string. Only edit this text if you are familiar with JSON, as incorrect formatting will cause the import to fail."})]})]})}),i.jsx(ex,{number:3,title:"Save and Import",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsx("strong",{className:"text-primary-text",children:"Save as CSV:"}),i.jsx("span",{children:"After making your changes, save your file. If you are using Excel or Google Sheets, make sure to **Save As** or **Download As** a **CSV (Comma-Separated Values)** file."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(jJ,{className:"h-4 w-4"})," Import:"]}),i.jsx("span",{children:"Go back to the application, click **Import**, and select the CSV file you just saved."})]})]})}),i.jsx(ex,{number:4,title:"Review Feedback",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-green-600 flex items-center gap-2",children:[i.jsx(Ji,{className:"h-4 w-4"})," Success:"]}),i.jsx("span",{children:"You will see a success message indicating how many records were imported."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-red-600 flex items-center gap-2",children:[i.jsx(Aa,{className:"h-4 w-4"})," Error:"]}),i.jsx("span",{children:'If the import fails, a specific error message will appear. The most common error is a "Header mismatch," which means you have violated the Golden Rule. If this happens, download a fresh template and carefully copy your data into it.'})]})]})})]}),i.jsx("div",{className:"p-4 border-t flex justify-end",children:i.jsx(ne,{onClick:e,children:"Close"})})]})}):null,fd=({title:n})=>i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8 bg-page rounded-lg min-h-[400px]",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text mb-2",children:n}),i.jsx("p",{className:"text-muted max-w-sm",children:"Configuration for this section will be available here. The form details will be provided in a future update."})]}),WL=["Site Name","Designation","Quantity","Billing Rate","Billing Model","Holiday Billing Policy","Holiday Payment Policy","Uniform Deduction"],Jce=n=>{if(n.length===0)return"";const e=Object.keys(n[0]);return[e.join(","),...n.map(r=>e.map(s=>{const a=String(r[s]??"");return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(","))].join(`
`)},Qce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim()),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'""')),a[l]=d}),r.push(a)}return r},Xce=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState({}),[c,d]=E.useState(null),h=E.useRef(null),{register:p,control:x,handleSubmit:v,watch:b,setValue:_}=tn({defaultValues:{resources:[],serviceChargePercentage:10}}),{fields:j,append:C,remove:P,replace:O}=js({control:x,name:"resources"});E.useEffect(()=>{ce.getOrganizations().then(e).finally(()=>r(!1))},[]);const M=async oe=>{if(!oe){O([]);return}a(!0);try{const X=await ce.getManpowerDetails(oe),he=X.filter($=>$.count>0).map($=>({id:`res_${$.designation.replace(/\s/g,"_")}_${Date.now()}`,siteId:oe,designation:$.designation,quantity:$.count,billingRate:null,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"}));if(!o[oe]){const $=X.map(K=>K.designation);l(K=>({...K,[oe]:$}))}O(he)}catch(X){console.error("Failed to load manpower",X),d({message:"Failed to load manpower details.",type:"error"})}finally{a(!1)}},D=async(oe,X)=>{if(_(`resources.${X}.designation`,""),oe&&!o[oe])try{const $=(await ce.getManpowerDetails(oe)).map(K=>K.designation);l(K=>({...K,[oe]:$}))}catch(he){console.error(`Failed to load designations for site ${oe}`,he)}},I=b("resources"),F=b("serviceChargePercentage"),q=()=>{C({id:`res_${Date.now()}`,siteId:"",designation:"",quantity:1,billingRate:0,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"})},{subTotal:U,serviceCharge:B,grandTotal:W}=ot.useMemo(()=>{const X=(Array.isArray(I)?I:[]).reduce((te,H)=>{const ae=Number(H.quantity)||0,le=Number(H.billingRate)||0;return te+ae*le},0),he=Number(F)||0,$=X*(he/100),K=X+$;return{subTotal:X,serviceCharge:$,grandTotal:K}},[I,F]),Y=()=>{const oe=[Object.fromEntries(WL.map(K=>[K,""]))],X=Jce(oe),he=new Blob([X],{type:"text/csv;charset=utf-8;"}),$=document.createElement("a");$.href=URL.createObjectURL(he),$.setAttribute("download","costing_resource_template.csv"),document.body.appendChild($),$.click(),document.body.removeChild($)},G=oe=>{const X=oe.target.files?.[0];if(!X)return;const he=new FileReader;he.onload=async $=>{try{const K=$.target?.result;if(!K)throw new Error("File is empty.");const te=Qce(K);if(te.length===0)throw new Error("No data rows found in CSV.");const H=Object.keys(te[0]);if(!WL.every(re=>H.includes(re)))throw new Error("CSV file is missing required headers.");const le=new Map(n.map(re=>[re.shortName.toLowerCase(),re.id])),ue=new Set;for(const re of te){const de=re["Site Name"]?.trim().toLowerCase();if(de){const je=le.get(de);typeof je=="string"&&ue.add(je)}}const ie=[...ue].filter(re=>!o[re]);if(ie.length>0){const re=ie.map(je=>ce.getManpowerDetails(je).then(Ae=>({siteId:je,designations:Ae.map(Te=>Te.designation)}))),de=await Promise.all(re);l(je=>{const Ae={...je};return de.forEach(Te=>{Ae[Te.siteId]=Te.designations}),Ae})}const pe=te.map(re=>{const de=re["Site Name"]?.trim().toLowerCase(),je=de?le.get(de):void 0;return je?{id:`res_imported_${Date.now()}_${Math.random()}`,siteId:je,designation:re.Designation||"",quantity:parseFloat(re.Quantity)||0,billingRate:parseFloat(re["Billing Rate"])||0,billingModel:re["Billing Model"]||"Per Month",holidayBillingPolicy:re["Holiday Billing Policy"]||"",holidayPaymentPolicy:re["Holiday Payment Policy"]||"",uniformDeduction:re["Uniform Deduction"]||"Yes"}:null}).filter(re=>re!==null);O(pe),d({message:`Successfully imported ${pe.length} resources.`,type:"success"})}catch(K){d({message:K.message||"Failed to import CSV.",type:"error"})}finally{oe.target&&(oe.target.value="")}},he.readAsText(X)},Z=oe=>{console.log("Saving Costing & Resource Data:",oe),d({message:"Configuration saved successfully (mocked).",type:"success"})};return i.jsxs("form",{onSubmit:v(Z),className:"space-y-6",children:[c&&i.jsx(pt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsx("input",{type:"file",ref:h,className:"hidden",accept:".csv",onChange:G}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Costing & Resource Configuration"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsxs(Ze,{label:"Load Manpower from Site",id:"site-selector",onChange:oe=>M(oe.target.value),disabled:t||s,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),n.map(oe=>i.jsx("option",{value:oe.id,children:oe.shortName},oe.id))]}),s&&i.jsx(_t,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 md:flex md:flex-wrap md:justify-end md:gap-2",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:Y,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Download Template",children:[i.jsx(_i,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Template"})]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>h.current?.click(),className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Import",children:[i.jsx(Yc,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Import"})]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:q,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Add Resource",children:[i.jsx(Ut,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Add Resource"})]}),i.jsxs(ne,{type:"submit",className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Save",children:[i.jsx(Ns,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Save"})]})]}),i.jsx("div",{className:"space-y-4",children:j.map((oe,X)=>{const he=b(`resources.${X}.siteId`);return i.jsxs("div",{className:"p-4 border border-border rounded-xl relative bg-page/50",children:[i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>P(X),className:"absolute top-2 right-2","aria-label":"Remove Resource",children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsx(_e,{control:x,name:`resources.${X}.siteId`,render:({field:$})=>i.jsxs(Ze,{label:"Site",id:`res-site-${X}`,...$,onChange:K=>{$.onChange(K),D(K.target.value,X)},children:[i.jsx("option",{value:"",children:"Select Site"}),n.map(K=>i.jsx("option",{value:K.id,children:K.shortName},K.id))]})}),i.jsxs(Ze,{label:"Designation",id:`res-desig-${X}`,...p(`resources.${X}.designation`),disabled:!he,children:[i.jsx("option",{value:"",children:"Select Designation"}),(o[he]||[]).map($=>i.jsx("option",{value:$,children:$},$))]}),i.jsx(we,{label:"Quantity",id:`res-qty-${X}`,type:"number",step:"0.01",...p(`resources.${X}.quantity`)}),i.jsx(we,{label:"Billing Rate",id:`res-rate-${X}`,type:"number",step:"0.01",...p(`resources.${X}.billingRate`)}),i.jsxs(Ze,{label:"Billing Model",id:`res-billing-${X}`,...p(`resources.${X}.billingModel`),children:[i.jsx("option",{children:"Per Month"}),i.jsx("option",{children:"Per Day"}),i.jsx("option",{children:"Per Hour"}),i.jsx("option",{children:"Lumpsum"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:`res-hol-bill-${X}`,className:"block text-sm font-medium text-muted",children:"Holiday Billing Policy"}),i.jsx("textarea",{id:`res-hol-bill-${X}`,...p(`resources.${X}.holidayBillingPolicy`),rows:3,className:"mt-1 form-input"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`res-hol-pay-${X}`,className:"block text-sm font-medium text-muted",children:"Holiday Payment Policy"}),i.jsx("textarea",{id:`res-hol-pay-${X}`,...p(`resources.${X}.holidayPaymentPolicy`),rows:3,className:"mt-1 form-input"})]}),i.jsxs(Ze,{label:"Uniform Deduction",id:`res-uniform-${X}`,...p(`resources.${X}.uniformDeduction`),children:[i.jsx("option",{children:"Yes"}),i.jsx("option",{children:"No"})]})]})]},oe.id)})}),j.length>0&&i.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:i.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsx("span",{className:"text-muted font-medium",children:"Sub Total"}),i.jsx("span",{className:"font-semibold text-primary-text",children:U.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-muted font-medium",children:"Service Charges"}),i.jsx("div",{className:"w-20",children:i.jsx(we,{"aria-label":"Service charge percentage",id:"service-charge-perc",type:"number",...p("serviceChargePercentage")})}),i.jsx("span",{className:"text-muted font-medium",children:"%"})]}),i.jsx("span",{className:"font-semibold text-primary-text",children:B.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),i.jsxs("div",{className:"flex justify-between items-center pt-2 mt-2 border-t-2 border-primary-text",children:[i.jsx("span",{className:"font-bold text-lg",children:"Grand Total"}),i.jsx("span",{className:"font-bold text-lg",children:W.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]})]})}),j.length===0&&i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:t?i.jsx(_t,{className:"h-5 w-5 animate-spin mx-auto"}):'Select a site to load manpower or click "Add Resource" to begin.'})]})},X6=["Department","Designation","PermanentId","TemporaryId"],ede=n=>{const e=X6.join(","),t=n.map(r=>[r.department,r.designation,r.permanentId,r.temporaryId].map(s=>{const a=String(s??"");return a.includes(",")?`"${a}"`:a}).join(","));return[e,...t].join(`
`)},tde=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim());if(!["Department","Designation","PermanentId","TemporaryId"].every(s=>t.includes(s)))throw new Error("CSV is missing required headers.");return e.slice(1).map(s=>{const a=s.split(","),o={};return t.forEach((l,c)=>{l==="Department"&&(o.department=a[c]),l==="Designation"&&(o.designation=a[c]),l==="PermanentId"&&(o.permanentId=a[c]),l==="TemporaryId"&&(o.temporaryId=a[c])}),o})},nde=()=>{const[n,e]=E.useState(!0),[t,r]=E.useState(null),s=E.useRef(null),{register:a,control:o,handleSubmit:l,reset:c,watch:d}=tn({defaultValues:{series:[]}}),{append:h,remove:p,replace:x}=js({control:o,name:"series"});E.useEffect(()=>{e(!0),ce.getBackOfficeIdSeries().then(M=>c({series:M})).catch(()=>r({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const v=d("series"),b=E.useMemo(()=>Array.isArray(v)?v.reduce((M,D,I)=>{const F=D.department||"Uncategorized";return M[F]||(M[F]=[]),M[F].push({...D,originalIndex:I}),M},{}):{},[v]),_=()=>{h({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:""})},j=async M=>{try{await ce.updateBackOfficeIdSeries(M.series),r({message:"Configuration saved successfully.",type:"success"})}catch{r({message:"Failed to save configuration.",type:"error"})}},C=()=>{if(!Array.isArray(v)||v.length===0){r({message:"No data to export.",type:"error"});return}const M=ede(v),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(D),I.setAttribute("download","back_office_id_series.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},P=()=>{const M=X6.join(","),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(D),I.setAttribute("download","id_series_template.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},O=M=>{const D=M.target.files?.[0];if(!D)return;const I=new FileReader;I.onload=F=>{try{const q=F.target?.result,B=tde(q).map(W=>({id:`imported_${Date.now()}_${Math.random()}`,department:W.department||"",designation:W.designation||"",permanentId:W.permanentId||"",temporaryId:W.temporaryId||""}));x(B),r({message:`Imported ${B.length} records.`,type:"success"})}catch(q){r({message:q.message||"Failed to import CSV.",type:"error"})}finally{M.target&&(M.target.value="")}},I.readAsText(D)};return i.jsxs("form",{onSubmit:l(j),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(pt,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:O}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Back Office Department & Emp ID Series"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:P,children:[i.jsx(ds,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Yc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:C,children:[i.jsx(_i,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(ne,{type:"submit",children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsx("div",{className:"space-y-6",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(b).length===0?i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No ID series defined. Click "Add Designation" to begin.'}):Object.entries(b).map(([M,D])=>i.jsxs("div",{className:"border border-border rounded-xl",children:[i.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:i.jsx(we,{"aria-label":`Department for ${M}`,id:`series.${D[0].originalIndex}.department`,...a(`series.${D[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),i.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(D)&&D.map(I=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-10 gap-2 items-center",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Designation","aria-label":`Designation for ${M}`,id:`series.${I.originalIndex}.designation`,...a(`series.${I.originalIndex}.designation`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${I.designation}`,id:`series.${I.originalIndex}.permanentId`,...a(`series.${I.originalIndex}.permanentId`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${I.designation}`,id:`series.${I.originalIndex}.temporaryId`,...a(`series.${I.originalIndex}.temporaryId`)})}),i.jsx("div",{className:"md:col-span-1 text-right",children:i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>p(I.originalIndex),"aria-label":`Remove ${I.designation}`,title:`Remove ${I.designation}`,children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})})})]},I.id))})]},M))}),i.jsxs(ne,{type:"button",onClick:_,variant:"outline",className:"mt-6",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},Kx=["Department","Designation","PermanentId","TemporaryId","MonthlySalary"],rde=n=>{const e=Kx.join(","),t=n.map(r=>[r.department,r.designation,r.permanentId,r.temporaryId,r.monthlySalary].map(s=>{const a=String(s??"");return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(","));return[e,...t].join(`
`)},sde=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,""));if(!Kx.every(s=>t.includes(s)))throw new Error(`CSV is missing required headers: ${Kx.join(", ")}`);const r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((c,d)=>{let h=(o[d]||"").trim();h.startsWith('"')&&h.endsWith('"')&&(h=h.substring(1,h.length-1).replace(/""/g,'""')),a[c]=h});const l=parseFloat(a.MonthlySalary);r.push({department:a.Department,designation:a.Designation,permanentId:a.PermanentId,temporaryId:a.TemporaryId,monthlySalary:isNaN(l)?null:l})}return r},ide=()=>{const[n,e]=E.useState(!0),[t,r]=E.useState(null),s=E.useRef(null),{register:a,control:o,handleSubmit:l,reset:c,watch:d}=tn({defaultValues:{designations:[]}}),{append:h,remove:p,replace:x}=js({control:o,name:"designations"});E.useEffect(()=>{e(!0),ce.getSiteStaffDesignations().then(M=>c({designations:M})).catch(()=>r({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const v=d("designations"),b=E.useMemo(()=>Array.isArray(v)?v.reduce((M,D,I)=>{const F=D.department||"Uncategorized";return M[F]||(M[F]=[]),M[F].push({...D,originalIndex:I}),M},{}):{},[v]),_=()=>{h({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:"",monthlySalary:null})},j=async M=>{try{await ce.updateSiteStaffDesignations(M.designations),r({message:"Configuration saved successfully.",type:"success"})}catch{r({message:"Failed to save configuration.",type:"error"})}},C=()=>{if(!Array.isArray(v)||v.length===0){r({message:"No data to export.",type:"error"});return}const M=rde(v),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(D),I.setAttribute("download","site_staff_designations.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},P=()=>{const M=Kx.join(","),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(D),I.setAttribute("download","site_staff_template.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},O=M=>{const D=M.target.files?.[0];if(!D)return;const I=new FileReader;I.onload=F=>{try{const q=F.target?.result,B=sde(q).map(W=>({id:`imported_${Date.now()}_${Math.random()}`,department:W.department||"",designation:W.designation||"",permanentId:W.permanentId||"",temporaryId:W.temporaryId||"",monthlySalary:W.monthlySalary||null}));x(B),r({message:`Imported ${B.length} records.`,type:"success"})}catch(q){r({message:q.message||"Failed to import CSV.",type:"error"})}finally{M.target&&(M.target.value="")}},I.readAsText(D)};return i.jsxs("form",{onSubmit:l(j),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(pt,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:O}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Staff Designation & ID Series"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:P,children:[i.jsx(ds,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Yc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:C,children:[i.jsx(_i,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(ne,{type:"submit",children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsx("div",{className:"space-y-6",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(b).length===0?i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No designations defined. Click "Add Designation" to begin.'}):Object.entries(b).map(([M,D])=>i.jsxs("div",{className:"border border-border rounded-xl",children:[i.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:i.jsx(we,{"aria-label":`Department for ${M}`,id:`designations.${D[0].originalIndex}.department`,...a(`designations.${D[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),i.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(D)&&D.map(I=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-center",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Designation","aria-label":`Designation for ${M}`,id:`designations.${I.originalIndex}.designation`,...a(`designations.${I.originalIndex}.designation`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${I.designation}`,id:`designations.${I.originalIndex}.permanentId`,...a(`designations.${I.originalIndex}.permanentId`)})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(we,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${I.designation}`,id:`designations.${I.originalIndex}.temporaryId`,...a(`designations.${I.originalIndex}.temporaryId`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Monthly Salary (Gross)","aria-label":`Salary for ${I.designation}`,id:`designations.${I.originalIndex}.monthlySalary`,type:"number",...a(`designations.${I.originalIndex}.monthlySalary`,{valueAsNumber:!0})})}),i.jsx("div",{className:"md:col-span-1 text-right",children:i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>p(I.originalIndex),"aria-label":`Remove ${I.designation}`,title:`Remove ${I.designation}`,children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})})})]},I.id))})]},M))}),i.jsxs(ne,{type:"button",onClick:_,variant:"outline",className:"mt-4",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},ade=({id:n,label:e,checked:t,onChange:r,description:s,disabled:a})=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{className:"flex-grow flex flex-col",children:[i.jsx("span",{className:"text-sm font-medium text-primary-text",children:e}),s&&i.jsx("span",{className:"text-sm text-muted",children:s})]}),i.jsxs("div",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",id:n,className:"sr-only peer",checked:t,onChange:o=>r(o.target.checked),disabled:a}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-accent-dark peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent"})]})]}),nC=["Applicability","OptInDisclaimer","CoverageDetails","OptOutDisclaimer","RequireAlternateInsurance","CollectProvider","CollectStartDate","CollectEndDate","CollectExtentOfCover"],ode={applicability:"Optional - Opt-in Default",optInDisclaimer:"",coverageDetails:"",optOutDisclaimer:"",requireAlternateInsurance:!1,collectProvider:!1,collectStartDate:!1,collectEndDate:!1,collectExtentOfCover:!1},lde=n=>{const e=nC.join(","),t=nC.map(r=>{const s=r.charAt(0).toLowerCase()+r.slice(1);let a=n[s];return typeof a=="string"&&(a.includes(",")||a.includes(`
`)||a.includes('"'))?`"${a.replace(/"/g,'""')}"`:a});return[e,t.join(",")].join(`
`)},cde=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)throw new Error("CSV file must have a header and at least one data row.");const t=e[0].split(",").map(a=>a.trim()),r=e[1].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[],s={};return t.forEach((a,o)=>{const l=a.charAt(0).toLowerCase()+a.slice(1);let c=(r[o]||"").trim();c.startsWith('"')&&c.endsWith('"')&&(c=c.substring(1,c.length-1).replace(/""/g,'""')),l==="applicability"?s[l]=c:typeof ode[l]=="boolean"?s[l]=c.toLowerCase()==="true":s[l]=c}),s},tx=({label:n,...e})=>i.jsxs("label",{className:"flex items-center gap-2 text-sm text-muted",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",...e}),n]}),dde=()=>{const{gmcPolicy:n,updateGmcPolicySettings:e}=bi(),[t,r]=E.useState(null),s=E.useRef(null),{register:a,handleSubmit:o,control:l,watch:c,reset:d,formState:{isDirty:h}}=tn({defaultValues:n});E.useEffect(()=>{d(n)},[n,d]);const p=c("requireAlternateInsurance"),x=c("applicability")==="Mandatory",v=C=>{e(C),r({message:"GMC policy settings saved.",type:"success"})},b=()=>{const C=lde(n),P=new Blob([C],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a");O.href=URL.createObjectURL(P),O.setAttribute("download","gmc_policy_settings.csv"),document.body.appendChild(O),O.click(),document.body.removeChild(O)},_=()=>{const C=nC.join(","),P=new Blob([C],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a");O.href=URL.createObjectURL(P),O.setAttribute("download","gmc_policy_template.csv"),document.body.appendChild(O),O.click(),document.body.removeChild(O)},j=C=>{const P=C.target.files?.[0];if(!P)return;const O=new FileReader;O.onload=M=>{try{const D=M.target?.result,I=cde(D);d(I),r({message:"Settings imported from CSV. Review and save.",type:"success"})}catch(D){r({message:D.message||"Failed to import CSV.",type:"error"})}finally{C.target&&(C.target.value="")}},O.readAsText(P)};return i.jsxs("form",{onSubmit:o(v),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(pt,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:j}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"GMC Policy Configuration"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:_,children:[i.jsx(ds,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Yc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:b,children:[i.jsx(_i,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(ne,{type:"submit",disabled:!h,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{children:i.jsx(_e,{name:"applicability",control:l,render:({field:C})=>i.jsxs(Ze,{label:"Applicability",...C,children:[i.jsx("option",{children:"Mandatory"}),i.jsx("option",{children:"Optional - Opt-in Default"}),i.jsx("option",{children:"Optional - Opt-out Default"})]})})}),i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-In Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-In Disclaimer"}),i.jsx("textarea",{...a("optInDisclaimer"),rows:3,className:"form-input mt-1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Coverage Details"}),i.jsx("textarea",{...a("coverageDetails"),rows:2,className:"form-input mt-1"})]})]}),!x&&i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-Out Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-Out Disclaimer"}),i.jsx("textarea",{...a("optOutDisclaimer"),rows:3,className:"form-input mt-1"})]}),i.jsx(_e,{name:"requireAlternateInsurance",control:l,render:({field:C})=>i.jsx(ade,{id:"require-alt-ins",label:"Require proof of alternate insurance on opt-out",checked:C.value,onChange:C.onChange})}),p&&i.jsxs("div",{className:"p-4 bg-page rounded-lg space-y-3",children:[i.jsx("p",{className:"text-sm text-muted",children:"Collect the following from employees who opt out:"}),i.jsx(_e,{name:"collectProvider",control:l,render:({field:C})=>i.jsx(tx,{label:"Provider Name",checked:C.value,onChange:C.onChange})}),i.jsx(_e,{name:"collectStartDate",control:l,render:({field:C})=>i.jsx(tx,{label:"Policy Start Date",checked:C.value,onChange:C.onChange})}),i.jsx(_e,{name:"collectEndDate",control:l,render:({field:C})=>i.jsx(tx,{label:"Policy End Date",checked:C.value,onChange:C.onChange})}),i.jsx(_e,{name:"collectExtentOfCover",control:l,render:({field:C})=>i.jsx(tx,{label:"Extent of Cover (Sum Assured)",checked:C.value,onChange:C.onChange})})]})]})]})]})},eq=[{key:"Phone",label:"Phone",icon:VJ},{key:"Computer",label:"Computer / Laptop",icon:MJ},{key:"Vehicle",label:"Vehicle",icon:hJ},{key:"Sim",label:"SIM Card",icon:yJ},{key:"IdCard",label:"Identity Card",icon:xJ},{key:"Petrocard",label:"Petrocard",icon:i3},{key:"Tools",label:"Tools",icon:kJ},{key:"Other",label:"Other Asset",icon:bm}],ude=({assetType:n,...e})=>{switch(n){case"Phone":return i.jsx(fde,{...e});case"Computer":return i.jsx(mde,{...e});case"Vehicle":return i.jsx(xde,{...e});case"Sim":return i.jsx(hde,{...e});case"IdCard":return i.jsx(pde,{...e});case"Petrocard":return i.jsx(gde,{...e});case"Tools":return i.jsx(yde,{...e});case"Other":return i.jsx(vde,{...e});default:return null}},fde=({index:n,control:e})=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4",children:[i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(we,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.imei`,control:e,render:({field:t})=>i.jsx(we,{label:"IMEI Number",...t})}),i.jsx(_e,{name:`assets.${n}.color`,control:e,render:({field:t})=>i.jsx(we,{label:"Colour",...t})}),i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Charger",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Charger"}),i.jsx("option",{children:"Without Charger"})]})}),i.jsx(_e,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Display Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Body Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),hde=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(_e,{name:`assets.${n}.number`,control:e,render:({field:t})=>i.jsx(we,{label:"SIM Number",...t})})}),mde=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.computerType`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Type",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Laptop"}),i.jsx("option",{children:"Desktop"}),i.jsx("option",{children:"Tab"})]})}),i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(we,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>i.jsx(we,{label:"Serial Number",...t})}),i.jsx(_e,{name:`assets.${n}.windowsKey`,control:e,render:({field:t})=>i.jsx(we,{label:"Windows Key",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Charger",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Charger"}),i.jsx("option",{children:"Without Charger"})]})}),i.jsx(_e,{name:`assets.${n}.bagStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Bag",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Bag"}),i.jsx("option",{children:"Without Bag"})]})}),i.jsx(_e,{name:`assets.${n}.mouseStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Mouse",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Mouse"}),i.jsx("option",{children:"Without Mouse"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Display Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Body Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.officeStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"MS Office",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Office"}),i.jsx("option",{children:"Without Office"})]})}),i.jsx(_e,{name:`assets.${n}.antivirusStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Antivirus",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Antivirus"}),i.jsx("option",{children:"Without Antivirus"})]})})]}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),pde=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(_e,{name:`assets.${n}.issueDate`,control:e,render:({field:t})=>i.jsx(En,{label:"Date Issued",id:t.name,value:t.value,onChange:t.onChange})})}),gde=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(_e,{name:`assets.${n}.number`,control:e,render:({field:t})=>i.jsx(we,{label:"Petrocard Number",...t})})}),xde=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.vehicleType`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Vehicle Type",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Bicycle"}),i.jsx("option",{children:"Two Wheeler"}),i.jsx("option",{children:"Three Wheeler"}),i.jsx("option",{children:"Four Wheeler"})]})}),i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(we,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.vehicleNumber`,control:e,render:({field:t})=>i.jsx(we,{label:"Vehicle Number",...t})}),i.jsx(_e,{name:`assets.${n}.chassisNumber`,control:e,render:({field:t})=>i.jsx(we,{label:"Chassis Number",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.dlNumber`,control:e,render:({field:t})=>i.jsx(we,{label:"DL Number of User",...t})}),i.jsx(_e,{name:`assets.${n}.kmsAtIssue`,control:e,render:({field:t})=>i.jsx(we,{label:"Kms at issue",type:"number",...t})}),i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.finesStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Violations / Fines",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Existing"}),i.jsx("option",{children:"Nil"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.insuranceValidity`,control:e,render:({field:t})=>i.jsx(En,{label:"Insurance Validity",id:t.name,value:t.value,onChange:t.onChange})}),i.jsx(_e,{name:`assets.${n}.pollutionCertValidity`,control:e,render:({field:t})=>i.jsx(En,{label:"Pollution Cert. Validity",id:t.name,value:t.value,onChange:t.onChange})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`assets.${n}.dlFrontPic`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture of DL (Front)",file:t.value,onFileChange:t.onChange})}),i.jsx(_e,{name:`assets.${n}.dlBackPic`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture of DL (Back)",file:t.value,onFileChange:t.onChange})}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture of Vehicle",file:t.value,onFileChange:t.onChange})})]})]}),yde=({index:n,control:e})=>{const{fields:t,append:r,remove:s}=js({control:e,name:`assets.${n}.toolList`});return i.jsxs("div",{className:"space-y-4 pt-4",children:[t.map((a,o)=>i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("div",{className:"flex-1",children:i.jsx(_e,{name:`assets.${n}.toolList.${o}.name`,control:e,render:({field:l})=>i.jsx(we,{label:"Tool Name",...l})})}),i.jsx("div",{className:"flex-1",children:i.jsx(_e,{name:`assets.${n}.toolList.${o}.description`,control:e,render:({field:l})=>i.jsx(we,{label:"Description",...l})})}),i.jsx("div",{children:i.jsx(_e,{name:`assets.${n}.toolList.${o}.quantity`,control:e,render:({field:l})=>i.jsx(we,{label:"Quantity",type:"number",...l})})}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>s(o),children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})})]},a.id)),i.jsxs(ne,{type:"button",variant:"outline",size:"sm",onClick:()=>r({id:`tool_${Date.now()}`,name:"",description:"",quantity:1}),children:[i.jsx(Ut,{className:"mr-1 h-4 w-4"})," Add Tool"]}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:a})=>i.jsx(vt,{label:"Picture of Tools",file:a.value,onFileChange:a.onChange})})]})},vde=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.name`,control:e,render:({field:t})=>i.jsx(we,{label:"Asset Name",placeholder:"e.g. Printer",...t})}),i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(we,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.model`,control:e,render:({field:t})=>i.jsx(we,{label:"Model No.",...t})}),i.jsx(_e,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>i.jsx(we,{label:"Serial Number",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.issueCondition`,control:e,render:({field:t})=>i.jsx(we,{label:"Condition at time of issue",...t})})]}),i.jsx("div",{children:i.jsx(_e,{name:`assets.${n}.accessories`,control:e,render:({field:t})=>i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Accessories List"}),i.jsx("textarea",{...t,rows:3,className:"form-input mt-1"})]})})}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture of Asset",file:t.value,onFileChange:t.onChange})})]}),bde=({item:n,index:e,control:t,errors:r,remove:s})=>{const[a,o]=E.useState(()=>n.id.startsWith("new_")),l=eq.find(p=>p.key===n.type),c=l?.icon||bm,h=(p=>"brand"in p&&p.brand?`${p.brand} ${p.type}`:"number"in p&&p.number?`${p.type} - ${p.number}`:"name"in p&&p.name?p.name:"vehicleNumber"in p&&p.vehicleNumber?p.vehicleNumber:l?.label||"Asset")(n);return i.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[i.jsxs("div",{className:"flex items-center p-3",children:[i.jsxs("button",{type:"button",onClick:()=>o(!a),className:"flex items-center gap-3 flex-grow text-left",children:[i.jsx(c,{className:"h-5 w-5 text-muted flex-shrink-0"}),i.jsx("span",{className:"font-semibold text-primary-text",children:h})]}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>s(e),children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>o(!a),children:i.jsx(Su,{className:`h-5 w-5 transform transition-transform ${a?"rotate-180":""}`})})]}),a&&i.jsx("div",{className:"p-4 border-t border-border",children:i.jsx(ude,{assetType:n.type,index:e,control:t,errors:r})})]})},wde=({site:n,initialAssets:e,onSave:t,onBack:r,setToast:s})=>{const[a,o]=E.useState(!1),[l,c]=E.useState(!1),d=E.useRef(null),{control:h,handleSubmit:p,reset:x,formState:{errors:v}}=tn(),{fields:b,append:_,remove:j}=js({control:h,name:"assets"});E.useEffect(()=>{x({assets:e})},[e,x]),E.useEffect(()=>{const O=M=>{d.current&&!d.current.contains(M.target)&&c(!1)};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[]);const C=O=>{const M={id:`new_${O}_${Date.now()}`,type:O};let D;switch(O){case"Phone":D={...M,type:"Phone",brand:"",condition:"",chargerStatus:"",displayStatus:"",bodyStatus:"",imei:"",color:""};break;case"Sim":D={...M,type:"Sim",number:""};break;case"Computer":D={...M,type:"Computer",computerType:"",brand:"",condition:"",bagStatus:"",mouseStatus:"",chargerStatus:"",displayStatus:"",bodyStatus:"",serialNumber:"",windowsKey:"",officeStatus:"",antivirusStatus:""};break;case"IdCard":D={...M,type:"IdCard",issueDate:""};break;case"Petrocard":D={...M,type:"Petrocard",number:""};break;case"Vehicle":D={...M,type:"Vehicle",vehicleType:"",brand:"",dlNumber:"",condition:"",kmsAtIssue:null,vehicleNumber:"",chassisNumber:"",insuranceValidity:"",pollutionCertValidity:"",finesStatus:""};break;case"Tools":D={...M,type:"Tools",toolList:[]};break;case"Other":D={...M,type:"Other",name:"",brand:"",model:"",serialNumber:"",condition:"",issueCondition:"",accessories:""};break;default:return}_(D),c(!1)},P=async O=>{o(!0);try{await t(n.id,O.assets)}catch{}finally{o(!1)}};return i.jsxs("form",{onSubmit:p(P),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsxs(ne,{type:"button",onClick:r,variant:"outline",size:"sm",className:"mb-2",children:[i.jsx(Fa,{className:"mr-2 h-4 w-4"})," Back to List"]}),i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Assets for: ",n.shortName]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"relative",ref:d,children:[i.jsxs(ne,{type:"button",onClick:()=>c(!l),children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Asset"]}),l&&i.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-card border rounded-lg shadow-lg z-10",children:eq.map(O=>i.jsxs("button",{type:"button",className:"w-full text-left px-4 py-2 text-sm hover:bg-page flex items-center gap-3",onClick:()=>C(O.key),children:[i.jsx(O.icon,{className:"h-4 w-4 text-muted"}),i.jsx("span",{children:O.label})]},O.key))})]}),i.jsxs(ne,{type:"submit",isLoading:a,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),i.jsx("div",{className:"space-y-4",children:b.length>0?b.map((O,M)=>i.jsx(bde,{item:O,index:M,control:h,errors:v,remove:j},O.id)):i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No assets found for this site. Click "Add Asset" to begin.'})})]})},_de=({sites:n,allAssets:e,searchTerm:t,setSearchTerm:r,onViewDetails:s})=>{const a=(o=[])=>{if(!o||o.length===0)return"No assets assigned.";const l=o.reduce((c,d)=>(c[d.type]=(c[d.type]||0)+1,c),{});return Object.entries(l).map(([c,d])=>`${d} ${c}(s)`).join(", ")};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Asset Overview"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx(we,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>r(o.target.value)})]})]}),i.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Asset Summary"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),i.jsx("td",{className:"px-4 py-3 text-muted",children:a(e[o.id])}),i.jsx("td",{className:"px-4 py-3",children:i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>s(o.id),title:"View Details",children:i.jsx(Tl,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},jde=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState(null),[s,a]=E.useState([]),[o,l]=E.useState({}),[c,d]=E.useState(!0),[h,p]=E.useState(""),[x,v]=E.useState(null);E.useEffect(()=>{d(!0),Promise.all([ce.getOrganizations(),ce.getAllSiteAssets()]).then(([C,P])=>{a(C.sort((O,M)=>O.shortName.localeCompare(M.shortName))),l(P)}).catch(()=>v({message:"Failed to load asset configuration.",type:"error"})).finally(()=>d(!1))},[]);const b=async(C,P)=>{try{await ce.updateSiteAssets(C,P),l(O=>({...O,[C]:P})),v({message:"Assets saved successfully.",type:"success"})}catch(O){throw v({message:"Failed to save assets.",type:"error"}),O}},_=C=>{r(C),e("detail")},j=E.useMemo(()=>h?s.filter(C=>C.shortName.toLowerCase().includes(h.toLowerCase())):s,[s,h]);return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{children:[x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>v(null)}),n==="detail"&&t?i.jsx(wde,{site:s.find(C=>C.id===t),initialAssets:o[t]||[],onSave:b,onBack:()=>e("list"),setToast:v}):i.jsx(_de,{sites:j,allAssets:o,searchTerm:h,setSearchTerm:p,onViewDetails:_})]})},Sde=({control:n,index:e,remove:t,masterTools:r})=>{const[s,a]=E.useState(!0),o=uu({control:n,name:`tools.${e}.department`}),l=uu({control:n,name:`tools.${e}.name`}),c=o?r[o]||[]:[],d=l||"New Tool",h=o||"Select a department";return i.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[i.jsxs("div",{className:"flex items-center p-3",children:[i.jsxs("button",{type:"button",onClick:()=>a(!s),className:"flex items-center gap-3 flex-grow text-left",children:[i.jsx(w3,{className:"h-5 w-5 text-muted flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold text-primary-text",children:d}),i.jsx("p",{className:"text-sm text-muted",children:h})]})]}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>t(e),children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>a(!s),children:i.jsx(Su,{className:`h-5 w-5 transform transition-transform ${s?"rotate-180":""}`})})]}),s&&i.jsxs("div",{className:"p-4 border-t border-border space-y-4 animate-fade-in-down",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`tools.${e}.department`,control:n,render:({field:p})=>i.jsxs(Ze,{label:"Department",...p,children:[i.jsx("option",{value:"",children:"Select Department"}),Object.keys(r).map(x=>i.jsx("option",{value:x,children:x},x))]})}),i.jsx(_e,{name:`tools.${e}.name`,control:n,render:({field:p})=>i.jsxs(Ze,{label:"Tool Name",...p,disabled:!o,children:[i.jsx("option",{value:"",children:"Select Tool"}),c.map(x=>i.jsx("option",{value:x.name,children:x.name},x.id))]})}),i.jsx(_e,{name:`tools.${e}.quantity`,control:n,render:({field:p})=>i.jsx(we,{label:"Quantity",type:"number",...p})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`tools.${e}.picture`,control:n,render:({field:p})=>i.jsx(vt,{label:"Picture of Tool",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.inwardDcCopy`,control:n,render:({field:p})=>i.jsx(vt,{label:"Inward DC Copy",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.deliveryCopy`,control:n,render:({field:p})=>i.jsx(vt,{label:"Delivery Copy",file:p.value,onFileChange:p.onChange})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end",children:[i.jsx(_e,{name:`tools.${e}.invoiceCopy`,control:n,render:({field:p})=>i.jsx(vt,{label:"Invoice",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.signedReceipt`,control:n,render:({field:p})=>i.jsx(vt,{label:"Signed Receipt",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.receiverName`,control:n,render:({field:p})=>i.jsx(we,{label:"Receiver's Name",...p})})]})]})]})},Nde=({site:n,initialTools:e,masterTools:t,onSave:r,onBack:s})=>{const[a,o]=E.useState(!1),{control:l,handleSubmit:c,reset:d}=tn(),{fields:h,append:p,remove:x}=js({control:l,name:"tools"});E.useEffect(()=>{d({tools:e})},[e,d]);const v=()=>{p({id:`new_tool_${Date.now()}`,department:"",name:"",quantity:1})},b=async _=>{o(!0);try{await r(n.id,_.tools)}finally{o(!1)}};return i.jsxs("form",{onSubmit:c(b),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsxs(ne,{type:"button",onClick:s,variant:"outline",size:"sm",className:"mb-2",children:[i.jsx(Fa,{className:"mr-2 h-4 w-4"})," Back to List"]}),i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Tools for: ",n.shortName]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(ne,{type:"button",onClick:v,children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Tool"]}),i.jsxs(ne,{type:"submit",isLoading:a,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),i.jsx("div",{className:"space-y-4",children:h.length>0?h.map((_,j)=>i.jsx(Sde,{control:l,index:j,remove:x,masterTools:t},_.id)):i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No tools found for this site. Click "Add Tool" to begin.'})})]})},Cde=({sites:n,allIssuedTools:e,searchTerm:t,setSearchTerm:r,onViewDetails:s})=>{const a=(o=[])=>{if(!o||o.length===0)return"No tools issued.";const l=o.reduce((d,h)=>d+(h.quantity||0),0),c=new Set(o.map(d=>d.department)).size;return`${l} tools issued across ${c} department${c>1?"s":""}.`};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Site Tools Overview"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx(we,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>r(o.target.value)})]})]}),i.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Tools Summary"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),i.jsx("td",{className:"px-4 py-3 text-muted",children:a(e[o.id])}),i.jsx("td",{className:"px-4 py-3",children:i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>s(o.id),title:"View Details",children:i.jsx(Tl,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},Tde=()=>{const[n,e]=E.useState(null),[t,r]=E.useState([]),[s,a]=E.useState({}),[o,l]=E.useState({}),[c,d]=E.useState(!0),[h,p]=E.useState(""),[x,v]=E.useState(null);E.useEffect(()=>{d(!0),Promise.all([ce.getOrganizations(),ce.getAllSiteIssuedTools(),ce.getToolsList()]).then(([j,C,P])=>{r(j.sort((O,M)=>O.shortName.localeCompare(M.shortName))),a(C),l(P)}).catch(()=>v({message:"Failed to load initial configuration.",type:"error"})).finally(()=>d(!1))},[]);const b=async(j,C)=>{try{await ce.updateSiteIssuedTools(j,C),a(P=>({...P,[j]:C})),v({message:"Tools list saved successfully.",type:"success"})}catch(P){throw v({message:"Failed to save tools list.",type:"error"}),P}},_=E.useMemo(()=>h?t.filter(j=>j.shortName.toLowerCase().includes(h.toLowerCase())):t,[t,h]);return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{children:[x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>v(null)}),n?i.jsx(Nde,{site:t.find(j=>j.id===n),initialTools:s[n]||[],masterTools:o,onSave:b,onBack:()=>e(null)}):i.jsx(Cde,{sites:_,allIssuedTools:s,searchTerm:h,setSearchTerm:p,onViewDetails:e})]})},kde=()=>i.jsx(fd,{title:"Attendance Format"}),Pde=()=>i.jsx(fd,{title:"Attendance Overview"}),Mde=()=>i.jsx(fd,{title:"Daily Attendance Summary"}),Ede=()=>i.jsx(fd,{title:"Notification & Mail Configuration"}),Dde=()=>i.jsx(fd,{title:"Onboarding Rejection Reasons"}),Ode=()=>i.jsx(fd,{title:"Salary Breakup"}),Ide=()=>i.jsx(fd,{title:"Salary Line Item"}),$L=(n,e)=>{const t=e.join(","),r=n.map(s=>e.map(a=>{const o=s[a]===null||s[a]===void 0?"":String(s[a]);return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...r].join(`
`)},HL=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,"")),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),a[l]=d}),r.push(a)}return r},zS=["GroupId","GroupName","CompanyId","CompanyName","EntityId","EntityName","organizationId","Location","RegisteredAddress","RegistrationType","RegistrationNumber","GSTNumber","PANNumber","Email","EShramNumber","ShopAndEstablishmentCode","EPFOCode","ESICCode","PSARALicenseNumber","PSARAValidTill"],US=["organizationId","organizationName","location","entityId","billingName","registeredAddress","gstNumber","panNumber","email1","email2","email3","eShramNumber","shopAndEstablishmentCode","keyAccountManager","siteAreaSqFt","projectType","apartmentCount","agreementDetails","siteOperations"],YL=(n,e)=>{const t=new Blob([n],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(t),r.setAttribute("download",e),document.body.appendChild(r),r.click(),document.body.removeChild(r)},Ade=({isOpen:n,onClose:e,onSave:t,title:r,label:s,initialName:a=""})=>{const[o,l]=E.useState(a),[c,d]=E.useState("");E.useEffect(()=>{n&&l(a)},[n,a]);const h=()=>{if(!o.trim()){d("Name cannot be empty.");return}t(o),e()};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4",onClick:p=>p.stopPropagation(),children:[i.jsx("h3",{className:"text-lg font-bold",children:r}),i.jsx("div",{className:"mt-4",children:i.jsx(we,{label:s,id:"name-input",value:o,onChange:p=>{l(p.target.value),d("")},error:c})}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ne,{onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ne,{onClick:h,children:"Save"})]})]})}):null},BS=[{key:"client_structure",label:"Client Structure",icon:s3},{key:"site_configuration",label:"Site Configuration",icon:Rm},{key:"costing_resource",label:"Costing & Resource",icon:lJ},{key:"backoffice_heads",label:"Back Office & ID Series",icon:Qi},{key:"staff_designation",label:"Staff Designation",icon:sJ},{key:"gmc_policy",label:"GMC Policy",icon:MC},{key:"asset",label:"Asset Management",icon:tJ},{key:"tools_list",label:"Tools List",icon:w3},{key:"attendance_format",label:"Attendance Format",icon:fJ},{key:"attendance_overview",label:"Attendance Overview",icon:aJ},{key:"notification_template",label:"Notification & Mail",icon:Gf},{key:"onboard_reject_reason",label:"Onboarding Rejection Reasons",icon:Ax},{key:"salary_template",label:"Salary Breakup",icon:kl},{key:"salary_line_item",label:"Salary Line Item",icon:kl}],Rde=()=>{const n=Nt(),{colorScheme:e}=on(),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState([]),[c,d]=E.useState(!0),[h,p]=E.useState(null),[x,v]=E.useState({}),[b,_]=E.useState("client_structure"),j=E.useRef(null),[C,P]=E.useState(""),[O,M]=E.useState(null),[D,I]=E.useState(!1),F=At("(max-width: 767px)"),[q,U]=E.useState({isOpen:!1,initialData:null,companyName:""}),[B,W]=E.useState({isOpen:!1,mode:"add",type:"group",title:"",label:""}),[Y,G]=E.useState({isOpen:!1,type:"group",id:"",name:""}),[Z,oe]=E.useState({isOpen:!1,org:null}),X=E.useMemo(()=>t.flatMap(Te=>Te.companies.flatMap(Se=>Se.entities.map(Pe=>({...Pe,companyName:Se.name})))),[t]);E.useEffect(()=>{(async()=>{d(!0);try{const[Se,Pe,qe]=await Promise.all([ce.getOrganizationStructure(),ce.getOrganizations(),ce.getSiteConfigurations()]);r(Se),a(Pe),l(qe)}catch{p({message:"Failed to load data.",type:"error"})}finally{d(!1)}})()},[]);const he=E.useMemo(()=>{if(!C.trim())return t;const Te=C.toLowerCase();return t.map(Se=>{if(Se.name.toLowerCase().includes(Te))return Se;const Pe=Se.companies.map(qe=>{if(qe.name.toLowerCase().includes(Te))return qe;const He=qe.entities.filter(ze=>ze.name.toLowerCase().includes(Te));return He.length>0?{...qe,entities:He}:null}).filter(Boolean);return Pe.length>0?{...Se,companies:Pe}:null}).filter(Boolean)},[t,C]),$=E.useMemo(()=>{if(!C.trim())return s;const Te=C.toLowerCase();return s.filter(Se=>Se.shortName.toLowerCase().includes(Te))},[s,C]),K=Te=>v(Se=>({...Se,[Te]:!Se[Te]})),te=()=>{p({message:"All changes saved successfully (mocked).",type:"success"})},H=Te=>U({isOpen:!0,initialData:null,companyName:Te}),ae=(Te,Se)=>U({isOpen:!0,initialData:Te,companyName:Se}),le=Te=>{p({message:Te.id.startsWith("new_")?"Client added.":"Client updated.",type:"success"}),U({isOpen:!1,initialData:null,companyName:""})},ue=(Te,Se,Pe)=>G({isOpen:!0,type:Te,id:Se,name:Pe}),ie=()=>{const{type:Te,id:Se,name:Pe}=Y;Te==="group"?r(qe=>qe.filter(He=>He.id!==Se)):Te==="company"?r(qe=>qe.map(He=>({...He,companies:He.companies.filter(ze=>ze.id!==Se)}))):Te==="client"&&r(qe=>qe.map(He=>({...He,companies:He.companies.map(ze=>({...ze,entities:ze.entities.filter(be=>be.id!==Se)}))}))),p({message:`${Te.charAt(0).toUpperCase()+Te.slice(1)} '${Pe}' deleted.`,type:"success"}),G({isOpen:!1,type:"group",id:"",name:""})},pe=Te=>{const{mode:Se,type:Pe,id:qe,groupId:He}=B;if(Se==="add"){if(Pe==="group"){const ze={id:`group_${Date.now()}`,name:Te,locations:[],companies:[]};r(be=>[...be,ze]),p({message:`Group '${Te}' added.`,type:"success"})}else if(Pe==="company"&&He){const ze={id:`comp_${Date.now()}`,name:Te,entities:[]};r(be=>be.map(Ue=>Ue.id===He?{...Ue,companies:[...Ue.companies,ze]}:Ue)),p({message:`Company '${Te}' added.`,type:"success"})}}else Pe==="group"&&qe?(r(ze=>ze.map(be=>be.id===qe?{...be,name:Te}:be)),p({message:"Group updated.",type:"success"})):Pe==="company"&&qe&&He&&(r(ze=>ze.map(be=>be.id===He?{...be,companies:be.companies.map(Ue=>Ue.id===qe?{...Ue,name:Te}:Ue)}:be)),p({message:"Company updated.",type:"success"}));W({isOpen:!1,mode:"add",type:"group",title:"",label:""})},re=()=>{let Te,Se,Pe;if(b==="client_structure"){Pe=zS;const qe=t.flatMap(He=>He.companies.flatMap(ze=>ze.entities.map(be=>({GroupId:He.id,GroupName:He.name,CompanyId:ze.id,CompanyName:ze.name,EntityId:be.id,EntityName:be.name,organizationId:be.organizationId||"",Location:be.location||"",RegisteredAddress:be.registeredAddress||"",RegistrationType:be.registrationType||"",RegistrationNumber:be.registrationNumber||"",GSTNumber:be.gstNumber||"",PANNumber:be.panNumber||"",Email:be.email||"",EShramNumber:be.eShramNumber||"",ShopAndEstablishmentCode:be.shopAndEstablishmentCode||"",EPFOCode:be.epfoCode||"",ESICCode:be.esicCode||"",PSARALicenseNumber:be.psaraLicenseNumber||"",PSARAValidTill:be.psaraValidTill||""}))));Te=$L(qe,Pe),Se="client_structure_export.csv"}else if(b==="site_configuration"){Pe=US;const qe=s.map(He=>{const ze=o.find(be=>be.organizationId===He.id);return{organizationId:He.id,organizationName:He.shortName,...ze||{},agreementDetails:JSON.stringify(ze?.agreementDetails||{}),siteOperations:JSON.stringify(ze?.siteOperations||{})}});Te=$L(qe,Pe),Se="site_configuration_export.csv"}else{p({message:"Export not implemented for this view.",type:"error"});return}YL(Te,Se),p({message:"Data exported successfully.",type:"success"})},de=()=>{let Te,Se;if(b==="client_structure")Te=zS,Se="client_structure_template.csv";else if(b==="site_configuration")Te=US,Se="site_configuration_template.csv";else{p({message:"Template not available for this view.",type:"error"});return}YL(Te.join(","),Se)},je=Te=>{const Se=Te.target.files?.[0];if(!Se)return;const Pe=new FileReader;Pe.onload=qe=>{try{const He=qe.target?.result;if(!He)throw new Error("File is empty.");const ze=He.trim().replace(/\r/g,"").split(`
`);if(ze.length<1)throw new Error("CSV file is empty.");const be=ze[0].split(",").map(Ue=>Ue.trim().replace(/"/g,""));if(b==="client_structure"){if(be.join(",")!==zS.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const Ue=HL(He);if(Ue.length===0)throw new Error("No data rows found.");const Ve=new Map;for(const se of Ue){Ve.has(se.GroupId)||Ve.set(se.GroupId,{group:{id:se.GroupId,name:se.GroupName,locations:[],companies:[]},companiesMap:new Map});const xe=Ve.get(se.GroupId);xe.companiesMap.has(se.CompanyId)||xe.companiesMap.set(se.CompanyId,{id:se.CompanyId,name:se.CompanyName,entities:[]});const ke=xe.companiesMap.get(se.CompanyId),Ie={id:se.EntityId,name:se.EntityName,organizationId:se.organizationId,location:se.Location,registeredAddress:se.RegisteredAddress,registrationType:se.RegistrationType||"",registrationNumber:se.RegistrationNumber,gstNumber:se.GSTNumber,panNumber:se.PANNumber,email:se.Email,eShramNumber:se.EShramNumber,shopAndEstablishmentCode:se.ShopAndEstablishmentCode,epfoCode:se.EPFOCode,esicCode:se.ESICCode,psaraLicenseNumber:se.PSARALicenseNumber,psaraValidTill:se.PSARAValidTill};ke.entities.push(Ie)}const ee=Array.from(Ve.values()).map(se=>(se.group.companies=Array.from(se.companiesMap.values()),se.group));r(ee),p({message:`Successfully imported ${Ue.length} client records.`,type:"success"})}else if(b==="site_configuration"){if(be.join(",")!==US.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const Ue=HL(He);if(Ue.length===0)throw new Error("No data rows found.");const Ve=Ue.map(ee=>{const se={};for(const xe of Object.keys(ee))if(xe==="agreementDetails"||xe==="siteOperations")try{se[xe]=JSON.parse(ee[xe])}catch{console.warn(`Could not parse JSON for ${xe} in row for site ${ee.organizationId}`),se[xe]={}}else se[xe]=ee[xe];return se});l(ee=>{const se=[...ee];return Ve.forEach(xe=>{const ke=se.findIndex(Ie=>Ie.organizationId===xe.organizationId);ke>-1?se[ke]=xe:se.push(xe)}),se}),p({message:`Successfully imported ${Ve.length} site configurations.`,type:"success"})}else p({message:"Import not implemented for this view.",type:"error"})}catch(He){p({message:He.message||"Failed to import CSV.",type:"error"})}finally{Te.target&&(Te.target.value="")}},Pe.readAsText(Se)},Ae=()=>{switch(b){case"client_structure":return i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsxs(ne,{onClick:()=>n("/hr/entity-management/add-group"),className:"btn-primary border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Ut,{className:"mr-2 h-4"}),"Add Group"]}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:de,className:"hover:bg-gray-100",children:[i.jsx(ds,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>j.current?.click(),className:"hover:bg-gray-100",children:[i.jsx(Yc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:re,className:"hover:bg-gray-100",children:[i.jsx(_i,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),i.jsx("div",{className:"space-y-2",children:he.map(Se=>i.jsxs("div",{className:"border-b border-border",children:[i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>K(Se.id),children:i.jsx(Rf,{className:`h-5 w-5 transition-transform ${x[Se.id]?"rotate-90":""}`})}),i.jsx(Ki,{className:"h-5 w-5 text-muted"}),i.jsx("span",{className:"font-semibold",children:Se.name})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ne,{size:"sm",className:"!p-1.5",onClick:()=>W({isOpen:!0,mode:"add",type:"company",groupId:Se.id,title:`Add Company to ${Se.name}`,label:"Company Name"}),title:"Add Company",children:i.jsx(Ut,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",onClick:()=>W({isOpen:!0,mode:"edit",type:"group",id:Se.id,initialName:Se.name,title:"Edit Group Name",label:"Group Name"}),title:"Edit group name",className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(ur,{className:"h-5 w-5"})}),i.jsx(ne,{variant:"icon",onClick:()=>ue("group",Se.id,Se.name),title:"Delete group",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(sn,{className:"h-5 w-5 text-red-500"})})]})]}),x[Se.id]&&i.jsx("div",{className:"pl-6 pr-3 pb-3 space-y-2",children:Se.companies.map(Pe=>i.jsxs("div",{className:"border border-border rounded-lg",children:[i.jsxs("div",{className:"p-2 flex items-center justify-between bg-card",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>K(Pe.id),children:i.jsx(Rf,{className:`h-5 w-5 transition-transform ${x[Pe.id]?"rotate-90":""}`})}),i.jsxs("span",{children:[Pe.name," (",Pe.entities.length," clients)"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ne,{variant:"icon",size:"sm",title:`View ${Pe.entities.length} clients`,onClick:()=>M({companyName:Pe.name,clients:Pe.entities}),children:i.jsx(Tl,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>H(Pe.name),title:"Add client",children:i.jsx(Ut,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",onClick:()=>W({isOpen:!0,mode:"edit",type:"company",id:Pe.id,groupId:Se.id,initialName:Pe.name,title:"Edit Company Name",label:"Company Name"}),title:"Edit company name",className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(ur,{className:"h-5 w-5"})}),i.jsx(ne,{variant:"icon",onClick:()=>ue("company",Pe.id,Pe.name),title:"Delete company",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(sn,{className:"h-5 w-5 text-red-500"})})]})]}),x[Pe.id]&&i.jsx("div",{className:"p-2",children:Pe.entities.map(qe=>i.jsxs("div",{className:"p-2 flex items-center justify-between hover:bg-page rounded",children:[i.jsx("span",{children:qe.name}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"icon",onClick:()=>ae(qe,Pe.name),className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(ur,{className:"h-5 w-5"})}),i.jsx(ne,{variant:"icon",onClick:()=>ue("client",qe.id,qe.name),className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(sn,{className:"h-5 w-5 text-red-500"})})]})]},qe.id))})]},Pe.id))})]},Se.id))})]});case"site_configuration":return i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Sites Configuration"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:de,children:[i.jsx(ds,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>j.current?.click(),children:[i.jsx(Yc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:re,children:[i.jsx(_i,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Configuration Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:$.map(Se=>{const Pe=o.find(He=>He.organizationId===Se.id),qe=!!Pe&&(!!Pe.billingName||!!Pe.keyAccountManager);return i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Ki,{className:"h-5 w-5 text-muted"}),i.jsx("span",{children:Se.shortName})]})}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:qe?i.jsxs("span",{className:"flex items-center text-green-600",children:[i.jsx(Ji,{className:"h-4 w-4 mr-1"})," Complete"]}):i.jsxs("span",{className:"flex items-center text-yellow-600",children:[i.jsx(n3,{className:"h-4 w-4 mr-1"})," Incomplete"]})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs(ne,{size:"sm",variant:"outline",onClick:()=>oe({isOpen:!0,org:Se}),children:[i.jsx(Tl,{className:"mr-2 h-4 w-4"})," View / Edit"]})})]},Se.id)})})]})})]});case"costing_resource":return i.jsx(Xce,{});case"backoffice_heads":return i.jsx(nde,{});case"staff_designation":return i.jsx(ide,{});case"gmc_policy":return i.jsx(dde,{});case"asset":return i.jsx(jde,{});case"tools_list":return i.jsx(Tde,{});case"attendance_format":return i.jsx(kde,{});case"attendance_overview":return i.jsx(Pde,{});case"daily_attendance":return i.jsx(Mde,{});case"notification_template":return i.jsx(Ede,{});case"onboard_reject_reason":return i.jsx(Dde,{});case"salary_template":return i.jsx(Ode,{});case"salary_line_item":return i.jsx(Ide,{});default:const Te=BS.find(Se=>Se.key===b);return i.jsx(fd,{title:Te?.label||"Configuration"})}};return i.jsxs("div",{className:"p-4 space-y-6",children:[h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(Kce,{isOpen:D,onClose:()=>I(!1)}),q.isOpen&&i.jsx(Zce,{...q,onClose:()=>U(Te=>({...Te,isOpen:!1})),onSave:le}),i.jsx(Ade,{isOpen:B.isOpen,onClose:()=>W({isOpen:!1,mode:"add",type:"group",title:"",label:""}),onSave:pe,title:B.title,label:B.label,initialName:B.initialName}),i.jsxs(Kr,{isOpen:Y.isOpen,onClose:()=>G(Te=>({...Te,isOpen:!1})),onConfirm:ie,title:"Confirm Deletion",children:["Are you sure you want to delete the ",Y.type,' "',Y.name,'"? This action cannot be undone.']}),Z.isOpen&&Z.org&&i.jsx(a6,{isOpen:Z.isOpen,onClose:()=>oe({isOpen:!1,org:null}),onSave:()=>{},organization:Z.org,allClients:X,initialData:o.find(Te=>Te.organizationId===Z.org?.id)}),O&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",onClick:()=>M(null),children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 animate-fade-in-scale",onClick:Te=>Te.stopPropagation(),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text mb-4",children:["Clients in ",O.companyName]}),O.clients.length>0?i.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:O.clients.map(Te=>i.jsx("li",{className:"text-sm p-2 bg-page rounded-md",children:Te.name},Te.id))}):i.jsx("p",{className:"text-muted text-center py-4",children:"No clients found for this company."}),i.jsx("div",{className:"mt-6 text-right",children:i.jsx(ne,{onClick:()=>M(null),variant:"secondary",children:"Close"})})]})}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Client Management"}),!F&&i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{variant:"outline",onClick:()=>I(!0),className:"hover:bg-gray-100",children:[i.jsx(zM,{className:"mr-2 h-4 w-4"})," Help"]}),i.jsx("input",{type:"file",ref:j,className:"hidden",accept:".csv",onChange:je}),i.jsxs(ne,{onClick:te,className:"btn-primary border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save All Changes"]})]})]}),F&&i.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[i.jsxs(ne,{onClick:te,className:"w-full justify-center btn-primary border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save All Changes"]}),i.jsxs(ne,{variant:"outline",onClick:()=>I(!0),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(zM,{className:"mr-2 h-4 w-4"})," Help"]}),i.jsx("input",{type:"file",ref:j,className:"hidden",accept:".csv",onChange:je})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx("input",{type:"text",placeholder:"Search across all clients and sites...",value:C,onChange:Te=>P(Te.target.value),className:"form-input pl-10 w-full"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx("nav",{className:"md:col-span-1",children:F?i.jsx(Ze,{label:"Configuration Section",id:"hr-config-select",value:b,onChange:Te=>_(Te.target.value),children:BS.map(Te=>i.jsx("option",{value:Te.key,children:Te.label},Te.key))}):i.jsx("div",{className:"space-y-1",children:BS.map(Te=>i.jsxs("button",{onClick:()=>_(Te.key),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg text-left transition-colors ${b===Te.key?"bg-accent text-white":"text-slate-700 hover:bg-gray-100 hover:text-slate-900"}`,children:[i.jsx(Te.icon,{className:`h-5 w-5 ${b===Te.key?"text-white":"text-slate-500"}`}),i.jsx("span",{children:Te.label})]},Te.key))})}),i.jsx("main",{className:"md:col-span-3",children:c?i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent mx-auto mt-16"}):Ae()})]})]})},Lde=({isOpen:n,onSave:e,onClose:t,initialData:r})=>{const[s,a]=E.useState(r?.name||""),[o,l]=E.useState(r?.description||""),[c,d]=E.useState(!1);E.useEffect(()=>{n&&(a(r?.name||""),l(r?.description||""),d(!1))},[n,r]);const h=async p=>{if(p&&p.preventDefault(),!!s.trim()){d(!0);try{await e({name:s.trim(),description:o.trim()})}catch(x){console.error("Error saving policy:",x),d(!1)}}};return i.jsx(Kr,{isOpen:n,onClose:t,onConfirm:h,title:`${r?"Edit":"Add"} Policy`,confirmButtonText:"Save Policy",isLoading:c,children:i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"policy-name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"policy-name",value:s,onChange:p=>a(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"policy-description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"policy-description",value:o,onChange:p=>l(p.target.value),placeholder:"Description",className:"form-input",rows:3,disabled:c})]})]})})},Fde=()=>{const n=Nt(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(!1),[l,c]=E.useState(null),[d,h]=E.useState(null),p=E.useRef(!0);E.useEffect(()=>(p.current=!0,()=>{p.current=!1}),[]);const x=E.useCallback(async()=>{s(!0);try{const j=await ce.getPolicies();p.current&&t(j)}catch(j){console.error("Error fetching policies:",j),p.current&&h({message:"Failed to fetch policies.",type:"error"})}finally{p.current&&s(!1)}},[]);E.useEffect(()=>{x()},[x]);const v=async j=>{try{l?h({message:"Policy updated.",type:"success"}):(await ce.createPolicy(j),p.current&&h({message:"Policy created successfully!",type:"success"})),p.current&&(o(!1),c(null),x())}catch(C){throw console.error("Error saving policy:",C),p.current&&h({message:"Failed to save policy. Please try again.",type:"error"}),C}},b=()=>{n("/hr/policies/add")},_=j=>{c(j),o(!0)};return i.jsxs("div",{children:[d&&i.jsx(pt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsx(Lde,{isOpen:a,onSave:v,onClose:()=>{o(!1),c(null)},initialData:l}),i.jsx(ra,{title:"Policy Management",children:i.jsxs(ne,{onClick:b,children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Policy"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Description"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):e.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:'No policies found. Click "Add Policy" to create one.'})}):e.map(j=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Policy Name",className:"px-6 py-4 font-medium",children:j.name}),i.jsx("td",{"data-label":"Description",className:"px-6 py-4 text-sm text-muted",children:j.description||""}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>_(j),children:i.jsx(ur,{className:"h-4 w-4"})})})})]},j.id))})]})})]})},qde=Pt({type:ye().oneOf(["GMC","GPA","WCA","Other"]).required("Type is required"),provider:ye().required("Provider is required"),policyNumber:ye().required("Policy number is required"),validTill:ye().required("Valid till date is required")}).defined(),zde=({onSave:n,onClose:e,initialData:t})=>{const{register:r,handleSubmit:s,control:a,formState:{errors:o},reset:l}=tn({resolver:On(qde)});E.useEffect(()=>{l(t||{type:"GMC",provider:"",policyNumber:"",validTill:""})},[t,l]);const c=d=>{n(d)};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4",onClick:d=>d.stopPropagation(),children:i.jsxs("form",{onSubmit:s(c),children:[i.jsxs("h3",{className:"text-lg font-bold mb-4",children:[t?"Edit":"Add"," Insurance"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(Ze,{label:"Insurance Type",id:"type",registration:r("type"),error:o.type?.message,children:[i.jsx("option",{children:"GMC"}),i.jsx("option",{children:"GPA"}),i.jsx("option",{children:"WCA"}),i.jsx("option",{children:"Other"})]}),i.jsx(we,{label:"Provider",id:"provider",registration:r("provider"),error:o.provider?.message}),i.jsx(we,{label:"Policy Number",id:"policyNumber",registration:r("policyNumber"),error:o.policyNumber?.message}),i.jsx(_e,{name:"validTill",control:a,render:({field:d})=>i.jsx(En,{label:"Valid Till",id:"validTill",value:d.value,onChange:d.onChange,error:o.validTill?.message})})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[i.jsx(ne,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(ne,{type:"submit",children:"Save Insurance"})]})]})})})},Ude=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState(null),[c,d]=E.useState(null),h=E.useCallback(async()=>{r(!0);try{const x=await ce.getInsurances();e(x)}catch{d({message:"Failed to fetch insurance policies.",type:"error"})}finally{r(!1)}},[]);E.useEffect(()=>{h()},[h]);const p=async x=>{try{o||(await ce.createInsurance(x),d({message:"Insurance created.",type:"success"})),a(!1),h()}catch{d({message:"Failed to save insurance.",type:"error"})}};return i.jsxs("div",{children:[c&&i.jsx(pt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),s&&i.jsx(zde,{onSave:p,onClose:()=>a(!1),initialData:o}),i.jsx(ra,{title:"Insurance Management",children:i.jsxs(ne,{onClick:()=>{l(null),a(!0)},children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Insurance"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Provider"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Number"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Valid Till"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:5,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):n.map(x=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Type",className:"px-6 py-4 font-medium",children:x.type}),i.jsx("td",{"data-label":"Provider",className:"px-6 py-4 text-sm text-muted",children:x.provider}),i.jsx("td",{"data-label":"Policy Number",className:"px-6 py-4 text-sm text-muted",children:x.policyNumber}),i.jsx("td",{"data-label":"Valid Till",className:"px-6 py-4 text-sm text-muted",children:x.validTill}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>{l(x),a(!0)},children:i.jsx(ur,{className:"h-4 w-4"})})})})]},x.id))})]})})]})},Bde=()=>{const[n,e]=E.useState("policies");return i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Policies & Insurance"})}),i.jsx("div",{children:i.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[i.jsxs("button",{onClick:()=>e("policies"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="policies"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[i.jsx(ds,{className:"h-5 w-5"}),i.jsx("span",{children:"Company Policies"})]}),i.jsxs("button",{onClick:()=>e("insurance"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="insurance"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[i.jsx(p3,{className:"h-5 w-5"}),i.jsx("span",{children:"Insurance Plans"})]})]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[n==="policies"&&i.jsx(Fde,{}),n==="insurance"&&i.jsx(Ude,{})]})]})},nx={documents:{aadhaar:!1,pan:!1,bankProof:!1,educationCertificate:!1,salarySlip:!1,uanProof:!1,familyAadhaar:!1},verifications:{requireBengaluruAddress:!1,requireDobVerification:!1}},Vde=()=>{const n=nd(),[e,t]=E.useState(null),[r,s]=E.useState([]),[a,o]=E.useState("Administrator");E.useEffect(()=>{ce.getSiteStaffDesignations().then(P=>{const O=[...new Set(P.map(M=>M.designation))];O.includes("Administrator")||O.unshift("Administrator"),s(O.map((M,D)=>({id:`${D}`,designation:M,department:"",permanentId:"",temporaryId:""})))})},[]);const{register:l,handleSubmit:c,control:d,formState:{isDirty:h},watch:p,reset:x,setValue:v}=tn({defaultValues:n});E.useEffect(()=>{x(n)},[n,x]),E.useEffect(()=>{n.rulesByDesignation?.[a]||(Object.keys(nx.documents).forEach(O=>{v(`rulesByDesignation.${a}.documents.${O}`,!0,{shouldDirty:!0})}),Object.keys(nx.verifications).forEach(O=>{v(`rulesByDesignation.${a}.verifications.${O}`,!0,{shouldDirty:!0})}))},[a,n.rulesByDesignation,v]);const b=p("enforceManpowerLimit"),_=p("enableEsiRule"),j=p("enableGmcRule"),C=P=>{n.updateRules(P),t({message:"Enrollment rules saved successfully!",type:"success"}),x(P)};return i.jsxs("form",{onSubmit:c(C),className:"p-4 space-y-8 w-full",children:[e&&i.jsx(pt,{message:e.message,type:e.type,onDismiss:()=>t(null)}),i.jsx(ra,{title:"Enrollment Rules",children:i.jsxs(ne,{type:"submit",disabled:!h,children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(ds,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"Designation-Specific Rules"}),i.jsx("p",{className:"text-muted",children:"Set mandatory documents and verifications for specific roles."})]})]}),i.jsx("div",{className:"mb-4",children:i.jsx(Ze,{label:"Configure rules for designation",value:a,onChange:P=>o(P.target.value),children:r.map(P=>i.jsx("option",{value:P.designation,children:P.designation},P.id))})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Mandatory Documents"}),i.jsx("div",{className:"space-y-3",children:Object.keys(nx.documents).map(P=>i.jsx(_e,{name:`rulesByDesignation.${a}.documents.${P}`,control:d,defaultValue:!0,render:({field:O})=>i.jsx(kn,{id:`${a}-${P}`,label:P.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()),checked:O.value,onChange:O.onChange})},P))})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Data Verifications"}),i.jsx("div",{className:"space-y-3",children:Object.keys(nx.verifications).map(P=>i.jsx(_e,{name:`rulesByDesignation.${a}.verifications.${P}`,control:d,defaultValue:!0,render:({field:O})=>i.jsx(kn,{id:`${a}-${P}`,label:P.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()),checked:O.value,onChange:O.onChange})},P))})]})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(kl,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"ESI Eligibility"}),i.jsx("p",{className:"text-muted",children:"Define salary threshold for statutory insurance."})]}),i.jsx(_e,{name:"enableEsiRule",control:d,render:({field:P})=>i.jsx(kn,{id:"enableEsiRule",label:"Enable Rule",checked:P.value,onChange:P.onChange})})]}),i.jsx("div",{className:`transition-opacity ${_?"opacity-100":"opacity-50 pointer-events-none"}`,children:i.jsxs("div",{className:"max-w-sm",children:[i.jsx(we,{label:"ESI Eligibility Gross Salary Threshold",id:"esiCtcThreshold",type:"number",registration:l("esiCtcThreshold",{valueAsNumber:!0}),disabled:!_}),i.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees at or below this amount are eligible for ESI. Those above are eligible for GMC."})]})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(kl,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"GMC/Insurance Policy Rules"}),i.jsx("p",{className:"text-muted",children:"Set default GMC policies."})]}),i.jsx(_e,{name:"enableGmcRule",control:d,render:({field:P})=>i.jsx(kn,{id:"enableGmcRule",label:"Enable Rule",checked:P.value,onChange:P.onChange})})]}),i.jsxs("div",{className:`transition-opacity ${j?"opacity-100":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[i.jsx(we,{label:"GMC Salary Threshold",id:"salaryThreshold",type:"number",registration:l("salaryThreshold",{valueAsNumber:!0}),disabled:!j}),i.jsx(_e,{name:"defaultPolicySingle",control:d,render:({field:P})=>i.jsxs(Ze,{label:"Policy (Single)",...P,disabled:!j,children:[i.jsx("option",{value:"1L",children:"1 Lakh"}),i.jsx("option",{value:"2L",children:"2 Lakh"})]})}),i.jsx(_e,{name:"defaultPolicyMarried",control:d,render:({field:P})=>i.jsxs(Ze,{label:"Policy (Married)",...P,disabled:!j,children:[i.jsx("option",{value:"1L",children:"1 Lakh"}),i.jsx("option",{value:"2L",children:"2 Lakh"})]})})]}),i.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees with a salary *above* this threshold will be eligible for GMC."})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Qi,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Manpower Allocation"}),i.jsx("p",{className:"text-muted",children:"Set rules for enrolling based on approved manpower."})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(_e,{name:"enforceManpowerLimit",control:d,render:({field:P})=>i.jsx(kn,{id:"enforceManpowerLimit",label:"Enforce Manpower Allocation Limits",description:"Check new enrollments against the approved manpower count for the site.",checked:P.value,onChange:P.onChange})}),i.jsx("div",{className:`max-w-sm transition-opacity ${b?"opacity-100":"opacity-50 pointer-events-none"}`,children:i.jsxs(Ze,{label:"Action When Limit is Reached",id:"manpowerLimitRule",registration:l("manpowerLimitRule"),disabled:!b,children:[i.jsx("option",{value:"warn",children:"Warn field officer but allow enrollment"}),i.jsx("option",{value:"block",children:"Block enrollment and require approval"})]})})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(ur,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Field Officer Permissions"}),i.jsx("p",{className:"text-muted",children:"Control what field officers can do during enrollment."})]})]}),i.jsx("div",{className:"space-y-4",children:i.jsx(_e,{name:"allowSalaryEdit",control:d,render:({field:P})=>i.jsx(kn,{id:"allowSalaryEdit",label:"Allow Salary Editing",description:"Permit field officers to edit default salary, triggering an approval workflow.",checked:P.value??!1,onChange:P.onChange})})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(yu,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Family Details Validation"}),i.jsx("p",{className:"text-muted",children:"Set rules for validating family member details."})]})]}),i.jsx("div",{className:"space-y-4",children:i.jsx(_e,{name:"enforceFamilyValidation",control:d,render:({field:P})=>i.jsx(kn,{id:"enforceFamilyValidation",label:"Enforce Strict Family Validation",description:"Enable checks for duplicates, age, and gender based on relationship.",checked:P.value??!1,onChange:P.onChange})})})]})]})},Wde=()=>{const{id:n}=Wf(),e=Nt(),[t,r]=E.useState(null),[s,a]=E.useState(!0),[o,l]=E.useState(!1),c=E.useRef(null),{data:d,setFormsGenerated:h}=Yn(),p=Am(D=>D.currentLogo),[x,v]=E.useState(!1);E.useEffect(()=>{(async()=>{if(n&&!n.startsWith("draft_")){a(!0);const I=await ce.getOnboardingDataById(n);r(I||null),a(!1)}else r(d),a(!1)})()},[n,d]);const b=async()=>{const D=c.current;if(D&&t){v(!0);try{const I=D.outerHTML,F={margin:0,filename:`Onboarding_Forms_${t?.personal.employeeId}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ce.generatePdf(I,F)}catch(I){console.error("PDF generation failed:",I)}finally{v(!1)}}},_=()=>{h(!0),e(`/onboarding/add/review?id=${n}`)};if(s||x)return i.jsx("div",{className:"text-center p-10",children:i.jsx(_t,{className:"h-8 w-8 animate-spin mx-auto"})});if(!t)return i.jsx("div",{className:"text-center p-10 text-red-500",children:"Could not find employee data."});const j=t,C=`${j.personal.firstName} ${j.personal.middleName||""} ${j.personal.lastName}`.replace(/\s+/g," ").trim(),P=j.family.find(D=>D.relation==="Father")?.name||"",O=j.family.find(D=>D.relation==="Spouse")?.name||"",M=j.family.find(D=>D.relation==="Mother")?.name||"";return i.jsx("div",{className:"bg-page",children:i.jsxs("div",{className:"max-w-4xl p-4 sm:p-6 lg:p-8",children:[i.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card no-print mb-8 sticky top-4 z-10",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsxs(ne,{type:"button",onClick:()=>e(-1),variant:"secondary",children:[i.jsx(Fa,{className:"mr-2 h-4 w-4"})," Go Back"]}),i.jsxs("div",{className:"text-center",children:[i.jsx("h2",{className:"font-bold text-lg",children:"Review Official Forms"}),i.jsx("p",{className:"text-sm text-muted",children:"Please confirm these details before submitting."})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(ne,{type:"button",onClick:b,variant:"outline",disabled:x,children:[x?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(_i,{className:"mr-2 h-4 w-4"}),x?"Generating...":"Download"]}),i.jsx(ne,{type:"button",onClick:_,children:"Confirm & Continue"})]})]})}),i.jsxs("div",{ref:c,className:"bg-white rounded-xl border border-border shadow-lg",children:[i.jsx("div",{className:"pdf-page p-8 font-serif text-sm text-black",children:i.jsxs("div",{className:"border-4 border-black p-6 h-full flex flex-col",children:[i.jsx("h1",{className:"text-center text-xl font-bold tracking-widest mb-8",children:"EMPLOYEE PERSONAL DATA"}),i.jsx("div",{className:"w-64 mx-auto border-2 border-black p-2 my-8",children:i.jsx("img",{src:p,alt:"Paradigm Logo",className:"w-full"})}),i.jsxs("div",{className:"mt-auto space-y-8 text-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S NAME"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:C})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"SITE"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.organization.organizationName})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"DESIGNATION"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.organization.designation})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S ID NO."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.personal.employeeId})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"PF No."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.uan.pfNumber||j.uan.uanNumber})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"ESI NO."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.esi.esiNumber})]})]})]})}),i.jsx("div",{className:"page-break"}),i.jsx("div",{className:"pdf-page p-8 font-serif text-xs text-black",children:i.jsxs("div",{className:"border-2 border-black p-4 h-full relative",children:[i.jsx("div",{className:"absolute top-4 right-4 w-48",children:i.jsx("img",{src:p,alt:"Paradigm Logo",className:"w-full"})}),i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h2",{className:"font-bold",children:["EMPLOYEE ID No. : ",i.jsx("span",{className:"font-normal underline",children:j.personal.employeeId})]}),i.jsx("h1",{className:"text-center font-bold text-base tracking-wider",children:"PERSONAL DATA"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("p",{children:["1. Name: ",i.jsx("span",{className:"underline",children:C})]}),i.jsxs("p",{children:["2. Father's Name: ",i.jsx("span",{className:"underline",children:P})]}),i.jsxs("p",{children:["3. Mother's Name: ",i.jsx("span",{className:"underline",children:M})]}),i.jsxs("p",{children:["4. Reference by: ",i.jsx("span",{className:"underline"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["5. Date of Birth: ",i.jsx("span",{className:"underline",children:j.personal.dob})]}),i.jsxs("p",{children:["6. Age: ",i.jsx("span",{className:"underline",children:j.personal.dob?new Date().getFullYear()-new Date(j.personal.dob).getFullYear():""})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["7. Qualification: ",i.jsx("span",{className:"underline",children:j.education[0]?.degree||""})]}),i.jsxs("p",{children:["8. Experience: ",i.jsx("span",{className:"underline"})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["9. Designation: ",i.jsx("span",{className:"underline",children:j.organization.designation})]}),i.jsxs("p",{children:["10. Net Salary Offered: ",i.jsx("span",{className:"underline",children:j.personal.salary?.toLocaleString("en-IN")})]})]}),i.jsxs("p",{children:["11. Present Address: ",i.jsx("span",{className:"underline",children:`${j.address.present.line1}, ${j.address.present.city}, ${j.address.present.state} - ${j.address.present.pincode}`})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["12. Permanent Address: ",i.jsx("span",{className:"underline",children:j.address.sameAsPresent?"Same as Present":`${j.address.permanent.line1}, ${j.address.permanent.city}`})]}),i.jsxs("p",{children:["Ph. No.: ",i.jsx("span",{className:"underline",children:j.personal.mobile})," Alternate Ph. No.: ",i.jsx("span",{className:"underline",children:j.personal.alternateMobile||""})]})]}),i.jsx("p",{children:"13. Left hand thumb impression"}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{})]}),i.jsx("p",{children:"14. Right hand thumb impression"}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["15. Marital Status: ",i.jsx("span",{className:"underline",children:j.personal.maritalStatus})]}),i.jsxs("p",{children:["16. Name of the Spouse: ",i.jsx("span",{className:"underline",children:O})," Contact No.: ",i.jsx("span",{className:"underline"})]})]}),i.jsxs("p",{children:["17. Languages Known: to Speak ",i.jsx("span",{className:"underline"})," to Write ",i.jsx("span",{className:"underline"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["18. Date of Joining: ",i.jsx("span",{className:"underline",children:j.organization.joiningDate})]}),i.jsx("p",{children:"19. ID Card:"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["20. ESI Number: ",i.jsx("span",{className:"underline",children:j.esi.esiNumber})]}),i.jsxs("p",{children:["21. PF Number: ",i.jsx("span",{className:"underline",children:j.uan.pfNumber||j.uan.uanNumber})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"22. Uniform Details: "}),i.jsx("p",{children:"23. Shoe Details: "})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["24. Name of the Site: ",i.jsx("span",{className:"underline",children:j.organization.organizationName})]}),i.jsx("p",{children:"25. Site / Estate Manager: "})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"26. Record enclosed: "}),i.jsx("p",{children:"28. Reference Name:"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"27. Hirer: "}),i.jsx("p",{className:"ml-24",children:"Reference Ph.:"})]}),i.jsxs("p",{children:["29. Emergency Contact Name: ",i.jsx("span",{className:"underline",children:j.personal.emergencyContactName})," Ph.: ",i.jsx("span",{className:"underline",children:j.personal.emergencyContactNumber})," Blood Group: ",i.jsx("span",{className:"underline",children:j.personal.bloodGroup})]})]}),i.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between",children:[i.jsx("p",{children:"Employee Signature:"}),i.jsx("p",{children:"Documented by:"})]})]})})]})]})})},$de=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-blue-100 text-blue-800",Issued:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},rx=({title:n,sizes:e,headers:t,control:r,quantityType:s,quantities:a,readOnly:o=!1})=>{const l=Array.from(new Set(e.map(d=>d.fit))),c=Array.from(new Set(e.map(d=>d.size))).sort((d,h)=>{const p=parseInt(String(d)),x=parseInt(String(h));return!isNaN(p)&&!isNaN(x)?p-x:String(d).localeCompare(String(h))});return i.jsxs("div",{className:"border rounded-lg flex flex-col overflow-hidden",children:[i.jsx("h4",{className:"p-3 font-semibold bg-page border-b flex-shrink-0",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:"Size"}),t.map(d=>i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:d.label},String(d.key))),i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted w-20",children:"Qty"})]})}),i.jsx("tbody",{className:"divide-y",children:c.map(d=>i.jsx(ot.Fragment,{children:l.map((h,p)=>{const x=e.find(v=>v.size===d&&v.fit===h);return x?i.jsxs("tr",{children:[p===0&&i.jsx("td",{rowSpan:l.filter(v=>e.some(b=>b.size===d&&b.fit===v)).length,className:"px-2 py-2 align-middle font-semibold border-r",children:d}),t.map(v=>i.jsx("td",{className:"px-2 py-2",children:x[v.key]},String(v.key))),i.jsx("td",{className:"px-2 py-2",children:o?i.jsx("span",{className:"font-semibold block text-center pr-4",children:a?.[x.id]||0}):i.jsx(_e,{name:`${s}.${x.id}`,control:r,render:({field:v})=>i.jsx(we,{"aria-label":`Quantity for ${n} size ${d} ${h}`,type:"number",...v,value:v.value||"",onChange:b=>v.onChange(parseInt(b.target.value)||null),className:"!py-1.5"})})})]},x.id):null})},d))})]})})]})},Hde=({request:n,onClose:e,masterUniforms:t})=>{if(!n)return null;const{pantsQuantities:r,shirtsQuantities:s}=E.useMemo(()=>{const o={},l={};return n.items.forEach(c=>{c.category==="Pants"?o[c.sizeId]=c.quantity:l[c.sizeId]=c.quantity}),{pantsQuantities:o,shirtsQuantities:l}},[n.items]),a=n.gender==="Gents"?t.gents:t.ladies;return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-6xl my-4 animate-fade-in-scale flex flex-col max-h-[90vh]",onClick:o=>o.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-start flex-shrink-0",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Uniform Request Details"}),i.jsxs("p",{className:"text-sm text-muted",children:[n.siteName," - ",We(new Date(n.requestedDate),"dd MMM, yyyy")]})]}),i.jsx(ne,{variant:"icon",onClick:e,children:i.jsx(wi,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-6",children:i.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:n.gender==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(rx,{readOnly:!0,title:"Gents' Pants",sizes:a.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],quantities:r}),i.jsx(rx,{readOnly:!0,title:"Gents' Shirts",sizes:a.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],quantities:s})]}):i.jsxs(i.Fragment,{children:[i.jsx(rx,{readOnly:!0,title:"Ladies' Pants",sizes:a.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],quantities:r}),i.jsx(rx,{readOnly:!0,title:"Ladies' Shirts",sizes:a.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],quantities:s})]})})}),i.jsx("div",{className:"p-4 border-t flex justify-end flex-shrink-0",children:i.jsx(ne,{variant:"secondary",onClick:e,children:"Close"})})]})})},Yde=()=>{const n=Nt(),[e,t]=E.useState("list"),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(null),[d,h]=E.useState(!0),[p,x]=E.useState(null),[v,b]=E.useState(null),[_,j]=E.useState(null),[C,P]=E.useState(null),O=async()=>{h(!0);try{const[F,q,U,B]=await Promise.all([ce.getUniformRequests(),ce.getOrganizations(),ce.getMasterGentsUniforms(),ce.getMasterLadiesUniforms()]);s(F),o(q),c({gents:U,ladies:B})}catch{x({message:"Failed to load uniform data.",type:"error"})}finally{h(!1)}};E.useEffect(()=>{O()},[]);const M=()=>{n("/uniforms/request/new")},D=F=>{n(`/uniforms/request/edit/${F.id}`)},I=async()=>{if(_)try{await ce.deleteUniformRequest(_.id),x({message:"Request deleted.",type:"success"}),j(null),O()}catch{x({message:"Failed to delete request.",type:"error"})}};return d?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"p-4 space-y-6",children:[p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Kr,{isOpen:!!_,onClose:()=>j(null),onConfirm:I,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),l&&i.jsx(Hde,{request:C,onClose:()=>P(null),masterUniforms:l}),i.jsx("div",{className:"bg-card p-4 rounded-2xl",children:i.jsx(ra,{title:"Uniform Management",children:e==="list"&&i.jsxs(ne,{onClick:M,children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," New Uniform Request"]})})}),e==="list"&&i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site / Employee"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Gender"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Requested By"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Source"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{children:r.map(F=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Site",className:"px-4 py-3 font-medium",children:[i.jsx("p",{children:F.siteName}),F.source==="Individual"&&F.employeeDetails?.[0]?.employeeName&&i.jsxs("p",{className:"text-xs text-muted",children:["For: ",F.employeeDetails[0].employeeName]}),F.source==="Enrollment"&&i.jsxs("p",{className:"text-xs text-muted",children:["(",F.employeeDetails?.length||0," employees)"]})]}),i.jsx("td",{"data-label":"Gender",className:"px-4 py-3 text-muted",children:F.gender}),i.jsx("td",{"data-label":"Requested By",className:"px-4 py-3 text-muted",children:F.requestedByName||"System"}),i.jsx("td",{"data-label":"Source",className:"px-4 py-3 text-muted",children:F.source||"Bulk"}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx($de,{status:F.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>P(F),title:"View Request",children:i.jsx(Tl,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>D(F),title:"Edit Request",disabled:F.source==="Enrollment",children:i.jsx(ur,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>j(F),title:"Delete Request",disabled:F.source==="Enrollment",children:i.jsx(sn,{className:"h-4 w-4 text-red-600"})})]})})]},F.id))})]}),r.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No uniform requests found."})]})]})},Gde=({item:n})=>{const[e,t]=E.useState(!1);return i.jsxs("div",{className:"bg-card rounded-xl border border-border p-4",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-primary-text",children:n.employeeName}),i.jsx("p",{className:"text-sm text-muted",children:n.employeeId}),i.jsx("p",{className:"text-xs text-muted mt-1",children:We(new Date(n.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")})]}),i.jsx("div",{className:"text-right",children:i.jsxs("p",{className:"text-lg font-bold text-accent",children:["",n.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),n.breakdown.length>0&&i.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[i.jsxs("button",{onClick:()=>t(!e),className:"flex justify-between items-center w-full text-sm text-muted",children:[i.jsx("span",{children:"Details"}),i.jsx(Su,{className:`h-4 w-4 transition-transform ${e?"rotate-180":""}`})]}),e&&i.jsx("ul",{className:"list-disc list-inside space-y-1 mt-2 text-sm text-muted animate-fade-in-down",children:n.breakdown.map((r,s)=>i.jsxs("li",{children:[r.name,": ",(r.cost||0).toFixed(2)]},s))})]})]})},Zde=()=>i.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,e)=>i.jsxs("div",{className:"bg-card rounded-xl border border-border p-4 space-y-3 skeleton-pulse",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-5 w-32 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-24 bg-gray-300 rounded"})]}),i.jsx("div",{className:"h-6 w-20 bg-gray-300 rounded"})]}),i.jsx("div",{className:"h-4 w-1/4 bg-gray-300 rounded mt-2"})]},e))}),Kde=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),{verificationCosts:s,updateVerificationCosts:a}=bi(),[o,l]=E.useState(s),[c,d]=E.useState(!1),[h,p]=E.useState([{startDate:yf(new Date,29),endDate:new Date,key:"selection"}]),[x,v]=E.useState("Last 30 Days"),[b,_]=E.useState(!1),j=E.useRef(null),[C,P]=E.useState(null),O=E.useRef(null),M=At("(max-width: 767px)"),D=E.useCallback(async()=>{const K=h[0]?.startDate,te=h[0]?.endDate;if(!(!K||!te)){r(!0);try{const H=await ce.getVerificationCostBreakdown(We(K,"yyyy-MM-dd"),We(te,"yyyy-MM-dd"));e(H)}catch(H){console.error("Failed to fetch cost breakdown",H),P({message:"Failed to load verification data.",type:"error"})}finally{r(!1)}}},[h]);E.useEffect(()=>{D()},[D]),E.useEffect(()=>{const K=te=>{j.current&&!j.current.contains(te.target)&&_(!1)};return document.addEventListener("mousedown",K),()=>document.removeEventListener("mousedown",K)},[]),E.useEffect(()=>{l(s)},[s]),E.useEffect(()=>{d(JSON.stringify(o)!==JSON.stringify(s))},[o,s]);const I=(K,te,H)=>{l(ae=>ae.map(le=>le.id===K?te==="cost"?{...le,cost:parseFloat(H)||0}:{...le,name:H}:le))},F=()=>{l(K=>[...K,{id:`new_${Date.now()}`,name:"New Verification Type",cost:0}])},q=K=>{l(te=>te.filter(H=>H.id!==K))},U=()=>{a(o),P({message:"Costs updated successfully!",type:"success"})},B=E.useMemo(()=>{const K=new Map(s.map(te=>[te.name,te.cost]));return n.map(te=>{const H=te.breakdown.map(le=>({...le,cost:Number(K.get(le.name))||0})),ae=H.reduce((le,ue)=>le+(ue.cost||0)*ue.count,0);return{...te,breakdown:H,totalCost:ae}})},[n,s]),W=E.useMemo(()=>{const K=B.length,te=B.reduce((ae,le)=>ae+le.totalCost,0),H=K>0?te/K:0;return{totalEmployees:K,totalCost:te,averageCost:H}},[B]),Y=E.useMemo(()=>{const K={};return B.forEach(te=>{te.breakdown.forEach(H=>{K[H.name]||(K[H.name]={count:0,total:0}),K[H.name].count+=H.count,K[H.name].total+=(H.cost||0)*H.count})}),Object.entries(K).map(([te,H])=>({name:te,...H}))},[B]),[G,Z]=E.useState(!1),oe=async K=>{{const te=O.current;if(!te){P({message:"Could not find report to export.",type:"error"});return}Z(!0);try{const H=te.outerHTML,ae={margin:.5,filename:`Cost_Analysis_Report_${We(h[0].startDate,"yyyy-MM-dd")}_to_${We(h[0].endDate,"yyyy-MM-dd")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ce.generatePdf(H,ae)}catch(H){console.error("PDF generation failed:",H),P({message:"Failed to generate PDF.",type:"error"})}finally{Z(!1)}}},X=[{label:"Today",value:"Today"},{label:"Last 7 Days",value:"Last 7 Days"},{label:"Last 30 Days",value:"Last 30 Days"}],he=K=>{const te=new Date;let H=new Date;K==="Today"?H=ox():K==="Last 7 Days"?H=yf(te,6):K==="Last 30 Days"&&(H=yf(te,29)),v(K),p([{startDate:H,endDate:te,key:"selection"}]),_(!1)},$=K=>{p([K.selection])};return i.jsxs("div",{className:"p-4 space-y-6",children:[C&&i.jsx(pt,{message:C.message,type:C.type,onDismiss:()=>P(null)}),i.jsx(ra,{title:"Verification Costing",children:i.jsx("div",{className:"w-full sm:w-auto",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:flex sm:items-center sm:flex-wrap",children:[i.jsxs(ne,{onClick:()=>oe(),variant:"outline",size:"sm",disabled:G||t||B.length===0,children:[G?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(_i,{className:"mr-2 h-4 w-4"}),G?"Generating PDF...":"Download PDF"]}),X.map(K=>i.jsx(ne,{variant:x===K.value?"outline":"secondary",size:"sm",onClick:()=>he(K.value),className:"justify-center",children:K.label},K.value)),i.jsxs("div",{className:"relative",ref:j,children:[i.jsxs(ne,{variant:x==="Custom"?"outline":"secondary",size:"sm",onClick:()=>{_(K=>!K),v("Custom")},className:"w-full justify-center",children:[i.jsx(Da,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Custom Range"})]}),b&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:i.jsx(jm.DateRangePicker,{onChange:$,ranges:h,maxDate:new Date,direction:"horizontal"})})]})]})})}),i.jsx("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"cursor-pointer flex justify-between items-center list-none",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2 text-primary-text",children:[i.jsx(Rm,{className:"h-5 w-5 text-muted"})," Cost Configuration"]}),i.jsx(Su,{className:"transition-transform group-open:rotate-180"})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t",children:[i.jsx("div",{className:"space-y-2",children:o.map(K=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[i.jsx("div",{className:"col-span-12 sm:col-span-6",children:i.jsx(we,{"aria-label":"Cost Item Name",value:K.name,onChange:te=>I(K.id,"name",te.target.value),className:"!py-2"})}),i.jsx("div",{className:"col-span-8 sm:col-span-4",children:i.jsx(we,{"aria-label":"Cost Value",type:"number",step:"0.01",value:K.cost||0,onChange:te=>I(K.id,"cost",te.target.value),className:"!py-2"})}),i.jsx("div",{className:"col-span-4 sm:col-span-2 text-right",children:i.jsx(ne,{variant:"icon",onClick:()=>q(K.id),"aria-label":`Remove ${K.name}`,children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})})})]},K.id))}),i.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[i.jsxs(ne,{type:"button",variant:"outline",size:"sm",onClick:F,children:[i.jsx(Ut,{className:"mr-2 h-4"})," Add Cost Item"]}),i.jsxs(ne,{onClick:U,disabled:!c,children:[i.jsx(Ns,{className:"mr-2 h-4"})," Save Costs"]})]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx(So,{title:"Total Verification Cost",value:`${W.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:kl}),i.jsx(So,{title:"Total Verified Employees",value:W.totalEmployees,icon:Qi}),i.jsx(So,{title:"Avg. Cost Per Employee",value:`${W.averageCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:kl})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Verification Usage Breakdown"}),t?i.jsx("div",{className:"flex justify-center items-center h-24",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted"})}):Y.length>0?i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Y.map(K=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border",children:[i.jsx("p",{className:"text-sm font-medium text-muted",children:K.name}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:K.count}),i.jsxs("p",{className:"text-sm font-semibold text-accent-dark",children:["Total: ",K.total.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},K.name))}):i.jsx("p",{className:"text-center text-muted py-8",children:"No verification data for this period."})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx("div",{className:"flex justify-between items-center",children:i.jsx("h3",{className:"text-lg font-semibold text-primary-text",children:"Detailed Report"})}),i.jsx("div",{ref:O,className:"mt-4 pt-4 border-t border-border",children:M?t?i.jsx(Zde,{}):B.length===0?i.jsx("p",{className:"text-center text-muted py-8",children:"No report data for this period."}):i.jsx("div",{className:"space-y-4",children:B.map(K=>i.jsx(Gde,{item:K},K.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Enrollment Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Cost Breakdown"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase",children:"Total Cost"})]})}),i.jsx("tbody",{children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted mx-auto"})})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No report data for this period."})}):B.map(K=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Employee",className:"px-6 py-4",children:[i.jsx("div",{className:"font-medium text-primary-text",children:K.employeeName}),i.jsx("div",{className:"text-sm text-muted",children:K.employeeId})]}),i.jsx("td",{"data-label":"Enrollment Date",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:We(new Date(K.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")}),i.jsx("td",{"data-label":"Cost Breakdown",className:"px-6 py-4 text-sm text-muted",children:i.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[K.breakdown.map((te,H)=>i.jsxs("li",{children:[te.name,": ",(te.cost||0).toFixed(2)]},H)),K.breakdown.length===0&&i.jsx("li",{children:"No verifications performed"})]})}),i.jsxs("td",{"data-label":"Total Cost",className:"px-6 py-4 whitespace-nowrap text-right font-semibold text-primary-text",children:["",K.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},K.id))})]})})})]})]})},Jde=({status:n})=>{if(!n)return i.jsx("span",{className:"text-xs text-muted",children:"-"});const e={"Not Generated":"bg-slate-700 text-white dark:bg-slate-600 dark:text-slate-200",Generated:"bg-sky-100 text-sky-800 dark:bg-sky-500/20 dark:text-sky-300",Sent:"bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-300",Paid:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${e[n]}`,children:n})},Qde=({invoiceData:n,discount:e,setDiscount:t,roundOff:r,setRoundOff:s})=>{const a=l=>new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l),o=E.useMemo(()=>{if(!n)return null;const l=n.lineItems.reduce((x,v)=>{const b=v.deployment*v.ratePerMonth;return v.description.toLowerCase().includes("deduction")?x-b:x+b},0),c=l*.1,d=l+c-e,h=d*.09,p=d+h+h+r;return{subTotal:l,serviceCharge:c,grandTotal:d,gst:h,finalTotal:p}},[n,e,r]);return o?i.jsxs("div",{className:"p-4 bg-white text-black text-[10px] printable-area",children:[i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("div",{children:[i.jsxs("p",{children:["Name : ",n.siteName]}),i.jsxs("p",{children:["Address : ",n.siteAddress]}),i.jsxs("p",{children:["City : ",n.siteAddress.split(",").pop()?.trim()]})]}),i.jsxs("div",{className:"border border-black",children:[i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Invoice No"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceNumber})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Date"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceDate})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Month"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.statementMonth.split("-")[0]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-black",children:"Due Date"}),i.jsx("div",{className:"p-1",children:"January 15, 2023"})]})]})]}),i.jsx("div",{className:"my-4 flex justify-center",children:i.jsx(Xi,{className:"h-10"})}),i.jsxs("h2",{className:"text-center font-bold text-sm underline mb-2",children:[n.siteName," Summary Statement for the month of ",n.statementMonth]}),i.jsxs("table",{className:"w-full border-collapse border border-black",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"font-bold bg-gray-200",children:[i.jsx("td",{className:"border p-1 border-black",children:"Sl.No"}),i.jsx("td",{className:"border p-1 border-black",children:"Description"}),i.jsx("td",{className:"border p-1 border-black",children:"Deployment"}),i.jsx("td",{className:"border p-1 border-black",children:"No of Days"}),i.jsx("td",{className:"border p-1 border-black",children:"Rate/Day"}),i.jsx("td",{className:"border p-1 border-black",children:"Rate/Month"}),i.jsx("td",{className:"border p-1 border-black",children:"Amount(Rs)"})]})}),i.jsxs("tbody",{children:[i.jsx("tr",{children:i.jsxs("td",{className:"border p-1 border-black font-bold",colSpan:7,children:["SERVICES (01/",We(new Date(n.statementMonth),"MM/yyyy")," to ",We(new Date(n.invoiceDate),"dd/MM/yyyy"),")"]})}),n.lineItems.map((l,c)=>{const d=l.deployment*l.ratePerMonth,h=l.description.toLowerCase().includes("deduction"),p=l.deployment===0;return i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1 border-black text-center",children:c+1}),i.jsx("td",{className:`border p-1 border-black ${h?"text-red-600":""}`,children:l.description}),i.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":l.deployment}),i.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":l.noOfDays}),i.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":a(l.ratePerDay)}),i.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":a(l.ratePerMonth)}),i.jsx("td",{className:`border p-1 border-black text-right ${h?"text-red-600":""}`,children:a(d)})]},l.id)}),Array.from({length:Math.max(0,10-n.lineItems.length)}).map((l,c)=>i.jsx("tr",{children:i.jsx("td",{className:"border p-1 border-black h-6",colSpan:7})},`spacer-${c}`))]}),i.jsxs("tfoot",{children:[i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Sub Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:a(o.subTotal)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Admin,Overheads and Service Charges 10% on Sub Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.serviceCharge)})]}),i.jsxs("tr",{className:"no-print",children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold text-red-600",children:"Discount"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:i.jsx(we,{type:"number",value:e,onChange:l=>t(parseFloat(l.target.value)||0),className:"text-right !p-1"})})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Grand Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:a(o.grandTotal)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"Central GST"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.gst)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"State GST"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.gst)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Round off"}),i.jsxs("td",{colSpan:2,className:"border p-1 border-black text-right",children:[i.jsx("span",{className:"print-only",children:a(r)}),i.jsx("span",{className:"no-print",children:i.jsx(we,{type:"number",step:"0.01",value:r,onChange:l=>s(parseFloat(l.target.value)||0),className:"text-right !p-1"})})]})]}),i.jsxs("tr",{className:"bg-gray-200 font-bold text-base",children:[i.jsx("td",{colSpan:5,className:"border p-2 border-black",children:"Payable for Services rendered"}),i.jsx("td",{colSpan:2,className:"border p-2 border-black text-right",children:a(o.finalTotal)})]})]})]})]}):null},Xde=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState(We(new Date,"yyyy-MM")),[c,d]=E.useState({}),[h,p]=E.useState({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),[x,v]=E.useState(0),[b,_]=E.useState(.2),[j,C]=E.useState(null),P=E.useRef(null),[O,M]=E.useState(!1);E.useEffect(()=>{ce.getOrganizations().then(U=>e(U.sort((B,W)=>B.shortName.localeCompare(W.shortName)))).catch(()=>C({message:"Failed to load sites.",type:"error"})).finally(()=>r(!1))},[]);const D=E.useCallback(async U=>{a(!0);try{const B=new Date(U+"-02"),W=await ce.getInvoiceStatuses(B);d(W)}catch{C({message:"Failed to fetch invoice statuses.",type:"error"})}finally{a(!1)}},[]);E.useEffect(()=>{o&&D(o)},[o,D]);const I=async U=>{p({isOpen:!0,site:U,invoiceData:null,isLoading:!0});try{const B=new Date(o+"-02"),W=await ce.getInvoiceSummaryData(U.id,B);p({isOpen:!0,site:U,invoiceData:W,isLoading:!1})}catch{C({message:"Failed to fetch invoice data.",type:"error"}),p({isOpen:!1,site:null,invoiceData:null,isLoading:!1})}},F=async()=>{const U=P.current;if(!U||!h.invoiceData){C({message:"Could not find invoice to export.",type:"error"});return}M(!0);try{const B=U.outerHTML,W={margin:.25,filename:`Invoice_${h.invoiceData.siteName.replace(" ","_")}_${h.invoiceData.statementMonth}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ce.generatePdf(B,W)}catch(B){console.error("PDF generation failed:",B),C({message:"Failed to generate PDF.",type:"error"})}finally{M(!1)}},q=()=>{p({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),v(0),_(.2)};return t?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"p-4 md:p-0",children:[j&&i.jsx(pt,{message:j.message,type:j.type,onDismiss:()=>C(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx(ra,{title:"Invoice Summary"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Monthly Invoice Status"}),i.jsx("div",{className:"md:w-56",children:i.jsx(we,{label:"",id:"month-select",type:"month",value:o,onChange:U=>l(U.target.value)})})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Invoice Status"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:n.map(U=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:U.shortName}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:s?i.jsx(_t,{className:"h-4 w-4 animate-spin"}):i.jsx(Jde,{status:c[U.id]})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>I(U),disabled:c[U.id]==="Not Generated"||s,title:"View Invoice",children:i.jsx(Tl,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>I(U),disabled:c[U.id]==="Not Generated"||s,title:"Download Invoice",children:i.jsx(_i,{className:"h-4 w-4"})})]})})]},U.id))})]})})]})]}),h.isOpen&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:q,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl m-4 animate-fade-in-scale flex flex-col",onClick:U=>U.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center no-print",children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Invoice for ",h.site?.shortName]}),i.jsx(ne,{variant:"icon",onClick:q,children:i.jsx(wi,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-4 max-h-[70vh]",children:h.isLoading?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):h.invoiceData?i.jsx("div",{ref:P,children:i.jsx(Qde,{invoiceData:h.invoiceData,discount:x,setDiscount:v,roundOff:b,setRoundOff:_})}):i.jsx("p",{className:"text-center text-muted",children:"No data to display."})}),i.jsx("div",{className:"p-4 border-t flex justify-end no-print",children:i.jsxs(ne,{onClick:F,disabled:!h.invoiceData||O,children:[O?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(_i,{className:"mr-2 h-4 w-4"}),O?"Generating...":"Download PDF"]})})]})})]})};var Qh={exports:{}};var eue=Qh.exports,GL;function tue(){return GL||(GL=1,(function(n,e){(function(t,r){r(e)})(eue,(function(t){var r="1.9.4";function s(f){var y,T,A,V;for(T=1,A=arguments.length;T<A;T++){V=arguments[T];for(y in V)f[y]=V[y]}return f}var a=Object.create||(function(){function f(){}return function(y){return f.prototype=y,new f}})();function o(f,y){var T=Array.prototype.slice;if(f.bind)return f.bind.apply(f,T.call(arguments,1));var A=T.call(arguments,2);return function(){return f.apply(y,A.length?A.concat(T.call(arguments)):arguments)}}var l=0;function c(f){return"_leaflet_id"in f||(f._leaflet_id=++l),f._leaflet_id}function d(f,y,T){var A,V,Q,me;return me=function(){A=!1,V&&(Q.apply(T,V),V=!1)},Q=function(){A?V=arguments:(f.apply(T,arguments),setTimeout(me,y),A=!0)},Q}function h(f,y,T){var A=y[1],V=y[0],Q=A-V;return f===A&&T?f:((f-V)%Q+Q)%Q+V}function p(){return!1}function x(f,y){if(y===!1)return f;var T=Math.pow(10,y===void 0?6:y);return Math.round(f*T)/T}function v(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function b(f){return v(f).split(/\s+/)}function _(f,y){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?a(f.options):{});for(var T in y)f.options[T]=y[T];return f.options}function j(f,y,T){var A=[];for(var V in f)A.push(encodeURIComponent(T?V.toUpperCase():V)+"="+encodeURIComponent(f[V]));return(!y||y.indexOf("?")===-1?"?":"&")+A.join("&")}var C=/\{ *([\w_ -]+) *\}/g;function P(f,y){return f.replace(C,function(T,A){var V=y[A];if(V===void 0)throw new Error("No value provided for variable "+T);return typeof V=="function"&&(V=V(y)),V})}var O=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function M(f,y){for(var T=0;T<f.length;T++)if(f[T]===y)return T;return-1}var D="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function I(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var F=0;function q(f){var y=+new Date,T=Math.max(0,16-(y-F));return F=y+T,window.setTimeout(f,T)}var U=window.requestAnimationFrame||I("RequestAnimationFrame")||q,B=window.cancelAnimationFrame||I("CancelAnimationFrame")||I("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function W(f,y,T){if(T&&U===q)f.call(y);else return U.call(window,o(f,y))}function Y(f){f&&B.call(window,f)}var G={__proto__:null,extend:s,create:a,bind:o,get lastId(){return l},stamp:c,throttle:d,wrapNum:h,falseFn:p,formatNum:x,trim:v,splitWords:b,setOptions:_,getParamString:j,template:P,isArray:O,indexOf:M,emptyImageUrl:D,requestFn:U,cancelFn:B,requestAnimFrame:W,cancelAnimFrame:Y};function Z(){}Z.extend=function(f){var y=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},T=y.__super__=this.prototype,A=a(T);A.constructor=y,y.prototype=A;for(var V in this)Object.prototype.hasOwnProperty.call(this,V)&&V!=="prototype"&&V!=="__super__"&&(y[V]=this[V]);return f.statics&&s(y,f.statics),f.includes&&(oe(f.includes),s.apply(null,[A].concat(f.includes))),s(A,f),delete A.statics,delete A.includes,A.options&&(A.options=T.options?a(T.options):{},s(A.options,f.options)),A._initHooks=[],A.callInitHooks=function(){if(!this._initHooksCalled){T.callInitHooks&&T.callInitHooks.call(this),this._initHooksCalled=!0;for(var Q=0,me=A._initHooks.length;Q<me;Q++)A._initHooks[Q].call(this)}},y},Z.include=function(f){var y=this.prototype.options;return s(this.prototype,f),f.options&&(this.prototype.options=y,this.mergeOptions(f.options)),this},Z.mergeOptions=function(f){return s(this.prototype.options,f),this},Z.addInitHook=function(f){var y=Array.prototype.slice.call(arguments,1),T=typeof f=="function"?f:function(){this[f].apply(this,y)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(T),this};function oe(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=O(f)?f:[f];for(var y=0;y<f.length;y++)f[y]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var X={on:function(f,y,T){if(typeof f=="object")for(var A in f)this._on(A,f[A],y);else{f=b(f);for(var V=0,Q=f.length;V<Q;V++)this._on(f[V],y,T)}return this},off:function(f,y,T){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var A in f)this._off(A,f[A],y);else{f=b(f);for(var V=arguments.length===1,Q=0,me=f.length;Q<me;Q++)V?this._off(f[Q]):this._off(f[Q],y,T)}return this},_on:function(f,y,T,A){if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}if(this._listens(f,y,T)===!1){T===this&&(T=void 0);var V={fn:y,ctx:T};A&&(V.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(V)}},_off:function(f,y,T){var A,V,Q;if(this._events&&(A=this._events[f],!!A)){if(arguments.length===1){if(this._firingCount)for(V=0,Q=A.length;V<Q;V++)A[V].fn=p;delete this._events[f];return}if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}var me=this._listens(f,y,T);if(me!==!1){var Ne=A[me];this._firingCount&&(Ne.fn=p,this._events[f]=A=A.slice()),A.splice(me,1)}}},fire:function(f,y,T){if(!this.listens(f,T))return this;var A=s({},y,{type:f,target:this,sourceTarget:y&&y.sourceTarget||this});if(this._events){var V=this._events[f];if(V){this._firingCount=this._firingCount+1||1;for(var Q=0,me=V.length;Q<me;Q++){var Ne=V[Q],De=Ne.fn;Ne.once&&this.off(f,De,Ne.ctx),De.call(Ne.ctx||this,A)}this._firingCount--}}return T&&this._propagateEvent(A),this},listens:function(f,y,T,A){typeof f!="string"&&console.warn('"string" type argument expected');var V=y;typeof y!="function"&&(A=!!y,V=void 0,T=void 0);var Q=this._events&&this._events[f];if(Q&&Q.length&&this._listens(f,V,T)!==!1)return!0;if(A){for(var me in this._eventParents)if(this._eventParents[me].listens(f,y,T,A))return!0}return!1},_listens:function(f,y,T){if(!this._events)return!1;var A=this._events[f]||[];if(!y)return!!A.length;T===this&&(T=void 0);for(var V=0,Q=A.length;V<Q;V++)if(A[V].fn===y&&A[V].ctx===T)return V;return!1},once:function(f,y,T){if(typeof f=="object")for(var A in f)this._on(A,f[A],y,!0);else{f=b(f);for(var V=0,Q=f.length;V<Q;V++)this._on(f[V],y,T,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[c(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[c(f)],this},_propagateEvent:function(f){for(var y in this._eventParents)this._eventParents[y].fire(f.type,s({layer:f.target,propagatedFrom:f.target},f),!0)}};X.addEventListener=X.on,X.removeEventListener=X.clearAllEventListeners=X.off,X.addOneTimeEventListener=X.once,X.fireEvent=X.fire,X.hasEventListeners=X.listens;var he=Z.extend(X);function $(f,y,T){this.x=T?Math.round(f):f,this.y=T?Math.round(y):y}var K=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};$.prototype={clone:function(){return new $(this.x,this.y)},add:function(f){return this.clone()._add(te(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(te(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new $(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new $(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=K(this.x),this.y=K(this.y),this},distanceTo:function(f){f=te(f);var y=f.x-this.x,T=f.y-this.y;return Math.sqrt(y*y+T*T)},equals:function(f){return f=te(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=te(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function te(f,y,T){return f instanceof $?f:O(f)?new $(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new $(f.x,f.y):new $(f,y,T)}function H(f,y){if(f)for(var T=y?[f,y]:f,A=0,V=T.length;A<V;A++)this.extend(T[A])}H.prototype={extend:function(f){var y,T;if(!f)return this;if(f instanceof $||typeof f[0]=="number"||"x"in f)y=T=te(f);else if(f=ae(f),y=f.min,T=f.max,!y||!T)return this;return!this.min&&!this.max?(this.min=y.clone(),this.max=T.clone()):(this.min.x=Math.min(y.x,this.min.x),this.max.x=Math.max(T.x,this.max.x),this.min.y=Math.min(y.y,this.min.y),this.max.y=Math.max(T.y,this.max.y)),this},getCenter:function(f){return te((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return te(this.min.x,this.max.y)},getTopRight:function(){return te(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var y,T;return typeof f[0]=="number"||f instanceof $?f=te(f):f=ae(f),f instanceof H?(y=f.min,T=f.max):y=T=f,y.x>=this.min.x&&T.x<=this.max.x&&y.y>=this.min.y&&T.y<=this.max.y},intersects:function(f){f=ae(f);var y=this.min,T=this.max,A=f.min,V=f.max,Q=V.x>=y.x&&A.x<=T.x,me=V.y>=y.y&&A.y<=T.y;return Q&&me},overlaps:function(f){f=ae(f);var y=this.min,T=this.max,A=f.min,V=f.max,Q=V.x>y.x&&A.x<T.x,me=V.y>y.y&&A.y<T.y;return Q&&me},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var y=this.min,T=this.max,A=Math.abs(y.x-T.x)*f,V=Math.abs(y.y-T.y)*f;return ae(te(y.x-A,y.y-V),te(T.x+A,T.y+V))},equals:function(f){return f?(f=ae(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function ae(f,y){return!f||f instanceof H?f:new H(f,y)}function le(f,y){if(f)for(var T=y?[f,y]:f,A=0,V=T.length;A<V;A++)this.extend(T[A])}le.prototype={extend:function(f){var y=this._southWest,T=this._northEast,A,V;if(f instanceof ie)A=f,V=f;else if(f instanceof le){if(A=f._southWest,V=f._northEast,!A||!V)return this}else return f?this.extend(pe(f)||ue(f)):this;return!y&&!T?(this._southWest=new ie(A.lat,A.lng),this._northEast=new ie(V.lat,V.lng)):(y.lat=Math.min(A.lat,y.lat),y.lng=Math.min(A.lng,y.lng),T.lat=Math.max(V.lat,T.lat),T.lng=Math.max(V.lng,T.lng)),this},pad:function(f){var y=this._southWest,T=this._northEast,A=Math.abs(y.lat-T.lat)*f,V=Math.abs(y.lng-T.lng)*f;return new le(new ie(y.lat-A,y.lng-V),new ie(T.lat+A,T.lng+V))},getCenter:function(){return new ie((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ie(this.getNorth(),this.getWest())},getSouthEast:function(){return new ie(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof ie||"lat"in f?f=pe(f):f=ue(f);var y=this._southWest,T=this._northEast,A,V;return f instanceof le?(A=f.getSouthWest(),V=f.getNorthEast()):A=V=f,A.lat>=y.lat&&V.lat<=T.lat&&A.lng>=y.lng&&V.lng<=T.lng},intersects:function(f){f=ue(f);var y=this._southWest,T=this._northEast,A=f.getSouthWest(),V=f.getNorthEast(),Q=V.lat>=y.lat&&A.lat<=T.lat,me=V.lng>=y.lng&&A.lng<=T.lng;return Q&&me},overlaps:function(f){f=ue(f);var y=this._southWest,T=this._northEast,A=f.getSouthWest(),V=f.getNorthEast(),Q=V.lat>y.lat&&A.lat<T.lat,me=V.lng>y.lng&&A.lng<T.lng;return Q&&me},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,y){return f?(f=ue(f),this._southWest.equals(f.getSouthWest(),y)&&this._northEast.equals(f.getNorthEast(),y)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ue(f,y){return f instanceof le?f:new le(f,y)}function ie(f,y,T){if(isNaN(f)||isNaN(y))throw new Error("Invalid LatLng object: ("+f+", "+y+")");this.lat=+f,this.lng=+y,T!==void 0&&(this.alt=+T)}ie.prototype={equals:function(f,y){if(!f)return!1;f=pe(f);var T=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return T<=(y===void 0?1e-9:y)},toString:function(f){return"LatLng("+x(this.lat,f)+", "+x(this.lng,f)+")"},distanceTo:function(f){return de.distance(this,pe(f))},wrap:function(){return de.wrapLatLng(this)},toBounds:function(f){var y=180*f/40075017,T=y/Math.cos(Math.PI/180*this.lat);return ue([this.lat-y,this.lng-T],[this.lat+y,this.lng+T])},clone:function(){return new ie(this.lat,this.lng,this.alt)}};function pe(f,y,T){return f instanceof ie?f:O(f)&&typeof f[0]!="object"?f.length===3?new ie(f[0],f[1],f[2]):f.length===2?new ie(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new ie(f.lat,"lng"in f?f.lng:f.lon,f.alt):y===void 0?null:new ie(f,y,T)}var re={latLngToPoint:function(f,y){var T=this.projection.project(f),A=this.scale(y);return this.transformation._transform(T,A)},pointToLatLng:function(f,y){var T=this.scale(y),A=this.transformation.untransform(f,T);return this.projection.unproject(A)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var y=this.projection.bounds,T=this.scale(f),A=this.transformation.transform(y.min,T),V=this.transformation.transform(y.max,T);return new H(A,V)},infinite:!1,wrapLatLng:function(f){var y=this.wrapLng?h(f.lng,this.wrapLng,!0):f.lng,T=this.wrapLat?h(f.lat,this.wrapLat,!0):f.lat,A=f.alt;return new ie(T,y,A)},wrapLatLngBounds:function(f){var y=f.getCenter(),T=this.wrapLatLng(y),A=y.lat-T.lat,V=y.lng-T.lng;if(A===0&&V===0)return f;var Q=f.getSouthWest(),me=f.getNorthEast(),Ne=new ie(Q.lat-A,Q.lng-V),De=new ie(me.lat-A,me.lng-V);return new le(Ne,De)}},de=s({},re,{wrapLng:[-180,180],R:6371e3,distance:function(f,y){var T=Math.PI/180,A=f.lat*T,V=y.lat*T,Q=Math.sin((y.lat-f.lat)*T/2),me=Math.sin((y.lng-f.lng)*T/2),Ne=Q*Q+Math.cos(A)*Math.cos(V)*me*me,De=2*Math.atan2(Math.sqrt(Ne),Math.sqrt(1-Ne));return this.R*De}}),je=6378137,Ae={R:je,MAX_LATITUDE:85.0511287798,project:function(f){var y=Math.PI/180,T=this.MAX_LATITUDE,A=Math.max(Math.min(T,f.lat),-T),V=Math.sin(A*y);return new $(this.R*f.lng*y,this.R*Math.log((1+V)/(1-V))/2)},unproject:function(f){var y=180/Math.PI;return new ie((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*y,f.x*y/this.R)},bounds:(function(){var f=je*Math.PI;return new H([-f,-f],[f,f])})()};function Te(f,y,T,A){if(O(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=y,this._c=T,this._d=A}Te.prototype={transform:function(f,y){return this._transform(f.clone(),y)},_transform:function(f,y){return y=y||1,f.x=y*(this._a*f.x+this._b),f.y=y*(this._c*f.y+this._d),f},untransform:function(f,y){return y=y||1,new $((f.x/y-this._b)/this._a,(f.y/y-this._d)/this._c)}};function Se(f,y,T,A){return new Te(f,y,T,A)}var Pe=s({},de,{code:"EPSG:3857",projection:Ae,transformation:(function(){var f=.5/(Math.PI*Ae.R);return Se(f,.5,-f,.5)})()}),qe=s({},Pe,{code:"EPSG:900913"});function He(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function ze(f,y){var T="",A,V,Q,me,Ne,De;for(A=0,Q=f.length;A<Q;A++){for(Ne=f[A],V=0,me=Ne.length;V<me;V++)De=Ne[V],T+=(V?"L":"M")+De.x+" "+De.y;T+=y?dt.svg?"z":"x":""}return T||"M0 0"}var be=document.documentElement.style,Ue="ActiveXObject"in window,Ve=Ue&&!document.addEventListener,ee="msLaunchUri"in navigator&&!("documentMode"in document),se=fr("webkit"),xe=fr("android"),ke=fr("android 2")||fr("android 3"),Ie=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Re=xe&&fr("Google")&&Ie<537&&!("AudioNode"in window),nt=!!window.opera,Xe=!ee&&fr("chrome"),ht=fr("gecko")&&!se&&!nt&&!Ue,Bt=!Xe&&fr("safari"),lt=fr("phantom"),Wt="OTransition"in be,Yt=navigator.platform.indexOf("Win")===0,Qt=Ue&&"transition"in be,Gt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ke,ln="MozPerspective"in be,rn=!window.L_DISABLE_3D&&(Qt||Gt||ln)&&!Wt&&!lt,Et=typeof orientation<"u"||fr("mobile"),qn=Et&&se,sr=Et&&Gt,vn=!window.PointerEvent&&window.MSPointerEvent,it=!!(window.PointerEvent||vn),dn="ontouchstart"in window||!!window.TouchEvent,ir=!window.L_NO_TOUCH&&(dn||it),ks=Et&&nt,Ps=Et&&ht,In=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ms=(function(){var f=!1;try{var y=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",p,y),window.removeEventListener("testPassiveEventSupport",p,y)}catch{}return f})(),Es=(function(){return!!document.createElement("canvas").getContext})(),Er=!!(document.createElementNS&&He("svg").createSVGRect),ei=!!Er&&(function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Eo=!Er&&(function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var y=f.firstChild;return y.style.behavior="url(#default#VML)",y&&typeof y.adj=="object"}catch{return!1}})(),sa=navigator.platform.indexOf("Mac")===0,hd=navigator.platform.indexOf("Linux")===0;function fr(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var dt={ie:Ue,ielt9:Ve,edge:ee,webkit:se,android:xe,android23:ke,androidStock:Re,opera:nt,chrome:Xe,gecko:ht,safari:Bt,phantom:lt,opera12:Wt,win:Yt,ie3d:Qt,webkit3d:Gt,gecko3d:ln,any3d:rn,mobile:Et,mobileWebkit:qn,mobileWebkit3d:sr,msPointer:vn,pointer:it,touch:ir,touchNative:dn,mobileOpera:ks,mobileGecko:Ps,retina:In,passiveEvents:Ms,canvas:Es,svg:Er,vml:Eo,inlineSvg:ei,mac:sa,linux:hd},ia=dt.msPointer?"MSPointerDown":"pointerdown",za=dt.msPointer?"MSPointerMove":"pointermove",Al=dt.msPointer?"MSPointerUp":"pointerup",Rl=dt.msPointer?"MSPointerCancel":"pointercancel",Do={touchstart:ia,touchmove:za,touchend:Al,touchcancel:Rl},Ds={touchstart:Pn,touchmove:Ua,touchend:Ua,touchcancel:Ua},ti={},Oo=!1;function md(f,y,T){return y==="touchstart"&&pd(),Ds[y]?(T=Ds[y].bind(this,T),f.addEventListener(Do[y],T,!1),T):(console.warn("wrong event specified:",y),p)}function Ll(f,y,T){if(!Do[y]){console.warn("wrong event specified:",y);return}f.removeEventListener(Do[y],T,!1)}function Fl(f){ti[f.pointerId]=f}function ql(f){ti[f.pointerId]&&(ti[f.pointerId]=f)}function Io(f){delete ti[f.pointerId]}function pd(){Oo||(document.addEventListener(ia,Fl,!0),document.addEventListener(za,ql,!0),document.addEventListener(Al,Io,!0),document.addEventListener(Rl,Io,!0),Oo=!0)}function Ua(f,y){if(y.pointerType!==(y.MSPOINTER_TYPE_MOUSE||"mouse")){y.touches=[];for(var T in ti)y.touches.push(ti[T]);y.changedTouches=[y],f(y)}}function Pn(f,y){y.MSPOINTER_TYPE_TOUCH&&y.pointerType===y.MSPOINTER_TYPE_TOUCH&&Mn(y),Ua(f,y)}function gd(f){var y={},T,A;for(A in f)T=f[A],y[A]=T&&T.bind?T.bind(f):T;return f=y,y.type="dblclick",y.detail=2,y.isTrusted=!1,y._simulated=!0,y}var Ao=200;function zl(f,y){f.addEventListener("dblclick",y);var T=0,A;function V(Q){if(Q.detail!==1){A=Q.detail;return}if(!(Q.pointerType==="mouse"||Q.sourceCapabilities&&!Q.sourceCapabilities.firesTouchEvents)){var me=si(Q);if(!(me.some(function(De){return De instanceof HTMLLabelElement&&De.attributes.for})&&!me.some(function(De){return De instanceof HTMLInputElement||De instanceof HTMLSelectElement}))){var Ne=Date.now();Ne-T<=Ao?(A++,A===2&&y(gd(Q))):A=1,T=Ne}}}return f.addEventListener("click",V),{dblclick:y,simDblclick:V}}function Ba(f,y){f.removeEventListener("dblclick",y.dblclick),f.removeEventListener("click",y.simDblclick)}var Ro=Ti(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Si=Ti(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),aa=Si==="webkitTransition"||Si==="OTransition"?Si+"End":"transitionend";function Fr(f){return typeof f=="string"?document.getElementById(f):f}function oa(f,y){var T=f.style[y]||f.currentStyle&&f.currentStyle[y];if((!T||T==="auto")&&document.defaultView){var A=document.defaultView.getComputedStyle(f,null);T=A?A[y]:null}return T==="auto"?null:T}function Dt(f,y,T){var A=document.createElement(f);return A.className=y||"",T&&T.appendChild(A),A}function jn(f){var y=f.parentNode;y&&y.removeChild(f)}function Va(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function Ni(f){var y=f.parentNode;y&&y.lastChild!==f&&y.appendChild(f)}function fs(f){var y=f.parentNode;y&&y.firstChild!==f&&y.insertBefore(f,y.firstChild)}function Ci(f,y){if(f.classList!==void 0)return f.classList.contains(y);var T=Wa(f);return T.length>0&&new RegExp("(^|\\s)"+y+"(\\s|$)").test(T)}function Mt(f,y){if(f.classList!==void 0)for(var T=b(y),A=0,V=T.length;A<V;A++)f.classList.add(T[A]);else if(!Ci(f,y)){var Q=Wa(f);Lo(f,(Q?Q+" ":"")+y)}}function bn(f,y){f.classList!==void 0?f.classList.remove(y):Lo(f,v((" "+Wa(f)+" ").replace(" "+y+" "," ")))}function Lo(f,y){f.className.baseVal===void 0?f.className=y:f.className.baseVal=y}function Wa(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function hr(f,y){"opacity"in f.style?f.style.opacity=y:"filter"in f.style&&Ul(f,y)}function Ul(f,y){var T=!1,A="DXImageTransform.Microsoft.Alpha";try{T=f.filters.item(A)}catch{if(y===1)return}y=Math.round(y*100),T?(T.Enabled=y!==100,T.Opacity=y):f.style.filter+=" progid:"+A+"(opacity="+y+")"}function Ti(f){for(var y=document.documentElement.style,T=0;T<f.length;T++)if(f[T]in y)return f[T];return!1}function qr(f,y,T){var A=y||new $(0,0);f.style[Ro]=(dt.ie3d?"translate("+A.x+"px,"+A.y+"px)":"translate3d("+A.x+"px,"+A.y+"px,0)")+(T?" scale("+T+")":"")}function An(f,y){f._leaflet_pos=y,dt.any3d?qr(f,y):(f.style.left=y.x+"px",f.style.top=y.y+"px")}function hs(f){return f._leaflet_pos||new $(0,0)}var Jt,ki,$a;if("onselectstart"in document)Jt=function(){Ct(window,"selectstart",Mn)},ki=function(){un(window,"selectstart",Mn)};else{var ni=Ti(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Jt=function(){if(ni){var f=document.documentElement.style;$a=f[ni],f[ni]="none"}},ki=function(){ni&&(document.documentElement.style[ni]=$a,$a=void 0)}}function Ha(){Ct(window,"dragstart",Mn)}function Ya(){un(window,"dragstart",Mn)}var la,ca;function Pi(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(zr(),la=f,ca=f.style.outlineStyle,f.style.outlineStyle="none",Ct(window,"keydown",zr))}function zr(){la&&(la.style.outlineStyle=ca,la=void 0,ca=void 0,un(window,"keydown",zr))}function ms(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function Jr(f){var y=f.getBoundingClientRect();return{x:y.width/f.offsetWidth||1,y:y.height/f.offsetHeight||1,boundingClientRect:y}}var da={__proto__:null,TRANSFORM:Ro,TRANSITION:Si,TRANSITION_END:aa,get:Fr,getStyle:oa,create:Dt,remove:jn,empty:Va,toFront:Ni,toBack:fs,hasClass:Ci,addClass:Mt,removeClass:bn,setClass:Lo,getClass:Wa,setOpacity:hr,testProp:Ti,setTransform:qr,setPosition:An,getPosition:hs,get disableTextSelection(){return Jt},get enableTextSelection(){return ki},disableImageDrag:Ha,enableImageDrag:Ya,preventOutline:Pi,restoreOutline:zr,getSizedParentNode:ms,getScale:Jr};function Ct(f,y,T,A){if(y&&typeof y=="object")for(var V in y)qo(f,V,y[V],T);else{y=b(y);for(var Q=0,me=y.length;Q<me;Q++)qo(f,y[Q],T,A)}return this}var Gn="_leaflet_events";function un(f,y,T,A){if(arguments.length===1)Fo(f),delete f[Gn];else if(y&&typeof y=="object")for(var V in y)Ga(f,V,y[V],T);else if(y=b(y),arguments.length===2)Fo(f,function(Ne){return M(y,Ne)!==-1});else for(var Q=0,me=y.length;Q<me;Q++)Ga(f,y[Q],T,A);return this}function Fo(f,y){for(var T in f[Gn]){var A=T.split(/\d/)[0];(!y||y(A))&&Ga(f,A,null,null,T)}}var ri={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function qo(f,y,T,A){var V=y+c(T)+(A?"_"+c(A):"");if(f[Gn]&&f[Gn][V])return this;var Q=function(Ne){return T.call(A||f,Ne||window.event)},me=Q;!dt.touchNative&&dt.pointer&&y.indexOf("touch")===0?Q=md(f,y,Q):dt.touch&&y==="dblclick"?Q=zl(f,Q):"addEventListener"in f?y==="touchstart"||y==="touchmove"||y==="wheel"||y==="mousewheel"?f.addEventListener(ri[y]||y,Q,dt.passiveEvents?{passive:!1}:!1):y==="mouseenter"||y==="mouseleave"?(Q=function(Ne){Ne=Ne||window.event,ha(f,Ne)&&me(Ne)},f.addEventListener(ri[y],Q,!1)):f.addEventListener(y,me,!1):f.attachEvent("on"+y,Q),f[Gn]=f[Gn]||{},f[Gn][V]=Q}function Ga(f,y,T,A,V){V=V||y+c(T)+(A?"_"+c(A):"");var Q=f[Gn]&&f[Gn][V];if(!Q)return this;!dt.touchNative&&dt.pointer&&y.indexOf("touch")===0?Ll(f,y,Q):dt.touch&&y==="dblclick"?Ba(f,Q):"removeEventListener"in f?f.removeEventListener(ri[y]||y,Q,!1):f.detachEvent("on"+y,Q),f[Gn][V]=null}function Qr(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function Za(f){return qo(f,"wheel",Qr),this}function ua(f){return Ct(f,"mousedown touchstart dblclick contextmenu",Qr),f._leaflet_disable_click=!0,this}function Mn(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function Ur(f){return Mn(f),Qr(f),this}function si(f){if(f.composedPath)return f.composedPath();for(var y=[],T=f.target;T;)y.push(T),T=T.parentNode;return y}function fa(f,y){if(!y)return new $(f.clientX,f.clientY);var T=Jr(y),A=T.boundingClientRect;return new $((f.clientX-A.left)/T.x-y.clientLeft,(f.clientY-A.top)/T.y-y.clientTop)}var xd=dt.linux&&dt.chrome?window.devicePixelRatio:dt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Bl(f){return dt.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/xd:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function ha(f,y){var T=y.relatedTarget;if(!T)return!0;try{for(;T&&T!==f;)T=T.parentNode}catch{return!1}return T!==f}var Ka={__proto__:null,on:Ct,off:un,stopPropagation:Qr,disableScrollPropagation:Za,disableClickPropagation:ua,preventDefault:Mn,stop:Ur,getPropagationPath:si,getMousePosition:fa,getWheelDelta:Bl,isExternalTarget:ha,addListener:Ct,removeListener:un},Ja=he.extend({run:function(f,y,T,A){this.stop(),this._el=f,this._inProgress=!0,this._duration=T||.25,this._easeOutPower=1/Math.max(A||.5,.2),this._startPos=hs(f),this._offset=y.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=W(this._animate,this),this._step()},_step:function(f){var y=+new Date-this._startTime,T=this._duration*1e3;y<T?this._runFrame(this._easeOut(y/T),f):(this._runFrame(1),this._complete())},_runFrame:function(f,y){var T=this._startPos.add(this._offset.multiplyBy(f));y&&T._round(),An(this._el,T),this.fire("step")},_complete:function(){Y(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),Ht=he.extend({options:{crs:Pe,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,y){y=_(this,y),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),y.maxBounds&&this.setMaxBounds(y.maxBounds),y.zoom!==void 0&&(this._zoom=this._limitZoom(y.zoom)),y.center&&y.zoom!==void 0&&this.setView(pe(y.center),y.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Si&&dt.any3d&&!dt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ct(this._proxy,aa,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,y,T){if(y=y===void 0?this._zoom:this._limitZoom(y),f=this._limitCenter(pe(f),y,this.options.maxBounds),T=T||{},this._stop(),this._loaded&&!T.reset&&T!==!0){T.animate!==void 0&&(T.zoom=s({animate:T.animate},T.zoom),T.pan=s({animate:T.animate,duration:T.duration},T.pan));var A=this._zoom!==y?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,y,T.zoom):this._tryAnimatedPan(f,T.pan);if(A)return clearTimeout(this._sizeTimer),this}return this._resetView(f,y,T.pan&&T.pan.noMoveStart),this},setZoom:function(f,y){return this._loaded?this.setView(this.getCenter(),f,{zoom:y}):(this._zoom=f,this)},zoomIn:function(f,y){return f=f||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,y)},zoomOut:function(f,y){return f=f||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,y)},setZoomAround:function(f,y,T){var A=this.getZoomScale(y),V=this.getSize().divideBy(2),Q=f instanceof $?f:this.latLngToContainerPoint(f),me=Q.subtract(V).multiplyBy(1-1/A),Ne=this.containerPointToLatLng(V.add(me));return this.setView(Ne,y,{zoom:T})},_getBoundsCenterZoom:function(f,y){y=y||{},f=f.getBounds?f.getBounds():ue(f);var T=te(y.paddingTopLeft||y.padding||[0,0]),A=te(y.paddingBottomRight||y.padding||[0,0]),V=this.getBoundsZoom(f,!1,T.add(A));if(V=typeof y.maxZoom=="number"?Math.min(y.maxZoom,V):V,V===1/0)return{center:f.getCenter(),zoom:V};var Q=A.subtract(T).divideBy(2),me=this.project(f.getSouthWest(),V),Ne=this.project(f.getNorthEast(),V),De=this.unproject(me.add(Ne).divideBy(2).add(Q),V);return{center:De,zoom:V}},fitBounds:function(f,y){if(f=ue(f),!f.isValid())throw new Error("Bounds are not valid.");var T=this._getBoundsCenterZoom(f,y);return this.setView(T.center,T.zoom,y)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,y){return this.setView(f,this._zoom,{pan:y})},panBy:function(f,y){if(f=te(f).round(),y=y||{},!f.x&&!f.y)return this.fire("moveend");if(y.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ja,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),y.noMoveStart||this.fire("movestart"),y.animate!==!1){Mt(this._mapPane,"leaflet-pan-anim");var T=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,T,y.duration||.25,y.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,y,T){if(T=T||{},T.animate===!1||!dt.any3d)return this.setView(f,y,T);this._stop();var A=this.project(this.getCenter()),V=this.project(f),Q=this.getSize(),me=this._zoom;f=pe(f),y=y===void 0?me:y;var Ne=Math.max(Q.x,Q.y),De=Ne*this.getZoomScale(me,y),Be=V.distanceTo(A)||1,rt=1.42,St=rt*rt;function $t(wn){var uc=wn?-1:1,By=wn?De:Ne,Vy=De*De-Ne*Ne+uc*St*St*Be*Be,nl=2*By*St*Be,rl=Vy/nl,sl=Math.sqrt(rl*rl+1)-rl,Du=sl<1e-9?-18:Math.log(sl);return Du}function Sr(wn){return(Math.exp(wn)-Math.exp(-wn))/2}function pr(wn){return(Math.exp(wn)+Math.exp(-wn))/2}function ys(wn){return Sr(wn)/pr(wn)}var es=$t(0);function cc(wn){return Ne*(pr(es)/pr(es+rt*wn))}function ih(wn){return Ne*(pr(es)*ys(es+rt*wn)-Sr(es))/St}function uo(wn){return 1-Math.pow(1-wn,1.5)}var Zm=Date.now(),tl=($t(1)-es)/rt,Li=T.duration?1e3*T.duration:1e3*tl*.8;function dc(){var wn=(Date.now()-Zm)/Li,uc=uo(wn)*tl;wn<=1?(this._flyToFrame=W(dc,this),this._move(this.unproject(A.add(V.subtract(A).multiplyBy(ih(uc)/Be)),me),this.getScaleZoom(Ne/cc(uc),me),{flyTo:!0})):this._move(f,y)._moveEnd(!0)}return this._moveStart(!0,T.noMoveStart),dc.call(this),this},flyToBounds:function(f,y){var T=this._getBoundsCenterZoom(f,y);return this.flyTo(T.center,T.zoom,y)},setMaxBounds:function(f){return f=ue(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var y=this.options.minZoom;return this.options.minZoom=f,this._loaded&&y!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var y=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&y!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,y){this._enforcingBounds=!0;var T=this.getCenter(),A=this._limitCenter(T,this._zoom,ue(f));return T.equals(A)||this.panTo(A,y),this._enforcingBounds=!1,this},panInside:function(f,y){y=y||{};var T=te(y.paddingTopLeft||y.padding||[0,0]),A=te(y.paddingBottomRight||y.padding||[0,0]),V=this.project(this.getCenter()),Q=this.project(f),me=this.getPixelBounds(),Ne=ae([me.min.add(T),me.max.subtract(A)]),De=Ne.getSize();if(!Ne.contains(Q)){this._enforcingBounds=!0;var Be=Q.subtract(Ne.getCenter()),rt=Ne.extend(Q).getSize().subtract(De);V.x+=Be.x<0?-rt.x:rt.x,V.y+=Be.y<0?-rt.y:rt.y,this.panTo(this.unproject(V),y),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=s({animate:!1,pan:!0},f===!0?{animate:!0}:f);var y=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var T=this.getSize(),A=y.divideBy(2).round(),V=T.divideBy(2).round(),Q=A.subtract(V);return!Q.x&&!Q.y?this:(f.animate&&f.pan?this.panBy(Q):(f.pan&&this._rawPanBy(Q),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:y,newSize:T}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=s({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var y=o(this._handleGeolocationResponse,this),T=o(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(y,T,f):navigator.geolocation.getCurrentPosition(y,T,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var y=f.code,T=f.message||(y===1?"permission denied":y===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:y,message:"Geolocation error: "+T+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var y=f.coords.latitude,T=f.coords.longitude,A=new ie(y,T),V=A.toBounds(f.coords.accuracy*2),Q=this._locateOptions;if(Q.setView){var me=this.getBoundsZoom(V);this.setView(A,Q.maxZoom?Math.min(me,Q.maxZoom):me)}var Ne={latlng:A,bounds:V,timestamp:f.timestamp};for(var De in f.coords)typeof f.coords[De]=="number"&&(Ne[De]=f.coords[De]);this.fire("locationfound",Ne)}},addHandler:function(f,y){if(!y)return this;var T=this[f]=new y(this);return this._handlers.push(T),this.options[f]&&T.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),jn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Y(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)jn(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,y){var T="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),A=Dt("div",T,y||this._mapPane);return f&&(this._panes[f]=A),A},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),y=this.unproject(f.getBottomLeft()),T=this.unproject(f.getTopRight());return new le(y,T)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,y,T){f=ue(f),T=te(T||[0,0]);var A=this.getZoom()||0,V=this.getMinZoom(),Q=this.getMaxZoom(),me=f.getNorthWest(),Ne=f.getSouthEast(),De=this.getSize().subtract(T),Be=ae(this.project(Ne,A),this.project(me,A)).getSize(),rt=dt.any3d?this.options.zoomSnap:1,St=De.x/Be.x,$t=De.y/Be.y,Sr=y?Math.max(St,$t):Math.min(St,$t);return A=this.getScaleZoom(Sr,A),rt&&(A=Math.round(A/(rt/100))*(rt/100),A=y?Math.ceil(A/rt)*rt:Math.floor(A/rt)*rt),Math.max(V,Math.min(Q,A))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new $(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,y){var T=this._getTopLeftPoint(f,y);return new H(T,T.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,y){var T=this.options.crs;return y=y===void 0?this._zoom:y,T.scale(f)/T.scale(y)},getScaleZoom:function(f,y){var T=this.options.crs;y=y===void 0?this._zoom:y;var A=T.zoom(f*T.scale(y));return isNaN(A)?1/0:A},project:function(f,y){return y=y===void 0?this._zoom:y,this.options.crs.latLngToPoint(pe(f),y)},unproject:function(f,y){return y=y===void 0?this._zoom:y,this.options.crs.pointToLatLng(te(f),y)},layerPointToLatLng:function(f){var y=te(f).add(this.getPixelOrigin());return this.unproject(y)},latLngToLayerPoint:function(f){var y=this.project(pe(f))._round();return y._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(pe(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(ue(f))},distance:function(f,y){return this.options.crs.distance(pe(f),pe(y))},containerPointToLayerPoint:function(f){return te(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return te(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var y=this.containerPointToLayerPoint(te(f));return this.layerPointToLatLng(y)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(pe(f)))},mouseEventToContainerPoint:function(f){return fa(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var y=this._container=Fr(f);if(y){if(y._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ct(y,"scroll",this._onScroll,this),this._containerId=c(y)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&dt.any3d,Mt(f,"leaflet-container"+(dt.touch?" leaflet-touch":"")+(dt.retina?" leaflet-retina":"")+(dt.ielt9?" leaflet-oldie":"")+(dt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var y=oa(f,"position");y!=="absolute"&&y!=="relative"&&y!=="fixed"&&y!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),An(this._mapPane,new $(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Mt(f.markerPane,"leaflet-zoom-hide"),Mt(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,y,T){An(this._mapPane,new $(0,0));var A=!this._loaded;this._loaded=!0,y=this._limitZoom(y),this.fire("viewprereset");var V=this._zoom!==y;this._moveStart(V,T)._move(f,y)._moveEnd(V),this.fire("viewreset"),A&&this.fire("load")},_moveStart:function(f,y){return f&&this.fire("zoomstart"),y||this.fire("movestart"),this},_move:function(f,y,T,A){y===void 0&&(y=this._zoom);var V=this._zoom!==y;return this._zoom=y,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),A?T&&T.pinch&&this.fire("zoom",T):((V||T&&T.pinch)&&this.fire("zoom",T),this.fire("move",T)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Y(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){An(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[c(this._container)]=this;var y=f?un:Ct;y(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&y(window,"resize",this._onResize,this),dt.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Y(this._resizeRequest),this._resizeRequest=W(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,y){for(var T=[],A,V=y==="mouseout"||y==="mouseover",Q=f.target||f.srcElement,me=!1;Q;){if(A=this._targets[c(Q)],A&&(y==="click"||y==="preclick")&&this._draggableMoved(A)){me=!0;break}if(A&&A.listens(y,!0)&&(V&&!ha(Q,f)||(T.push(A),V))||Q===this._container)break;Q=Q.parentNode}return!T.length&&!me&&!V&&this.listens(y,!0)&&(T=[this]),T},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var y=f.target||f.srcElement;if(!(!this._loaded||y._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(y))){var T=f.type;T==="mousedown"&&Pi(y),this._fireDOMEvent(f,T)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,y,T){if(f.type==="click"){var A=s({},f);A.type="preclick",this._fireDOMEvent(A,A.type,T)}var V=this._findEventTargets(f,y);if(T){for(var Q=[],me=0;me<T.length;me++)T[me].listens(y,!0)&&Q.push(T[me]);V=Q.concat(V)}if(V.length){y==="contextmenu"&&Mn(f);var Ne=V[0],De={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var Be=Ne.getLatLng&&(!Ne._radius||Ne._radius<=10);De.containerPoint=Be?this.latLngToContainerPoint(Ne.getLatLng()):this.mouseEventToContainerPoint(f),De.layerPoint=this.containerPointToLayerPoint(De.containerPoint),De.latlng=Be?Ne.getLatLng():this.layerPointToLatLng(De.layerPoint)}for(me=0;me<V.length;me++)if(V[me].fire(y,De,!0),De.originalEvent._stopped||V[me].options.bubblingMouseEvents===!1&&M(this._mouseEvents,y)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,y=this._handlers.length;f<y;f++)this._handlers[f].disable()},whenReady:function(f,y){return this._loaded?f.call(y||this,{target:this}):this.on("load",f,y),this},_getMapPanePos:function(){return hs(this._mapPane)||new $(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,y){var T=f&&y!==void 0?this._getNewPixelOrigin(f,y):this.getPixelOrigin();return T.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,y){var T=this.getSize()._divideBy(2);return this.project(f,y)._subtract(T)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,y,T){var A=this._getNewPixelOrigin(T,y);return this.project(f,y)._subtract(A)},_latLngBoundsToNewLayerBounds:function(f,y,T){var A=this._getNewPixelOrigin(T,y);return ae([this.project(f.getSouthWest(),y)._subtract(A),this.project(f.getNorthWest(),y)._subtract(A),this.project(f.getSouthEast(),y)._subtract(A),this.project(f.getNorthEast(),y)._subtract(A)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,y,T){if(!T)return f;var A=this.project(f,y),V=this.getSize().divideBy(2),Q=new H(A.subtract(V),A.add(V)),me=this._getBoundsOffset(Q,T,y);return Math.abs(me.x)<=1&&Math.abs(me.y)<=1?f:this.unproject(A.add(me),y)},_limitOffset:function(f,y){if(!y)return f;var T=this.getPixelBounds(),A=new H(T.min.add(f),T.max.add(f));return f.add(this._getBoundsOffset(A,y))},_getBoundsOffset:function(f,y,T){var A=ae(this.project(y.getNorthEast(),T),this.project(y.getSouthWest(),T)),V=A.min.subtract(f.min),Q=A.max.subtract(f.max),me=this._rebound(V.x,-Q.x),Ne=this._rebound(V.y,-Q.y);return new $(me,Ne)},_rebound:function(f,y){return f+y>0?Math.round(f-y)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(y))},_limitZoom:function(f){var y=this.getMinZoom(),T=this.getMaxZoom(),A=dt.any3d?this.options.zoomSnap:1;return A&&(f=Math.round(f/A)*A),Math.max(y,Math.min(T,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){bn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,y){var T=this._getCenterOffset(f)._trunc();return(y&&y.animate)!==!0&&!this.getSize().contains(T)?!1:(this.panBy(T,y),!0)},_createAnimProxy:function(){var f=this._proxy=Dt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(y){var T=Ro,A=this._proxy.style[T];qr(this._proxy,this.project(y.center,y.zoom),this.getZoomScale(y.zoom,1)),A===this._proxy.style[T]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){jn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),y=this.getZoom();qr(this._proxy,this.project(f,y),this.getZoomScale(y,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,y,T){if(this._animatingZoom)return!0;if(T=T||{},!this._zoomAnimated||T.animate===!1||this._nothingToAnimate()||Math.abs(y-this._zoom)>this.options.zoomAnimationThreshold)return!1;var A=this.getZoomScale(y),V=this._getCenterOffset(f)._divideBy(1-1/A);return T.animate!==!0&&!this.getSize().contains(V)?!1:(W(function(){this._moveStart(!0,T.noMoveStart||!1)._animateZoom(f,y,!0)},this),!0)},_animateZoom:function(f,y,T,A){this._mapPane&&(T&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=y,Mt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:y,noUpdate:A}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&bn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Os(f,y){return new Ht(f,y)}var _r=Z.extend({options:{position:"topright"},initialize:function(f){_(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var y=this._map;return y&&y.removeControl(this),this.options.position=f,y&&y.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var y=this._container=this.onAdd(f),T=this.getPosition(),A=f._controlCorners[T];return Mt(y,"leaflet-control"),T.indexOf("bottom")!==-1?A.insertBefore(y,A.firstChild):A.appendChild(y),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(jn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),Is=function(f){return new _r(f)};Ht.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},y="leaflet-",T=this._controlContainer=Dt("div",y+"control-container",this._container);function A(V,Q){var me=y+V+" "+y+Q;f[V+Q]=Dt("div",me,T)}A("top","left"),A("top","right"),A("bottom","left"),A("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)jn(this._controlCorners[f]);jn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var zo=_r.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,y,T,A){return T<A?-1:A<T?1:0}},initialize:function(f,y,T){_(this,T),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var A in f)this._addLayer(f[A],A);for(A in y)this._addLayer(y[A],A,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var y=0;y<this._layers.length;y++)this._layers[y].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return _r.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,y){return this._addLayer(f,y),this._map?this._update():this},addOverlay:function(f,y){return this._addLayer(f,y,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var y=this._getLayer(c(f));return y&&this._layers.splice(this._layers.indexOf(y),1),this._map?this._update():this},expand:function(){Mt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(Mt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):bn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return bn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",y=this._container=Dt("div",f),T=this.options.collapsed;y.setAttribute("aria-haspopup",!0),ua(y),Za(y);var A=this._section=Dt("section",f+"-list");T&&(this._map.on("click",this.collapse,this),Ct(y,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var V=this._layersLink=Dt("a",f+"-toggle",y);V.href="#",V.title="Layers",V.setAttribute("role","button"),Ct(V,{keydown:function(Q){Q.keyCode===13&&this._expandSafely()},click:function(Q){Mn(Q),this._expandSafely()}},this),T||this.expand(),this._baseLayersList=Dt("div",f+"-base",A),this._separator=Dt("div",f+"-separator",A),this._overlaysList=Dt("div",f+"-overlays",A),y.appendChild(A)},_getLayer:function(f){for(var y=0;y<this._layers.length;y++)if(this._layers[y]&&c(this._layers[y].layer)===f)return this._layers[y]},_addLayer:function(f,y,T){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:y,overlay:T}),this.options.sortLayers&&this._layers.sort(o(function(A,V){return this.options.sortFunction(A.layer,V.layer,A.name,V.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Va(this._baseLayersList),Va(this._overlaysList),this._layerControlInputs=[];var f,y,T,A,V=0;for(T=0;T<this._layers.length;T++)A=this._layers[T],this._addItem(A),y=y||A.overlay,f=f||!A.overlay,V+=A.overlay?0:1;return this.options.hideSingleBase&&(f=f&&V>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=y&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var y=this._getLayer(c(f.target)),T=y.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;T&&this._map.fire(T,y)},_createRadioElement:function(f,y){var T='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(y?' checked="checked"':"")+"/>",A=document.createElement("div");return A.innerHTML=T,A.firstChild},_addItem:function(f){var y=document.createElement("label"),T=this._map.hasLayer(f.layer),A;f.overlay?(A=document.createElement("input"),A.type="checkbox",A.className="leaflet-control-layers-selector",A.defaultChecked=T):A=this._createRadioElement("leaflet-base-layers_"+c(this),T),this._layerControlInputs.push(A),A.layerId=c(f.layer),Ct(A,"click",this._onInputClick,this);var V=document.createElement("span");V.innerHTML=" "+f.name;var Q=document.createElement("span");y.appendChild(Q),Q.appendChild(A),Q.appendChild(V);var me=f.overlay?this._overlaysList:this._baseLayersList;return me.appendChild(y),this._checkDisabledLayers(),y},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,y,T,A=[],V=[];this._handlingClick=!0;for(var Q=f.length-1;Q>=0;Q--)y=f[Q],T=this._getLayer(y.layerId).layer,y.checked?A.push(T):y.checked||V.push(T);for(Q=0;Q<V.length;Q++)this._map.hasLayer(V[Q])&&this._map.removeLayer(V[Q]);for(Q=0;Q<A.length;Q++)this._map.hasLayer(A[Q])||this._map.addLayer(A[Q]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,y,T,A=this._map.getZoom(),V=f.length-1;V>=0;V--)y=f[V],T=this._getLayer(y.layerId).layer,y.disabled=T.options.minZoom!==void 0&&A<T.options.minZoom||T.options.maxZoom!==void 0&&A>T.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,Ct(f,"click",Mn),this.expand();var y=this;setTimeout(function(){un(f,"click",Mn),y._preventClick=!1})}}),Qa=function(f,y,T){return new zo(f,y,T)},Mi=_r.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var y="leaflet-control-zoom",T=Dt("div",y+" leaflet-bar"),A=this.options;return this._zoomInButton=this._createButton(A.zoomInText,A.zoomInTitle,y+"-in",T,this._zoomIn),this._zoomOutButton=this._createButton(A.zoomOutText,A.zoomOutTitle,y+"-out",T,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),T},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,y,T,A,V){var Q=Dt("a",T,A);return Q.innerHTML=f,Q.href="#",Q.title=y,Q.setAttribute("role","button"),Q.setAttribute("aria-label",y),ua(Q),Ct(Q,"click",Ur),Ct(Q,"click",V,this),Ct(Q,"click",this._refocusOnMap,this),Q},_updateDisabled:function(){var f=this._map,y="leaflet-disabled";bn(this._zoomInButton,y),bn(this._zoomOutButton,y),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(Mt(this._zoomOutButton,y),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(Mt(this._zoomInButton,y),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ht.mergeOptions({zoomControl:!0}),Ht.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Mi,this.addControl(this.zoomControl))});var Vl=function(f){return new Mi(f)},mr=_r.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var y="leaflet-control-scale",T=Dt("div",y),A=this.options;return this._addScales(A,y+"-line",T),f.on(A.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),T},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,y,T){f.metric&&(this._mScale=Dt("div",y,T)),f.imperial&&(this._iScale=Dt("div",y,T))},_update:function(){var f=this._map,y=f.getSize().y/2,T=f.distance(f.containerPointToLatLng([0,y]),f.containerPointToLatLng([this.options.maxWidth,y]));this._updateScales(T)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var y=this._getRoundNum(f),T=y<1e3?y+" m":y/1e3+" km";this._updateScale(this._mScale,T,y/f)},_updateImperial:function(f){var y=f*3.2808399,T,A,V;y>5280?(T=y/5280,A=this._getRoundNum(T),this._updateScale(this._iScale,A+" mi",A/T)):(V=this._getRoundNum(y),this._updateScale(this._iScale,V+" ft",V/y))},_updateScale:function(f,y,T){f.style.width=Math.round(this.options.maxWidth*T)+"px",f.innerHTML=y},_getRoundNum:function(f){var y=Math.pow(10,(Math.floor(f)+"").length-1),T=f/y;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:1,y*T}}),Ei=function(f){return new mr(f)},Uo='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ii=_r.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(dt.inlineSvg?Uo+" ":"")+"Leaflet</a>"},initialize:function(f){_(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=Dt("div","leaflet-control-attribution"),ua(this._container);for(var y in f._layers)f._layers[y].getAttribution&&this.addAttribution(f._layers[y].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var y in this._attributions)this._attributions[y]&&f.push(y);var T=[];this.options.prefix&&T.push(this.options.prefix),f.length&&T.push(f.join(", ")),this._container.innerHTML=T.join(' <span aria-hidden="true">|</span> ')}}});Ht.mergeOptions({attributionControl:!0}),Ht.addInitHook(function(){this.options.attributionControl&&new ii().addTo(this)});var yd=function(f){return new ii(f)};_r.Layers=zo,_r.Zoom=Mi,_r.Scale=mr,_r.Attribution=ii,Is.layers=Qa,Is.zoom=Vl,Is.scale=Ei,Is.attribution=yd;var Dr=Z.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Dr.addTo=function(f,y){return f.addHandler(y,this),this};var Bo={Events:X},Di=dt.touch?"touchstart mousedown":"mousedown",Br=he.extend({options:{clickTolerance:3},initialize:function(f,y,T,A){_(this,A),this._element=f,this._dragStartTarget=y||f,this._preventOutline=T},enable:function(){this._enabled||(Ct(this._dragStartTarget,Di,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Br._dragging===this&&this.finishDrag(!0),un(this._dragStartTarget,Di,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!Ci(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){Br._dragging===this&&this.finishDrag();return}if(!(Br._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(Br._dragging=this,this._preventOutline&&Pi(this._element),Ha(),Jt(),!this._moving)){this.fire("down");var y=f.touches?f.touches[0]:f,T=ms(this._element);this._startPoint=new $(y.clientX,y.clientY),this._startPos=hs(this._element),this._parentScale=Jr(T);var A=f.type==="mousedown";Ct(document,A?"mousemove":"touchmove",this._onMove,this),Ct(document,A?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var y=f.touches&&f.touches.length===1?f.touches[0]:f,T=new $(y.clientX,y.clientY)._subtract(this._startPoint);!T.x&&!T.y||Math.abs(T.x)+Math.abs(T.y)<this.options.clickTolerance||(T.x/=this._parentScale.x,T.y/=this._parentScale.y,Mn(f),this._moved||(this.fire("dragstart"),this._moved=!0,Mt(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Mt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(T),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),An(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){bn(document.body,"leaflet-dragging"),this._lastTarget&&(bn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),un(document,"mousemove touchmove",this._onMove,this),un(document,"mouseup touchend touchcancel",this._onUp,this),Ya(),ki();var y=this._moved&&this._moving;this._moving=!1,Br._dragging=!1,y&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function Vo(f,y,T){var A,V=[1,4,2,8],Q,me,Ne,De,Be,rt,St,$t;for(Q=0,rt=f.length;Q<rt;Q++)f[Q]._code=ai(f[Q],y);for(Ne=0;Ne<4;Ne++){for(St=V[Ne],A=[],Q=0,rt=f.length,me=rt-1;Q<rt;me=Q++)De=f[Q],Be=f[me],De._code&St?Be._code&St||($t=eo(Be,De,St,y,T),$t._code=ai($t,y),A.push($t)):(Be._code&St&&($t=eo(Be,De,St,y,T),$t._code=ai($t,y),A.push($t)),A.push(De));f=A}return f}function Wl(f,y){var T,A,V,Q,me,Ne,De,Be,rt;if(!f||f.length===0)throw new Error("latlngs not passed");Or(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var St=pe([0,0]),$t=ue(f),Sr=$t.getNorthWest().distanceTo($t.getSouthWest())*$t.getNorthEast().distanceTo($t.getNorthWest());Sr<1700&&(St=Wo(f));var pr=f.length,ys=[];for(T=0;T<pr;T++){var es=pe(f[T]);ys.push(y.project(pe([es.lat-St.lat,es.lng-St.lng])))}for(Ne=De=Be=0,T=0,A=pr-1;T<pr;A=T++)V=ys[T],Q=ys[A],me=V.y*Q.x-Q.y*V.x,De+=(V.x+Q.x)*me,Be+=(V.y+Q.y)*me,Ne+=me*3;Ne===0?rt=ys[0]:rt=[De/Ne,Be/Ne];var cc=y.unproject(te(rt));return pe([cc.lat+St.lat,cc.lng+St.lng])}function Wo(f){for(var y=0,T=0,A=0,V=0;V<f.length;V++){var Q=pe(f[V]);y+=Q.lat,T+=Q.lng,A++}return pe([y/A,T/A])}var vd={__proto__:null,clipPolygon:Vo,polygonCenter:Wl,centroid:Wo};function Xa(f,y){if(!y||!f.length)return f.slice();var T=y*y;return f=_d(f,T),f=wd(f,T),f}function $l(f,y,T){return Math.sqrt(oi(f,y,T,!0))}function bd(f,y,T){return oi(f,y,T)}function wd(f,y){var T=f.length,A=typeof Uint8Array<"u"?Uint8Array:Array,V=new A(T);V[0]=V[T-1]=1,$o(f,V,y,0,T-1);var Q,me=[];for(Q=0;Q<T;Q++)V[Q]&&me.push(f[Q]);return me}function $o(f,y,T,A,V){var Q=0,me,Ne,De;for(Ne=A+1;Ne<=V-1;Ne++)De=oi(f[Ne],f[A],f[V],!0),De>Q&&(me=Ne,Q=De);Q>T&&(y[me]=1,$o(f,y,T,A,me),$o(f,y,T,me,V))}function _d(f,y){for(var T=[f[0]],A=1,V=0,Q=f.length;A<Q;A++)jd(f[A],f[V])>y&&(T.push(f[A]),V=A);return V<Q-1&&T.push(f[Q-1]),T}var Ho;function Hl(f,y,T,A,V){var Q=A?Ho:ai(f,T),me=ai(y,T),Ne,De,Be;for(Ho=me;;){if(!(Q|me))return[f,y];if(Q&me)return!1;Ne=Q||me,De=eo(f,y,Ne,T,V),Be=ai(De,T),Ne===Q?(f=De,Q=Be):(y=De,me=Be)}}function eo(f,y,T,A,V){var Q=y.x-f.x,me=y.y-f.y,Ne=A.min,De=A.max,Be,rt;return T&8?(Be=f.x+Q*(De.y-f.y)/me,rt=De.y):T&4?(Be=f.x+Q*(Ne.y-f.y)/me,rt=Ne.y):T&2?(Be=De.x,rt=f.y+me*(De.x-f.x)/Q):T&1&&(Be=Ne.x,rt=f.y+me*(Ne.x-f.x)/Q),new $(Be,rt,V)}function ai(f,y){var T=0;return f.x<y.min.x?T|=1:f.x>y.max.x&&(T|=2),f.y<y.min.y?T|=4:f.y>y.max.y&&(T|=8),T}function jd(f,y){var T=y.x-f.x,A=y.y-f.y;return T*T+A*A}function oi(f,y,T,A){var V=y.x,Q=y.y,me=T.x-V,Ne=T.y-Q,De=me*me+Ne*Ne,Be;return De>0&&(Be=((f.x-V)*me+(f.y-Q)*Ne)/De,Be>1?(V=T.x,Q=T.y):Be>0&&(V+=me*Be,Q+=Ne*Be)),me=f.x-V,Ne=f.y-Q,A?me*me+Ne*Ne:new $(V,Q)}function Or(f){return!O(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function Yl(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Or(f)}function Gl(f,y){var T,A,V,Q,me,Ne,De,Be;if(!f||f.length===0)throw new Error("latlngs not passed");Or(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var rt=pe([0,0]),St=ue(f),$t=St.getNorthWest().distanceTo(St.getSouthWest())*St.getNorthEast().distanceTo(St.getNorthWest());$t<1700&&(rt=Wo(f));var Sr=f.length,pr=[];for(T=0;T<Sr;T++){var ys=pe(f[T]);pr.push(y.project(pe([ys.lat-rt.lat,ys.lng-rt.lng])))}for(T=0,A=0;T<Sr-1;T++)A+=pr[T].distanceTo(pr[T+1])/2;if(A===0)Be=pr[0];else for(T=0,Q=0;T<Sr-1;T++)if(me=pr[T],Ne=pr[T+1],V=me.distanceTo(Ne),Q+=V,Q>A){De=(Q-A)/V,Be=[Ne.x-De*(Ne.x-me.x),Ne.y-De*(Ne.y-me.y)];break}var es=y.unproject(te(Be));return pe([es.lat+rt.lat,es.lng+rt.lng])}var Zl={__proto__:null,simplify:Xa,pointToSegmentDistance:$l,closestPointOnSegment:bd,clipSegment:Hl,_getEdgeIntersection:eo,_getBitCode:ai,_sqClosestPointOnSegment:oi,isFlat:Or,_flat:Yl,polylineCenter:Gl},Yo={project:function(f){return new $(f.lng,f.lat)},unproject:function(f){return new ie(f.y,f.x)},bounds:new H([-180,-90],[180,90])},Go={R:6378137,R_MINOR:6356752314245179e-9,bounds:new H([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var y=Math.PI/180,T=this.R,A=f.lat*y,V=this.R_MINOR/T,Q=Math.sqrt(1-V*V),me=Q*Math.sin(A),Ne=Math.tan(Math.PI/4-A/2)/Math.pow((1-me)/(1+me),Q/2);return A=-T*Math.log(Math.max(Ne,1e-10)),new $(f.lng*y*T,A)},unproject:function(f){for(var y=180/Math.PI,T=this.R,A=this.R_MINOR/T,V=Math.sqrt(1-A*A),Q=Math.exp(-f.y/T),me=Math.PI/2-2*Math.atan(Q),Ne=0,De=.1,Be;Ne<15&&Math.abs(De)>1e-7;Ne++)Be=V*Math.sin(me),Be=Math.pow((1-Be)/(1+Be),V/2),De=Math.PI/2-2*Math.atan(Q*Be)-me,me+=De;return new ie(me*y,f.x*y/T)}},Sd={__proto__:null,LonLat:Yo,Mercator:Go,SphericalMercator:Ae},Nd=s({},de,{code:"EPSG:3395",projection:Go,transformation:(function(){var f=.5/(Math.PI*Go.R);return Se(f,.5,-f,.5)})()}),Kl=s({},de,{code:"EPSG:4326",projection:Yo,transformation:Se(1/180,1,-1/180,.5)}),Cd=s({},re,{projection:Yo,transformation:Se(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,y){var T=y.lng-f.lng,A=y.lat-f.lat;return Math.sqrt(T*T+A*A)},infinite:!0});re.Earth=de,re.EPSG3395=Nd,re.EPSG3857=Pe,re.EPSG900913=qe,re.EPSG4326=Kl,re.Simple=Cd;var Vr=he.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[c(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[c(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var y=f.target;if(y.hasLayer(this)){if(this._map=y,this._zoomAnimated=y._zoomAnimated,this.getEvents){var T=this.getEvents();y.on(T,this),this.once("remove",function(){y.off(T,this)},this)}this.onAdd(y),this.fire("add"),y.fire("layeradd",{layer:this})}}});Ht.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var y=c(f);return this._layers[y]?this:(this._layers[y]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var y=c(f);return this._layers[y]?(this._loaded&&f.onRemove(this),delete this._layers[y],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return c(f)in this._layers},eachLayer:function(f,y){for(var T in this._layers)f.call(y,this._layers[T]);return this},_addLayers:function(f){f=f?O(f)?f:[f]:[];for(var y=0,T=f.length;y<T;y++)this.addLayer(f[y])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[c(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var y=c(f);this._zoomBoundLayers[y]&&(delete this._zoomBoundLayers[y],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,y=-1/0,T=this._getZoomSpan();for(var A in this._zoomBoundLayers){var V=this._zoomBoundLayers[A].options;f=V.minZoom===void 0?f:Math.min(f,V.minZoom),y=V.maxZoom===void 0?y:Math.max(y,V.maxZoom)}this._layersMaxZoom=y===-1/0?void 0:y,this._layersMinZoom=f===1/0?void 0:f,T!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var As=Vr.extend({initialize:function(f,y){_(this,y),this._layers={};var T,A;if(f)for(T=0,A=f.length;T<A;T++)this.addLayer(f[T])},addLayer:function(f){var y=this.getLayerId(f);return this._layers[y]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var y=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[y]&&this._map.removeLayer(this._layers[y]),delete this._layers[y],this},hasLayer:function(f){var y=typeof f=="number"?f:this.getLayerId(f);return y in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var y=Array.prototype.slice.call(arguments,1),T,A;for(T in this._layers)A=this._layers[T],A[f]&&A[f].apply(A,y);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,y){for(var T in this._layers)f.call(y,this._layers[T]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return c(f)}}),ma=function(f,y){return new As(f,y)},ps=As.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),As.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),As.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new le;for(var y in this._layers){var T=this._layers[y];f.extend(T.getBounds?T.getBounds():T.getLatLng())}return f}}),Jl=function(f,y){return new ps(f,y)},li=Z.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){_(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,y){var T=this._getIconUrl(f);if(!T){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var A=this._createImg(T,y&&y.tagName==="IMG"?y:null);return this._setIconStyles(A,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),A},_setIconStyles:function(f,y){var T=this.options,A=T[y+"Size"];typeof A=="number"&&(A=[A,A]);var V=te(A),Q=te(y==="shadow"&&T.shadowAnchor||T.iconAnchor||V&&V.divideBy(2,!0));f.className="leaflet-marker-"+y+" "+(T.className||""),Q&&(f.style.marginLeft=-Q.x+"px",f.style.marginTop=-Q.y+"px"),V&&(f.style.width=V.x+"px",f.style.height=V.y+"px")},_createImg:function(f,y){return y=y||document.createElement("img"),y.src=f,y},_getIconUrl:function(f){return dt.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function Ql(f){return new li(f)}var Oi=li.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof Oi.imagePath!="string"&&(Oi.imagePath=this._detectIconPath()),(this.options.imagePath||Oi.imagePath)+li.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var y=function(T,A,V){var Q=A.exec(T);return Q&&Q[V]};return f=y(f,/^url\((['"])?(.+)\1\)$/,2),f&&y(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=Dt("div","leaflet-default-icon-path",document.body),y=oa(f,"background-image")||oa(f,"backgroundImage");if(document.body.removeChild(f),y=this._stripUrl(y),y)return y;var T=document.querySelector('link[href$="leaflet.css"]');return T?T.href.substring(0,T.href.length-11-1):""}}),Zo=Dr.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new Br(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Mt(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&bn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var y=this._marker,T=y._map,A=this._marker.options.autoPanSpeed,V=this._marker.options.autoPanPadding,Q=hs(y._icon),me=T.getPixelBounds(),Ne=T.getPixelOrigin(),De=ae(me.min._subtract(Ne).add(V),me.max._subtract(Ne).subtract(V));if(!De.contains(Q)){var Be=te((Math.max(De.max.x,Q.x)-De.max.x)/(me.max.x-De.max.x)-(Math.min(De.min.x,Q.x)-De.min.x)/(me.min.x-De.min.x),(Math.max(De.max.y,Q.y)-De.max.y)/(me.max.y-De.max.y)-(Math.min(De.min.y,Q.y)-De.min.y)/(me.min.y-De.min.y)).multiplyBy(A);T.panBy(Be,{animate:!1}),this._draggable._newPos._add(Be),this._draggable._startPos._add(Be),An(y._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=W(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(Y(this._panRequest),this._panRequest=W(this._adjustPan.bind(this,f)))},_onDrag:function(f){var y=this._marker,T=y._shadow,A=hs(y._icon),V=y._map.layerPointToLatLng(A);T&&An(T,A),y._latlng=V,f.latlng=V,f.oldLatLng=this._oldLatLng,y.fire("move",f).fire("drag",f)},_onDragEnd:function(f){Y(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),gs=Vr.extend({options:{icon:new Oi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,y){_(this,y),this._latlng=pe(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var y=this._latlng;return this._latlng=pe(f),this.update(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,y="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),T=f.icon.createIcon(this._icon),A=!1;T!==this._icon&&(this._icon&&this._removeIcon(),A=!0,f.title&&(T.title=f.title),T.tagName==="IMG"&&(T.alt=f.alt||"")),Mt(T,y),f.keyboard&&(T.tabIndex="0",T.setAttribute("role","button")),this._icon=T,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ct(T,"focus",this._panOnFocus,this);var V=f.icon.createShadow(this._shadow),Q=!1;V!==this._shadow&&(this._removeShadow(),Q=!0),V&&(Mt(V,y),V.alt=""),this._shadow=V,f.opacity<1&&this._updateOpacity(),A&&this.getPane().appendChild(this._icon),this._initInteraction(),V&&Q&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&un(this._icon,"focus",this._panOnFocus,this),jn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&jn(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&An(this._icon,f),this._shadow&&An(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(y)},_initInteraction:function(){if(this.options.interactive&&(Mt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Zo)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Zo(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&hr(this._icon,f),this._shadow&&hr(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var y=this.options.icon.options,T=y.iconSize?te(y.iconSize):te(0,0),A=y.iconAnchor?te(y.iconAnchor):te(0,0);f.panInside(this._latlng,{paddingTopLeft:A,paddingBottomRight:T.subtract(A)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Td(f,y){return new gs(f,y)}var Rs=Vr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return _(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),to=Rs.extend({options:{fill:!0,radius:10},initialize:function(f,y){_(this,y),this._latlng=pe(f),this._radius=this.options.radius},setLatLng:function(f){var y=this._latlng;return this._latlng=pe(f),this.redraw(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var y=f&&f.radius||this._radius;return Rs.prototype.setStyle.call(this,f),this.setRadius(y),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,y=this._radiusY||f,T=this._clickTolerance(),A=[f+T,y+T];this._pxBounds=new H(this._point.subtract(A),this._point.add(A))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Xl(f,y){return new to(f,y)}var no=to.extend({initialize:function(f,y,T){if(typeof y=="number"&&(y=s({},T,{radius:y})),_(this,y),this._latlng=pe(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new le(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:Rs.prototype.setStyle,_project:function(){var f=this._latlng.lng,y=this._latlng.lat,T=this._map,A=T.options.crs;if(A.distance===de.distance){var V=Math.PI/180,Q=this._mRadius/de.R/V,me=T.project([y+Q,f]),Ne=T.project([y-Q,f]),De=me.add(Ne).divideBy(2),Be=T.unproject(De).lat,rt=Math.acos((Math.cos(Q*V)-Math.sin(y*V)*Math.sin(Be*V))/(Math.cos(y*V)*Math.cos(Be*V)))/V;(isNaN(rt)||rt===0)&&(rt=Q/Math.cos(Math.PI/180*y)),this._point=De.subtract(T.getPixelOrigin()),this._radius=isNaN(rt)?0:De.x-T.project([Be,f-rt]).x,this._radiusY=De.y-me.y}else{var St=A.unproject(A.project(this._latlng).subtract([this._mRadius,0]));this._point=T.latLngToLayerPoint(this._latlng),this._radius=this._point.x-T.latLngToLayerPoint(St).x}this._updateBounds()}});function pa(f,y,T){return new no(f,y,T)}var jr=Rs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,y){_(this,y),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var y=1/0,T=null,A=oi,V,Q,me=0,Ne=this._parts.length;me<Ne;me++)for(var De=this._parts[me],Be=1,rt=De.length;Be<rt;Be++){V=De[Be-1],Q=De[Be];var St=A(f,V,Q,!0);St<y&&(y=St,T=A(f,V,Q))}return T&&(T.distance=Math.sqrt(y)),T},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Gl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,y){return y=y||this._defaultShape(),f=pe(f),y.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new le,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return Or(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var y=[],T=Or(f),A=0,V=f.length;A<V;A++)T?(y[A]=pe(f[A]),this._bounds.extend(y[A])):y[A]=this._convertLatLngs(f[A]);return y},_project:function(){var f=new H;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),y=new $(f,f);this._rawPxBounds&&(this._pxBounds=new H([this._rawPxBounds.min.subtract(y),this._rawPxBounds.max.add(y)]))},_projectLatlngs:function(f,y,T){var A=f[0]instanceof ie,V=f.length,Q,me;if(A){for(me=[],Q=0;Q<V;Q++)me[Q]=this._map.latLngToLayerPoint(f[Q]),T.extend(me[Q]);y.push(me)}else for(Q=0;Q<V;Q++)this._projectLatlngs(f[Q],y,T)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var y=this._parts,T,A,V,Q,me,Ne,De;for(T=0,V=0,Q=this._rings.length;T<Q;T++)for(De=this._rings[T],A=0,me=De.length;A<me-1;A++)Ne=Hl(De[A],De[A+1],f,A,!0),Ne&&(y[V]=y[V]||[],y[V].push(Ne[0]),(Ne[1]!==De[A+1]||A===me-2)&&(y[V].push(Ne[1]),V++))}},_simplifyPoints:function(){for(var f=this._parts,y=this.options.smoothFactor,T=0,A=f.length;T<A;T++)f[T]=Xa(f[T],y)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,y){var T,A,V,Q,me,Ne,De=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(T=0,Q=this._parts.length;T<Q;T++)for(Ne=this._parts[T],A=0,me=Ne.length,V=me-1;A<me;V=A++)if(!(!y&&A===0)&&$l(f,Ne[V],Ne[A])<=De)return!0;return!1}});function kd(f,y){return new jr(f,y)}jr._flat=Yl;var xs=jr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Wl(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var y=jr.prototype._convertLatLngs.call(this,f),T=y.length;return T>=2&&y[0]instanceof ie&&y[0].equals(y[T-1])&&y.pop(),y},_setLatLngs:function(f){jr.prototype._setLatLngs.call(this,f),Or(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Or(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,y=this.options.weight,T=new $(y,y);if(f=new H(f.min.subtract(T),f.max.add(T)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var A=0,V=this._rings.length,Q;A<V;A++)Q=Vo(this._rings[A],f,!0),Q.length&&this._parts.push(Q)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var y=!1,T,A,V,Q,me,Ne,De,Be;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(Q=0,De=this._parts.length;Q<De;Q++)for(T=this._parts[Q],me=0,Be=T.length,Ne=Be-1;me<Be;Ne=me++)A=T[me],V=T[Ne],A.y>f.y!=V.y>f.y&&f.x<(V.x-A.x)*(f.y-A.y)/(V.y-A.y)+A.x&&(y=!y);return y||jr.prototype._containsPoint.call(this,f,!0)}});function Pd(f,y){return new xs(f,y)}var Xr=ps.extend({initialize:function(f,y){_(this,y),this._layers={},f&&this.addData(f)},addData:function(f){var y=O(f)?f:f.features,T,A,V;if(y){for(T=0,A=y.length;T<A;T++)V=y[T],(V.geometries||V.geometry||V.features||V.coordinates)&&this.addData(V);return this}var Q=this.options;if(Q.filter&&!Q.filter(f))return this;var me=Ii(f,Q);return me?(me.feature=oo(f),me.defaultOptions=me.options,this.resetStyle(me),Q.onEachFeature&&Q.onEachFeature(f,me),this.addLayer(me)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=s({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(y){this._setLayerStyle(y,f)},this)},_setLayerStyle:function(f,y){f.setStyle&&(typeof y=="function"&&(y=y(f.feature)),f.setStyle(y))}});function Ii(f,y){var T=f.type==="Feature"?f.geometry:f,A=T?T.coordinates:null,V=[],Q=y&&y.pointToLayer,me=y&&y.coordsToLatLng||so,Ne,De,Be,rt;if(!A&&!T)return null;switch(T.type){case"Point":return Ne=me(A),ro(Q,f,Ne,y);case"MultiPoint":for(Be=0,rt=A.length;Be<rt;Be++)Ne=me(A[Be]),V.push(ro(Q,f,Ne,y));return new ps(V);case"LineString":case"MultiLineString":return De=ga(A,T.type==="LineString"?0:1,me),new jr(De,y);case"Polygon":case"MultiPolygon":return De=ga(A,T.type==="Polygon"?1:2,me),new xs(De,y);case"GeometryCollection":for(Be=0,rt=T.geometries.length;Be<rt;Be++){var St=Ii({geometry:T.geometries[Be],type:"Feature",properties:f.properties},y);St&&V.push(St)}return new ps(V);case"FeatureCollection":for(Be=0,rt=T.features.length;Be<rt;Be++){var $t=Ii(T.features[Be],y);$t&&V.push($t)}return new ps(V);default:throw new Error("Invalid GeoJSON object.")}}function ro(f,y,T,A){return f?f(y,T):new gs(T,A&&A.markersInheritOptions&&A)}function so(f){return new ie(f[1],f[0],f[2])}function ga(f,y,T){for(var A=[],V=0,Q=f.length,me;V<Q;V++)me=y?ga(f[V],y-1,T):(T||so)(f[V]),A.push(me);return A}function io(f,y){return f=pe(f),f.alt!==void 0?[x(f.lng,y),x(f.lat,y),x(f.alt,y)]:[x(f.lng,y),x(f.lat,y)]}function ao(f,y,T,A){for(var V=[],Q=0,me=f.length;Q<me;Q++)V.push(y?ao(f[Q],Or(f[Q])?0:y-1,T,A):io(f[Q],A));return!y&&T&&V.length>0&&V.push(V[0].slice()),V}function Ai(f,y){return f.feature?s({},f.feature,{geometry:y}):oo(y)}function oo(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var Ko={toGeoJSON:function(f){return Ai(this,{type:"Point",coordinates:io(this.getLatLng(),f)})}};gs.include(Ko),no.include(Ko),to.include(Ko),jr.include({toGeoJSON:function(f){var y=!Or(this._latlngs),T=ao(this._latlngs,y?1:0,!1,f);return Ai(this,{type:(y?"Multi":"")+"LineString",coordinates:T})}}),xs.include({toGeoJSON:function(f){var y=!Or(this._latlngs),T=y&&!Or(this._latlngs[0]),A=ao(this._latlngs,T?2:y?1:0,!0,f);return y||(A=[A]),Ai(this,{type:(T?"Multi":"")+"Polygon",coordinates:A})}}),As.include({toMultiPoint:function(f){var y=[];return this.eachLayer(function(T){y.push(T.toGeoJSON(f).geometry.coordinates)}),Ai(this,{type:"MultiPoint",coordinates:y})},toGeoJSON:function(f){var y=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(y==="MultiPoint")return this.toMultiPoint(f);var T=y==="GeometryCollection",A=[];return this.eachLayer(function(V){if(V.toGeoJSON){var Q=V.toGeoJSON(f);if(T)A.push(Q.geometry);else{var me=oo(Q);me.type==="FeatureCollection"?A.push.apply(A,me.features):A.push(me)}}}),T?Ai(this,{geometries:A,type:"GeometryCollection"}):{type:"FeatureCollection",features:A}}});function ec(f,y){return new Xr(f,y)}var Wr=ec,Ls=Vr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,y,T){this._url=f,this._bounds=ue(y),_(this,T)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Mt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){jn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&Ni(this._image),this},bringToBack:function(){return this._map&&fs(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=ue(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",y=this._image=f?this._url:Dt("img");if(Mt(y,"leaflet-image-layer"),this._zoomAnimated&&Mt(y,"leaflet-zoom-animated"),this.options.className&&Mt(y,this.options.className),y.onselectstart=p,y.onmousemove=p,y.onload=o(this.fire,this,"load"),y.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=y.src;return}y.src=this._url,y.alt=this.options.alt},_animateZoom:function(f){var y=this._map.getZoomScale(f.zoom),T=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;qr(this._image,T,y)},_reset:function(){var f=this._image,y=new H(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),T=y.getSize();An(f,y.min),f.style.width=T.x+"px",f.style.height=T.y+"px"},_updateOpacity:function(){hr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),tc=function(f,y,T){return new Ls(f,y,T)},Jo=Ls.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",y=this._image=f?this._url:Dt("video");if(Mt(y,"leaflet-image-layer"),this._zoomAnimated&&Mt(y,"leaflet-zoom-animated"),this.options.className&&Mt(y,this.options.className),y.onselectstart=p,y.onmousemove=p,y.onloadeddata=o(this.fire,this,"load"),f){for(var T=y.getElementsByTagName("source"),A=[],V=0;V<T.length;V++)A.push(T[V].src);this._url=T.length>0?A:[y.src];return}O(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(y.style,"objectFit")&&(y.style.objectFit="fill"),y.autoplay=!!this.options.autoplay,y.loop=!!this.options.loop,y.muted=!!this.options.muted,y.playsInline=!!this.options.playsInline;for(var Q=0;Q<this._url.length;Q++){var me=Dt("source");me.src=this._url[Q],y.appendChild(me)}}});function nc(f,y,T){return new Jo(f,y,T)}var Qo=Ls.extend({_initImage:function(){var f=this._image=this._url;Mt(f,"leaflet-image-layer"),this._zoomAnimated&&Mt(f,"leaflet-zoom-animated"),this.options.className&&Mt(f,this.options.className),f.onselectstart=p,f.onmousemove=p}});function Xo(f,y,T){return new Qo(f,y,T)}var g=Vr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,y){f&&(f instanceof ie||O(f))?(this._latlng=pe(f),_(this,y)):(_(this,f),this._source=y),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&hr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&hr(this._container,1),this.bringToFront(),this.options.interactive&&(Mt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(hr(this._container,0),this._removeTimeout=setTimeout(o(jn,void 0,this._container),200)):jn(this._container),this.options.interactive&&(bn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=pe(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ni(this._container),this},bringToBack:function(){return this._map&&fs(this._container),this},_prepareOpen:function(f){var y=this._source;if(!y._map)return!1;if(y instanceof ps){y=null;var T=this._source._layers;for(var A in T)if(T[A]._map){y=T[A];break}if(!y)return!1;this._source=y}if(!f)if(y.getCenter)f=y.getCenter();else if(y.getLatLng)f=y.getLatLng();else if(y.getBounds)f=y.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,y=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof y=="string")f.innerHTML=y;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(y)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),y=te(this.options.offset),T=this._getAnchor();this._zoomAnimated?An(this._container,f.add(T)):y=y.add(f).add(T);var A=this._containerBottom=-y.y,V=this._containerLeft=-Math.round(this._containerWidth/2)+y.x;this._container.style.bottom=A+"px",this._container.style.left=V+"px"}},_getAnchor:function(){return[0,0]}});Ht.include({_initOverlay:function(f,y,T,A){var V=y;return V instanceof f||(V=new f(A).setContent(y)),T&&V.setLatLng(T),V}}),Vr.include({_initOverlay:function(f,y,T,A){var V=T;return V instanceof f?(_(V,A),V._source=this):(V=y&&!A?y:new f(A,this),V.setContent(T)),V}});var Pu=g.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,g.prototype.openOn.call(this,f)},onAdd:function(f){g.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Rs||this._source.on("preclick",Qr))},onRemove:function(f){g.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Rs||this._source.off("preclick",Qr))},getEvents:function(){var f=g.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",y=this._container=Dt("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),T=this._wrapper=Dt("div",f+"-content-wrapper",y);if(this._contentNode=Dt("div",f+"-content",T),ua(y),Za(this._contentNode),Ct(y,"contextmenu",Qr),this._tipContainer=Dt("div",f+"-tip-container",y),this._tip=Dt("div",f+"-tip",this._tipContainer),this.options.closeButton){var A=this._closeButton=Dt("a",f+"-close-button",y);A.setAttribute("role","button"),A.setAttribute("aria-label","Close popup"),A.href="#close",A.innerHTML='<span aria-hidden="true">&#215;</span>',Ct(A,"click",function(V){Mn(V),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,y=f.style;y.width="",y.whiteSpace="nowrap";var T=f.offsetWidth;T=Math.min(T,this.options.maxWidth),T=Math.max(T,this.options.minWidth),y.width=T+1+"px",y.whiteSpace="",y.height="";var A=f.offsetHeight,V=this.options.maxHeight,Q="leaflet-popup-scrolled";V&&A>V?(y.height=V+"px",Mt(f,Q)):bn(f,Q),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),T=this._getAnchor();An(this._container,y.add(T))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,y=parseInt(oa(this._container,"marginBottom"),10)||0,T=this._container.offsetHeight+y,A=this._containerWidth,V=new $(this._containerLeft,-T-this._containerBottom);V._add(hs(this._container));var Q=f.layerPointToContainerPoint(V),me=te(this.options.autoPanPadding),Ne=te(this.options.autoPanPaddingTopLeft||me),De=te(this.options.autoPanPaddingBottomRight||me),Be=f.getSize(),rt=0,St=0;Q.x+A+De.x>Be.x&&(rt=Q.x+A-Be.x+De.x),Q.x-rt-Ne.x<0&&(rt=Q.x-Ne.x),Q.y+T+De.y>Be.y&&(St=Q.y+T-Be.y+De.y),Q.y-St-Ne.y<0&&(St=Q.y-Ne.y),(rt||St)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([rt,St]))}},_getAnchor:function(){return te(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),rc=function(f,y){return new Pu(f,y)};Ht.mergeOptions({closePopupOnClick:!0}),Ht.include({openPopup:function(f,y,T){return this._initOverlay(Pu,f,y,T).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),Vr.include({bindPopup:function(f,y){return this._popup=this._initOverlay(Pu,this._popup,f,y),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof ps||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){Ur(f);var y=f.layer||f.target;if(this._popup._source===y&&!(y instanceof Rs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=y,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var sc=g.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){g.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){g.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=g.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",y=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Dt("div",y),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var y,T,A=this._map,V=this._container,Q=A.latLngToContainerPoint(A.getCenter()),me=A.layerPointToContainerPoint(f),Ne=this.options.direction,De=V.offsetWidth,Be=V.offsetHeight,rt=te(this.options.offset),St=this._getAnchor();Ne==="top"?(y=De/2,T=Be):Ne==="bottom"?(y=De/2,T=0):Ne==="center"?(y=De/2,T=Be/2):Ne==="right"?(y=0,T=Be/2):Ne==="left"?(y=De,T=Be/2):me.x<Q.x?(Ne="right",y=0,T=Be/2):(Ne="left",y=De+(rt.x+St.x)*2,T=Be/2),f=f.subtract(te(y,T,!0)).add(rt).add(St),bn(V,"leaflet-tooltip-right"),bn(V,"leaflet-tooltip-left"),bn(V,"leaflet-tooltip-top"),bn(V,"leaflet-tooltip-bottom"),Mt(V,"leaflet-tooltip-"+Ne),An(V,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&hr(this._container,f)},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(y)},_getAnchor:function(){return te(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Md=function(f,y){return new sc(f,y)};Ht.include({openTooltip:function(f,y,T){return this._initOverlay(sc,f,y,T).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),Vr.include({bindTooltip:function(f,y){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(sc,this._tooltip,f,y),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var y=f?"off":"on",T={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?T.add=this._openTooltip:(T.mouseover=this._openTooltip,T.mouseout=this.closeTooltip,T.click=this._openTooltip,this._map?this._addFocusListeners():T.add=this._addFocusListeners),this._tooltip.options.sticky&&(T.mousemove=this._moveTooltip),this[y](T),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof ps||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var y=typeof f.getElement=="function"&&f.getElement();y&&(Ct(y,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),Ct(y,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var y=typeof f.getElement=="function"&&f.getElement();y&&y.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var y=this;this._map.once("moveend",function(){y._openOnceFlag=!1,y._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var y=f.latlng,T,A;this._tooltip.options.sticky&&f.originalEvent&&(T=this._map.mouseEventToContainerPoint(f.originalEvent),A=this._map.containerPointToLayerPoint(T),y=this._map.layerPointToLatLng(A)),this._tooltip.setLatLng(y)}});var Mu=li.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var y=f&&f.tagName==="DIV"?f:document.createElement("div"),T=this.options;if(T.html instanceof Element?(Va(y),y.appendChild(T.html)):y.innerHTML=T.html!==!1?T.html:"",T.bgPos){var A=te(T.bgPos);y.style.backgroundPosition=-A.x+"px "+-A.y+"px"}return this._setIconStyles(y,"icon"),y},createShadow:function(){return null}});function Vm(f){return new Mu(f)}li.Default=Oi;var lo=Vr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:dt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){_(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),jn(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ni(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(fs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof $?f:new $(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var y=this.getPane().children,T=-f(-1/0,1/0),A=0,V=y.length,Q;A<V;A++)Q=y[A].style.zIndex,y[A]!==this._container&&Q&&(T=f(T,+Q));isFinite(T)&&(this.options.zIndex=T+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!dt.ielt9){hr(this._container,this.options.opacity);var f=+new Date,y=!1,T=!1;for(var A in this._tiles){var V=this._tiles[A];if(!(!V.current||!V.loaded)){var Q=Math.min(1,(f-V.loaded)/200);hr(V.el,Q),Q<1?y=!0:(V.active?T=!0:this._onOpaqueTile(V),V.active=!0)}}T&&!this._noPrune&&this._pruneTiles(),y&&(Y(this._fadeFrame),this._fadeFrame=W(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=Dt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,y=this.options.maxZoom;if(f!==void 0){for(var T in this._levels)T=Number(T),this._levels[T].el.children.length||T===f?(this._levels[T].el.style.zIndex=y-Math.abs(f-T),this._onUpdateLevel(T)):(jn(this._levels[T].el),this._removeTilesAtZoom(T),this._onRemoveLevel(T),delete this._levels[T]);var A=this._levels[f],V=this._map;return A||(A=this._levels[f]={},A.el=Dt("div","leaflet-tile-container leaflet-zoom-animated",this._container),A.el.style.zIndex=y,A.origin=V.project(V.unproject(V.getPixelOrigin()),f).round(),A.zoom=f,this._setZoomTransform(A,V.getCenter(),V.getZoom()),p(A.el.offsetWidth),this._onCreateLevel(A)),this._level=A,A}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var f,y,T=this._map.getZoom();if(T>this.options.maxZoom||T<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)y=this._tiles[f],y.retain=y.current;for(f in this._tiles)if(y=this._tiles[f],y.current&&!y.active){var A=y.coords;this._retainParent(A.x,A.y,A.z,A.z-5)||this._retainChildren(A.x,A.y,A.z,A.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var y in this._tiles)this._tiles[y].coords.z===f&&this._removeTile(y)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)jn(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,y,T,A){var V=Math.floor(f/2),Q=Math.floor(y/2),me=T-1,Ne=new $(+V,+Q);Ne.z=+me;var De=this._tileCoordsToKey(Ne),Be=this._tiles[De];return Be&&Be.active?(Be.retain=!0,!0):(Be&&Be.loaded&&(Be.retain=!0),me>A?this._retainParent(V,Q,me,A):!1)},_retainChildren:function(f,y,T,A){for(var V=2*f;V<2*f+2;V++)for(var Q=2*y;Q<2*y+2;Q++){var me=new $(V,Q);me.z=T+1;var Ne=this._tileCoordsToKey(me),De=this._tiles[Ne];if(De&&De.active){De.retain=!0;continue}else De&&De.loaded&&(De.retain=!0);T+1<A&&this._retainChildren(V,Q,T+1,A)}},_resetView:function(f){var y=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),y,y)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var y=this.options;return y.minNativeZoom!==void 0&&f<y.minNativeZoom?y.minNativeZoom:y.maxNativeZoom!==void 0&&y.maxNativeZoom<f?y.maxNativeZoom:f},_setView:function(f,y,T,A){var V=Math.round(y);this.options.maxZoom!==void 0&&V>this.options.maxZoom||this.options.minZoom!==void 0&&V<this.options.minZoom?V=void 0:V=this._clampZoom(V);var Q=this.options.updateWhenZooming&&V!==this._tileZoom;(!A||Q)&&(this._tileZoom=V,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),V!==void 0&&this._update(f),T||this._pruneTiles(),this._noPrune=!!T),this._setZoomTransforms(f,y)},_setZoomTransforms:function(f,y){for(var T in this._levels)this._setZoomTransform(this._levels[T],f,y)},_setZoomTransform:function(f,y,T){var A=this._map.getZoomScale(T,f.zoom),V=f.origin.multiplyBy(A).subtract(this._map._getNewPixelOrigin(y,T)).round();dt.any3d?qr(f.el,V,A):An(f.el,V)},_resetGrid:function(){var f=this._map,y=f.options.crs,T=this._tileSize=this.getTileSize(),A=this._tileZoom,V=this._map.getPixelWorldBounds(this._tileZoom);V&&(this._globalTileRange=this._pxBoundsToTileRange(V)),this._wrapX=y.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,y.wrapLng[0]],A).x/T.x),Math.ceil(f.project([0,y.wrapLng[1]],A).x/T.y)],this._wrapY=y.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([y.wrapLat[0],0],A).y/T.x),Math.ceil(f.project([y.wrapLat[1],0],A).y/T.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var y=this._map,T=y._animatingZoom?Math.max(y._animateToZoom,y.getZoom()):y.getZoom(),A=y.getZoomScale(T,this._tileZoom),V=y.project(f,this._tileZoom).floor(),Q=y.getSize().divideBy(A*2);return new H(V.subtract(Q),V.add(Q))},_update:function(f){var y=this._map;if(y){var T=this._clampZoom(y.getZoom());if(f===void 0&&(f=y.getCenter()),this._tileZoom!==void 0){var A=this._getTiledPixelBounds(f),V=this._pxBoundsToTileRange(A),Q=V.getCenter(),me=[],Ne=this.options.keepBuffer,De=new H(V.getBottomLeft().subtract([Ne,-Ne]),V.getTopRight().add([Ne,-Ne]));if(!(isFinite(V.min.x)&&isFinite(V.min.y)&&isFinite(V.max.x)&&isFinite(V.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Be in this._tiles){var rt=this._tiles[Be].coords;(rt.z!==this._tileZoom||!De.contains(new $(rt.x,rt.y)))&&(this._tiles[Be].current=!1)}if(Math.abs(T-this._tileZoom)>1){this._setView(f,T);return}for(var St=V.min.y;St<=V.max.y;St++)for(var $t=V.min.x;$t<=V.max.x;$t++){var Sr=new $($t,St);if(Sr.z=this._tileZoom,!!this._isValidTile(Sr)){var pr=this._tiles[this._tileCoordsToKey(Sr)];pr?pr.current=!0:me.push(Sr)}}if(me.sort(function(es,cc){return es.distanceTo(Q)-cc.distanceTo(Q)}),me.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ys=document.createDocumentFragment();for($t=0;$t<me.length;$t++)this._addTile(me[$t],ys);this._level.el.appendChild(ys)}}}},_isValidTile:function(f){var y=this._map.options.crs;if(!y.infinite){var T=this._globalTileRange;if(!y.wrapLng&&(f.x<T.min.x||f.x>T.max.x)||!y.wrapLat&&(f.y<T.min.y||f.y>T.max.y))return!1}if(!this.options.bounds)return!0;var A=this._tileCoordsToBounds(f);return ue(this.options.bounds).overlaps(A)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var y=this._map,T=this.getTileSize(),A=f.scaleBy(T),V=A.add(T),Q=y.unproject(A,f.z),me=y.unproject(V,f.z);return[Q,me]},_tileCoordsToBounds:function(f){var y=this._tileCoordsToNwSe(f),T=new le(y[0],y[1]);return this.options.noWrap||(T=this._map.wrapLatLngBounds(T)),T},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var y=f.split(":"),T=new $(+y[0],+y[1]);return T.z=+y[2],T},_removeTile:function(f){var y=this._tiles[f];y&&(jn(y.el),delete this._tiles[f],this.fire("tileunload",{tile:y.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){Mt(f,"leaflet-tile");var y=this.getTileSize();f.style.width=y.x+"px",f.style.height=y.y+"px",f.onselectstart=p,f.onmousemove=p,dt.ielt9&&this.options.opacity<1&&hr(f,this.options.opacity)},_addTile:function(f,y){var T=this._getTilePos(f),A=this._tileCoordsToKey(f),V=this.createTile(this._wrapCoords(f),o(this._tileReady,this,f));this._initTile(V),this.createTile.length<2&&W(o(this._tileReady,this,f,null,V)),An(V,T),this._tiles[A]={el:V,coords:f,current:!0},y.appendChild(V),this.fire("tileloadstart",{tile:V,coords:f})},_tileReady:function(f,y,T){y&&this.fire("tileerror",{error:y,tile:T,coords:f});var A=this._tileCoordsToKey(f);T=this._tiles[A],T&&(T.loaded=+new Date,this._map._fadeAnimated?(hr(T.el,0),Y(this._fadeFrame),this._fadeFrame=W(this._updateOpacity,this)):(T.active=!0,this._pruneTiles()),y||(Mt(T.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:T.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),dt.ielt9||!this._map._fadeAnimated?W(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var y=new $(this._wrapX?h(f.x,this._wrapX):f.x,this._wrapY?h(f.y,this._wrapY):f.y);return y.z=f.z,y},_pxBoundsToTileRange:function(f){var y=this.getTileSize();return new H(f.min.unscaleBy(y).floor(),f.max.unscaleBy(y).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function ic(f){return new lo(f)}var co=lo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,y){this._url=f,y=_(this,y),y.detectRetina&&dt.retina&&y.maxZoom>0?(y.tileSize=Math.floor(y.tileSize/2),y.zoomReverse?(y.zoomOffset--,y.minZoom=Math.min(y.maxZoom,y.minZoom+1)):(y.zoomOffset++,y.maxZoom=Math.max(y.minZoom,y.maxZoom-1)),y.minZoom=Math.max(0,y.minZoom)):y.zoomReverse?y.minZoom=Math.min(y.maxZoom,y.minZoom):y.maxZoom=Math.max(y.minZoom,y.maxZoom),typeof y.subdomains=="string"&&(y.subdomains=y.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,y){return this._url===f&&y===void 0&&(y=!0),this._url=f,y||this.redraw(),this},createTile:function(f,y){var T=document.createElement("img");return Ct(T,"load",o(this._tileOnLoad,this,y,T)),Ct(T,"error",o(this._tileOnError,this,y,T)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(T.referrerPolicy=this.options.referrerPolicy),T.alt="",T.src=this.getTileUrl(f),T},getTileUrl:function(f){var y={r:dt.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var T=this._globalTileRange.max.y-f.y;this.options.tms&&(y.y=T),y["-y"]=T}return P(this._url,s(y,this.options))},_tileOnLoad:function(f,y){dt.ielt9?setTimeout(o(f,this,null,y),0):f(null,y)},_tileOnError:function(f,y,T){var A=this.options.errorTileUrl;A&&y.getAttribute("src")!==A&&(y.src=A),f(T,y)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,y=this.options.maxZoom,T=this.options.zoomReverse,A=this.options.zoomOffset;return T&&(f=y-f),f+A},_getSubdomain:function(f){var y=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[y]},_abortLoading:function(){var f,y;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(y=this._tiles[f].el,y.onload=p,y.onerror=p,!y.complete)){y.src=D;var T=this._tiles[f].coords;jn(y),delete this._tiles[f],this.fire("tileabort",{tile:y,coords:T})}},_removeTile:function(f){var y=this._tiles[f];if(y)return y.el.setAttribute("src",D),lo.prototype._removeTile.call(this,f)},_tileReady:function(f,y,T){if(!(!this._map||T&&T.getAttribute("src")===D))return lo.prototype._tileReady.call(this,f,y,T)}});function Xf(f,y){return new co(f,y)}var Ed=co.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,y){this._url=f;var T=s({},this.defaultWmsParams);for(var A in y)A in this.options||(T[A]=y[A]);y=_(this,y);var V=y.detectRetina&&dt.retina?2:1,Q=this.getTileSize();T.width=Q.x*V,T.height=Q.y*V,this.wmsParams=T},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var y=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[y]=this._crs.code,co.prototype.onAdd.call(this,f)},getTileUrl:function(f){var y=this._tileCoordsToNwSe(f),T=this._crs,A=ae(T.project(y[0]),T.project(y[1])),V=A.min,Q=A.max,me=(this._wmsVersion>=1.3&&this._crs===Kl?[V.y,V.x,Q.y,Q.x]:[V.x,V.y,Q.x,Q.y]).join(","),Ne=co.prototype.getTileUrl.call(this,f);return Ne+j(this.wmsParams,Ne,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+me},setParams:function(f,y){return s(this.wmsParams,f),y||this.redraw(),this}});function Wm(f,y){return new Ed(f,y)}co.WMS=Ed,Xf.wms=Wm;var Ri=Vr.extend({options:{padding:.1},initialize:function(f){_(this,f),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Mt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,y){var T=this._map.getZoomScale(y,this._zoom),A=this._map.getSize().multiplyBy(.5+this.options.padding),V=this._map.project(this._center,y),Q=A.multiplyBy(-T).add(V).subtract(this._map._getNewPixelOrigin(f,y));dt.any3d?qr(this._container,Q,T):An(this._container,Q)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,y=this._map.getSize(),T=this._map.containerPointToLayerPoint(y.multiplyBy(-f)).round();this._bounds=new H(T,T.add(y.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),eh=Ri.extend({options:{tolerance:0},getEvents:function(){var f=Ri.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ri.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");Ct(f,"mousemove",this._onMouseMove,this),Ct(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ct(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){Y(this._redrawRequest),delete this._ctx,jn(this._container),un(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var y in this._layers)f=this._layers[y],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ri.prototype._update.call(this);var f=this._bounds,y=this._container,T=f.getSize(),A=dt.retina?2:1;An(y,f.min),y.width=A*T.x,y.height=A*T.y,y.style.width=T.x+"px",y.style.height=T.y+"px",dt.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){Ri.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[c(f)]=f;var y=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=y),this._drawLast=y,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var y=f._order,T=y.next,A=y.prev;T?T.prev=A:this._drawLast=A,A?A.next=T:this._drawFirst=T,delete f._order,delete this._layers[c(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var y=f.options.dashArray.split(/[, ]+/),T=[],A,V;for(V=0;V<y.length;V++){if(A=Number(y[V]),isNaN(A))return;T.push(A)}f.options._dashArray=T}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||W(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var y=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new H,this._redrawBounds.extend(f._pxBounds.min.subtract([y,y])),this._redrawBounds.extend(f._pxBounds.max.add([y,y]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var y=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,y.x,y.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,y=this._redrawBounds;if(this._ctx.save(),y){var T=y.getSize();this._ctx.beginPath(),this._ctx.rect(y.min.x,y.min.y,T.x,T.y),this._ctx.clip()}this._drawing=!0;for(var A=this._drawFirst;A;A=A.next)f=A.layer,(!y||f._pxBounds&&f._pxBounds.intersects(y))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,y){if(this._drawing){var T,A,V,Q,me=f._parts,Ne=me.length,De=this._ctx;if(Ne){for(De.beginPath(),T=0;T<Ne;T++){for(A=0,V=me[T].length;A<V;A++)Q=me[T][A],De[A?"lineTo":"moveTo"](Q.x,Q.y);y&&De.closePath()}this._fillStroke(De,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var y=f._point,T=this._ctx,A=Math.max(Math.round(f._radius),1),V=(Math.max(Math.round(f._radiusY),1)||A)/A;V!==1&&(T.save(),T.scale(1,V)),T.beginPath(),T.arc(y.x,y.y/V,A,0,Math.PI*2,!1),V!==1&&T.restore(),this._fillStroke(T,f)}},_fillStroke:function(f,y){var T=y.options;T.fill&&(f.globalAlpha=T.fillOpacity,f.fillStyle=T.fillColor||T.color,f.fill(T.fillRule||"evenodd")),T.stroke&&T.weight!==0&&(f.setLineDash&&f.setLineDash(y.options&&y.options._dashArray||[]),f.globalAlpha=T.opacity,f.lineWidth=T.weight,f.strokeStyle=T.color,f.lineCap=T.lineCap,f.lineJoin=T.lineJoin,f.stroke())},_onClick:function(f){for(var y=this._map.mouseEventToLayerPoint(f),T,A,V=this._drawFirst;V;V=V.next)T=V.layer,T.options.interactive&&T._containsPoint(y)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(T))&&(A=T);this._fireEvent(A?[A]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var y=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,y)}},_handleMouseOut:function(f){var y=this._hoveredLayer;y&&(bn(this._container,"leaflet-interactive"),this._fireEvent([y],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,y){if(!this._mouseHoverThrottled){for(var T,A,V=this._drawFirst;V;V=V.next)T=V.layer,T.options.interactive&&T._containsPoint(y)&&(A=T);A!==this._hoveredLayer&&(this._handleMouseOut(f),A&&(Mt(this._container,"leaflet-interactive"),this._fireEvent([A],f,"mouseover"),this._hoveredLayer=A)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,y,T){this._map._fireDOMEvent(y,T||y.type,f)},_bringToFront:function(f){var y=f._order;if(y){var T=y.next,A=y.prev;if(T)T.prev=A;else return;A?A.next=T:T&&(this._drawFirst=T),y.prev=this._drawLast,this._drawLast.next=y,y.next=null,this._drawLast=y,this._requestRedraw(f)}},_bringToBack:function(f){var y=f._order;if(y){var T=y.next,A=y.prev;if(A)A.next=T;else return;T?T.prev=A:A&&(this._drawLast=A),y.prev=null,y.next=this._drawFirst,this._drawFirst.prev=y,this._drawFirst=y,this._requestRedraw(f)}}});function th(f){return dt.canvas?new eh(f):null}var ac=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),$m={_initContainer:function(){this._container=Dt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ri.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var y=f._container=ac("shape");Mt(y,"leaflet-vml-shape "+(this.options.className||"")),y.coordsize="1 1",f._path=ac("path"),y.appendChild(f._path),this._updateStyle(f),this._layers[c(f)]=f},_addPath:function(f){var y=f._container;this._container.appendChild(y),f.options.interactive&&f.addInteractiveTarget(y)},_removePath:function(f){var y=f._container;jn(y),f.removeInteractiveTarget(y),delete this._layers[c(f)]},_updateStyle:function(f){var y=f._stroke,T=f._fill,A=f.options,V=f._container;V.stroked=!!A.stroke,V.filled=!!A.fill,A.stroke?(y||(y=f._stroke=ac("stroke")),V.appendChild(y),y.weight=A.weight+"px",y.color=A.color,y.opacity=A.opacity,A.dashArray?y.dashStyle=O(A.dashArray)?A.dashArray.join(" "):A.dashArray.replace(/( *, *)/g," "):y.dashStyle="",y.endcap=A.lineCap.replace("butt","flat"),y.joinstyle=A.lineJoin):y&&(V.removeChild(y),f._stroke=null),A.fill?(T||(T=f._fill=ac("fill")),V.appendChild(T),T.color=A.fillColor||A.color,T.opacity=A.fillOpacity):T&&(V.removeChild(T),f._fill=null)},_updateCircle:function(f){var y=f._point.round(),T=Math.round(f._radius),A=Math.round(f._radiusY||T);this._setPath(f,f._empty()?"M0 0":"AL "+y.x+","+y.y+" "+T+","+A+" 0,"+65535*360)},_setPath:function(f,y){f._path.v=y},_bringToFront:function(f){Ni(f._container)},_bringToBack:function(f){fs(f._container)}},ci=dt.vml?ac:He,el=Ri.extend({_initContainer:function(){this._container=ci("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ci("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){jn(this._container),un(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ri.prototype._update.call(this);var f=this._bounds,y=f.getSize(),T=this._container;(!this._svgSize||!this._svgSize.equals(y))&&(this._svgSize=y,T.setAttribute("width",y.x),T.setAttribute("height",y.y)),An(T,f.min),T.setAttribute("viewBox",[f.min.x,f.min.y,y.x,y.y].join(" ")),this.fire("update")}},_initPath:function(f){var y=f._path=ci("path");f.options.className&&Mt(y,f.options.className),f.options.interactive&&Mt(y,"leaflet-interactive"),this._updateStyle(f),this._layers[c(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){jn(f._path),f.removeInteractiveTarget(f._path),delete this._layers[c(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var y=f._path,T=f.options;y&&(T.stroke?(y.setAttribute("stroke",T.color),y.setAttribute("stroke-opacity",T.opacity),y.setAttribute("stroke-width",T.weight),y.setAttribute("stroke-linecap",T.lineCap),y.setAttribute("stroke-linejoin",T.lineJoin),T.dashArray?y.setAttribute("stroke-dasharray",T.dashArray):y.removeAttribute("stroke-dasharray"),T.dashOffset?y.setAttribute("stroke-dashoffset",T.dashOffset):y.removeAttribute("stroke-dashoffset")):y.setAttribute("stroke","none"),T.fill?(y.setAttribute("fill",T.fillColor||T.color),y.setAttribute("fill-opacity",T.fillOpacity),y.setAttribute("fill-rule",T.fillRule||"evenodd")):y.setAttribute("fill","none"))},_updatePoly:function(f,y){this._setPath(f,ze(f._parts,y))},_updateCircle:function(f){var y=f._point,T=Math.max(Math.round(f._radius),1),A=Math.max(Math.round(f._radiusY),1)||T,V="a"+T+","+A+" 0 1,0 ",Q=f._empty()?"M0 0":"M"+(y.x-T)+","+y.y+V+T*2+",0 "+V+-T*2+",0 ";this._setPath(f,Q)},_setPath:function(f,y){f._path.setAttribute("d",y)},_bringToFront:function(f){Ni(f._path)},_bringToBack:function(f){fs(f._path)}});dt.vml&&el.include($m);function Eu(f){return dt.svg||dt.vml?new el(f):null}Ht.include({getRenderer:function(f){var y=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return y||(y=this._renderer=this._createRenderer()),this.hasLayer(y)||this.addLayer(y),y},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var y=this._paneRenderers[f];return y===void 0&&(y=this._createRenderer({pane:f}),this._paneRenderers[f]=y),y},_createRenderer:function(f){return this.options.preferCanvas&&th(f)||Eu(f)}});var Hm=xs.extend({initialize:function(f,y){xs.prototype.initialize.call(this,this._boundsToLatLngs(f),y)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=ue(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function Uy(f,y){return new Hm(f,y)}el.create=ci,el.pointsToPath=ze,Xr.geometryToLayer=Ii,Xr.coordsToLatLng=so,Xr.coordsToLatLngs=ga,Xr.latLngToCoords=io,Xr.latLngsToCoords=ao,Xr.getFeature=Ai,Xr.asFeature=oo,Ht.mergeOptions({boxZoom:!0});var oc=Dr.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){Ct(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){un(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){jn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Jt(),Ha(),this._startPoint=this._map.mouseEventToContainerPoint(f),Ct(document,{contextmenu:Ur,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Dt("div","leaflet-zoom-box",this._container),Mt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var y=new H(this._point,this._startPoint),T=y.getSize();An(this._box,y.min),this._box.style.width=T.x+"px",this._box.style.height=T.y+"px"},_finish:function(){this._moved&&(jn(this._box),bn(this._container,"leaflet-crosshair")),ki(),Ya(),un(document,{contextmenu:Ur,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var y=new le(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(y).fire("boxzoomend",{boxZoomBounds:y})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ht.addInitHook("addHandler","boxZoom",oc),Ht.mergeOptions({doubleClickZoom:!0});var Ym=Dr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var y=this._map,T=y.getZoom(),A=y.options.zoomDelta,V=f.originalEvent.shiftKey?T-A:T+A;y.options.doubleClickZoom==="center"?y.setZoom(V):y.setZoomAround(f.containerPoint,V)}});Ht.addInitHook("addHandler","doubleClickZoom",Ym),Ht.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var nh=Dr.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new Br(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}Mt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){bn(this._map._container,"leaflet-grab"),bn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var y=ue(this._map.options.maxBounds);this._offsetLimit=ae(this._map.latLngToContainerPoint(y.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(y.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var y=this._lastTime=+new Date,T=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(T),this._times.push(y),this._prunePositions(y)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),y=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=y.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,y){return f-(f-y)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),y=this._offsetLimit;f.x<y.min.x&&(f.x=this._viscousLimit(f.x,y.min.x)),f.y<y.min.y&&(f.y=this._viscousLimit(f.y,y.min.y)),f.x>y.max.x&&(f.x=this._viscousLimit(f.x,y.max.x)),f.y>y.max.y&&(f.y=this._viscousLimit(f.y,y.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,y=Math.round(f/2),T=this._initialWorldOffset,A=this._draggable._newPos.x,V=(A-y+T)%f+y-T,Q=(A+y+T)%f-y-T,me=Math.abs(V+T)<Math.abs(Q+T)?V:Q;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=me},_onDragEnd:function(f){var y=this._map,T=y.options,A=!T.inertia||f.noInertia||this._times.length<2;if(y.fire("dragend",f),A)y.fire("moveend");else{this._prunePositions(+new Date);var V=this._lastPos.subtract(this._positions[0]),Q=(this._lastTime-this._times[0])/1e3,me=T.easeLinearity,Ne=V.multiplyBy(me/Q),De=Ne.distanceTo([0,0]),Be=Math.min(T.inertiaMaxSpeed,De),rt=Ne.multiplyBy(Be/De),St=Be/(T.inertiaDeceleration*me),$t=rt.multiplyBy(-St/2).round();!$t.x&&!$t.y?y.fire("moveend"):($t=y._limitOffset($t,y.options.maxBounds),W(function(){y.panBy($t,{duration:St,easeLinearity:me,noMoveStart:!0,animate:!0})}))}}});Ht.addInitHook("addHandler","dragging",nh),Ht.mergeOptions({keyboard:!0,keyboardPanDelta:80});var rh=Dr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),Ct(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),un(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,y=document.documentElement,T=f.scrollTop||y.scrollTop,A=f.scrollLeft||y.scrollLeft;this._map._container.focus(),window.scrollTo(A,T)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var y=this._panKeys={},T=this.keyCodes,A,V;for(A=0,V=T.left.length;A<V;A++)y[T.left[A]]=[-1*f,0];for(A=0,V=T.right.length;A<V;A++)y[T.right[A]]=[f,0];for(A=0,V=T.down.length;A<V;A++)y[T.down[A]]=[0,f];for(A=0,V=T.up.length;A<V;A++)y[T.up[A]]=[0,-1*f]},_setZoomDelta:function(f){var y=this._zoomKeys={},T=this.keyCodes,A,V;for(A=0,V=T.zoomIn.length;A<V;A++)y[T.zoomIn[A]]=f;for(A=0,V=T.zoomOut.length;A<V;A++)y[T.zoomOut[A]]=-f},_addHooks:function(){Ct(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){un(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var y=f.keyCode,T=this._map,A;if(y in this._panKeys){if(!T._panAnim||!T._panAnim._inProgress)if(A=this._panKeys[y],f.shiftKey&&(A=te(A).multiplyBy(3)),T.options.maxBounds&&(A=T._limitOffset(te(A),T.options.maxBounds)),T.options.worldCopyJump){var V=T.wrapLatLng(T.unproject(T.project(T.getCenter()).add(A)));T.panTo(V)}else T.panBy(A)}else if(y in this._zoomKeys)T.setZoom(T.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[y]);else if(y===27&&T._popup&&T._popup.options.closeOnEscapeKey)T.closePopup();else return;Ur(f)}}});Ht.addInitHook("addHandler","keyboard",rh),Ht.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Tn=Dr.extend({addHooks:function(){Ct(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){un(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var y=Bl(f),T=this._map.options.wheelDebounceTime;this._delta+=y,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var A=Math.max(T-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),A),Ur(f)},_performZoom:function(){var f=this._map,y=f.getZoom(),T=this._map.options.zoomSnap||0;f._stop();var A=this._delta/(this._map.options.wheelPxPerZoomLevel*4),V=4*Math.log(2/(1+Math.exp(-Math.abs(A))))/Math.LN2,Q=T?Math.ceil(V/T)*T:V,me=f._limitZoom(y+(this._delta>0?Q:-Q))-y;this._delta=0,this._startTime=null,me&&(f.options.scrollWheelZoom==="center"?f.setZoom(y+me):f.setZoomAround(this._lastMousePos,y+me))}});Ht.addInitHook("addHandler","scrollWheelZoom",Tn);var sh=600;Ht.mergeOptions({tapHold:dt.touchNative&&dt.safari&&dt.mobile,tapTolerance:15});var Dd=Dr.extend({addHooks:function(){Ct(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){un(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var y=f.touches[0];this._startPos=this._newPos=new $(y.clientX,y.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Ct(document,"touchend",Mn),Ct(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",y))},this),sh),Ct(document,"touchend touchcancel contextmenu",this._cancel,this),Ct(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){un(document,"touchend",Mn),un(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),un(document,"touchend touchcancel contextmenu",this._cancel,this),un(document,"touchmove",this._onMove,this)},_onMove:function(f){var y=f.touches[0];this._newPos=new $(y.clientX,y.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,y){var T=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:y.screenX,screenY:y.screenY,clientX:y.clientX,clientY:y.clientY});T._simulated=!0,y.target.dispatchEvent(T)}});Ht.addInitHook("addHandler","tapHold",Dd),Ht.mergeOptions({touchZoom:dt.touch,bounceAtZoomLimits:!0});var lc=Dr.extend({addHooks:function(){Mt(this._map._container,"leaflet-touch-zoom"),Ct(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){bn(this._map._container,"leaflet-touch-zoom"),un(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var y=this._map;if(!(!f.touches||f.touches.length!==2||y._animatingZoom||this._zooming)){var T=y.mouseEventToContainerPoint(f.touches[0]),A=y.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=y.getSize()._divideBy(2),this._startLatLng=y.containerPointToLatLng(this._centerPoint),y.options.touchZoom!=="center"&&(this._pinchStartLatLng=y.containerPointToLatLng(T.add(A)._divideBy(2))),this._startDist=T.distanceTo(A),this._startZoom=y.getZoom(),this._moved=!1,this._zooming=!0,y._stop(),Ct(document,"touchmove",this._onTouchMove,this),Ct(document,"touchend touchcancel",this._onTouchEnd,this),Mn(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var y=this._map,T=y.mouseEventToContainerPoint(f.touches[0]),A=y.mouseEventToContainerPoint(f.touches[1]),V=T.distanceTo(A)/this._startDist;if(this._zoom=y.getScaleZoom(V,this._startZoom),!y.options.bounceAtZoomLimits&&(this._zoom<y.getMinZoom()&&V<1||this._zoom>y.getMaxZoom()&&V>1)&&(this._zoom=y._limitZoom(this._zoom)),y.options.touchZoom==="center"){if(this._center=this._startLatLng,V===1)return}else{var Q=T._add(A)._divideBy(2)._subtract(this._centerPoint);if(V===1&&Q.x===0&&Q.y===0)return;this._center=y.unproject(y.project(this._pinchStartLatLng,this._zoom).subtract(Q),this._zoom)}this._moved||(y._moveStart(!0,!1),this._moved=!0),Y(this._animRequest);var me=o(y._move,y,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=W(me,this,!0),Mn(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Y(this._animRequest),un(document,"touchmove",this._onTouchMove,this),un(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ht.addInitHook("addHandler","touchZoom",lc),Ht.BoxZoom=oc,Ht.DoubleClickZoom=Ym,Ht.Drag=nh,Ht.Keyboard=rh,Ht.ScrollWheelZoom=Tn,Ht.TapHold=Dd,Ht.TouchZoom=lc,t.Bounds=H,t.Browser=dt,t.CRS=re,t.Canvas=eh,t.Circle=no,t.CircleMarker=to,t.Class=Z,t.Control=_r,t.DivIcon=Mu,t.DivOverlay=g,t.DomEvent=Ka,t.DomUtil=da,t.Draggable=Br,t.Evented=he,t.FeatureGroup=ps,t.GeoJSON=Xr,t.GridLayer=lo,t.Handler=Dr,t.Icon=li,t.ImageOverlay=Ls,t.LatLng=ie,t.LatLngBounds=le,t.Layer=Vr,t.LayerGroup=As,t.LineUtil=Zl,t.Map=Ht,t.Marker=gs,t.Mixin=Bo,t.Path=Rs,t.Point=$,t.PolyUtil=vd,t.Polygon=xs,t.Polyline=jr,t.Popup=Pu,t.PosAnimation=Ja,t.Projection=Sd,t.Rectangle=Hm,t.Renderer=Ri,t.SVG=el,t.SVGOverlay=Qo,t.TileLayer=co,t.Tooltip=sc,t.Transformation=Te,t.Util=G,t.VideoOverlay=Jo,t.bind=o,t.bounds=ae,t.canvas=th,t.circle=pa,t.circleMarker=Xl,t.control=Is,t.divIcon=Vm,t.extend=s,t.featureGroup=Jl,t.geoJSON=ec,t.geoJson=Wr,t.gridLayer=ic,t.icon=Ql,t.imageOverlay=tc,t.latLng=pe,t.latLngBounds=ue,t.layerGroup=ma,t.map=Os,t.marker=Td,t.point=te,t.polygon=Pd,t.polyline=kd,t.popup=rc,t.rectangle=Uy,t.setOptions=_,t.stamp=c,t.svg=Eu,t.svgOverlay=Xo,t.tileLayer=Xf,t.tooltip=Md,t.transformation=Se,t.version=r,t.videoOverlay=nc;var Gm=window.L;t.noConflict=function(){return window.L=Gm,this},window.L=t}))})(Qh,Qh.exports)),Qh.exports}var nue=tue();const Lr=wu(nue),rue=({events:n,users:e})=>{const t=E.useRef(null),r=E.useRef(null),s=E.useRef(Lr.layerGroup()),a=E.useRef(null),{theme:o}=td();return E.useEffect(()=>{r.current&&!t.current&&(t.current=Lr.map(r.current,{zoomControl:!1}).setView([12.9716,77.5946],12),s.current.addTo(t.current),Lr.control.zoom({position:"bottomright"}).addTo(t.current)),setTimeout(()=>t.current?.invalidateSize(),100)},[]),E.useEffect(()=>{if(!t.current)return;const l=o==="dark",h=l?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",p=l?'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>':'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';a.current?(a.current.setUrl(h),t.current.attributionControl.setPrefix(p)):a.current=Lr.tileLayer(h,{attribution:p}).addTo(t.current)},[o]),E.useEffect(()=>{s.current.clearLayers();const l=new Map;n.forEach(h=>{if(h.latitude&&h.longitude){const p=l.get(h.userId);(!p||new Date(h.timestamp)>new Date(p.timestamp))&&l.set(h.userId,h)}});const c=new Map(e.map(h=>[h.id,h])),d=[];if(l.forEach(h=>{const p=c.get(h.userId);if(p&&h.latitude&&h.longitude){const x=Lr.divIcon({className:"",html:`<div class="user-marker" style="background-image: url(${p.photoUrl||`https://i.pravatar.cc/150?u=${p.id}`})"></div>`,iconSize:[48,48],iconAnchor:[24,56],popupAnchor:[0,-56]}),v=Lr.marker([h.latitude,h.longitude],{icon:x});v.bindPopup(`
                    <div class="user-marker-popup">
                        <p class="popup-name">${p.name}</p>
                        <p class="popup-time">Last seen: ${We(new Date(h.timestamp),"hh:mm a")}</p>
                    </div>
                `),s.current.addLayer(v),d.push(v)}}),d.length>0&&t.current){const h=Lr.featureGroup(d);t.current.fitBounds(h.getBounds().pad(.5))}else t.current&&t.current.setView([12.9716,77.5946],12)},[n,e]),i.jsx("div",{ref:r,style:{height:"600px",width:"100%",borderRadius:"1rem",zIndex:0}})},sue=({events:n,selectedUser:e})=>{const t=E.useRef(null),r=E.useRef(null),s=E.useRef(null),a=E.useRef(null),o=E.useRef(Lr.layerGroup()),l=E.useRef(null),{theme:c}=td(),d=E.useMemo(()=>n.filter(h=>h.userId===e&&h.latitude&&h.longitude).sort((h,p)=>new Date(h.timestamp).getTime()-new Date(p.timestamp).getTime()),[n,e]);return E.useEffect(()=>{r.current&&!t.current&&(t.current=Lr.map(r.current,{zoomControl:!1}).setView([12.9716,77.5946],12),o.current.addTo(t.current),Lr.control.zoom({position:"bottomright"}).addTo(t.current)),setTimeout(()=>t.current?.invalidateSize(),100)},[]),E.useEffect(()=>{if(!t.current)return;const h=c==="dark",v=h?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",b=h?'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>':'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';l.current?(l.current.setUrl(v),t.current.attributionControl.setPrefix(b)):l.current=Lr.tileLayer(v,{attribution:b}).addTo(t.current)},[c]),E.useEffect(()=>{if(!t.current)return;if(o.current.clearLayers(),s.current&&(t.current.removeLayer(s.current),s.current=null),a.current&&(t.current.removeLayer(a.current),a.current=null),d.length===0){t.current.setView([12.9716,77.5946],12);return}const h=d.map(I=>[I.latitude,I.longitude]);s.current=Lr.polyline(h,{color:"#00BFA6",weight:4}).addTo(t.current);const p=h[0],x=h[h.length-1],v=Lr.marker(p,{icon:Lr.divIcon({className:"",html:'<div style="width:16px;height:16px;border-radius:50%;background-color:#00BFA6;border:2px solid white;"></div>',iconSize:[16,16],iconAnchor:[8,8]})}),b=Lr.marker(x,{icon:Lr.divIcon({className:"",html:'<div style="width:16px;height:16px;border-radius:50%;background-color:#EF4444;border:2px solid white;"></div>',iconSize:[16,16],iconAnchor:[8,8]})});o.current.addLayer(v),o.current.addLayer(b);let _=h[0][0],j=h[0][0],C=h[0][1],P=h[0][1];h.forEach(([I,F])=>{_=Math.min(_,I),j=Math.max(j,I),C=Math.min(C,F),P=Math.max(P,F)});const O=[_,C],M=[j,P];a.current=Lr.rectangle([O,M],{color:"#FFB700",weight:2,fillOpacity:.1}).addTo(t.current);const D=Lr.latLngBounds(O,M);t.current.fitBounds(D.pad(.2))},[d]),i.jsx("div",{ref:r,style:{height:"600px",width:"100%",borderRadius:"1rem",zIndex:0}})},iue=({event:n})=>i.jsxs("div",{className:"bg-card rounded-2xl border border-border overflow-hidden shadow-sm",children:[i.jsxs("div",{className:"p-3 bg-page flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium text-muted",children:"User"}),i.jsx("span",{className:"font-semibold text-primary-text",children:n.userName})]}),i.jsxs("div",{className:"p-3 space-y-3 text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Event"}),i.jsx("span",{className:"font-semibold capitalize text-primary-text",children:n.type.replace("-"," ")})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Timestamp"}),i.jsx("span",{className:"text-primary-text",children:We(new Date(n.timestamp),"dd MMM, yy - hh:mm a")})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Location"}),n.latitude&&n.longitude?i.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${n.latitude},${n.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-accent hover:underline",children:[i.jsx(Pl,{className:"h-4 w-4 mr-1"})," View on Map"]}):i.jsx("span",{className:"text-primary-text",children:"-"})]})]})]}),aue=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(!0),[c,d]=E.useState(We(new Date,"yyyy-MM-dd")),[h,p]=E.useState(We(new Date,"yyyy-MM-dd")),[x,v]=E.useState("all"),b=At("(max-width: 767px)"),_=E.useMemo(()=>s.filter(M=>M.role==="field_officer"),[s]),j=E.useCallback(async()=>{l(!0);try{const M=new Date(c);M.setHours(0,0,0,0);const D=new Date(h);D.setHours(23,59,59,999);const[I,F]=await Promise.all([ce.getAllAttendanceEvents(M.toISOString(),D.toISOString()),ce.getUsers()]);r(I),a(F)}catch(M){console.error("Failed to fetch tracking data",M)}finally{l(!1)}},[c,h]);E.useEffect(()=>{j()},[j]);const C=E.useMemo(()=>{let M=t;x!=="all"&&(M=M.filter(I=>I.userId===x));const D=new Map(s.map(I=>[I.id,I]));return M.map(I=>({...I,userName:D.get(I.userId)?.name||"Unknown User"})).sort((I,F)=>new Date(F.timestamp).getTime()-new Date(I.timestamp).getTime())},[t,s,x]),P=E.useMemo(()=>{const M=new Set(C.map(D=>D.userId));return s.filter(D=>M.has(D.id))},[C,s]),O=()=>o?i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):n==="map"?i.jsx(rue,{events:C,users:P}):n==="route"?x==="all"?i.jsx("div",{className:"text-center py-10 text-muted",children:"Please select a specific user to view their route coverage."}):i.jsx(sue,{events:C,selectedUser:x}):b?i.jsx("div",{className:"space-y-3",children:C.length===0?i.jsx("div",{className:"text-center py-10 text-muted",children:"No events found."}):C.map(M=>i.jsx(iue,{event:M},M.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"User"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Event"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Timestamp"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Location"})]})}),i.jsx("tbody",{children:C.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No events found."})}):C.map(M=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"User",className:"px-6 py-4 whitespace-nowrap font-medium",children:M.userName}),i.jsx("td",{"data-label":"Event",className:"px-6 py-4 whitespace-nowrap capitalize",children:M.type.replace("-"," ")}),i.jsx("td",{"data-label":"Timestamp",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:We(new Date(M.timestamp),"dd MMM, yyyy - hh:mm a")}),i.jsx("td",{"data-label":"Location",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:M.latitude&&M.longitude?i.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${M.latitude},${M.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center md:justify-start justify-end text-accent hover:underline",children:[i.jsx(Pl,{className:"h-4 w-4 mr-1"})," View on Map"]}):"-"})]},M.id))})]})});return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text flex-shrink-0",children:"User Activity Tracking"}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto justify-end flex-wrap",children:[i.jsx("div",{className:"w-full sm:w-40",children:i.jsx(En,{label:"",id:"start-date",value:c,onChange:d})}),i.jsx("div",{className:"w-full sm:w-40",children:i.jsx(En,{label:"",id:"end-date",value:h,onChange:p})}),i.jsx("div",{className:"w-full sm:w-48",children:i.jsxs(Ze,{label:"",id:"user-select",value:x,onChange:M=>v(M.target.value),children:[i.jsx("option",{value:"all",children:"All Users"}),_.map(M=>i.jsx("option",{value:M.id,children:M.name},M.id))]})})]})]}),i.jsx("div",{className:"mt-4",children:i.jsxs("div",{className:"bg-page p-1 rounded-full flex items-center w-fit",children:[i.jsxs("button",{onClick:()=>e("list"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="list"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(DJ,{className:"h-4 w-4"}),"List View"]}),i.jsxs("button",{onClick:()=>e("map"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="map"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(f3,{className:"h-4 w-4"}),"Map View"]}),i.jsxs("button",{onClick:()=>e("route"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="route"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(UJ,{className:"h-4 w-4"}),"Route View"]})]})})]}),i.jsx("div",{className:"mt-6",children:O()})]})},oue=(n,e,t,r)=>{const a=n*Math.PI/180,o=t*Math.PI/180,l=(t-n)*Math.PI/180,c=(r-e)*Math.PI/180,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},lue=()=>{const{user:n}=jt(),{colorScheme:e}=on(),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(""),[c,d]=E.useState("100"),[h,p]=E.useState(""),[x,v]=E.useState(""),[b,_]=E.useState(""),[j,C]=E.useState(""),[P,O]=E.useState([]),[M,D]=E.useState(!0),[I,F]=E.useState(null),[q,U]=E.useState(null);E.useEffect(()=>{(async()=>{try{const[K,te]=await Promise.all([ce.getLocations(),ce.getUsers()]);r(K),a(te)}catch(K){console.error(K),F({message:"Failed to load locations or users.",type:"error"})}finally{D(!1)}})()},[]);const B=ot.useMemo(()=>{const $=new Map;return s.forEach(K=>$.set(K.id,K.name)),$},[s]),W=async()=>{try{const $=await ce.getLocations();r($)}catch($){console.error($),F({message:"Failed to refresh locations.",type:"error"})}},Y=async()=>{try{const $=await ly(),{latitude:K,longitude:te}=$.coords;p(K.toString()),v(te.toString());try{const H=await gm(K,te);b||_(H),o||l(H)}catch(H){console.warn("Reverse geocode failed",H)}}catch($){console.error($),F({message:"Unable to retrieve current location.",type:"error"})}},G=async()=>{const $=parseFloat(c),K=parseFloat(h),te=parseFloat(x);if(isNaN($)||$<10||$>1e3){F({message:"Radius must be between 10 and 1000 meters.",type:"error"});return}if(isNaN(K)||isNaN(te)){F({message:"Please provide valid latitude and longitude.",type:"error"});return}try{const H=b||await gm(K,te);if(!q&&t.some(le=>oue(K,te,le.latitude,le.longitude)<10)){F({message:"A location already exists at these coordinates. Please use a different location.",type:"error"});return}q?(await ce.updateLocation(q,{name:o||H,latitude:K,longitude:te,radius:$,address:H}),F({message:"Location updated successfully.",type:"success"}),U(null)):(await ce.createLocation({name:o||H,latitude:K,longitude:te,radius:$,address:H,createdBy:n?.id||null}),F({message:"Location created successfully.",type:"success"})),l(""),d("100"),p(""),v(""),_(""),await W()}catch(H){console.error(H);const ae=H?.message||(q?"Failed to update location.":"Failed to create location.");F({message:ae,type:"error"})}},Z=async()=>{if(!j||P.length===0){F({message:"Please select a user and at least one location.",type:"error"});return}try{await Promise.all(P.map($=>ce.assignLocationToUser(j,$))),F({message:"Location(s) assigned to user.",type:"success"}),C(""),O([])}catch($){console.error($),F({message:"Failed to assign location(s).",type:"error"})}},oe=$=>{U($.id),l($.name||""),d($.radius.toString()),p($.latitude.toString()),v($.longitude.toString()),_($.address||""),window.scrollTo({top:0,behavior:"smooth"})},X=()=>{U(null),l(""),d("100"),p(""),v(""),_("")},he=async $=>{if(window.confirm("Are you sure you want to delete this location? This will remove it from all users and the database."))try{await ce.deleteLocation($),F({message:"Location deleted successfully from all users and database.",type:"success"}),await W()}catch(K){console.error(K);const te=K?.message||"Failed to delete location.";F({message:te,type:"error"})}};return i.jsxs("div",{className:"p-4 md:p-6 w-full",children:[I&&i.jsx(pt,{message:I.message,type:I.type,onDismiss:()=>F(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx(ra,{title:"Location Management"}),i.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Define geofenced locations and assign them to staff. Only checkins within these locations will be accepted."})]}),i.jsxs("div",{className:"mt-6 space-y-6",children:[i.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Pl,{className:"h-5 w-5 mr-2 text-muted"})," ",q?"Edit Location":"Add New Location"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(we,{label:"Name (optional)",id:"locName",value:o,onChange:$=>l($.target.value),placeholder:"e.g. Office HQ"}),i.jsx(we,{label:"Radius (meters)",id:"locRadius",type:"number",value:c,onChange:$=>d($.target.value),min:"10",max:"1000"}),i.jsx(we,{label:"Latitude",id:"locLat",type:"number",value:h,onChange:$=>p($.target.value),placeholder:"12.9716"}),i.jsx(we,{label:"Longitude",id:"locLng",type:"number",value:x,onChange:$=>v($.target.value),placeholder:"77.5946"}),i.jsx(we,{label:"Address (optional)",id:"locAddr",value:b,onChange:$=>_($.target.value),placeholder:"Street, City, State"})]}),i.jsxs("div",{className:"flex flex-wrap mt-4 gap-4",children:[i.jsxs(ne,{variant:"secondary",onClick:Y,children:[i.jsx(h3,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),q?i.jsxs(i.Fragment,{children:[i.jsxs(ne,{onClick:G,children:[i.jsx(Ns,{className:"h-4 w-4 mr-2"})," Save Changes"]}),i.jsx(ne,{variant:"secondary",onClick:X,children:"Cancel"})]}):i.jsxs(ne,{onClick:G,children:[i.jsx(Ut,{className:"h-4 w-4 mr-2"})," Add Location"]})]})]}),i.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Qi,{className:"h-5 w-5 mr-2 text-muted"})," Assign Location to User"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs(Ze,{label:"Select User",id:"assignUser",value:j,onChange:$=>C($.target.value),children:[i.jsx("option",{value:"",children:"-- Select User --"}),s.map($=>i.jsx("option",{value:$.id,children:$.name},$.id))]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Select Location(s)"}),i.jsx("div",{className:"border border-border rounded-lg p-3 max-h-48 overflow-y-auto bg-page",children:t.length===0?i.jsx("p",{className:"text-muted text-sm",children:"No locations available."}):t.map($=>i.jsxs("label",{className:"flex items-center justify-start gap-2 py-1 text-sm",children:[i.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-accent border-gray-300 rounded",checked:P.includes($.id),onChange:K=>{O(te=>K.target.checked?[...te,$.id]:te.filter(H=>H!==$.id))}}),i.jsx("span",{children:$.name||$.address||`${$.latitude.toFixed(4)}, ${$.longitude.toFixed(4)}`})]},$.id))})]})]}),i.jsx("div",{className:"flex justify-end mt-4",children:i.jsxs(ne,{onClick:Z,className:"w-full md:w-auto",children:[i.jsx(Ns,{className:"h-4 w-4 mr-2"})," Assign"]})})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-xl font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Pl,{className:"h-5 w-5 mr-2 text-muted"})," Existing Locations"]}),M?i.jsx("p",{children:"Loading..."}):t.length===0?i.jsx("p",{className:"text-muted text-center md:text-left",children:"No locations defined yet."}):i.jsxs("div",{className:"space-y-4 md:space-y-0",children:[i.jsx("div",{className:"md:hidden space-y-4",children:t.map($=>i.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-primary-text",children:$.name||"Unnamed Location"}),i.jsx("p",{className:"text-sm text-muted",children:$.address})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:`p-1 ${e==="blue"?"text-blue-500 hover:text-blue-700":"text-[#006B3F] hover:text-[#005632]"}`,title:"Edit",onClick:()=>oe($),children:i.jsx(ur,{className:"h-5 w-5"})}),i.jsx("button",{type:"button",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",title:"Delete",onClick:()=>he($.id),children:i.jsx(sn,{className:"h-5 w-5 text-red-500"})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Radius"}),i.jsxs("p",{children:[$.radius,"m"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Coordinates"}),i.jsxs("p",{children:[$.latitude.toFixed(4),", ",$.longitude.toFixed(4)]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Created By"}),i.jsx("p",{children:$.createdByName||B.get($.createdBy||"")||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Created At"}),i.jsx("p",{children:$.createdAt?new Date($.createdAt).toLocaleDateString():"-"})]})]})]},$.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[i.jsx("thead",{className:"bg-page text-primary-text",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created By"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created At"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),i.jsx("tbody",{children:t.map($=>i.jsxs("tr",{className:"border-b border-border",children:[i.jsx("td",{className:"p-3",children:$.name||"-"}),i.jsx("td",{className:"p-3",children:$.radius}),i.jsxs("td",{className:"p-3",children:[$.latitude.toFixed(4),", ",$.longitude.toFixed(4)]}),i.jsx("td",{className:"p-3",children:$.address||"-"}),i.jsx("td",{className:"p-3",children:$.createdByName||B.get($.createdBy||"")||"-"}),i.jsx("td",{className:"p-3",children:$.createdAt?new Date($.createdAt).toLocaleString():"-"}),i.jsxs("td",{className:"p-3 whitespace-nowrap",children:[i.jsx("button",{type:"button",className:`mr-3 ${e==="blue"?"text-blue-600 hover:text-blue-800":"text-[#006B3F] hover:text-[#005632]"}`,title:"Edit",onClick:()=>oe($),children:i.jsx(ur,{className:"h-4 w-4"})}),i.jsx("button",{type:"button",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",title:"Delete",onClick:()=>he($.id),children:i.jsx(sn,{className:"h-5 w-5 text-red-500"})})]})]},$.id))})]})})]})]})]})]})},cue=({isOpen:n,onClose:e,onOverride:t,employeeName:r,bankName:s,reason:a})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",children:[i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10 flex items-center justify-center rounded-full bg-red-100",children:i.jsx(Aa,{className:"h-6 w-6 text-red-600"})}),i.jsxs("div",{className:"ml-4 flex-1",children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Verification Alert: Name Mismatch Found"}),i.jsxs("div",{className:"mt-2 text-sm text-muted space-y-2",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name on ID:"}),' "',r,'"']}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name on Bank Proof:"}),' "',s,'"']}),a&&i.jsxs("p",{className:"mt-2 p-2 bg-page rounded-md",children:[i.jsx("strong",{children:"AI Analysis:"})," ",i.jsx("em",{children:a})]}),i.jsx("p",{className:"mt-2",children:"Please upload the correct documents. If the names are different for a valid reason (e.g., maiden name), you can override this warning, but it will require manual verification by an administrator."})]})]})]}),i.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[i.jsx(ne,{onClick:t,variant:"danger",children:"Override & Proceed"}),i.jsx(ne,{onClick:e,variant:"secondary",children:"Re-upload Documents"})]})]})}):null,due={documents:{aadhaar:!0,pan:!0,bankProof:!0,educationCertificate:!0,salarySlip:!0,uanProof:!0,familyAadhaar:!0},verifications:{requireBengaluruAddress:!0,requireDobVerification:!0}},uue=n=>{const e=Pt({id:ye().required(),relation:ye().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),phone:ye().when("relation",{is:"Child",then:r=>r.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:r=>r.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:n.documents.familyAadhaar?Vt().nonNullable("Aadhaar proof is required for each family member."):Vt().optional().nullable()}),t=Pt({id:ye().required(),document:n.documents.educationCertificate?Vt().nonNullable("Education certificate is required."):Vt().optional().nullable()});return Pt({photo:Vt().optional().nullable(),aadhaarLinkedMobile:ye().required("Aadhaar-linked mobile number is required.").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),alternateMobile:ye().optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),idProofType:ye().oneOf(["Aadhaar","PAN","Voter ID",""]).required(),idProofFront:Vt().nonNullable("Aadhaar (Front) is required."),idProofBack:Vt().nonNullable("Aadhaar (Back) is required."),bankProof:Vt().nonNullable("Bank proof document is required."),uanProof:Vt().nonNullable("UAN proof document is required."),salarySlip:n.documents.salarySlip?Vt().nonNullable("Salary slip is required."):Vt().optional().nullable(),family:_s().of(e).optional(),education:_s().of(t).optional()}).defined()},Xd=n=>new Promise((e,t)=>{const r=new FileReader;r.readAsDataURL(n),r.onload=()=>e({base64:r.result.split(",")[1],type:n.type}),r.onerror=s=>t(s)}),Vh=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",fue=()=>{const n=Nt(),e=Yn(),{user:t}=jt(),{rulesByDesignation:r}=nd(),[s,a]=E.useState(!1),[o,l]=E.useState(null),[c,d]=E.useState({isOpen:!1,employeeName:"",bankName:"",reason:""}),[h,p]=E.useState(window.innerWidth<768),x=e.data.organization.designation,v=E.useMemo(()=>x&&r[x]?r[x]:due,[x,r]),b=E.useMemo(()=>uue(v),[v]);E.useEffect(()=>{const Z=()=>p(window.innerWidth<768);return window.addEventListener("resize",Z),()=>window.removeEventListener("resize",Z)},[]),t?.role;const{control:_,handleSubmit:j,formState:{errors:C},getValues:P,watch:O}=tn({resolver:On(b),defaultValues:{aadhaarLinkedMobile:"",alternateMobile:"",photo:null,idProofType:"Aadhaar",idProofFront:null,idProofBack:null,bankProof:null,salarySlip:null,uanProof:null,family:[],education:[]}}),{fields:M,append:D,remove:I}=js({control:_,name:"family"}),{fields:F,append:q,remove:U}=js({control:_,name:"education"});O("idProofType");const B=O("family"),W=async(Z,oe=!1)=>{a(!0),e.setRequiresManualVerification(oe);try{const X={type:et.OBJECT,properties:{name:{type:et.STRING,description:"The person's full name as written on the card."},dob:{type:et.STRING,description:"The person's date of birth in YYYY-MM-DD format. If only year available, return YYYY-01-01."},gender:{type:et.STRING,description:"Gender: 'Male', 'Female', or 'Other'."},aadhaarNumber:{type:et.STRING,description:"The 12-digit Aadhaar number, if present."},panNumber:{type:et.STRING,description:"The 10-character PAN number, if present."},voterIdNumber:{type:et.STRING,description:"The Voter ID number, also known as EPIC number."}}},he={type:et.OBJECT,properties:{address:{type:et.OBJECT,description:"The full address on the back of an Aadhaar card, parsed into components.",properties:{line1:{type:et.STRING,description:"Full address line(s) excluding city, state, pincode. e.g., 'S/O: John Doe, 123 Maple Street, Anytown'"},city:{type:et.STRING},state:{type:et.STRING},pincode:{type:et.STRING}}}}},$={type:et.OBJECT,properties:{accountHolderName:{type:et.STRING,description:"The account holder's full name."},accountNumber:{type:et.STRING,description:"The full bank account number."},ifscCode:{type:et.STRING,description:"The bank's IFSC code."},bankName:{type:et.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:et.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}}},K={type:et.OBJECT,properties:{uanNumber:{type:et.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:et.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:et.STRING,description:"The 10 or 17-digit ESI number."}}},te={type:et.OBJECT,properties:{uanNumber:{type:et.STRING}}},H={type:et.OBJECT,properties:{name:{type:et.STRING},dob:{type:et.STRING}}},ae={type:et.OBJECT,properties:{degree:{type:et.STRING},institution:{type:et.STRING},endYear:{type:et.STRING}}},le=[Z.idProofFront?Xd(Z.idProofFront.file):Promise.resolve(null),(Z.idProofType==="Aadhaar"||Z.idProofType==="Voter ID")&&Z.idProofBack?Xd(Z.idProofBack.file):Promise.resolve(null),Z.bankProof?Xd(Z.bankProof.file):Promise.resolve(null),Z.salarySlip?Xd(Z.salarySlip.file):Promise.resolve(null),Z.uanProof?Xd(Z.uanProof.file):Promise.resolve(null),...Z.family.map(it=>it.idProof?Xd(it.idProof.file):Promise.resolve(null)),...Z.education.map(it=>it.document?Xd(it.document.file):Promise.resolve(null))],[ue,ie,pe,re,de,...je]=await Promise.all(le),Ae=je.slice(0,Z.family.length),Te=je.slice(Z.family.length),Se=ue?ce.extractDataFromImage(ue.base64,ue.type,X,Z.idProofType):Promise.resolve({}),Pe=ie&&Z.idProofType==="Aadhaar"?ce.extractDataFromImage(ie.base64,ie.type,he,"Aadhaar"):Promise.resolve({}),qe=pe?ce.extractDataFromImage(pe.base64,pe.type,$,"Bank"):Promise.resolve({}),He=re?ce.extractDataFromImage(re.base64,re.type,K,"Salary"):Promise.resolve(null),ze=de?ce.extractDataFromImage(de.base64,de.type,te,"UAN"):Promise.resolve(null),be=Ae.map(it=>it?ce.extractDataFromImage(it.base64,it.type,H,"Aadhaar"):Promise.resolve({})),Ue=Te.map(it=>it?ce.extractDataFromImage(it.base64,it.type,ae):Promise.resolve({})),[Ve,ee,se,xe,ke,...Ie]=await Promise.all([Se,Pe,qe,He,ze,...be,...Ue]),Re=Ie.slice(0,Ae.length),nt=Ie.slice(Ae.length),Xe={...Ve,...ee},ht=Xe.name||"",Bt=se.accountHolderName||"";if(!oe&&ht&&Bt){const{isMatch:it,reason:dn}=await ce.crossVerifyNames(ht,Bt);if(!it){d({isOpen:!0,employeeName:ht,bankName:Bt,reason:dn}),a(!1);return}}const lt={idProofType:Z.idProofType,idProofFront:Z.idProofFront,idProofBack:Z.idProofBack,photo:Z.photo,mobile:Z.aadhaarLinkedMobile,alternateMobile:Z.alternateMobile},Wt={};if(Xe.name){const it=Xe.name.split(" ");lt.firstName=Vh(it.shift()||""),lt.lastName=Vh(it.pop()||""),lt.middleName=Vh(it.join(" ")),lt.preferredName=lt.firstName,Wt.name=!0}if(Xe.dob)try{lt.dob=We(new Date(Xe.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd"),Wt.dob=!0}catch{}if(Xe.gender){const it=Xe.gender.toLowerCase().trim();it.includes("male")||it.includes("purush")||it==="m"?lt.gender="Male":it.includes("female")||it.includes("mahila")||it==="f"?lt.gender="Female":it.includes("transgender")&&(lt.gender="Other")}(Xe.aadhaarNumber||Xe.panNumber||Xe.voterIdNumber)&&(lt.idProofNumber=(Xe.aadhaarNumber||Xe.panNumber||Xe.voterIdNumber).replace(/\s/g,""),Wt.idProofNumber=!0);const Yt={bankProof:Z.bankProof},Qt={};if(se.accountHolderName&&(Yt.accountHolderName=Vh(se.accountHolderName),Qt.accountHolderName=!0),se.accountNumber){const it=se.accountNumber.replace(/\D/g,"");Yt.accountNumber=it,Yt.confirmAccountNumber=it,Qt.accountNumber=!0}se.ifscCode&&(Yt.ifscCode=se.ifscCode.toUpperCase().replace(/\s/g,""),Qt.ifscCode=!0),se.bankName&&(Yt.bankName=se.bankName),se.branchName&&(Yt.branchName=se.branchName);const Gt={salarySlip:Z.salarySlip,document:Z.uanProof},ln={},rn={},Et={},qn=ke?.uanNumber||xe?.uanNumber;if(qn){const it=qn.replace(/\D/g,"");it.length===12&&(Gt.uanNumber=it,Gt.hasPreviousPf=!0,rn.uanNumber=!0)}if(xe?.pfNumber&&(Gt.pfNumber=xe.pfNumber,Gt.hasPreviousPf=!0),xe?.esiNumber){const it=xe.esiNumber.replace(/\D/g,"");(it.length===10||it.length===17)&&(ln.esiNumber=it,ln.hasEsi=!0,Et.esiNumber=!0)}const sr=Re.map((it,dn)=>{const ir=Z.family[dn];let ks="";if(it.dob)try{ks=We(new Date(it.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd")}catch{}return{id:`fam_preupload_${Date.now()}_${dn}`,relation:ir.relation,name:Vh(it.name)||"",dob:ks,gender:"",occupation:"",dependent:!1,idProof:ir.idProof,phone:ir.phone}}),vn=nt.map((it,dn)=>{const ir=Z.education[dn];return{id:`edu_preupload_${Date.now()}_${dn}`,degree:it.degree||"",institution:it.institution||"",startYear:"",endYear:it.endYear||"",document:ir.document}});Xe.address&&e.updateAddress({present:{...Xe.address,country:"India",verifiedStatus:{line1:!0,city:!0,state:!0,pincode:!0,country:!0}},permanent:{...Xe.address,country:"India"},sameAsPresent:!0}),e.updateBank(Yt),e.setBankVerifiedStatus(Qt),e.updateUan(Gt),e.setUanVerifiedStatus(rn),e.updateEsi(ln),e.setEsiVerifiedStatus(Et),e.updateFamily(sr),e.updateEducation(vn),e.updatePersonal(lt),e.setPersonalVerifiedStatus(Wt),l({message:"Application auto-filled! Please review.",type:"success"}),n("/onboarding/add/personal")}catch(X){const he=X instanceof Error?X.message:"An unexpected error occurred.";console.error("Document processing failed:",X),l({message:`Document processing failed: ${he}`,type:"error"}),a(!1)}},Y=Z=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),W(Z,!1)},G=()=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),W(P(),!0)};return i.jsxs("div",{className:"relative",children:[s&&i.jsxs("div",{className:"absolute inset-0 bg-page/90 backdrop-blur-sm z-10 flex flex-col items-center justify-center rounded-xl animate-fade-in-scale",children:[i.jsx(_t,{className:"h-12 w-12 animate-spin text-accent"}),i.jsx("p",{className:"mt-4 text-lg font-semibold text-primary-text",children:"Processing Documents..."}),i.jsx("p",{className:"text-muted text-center max-w-xs",children:"Our AI is analyzing your files. This may take a moment."})]}),i.jsxs("div",{className:`bg-card p-8 rounded-xl shadow-card w-full transition-all ${s?"blur-sm pointer-events-none":""}`,children:[i.jsx(cue,{...c,onClose:()=>d({isOpen:!1,employeeName:"",bankName:"",reason:""}),onOverride:G}),i.jsxs("form",{onSubmit:j(Y),children:[i.jsx(Mr,{title:"Document Collection",subtitle:"Upload documents to auto-fill the application."}),i.jsxs("div",{className:"space-y-8 mt-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(_e,{name:"photo",control:_,render:({field:Z})=>i.jsx(vt,{label:"Profile Photo",file:Z.value,onFileChange:Z.onChange,allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsx(_e,{name:"aadhaarLinkedMobile",control:_,render:({field:Z,fieldState:oe})=>i.jsx(we,{label:"Aadhaar Linked Mobile Number",type:"tel",...Z,error:oe.error?.message})}),i.jsx(_e,{name:"alternateMobile",control:_,render:({field:Z,fieldState:oe})=>i.jsx(we,{label:"Alternative Mobile Number (Optional)",type:"tel",...Z,error:oe.error?.message})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(_e,{name:"idProofFront",control:_,render:({field:Z})=>i.jsx(vt,{label:"Aadhaar (Front Side)",file:Z.value,onFileChange:Z.onChange,error:C.idProofFront?.message,allowCapture:!0,verificationStatus:e.data.personal.verifiedStatus?.idProofNumber})}),i.jsx(_e,{name:"idProofBack",control:_,render:({field:Z})=>i.jsx(vt,{label:"Aadhaar (Back Side)",file:Z.value,onFileChange:Z.onChange,error:C.idProofBack?.message,allowCapture:!0,verificationStatus:e.data.personal.verifiedStatus?.idProofNumber})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(_e,{name:"bankProof",control:_,render:({field:Z})=>i.jsx(vt,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:Z.value,onFileChange:Z.onChange,error:C.bankProof?.message,allowCapture:!0,verificationStatus:e.data.bank.verifiedStatus?.accountNumber})}),i.jsx(_e,{name:"uanProof",control:_,render:({field:Z})=>i.jsx(vt,{label:"UAN Proof Document",file:Z.value,onFileChange:Z.onChange,error:C.uanProof?.message,allowCapture:!0,verificationStatus:e.data.uan.verifiedStatus?.uanNumber})})]}),v.documents.salarySlip&&i.jsx(_e,{name:"salarySlip",control:_,render:({field:Z})=>i.jsx(vt,{label:"Latest Salary Slip",file:Z.value,onFileChange:Z.onChange,error:C.salarySlip?.message,allowCapture:!0})}),v.documents.educationCertificate&&i.jsxs("div",{className:"pt-6 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[F.map((Z,oe)=>i.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 relative",children:[i.jsx(_e,{name:`education.${oe}.document`,control:_,render:({field:X,fieldState:he})=>i.jsx(vt,{label:"Certificate",file:X.value,onFileChange:X.onChange,error:he.error?.message,allowCapture:!0})}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>U(oe),className:"!absolute top-2 right-2",children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})})]},Z.id)),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>q({id:`edu_upload_${Date.now()}`,document:null}),children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Certificate"]})]})]}),v.documents.familyAadhaar&&i.jsxs("div",{className:"pt-6 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[M.map((Z,oe)=>{const he=B?.[oe]?.relation==="Child";return i.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 grid grid-cols-1 md:grid-cols-3 gap-4 items-start relative",children:[i.jsx(_e,{name:`family.${oe}.relation`,control:_,render:({field:$,fieldState:K})=>i.jsxs(Ze,{label:"Relation",error:K.error?.message,...$,children:[" ",i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})," "]})}),i.jsx(_e,{name:`family.${oe}.phone`,control:_,render:({field:$,fieldState:K})=>i.jsx(we,{label:`Phone Number${he?" (Optional)":""}`,type:"tel",...$,error:K.error?.message})}),i.jsx("div",{className:"md:col-start-1 md:col-span-3",children:i.jsx(_e,{name:`family.${oe}.idProof`,control:_,render:({field:$,fieldState:K})=>i.jsx(vt,{label:"Aadhaar Card",file:$.value,onFileChange:$.onChange,error:K.error?.message,allowCapture:!0})})}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>I(oe),className:"!absolute top-2 right-2",children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})})]},Z.id)}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>D({id:`fam_upload_${Date.now()}`,relation:"",idProof:null,phone:""}),children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-between items-center gap-4",children:[i.jsxs(ne,{type:"button",variant:"secondary",onClick:()=>n(-1),children:[i.jsx(Fa,{className:"mr-2 h-4 w-4"})," Back"]}),i.jsx(ne,{type:"submit",isLoading:s,children:"Process"})]})]})]})]})},hue=({count:n=3})=>i.jsx("div",{className:"space-y-2.5",children:Array.from({length:n}).map((e,t)=>i.jsxs("div",{className:"bg-[#041b0f] md:bg-[#243524] p-3 rounded-xl flex gap-4 items-start border border-transparent",children:[i.jsx(Gr,{className:"w-12 h-12 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"flex-grow space-y-2 mt-1",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx(Gr,{className:"h-4 w-1/2"}),i.jsx(Gr,{className:"h-5 w-20 rounded-full"})]}),i.jsx(Gr,{className:"h-3 w-1/3"}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[i.jsx(Gr,{className:"h-3 w-20"}),i.jsx(Gr,{className:"h-3 w-20"}),i.jsx(Gr,{className:"h-3 w-20"}),i.jsx(Gr,{className:"h-3 w-20"})]})]})]},t))}),sx=({label:n,checked:e})=>i.jsxs("div",{className:"flex items-center gap-1.5",children:[e?i.jsx(_m,{className:"h-4 w-4 text-emerald-400"}):i.jsx(x3,{className:"h-4 w-4 text-gray-500"}),i.jsx("span",{className:e?"text-gray-300":"text-gray-500",children:n})]}),mue=({submission:n})=>{const{esiCtcThreshold:e}=nd(),{colorScheme:t}=on(),r=E.useMemo(()=>{const{personal:s,uan:a,esi:o,gmc:l}=n,c=s.salary!=null&&s.salary<=e;let d=!1;return c?d=!o.hasEsi||o.hasEsi&&!!o.esiNumber:l.isOptedIn===!0?d=!0:l.isOptedIn===!1&&(d=!!l.gmcPolicyCopy&&!!l.declarationAccepted),{aadhaar:!!s.idProofFront,uan:!a.hasPreviousPf||a.hasPreviousPf&&!!a.uanNumber,pf:!a.hasPreviousPf||a.hasPreviousPf&&!!a.uanNumber,esiGmc:d}},[n,e]);return i.jsx(Oa,{to:`/onboarding/add/personal?id=${n.id}`,className:"block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-xl",children:i.jsxs("div",{className:"bg-[#041b0f] md:bg-[#243524] hover:border-emerald-500 p-3 rounded-xl flex gap-4 items-start border border-transparent transition-colors duration-200",children:[i.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 border-2 border-gray-600",children:i.jsx(Zi,{photoUrl:n.personal.photo?.preview,seed:n.id})}),i.jsxs("div",{className:"flex-grow",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx("p",{className:"font-semibold text-green-400",children:`${n.personal.firstName} ${n.personal.lastName}`}),i.jsx("div",{className:"flex-shrink-0",children:i.jsx(VC,{status:n.status})})]}),i.jsx("p",{className:"text-sm text-gray-400",children:n.personal.mobile}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[i.jsx(sx,{label:"Aadhaar",checked:r.aadhaar}),i.jsx(sx,{label:"UAN",checked:r.uan}),i.jsx(sx,{label:"PF",checked:r.pf}),i.jsx(sx,{label:"ESI / GMC",checked:r.esiGmc})]})]})]})})},pue=()=>{const{colorScheme:n}=on(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState("in-progress"),[l,c]=E.useState(""),[d,h]=E.useState(null),p=Nt(),x=E.useRef(null);E.useEffect(()=>{(async()=>{s(!0);try{const P=await ce.getVerificationSubmissions();t(P)}catch{h({message:"Failed to load submissions.",type:"error"})}finally{s(!1)}})()},[]);const v=E.useMemo(()=>{const C={"in-progress":["pending","draft","rejected"],existing:["verified"]};return e.filter(P=>C[a].includes(P.status)).filter(P=>`${P.personal.firstName} ${P.personal.lastName}`.toLowerCase().includes(l.toLowerCase())||P.personal.mobile?.toLowerCase().includes(l.toLowerCase()))},[e,a,l]),b=()=>{p("/onboarding/select-organization")},_=()=>{x.current?.focus()},j=[{key:"in-progress",label:"IN PROGRESS"},{key:"existing",label:"EXISTING"}];return i.jsxs("div",{className:"h-full flex flex-col bg-[#041b0f] text-white",children:[d&&i.jsx(pt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header sticky top-0 z-10 bg-[#041b0f]/80 border-[#374151] backdrop-blur-sm border-b",children:[i.jsx("button",{onClick:()=>p("/onboarding"),"aria-label":"Go back",className:"p-2 rounded-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400 hover:bg-white/10",children:i.jsx(Fa,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-lg font-semibold",children:"On Boarding"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:_,"aria-label":"Search employee",className:"p-2 rounded-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400 hover:bg-white/10",children:i.jsx(Ia,{className:"h-6 w-6"})}),i.jsx("button",{onClick:b,"aria-label":"Add new employee",className:"p-2 rounded-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400 hover:bg-white/10",children:i.jsx(Gc,{className:"h-6 w-6"})}),i.jsx("button",{onClick:()=>p("/profile"),"aria-label":"Exit to profile",className:"p-2 rounded-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400 hover:bg-white/10",children:i.jsx(wi,{className:"h-6 w-6"})})]})]}),i.jsx("div",{className:"px-4 pt-4 pb-3 flex-shrink-0",children:i.jsx("div",{className:"flex",children:j.map(C=>i.jsx("button",{onClick:()=>o(C.key),className:`flex-1 py-2 text-sm font-semibold uppercase tracking-wider transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-sm ${a===C.key?"border-b-2 border-emerald-500 text-emerald-600":"border-b-2 border-transparent text-gray-400 hover:text-white"}`,children:C.label},C.key))})}),i.jsxs("main",{className:"flex-1 overflow-y-auto px-4 space-y-2.5 pb-24",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-500"}),i.jsx("input",{ref:x,type:"text",placeholder:"Search by name or number...",value:l,onChange:C=>c(C.target.value),className:"form-input w-full !pl-10 !h-12 !rounded-md"})]}),r?i.jsx("div",{className:"pt-4",children:i.jsx(hue,{count:3})}):v.length>0?i.jsx("div",{className:"space-y-2.5",children:v.map(C=>i.jsx(mue,{submission:C},C.id))}):i.jsx("div",{className:"text-center pt-16 text-gray-500",children:i.jsxs("p",{children:["No ",a.replace("-"," ")," submissions found."]})})]})]})},gue=({status:n})=>{const e={"To Do":"bg-gray-500","In Progress":"bg-blue-500",Done:"bg-green-600"};return i.jsx("span",{className:`fo-status-badge ${e[n]}`,children:n})},xue=()=>{const{user:n}=jt(),{colorScheme:e}=on(),[t,r]=E.useState("tasks"),[s,a]=E.useState([]),[o,l]=E.useState([]),[c,d]=E.useState(!0);E.useEffect(()=>{if(!n)return;(async()=>{d(!0);try{const[x,v]=await Promise.all([ce.getTasks(),ce.getNotifications(n.id)]),b=x.filter(_=>_.assignedToId===n.id);a(b),l(v)}catch(x){console.error("Failed to load data for tasks page",x)}finally{d(!1)}})()},[n]);const h=p=>{const x=["HR","Admin","Ops Manager","Site Manager"];return x[p.charCodeAt(p.length-1)%x.length]};return i.jsxs("div",{className:"text-white",children:[i.jsx("header",{className:"p-4 flex-shrink-0 text-center fo-mobile-header sticky top-0 bg-[#041b0f]/80 border-[#374151] backdrop-blur-sm z-10 border-b",children:i.jsx("h1",{className:"font-semibold text-lg",children:"Tasks"})}),i.jsx("div",{className:"flex-shrink-0 p-4",children:i.jsxs("div",{className:"fo-tabs-container",children:[i.jsx("button",{onClick:()=>r("tasks"),className:`fo-tab-button ${t==="tasks"?"active":""}`,children:"Tasks"}),i.jsx("button",{onClick:()=>r("notifications"),className:`fo-tab-button ${t==="notifications"?"active":""}`,children:"Notifications"})]})}),i.jsx("main",{className:"p-4",children:c?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-muted"})}):t==="tasks"?s.length>0?i.jsx("div",{className:"space-y-4",children:s.map(p=>i.jsxs("div",{className:"fo-task-card",children:[i.jsxs("div",{className:"fo-task-header",children:[i.jsx("p",{className:"fo-task-title",children:p.name}),i.jsx(gue,{status:p.status})]}),i.jsx("p",{className:"text-sm mb-2 text-gray-400",children:p.description}),i.jsxs("div",{className:"fo-task-meta flex justify-between items-center",children:[i.jsxs("span",{children:["Due: ",p.dueDate?We(new Date(p.dueDate),"dd MMM, yyyy"):"N/A"]}),i.jsxs("span",{children:["Assigned by: ",h(p.id)]})]})]},p.id))}):i.jsxs("div",{className:"text-center pt-16 text-muted",children:[i.jsx(DC,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"You have no assigned tasks."})]}):o.length>0?i.jsx("div",{className:"divide-y divide-border",children:o.map(p=>i.jsxs("div",{className:"fo-notification-item",children:[i.jsx(Af,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("p",{className:"text-sm text-gray-300",children:p.message}),i.jsx("p",{className:"text-xs text-muted mt-1",children:mu(new Date(p.createdAt),{addSuffix:!0})})]})]},p.id))}):i.jsxs("div",{className:"text-center pt-16 text-muted",children:[i.jsx(Af,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"You have no notifications."})]})})]})},yue=({status:n})=>{const{colorScheme:e}=useBrandingStore(),r={Pending:"bg-yellow-900/50 text-yellow-300 border border-yellow-500/50",Approved:"bg-blue-900/50 text-blue-300 border border-blue-500/50",Issued:"bg-green-900/50 text-green-300 border border-green-500/50",Rejected:"bg-red-900/50 text-red-300 border border-red-500/50"};return i.jsx("span",{className:`fo-status-badge ${r[n]}`,children:n})},ix=({title:n,sizes:e,headers:t,control:r,quantityType:s})=>{const a=Array.from(new Set(e.map(l=>l.fit))),o=Array.from(new Set(e.map(l=>l.size))).sort((l,c)=>{const d=parseInt(String(l)),h=parseInt(String(c));return!isNaN(d)&&!isNaN(h)?d-h:String(l).localeCompare(String(c))});return i.jsxs("div",{className:"border border-border rounded-lg",children:[i.jsx("h4",{className:"p-3 font-semibold bg-accent text-white border-b border-accent",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:"Size"}),t.map(l=>i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:l.label},String(l.key))),i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted w-24",children:"Quantity"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:o.map(l=>i.jsx(ot.Fragment,{children:a.map((c,d)=>{const h=e.find(p=>p.size===l&&p.fit===c);return h?i.jsxs("tr",{children:[d===0&&i.jsx("td",{rowSpan:a.filter(p=>e.some(x=>x.size===l&&x.fit===p)).length,className:"px-3 py-2 align-middle font-semibold border-r",children:l}),t.map(p=>i.jsx("td",{className:"px-3 py-2",children:h[p.key]},String(p.key))),i.jsx("td",{className:"px-3 py-2",children:i.jsx(_e,{name:`${s}.${h.id}`,control:r,render:({field:p})=>i.jsx(we,{"aria-label":`Quantity for ${n} size ${l} ${c}`,type:"number",...p,value:p.value||"",onChange:x=>p.onChange(parseInt(x.target.value)||null),className:"!py-1.5"})})})]},h.id):null})},l))})]})})]})},vue=({onSave:n,onCancel:e,sites:t,masterUniforms:r,initialData:s})=>{const{register:a,control:o,handleSubmit:l,watch:c,reset:d}=tn({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),{data:h}=Yn(),{user:p}=jt(),x=c("gender"),v=c("siteId");E.useEffect(()=>{if(s){const _={},j={};s.items.forEach(C=>{C.category==="Pants"?_[C.sizeId]=C.quantity:j[C.sizeId]=C.quantity}),d({siteId:s.siteId,gender:s.gender,pantsQuantities:_,shirtsQuantities:j})}else{const _=h.organization.organizationId||"",C=h.personal.gender==="Female"?"Ladies":"Gents";d({siteId:_,gender:C,pantsQuantities:{},shirtsQuantities:{}})}},[s,d,h]);const b=_=>{const j=t.find(M=>M.id===_.siteId);if(!j||!p)return;const C=x==="Gents"?[...r.gents.pants,...r.gents.shirts]:[...r.ladies.pants,...r.ladies.shirts],P=[];for(const[M,D]of Object.entries(_.pantsQuantities))if(D&&D>0){const I=C.find(F=>F.id===M);I&&P.push({sizeId:M,quantity:D,category:"Pants",sizeLabel:I.size,fit:I.fit})}for(const[M,D]of Object.entries(_.shirtsQuantities))if(D&&D>0){const I=C.find(F=>F.id===M);I&&P.push({sizeId:M,quantity:D,category:"Shirts",sizeLabel:I.size,fit:I.fit})}const O={id:s?.id||`new_${Date.now()}`,siteId:_.siteId,siteName:j.shortName,gender:_.gender,requestedDate:s?.requestedDate||new Date().toISOString(),status:s?.status||"Pending",items:P,source:"Individual",requestedById:p.id,requestedByName:p.name,employeeDetails:[{employeeName:`${h.personal.firstName} ${h.personal.lastName}`,employeeId:h.personal.employeeId,items:P.map(M=>({itemName:M.category,sizeLabel:M.sizeLabel,fit:M.fit,quantity:M.quantity}))}]};n(O)};return i.jsx("form",{onSubmit:l(b),children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(Ze,{label:"Select Site",value:v,...a("siteId"),required:!0,disabled:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),t.map(_=>i.jsx("option",{value:_.id,children:_.shortName},_.id))]}),i.jsxs(Ze,{label:"Select Uniform Type",value:x,...a("gender"),disabled:!0,children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(ix,{title:"Gents' Pants",sizes:r.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(ix,{title:"Gents' Shirts",sizes:r.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(ix,{title:"Ladies' Pants",sizes:r.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(ix,{title:"Ladies' Shirts",sizes:r.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]})}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#374151]",children:[i.jsx(ne,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsxs(ne,{type:"submit",children:[i.jsx(Ns,{className:"mr-2 h-4 w-4"})," Save Request"]})]})]})})},bue=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(null),[c,d]=E.useState(!0),[h,p]=E.useState(null),[x,v]=E.useState(null),[b,_]=E.useState(null),j=Nt(),[C]=y4(),{updateUniforms:P}=Yn(),O=C.get("from")==="onboarding",M=async()=>{d(!0);try{const[B,W,Y,G]=await Promise.all([ce.getUniformRequests(),ce.getOrganizations(),ce.getMasterGentsUniforms(),ce.getMasterLadiesUniforms()]);r(B.sort((Z,oe)=>new Date(oe.requestedDate).getTime()-new Date(Z.requestedDate).getTime())),a(W),l({gents:Y,ladies:G})}catch{p({message:"Failed to load uniform data.",type:"error"})}finally{d(!1)}};E.useEffect(()=>{M()},[]),E.useEffect(()=>{O&&(e("form"),v(null))},[O]);const D=()=>{v(null),e("form")},I=B=>{v(B),e("form")},F=async B=>{if(O&&o){const W=B.gender==="Ladies"?[...o.ladies.pants,...o.ladies.shirts]:[...o.gents.pants,...o.gents.shirts],Y=B.items.map(G=>{const Z=W.find(he=>he.id===G.sizeId),oe=G.category==="Pants"?`${B.gender}' Pants`:`${B.gender}' Shirts`;return{itemId:`generic_${B.gender.toLowerCase()}_${G.category==="Pants"?"pants":"shirts"}`,itemName:oe,sizeId:G.sizeId,sizeLabel:Z?.size||"",fit:Z?.fit||"",quantity:G.quantity}});P(Y),await ce.submitUniformRequest(B),j(-1);return}try{B.id.startsWith("new_")?(await ce.submitUniformRequest(B),p({message:"New request submitted.",type:"success"})):(await ce.updateUniformRequest(B),p({message:"Request updated.",type:"success"})),e("list"),M()}catch{p({message:"Failed to save request.",type:"error"})}},q=async()=>{if(b)try{await ce.deleteUniformRequest(b.id),p({message:"Request deleted.",type:"success"}),_(null),M()}catch{p({message:"Failed to delete request.",type:"error"})}},U=B=>B.reduce((W,Y)=>W+Y.quantity,0);if(c||!o)return i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-muted"})});if(n==="form"){const B=()=>{O?j(-1):e("list")};return i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header",children:[i.jsx("button",{onClick:B,"aria-label":"Go back",children:i.jsx(Fa,{className:"h-6 w-6"})}),i.jsxs("h1",{children:[x?"Edit":"New"," Request"]})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsx(vue,{onSave:F,onCancel:B,sites:s,masterUniforms:o,initialData:x})})]})}return i.jsxs("div",{className:"h-full flex flex-col bg-[#041b0f] text-white",children:[h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(Kr,{isOpen:!!b,onClose:()=>_(null),onConfirm:q,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header",children:[i.jsx("h1",{className:"text-lg font-semibold",children:"Uniform Requests"}),i.jsx("button",{onClick:D,"aria-label":"New Uniform Request",className:"",children:i.jsx(Gc,{className:"h-6 w-6"})})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:t.length>0?t.map(B=>i.jsxs("div",{className:"p-3 rounded-xl border bg-[#243524] border-[#374151]",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-white",children:B.siteName}),i.jsx("p",{className:"text-xs text-gray-400",children:We(new Date(B.requestedDate),"dd MMM, yyyy")})]}),i.jsx(yue,{status:B.status})]}),i.jsxs("div",{className:"mt-3 flex justify-between items-end",children:[i.jsxs("div",{className:"text-sm text-gray-300",children:[i.jsxs("p",{children:[B.gender," Uniforms"]}),i.jsxs("p",{className:"font-semibold",children:[U(B.items)," Items"]})]}),B.status==="Pending"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>I(B),children:i.jsx(ur,{className:"h-4 w-4 text-gray-400"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>_(B),children:i.jsx(sn,{className:"h-4 w-4 text-red-500"})})]})]})]},B.id)):i.jsxs("div",{className:"text-center pt-16 text-muted",children:[i.jsx(Ff,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"No uniform requests found."}),i.jsxs(ne,{onClick:D,className:"mt-4",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Create First Request"]})]})})]})},wue=({priority:n})=>{const e={Low:"bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.5)]",Medium:"bg-yellow-500 shadow-[0_0_8px_rgba(234,179,8,0.5)]",High:"bg-orange-500 shadow-[0_0_8px_rgba(249,115,22,0.5)]",Urgent:"bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]"};return i.jsx("span",{className:`w-3 h-3 rounded-full ${e[n]}`,title:`Priority: ${n}`})},_ue=({status:n})=>{const e={Open:"bg-emerald-500/10 text-emerald-500 border-emerald-500/20","In Progress":"bg-blue-500/10 text-blue-500 border-blue-500/20","Pending Requester":"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",Resolved:"bg-purple-500/10 text-purple-500 border-purple-500/20",Closed:"bg-gray-500/10 text-gray-500 border-gray-500/20"};return i.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${e[n]}`,children:n})},jue=({ticket:n,onClick:e})=>i.jsxs("div",{onClick:e,className:"group bg-card hover:bg-accent/5 p-5 rounded-xl border border-border hover:border-accent cursor-pointer transition-all duration-300 flex flex-col justify-between h-full shadow-sm hover:shadow-md",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-start gap-3 mb-2",children:[i.jsx("h4",{className:"font-bold text-primary-text leading-snug group-hover:text-accent transition-colors line-clamp-2",children:n.title}),i.jsx("div",{className:"flex-shrink-0 mt-1",children:i.jsx(wue,{priority:n.priority})})]}),i.jsxs("p",{className:"text-xs text-muted font-mono",children:["#",n.ticketNumber]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[i.jsxs("div",{className:"flex justify-between items-center text-xs text-muted mb-3",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-700 flex items-center justify-center text-[10px] text-white font-bold",children:n.raisedByName.charAt(0)}),i.jsx("span",{children:n.raisedByName})]}),i.jsx("span",{children:mu(new Date(n.raisedAt),{addSuffix:!0})})]}),i.jsx("div",{className:"flex justify-between items-center",children:i.jsx(_ue,{status:n.status})})]})]}),ZL=({user:n,onAction:e})=>{const{colorScheme:t}=on();return i.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-card border border-border hover:border-accent/50 transition-colors",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Zi,{photoUrl:n.photoUrl,seed:n.id,className:"w-12 h-12 rounded-full shadow-sm"}),i.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ${n.isAvailable?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":"bg-rose-600 shadow-[0_0_6px_rgba(225,29,72,0.6)]"} ring-2 ring-white`})]}),i.jsxs("div",{className:"flex-grow min-w-0",children:[i.jsx("p",{className:"text-sm font-bold text-primary-text truncate",children:n.name}),i.jsx("p",{className:"text-xs text-muted truncate",children:n.role.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase())})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:t==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:t==="blue"?"#0f264a":"#005632"},title:"Call",onClick:()=>e(n.phone),children:i.jsx(Lf,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:t==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:t==="blue"?"#0f264a":"#005632"},title:"Message",onClick:()=>e(n.phone),children:i.jsx(vm,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:t==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:t==="blue"?"#0f264a":"#005632"},title:"Video",onClick:()=>e(n.phone),children:i.jsx(b3,{className:"h-4 w-4"})})]})]})},Sue=()=>{const n=Nt(),{user:e}=jt(),{colorScheme:t}=on(),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState(null),[p,x]=E.useState("All"),[v,b]=E.useState("All"),[_,j]=E.useState(""),[C,P]=E.useState(!1),[O,M]=E.useState(!1),D=At("(max-width: 767px)"),[I,F]=E.useState({status:"all",priority:"all",searchTerm:""});E.useEffect(()=>{(async()=>{if(e){c(!0);try{const[G,Z]=await Promise.all([ce.getSupportTickets(),ce.getNearbyUsers()]);s(G),o(Z.filter(oe=>oe.id!==e.id))}catch{h({message:"Failed to load support data.",type:"error"})}finally{c(!1)}}})()},[e]);const q=E.useMemo(()=>r.filter(Y=>{const G=I.status==="all"||Y.status===I.status,Z=I.priority==="all"||Y.priority===I.priority,oe=I.searchTerm===""||Y.title.toLowerCase().includes(I.searchTerm.toLowerCase())||Y.ticketNumber.toLowerCase().includes(I.searchTerm.toLowerCase())||Y.description.toLowerCase().includes(I.searchTerm.toLowerCase());return G&&Z&&oe}),[r,I]),U=E.useMemo(()=>{const Y=r.filter(G=>G.status==="Resolved"&&G.raisedById===e?.id);return{open:r.filter(G=>G.status==="Open").length,inProgress:r.filter(G=>G.status==="In Progress").length,pendingYourAction:Y.length}},[r,e]),B=Y=>{if(!Y){h({message:"User does not have a phone number.",type:"error"});return}let G=Y.replace(/\D/g,"");if(G.length>10&&(G=G.slice(-10)),G.length!==10){h({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${G}`,"_blank")},W=({title:Y,value:G,icon:Z,colorClass:oe})=>i.jsxs("div",{className:"bg-transparent p-5 rounded-2xl flex items-center justify-between transition-all",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted mb-1",children:Y}),i.jsx("p",{className:`text-3xl font-bold ${oe.replace("bg-","text-").split(" ")[0]}`,children:G})]}),i.jsx("div",{className:`p-3 rounded-full bg-opacity-10 ${oe.replace("text-","bg-")} ${oe}`,children:Z})]});return i.jsxs("div",{className:"w-full p-4 lg:p-8 space-y-8",children:[d&&i.jsx(pt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsx(Kr,{isOpen:O,onClose:()=>M(!1),title:"Nearby Available Support",onConfirm:()=>M(!1),confirmButtonText:"Close",children:i.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:a.length>0?a.map(Y=>i.jsx(ZL,{user:Y,onAction:B},Y.id)):i.jsxs("div",{className:"text-center py-8 text-muted",children:[i.jsx(Qi,{className:"h-10 w-10 mx-auto mb-2 opacity-20"}),i.jsx("p",{children:"No support staff found nearby."})]})})}),i.jsx("div",{className:"relative overflow-hidden rounded-3xl bg-transparent p-6 lg:p-10 transition-all",children:i.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg backdrop-blur-sm",children:i.jsx(Ox,{className:"h-6 w-6 text-emerald-600"})}),i.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-primary-text",children:"Support & Audit"})]}),i.jsx("p",{className:"text-muted max-w-xl text-sm",children:"Track issues, request audits, and connect with support staff in real-time."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 w-full lg:w-auto",children:[D&&i.jsxs(ne,{onClick:()=>M(!0),variant:"secondary",className:"flex-1 lg:flex-none bg-gray-100 text-gray-900 hover:bg-gray-200 border-none shadow-none p-0 text-sm transition-colors",children:[i.jsx(yu,{className:"mr-1.5 h-3.5 w-3.5"})," Nearby"]}),i.jsxs(ne,{onClick:()=>n("/support/ticket/new"),className:"flex-1 lg:flex-none",children:[i.jsx(Ut,{className:"mr-1.5 h-3.5 w-3.5"})," New Ticket"]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 lg:gap-6",children:[i.jsx(W,{title:"Open Tickets",value:U.open,icon:i.jsx(Ox,{className:"h-6 w-6"}),colorClass:"text-rose-500"}),i.jsx(W,{title:"In Progress",value:U.inProgress,icon:i.jsx(_t,{className:"h-6 w-6"}),colorClass:"text-blue-500"}),i.jsx(W,{title:"Pending Your Action",value:U.pendingYourAction,icon:i.jsx(yu,{className:"h-6 w-6"}),colorClass:"text-amber-500"})]}),i.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-8",children:[i.jsx("div",{className:"lg:col-span-2 space-y-6",children:i.jsxs("div",{className:"bg-transparent p-5 rounded-2xl",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[i.jsxs("div",{className:"relative flex-grow",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(we,{id:"search",placeholder:"Search tickets...",className:"pl-10 bg-gray-50 border-gray-200",value:I.searchTerm,onChange:Y=>F(G=>({...G,searchTerm:Y.target.value}))})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:"w-32 sm:w-40",children:i.jsxs(Ze,{value:I.status,onChange:Y=>F(G=>({...G,status:Y.target.value})),className:"bg-gray-50 border-gray-200",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{children:"Open"}),i.jsx("option",{children:"In Progress"}),i.jsx("option",{value:"Pending Requester",children:"Pending"}),i.jsx("option",{children:"Resolved"}),i.jsx("option",{children:"Closed"})]})}),i.jsx("div",{className:"w-32 sm:w-40",children:i.jsxs(Ze,{value:I.priority,onChange:Y=>F(G=>({...G,priority:Y.target.value})),className:"bg-gray-50 border-gray-200",children:[i.jsx("option",{value:"all",children:"All Priority"}),i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})})]})]}),l?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:q.length>0?q.map(Y=>i.jsx(jue,{ticket:Y,onClick:()=>n(`/support/ticket/${Y.id}`)},Y.id)):i.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-muted",children:[i.jsx("div",{className:"p-4 bg-accent/5 rounded-full mb-3",children:i.jsx(Ia,{className:"h-8 w-8 opacity-50"})}),i.jsx("p",{children:"No tickets match your filters."})]})})]})}),i.jsx("aside",{className:"hidden lg:block space-y-6",children:i.jsxs("div",{className:"bg-card p-6 rounded-2xl border border-border shadow-sm sticky top-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h3",{className:"font-bold text-lg text-primary-text flex items-center gap-2",children:[i.jsx(Qi,{className:"h-5 w-5 text-accent"})," Nearby Support"]}),i.jsxs("span",{className:"text-xs font-medium bg-accent/10 text-accent px-2 py-1 rounded-full",children:[a.filter(Y=>Y.isAvailable).length," Online"]})]}),i.jsx("div",{className:"space-y-3 max-h-[calc(100vh-200px)] overflow-y-auto pr-1 custom-scrollbar",children:a.length>0?a.map(Y=>i.jsx(ZL,{user:Y,onAction:B},Y.id)):i.jsx("div",{className:"text-center py-8 text-muted",children:i.jsx("p",{children:"No support staff found nearby."})})})]})})]})]})},Nue=({post:n,ticket:e,setTicket:t})=>{const{user:r}=jt(),[s,a]=E.useState(!1),[o,l]=E.useState(""),[c,d]=E.useState(!1),h=r?n.likes.includes(r.id):!1,p=async()=>{if(!r)return;const v=[...n.likes],b=h?n.likes.filter(_=>_!==r.id):[...n.likes,r.id];t(_=>_?{..._,posts:_.posts.map(j=>j.id===n.id?{...j,likes:b}:j)}:null);try{await ce.togglePostLike(n.id,r.id)}catch{t(j=>j?{...j,posts:j.posts.map(C=>C.id===n.id?{...C,likes:v}:C)}:null)}},x=async()=>{if(!(!o.trim()||!r)){d(!0);try{const v=await ce.addPostComment(n.id,{postId:n.id,authorId:r.id,authorName:r.name,content:o});t(b=>b?{...b,posts:b.posts.map(_=>_.id===n.id?{..._,comments:[..._.comments,v]}:_)}:null),l("")}catch{}finally{d(!1)}}};return i.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Zi,{seed:n.authorId,className:"w-10 h-10 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"w-full",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:n.authorName}),i.jsx("span",{className:"text-xs text-muted",children:n.authorRole.replace(/_/g," ")}),i.jsxs("span",{className:"text-xs text-muted",children:[" ",mu(new Date(n.createdAt),{addSuffix:!0})]})]}),i.jsx("p",{className:"text-sm text-muted mt-1 whitespace-pre-wrap",children:n.content}),i.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted",children:[i.jsxs("button",{onClick:p,className:`flex items-center gap-1.5 hover:text-accent transition-colors ${h?"text-accent font-semibold":""}`,children:[i.jsx($J,{className:`h-4 w-4 ${h?"fill-current":""}`}),i.jsxs("span",{children:[n.likes.length," Like",n.likes.length!==1&&"s"]})]}),i.jsxs("button",{onClick:()=>a(!s),className:"flex items-center gap-1.5 hover:text-accent transition-colors",children:[i.jsx(vm,{className:"h-4 w-4"}),i.jsxs("span",{children:[n.comments.length," Comment",n.comments.length!==1&&"s"]})]})]}),s&&i.jsxs("div",{className:"mt-4 space-y-3 pt-3 border-t border-border animate-fade-in-down",children:[n.comments.map(v=>i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Zi,{seed:v.authorId,className:"w-8 h-8 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"bg-page p-2 rounded-lg flex-grow",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"font-semibold text-sm text-primary-text",children:v.authorName}),i.jsx("span",{className:"text-xs text-muted",children:mu(new Date(v.createdAt),{addSuffix:!0})})]}),i.jsx("p",{className:"text-sm text-muted",children:v.content})]})]},v.id)),i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Zi,{className:"w-8 h-8 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("textarea",{value:o,onChange:v=>l(v.target.value),placeholder:"Write a comment...",rows:2,className:"form-input text-sm"}),i.jsx("div",{className:"text-right mt-1",children:i.jsx(ne,{size:"sm",onClick:x,isLoading:c,children:"Post"})})]})]})]})]})]})})},Cue=Pt({rating:ls().min(1,"Please select a rating.").required(),feedback:ye().required("Feedback is required to close the ticket.").min(10,"Please provide more detailed feedback.")}).defined(),Tue=({value:n,onChange:e})=>{const[t,r]=E.useState(0);return i.jsx("div",{className:"flex items-center justify-center gap-1",onMouseLeave:()=>r(0),children:[1,2,3,4,5].map(s=>i.jsx("button",{type:"button",onMouseEnter:()=>r(s),onClick:()=>e(s),className:"focus:outline-none",children:i.jsx(y3,{className:`h-8 w-8 cursor-pointer transition-colors ${(t||n)>=s?"text-yellow-400 fill-current":"text-gray-400"}`})},s))})},kue=({isOpen:n,onClose:e,onSubmit:t})=>{const[r,s]=E.useState(!1),{register:a,handleSubmit:o,control:l,formState:{errors:c}}=tn({resolver:On(Cue),defaultValues:{rating:0,feedback:""}}),d=h=>{s(!0),t(h.rating,h.feedback),s(!1)};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:h=>h.stopPropagation(),children:i.jsxs("form",{onSubmit:o(d),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-2 text-center",children:"Ticket Resolved"}),i.jsx("p",{className:"text-sm text-muted text-center mb-4",children:"Please rate the support you received before closing this ticket."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx(_e,{name:"rating",control:l,render:({field:h})=>i.jsx(Tue,{value:h.value,onChange:h.onChange})}),c.rating&&i.jsx("p",{className:"mt-2 text-xs text-red-500 text-center",children:c.rating.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted text-center",children:"Your Feedback"}),i.jsx("textarea",{...a("feedback"),rows:4,className:`mt-1 form-input ${c.feedback?"form-input--error":""}`}),c.feedback&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.feedback.message})]})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ne,{type:"button",onClick:e,variant:"secondary",children:"Not Now"}),i.jsx(ne,{type:"submit",isLoading:r,children:"Confirm & Close"})]})]})})}):null},Pue=({priority:n})=>{const e={Low:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",Medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",High:"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300",Urgent:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"};return i.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${e[n]}`,children:n})},Mue=({status:n})=>{const e={Open:"status-chip--pending","In Progress":"sync-chip--pending_sync","Pending Requester":"leave-status-chip--pending_hr_confirmation",Resolved:"leave-status-chip--approved",Closed:"status-chip--draft"};return i.jsx("span",{className:`status-chip ${e[n]}`,children:n})},Eue=()=>{const{id:n}=Wf(),e=Nt(),{user:t}=jt(),[r,s]=E.useState(null),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState(null),[p,x]=E.useState(""),[v,b]=E.useState(!1),[_,j]=E.useState(!1);At("(max-width: 1023px)"),E.useEffect(()=>{if(!n)return;(async()=>{c(!0);try{const[q,U]=await Promise.all([ce.getSupportTicketById(n),ce.getNearbyUsers()]);q?s(q):(h({message:"Ticket not found.",type:"error"}),e("/support")),o(U)}catch{h({message:"Failed to load ticket data.",type:"error"})}finally{c(!1)}})()},[n,e]);const C=async()=>{if(!(!p.trim()||!r||!t)){b(!0);try{const F=await ce.addTicketPost(r.id,{ticketId:r.id,authorId:t.id,authorName:t.name,authorRole:t.role,content:p});s(q=>q?{...q,posts:[...q.posts,F]}:null),x("")}catch{h({message:"Failed to add post.",type:"error"})}finally{b(!1)}}},P=async F=>{if(r)try{const q=await ce.updateSupportTicket(r.id,F);s(q),F.status&&h({message:`Ticket status updated to ${F.status}`,type:"success"})}catch{h({message:"Failed to update ticket.",type:"error"})}},O=async(F,q)=>{await P({status:"Closed",rating:F,feedback:q,closedAt:new Date().toISOString()}),j(!1)},M=F=>{if(!F){h({message:"User does not have a phone number.",type:"error"});return}let q=F.replace(/\D/g,"");if(q.length>10&&(q=q.slice(-10)),q.length!==10){h({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${q}`,"_blank")};if(l)return i.jsx("div",{className:"flex justify-center items-center h-screen",children:i.jsx(_t,{className:"h-12 w-12 animate-spin text-accent"})});if(!r)return null;const D=t?.id===r.raisedById,I=()=>r.status==="Closed"?null:i.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.status==="Open"&&i.jsx(ne,{onClick:()=>P({status:"In Progress",assignedToId:t?.id,assignedToName:t?.name}),children:"Assign to Me"}),r.status==="In Progress"&&t?.id===r.assignedToId&&i.jsx(ne,{onClick:()=>P({status:"Resolved",resolvedAt:new Date().toISOString()}),children:"Mark as Resolved"}),r.status==="Resolved"&&D&&i.jsx(ne,{onClick:()=>j(!0),children:"Close Ticket"})]});return i.jsxs("div",{className:"p-4",children:[d&&i.jsx(pt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),_&&i.jsx(kue,{isOpen:_,onClose:()=>j(!1),onSubmit:O}),i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx(ne,{variant:"icon",onClick:()=>e("/support"),children:i.jsx(Fa,{})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl md:text-2xl font-bold text-primary-text",children:r.title}),i.jsxs("p",{className:"text-xs text-muted",children:["#",r.ticketNumber]})]})]}),i.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-6",children:[i.jsxs("main",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card space-y-4",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-start",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(Mue,{status:r.status}),i.jsx(Pue,{priority:r.priority})]}),i.jsxs("div",{className:"text-sm text-muted text-right",children:[i.jsxs("p",{children:["Raised by: ",i.jsx("span",{className:"font-semibold text-primary-text",children:r.raisedByName})]}),i.jsx("p",{children:We(new Date(r.raisedAt),"dd MMM, yyyy - hh:mm a")})]})]}),i.jsx("p",{className:"text-sm text-muted whitespace-pre-wrap",children:r.description}),r.attachmentUrl&&i.jsxs("div",{className:"mt-4",children:[i.jsx("h5",{className:"text-sm font-semibold text-primary-text mb-2",children:"Attachment"}),i.jsx("a",{href:r.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"block border rounded-lg overflow-hidden max-w-xs hover:border-accent",children:i.jsx("img",{src:r.attachmentUrl,alt:"Attachment",className:"max-h-64 w-auto"})})]})]}),i.jsx("div",{className:"space-y-4",children:r.posts.map(F=>i.jsx(Nue,{post:F,ticket:r,setTicket:s},F.id))}),r.status!=="Closed"&&i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card flex items-start gap-3",children:[i.jsx(Zi,{className:"w-10 h-10 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"w-full",children:[i.jsx("textarea",{value:p,onChange:F=>x(F.target.value),placeholder:"Add a public reply...",className:"form-input w-full",rows:3}),i.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[i.jsx(ne,{variant:"icon",size:"sm",title:"Attach file",children:i.jsx(qJ,{className:"h-5 w-5"})}),i.jsxs(ne,{onClick:C,isLoading:v,children:[i.jsx(OC,{className:"mr-2 h-4"})," Post"]})]})]})]})]}),i.jsxs("aside",{className:"space-y-6 mt-6 lg:mt-0",children:[i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[i.jsx("h3",{className:"font-semibold text-primary-text mb-3",children:"Ticket Details"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Assigned To:"})," ",i.jsx("span",{className:"font-semibold",children:r.assignedToName||"Unassigned"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Category:"})," ",i.jsx("span",{children:r.category})]}),r.resolvedAt&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Resolved:"})," ",i.jsx("span",{children:We(new Date(r.resolvedAt),"dd MMM, yy")})]}),r.closedAt&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Closed:"})," ",i.jsx("span",{children:We(new Date(r.closedAt),"dd MMM, yy")})]}),r.rating&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Rating:"})," ",i.jsxs("span",{className:"flex items-center gap-1",children:[r.rating," ",i.jsx(y3,{className:"h-4 w-4 text-yellow-400 fill-current"})]})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:I()})]}),i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[i.jsxs("h3",{className:"font-semibold text-primary-text mb-3 flex items-center gap-2",children:[i.jsx(Qi,{className:"h-5 w-5 text-muted"})," Nearby Users"]}),i.jsx("div",{className:"space-y-3",children:a.map(F=>i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Zi,{photoUrl:F.photoUrl,seed:F.id,className:"w-10 h-10 rounded-full"}),i.jsx("span",{className:"absolute bottom-0 right-0 block h-2.5 w-2.5 rounded-full bg-green-400 ring-2 ring-card"})]}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("p",{className:"text-sm font-semibold",children:F.name}),i.jsx("p",{className:"text-xs text-muted",children:F.role.replace(/_/g," ").replace(/\b\w/g,q=>q.toUpperCase())})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(F.phone),children:i.jsx(Lf,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(F.phone),children:i.jsx(vm,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(F.phone),children:i.jsx(b3,{className:"h-4 w-4"})})]})]},F.id))})]})]})]})]})},Due=Pt({id:ye().optional(),name:ye().required("Name is required"),email:ye().email("Invalid email").required("Email is required"),role:ye().required("Role is required"),password:ye().min(6,"Password must be at least 6 characters").required("Password is required for new users"),phone:ye().optional(),organizationId:ye().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:ye().optional(),reportingManagerId:ye().optional(),photoUrl:ye().optional().nullable()}).defined(),Oue=Pt({id:ye().optional(),name:ye().required("Name is required"),email:ye().email("Invalid email").required("Email is required"),role:ye().required("Role is required"),phone:ye().optional(),organizationId:ye().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:ye().optional(),reportingManagerId:ye().optional(),photoUrl:ye().optional().nullable()}).defined(),KL=()=>{const n=Nt(),{id:e}=Wf(),t=!!e,r=At("(max-width: 767px)"),[s,a]=E.useState(!1),[o,l]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState(null),[x,v]=E.useState(null),b=t?Oue:Due,{register:_,handleSubmit:j,formState:{errors:C},reset:P,watch:O,setValue:M}=tn({resolver:On(b)}),D=O("role");E.useEffect(()=>{(async()=>{try{const[U,B]=await Promise.all([ce.getOrganizations(),ce.getRoles()]);if(l(U),d(B),t&&e){const Y=(await ce.getUsers()).find(G=>G.id===e);Y&&(v(Y),P(Y))}else P({name:"",email:"",role:"field_officer"})}catch{p({message:"Failed to load form data.",type:"error"})}})()},[e,t,P]);const I=q=>{const U=q.target.value,B=o.find(W=>W.id===U);M("organizationId",U),M("organizationName",B?.shortName||"")},F=async q=>{a(!0);try{if(t&&e){const{password:U,...B}=q;await ce.updateUser(e,B),p({message:"User updated successfully!",type:"success"})}else{const{name:U,email:B,password:W,role:Y,...G}=q;if(!W)throw new Error("Password is required when creating a new user");const Z=await ce.createAuthUser({name:U,email:B,password:W,role:Y});G&&Object.keys(G).length>0&&await ce.updateUser(Z.id,G),await ce.createNotification({userId:Z.id,message:`Welcome ${Z.name}! Your account has been created.`,type:"greeting"}),p({message:"User created successfully!",type:"success"})}setTimeout(()=>n("/admin/users"),1500)}catch(U){p({message:U.message||"Failed to save user.",type:"error"})}finally{a(!1)}};return r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit User":"Add User"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Gc,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit User":"Add New User"}),i.jsx("p",{className:"text-sm text-gray-400",children:t?"Update user information below.":"Create a new user account with initial credentials."})]}),i.jsxs("form",{onSubmit:j(F),className:"space-y-4",children:[i.jsx(we,{label:"Full Name",id:"name",registration:_("name"),error:C.name?.message}),i.jsx(we,{label:"Email",id:"email",type:"email",registration:_("email"),error:C.email?.message}),i.jsx(Ze,{label:"Role",id:"role",registration:_("role"),error:C.role?.message,children:c.map(q=>i.jsx("option",{value:q.id,children:q.displayName},q.id))}),!t&&i.jsx(we,{label:"Password",id:"password",type:"password",registration:_("password"),error:C.password?.message}),D==="site_manager"&&i.jsxs(Ze,{label:"Assigned Site",id:"organizationId",..._("organizationId"),error:C.organizationId?.message,onChange:I,children:[i.jsx("option",{value:"",children:"Select a Site"}),o.map(q=>i.jsx("option",{value:q.id,children:q.shortName},q.id))]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/users"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:j(F),disabled:s,className:"fo-btn-primary flex-1",children:s?"Saving...":t?"Save Changes":"Create User"})]}),h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Gc,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit User":"Add New User"}),i.jsx("p",{className:"text-muted",children:t?"Update user information below.":"Create a new user account with initial credentials."})]})]}),i.jsxs("form",{onSubmit:j(F),className:"space-y-6",children:[i.jsx(we,{label:"Full Name",id:"name",registration:_("name"),error:C.name?.message}),i.jsx(we,{label:"Email",id:"email",type:"email",registration:_("email"),error:C.email?.message}),i.jsx(Ze,{label:"Role",id:"role",registration:_("role"),error:C.role?.message,children:c.map(q=>i.jsx("option",{value:q.id,children:q.displayName},q.id))}),!t&&i.jsx(we,{label:"Password",id:"password",type:"password",registration:_("password"),error:C.password?.message}),D==="site_manager"&&i.jsxs(Ze,{label:"Assigned Site",id:"organizationId",..._("organizationId"),error:C.organizationId?.message,onChange:I,children:[i.jsx("option",{value:"",children:"Select a Site"}),o.map(q=>i.jsx("option",{value:q.id,children:q.shortName},q.id))]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/admin/users"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:s,children:t?"Save Changes":"Create User"})]})]})]}),h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)})]})},Iue=()=>{const n=Nt(),e=At("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(""),[o,l]=E.useState(!1),[c,d]=E.useState(null),h=async p=>{if(p.preventDefault(),!!t.trim()){l(!0);try{await ce.createPolicy({name:t.trim(),description:s.trim()}),d({message:"Policy created successfully!",type:"success"}),setTimeout(()=>n("/hr/policies-and-insurance"),1500)}catch{d({message:"Failed to save policy. Please try again.",type:"error"})}finally{l(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Policy"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(ds,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Policy"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new policy for your organization."})]}),i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:p=>r(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:o})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"description",value:s,onChange:p=>a(p.target.value),placeholder:"Description",className:"form-input",rows:4,disabled:o})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/policies-and-insurance"),disabled:o,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:h,disabled:o||!t.trim(),className:"fo-btn-primary flex-1",children:o?"Saving...":"Save Policy"})]}),c&&i.jsx(pt,{message:c.message,type:c.type,onDismiss:()=>d(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(ds,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Policy"}),i.jsx("p",{className:"text-muted",children:"Create a new policy for your organization."})]})]}),i.jsxs("form",{onSubmit:h,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:p=>r(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:o})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"description",value:s,onChange:p=>a(p.target.value),placeholder:"Description",className:"form-input",rows:4,disabled:o})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/hr/policies-and-insurance"),variant:"secondary",disabled:o,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:o,disabled:!t.trim(),children:"Save Policy"})]})]})]}),c&&i.jsx(pt,{message:c.message,type:c.type,onDismiss:()=>d(null)})]})},Aue=Pt({title:ye().required("Title is required"),description:ye().required("Description is required"),category:ye().oneOf(["Software Developer","Admin","Operational","HR Query","Other"]).required("Category is required"),priority:ye().oneOf(["Low","Medium","High","Urgent"]).required("Priority is required"),assignedToId:ye().optional().nullable(),attachment:Vt().optional().nullable()}).defined(),Rue=()=>{const n=Nt(),{user:e}=jt(),[t,r]=E.useState(!1),[s,a]=E.useState([]),[o,l]=E.useState(null),c=At("(max-width: 767px)"),{register:d,handleSubmit:h,control:p,formState:{errors:x}}=tn({resolver:On(Aue),defaultValues:{category:"Software Developer",priority:"Medium",assignedToId:null,attachment:null}}),v=uu({control:p,name:"category"});E.useEffect(()=>{ce.getUsers().then(a)},[]);const b=E.useMemo(()=>{if(!s)return[];switch(v){case"Software Developer":return s.filter(P=>P.role==="developer");case"Admin":return s.filter(P=>P.role==="admin");case"HR Query":return s.filter(P=>P.role==="hr");case"Operational":return s.filter(P=>["operation_manager","site_manager"].includes(P.role));default:const C=["admin","hr","developer","operation_manager","site_manager"];return s.filter(P=>C.includes(P.role))}},[s,v]),_=async C=>{if(e){r(!0);try{const P=s.find(O=>O.id===C.assignedToId);await ce.createSupportTicket({...C,attachment:C.attachment,status:"Open",raisedById:e.id,raisedByName:e.name,assignedToId:C.assignedToId||null,assignedToName:P?.name||null,resolvedAt:null,closedAt:null,rating:null,feedback:null}),l({message:"Ticket created successfully!",type:"success"}),setTimeout(()=>n("/support"),1500)}catch{l({message:"Failed to create ticket.",type:"error"})}finally{r(!1)}}},j="new-ticket-form";return c?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"New Support Ticket"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(BM,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Create New Ticket"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Submit a support request or report an issue."})]}),i.jsxs("form",{id:j,onSubmit:h(_),className:"space-y-4",children:[i.jsx(we,{placeholder:"Title / Subject",...d("title"),error:x.title?.message}),i.jsxs("div",{children:[i.jsx("textarea",{placeholder:"Description",...d("description"),rows:5,className:`form-input ${x.description?"form-input--error":""}`}),x.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.description.message})]}),i.jsx(_e,{name:"category",control:p,render:({field:C})=>i.jsxs(Ze,{...C,error:x.category?.message,children:[i.jsx("option",{children:"Software Developer"}),i.jsx("option",{children:"Admin"}),i.jsx("option",{children:"Operational"}),i.jsx("option",{children:"HR Query"}),i.jsx("option",{children:"Other"})]})}),i.jsx(_e,{name:"priority",control:p,render:({field:C})=>i.jsxs(Ze,{...C,error:x.priority?.message,children:[i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})}),i.jsx(_e,{name:"assignedToId",control:p,render:({field:C})=>i.jsxs(Ze,{...C,value:C.value??"",error:x.assignedToId?.message,children:[i.jsx("option",{value:"",children:"Unassigned"}),b.map(P=>i.jsxs("option",{value:P.id,children:[P.name," (",P.role.replace(/_/g," "),")"]},P.id))]})}),i.jsx(_e,{name:"attachment",control:p,render:({field:C,fieldState:P})=>i.jsx(vt,{label:"Attach Screenshot or Document (Image only)",file:C.value,onFileChange:C.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:P.error?.message})})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/support"),disabled:t,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",form:j,disabled:t,className:"fo-btn-primary flex-1",children:t?"Creating...":"Create Ticket"})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(BM,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Create New Ticket"}),i.jsx("p",{className:"text-muted",children:"Submit a support request or report an issue."})]})]}),i.jsxs("form",{id:j,onSubmit:h(_),className:"space-y-6",children:[i.jsx(we,{label:"Title / Subject",...d("title"),error:x.title?.message}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{...d("description"),rows:5,className:`form-input ${x.description?"form-input--error":""}`}),x.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.description.message})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(_e,{name:"category",control:p,render:({field:C})=>i.jsxs(Ze,{label:"Category",...C,error:x.category?.message,children:[i.jsx("option",{children:"Software Developer"}),i.jsx("option",{children:"Admin"}),i.jsx("option",{children:"Operational"}),i.jsx("option",{children:"HR Query"}),i.jsx("option",{children:"Other"})]})}),i.jsx(_e,{name:"priority",control:p,render:({field:C})=>i.jsxs(Ze,{label:"Priority",...C,error:x.priority?.message,children:[i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})})]}),i.jsx(_e,{name:"assignedToId",control:p,render:({field:C})=>i.jsxs(Ze,{label:"Assigned To (Optional)",...C,value:C.value??"",error:x.assignedToId?.message,children:[i.jsx("option",{value:"",children:"Unassigned"}),b.map(P=>i.jsxs("option",{value:P.id,children:[P.name," (",P.role.replace(/_/g," "),")"]},P.id))]})}),i.jsx(_e,{name:"attachment",control:p,render:({field:C,fieldState:P})=>i.jsx(vt,{label:"Attach Screenshot or Document (Image only)",file:C.value,onFileChange:C.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:P.error?.message})}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/support"),variant:"secondary",disabled:t,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:t,children:"Create Ticket"})]})]})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},Lue=()=>{const n=Nt(),e=At("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(!1),[o,l]=E.useState(null),c=async d=>{if(d.preventDefault(),!!t.trim()){a(!0);try{const h={id:`group_${Date.now()}`,name:t.trim(),locations:[],companies:[]};l({message:"Group created successfully!",type:"success"}),setTimeout(()=>n("/hr/entity-management"),1500)}catch{l({message:"Failed to create group. Please try again.",type:"error"})}finally{a(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Group"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Ki,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Group"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new organizational group."})]}),i.jsx("form",{onSubmit:c,className:"space-y-4",children:i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Group Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:d=>r(d.target.value),placeholder:"Enter group name",className:"form-input",required:!0,disabled:s})]})})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/entity-management"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:c,disabled:s||!t.trim(),className:"fo-btn-primary flex-1",children:s?"Saving...":"Create Group"})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Ki,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Group"}),i.jsx("p",{className:"text-muted",children:"Create a new organizational group."})]})]}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Group Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:d=>r(d.target.value),placeholder:"Enter group name",className:"form-input",required:!0,disabled:s})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/hr/entity-management"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:s,disabled:!t.trim(),children:"Create Group"})]})]})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},Fue=()=>{const n=Nt(),e=At("(max-width: 767px)"),[t,r]=E.useState([]),[s,a]=E.useState(""),[o,l]=E.useState(""),[c,d]=E.useState(""),[h,p]=E.useState(!1),[x,v]=E.useState(null),b=async _=>{if(_.preventDefault(),!(!s||!o||!c.trim())){p(!0);try{console.log("Granting comp off:",{userId:s,days:o,reason:c}),v({message:"Comp off granted successfully!",type:"success"}),setTimeout(()=>n("/hr/leave-management"),1500)}catch{v({message:"Failed to grant comp off.",type:"error"})}finally{p(!1)}}};return E.useEffect(()=>{(async()=>{try{const j=await ce.getUsers();r(j)}catch{v({message:"Failed to load users.",type:"error"})}})()},[]),e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Grant Comp Off"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(UM,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Grant Compensatory Off"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Grant comp off days to an employee."})]}),i.jsxs("form",{onSubmit:b,className:"space-y-4",children:[i.jsxs(Ze,{label:"Select Employee",id:"user",value:s,onChange:_=>a(_.target.value),error:!s&&s!==""?"Please select an employee":"",children:[i.jsx("option",{value:"",children:"Select an employee"}),t.map(_=>i.jsxs("option",{value:_.id,children:[_.name," - ",_.role]},_.id))]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"days",className:"block text-sm font-medium text-muted mb-1",children:["Number of Days ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"days",type:"number",step:"0.5",min:"0.5",value:o,onChange:_=>l(_.target.value),placeholder:"e.g. 1, 0.5, 2",className:"form-input",required:!0,disabled:h})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-muted mb-1",children:["Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"reason",value:c,onChange:_=>d(_.target.value),placeholder:"Reason for granting comp off",className:"form-input",rows:4,required:!0,disabled:h})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/leave-management"),disabled:h,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:b,disabled:h||!s||!o||!c.trim(),className:"fo-btn-primary flex-1",children:h?"Granting...":"Grant Comp Off"})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(UM,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Grant Compensatory Off"}),i.jsx("p",{className:"text-muted",children:"Grant comp off days to an employee."})]})]}),i.jsxs("form",{onSubmit:b,className:"space-y-6",children:[i.jsxs(Ze,{label:"Select Employee",id:"user",value:s,onChange:_=>a(_.target.value),children:[i.jsx("option",{value:"",children:"Select an employee"}),t.map(_=>i.jsxs("option",{value:_.id,children:[_.name," - ",_.role]},_.id))]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"days",className:"block text-sm font-medium text-muted mb-1",children:["Number of Days ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"days",type:"number",step:"0.5",min:"0.5",value:o,onChange:_=>l(_.target.value),placeholder:"e.g. 1, 0.5, 2",className:"form-input",required:!0,disabled:h})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-muted mb-1",children:["Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"reason",value:c,onChange:_=>d(_.target.value),placeholder:"Reason for granting comp off",className:"form-input",rows:4,required:!0,disabled:h})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/hr/leave-management"),variant:"secondary",disabled:h,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:h,disabled:!s||!o||!c.trim(),children:"Grant Comp Off"})]})]})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>v(null)})]})},que=()=>{const n=Nt(),e=At("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(""),[o,l]=E.useState(""),[c,d]=E.useState(!1),[h,p]=E.useState(null),x=async v=>{if(v.preventDefault(),!(!t.trim()||!s.trim())){d(!0);try{const b={id:t.toLowerCase().replace(/\s+/g,"_"),name:t.trim(),description:s.trim(),permissions:o.split(",").map(C=>C.trim()).filter(Boolean)},_=await ce.getModules();if(_.some(C=>C.id===b.id)){p({message:"Module with this ID already exists.",type:"error"}),d(!1);return}const j=[..._,b];await ce.saveModules(j),p({message:"Module created successfully!",type:"success"}),setTimeout(()=>n("/admin/modules"),1500)}catch{p({message:"Failed to create module. Please try again.",type:"error"})}finally{d(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Module"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(bm,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Module"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new system module."})]}),i.jsxs("form",{onSubmit:x,className:"space-y-4",children:[i.jsx(we,{label:"Module Name",id:"name",value:t,onChange:v=>r(v.target.value),placeholder:"e.g. HR Tasks & Management",required:!0,disabled:c,error:!t.trim()&&t!==""?"Module name is required":""}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:["Description ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"description",value:s,onChange:v=>a(v.target.value),placeholder:"Manage leaves, policies, insurance, uniforms, and tasks.",className:"form-input",rows:4,required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"permissions",className:"block text-sm font-medium text-muted mb-1",children:"Permissions (comma-separated)"}),i.jsx("input",{id:"permissions",value:o,onChange:v=>l(v.target.value),placeholder:"e.g. view_module, manage_module",className:"form-input",disabled:c})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/modules"),disabled:c,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:x,disabled:c||!t.trim()||!s.trim(),className:"fo-btn-primary flex-1",children:c?"Creating...":"Create Module"})]}),h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(bm,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Module"}),i.jsx("p",{className:"text-muted",children:"Create a new system module."})]})]}),i.jsxs("form",{onSubmit:x,className:"space-y-6",children:[i.jsx(we,{label:"Module Name",id:"name",value:t,onChange:v=>r(v.target.value),placeholder:"e.g. HR Tasks & Management",required:!0,disabled:c}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:["Description ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"description",value:s,onChange:v=>a(v.target.value),placeholder:"Manage leaves, policies, insurance, uniforms, and tasks.",className:"form-input",rows:4,required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"permissions",className:"block text-sm font-medium text-muted mb-1",children:"Permissions (comma-separated)"}),i.jsx("input",{id:"permissions",value:o,onChange:v=>l(v.target.value),placeholder:"e.g. view_module, manage_module",className:"form-input",disabled:c})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/admin/modules"),variant:"secondary",disabled:c,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:c,disabled:!t.trim()||!s.trim(),children:"Create Module"})]})]})]}),h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)})]})},JL=()=>{const n=Nt(),{id:e}=Wf(),t=!!e,r=At("(max-width: 767px)"),{permissions:s,setRolePermissions:a,addRolePermissionEntry:o}=na(),[l,c]=E.useState(""),[d,h]=E.useState(""),[p,x]=E.useState([]),[v,b]=E.useState(!1),[_,j]=E.useState(null);E.useEffect(()=>{(async()=>{try{if(t&&e){const D=(await ce.getRoles()).find(I=>I.id===e);if(D){c(D.id),h(D.displayName);const I=s[D.id]||[];x(I)}}}catch{j({message:"Failed to load data.",type:"error"})}})()},[e,t,s]);const C=O=>{x(M=>M.includes(O)?M.filter(D=>D!==O):[...M,O])},P=async O=>{if(O.preventDefault(),!(!l.trim()||!d.trim())){b(!0);try{const M=t?l:l.toLowerCase().replace(/\s+/g,"_"),D={id:M,displayName:d.trim()},I=await ce.getRoles();let F=[...I];if(t)F=F.map(q=>q.id===M?D:q);else{if(I.some(q=>q.id===M)){j({message:"Role ID already exists.",type:"error"}),b(!1);return}F.push(D)}await ce.saveRoles(F),a(M,p),t||o(D),j({message:`Role ${t?"updated":"created"} successfully!`,type:"success"}),setTimeout(()=>n("/admin/roles"),1500)}catch{j({message:"Failed to save role. Please try again.",type:"error"})}finally{b(!1)}}};return r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Role":"Add Role"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(wm,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit Role":"Add New Role"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Define role permissions and access control."})]}),i.jsxs("form",{onSubmit:P,className:"space-y-4",children:[i.jsx(we,{label:"Role ID",id:"roleId",value:l,onChange:O=>c(O.target.value),placeholder:"e.g. admin, hr, field_officer",required:!0,disabled:v||t}),i.jsx(we,{label:"Display Name",id:"displayName",value:d,onChange:O=>h(O.target.value),placeholder:"e.g. Admin, HR, Field Officer",required:!0,disabled:v}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Permissions"}),i.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Sm.map(O=>i.jsxs("label",{className:"flex items-center gap-2 p-2 rounded hover:bg-page cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.includes(O.key),onChange:()=>C(O.key),className:"form-checkbox",disabled:v}),i.jsx("span",{className:"text-sm",children:O.name})]},O.key))})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/roles"),disabled:v,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:P,disabled:v||!l.trim()||!d.trim(),className:"fo-btn-primary flex-1",children:v?"Saving...":t?"Save Changes":"Create Role"})]}),_&&i.jsx(pt,{message:_.message,type:_.type,onDismiss:()=>j(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(wm,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit Role":"Add New Role"}),i.jsx("p",{className:"text-muted",children:"Define role permissions and access control."})]})]}),i.jsxs("form",{onSubmit:P,className:"space-y-6",children:[i.jsx(we,{label:"Role ID",id:"roleId",value:l,onChange:O=>c(O.target.value),placeholder:"e.g. admin, hr, field_officer",required:!0,disabled:v||t}),i.jsx(we,{label:"Display Name",id:"displayName",value:d,onChange:O=>h(O.target.value),placeholder:"e.g. Admin, HR, Field Officer",required:!0,disabled:v}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-muted mb-2",children:["Permissions (",p.length," selected)"]}),i.jsx("div",{className:"border border-border rounded-lg p-4 space-y-2 max-h-96 overflow-y-auto",children:Sm.map(O=>i.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-page cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.includes(O.key),onChange:()=>C(O.key),className:"form-checkbox",disabled:v}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium",children:O.name}),O.description&&i.jsx("div",{className:"text-xs text-muted",children:O.description})]})]},O.key))})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/admin/roles"),variant:"secondary",disabled:v,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:v,disabled:!l.trim()||!d.trim(),children:t?"Save Changes":"Create Role"})]})]})]}),_&&i.jsx(pt,{message:_.message,type:_.type,onDismiss:()=>j(null)})]})},zue=Pt({groupId:ye().required("Please select a group"),companyId:ye().required("Please select a company"),clientId:ye().required("Please select a client"),manpowerCount:ls().typeError("Must be a number").min(0,"Cannot be negative").required("Manpower count is required")}).defined(),Uue=()=>{const n=Nt(),e=At("(max-width: 767px)"),[t,r]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(!1),[c,d]=E.useState(""),[h,p]=E.useState(!1),[x,v]=E.useState(null),b=E.useRef(null),{register:_,handleSubmit:j,watch:C,formState:{errors:P},setValue:O}=tn({resolver:On(zue)}),M=C("groupId"),D=C("companyId");E.useEffect(()=>{a(!0),ce.getOrganizationStructure().then(r).catch(()=>v({message:"Failed to load organization structure.",type:"error"})).finally(()=>a(!1))},[]),E.useEffect(()=>{O("companyId",""),O("clientId",""),d("")},[M,O]),E.useEffect(()=>{O("clientId",""),d("")},[D,O]),E.useEffect(()=>{const W=Y=>{b.current&&!b.current.contains(Y.target)&&p(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[]);const I=E.useMemo(()=>t.find(W=>W.id===M)?.companies||[],[t,M]),F=E.useMemo(()=>I.find(W=>W.id===D)?.entities||[],[I,D]),q=E.useMemo(()=>c?F.filter(W=>W.name.toLowerCase().includes(c.toLowerCase())):F,[F,c]),U=W=>{O("clientId",W.id,{shouldValidate:!0}),d(W.name),p(!1)},B=async W=>{const Y=F.find(G=>G.id===W.clientId);if(Y){l(!0);try{if((await ce.getOrganizations()).some(oe=>oe.id===Y.organizationId)){v({message:"A site for this client already exists.",type:"error"}),l(!1);return}const Z={id:Y.organizationId||`site_${Date.now()}`,shortName:Y.name,fullName:Y.name,address:Y.location||Y.registeredAddress||"",manpowerApprovedCount:W.manpowerCount};await ce.createOrganization(Z),v({message:"Site added successfully!",type:"success"}),setTimeout(()=>n("/admin/sites"),1500)}catch{v({message:"Failed to add site. Please try again.",type:"error"})}finally{l(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Site"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Ki,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add Site from Client"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new site from an existing client entity."})]}),s?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("form",{onSubmit:j(B),className:"space-y-4",children:[i.jsxs(Ze,{label:"Group",id:"groupId",registration:_("groupId"),error:P.groupId?.message,children:[i.jsx("option",{value:"",children:"Select a Group"}),t.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs(Ze,{label:"Company",id:"companyId",registration:_("companyId"),error:P.companyId?.message,disabled:!M,children:[i.jsx("option",{value:"",children:"Select a Company"}),I.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs("div",{className:"relative",ref:b,children:[i.jsx(we,{label:"Client",id:"clientSearch",value:c,onChange:W=>{d(W.target.value),p(!0),O("clientId","")},onFocus:()=>p(!0),disabled:!D,error:P.clientId?.message,autoComplete:"off"}),h&&q.length>0&&i.jsx("ul",{className:"absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto shadow-lg",children:q.map(W=>i.jsx("li",{onClick:()=>U(W),className:"px-3 py-2 text-sm cursor-pointer hover:bg-page",children:W.name},W.id))})]}),i.jsx(we,{label:"Approved Manpower Count",id:"manpowerCount",type:"number",registration:_("manpowerCount"),error:P.manpowerCount?.message})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/sites"),disabled:o,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:j(B),disabled:o||s,className:"fo-btn-primary flex-1",children:o?"Adding...":"Add Site"})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Ki,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add Site from Client"}),i.jsx("p",{className:"text-muted",children:"Create a new site from an existing client entity."})]})]}),s?i.jsx("div",{className:"flex justify-center py-12",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("form",{onSubmit:j(B),className:"space-y-6",children:[i.jsxs(Ze,{label:"Group",id:"groupId",registration:_("groupId"),error:P.groupId?.message,children:[i.jsx("option",{value:"",children:"Select a Group"}),t.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs(Ze,{label:"Company",id:"companyId",registration:_("companyId"),error:P.companyId?.message,disabled:!M,children:[i.jsx("option",{value:"",children:"Select a Company"}),I.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs("div",{className:"relative",ref:b,children:[i.jsx(we,{label:"Client",id:"clientSearch",value:c,onChange:W=>{d(W.target.value),p(!0),O("clientId","")},onFocus:()=>p(!0),disabled:!D,error:P.clientId?.message,autoComplete:"off"}),h&&q.length>0&&i.jsx("ul",{className:"absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto shadow-lg",children:q.map(W=>i.jsx("li",{onClick:()=>U(W),className:"px-3 py-2 text-sm cursor-pointer hover:bg-page",children:W.name},W.id))})]}),i.jsx(we,{label:"Approved Manpower Count",id:"manpowerCount",type:"number",registration:_("manpowerCount"),error:P.manpowerCount?.message}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/admin/sites"),variant:"secondary",disabled:o,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:o,children:"Add Site"})]})]})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>v(null)})]})},Bue=()=>{const n=Nt(),e=At("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(!1),[o,l]=E.useState(null),c=async d=>{if(d.preventDefault(),!!t.trim()){a(!0);try{const h={id:`SITE-${t.toUpperCase().replace(/\s/g,"").substring(0,4)}-${Date.now()%1e3}`,shortName:t.trim(),fullName:t.trim(),address:"To be configured",provisionalCreationDate:new Date().toISOString()};await ce.createOrganization(h),l({message:`Provisional site '${t}' created.`,type:"success"}),setTimeout(()=>n("/admin/sites"),1500)}catch(h){const p=h?.message||h?.error?.message||"Failed to create site.";l({message:`Failed to create site: ${p}`,type:"error"})}finally{a(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Quick Add Site"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(LN,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Quick Add Provisional Site"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new site with a 90-day grace period."})]}),i.jsxs("form",{onSubmit:c,className:"space-y-4",children:[i.jsx(we,{label:"New Site Name",id:"quick-add-site-name",value:t,onChange:d=>r(d.target.value),placeholder:"e.g. New Project Site",required:!0,disabled:s,autoFocus:!0}),i.jsx("p",{className:"text-xs text-muted",children:"This will create a new site with a 90-day grace period to complete the full configuration."})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/sites"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:c,disabled:s||!t.trim(),className:"fo-btn-primary flex-1",children:s?"Adding...":"Add Site"})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(LN,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Quick Add Provisional Site"}),i.jsx("p",{className:"text-muted",children:"Create a new site with a 90-day grace period to complete the full configuration."})]})]}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[i.jsx(we,{label:"New Site Name",id:"quick-add-site-name",value:t,onChange:d=>r(d.target.value),placeholder:"e.g. New Project Site",required:!0,disabled:s,autoFocus:!0}),i.jsx("p",{className:"text-sm text-muted -mt-4",children:"This will create a new site with a 90-day grace period to complete the full configuration."}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/admin/sites"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:s,disabled:!t.trim(),children:"Add Site"})]})]})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},Vue=Pt({name:ye().required("Task name is required"),description:ye().required("Description is required"),dueDate:ye().required("A due date is required").nullable(),priority:ye().oneOf(["Low","Medium","High"]).required("Priority is required"),assignedToId:ye().required("An assignee is required"),escalationLevel1UserId:ye().optional(),escalationLevel1DurationDays:ls().when("escalationLevel1UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationLevel2UserId:ye().optional(),escalationLevel2DurationDays:ls().when("escalationLevel2UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationEmail:ye().email("Must be a valid email address").optional(),escalationEmailDurationDays:ls().when("escalationEmail",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()})}).defined(),QL=()=>{const n=Nt(),{id:e}=Wf(),t=!!e,r=At("(max-width: 767px)"),{createTask:s,updateTask:a,tasks:o}=S1(),[l,c]=E.useState(!1),[d,h]=E.useState([]),[p,x]=E.useState(null),{permissions:v}=na(),{fetchNotifications:b}=uy(),{theme:_}=td(),{colorScheme:j}=on(),C=qa(j),P=_==="dark"||C.isDark,{register:O,handleSubmit:M,formState:{errors:D},reset:I,control:F,watch:q}=tn({resolver:On(Vue),defaultValues:{priority:"Medium",assignedToId:"",dueDate:null}}),U=q("escalationLevel1UserId"),B=q("escalationLevel2UserId"),W=q("escalationEmail"),Y=async te=>{c(!0);try{t&&e?(await a(e,te),x({message:"Task updated successfully",type:"success"})):(await s(te),x({message:"Task created successfully",type:"success"})),setTimeout(()=>n("/tasks"),1500)}catch(H){console.error("Failed to save task:",H),x({message:"Failed to save task. Please try again.",type:"error"}),c(!1)}},G="!text-white !border-white/10 !placeholder-slate-400 !rounded-xl focus:!ring-2 focus:!ring-opacity-50",Z="text-gray-300 font-medium mb-1.5 block",oe="",X="block text-sm font-medium text-muted mb-1",he=P?G:oe,$=P?{backgroundColor:C.sidebarBg,borderColor:"rgba(255,255,255,0.1)"}:{},K=P?Z:X;return r?i.jsxs("div",{className:"h-full flex flex-col",style:{backgroundColor:P?C.mobileBg:void 0,color:P?"white":void 0},children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Task":"Add Task"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"rounded-2xl p-6 space-y-6",style:{backgroundColor:P?C.sidebarBg:"white",borderColor:P?"rgba(255,255,255,0.1)":void 0,borderWidth:P?1:0},children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:`inline-block p-3 rounded-full mb-2 ${P?"bg-white/10":"bg-accent-light"}`,children:i.jsx(_m,{className:`h-8 w-8 ${P?"text-white":"text-accent-dark"}`})}),i.jsx("h2",{className:`text-xl font-bold ${P?"text-white":"text-primary-text"}`,children:t?"Edit Task":"Create New Task"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Assign tasks and set deadlines."})]}),i.jsxs("form",{onSubmit:M(Y),className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"name",className:K,children:"Task Name"}),i.jsx(we,{id:"name",registration:O("name"),error:D.name?.message,className:he,style:$,placeholder:P?"Enter task name":""})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:K,children:"Description"}),i.jsx("textarea",{id:"description",rows:4,...O("description"),className:P?`w-full ${he} px-3 py-3 outline-none`:`mt-1 bg-card border ${D.description?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`,style:P?$:{},placeholder:P?"Enter task description":""}),D.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:D.description.message})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:K,children:"Due Date"}),i.jsx(_e,{name:"dueDate",control:F,render:({field:te})=>i.jsx(En,{label:"",id:"dueDate",value:te.value,onChange:te.onChange,error:D.dueDate?.message,minDate:new Date,className:he,style:$})})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"priority",className:K,children:"Priority"}),i.jsxs(Ze,{id:"priority",registration:O("priority"),error:D.priority?.message,className:he,style:$,children:[i.jsx("option",{value:"Low",style:P?{backgroundColor:C.sidebarBg}:{},children:"Low"}),i.jsx("option",{value:"Medium",style:P?{backgroundColor:C.sidebarBg}:{},children:"Medium"}),i.jsx("option",{value:"High",style:P?{backgroundColor:C.sidebarBg}:{},children:"High"})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"assignedToId",className:K,children:"Assign To"}),i.jsxs(Ze,{id:"assignedToId",registration:O("assignedToId"),error:D.assignedToId?.message,className:he,style:$,children:[i.jsx("option",{value:"",style:P?{backgroundColor:C.sidebarBg}:{},children:"Select User"}),d.map(te=>i.jsxs("option",{value:te.id,style:P?{backgroundColor:C.sidebarBg}:{},children:[te.name," (",te.role.replace(/_/g," "),")"]},te.id))]})]})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/tasks"),disabled:l,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:M(Y),disabled:l,className:"fo-btn-primary flex-1",children:l?"Saving...":t?"Save Changes":"Create Task"})]}),p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)})]}):i.jsxs("div",{className:`p-4 md:p-6 ${P?"text-white":""}`,children:[i.jsxs("div",{className:`p-8 rounded-xl shadow-card w-full max-w-3xl mx-auto ${P?"":"bg-card"}`,style:P?{backgroundColor:C.sidebarBg,borderColor:"rgba(255,255,255,0.1)",borderWidth:1}:{},children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:`p-3 rounded-full mr-4 ${P?"bg-white/10":"bg-accent-light"}`,children:i.jsx(_m,{className:`h-8 w-8 ${P?"text-white":"text-accent-dark"}`})}),i.jsxs("div",{children:[i.jsx("h2",{className:`text-2xl font-bold ${P?"text-white":"text-primary-text"}`,children:t?"Edit Task":"Create New Task"}),i.jsx("p",{className:P?"text-gray-400":"text-muted",children:"Assign tasks and set deadlines."})]})]}),i.jsxs("form",{onSubmit:M(Y),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"name",className:K,children:"Task Name"}),i.jsx(we,{id:"name",registration:O("name"),error:D.name?.message,className:he,style:$,placeholder:P?"Enter task name":""})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"description",className:K,children:"Description"}),i.jsx("textarea",{id:"description",rows:4,...O("description"),className:P?`w-full ${he} px-3 py-3 outline-none`:`mt-1 bg-card border ${D.description?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`,style:P?$:{},placeholder:P?"Enter task description":""}),D.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:D.description.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:K,children:"Due Date"}),i.jsx(_e,{name:"dueDate",control:F,render:({field:te})=>i.jsx(En,{label:"",id:"dueDate",value:te.value,onChange:te.onChange,error:D.dueDate?.message,minDate:new Date,className:he,style:$})})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"priority",className:K,children:"Priority"}),i.jsxs(Ze,{id:"priority",registration:O("priority"),error:D.priority?.message,className:he,style:$,children:[i.jsx("option",{value:"Low",style:P?{backgroundColor:C.sidebarBg}:{},children:"Low"}),i.jsx("option",{value:"Medium",style:P?{backgroundColor:C.sidebarBg}:{},children:"Medium"}),i.jsx("option",{value:"High",style:P?{backgroundColor:C.sidebarBg}:{},children:"High"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"assignedToId",className:K,children:"Assign To"}),i.jsxs(Ze,{id:"assignedToId",registration:O("assignedToId"),error:D.assignedToId?.message,className:he,style:$,children:[i.jsx("option",{value:"",style:P?{backgroundColor:C.sidebarBg}:{},children:"Select User"}),d.map(te=>i.jsxs("option",{value:te.id,style:P?{backgroundColor:C.sidebarBg}:{},children:[te.name," (",te.role.replace(/_/g," "),")"]},te.id))]})]})]}),i.jsxs("div",{className:`pt-6 border-t ${P?"border-white/10":"border-border"}`,children:[i.jsx("h4",{className:`text-lg font-semibold ${P?"text-white":"text-primary-text"} mb-1`,children:"Escalation Matrix (Optional)"}),i.jsx("p",{className:`text-sm ${P?"text-gray-400":"text-muted"} mb-6`,children:"Define who gets notified if this task becomes overdue."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel1UserId",className:K,children:"Escalation Level 1"}),i.jsxs(Ze,{id:"escalationLevel1UserId",registration:O("escalationLevel1UserId"),error:D.escalationLevel1UserId?.message,className:he,style:$,children:[i.jsx("option",{value:"",style:P?{backgroundColor:C.sidebarBg}:{},children:"Select User"}),d.map(te=>i.jsx("option",{value:te.id,style:P?{backgroundColor:C.sidebarBg}:{},children:te.name},te.id))]})]}),U&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel1DurationDays",className:K,children:"Days until L1 Escalation"}),i.jsx(we,{id:"escalationLevel1DurationDays",type:"number",registration:O("escalationLevel1DurationDays"),error:D.escalationLevel1DurationDays?.message,className:he,style:$})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel2UserId",className:K,children:"Escalation Level 2"}),i.jsxs(Ze,{id:"escalationLevel2UserId",registration:O("escalationLevel2UserId"),error:D.escalationLevel2UserId?.message,className:he,style:$,children:[i.jsx("option",{value:"",style:P?{backgroundColor:C.sidebarBg}:{},children:"Select User"}),d.map(te=>i.jsx("option",{value:te.id,style:P?{backgroundColor:C.sidebarBg}:{},children:te.name},te.id))]})]}),B&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel2DurationDays",className:K,children:"Days until L2 Escalation"}),i.jsx(we,{id:"escalationLevel2DurationDays",type:"number",registration:O("escalationLevel2DurationDays"),error:D.escalationLevel2DurationDays?.message,className:he,style:$})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"escalationEmail",className:K,children:"Final Escalation Email"}),i.jsx(we,{id:"escalationEmail",type:"email",registration:O("escalationEmail"),error:D.escalationEmail?.message,className:he,style:$,placeholder:P?"Enter email address":""})]}),W&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"escalationEmailDurationDays",className:K,children:"Days until Final Escalation"}),i.jsx(we,{id:"escalationEmailDurationDays",type:"number",registration:O("escalationEmailDurationDays"),error:D.escalationEmailDurationDays?.message,className:he,style:$})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/tasks"),variant:"secondary",disabled:l,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:l,children:t?"Save Changes":"Create Task"})]})]})]}),p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)})]})},Mc=({title:n,sizes:e,headers:t,control:r,quantityType:s,quantities:a,readOnly:o=!1})=>{const l=Array.from(new Set(e.map(d=>d.fit))),c=Array.from(new Set(e.map(d=>d.size))).sort((d,h)=>{const p=parseInt(String(d)),x=parseInt(String(h));return!isNaN(p)&&!isNaN(x)?p-x:String(d).localeCompare(String(h))});return i.jsxs("div",{className:"border rounded-lg flex flex-col overflow-hidden bg-card",children:[i.jsx("h4",{className:"p-3 font-semibold bg-gray-50 dark:bg-white/5 border-b flex-shrink-0",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 dark:bg-white/5",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:"Size"}),t.map(d=>i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:d.label},String(d.key))),i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted w-20",children:"Qty"})]})}),i.jsx("tbody",{className:"divide-y dark:divide-white/10",children:c.map(d=>i.jsx(ot.Fragment,{children:l.map((h,p)=>{const x=e.find(v=>v.size===d&&v.fit===h);return x?i.jsxs("tr",{children:[p===0&&i.jsx("td",{rowSpan:l.filter(v=>e.some(b=>b.size===d&&b.fit===v)).length,className:"px-2 py-2 align-middle font-semibold border-r dark:border-white/10",children:d}),t.map(v=>i.jsx("td",{className:"px-2 py-2",children:x[v.key]},String(v.key))),i.jsx("td",{className:"px-2 py-2",children:o?i.jsx("span",{className:"font-semibold block text-center pr-4",children:a?.[x.id]||0}):i.jsx(_e,{name:`${s}.${x.id}`,control:r,render:({field:v})=>i.jsx(we,{"aria-label":`Quantity for ${n} size ${d} ${h}`,type:"number",...v,value:v.value||"",onChange:b=>v.onChange(parseInt(b.target.value)||null),className:"!py-1.5"})})})]},x.id):null})},d))})]})})]})},XL=()=>{const n=Nt(),{id:e}=Wf(),t=!!e,r=At("(max-width: 767px)"),[s,a]=E.useState([]),[o,l]=E.useState(null),[c,d]=E.useState(!0),[h,p]=E.useState(!1),[x,v]=E.useState(null),[b,_]=E.useState(null),{register:j,control:C,handleSubmit:P,watch:O,reset:M}=tn({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),D=O("gender");E.useEffect(()=>{(async()=>{d(!0);try{const[q,U,B]=await Promise.all([ce.getOrganizations(),ce.getMasterGentsUniforms(),ce.getMasterLadiesUniforms()]);if(a(q),l({gents:U,ladies:B}),t&&e){const Y=(await ce.getUniformRequests()).find(G=>G.id===e);if(Y){_(Y);const G={},Z={};Y.items.forEach(oe=>{oe.category==="Pants"?G[oe.sizeId]=oe.quantity:Z[oe.sizeId]=oe.quantity}),M({siteId:Y.siteId,gender:Y.gender,pantsQuantities:G,shirtsQuantities:Z})}else v({message:"Request not found.",type:"error"}),setTimeout(()=>n("/uniforms"),2e3)}}catch{v({message:"Failed to load data.",type:"error"})}finally{d(!1)}})()},[e,t,n,M]);const I=async F=>{if(!o)return;const q=s.find(U=>U.id===F.siteId);if(q){p(!0);try{const U=D==="Gents"?[...o.gents.pants,...o.gents.shirts]:[...o.ladies.pants,...o.ladies.shirts],B=[];for(const[Y,G]of Object.entries(F.pantsQuantities))if(G&&G>0){const Z=U.find(oe=>oe.id===Y);Z&&B.push({sizeId:Y,quantity:G,category:"Pants",sizeLabel:Z.size,fit:Z.fit})}for(const[Y,G]of Object.entries(F.shirtsQuantities))if(G&&G>0){const Z=U.find(oe=>oe.id===Y);Z&&B.push({sizeId:Y,quantity:G,category:"Shirts",sizeLabel:Z.size,fit:Z.fit})}const W={id:b?.id||`new_${Date.now()}`,siteId:F.siteId,siteName:q.shortName,gender:F.gender,requestedDate:b?.requestedDate||new Date().toISOString(),status:b?.status||"Pending",items:B};W.id.startsWith("new_")?(await ce.submitUniformRequest(W),v({message:"New request submitted.",type:"success"})):(await ce.updateUniformRequest(W),v({message:"Request updated.",type:"success"})),setTimeout(()=>n("/uniforms"),1500)}catch{v({message:"Failed to save request.",type:"error"})}finally{p(!1)}}};return c?i.jsx("div",{className:"flex justify-center items-center h-screen",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-emerald-600"})}):o?r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Request":"New Request"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Ff,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit Uniform Request":"New Uniform Request"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Submit a request for new uniforms."})]}),i.jsxs("form",{onSubmit:P(I),className:"space-y-6",children:[i.jsxs(Ze,{label:"Select Site",...j("siteId"),required:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),s.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]}),i.jsxs(Ze,{label:"Select Uniform Type",...j("gender"),children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]}),i.jsx("div",{className:"space-y-6",children:D==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Mc,{title:"Gents' Pants",sizes:o.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],control:C,quantityType:"pantsQuantities"}),i.jsx(Mc,{title:"Gents' Shirts",sizes:o.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],control:C,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Mc,{title:"Ladies' Pants",sizes:o.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:C,quantityType:"pantsQuantities"}),i.jsx(Mc,{title:"Ladies' Shirts",sizes:o.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:C,quantityType:"shirtsQuantities"})]})})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/uniforms"),disabled:h,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:P(I),disabled:h,className:"fo-btn-primary flex-1",children:h?"Saving...":"Save Request"})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Ff,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit Uniform Request":"New Uniform Request"}),i.jsx("p",{className:"text-muted",children:"Submit a request for new uniforms."})]})]}),i.jsxs("form",{onSubmit:P(I),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(Ze,{label:"Select Site",...j("siteId"),required:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),s.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]}),i.jsxs(Ze,{label:"Select Uniform Type",...j("gender"),children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]})]}),i.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:D==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Mc,{title:"Gents' Pants",sizes:o.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],control:C,quantityType:"pantsQuantities"}),i.jsx(Mc,{title:"Gents' Shirts",sizes:o.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],control:C,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Mc,{title:"Ladies' Pants",sizes:o.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:C,quantityType:"pantsQuantities"}),i.jsx(Mc,{title:"Ladies' Shirts",sizes:o.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:C,quantityType:"shirtsQuantities"})]})}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/uniforms"),variant:"secondary",disabled:h,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:h,children:h?"Saving...":"Save Request"})]})]})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):null},br=({label:n,isVerified:e,hasValue:t,error:r,registration:s,onManualInput:a,...o})=>{const{theme:l}=td(),c=l==="dark",h=s?{...s,onChange:async p=>{a&&a(),s?.onChange&&await s.onChange(p)}}:void 0;return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center mb-1",children:[i.jsx("label",{htmlFor:o.id,className:"block text-sm font-medium text-muted",children:n}),t&&(e?i.jsx("span",{className:`ml-2 flex items-center ${c?"text-green-400":"text-green-600"}`,title:"Verified from document",children:i.jsx(Ji,{className:"h-4 w-4"})}):i.jsx("span",{className:`ml-2 flex items-center ${c?"text-yellow-400":"text-yellow-500"}`,title:"Manually entered. Please verify.",children:i.jsx(Aa,{className:"h-4 w-4"})}))]}),i.jsx(we,{id:o.id,error:r,registration:h,label:"",...o})]})},Wue=Pt({employeeId:ye().required(),firstName:ye().required("First name is required"),middleName:ye().optional(),lastName:ye().required("Last name is required"),preferredName:ye().optional(),dob:ye().required("Date of birth is required"),gender:ye().oneOf(["Male","Female","Other",""]).required("Gender is required"),maritalStatus:ye().oneOf(["Single","Married","Divorced","Widowed",""]).required("Marital status is required"),bloodGroup:ye().oneOf(["","A+","A-","B+","B-","AB+","AB-","O+","O-"]).required("Blood group is required"),mobile:ye().required("Mobile number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number"),alternateMobile:ye().optional().nullable(),email:ye().email("Must be a valid email").required("Email is required"),idProofType:ye().oneOf(["Aadhaar","PAN","Voter ID",""]).optional(),idProofNumber:ye().optional(),photo:Vt().optional().nullable(),idProofFront:Vt().optional().nullable(),idProofBack:Vt().optional().nullable(),emergencyContactName:ye().required("Emergency contact name is required"),emergencyContactNumber:ye().required("Emergency contact number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),relationship:ye().oneOf(["Spouse","Child","Father","Mother","Sibling","Other",""]).required("Relationship is required"),salary:ls().typeError("Salary must be a number").min(0).required("Salary is required").nullable(),verifiedStatus:Pt().optional()}).defined(),$ue=()=>{const{onValidated:n}=ji(),{data:e,updatePersonal:t,addOrUpdateEmergencyContactAsFamilyMember:r,setPersonalVerifiedStatus:s}=Yn(),{register:a,handleSubmit:o,formState:{errors:l},control:c,reset:d,watch:h}=tn({resolver:On(Wue),defaultValues:e.personal}),p=h();E.useEffect(()=>{d(e.personal)},[e.personal,d]),E.useEffect(()=>{let v;const b=h(_=>{clearTimeout(v),v=window.setTimeout(()=>{t(_)},500)});return()=>{b.unsubscribe(),clearTimeout(v)}},[h,t]);const x=async v=>{t(v),r(),await n()};return i.jsxs("form",{onSubmit:o(x),id:"personal-form",children:[i.jsx("div",{className:"text-left",children:i.jsx(Mr,{title:"Personal Details",subtitle:"Please provide your personal information as per your official documents."})}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-8 md:items-start",children:[i.jsx("div",{className:"flex-shrink-0 mx-auto md:mx-0",children:i.jsx(_e,{name:"photo",control:c,render:({field:v})=>i.jsx(YN,{file:v.value,onFileChange:b=>v.onChange(b)})})}),i.jsxs("div",{className:"w-full flex-grow grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{label:"Employee ID",id:"employeeId",registration:a("employeeId"),error:l.employeeId?.message,readOnly:!0,className:"bg-gray-100"})}),i.jsx(br,{label:"First Name",id:"firstName",registration:a("firstName"),error:l.firstName?.message,isVerified:e.personal.verifiedStatus?.name===!0,hasValue:!!p.firstName,onManualInput:()=>s({name:!1})}),i.jsx(we,{label:"Middle Name (Optional)",id:"middleName",registration:a("middleName")}),i.jsx(br,{label:"Last Name",id:"lastName",registration:a("lastName"),error:l.lastName?.message,isVerified:e.personal.verifiedStatus?.name===!0,hasValue:!!p.lastName,onManualInput:()=>s({name:!1})}),i.jsx(we,{label:"Preferred Name (Optional)",id:"preferredName",registration:a("preferredName")}),i.jsx(_e,{name:"dob",control:c,render:({field:v})=>i.jsx(En,{label:"Date of Birth",id:"dob",error:l.dob?.message,value:v.value,onChange:b=>{v.onChange(b),s({dob:!1})},maxDate:new Date})}),i.jsxs(Ze,{label:"Gender",id:"gender",registration:a("gender"),error:l.gender?.message,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{children:"Male"}),i.jsx("option",{children:"Female"}),i.jsx("option",{children:"Other"})]}),i.jsxs(Ze,{label:"Marital Status",id:"maritalStatus",registration:a("maritalStatus"),error:l.maritalStatus?.message,children:[i.jsx("option",{value:"",children:"Select Status"}),i.jsx("option",{children:"Single"}),i.jsx("option",{children:"Married"}),i.jsx("option",{children:"Divorced"}),i.jsx("option",{children:"Widowed"})]}),i.jsxs(Ze,{label:"Blood Group",id:"bloodGroup",registration:a("bloodGroup"),error:l.bloodGroup?.message,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"A+"}),i.jsx("option",{children:"A-"}),i.jsx("option",{children:"B+"}),i.jsx("option",{children:"B-"}),i.jsx("option",{children:"AB+"}),i.jsx("option",{children:"AB-"}),i.jsx("option",{children:"O+"}),i.jsx("option",{children:"O-"})]}),i.jsx(we,{label:"Mobile Number",id:"mobile",type:"tel",registration:a("mobile"),error:l.mobile?.message}),i.jsx(we,{label:"Alternate Mobile (Optional)",id:"alternateMobile",type:"tel",registration:a("alternateMobile")}),i.jsx(we,{label:"Email Address",id:"email",type:"email",registration:a("email"),error:l.email?.message}),i.jsx(we,{label:"Monthly Salary (Gross)",id:"salary",type:"number",registration:a("salary"),error:l.salary?.message}),i.jsxs("div",{className:"md:col-span-3 pt-4 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Emergency Contact"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[i.jsx(we,{label:"Contact Name",id:"emergencyContactName",registration:a("emergencyContactName"),error:l.emergencyContactName?.message}),i.jsx(we,{label:"Contact Number",id:"emergencyContactNumber",type:"tel",registration:a("emergencyContactNumber"),error:l.emergencyContactNumber?.message}),i.jsxs(Ze,{label:"Relationship",id:"relationship",registration:a("relationship"),error:l.relationship?.message,children:[i.jsx("option",{value:"",children:"Select Relationship"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"}),i.jsx("option",{children:"Sibling"}),i.jsx("option",{children:"Other"})]})]})]})]})]})]})},e4=Pt({line1:ye().required("Address line 1 is required"),line2:ye().optional(),city:ye().required("City is required"),state:ye().required("State is required"),country:ye().required("Country is required"),pincode:ye().required("Pincode is required").matches(/^[1-9][0-9]{5}$/,"Must be a valid 6-digit Indian pincode"),verifiedStatus:Pt().optional()}).defined(),Hue=Pt({present:e4.required(),permanent:e4.required(),sameAsPresent:os().required()}).defined(),Yue=()=>{const{onValidated:n}=ji(),{data:e,updateAddress:t,setAddressVerifiedStatus:r}=Yn(),{address:s}=bi(),[a,o]=E.useState(!1),[l,c]=E.useState(""),{register:d,handleSubmit:h,formState:{errors:p},control:x,setValue:v,trigger:b,getValues:_,reset:j,watch:C}=tn({resolver:On(Hue),defaultValues:e.address}),P=uu({control:x,name:"sameAsPresent"}),O=uu({control:x,name:"present"}),M=uu({control:x,name:"permanent"});E.useEffect(()=>{j(e.address)},[e.address,j]),E.useEffect(()=>{let q;const U=C(B=>{clearTimeout(q),q=window.setTimeout(()=>{t(B)},500)});return()=>{U.unsubscribe(),clearTimeout(q)}},[C,t]),E.useEffect(()=>{P&&(v("permanent",O),b("permanent"))},[P,O,v,b]);const D=(q,U)=>{r(q,{[U]:!1})},I=async q=>{const U=q.target.value;if(D("present","pincode"),s.enablePincodeVerification&&/^[1-9][0-9]{5}$/.test(U)){o(!0),c("");try{const B=await ce.getPincodeDetails(U);v("present.city",B.city,{shouldValidate:!0}),v("present.state",B.state,{shouldValidate:!0}),r("present",{city:!0,state:!0,pincode:!0})}catch{c("Invalid Pincode. Please check and try again.")}finally{o(!1)}}},F=async q=>{t(q),await n()};return i.jsxs("form",{onSubmit:h(F),id:"address-form",children:[i.jsx(Mr,{title:"Address Details",subtitle:"Your communication and permanent address."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Present Address"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(br,{label:"Address Line 1",id:"present.line1",isVerified:!!e.address.present.verifiedStatus?.line1,hasValue:!!O?.line1,onManualInput:()=>D("present","line1"),error:p.present?.line1?.message,registration:d("present.line1")})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(we,{label:"Address Line 2 (Optional)",id:"present.line2",registration:d("present.line2")})}),i.jsx(br,{label:"Country",id:"present.country",isVerified:!!e.address.present.verifiedStatus?.country,hasValue:!!O?.country,onManualInput:()=>D("present","country"),error:p.present?.country?.message,registration:d("present.country")}),i.jsxs("div",{className:"relative",children:[i.jsx(br,{label:"Pincode",id:"present.pincode",type:"tel",isVerified:!!e.address.present.verifiedStatus?.pincode,hasValue:!!O?.pincode,error:p.present?.pincode?.message||l,registration:d("present.pincode"),onBlur:I}),a&&i.jsx(_t,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]}),i.jsx(br,{label:"City",id:"present.city",isVerified:!!e.address.present.verifiedStatus?.city,hasValue:!!O?.city,onManualInput:()=>D("present","city"),error:p.present?.city?.message,registration:d("present.city")}),i.jsx(br,{label:"State",id:"present.state",isVerified:!!e.address.present.verifiedStatus?.state,hasValue:!!O?.state,onManualInput:()=>D("present","state"),error:p.present?.state?.message,registration:d("present.state")})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Permanent Address"}),i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("input",{id:"sameAsPresent",type:"checkbox",...d("sameAsPresent"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),i.jsx("label",{htmlFor:"sameAsPresent",className:"ml-2 block text-sm text-muted",children:"Same as Present Address"})]}),!P&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(br,{label:"Address Line 1",id:"permanent.line1",isVerified:!!e.address.permanent.verifiedStatus?.line1,hasValue:!!M?.line1,onManualInput:()=>D("permanent","line1"),error:p.permanent?.line1?.message,registration:d("permanent.line1")})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(we,{label:"Address Line 2 (Optional)",id:"permanent.line2",registration:d("permanent.line2")})}),i.jsx(br,{label:"Country",id:"permanent.country",isVerified:!!e.address.permanent.verifiedStatus?.country,hasValue:!!M?.country,onManualInput:()=>D("permanent","country"),error:p.permanent?.country?.message,registration:d("permanent.country")}),i.jsx(br,{label:"Pincode",id:"permanent.pincode",type:"tel",isVerified:!!e.address.permanent.verifiedStatus?.pincode,hasValue:!!M?.pincode,onManualInput:()=>D("permanent","pincode"),error:p.permanent?.pincode?.message,registration:d("permanent.pincode")}),i.jsx(br,{label:"City",id:"permanent.city",isVerified:!!e.address.permanent.verifiedStatus?.city,hasValue:!!M?.city,onManualInput:()=>D("permanent","city"),error:p.permanent?.city?.message,registration:d("permanent.city")}),i.jsx(br,{label:"State",id:"permanent.state",isVerified:!!e.address.permanent.verifiedStatus?.state,hasValue:!!M?.state,onManualInput:()=>D("permanent","state"),error:p.permanent?.state?.message,registration:d("permanent.state")})]})]})]})]})},Gue=Pt({designation:ye().required("Designation is required"),department:ye().required("Department is required"),reportingManager:ye().optional(),organizationId:ye().required("Organization is required"),organizationName:ye().required(),joiningDate:ye().required("Joining date is required"),workType:ye().oneOf(["Full-time","Part-time","Contract",""]).required("Work type is required"),site:ye().optional(),defaultSalary:ls().nullable().optional()}).defined(),Zue=()=>{const{onValidated:n}=ji(),{user:e}=jt(),{data:t,updateOrganization:r}=Yn(),[s,a]=E.useState([]),o=At("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:h,watch:p,setValue:x,reset:v}=tn({resolver:On(Gue),defaultValues:t.organization}),b=p("organizationId"),_=p("designation"),j=!!t.organization.organizationId;E.useEffect(()=>{ce.getOrganizations().then(a)},[]),E.useEffect(()=>{v(t.organization)},[t.organization,v]),E.useEffect(()=>{let P;const O=p(M=>{clearTimeout(P),P=window.setTimeout(()=>{r(M)},500)});return()=>{O.unsubscribe(),clearTimeout(P)}},[p,r]),E.useEffect(()=>{const P=s.find(O=>O.id===b);P&&x("organizationName",P.shortName)},[b,s,x]),E.useEffect(()=>{_&&ce.suggestDepartmentForDesignation(_).then(P=>{P&&x("department",P,{shouldValidate:!0})})},[_,x]);const C=async P=>{r(P),await n()};return o?i.jsx("form",{onSubmit:c(C),id:"organization-form",children:i.jsxs("div",{className:"space-y-6",children:[i.jsx("p",{className:"text-sm text-gray-400",children:"Provide the employment details for the new employee within the organization."}),i.jsxs("select",{...l("organizationId"),className:"pro-select pro-select-arrow",disabled:j,children:[i.jsx("option",{value:"",children:"Select Organization"}),s.map(P=>i.jsx("option",{value:P.id,children:P.shortName},P.id))]}),d.organizationId&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.organizationId.message}),i.jsx("input",{placeholder:"Designation",...l("designation"),className:"form-input"}),i.jsx("input",{placeholder:"Department",...l("department"),className:"form-input"}),i.jsx("input",{placeholder:"Reporting Manager",...l("reportingManager"),className:"form-input"}),i.jsx(_e,{name:"joiningDate",control:h,render:({field:P})=>i.jsx("input",{type:"date",...P,className:"form-input"})}),d.joiningDate&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.joiningDate.message}),i.jsxs("select",{...l("workType"),className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"Select Work Type"}),i.jsx("option",{children:"Full-time"}),i.jsx("option",{children:"Part-time"}),i.jsx("option",{children:"Contract"})]}),d.workType&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.workType.message})]})}):i.jsxs("form",{onSubmit:c(C),id:"organization-form",children:[i.jsx(Mr,{title:"Organization Details",subtitle:"Your employment details within the organization."}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsxs(Ze,{label:"Organization / Client",id:"organizationId",error:d.organizationId?.message,registration:l("organizationId"),disabled:j,children:[i.jsx("option",{value:"",children:"Select Organization"}),s.map(P=>i.jsx("option",{value:P.id,children:P.shortName},P.id))]}),i.jsx(we,{label:"Designation",id:"designation",error:d.designation?.message,registration:l("designation")}),i.jsx(we,{label:"Department",id:"department",error:d.department?.message,registration:l("department")}),i.jsx(we,{label:"Reporting Manager",id:"reportingManager",error:d.reportingManager?.message,registration:l("reportingManager")}),i.jsx(_e,{name:"joiningDate",control:h,render:({field:P})=>i.jsx(En,{label:"Joining Date",id:"joiningDate",error:d.joiningDate?.message,value:P.value,onChange:P.onChange})}),i.jsxs(Ze,{label:"Work Type",id:"workType",error:d.workType?.message,registration:l("workType"),children:[i.jsx("option",{value:"",children:"Select Work Type"}),i.jsx("option",{children:"Full-time"}),i.jsx("option",{children:"Part-time"}),i.jsx("option",{children:"Contract"})]})]})]})},Kue=()=>{const{onValidated:n,setToast:e}=ji(),{data:t,updateFamily:r}=Yn(),{rulesByDesignation:s}=nd(),a=At("(max-width: 767px)"),o=t.organization.designation,l=E.useMemo(()=>{const Y=o&&s[o];return Y?Y.documents.familyAadhaar:!1},[o,s]),c=Pt({id:ye().required(),relation:ye().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),name:ye().required("Name is required"),dob:ye().required("Date of birth is required"),gender:ye().oneOf(["Male","Female","Other",""]).required("Gender is required"),occupation:ye().optional(),dependent:os().required(),phone:ye().when("relation",{is:"Child",then:Y=>Y.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:Y=>Y.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:Vt().nullable().when([],{is:()=>l,then:Y=>Y.test("is-required","Aadhaar proof is required for this designation.",G=>G!=null).nullable(),otherwise:Y=>Y.optional().nullable()})}),d=Pt({family:_s().of(c).required()}),{control:h,handleSubmit:p,formState:{errors:x},watch:v,setValue:b}=tn({resolver:On(d),defaultValues:{family:t.family}}),{fields:_,append:j,remove:C}=js({control:h,name:"family"}),[P,O]=E.useState(!1),[M,D]=E.useState(null);E.useEffect(()=>{let Y;const G=v(Z=>{clearTimeout(Y),Y=window.setTimeout(()=>{r(Z.family)},500)});return()=>{G.unsubscribe(),clearTimeout(Y)}},[v,r]);const I=Y=>G=>{let Z=!1;if(G.name){const oe=G.name.toLowerCase().replace(/\b(\w)/g,X=>X.toUpperCase());b(`family.${Y}.name`,oe,{shouldValidate:!0}),Z=!0}if(G.dob)try{const oe=G.dob.replace(/[/.]/g,"-"),X=["dd-MM-yyyy","yyyy-MM-dd","MM-dd-yyyy","d-M-yyyy"];let he=null;for(const $ of X){const K=W$(oe,$,new Date);if(!isNaN(K.getTime())){he=K;break}}if(he){const $=We(he,"yyyy-MM-dd");b(`family.${Y}.dob`,$,{shouldValidate:!0}),Z=!0}}catch{console.error("Could not parse date from OCR:",G.dob)}if(G.gender){const oe=G.gender.toLowerCase().trim();oe.includes("male")||oe.includes("purush")||oe==="m"?(b(`family.${Y}.gender`,"Male",{shouldValidate:!0}),Z=!0):(oe.includes("female")||oe.includes("mahila")||oe==="f")&&(b(`family.${Y}.gender`,"Female",{shouldValidate:!0}),Z=!0)}Z&&e({message:"Family member details auto-filled.",type:"success"})},F={type:et.OBJECT,properties:{name:{type:et.STRING},dob:{type:et.STRING},gender:{type:et.STRING}}},q=()=>{j({id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""})},U=Y=>{D(Y),O(!0)},B=()=>{M!==null&&(C(M),O(!1),D(null))},W=async Y=>{r(Y.family),await n()};return a?i.jsxs("form",{onSubmit:p(W),id:"family-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List your immediate family members."}),i.jsx("div",{className:"space-y-4",children:_.map((Y,G)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[i.jsx("button",{type:"button",onClick:()=>U(G),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove family member",children:i.jsx(sn,{className:"h-5 w-5"})}),i.jsx(_e,{name:`family.${G}.relation`,control:h,render:({field:Z})=>i.jsxs("select",{...Z,className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"Select Relation"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})]})}),i.jsx(_e,{name:`family.${G}.name`,control:h,render:({field:Z})=>i.jsx("input",{placeholder:"Full Name",...Z,className:"form-input"})}),i.jsx(_e,{name:`family.${G}.dob`,control:h,render:({field:Z})=>i.jsx("input",{type:"date",placeholder:"Date of Birth",...Z,className:"form-input"})}),i.jsx(_e,{name:`family.${G}.phone`,control:h,render:({field:Z})=>i.jsx("input",{placeholder:"Phone Number",type:"tel",...Z,className:"form-input"})})]},Y.id))}),i.jsxs(ne,{type:"button",onClick:q,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]}):i.jsxs("form",{onSubmit:p(W),id:"family-form",children:[i.jsx(Kr,{isOpen:P,onClose:()=>O(!1),onConfirm:B,title:"Confirm Deletion",children:"Are you sure you want to remove this family member? This action cannot be undone."}),i.jsx(Mr,{title:"Family Details",subtitle:"List your immediate family members."}),i.jsx("div",{className:"space-y-6",children:_.map((Y,G)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[i.jsx("button",{type:"button",onClick:()=>U(G),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${Y.name}`,children:i.jsx(sn,{className:"h-4 w-4"})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`family.${G}.relation`,control:h,render:({field:Z})=>i.jsxs(Ze,{label:"Relation",id:Z.name,error:x.family?.[G]?.relation?.message,...Z,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})]})}),i.jsx(_e,{name:`family.${G}.name`,control:h,render:({field:Z})=>i.jsx(we,{label:"Full Name",id:Z.name,error:x.family?.[G]?.name?.message,...Z})}),i.jsx(_e,{name:`family.${G}.dob`,control:h,render:({field:Z})=>i.jsx(En,{label:"Date of Birth",id:Z.name,value:Z.value,onChange:Z.onChange,error:x.family?.[G]?.dob?.message,maxDate:new Date})}),i.jsx(_e,{name:`family.${G}.gender`,control:h,render:({field:Z})=>i.jsxs(Ze,{label:"Gender",id:Z.name,error:x.family?.[G]?.gender?.message,...Z,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Male"}),i.jsx("option",{children:"Female"}),i.jsx("option",{children:"Other"})]})}),i.jsx(_e,{name:`family.${G}.phone`,control:h,render:({field:Z})=>i.jsx(we,{label:"Phone Number",id:Z.name,type:"tel",error:x.family?.[G]?.phone?.message,...Z,value:Z.value??""})}),i.jsx(_e,{name:`family.${G}.occupation`,control:h,render:({field:Z})=>i.jsx(we,{label:"Occupation (Optional)",id:Z.name,...Z,value:Z.value??""})}),i.jsx("div",{className:"col-span-full md:col-span-1 flex items-center pt-5",children:i.jsx(_e,{name:`family.${G}.dependent`,control:h,render:({field:Z})=>i.jsx(kn,{id:Z.name,label:"Is a dependent?",checked:Z.value,onChange:Z.onChange})})}),i.jsx("div",{className:"col-span-full",children:i.jsx(_e,{name:`family.${G}.idProof`,control:h,render:({field:Z,fieldState:oe})=>i.jsx(vt,{label:`Aadhaar Proof ${l?"(Mandatory)":"(Optional)"}`,file:Z.value,onFileChange:Z.onChange,onOcrComplete:I(G),ocrSchema:F,setToast:e,error:oe.error?.message,docType:"Aadhaar"})})})]})]},Y.id))}),i.jsxs(ne,{type:"button",onClick:q,variant:"outline",className:"mt-6",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})},Jue=()=>{const{onValidated:n,setToast:e}=ji(),{user:t}=jt(),{data:r,updateEducation:s,updateEducationRecord:a}=Yn(),o=At("(max-width: 767px)"),l=E.useMemo(()=>/manager|admin|head/i.test(r.organization.designation),[r.organization.designation]),c=E.useMemo(()=>Pt({id:ye().required(),degree:ye().required("Degree is required"),institution:ye().required("Institution is required"),startYear:ye().required("Start year is required").matches(/^\d{4}$/,"Must be a 4-digit year"),endYear:ye().required("End year is required").matches(/^\d{4}$/,"Must be a 4-digit year").test("is-after-start-year","End year must be on or after start year",function(G){const{startYear:Z}=this.parent;return!Z||!G||parseInt(G)>=parseInt(Z)}),percentage:ls().nullable().min(0).max(100).optional(),grade:ye().optional(),document:Vt().nullable().when([],{is:()=>l,then:G=>G.required("Certificate is mandatory for this role.").nullable(),otherwise:G=>G.optional().nullable()})}).defined(),[l]),d=Pt({education:_s().of(c).required()}),{control:h,handleSubmit:p,formState:{errors:x},setValue:v,reset:b,watch:_}=tn({resolver:On(d),context:{isAdminOrManager:l},mode:"onBlur"}),{fields:j,append:C,remove:P}=js({control:h,name:"education"}),[O,M]=E.useState(!1),[D,I]=E.useState(null);E.useEffect(()=>{b({education:r.education})},[r.education,b]),E.useEffect(()=>{let G;const Z=_(oe=>{clearTimeout(G),G=window.setTimeout(()=>{s(oe.education)},500)});return()=>{Z.unsubscribe(),clearTimeout(G)}},[_,s]);const F=()=>{C({id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""})},q=G=>{I(G),M(!0)},U=()=>{D!==null&&(P(D),M(!1),I(null))},B=async G=>{s(G.education),await n()},W=G=>Z=>{const oe=j[G].id,X={};if(Z.degree&&(v(`education.${G}.degree`,Z.degree,{shouldValidate:!0}),X.degree=Z.degree),Z.institution&&(v(`education.${G}.institution`,Z.institution,{shouldValidate:!0}),X.institution=Z.institution),Z.endYear){const he=Z.endYear.toString();v(`education.${G}.endYear`,he,{shouldValidate:!0}),X.endYear=he}Object.keys(X).length>0&&(a(oe,X),e({message:"Education details auto-filled.",type:"success"}))},Y={type:et.OBJECT,properties:{degree:{type:et.STRING,description:"The name of the degree, diploma, or certificate."},institution:{type:et.STRING,description:"The name of the university, college, or institution."},endYear:{type:et.STRING,description:"The year of completion or graduation as a 4-digit number."}},required:["degree","institution","endYear"]};return o?i.jsxs("form",{onSubmit:p(B),id:"education-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List educational qualifications, starting with the most recent."}),i.jsx("div",{className:"space-y-4",children:j.map((G,Z)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[i.jsx("button",{type:"button",onClick:()=>q(Z),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove qualification",children:i.jsx(sn,{className:"h-5 w-5"})}),i.jsx(_e,{name:`education.${Z}.degree`,control:h,render:({field:oe})=>i.jsx("input",{placeholder:"Degree / Certificate",...oe,className:"form-input"})}),i.jsx(_e,{name:`education.${Z}.institution`,control:h,render:({field:oe})=>i.jsx("input",{placeholder:"Institution / University",...oe,className:"form-input"})}),i.jsx(_e,{name:`education.${Z}.endYear`,control:h,render:({field:oe})=>i.jsx("input",{placeholder:"Year of Completion",type:"text",maxLength:4,...oe,className:"form-input"})}),i.jsx(_e,{name:`education.${Z}.document`,control:h,render:({field:oe,fieldState:X})=>i.jsx(vt,{label:`Certificate ${l?"(Mandatory)":"(Optional)"}`,file:oe.value,onFileChange:oe.onChange,error:X.error?.message,allowCapture:!0})})]},G.id))}),i.jsxs(ne,{type:"button",onClick:F,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]}):i.jsxs("form",{onSubmit:p(B),id:"education-form",children:[i.jsx(Kr,{isOpen:O,onClose:()=>M(!1),onConfirm:U,title:"Confirm Deletion",children:"Are you sure you want to remove this education record? This action cannot be undone."}),i.jsx(Mr,{title:"Education Details",subtitle:"List your educational qualifications, starting with the most recent."}),i.jsx("div",{className:"space-y-6",children:j.map((G,Z)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[i.jsx("button",{type:"button",onClick:()=>q(Z),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${G.degree}`,children:i.jsx(sn,{className:"h-4 w-4"})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(_e,{name:`education.${Z}.degree`,control:h,render:({field:oe})=>i.jsx(we,{label:"Degree / Certificate",id:oe.name,error:x.education?.[Z]?.degree?.message,...oe})}),i.jsx(_e,{name:`education.${Z}.institution`,control:h,render:({field:oe})=>i.jsx(we,{label:"Institution / University",id:oe.name,error:x.education?.[Z]?.institution?.message,...oe})}),i.jsx(_e,{name:`education.${Z}.startYear`,control:h,render:({field:oe})=>i.jsx(we,{label:"Start Year",id:oe.name,type:"text",maxLength:4,error:x.education?.[Z]?.startYear?.message,...oe})}),i.jsx(_e,{name:`education.${Z}.endYear`,control:h,render:({field:oe})=>i.jsx(we,{label:"End Year",id:oe.name,type:"text",maxLength:4,error:x.education?.[Z]?.endYear?.message,...oe})}),i.jsx(_e,{name:`education.${Z}.percentage`,control:h,render:({field:oe})=>i.jsx(we,{label:"Percentage (Optional)",id:oe.name,type:"number",error:x.education?.[Z]?.percentage?.message,...oe,value:oe.value??""})}),i.jsx(_e,{name:`education.${Z}.grade`,control:h,render:({field:oe})=>i.jsx(we,{label:"Grade (Optional)",id:oe.name,type:"text",error:x.education?.[Z]?.grade?.message,...oe,value:oe.value??""})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(_e,{name:`education.${Z}.document`,control:h,render:({field:oe,fieldState:X})=>i.jsx(vt,{label:`Upload Certificate ${l?"(Mandatory)":"(Optional)"}`,file:oe.value,onFileChange:oe.onChange,onOcrComplete:W(Z),ocrSchema:Y,setToast:e,error:X.error?.message})})})]})]},G.id))}),i.jsxs(ne,{type:"button",onClick:F,variant:"outline",className:"mt-6",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})},rC=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",Que=ye().matches(/^[a-zA-Z\s.'-]*$/,"Name can only contain letters and spaces").transform(rC),Xue=Pt({accountHolderName:Que.required("Account holder name is required"),accountNumber:ye().required("Account number is required").matches(/^[0-9]+$/,"Must be only digits"),confirmAccountNumber:ye().oneOf([UC("accountNumber")],"Account numbers must match").required("Please confirm your account number"),ifscCode:ye().required("IFSC code is required").transform(n=>n.toUpperCase()).matches(/^[A-Z]{4}0[A-Z0-9]{6}$/,"Invalid IFSC code format (e.g., SBIN0123456)"),bankName:ye().required("Bank name is required"),branchName:ye().required("Branch name is required"),bankProof:Vt().optional().nullable(),verifiedStatus:Pt().optional()}).defined(),efe=()=>{const{onValidated:n,setToast:e}=ji(),{user:t}=jt(),{data:r,updateBank:s,setBankVerifiedStatus:a}=Yn(),o=At("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:h,setValue:p,watch:x,reset:v}=tn({resolver:On(Xue),defaultValues:r.bank});E.useEffect(()=>{v(r.bank)},[r.bank,v]),E.useEffect(()=>{let M;const D=x(I=>{clearTimeout(M),M=window.setTimeout(()=>{s(I)},500)});return()=>{D.unsubscribe(),clearTimeout(M)}},[x,s]);const b=x(),_=async M=>{s(M),await n()},j=M=>{const D=M.target.value;p("accountHolderName",rC(D),{shouldValidate:!0})},C=M=>{const D={};M.forEach(I=>{D[I]=!1}),a(D)},P=M=>{const D={},I={};if(M.accountHolderName){const F=rC(M.accountHolderName);p("accountHolderName",F,{shouldValidate:!0}),D.accountHolderName=F,I.accountHolderName=!0}if(M.accountNumber){const F=M.accountNumber.replace(/\D/g,"");p("accountNumber",F,{shouldValidate:!0}),p("confirmAccountNumber",F,{shouldValidate:!0}),D.accountNumber=F,D.confirmAccountNumber=F,I.accountNumber=!0}if(M.ifscCode){const F=M.ifscCode.toUpperCase().replace(/\s/g,"");p("ifscCode",F,{shouldValidate:!0}),D.ifscCode=F,I.ifscCode=!0}M.bankName&&(p("bankName",M.bankName,{shouldValidate:!0}),D.bankName=M.bankName),M.branchName&&(p("branchName",M.branchName,{shouldValidate:!0}),D.branchName=M.branchName),Object.keys(D).length>0&&s(D),a(I),e({message:"Bank details extracted. Please review.",type:"success"})},O={type:et.OBJECT,properties:{accountHolderName:{type:et.STRING,description:"The account holder's full name."},accountNumber:{type:et.STRING,description:"The full bank account number."},ifscCode:{type:et.STRING,description:"The bank's IFSC code."},bankName:{type:et.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:et.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}},required:["accountHolderName","accountNumber","ifscCode","bankName","branchName"]};return o?i.jsxs("form",{onSubmit:c(_),id:"bank-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Your salary will be credited to this account."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("input",{placeholder:"Account Holder Name",...l("accountHolderName"),onBlur:j,className:"form-input"}),i.jsx("input",{placeholder:"Bank Name",...l("bankName"),className:"form-input"}),i.jsx("input",{placeholder:"Account Number",...l("accountNumber"),className:"form-input"}),i.jsx("input",{placeholder:"Confirm Account Number",...l("confirmAccountNumber"),className:"form-input"}),i.jsx("input",{placeholder:"IFSC Code",...l("ifscCode"),className:"form-input"}),i.jsx("input",{placeholder:"Branch Name",...l("branchName"),className:"form-input"}),i.jsx(_e,{name:"bankProof",control:h,render:({field:M})=>i.jsx(vt,{label:"Upload Bank Proof (Optional)",file:M.value,onFileChange:M.onChange,allowCapture:!0})})]})]}):i.jsxs("form",{onSubmit:c(_),id:"bank-form",children:[i.jsx(Mr,{title:"Bank Details",subtitle:"Your salary will be credited to this account."}),i.jsxs("div",{className:"space-y-6",children:[i.jsx(_e,{name:"bankProof",control:h,render:({field:M})=>i.jsx(vt,{label:"Upload Bank Proof (Cancelled Cheque/Passbook)",file:M.value,onFileChange:M.onChange,onOcrComplete:P,ocrSchema:O,setToast:e})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 pt-6 border-t",children:[i.jsx(br,{label:"Account Holder Name",id:"accountHolderName",hasValue:!!b.accountHolderName,isVerified:r.bank.verifiedStatus?.accountHolderName===!0,onManualInput:()=>C(["accountHolderName"]),error:d.accountHolderName?.message,registration:l("accountHolderName"),onBlur:j}),i.jsx(br,{label:"Bank Name",id:"bankName",hasValue:!!b.bankName,isVerified:!1,error:d.bankName?.message,registration:l("bankName")}),i.jsx(br,{label:"Account Number",id:"accountNumber",hasValue:!!b.accountNumber,isVerified:r.bank.verifiedStatus?.accountNumber===!0,onManualInput:()=>C(["accountNumber"]),error:d.accountNumber?.message,registration:l("accountNumber")}),i.jsx(br,{label:"Confirm Account Number",id:"confirmAccountNumber",hasValue:!!b.confirmAccountNumber,isVerified:r.bank.verifiedStatus?.accountNumber===!0,onManualInput:()=>C(["accountNumber"]),error:d.confirmAccountNumber?.message,registration:l("confirmAccountNumber")}),i.jsx(br,{label:"IFSC Code",id:"ifscCode",hasValue:!!b.ifscCode,isVerified:r.bank.verifiedStatus?.ifscCode===!0,onManualInput:()=>C(["ifscCode"]),error:d.ifscCode?.message,registration:l("ifscCode")}),i.jsx(br,{label:"Branch Name",id:"branchName",hasValue:!!b.branchName,isVerified:!1,error:d.branchName?.message,registration:l("branchName")})]})]})]})},tfe=Pt({hasPreviousPf:os().required(),uanNumber:ye().when("hasPreviousPf",{is:!0,then:n=>n.required("UAN Number is required").matches(/^[0-9]{12}$/,"UAN must be 12 digits"),otherwise:n=>n.optional().nullable()}),pfNumber:ye().when("hasPreviousPf",{is:!0,then:n=>n.optional().nullable(),otherwise:n=>n.optional().nullable()}),document:Vt().optional().nullable(),salarySlip:Vt().optional().nullable(),verifiedStatus:Pt().optional()}).defined(),nfe=()=>{const{onValidated:n,setToast:e}=ji(),{user:t}=jt(),{data:r,updateUan:s,setUanVerifiedStatus:a}=Yn(),o=At("(max-width: 767px)"),{register:l,control:c,handleSubmit:d,formState:{errors:h},setValue:p,watch:x,reset:v}=tn({resolver:On(tfe),defaultValues:r.uan});E.useEffect(()=>{v(r.uan)},[r.uan,v]),E.useEffect(()=>{let M;const D=x(I=>{clearTimeout(M),M=window.setTimeout(()=>{s(I)},500)});return()=>{D.unsubscribe(),clearTimeout(M)}},[x,s]);const b=x("hasPreviousPf"),_=x(),j=async M=>{s(M),await n()},C=()=>{a({uanNumber:!1})},P=M=>{if(M.uanNumber){const D=M.uanNumber.replace(/\D/g,"");if(D.length===12){const I={uanNumber:D,hasPreviousPf:!0};p("uanNumber",D,{shouldValidate:!0}),p("hasPreviousPf",!0,{shouldValidate:!0}),s(I),a({uanNumber:!0}),e({message:"UAN extracted successfully.",type:"success"})}}},O={type:et.OBJECT,properties:{uanNumber:{type:et.STRING,description:"The 12-digit Universal Account Number (UAN)."}},required:["uanNumber"]};return o?i.jsxs("form",{onSubmit:d(j),id:"uan-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Universal Account Number if you have one."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",...l("hasPreviousPf"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"Do you have a previous PF account or UAN?"})]}),b&&i.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[i.jsx("input",{placeholder:"UAN Number",...l("uanNumber"),className:"form-input"}),i.jsx("input",{placeholder:"PF Number (Optional)",...l("pfNumber"),className:"form-input"}),i.jsx(_e,{name:"document",control:c,render:({field:M})=>i.jsx(vt,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,allowCapture:!0,costingItemName:"EPF UAN Lookup"})})]})]})]}):i.jsxs("form",{onSubmit:d(j),id:"uan-form",children:[i.jsx(Mr,{title:"UAN / PF Details",subtitle:"Provide your Universal Account Number if you have one."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"hasPreviousPf",type:"checkbox",...l("hasPreviousPf"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),i.jsx("label",{htmlFor:"hasPreviousPf",className:"ml-2 block text-sm text-muted",children:"Do you have a previous PF account or UAN?"})]}),r.uan.salarySlip&&i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-2",children:"Reference Salary Slip"}),i.jsx(vt,{label:"",file:r.uan.salarySlip,onFileChange:()=>{}})]}),b&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx(br,{label:"UAN Number",id:"uanNumber",hasValue:!!_.uanNumber,isVerified:r.uan.verifiedStatus?.uanNumber===!0,onManualInput:C,registration:l("uanNumber"),error:h.uanNumber?.message}),i.jsx(we,{label:"PF Number (Optional)",id:"pfNumber",registration:l("pfNumber"),error:h.pfNumber?.message})]}),i.jsx(_e,{name:"document",control:c,render:({field:M})=>i.jsx(vt,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,onOcrComplete:P,ocrSchema:O,setToast:e,costingItemName:"EPF UAN Lookup"})})]})]})]})},rfe=Pt({hasEsi:os().required(),esiNumber:ye().when("hasEsi",{is:!0,then:n=>n.required("ESI Number is required").matches(/^(\d{10}|\d{17})$/,"ESI number must be 10 or 17 digits"),otherwise:n=>n.optional().nullable()}),esiRegistrationDate:ye().when("hasEsi",{is:!0,then:n=>n.required("Registration date is required").test("not-in-future","Registration date cannot be in the future",e=>e?new Date(e.replace(/-/g,"/"))<=new Date:!0),otherwise:n=>n.optional().nullable()}),esicBranch:ye().when("hasEsi",{is:!0,then:n=>n.required("ESIC Branch is required"),otherwise:n=>n.optional().nullable()}),document:Vt().optional().nullable(),verifiedStatus:Pt().optional()}),sfe=()=>{const{onValidated:n,setToast:e}=ji(),{user:t}=jt(),{data:r,updateEsi:s,setEsiVerifiedStatus:a}=Yn(),{esiCtcThreshold:o,enableEsiRule:l}=nd(),c=At("(max-width: 767px)"),{register:d,control:h,handleSubmit:p,formState:{errors:x},reset:v,setValue:b,watch:_}=tn({resolver:On(rfe),defaultValues:r.esi}),j=_("hasEsi"),C=_(),P=r.personal.salary!=null&&r.personal.salary<=o;E.useEffect(()=>{v(r.esi)},[r.esi,v]),E.useEffect(()=>{let F;const q=_(U=>{clearTimeout(F),F=window.setTimeout(()=>{s(U)},500)});return()=>{q.unsubscribe(),clearTimeout(F)}},[_,s]),E.useEffect(()=>{P||r.esi.hasEsi&&s({hasEsi:!1,esiNumber:"",esiRegistrationDate:"",esicBranch:""})},[P,r.esi.hasEsi,s]);const O=async F=>{s(F),await n()},M=()=>{a({esiNumber:!1})},D=F=>{if(F.esiNumber){const q=F.esiNumber.replace(/\D/g,"");if(q.length===10||q.length===17){const U={esiNumber:q,hasEsi:!0};b("esiNumber",q,{shouldValidate:!0}),b("hasEsi",!0,{shouldValidate:!0}),s(U),a({esiNumber:!0}),e({message:"ESI Number extracted successfully.",type:"success"})}}},I={type:et.OBJECT,properties:{esiNumber:{type:et.STRING,description:"The 10 or 17-digit ESI number."}},required:["esiNumber"]};if(c){if(!l||!P){const F=l?`Employee is not eligible for ESI as their gross salary is above the ${o.toLocaleString()} threshold.`:"ESI enrollment is currently disabled by company policy. This step is not applicable.";return i.jsx("form",{onSubmit:async q=>{q.preventDefault(),await n()},id:"esi-form",children:i.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-900/40 rounded-lg border border-blue-500/50",children:[i.jsx(du,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),i.jsx("p",{className:"text-sm text-blue-300",children:F})]})})}return i.jsxs("form",{onSubmit:p(O),id:"esi-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Employee's State Insurance number if applicable."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",...d("hasEsi"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"Are you covered under ESI?"})]}),j&&i.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[i.jsx("input",{placeholder:"ESI Number",...d("esiNumber"),className:"form-input"}),i.jsx("input",{type:"date",...d("esiRegistrationDate"),className:"form-input"}),i.jsx("input",{placeholder:"ESIC Branch",...d("esicBranch"),className:"form-input"}),i.jsx(_e,{name:"document",control:h,render:({field:F})=>i.jsx(vt,{label:"Upload ESI Card",file:F.value,onFileChange:F.onChange,allowCapture:!0,costingItemName:"ESI Card OCR"})})]})]})]})}return l?P?i.jsxs("form",{onSubmit:p(O),id:"esi-form",children:[i.jsx(Mr,{title:"ESI Details",subtitle:"Provide your Employee's State Insurance number if applicable."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"hasEsi",type:"checkbox",...d("hasEsi"),className:"h-4 w-4 text-accent"}),i.jsx("label",{htmlFor:"hasEsi",className:"ml-2 block text-sm text-muted",children:"Are you covered under ESI?"})]}),j&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx(br,{label:"ESI Number",id:"esiNumber",hasValue:!!C.esiNumber,isVerified:r.esi.verifiedStatus?.esiNumber===!0,onManualInput:M,registration:d("esiNumber"),error:x.esiNumber?.message}),i.jsx(_e,{name:"esiRegistrationDate",control:h,render:({field:F})=>i.jsx(En,{label:"ESI Registration Date",id:"esiRegistrationDate",error:x.esiRegistrationDate?.message,value:F.value,onChange:F.onChange,maxDate:new Date})}),i.jsx(we,{label:"ESIC Branch",id:"esicBranch",registration:d("esicBranch"),error:x.esicBranch?.message})]}),i.jsx(_e,{name:"document",control:h,render:({field:F})=>i.jsx(vt,{label:"Upload ESI Card",file:F.value,onFileChange:F.onChange,onOcrComplete:D,ocrSchema:I,setToast:e,costingItemName:"ESI Card OCR"})})]})]})]}):i.jsxs("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"esi-form",children:[i.jsx(Mr,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),i.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[i.jsx(du,{className:"h-5 w-5 text-blue-500 mr-3"}),i.jsxs("p",{className:"text-sm text-blue-700",children:["Employee is not eligible for ESI as their gross salary is above the $",o.toLocaleString()," threshold."]})]})]}):i.jsxs("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"esi-form",children:[i.jsx(Mr,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),i.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[i.jsx(du,{className:"h-5 w-5 text-blue-500 mr-3"}),i.jsx("p",{className:"text-sm text-blue-700",children:"ESI enrollment is currently disabled by company policy. This step is not applicable."})]})]})},ife=Pt({isOptedIn:os().nullable().required("Please choose whether you want to avail Group Medical Cover."),selectedSpouseId:ye().optional(),selectedChildIds:_s().of(ye().required()).optional(),gmcPolicyCopy:Vt().when("isOptedIn",{is:!1,then:n=>n.required("Please upload GMC policy copy (PNG, JPG, PDF up to 5MB)."),otherwise:n=>n.optional().nullable()}),declarationAccepted:os().when("isOptedIn",{is:!1,then:n=>n.oneOf([!0],"Please accept the declaration to proceed."),otherwise:n=>n.optional()}),policyAmount:ye().optional().nullable(),nomineeName:ye().optional().nullable(),nomineeRelation:ye().optional().nullable(),wantsToAddDependents:os().optional().nullable(),optOutReason:ye().optional().nullable(),alternateInsuranceProvider:ye().optional().nullable(),alternateInsuranceStartDate:ye().optional().nullable(),alternateInsuranceEndDate:ye().optional().nullable(),alternateInsuranceCoverage:ye().optional().nullable()}).defined(),afe=()=>{const{onValidated:n}=ji(),{user:e}=jt(),{data:t,updateGmc:r}=Yn(),s=At("(max-width: 767px)"),{control:a,handleSubmit:o,formState:{errors:l},watch:c,reset:d,setValue:h,getValues:p}=tn({resolver:On(ife),defaultValues:t.gmc}),x=c("isOptedIn"),v=c("selectedSpouseId"),b=c("selectedChildIds")||[],_=E.useMemo(()=>t.family.find(M=>M.relation==="Spouse"),[t.family]),j=E.useMemo(()=>t.family.filter(M=>M.relation==="Child"),[t.family]),C=E.useMemo(()=>{const M=[];return _&&M.push(_),M.push(...j),M},[_,j]);E.useEffect(()=>{if(t.gmc.isOptedIn===!0){const M=!t.gmc.selectedSpouseId&&(!t.gmc.selectedChildIds||t.gmc.selectedChildIds.length===0),D=_||j.length>0;M&&D&&(h("selectedSpouseId",_?.id||"",{shouldDirty:!0}),h("selectedChildIds",j.map(I=>I.id),{shouldDirty:!0}))}},[t.gmc.isOptedIn,_,j,h,t.gmc.selectedSpouseId,t.gmc.selectedChildIds]),E.useEffect(()=>{d(t.gmc)},[t.gmc,d]),E.useEffect(()=>{let M;const D=c(I=>{clearTimeout(M),M=window.setTimeout(()=>{r(I)},500)});return()=>{D.unsubscribe(),clearTimeout(M)}},[c,r]);const P=async M=>{const D={...M};M.isOptedIn?(D.gmcPolicyCopy=null,D.declarationAccepted=!1):(D.selectedSpouseId="",D.selectedChildIds=[]),r(D),await n()},O=(M,D)=>{if(M.relation==="Spouse")h("selectedSpouseId",D?M.id:"",{shouldDirty:!0});else{const I=p("selectedChildIds")||[],F=D?[...I,M.id]:I.filter(q=>q!==M.id);h("selectedChildIds",F,{shouldDirty:!0})}};return s?i.jsxs("form",{onSubmit:o(P),id:"gmc-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please choose whether to enroll in the company's insurance plan."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-md font-semibold",children:"Would you like to Avail Group Medical Cover?"}),i.jsx(_e,{name:"isOptedIn",control:a,render:({field:M})=>i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!0?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!0),checked:M.value===!0,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!1?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!1),checked:M.value===!1,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),x===!0&&i.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[i.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Select Dependents"}),C.map(M=>{const D=M.relation==="Spouse"?v===M.id:b.includes(M.id);return i.jsx(kn,{id:`dep-mob-${M.id}`,label:`${M.name} (${M.relation})`,checked:D,onChange:I=>O(M,I)},M.id)})]}),x===!1&&i.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[i.jsx(_e,{name:"gmcPolicyCopy",control:a,render:({field:M,fieldState:D})=>i.jsx(vt,{label:"Upload GMC Policy Copy",file:M.value,onFileChange:M.onChange,error:D.error?.message,allowCapture:!0})}),i.jsx(_e,{name:"declarationAccepted",control:a,render:({field:M,fieldState:D})=>i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",checked:M.value??!1,onChange:M.onChange,className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"I declare I will not avail company GMC and the uploaded policy is valid."})]})})]})]})]}):i.jsxs("form",{onSubmit:o(P),id:"gmc-form",children:[i.jsx(Mr,{title:"Group Medical Cover (GMC)",subtitle:"Please choose whether to enroll in the company's insurance plan."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Would you like to Avail Group Medical Cover?"}),i.jsx(_e,{name:"isOptedIn",control:a,render:({field:M})=>i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!0?"border-accent bg-accent-light":"border-border"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!0),checked:M.value===!0,className:"h-4 w-4 text-accent focus:ring-accent"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!1?"border-accent bg-accent-light":"border-border"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!1),checked:M.value===!1,className:"h-4 w-4 text-accent focus:ring-accent"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),l.isOptedIn&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:l.isOptedIn.message})]}),x===!0&&i.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[i.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Select Dependents for Policy"}),i.jsx("p",{className:"text-sm text-muted -mt-2 mb-2",children:"Spouse and children are included by default. Uncheck any dependents you do not want to include."}),i.jsx("div",{className:"space-y-2 p-4 border rounded-lg bg-page",children:C.length>0?C.map(M=>{const D=M.relation==="Spouse"?v===M.id:b.includes(M.id);return i.jsx(kn,{id:`dep-${M.id}`,label:`${M.name} (${M.relation})`,checked:D,onChange:I=>O(M,I)},M.id)}):i.jsx("p",{className:"text-sm text-muted",children:'No spouse or children added. Please add them in the "Family Details" section to include them in the policy.'})})]}),x===!1&&i.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[i.jsx(_e,{name:"gmcPolicyCopy",control:a,render:({field:M,fieldState:D})=>i.jsx(vt,{label:"Upload GMC Policy Copy",file:M.value,onFileChange:M.onChange,allowedTypes:["image/png","image/jpeg","application/pdf"],error:D.error?.message})}),i.jsx(_e,{name:"declarationAccepted",control:a,render:({field:M,fieldState:D})=>i.jsxs("div",{className:"space-y-1",children:[i.jsx(kn,{id:"declarationAccepted",label:"I declare that I will not avail company GMC and the uploaded policy is valid.",checked:M.value??!1,onChange:M.onChange}),D.error&&i.jsx("p",{className:"text-xs text-red-600",children:D.error.message})]})})]})]})]})},ofe=()=>{const{onValidated:n,setToast:e}=ji(),{user:t}=jt(),r=Nt(),{data:s,updateUniforms:a}=Yn(),o=At("(max-width: 767px)"),[l,c]=E.useState(!0),[d,h]=E.useState(null),{gender:p}=s.personal,{organizationId:x,department:v,designation:b}=s.organization,{control:_,handleSubmit:j,reset:C,watch:P}=tn(),{fields:O,replace:M}=js({control:_,name:"uniforms"});E.useEffect(()=>{(async()=>{c(!0);try{const[U,B,W]=await Promise.all([ce.getAllSiteUniformDetails(),ce.getMasterGentsUniforms(),ce.getMasterLadiesUniforms()]);h({details:U,gents:B,ladies:W})}catch{e({message:"Failed to load uniform configuration.",type:"error"})}finally{c(!1)}})()},[e]);const D=E.useMemo(()=>{if(!d||!x||!v||!b)return[];const q=d.details[x];if(!q)return[];const U=q.departments.find(W=>W.department===v);return U?U.designations.find(W=>W.designation===b)?.items||[]:[]},[d,x,v,b]);E.useEffect(()=>{const q=D.map(U=>{const B=s.uniforms.find(Y=>Y.itemId===U.id),W=U.name.toLowerCase().includes("pant")?"Pants":"Shirts";return{itemId:U.id,itemName:U.name,category:W,sizeId:B?.sizeId||"",quantity:B?.quantity||1}});M(q)},[D,s.uniforms,M]),E.useEffect(()=>{let q;const U=P(B=>{clearTimeout(q),q=window.setTimeout(()=>{const W=B,Y=p==="Female"?[...d?.ladies.pants||[],...d?.ladies.shirts||[]]:[...d?.gents.pants||[],...d?.gents.shirts||[]],G=(W.uniforms||[]).filter(Z=>Z.sizeId&&Z.quantity>0).map(Z=>{const oe=Y.find(X=>X.id===Z.sizeId);return{itemId:Z.itemId,itemName:Z.itemName,sizeId:Z.sizeId,sizeLabel:oe?.size||"",fit:oe?.fit||"",quantity:Z.quantity}});a(G)},500)});return()=>{U.unsubscribe(),clearTimeout(q)}},[P,a,p,d]);const I=async q=>{const U=p==="Female"?[...d?.ladies.pants||[],...d?.ladies.shirts||[]]:[...d?.gents.pants||[],...d?.gents.shirts||[]],B=q.uniforms.filter(W=>W.sizeId&&W.quantity>0).map(W=>{const Y=U.find(G=>G.id===W.sizeId);return{itemId:W.itemId,itemName:W.itemName,sizeId:W.sizeId,sizeLabel:Y?.size||"",fit:Y?.fit||"",quantity:W.quantity}});a(B),await n()};if(l)return i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})});if(D.length===0&&s.uniforms.length>0)return i.jsxs("form",{onSubmit:async q=>{q.preventDefault(),await n()},id:"uniform-form",children:[!o&&i.jsx(Mr,{title:"Uniform Details",subtitle:"The following items have been selected for this employee."}),i.jsxs("div",{className:"space-y-4",children:[s.uniforms.map(q=>i.jsx("div",{className:`p-4 border rounded-lg flex justify-between items-center ${o?"bg-[#243524] border-border":"bg-page"}`,children:i.jsxs("div",{children:[i.jsx("p",{className:`font-semibold ${o?"text-white":"text-primary-text"}`,children:q.itemName}),i.jsxs("p",{className:`text-sm ${o?"text-gray-400":"text-muted"}`,children:["Size: ",q.sizeLabel,", Fit: ",q.fit,", Quantity: ",q.quantity]})]})},q.itemId+q.sizeId)),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>r("/onboarding/uniforms?from=onboarding"),children:[i.jsx(ur,{className:"mr-2 h-4 w-4"}),"Edit Uniform Selection"]})]})]});if(!p||D.length===0){const q=p?"No uniform requirements found for the selected site, department, and designation.":"Please select a gender in 'Personal Details' to view uniform options.",U=p&&D.length===0;return i.jsxs("form",{onSubmit:async B=>{B.preventDefault(),await n()},id:"uniform-form",children:[!o&&i.jsx(Mr,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),i.jsxs("div",{className:`text-center p-8 rounded-lg ${o?"":"bg-page"}`,children:[i.jsx(Ff,{className:`h-12 w-12 mx-auto ${o?"text-gray-500":"text-muted"}`}),i.jsx("p",{className:`mt-4 ${o?"text-gray-400":"text-muted"}`,children:q}),U&&i.jsxs("div",{className:"mt-6",children:[i.jsx("p",{className:`text-sm mb-4 ${o?"text-gray-500":"text-muted"}`,children:"You can proceed to the next step, or create a new site-level request if uniforms are needed."}),i.jsxs(ne,{type:"button",onClick:()=>r("/onboarding/uniforms?from=onboarding"),children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"}),"Create Site Uniform Request"]})]})]})]})}const F=p==="Female"?d?.ladies:d?.gents;return o?i.jsxs("form",{onSubmit:j(I),id:"uniform-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide uniform measurements for the employee."}),i.jsx("div",{className:"space-y-4",children:O.map((q,U)=>{const B=q.category==="Pants"?F?.pants:F?.shirts;return i.jsxs("div",{className:"p-4 border border-border rounded-xl space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:q.itemName}),i.jsx(_e,{name:`uniforms.${U}.sizeId`,control:_,render:({field:W})=>i.jsxs("select",{...W,className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"-- Select Size --"}),B?.map(Y=>i.jsxs("option",{value:Y.id,children:["Size: ",Y.size," - ",Y.fit]},Y.id))]})}),i.jsx(_e,{name:`uniforms.${U}.quantity`,control:_,render:({field:W})=>i.jsx("input",{type:"number",min:"1",...W,className:"form-input"})})]},q.id)})})]}):i.jsxs("form",{onSubmit:j(I),id:"uniform-form",children:[i.jsx(Mr,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),i.jsx("div",{className:"space-y-6",children:O.map((q,U)=>{const B=q.category==="Pants"?F?.pants:F?.shirts;return i.jsxs("div",{className:"p-4 border border-border rounded-xl bg-page/50",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:q.itemName}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(_e,{name:`uniforms.${U}.sizeId`,control:_,rules:{required:"Please select a size"},render:({field:W,fieldState:Y})=>i.jsxs(Ze,{label:"Size & Fit",error:Y.error?.message,...W,children:[i.jsx("option",{value:"",children:"-- Select Size --"}),B?.map(G=>i.jsxs("option",{value:G.id,children:["Size: ",G.size," - ",G.fit]},G.id))]})}),i.jsx(_e,{name:`uniforms.${U}.quantity`,control:_,rules:{required:!0,min:1},render:({field:W})=>i.jsx(we,{label:"Quantity",type:"number",min:"1",...W})})]})]},q.id)})})]})},Wh=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",lfe=()=>{const{onValidated:n,setToast:e}=ji(),{user:t}=jt(),r=Nt(),{data:s,updatePersonal:a,updateBank:o,addEducationRecord:l,updateFamilyMember:c,updateEducationRecord:d,updateUan:h,updateEsi:p,updateGmc:x}=Yn(),v=At("(max-width: 767px)"),b=B=>{const W={};if(B.name){const Y=B.name.split(" ");W.firstName=Wh(Y.shift()||""),W.lastName=Wh(Y.pop()||""),W.middleName=Wh(Y.join(" "))}if(B.dob)try{const Y=new Date(B.dob);isNaN(Y.getTime())||(W.dob=We(Y,"yyyy-MM-dd"))}catch{}B.aadhaarNumber&&(W.idProofNumber=B.aadhaarNumber.replace(/\s/g,""),W.idProofType="Aadhaar"),a(W)},_=B=>{const W={};if(B.accountHolderName&&(W.accountHolderName=Wh(B.accountHolderName)),B.accountNumber){const Y=B.accountNumber.replace(/\D/g,"");W.accountNumber=Y,W.confirmAccountNumber=Y}B.ifscCode&&(W.ifscCode=B.ifscCode.toUpperCase().replace(/\s/g,"")),o(W)},j=B=>{const W={};B.uanNumber&&(W.uanNumber=B.uanNumber.replace(/\D/g,""),W.hasPreviousPf=!0),h(W)},C=B=>{const W={};B.esiNumber&&(W.esiNumber=B.esiNumber.replace(/\D/g,""),W.hasEsi=!0),p(W)},P=B=>W=>{const Y={};if(W.name&&(Y.name=Wh(W.name)),W.dob)try{const G=new Date(W.dob);isNaN(G.getTime())||(Y.dob=We(G,"yyyy-MM-dd"))}catch{}c(B,Y)},O=B=>W=>{const Y={};W.degree&&(Y.degree=W.degree),W.institution&&(Y.institution=W.institution),W.endYear&&(Y.endYear=W.endYear.toString()),d(B,Y)},M={type:et.OBJECT,properties:{name:{type:et.STRING},dob:{type:et.STRING},aadhaarNumber:{type:et.STRING}}},D={type:et.OBJECT,properties:{accountHolderName:{type:et.STRING},accountNumber:{type:et.STRING},ifscCode:{type:et.STRING}}},I={type:et.OBJECT,properties:{uanNumber:{type:et.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:et.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:et.STRING,description:"The 10 or 17-digit ESI number."}}},F={type:et.OBJECT,properties:{uanNumber:{type:et.STRING}}},q={type:et.OBJECT,properties:{esiNumber:{type:et.STRING}}},U={type:et.OBJECT,properties:{degree:{type:et.STRING},institution:{type:et.STRING},endYear:{type:et.STRING}}};return v?i.jsxs("form",{onSubmit:async B=>{B.preventDefault(),await n()},id:"documents-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Upload supporting documents. You can also do this within each relevant section."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(vt,{label:"ID Proof (Front Side)",file:s.personal.idProofFront,onFileChange:B=>a({idProofFront:B}),onOcrComplete:b,ocrSchema:M,setToast:e,allowCapture:!0,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(vt,{label:"ID Proof (Back Side)",file:s.personal.idProofBack,onFileChange:B=>a({idProofBack:B}),onOcrComplete:b,ocrSchema:M,setToast:e,allowCapture:!0,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(vt,{label:"Profile Photo",file:s.personal.photo,onFileChange:B=>a({photo:B}),allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]}),i.jsx(vt,{label:"Bank Proof",file:s.bank.bankProof,onFileChange:B=>o({bankProof:B}),onOcrComplete:_,ocrSchema:D,setToast:e,allowCapture:!0,docType:"Bank"}),i.jsx(vt,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:s.uan.salarySlip,onFileChange:B=>h({salarySlip:B}),onOcrComplete:B=>{j(B),C(B)},ocrSchema:I,setToast:e,allowCapture:!0,docType:"Salary"}),s.uan.hasPreviousPf&&i.jsx(vt,{label:"UAN Document",file:s.uan.document,onFileChange:B=>h({document:B}),onOcrComplete:j,ocrSchema:F,setToast:e,allowCapture:!0,docType:"UAN"}),s.esi.hasEsi&&i.jsx(vt,{label:"ESI Document",file:s.esi.document,onFileChange:B=>p({document:B}),onOcrComplete:C,ocrSchema:q,setToast:e,allowCapture:!0}),s.gmc.isOptedIn===!1&&i.jsx(vt,{label:"GMC Policy Copy",file:s.gmc.gmcPolicyCopy,onFileChange:B=>x({gmcPolicyCopy:B}),allowCapture:!0}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[i.jsx("h4",{className:"form-header-title mb-4",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[s.education.map(B=>i.jsx(vt,{label:`Certificate for ${B.degree||"Qualification"}`,file:B.document,onFileChange:W=>d(B.id,{document:W}),onOcrComplete:O(B.id),ocrSchema:U,setToast:e,allowCapture:!0},B.id)),i.jsxs(ne,{type:"button",onClick:()=>r("/onboarding/add/education"),variant:"secondary",className:"w-full flex items-center justify-center",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Add / Edit Qualifications"})]})]})]}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[i.jsx("h4",{className:"form-header-title mb-4",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[s.family.map(B=>i.jsx(vt,{label:`ID Proof for ${B.name||"Family Member"}`,file:B.idProof,onFileChange:W=>c(B.id,{idProof:W}),onOcrComplete:P(B.id),ocrSchema:M,setToast:e,allowCapture:!0,docType:"Aadhaar"},B.id)),s.family.length===0&&i.jsx("p",{className:"text-sm text-gray-400",children:"No family members added."}),i.jsxs(ne,{type:"button",onClick:()=>r("/onboarding/add/family"),variant:"secondary",className:"w-full flex items-center justify-center",children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Add/Edit on Family Page"})]})]})]})]})]}):i.jsxs("form",{onSubmit:async B=>{B.preventDefault(),await n()},id:"documents-form",children:[i.jsx(Mr,{title:"Document Collection",subtitle:"Upload supporting documents. You can also do this within each relevant section."}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("section",{children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx(vt,{label:"Employee ID Proof (Aadhaar/PAN) - Front Side",file:s.personal.idProofFront,onFileChange:B=>a({idProofFront:B}),onOcrComplete:b,ocrSchema:M,setToast:e,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(vt,{label:"Employee ID Proof (Aadhaar/PAN) - Back Side",file:s.personal.idProofBack,onFileChange:B=>a({idProofBack:B}),onOcrComplete:b,ocrSchema:M,setToast:e,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(vt,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:s.bank.bankProof,onFileChange:B=>o({bankProof:B}),onOcrComplete:_,ocrSchema:D,setToast:e,docType:"Bank"}),i.jsx(vt,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:s.uan.salarySlip,onFileChange:B=>h({salarySlip:B}),onOcrComplete:B=>{j(B),C(B)},ocrSchema:I,setToast:e,docType:"Salary"})]})}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[s.education.map(B=>i.jsx(vt,{label:`Certificate for ${B.degree||"New Qualification"}`,file:B.document,onFileChange:W=>d(B.id,{document:W}),onOcrComplete:O(B.id),ocrSchema:U,setToast:e},B.id)),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>l(),children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[s.family.map(B=>i.jsx(vt,{label:`ID Proof for ${B.name||`(${B.relation})`}`,file:B.idProof,onFileChange:W=>c(B.id,{idProof:W}),onOcrComplete:P(B.id),ocrSchema:M,setToast:e,docType:"Aadhaar"},B.id)),s.family.length===0&&i.jsx("p",{className:"text-sm text-muted",children:"No family members added yet."}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>r("/onboarding/add/family"),children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"})," Go to Family Page to Add/Edit"]})]})]})]})]})},cfe=Pt({signatureImage:Vt().required("A signature image is mandatory.").nullable(),fingerprints:Pt().shape({leftThumb:Vt().optional().nullable(),leftIndex:Vt().optional().nullable(),leftMiddle:Vt().optional().nullable(),leftRing:Vt().optional().nullable(),leftLittle:Vt().optional().nullable(),rightThumb:Vt().optional().nullable(),rightIndex:Vt().optional().nullable(),rightMiddle:Vt().optional().nullable(),rightRing:Vt().optional().nullable(),rightLittle:Vt().optional().nullable()})}).defined(),dfe=[{hand:"Left",key:"leftThumb",name:"Thumb"},{hand:"Left",key:"leftIndex",name:"Index"},{hand:"Left",key:"leftMiddle",name:"Middle"},{hand:"Left",key:"leftRing",name:"Ring"},{hand:"Left",key:"leftLittle",name:"Little"},{hand:"Right",key:"rightThumb",name:"Thumb"},{hand:"Right",key:"rightIndex",name:"Index"},{hand:"Right",key:"rightMiddle",name:"Middle"},{hand:"Right",key:"rightRing",name:"Ring"},{hand:"Right",key:"rightLittle",name:"Little"}],ufe=()=>{const{onValidated:n}=ji(),{data:e,updateBiometrics:t}=Yn(),{user:r}=jt(),s=At("(max-width: 767px)"),{control:a,handleSubmit:o,formState:{errors:l},reset:c,watch:d}=tn({resolver:On(cfe),defaultValues:e.biometrics});E.useEffect(()=>{c(e.biometrics)},[e.biometrics,c]),E.useEffect(()=>{const v=d(b=>{t(b)});return()=>v.unsubscribe()},[d,t]);const h=async(v,b)=>{try{const _=await ce.verifyFingerprintImage(v,b);return _.containsFingerprints?{success:!0,reason:""}:{success:!1,reason:_.reason||"Image does not appear to contain fingerprints. Please upload a clear scan."}}catch(_){return{success:!1,reason:_.message||"AI verification failed."}}},p=async v=>{t(v),await n()},x=v=>dfe.filter(b=>b.hand===v).map(b=>i.jsx(_e,{name:`fingerprints.${b.key}`,control:a,render:({field:_})=>i.jsx(vt,{label:`${v} ${b.name}`,file:_.value,onFileChange:_.onChange,onVerification:h,allowCapture:!0})},b.key));return i.jsxs("form",{onSubmit:o(p),id:"biometrics-form",children:[!s&&i.jsx(Mr,{title:"Biometrics",subtitle:"Please provide fingerprint scans and a mandatory signature."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:`text-lg font-semibold text-center mb-4 ${s?"form-header-title":"text-primary-text"}`,children:["Signature ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("div",{className:"w-full",children:i.jsx(_e,{name:"signatureImage",control:a,render:({field:v,fieldState:b})=>i.jsx(vt,{label:"Upload or capture a signature",file:v.value,onFileChange:v.onChange,allowCapture:!0,error:b.error?.message})})})]}),i.jsx("div",{className:s?"":"my-8 border-t border-border"}),i.jsxs("div",{children:[i.jsx("h4",{className:`text-lg font-semibold text-center mb-4 ${s?"form-header-title":"text-primary-text"}`,children:"Fingerprints (Optional)"}),i.jsx("p",{className:`text-center mb-6 ${s?"text-gray-400":"text-muted"}`,children:"Upload scans for all 10 fingerprints, one image per finger."}),i.jsxs("div",{className:"w-full grid grid-cols-2 md:grid-cols-5 gap-4",children:[x("Left"),x("Right")]})]})]})]})},Ec=({label:n,value:e})=>i.jsxs("div",{children:[i.jsx("dt",{className:"text-sm font-medium text-muted",children:n}),i.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),Dc=({label:n,value:e,status:t,isVerifying:r})=>i.jsxs("div",{children:[i.jsxs("dt",{className:"text-sm font-medium text-muted flex items-center",children:[n,r&&i.jsx(_t,{className:"h-4 w-4 text-muted animate-spin ml-2"}),!r&&t===!0&&i.jsx("span",{title:"Verified from document",className:"ml-2",children:i.jsx(Ji,{className:"h-4 w-4 text-green-500"})}),!r&&t===!1&&i.jsx("span",{title:"Verification Failed",className:"ml-2",children:i.jsx(ym,{className:"h-4 w-4 text-red-500"})})]}),i.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),Hi=({label:n,value:e})=>i.jsxs("div",{className:"flex justify-between items-start py-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:n}),i.jsx("span",{className:"text-sm text-white font-medium text-right max-w-[60%]",children:e||"-"})]}),ffe=()=>{const{onSubmit:n,isSubmitting:e}=ji(),{user:t}=jt(),{data:r,logVerificationUsage:s,setPersonalVerifiedStatus:a,setBankVerifiedStatus:o,setUanVerifiedStatus:l}=Yn(),{perfiosApi:c}=bi(),d=Nt(),[h,p]=E.useState(window.innerWidth<768);E.useEffect(()=>{const D=()=>p(window.innerWidth<768);return window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)},[]);const x=t?.role==="field_officer"&&h,[v,b]=E.useState("idle"),[_,j]=E.useState(""),C=E.useMemo(()=>Object.entries(r.biometrics.fingerprints).filter(([,D])=>D!==null).map(([D])=>D.replace(/([A-Z])/g," $1").replace(/^./,I=>I.toUpperCase())),[r.biometrics.fingerprints]),P=async()=>{b("verifying"),j("");let D=!0;const I=[];try{s("Bank AC Verification Advanced");const F=await ce.verifyBankAccountWithPerfios({name:r.bank.accountHolderName,dob:r.personal.dob,aadhaar:r.personal.idProofNumber||null,pan:null,bank:{accountNumber:r.bank.accountNumber,ifsc:r.bank.ifscCode},uan:r.uan.uanNumber||null,esi:r.esi.esiNumber||null});if(I.push(`Bank: ${F.message}`),o({accountNumber:F.verifiedFields.accountNumber,accountHolderName:F.verifiedFields.accountHolderName}),F.success||(D=!1),r.personal.idProofType==="Aadhaar"&&r.personal.idProofNumber){s("Aadhaar Verification");const q=await ce.verifyAadhaar(r.personal.idProofNumber);I.push(`Aadhaar: ${q.message}`),a({idProofNumber:q.success}),q.success||(D=!1)}if(r.uan.hasPreviousPf&&r.uan.uanNumber){s("EPF UAN Lookup");const q=await ce.lookupUan(r.uan.uanNumber);I.push(`UAN: ${q.message}`),l({uanNumber:q.verifiedFields.uan}),q.success||(D=!1)}await ce.updateOnboarding(Yn.getState().data),j(I.join(`
`)),b(D?"success":"failed")}catch(F){b("failed"),j(F.message||"An unexpected error occurred during verification.")}},O=()=>{d(`/onboarding/pdf/${r.id||"draft"}`)},M=(v==="success"||!c.enabled)&&r.formsGenerated;return x?i.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"review-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please review all your details carefully before submitting."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Personal Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Hi,{label:"Full Name",value:`${r.personal.firstName} ${r.personal.lastName}`}),i.jsx(Hi,{label:"Email",value:r.personal.email}),i.jsx(Hi,{label:"Mobile",value:r.personal.mobile}),i.jsx(Hi,{label:"Date of Birth",value:r.personal.dob})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Organization Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Hi,{label:"Site",value:r.organization.organizationName}),i.jsx(Hi,{label:"Designation",value:r.organization.designation}),i.jsx(Hi,{label:"Department",value:r.organization.department})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Bank Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Hi,{label:"Account Holder",value:r.bank.accountHolderName}),i.jsx(Hi,{label:"Account Number",value:"*".repeat(Math.max(0,r.bank.accountNumber.length-4))+r.bank.accountNumber.slice(-4)}),i.jsx(Hi,{label:"IFSC Code",value:r.bank.ifscCode})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Uniform Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Hi,{label:"Uniform Required",value:r.uniforms.length>0?"Yes":"No"}),r.uniforms.map(D=>i.jsx(Hi,{label:D.itemName,value:`${D.quantity} x Size ${D.sizeLabel} (${D.fit})`},D.itemId))]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Biometrics"}),r.biometrics.signatureImage&&i.jsxs("div",{className:"mb-4",children:[i.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Signature"}),i.jsx("img",{src:r.biometrics.signatureImage.preview,alt:"Signature",className:"h-24 bg-white border rounded-md mx-auto"})]}),C.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Fingerprints"}),i.jsx("ul",{className:"text-sm text-center text-gray-400 list-disc list-inside",children:C.map(D=>i.jsx("li",{children:D},D))})]})]})]})]}):i.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"review-form",children:[i.jsx(Mr,{title:"Review & Submit",subtitle:"Please review all your details carefully before submitting."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Personal Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Dc,{label:"Full Name",value:`${r.personal.firstName} ${r.personal.lastName}`,status:r.personal.verifiedStatus?.name,isVerifying:!1}),i.jsx(Ec,{label:"Email",value:r.personal.email}),i.jsx(Ec,{label:"Mobile",value:r.personal.mobile}),i.jsx(Dc,{label:"Date of Birth",value:r.personal.dob,status:r.personal.verifiedStatus?.dob,isVerifying:!1}),i.jsx(Ec,{label:"Gender",value:r.personal.gender}),i.jsx(Dc,{label:"Aadhaar Number",value:r.personal.idProofNumber,status:r.personal.verifiedStatus?.idProofNumber,isVerifying:v==="verifying"})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Organization Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Ec,{label:"Site / Client",value:r.organization.organizationName}),i.jsx(Ec,{label:"Designation",value:r.organization.designation}),i.jsx(Ec,{label:"Department",value:r.organization.department}),i.jsx(Ec,{label:"Joining Date",value:r.organization.joiningDate})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Bank & Statutory Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Dc,{label:"Account Holder",value:r.bank.accountHolderName,status:r.bank.verifiedStatus?.accountHolderName,isVerifying:v==="verifying"}),i.jsx(Dc,{label:"Account Number",value:"*".repeat(Math.max(0,r.bank.accountNumber.length-4))+r.bank.accountNumber.slice(-4),status:r.bank.verifiedStatus?.accountNumber,isVerifying:v==="verifying"}),i.jsx(Dc,{label:"IFSC Code",value:r.bank.ifscCode,status:r.bank.verifiedStatus?.ifscCode,isVerifying:v==="verifying"}),i.jsx(Ec,{label:"Bank Name",value:r.bank.bankName}),r.uan.hasPreviousPf&&i.jsx(Dc,{label:"UAN",value:r.uan.uanNumber,status:r.uan.verifiedStatus?.uanNumber,isVerifying:v==="verifying"}),r.esi.hasEsi&&i.jsx(Dc,{label:"ESI Number",value:r.esi.esiNumber,status:r.esi.verifiedStatus?.esiNumber,isVerifying:v==="verifying"})]})]}),r.uniforms.length>0&&i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Uniform Details"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.uniforms.map(D=>i.jsxs("div",{className:"bg-page p-3 rounded-md",children:[i.jsx("p",{className:"font-semibold text-sm",children:D.itemName}),i.jsxs("p",{className:"text-xs text-muted",children:["Size: ",D.sizeLabel," (",D.fit,")"]}),i.jsxs("p",{className:"text-xs text-muted",children:["Qty: ",D.quantity]})]},D.itemId))})]}),r.biometrics.signatureImage&&i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Biometrics"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-primary-text",children:"Signature"}),i.jsx("div",{className:"mt-2 p-2 border rounded-lg inline-block bg-page",children:i.jsx("img",{src:r.biometrics.signatureImage.preview,alt:"Signature",className:"h-24"})})]}),C.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-primary-text",children:"Fingerprints Uploaded"}),i.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-muted columns-2",children:C.map(D=>i.jsx("li",{children:D},D))})]})]})]})]}),c.enabled&&i.jsxs("div",{className:"mt-8 pt-6 border-t",children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Third-Party Verification"}),i.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:"Run a background check against official records."}),i.jsx("p",{className:"text-sm text-muted",children:"This step is required before you can submit the application."}),v==="failed"&&i.jsx("p",{className:"text-sm text-red-600 mt-2",children:_}),v==="success"&&i.jsx("p",{className:"text-sm text-green-600 mt-2",children:_})]}),i.jsxs(ne,{onClick:P,isLoading:v==="verifying",disabled:v==="success",children:[v==="idle"&&i.jsxs(i.Fragment,{children:[i.jsx(dy,{className:"mr-2 h-4 w-4"})," Verify Details"]}),v==="verifying"&&"Verifying...",v==="failed"&&"Retry Verification",v==="success"&&i.jsxs(i.Fragment,{children:[i.jsx(Ji,{className:"mr-2 h-4 w-4"})," Verified"]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t",children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Generate Official Forms"}),i.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:"Generate and review the official PDF documents."}),i.jsx("p",{className:"text-sm text-muted",children:"This step is mandatory before final submission."})]}),r.formsGenerated?i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-green-600",children:[i.jsx(Ji,{className:"h-5 w-5"}),i.jsx("span",{children:"Forms Generated & Confirmed"})]}):i.jsxs(ne,{onClick:O,children:[i.jsx(ds,{className:"mr-2 h-4 w-4"})," Generate & Review Forms"]})]})]}),i.jsx("div",{className:"mt-8 pt-6 border-t",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex items-center h-5",children:i.jsx("input",{id:"confirmation",name:"confirmation",type:"checkbox",required:!0,className:"focus:ring-accent h-4 w-4 text-accent border-gray-300 rounded",disabled:!M})}),i.jsxs("div",{className:"ml-3 text-sm",children:[i.jsx("label",{htmlFor:"confirmation",className:`font-medium ${M?"text-gray-700":"text-gray-400"}`,children:"Declaration"}),i.jsx("p",{className:`${M?"text-muted":"text-gray-400"}`,children:"I hereby declare that the information provided is true and correct to the best of my knowledge."})]})]})})]})},Hn=({requiredPermission:n,children:e})=>{const{user:t,isInitialized:r}=jt(),{permissions:s}=na();return r?t?(s[t.role]||[]).includes(n)?e?i.jsx(i.Fragment,{children:e}):i.jsx(Sf,{}):i.jsx(wl,{to:"/forbidden",replace:!0}):i.jsx(wl,{to:"/auth/login",replace:!0}):null},hfe=({onIdle:n,idleTimeout:e,promptTimeout:t,disabled:r=!1})=>{const[s,a]=E.useState(!1),[o,l]=E.useState(t),c=E.useRef(null),d=E.useRef(null),h=E.useRef(null),p=["mousemove","keydown","mousedown","scroll","touchstart"],x=E.useCallback(()=>{r||(a(!1),l(t),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current),c.current=window.setTimeout(()=>{a(!0)},e))},[e,t,r]);return E.useEffect(()=>{if(!r)return s&&(d.current=window.setTimeout(n,t),h.current=window.setInterval(()=>{l(v=>Math.max(0,v-1e3))},1e3)),()=>{d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)}},[s,n,t,r]),E.useEffect(()=>{if(r)return;const v=()=>x();return p.forEach(b=>{window.addEventListener(b,v)}),x(),()=>{p.forEach(b=>{window.removeEventListener(b,v)}),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)}},[x,r]),{isIdle:s,countdown:o,reset:x}},mfe=1800*1e3,pfe=120*1e3,gfe=()=>{const{logout:n}=jt(),e=Nt(),t=()=>{n(),e("/auth/login",{replace:!0})},r=At("(max-width: 768px)"),{isIdle:s,countdown:a,reset:o}=hfe({onIdle:t,idleTimeout:mfe,promptTimeout:pfe,disabled:r});return s?i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-70 backdrop-blur-sm","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 text-center animate-fade-in-scale",children:[i.jsx(m3,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Are you still there?"}),i.jsx("p",{className:"mt-2 text-muted",children:"For your security, you will be logged out due to inactivity."}),i.jsx("div",{className:"my-6 text-4xl font-bold text-accent",children:Math.ceil(a/1e3)}),i.jsx("p",{className:"text-sm text-muted mb-6",children:"Click the button below to stay logged in."}),i.jsx("div",{className:"flex justify-center gap-4",children:i.jsx(ne,{onClick:o,variant:"primary",size:"lg",children:"Stay Logged In"})})]})}):null},xfe=()=>{const{pathname:n}=Zr();return E.useEffect(()=>{window.scrollTo(0,0);const e=document.querySelector("main");e&&e.scrollTo(0,0);const t=document.getElementById("root");t&&t.scrollTo(0,0)},[n]),null},yfe=()=>{const{theme:n,isAutomatic:e,_setThemeInternal:t}=td(),{colorScheme:r}=on(),s=At("(max-width: 767px)");return E.useEffect(()=>{const a=document.body;let o="light";e?s?o="dark":o="light":o=n,t(o),o==="dark"?a.classList.add("pro-dark-theme"):a.classList.remove("pro-dark-theme")},[n,e,s,t,r]),null},vfe=()=>{const{colorScheme:n,appTitle:e}=on();return E.useEffect(()=>{const t=document.body;t.classList.remove("blue-theme","green-theme","purple-theme","red-theme","amber-theme","professional-blue-theme","dark-saas-theme","teal-mint-theme","indigo-violet-theme","green-finance-theme","orange-energy-theme","red-alert-theme","neutral-gray-theme","cyan-tech-theme","black-gold-theme"),t.classList.add(`${n}-theme`),e&&(document.title=e)},[n,e]),null},xx="app:lastPath",bfe=["/auth","/splash","/pending-approval","/forbidden"],sC=n=>n==="/"||n==="/#"||n==="/index.html"?!1:!bfe.some(e=>n.startsWith(e)),wfe=()=>{const{user:n,isInitialized:e}=jt(),t=Zr(),r=At("(max-width: 767px)");return e?n?n.role==="unverified"?i.jsx(wl,{to:"/pending-approval",replace:!0}):i.jsx(_Q,{children:r?i.jsx(XJ,{}):i.jsx(JJ,{})}):(sC(t.pathname+t.search)&&localStorage.setItem(xx,t.pathname+t.search),i.jsx(wl,{to:"/auth/login",replace:!0})):null},_fe=()=>{const{user:n,isInitialized:e,setUser:t,setInitialized:r,resetAttendance:s,setLoading:a,isLoginAnimationPending:o}=jt(),{init:l}=nd(),{initRoles:c}=na(),{initSettings:d}=bi(),{initBranding:h}=on(),p=Nt(),x=Zr();return E.useEffect(()=>{n&&sC(x.pathname+x.search)&&localStorage.setItem(xx,x.pathname+x.search)},[n,x.pathname,x.search]),E.useEffect(()=>{let v=!0;const b=setTimeout(()=>{v&&(console.warn("App initialization is taking too long. Proceeding without a session."),a(!1),r(!0))},3e4);(async()=>{a(!0);try{let{data:{session:C},error:P}=await Ee.auth.getSession();if(P&&console.error("Error fetching initial session:",P.message),!C){const O=localStorage.getItem("supabase.auth.rememberMe");if(O){console.log("Attempting to restore session from long-term token...");try{const{data:M,error:D}=await Ee.auth.setSession({refresh_token:O});D?(console.error("Failed to restore session from long-term token:",D.message),localStorage.removeItem("supabase.auth.rememberMe")):C=M.session}catch(M){console.error("Exception while restoring session from long-term token:",M)}}}if(C)try{const O=await Ca.getAppUserProfile(C.user);v&&t(O)}catch(O){console.error("Failed to fetch user profile during initialization:",O),v&&(t(null),s())}else v&&(t(null),s())}catch(C){console.error("Error during app initialization:",C),v&&(t(null),s())}finally{clearTimeout(b),v&&(a(!1),r(!0))}})();const{data:{subscription:j}}=Ee.auth.onAuthStateChange((C,P)=>{if(C==="PASSWORD_RECOVERY"){p("/auth/update-password",{replace:!0});return}P?.user?setTimeout(async()=>{try{const O=await Ca.getAppUserProfile(P.user);if(v&&(t(O),O))try{const M=`greetingSent_${O.id}`;localStorage.getItem(M)||(await ce.createNotification({userId:O.id,message:`Good morning, ${O.name||"there"}! Welcome to Paradigm Services.`,type:"greeting"}),localStorage.setItem(M,"1"))}catch(M){console.error("Failed to send login greeting notification",M)}}catch(O){console.error("Failed to fetch user profile after auth change:",O),v&&(t(null),s(),Yn.getState().reset())}},0):v&&(t(null),s(),Yn.getState().reset())});return()=>{v=!1,j?.unsubscribe(),clearTimeout(b)}},[t,r,s,a]),E.useEffect(()=>{n&&e&&((async()=>{try{const{settings:b,roles:_,holidays:j}=await ce.getInitialAppData(),C=await ce.getRecurringHolidays();b.enrollmentRules&&l(b.enrollmentRules),_&&c(_),b.attendanceSettings&&j&&d({holidays:j,attendanceSettings:b.attendanceSettings,recurringHolidays:C||[]}),b.apiSettings?.colorScheme&&h(b.apiSettings.colorScheme,b.apiSettings.appTitle),b.apiSettings?.globalLogo&&Am.getState().setCurrentLogo(b.apiSettings.globalLogo)}catch(b){console.error("Failed to load initial application data:",b)}})(),jt.getState().checkAttendanceStatus())},[n,e,l,c,d,h]),E.useEffect(()=>{if(e&&x.pathname!=="/auth/update-password"&&n&&!o&&(x.pathname.startsWith("/auth")&&x.pathname!=="/auth/logout"||x.pathname==="/"||x.pathname==="/splash")){const v=localStorage.getItem(xx);v&&sC(v)&&v!=="/"&&v!=="/#"?(localStorage.removeItem(xx),p(v,{replace:!0})):n.role==="unverified"?p("/pending-approval",{replace:!0}):p("/profile",{replace:!0})}},[e,n,x.pathname,p,o]),e?i.jsxs(i.Fragment,{children:[i.jsx(xfe,{}),i.jsx(yfe,{}),i.jsx(vfe,{}),n&&i.jsx(gfe,{}),i.jsxs(Rz,{children:[i.jsxs($e,{path:"/auth",element:i.jsx(tQ,{}),children:[i.jsx($e,{index:!0,element:i.jsx(wl,{to:"login",replace:!0})}),i.jsx($e,{path:"login",element:i.jsx(PX,{})}),i.jsx($e,{path:"signup",element:i.jsx(EX,{})}),i.jsx($e,{path:"forgot-password",element:i.jsx(OX,{})}),i.jsx($e,{path:"update-password",element:i.jsx(RX,{})}),i.jsx($e,{path:"logout",element:i.jsx(LX,{})})]}),i.jsx($e,{path:"/pending-approval",element:n&&n.role==="unverified"?i.jsx(FX,{}):i.jsx(wl,{to:"/auth/login",replace:!0})}),i.jsx($e,{path:"/forbidden",element:i.jsx(qX,{})}),i.jsxs($e,{path:"/",element:i.jsx(sQ,{children:i.jsx(wfe,{})}),children:[i.jsx($e,{index:!0,element:i.jsx(wl,{to:"/profile",replace:!0})}),i.jsx($e,{path:"profile",element:i.jsx(Mse,{})}),i.jsx($e,{path:"mobile-home",element:i.jsx(NQ,{})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"create_enrollment"}),children:[i.jsx($e,{path:"onboarding",element:i.jsx(zX,{})}),i.jsx($e,{path:"onboarding/select-organization",element:i.jsx(UX,{})}),i.jsx($e,{path:"onboarding/pre-upload",element:i.jsx(fue,{})}),i.jsx($e,{path:"onboarding/submissions",element:i.jsx(pue,{})}),i.jsx($e,{path:"onboarding/tasks",element:i.jsx(xue,{})}),i.jsx($e,{path:"onboarding/uniforms",element:i.jsx(bue,{})}),i.jsxs($e,{path:"onboarding/add",element:i.jsx(BX,{}),children:[i.jsx($e,{path:"personal",element:i.jsx($ue,{})}),i.jsx($e,{path:"address",element:i.jsx(Yue,{})}),i.jsx($e,{path:"organization",element:i.jsx(Zue,{})}),i.jsx($e,{path:"family",element:i.jsx(Kue,{})}),i.jsx($e,{path:"education",element:i.jsx(Jue,{})}),i.jsx($e,{path:"bank",element:i.jsx(efe,{})}),i.jsx($e,{path:"uan",element:i.jsx(nfe,{})}),i.jsx($e,{path:"esi",element:i.jsx(sfe,{})}),i.jsx($e,{path:"gmc",element:i.jsx(afe,{})}),i.jsx($e,{path:"uniform",element:i.jsx(ofe,{})}),i.jsx($e,{path:"documents",element:i.jsx(lfe,{})}),i.jsx($e,{path:"biometrics",element:i.jsx(ufe,{})}),i.jsx($e,{path:"review",element:i.jsx(ffe,{})})]}),i.jsx($e,{path:"onboarding/pdf/:id",element:i.jsx(Wde,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_all_submissions"}),children:i.jsx($e,{path:"verification/dashboard",element:i.jsx(HX,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_users"}),children:[i.jsx($e,{path:"admin/users",element:i.jsx(ZX,{})}),i.jsx($e,{path:"admin/users/add",element:i.jsx(KL,{})}),i.jsx($e,{path:"admin/users/edit/:id",element:i.jsx(KL,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_sites"}),children:[i.jsx($e,{path:"admin/sites",element:i.jsx(pse,{})}),i.jsx($e,{path:"admin/sites/add",element:i.jsx(Uue,{})}),i.jsx($e,{path:"admin/sites/quick-add",element:i.jsx(Bue,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_roles_and_permissions"}),children:[i.jsx($e,{path:"admin/roles",element:i.jsx(xse,{})}),i.jsx($e,{path:"admin/roles/add",element:i.jsx(JL,{})}),i.jsx($e,{path:"admin/roles/edit/:id",element:i.jsx(JL,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_modules"}),children:[i.jsx($e,{path:"admin/modules",element:i.jsx(wse,{})}),i.jsx($e,{path:"admin/modules/add",element:i.jsx(que,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_approval_workflow"}),children:[i.jsx($e,{path:"admin/approval-workflow",element:i.jsx(Bce,{})}),i.jsx($e,{path:"admin/approval-workflow/chart",element:i.jsx(Vce,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_developer_settings"}),children:i.jsx($e,{path:"developer/api",element:i.jsx(jse,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"view_operations_dashboard"}),children:[i.jsx($e,{path:"operations/dashboard",element:i.jsx(Nse,{})}),i.jsx($e,{path:"operations/team-activity",element:i.jsx(Cse,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_site_dashboard"}),children:i.jsx($e,{path:"site/dashboard",element:i.jsx(kse,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"view_own_attendance"}),children:[i.jsx($e,{path:"attendance/dashboard",element:i.jsx(Sce,{})}),i.jsx($e,{path:"attendance/locations",element:i.jsx(Tce,{})}),i.jsx($e,{path:"attendance/check-in",element:i.jsx(BL,{})}),i.jsx($e,{path:"attendance/check-out",element:i.jsx(BL,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"apply_for_leave"}),children:i.jsx($e,{path:"leaves/dashboard",element:i.jsx(Rce,{})})}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"manage_attendance_rules"}),children:i.jsx($e,{path:"hr/attendance-settings",element:i.jsx(kce,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_leave_requests"}),children:[i.jsx($e,{path:"hr/leave-management",element:i.jsx(zce,{})}),i.jsx($e,{path:"hr/leave-management/grant-comp-off",element:i.jsx(Fue,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"view_entity_management"}),children:[i.jsx($e,{path:"hr/entities",element:i.jsx(Rde,{})}),i.jsx($e,{path:"hr/entity-management/add-group",element:i.jsx(Lue,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_policies"}),children:[i.jsx($e,{path:"hr/policies-and-insurance",element:i.jsx(Bde,{})}),i.jsx($e,{path:"hr/policies/add",element:i.jsx(Iue,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"manage_enrollment_rules"}),children:i.jsx($e,{path:"hr/enrollment-rules",element:i.jsx(Vde,{})})}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_field_officer_tracking"}),children:i.jsx($e,{path:"hr/field-officer-tracking",element:i.jsx(aue,{})})}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"manage_attendance_rules"}),children:i.jsx($e,{path:"hr/locations",element:i.jsx(lue,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_uniforms"}),children:[i.jsx($e,{path:"uniforms",element:i.jsx(Yde,{})}),i.jsx($e,{path:"uniforms/request/new",element:i.jsx(XL,{})}),i.jsx($e,{path:"uniforms/request/edit/:id",element:i.jsx(XL,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_verification_costing"}),children:i.jsx($e,{path:"billing/cost-analysis",element:i.jsx(Kde,{})})}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_invoice_summary"}),children:i.jsx($e,{path:"billing/summary",element:i.jsx(Xde,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_tasks"}),children:[i.jsx($e,{path:"tasks",element:i.jsx(Yce,{})}),i.jsx($e,{path:"tasks/add",element:i.jsx(QL,{})}),i.jsx($e,{path:"tasks/edit/:id",element:i.jsx(QL,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"access_support_desk"}),children:[i.jsx($e,{path:"support",element:i.jsx(Sue,{})}),i.jsx($e,{path:"support/ticket/new",element:i.jsx(Rue,{})}),i.jsx($e,{path:"support/ticket/:id",element:i.jsx(Eue,{})})]})]}),i.jsx($e,{path:"*",element:i.jsx(wl,{to:"/",replace:!0})})]})]}):i.jsx(SQ,{})},tq=document.getElementById("root");if(!tq)throw new Error("Could not find root element to mount to");const jfe=$q.createRoot(tq);jfe.render(i.jsx(ot.StrictMode,{children:i.jsx($z,{children:i.jsx(_fe,{})})}));export{ZM as E,RC as W,Cf as _,wu as a,fQ as b,Sfe as c,n4 as g};
