function t4(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var hfe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function n4(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var Wv={exports:{}},ph={},$v={exports:{}},Jt={};var tk;function Aq(){if(tk)return Jt;tk=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function x(H){return H===null||typeof H!="object"?null:(H=p&&H[p]||H["@@iterator"],typeof H=="function"?H:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,_={};function j(H,Q,re){this.props=H,this.context=Q,this.refs=_,this.updater=re||v}j.prototype.isReactComponent={},j.prototype.setState=function(H,Q){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,Q,"setState")},j.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function T(){}T.prototype=j.prototype;function P(H,Q,re){this.props=H,this.context=Q,this.refs=_,this.updater=re||v}var D=P.prototype=new T;D.constructor=P,w(D,j.prototype),D.isPureReactComponent=!0;var M=Array.isArray,O=Object.prototype.hasOwnProperty,I={current:null},q={key:!0,ref:!0,__self:!0,__source:!0};function F(H,Q,re){var de,ce={},pe=null,ie=null;if(Q!=null)for(de in Q.ref!==void 0&&(ie=Q.ref),Q.key!==void 0&&(pe=""+Q.key),Q)O.call(Q,de)&&!q.hasOwnProperty(de)&&(ce[de]=Q[de]);var xe=arguments.length-2;if(xe===1)ce.children=re;else if(1<xe){for(var Ce=Array(xe),ve=0;ve<xe;ve++)Ce[ve]=arguments[ve+2];ce.children=Ce}if(H&&H.defaultProps)for(de in xe=H.defaultProps,xe)ce[de]===void 0&&(ce[de]=xe[de]);return{$$typeof:n,type:H,key:pe,ref:ie,props:ce,_owner:I.current}}function V(H,Q){return{$$typeof:n,type:H.type,key:Q,ref:H.ref,props:H.props,_owner:H._owner}}function U(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function W(H){var Q={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(re){return Q[re]})}var $=/\/+/g;function ne(H,Q){return typeof H=="object"&&H!==null&&H.key!=null?W(""+H.key):Q.toString(36)}function Y(H,Q,re,de,ce){var pe=typeof H;(pe==="undefined"||pe==="boolean")&&(H=null);var ie=!1;if(H===null)ie=!0;else switch(pe){case"string":case"number":ie=!0;break;case"object":switch(H.$$typeof){case n:case e:ie=!0}}if(ie)return ie=H,ce=ce(ie),H=de===""?"."+ne(ie,0):de,M(ce)?(re="",H!=null&&(re=H.replace($,"$&/")+"/"),Y(ce,Q,re,"",function(ve){return ve})):ce!=null&&(U(ce)&&(ce=V(ce,re+(!ce.key||ie&&ie.key===ce.key?"":(""+ce.key).replace($,"$&/")+"/")+H)),Q.push(ce)),1;if(ie=0,de=de===""?".":de+":",M(H))for(var xe=0;xe<H.length;xe++){pe=H[xe];var Ce=de+ne(pe,xe);ie+=Y(pe,Q,re,Ce,ce)}else if(Ce=x(H),typeof Ce=="function")for(H=Ce.call(H),xe=0;!(pe=H.next()).done;)pe=pe.value,Ce=de+ne(pe,xe++),ie+=Y(pe,Q,re,Ce,ce);else if(pe==="object")throw Q=String(H),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return ie}function ae(H,Q,re){if(H==null)return H;var de=[],ce=0;return Y(H,de,"","",function(pe){return Q.call(re,pe,ce++)}),de}function J(H){if(H._status===-1){var Q=H._result;Q=Q(),Q.then(function(re){(H._status===0||H._status===-1)&&(H._status=1,H._result=re)},function(re){(H._status===0||H._status===-1)&&(H._status=2,H._result=re)}),H._status===-1&&(H._status=0,H._result=Q)}if(H._status===1)return H._result.default;throw H._result}var ee={current:null},X={transition:null},Z={ReactCurrentDispatcher:ee,ReactCurrentBatchConfig:X,ReactCurrentOwner:I};function oe(){throw Error("act(...) is not supported in production builds of React.")}return Jt.Children={map:ae,forEach:function(H,Q,re){ae(H,function(){Q.apply(this,arguments)},re)},count:function(H){var Q=0;return ae(H,function(){Q++}),Q},toArray:function(H){return ae(H,function(Q){return Q})||[]},only:function(H){if(!U(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Jt.Component=j,Jt.Fragment=t,Jt.Profiler=s,Jt.PureComponent=P,Jt.StrictMode=r,Jt.Suspense=c,Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,Jt.act=oe,Jt.cloneElement=function(H,Q,re){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var de=w({},H.props),ce=H.key,pe=H.ref,ie=H._owner;if(Q!=null){if(Q.ref!==void 0&&(pe=Q.ref,ie=I.current),Q.key!==void 0&&(ce=""+Q.key),H.type&&H.type.defaultProps)var xe=H.type.defaultProps;for(Ce in Q)O.call(Q,Ce)&&!q.hasOwnProperty(Ce)&&(de[Ce]=Q[Ce]===void 0&&xe!==void 0?xe[Ce]:Q[Ce])}var Ce=arguments.length-2;if(Ce===1)de.children=re;else if(1<Ce){xe=Array(Ce);for(var ve=0;ve<Ce;ve++)xe[ve]=arguments[ve+2];de.children=xe}return{$$typeof:n,type:H.type,key:ce,ref:pe,props:de,_owner:ie}},Jt.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:a,_context:H},H.Consumer=H},Jt.createElement=F,Jt.createFactory=function(H){var Q=F.bind(null,H);return Q.type=H,Q},Jt.createRef=function(){return{current:null}},Jt.forwardRef=function(H){return{$$typeof:l,render:H}},Jt.isValidElement=U,Jt.lazy=function(H){return{$$typeof:h,_payload:{_status:-1,_result:H},_init:J}},Jt.memo=function(H,Q){return{$$typeof:d,type:H,compare:Q===void 0?null:Q}},Jt.startTransition=function(H){var Q=X.transition;X.transition={};try{H()}finally{X.transition=Q}},Jt.unstable_act=oe,Jt.useCallback=function(H,Q){return ee.current.useCallback(H,Q)},Jt.useContext=function(H){return ee.current.useContext(H)},Jt.useDebugValue=function(){},Jt.useDeferredValue=function(H){return ee.current.useDeferredValue(H)},Jt.useEffect=function(H,Q){return ee.current.useEffect(H,Q)},Jt.useId=function(){return ee.current.useId()},Jt.useImperativeHandle=function(H,Q,re){return ee.current.useImperativeHandle(H,Q,re)},Jt.useInsertionEffect=function(H,Q){return ee.current.useInsertionEffect(H,Q)},Jt.useLayoutEffect=function(H,Q){return ee.current.useLayoutEffect(H,Q)},Jt.useMemo=function(H,Q){return ee.current.useMemo(H,Q)},Jt.useReducer=function(H,Q,re){return ee.current.useReducer(H,Q,re)},Jt.useRef=function(H){return ee.current.useRef(H)},Jt.useState=function(H){return ee.current.useState(H)},Jt.useSyncExternalStore=function(H,Q,re){return ee.current.useSyncExternalStore(H,Q,re)},Jt.useTransition=function(){return ee.current.useTransition()},Jt.version="18.3.1",Jt}var nk;function Gs(){return nk||(nk=1,$v.exports=Aq()),$v.exports}var rk;function Rq(){if(rk)return ph;rk=1;var n=Gs(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(l,c,d){var h,p={},x=null,v=null;d!==void 0&&(x=""+d),c.key!==void 0&&(x=""+c.key),c.ref!==void 0&&(v=c.ref);for(h in c)r.call(c,h)&&!a.hasOwnProperty(h)&&(p[h]=c[h]);if(l&&l.defaultProps)for(h in c=l.defaultProps,c)p[h]===void 0&&(p[h]=c[h]);return{$$typeof:e,type:l,key:x,ref:v,props:p,_owner:s.current}}return ph.Fragment=t,ph.jsx=o,ph.jsxs=o,ph}var sk;function r4(){return sk||(sk=1,Wv.exports=Rq()),Wv.exports}var i=r4(),E=Gs();const ot=gu(E),Lq=t4({__proto__:null,default:ot},[E]);var Mp={},Hv={exports:{}},qs={},Yv={exports:{}},Gv={};var ik;function Fq(){return ik||(ik=1,(function(n){function e(X,Z){var oe=X.length;X.push(Z);e:for(;0<oe;){var H=oe-1>>>1,Q=X[H];if(0<s(Q,Z))X[H]=Z,X[oe]=Q,oe=H;else break e}}function t(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var Z=X[0],oe=X.pop();if(oe!==Z){X[0]=oe;e:for(var H=0,Q=X.length,re=Q>>>1;H<re;){var de=2*(H+1)-1,ce=X[de],pe=de+1,ie=X[pe];if(0>s(ce,oe))pe<Q&&0>s(ie,ce)?(X[H]=ie,X[pe]=oe,H=pe):(X[H]=ce,X[de]=oe,H=de);else if(pe<Q&&0>s(ie,oe))X[H]=ie,X[pe]=oe,H=pe;else break e}}return Z}function s(X,Z){var oe=X.sortIndex-Z.sortIndex;return oe!==0?oe:X.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,p=null,x=3,v=!1,w=!1,_=!1,j=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(X){for(var Z=t(d);Z!==null;){if(Z.callback===null)r(d);else if(Z.startTime<=X)r(d),Z.sortIndex=Z.expirationTime,e(c,Z);else break;Z=t(d)}}function M(X){if(_=!1,D(X),!w)if(t(c)!==null)w=!0,J(O);else{var Z=t(d);Z!==null&&ee(M,Z.startTime-X)}}function O(X,Z){w=!1,_&&(_=!1,T(F),F=-1),v=!0;var oe=x;try{for(D(Z),p=t(c);p!==null&&(!(p.expirationTime>Z)||X&&!W());){var H=p.callback;if(typeof H=="function"){p.callback=null,x=p.priorityLevel;var Q=H(p.expirationTime<=Z);Z=n.unstable_now(),typeof Q=="function"?p.callback=Q:p===t(c)&&r(c),D(Z)}else r(c);p=t(c)}if(p!==null)var re=!0;else{var de=t(d);de!==null&&ee(M,de.startTime-Z),re=!1}return re}finally{p=null,x=oe,v=!1}}var I=!1,q=null,F=-1,V=5,U=-1;function W(){return!(n.unstable_now()-U<V)}function $(){if(q!==null){var X=n.unstable_now();U=X;var Z=!0;try{Z=q(!0,X)}finally{Z?ne():(I=!1,q=null)}}else I=!1}var ne;if(typeof P=="function")ne=function(){P($)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ae=Y.port2;Y.port1.onmessage=$,ne=function(){ae.postMessage(null)}}else ne=function(){j($,0)};function J(X){q=X,I||(I=!0,ne())}function ee(X,Z){F=j(function(){X(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_continueExecution=function(){w||v||(w=!0,J(O))},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(X){switch(x){case 1:case 2:case 3:var Z=3;break;default:Z=x}var oe=x;x=Z;try{return X()}finally{x=oe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(X,Z){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var oe=x;x=X;try{return Z()}finally{x=oe}},n.unstable_scheduleCallback=function(X,Z,oe){var H=n.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?H+oe:H):oe=H,X){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=oe+Q,X={id:h++,callback:Z,priorityLevel:X,startTime:oe,expirationTime:Q,sortIndex:-1},oe>H?(X.sortIndex=oe,e(d,X),t(c)===null&&X===t(d)&&(_?(T(F),F=-1):_=!0,ee(M,oe-H))):(X.sortIndex=Q,e(c,X),w||v||(w=!0,J(O))),X},n.unstable_shouldYield=W,n.unstable_wrapCallback=function(X){var Z=x;return function(){var oe=x;x=Z;try{return X.apply(this,arguments)}finally{x=oe}}}})(Gv)),Gv}var ak;function qq(){return ak||(ak=1,Yv.exports=Fq()),Yv.exports}var ok;function zq(){if(ok)return qs;ok=1;var n=Gs(),e=qq();function t(u){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+u,b=1;b<arguments.length;b++)m+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+u+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(u,m){o(u,m),o(u+"Capture",m)}function o(u,m){for(s[u]=m,u=0;u<m.length;u++)r.add(m[u])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function x(u){return c.call(p,u)?!0:c.call(h,u)?!1:d.test(u)?p[u]=!0:(h[u]=!0,!1)}function v(u,m,b,k){if(b!==null&&b.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return k?!1:b!==null?!b.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function w(u,m,b,k){if(m===null||typeof m>"u"||v(u,m,b,k))return!0;if(k)return!1;if(b!==null)switch(b.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function _(u,m,b,k,R,z,G){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=k,this.attributeNamespace=R,this.mustUseProperty=b,this.propertyName=u,this.type=m,this.sanitizeURL=z,this.removeEmptyString=G}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){j[u]=new _(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var m=u[0];j[m]=new _(m,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){j[u]=new _(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){j[u]=new _(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){j[u]=new _(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){j[u]=new _(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){j[u]=new _(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){j[u]=new _(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){j[u]=new _(u,5,!1,u.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function P(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var m=u.replace(T,P);j[m]=new _(m,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var m=u.replace(T,P);j[m]=new _(m,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var m=u.replace(T,P);j[m]=new _(m,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){j[u]=new _(u,1,!1,u.toLowerCase(),null,!1,!1)}),j.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){j[u]=new _(u,1,!1,u.toLowerCase(),null,!0,!0)});function D(u,m,b,k){var R=j.hasOwnProperty(m)?j[m]:null;(R!==null?R.type!==0:k||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(w(m,b,R,k)&&(b=null),k||R===null?x(m)&&(b===null?u.removeAttribute(m):u.setAttribute(m,""+b)):R.mustUseProperty?u[R.propertyName]=b===null?R.type===3?!1:"":b:(m=R.attributeName,k=R.attributeNamespace,b===null?u.removeAttribute(m):(R=R.type,b=R===3||R===4&&b===!0?"":""+b,k?u.setAttributeNS(k,m,b):u.setAttribute(m,b))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),I=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),W=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),ne=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),ee=Symbol.for("react.offscreen"),X=Symbol.iterator;function Z(u){return u===null||typeof u!="object"?null:(u=X&&u[X]||u["@@iterator"],typeof u=="function"?u:null)}var oe=Object.assign,H;function Q(u){if(H===void 0)try{throw Error()}catch(b){var m=b.stack.trim().match(/\n( *(at )?)/);H=m&&m[1]||""}return`
`+H+u}var re=!1;function de(u,m){if(!u||re)return"";re=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(De){var k=De}Reflect.construct(u,[],m)}else{try{m.call()}catch(De){k=De}u.call(m.prototype)}else{try{throw Error()}catch(De){k=De}u()}}catch(De){if(De&&k&&typeof De.stack=="string"){for(var R=De.stack.split(`
`),z=k.stack.split(`
`),G=R.length-1,fe=z.length-1;1<=G&&0<=fe&&R[G]!==z[fe];)fe--;for(;1<=G&&0<=fe;G--,fe--)if(R[G]!==z[fe]){if(G!==1||fe!==1)do if(G--,fe--,0>fe||R[G]!==z[fe]){var me=`
`+R[G].replace(" at new "," at ");return u.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",u.displayName)),me}while(1<=G&&0<=fe);break}}}finally{re=!1,Error.prepareStackTrace=b}return(u=u?u.displayName||u.name:"")?Q(u):""}function ce(u){switch(u.tag){case 5:return Q(u.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return u=de(u.type,!1),u;case 11:return u=de(u.type.render,!1),u;case 1:return u=de(u.type,!0),u;default:return""}}function pe(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case q:return"Fragment";case I:return"Portal";case V:return"Profiler";case F:return"StrictMode";case ne:return"Suspense";case Y:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case W:return(u.displayName||"Context")+".Consumer";case U:return(u._context.displayName||"Context")+".Provider";case $:var m=u.render;return u=u.displayName,u||(u=m.displayName||m.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case ae:return m=u.displayName||null,m!==null?m:pe(u.type)||"Memo";case J:m=u._payload,u=u._init;try{return pe(u(m))}catch{}}return null}function ie(u){var m=u.type;switch(u.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=m.render,u=u.displayName||u.name||"",m.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(m);case 8:return m===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function xe(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function Ce(u){var m=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function ve(u){var m=Ce(u)?"checked":"value",b=Object.getOwnPropertyDescriptor(u.constructor.prototype,m),k=""+u[m];if(!u.hasOwnProperty(m)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var R=b.get,z=b.set;return Object.defineProperty(u,m,{configurable:!0,get:function(){return R.call(this)},set:function(G){k=""+G,z.call(this,G)}}),Object.defineProperty(u,m,{enumerable:b.enumerable}),{getValue:function(){return k},setValue:function(G){k=""+G},stopTracking:function(){u._valueTracker=null,delete u[m]}}}}function Oe(u){u._valueTracker||(u._valueTracker=ve(u))}function Pe(u){if(!u)return!1;var m=u._valueTracker;if(!m)return!0;var b=m.getValue(),k="";return u&&(k=Ce(u)?u.checked?"true":"false":u.value),u=k,u!==b?(m.setValue(u),!0):!1}function Ie(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Fe(u,m){var b=m.checked;return oe({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??u._wrapperState.initialChecked})}function we(u,m){var b=m.defaultValue==null?"":m.defaultValue,k=m.checked!=null?m.checked:m.defaultChecked;b=xe(m.value!=null?m.value:b),u._wrapperState={initialChecked:k,initialValue:b,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function Ne(u,m){m=m.checked,m!=null&&D(u,"checked",m,!1)}function Ue(u,m){Ne(u,m);var b=xe(m.value),k=m.type;if(b!=null)k==="number"?(b===0&&u.value===""||u.value!=b)&&(u.value=""+b):u.value!==""+b&&(u.value=""+b);else if(k==="submit"||k==="reset"){u.removeAttribute("value");return}m.hasOwnProperty("value")?qe(u,m.type,b):m.hasOwnProperty("defaultValue")&&qe(u,m.type,xe(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(u.defaultChecked=!!m.defaultChecked)}function Be(u,m,b){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var k=m.type;if(!(k!=="submit"&&k!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+u._wrapperState.initialValue,b||m===u.value||(u.value=m),u.defaultValue=m}b=u.name,b!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,b!==""&&(u.name=b)}function qe(u,m,b){(m!=="number"||Ie(u.ownerDocument)!==u)&&(b==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+b&&(u.defaultValue=""+b))}var te=Array.isArray;function le(u,m,b,k){if(u=u.options,m){m={};for(var R=0;R<b.length;R++)m["$"+b[R]]=!0;for(b=0;b<u.length;b++)R=m.hasOwnProperty("$"+u[b].value),u[b].selected!==R&&(u[b].selected=R),R&&k&&(u[b].defaultSelected=!0)}else{for(b=""+xe(b),m=null,R=0;R<u.length;R++){if(u[R].value===b){u[R].selected=!0,k&&(u[R].defaultSelected=!0);return}m!==null||u[R].disabled||(m=u[R])}m!==null&&(m.selected=!0)}}function ye(u,m){if(m.dangerouslySetInnerHTML!=null)throw Error(t(91));return oe({},m,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Ve(u,m){var b=m.value;if(b==null){if(b=m.children,m=m.defaultValue,b!=null){if(m!=null)throw Error(t(92));if(te(b)){if(1<b.length)throw Error(t(93));b=b[0]}m=b}m==null&&(m=""),b=m}u._wrapperState={initialValue:xe(b)}}function ze(u,m){var b=xe(m.value),k=xe(m.defaultValue);b!=null&&(b=""+b,b!==u.value&&(u.value=b),m.defaultValue==null&&u.defaultValue!==b&&(u.defaultValue=b)),k!=null&&(u.defaultValue=""+k)}function Le(u){var m=u.textContent;m===u._wrapperState.initialValue&&m!==""&&m!==null&&(u.value=m)}function rt(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xe(u,m){return u==null||u==="http://www.w3.org/1999/xhtml"?rt(m):u==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var tt,qt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,b,k,R){MSApp.execUnsafeLocalFunction(function(){return u(m,b,k,R)})}:u})(function(u,m){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=m;else{for(tt=tt||document.createElement("div"),tt.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=tt.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;m.firstChild;)u.appendChild(m.firstChild)}});function bt(u,m){if(m){var b=u.firstChild;if(b&&b===u.lastChild&&b.nodeType===3){b.nodeValue=m;return}}u.textContent=m}var Et={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xt=["Webkit","ms","Moz","O"];Object.keys(Et).forEach(function(u){Xt.forEach(function(m){m=m+u.charAt(0).toUpperCase()+u.substring(1),Et[m]=Et[u]})});function en(u,m,b){return m==null||typeof m=="boolean"||m===""?"":b||typeof m!="number"||m===0||Et.hasOwnProperty(u)&&Et[u]?(""+m).trim():m+"px"}function Yt(u,m){u=u.style;for(var b in m)if(m.hasOwnProperty(b)){var k=b.indexOf("--")===0,R=en(b,m[b],k);b==="float"&&(b="cssFloat"),k?u.setProperty(b,R):u[b]=R}}var Ut=oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rn(u,m){if(m){if(Ut[u]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(t(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(t(61))}if(m.style!=null&&typeof m.style!="object")throw Error(t(62))}}function Nn(u,m){if(u.indexOf("-")===-1)return typeof m.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var an=null;function rr(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Hn=null,lt=null,Vn=null;function br(u){if(u=tl(u)){if(typeof Hn!="function")throw Error(t(280));var m=u.stateNode;m&&(m=Tu(m),Hn(u.stateNode,u.type,m))}}function vn(u){lt?Vn?Vn.push(u):Vn=[u]:lt=u}function us(){if(lt){var u=lt,m=Vn;if(Vn=lt=null,br(u),m)for(u=0;u<m.length;u++)br(m[u])}}function Ks(u,m){return u(m)}function Gr(){}var Xi=!1;function La(u,m,b){if(Xi)return u(m,b);Xi=!0;try{return Ks(u,m,b)}finally{Xi=!1,(lt!==null||Vn!==null)&&(Gr(),us())}}function ea(u,m){var b=u.stateNode;if(b===null)return null;var k=Tu(b);if(k===null)return null;b=k[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(u=u.type,k=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!k;break e;default:u=!1}if(u)return null;if(b&&typeof b!="function")throw Error(t(231,m,typeof b));return b}var Po=!1;if(l)try{var ta={};Object.defineProperty(ta,"passive",{get:function(){Po=!0}}),window.addEventListener("test",ta,ta),window.removeEventListener("test",ta,ta)}catch{Po=!1}function cd(u,m,b,k,R,z,G,fe,me){var De=Array.prototype.slice.call(arguments,3);try{m.apply(b,De)}catch(Ge){this.onError(Ge)}}var dr=!1,dt=null,na=!1,Fa=null,Ol={onError:function(u){dr=!0,dt=u}};function Il(u,m,b,k,R,z,G,fe,me){dr=!1,dt=null,cd.apply(Ol,arguments)}function Mo(u,m,b,k,R,z,G,fe,me){if(Il.apply(this,arguments),dr){if(dr){var De=dt;dr=!1,dt=null}else throw Error(t(198));na||(na=!0,Fa=De)}}function ks(u){var m=u,b=u;if(u.alternate)for(;m.return;)m=m.return;else{u=m;do m=u,(m.flags&4098)!==0&&(b=m.return),u=m.return;while(u)}return m.tag===3?b:null}function Js(u){if(u.tag===13){var m=u.memoizedState;if(m===null&&(u=u.alternate,u!==null&&(m=u.memoizedState)),m!==null)return m.dehydrated}return null}function Eo(u){if(ks(u)!==u)throw Error(t(188))}function dd(u){var m=u.alternate;if(!m){if(m=ks(u),m===null)throw Error(t(188));return m!==u?null:u}for(var b=u,k=m;;){var R=b.return;if(R===null)break;var z=R.alternate;if(z===null){if(k=R.return,k!==null){b=k;continue}break}if(R.child===z.child){for(z=R.child;z;){if(z===b)return Eo(R),u;if(z===k)return Eo(R),m;z=z.sibling}throw Error(t(188))}if(b.return!==k.return)b=R,k=z;else{for(var G=!1,fe=R.child;fe;){if(fe===b){G=!0,b=R,k=z;break}if(fe===k){G=!0,k=R,b=z;break}fe=fe.sibling}if(!G){for(fe=z.child;fe;){if(fe===b){G=!0,b=z,k=R;break}if(fe===k){G=!0,k=z,b=R;break}fe=fe.sibling}if(!G)throw Error(t(189))}}if(b.alternate!==k)throw Error(t(190))}if(b.tag!==3)throw Error(t(188));return b.stateNode.current===b?u:m}function Al(u){return u=dd(u),u!==null?Rl(u):null}function Rl(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var m=Rl(u);if(m!==null)return m;u=u.sibling}return null}var Ll=e.unstable_scheduleCallback,Do=e.unstable_cancelCallback,ud=e.unstable_shouldYield,qa=e.unstable_requestPaint,Cn=e.unstable_now,fd=e.unstable_getCurrentPriorityLevel,Oo=e.unstable_ImmediatePriority,Fl=e.unstable_UserBlockingPriority,za=e.unstable_NormalPriority,Io=e.unstable_LowPriority,bi=e.unstable_IdlePriority,ra=null,Rr=null;function sa(u){if(Rr&&typeof Rr.onCommitFiberRoot=="function")try{Rr.onCommitFiberRoot(ra,u,void 0,(u.current.flags&128)===128)}catch{}}var Dt=Math.clz32?Math.clz32:wi,bn=Math.log,Ua=Math.LN2;function wi(u){return u>>>=0,u===0?32:31-(bn(u)/Ua|0)|0}var fs=64,_i=4194304;function Mt(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function gn(u,m){var b=u.pendingLanes;if(b===0)return 0;var k=0,R=u.suspendedLanes,z=u.pingedLanes,G=b&268435455;if(G!==0){var fe=G&~R;fe!==0?k=Mt(fe):(z&=G,z!==0&&(k=Mt(z)))}else G=b&~R,G!==0?k=Mt(G):z!==0&&(k=Mt(z));if(k===0)return 0;if(m!==0&&m!==k&&(m&R)===0&&(R=k&-k,z=m&-m,R>=z||R===16&&(z&4194240)!==0))return m;if((k&4)!==0&&(k|=b&16),m=u.entangledLanes,m!==0)for(u=u.entanglements,m&=k;0<m;)b=31-Dt(m),R=1<<b,k|=u[b],m&=~R;return k}function Ao(u,m){switch(u){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Va(u,m){for(var b=u.suspendedLanes,k=u.pingedLanes,R=u.expirationTimes,z=u.pendingLanes;0<z;){var G=31-Dt(z),fe=1<<G,me=R[G];me===-1?((fe&b)===0||(fe&k)!==0)&&(R[G]=Ao(fe,m)):me<=m&&(u.expiredLanes|=fe),z&=~fe}}function ur(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function ql(){var u=fs;return fs<<=1,(fs&4194240)===0&&(fs=64),u}function ji(u){for(var m=[],b=0;31>b;b++)m.push(u);return m}function Lr(u,m,b){u.pendingLanes|=m,m!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,m=31-Dt(m),u[m]=b}function Dn(u,m){var b=u.pendingLanes&~m;u.pendingLanes=m,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=m,u.mutableReadLanes&=m,u.entangledLanes&=m,m=u.entanglements;var k=u.eventTimes;for(u=u.expirationTimes;0<b;){var R=31-Dt(b),z=1<<R;m[R]=0,k[R]=-1,u[R]=-1,b&=~z}}function hs(u,m){var b=u.entangledLanes|=m;for(u=u.entanglements;b;){var k=31-Dt(b),R=1<<k;R&m|u[k]&m&&(u[k]|=m),b&=~R}}var Kt=0;function Ni(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Ba,Qs,Wa,$a,ia,aa=!1,Si=[],Fr=null,ms=null,Zr=null,oa=new Map,Ct=new Map,Yn=[],ln="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ro(u,m){switch(u){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":ms=null;break;case"mouseover":case"mouseout":Zr=null;break;case"pointerover":case"pointerout":oa.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ct.delete(m.pointerId)}}function Xs(u,m,b,k,R,z){return u===null||u.nativeEvent!==z?(u={blockedOn:m,domEventName:b,eventSystemFlags:k,nativeEvent:z,targetContainers:[R]},m!==null&&(m=tl(m),m!==null&&Qs(m)),u):(u.eventSystemFlags|=k,m=u.targetContainers,R!==null&&m.indexOf(R)===-1&&m.push(R),u)}function Lo(u,m,b,k,R){switch(m){case"focusin":return Fr=Xs(Fr,u,m,b,k,R),!0;case"dragenter":return ms=Xs(ms,u,m,b,k,R),!0;case"mouseover":return Zr=Xs(Zr,u,m,b,k,R),!0;case"pointerover":var z=R.pointerId;return oa.set(z,Xs(oa.get(z)||null,u,m,b,k,R)),!0;case"gotpointercapture":return z=R.pointerId,Ct.set(z,Xs(Ct.get(z)||null,u,m,b,k,R)),!0}return!1}function Ha(u){var m=el(u.target);if(m!==null){var b=ks(m);if(b!==null){if(m=b.tag,m===13){if(m=Js(b),m!==null){u.blockedOn=m,ia(u.priority,function(){Wa(b)});return}}else if(m===3&&b.stateNode.current.memoizedState.isDehydrated){u.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Kr(u){if(u.blockedOn!==null)return!1;for(var m=u.targetContainers;0<m.length;){var b=Za(u.domEventName,u.eventSystemFlags,m[0],u.nativeEvent);if(b===null){b=u.nativeEvent;var k=new b.constructor(b.type,b);an=k,b.target.dispatchEvent(k),an=null}else return m=tl(b),m!==null&&Qs(m),u.blockedOn=b,!1;m.shift()}return!0}function Ya(u,m,b){Kr(u)&&b.delete(m)}function la(){aa=!1,Fr!==null&&Kr(Fr)&&(Fr=null),ms!==null&&Kr(ms)&&(ms=null),Zr!==null&&Kr(Zr)&&(Zr=null),oa.forEach(Ya),Ct.forEach(Ya)}function Tn(u,m){u.blockedOn===m&&(u.blockedOn=null,aa||(aa=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,la)))}function qr(u){function m(R){return Tn(R,u)}if(0<Si.length){Tn(Si[0],u);for(var b=1;b<Si.length;b++){var k=Si[b];k.blockedOn===u&&(k.blockedOn=null)}}for(Fr!==null&&Tn(Fr,u),ms!==null&&Tn(ms,u),Zr!==null&&Tn(Zr,u),oa.forEach(m),Ct.forEach(m),b=0;b<Yn.length;b++)k=Yn[b],k.blockedOn===u&&(k.blockedOn=null);for(;0<Yn.length&&(b=Yn[0],b.blockedOn===null);)Ha(b),b.blockedOn===null&&Yn.shift()}var ei=M.ReactCurrentBatchConfig,ca=!0;function hd(u,m,b,k){var R=Kt,z=ei.transition;ei.transition=null;try{Kt=1,da(u,m,b,k)}finally{Kt=R,ei.transition=z}}function zl(u,m,b,k){var R=Kt,z=ei.transition;ei.transition=null;try{Kt=4,da(u,m,b,k)}finally{Kt=R,ei.transition=z}}function da(u,m,b,k){if(ca){var R=Za(u,m,b,k);if(R===null)f(u,m,k,Ga,b),Ro(u,k);else if(Lo(R,u,m,b,k))k.stopPropagation();else if(Ro(u,k),m&4&&-1<ln.indexOf(u)){for(;R!==null;){var z=tl(R);if(z!==null&&Ba(z),z=Za(u,m,b,k),z===null&&f(u,m,k,Ga,b),z===R)break;R=z}R!==null&&k.stopPropagation()}else f(u,m,k,null,b)}}var Ga=null;function Za(u,m,b,k){if(Ga=null,u=rr(k),u=el(u),u!==null)if(m=ks(u),m===null)u=null;else if(b=m.tag,b===13){if(u=Js(m),u!==null)return u;u=null}else if(b===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;u=null}else m!==u&&(u=null);return Ga=u,null}function Ht(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fd()){case Oo:return 1;case Fl:return 4;case za:case Io:return 16;case bi:return 536870912;default:return 16}default:return 16}}var Ps=null,wr=null,Ms=null;function Fo(){if(Ms)return Ms;var u,m=wr,b=m.length,k,R="value"in Ps?Ps.value:Ps.textContent,z=R.length;for(u=0;u<b&&m[u]===R[u];u++);var G=b-u;for(k=1;k<=G&&m[b-k]===R[z-k];k++);return Ms=R.slice(u,1<k?1-k:void 0)}function Ka(u){var m=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&m===13&&(u=13)):u=m,u===10&&(u=13),32<=u||u===13?u:0}function Ci(){return!0}function Ul(){return!1}function fr(u){function m(b,k,R,z,G){this._reactName=b,this._targetInst=R,this.type=k,this.nativeEvent=z,this.target=G,this.currentTarget=null;for(var fe in u)u.hasOwnProperty(fe)&&(b=u[fe],this[fe]=b?b(z):z[fe]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?Ci:Ul,this.isPropagationStopped=Ul,this}return oe(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=Ci)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=Ci)},persist:function(){},isPersistent:Ci}),m}var Ti={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qo=fr(Ti),ti=oe({},Ti,{view:0,detail:0}),md=fr(ti),Mr,zo,ki,zr=oe({},ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ri,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==ki&&(ki&&u.type==="mousemove"?(Mr=u.screenX-ki.screenX,zo=u.screenY-ki.screenY):zo=Mr=0,ki=u),Mr)},movementY:function(u){return"movementY"in u?u.movementY:zo}}),Uo=fr(zr),Vl=oe({},zr,{dataTransfer:0}),Vo=fr(Vl),pd=oe({},ti,{relatedTarget:0}),Ja=fr(pd),Bl=oe({},Ti,{animationName:0,elapsedTime:0,pseudoElement:0}),gd=fr(Bl),xd=oe({},Ti,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),Bo=fr(xd),yd=oe({},Ti,{data:0}),Wo=fr(yd),Wl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ni={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vd(u){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(u):(u=ni[u])?!!m[u]:!1}function ri(){return vd}var Er=oe({},ti,{key:function(u){if(u.key){var m=Wl[u.key]||u.key;if(m!=="Unidentified")return m}return u.type==="keypress"?(u=Ka(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?Qa[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ri,charCode:function(u){return u.type==="keypress"?Ka(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Ka(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),$l=fr(Er),Hl=oe({},zr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yl=fr(Hl),$o=oe({},ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ri}),Ho=fr($o),bd=oe({},Ti,{propertyName:0,elapsedTime:0,pseudoElement:0}),wd=fr(bd),Gl=oe({},zr,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),_d=fr(Gl),Ur=[9,13,27,32],Es=l&&"CompositionEvent"in window,ua=null;l&&"documentMode"in document&&(ua=document.documentMode);var ps=l&&"TextEvent"in window&&!ua,Zl=l&&(!Es||ua&&8<ua&&11>=ua),si=" ",Kl=!1;function Pi(u,m){switch(u){case"keyup":return Ur.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yo(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var gs=!1;function jd(u,m){switch(u){case"compositionend":return Yo(m);case"keypress":return m.which!==32?null:(Kl=!0,si);case"textInput":return u=m.data,u===si&&Kl?null:u;default:return null}}function Ds(u,m){if(gs)return u==="compositionend"||!Es&&Pi(u,m)?(u=Fo(),Ms=wr=Ps=null,gs=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Zl&&m.locale!=="ko"?null:m.data;default:return null}}var Xa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jl(u){var m=u&&u.nodeName&&u.nodeName.toLowerCase();return m==="input"?!!Xa[u.type]:m==="textarea"}function eo(u,m,b,k){vn(k),m=C(m,"onChange"),0<m.length&&(b=new qo("onChange","change",null,b,k),u.push({event:b,listeners:m}))}var fa=null,_r=null;function Nd(u){Qf(u,0)}function xs(u){var m=nl(u);if(Pe(m))return u}function Sd(u,m){if(u==="change")return m}var Jr=!1;if(l){var Mi;if(l){var to="oninput"in document;if(!to){var no=document.createElement("div");no.setAttribute("oninput","return;"),to=typeof no.oninput=="function"}Mi=to}else Mi=!1;Jr=Mi&&(!document.documentMode||9<document.documentMode)}function ha(){fa&&(fa.detachEvent("onpropertychange",ro),_r=fa=null)}function ro(u){if(u.propertyName==="value"&&xs(_r)){var m=[];eo(m,_r,u,rr(u)),La(Nd,m)}}function so(u,m,b){u==="focusin"?(ha(),fa=m,_r=b,fa.attachEvent("onpropertychange",ro)):u==="focusout"&&ha()}function Ei(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return xs(_r)}function io(u,m){if(u==="click")return xs(m)}function Go(u,m){if(u==="input"||u==="change")return xs(m)}function Ql(u,m){return u===m&&(u!==0||1/u===1/m)||u!==u&&m!==m}var Vr=typeof Object.is=="function"?Object.is:Ql;function Os(u,m){if(Vr(u,m))return!0;if(typeof u!="object"||u===null||typeof m!="object"||m===null)return!1;var b=Object.keys(u),k=Object.keys(m);if(b.length!==k.length)return!1;for(k=0;k<b.length;k++){var R=b[k];if(!c.call(m,R)||!Vr(u[R],m[R]))return!1}return!0}function Xl(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function Zo(u,m){var b=Xl(u);u=0;for(var k;b;){if(b.nodeType===3){if(k=u+b.textContent.length,u<=m&&k>=m)return{node:b,offset:m-u};u=k}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=Xl(b)}}function ec(u,m){return u&&m?u===m?!0:u&&u.nodeType===3?!1:m&&m.nodeType===3?ec(u,m.parentNode):"contains"in u?u.contains(m):u.compareDocumentPosition?!!(u.compareDocumentPosition(m)&16):!1:!1}function Ko(){for(var u=window,m=Ie();m instanceof u.HTMLIFrameElement;){try{var b=typeof m.contentWindow.location.href=="string"}catch{b=!1}if(b)u=m.contentWindow;else break;m=Ie(u.document)}return m}function Jo(u){var m=u&&u.nodeName&&u.nodeName.toLowerCase();return m&&(m==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||m==="textarea"||u.contentEditable==="true")}function g(u){var m=Ko(),b=u.focusedElem,k=u.selectionRange;if(m!==b&&b&&b.ownerDocument&&ec(b.ownerDocument.documentElement,b)){if(k!==null&&Jo(b)){if(m=k.start,u=k.end,u===void 0&&(u=m),"selectionStart"in b)b.selectionStart=m,b.selectionEnd=Math.min(u,b.value.length);else if(u=(m=b.ownerDocument||document)&&m.defaultView||window,u.getSelection){u=u.getSelection();var R=b.textContent.length,z=Math.min(k.start,R);k=k.end===void 0?z:Math.min(k.end,R),!u.extend&&z>k&&(R=k,k=z,z=R),R=Zo(b,z);var G=Zo(b,k);R&&G&&(u.rangeCount!==1||u.anchorNode!==R.node||u.anchorOffset!==R.offset||u.focusNode!==G.node||u.focusOffset!==G.offset)&&(m=m.createRange(),m.setStart(R.node,R.offset),u.removeAllRanges(),z>k?(u.addRange(m),u.extend(G.node,G.offset)):(m.setEnd(G.node,G.offset),u.addRange(m)))}}for(m=[],u=b;u=u.parentNode;)u.nodeType===1&&m.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<m.length;b++)u=m[b],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var Nu=l&&"documentMode"in document&&11>=document.documentMode,tc=null,nc=null,Cd=null,Su=!1;function qm(u,m,b){var k=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;Su||tc==null||tc!==Ie(k)||(k=tc,"selectionStart"in k&&Jo(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),Cd&&Os(Cd,k)||(Cd=k,k=C(nc,"onSelect"),0<k.length&&(m=new qo("onSelect","select",null,m,b),u.push({event:m,listeners:k}),m.target=tc)))}function ao(u,m){var b={};return b[u.toLowerCase()]=m.toLowerCase(),b["Webkit"+u]="webkit"+m,b["Moz"+u]="moz"+m,b}var rc={animationend:ao("Animation","AnimationEnd"),animationiteration:ao("Animation","AnimationIteration"),animationstart:ao("Animation","AnimationStart"),transitionend:ao("Transition","TransitionEnd")},oo={},Gf={};l&&(Gf=document.createElement("div").style,"AnimationEvent"in window||(delete rc.animationend.animation,delete rc.animationiteration.animation,delete rc.animationstart.animation),"TransitionEvent"in window||delete rc.transitionend.transition);function Td(u){if(oo[u])return oo[u];if(!rc[u])return u;var m=rc[u],b;for(b in m)if(m.hasOwnProperty(b)&&b in Gf)return oo[u]=m[b];return u}var zm=Td("animationend"),Di=Td("animationiteration"),Zf=Td("animationstart"),Kf=Td("transitionend"),sc=new Map,Um="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ii(u,m){sc.set(u,m),a(m,[u])}for(var Qo=0;Qo<Um.length;Qo++){var Cu=Um[Qo],Vm=Cu.toLowerCase(),Fy=Cu[0].toUpperCase()+Cu.slice(1);ii(Vm,"on"+Fy)}ii(zm,"onAnimationEnd"),ii(Di,"onAnimationIteration"),ii(Zf,"onAnimationStart"),ii("dblclick","onDoubleClick"),ii("focusin","onFocus"),ii("focusout","onBlur"),ii(Kf,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ic="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bm=new Set("cancel close invalid load scroll toggle".split(" ").concat(ic));function Jf(u,m,b){var k=u.type||"unknown-event";u.currentTarget=b,Mo(k,m,void 0,u),u.currentTarget=null}function Qf(u,m){m=(m&4)!==0;for(var b=0;b<u.length;b++){var k=u[b],R=k.event;k=k.listeners;e:{var z=void 0;if(m)for(var G=k.length-1;0<=G;G--){var fe=k[G],me=fe.instance,De=fe.currentTarget;if(fe=fe.listener,me!==z&&R.isPropagationStopped())break e;Jf(R,fe,De),z=me}else for(G=0;G<k.length;G++){if(fe=k[G],me=fe.instance,De=fe.currentTarget,fe=fe.listener,me!==z&&R.isPropagationStopped())break e;Jf(R,fe,De),z=me}}}if(na)throw u=Fa,na=!1,Fa=null,u}function Sn(u,m){var b=m[cc];b===void 0&&(b=m[cc]=new Set);var k=u+"__bubble";b.has(k)||(Wm(m,u,2,!1),b.add(k))}function Xf(u,m,b){var k=0;m&&(k|=4),Wm(b,u,k,m)}var kd="_reactListening"+Math.random().toString(36).slice(2);function ac(u){if(!u[kd]){u[kd]=!0,r.forEach(function(b){b!=="selectionchange"&&(Bm.has(b)||Xf(b,!1,u),Xf(b,!0,u))});var m=u.nodeType===9?u:u.ownerDocument;m===null||m[kd]||(m[kd]=!0,Xf("selectionchange",!1,m))}}function Wm(u,m,b,k){switch(Ht(m)){case 1:var R=hd;break;case 4:R=zl;break;default:R=da}b=R.bind(null,m,b,u),R=void 0,!Po||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(R=!0),k?R!==void 0?u.addEventListener(m,b,{capture:!0,passive:R}):u.addEventListener(m,b,!0):R!==void 0?u.addEventListener(m,b,{passive:R}):u.addEventListener(m,b,!1)}function f(u,m,b,k,R){var z=k;if((m&1)===0&&(m&2)===0&&k!==null)e:for(;;){if(k===null)return;var G=k.tag;if(G===3||G===4){var fe=k.stateNode.containerInfo;if(fe===R||fe.nodeType===8&&fe.parentNode===R)break;if(G===4)for(G=k.return;G!==null;){var me=G.tag;if((me===3||me===4)&&(me=G.stateNode.containerInfo,me===R||me.nodeType===8&&me.parentNode===R))return;G=G.return}for(;fe!==null;){if(G=el(fe),G===null)return;if(me=G.tag,me===5||me===6){k=z=G;continue e}fe=fe.parentNode}}k=k.return}La(function(){var De=z,Ge=rr(b),Ze=[];e:{var Ye=sc.get(u);if(Ye!==void 0){var at=qo,ut=u;switch(u){case"keypress":if(Ka(b)===0)break e;case"keydown":case"keyup":at=$l;break;case"focusin":ut="focus",at=Ja;break;case"focusout":ut="blur",at=Ja;break;case"beforeblur":case"afterblur":at=Ja;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=Uo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=Vo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=Ho;break;case zm:case Di:case Zf:at=gd;break;case Kf:at=wd;break;case"scroll":at=md;break;case"wheel":at=_d;break;case"copy":case"cut":case"paste":at=Bo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=Yl}var mt=(m&4)!==0,sr=!mt&&u==="scroll",Te=mt?Ye!==null?Ye+"Capture":null:Ye;mt=[];for(var be=De,ke;be!==null;){ke=be;var Je=ke.stateNode;if(ke.tag===5&&Je!==null&&(ke=Je,Te!==null&&(Je=ea(be,Te),Je!=null&&mt.push(y(be,Je,ke)))),sr)break;be=be.return}0<mt.length&&(Ye=new at(Ye,ut,null,b,Ge),Ze.push({event:Ye,listeners:mt}))}}if((m&7)===0){e:{if(Ye=u==="mouseover"||u==="pointerover",at=u==="mouseout"||u==="pointerout",Ye&&b!==an&&(ut=b.relatedTarget||b.fromElement)&&(el(ut)||ut[xn]))break e;if((at||Ye)&&(Ye=Ge.window===Ge?Ge:(Ye=Ge.ownerDocument)?Ye.defaultView||Ye.parentWindow:window,at?(ut=b.relatedTarget||b.toElement,at=De,ut=ut?el(ut):null,ut!==null&&(sr=ks(ut),ut!==sr||ut.tag!==5&&ut.tag!==6)&&(ut=null)):(at=null,ut=De),at!==ut)){if(mt=Uo,Je="onMouseLeave",Te="onMouseEnter",be="mouse",(u==="pointerout"||u==="pointerover")&&(mt=Yl,Je="onPointerLeave",Te="onPointerEnter",be="pointer"),sr=at==null?Ye:nl(at),ke=ut==null?Ye:nl(ut),Ye=new mt(Je,be+"leave",at,b,Ge),Ye.target=sr,Ye.relatedTarget=ke,Je=null,el(Ge)===De&&(mt=new mt(Te,be+"enter",ut,b,Ge),mt.target=ke,mt.relatedTarget=sr,Je=mt),sr=Je,at&&ut)t:{for(mt=at,Te=ut,be=0,ke=mt;ke;ke=A(ke))be++;for(ke=0,Je=Te;Je;Je=A(Je))ke++;for(;0<be-ke;)mt=A(mt),be--;for(;0<ke-be;)Te=A(Te),ke--;for(;be--;){if(mt===Te||Te!==null&&mt===Te.alternate)break t;mt=A(mt),Te=A(Te)}mt=null}else mt=null;at!==null&&B(Ze,Ye,at,mt,!1),ut!==null&&sr!==null&&B(Ze,sr,ut,mt,!0)}}e:{if(Ye=De?nl(De):window,at=Ye.nodeName&&Ye.nodeName.toLowerCase(),at==="select"||at==="input"&&Ye.type==="file")var pt=Sd;else if(Jl(Ye))if(Jr)pt=Go;else{pt=Ei;var Tt=so}else(at=Ye.nodeName)&&at.toLowerCase()==="input"&&(Ye.type==="checkbox"||Ye.type==="radio")&&(pt=io);if(pt&&(pt=pt(u,De))){eo(Ze,pt,b,Ge);break e}Tt&&Tt(u,Ye,De),u==="focusout"&&(Tt=Ye._wrapperState)&&Tt.controlled&&Ye.type==="number"&&qe(Ye,"number",Ye.value)}switch(Tt=De?nl(De):window,u){case"focusin":(Jl(Tt)||Tt.contentEditable==="true")&&(tc=Tt,nc=De,Cd=null);break;case"focusout":Cd=nc=tc=null;break;case"mousedown":Su=!0;break;case"contextmenu":case"mouseup":case"dragend":Su=!1,qm(Ze,b,Ge);break;case"selectionchange":if(Nu)break;case"keydown":case"keyup":qm(Ze,b,Ge)}var kt;if(Es)e:{switch(u){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else gs?Pi(u,b)&&(At="onCompositionEnd"):u==="keydown"&&b.keyCode===229&&(At="onCompositionStart");At&&(Zl&&b.locale!=="ko"&&(gs||At!=="onCompositionStart"?At==="onCompositionEnd"&&gs&&(kt=Fo()):(Ps=Ge,wr="value"in Ps?Ps.value:Ps.textContent,gs=!0)),Tt=C(De,At),0<Tt.length&&(At=new Wo(At,u,null,b,Ge),Ze.push({event:At,listeners:Tt}),kt?At.data=kt:(kt=Yo(b),kt!==null&&(At.data=kt)))),(kt=ps?jd(u,b):Ds(u,b))&&(De=C(De,"onBeforeInput"),0<De.length&&(Ge=new Wo("onBeforeInput","beforeinput",null,b,Ge),Ze.push({event:Ge,listeners:De}),Ge.data=kt))}Qf(Ze,m)})}function y(u,m,b){return{instance:u,listener:m,currentTarget:b}}function C(u,m){for(var b=m+"Capture",k=[];u!==null;){var R=u,z=R.stateNode;R.tag===5&&z!==null&&(R=z,z=ea(u,b),z!=null&&k.unshift(y(u,z,R)),z=ea(u,m),z!=null&&k.push(y(u,z,R))),u=u.return}return k}function A(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function B(u,m,b,k,R){for(var z=m._reactName,G=[];b!==null&&b!==k;){var fe=b,me=fe.alternate,De=fe.stateNode;if(me!==null&&me===k)break;fe.tag===5&&De!==null&&(fe=De,R?(me=ea(b,z),me!=null&&G.unshift(y(b,me,fe))):R||(me=ea(b,z),me!=null&&G.push(y(b,me,fe)))),b=b.return}G.length!==0&&u.push({event:m,listeners:G})}var K=/\r\n?/g,he=/\u0000|\uFFFD/g;function Se(u){return(typeof u=="string"?u:""+u).replace(K,`
`).replace(he,"")}function Ee(u,m,b){if(m=Se(m),Se(u)!==m&&b)throw Error(t(425))}function We(){}var st=null,Nt=null;function $t(u,m){return u==="textarea"||u==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var jr=typeof setTimeout=="function"?setTimeout:void 0,hr=typeof clearTimeout=="function"?clearTimeout:void 0,ys=typeof Promise=="function"?Promise:void 0,Qr=typeof queueMicrotask=="function"?queueMicrotask:typeof ys<"u"?function(u){return ys.resolve(null).then(u).catch(oc)}:jr;function oc(u){setTimeout(function(){throw u})}function eh(u,m){var b=m,k=0;do{var R=b.nextSibling;if(u.removeChild(b),R&&R.nodeType===8)if(b=R.data,b==="/$"){if(k===0){u.removeChild(R),qr(m);return}k--}else b!=="$"&&b!=="$?"&&b!=="$!"||k++;b=R}while(b);qr(m)}function lo(u){for(;u!=null;u=u.nextSibling){var m=u.nodeType;if(m===1||m===3)break;if(m===8){if(m=u.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return u}function $m(u){u=u.previousSibling;for(var m=0;u;){if(u.nodeType===8){var b=u.data;if(b==="$"||b==="$!"||b==="$?"){if(m===0)return u;m--}else b==="/$"&&m++}u=u.previousSibling}return null}var Xo=Math.random().toString(36).slice(2),Oi="__reactFiber$"+Xo,lc="__reactProps$"+Xo,xn="__reactContainer$"+Xo,cc="__reactEvents$"+Xo,qy="__reactListeners$"+Xo,zy="__reactHandles$"+Xo;function el(u){var m=u[Oi];if(m)return m;for(var b=u.parentNode;b;){if(m=b[xn]||b[Oi]){if(b=m.alternate,m.child!==null||b!==null&&b.child!==null)for(u=$m(u);u!==null;){if(b=u[Oi])return b;u=$m(u)}return m}u=b,b=u.parentNode}return null}function tl(u){return u=u[Oi]||u[xn],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function nl(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function Tu(u){return u[lc]||null}var Uy=[],ku=-1;function dc(u){return{current:u}}function Ln(u){0>ku||(u.current=Uy[ku],Uy[ku]=null,ku--)}function On(u,m){ku++,Uy[ku]=u.current,u.current=m}var uc={},Xr=dc(uc),Is=dc(!1),Pd=uc;function Pu(u,m){var b=u.type.contextTypes;if(!b)return uc;var k=u.stateNode;if(k&&k.__reactInternalMemoizedUnmaskedChildContext===m)return k.__reactInternalMemoizedMaskedChildContext;var R={},z;for(z in b)R[z]=m[z];return k&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=m,u.__reactInternalMemoizedMaskedChildContext=R),R}function As(u){return u=u.childContextTypes,u!=null}function Hm(){Ln(Is),Ln(Xr)}function j1(u,m,b){if(Xr.current!==uc)throw Error(t(168));On(Xr,m),On(Is,b)}function N1(u,m,b){var k=u.stateNode;if(m=m.childContextTypes,typeof k.getChildContext!="function")return b;k=k.getChildContext();for(var R in k)if(!(R in m))throw Error(t(108,ie(u)||"Unknown",R));return oe({},b,k)}function Ym(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||uc,Pd=Xr.current,On(Xr,u),On(Is,Is.current),!0}function S1(u,m,b){var k=u.stateNode;if(!k)throw Error(t(169));b?(u=N1(u,m,Pd),k.__reactInternalMemoizedMergedChildContext=u,Ln(Is),Ln(Xr),On(Xr,u)):Ln(Is),On(Is,b)}var rl=null,Gm=!1,Vy=!1;function C1(u){rl===null?rl=[u]:rl.push(u)}function eq(u){Gm=!0,C1(u)}function fc(){if(!Vy&&rl!==null){Vy=!0;var u=0,m=Kt;try{var b=rl;for(Kt=1;u<b.length;u++){var k=b[u];do k=k(!0);while(k!==null)}rl=null,Gm=!1}catch(R){throw rl!==null&&(rl=rl.slice(u+1)),Ll(Oo,fc),R}finally{Kt=m,Vy=!1}}return null}var Mu=[],Eu=0,Zm=null,Km=0,Ii=[],Ai=0,Md=null,sl=1,il="";function Ed(u,m){Mu[Eu++]=Km,Mu[Eu++]=Zm,Zm=u,Km=m}function T1(u,m,b){Ii[Ai++]=sl,Ii[Ai++]=il,Ii[Ai++]=Md,Md=u;var k=sl;u=il;var R=32-Dt(k)-1;k&=~(1<<R),b+=1;var z=32-Dt(m)+R;if(30<z){var G=R-R%5;z=(k&(1<<G)-1).toString(32),k>>=G,R-=G,sl=1<<32-Dt(m)+R|b<<R|k,il=z+u}else sl=1<<z|b<<R|k,il=u}function By(u){u.return!==null&&(Ed(u,1),T1(u,1,0))}function Wy(u){for(;u===Zm;)Zm=Mu[--Eu],Mu[Eu]=null,Km=Mu[--Eu],Mu[Eu]=null;for(;u===Md;)Md=Ii[--Ai],Ii[Ai]=null,il=Ii[--Ai],Ii[Ai]=null,sl=Ii[--Ai],Ii[Ai]=null}var ai=null,oi=null,Bn=!1,ma=null;function k1(u,m){var b=qi(5,null,null,0);b.elementType="DELETED",b.stateNode=m,b.return=u,m=u.deletions,m===null?(u.deletions=[b],u.flags|=16):m.push(b)}function P1(u,m){switch(u.tag){case 5:var b=u.type;return m=m.nodeType!==1||b.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(u.stateNode=m,ai=u,oi=lo(m.firstChild),!0):!1;case 6:return m=u.pendingProps===""||m.nodeType!==3?null:m,m!==null?(u.stateNode=m,ai=u,oi=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(b=Md!==null?{id:sl,overflow:il}:null,u.memoizedState={dehydrated:m,treeContext:b,retryLane:1073741824},b=qi(18,null,null,0),b.stateNode=m,b.return=u,u.child=b,ai=u,oi=null,!0):!1;default:return!1}}function $y(u){return(u.mode&1)!==0&&(u.flags&128)===0}function Hy(u){if(Bn){var m=oi;if(m){var b=m;if(!P1(u,m)){if($y(u))throw Error(t(418));m=lo(b.nextSibling);var k=ai;m&&P1(u,m)?k1(k,b):(u.flags=u.flags&-4097|2,Bn=!1,ai=u)}}else{if($y(u))throw Error(t(418));u.flags=u.flags&-4097|2,Bn=!1,ai=u}}}function M1(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;ai=u}function Jm(u){if(u!==ai)return!1;if(!Bn)return M1(u),Bn=!0,!1;var m;if((m=u.tag!==3)&&!(m=u.tag!==5)&&(m=u.type,m=m!=="head"&&m!=="body"&&!$t(u.type,u.memoizedProps)),m&&(m=oi)){if($y(u))throw E1(),Error(t(418));for(;m;)k1(u,m),m=lo(m.nextSibling)}if(M1(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,m=0;u;){if(u.nodeType===8){var b=u.data;if(b==="/$"){if(m===0){oi=lo(u.nextSibling);break e}m--}else b!=="$"&&b!=="$!"&&b!=="$?"||m++}u=u.nextSibling}oi=null}}else oi=ai?lo(u.stateNode.nextSibling):null;return!0}function E1(){for(var u=oi;u;)u=lo(u.nextSibling)}function Du(){oi=ai=null,Bn=!1}function Yy(u){ma===null?ma=[u]:ma.push(u)}var tq=M.ReactCurrentBatchConfig;function th(u,m,b){if(u=b.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(t(309));var k=b.stateNode}if(!k)throw Error(t(147,u));var R=k,z=""+u;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===z?m.ref:(m=function(G){var fe=R.refs;G===null?delete fe[z]:fe[z]=G},m._stringRef=z,m)}if(typeof u!="string")throw Error(t(284));if(!b._owner)throw Error(t(290,u))}return u}function Qm(u,m){throw u=Object.prototype.toString.call(m),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":u))}function D1(u){var m=u._init;return m(u._payload)}function O1(u){function m(Te,be){if(u){var ke=Te.deletions;ke===null?(Te.deletions=[be],Te.flags|=16):ke.push(be)}}function b(Te,be){if(!u)return null;for(;be!==null;)m(Te,be),be=be.sibling;return null}function k(Te,be){for(Te=new Map;be!==null;)be.key!==null?Te.set(be.key,be):Te.set(be.index,be),be=be.sibling;return Te}function R(Te,be){return Te=bc(Te,be),Te.index=0,Te.sibling=null,Te}function z(Te,be,ke){return Te.index=ke,u?(ke=Te.alternate,ke!==null?(ke=ke.index,ke<be?(Te.flags|=2,be):ke):(Te.flags|=2,be)):(Te.flags|=1048576,be)}function G(Te){return u&&Te.alternate===null&&(Te.flags|=2),Te}function fe(Te,be,ke,Je){return be===null||be.tag!==6?(be=Fv(ke,Te.mode,Je),be.return=Te,be):(be=R(be,ke),be.return=Te,be)}function me(Te,be,ke,Je){var pt=ke.type;return pt===q?Ge(Te,be,ke.props.children,Je,ke.key):be!==null&&(be.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===J&&D1(pt)===be.type)?(Je=R(be,ke.props),Je.ref=th(Te,be,ke),Je.return=Te,Je):(Je=_p(ke.type,ke.key,ke.props,null,Te.mode,Je),Je.ref=th(Te,be,ke),Je.return=Te,Je)}function De(Te,be,ke,Je){return be===null||be.tag!==4||be.stateNode.containerInfo!==ke.containerInfo||be.stateNode.implementation!==ke.implementation?(be=qv(ke,Te.mode,Je),be.return=Te,be):(be=R(be,ke.children||[]),be.return=Te,be)}function Ge(Te,be,ke,Je,pt){return be===null||be.tag!==7?(be=qd(ke,Te.mode,Je,pt),be.return=Te,be):(be=R(be,ke),be.return=Te,be)}function Ze(Te,be,ke){if(typeof be=="string"&&be!==""||typeof be=="number")return be=Fv(""+be,Te.mode,ke),be.return=Te,be;if(typeof be=="object"&&be!==null){switch(be.$$typeof){case O:return ke=_p(be.type,be.key,be.props,null,Te.mode,ke),ke.ref=th(Te,null,be),ke.return=Te,ke;case I:return be=qv(be,Te.mode,ke),be.return=Te,be;case J:var Je=be._init;return Ze(Te,Je(be._payload),ke)}if(te(be)||Z(be))return be=qd(be,Te.mode,ke,null),be.return=Te,be;Qm(Te,be)}return null}function Ye(Te,be,ke,Je){var pt=be!==null?be.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number")return pt!==null?null:fe(Te,be,""+ke,Je);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case O:return ke.key===pt?me(Te,be,ke,Je):null;case I:return ke.key===pt?De(Te,be,ke,Je):null;case J:return pt=ke._init,Ye(Te,be,pt(ke._payload),Je)}if(te(ke)||Z(ke))return pt!==null?null:Ge(Te,be,ke,Je,null);Qm(Te,ke)}return null}function at(Te,be,ke,Je,pt){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return Te=Te.get(ke)||null,fe(be,Te,""+Je,pt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case O:return Te=Te.get(Je.key===null?ke:Je.key)||null,me(be,Te,Je,pt);case I:return Te=Te.get(Je.key===null?ke:Je.key)||null,De(be,Te,Je,pt);case J:var Tt=Je._init;return at(Te,be,ke,Tt(Je._payload),pt)}if(te(Je)||Z(Je))return Te=Te.get(ke)||null,Ge(be,Te,Je,pt,null);Qm(be,Je)}return null}function ut(Te,be,ke,Je){for(var pt=null,Tt=null,kt=be,At=be=0,Ir=null;kt!==null&&At<ke.length;At++){kt.index>At?(Ir=kt,kt=null):Ir=kt.sibling;var cn=Ye(Te,kt,ke[At],Je);if(cn===null){kt===null&&(kt=Ir);break}u&&kt&&cn.alternate===null&&m(Te,kt),be=z(cn,be,At),Tt===null?pt=cn:Tt.sibling=cn,Tt=cn,kt=Ir}if(At===ke.length)return b(Te,kt),Bn&&Ed(Te,At),pt;if(kt===null){for(;At<ke.length;At++)kt=Ze(Te,ke[At],Je),kt!==null&&(be=z(kt,be,At),Tt===null?pt=kt:Tt.sibling=kt,Tt=kt);return Bn&&Ed(Te,At),pt}for(kt=k(Te,kt);At<ke.length;At++)Ir=at(kt,Te,At,ke[At],Je),Ir!==null&&(u&&Ir.alternate!==null&&kt.delete(Ir.key===null?At:Ir.key),be=z(Ir,be,At),Tt===null?pt=Ir:Tt.sibling=Ir,Tt=Ir);return u&&kt.forEach(function(wc){return m(Te,wc)}),Bn&&Ed(Te,At),pt}function mt(Te,be,ke,Je){var pt=Z(ke);if(typeof pt!="function")throw Error(t(150));if(ke=pt.call(ke),ke==null)throw Error(t(151));for(var Tt=pt=null,kt=be,At=be=0,Ir=null,cn=ke.next();kt!==null&&!cn.done;At++,cn=ke.next()){kt.index>At?(Ir=kt,kt=null):Ir=kt.sibling;var wc=Ye(Te,kt,cn.value,Je);if(wc===null){kt===null&&(kt=Ir);break}u&&kt&&wc.alternate===null&&m(Te,kt),be=z(wc,be,At),Tt===null?pt=wc:Tt.sibling=wc,Tt=wc,kt=Ir}if(cn.done)return b(Te,kt),Bn&&Ed(Te,At),pt;if(kt===null){for(;!cn.done;At++,cn=ke.next())cn=Ze(Te,cn.value,Je),cn!==null&&(be=z(cn,be,At),Tt===null?pt=cn:Tt.sibling=cn,Tt=cn);return Bn&&Ed(Te,At),pt}for(kt=k(Te,kt);!cn.done;At++,cn=ke.next())cn=at(kt,Te,At,cn.value,Je),cn!==null&&(u&&cn.alternate!==null&&kt.delete(cn.key===null?At:cn.key),be=z(cn,be,At),Tt===null?pt=cn:Tt.sibling=cn,Tt=cn);return u&&kt.forEach(function(Iq){return m(Te,Iq)}),Bn&&Ed(Te,At),pt}function sr(Te,be,ke,Je){if(typeof ke=="object"&&ke!==null&&ke.type===q&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case O:e:{for(var pt=ke.key,Tt=be;Tt!==null;){if(Tt.key===pt){if(pt=ke.type,pt===q){if(Tt.tag===7){b(Te,Tt.sibling),be=R(Tt,ke.props.children),be.return=Te,Te=be;break e}}else if(Tt.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===J&&D1(pt)===Tt.type){b(Te,Tt.sibling),be=R(Tt,ke.props),be.ref=th(Te,Tt,ke),be.return=Te,Te=be;break e}b(Te,Tt);break}else m(Te,Tt);Tt=Tt.sibling}ke.type===q?(be=qd(ke.props.children,Te.mode,Je,ke.key),be.return=Te,Te=be):(Je=_p(ke.type,ke.key,ke.props,null,Te.mode,Je),Je.ref=th(Te,be,ke),Je.return=Te,Te=Je)}return G(Te);case I:e:{for(Tt=ke.key;be!==null;){if(be.key===Tt)if(be.tag===4&&be.stateNode.containerInfo===ke.containerInfo&&be.stateNode.implementation===ke.implementation){b(Te,be.sibling),be=R(be,ke.children||[]),be.return=Te,Te=be;break e}else{b(Te,be);break}else m(Te,be);be=be.sibling}be=qv(ke,Te.mode,Je),be.return=Te,Te=be}return G(Te);case J:return Tt=ke._init,sr(Te,be,Tt(ke._payload),Je)}if(te(ke))return ut(Te,be,ke,Je);if(Z(ke))return mt(Te,be,ke,Je);Qm(Te,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"?(ke=""+ke,be!==null&&be.tag===6?(b(Te,be.sibling),be=R(be,ke),be.return=Te,Te=be):(b(Te,be),be=Fv(ke,Te.mode,Je),be.return=Te,Te=be),G(Te)):b(Te,be)}return sr}var Ou=O1(!0),I1=O1(!1),Xm=dc(null),ep=null,Iu=null,Gy=null;function Zy(){Gy=Iu=ep=null}function Ky(u){var m=Xm.current;Ln(Xm),u._currentValue=m}function Jy(u,m,b){for(;u!==null;){var k=u.alternate;if((u.childLanes&m)!==m?(u.childLanes|=m,k!==null&&(k.childLanes|=m)):k!==null&&(k.childLanes&m)!==m&&(k.childLanes|=m),u===b)break;u=u.return}}function Au(u,m){ep=u,Gy=Iu=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&m)!==0&&(Rs=!0),u.firstContext=null)}function Ri(u){var m=u._currentValue;if(Gy!==u)if(u={context:u,memoizedValue:m,next:null},Iu===null){if(ep===null)throw Error(t(308));Iu=u,ep.dependencies={lanes:0,firstContext:u}}else Iu=Iu.next=u;return m}var Dd=null;function Qy(u){Dd===null?Dd=[u]:Dd.push(u)}function A1(u,m,b,k){var R=m.interleaved;return R===null?(b.next=b,Qy(m)):(b.next=R.next,R.next=b),m.interleaved=b,al(u,k)}function al(u,m){u.lanes|=m;var b=u.alternate;for(b!==null&&(b.lanes|=m),b=u,u=u.return;u!==null;)u.childLanes|=m,b=u.alternate,b!==null&&(b.childLanes|=m),b=u,u=u.return;return b.tag===3?b.stateNode:null}var hc=!1;function Xy(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function R1(u,m){u=u.updateQueue,m.updateQueue===u&&(m.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function ol(u,m){return{eventTime:u,lane:m,tag:0,payload:null,callback:null,next:null}}function mc(u,m,b){var k=u.updateQueue;if(k===null)return null;if(k=k.shared,(on&2)!==0){var R=k.pending;return R===null?m.next=m:(m.next=R.next,R.next=m),k.pending=m,al(u,b)}return R=k.interleaved,R===null?(m.next=m,Qy(k)):(m.next=R.next,R.next=m),k.interleaved=m,al(u,b)}function tp(u,m,b){if(m=m.updateQueue,m!==null&&(m=m.shared,(b&4194240)!==0)){var k=m.lanes;k&=u.pendingLanes,b|=k,m.lanes=b,hs(u,b)}}function L1(u,m){var b=u.updateQueue,k=u.alternate;if(k!==null&&(k=k.updateQueue,b===k)){var R=null,z=null;if(b=b.firstBaseUpdate,b!==null){do{var G={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};z===null?R=z=G:z=z.next=G,b=b.next}while(b!==null);z===null?R=z=m:z=z.next=m}else R=z=m;b={baseState:k.baseState,firstBaseUpdate:R,lastBaseUpdate:z,shared:k.shared,effects:k.effects},u.updateQueue=b;return}u=b.lastBaseUpdate,u===null?b.firstBaseUpdate=m:u.next=m,b.lastBaseUpdate=m}function np(u,m,b,k){var R=u.updateQueue;hc=!1;var z=R.firstBaseUpdate,G=R.lastBaseUpdate,fe=R.shared.pending;if(fe!==null){R.shared.pending=null;var me=fe,De=me.next;me.next=null,G===null?z=De:G.next=De,G=me;var Ge=u.alternate;Ge!==null&&(Ge=Ge.updateQueue,fe=Ge.lastBaseUpdate,fe!==G&&(fe===null?Ge.firstBaseUpdate=De:fe.next=De,Ge.lastBaseUpdate=me))}if(z!==null){var Ze=R.baseState;G=0,Ge=De=me=null,fe=z;do{var Ye=fe.lane,at=fe.eventTime;if((k&Ye)===Ye){Ge!==null&&(Ge=Ge.next={eventTime:at,lane:0,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null});e:{var ut=u,mt=fe;switch(Ye=m,at=b,mt.tag){case 1:if(ut=mt.payload,typeof ut=="function"){Ze=ut.call(at,Ze,Ye);break e}Ze=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=mt.payload,Ye=typeof ut=="function"?ut.call(at,Ze,Ye):ut,Ye==null)break e;Ze=oe({},Ze,Ye);break e;case 2:hc=!0}}fe.callback!==null&&fe.lane!==0&&(u.flags|=64,Ye=R.effects,Ye===null?R.effects=[fe]:Ye.push(fe))}else at={eventTime:at,lane:Ye,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},Ge===null?(De=Ge=at,me=Ze):Ge=Ge.next=at,G|=Ye;if(fe=fe.next,fe===null){if(fe=R.shared.pending,fe===null)break;Ye=fe,fe=Ye.next,Ye.next=null,R.lastBaseUpdate=Ye,R.shared.pending=null}}while(!0);if(Ge===null&&(me=Ze),R.baseState=me,R.firstBaseUpdate=De,R.lastBaseUpdate=Ge,m=R.shared.interleaved,m!==null){R=m;do G|=R.lane,R=R.next;while(R!==m)}else z===null&&(R.shared.lanes=0);Ad|=G,u.lanes=G,u.memoizedState=Ze}}function F1(u,m,b){if(u=m.effects,m.effects=null,u!==null)for(m=0;m<u.length;m++){var k=u[m],R=k.callback;if(R!==null){if(k.callback=null,k=b,typeof R!="function")throw Error(t(191,R));R.call(k)}}}var nh={},co=dc(nh),rh=dc(nh),sh=dc(nh);function Od(u){if(u===nh)throw Error(t(174));return u}function ev(u,m){switch(On(sh,m),On(rh,u),On(co,nh),u=m.nodeType,u){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:Xe(null,"");break;default:u=u===8?m.parentNode:m,m=u.namespaceURI||null,u=u.tagName,m=Xe(m,u)}Ln(co),On(co,m)}function Ru(){Ln(co),Ln(rh),Ln(sh)}function q1(u){Od(sh.current);var m=Od(co.current),b=Xe(m,u.type);m!==b&&(On(rh,u),On(co,b))}function tv(u){rh.current===u&&(Ln(co),Ln(rh))}var Gn=dc(0);function rp(u){for(var m=u;m!==null;){if(m.tag===13){var b=m.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===u)break;for(;m.sibling===null;){if(m.return===null||m.return===u)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var nv=[];function rv(){for(var u=0;u<nv.length;u++)nv[u]._workInProgressVersionPrimary=null;nv.length=0}var sp=M.ReactCurrentDispatcher,sv=M.ReactCurrentBatchConfig,Id=0,Zn=null,Nr=null,Dr=null,ip=!1,ih=!1,ah=0,nq=0;function es(){throw Error(t(321))}function iv(u,m){if(m===null)return!1;for(var b=0;b<m.length&&b<u.length;b++)if(!Vr(u[b],m[b]))return!1;return!0}function av(u,m,b,k,R,z){if(Id=z,Zn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,sp.current=u===null||u.memoizedState===null?aq:oq,u=b(k,R),ih){z=0;do{if(ih=!1,ah=0,25<=z)throw Error(t(301));z+=1,Dr=Nr=null,m.updateQueue=null,sp.current=lq,u=b(k,R)}while(ih)}if(sp.current=lp,m=Nr!==null&&Nr.next!==null,Id=0,Dr=Nr=Zn=null,ip=!1,m)throw Error(t(300));return u}function ov(){var u=ah!==0;return ah=0,u}function uo(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dr===null?Zn.memoizedState=Dr=u:Dr=Dr.next=u,Dr}function Li(){if(Nr===null){var u=Zn.alternate;u=u!==null?u.memoizedState:null}else u=Nr.next;var m=Dr===null?Zn.memoizedState:Dr.next;if(m!==null)Dr=m,Nr=u;else{if(u===null)throw Error(t(310));Nr=u,u={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},Dr===null?Zn.memoizedState=Dr=u:Dr=Dr.next=u}return Dr}function oh(u,m){return typeof m=="function"?m(u):m}function lv(u){var m=Li(),b=m.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=u;var k=Nr,R=k.baseQueue,z=b.pending;if(z!==null){if(R!==null){var G=R.next;R.next=z.next,z.next=G}k.baseQueue=R=z,b.pending=null}if(R!==null){z=R.next,k=k.baseState;var fe=G=null,me=null,De=z;do{var Ge=De.lane;if((Id&Ge)===Ge)me!==null&&(me=me.next={lane:0,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null}),k=De.hasEagerState?De.eagerState:u(k,De.action);else{var Ze={lane:Ge,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null};me===null?(fe=me=Ze,G=k):me=me.next=Ze,Zn.lanes|=Ge,Ad|=Ge}De=De.next}while(De!==null&&De!==z);me===null?G=k:me.next=fe,Vr(k,m.memoizedState)||(Rs=!0),m.memoizedState=k,m.baseState=G,m.baseQueue=me,b.lastRenderedState=k}if(u=b.interleaved,u!==null){R=u;do z=R.lane,Zn.lanes|=z,Ad|=z,R=R.next;while(R!==u)}else R===null&&(b.lanes=0);return[m.memoizedState,b.dispatch]}function cv(u){var m=Li(),b=m.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=u;var k=b.dispatch,R=b.pending,z=m.memoizedState;if(R!==null){b.pending=null;var G=R=R.next;do z=u(z,G.action),G=G.next;while(G!==R);Vr(z,m.memoizedState)||(Rs=!0),m.memoizedState=z,m.baseQueue===null&&(m.baseState=z),b.lastRenderedState=z}return[z,k]}function z1(){}function U1(u,m){var b=Zn,k=Li(),R=m(),z=!Vr(k.memoizedState,R);if(z&&(k.memoizedState=R,Rs=!0),k=k.queue,dv(W1.bind(null,b,k,u),[u]),k.getSnapshot!==m||z||Dr!==null&&Dr.memoizedState.tag&1){if(b.flags|=2048,lh(9,B1.bind(null,b,k,R,m),void 0,null),Or===null)throw Error(t(349));(Id&30)!==0||V1(b,m,R)}return R}function V1(u,m,b){u.flags|=16384,u={getSnapshot:m,value:b},m=Zn.updateQueue,m===null?(m={lastEffect:null,stores:null},Zn.updateQueue=m,m.stores=[u]):(b=m.stores,b===null?m.stores=[u]:b.push(u))}function B1(u,m,b,k){m.value=b,m.getSnapshot=k,$1(m)&&H1(u)}function W1(u,m,b){return b(function(){$1(m)&&H1(u)})}function $1(u){var m=u.getSnapshot;u=u.value;try{var b=m();return!Vr(u,b)}catch{return!0}}function H1(u){var m=al(u,1);m!==null&&ya(m,u,1,-1)}function Y1(u){var m=uo();return typeof u=="function"&&(u=u()),m.memoizedState=m.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oh,lastRenderedState:u},m.queue=u,u=u.dispatch=iq.bind(null,Zn,u),[m.memoizedState,u]}function lh(u,m,b,k){return u={tag:u,create:m,destroy:b,deps:k,next:null},m=Zn.updateQueue,m===null?(m={lastEffect:null,stores:null},Zn.updateQueue=m,m.lastEffect=u.next=u):(b=m.lastEffect,b===null?m.lastEffect=u.next=u:(k=b.next,b.next=u,u.next=k,m.lastEffect=u)),u}function G1(){return Li().memoizedState}function ap(u,m,b,k){var R=uo();Zn.flags|=u,R.memoizedState=lh(1|m,b,void 0,k===void 0?null:k)}function op(u,m,b,k){var R=Li();k=k===void 0?null:k;var z=void 0;if(Nr!==null){var G=Nr.memoizedState;if(z=G.destroy,k!==null&&iv(k,G.deps)){R.memoizedState=lh(m,b,z,k);return}}Zn.flags|=u,R.memoizedState=lh(1|m,b,z,k)}function Z1(u,m){return ap(8390656,8,u,m)}function dv(u,m){return op(2048,8,u,m)}function K1(u,m){return op(4,2,u,m)}function J1(u,m){return op(4,4,u,m)}function Q1(u,m){if(typeof m=="function")return u=u(),m(u),function(){m(null)};if(m!=null)return u=u(),m.current=u,function(){m.current=null}}function X1(u,m,b){return b=b!=null?b.concat([u]):null,op(4,4,Q1.bind(null,m,u),b)}function uv(){}function eT(u,m){var b=Li();m=m===void 0?null:m;var k=b.memoizedState;return k!==null&&m!==null&&iv(m,k[1])?k[0]:(b.memoizedState=[u,m],u)}function tT(u,m){var b=Li();m=m===void 0?null:m;var k=b.memoizedState;return k!==null&&m!==null&&iv(m,k[1])?k[0]:(u=u(),b.memoizedState=[u,m],u)}function nT(u,m,b){return(Id&21)===0?(u.baseState&&(u.baseState=!1,Rs=!0),u.memoizedState=b):(Vr(b,m)||(b=ql(),Zn.lanes|=b,Ad|=b,u.baseState=!0),m)}function rq(u,m){var b=Kt;Kt=b!==0&&4>b?b:4,u(!0);var k=sv.transition;sv.transition={};try{u(!1),m()}finally{Kt=b,sv.transition=k}}function rT(){return Li().memoizedState}function sq(u,m,b){var k=yc(u);if(b={lane:k,action:b,hasEagerState:!1,eagerState:null,next:null},sT(u))iT(m,b);else if(b=A1(u,m,b,k),b!==null){var R=bs();ya(b,u,k,R),aT(b,m,k)}}function iq(u,m,b){var k=yc(u),R={lane:k,action:b,hasEagerState:!1,eagerState:null,next:null};if(sT(u))iT(m,R);else{var z=u.alternate;if(u.lanes===0&&(z===null||z.lanes===0)&&(z=m.lastRenderedReducer,z!==null))try{var G=m.lastRenderedState,fe=z(G,b);if(R.hasEagerState=!0,R.eagerState=fe,Vr(fe,G)){var me=m.interleaved;me===null?(R.next=R,Qy(m)):(R.next=me.next,me.next=R),m.interleaved=R;return}}catch{}finally{}b=A1(u,m,R,k),b!==null&&(R=bs(),ya(b,u,k,R),aT(b,m,k))}}function sT(u){var m=u.alternate;return u===Zn||m!==null&&m===Zn}function iT(u,m){ih=ip=!0;var b=u.pending;b===null?m.next=m:(m.next=b.next,b.next=m),u.pending=m}function aT(u,m,b){if((b&4194240)!==0){var k=m.lanes;k&=u.pendingLanes,b|=k,m.lanes=b,hs(u,b)}}var lp={readContext:Ri,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},aq={readContext:Ri,useCallback:function(u,m){return uo().memoizedState=[u,m===void 0?null:m],u},useContext:Ri,useEffect:Z1,useImperativeHandle:function(u,m,b){return b=b!=null?b.concat([u]):null,ap(4194308,4,Q1.bind(null,m,u),b)},useLayoutEffect:function(u,m){return ap(4194308,4,u,m)},useInsertionEffect:function(u,m){return ap(4,2,u,m)},useMemo:function(u,m){var b=uo();return m=m===void 0?null:m,u=u(),b.memoizedState=[u,m],u},useReducer:function(u,m,b){var k=uo();return m=b!==void 0?b(m):m,k.memoizedState=k.baseState=m,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:m},k.queue=u,u=u.dispatch=sq.bind(null,Zn,u),[k.memoizedState,u]},useRef:function(u){var m=uo();return u={current:u},m.memoizedState=u},useState:Y1,useDebugValue:uv,useDeferredValue:function(u){return uo().memoizedState=u},useTransition:function(){var u=Y1(!1),m=u[0];return u=rq.bind(null,u[1]),uo().memoizedState=u,[m,u]},useMutableSource:function(){},useSyncExternalStore:function(u,m,b){var k=Zn,R=uo();if(Bn){if(b===void 0)throw Error(t(407));b=b()}else{if(b=m(),Or===null)throw Error(t(349));(Id&30)!==0||V1(k,m,b)}R.memoizedState=b;var z={value:b,getSnapshot:m};return R.queue=z,Z1(W1.bind(null,k,z,u),[u]),k.flags|=2048,lh(9,B1.bind(null,k,z,b,m),void 0,null),b},useId:function(){var u=uo(),m=Or.identifierPrefix;if(Bn){var b=il,k=sl;b=(k&~(1<<32-Dt(k)-1)).toString(32)+b,m=":"+m+"R"+b,b=ah++,0<b&&(m+="H"+b.toString(32)),m+=":"}else b=nq++,m=":"+m+"r"+b.toString(32)+":";return u.memoizedState=m},unstable_isNewReconciler:!1},oq={readContext:Ri,useCallback:eT,useContext:Ri,useEffect:dv,useImperativeHandle:X1,useInsertionEffect:K1,useLayoutEffect:J1,useMemo:tT,useReducer:lv,useRef:G1,useState:function(){return lv(oh)},useDebugValue:uv,useDeferredValue:function(u){var m=Li();return nT(m,Nr.memoizedState,u)},useTransition:function(){var u=lv(oh)[0],m=Li().memoizedState;return[u,m]},useMutableSource:z1,useSyncExternalStore:U1,useId:rT,unstable_isNewReconciler:!1},lq={readContext:Ri,useCallback:eT,useContext:Ri,useEffect:dv,useImperativeHandle:X1,useInsertionEffect:K1,useLayoutEffect:J1,useMemo:tT,useReducer:cv,useRef:G1,useState:function(){return cv(oh)},useDebugValue:uv,useDeferredValue:function(u){var m=Li();return Nr===null?m.memoizedState=u:nT(m,Nr.memoizedState,u)},useTransition:function(){var u=cv(oh)[0],m=Li().memoizedState;return[u,m]},useMutableSource:z1,useSyncExternalStore:U1,useId:rT,unstable_isNewReconciler:!1};function pa(u,m){if(u&&u.defaultProps){m=oe({},m),u=u.defaultProps;for(var b in u)m[b]===void 0&&(m[b]=u[b]);return m}return m}function fv(u,m,b,k){m=u.memoizedState,b=b(k,m),b=b==null?m:oe({},m,b),u.memoizedState=b,u.lanes===0&&(u.updateQueue.baseState=b)}var cp={isMounted:function(u){return(u=u._reactInternals)?ks(u)===u:!1},enqueueSetState:function(u,m,b){u=u._reactInternals;var k=bs(),R=yc(u),z=ol(k,R);z.payload=m,b!=null&&(z.callback=b),m=mc(u,z,R),m!==null&&(ya(m,u,R,k),tp(m,u,R))},enqueueReplaceState:function(u,m,b){u=u._reactInternals;var k=bs(),R=yc(u),z=ol(k,R);z.tag=1,z.payload=m,b!=null&&(z.callback=b),m=mc(u,z,R),m!==null&&(ya(m,u,R,k),tp(m,u,R))},enqueueForceUpdate:function(u,m){u=u._reactInternals;var b=bs(),k=yc(u),R=ol(b,k);R.tag=2,m!=null&&(R.callback=m),m=mc(u,R,k),m!==null&&(ya(m,u,k,b),tp(m,u,k))}};function oT(u,m,b,k,R,z,G){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(k,z,G):m.prototype&&m.prototype.isPureReactComponent?!Os(b,k)||!Os(R,z):!0}function lT(u,m,b){var k=!1,R=uc,z=m.contextType;return typeof z=="object"&&z!==null?z=Ri(z):(R=As(m)?Pd:Xr.current,k=m.contextTypes,z=(k=k!=null)?Pu(u,R):uc),m=new m(b,z),u.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=cp,u.stateNode=m,m._reactInternals=u,k&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=R,u.__reactInternalMemoizedMaskedChildContext=z),m}function cT(u,m,b,k){u=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(b,k),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(b,k),m.state!==u&&cp.enqueueReplaceState(m,m.state,null)}function hv(u,m,b,k){var R=u.stateNode;R.props=b,R.state=u.memoizedState,R.refs={},Xy(u);var z=m.contextType;typeof z=="object"&&z!==null?R.context=Ri(z):(z=As(m)?Pd:Xr.current,R.context=Pu(u,z)),R.state=u.memoizedState,z=m.getDerivedStateFromProps,typeof z=="function"&&(fv(u,m,z,b),R.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(m=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),m!==R.state&&cp.enqueueReplaceState(R,R.state,null),np(u,b,R,k),R.state=u.memoizedState),typeof R.componentDidMount=="function"&&(u.flags|=4194308)}function Lu(u,m){try{var b="",k=m;do b+=ce(k),k=k.return;while(k);var R=b}catch(z){R=`
Error generating stack: `+z.message+`
`+z.stack}return{value:u,source:m,stack:R,digest:null}}function mv(u,m,b){return{value:u,source:null,stack:b??null,digest:m??null}}function pv(u,m){try{console.error(m.value)}catch(b){setTimeout(function(){throw b})}}var cq=typeof WeakMap=="function"?WeakMap:Map;function dT(u,m,b){b=ol(-1,b),b.tag=3,b.payload={element:null};var k=m.value;return b.callback=function(){gp||(gp=!0,Mv=k),pv(u,m)},b}function uT(u,m,b){b=ol(-1,b),b.tag=3;var k=u.type.getDerivedStateFromError;if(typeof k=="function"){var R=m.value;b.payload=function(){return k(R)},b.callback=function(){pv(u,m)}}var z=u.stateNode;return z!==null&&typeof z.componentDidCatch=="function"&&(b.callback=function(){pv(u,m),typeof k!="function"&&(gc===null?gc=new Set([this]):gc.add(this));var G=m.stack;this.componentDidCatch(m.value,{componentStack:G!==null?G:""})}),b}function fT(u,m,b){var k=u.pingCache;if(k===null){k=u.pingCache=new cq;var R=new Set;k.set(m,R)}else R=k.get(m),R===void 0&&(R=new Set,k.set(m,R));R.has(b)||(R.add(b),u=jq.bind(null,u,m,b),m.then(u,u))}function hT(u){do{var m;if((m=u.tag===13)&&(m=u.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return u;u=u.return}while(u!==null);return null}function mT(u,m,b,k,R){return(u.mode&1)===0?(u===m?u.flags|=65536:(u.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(m=ol(-1,1),m.tag=2,mc(b,m,1))),b.lanes|=1),u):(u.flags|=65536,u.lanes=R,u)}var dq=M.ReactCurrentOwner,Rs=!1;function vs(u,m,b,k){m.child=u===null?I1(m,null,b,k):Ou(m,u.child,b,k)}function pT(u,m,b,k,R){b=b.render;var z=m.ref;return Au(m,R),k=av(u,m,b,k,z,R),b=ov(),u!==null&&!Rs?(m.updateQueue=u.updateQueue,m.flags&=-2053,u.lanes&=~R,ll(u,m,R)):(Bn&&b&&By(m),m.flags|=1,vs(u,m,k,R),m.child)}function gT(u,m,b,k,R){if(u===null){var z=b.type;return typeof z=="function"&&!Lv(z)&&z.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(m.tag=15,m.type=z,xT(u,m,z,k,R)):(u=_p(b.type,null,k,m,m.mode,R),u.ref=m.ref,u.return=m,m.child=u)}if(z=u.child,(u.lanes&R)===0){var G=z.memoizedProps;if(b=b.compare,b=b!==null?b:Os,b(G,k)&&u.ref===m.ref)return ll(u,m,R)}return m.flags|=1,u=bc(z,k),u.ref=m.ref,u.return=m,m.child=u}function xT(u,m,b,k,R){if(u!==null){var z=u.memoizedProps;if(Os(z,k)&&u.ref===m.ref)if(Rs=!1,m.pendingProps=k=z,(u.lanes&R)!==0)(u.flags&131072)!==0&&(Rs=!0);else return m.lanes=u.lanes,ll(u,m,R)}return gv(u,m,b,k,R)}function yT(u,m,b){var k=m.pendingProps,R=k.children,z=u!==null?u.memoizedState:null;if(k.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},On(qu,li),li|=b;else{if((b&1073741824)===0)return u=z!==null?z.baseLanes|b:b,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:u,cachePool:null,transitions:null},m.updateQueue=null,On(qu,li),li|=u,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},k=z!==null?z.baseLanes:b,On(qu,li),li|=k}else z!==null?(k=z.baseLanes|b,m.memoizedState=null):k=b,On(qu,li),li|=k;return vs(u,m,R,b),m.child}function vT(u,m){var b=m.ref;(u===null&&b!==null||u!==null&&u.ref!==b)&&(m.flags|=512,m.flags|=2097152)}function gv(u,m,b,k,R){var z=As(b)?Pd:Xr.current;return z=Pu(m,z),Au(m,R),b=av(u,m,b,k,z,R),k=ov(),u!==null&&!Rs?(m.updateQueue=u.updateQueue,m.flags&=-2053,u.lanes&=~R,ll(u,m,R)):(Bn&&k&&By(m),m.flags|=1,vs(u,m,b,R),m.child)}function bT(u,m,b,k,R){if(As(b)){var z=!0;Ym(m)}else z=!1;if(Au(m,R),m.stateNode===null)up(u,m),lT(m,b,k),hv(m,b,k,R),k=!0;else if(u===null){var G=m.stateNode,fe=m.memoizedProps;G.props=fe;var me=G.context,De=b.contextType;typeof De=="object"&&De!==null?De=Ri(De):(De=As(b)?Pd:Xr.current,De=Pu(m,De));var Ge=b.getDerivedStateFromProps,Ze=typeof Ge=="function"||typeof G.getSnapshotBeforeUpdate=="function";Ze||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(fe!==k||me!==De)&&cT(m,G,k,De),hc=!1;var Ye=m.memoizedState;G.state=Ye,np(m,k,G,R),me=m.memoizedState,fe!==k||Ye!==me||Is.current||hc?(typeof Ge=="function"&&(fv(m,b,Ge,k),me=m.memoizedState),(fe=hc||oT(m,b,fe,k,Ye,me,De))?(Ze||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(m.flags|=4194308)):(typeof G.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=k,m.memoizedState=me),G.props=k,G.state=me,G.context=De,k=fe):(typeof G.componentDidMount=="function"&&(m.flags|=4194308),k=!1)}else{G=m.stateNode,R1(u,m),fe=m.memoizedProps,De=m.type===m.elementType?fe:pa(m.type,fe),G.props=De,Ze=m.pendingProps,Ye=G.context,me=b.contextType,typeof me=="object"&&me!==null?me=Ri(me):(me=As(b)?Pd:Xr.current,me=Pu(m,me));var at=b.getDerivedStateFromProps;(Ge=typeof at=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(fe!==Ze||Ye!==me)&&cT(m,G,k,me),hc=!1,Ye=m.memoizedState,G.state=Ye,np(m,k,G,R);var ut=m.memoizedState;fe!==Ze||Ye!==ut||Is.current||hc?(typeof at=="function"&&(fv(m,b,at,k),ut=m.memoizedState),(De=hc||oT(m,b,De,k,Ye,ut,me)||!1)?(Ge||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(k,ut,me),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(k,ut,me)),typeof G.componentDidUpdate=="function"&&(m.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof G.componentDidUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=1024),m.memoizedProps=k,m.memoizedState=ut),G.props=k,G.state=ut,G.context=me,k=De):(typeof G.componentDidUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||fe===u.memoizedProps&&Ye===u.memoizedState||(m.flags|=1024),k=!1)}return xv(u,m,b,k,z,R)}function xv(u,m,b,k,R,z){vT(u,m);var G=(m.flags&128)!==0;if(!k&&!G)return R&&S1(m,b,!1),ll(u,m,z);k=m.stateNode,dq.current=m;var fe=G&&typeof b.getDerivedStateFromError!="function"?null:k.render();return m.flags|=1,u!==null&&G?(m.child=Ou(m,u.child,null,z),m.child=Ou(m,null,fe,z)):vs(u,m,fe,z),m.memoizedState=k.state,R&&S1(m,b,!0),m.child}function wT(u){var m=u.stateNode;m.pendingContext?j1(u,m.pendingContext,m.pendingContext!==m.context):m.context&&j1(u,m.context,!1),ev(u,m.containerInfo)}function _T(u,m,b,k,R){return Du(),Yy(R),m.flags|=256,vs(u,m,b,k),m.child}var yv={dehydrated:null,treeContext:null,retryLane:0};function vv(u){return{baseLanes:u,cachePool:null,transitions:null}}function jT(u,m,b){var k=m.pendingProps,R=Gn.current,z=!1,G=(m.flags&128)!==0,fe;if((fe=G)||(fe=u!==null&&u.memoizedState===null?!1:(R&2)!==0),fe?(z=!0,m.flags&=-129):(u===null||u.memoizedState!==null)&&(R|=1),On(Gn,R&1),u===null)return Hy(m),u=m.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((m.mode&1)===0?m.lanes=1:u.data==="$!"?m.lanes=8:m.lanes=1073741824,null):(G=k.children,u=k.fallback,z?(k=m.mode,z=m.child,G={mode:"hidden",children:G},(k&1)===0&&z!==null?(z.childLanes=0,z.pendingProps=G):z=jp(G,k,0,null),u=qd(u,k,b,null),z.return=m,u.return=m,z.sibling=u,m.child=z,m.child.memoizedState=vv(b),m.memoizedState=yv,u):bv(m,G));if(R=u.memoizedState,R!==null&&(fe=R.dehydrated,fe!==null))return uq(u,m,G,k,fe,R,b);if(z){z=k.fallback,G=m.mode,R=u.child,fe=R.sibling;var me={mode:"hidden",children:k.children};return(G&1)===0&&m.child!==R?(k=m.child,k.childLanes=0,k.pendingProps=me,m.deletions=null):(k=bc(R,me),k.subtreeFlags=R.subtreeFlags&14680064),fe!==null?z=bc(fe,z):(z=qd(z,G,b,null),z.flags|=2),z.return=m,k.return=m,k.sibling=z,m.child=k,k=z,z=m.child,G=u.child.memoizedState,G=G===null?vv(b):{baseLanes:G.baseLanes|b,cachePool:null,transitions:G.transitions},z.memoizedState=G,z.childLanes=u.childLanes&~b,m.memoizedState=yv,k}return z=u.child,u=z.sibling,k=bc(z,{mode:"visible",children:k.children}),(m.mode&1)===0&&(k.lanes=b),k.return=m,k.sibling=null,u!==null&&(b=m.deletions,b===null?(m.deletions=[u],m.flags|=16):b.push(u)),m.child=k,m.memoizedState=null,k}function bv(u,m){return m=jp({mode:"visible",children:m},u.mode,0,null),m.return=u,u.child=m}function dp(u,m,b,k){return k!==null&&Yy(k),Ou(m,u.child,null,b),u=bv(m,m.pendingProps.children),u.flags|=2,m.memoizedState=null,u}function uq(u,m,b,k,R,z,G){if(b)return m.flags&256?(m.flags&=-257,k=mv(Error(t(422))),dp(u,m,G,k)):m.memoizedState!==null?(m.child=u.child,m.flags|=128,null):(z=k.fallback,R=m.mode,k=jp({mode:"visible",children:k.children},R,0,null),z=qd(z,R,G,null),z.flags|=2,k.return=m,z.return=m,k.sibling=z,m.child=k,(m.mode&1)!==0&&Ou(m,u.child,null,G),m.child.memoizedState=vv(G),m.memoizedState=yv,z);if((m.mode&1)===0)return dp(u,m,G,null);if(R.data==="$!"){if(k=R.nextSibling&&R.nextSibling.dataset,k)var fe=k.dgst;return k=fe,z=Error(t(419)),k=mv(z,k,void 0),dp(u,m,G,k)}if(fe=(G&u.childLanes)!==0,Rs||fe){if(k=Or,k!==null){switch(G&-G){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(k.suspendedLanes|G))!==0?0:R,R!==0&&R!==z.retryLane&&(z.retryLane=R,al(u,R),ya(k,u,R,-1))}return Rv(),k=mv(Error(t(421))),dp(u,m,G,k)}return R.data==="$?"?(m.flags|=128,m.child=u.child,m=Nq.bind(null,u),R._reactRetry=m,null):(u=z.treeContext,oi=lo(R.nextSibling),ai=m,Bn=!0,ma=null,u!==null&&(Ii[Ai++]=sl,Ii[Ai++]=il,Ii[Ai++]=Md,sl=u.id,il=u.overflow,Md=m),m=bv(m,k.children),m.flags|=4096,m)}function NT(u,m,b){u.lanes|=m;var k=u.alternate;k!==null&&(k.lanes|=m),Jy(u.return,m,b)}function wv(u,m,b,k,R){var z=u.memoizedState;z===null?u.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:k,tail:b,tailMode:R}:(z.isBackwards=m,z.rendering=null,z.renderingStartTime=0,z.last=k,z.tail=b,z.tailMode=R)}function ST(u,m,b){var k=m.pendingProps,R=k.revealOrder,z=k.tail;if(vs(u,m,k.children,b),k=Gn.current,(k&2)!==0)k=k&1|2,m.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=m.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&NT(u,b,m);else if(u.tag===19)NT(u,b,m);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===m)break e;for(;u.sibling===null;){if(u.return===null||u.return===m)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}k&=1}if(On(Gn,k),(m.mode&1)===0)m.memoizedState=null;else switch(R){case"forwards":for(b=m.child,R=null;b!==null;)u=b.alternate,u!==null&&rp(u)===null&&(R=b),b=b.sibling;b=R,b===null?(R=m.child,m.child=null):(R=b.sibling,b.sibling=null),wv(m,!1,R,b,z);break;case"backwards":for(b=null,R=m.child,m.child=null;R!==null;){if(u=R.alternate,u!==null&&rp(u)===null){m.child=R;break}u=R.sibling,R.sibling=b,b=R,R=u}wv(m,!0,b,null,z);break;case"together":wv(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function up(u,m){(m.mode&1)===0&&u!==null&&(u.alternate=null,m.alternate=null,m.flags|=2)}function ll(u,m,b){if(u!==null&&(m.dependencies=u.dependencies),Ad|=m.lanes,(b&m.childLanes)===0)return null;if(u!==null&&m.child!==u.child)throw Error(t(153));if(m.child!==null){for(u=m.child,b=bc(u,u.pendingProps),m.child=b,b.return=m;u.sibling!==null;)u=u.sibling,b=b.sibling=bc(u,u.pendingProps),b.return=m;b.sibling=null}return m.child}function fq(u,m,b){switch(m.tag){case 3:wT(m),Du();break;case 5:q1(m);break;case 1:As(m.type)&&Ym(m);break;case 4:ev(m,m.stateNode.containerInfo);break;case 10:var k=m.type._context,R=m.memoizedProps.value;On(Xm,k._currentValue),k._currentValue=R;break;case 13:if(k=m.memoizedState,k!==null)return k.dehydrated!==null?(On(Gn,Gn.current&1),m.flags|=128,null):(b&m.child.childLanes)!==0?jT(u,m,b):(On(Gn,Gn.current&1),u=ll(u,m,b),u!==null?u.sibling:null);On(Gn,Gn.current&1);break;case 19:if(k=(b&m.childLanes)!==0,(u.flags&128)!==0){if(k)return ST(u,m,b);m.flags|=128}if(R=m.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),On(Gn,Gn.current),k)break;return null;case 22:case 23:return m.lanes=0,yT(u,m,b)}return ll(u,m,b)}var CT,_v,TT,kT;CT=function(u,m){for(var b=m.child;b!==null;){if(b.tag===5||b.tag===6)u.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===m)break;for(;b.sibling===null;){if(b.return===null||b.return===m)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},_v=function(){},TT=function(u,m,b,k){var R=u.memoizedProps;if(R!==k){u=m.stateNode,Od(co.current);var z=null;switch(b){case"input":R=Fe(u,R),k=Fe(u,k),z=[];break;case"select":R=oe({},R,{value:void 0}),k=oe({},k,{value:void 0}),z=[];break;case"textarea":R=ye(u,R),k=ye(u,k),z=[];break;default:typeof R.onClick!="function"&&typeof k.onClick=="function"&&(u.onclick=We)}Rn(b,k);var G;b=null;for(De in R)if(!k.hasOwnProperty(De)&&R.hasOwnProperty(De)&&R[De]!=null)if(De==="style"){var fe=R[De];for(G in fe)fe.hasOwnProperty(G)&&(b||(b={}),b[G]="")}else De!=="dangerouslySetInnerHTML"&&De!=="children"&&De!=="suppressContentEditableWarning"&&De!=="suppressHydrationWarning"&&De!=="autoFocus"&&(s.hasOwnProperty(De)?z||(z=[]):(z=z||[]).push(De,null));for(De in k){var me=k[De];if(fe=R?.[De],k.hasOwnProperty(De)&&me!==fe&&(me!=null||fe!=null))if(De==="style")if(fe){for(G in fe)!fe.hasOwnProperty(G)||me&&me.hasOwnProperty(G)||(b||(b={}),b[G]="");for(G in me)me.hasOwnProperty(G)&&fe[G]!==me[G]&&(b||(b={}),b[G]=me[G])}else b||(z||(z=[]),z.push(De,b)),b=me;else De==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,fe=fe?fe.__html:void 0,me!=null&&fe!==me&&(z=z||[]).push(De,me)):De==="children"?typeof me!="string"&&typeof me!="number"||(z=z||[]).push(De,""+me):De!=="suppressContentEditableWarning"&&De!=="suppressHydrationWarning"&&(s.hasOwnProperty(De)?(me!=null&&De==="onScroll"&&Sn("scroll",u),z||fe===me||(z=[])):(z=z||[]).push(De,me))}b&&(z=z||[]).push("style",b);var De=z;(m.updateQueue=De)&&(m.flags|=4)}},kT=function(u,m,b,k){b!==k&&(m.flags|=4)};function ch(u,m){if(!Bn)switch(u.tailMode){case"hidden":m=u.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?u.tail=null:b.sibling=null;break;case"collapsed":b=u.tail;for(var k=null;b!==null;)b.alternate!==null&&(k=b),b=b.sibling;k===null?m||u.tail===null?u.tail=null:u.tail.sibling=null:k.sibling=null}}function ts(u){var m=u.alternate!==null&&u.alternate.child===u.child,b=0,k=0;if(m)for(var R=u.child;R!==null;)b|=R.lanes|R.childLanes,k|=R.subtreeFlags&14680064,k|=R.flags&14680064,R.return=u,R=R.sibling;else for(R=u.child;R!==null;)b|=R.lanes|R.childLanes,k|=R.subtreeFlags,k|=R.flags,R.return=u,R=R.sibling;return u.subtreeFlags|=k,u.childLanes=b,m}function hq(u,m,b){var k=m.pendingProps;switch(Wy(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(m),null;case 1:return As(m.type)&&Hm(),ts(m),null;case 3:return k=m.stateNode,Ru(),Ln(Is),Ln(Xr),rv(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(u===null||u.child===null)&&(Jm(m)?m.flags|=4:u===null||u.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,ma!==null&&(Ov(ma),ma=null))),_v(u,m),ts(m),null;case 5:tv(m);var R=Od(sh.current);if(b=m.type,u!==null&&m.stateNode!=null)TT(u,m,b,k,R),u.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!k){if(m.stateNode===null)throw Error(t(166));return ts(m),null}if(u=Od(co.current),Jm(m)){k=m.stateNode,b=m.type;var z=m.memoizedProps;switch(k[Oi]=m,k[lc]=z,u=(m.mode&1)!==0,b){case"dialog":Sn("cancel",k),Sn("close",k);break;case"iframe":case"object":case"embed":Sn("load",k);break;case"video":case"audio":for(R=0;R<ic.length;R++)Sn(ic[R],k);break;case"source":Sn("error",k);break;case"img":case"image":case"link":Sn("error",k),Sn("load",k);break;case"details":Sn("toggle",k);break;case"input":we(k,z),Sn("invalid",k);break;case"select":k._wrapperState={wasMultiple:!!z.multiple},Sn("invalid",k);break;case"textarea":Ve(k,z),Sn("invalid",k)}Rn(b,z),R=null;for(var G in z)if(z.hasOwnProperty(G)){var fe=z[G];G==="children"?typeof fe=="string"?k.textContent!==fe&&(z.suppressHydrationWarning!==!0&&Ee(k.textContent,fe,u),R=["children",fe]):typeof fe=="number"&&k.textContent!==""+fe&&(z.suppressHydrationWarning!==!0&&Ee(k.textContent,fe,u),R=["children",""+fe]):s.hasOwnProperty(G)&&fe!=null&&G==="onScroll"&&Sn("scroll",k)}switch(b){case"input":Oe(k),Be(k,z,!0);break;case"textarea":Oe(k),Le(k);break;case"select":case"option":break;default:typeof z.onClick=="function"&&(k.onclick=We)}k=R,m.updateQueue=k,k!==null&&(m.flags|=4)}else{G=R.nodeType===9?R:R.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=rt(b)),u==="http://www.w3.org/1999/xhtml"?b==="script"?(u=G.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof k.is=="string"?u=G.createElement(b,{is:k.is}):(u=G.createElement(b),b==="select"&&(G=u,k.multiple?G.multiple=!0:k.size&&(G.size=k.size))):u=G.createElementNS(u,b),u[Oi]=m,u[lc]=k,CT(u,m,!1,!1),m.stateNode=u;e:{switch(G=Nn(b,k),b){case"dialog":Sn("cancel",u),Sn("close",u),R=k;break;case"iframe":case"object":case"embed":Sn("load",u),R=k;break;case"video":case"audio":for(R=0;R<ic.length;R++)Sn(ic[R],u);R=k;break;case"source":Sn("error",u),R=k;break;case"img":case"image":case"link":Sn("error",u),Sn("load",u),R=k;break;case"details":Sn("toggle",u),R=k;break;case"input":we(u,k),R=Fe(u,k),Sn("invalid",u);break;case"option":R=k;break;case"select":u._wrapperState={wasMultiple:!!k.multiple},R=oe({},k,{value:void 0}),Sn("invalid",u);break;case"textarea":Ve(u,k),R=ye(u,k),Sn("invalid",u);break;default:R=k}Rn(b,R),fe=R;for(z in fe)if(fe.hasOwnProperty(z)){var me=fe[z];z==="style"?Yt(u,me):z==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,me!=null&&qt(u,me)):z==="children"?typeof me=="string"?(b!=="textarea"||me!=="")&&bt(u,me):typeof me=="number"&&bt(u,""+me):z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&z!=="autoFocus"&&(s.hasOwnProperty(z)?me!=null&&z==="onScroll"&&Sn("scroll",u):me!=null&&D(u,z,me,G))}switch(b){case"input":Oe(u),Be(u,k,!1);break;case"textarea":Oe(u),Le(u);break;case"option":k.value!=null&&u.setAttribute("value",""+xe(k.value));break;case"select":u.multiple=!!k.multiple,z=k.value,z!=null?le(u,!!k.multiple,z,!1):k.defaultValue!=null&&le(u,!!k.multiple,k.defaultValue,!0);break;default:typeof R.onClick=="function"&&(u.onclick=We)}switch(b){case"button":case"input":case"select":case"textarea":k=!!k.autoFocus;break e;case"img":k=!0;break e;default:k=!1}}k&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return ts(m),null;case 6:if(u&&m.stateNode!=null)kT(u,m,u.memoizedProps,k);else{if(typeof k!="string"&&m.stateNode===null)throw Error(t(166));if(b=Od(sh.current),Od(co.current),Jm(m)){if(k=m.stateNode,b=m.memoizedProps,k[Oi]=m,(z=k.nodeValue!==b)&&(u=ai,u!==null))switch(u.tag){case 3:Ee(k.nodeValue,b,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&Ee(k.nodeValue,b,(u.mode&1)!==0)}z&&(m.flags|=4)}else k=(b.nodeType===9?b:b.ownerDocument).createTextNode(k),k[Oi]=m,m.stateNode=k}return ts(m),null;case 13:if(Ln(Gn),k=m.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(Bn&&oi!==null&&(m.mode&1)!==0&&(m.flags&128)===0)E1(),Du(),m.flags|=98560,z=!1;else if(z=Jm(m),k!==null&&k.dehydrated!==null){if(u===null){if(!z)throw Error(t(318));if(z=m.memoizedState,z=z!==null?z.dehydrated:null,!z)throw Error(t(317));z[Oi]=m}else Du(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;ts(m),z=!1}else ma!==null&&(Ov(ma),ma=null),z=!0;if(!z)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=b,m):(k=k!==null,k!==(u!==null&&u.memoizedState!==null)&&k&&(m.child.flags|=8192,(m.mode&1)!==0&&(u===null||(Gn.current&1)!==0?Sr===0&&(Sr=3):Rv())),m.updateQueue!==null&&(m.flags|=4),ts(m),null);case 4:return Ru(),_v(u,m),u===null&&ac(m.stateNode.containerInfo),ts(m),null;case 10:return Ky(m.type._context),ts(m),null;case 17:return As(m.type)&&Hm(),ts(m),null;case 19:if(Ln(Gn),z=m.memoizedState,z===null)return ts(m),null;if(k=(m.flags&128)!==0,G=z.rendering,G===null)if(k)ch(z,!1);else{if(Sr!==0||u!==null&&(u.flags&128)!==0)for(u=m.child;u!==null;){if(G=rp(u),G!==null){for(m.flags|=128,ch(z,!1),k=G.updateQueue,k!==null&&(m.updateQueue=k,m.flags|=4),m.subtreeFlags=0,k=b,b=m.child;b!==null;)z=b,u=k,z.flags&=14680066,G=z.alternate,G===null?(z.childLanes=0,z.lanes=u,z.child=null,z.subtreeFlags=0,z.memoizedProps=null,z.memoizedState=null,z.updateQueue=null,z.dependencies=null,z.stateNode=null):(z.childLanes=G.childLanes,z.lanes=G.lanes,z.child=G.child,z.subtreeFlags=0,z.deletions=null,z.memoizedProps=G.memoizedProps,z.memoizedState=G.memoizedState,z.updateQueue=G.updateQueue,z.type=G.type,u=G.dependencies,z.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),b=b.sibling;return On(Gn,Gn.current&1|2),m.child}u=u.sibling}z.tail!==null&&Cn()>zu&&(m.flags|=128,k=!0,ch(z,!1),m.lanes=4194304)}else{if(!k)if(u=rp(G),u!==null){if(m.flags|=128,k=!0,b=u.updateQueue,b!==null&&(m.updateQueue=b,m.flags|=4),ch(z,!0),z.tail===null&&z.tailMode==="hidden"&&!G.alternate&&!Bn)return ts(m),null}else 2*Cn()-z.renderingStartTime>zu&&b!==1073741824&&(m.flags|=128,k=!0,ch(z,!1),m.lanes=4194304);z.isBackwards?(G.sibling=m.child,m.child=G):(b=z.last,b!==null?b.sibling=G:m.child=G,z.last=G)}return z.tail!==null?(m=z.tail,z.rendering=m,z.tail=m.sibling,z.renderingStartTime=Cn(),m.sibling=null,b=Gn.current,On(Gn,k?b&1|2:b&1),m):(ts(m),null);case 22:case 23:return Av(),k=m.memoizedState!==null,u!==null&&u.memoizedState!==null!==k&&(m.flags|=8192),k&&(m.mode&1)!==0?(li&1073741824)!==0&&(ts(m),m.subtreeFlags&6&&(m.flags|=8192)):ts(m),null;case 24:return null;case 25:return null}throw Error(t(156,m.tag))}function mq(u,m){switch(Wy(m),m.tag){case 1:return As(m.type)&&Hm(),u=m.flags,u&65536?(m.flags=u&-65537|128,m):null;case 3:return Ru(),Ln(Is),Ln(Xr),rv(),u=m.flags,(u&65536)!==0&&(u&128)===0?(m.flags=u&-65537|128,m):null;case 5:return tv(m),null;case 13:if(Ln(Gn),u=m.memoizedState,u!==null&&u.dehydrated!==null){if(m.alternate===null)throw Error(t(340));Du()}return u=m.flags,u&65536?(m.flags=u&-65537|128,m):null;case 19:return Ln(Gn),null;case 4:return Ru(),null;case 10:return Ky(m.type._context),null;case 22:case 23:return Av(),null;case 24:return null;default:return null}}var fp=!1,ns=!1,pq=typeof WeakSet=="function"?WeakSet:Set,ct=null;function Fu(u,m){var b=u.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(k){tr(u,m,k)}else b.current=null}function jv(u,m,b){try{b()}catch(k){tr(u,m,k)}}var PT=!1;function gq(u,m){if(st=ca,u=Ko(),Jo(u)){if("selectionStart"in u)var b={start:u.selectionStart,end:u.selectionEnd};else e:{b=(b=u.ownerDocument)&&b.defaultView||window;var k=b.getSelection&&b.getSelection();if(k&&k.rangeCount!==0){b=k.anchorNode;var R=k.anchorOffset,z=k.focusNode;k=k.focusOffset;try{b.nodeType,z.nodeType}catch{b=null;break e}var G=0,fe=-1,me=-1,De=0,Ge=0,Ze=u,Ye=null;t:for(;;){for(var at;Ze!==b||R!==0&&Ze.nodeType!==3||(fe=G+R),Ze!==z||k!==0&&Ze.nodeType!==3||(me=G+k),Ze.nodeType===3&&(G+=Ze.nodeValue.length),(at=Ze.firstChild)!==null;)Ye=Ze,Ze=at;for(;;){if(Ze===u)break t;if(Ye===b&&++De===R&&(fe=G),Ye===z&&++Ge===k&&(me=G),(at=Ze.nextSibling)!==null)break;Ze=Ye,Ye=Ze.parentNode}Ze=at}b=fe===-1||me===-1?null:{start:fe,end:me}}else b=null}b=b||{start:0,end:0}}else b=null;for(Nt={focusedElem:u,selectionRange:b},ca=!1,ct=m;ct!==null;)if(m=ct,u=m.child,(m.subtreeFlags&1028)!==0&&u!==null)u.return=m,ct=u;else for(;ct!==null;){m=ct;try{var ut=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(ut!==null){var mt=ut.memoizedProps,sr=ut.memoizedState,Te=m.stateNode,be=Te.getSnapshotBeforeUpdate(m.elementType===m.type?mt:pa(m.type,mt),sr);Te.__reactInternalSnapshotBeforeUpdate=be}break;case 3:var ke=m.stateNode.containerInfo;ke.nodeType===1?ke.textContent="":ke.nodeType===9&&ke.documentElement&&ke.removeChild(ke.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Je){tr(m,m.return,Je)}if(u=m.sibling,u!==null){u.return=m.return,ct=u;break}ct=m.return}return ut=PT,PT=!1,ut}function dh(u,m,b){var k=m.updateQueue;if(k=k!==null?k.lastEffect:null,k!==null){var R=k=k.next;do{if((R.tag&u)===u){var z=R.destroy;R.destroy=void 0,z!==void 0&&jv(m,b,z)}R=R.next}while(R!==k)}}function hp(u,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var b=m=m.next;do{if((b.tag&u)===u){var k=b.create;b.destroy=k()}b=b.next}while(b!==m)}}function Nv(u){var m=u.ref;if(m!==null){var b=u.stateNode;switch(u.tag){case 5:u=b;break;default:u=b}typeof m=="function"?m(u):m.current=u}}function MT(u){var m=u.alternate;m!==null&&(u.alternate=null,MT(m)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(m=u.stateNode,m!==null&&(delete m[Oi],delete m[lc],delete m[cc],delete m[qy],delete m[zy])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function ET(u){return u.tag===5||u.tag===3||u.tag===4}function DT(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||ET(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Sv(u,m,b){var k=u.tag;if(k===5||k===6)u=u.stateNode,m?b.nodeType===8?b.parentNode.insertBefore(u,m):b.insertBefore(u,m):(b.nodeType===8?(m=b.parentNode,m.insertBefore(u,b)):(m=b,m.appendChild(u)),b=b._reactRootContainer,b!=null||m.onclick!==null||(m.onclick=We));else if(k!==4&&(u=u.child,u!==null))for(Sv(u,m,b),u=u.sibling;u!==null;)Sv(u,m,b),u=u.sibling}function Cv(u,m,b){var k=u.tag;if(k===5||k===6)u=u.stateNode,m?b.insertBefore(u,m):b.appendChild(u);else if(k!==4&&(u=u.child,u!==null))for(Cv(u,m,b),u=u.sibling;u!==null;)Cv(u,m,b),u=u.sibling}var Br=null,ga=!1;function pc(u,m,b){for(b=b.child;b!==null;)OT(u,m,b),b=b.sibling}function OT(u,m,b){if(Rr&&typeof Rr.onCommitFiberUnmount=="function")try{Rr.onCommitFiberUnmount(ra,b)}catch{}switch(b.tag){case 5:ns||Fu(b,m);case 6:var k=Br,R=ga;Br=null,pc(u,m,b),Br=k,ga=R,Br!==null&&(ga?(u=Br,b=b.stateNode,u.nodeType===8?u.parentNode.removeChild(b):u.removeChild(b)):Br.removeChild(b.stateNode));break;case 18:Br!==null&&(ga?(u=Br,b=b.stateNode,u.nodeType===8?eh(u.parentNode,b):u.nodeType===1&&eh(u,b),qr(u)):eh(Br,b.stateNode));break;case 4:k=Br,R=ga,Br=b.stateNode.containerInfo,ga=!0,pc(u,m,b),Br=k,ga=R;break;case 0:case 11:case 14:case 15:if(!ns&&(k=b.updateQueue,k!==null&&(k=k.lastEffect,k!==null))){R=k=k.next;do{var z=R,G=z.destroy;z=z.tag,G!==void 0&&((z&2)!==0||(z&4)!==0)&&jv(b,m,G),R=R.next}while(R!==k)}pc(u,m,b);break;case 1:if(!ns&&(Fu(b,m),k=b.stateNode,typeof k.componentWillUnmount=="function"))try{k.props=b.memoizedProps,k.state=b.memoizedState,k.componentWillUnmount()}catch(fe){tr(b,m,fe)}pc(u,m,b);break;case 21:pc(u,m,b);break;case 22:b.mode&1?(ns=(k=ns)||b.memoizedState!==null,pc(u,m,b),ns=k):pc(u,m,b);break;default:pc(u,m,b)}}function IT(u){var m=u.updateQueue;if(m!==null){u.updateQueue=null;var b=u.stateNode;b===null&&(b=u.stateNode=new pq),m.forEach(function(k){var R=Sq.bind(null,u,k);b.has(k)||(b.add(k),k.then(R,R))})}}function xa(u,m){var b=m.deletions;if(b!==null)for(var k=0;k<b.length;k++){var R=b[k];try{var z=u,G=m,fe=G;e:for(;fe!==null;){switch(fe.tag){case 5:Br=fe.stateNode,ga=!1;break e;case 3:Br=fe.stateNode.containerInfo,ga=!0;break e;case 4:Br=fe.stateNode.containerInfo,ga=!0;break e}fe=fe.return}if(Br===null)throw Error(t(160));OT(z,G,R),Br=null,ga=!1;var me=R.alternate;me!==null&&(me.return=null),R.return=null}catch(De){tr(R,m,De)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)AT(m,u),m=m.sibling}function AT(u,m){var b=u.alternate,k=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(xa(m,u),fo(u),k&4){try{dh(3,u,u.return),hp(3,u)}catch(mt){tr(u,u.return,mt)}try{dh(5,u,u.return)}catch(mt){tr(u,u.return,mt)}}break;case 1:xa(m,u),fo(u),k&512&&b!==null&&Fu(b,b.return);break;case 5:if(xa(m,u),fo(u),k&512&&b!==null&&Fu(b,b.return),u.flags&32){var R=u.stateNode;try{bt(R,"")}catch(mt){tr(u,u.return,mt)}}if(k&4&&(R=u.stateNode,R!=null)){var z=u.memoizedProps,G=b!==null?b.memoizedProps:z,fe=u.type,me=u.updateQueue;if(u.updateQueue=null,me!==null)try{fe==="input"&&z.type==="radio"&&z.name!=null&&Ne(R,z),Nn(fe,G);var De=Nn(fe,z);for(G=0;G<me.length;G+=2){var Ge=me[G],Ze=me[G+1];Ge==="style"?Yt(R,Ze):Ge==="dangerouslySetInnerHTML"?qt(R,Ze):Ge==="children"?bt(R,Ze):D(R,Ge,Ze,De)}switch(fe){case"input":Ue(R,z);break;case"textarea":ze(R,z);break;case"select":var Ye=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!z.multiple;var at=z.value;at!=null?le(R,!!z.multiple,at,!1):Ye!==!!z.multiple&&(z.defaultValue!=null?le(R,!!z.multiple,z.defaultValue,!0):le(R,!!z.multiple,z.multiple?[]:"",!1))}R[lc]=z}catch(mt){tr(u,u.return,mt)}}break;case 6:if(xa(m,u),fo(u),k&4){if(u.stateNode===null)throw Error(t(162));R=u.stateNode,z=u.memoizedProps;try{R.nodeValue=z}catch(mt){tr(u,u.return,mt)}}break;case 3:if(xa(m,u),fo(u),k&4&&b!==null&&b.memoizedState.isDehydrated)try{qr(m.containerInfo)}catch(mt){tr(u,u.return,mt)}break;case 4:xa(m,u),fo(u);break;case 13:xa(m,u),fo(u),R=u.child,R.flags&8192&&(z=R.memoizedState!==null,R.stateNode.isHidden=z,!z||R.alternate!==null&&R.alternate.memoizedState!==null||(Pv=Cn())),k&4&&IT(u);break;case 22:if(Ge=b!==null&&b.memoizedState!==null,u.mode&1?(ns=(De=ns)||Ge,xa(m,u),ns=De):xa(m,u),fo(u),k&8192){if(De=u.memoizedState!==null,(u.stateNode.isHidden=De)&&!Ge&&(u.mode&1)!==0)for(ct=u,Ge=u.child;Ge!==null;){for(Ze=ct=Ge;ct!==null;){switch(Ye=ct,at=Ye.child,Ye.tag){case 0:case 11:case 14:case 15:dh(4,Ye,Ye.return);break;case 1:Fu(Ye,Ye.return);var ut=Ye.stateNode;if(typeof ut.componentWillUnmount=="function"){k=Ye,b=Ye.return;try{m=k,ut.props=m.memoizedProps,ut.state=m.memoizedState,ut.componentWillUnmount()}catch(mt){tr(k,b,mt)}}break;case 5:Fu(Ye,Ye.return);break;case 22:if(Ye.memoizedState!==null){FT(Ze);continue}}at!==null?(at.return=Ye,ct=at):FT(Ze)}Ge=Ge.sibling}e:for(Ge=null,Ze=u;;){if(Ze.tag===5){if(Ge===null){Ge=Ze;try{R=Ze.stateNode,De?(z=R.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none"):(fe=Ze.stateNode,me=Ze.memoizedProps.style,G=me!=null&&me.hasOwnProperty("display")?me.display:null,fe.style.display=en("display",G))}catch(mt){tr(u,u.return,mt)}}}else if(Ze.tag===6){if(Ge===null)try{Ze.stateNode.nodeValue=De?"":Ze.memoizedProps}catch(mt){tr(u,u.return,mt)}}else if((Ze.tag!==22&&Ze.tag!==23||Ze.memoizedState===null||Ze===u)&&Ze.child!==null){Ze.child.return=Ze,Ze=Ze.child;continue}if(Ze===u)break e;for(;Ze.sibling===null;){if(Ze.return===null||Ze.return===u)break e;Ge===Ze&&(Ge=null),Ze=Ze.return}Ge===Ze&&(Ge=null),Ze.sibling.return=Ze.return,Ze=Ze.sibling}}break;case 19:xa(m,u),fo(u),k&4&&IT(u);break;case 21:break;default:xa(m,u),fo(u)}}function fo(u){var m=u.flags;if(m&2){try{e:{for(var b=u.return;b!==null;){if(ET(b)){var k=b;break e}b=b.return}throw Error(t(160))}switch(k.tag){case 5:var R=k.stateNode;k.flags&32&&(bt(R,""),k.flags&=-33);var z=DT(u);Cv(u,z,R);break;case 3:case 4:var G=k.stateNode.containerInfo,fe=DT(u);Sv(u,fe,G);break;default:throw Error(t(161))}}catch(me){tr(u,u.return,me)}u.flags&=-3}m&4096&&(u.flags&=-4097)}function xq(u,m,b){ct=u,RT(u)}function RT(u,m,b){for(var k=(u.mode&1)!==0;ct!==null;){var R=ct,z=R.child;if(R.tag===22&&k){var G=R.memoizedState!==null||fp;if(!G){var fe=R.alternate,me=fe!==null&&fe.memoizedState!==null||ns;fe=fp;var De=ns;if(fp=G,(ns=me)&&!De)for(ct=R;ct!==null;)G=ct,me=G.child,G.tag===22&&G.memoizedState!==null?qT(R):me!==null?(me.return=G,ct=me):qT(R);for(;z!==null;)ct=z,RT(z),z=z.sibling;ct=R,fp=fe,ns=De}LT(u)}else(R.subtreeFlags&8772)!==0&&z!==null?(z.return=R,ct=z):LT(u)}}function LT(u){for(;ct!==null;){var m=ct;if((m.flags&8772)!==0){var b=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:ns||hp(5,m);break;case 1:var k=m.stateNode;if(m.flags&4&&!ns)if(b===null)k.componentDidMount();else{var R=m.elementType===m.type?b.memoizedProps:pa(m.type,b.memoizedProps);k.componentDidUpdate(R,b.memoizedState,k.__reactInternalSnapshotBeforeUpdate)}var z=m.updateQueue;z!==null&&F1(m,z,k);break;case 3:var G=m.updateQueue;if(G!==null){if(b=null,m.child!==null)switch(m.child.tag){case 5:b=m.child.stateNode;break;case 1:b=m.child.stateNode}F1(m,G,b)}break;case 5:var fe=m.stateNode;if(b===null&&m.flags&4){b=fe;var me=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":me.autoFocus&&b.focus();break;case"img":me.src&&(b.src=me.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var De=m.alternate;if(De!==null){var Ge=De.memoizedState;if(Ge!==null){var Ze=Ge.dehydrated;Ze!==null&&qr(Ze)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ns||m.flags&512&&Nv(m)}catch(Ye){tr(m,m.return,Ye)}}if(m===u){ct=null;break}if(b=m.sibling,b!==null){b.return=m.return,ct=b;break}ct=m.return}}function FT(u){for(;ct!==null;){var m=ct;if(m===u){ct=null;break}var b=m.sibling;if(b!==null){b.return=m.return,ct=b;break}ct=m.return}}function qT(u){for(;ct!==null;){var m=ct;try{switch(m.tag){case 0:case 11:case 15:var b=m.return;try{hp(4,m)}catch(me){tr(m,b,me)}break;case 1:var k=m.stateNode;if(typeof k.componentDidMount=="function"){var R=m.return;try{k.componentDidMount()}catch(me){tr(m,R,me)}}var z=m.return;try{Nv(m)}catch(me){tr(m,z,me)}break;case 5:var G=m.return;try{Nv(m)}catch(me){tr(m,G,me)}}}catch(me){tr(m,m.return,me)}if(m===u){ct=null;break}var fe=m.sibling;if(fe!==null){fe.return=m.return,ct=fe;break}ct=m.return}}var yq=Math.ceil,mp=M.ReactCurrentDispatcher,Tv=M.ReactCurrentOwner,Fi=M.ReactCurrentBatchConfig,on=0,Or=null,mr=null,Wr=0,li=0,qu=dc(0),Sr=0,uh=null,Ad=0,pp=0,kv=0,fh=null,Ls=null,Pv=0,zu=1/0,cl=null,gp=!1,Mv=null,gc=null,xp=!1,xc=null,yp=0,hh=0,Ev=null,vp=-1,bp=0;function bs(){return(on&6)!==0?Cn():vp!==-1?vp:vp=Cn()}function yc(u){return(u.mode&1)===0?1:(on&2)!==0&&Wr!==0?Wr&-Wr:tq.transition!==null?(bp===0&&(bp=ql()),bp):(u=Kt,u!==0||(u=window.event,u=u===void 0?16:Ht(u.type)),u)}function ya(u,m,b,k){if(50<hh)throw hh=0,Ev=null,Error(t(185));Lr(u,b,k),((on&2)===0||u!==Or)&&(u===Or&&((on&2)===0&&(pp|=b),Sr===4&&vc(u,Wr)),Fs(u,k),b===1&&on===0&&(m.mode&1)===0&&(zu=Cn()+500,Gm&&fc()))}function Fs(u,m){var b=u.callbackNode;Va(u,m);var k=gn(u,u===Or?Wr:0);if(k===0)b!==null&&Do(b),u.callbackNode=null,u.callbackPriority=0;else if(m=k&-k,u.callbackPriority!==m){if(b!=null&&Do(b),m===1)u.tag===0?eq(UT.bind(null,u)):C1(UT.bind(null,u)),Qr(function(){(on&6)===0&&fc()}),b=null;else{switch(Ni(k)){case 1:b=Oo;break;case 4:b=Fl;break;case 16:b=za;break;case 536870912:b=bi;break;default:b=za}b=ZT(b,zT.bind(null,u))}u.callbackPriority=m,u.callbackNode=b}}function zT(u,m){if(vp=-1,bp=0,(on&6)!==0)throw Error(t(327));var b=u.callbackNode;if(Uu()&&u.callbackNode!==b)return null;var k=gn(u,u===Or?Wr:0);if(k===0)return null;if((k&30)!==0||(k&u.expiredLanes)!==0||m)m=wp(u,k);else{m=k;var R=on;on|=2;var z=BT();(Or!==u||Wr!==m)&&(cl=null,zu=Cn()+500,Ld(u,m));do try{wq();break}catch(fe){VT(u,fe)}while(!0);Zy(),mp.current=z,on=R,mr!==null?m=0:(Or=null,Wr=0,m=Sr)}if(m!==0){if(m===2&&(R=ur(u),R!==0&&(k=R,m=Dv(u,R))),m===1)throw b=uh,Ld(u,0),vc(u,k),Fs(u,Cn()),b;if(m===6)vc(u,k);else{if(R=u.current.alternate,(k&30)===0&&!vq(R)&&(m=wp(u,k),m===2&&(z=ur(u),z!==0&&(k=z,m=Dv(u,z))),m===1))throw b=uh,Ld(u,0),vc(u,k),Fs(u,Cn()),b;switch(u.finishedWork=R,u.finishedLanes=k,m){case 0:case 1:throw Error(t(345));case 2:Fd(u,Ls,cl);break;case 3:if(vc(u,k),(k&130023424)===k&&(m=Pv+500-Cn(),10<m)){if(gn(u,0)!==0)break;if(R=u.suspendedLanes,(R&k)!==k){bs(),u.pingedLanes|=u.suspendedLanes&R;break}u.timeoutHandle=jr(Fd.bind(null,u,Ls,cl),m);break}Fd(u,Ls,cl);break;case 4:if(vc(u,k),(k&4194240)===k)break;for(m=u.eventTimes,R=-1;0<k;){var G=31-Dt(k);z=1<<G,G=m[G],G>R&&(R=G),k&=~z}if(k=R,k=Cn()-k,k=(120>k?120:480>k?480:1080>k?1080:1920>k?1920:3e3>k?3e3:4320>k?4320:1960*yq(k/1960))-k,10<k){u.timeoutHandle=jr(Fd.bind(null,u,Ls,cl),k);break}Fd(u,Ls,cl);break;case 5:Fd(u,Ls,cl);break;default:throw Error(t(329))}}}return Fs(u,Cn()),u.callbackNode===b?zT.bind(null,u):null}function Dv(u,m){var b=fh;return u.current.memoizedState.isDehydrated&&(Ld(u,m).flags|=256),u=wp(u,m),u!==2&&(m=Ls,Ls=b,m!==null&&Ov(m)),u}function Ov(u){Ls===null?Ls=u:Ls.push.apply(Ls,u)}function vq(u){for(var m=u;;){if(m.flags&16384){var b=m.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var k=0;k<b.length;k++){var R=b[k],z=R.getSnapshot;R=R.value;try{if(!Vr(z(),R))return!1}catch{return!1}}}if(b=m.child,m.subtreeFlags&16384&&b!==null)b.return=m,m=b;else{if(m===u)break;for(;m.sibling===null;){if(m.return===null||m.return===u)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function vc(u,m){for(m&=~kv,m&=~pp,u.suspendedLanes|=m,u.pingedLanes&=~m,u=u.expirationTimes;0<m;){var b=31-Dt(m),k=1<<b;u[b]=-1,m&=~k}}function UT(u){if((on&6)!==0)throw Error(t(327));Uu();var m=gn(u,0);if((m&1)===0)return Fs(u,Cn()),null;var b=wp(u,m);if(u.tag!==0&&b===2){var k=ur(u);k!==0&&(m=k,b=Dv(u,k))}if(b===1)throw b=uh,Ld(u,0),vc(u,m),Fs(u,Cn()),b;if(b===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=m,Fd(u,Ls,cl),Fs(u,Cn()),null}function Iv(u,m){var b=on;on|=1;try{return u(m)}finally{on=b,on===0&&(zu=Cn()+500,Gm&&fc())}}function Rd(u){xc!==null&&xc.tag===0&&(on&6)===0&&Uu();var m=on;on|=1;var b=Fi.transition,k=Kt;try{if(Fi.transition=null,Kt=1,u)return u()}finally{Kt=k,Fi.transition=b,on=m,(on&6)===0&&fc()}}function Av(){li=qu.current,Ln(qu)}function Ld(u,m){u.finishedWork=null,u.finishedLanes=0;var b=u.timeoutHandle;if(b!==-1&&(u.timeoutHandle=-1,hr(b)),mr!==null)for(b=mr.return;b!==null;){var k=b;switch(Wy(k),k.tag){case 1:k=k.type.childContextTypes,k!=null&&Hm();break;case 3:Ru(),Ln(Is),Ln(Xr),rv();break;case 5:tv(k);break;case 4:Ru();break;case 13:Ln(Gn);break;case 19:Ln(Gn);break;case 10:Ky(k.type._context);break;case 22:case 23:Av()}b=b.return}if(Or=u,mr=u=bc(u.current,null),Wr=li=m,Sr=0,uh=null,kv=pp=Ad=0,Ls=fh=null,Dd!==null){for(m=0;m<Dd.length;m++)if(b=Dd[m],k=b.interleaved,k!==null){b.interleaved=null;var R=k.next,z=b.pending;if(z!==null){var G=z.next;z.next=R,k.next=G}b.pending=k}Dd=null}return u}function VT(u,m){do{var b=mr;try{if(Zy(),sp.current=lp,ip){for(var k=Zn.memoizedState;k!==null;){var R=k.queue;R!==null&&(R.pending=null),k=k.next}ip=!1}if(Id=0,Dr=Nr=Zn=null,ih=!1,ah=0,Tv.current=null,b===null||b.return===null){Sr=1,uh=m,mr=null;break}e:{var z=u,G=b.return,fe=b,me=m;if(m=Wr,fe.flags|=32768,me!==null&&typeof me=="object"&&typeof me.then=="function"){var De=me,Ge=fe,Ze=Ge.tag;if((Ge.mode&1)===0&&(Ze===0||Ze===11||Ze===15)){var Ye=Ge.alternate;Ye?(Ge.updateQueue=Ye.updateQueue,Ge.memoizedState=Ye.memoizedState,Ge.lanes=Ye.lanes):(Ge.updateQueue=null,Ge.memoizedState=null)}var at=hT(G);if(at!==null){at.flags&=-257,mT(at,G,fe,z,m),at.mode&1&&fT(z,De,m),m=at,me=De;var ut=m.updateQueue;if(ut===null){var mt=new Set;mt.add(me),m.updateQueue=mt}else ut.add(me);break e}else{if((m&1)===0){fT(z,De,m),Rv();break e}me=Error(t(426))}}else if(Bn&&fe.mode&1){var sr=hT(G);if(sr!==null){(sr.flags&65536)===0&&(sr.flags|=256),mT(sr,G,fe,z,m),Yy(Lu(me,fe));break e}}z=me=Lu(me,fe),Sr!==4&&(Sr=2),fh===null?fh=[z]:fh.push(z),z=G;do{switch(z.tag){case 3:z.flags|=65536,m&=-m,z.lanes|=m;var Te=dT(z,me,m);L1(z,Te);break e;case 1:fe=me;var be=z.type,ke=z.stateNode;if((z.flags&128)===0&&(typeof be.getDerivedStateFromError=="function"||ke!==null&&typeof ke.componentDidCatch=="function"&&(gc===null||!gc.has(ke)))){z.flags|=65536,m&=-m,z.lanes|=m;var Je=uT(z,fe,m);L1(z,Je);break e}}z=z.return}while(z!==null)}$T(b)}catch(pt){m=pt,mr===b&&b!==null&&(mr=b=b.return);continue}break}while(!0)}function BT(){var u=mp.current;return mp.current=lp,u===null?lp:u}function Rv(){(Sr===0||Sr===3||Sr===2)&&(Sr=4),Or===null||(Ad&268435455)===0&&(pp&268435455)===0||vc(Or,Wr)}function wp(u,m){var b=on;on|=2;var k=BT();(Or!==u||Wr!==m)&&(cl=null,Ld(u,m));do try{bq();break}catch(R){VT(u,R)}while(!0);if(Zy(),on=b,mp.current=k,mr!==null)throw Error(t(261));return Or=null,Wr=0,Sr}function bq(){for(;mr!==null;)WT(mr)}function wq(){for(;mr!==null&&!ud();)WT(mr)}function WT(u){var m=GT(u.alternate,u,li);u.memoizedProps=u.pendingProps,m===null?$T(u):mr=m,Tv.current=null}function $T(u){var m=u;do{var b=m.alternate;if(u=m.return,(m.flags&32768)===0){if(b=hq(b,m,li),b!==null){mr=b;return}}else{if(b=mq(b,m),b!==null){b.flags&=32767,mr=b;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{Sr=6,mr=null;return}}if(m=m.sibling,m!==null){mr=m;return}mr=m=u}while(m!==null);Sr===0&&(Sr=5)}function Fd(u,m,b){var k=Kt,R=Fi.transition;try{Fi.transition=null,Kt=1,_q(u,m,b,k)}finally{Fi.transition=R,Kt=k}return null}function _q(u,m,b,k){do Uu();while(xc!==null);if((on&6)!==0)throw Error(t(327));b=u.finishedWork;var R=u.finishedLanes;if(b===null)return null;if(u.finishedWork=null,u.finishedLanes=0,b===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var z=b.lanes|b.childLanes;if(Dn(u,z),u===Or&&(mr=Or=null,Wr=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||xp||(xp=!0,ZT(za,function(){return Uu(),null})),z=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||z){z=Fi.transition,Fi.transition=null;var G=Kt;Kt=1;var fe=on;on|=4,Tv.current=null,gq(u,b),AT(b,u),g(Nt),ca=!!st,Nt=st=null,u.current=b,xq(b),qa(),on=fe,Kt=G,Fi.transition=z}else u.current=b;if(xp&&(xp=!1,xc=u,yp=R),z=u.pendingLanes,z===0&&(gc=null),sa(b.stateNode),Fs(u,Cn()),m!==null)for(k=u.onRecoverableError,b=0;b<m.length;b++)R=m[b],k(R.value,{componentStack:R.stack,digest:R.digest});if(gp)throw gp=!1,u=Mv,Mv=null,u;return(yp&1)!==0&&u.tag!==0&&Uu(),z=u.pendingLanes,(z&1)!==0?u===Ev?hh++:(hh=0,Ev=u):hh=0,fc(),null}function Uu(){if(xc!==null){var u=Ni(yp),m=Fi.transition,b=Kt;try{if(Fi.transition=null,Kt=16>u?16:u,xc===null)var k=!1;else{if(u=xc,xc=null,yp=0,(on&6)!==0)throw Error(t(331));var R=on;for(on|=4,ct=u.current;ct!==null;){var z=ct,G=z.child;if((ct.flags&16)!==0){var fe=z.deletions;if(fe!==null){for(var me=0;me<fe.length;me++){var De=fe[me];for(ct=De;ct!==null;){var Ge=ct;switch(Ge.tag){case 0:case 11:case 15:dh(8,Ge,z)}var Ze=Ge.child;if(Ze!==null)Ze.return=Ge,ct=Ze;else for(;ct!==null;){Ge=ct;var Ye=Ge.sibling,at=Ge.return;if(MT(Ge),Ge===De){ct=null;break}if(Ye!==null){Ye.return=at,ct=Ye;break}ct=at}}}var ut=z.alternate;if(ut!==null){var mt=ut.child;if(mt!==null){ut.child=null;do{var sr=mt.sibling;mt.sibling=null,mt=sr}while(mt!==null)}}ct=z}}if((z.subtreeFlags&2064)!==0&&G!==null)G.return=z,ct=G;else e:for(;ct!==null;){if(z=ct,(z.flags&2048)!==0)switch(z.tag){case 0:case 11:case 15:dh(9,z,z.return)}var Te=z.sibling;if(Te!==null){Te.return=z.return,ct=Te;break e}ct=z.return}}var be=u.current;for(ct=be;ct!==null;){G=ct;var ke=G.child;if((G.subtreeFlags&2064)!==0&&ke!==null)ke.return=G,ct=ke;else e:for(G=be;ct!==null;){if(fe=ct,(fe.flags&2048)!==0)try{switch(fe.tag){case 0:case 11:case 15:hp(9,fe)}}catch(pt){tr(fe,fe.return,pt)}if(fe===G){ct=null;break e}var Je=fe.sibling;if(Je!==null){Je.return=fe.return,ct=Je;break e}ct=fe.return}}if(on=R,fc(),Rr&&typeof Rr.onPostCommitFiberRoot=="function")try{Rr.onPostCommitFiberRoot(ra,u)}catch{}k=!0}return k}finally{Kt=b,Fi.transition=m}}return!1}function HT(u,m,b){m=Lu(b,m),m=dT(u,m,1),u=mc(u,m,1),m=bs(),u!==null&&(Lr(u,1,m),Fs(u,m))}function tr(u,m,b){if(u.tag===3)HT(u,u,b);else for(;m!==null;){if(m.tag===3){HT(m,u,b);break}else if(m.tag===1){var k=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(gc===null||!gc.has(k))){u=Lu(b,u),u=uT(m,u,1),m=mc(m,u,1),u=bs(),m!==null&&(Lr(m,1,u),Fs(m,u));break}}m=m.return}}function jq(u,m,b){var k=u.pingCache;k!==null&&k.delete(m),m=bs(),u.pingedLanes|=u.suspendedLanes&b,Or===u&&(Wr&b)===b&&(Sr===4||Sr===3&&(Wr&130023424)===Wr&&500>Cn()-Pv?Ld(u,0):kv|=b),Fs(u,m)}function YT(u,m){m===0&&((u.mode&1)===0?m=1:(m=_i,_i<<=1,(_i&130023424)===0&&(_i=4194304)));var b=bs();u=al(u,m),u!==null&&(Lr(u,m,b),Fs(u,b))}function Nq(u){var m=u.memoizedState,b=0;m!==null&&(b=m.retryLane),YT(u,b)}function Sq(u,m){var b=0;switch(u.tag){case 13:var k=u.stateNode,R=u.memoizedState;R!==null&&(b=R.retryLane);break;case 19:k=u.stateNode;break;default:throw Error(t(314))}k!==null&&k.delete(m),YT(u,b)}var GT;GT=function(u,m,b){if(u!==null)if(u.memoizedProps!==m.pendingProps||Is.current)Rs=!0;else{if((u.lanes&b)===0&&(m.flags&128)===0)return Rs=!1,fq(u,m,b);Rs=(u.flags&131072)!==0}else Rs=!1,Bn&&(m.flags&1048576)!==0&&T1(m,Km,m.index);switch(m.lanes=0,m.tag){case 2:var k=m.type;up(u,m),u=m.pendingProps;var R=Pu(m,Xr.current);Au(m,b),R=av(null,m,k,u,R,b);var z=ov();return m.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,As(k)?(z=!0,Ym(m)):z=!1,m.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,Xy(m),R.updater=cp,m.stateNode=R,R._reactInternals=m,hv(m,k,u,b),m=xv(null,m,k,!0,z,b)):(m.tag=0,Bn&&z&&By(m),vs(null,m,R,b),m=m.child),m;case 16:k=m.elementType;e:{switch(up(u,m),u=m.pendingProps,R=k._init,k=R(k._payload),m.type=k,R=m.tag=Tq(k),u=pa(k,u),R){case 0:m=gv(null,m,k,u,b);break e;case 1:m=bT(null,m,k,u,b);break e;case 11:m=pT(null,m,k,u,b);break e;case 14:m=gT(null,m,k,pa(k.type,u),b);break e}throw Error(t(306,k,""))}return m;case 0:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:pa(k,R),gv(u,m,k,R,b);case 1:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:pa(k,R),bT(u,m,k,R,b);case 3:e:{if(wT(m),u===null)throw Error(t(387));k=m.pendingProps,z=m.memoizedState,R=z.element,R1(u,m),np(m,k,null,b);var G=m.memoizedState;if(k=G.element,z.isDehydrated)if(z={element:k,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},m.updateQueue.baseState=z,m.memoizedState=z,m.flags&256){R=Lu(Error(t(423)),m),m=_T(u,m,k,b,R);break e}else if(k!==R){R=Lu(Error(t(424)),m),m=_T(u,m,k,b,R);break e}else for(oi=lo(m.stateNode.containerInfo.firstChild),ai=m,Bn=!0,ma=null,b=I1(m,null,k,b),m.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Du(),k===R){m=ll(u,m,b);break e}vs(u,m,k,b)}m=m.child}return m;case 5:return q1(m),u===null&&Hy(m),k=m.type,R=m.pendingProps,z=u!==null?u.memoizedProps:null,G=R.children,$t(k,R)?G=null:z!==null&&$t(k,z)&&(m.flags|=32),vT(u,m),vs(u,m,G,b),m.child;case 6:return u===null&&Hy(m),null;case 13:return jT(u,m,b);case 4:return ev(m,m.stateNode.containerInfo),k=m.pendingProps,u===null?m.child=Ou(m,null,k,b):vs(u,m,k,b),m.child;case 11:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:pa(k,R),pT(u,m,k,R,b);case 7:return vs(u,m,m.pendingProps,b),m.child;case 8:return vs(u,m,m.pendingProps.children,b),m.child;case 12:return vs(u,m,m.pendingProps.children,b),m.child;case 10:e:{if(k=m.type._context,R=m.pendingProps,z=m.memoizedProps,G=R.value,On(Xm,k._currentValue),k._currentValue=G,z!==null)if(Vr(z.value,G)){if(z.children===R.children&&!Is.current){m=ll(u,m,b);break e}}else for(z=m.child,z!==null&&(z.return=m);z!==null;){var fe=z.dependencies;if(fe!==null){G=z.child;for(var me=fe.firstContext;me!==null;){if(me.context===k){if(z.tag===1){me=ol(-1,b&-b),me.tag=2;var De=z.updateQueue;if(De!==null){De=De.shared;var Ge=De.pending;Ge===null?me.next=me:(me.next=Ge.next,Ge.next=me),De.pending=me}}z.lanes|=b,me=z.alternate,me!==null&&(me.lanes|=b),Jy(z.return,b,m),fe.lanes|=b;break}me=me.next}}else if(z.tag===10)G=z.type===m.type?null:z.child;else if(z.tag===18){if(G=z.return,G===null)throw Error(t(341));G.lanes|=b,fe=G.alternate,fe!==null&&(fe.lanes|=b),Jy(G,b,m),G=z.sibling}else G=z.child;if(G!==null)G.return=z;else for(G=z;G!==null;){if(G===m){G=null;break}if(z=G.sibling,z!==null){z.return=G.return,G=z;break}G=G.return}z=G}vs(u,m,R.children,b),m=m.child}return m;case 9:return R=m.type,k=m.pendingProps.children,Au(m,b),R=Ri(R),k=k(R),m.flags|=1,vs(u,m,k,b),m.child;case 14:return k=m.type,R=pa(k,m.pendingProps),R=pa(k.type,R),gT(u,m,k,R,b);case 15:return xT(u,m,m.type,m.pendingProps,b);case 17:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:pa(k,R),up(u,m),m.tag=1,As(k)?(u=!0,Ym(m)):u=!1,Au(m,b),lT(m,k,R),hv(m,k,R,b),xv(null,m,k,!0,u,b);case 19:return ST(u,m,b);case 22:return yT(u,m,b)}throw Error(t(156,m.tag))};function ZT(u,m){return Ll(u,m)}function Cq(u,m,b,k){this.tag=u,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qi(u,m,b,k){return new Cq(u,m,b,k)}function Lv(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Tq(u){if(typeof u=="function")return Lv(u)?1:0;if(u!=null){if(u=u.$$typeof,u===$)return 11;if(u===ae)return 14}return 2}function bc(u,m){var b=u.alternate;return b===null?(b=qi(u.tag,m,u.key,u.mode),b.elementType=u.elementType,b.type=u.type,b.stateNode=u.stateNode,b.alternate=u,u.alternate=b):(b.pendingProps=m,b.type=u.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=u.flags&14680064,b.childLanes=u.childLanes,b.lanes=u.lanes,b.child=u.child,b.memoizedProps=u.memoizedProps,b.memoizedState=u.memoizedState,b.updateQueue=u.updateQueue,m=u.dependencies,b.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},b.sibling=u.sibling,b.index=u.index,b.ref=u.ref,b}function _p(u,m,b,k,R,z){var G=2;if(k=u,typeof u=="function")Lv(u)&&(G=1);else if(typeof u=="string")G=5;else e:switch(u){case q:return qd(b.children,R,z,m);case F:G=8,R|=8;break;case V:return u=qi(12,b,m,R|2),u.elementType=V,u.lanes=z,u;case ne:return u=qi(13,b,m,R),u.elementType=ne,u.lanes=z,u;case Y:return u=qi(19,b,m,R),u.elementType=Y,u.lanes=z,u;case ee:return jp(b,R,z,m);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case U:G=10;break e;case W:G=9;break e;case $:G=11;break e;case ae:G=14;break e;case J:G=16,k=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return m=qi(G,b,m,R),m.elementType=u,m.type=k,m.lanes=z,m}function qd(u,m,b,k){return u=qi(7,u,k,m),u.lanes=b,u}function jp(u,m,b,k){return u=qi(22,u,k,m),u.elementType=ee,u.lanes=b,u.stateNode={isHidden:!1},u}function Fv(u,m,b){return u=qi(6,u,null,m),u.lanes=b,u}function qv(u,m,b){return m=qi(4,u.children!==null?u.children:[],u.key,m),m.lanes=b,m.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},m}function kq(u,m,b,k,R){this.tag=m,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ji(0),this.expirationTimes=ji(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ji(0),this.identifierPrefix=k,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function zv(u,m,b,k,R,z,G,fe,me){return u=new kq(u,m,b,fe,me),m===1?(m=1,z===!0&&(m|=8)):m=0,z=qi(3,null,null,m),u.current=z,z.stateNode=u,z.memoizedState={element:k,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xy(z),u}function Pq(u,m,b){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:k==null?null:""+k,children:u,containerInfo:m,implementation:b}}function KT(u){if(!u)return uc;u=u._reactInternals;e:{if(ks(u)!==u||u.tag!==1)throw Error(t(170));var m=u;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(As(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(t(171))}if(u.tag===1){var b=u.type;if(As(b))return N1(u,b,m)}return m}function JT(u,m,b,k,R,z,G,fe,me){return u=zv(b,k,!0,u,R,z,G,fe,me),u.context=KT(null),b=u.current,k=bs(),R=yc(b),z=ol(k,R),z.callback=m??null,mc(b,z,R),u.current.lanes=R,Lr(u,R,k),Fs(u,k),u}function Np(u,m,b,k){var R=m.current,z=bs(),G=yc(R);return b=KT(b),m.context===null?m.context=b:m.pendingContext=b,m=ol(z,G),m.payload={element:u},k=k===void 0?null:k,k!==null&&(m.callback=k),u=mc(R,m,G),u!==null&&(ya(u,R,G,z),tp(u,R,G)),G}function Sp(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function QT(u,m){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var b=u.retryLane;u.retryLane=b!==0&&b<m?b:m}}function Uv(u,m){QT(u,m),(u=u.alternate)&&QT(u,m)}function Mq(){return null}var XT=typeof reportError=="function"?reportError:function(u){console.error(u)};function Vv(u){this._internalRoot=u}Cp.prototype.render=Vv.prototype.render=function(u){var m=this._internalRoot;if(m===null)throw Error(t(409));Np(u,m,null,null)},Cp.prototype.unmount=Vv.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var m=u.containerInfo;Rd(function(){Np(null,u,null,null)}),m[xn]=null}};function Cp(u){this._internalRoot=u}Cp.prototype.unstable_scheduleHydration=function(u){if(u){var m=$a();u={blockedOn:null,target:u,priority:m};for(var b=0;b<Yn.length&&m!==0&&m<Yn[b].priority;b++);Yn.splice(b,0,u),b===0&&Ha(u)}};function Bv(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function Tp(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function ek(){}function Eq(u,m,b,k,R){if(R){if(typeof k=="function"){var z=k;k=function(){var De=Sp(G);z.call(De)}}var G=JT(m,k,u,0,null,!1,!1,"",ek);return u._reactRootContainer=G,u[xn]=G.current,ac(u.nodeType===8?u.parentNode:u),Rd(),G}for(;R=u.lastChild;)u.removeChild(R);if(typeof k=="function"){var fe=k;k=function(){var De=Sp(me);fe.call(De)}}var me=zv(u,0,!1,null,null,!1,!1,"",ek);return u._reactRootContainer=me,u[xn]=me.current,ac(u.nodeType===8?u.parentNode:u),Rd(function(){Np(m,me,b,k)}),me}function kp(u,m,b,k,R){var z=b._reactRootContainer;if(z){var G=z;if(typeof R=="function"){var fe=R;R=function(){var me=Sp(G);fe.call(me)}}Np(m,G,u,R)}else G=Eq(b,m,u,R,k);return Sp(G)}Ba=function(u){switch(u.tag){case 3:var m=u.stateNode;if(m.current.memoizedState.isDehydrated){var b=Mt(m.pendingLanes);b!==0&&(hs(m,b|1),Fs(m,Cn()),(on&6)===0&&(zu=Cn()+500,fc()))}break;case 13:Rd(function(){var k=al(u,1);if(k!==null){var R=bs();ya(k,u,1,R)}}),Uv(u,1)}},Qs=function(u){if(u.tag===13){var m=al(u,134217728);if(m!==null){var b=bs();ya(m,u,134217728,b)}Uv(u,134217728)}},Wa=function(u){if(u.tag===13){var m=yc(u),b=al(u,m);if(b!==null){var k=bs();ya(b,u,m,k)}Uv(u,m)}},$a=function(){return Kt},ia=function(u,m){var b=Kt;try{return Kt=u,m()}finally{Kt=b}},Hn=function(u,m,b){switch(m){case"input":if(Ue(u,b),m=b.name,b.type==="radio"&&m!=null){for(b=u;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<b.length;m++){var k=b[m];if(k!==u&&k.form===u.form){var R=Tu(k);if(!R)throw Error(t(90));Pe(k),Ue(k,R)}}}break;case"textarea":ze(u,b);break;case"select":m=b.value,m!=null&&le(u,!!b.multiple,m,!1)}},Ks=Iv,Gr=Rd;var Dq={usingClientEntryPoint:!1,Events:[tl,nl,Tu,vn,us,Iv]},mh={findFiberByHostInstance:el,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Oq={bundleType:mh.bundleType,version:mh.version,rendererPackageName:mh.rendererPackageName,rendererConfig:mh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Al(u),u===null?null:u.stateNode},findFiberByHostInstance:mh.findFiberByHostInstance||Mq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pp.isDisabled&&Pp.supportsFiber)try{ra=Pp.inject(Oq),Rr=Pp}catch{}}return qs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dq,qs.createPortal=function(u,m){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bv(m))throw Error(t(200));return Pq(u,m,null,b)},qs.createRoot=function(u,m){if(!Bv(u))throw Error(t(299));var b=!1,k="",R=XT;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(k=m.identifierPrefix),m.onRecoverableError!==void 0&&(R=m.onRecoverableError)),m=zv(u,1,!1,null,null,b,!1,k,R),u[xn]=m.current,ac(u.nodeType===8?u.parentNode:u),new Vv(m)},qs.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var m=u._reactInternals;if(m===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Al(m),u=u===null?null:u.stateNode,u},qs.flushSync=function(u){return Rd(u)},qs.hydrate=function(u,m,b){if(!Tp(m))throw Error(t(200));return kp(null,u,m,!0,b)},qs.hydrateRoot=function(u,m,b){if(!Bv(u))throw Error(t(405));var k=b!=null&&b.hydratedSources||null,R=!1,z="",G=XT;if(b!=null&&(b.unstable_strictMode===!0&&(R=!0),b.identifierPrefix!==void 0&&(z=b.identifierPrefix),b.onRecoverableError!==void 0&&(G=b.onRecoverableError)),m=JT(m,null,u,1,b??null,R,!1,z,G),u[xn]=m.current,ac(u),k)for(u=0;u<k.length;u++)b=k[u],R=b._getVersion,R=R(b._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[b,R]:m.mutableSourceEagerHydrationData.push(b,R);return new Cp(m)},qs.render=function(u,m,b){if(!Tp(m))throw Error(t(200));return kp(null,u,m,!1,b)},qs.unmountComponentAtNode=function(u){if(!Tp(u))throw Error(t(40));return u._reactRootContainer?(Rd(function(){kp(null,null,u,!1,function(){u._reactRootContainer=null,u[xn]=null})}),!0):!1},qs.unstable_batchedUpdates=Iv,qs.unstable_renderSubtreeIntoContainer=function(u,m,b,k){if(!Tp(b))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return kp(u,m,b,!1,k)},qs.version="18.3.1-next-f1338f8080-20240426",qs}var lk;function s4(){if(lk)return Hv.exports;lk=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Hv.exports=zq(),Hv.exports}var ck;function Uq(){if(ck)return Mp;ck=1;var n=s4();return Mp.createRoot=n.createRoot,Mp.hydrateRoot=n.hydrateRoot,Mp}var Vq=Uq();const Bq=gu(Vq);var i4=s4();function sm(){return sm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},sm.apply(this,arguments)}var Oc;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Oc||(Oc={}));const dk="popstate";function Wq(n){n===void 0&&(n={});function e(s,a){let{pathname:o="/",search:l="",hash:c=""}=xu(s.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),zN("",{pathname:o,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,d=c.indexOf("#");l=d===-1?c:c.slice(0,d)}return l+"#"+(typeof a=="string"?a:px(a))}function r(s,a){Gx(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(a)+")")}return Hq(e,t,r,n)}function er(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Gx(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function $q(){return Math.random().toString(36).substr(2,8)}function uk(n,e){return{usr:n.state,key:n.key,idx:e}}function zN(n,e,t,r){return t===void 0&&(t=null),sm({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?xu(e):e,{state:t,key:e&&e.key||r||$q()})}function px(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function xu(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function Hq(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:a=!1}=r,o=s.history,l=Oc.Pop,c=null,d=h();d==null&&(d=0,o.replaceState(sm({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function p(){l=Oc.Pop;let j=h(),T=j==null?null:j-d;d=j,c&&c({action:l,location:_.location,delta:T})}function x(j,T){l=Oc.Push;let P=zN(_.location,j,T);t&&t(P,j),d=h()+1;let D=uk(P,d),M=_.createHref(P);try{o.pushState(D,"",M)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(M)}a&&c&&c({action:l,location:_.location,delta:1})}function v(j,T){l=Oc.Replace;let P=zN(_.location,j,T);t&&t(P,j),d=h();let D=uk(P,d),M=_.createHref(P);o.replaceState(D,"",M),a&&c&&c({action:l,location:_.location,delta:0})}function w(j){let T=s.location.origin!=="null"?s.location.origin:s.location.href,P=typeof j=="string"?j:px(j);return P=P.replace(/ $/,"%20"),er(T,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,T)}let _={get action(){return l},get location(){return n(s,o)},listen(j){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(dk,p),c=j,()=>{s.removeEventListener(dk,p),c=null}},createHref(j){return e(s,j)},createURL:w,encodeLocation(j){let T=w(j);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:x,replace:v,go(j){return o.go(j)}};return _}var fk;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(fk||(fk={}));function Yq(n,e,t){return t===void 0&&(t="/"),Gq(n,e,t)}function Gq(n,e,t,r){let s=typeof e=="string"?xu(e):e,a=yf(s.pathname||"/",t);if(a==null)return null;let o=a4(n);Zq(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=az(a);l=sz(o[c],d)}return l}function a4(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(er(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=Fc([r,c.relativePath]),h=t.concat(c);a.children&&a.children.length>0&&(er(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),a4(a.children,e,h,d)),!(a.path==null&&!a.index)&&e.push({path:d,score:nz(d,a.index),routesMeta:h})};return n.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,o);else for(let c of o4(a.path))s(a,o,c)}),e}function o4(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let o=o4(r.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function Zq(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:rz(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Kq=/^:[\w-]+$/,Jq=3,Qq=2,Xq=1,ez=10,tz=-2,hk=n=>n==="*";function nz(n,e){let t=n.split("/"),r=t.length;return t.some(hk)&&(r+=tz),e&&(r+=Qq),t.filter(s=>!hk(s)).reduce((s,a)=>s+(Kq.test(a)?Jq:a===""?Xq:ez),r)}function rz(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function sz(n,e,t){let{routesMeta:r}=n,s={},a="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=UN({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),x=c.route;if(!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:Fc([a,p.pathname]),pathnameBase:uz(Fc([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=Fc([a,p.pathnameBase]))}return o}function UN(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=iz(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,h,p)=>{let{paramName:x,isOptional:v}=h;if(x==="*"){let _=l[p]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const w=l[p];return v&&!w?d[x]=void 0:d[x]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function iz(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Gx(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function az(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gx(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function yf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const oz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,lz=n=>oz.test(n);function cz(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?xu(n):n,a;if(t)if(lz(t))a=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Gx(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+t))}t.startsWith("/")?a=mk(t.substring(1),"/"):a=mk(t,e)}else a=e;return{pathname:a,search:fz(r),hash:hz(s)}}function mk(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Zv(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dz(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function nC(n,e){let t=dz(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function rC(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=xu(n):(s=sm({},n),er(!s.pathname||!s.pathname.includes("?"),Zv("?","pathname","search",s)),er(!s.pathname||!s.pathname.includes("#"),Zv("#","pathname","hash",s)),er(!s.search||!s.search.includes("#"),Zv("#","search","hash",s)));let a=n===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),p-=1;s.pathname=x.join("/")}l=p>=0?e[p]:"/"}let c=cz(s,l),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const Fc=n=>n.join("/").replace(/\/\/+/g,"/"),uz=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),fz=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,hz=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function mz(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const l4=["post","put","patch","delete"];new Set(l4);const pz=["get",...l4];new Set(pz);function im(){return im=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},im.apply(this,arguments)}const Zx=E.createContext(null),c4=E.createContext(null),Pl=E.createContext(null),Kx=E.createContext(null),To=E.createContext({outlet:null,matches:[],isDataRoute:!1}),d4=E.createContext(null);function gz(n,e){let{relative:t}=e===void 0?{}:e;Lf()||er(!1);let{basename:r,navigator:s}=E.useContext(Pl),{hash:a,pathname:o,search:l}=Jx(n,{relative:t}),c=o;return r!=="/"&&(c=o==="/"?r:Fc([r,o])),s.createHref({pathname:c,search:l,hash:a})}function Lf(){return E.useContext(Kx)!=null}function ds(){return Lf()||er(!1),E.useContext(Kx).location}function u4(n){E.useContext(Pl).static||E.useLayoutEffect(n)}function St(){let{isDataRoute:n}=E.useContext(To);return n?Mz():xz()}function xz(){Lf()||er(!1);let n=E.useContext(Zx),{basename:e,future:t,navigator:r}=E.useContext(Pl),{matches:s}=E.useContext(To),{pathname:a}=ds(),o=JSON.stringify(nC(s,t.v7_relativeSplatPath)),l=E.useRef(!1);return u4(()=>{l.current=!0}),E.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let p=rC(d,JSON.parse(o),a,h.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Fc([e,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[e,r,o,a,n])}const f4=E.createContext(null);function vi(){return E.useContext(f4)}function yz(n){let e=E.useContext(To).outlet;return e&&E.createElement(f4.Provider,{value:n},e)}function Ff(){let{matches:n}=E.useContext(To),e=n[n.length-1];return e?e.params:{}}function Jx(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=E.useContext(Pl),{matches:s}=E.useContext(To),{pathname:a}=ds(),o=JSON.stringify(nC(s,r.v7_relativeSplatPath));return E.useMemo(()=>rC(n,JSON.parse(o),a,t==="path"),[n,o,a,t])}function vz(n,e){return bz(n,e)}function bz(n,e,t,r){Lf()||er(!1);let{navigator:s}=E.useContext(Pl),{matches:a}=E.useContext(To),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=ds(),h;if(e){var p;let j=typeof e=="string"?xu(e):e;c==="/"||(p=j.pathname)!=null&&p.startsWith(c)||er(!1),h=j}else h=d;let x=h.pathname||"/",v=x;if(c!=="/"){let j=c.replace(/^\//,"").split("/");v="/"+x.replace(/^\//,"").split("/").slice(j.length).join("/")}let w=Yq(n,{pathname:v}),_=Sz(w&&w.map(j=>Object.assign({},j,{params:Object.assign({},l,j.params),pathname:Fc([c,s.encodeLocation?s.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?c:Fc([c,s.encodeLocation?s.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),a,t,r);return e&&_?E.createElement(Kx.Provider,{value:{location:im({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Oc.Pop}},_):_}function wz(){let n=Pz(),e=mz(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),t?E.createElement("pre",{style:s},t):null,null)}const _z=E.createElement(wz,null);class jz extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?E.createElement(To.Provider,{value:this.props.routeContext},E.createElement(d4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Nz(n){let{routeContext:e,match:t,children:r}=n,s=E.useContext(Zx);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),E.createElement(To.Provider,{value:e},r)}function Sz(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var a;if(!t)return null;if(t.errors)n=t.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,l=(s=t)==null?void 0:s.errors;if(l!=null){let h=o.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);h>=0||er(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,d=-1;if(t&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:x,errors:v}=t,w=p.route.loader&&x[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||w){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,p,x)=>{let v,w=!1,_=null,j=null;t&&(v=l&&p.route.id?l[p.route.id]:void 0,_=p.route.errorElement||_z,c&&(d<0&&x===0?(Ez("route-fallback"),w=!0,j=null):d===x&&(w=!0,j=p.route.hydrateFallbackElement||null)));let T=e.concat(o.slice(0,x+1)),P=()=>{let D;return v?D=_:w?D=j:p.route.Component?D=E.createElement(p.route.Component,null):p.route.element?D=p.route.element:D=h,E.createElement(Nz,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:t!=null},children:D})};return t&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?E.createElement(jz,{location:t.location,revalidation:t.revalidation,component:_,error:v,children:P(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):P()},null)}var h4=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(h4||{}),m4=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(m4||{});function Cz(n){let e=E.useContext(Zx);return e||er(!1),e}function Tz(n){let e=E.useContext(c4);return e||er(!1),e}function kz(n){let e=E.useContext(To);return e||er(!1),e}function p4(n){let e=kz(),t=e.matches[e.matches.length-1];return t.route.id||er(!1),t.route.id}function Pz(){var n;let e=E.useContext(d4),t=Tz(),r=p4();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Mz(){let{router:n}=Cz(h4.UseNavigateStable),e=p4(m4.UseNavigateStable),t=E.useRef(!1);return u4(()=>{t.current=!0}),E.useCallback(function(s,a){a===void 0&&(a={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,im({fromRouteId:e},a)))},[n,e])}const pk={};function Ez(n,e,t){pk[n]||(pk[n]=!0)}function Dz(n,e){n?.v7_startTransition,n?.v7_relativeSplatPath}function vl(n){let{to:e,replace:t,state:r,relative:s}=n;Lf()||er(!1);let{future:a,static:o}=E.useContext(Pl),{matches:l}=E.useContext(To),{pathname:c}=ds(),d=St(),h=rC(e,nC(l,a.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(h);return E.useEffect(()=>d(JSON.parse(p),{replace:t,state:r,relative:s}),[d,p,s,t,r]),null}function vf(n){return yz(n.context)}function He(n){er(!1)}function Oz(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Oc.Pop,navigator:a,static:o=!1,future:l}=n;Lf()&&er(!1);let c=e.replace(/^\/*/,"/"),d=E.useMemo(()=>({basename:c,navigator:a,static:o,future:im({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof r=="string"&&(r=xu(r));let{pathname:h="/",search:p="",hash:x="",state:v=null,key:w="default"}=r,_=E.useMemo(()=>{let j=yf(h,c);return j==null?null:{location:{pathname:j,search:p,hash:x,state:v,key:w},navigationType:s}},[c,h,p,x,v,w,s]);return _==null?null:E.createElement(Pl.Provider,{value:d},E.createElement(Kx.Provider,{children:t,value:_}))}function Iz(n){let{children:e,location:t}=n;return vz(VN(e),t)}new Promise(()=>{});function VN(n,e){e===void 0&&(e=[]);let t=[];return E.Children.forEach(n,(r,s)=>{if(!E.isValidElement(r))return;let a=[...e,s];if(r.type===E.Fragment){t.push.apply(t,VN(r.props.children,a));return}r.type!==He&&er(!1),!r.props.index||!r.props.children||er(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=VN(r.props.children,a)),t.push(o)}),t}function gx(){return gx=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},gx.apply(this,arguments)}function g4(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,a;for(a=0;a<r.length;a++)s=r[a],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function Az(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Rz(n,e){return n.button===0&&(!e||e==="_self")&&!Az(n)}function BN(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(s=>[t,s]):[[t,r]])},[]))}function Lz(n,e){let t=BN(n);return e&&e.forEach((r,s)=>{t.has(s)||e.getAll(s).forEach(a=>{t.append(s,a)})}),t}const Fz=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],qz=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],zz="6";try{window.__reactRouterVersion=zz}catch{}const Uz=E.createContext({isTransitioning:!1}),Vz="startTransition",gk=Lq[Vz];function Bz(n){let{basename:e,children:t,future:r,window:s}=n,a=E.useRef();a.current==null&&(a.current=Wq({window:s,v5Compat:!0}));let o=a.current,[l,c]=E.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=E.useCallback(p=>{d&&gk?gk(()=>c(p)):c(p)},[c,d]);return E.useLayoutEffect(()=>o.listen(h),[o,h]),E.useEffect(()=>Dz(r),[r]),E.createElement(Oz,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:r})}const Wz=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$z=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ma=E.forwardRef(function(e,t){let{onClick:r,relative:s,reloadDocument:a,replace:o,state:l,target:c,to:d,preventScrollReset:h,viewTransition:p}=e,x=g4(e,Fz),{basename:v}=E.useContext(Pl),w,_=!1;if(typeof d=="string"&&$z.test(d)&&(w=d,Wz))try{let D=new URL(window.location.href),M=d.startsWith("//")?new URL(D.protocol+d):new URL(d),O=yf(M.pathname,v);M.origin===D.origin&&O!=null?d=O+M.search+M.hash:_=!0}catch{}let j=gz(d,{relative:s}),T=Yz(d,{replace:o,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:p});function P(D){r&&r(D),D.defaultPrevented||T(D)}return E.createElement("a",gx({},x,{href:w||j,onClick:_||a?r:P,ref:t,target:c}))}),x4=E.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:s=!1,className:a="",end:o=!1,style:l,to:c,viewTransition:d,children:h}=e,p=g4(e,qz),x=Jx(c,{relative:p.relative}),v=ds(),w=E.useContext(c4),{navigator:_,basename:j}=E.useContext(Pl),T=w!=null&&Gz(x)&&d===!0,P=_.encodeLocation?_.encodeLocation(x).pathname:x.pathname,D=v.pathname,M=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;s||(D=D.toLowerCase(),M=M?M.toLowerCase():null,P=P.toLowerCase()),M&&j&&(M=yf(M,j)||M);const O=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let I=D===P||!o&&D.startsWith(P)&&D.charAt(O)==="/",q=M!=null&&(M===P||!o&&M.startsWith(P)&&M.charAt(P.length)==="/"),F={isActive:I,isPending:q,isTransitioning:T},V=I?r:void 0,U;typeof a=="function"?U=a(F):U=[a,I?"active":null,q?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let W=typeof l=="function"?l(F):l;return E.createElement(Ma,gx({},p,{"aria-current":V,className:U,ref:t,style:W,to:c,viewTransition:d}),typeof h=="function"?h(F):h)});var WN;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(WN||(WN={}));var xk;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(xk||(xk={}));function Hz(n){let e=E.useContext(Zx);return e||er(!1),e}function Yz(n,e){let{target:t,replace:r,state:s,preventScrollReset:a,relative:o,viewTransition:l}=e===void 0?{}:e,c=St(),d=ds(),h=Jx(n,{relative:o});return E.useCallback(p=>{if(Rz(p,t)){p.preventDefault();let x=r!==void 0?r:px(d)===px(h);c(n,{replace:x,state:s,preventScrollReset:a,relative:o,viewTransition:l})}},[d,c,h,r,s,t,n,a,o,l])}function y4(n){let e=E.useRef(BN(n)),t=E.useRef(!1),r=ds(),s=E.useMemo(()=>Lz(r.search,t.current?null:e.current),[r.search]),a=St(),o=E.useCallback((l,c)=>{const d=BN(typeof l=="function"?l(s):l);t.current=!0,a("?"+d,c)},[a,s]);return[s,o]}function Gz(n,e){e===void 0&&(e={});let t=E.useContext(Uz);t==null&&er(!1);let{basename:r}=Hz(WN.useViewTransitionState),s=Jx(n,{relative:e.relative});if(!t.isTransitioning)return!1;let a=yf(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=yf(t.nextLocation.pathname,r)||t.nextLocation.pathname;return UN(s.pathname,o)!=null||UN(s.pathname,a)!=null}const Zz={},yk=n=>{let e;const t=new Set,r=(h,p)=>{const x=typeof h=="function"?h(e):h;if(!Object.is(x,e)){const v=e;e=p??(typeof x!="object"||x===null)?x:Object.assign({},e,x),t.forEach(w=>w(e,v))}},s=()=>e,c={setState:r,getState:s,getInitialState:()=>d,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(Zz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=n(r,s,c);return c},Kz=n=>n?yk(n):yk;var Kv={exports:{}},Jv={},Qv={exports:{}},Xv={};var vk;function Jz(){if(vk)return Xv;vk=1;var n=Gs();function e(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,a=n.useLayoutEffect,o=n.useDebugValue;function l(p,x){var v=x(),w=r({inst:{value:v,getSnapshot:x}}),_=w[0].inst,j=w[1];return a(function(){_.value=v,_.getSnapshot=x,c(_)&&j({inst:_})},[p,v,x]),s(function(){return c(_)&&j({inst:_}),p(function(){c(_)&&j({inst:_})})},[p]),o(v),v}function c(p){var x=p.getSnapshot;p=p.value;try{var v=x();return!t(p,v)}catch{return!0}}function d(p,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return Xv.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,Xv}var bk;function Qz(){return bk||(bk=1,Qv.exports=Jz()),Qv.exports}var wk;function Xz(){if(wk)return Jv;wk=1;var n=Gs(),e=Qz();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,a=n.useRef,o=n.useEffect,l=n.useMemo,c=n.useDebugValue;return Jv.useSyncExternalStoreWithSelector=function(d,h,p,x,v){var w=a(null);if(w.current===null){var _={hasValue:!1,value:null};w.current=_}else _=w.current;w=l(function(){function T(I){if(!P){if(P=!0,D=I,I=x(I),v!==void 0&&_.hasValue){var q=_.value;if(v(q,I))return M=q}return M=I}if(q=M,r(D,I))return q;var F=x(I);return v!==void 0&&v(q,F)?(D=I,q):(D=I,M=F)}var P=!1,D,M,O=p===void 0?null:p;return[function(){return T(h())},O===null?void 0:function(){return T(O())}]},[h,p,x,v]);var j=s(d,w[0],w[1]);return o(function(){_.hasValue=!0,_.value=j},[j]),c(j),j},Jv}var _k;function eU(){return _k||(_k=1,Kv.exports=Xz()),Kv.exports}var tU=eU();const nU=gu(tU),v4={},{useDebugValue:rU}=ot,{useSyncExternalStoreWithSelector:sU}=nU;let jk=!1;const iU=n=>n;function aU(n,e=iU,t){(v4?"production":void 0)!=="production"&&t&&!jk&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),jk=!0);const r=sU(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return rU(r),r}const Nk=n=>{(v4?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?Kz(n):n,t=(r,s)=>aU(e,r,s);return Object.assign(t,e),t},Aa=n=>n?Nk(n):Nk;var $N=function(n,e){return $N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},$N(n,e)};function sC(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$N(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var pr=function(){return pr=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},pr.apply(this,arguments)};function qf(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function b4(n,e,t,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var l=n.length-1;l>=0;l--)(o=n[l])&&(a=(s<3?o(a):s>3?o(e,t,a):o(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a}function w4(n,e){return function(t,r){e(t,r,n)}}function _4(n,e,t,r,s,a){function o(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var l=r.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&n?r.static?n:n.prototype:null,h=e||(d?Object.getOwnPropertyDescriptor(d,r.name):{}),p,x=!1,v=t.length-1;v>=0;v--){var w={};for(var _ in r)w[_]=_==="access"?{}:r[_];for(var _ in r.access)w.access[_]=r.access[_];w.addInitializer=function(T){if(x)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(T||null))};var j=(0,t[v])(l==="accessor"?{get:h.get,set:h.set}:h[c],w);if(l==="accessor"){if(j===void 0)continue;if(j===null||typeof j!="object")throw new TypeError("Object expected");(p=o(j.get))&&(h.get=p),(p=o(j.set))&&(h.set=p),(p=o(j.init))&&s.unshift(p)}else(p=o(j))&&(l==="field"?s.unshift(p):h[c]=p)}d&&Object.defineProperty(d,r.name,h),x=!0}function j4(n,e,t){for(var r=arguments.length>2,s=0;s<e.length;s++)t=r?e[s].call(n,t):e[s].call(n);return r?t:void 0}function N4(n){return typeof n=="symbol"?n:"".concat(n)}function S4(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function C4(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function vt(n,e,t,r){function s(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(h){try{d(r.next(h))}catch(p){o(p)}}function c(h){try{d(r.throw(h))}catch(p){o(p)}}function d(h){h.done?a(h.value):s(h.value).then(l,c)}d((r=r.apply(n,e||[])).next())})}function T4(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(h){return c([d,h])}}function c(d){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(t=0)),t;)try{if(r=1,s&&(a=d[0]&2?s.return:d[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,d[1])).done)return a;switch(s=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,s=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){t.label=d[1];break}if(d[0]===6&&t.label<a[1]){t.label=a[1],a=d;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(d);break}a[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(h){d=[6,h],s=0}finally{r=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Qx=Object.create?(function(n,e,t,r){r===void 0&&(r=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,s)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]});function k4(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Qx(e,n,t)}function xx(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function iC(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(l){o={error:l}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function P4(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(iC(arguments[e]));return n}function M4(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),s=0,e=0;e<t;e++)for(var a=arguments[e],o=0,l=a.length;o<l;o++,s++)r[s]=a[o];return r}function E4(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,a;r<s;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function bf(n){return this instanceof bf?(this.v=n,this):new bf(n)}function D4(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(v){return function(w){return Promise.resolve(w).then(v,p)}}function l(v,w){r[v]&&(s[v]=function(_){return new Promise(function(j,T){a.push([v,_,j,T])>1||c(v,_)})},w&&(s[v]=w(s[v])))}function c(v,w){try{d(r[v](w))}catch(_){x(a[0][3],_)}}function d(v){v.value instanceof bf?Promise.resolve(v.value.v).then(h,p):x(a[0][2],v)}function h(v){c("next",v)}function p(v){c("throw",v)}function x(v,w){v(w),a.shift(),a.length&&c(a[0][0],a[0][1])}}function O4(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,a){e[s]=n[s]?function(o){return(t=!t)?{value:bf(n[s](o)),done:!1}:a?a(o):o}:a}}function I4(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof xx=="function"?xx(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(l,c){o=n[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},o)}}function A4(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var oU=Object.create?(function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}):function(n,e){n.default=e},HN=function(n){return HN=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},HN(n)};function R4(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=HN(n),r=0;r<t.length;r++)t[r]!=="default"&&Qx(e,n,t[r]);return oU(e,n),e}function L4(n){return n&&n.__esModule?n:{default:n}}function F4(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function q4(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t}function z4(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function U4(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,s;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var lU=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function V4(n){function e(a){n.error=n.hasError?new lU(a,n.error,"An error was suppressed during disposal."):a,n.hasError=!0}var t,r=0;function s(){for(;t=n.stack.pop();)try{if(!t.async&&r===1)return r=0,n.stack.push(t),Promise.resolve().then(s);if(t.dispose){var a=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(a).then(s,function(o){return e(o),s()})}else r|=1}catch(o){e(o)}if(r===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return s()}function B4(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,s,a,o){return r?e?".jsx":".js":s&&(!a||!o)?t:s+a+"."+o.toLowerCase()+"js"}):n}const cU={__extends:sC,__assign:pr,__rest:qf,__decorate:b4,__param:w4,__esDecorate:_4,__runInitializers:j4,__propKey:N4,__setFunctionName:S4,__metadata:C4,__awaiter:vt,__generator:T4,__createBinding:Qx,__exportStar:k4,__values:xx,__read:iC,__spread:P4,__spreadArrays:M4,__spreadArray:E4,__await:bf,__asyncGenerator:D4,__asyncDelegator:O4,__asyncValues:I4,__makeTemplateObject:A4,__importStar:R4,__importDefault:L4,__classPrivateFieldGet:F4,__classPrivateFieldSet:q4,__classPrivateFieldIn:z4,__addDisposableResource:U4,__disposeResources:V4,__rewriteRelativeImportExtension:B4},dU=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:U4,get __assign(){return pr},__asyncDelegator:O4,__asyncGenerator:D4,__asyncValues:I4,__await:bf,__awaiter:vt,__classPrivateFieldGet:F4,__classPrivateFieldIn:z4,__classPrivateFieldSet:q4,__createBinding:Qx,__decorate:b4,__disposeResources:V4,__esDecorate:_4,__exportStar:k4,__extends:sC,__generator:T4,__importDefault:L4,__importStar:R4,__makeTemplateObject:A4,__metadata:C4,__param:w4,__propKey:N4,__read:iC,__rest:qf,__rewriteRelativeImportExtension:B4,__runInitializers:j4,__setFunctionName:S4,__spread:P4,__spreadArray:E4,__spreadArrays:M4,__values:xx,default:cU},Symbol.toStringTag,{value:"Module"})),uU=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class aC extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class fU extends aC{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Sk extends aC{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ck extends aC{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var YN;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(YN||(YN={}));class hU{constructor(e,{headers:t={},customFetch:r,region:s=YN.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=uU(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return vt(this,arguments,void 0,function*(t,r={}){var s;let a,o;try{const{headers:l,method:c,body:d,signal:h,timeout:p}=r;let x={},{region:v}=r;v||(v=this.region);const w=new URL(`${this.url}/${t}`);v&&v!=="any"&&(x["x-region"]=v,w.searchParams.set("forceFunctionRegion",v));let _;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(x["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(x["Content-Type"]="application/json",_=JSON.stringify(d)):_=d;let j=h;p&&(o=new AbortController,a=setTimeout(()=>o.abort(),p),h?(j=o.signal,h.addEventListener("abort",()=>o.abort())):j=o.signal);const T=yield this.fetch(w.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),l),body:_,signal:j}).catch(O=>{throw new fU(O)}),P=T.headers.get("x-relay-error");if(P&&P==="true")throw new Sk(T);if(!T.ok)throw new Ck(T);let D=((s=T.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),M;return D==="application/json"?M=yield T.json():D==="application/octet-stream"||D==="application/pdf"?M=yield T.blob():D==="text/event-stream"?M=T:D==="multipart/form-data"?M=yield T.formData():M=yield T.text(),{data:M,error:null,response:T}}catch(l){return{data:null,error:l,response:l instanceof Ck||l instanceof Sk?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var rs={};const zf=n4(dU);var Ep={},Dp={},Op={},Ip={},Ap={},Rp={},Tk;function W4(){if(Tk)return Rp;Tk=1,Object.defineProperty(Rp,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Rp.default=n,Rp}var kk;function $4(){if(kk)return Ap;kk=1,Object.defineProperty(Ap,"__esModule",{value:!0});const e=zf.__importDefault(W4());class t{constructor(s){var a,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(a=s.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=s.signal,this.isMaybeSingle=(o=s.isMaybeSingle)!==null&&o!==void 0?o:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,a){return this.headers=new Headers(this.headers),this.headers.set(s,a),this}then(s,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,h,p,x;let v=null,w=null,_=null,j=c.status,T=c.statusText;if(c.ok){if(this.method!=="HEAD"){const O=await c.text();O===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?w=O:w=JSON.parse(O))}const D=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),M=(p=c.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");D&&M&&M.length>1&&(_=parseInt(M[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(v={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,_=null,j=406,T="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const D=await c.text();try{v=JSON.parse(D),Array.isArray(v)&&c.status===404&&(w=[],v=null,j=200,T="OK")}catch{c.status===404&&D===""?(j=204,T="No Content"):v={message:D}}if(v&&this.isMaybeSingle&&(!((x=v?.details)===null||x===void 0)&&x.includes("0 rows"))&&(v=null,j=200,T="OK"),v&&this.shouldThrowOnError)throw new e.default(v)}return{error:v,data:w,count:_,status:j,statusText:T}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,h,p;return{error:{message:`${(d=c?.name)!==null&&d!==void 0?d:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(p=c?.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,a)}returns(){return this}overrideTypes(){return this}}return Ap.default=t,Ap}var Pk;function H4(){if(Pk)return Ip;Pk=1,Object.defineProperty(Ip,"__esModule",{value:!0});const e=zf.__importDefault($4());class t extends e.default{select(s){let a=!1;const o=(s??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:a=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",h=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${h?`${h},`:""}${s}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this}range(s,a,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(d,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:a=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var h;const p=[s?"analyze":null,a?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),x=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${x}"; options=${p};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Ip.default=t,Ip}var Mk;function oC(){if(Mk)return Op;Mk=1,Object.defineProperty(Op,"__esModule",{value:!0});const e=zf.__importDefault(H4()),t=new RegExp("[,()]");class r extends e.default{eq(a,o){return this.url.searchParams.append(a,`eq.${o}`),this}neq(a,o){return this.url.searchParams.append(a,`neq.${o}`),this}gt(a,o){return this.url.searchParams.append(a,`gt.${o}`),this}gte(a,o){return this.url.searchParams.append(a,`gte.${o}`),this}lt(a,o){return this.url.searchParams.append(a,`lt.${o}`),this}lte(a,o){return this.url.searchParams.append(a,`lte.${o}`),this}like(a,o){return this.url.searchParams.append(a,`like.${o}`),this}likeAllOf(a,o){return this.url.searchParams.append(a,`like(all).{${o.join(",")}}`),this}likeAnyOf(a,o){return this.url.searchParams.append(a,`like(any).{${o.join(",")}}`),this}ilike(a,o){return this.url.searchParams.append(a,`ilike.${o}`),this}ilikeAllOf(a,o){return this.url.searchParams.append(a,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(a,o){return this.url.searchParams.append(a,`ilike(any).{${o.join(",")}}`),this}is(a,o){return this.url.searchParams.append(a,`is.${o}`),this}in(a,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&t.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cs.{${o.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(o)}`),this}containedBy(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cd.{${o.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(o)}`),this}rangeGt(a,o){return this.url.searchParams.append(a,`sr.${o}`),this}rangeGte(a,o){return this.url.searchParams.append(a,`nxl.${o}`),this}rangeLt(a,o){return this.url.searchParams.append(a,`sl.${o}`),this}rangeLte(a,o){return this.url.searchParams.append(a,`nxr.${o}`),this}rangeAdjacent(a,o){return this.url.searchParams.append(a,`adj.${o}`),this}overlaps(a,o){return typeof o=="string"?this.url.searchParams.append(a,`ov.${o}`):this.url.searchParams.append(a,`ov.{${o.join(",")}}`),this}textSearch(a,o,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${h}.${o}`),this}match(a){return Object.entries(a).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(a,o,l){return this.url.searchParams.append(a,`not.${o}.${l}`),this}or(a,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,o,l){return this.url.searchParams.append(a,`${o}.${l}`),this}}return Op.default=r,Op}var Ek;function Y4(){if(Ek)return Dp;Ek=1,Object.defineProperty(Dp,"__esModule",{value:!0});const e=zf.__importDefault(oC());class t{constructor(s,{headers:a={},schema:o,fetch:l}){this.url=s,this.headers=new Headers(a),this.schema=o,this.fetch=l}select(s,a){const{head:o=!1,count:l}=a??{},c=o?"HEAD":"GET";let d=!1;const h=(s??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",h),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:a,defaultToNull:o=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(d.length>0){const h=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(s,{onConflict:a,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var d;const h="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const p=s.reduce((x,v)=>x.concat(Object.keys(v)),[]);if(p.length>0){const x=[...new Set(p)].map(v=>`"${v}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(s,{count:a}={}){var o;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var a;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return Dp.default=t,Dp}var Dk;function mU(){if(Dk)return Ep;Dk=1,Object.defineProperty(Ep,"__esModule",{value:!0});const n=zf,e=n.__importDefault(Y4()),t=n.__importDefault(oC());class r{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new r(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:d}={}){var h;let p;const x=new URL(`${this.url}/rpc/${a}`);let v;l||c?(p=l?"HEAD":"GET",Object.entries(o).filter(([_,j])=>j!==void 0).map(([_,j])=>[_,Array.isArray(j)?`{${j.join(",")}}`:`${j}`]).forEach(([_,j])=>{x.searchParams.append(_,j)})):(p="POST",v=o);const w=new Headers(this.headers);return d&&w.set("Prefer",`count=${d}`),new t.default({method:p,url:x,headers:w,schema:this.schemaName,body:v,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return Ep.default=r,Ep}var Ok;function pU(){if(Ok)return rs;Ok=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.PostgrestError=rs.PostgrestBuilder=rs.PostgrestTransformBuilder=rs.PostgrestFilterBuilder=rs.PostgrestQueryBuilder=rs.PostgrestClient=void 0;const n=zf,e=n.__importDefault(mU());rs.PostgrestClient=e.default;const t=n.__importDefault(Y4());rs.PostgrestQueryBuilder=t.default;const r=n.__importDefault(oC());rs.PostgrestFilterBuilder=r.default;const s=n.__importDefault(H4());rs.PostgrestTransformBuilder=s.default;const a=n.__importDefault($4());rs.PostgrestBuilder=a.default;const o=n.__importDefault(W4());return rs.PostgrestError=o.default,rs.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:a.default,PostgrestError:o.default},rs}var G4=pU();const Z4=gu(G4),gU=t4({__proto__:null,default:Z4},[G4]),{PostgrestClient:xU,PostgrestQueryBuilder:mfe,PostgrestFilterBuilder:pfe,PostgrestTransformBuilder:gfe,PostgrestBuilder:xfe,PostgrestError:yfe}=Z4||gU;class yU{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const vU="2.81.1",bU=`realtime-js/${vU}`,K4="1.0.0",wU="2.0.0",Ik=K4,GN=1e4,_U=1e3,jU=100;var Xd;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Xd||(Xd={}));var Cr;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Cr||(Cr={}));var Bi;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Bi||(Bi={}));var ZN;(function(n){n.websocket="websocket"})(ZN||(ZN={}));var eu;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(eu||(eu={}));class NU{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(e,t){if(this._isArrayBuffer(e.payload))return t(this._binaryEncodePush(e));if(e.event===this.BROADCAST&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodePush(e){const{join_ref:t,ref:r,event:s,topic:a,payload:o}=e,l=this.META_LENGTH+t.length+r.length+a.length+s.length,c=new ArrayBuffer(this.HEADER_LENGTH+l);let d=new DataView(c),h=0;d.setUint8(h++,this.KINDS.push),d.setUint8(h++,t.length),d.setUint8(h++,r.length),d.setUint8(h++,a.length),d.setUint8(h++,s.length),Array.from(t,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(r,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(a,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(s,x=>d.setUint8(h++,x.charCodeAt(0)));var p=new Uint8Array(c.byteLength+o.byteLength);return p.set(new Uint8Array(c),0),p.set(new Uint8Array(o),c.byteLength),p.buffer}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const{join_ref:s,ref:a,topic:o}=e,l=e.payload.event,c=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:new ArrayBuffer(0),d=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+o.length+l.length,h=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(h),x=0;p.setUint8(x++,this.KINDS.userBroadcastPush),p.setUint8(x++,s.length),p.setUint8(x++,a.length),p.setUint8(x++,o.length),p.setUint8(x++,l.length),p.setUint8(x++,this.BINARY_ENCODING),Array.from(s,w=>p.setUint8(x++,w.charCodeAt(0))),Array.from(a,w=>p.setUint8(x++,w.charCodeAt(0))),Array.from(o,w=>p.setUint8(x++,w.charCodeAt(0))),Array.from(l,w=>p.setUint8(x++,w.charCodeAt(0)));var v=new Uint8Array(h.byteLength+c.byteLength);return v.set(new Uint8Array(h),0),v.set(new Uint8Array(c),h.byteLength),v.buffer}_encodeJsonUserBroadcastPush(e){var t,r;const{join_ref:s,ref:a,topic:o}=e,l=e.payload.event,c=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:{},h=new TextEncoder().encode(JSON.stringify(c)).buffer,p=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+o.length+l.length,x=new ArrayBuffer(this.HEADER_LENGTH+p);let v=new DataView(x),w=0;v.setUint8(w++,this.KINDS.userBroadcastPush),v.setUint8(w++,s.length),v.setUint8(w++,a.length),v.setUint8(w++,o.length),v.setUint8(w++,l.length),v.setUint8(w++,this.JSON_ENCODING),Array.from(s,j=>v.setUint8(w++,j.charCodeAt(0))),Array.from(a,j=>v.setUint8(w++,j.charCodeAt(0))),Array.from(o,j=>v.setUint8(w++,j.charCodeAt(0))),Array.from(l,j=>v.setUint8(w++,j.charCodeAt(0)));var _=new Uint8Array(x.byteLength+h.byteLength);return _.set(new Uint8Array(x),0),_.set(new Uint8Array(h),x.byteLength),_.buffer}decode(e,t){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return t(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,a,o,l,c]=r;return t({join_ref:s,ref:a,topic:o,event:l,payload:c})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.push:return this._decodePush(e,t,s);case this.KINDS.reply:return this._decodeReply(e,t,s);case this.KINDS.broadcast:return this._decodeBroadcast(e,t,s);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,s)}}_decodePush(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3);let l=this.HEADER_LENGTH+this.META_LENGTH-1;const c=r.decode(e.slice(l,l+s));l=l+s;const d=r.decode(e.slice(l,l+a));l=l+a;const h=r.decode(e.slice(l,l+o));l=l+o;const p=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{join_ref:c,ref:null,topic:d,event:h,payload:p}}_decodeReply(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+this.META_LENGTH;const d=r.decode(e.slice(c,c+s));c=c+s;const h=r.decode(e.slice(c,c+a));c=c+a;const p=r.decode(e.slice(c,c+o));c=c+o;const x=r.decode(e.slice(c,c+l));c=c+l;const v=JSON.parse(r.decode(e.slice(c,e.byteLength))),w={status:x,response:v};return{join_ref:d,ref:h,topic:p,event:Bi.reply,payload:w}}_decodeBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+s));o=o+s;const c=r.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{join_ref:null,ref:null,topic:l,event:c,payload:d}}_decodeUserBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+4;const d=r.decode(e.slice(c,c+s));c=c+s;const h=r.decode(e.slice(c,c+a));c=c+a;const p=r.decode(e.slice(c,c+o));c=c+o;const x=e.slice(c,e.byteLength),v=l===this.JSON_ENCODING?JSON.parse(r.decode(x)):x,w={type:this.BROADCAST,event:h,payload:v};return o>0&&(w.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST,payload:w}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}}class J4{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var In;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(In||(In={}));const Ak=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((a,o)=>(a[o]=SU(o,n,e,s),a),{}):{}},SU=(n,e,t,r)=>{const s=e.find(l=>l.name===n),a=s?.type,o=t[n];return a&&!r.includes(a)?Q4(a,o):KN(o)},Q4=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return PU(e,t)}switch(n){case In.bool:return CU(e);case In.float4:case In.float8:case In.int2:case In.int4:case In.int8:case In.numeric:case In.oid:return TU(e);case In.json:case In.jsonb:return kU(e);case In.timestamp:return MU(e);case In.abstime:case In.date:case In.daterange:case In.int4range:case In.int8range:case In.money:case In.reltime:case In.text:case In.time:case In.timestamptz:case In.timetz:case In.tsrange:case In.tstzrange:return KN(e);default:return KN(e)}},KN=n=>n,CU=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},TU=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},kU=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},PU=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let a;const o=n.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Q4(e,l))}return n},MU=n=>typeof n=="string"?n.replace(" ","T"):n,X4=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class eb{constructor(e,t,r={},s=GN){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Rk;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Rk||(Rk={}));class Zh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Zh.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=Zh.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Zh.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const a=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(a,(d,h)=>{o[d]||(c[d]=h)}),this.map(o,(d,h)=>{const p=a[d];if(p){const x=h.map(j=>j.presence_ref),v=p.map(j=>j.presence_ref),w=h.filter(j=>v.indexOf(j.presence_ref)<0),_=p.filter(j=>x.indexOf(j.presence_ref)<0);w.length>0&&(l[d]=w),_.length>0&&(c[d]=_)}else l[d]=h}),this.syncDiff(a,{joins:l,leaves:c},r,s)}static syncDiff(e,t,r,s){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var d;const h=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),h.length>0){const p=e[l].map(v=>v.presence_ref),x=h.filter(v=>p.indexOf(v.presence_ref)<0);e[l].unshift(...x)}r(l,h,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const h=c.map(p=>p.presence_ref);d=d.filter(p=>h.indexOf(p.presence_ref)<0),e[l]=d,s(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Lk;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Lk||(Lk={}));var Kh;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Kh||(Kh={}));var gl;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(gl||(gl={}));class lC{constructor(e,t={config:{}},r){var s,a;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Cr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new eb(this,Bi.join,this.params,this.timeout),this.rejoinTimer=new J4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Cr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Cr.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Cr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Cr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Cr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Bi.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Zh(this),this.broadcastEndpointURL=X4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Cr.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(v=>v.filter))!==null&&s!==void 0?s:[],h=!!this.bindings[Kh.PRESENCE]&&this.bindings[Kh.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,p={},x={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(gl.CHANNEL_ERROR,v)),this._onClose(()=>e?.(gl.CLOSED)),this.updateJoinPayload(Object.assign({config:x},p)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var w;if(this.socket.setAuth(),v===void 0){e?.(gl.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,j=(w=_?.length)!==null&&w!==void 0?w:0,T=[];for(let P=0;P<j;P++){const D=_[P],{filter:{event:M,schema:O,table:I,filter:q}}=D,F=v&&v[P];if(F&&F.event===M&&F.schema===O&&F.table===I&&F.filter===q)T.push(Object.assign(Object.assign({},D),{id:F.id}));else{this.unsubscribe(),this.state=Cr.errored,e?.(gl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,e&&e(gl.SUBSCRIBED);return}}).receive("error",v=>{this.state=Cr.errored,e?.(gl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(gl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===Cr.joined&&e===Kh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var s;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Cr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Bi.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new eb(this,Bi.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Cr.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,a=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new eb(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>jU){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:h}=Bi;if(r&&[l,c,d,h].indexOf(o)>=0&&r!==this._joinRef())return;let x=this._onMessage(o,t,r);if(t&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var w,_,j;return((w=v.filter)===null||w===void 0?void 0:w.event)==="*"||((j=(_=v.filter)===null||_===void 0?void 0:_.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===o}).map(v=>v.callback(x,r)):(a=this.bindings[o])===null||a===void 0||a.filter(v=>{var w,_,j,T,P,D;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const M=v.id,O=(w=v.filter)===null||w===void 0?void 0:w.event;return M&&((_=t.ids)===null||_===void 0?void 0:_.includes(M))&&(O==="*"||O?.toLocaleLowerCase()===((j=t.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const M=(P=(T=v?.filter)===null||T===void 0?void 0:T.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return M==="*"||M===((D=t?.event)===null||D===void 0?void 0:D.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof x=="object"&&"ids"in x){const w=x.data,{schema:_,table:j,commit_timestamp:T,type:P,errors:D}=w;x=Object.assign(Object.assign({},{schema:_,table:j,commit_timestamp:T,eventType:P,new:{},old:{},errors:D}),this._getPayloadRecords(w))}v.callback(x,r)})}_isClosed(){return this.state===Cr.closed}_isJoined(){return this.state===Cr.joined}_isJoining(){return this.state===Cr.joining}_isLeaving(){return this.state===Cr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&lC.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Bi.close,{},e)}_onError(e){this._on(Bi.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Cr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Ak(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Ak(e.columns,e.old_record)),t}}const tb=()=>{},Lp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},EU=[1e3,2e3,5e3,1e4],DU=1e4,OU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class IU{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=GN,this.transport=null,this.heartbeatIntervalMs=Lp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=tb,this.ref=0,this.reconnectTimer=null,this.vsn=Ik,this.logger=tb,this.conn=null,this.sendBuffer=[],this.serializer=new NU,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${ZN.websocket}`,this.httpEndpoint=X4(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=yU.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Xd.connecting:return eu.Connecting;case Xd.open:return eu.Open;case Xd.closing:return eu.Closing;default:return eu.Closed}}isConnected(){return this.connectionState()===eu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(a=>a.topic===r);if(s)return s;{const a=new lC(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:r,payload:s,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${r} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(_U,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Lp.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:a,ref:o}=t,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${r} ${s} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(s,a,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Xd.open||this.conn.readyState===Xd.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Bi.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([OU],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:bU};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Bi.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new J4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Lp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,a,o,l,c,d,h,p,x,v;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:GN,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:Lp.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:tb,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:Ik,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(w=>EU[w-1]||DU),this.vsn){case K4:this.encode=(h=e?.encode)!==null&&h!==void 0?h:((w,_)=>_(JSON.stringify(w))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:((w,_)=>_(JSON.parse(w)));break;case wU:this.encode=(x=e?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(v=e?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class cC extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Jn(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class AU extends cC{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class JN extends cC{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const dC=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),RU=()=>Response,QN=n=>{if(Array.isArray(n))return n.map(t=>QN(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[s]=QN(r)}),e},LU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},nb=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},FU=(n,e,t)=>vt(void 0,void 0,void 0,function*(){const r=yield RU();n instanceof r&&!t?.noResolveJson?n.json().then(s=>{const a=n.status||500,o=s?.statusCode||a+"";e(new AU(nb(s),a,o))}).catch(s=>{e(new JN(nb(s),s))}):e(new JN(nb(n),n))}),qU=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||!r?s:(LU(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,e?.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function Pm(n,e,t,r,s,a){return vt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,qU(e,r,s,a)).then(c=>{if(!c.ok)throw c;return r?.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>FU(c,l,r))})})}function am(n,e,t,r){return vt(this,void 0,void 0,function*(){return Pm(n,"GET",e,t,r)})}function _a(n,e,t,r,s){return vt(this,void 0,void 0,function*(){return Pm(n,"POST",e,r,s,t)})}function XN(n,e,t,r,s){return vt(this,void 0,void 0,function*(){return Pm(n,"PUT",e,r,s,t)})}function zU(n,e,t,r){return vt(this,void 0,void 0,function*(){return Pm(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function uC(n,e,t,r,s){return vt(this,void 0,void 0,function*(){return Pm(n,"DELETE",e,r,s,t)})}class UU{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return vt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Jn(e))return{data:null,error:e};throw e}})}}var eF;class VU{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[eF]="BlobDownloadBuilder",this.promise=null}asStream(){return new UU(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return vt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Jn(e))return{data:null,error:e};throw e}})}}eF=Symbol.toStringTag;const BU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Fk={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class WU{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=dC(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return vt(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Fk),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),s?.headers&&(l=Object.assign(Object.assign({},l),s.headers));const d=this._removeEmptyFolders(t),h=this._getFinalPath(d),p=yield(e=="PUT"?XN:_a)(this.fetch,`${this.url}/object/${h}`,a,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Jn(a))return{data:null,error:a};throw a}})}upload(e,t,r){return vt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return vt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:Fk.upsert},s),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const p=yield XN(this.fetch,l.toString(),c,{headers:h});return{data:{path:a,fullPath:p.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Jn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return vt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");const a=yield _a(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new cC("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Jn(r))return{data:null,error:r};throw r}})}update(e,t,r){return vt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return vt(this,void 0,void 0,function*(){try{return{data:yield _a(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}copy(e,t,r){return vt(this,void 0,void 0,function*(){try{return{data:{path:(yield _a(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return vt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),a=yield _a(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return vt(this,void 0,void 0,function*(){try{const s=yield _a(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}download(e,t){const s=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),o=a?`?${a}`:"",l=this._getFinalPath(e),c=()=>am(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new VU(c,this.shouldThrowOnError)}info(e){return vt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield am(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:QN(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Jn(r))return{data:null,error:r};throw r}})}exists(e){return vt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield zU(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Jn(r)&&r instanceof JN){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return vt(this,void 0,void 0,function*(){try{return{data:yield uC(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}list(e,t,r){return vt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},BU),t),{prefix:e||""});return{data:yield _a(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}listV2(e,t){return vt(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield _a(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Jn(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const tF="2.81.1",nF={"X-Client-Info":`storage-js/${tF}`};class $U{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},nF),t),this.fetch=dC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return vt(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield am(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}getBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield am(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}createBucket(e){return vt(this,arguments,void 0,function*(t,r={public:!1}){try{return{data:yield _a(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Jn(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return vt(this,void 0,void 0,function*(){try{return{data:yield XN(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Jn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield _a(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield uC(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}class HU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},nF),t),this.fetch=dC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield _a(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}listBuckets(e){return vt(this,void 0,void 0,function*(){try{const t=new URLSearchParams;e?.limit!==void 0&&t.set("limit",e.limit.toString()),e?.offset!==void 0&&t.set("offset",e.offset.toString()),e?.sortColumn&&t.set("sortColumn",e.sortColumn),e?.sortOrder&&t.set("sortOrder",e.sortOrder),e?.search&&t.set("search",e.search);const r=t.toString(),s=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield am(this.fetch,s,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield uC(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Jn(t))return{data:null,error:t};throw t}})}}const fC={"X-Client-Info":`storage-js/${tF}`,"Content-Type":"application/json"};class rF extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function fi(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}class rb extends rF{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class YU extends rF{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var qk;(function(n){n.InternalError="InternalError",n.S3VectorConflictException="S3VectorConflictException",n.S3VectorNotFoundException="S3VectorNotFoundException",n.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",n.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",n.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(qk||(qk={}));const hC=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),GU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},zk=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ZU=(n,e,t)=>vt(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!t?.noResolveJson){const s=n.status||500,a=n;if(typeof a.json=="function")a.json().then(o=>{const l=o?.statusCode||o?.code||s+"";e(new rb(zk(o),s,l))}).catch(()=>{const o=s+"",l=a.statusText||`HTTP ${s} error`;e(new rb(l,s,o))});else{const o=s+"",l=a.statusText||`HTTP ${s} error`;e(new rb(l,s,o))}}else e(new YU(zk(n),n))}),KU=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return r?(GU(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,Object.assign(Object.assign({},s),t)):s};function JU(n,e,t,r,s,a){return vt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,KU(e,r,s,a)).then(c=>{if(!c.ok)throw c;if(r?.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>ZU(c,l,r))})})}function hi(n,e,t,r,s){return vt(this,void 0,void 0,function*(){return JU(n,"POST",e,r,s,t)})}class QU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fC),t),this.fetch=hC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return vt(this,void 0,void 0,function*(){try{return{data:(yield hi(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}getIndex(e,t){return vt(this,void 0,void 0,function*(){try{return{data:yield hi(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fi(r))return{data:null,error:r};throw r}})}listIndexes(e){return vt(this,void 0,void 0,function*(){try{return{data:yield hi(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return vt(this,void 0,void 0,function*(){try{return{data:(yield hi(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fi(r))return{data:null,error:r};throw r}})}}class XU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fC),t),this.fetch=hC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return vt(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield hi(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}getVectors(e){return vt(this,void 0,void 0,function*(){try{return{data:yield hi(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}listVectors(e){return vt(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield hi(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}queryVectors(e){return vt(this,void 0,void 0,function*(){try{return{data:yield hi(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}deleteVectors(e){return vt(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield hi(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}}class eV{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},fC),t),this.fetch=hC(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:(yield hi(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}getBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:yield hi(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}listBuckets(){return vt(this,arguments,void 0,function*(e={}){try{return{data:yield hi(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}deleteBucket(e){return vt(this,void 0,void 0,function*(){try{return{data:(yield hi(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fi(t))return{data:null,error:t};throw t}})}}class tV extends eV{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new nV(this.url,this.headers,e,this.fetch)}}class nV extends QU{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return vt(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return vt(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return vt(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return vt(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new rV(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class rV extends XU{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return vt(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return vt(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return vt(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return vt(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return vt(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class sV extends $U{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new WU(this.url,this.headers,e,this.fetch)}get vectors(){return new tV(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new HU(this.url+"/iceberg",this.headers,this.fetch)}}const iV="2.81.1";let Uh="";typeof Deno<"u"?Uh="deno":typeof document<"u"?Uh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Uh="react-native":Uh="node";const aV={"X-Client-Info":`supabase-js-${Uh}/${iV}`},oV={headers:aV},lV={schema:"public"},cV={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},dV={},uV=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),fV=()=>Headers,hV=(n,e,t)=>{const r=uV(t),s=fV();return async(a,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:n;let d=new s(o?.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(a,Object.assign(Object.assign({},o),{headers:d}))}};function mV(n){return n.endsWith("/")?n:n+"/"}function pV(n,e){var t,r;const{db:s,auth:a,realtime:o,global:l}=n,{db:c,auth:d,realtime:h,global:p}=e,x={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},h),o),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(t=p?.headers)!==null&&t!==void 0?t:{}),(r=l?.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return n.accessToken?x.accessToken=n.accessToken:delete x.accessToken,x}function gV(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(mV(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const sF="2.81.1",tf=30*1e3,eS=3,sb=eS*tf,xV="http://localhost:9999",yV="supabase.auth.token",vV={"X-Client-Info":`gotrue-js/${sF}`},tS="X-Supabase-Api-Version",iF={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bV=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,wV=600*1e3;class om extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function wt(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class _V extends om{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function jV(n){return wt(n)&&n.name==="AuthApiError"}class tu extends om{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Yc extends om{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class ba extends Yc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function NV(n){return wt(n)&&n.name==="AuthSessionMissingError"}class Vu extends Yc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fp extends Yc{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class qp extends Yc{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function SV(n){return wt(n)&&n.name==="AuthImplicitGrantRedirectError"}class Uk extends Yc{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class nS extends Yc{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ib(n){return wt(n)&&n.name==="AuthRetryableFetchError"}class Vk extends Yc{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class rS extends Yc{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const yx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Bk=` 	
\r=`.split(""),CV=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Bk.length;e+=1)n[Bk[e].charCodeAt(0)]=-2;for(let e=0;e<yx.length;e+=1)n[yx[e].charCodeAt(0)]=e;return n})();function Wk(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(yx[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(yx[r]),e.queuedBits-=6}}function aF(n,e,t){const r=CV[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function $k(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{PV(o,r,t)};for(let o=0;o<n.length;o+=1)aF(n.charCodeAt(o),s,a);return e.join("")}function TV(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function kV(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}TV(r,e)}}function PV(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function df(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)aF(n.charCodeAt(s),t,r);return new Uint8Array(e)}function MV(n){const e=[];return kV(n,t=>e.push(t)),new Uint8Array(e)}function nu(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>Wk(s,t,r)),Wk(null,t,r),e.join("")}function EV(n){return Math.round(Date.now()/1e3)+n}function DV(){return Symbol("auth-callback")}const $r=()=>typeof window<"u"&&typeof document<"u",zd={tested:!1,writable:!1},oF=()=>{if(!$r())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(zd.tested)return zd.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),zd.tested=!0,zd.writable=!0}catch{zd.tested=!0,zd.writable=!1}return zd.writable};function OV(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,a)=>{e[a]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const lF=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),IV=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",nf=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Ud=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},_c=async(n,e)=>{await n.removeItem(e)};class Xx{constructor(){this.promise=new Xx.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Xx.promiseConstructor=Promise;function ab(n){const e=n.split(".");if(e.length!==3)throw new rS("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!bV.test(e[r]))throw new rS("JWT not in base64url format");return{header:JSON.parse($k(e[0])),payload:JSON.parse($k(e[1])),signature:df(e[2]),raw:{header:e[0],payload:e[1]}}}async function AV(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function RV(n,e){return new Promise((r,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await n(a);if(!e(a,null,o)){r(o);return}}catch(o){if(!e(a,o)){s(o);return}}})()})}function LV(n){return("0"+n.toString(16)).substr(-2)}function FV(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let a=0;a<56;a++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,LV).join("")}async function qV(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function zV(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await qV(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Bu(n,e,t=!1){const r=FV();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await nf(n,`${e}-code-verifier`,s);const a=await zV(r);return[a,r===a?"plain":"s256"]}const UV=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function VV(n){const e=n.headers.get(tS);if(!e||!e.match(UV))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function BV(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function WV(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const $V=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Wu(n){if(!$V.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ob(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function HV(n,e){return new Proxy(n,{get:(t,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,r,s)}})}function Hk(n){return JSON.parse(JSON.stringify(n))}const Zd=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),YV=[502,503,504];async function Yk(n){var e;if(!IV(n))throw new nS(Zd(n),0);if(YV.includes(n.status))throw new nS(Zd(n),n.status);let t;try{t=await n.json()}catch(a){throw new tu(Zd(a),a)}let r;const s=VV(n);if(s&&s.getTime()>=iF["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Vk(Zd(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ba}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Vk(Zd(t),n.status,t.weak_password.reasons);throw new _V(Zd(t),n.status||500,r)}const GV=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function It(n,e,t,r){var s;const a=Object.assign({},r?.headers);a[tS]||(a[tS]=iF["2024-01-01"].name),r?.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const o=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await ZV(n,e,t+l,{headers:a,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(c):{data:Object.assign({},c),error:null}}async function ZV(n,e,t,r,s,a){const o=GV(e,r,s,a);let l;try{l=await n(t,Object.assign({},o))}catch(c){throw console.error(c),new nS(Zd(c),0)}if(l.ok||await Yk(l),r?.noResolveJson)return l;try{return await l.json()}catch(c){await Yk(c)}}function wa(n){var e;let t=null;QV(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=EV(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function Gk(n){const e=wa(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Dc(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function KV(n){return{data:n,error:null}}function JV(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a}=n,o=qf(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Zk(n){return n}function QV(n){return n.access_token&&n.refresh_token&&n.expires_in}const lb=["global","local","others"];class XV{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=lF(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=lb[0]){if(lb.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${lb.join(", ")}`);try{return await It(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(wt(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await It(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Dc})}catch(r){if(wt(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=qf(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await It(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:JV,redirectTo:t?.redirectTo})}catch(t){if(wt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await It(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Dc})}catch(t){if(wt(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await It(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:Zk});if(h.error)throw h.error;const p=await h.json(),x=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(w.split(";")[1].split("=")[1]);d[`${j}Page`]=_}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(wt(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Wu(e);try{return await It(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Dc})}catch(t){if(wt(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Wu(e);try{return await It(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Dc})}catch(r){if(wt(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Wu(e);try{return await It(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Dc})}catch(r){if(wt(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Wu(e.userId);try{const{data:t,error:r}=await It(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Wu(e.userId),Wu(e.id);try{return{data:await It(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await It(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:Zk});if(h.error)throw h.error;const p=await h.json(),x=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(w.split(";")[1].split("=")[1]);d[`${j}Page`]=_}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(wt(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await It(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await It(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await It(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(wt(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await It(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await It(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}}function Kk(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const $u={debug:!!(globalThis&&oF()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cF extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class eB extends cF{}async function tB(n,e,t){$u.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),$u.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){$u.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{$u.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw $u.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new eB(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if($u.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function nB(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function dF(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function rB(n){return parseInt(n,16)}function sB(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function iB(n){var e;const{chainId:t,domain:r,expirationTime:s,issuedAt:a=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:h,uri:p,version:x}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const v=dF(n.address),w=h?`${h}://${r}`:r,_=n.statement?`${n.statement}
`:"",j=`${w} wants you to sign in with your Ethereum account:
${v}

${_}`;let T=`URI: ${p}
Version: ${x}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(s&&(T+=`
Expiration Time: ${s.toISOString()}`),l&&(T+=`
Not Before: ${l.toISOString()}`),c&&(T+=`
Request ID: ${c}`),d){let P=`
Resources:`;for(const D of d){if(!D||typeof D!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${D}`);P+=`
- ${D}`}T+=P}return`${j}
${T}`}class gr extends Error{constructor({message:e,code:t,cause:r,name:s}){var a;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(a=s??(r instanceof Error?r.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=t}}class vx extends gr{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function aB({error:n,options:e}){var t,r,s;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new gr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=a.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new gr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((r=a.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new gr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new gr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new gr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new gr({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new gr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new gr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(uF(o)){if(a.rp.id!==o)return new gr({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new gr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new gr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new gr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new gr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function oB({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new gr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new gr({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const r=window.location.hostname;if(uF(r)){if(t.rpId!==r)return new gr({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new gr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new gr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new gr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class lB{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const cB=new lB;function dB(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:r}=n,s=qf(n,["challenge","user","excludeCredentials"]),a=df(e).buffer,o=Object.assign(Object.assign({},t),{id:df(t.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:a,user:o});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const d=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:df(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function uB(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,r=qf(n,["challenge","allowCredentials"]),s=df(e).buffer,a=Object.assign(Object.assign({},r),{challenge:s});if(t&&t.length>0){a.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const l=t[o];a.allowCredentials[o]=Object.assign(Object.assign({},l),{id:df(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function fB(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:nu(new Uint8Array(n.response.attestationObject)),clientDataJSON:nu(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function hB(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,r=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:nu(new Uint8Array(s.authenticatorData)),clientDataJSON:nu(new Uint8Array(s.clientDataJSON)),signature:nu(new Uint8Array(s.signature)),userHandle:s.userHandle?nu(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function uF(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Jk(){var n,e;return!!($r()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function mB(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new vx("Browser returned unexpected credential type",e)}:{data:null,error:new vx("Empty credential response",e)}}catch(e){return{data:null,error:aB({error:e,options:n})}}}async function pB(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new vx("Browser returned unexpected credential type",e)}:{data:null,error:new vx("Empty credential response",e)}}catch(e){return{data:null,error:oB({error:e,options:n})}}}const gB={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},xB={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function bx(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of n)if(s)for(const a in s){const o=s[a];if(o!==void 0)if(Array.isArray(o))r[a]=o;else if(t(o))r[a]=o;else if(e(o)){const l=r[a];e(l)?r[a]=bx(l,o):r[a]=bx(o)}else r[a]=o}return r}function yB(n,e){return bx(gB,n,e||{})}function vB(n,e){return bx(xB,n,e||{})}class bB{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},a){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:l};const c=s??cB.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=yB(o.webauthn.credential_options.publicKey,a?.create),{data:h,error:p}=await mB({publicKey:d,signal:c});return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}case"request":{const d=vB(o.webauthn.credential_options.publicKey,a?.request),{data:h,error:p}=await pB(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:c}));return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}}}catch(o){return wt(o)?{data:null,error:o}:{data:null,error:new tu("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new om("rpId is required for WebAuthn authentication")};try{if(!Jk())return{data:null,error:new tu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:a});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:r,credential_response:c.credential_response}})}catch(o){return wt(o)?{data:null,error:o}:{data:null,error:new tu("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new om("rpId is required for WebAuthn registration")};try{if(!Jk())return{data:null,error:new tu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(h=>{var p;return(p=h.data)===null||p===void 0?void 0:p.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:a});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return wt(o)?{data:null,error:o}:{data:null,error:new tu("Unexpected error in register",o)}}}}nB();const wB={url:xV,storageKey:yV,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vV,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Qk(n,e,t){return await t()}const Hu={};class lm{get jwks(){var e,t;return(t=(e=Hu[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Hu[this.storageKey]=Object.assign(Object.assign({},Hu[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Hu[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Hu[this.storageKey]=Object.assign(Object.assign({},Hu[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},wB),e);if(this.storageKey=a.storageKey,this.instanceID=(t=lm.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,lm.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&$r()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new XV({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=lF(a.fetch),this.lock=a.lock||Qk,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:$r()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=tB:this.lock=Qk,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new bB(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:oF()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Kk(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Kk(this.memoryStorage)),$r()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${sF}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},r="none";if($r()&&(t=OV(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),$r()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),SV(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return wt(t)?this._returnResult({error:t}):this._returnResult({error:new tu("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const a=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:wa}),{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(wt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,r,s;try{let a;if("email"in e){const{email:h,password:p,options:x}=e;let v=null,w=null;this.flowType==="pkce"&&([v,w]=await Bu(this.storage,this.storageKey)),a=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:h,password:p,data:(t=x?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:v,code_challenge_method:w},xform:wa})}else if("phone"in e){const{phone:h,password:p,options:x}=e;a=await It(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:p,data:(r=x?.data)!==null&&r!==void 0?r:{},channel:(s=x?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:wa})}else throw new Fp("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(wt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:l}=e;t=await It(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Gk})}else if("phone"in e){const{phone:a,password:o,options:l}=e;t=await It(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Gk})}else throw new Fp("You must provide either an email or phone number and a password");const{data:r,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const a=new Vu;return this._returnResult({data:{user:null,session:null},error:a})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,a,o,l,c,d,h,p,x;let v,w;if("message"in e)v=e.message,w=e.signature;else{const{chain:_,wallet:j,statement:T,options:P}=e;let D;if($r())if(typeof j=="object")D=j;else{const V=window;if("ethereum"in V&&typeof V.ethereum=="object"&&"request"in V.ethereum&&typeof V.ethereum.request=="function")D=V.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!P?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");D=j}const M=new URL((t=P?.url)!==null&&t!==void 0?t:window.location.href),O=await D.request({method:"eth_requestAccounts"}).then(V=>V).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=dF(O[0]);let q=(r=P?.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!q){const V=await D.request({method:"eth_chainId"});q=rB(V)}const F={domain:M.host,address:I,statement:T,uri:M.href,version:"1",chainId:q,nonce:(s=P?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(a=P?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=P?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=P?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=P?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(h=P?.signInWithEthereum)===null||h===void 0?void 0:h.resources};v=iB(F),w=await D.request({method:"personal_sign",params:[sB(v),I]})}try{const{data:_,error:j}=await It(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:w},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:wa});if(j)throw j;if(!_||!_.session||!_.user){const T=new Vu;return this._returnResult({data:{user:null,session:null},error:T})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:j})}catch(_){if(wt(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var t,r,s,a,o,l,c,d,h,p,x,v;let w,_;if("message"in e)w=e.message,_=e.signature;else{const{chain:j,wallet:T,statement:P,options:D}=e;let M;if($r())if(typeof T=="object")M=T;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))M=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!D?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=T}const O=new URL((t=D?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in M&&M.signIn){const I=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},D?.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),P?{statement:P}:null));let q;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")q=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)q=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in q&&"signature"in q&&(typeof q.signedMessage=="string"||q.signedMessage instanceof Uint8Array)&&q.signature instanceof Uint8Array)w=typeof q.signedMessage=="string"?q.signedMessage:new TextDecoder().decode(q.signedMessage),_=q.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${O.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...P?["",P,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(s=(r=D?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=D?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${D.signInWithSolana.notBefore}`]:[],...!((o=D?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${D.signInWithSolana.expirationTime}`]:[],...!((l=D?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${D.signInWithSolana.chainId}`]:[],...!((c=D?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${D.signInWithSolana.nonce}`]:[],...!((d=D?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${D.signInWithSolana.requestId}`]:[],...!((p=(h=D?.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||p===void 0)&&p.length?["Resources",...D.signInWithSolana.resources.map(q=>`- ${q}`)]:[]].join(`
`);const I=await M.signMessage(new TextEncoder().encode(w),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=I}}try{const{data:j,error:T}=await It(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:nu(_)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:wa});if(T)throw T;if(!j||!j.session||!j.user){const P=new Vu;return this._returnResult({data:{user:null,session:null},error:P})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:T})}catch(j){if(wt(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async _exchangeCodeForSession(e){const t=await Ud(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:a,error:o}=await It(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:wa});if(await _c(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const l=new Vu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(wt(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:a,nonce:o}=e,l=await It(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:wa}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const h=new Vu;return this._returnResult({data:{user:null,session:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,s,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Bu(this.storage,this.storageKey));const{error:p}=await It(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c?.data)!==null&&t!==void 0?t:{},create_user:(r=c?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:h}=await It(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(a=c?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(o=c?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:h})}throw new Fp("You must provide either an email or phone number.")}catch(l){if(wt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,r;try{let s,a;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await It(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:wa});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(wt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,r,s,a,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Bu(this.storage,this.storageKey));const d=await It(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:KV});return!((a=d.data)===null||a===void 0)&&a.url&&$r()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(wt(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ba;const{error:s}=await It(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(wt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:a}=e,{error:o}=await It(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:s,options:a}=e,{data:o,error:l}=await It(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new Fp("You must provide either an email or phone number and a type")}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ud(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<sb:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Ud(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=ob()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=HV(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await It(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Dc}):await this._useSession(async t=>{var r,s,a;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ba}:await It(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Dc})})}catch(t){if(wt(t))return NV(t)&&(await this._removeSession(),await _c(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new ba;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Bu(this.storage,this.storageKey));const{data:d,error:h}=await It(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Dc});if(h)throw h;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(wt(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ba;const t=Date.now()/1e3;let r=t,s=!0,a=null;const{payload:o}=ab(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(wt(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new ba;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!$r())throw new qp("No browser detected.");if(e.error||e.error_description||e.error_code)throw new qp(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Uk("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new qp("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Uk("No code detected.");const{data:P,error:D}=await this._exchangeCodeForSession(e.code);if(D)throw D;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new qp("No session defined in URL");const h=Math.round(Date.now()/1e3),p=parseInt(l);let x=h+p;c&&(x=parseInt(c));const v=x-h;v*1e3<=tf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${p}s`);const w=x-p;h-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,x,h):h-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,x,h);const{data:_,error:j}=await this._getUser(a);if(j)throw j;const T={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:p,expires_at:x,refresh_token:o,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:e.type},error:null})}catch(r){if(wt(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ud(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({error:a});const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(jV(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await _c(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=DV(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:a},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Bu(this.storage,this.storageKey,!0));try{return await It(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(wt(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:s}=await this._useSession(async a=>{var o,l,c,d,h;const{data:p,error:x}=a;if(x)throw x;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await It(this.fetch,"GET",v,{headers:this.headers,jwt:(h=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return $r()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),this._returnResult({data:{provider:e.provider,url:r?.url},error:null})}catch(r){if(wt(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:s,data:{session:a}}=t;if(s)throw s;const{options:o,provider:l,token:c,access_token:d,nonce:h}=e,p=await It(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=a?.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:d,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:wa}),{data:x,error:v}=p;return v?this._returnResult({data:{user:null,session:null},error:v}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Vu}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:v}))}catch(s){if(wt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:o}=t;if(o)throw o;return await It(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await RV(async s=>(s>0&&await AV(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await It(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:wa})),(s,a)=>{const o=200*Math.pow(2,s);return a&&ib(a)&&Date.now()+o-r<tf})}catch(r){if(this._debug(t,"error",r),wt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),$r()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Ud(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Ud(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await nf(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:ob()}else if(s&&!s.user&&!s.user){const o=await Ud(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await _c(this.storage,this.storageKey+"-user"),await nf(this.storage,this.storageKey,s)):s.user=ob()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const a=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<sb;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${sb}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),ib(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ba;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Xx;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new ba;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),wt(a)){const o={data:null,error:a};return ib(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await nf(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const a=Hk(s);await nf(this.storage,this.storageKey,a)}else{const s=Hk(t);await nf(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await _c(this.storage,this.storageKey),await _c(this.storage,this.storageKey+"-code-verifier"),await _c(this.storage,this.storageKey+"-user"),this.userStorage&&await _c(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&$r()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),tf);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/tf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${tf}ms, refresh threshold is ${eS} ticks`),s<=eS&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof cF)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!$r()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,o]=await Bu(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r?.queryParams){const a=new URLSearchParams(r.queryParams);s.push(a.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;return a?this._returnResult({data:null,error:a}):await It(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await It(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=a?.session)===null||r===void 0?void 0:r.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?fB(e.webauthn.credential_response):hB(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await It(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=await It(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:dB(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:uB(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=ab(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((t=(e=r.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await It(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ba})})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ba});const o=await It(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&$r()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(wt(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ba});const o=await It(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&$r()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(wt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(l=>l.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+wV>s)return r;const{data:a,error:o}=await It(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,r=a.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:v,error:w}=await this.getSession();if(w||!v.session)return this._returnResult({data:null,error:w});r=v.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=ab(r);t?.allowExpired||BV(a.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:v}=await this.getUser(r);if(v)throw v;return{data:{claims:a,header:s,signature:o},error:null}}const h=WV(s.alg),p=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,p,o,MV(`${l}.${c}`)))throw new rS("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(r){if(wt(r))return this._returnResult({data:null,error:r});throw r}}}lm.nextInstanceID={};const _B=lm;class jB extends _B{constructor(e){super(e)}}class NB{constructor(e,t,r){var s,a,o;this.supabaseUrl=e,this.supabaseKey=t;const l=gV(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:lV,realtime:dV,auth:Object.assign(Object.assign({},cV),{storageKey:c}),global:oV},h=pV(r??{},d);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=hV(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new xU(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new sV(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new hU(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:o,flowType:l,lock:c,debug:d,throwOnError:h},p,x){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jB({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),p),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:l,lock:c,debug:d,throwOnError:h,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new IU(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const SB=(n,e,t)=>new NB(n,e,t);function CB(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}CB()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const TB="https://fmyafuhxlorbafbacywa.supabase.co",kB="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZteWFmdWh4bG9yYmFmYmFjeXdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMjg1NDYsImV4cCI6MjA3NzgwNDU0Nn0.RqsniEqzNec6ww35TXJtLJD3mafnGbMI82om4XRUdUU",PB=TB,MB=kB,Me=SB(PB,MB,{auth:{persistSession:!0,storage:window.localStorage,autoRefreshToken:!0,detectSessionInUrl:!0},global:{multiTab:!1}}),EB=async n=>{try{let{data:e,error:t}=await Me.from("users").select("*, role_id").eq("id",n.id).single();if(t&&t.code==="PGRST116"){const r={id:n.id,name:n.user_metadata.name||"New User",email:n.email,role_id:"unverified"},{data:s,error:a}=await Me.from("users").insert(r).select("*, role_id").single();if(a)return console.error("Error creating user profile on-the-fly:",a.message,a),null;e=s,t=null}return t?(console.error("Error fetching app profile:",t.message,t),null):{id:e.id,name:e.name,email:n.email||"",phone:e.phone,role:e.role_id,organizationId:e.organization_id,organizationName:e.organization_name,reportingManagerId:e.reporting_manager_id,photoUrl:e.photo_url}}catch(e){return console.error("Exception fetching profile:",e),null}},DB=async(n,e)=>await Me.auth.signInWithPassword({email:n,password:e}),OB=async n=>{const{email:e,password:t,options:r}=n;return await Me.auth.signUp({email:e,password:t,options:{...r,emailRedirectTo:`${window.location.origin}/`}})},IB=async(n,e)=>await Me.from("users").update({role_id:e}).eq("id",n),AB=async()=>await Me.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}}),RB=async()=>{const{error:n}=await Me.auth.signOut();n&&console.error("Error signing out:",n.message)},LB=async n=>{const e=window.location.origin;return await Me.auth.resetPasswordForEmail(n,{redirectTo:e})},FB=async n=>await Me.auth.updateUser({password:n}),ja={getAppUserProfile:EB,signInWithPassword:DB,signUpWithPassword:OB,signInWithGoogle:AB,signOut:RB,resetPasswordForEmail:LB,updateUserPassword:FB,approveUser:IB},qB="modulepreload",zB=function(n,e){return new URL(n,e).href},Xk={},cm=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let d=function(h){return Promise.all(h.map(p=>Promise.resolve(p).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");s=d(t.map(h=>{if(h=zB(h,r),h in Xk)return;Xk[h]=!0;const p=h.endsWith(".css"),x=p?'[rel="stylesheet"]':"";if(r)for(let w=o.length-1;w>=0;w--){const _=o[w];if(_.href===h&&(!p||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${x}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":qB,p||(v.as="script"),v.crossOrigin="",v.href=h,c&&v.setAttribute("nonce",c),document.head.appendChild(v),p)return new Promise((w,_)=>{v.addEventListener("load",w),v.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function Lt(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function zn(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function xl(n,e){const t=Lt(n);return isNaN(e)?zn(n,NaN):(e&&t.setDate(t.getDate()+e),t)}function ey(n,e){const t=Lt(n);if(isNaN(e))return zn(n,NaN);if(!e)return t;const r=t.getDate(),s=zn(n,t.getTime());s.setMonth(t.getMonth()+e+1,0);const a=s.getDate();return r>=a?s:(t.setFullYear(s.getFullYear(),s.getMonth(),r),t)}const fF=6048e5,UB=864e5,hF=6e4,VB=36e5,BB=1e3,zp=43200,eP=1440;let WB={};function Gc(){return WB}function So(n,e){const t=Gc(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=Lt(n),a=s.getDay(),o=(a<r?7:0)+a-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function wf(n){return So(n,{weekStartsOn:1})}function mF(n){const e=Lt(n),t=e.getFullYear(),r=zn(n,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const s=wf(r),a=zn(n,0);a.setFullYear(t,0,4),a.setHours(0,0,0,0);const o=wf(a);return e.getTime()>=s.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function Uc(n){const e=Lt(n);return e.setHours(0,0,0,0),e}function _f(n){const e=Lt(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function Mm(n,e){const t=Uc(n),r=Uc(e),s=+t-_f(t),a=+r-_f(r);return Math.round((s-a)/UB)}function $B(n){const e=mF(n),t=zn(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),wf(t)}function rx(n,e){const t=Lt(n),r=Lt(e),s=t.getTime()-r.getTime();return s<0?-1:s>0?1:s}function HB(n){return zn(n,Date.now())}function uf(n,e){const t=Uc(n),r=Uc(e);return+t==+r}function YB(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function GB(n){if(!YB(n)&&typeof n!="number")return!1;const e=Lt(n);return!isNaN(Number(e))}function ZB(n,e){const t=Lt(n),r=Lt(e),s=t.getFullYear()-r.getFullYear(),a=t.getMonth()-r.getMonth();return s*12+a}function KB(n,e){const t=Lt(n),r=Lt(e),s=tP(t,r),a=Math.abs(Mm(t,r));t.setDate(t.getDate()-s*a);const o=+(tP(t,r)===-s),l=s*(a-o);return l===0?0:l}function tP(n,e){const t=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function pF(n){return e=>{const r=(n?Math[n]:Math.trunc)(e);return r===0?0:r}}function gF(n,e){return+Lt(n)-+Lt(e)}function ff(n,e,t){const r=gF(n,e)/hF;return pF(t?.roundingMethod)(r)}function mC(n){const e=Lt(n);return e.setHours(23,59,59,999),e}function Ta(n){const e=Lt(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function JB(n){const e=Lt(n);return+mC(e)==+Ta(e)}function QB(n,e){const t=Lt(n),r=Lt(e),s=rx(t,r),a=Math.abs(ZB(t,r));let o;if(a<1)o=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-s*a);let l=rx(t,r)===-s;JB(Lt(n))&&a===1&&rx(n,r)===1&&(l=!1),o=s*(a-Number(l))}return o===0?0:o}function XB(n,e,t){const r=gF(n,e)/1e3;return pF(t?.roundingMethod)(r)}function xo(n,e){const t=Lt(n.start),r=Lt(n.end);let s=+t>+r;const a=s?+t:+r,o=s?r:t;o.setHours(0,0,0,0);let l=1;const c=[];for(;+o<=a;)c.push(Lt(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return s?c.reverse():c}function pi(n){const e=Lt(n);return e.setDate(1),e.setHours(0,0,0,0),e}function eW(n){const e=Lt(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function xF(n){const e=Lt(n),t=zn(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function nP(n,e){const t=Gc(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=Lt(n),a=s.getDay(),o=(a<r?-7:0)+6-(a-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function cb(){return mC(Date.now())}const tW={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},nW=(n,e,t)=>{let r;const s=tW[n];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function db(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const rW={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},sW={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},iW={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},aW={date:db({formats:rW,defaultWidth:"full"}),time:db({formats:sW,defaultWidth:"full"}),dateTime:db({formats:iW,defaultWidth:"full"})},oW={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},lW=(n,e,t,r)=>oW[n];function gh(n){return(e,t)=>{const r=t?.context?String(t.context):"standalone";let s;if(r==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,l=t?.width?String(t.width):o;s=n.formattingValues[l]||n.formattingValues[o]}else{const o=n.defaultWidth,l=t?.width?String(t.width):n.defaultWidth;s=n.values[l]||n.values[o]}const a=n.argumentCallback?n.argumentCallback(e):e;return s[a]}}const cW={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},dW={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},uW={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},fW={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},hW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},mW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},pW=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},gW={ordinalNumber:pW,era:gh({values:cW,defaultWidth:"wide"}),quarter:gh({values:dW,defaultWidth:"wide",argumentCallback:n=>n-1}),month:gh({values:uW,defaultWidth:"wide"}),day:gh({values:fW,defaultWidth:"wide"}),dayPeriod:gh({values:hW,defaultWidth:"wide",formattingValues:mW,defaultFormattingWidth:"wide"})};function xh(n){return(e,t={})=>{const r=t.width,s=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],a=e.match(s);if(!a)return null;const o=a[0],l=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(l)?yW(l,p=>p.test(o)):xW(l,p=>p.test(o));let d;d=n.valueCallback?n.valueCallback(c):c,d=t.valueCallback?t.valueCallback(d):d;const h=e.slice(o.length);return{value:d,rest:h}}}function xW(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function yW(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function vW(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const s=r[0],a=e.match(n.parsePattern);if(!a)return null;let o=n.valueCallback?n.valueCallback(a[0]):a[0];o=t.valueCallback?t.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const bW=/^(\d+)(th|st|nd|rd)?/i,wW=/\d+/i,_W={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},jW={any:[/^b/i,/^(a|c)/i]},NW={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},SW={any:[/1/i,/2/i,/3/i,/4/i]},CW={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},TW={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},kW={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},PW={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},MW={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},EW={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},DW={ordinalNumber:vW({matchPattern:bW,parsePattern:wW,valueCallback:n=>parseInt(n,10)}),era:xh({matchPatterns:_W,defaultMatchWidth:"wide",parsePatterns:jW,defaultParseWidth:"any"}),quarter:xh({matchPatterns:NW,defaultMatchWidth:"wide",parsePatterns:SW,defaultParseWidth:"any",valueCallback:n=>n+1}),month:xh({matchPatterns:CW,defaultMatchWidth:"wide",parsePatterns:TW,defaultParseWidth:"any"}),day:xh({matchPatterns:kW,defaultMatchWidth:"wide",parsePatterns:PW,defaultParseWidth:"any"}),dayPeriod:xh({matchPatterns:MW,defaultMatchWidth:"any",parsePatterns:EW,defaultParseWidth:"any"})},pC={code:"en-US",formatDistance:nW,formatLong:aW,formatRelative:lW,localize:gW,match:DW,options:{weekStartsOn:0,firstWeekContainsDate:1}};function OW(n){const e=Lt(n);return Mm(e,xF(e))+1}function yF(n){const e=Lt(n),t=+wf(e)-+$B(e);return Math.round(t/fF)+1}function gC(n,e){const t=Lt(n),r=t.getFullYear(),s=Gc(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=zn(n,0);o.setFullYear(r+1,0,a),o.setHours(0,0,0,0);const l=So(o,e),c=zn(n,0);c.setFullYear(r,0,a),c.setHours(0,0,0,0);const d=So(c,e);return t.getTime()>=l.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function IW(n,e){const t=Gc(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,s=gC(n,e),a=zn(n,0);return a.setFullYear(s,0,r),a.setHours(0,0,0,0),So(a,e)}function vF(n,e){const t=Lt(n),r=+So(t,e)-+IW(t,e);return Math.round(r/fF)+1}function wn(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const jc={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return wn(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):wn(t+1,2)},d(n,e){return wn(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return wn(n.getHours()%12||12,e.length)},H(n,e){return wn(n.getHours(),e.length)},m(n,e){return wn(n.getMinutes(),e.length)},s(n,e){return wn(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),s=Math.trunc(r*Math.pow(10,t-3));return wn(s,e.length)}},Yu={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},rP={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),s=r>0?r:1-r;return t.ordinalNumber(s,{unit:"year"})}return jc.y(n,e)},Y:function(n,e,t,r){const s=gC(n,r),a=s>0?s:1-s;if(e==="YY"){const o=a%100;return wn(o,2)}return e==="Yo"?t.ordinalNumber(a,{unit:"year"}):wn(a,e.length)},R:function(n,e){const t=mF(n);return wn(t,e.length)},u:function(n,e){const t=n.getFullYear();return wn(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return wn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return wn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return jc.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return wn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const s=vF(n,r);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):wn(s,e.length)},I:function(n,e,t){const r=yF(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):wn(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):jc.d(n,e)},D:function(n,e,t){const r=OW(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):wn(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const s=n.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return wn(a,2);case"eo":return t.ordinalNumber(a,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const s=n.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return wn(a,e.length);case"co":return t.ordinalNumber(a,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return wn(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const s=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let s;switch(r===12?s=Yu.noon:r===0?s=Yu.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let s;switch(r>=17?s=Yu.evening:r>=12?s=Yu.afternoon:r>=4?s=Yu.morning:s=Yu.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return jc.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):jc.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):wn(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):wn(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):jc.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):jc.s(n,e)},S:function(n,e){return jc.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return iP(r);case"XXXX":case"XX":return Kd(r);case"XXXXX":case"XXX":default:return Kd(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return iP(r);case"xxxx":case"xx":return Kd(r);case"xxxxx":case"xxx":default:return Kd(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+sP(r,":");case"OOOO":default:return"GMT"+Kd(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+sP(r,":");case"zzzz":default:return"GMT"+Kd(r,":")}},t:function(n,e,t){const r=Math.trunc(n.getTime()/1e3);return wn(r,e.length)},T:function(n,e,t){const r=n.getTime();return wn(r,e.length)}};function sP(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Math.trunc(r/60),a=r%60;return a===0?t+String(s):t+String(s)+e+wn(a,2)}function iP(n,e){return n%60===0?(n>0?"-":"+")+wn(Math.abs(n)/60,2):Kd(n,e)}function Kd(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=wn(Math.trunc(r/60),2),a=wn(r%60,2);return t+s+e+a}const aP=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},bF=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},AW=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],s=t[2];if(!s)return aP(n,e);let a;switch(r){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",aP(r,e)).replace("{{time}}",bF(s,e))},sS={p:bF,P:AW},RW=/^D+$/,LW=/^Y+$/,FW=["D","DD","YY","YYYY"];function wF(n){return RW.test(n)}function _F(n){return LW.test(n)}function iS(n,e,t){const r=qW(n,e,t);if(console.warn(r),FW.includes(n))throw new RangeError(r)}function qW(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const zW=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,UW=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,VW=/^'([^]*?)'?$/,BW=/''/g,WW=/[a-zA-Z]/;function $e(n,e,t){const r=Gc(),s=r.locale??pC,a=r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,l=Lt(n);if(!GB(l))throw new RangeError("Invalid time value");let c=e.match(UW).map(h=>{const p=h[0];if(p==="p"||p==="P"){const x=sS[p];return x(h,s.formatLong)}return h}).join("").match(zW).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const p=h[0];if(p==="'")return{isToken:!1,value:$W(h)};if(rP[p])return{isToken:!0,value:h};if(p.match(WW))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:h}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const d={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(h=>{if(!h.isToken)return h.value;const p=h.value;(_F(p)||wF(p))&&iS(p,e,String(n));const x=rP[p[0]];return x(l,p,s.localize,d)}).join("")}function $W(n){const e=n.match(VW);return e?e[1].replace(BW,"'"):n}function HW(n,e,t){const r=Gc(),s=t?.locale??r.locale??pC,a=2520,o=rx(n,e);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:o});let c,d;o>0?(c=Lt(e),d=Lt(n)):(c=Lt(n),d=Lt(e));const h=XB(d,c),p=(_f(d)-_f(c))/1e3,x=Math.round((h-p)/60);let v;if(x<2)return t?.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,l):h<10?s.formatDistance("lessThanXSeconds",10,l):h<20?s.formatDistance("lessThanXSeconds",20,l):h<40?s.formatDistance("halfAMinute",0,l):h<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):x===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",x,l);if(x<45)return s.formatDistance("xMinutes",x,l);if(x<90)return s.formatDistance("aboutXHours",1,l);if(x<eP){const w=Math.round(x/60);return s.formatDistance("aboutXHours",w,l)}else{if(x<a)return s.formatDistance("xDays",1,l);if(x<zp){const w=Math.round(x/eP);return s.formatDistance("xDays",w,l)}else if(x<zp*2)return v=Math.round(x/zp),s.formatDistance("aboutXMonths",v,l)}if(v=QB(d,c),v<12){const w=Math.round(x/zp);return s.formatDistance("xMonths",w,l)}else{const w=v%12,_=Math.trunc(v/12);return w<3?s.formatDistance("aboutXYears",_,l):w<9?s.formatDistance("overXYears",_,l):s.formatDistance("almostXYears",_+1,l)}}function cu(n,e){return HW(n,HB(n),e)}function xC(n){return Lt(n).getDay()}function YW(){return Object.assign({},Gc())}function GW(n){let t=Lt(n).getDay();return t===0&&(t=7),t}function ZW(n,e){const t=Lt(n),r=Lt(e);return t.getTime()>r.getTime()}function KW(n,e){const t=e instanceof Date?zn(e,0):new e(0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),t}const JW=10;let jF=class{subPriority=0;validate(e,t){return!0}};class QW extends jF{constructor(e,t,r,s,a){super(),this.value=e,this.validateValue=t,this.setValue=r,this.priority=s,a&&(this.subPriority=a)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,r){return this.setValue(e,t,this.value,r)}}class XW extends jF{priority=JW;subPriority=-1;set(e,t){return t.timestampIsSet?e:zn(e,KW(e,Date))}}let mn=class{run(e,t,r,s){const a=this.parse(e,t,r,s);return a?{setter:new QW(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(e,t,r){return!0}},e$=class extends mn{priority=140;parse(e,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"});case"GGGGG":return r.era(e,{width:"narrow"});case"GGGG":default:return r.era(e,{width:"wide"})||r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"})}}set(e,t,r){return t.era=r,e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]};const ar={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},yo={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function or(n,e){return n&&{value:e(n.value),rest:n.rest}}function Qn(n,e){const t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function vo(n,e){const t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const r=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,a=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:r*(s*VB+a*hF+o*BB),rest:e.slice(t[0].length)}}function NF(n){return Qn(ar.anyDigitsSigned,n)}function nr(n,e){switch(n){case 1:return Qn(ar.singleDigit,e);case 2:return Qn(ar.twoDigits,e);case 3:return Qn(ar.threeDigits,e);case 4:return Qn(ar.fourDigits,e);default:return Qn(new RegExp("^\\d{1,"+n+"}"),e)}}function wx(n,e){switch(n){case 1:return Qn(ar.singleDigitSigned,e);case 2:return Qn(ar.twoDigitsSigned,e);case 3:return Qn(ar.threeDigitsSigned,e);case 4:return Qn(ar.fourDigitsSigned,e);default:return Qn(new RegExp("^-?\\d{1,"+n+"}"),e)}}function yC(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function SF(n,e){const t=e>0,r=t?e:1-e;let s;if(r<=50)s=n||100;else{const a=r+50,o=Math.trunc(a/100)*100,l=n>=a%100;s=n+o-(l?100:0)}return t?s:1-s}function CF(n){return n%400===0||n%4===0&&n%100!==0}let t$=class extends mn{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,t,r){const s=a=>({year:a,isTwoDigitYear:t==="yy"});switch(t){case"y":return or(nr(4,e),s);case"yo":return or(r.ordinalNumber(e,{unit:"year"}),s);default:return or(nr(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r){const s=e.getFullYear();if(r.isTwoDigitYear){const o=SF(r.year,s);return e.setFullYear(o,0,1),e.setHours(0,0,0,0),e}const a=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}},n$=class extends mn{priority=130;parse(e,t,r){const s=a=>({year:a,isTwoDigitYear:t==="YY"});switch(t){case"Y":return or(nr(4,e),s);case"Yo":return or(r.ordinalNumber(e,{unit:"year"}),s);default:return or(nr(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r,s){const a=gC(e,s);if(r.isTwoDigitYear){const l=SF(r.year,a);return e.setFullYear(l,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),So(e,s)}const o=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(o,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),So(e,s)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},r$=class extends mn{priority=130;parse(e,t){return wx(t==="R"?4:t.length,e)}set(e,t,r){const s=zn(e,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),wf(s)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},s$=class extends mn{priority=130;parse(e,t){return wx(t==="u"?4:t.length,e)}set(e,t,r){return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]},i$=class extends mn{priority=120;parse(e,t,r){switch(t){case"Q":case"QQ":return nr(t.length,e);case"Qo":return r.ordinalNumber(e,{unit:"quarter"});case"QQQ":return r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(e,{width:"wide",context:"formatting"})||r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},a$=class extends mn{priority=120;parse(e,t,r){switch(t){case"q":case"qq":return nr(t.length,e);case"qo":return r.ordinalNumber(e,{unit:"quarter"});case"qqq":return r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(e,{width:"wide",context:"standalone"})||r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},o$=class extends mn{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,t,r){const s=a=>a-1;switch(t){case"M":return or(Qn(ar.month,e),s);case"MM":return or(nr(2,e),s);case"Mo":return or(r.ordinalNumber(e,{unit:"month"}),s);case"MMM":return r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(e,{width:"wide",context:"formatting"})||r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}},l$=class extends mn{priority=110;parse(e,t,r){const s=a=>a-1;switch(t){case"L":return or(Qn(ar.month,e),s);case"LL":return or(nr(2,e),s);case"Lo":return or(r.ordinalNumber(e,{unit:"month"}),s);case"LLL":return r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(e,{width:"wide",context:"standalone"})||r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};function c$(n,e,t){const r=Lt(n),s=vF(r,t)-e;return r.setDate(r.getDate()-s*7),r}let d$=class extends mn{priority=100;parse(e,t,r){switch(t){case"w":return Qn(ar.week,e);case"wo":return r.ordinalNumber(e,{unit:"week"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r,s){return So(c$(e,r,s),s)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};function u$(n,e){const t=Lt(n),r=yF(t)-e;return t.setDate(t.getDate()-r*7),t}let f$=class extends mn{priority=100;parse(e,t,r){switch(t){case"I":return Qn(ar.week,e);case"Io":return r.ordinalNumber(e,{unit:"week"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r){return wf(u$(e,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};const h$=[31,28,31,30,31,30,31,31,30,31,30,31],m$=[31,29,31,30,31,30,31,31,30,31,30,31];let p$=class extends mn{priority=90;subPriority=1;parse(e,t,r){switch(t){case"d":return Qn(ar.date,e);case"do":return r.ordinalNumber(e,{unit:"date"});default:return nr(t.length,e)}}validate(e,t){const r=e.getFullYear(),s=CF(r),a=e.getMonth();return s?t>=1&&t<=m$[a]:t>=1&&t<=h$[a]}set(e,t,r){return e.setDate(r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]},g$=class extends mn{priority=90;subpriority=1;parse(e,t,r){switch(t){case"D":case"DD":return Qn(ar.dayOfYear,e);case"Do":return r.ordinalNumber(e,{unit:"date"});default:return nr(t.length,e)}}validate(e,t){const r=e.getFullYear();return CF(r)?t>=1&&t<=366:t>=1&&t<=365}set(e,t,r){return e.setMonth(0,r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};function vC(n,e,t){const r=Gc(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=Lt(n),o=a.getDay(),c=(e%7+7)%7,d=7-s,h=e<0||e>6?e-(o+d)%7:(c+d)%7-(o+d)%7;return xl(a,h)}let x$=class extends mn{priority=90;parse(e,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=vC(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]},y$=class extends mn{priority=90;parse(e,t,r,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(t){case"e":case"ee":return or(nr(t.length,e),a);case"eo":return or(r.ordinalNumber(e,{unit:"day"}),a);case"eee":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeeee":return r.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=vC(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},v$=class extends mn{priority=90;parse(e,t,r,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(t){case"c":case"cc":return or(nr(t.length,e),a);case"co":return or(r.ordinalNumber(e,{unit:"day"}),a);case"ccc":return r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"ccccc":return r.day(e,{width:"narrow",context:"standalone"});case"cccccc":return r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(e,{width:"wide",context:"standalone"})||r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=vC(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};function b$(n,e){const t=Lt(n),r=GW(t),s=e-r;return xl(t,s)}let w$=class extends mn{priority=90;parse(e,t,r){const s=a=>a===0?7:a;switch(t){case"i":case"ii":return nr(t.length,e);case"io":return r.ordinalNumber(e,{unit:"day"});case"iii":return or(r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s);case"iiiii":return or(r.day(e,{width:"narrow",context:"formatting"}),s);case"iiiiii":return or(r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s);case"iiii":default:return or(r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s)}}validate(e,t){return t>=1&&t<=7}set(e,t,r){return e=b$(e,r),e.setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},_$=class extends mn{priority=80;parse(e,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(yC(r),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]},j$=class extends mn{priority=80;parse(e,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(yC(r),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]},N$=class extends mn{priority=80;parse(e,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(yC(r),0,0,0),e}incompatibleTokens=["a","b","t","T"]},S$=class extends mn{priority=70;parse(e,t,r){switch(t){case"h":return Qn(ar.hour12h,e);case"ho":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,r){const s=e.getHours()>=12;return s&&r<12?e.setHours(r+12,0,0,0):!s&&r===12?e.setHours(0,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]},C$=class extends mn{priority=70;parse(e,t,r){switch(t){case"H":return Qn(ar.hour23h,e);case"Ho":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,r){return e.setHours(r,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]},T$=class extends mn{priority=70;parse(e,t,r){switch(t){case"K":return Qn(ar.hour11h,e);case"Ko":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.getHours()>=12&&r<12?e.setHours(r+12,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]},k$=class extends mn{priority=70;parse(e,t,r){switch(t){case"k":return Qn(ar.hour24h,e);case"ko":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,r){const s=r<=24?r%24:r;return e.setHours(s,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]},P$=class extends mn{priority=60;parse(e,t,r){switch(t){case"m":return Qn(ar.minute,e);case"mo":return r.ordinalNumber(e,{unit:"minute"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setMinutes(r,0,0),e}incompatibleTokens=["t","T"]},M$=class extends mn{priority=50;parse(e,t,r){switch(t){case"s":return Qn(ar.second,e);case"so":return r.ordinalNumber(e,{unit:"second"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setSeconds(r,0),e}incompatibleTokens=["t","T"]},E$=class extends mn{priority=30;parse(e,t){const r=s=>Math.trunc(s*Math.pow(10,-t.length+3));return or(nr(t.length,e),r)}set(e,t,r){return e.setMilliseconds(r),e}incompatibleTokens=["t","T"]},D$=class extends mn{priority=10;parse(e,t){switch(t){case"X":return vo(yo.basicOptionalMinutes,e);case"XX":return vo(yo.basic,e);case"XXXX":return vo(yo.basicOptionalSeconds,e);case"XXXXX":return vo(yo.extendedOptionalSeconds,e);case"XXX":default:return vo(yo.extended,e)}}set(e,t,r){return t.timestampIsSet?e:zn(e,e.getTime()-_f(e)-r)}incompatibleTokens=["t","T","x"]},O$=class extends mn{priority=10;parse(e,t){switch(t){case"x":return vo(yo.basicOptionalMinutes,e);case"xx":return vo(yo.basic,e);case"xxxx":return vo(yo.basicOptionalSeconds,e);case"xxxxx":return vo(yo.extendedOptionalSeconds,e);case"xxx":default:return vo(yo.extended,e)}}set(e,t,r){return t.timestampIsSet?e:zn(e,e.getTime()-_f(e)-r)}incompatibleTokens=["t","T","X"]},I$=class extends mn{priority=40;parse(e){return NF(e)}set(e,t,r){return[zn(e,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"},A$=class extends mn{priority=20;parse(e){return NF(e)}set(e,t,r){return[zn(e,r),{timestampIsSet:!0}]}incompatibleTokens="*"};const R$={G:new e$,y:new t$,Y:new n$,R:new r$,u:new s$,Q:new i$,q:new a$,M:new o$,L:new l$,w:new d$,I:new f$,d:new p$,D:new g$,E:new x$,e:new y$,c:new v$,i:new w$,a:new _$,b:new j$,B:new N$,h:new S$,H:new C$,K:new T$,k:new k$,m:new P$,s:new M$,S:new E$,X:new D$,x:new O$,t:new I$,T:new A$},L$=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,F$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,q$=/^'([^]*?)'?$/,z$=/''/g,U$=/\S/,V$=/[a-zA-Z]/;function B$(n,e,t,r){const s=YW(),a=s.locale??pC,o=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,l=s.weekStartsOn??s.locale?.options?.weekStartsOn??0;if(e==="")return n===""?Lt(t):zn(t,NaN);const c={firstWeekContainsDate:o,weekStartsOn:l,locale:a},d=[new XW],h=e.match(F$).map(_=>{const j=_[0];if(j in sS){const T=sS[j];return T(_,a.formatLong)}return _}).join("").match(L$),p=[];for(let _ of h){_F(_)&&iS(_,e,n),wF(_)&&iS(_,e,n);const j=_[0],T=R$[j];if(T){const{incompatibleTokens:P}=T;if(Array.isArray(P)){const M=p.find(O=>P.includes(O.token)||O.token===j);if(M)throw new RangeError(`The format string mustn't contain \`${M.fullToken}\` and \`${_}\` at the same time`)}else if(T.incompatibleTokens==="*"&&p.length>0)throw new RangeError(`The format string mustn't contain \`${_}\` and any other token at the same time`);p.push({token:j,fullToken:_});const D=T.run(n,_,a.match,c);if(!D)return zn(t,NaN);d.push(D.setter),n=D.rest}else{if(j.match(V$))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");if(_==="''"?_="'":j==="'"&&(_=W$(_)),n.indexOf(_)===0)n=n.slice(_.length);else return zn(t,NaN)}}if(n.length>0&&U$.test(n))return zn(t,NaN);const x=d.map(_=>_.priority).sort((_,j)=>j-_).filter((_,j,T)=>T.indexOf(_)===j).map(_=>d.filter(j=>j.priority===_).sort((j,T)=>T.subPriority-j.subPriority)).map(_=>_[0]);let v=Lt(t);if(isNaN(v.getTime()))return zn(t,NaN);const w={};for(const _ of x){if(!_.validate(v,c))return zn(t,NaN);const j=_.set(v,w,c);Array.isArray(j)?(v=j[0],Object.assign(w,j[1])):v=j}return zn(t,v)}function W$(n){return n.match(q$)[1].replace(z$,"'")}function hf(n,e){return xl(n,-e)}function sx(){return Uc(Date.now())}function bC(n,e){return ey(n,-1)}var dn;(function(n){n.assertEqual=s=>{};function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const a={};for(const o of s)a[o]=o;return a},n.getValidEnumValues=s=>{const a=n.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),o={};for(const l of a)o[l]=s[l];return n.objectValues(o)},n.objectValues=s=>n.objectKeys(s).map(function(a){return s[a]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&a.push(o);return a},n.find=(s,a)=>{for(const o of s)if(a(o))return o},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}n.joinValues=r,n.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(dn||(dn={}));var oP;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(oP||(oP={}));const ft=dn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ec=n=>{switch(typeof n){case"undefined":return ft.undefined;case"string":return ft.string;case"number":return Number.isNaN(n)?ft.nan:ft.number;case"boolean":return ft.boolean;case"function":return ft.function;case"bigint":return ft.bigint;case"symbol":return ft.symbol;case"object":return Array.isArray(n)?ft.array:n===null?ft.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?ft.promise:typeof Map<"u"&&n instanceof Map?ft.map:typeof Set<"u"&&n instanceof Set?ft.set:typeof Date<"u"&&n instanceof Date?ft.date:ft.object;default:return ft.unknown}},Qe=dn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Nl extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},r={_errors:[]},s=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let l=r,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(t(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return s(this),r}static assert(e){if(!(e instanceof Nl))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,dn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];t[a]=t[a]||[],t[a].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Nl.create=n=>new Nl(n);const aS=(n,e)=>{let t;switch(n.code){case Qe.invalid_type:n.received===ft.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case Qe.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,dn.jsonStringifyReplacer)}`;break;case Qe.unrecognized_keys:t=`Unrecognized key(s) in object: ${dn.joinValues(n.keys,", ")}`;break;case Qe.invalid_union:t="Invalid input";break;case Qe.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${dn.joinValues(n.options)}`;break;case Qe.invalid_enum_value:t=`Invalid enum value. Expected ${dn.joinValues(n.options)}, received '${n.received}'`;break;case Qe.invalid_arguments:t="Invalid function arguments";break;case Qe.invalid_return_type:t="Invalid function return type";break;case Qe.invalid_date:t="Invalid date";break;case Qe.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:dn.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case Qe.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case Qe.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case Qe.custom:t="Invalid input";break;case Qe.invalid_intersection_types:t="Intersection results could not be merged";break;case Qe.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case Qe.not_finite:t="Number must be finite";break;default:t=e.defaultError,dn.assertNever(n)}return{message:t}};let $$=aS;function H$(){return $$}const Y$=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,a=[...t,...s.path||[]],o={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let l="";const c=r.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:e,defaultError:l}).message;return{...s,path:a,message:l}};function it(n,e){const t=H$(),r=Y$({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===aS?void 0:aS].filter(s=>!!s)});n.common.issues.push(r)}class Ns{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return Vt;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t){const a=await s.key,o=await s.value;r.push({key:a,value:o})}return Ns.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:a,value:o}=s;if(a.status==="aborted"||o.status==="aborted")return Vt;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[a.value]=o.value)}return{status:e.value,value:r}}}const Vt=Object.freeze({status:"aborted"}),Vh=n=>({status:"dirty",value:n}),Ki=n=>({status:"valid",value:n}),lP=n=>n.status==="aborted",cP=n=>n.status==="dirty",jf=n=>n.status==="valid",_x=n=>typeof Promise<"u"&&n instanceof Promise;var xt;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message})(xt||(xt={}));class Co{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const dP=(n,e)=>{if(jf(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Nl(n.common.issues);return this._error=t,this._error}}};function Zt(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,l)=>{const{message:c}=n;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??r??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??t??l.defaultError}},description:s}}class sn{get description(){return this._def.description}_getType(e){return Ec(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Ec(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ns,ctx:{common:e.parent.common,data:e.data,parsedType:Ec(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(_x(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ec(e)},s=this._parseSync({data:e,path:r.path,parent:r});return dP(r,s)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ec(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:t});return jf(r)?{value:r.value}:{issues:t.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>jf(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ec(e)},s=this._parse({data:e,path:r.path,parent:r}),a=await(_x(s)?s:Promise.resolve(s));return dP(r,a)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,a)=>{const o=e(s),l=()=>a.addIssue({code:Qe.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new Cf({schema:this,typeName:zt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return qc.create(this,this._def)}nullable(){return Tf.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return jo.create(this)}promise(){return Tx.create(this,this._def)}or(e){return Nx.create([this,e],this._def)}and(e){return Sx.create(this,e,this._def)}transform(e){return new Cf({...Zt(this._def),schema:this,typeName:zt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new dS({...Zt(this._def),innerType:this,defaultValue:t,typeName:zt.ZodDefault})}brand(){return new gH({typeName:zt.ZodBranded,type:this,...Zt(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new uS({...Zt(this._def),innerType:this,catchValue:t,typeName:zt.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return wC.create(this,e)}readonly(){return fS.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const G$=/^c[^\s-]{8,}$/i,Z$=/^[0-9a-z]+$/,K$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,J$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Q$=/^[a-z0-9_-]{21}$/i,X$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,eH=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,tH=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,nH="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ub;const rH=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,sH=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,iH=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,aH=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,oH=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,lH=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,TF="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",cH=new RegExp(`^${TF}$`);function kF(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function dH(n){return new RegExp(`^${kF(n)}$`)}function uH(n){let e=`${TF}T${kF(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function fH(n,e){return!!((e==="v4"||!e)&&rH.test(n)||(e==="v6"||!e)&&iH.test(n))}function hH(n,e){if(!X$.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function mH(n,e){return!!((e==="v4"||!e)&&sH.test(n)||(e==="v6"||!e)&&aH.test(n))}class bo extends sn{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ft.string){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_type,expected:ft.string,received:a.parsedType}),Vt}const r=new Ns;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const o=e.data.length>a.value,l=e.data.length<a.value;(o||l)&&(s=this._getOrReturnCtx(e,s),o?it(s,{code:Qe.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):l&&it(s,{code:Qe.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")tH.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"email",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")ub||(ub=new RegExp(nH,"u")),ub.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"emoji",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")J$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"uuid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")Q$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"nanoid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")G$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"cuid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")Z$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"cuid2",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")K$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"ulid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),it(s,{validation:"url",code:Qe.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"regex",code:Qe.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?uH(a).test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?cH.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?dH(a).test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?eH.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"duration",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?fH(e.data,a.version)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"ip",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?hH(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"jwt",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?mH(e.data,a.version)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"cidr",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?oH.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"base64",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?lH.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"base64url",code:Qe.invalid_string,message:a.message}),r.dirty()):dn.assertNever(a);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(s=>e.test(s),{validation:t,code:Qe.invalid_string,...xt.errToObj(r)})}_addCheck(e){return new bo({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...xt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...xt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...xt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...xt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...xt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...xt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...xt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...xt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...xt.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...xt.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...xt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...xt.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...xt.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...xt.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...xt.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...xt.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...xt.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...xt.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...xt.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...xt.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...xt.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...xt.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...xt.errToObj(t)})}nonempty(e){return this.min(1,xt.errToObj(e))}trim(){return new bo({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new bo({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new bo({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}bo.create=n=>new bo({checks:[],typeName:zt.ZodString,coerce:n?.coerce??!1,...Zt(n)});function pH(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,a=Number.parseInt(n.toFixed(s).replace(".","")),o=Number.parseInt(e.toFixed(s).replace(".",""));return a%o/10**s}class du extends sn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ft.number){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_type,expected:ft.number,received:a.parsedType}),Vt}let r;const s=new Ns;for(const a of this._def.checks)a.kind==="int"?dn.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?pH(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.not_finite,message:a.message}),s.dirty()):dn.assertNever(a);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,xt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,xt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,xt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,xt.toString(t))}setLimit(e,t,r,s){return new du({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:xt.toString(s)}]})}_addCheck(e){return new du({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:xt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:xt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:xt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:xt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:xt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:xt.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:xt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:xt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:xt.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&dn.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}du.create=n=>new du({checks:[],typeName:zt.ZodNumber,coerce:n?.coerce||!1,...Zt(n)});class uu extends sn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ft.bigint)return this._getInvalidInput(e);let r;const s=new Ns;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):dn.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return it(t,{code:Qe.invalid_type,expected:ft.bigint,received:t.parsedType}),Vt}gte(e,t){return this.setLimit("min",e,!0,xt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,xt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,xt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,xt.toString(t))}setLimit(e,t,r,s){return new uu({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:xt.toString(s)}]})}_addCheck(e){return new uu({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:xt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:xt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:xt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:xt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:xt.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}uu.create=n=>new uu({checks:[],typeName:zt.ZodBigInt,coerce:n?.coerce??!1,...Zt(n)});class jx extends sn{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ft.boolean){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.boolean,received:r.parsedType}),Vt}return Ki(e.data)}}jx.create=n=>new jx({typeName:zt.ZodBoolean,coerce:n?.coerce||!1,...Zt(n)});class Nf extends sn{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ft.date){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_type,expected:ft.date,received:a.parsedType}),Vt}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_date}),Vt}const r=new Ns;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):dn.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Nf({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:xt.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:xt.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Nf.create=n=>new Nf({checks:[],coerce:n?.coerce||!1,typeName:zt.ZodDate,...Zt(n)});class uP extends sn{_parse(e){if(this._getType(e)!==ft.symbol){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.symbol,received:r.parsedType}),Vt}return Ki(e.data)}}uP.create=n=>new uP({typeName:zt.ZodSymbol,...Zt(n)});class fP extends sn{_parse(e){if(this._getType(e)!==ft.undefined){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.undefined,received:r.parsedType}),Vt}return Ki(e.data)}}fP.create=n=>new fP({typeName:zt.ZodUndefined,...Zt(n)});class hP extends sn{_parse(e){if(this._getType(e)!==ft.null){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.null,received:r.parsedType}),Vt}return Ki(e.data)}}hP.create=n=>new hP({typeName:zt.ZodNull,...Zt(n)});class mP extends sn{constructor(){super(...arguments),this._any=!0}_parse(e){return Ki(e.data)}}mP.create=n=>new mP({typeName:zt.ZodAny,...Zt(n)});class oS extends sn{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ki(e.data)}}oS.create=n=>new oS({typeName:zt.ZodUnknown,...Zt(n)});class Vc extends sn{_parse(e){const t=this._getOrReturnCtx(e);return it(t,{code:Qe.invalid_type,expected:ft.never,received:t.parsedType}),Vt}}Vc.create=n=>new Vc({typeName:zt.ZodNever,...Zt(n)});class pP extends sn{_parse(e){if(this._getType(e)!==ft.undefined){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.void,received:r.parsedType}),Vt}return Ki(e.data)}}pP.create=n=>new pP({typeName:zt.ZodVoid,...Zt(n)});class jo extends sn{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==ft.array)return it(t,{code:Qe.invalid_type,expected:ft.array,received:t.parsedType}),Vt;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,l=t.data.length<s.exactLength.value;(o||l)&&(it(t,{code:o?Qe.too_big:Qe.too_small,minimum:l?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(it(t,{code:Qe.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(it(t,{code:Qe.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,l)=>s.type._parseAsync(new Co(t,o,t.path,l)))).then(o=>Ns.mergeArray(r,o));const a=[...t.data].map((o,l)=>s.type._parseSync(new Co(t,o,t.path,l)));return Ns.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new jo({...this._def,minLength:{value:e,message:xt.toString(t)}})}max(e,t){return new jo({...this._def,maxLength:{value:e,message:xt.toString(t)}})}length(e,t){return new jo({...this._def,exactLength:{value:e,message:xt.toString(t)}})}nonempty(e){return this.min(1,e)}}jo.create=(n,e)=>new jo({type:n,minLength:null,maxLength:null,exactLength:null,typeName:zt.ZodArray,...Zt(e)});function rf(n){if(n instanceof xr){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=qc.create(rf(r))}return new xr({...n._def,shape:()=>e})}else return n instanceof jo?new jo({...n._def,type:rf(n.element)}):n instanceof qc?qc.create(rf(n.unwrap())):n instanceof Tf?Tf.create(rf(n.unwrap())):n instanceof fu?fu.create(n.items.map(e=>rf(e))):n}class xr extends sn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=dn.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==ft.object){const d=this._getOrReturnCtx(e);return it(d,{code:Qe.invalid_type,expected:ft.object,received:d.parsedType}),Vt}const{status:r,ctx:s}=this._processInputParams(e),{shape:a,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof Vc&&this._def.unknownKeys==="strip"))for(const d in s.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const h=a[d],p=s.data[d];c.push({key:{status:"valid",value:d},value:h._parse(new Co(s,p,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof Vc){const d=this._def.unknownKeys;if(d==="passthrough")for(const h of l)c.push({key:{status:"valid",value:h},value:{status:"valid",value:s.data[h]}});else if(d==="strict")l.length>0&&(it(s,{code:Qe.unrecognized_keys,keys:l}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const h of l){const p=s.data[h];c.push({key:{status:"valid",value:h},value:d._parse(new Co(s,p,s.path,h)),alwaysSet:h in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const h of c){const p=await h.key,x=await h.value;d.push({key:p,value:x,alwaysSet:h.alwaysSet})}return d}).then(d=>Ns.mergeObjectSync(r,d)):Ns.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return xt.errToObj,new xr({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{const s=this._def.errorMap?.(t,r).message??r.defaultError;return t.code==="unrecognized_keys"?{message:xt.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new xr({...this._def,unknownKeys:"strip"})}passthrough(){return new xr({...this._def,unknownKeys:"passthrough"})}extend(e){return new xr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new xr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:zt.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new xr({...this._def,catchall:e})}pick(e){const t={};for(const r of dn.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new xr({...this._def,shape:()=>t})}omit(e){const t={};for(const r of dn.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new xr({...this._def,shape:()=>t})}deepPartial(){return rf(this)}partial(e){const t={};for(const r of dn.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}return new xr({...this._def,shape:()=>t})}required(e){const t={};for(const r of dn.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof qc;)a=a._def.innerType;t[r]=a}return new xr({...this._def,shape:()=>t})}keyof(){return PF(dn.objectKeys(this.shape))}}xr.create=(n,e)=>new xr({shape:()=>n,unknownKeys:"strip",catchall:Vc.create(),typeName:zt.ZodObject,...Zt(e)});xr.strictCreate=(n,e)=>new xr({shape:()=>n,unknownKeys:"strict",catchall:Vc.create(),typeName:zt.ZodObject,...Zt(e)});xr.lazycreate=(n,e)=>new xr({shape:n,unknownKeys:"strip",catchall:Vc.create(),typeName:zt.ZodObject,...Zt(e)});class Nx extends sn{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(a){for(const l of a)if(l.result.status==="valid")return l.result;for(const l of a)if(l.result.status==="dirty")return t.common.issues.push(...l.ctx.common.issues),l.result;const o=a.map(l=>new Nl(l.ctx.common.issues));return it(t,{code:Qe.invalid_union,unionErrors:o}),Vt}if(t.common.async)return Promise.all(r.map(async a=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let a;const o=[];for(const c of r){const d={...t,common:{...t.common,issues:[]},parent:null},h=c._parseSync({data:t.data,path:t.path,parent:d});if(h.status==="valid")return h;h.status==="dirty"&&!a&&(a={result:h,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const l=o.map(c=>new Nl(c));return it(t,{code:Qe.invalid_union,unionErrors:l}),Vt}}get options(){return this._def.options}}Nx.create=(n,e)=>new Nx({options:n,typeName:zt.ZodUnion,...Zt(e)});function lS(n,e){const t=Ec(n),r=Ec(e);if(n===e)return{valid:!0,data:n};if(t===ft.object&&r===ft.object){const s=dn.objectKeys(e),a=dn.objectKeys(n).filter(l=>s.indexOf(l)!==-1),o={...n,...e};for(const l of a){const c=lS(n[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(t===ft.array&&r===ft.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<n.length;a++){const o=n[a],l=e[a],c=lS(o,l);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===ft.date&&r===ft.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class Sx extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(a,o)=>{if(lP(a)||lP(o))return Vt;const l=lS(a.value,o.value);return l.valid?((cP(a)||cP(o))&&t.dirty(),{status:t.value,value:l.data}):(it(r,{code:Qe.invalid_intersection_types}),Vt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,o])=>s(a,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Sx.create=(n,e,t)=>new Sx({left:n,right:e,typeName:zt.ZodIntersection,...Zt(t)});class fu extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.array)return it(r,{code:Qe.invalid_type,expected:ft.array,received:r.parsedType}),Vt;if(r.data.length<this._def.items.length)return it(r,{code:Qe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Vt;!this._def.rest&&r.data.length>this._def.items.length&&(it(r,{code:Qe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...r.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new Co(r,o,r.path,l)):null}).filter(o=>!!o);return r.common.async?Promise.all(a).then(o=>Ns.mergeArray(t,o)):Ns.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new fu({...this._def,rest:e})}}fu.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new fu({items:n,typeName:zt.ZodTuple,rest:null,...Zt(e)})};class Cx extends sn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.object)return it(r,{code:Qe.invalid_type,expected:ft.object,received:r.parsedType}),Vt;const s=[],a=this._def.keyType,o=this._def.valueType;for(const l in r.data)s.push({key:a._parse(new Co(r,l,r.path,l)),value:o._parse(new Co(r,r.data[l],r.path,l)),alwaysSet:l in r.data});return r.common.async?Ns.mergeObjectAsync(t,s):Ns.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof sn?new Cx({keyType:e,valueType:t,typeName:zt.ZodRecord,...Zt(r)}):new Cx({keyType:bo.create(),valueType:e,typeName:zt.ZodRecord,...Zt(t)})}}class gP extends sn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.map)return it(r,{code:Qe.invalid_type,expected:ft.map,received:r.parsedType}),Vt;const s=this._def.keyType,a=this._def.valueType,o=[...r.data.entries()].map(([l,c],d)=>({key:s._parse(new Co(r,l,r.path,[d,"key"])),value:a._parse(new Co(r,c,r.path,[d,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,h=await c.value;if(d.status==="aborted"||h.status==="aborted")return Vt;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),l.set(d.value,h.value)}return{status:t.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,h=c.value;if(d.status==="aborted"||h.status==="aborted")return Vt;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),l.set(d.value,h.value)}return{status:t.value,value:l}}}}gP.create=(n,e,t)=>new gP({valueType:e,keyType:n,typeName:zt.ZodMap,...Zt(t)});class dm extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.set)return it(r,{code:Qe.invalid_type,expected:ft.set,received:r.parsedType}),Vt;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(it(r,{code:Qe.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(it(r,{code:Qe.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const a=this._def.valueType;function o(c){const d=new Set;for(const h of c){if(h.status==="aborted")return Vt;h.status==="dirty"&&t.dirty(),d.add(h.value)}return{status:t.value,value:d}}const l=[...r.data.values()].map((c,d)=>a._parse(new Co(r,c,r.path,d)));return r.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,t){return new dm({...this._def,minSize:{value:e,message:xt.toString(t)}})}max(e,t){return new dm({...this._def,maxSize:{value:e,message:xt.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}dm.create=(n,e)=>new dm({valueType:n,minSize:null,maxSize:null,typeName:zt.ZodSet,...Zt(e)});class cS extends sn{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}cS.create=(n,e)=>new cS({getter:n,typeName:zt.ZodLazy,...Zt(e)});class xP extends sn{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return it(t,{received:t.data,code:Qe.invalid_literal,expected:this._def.value}),Vt}return{status:"valid",value:e.data}}get value(){return this._def.value}}xP.create=(n,e)=>new xP({value:n,typeName:zt.ZodLiteral,...Zt(e)});function PF(n,e){return new Sf({values:n,typeName:zt.ZodEnum,...Zt(e)})}class Sf extends sn{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return it(t,{expected:dn.joinValues(r),received:t.parsedType,code:Qe.invalid_type}),Vt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return it(t,{received:t.data,code:Qe.invalid_enum_value,options:r}),Vt}return Ki(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Sf.create(e,{...this._def,...t})}exclude(e,t=this._def){return Sf.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}Sf.create=PF;class yP extends sn{_parse(e){const t=dn.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ft.string&&r.parsedType!==ft.number){const s=dn.objectValues(t);return it(r,{expected:dn.joinValues(s),received:r.parsedType,code:Qe.invalid_type}),Vt}if(this._cache||(this._cache=new Set(dn.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=dn.objectValues(t);return it(r,{received:r.data,code:Qe.invalid_enum_value,options:s}),Vt}return Ki(e.data)}get enum(){return this._def.values}}yP.create=(n,e)=>new yP({values:n,typeName:zt.ZodNativeEnum,...Zt(e)});class Tx extends sn{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ft.promise&&t.common.async===!1)return it(t,{code:Qe.invalid_type,expected:ft.promise,received:t.parsedType}),Vt;const r=t.parsedType===ft.promise?t.data:Promise.resolve(t.data);return Ki(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Tx.create=(n,e)=>new Tx({type:n,typeName:zt.ZodPromise,...Zt(e)});class Cf extends sn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===zt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:o=>{it(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const o=s.transform(r.data,a);if(r.common.async)return Promise.resolve(o).then(async l=>{if(t.value==="aborted")return Vt;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?Vt:c.status==="dirty"||t.value==="dirty"?Vh(c.value):c});{if(t.value==="aborted")return Vt;const l=this._def.schema._parseSync({data:o,path:r.path,parent:r});return l.status==="aborted"?Vt:l.status==="dirty"||t.value==="dirty"?Vh(l.value):l}}if(s.type==="refinement"){const o=l=>{const c=s.refinement(l,a);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?Vt:(l.status==="dirty"&&t.dirty(),o(l.value),{status:t.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?Vt:(l.status==="dirty"&&t.dirty(),o(l.value).then(()=>({status:t.value,value:l.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!jf(o))return Vt;const l=s.transform(o.value,a);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>jf(o)?Promise.resolve(s.transform(o.value,a)).then(l=>({status:t.value,value:l})):Vt);dn.assertNever(s)}}Cf.create=(n,e,t)=>new Cf({schema:n,typeName:zt.ZodEffects,effect:e,...Zt(t)});Cf.createWithPreprocess=(n,e,t)=>new Cf({schema:e,effect:{type:"preprocess",transform:n},typeName:zt.ZodEffects,...Zt(t)});class qc extends sn{_parse(e){return this._getType(e)===ft.undefined?Ki(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}qc.create=(n,e)=>new qc({innerType:n,typeName:zt.ZodOptional,...Zt(e)});class Tf extends sn{_parse(e){return this._getType(e)===ft.null?Ki(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Tf.create=(n,e)=>new Tf({innerType:n,typeName:zt.ZodNullable,...Zt(e)});class dS extends sn{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===ft.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}dS.create=(n,e)=>new dS({innerType:n,typeName:zt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Zt(e)});class uS extends sn{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return _x(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Nl(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Nl(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}uS.create=(n,e)=>new uS({innerType:n,typeName:zt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Zt(e)});class vP extends sn{_parse(e){if(this._getType(e)!==ft.nan){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.nan,received:r.parsedType}),Vt}return{status:"valid",value:e.data}}}vP.create=n=>new vP({typeName:zt.ZodNaN,...Zt(n)});class gH extends sn{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class wC extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Vt:a.status==="dirty"?(t.dirty(),Vh(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Vt:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new wC({in:e,out:t,typeName:zt.ZodPipeline})}}class fS extends sn{_parse(e){const t=this._def.innerType._parse(e),r=s=>(jf(s)&&(s.value=Object.freeze(s.value)),s);return _x(t)?t.then(s=>r(s)):r(t)}unwrap(){return this._def.innerType}}fS.create=(n,e)=>new fS({innerType:n,typeName:zt.ZodReadonly,...Zt(e)});var zt;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(zt||(zt={}));const Vd=bo.create,bP=du.create;uu.create;const xH=jx.create;Nf.create;const wP=oS.create;Vc.create;const Bh=jo.create,yH=xr.create,vH=Nx.create;Sx.create;fu.create;const bH=Cx.create,wH=cS.create,_H=Sf.create;Tx.create;qc.create;Tf.create;const Gu={string:(n=>bo.create({...n,coerce:!0})),number:(n=>du.create({...n,coerce:!0})),boolean:(n=>jx.create({...n,coerce:!0})),bigint:(n=>uu.create({...n,coerce:!0})),date:(n=>Nf.create({...n,coerce:!0}))};let jH,NH;function SH(){return{geminiUrl:jH,vertexUrl:NH}}function CH(n,e,t){var r,s,a;if(!(!((r=n.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=SH();return n.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(a=o.geminiUrl)!==null&&a!==void 0?a:t}return n.httpOptions.baseUrl}class Em{}function Rt(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const a=e[s];return a!=null?String(a):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function S(n,e,t){for(let a=0;a<e.length-1;a++){const o=e[a];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in n))if(Array.isArray(t))n[l]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[l])){const c=n[l];if(Array.isArray(t))for(let d=0;d<c.length;d++){const h=c[d];S(h,e.slice(a+1),t[d])}else for(const d of c)S(d,e.slice(a+1),t)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in n||(n[l]=[{}]);const c=n[l];S(c[0],e.slice(a+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const r=e[e.length-1],s=n[r];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else n[r]=t}function N(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const r=e[t];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in n){const a=n[s];return Array.isArray(a)?a.map(o=>N(o,e.slice(t+1))):void 0}else return}else n=n[r]}return n}catch(t){if(t instanceof TypeError)return;throw t}}var _P;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(_P||(_P={}));var jP;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(jP||(jP={}));var NP;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(NP||(NP={}));var SP;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(SP||(SP={}));var CP;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(CP||(CP={}));var et;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(et||(et={}));var TP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(TP||(TP={}));var kP;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(kP||(kP={}));var PP;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(PP||(PP={}));var MP;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(MP||(MP={}));var EP;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(EP||(EP={}));var DP;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(DP||(DP={}));var OP;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(OP||(OP={}));var um;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(um||(um={}));var IP;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(IP||(IP={}));var hS;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(hS||(hS={}));var AP;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(AP||(AP={}));var RP;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(RP||(RP={}));var LP;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(LP||(LP={}));var FP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(FP||(FP={}));var qP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(qP||(qP={}));var zP;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(zP||(zP={}));var UP;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(UP||(UP={}));var VP;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(VP||(VP={}));var BP;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})(BP||(BP={}));var WP;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(WP||(WP={}));var $P;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})($P||($P={}));var HP;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(HP||(HP={}));var YP;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(YP||(YP={}));var GP;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(GP||(GP={}));var ZP;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(ZP||(ZP={}));var KP;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(KP||(KP={}));var JP;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(JP||(JP={}));var QP;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(QP||(QP={}));var XP;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(XP||(XP={}));var eM;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(eM||(eM={}));var tM;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(tM||(tM={}));var nM;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(nM||(nM={}));var rM;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY"})(rM||(rM={}));var af;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(af||(af={}));class yh{get text(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const p=[];for(const x of(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[v,w]of Object.entries(x))v!=="text"&&v!=="thought"&&(w!==null||w!==void 0)&&p.push(v);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;h=!0,d+=x.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const p of(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[x,v]of Object.entries(p))x!=="inlineData"&&(v!==null||v!==void 0)&&h.push(x);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if(d?.length!==0)return d}get executableCode(){var e,t,r,s,a,o,l,c,d;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if(h?.length!==0)return(d=h?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,r,s,a,o,l,c,d;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if(h?.length!==0)return(d=h?.[0])===null||d===void 0?void 0:d.output}}class sM{}class iM{}class TH{}class kH{}class aM{}class oM{}class lM{}class PH{}class cM{}class dM{}class uM{}class MH{}class mS{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class EH{}class DH{}class OH{get text(){var e,t,r;let s="",a=!1;const o=[];for(const l of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(l))c!=="text"&&c!=="thought"&&d!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;a=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?s:void 0}get data(){var e,t,r;let s="";const a=[];for(const o of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&a.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class IH{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function Un(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function MF(n,e){const t=Un(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function EF(n,e){return Array.isArray(e)?e.map(t=>kx(n,t)):[kx(n,e)]}function kx(n,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function AH(n,e){const t=kx(n,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function RH(n,e){const t=kx(n,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function fM(n,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function DF(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>fM(n,t)):[fM(n,e)]}function pS(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function hM(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function mM(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Ws(n,e){if(e==null)throw new Error("ContentUnion is required");return pS(e)?e:{role:"user",parts:DF(n,e)}}function OF(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=Ws(n,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=Ws(n,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Ws(n,t)):[Ws(n,e)]}function ka(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(hM(e)||mM(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ws(n,e)]}const t=[],r=[],s=pS(e[0]);for(const a of e){const o=pS(a);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(a);else{if(hM(a)||mM(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(a)}}return s||t.push({role:"user",parts:DF(n,r)}),t}const pM=_H(["string","number","integer","object","array","boolean","null"]),LH=vH([pM,Bh(pM)]);function FH(n=!0){const e=wH(()=>{const t=yH({type:LH.optional(),format:Vd().optional(),title:Vd().optional(),description:Vd().optional(),default:wP().optional(),items:e.optional(),minItems:Gu.string().optional(),maxItems:Gu.string().optional(),enum:Bh(wP()).optional(),properties:bH(Vd(),e).optional(),required:Bh(Vd()).optional(),minProperties:Gu.string().optional(),maxProperties:Gu.string().optional(),propertyOrdering:Bh(Vd()).optional(),minimum:bP().optional(),maximum:bP().optional(),minLength:Gu.string().optional(),maxLength:Gu.string().optional(),pattern:Vd().optional(),anyOf:Bh(e).optional(),additionalProperties:xH().optional()});return n?t.strict():t});return e}function qH(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.keys(et).includes(t[0].toUpperCase())?et[t[0].toUpperCase()]:et.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.keys(et).includes(r.toUpperCase())?et[r.toUpperCase()]:et.TYPE_UNSPECIFIED})}}function Jh(n){const e={},t=["items"],r=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&qH(n.type,e);for(const[o,l]of Object.entries(n))if(l!=null)if(o=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;e.type=Object.keys(et).includes(l.toUpperCase())?l.toUpperCase():et.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=Jh(l);else if(r.includes(o)){const c=[];for(const d of l){if(d.type=="null"){e.nullable=!0;continue}c.push(Jh(d))}e[o]=c}else if(s.includes(o)){const c={};for(const[d,h]of Object.entries(l))c[d]=Jh(h);e[o]=c}else{if(o==="additionalProperties")continue;e[o]=l}return e}function Px(n,e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=FH().parse(e);return Jh(t)}else return Jh(e)}function IF(n,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function AF(n,e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function ty(n,e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=Px(n,t.parameters)),t.response&&(t.response=Px(n,t.response));return e}function ny(n,e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const r of e)t.push(r);return t}function zH(n,e,t,r=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Zc(n,e){if(typeof e!="string")throw new Error("name must be a string");return zH(n,e,"cachedContents")}function RF(n,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Kc(n,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function UH(n){return n!=null&&typeof n=="object"&&"name"in n}function VH(n){return n!=null&&typeof n=="object"&&"video"in n}function BH(n){return n!=null&&typeof n=="object"&&"uri"in n}function LF(n,e){var t;let r;if(UH(e)&&(r=e.name),!(BH(e)&&(r=e.uri,r===void 0))&&!(VH(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const a=r.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${r}`);r=a[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function FF(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function qF(n,e){for(const t of["models","tunedModels","publisherModels"])if(WH(e,t))return e[t];return[]}function WH(n,e){return n!==null&&typeof n=="object"&&e in n}function $H(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function HH(n,e){const t={};if(N(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function YH(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],$H(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],HH(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function gM(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>YH(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function GH(n,e){const t={},r=N(e,["behavior"]);r!=null&&S(t,["behavior"],r);const s=N(e,["description"]);s!=null&&S(t,["description"],s);const a=N(e,["name"]);a!=null&&S(t,["name"],a);const o=N(e,["parameters"]);o!=null&&S(t,["parameters"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],l),t}function ZH(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function KH(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],ZH(n,r)),t}function JH(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function QH(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],JH(n,r)),t}function XH(){return{}}function e8(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>GH(n,d))),S(t,["functionDeclarations"],c)}if(N(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=N(e,["googleSearch"]);s!=null&&S(t,["googleSearch"],KH(n,s));const a=N(e,["googleSearchRetrieval"]);if(a!=null&&S(t,["googleSearchRetrieval"],QH(n,a)),N(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(N(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");N(e,["urlContext"])!=null&&S(t,["urlContext"],XH());const l=N(e,["codeExecution"]);return l!=null&&S(t,["codeExecution"],l),t}function t8(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function n8(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function r8(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],n8(n,r)),t}function s8(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],t8(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],r8(n,s)),t}function i8(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);t!==void 0&&a!=null&&S(t,["expireTime"],a);const o=N(e,["displayName"]);t!==void 0&&o!=null&&S(t,["displayName"],o);const l=N(e,["contents"]);if(t!==void 0&&l!=null){let p=ka(n,l);Array.isArray(p)&&(p=p.map(x=>gM(n,x))),S(t,["contents"],p)}const c=N(e,["systemInstruction"]);t!==void 0&&c!=null&&S(t,["systemInstruction"],gM(n,Ws(n,c)));const d=N(e,["tools"]);if(t!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(x=>e8(n,x))),S(t,["tools"],p)}const h=N(e,["toolConfig"]);if(t!==void 0&&h!=null&&S(t,["toolConfig"],s8(n,h)),N(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return r}function a8(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["model"],MF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],i8(n,s,t)),t}function o8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Zc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function l8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Zc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function c8(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);return t!==void 0&&a!=null&&S(t,["expireTime"],a),r}function d8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Zc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],c8(n,s,t)),t}function u8(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);return t!==void 0&&a!=null&&S(t,["_query","pageToken"],a),r}function f8(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],u8(n,r,t)),t}function h8(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function m8(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function p8(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],h8(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],m8(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function xM(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>p8(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function g8(n,e){const t={};if(N(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=N(e,["description"]);r!=null&&S(t,["description"],r);const s=N(e,["name"]);s!=null&&S(t,["name"],s);const a=N(e,["parameters"]);a!=null&&S(t,["parameters"],a);const o=N(e,["response"]);return o!=null&&S(t,["response"],o),t}function x8(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function y8(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],x8(n,r)),t}function v8(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function b8(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],v8(n,r)),t}function w8(){return{}}function _8(n,e){const t={},r=N(e,["apiKeyString"]);return r!=null&&S(t,["apiKeyString"],r),t}function j8(n,e){const t={},r=N(e,["apiKeyConfig"]);r!=null&&S(t,["apiKeyConfig"],_8(n,r));const s=N(e,["authType"]);s!=null&&S(t,["authType"],s);const a=N(e,["googleServiceAccountConfig"]);a!=null&&S(t,["googleServiceAccountConfig"],a);const o=N(e,["httpBasicAuthConfig"]);o!=null&&S(t,["httpBasicAuthConfig"],o);const l=N(e,["oauthConfig"]);l!=null&&S(t,["oauthConfig"],l);const c=N(e,["oidcConfig"]);return c!=null&&S(t,["oidcConfig"],c),t}function N8(n,e){const t={},r=N(e,["authConfig"]);return r!=null&&S(t,["authConfig"],j8(n,r)),t}function S8(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>g8(n,p))),S(t,["functionDeclarations"],h)}const s=N(e,["retrieval"]);s!=null&&S(t,["retrieval"],s);const a=N(e,["googleSearch"]);a!=null&&S(t,["googleSearch"],y8(n,a));const o=N(e,["googleSearchRetrieval"]);o!=null&&S(t,["googleSearchRetrieval"],b8(n,o)),N(e,["enterpriseWebSearch"])!=null&&S(t,["enterpriseWebSearch"],w8());const c=N(e,["googleMaps"]);if(c!=null&&S(t,["googleMaps"],N8(n,c)),N(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=N(e,["codeExecution"]);return d!=null&&S(t,["codeExecution"],d),t}function C8(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function T8(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function k8(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],T8(n,r)),t}function P8(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],C8(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],k8(n,s)),t}function M8(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);t!==void 0&&a!=null&&S(t,["expireTime"],a);const o=N(e,["displayName"]);t!==void 0&&o!=null&&S(t,["displayName"],o);const l=N(e,["contents"]);if(t!==void 0&&l!=null){let x=ka(n,l);Array.isArray(x)&&(x=x.map(v=>xM(n,v))),S(t,["contents"],x)}const c=N(e,["systemInstruction"]);t!==void 0&&c!=null&&S(t,["systemInstruction"],xM(n,Ws(n,c)));const d=N(e,["tools"]);if(t!==void 0&&d!=null){let x=d;Array.isArray(x)&&(x=x.map(v=>S8(n,v))),S(t,["tools"],x)}const h=N(e,["toolConfig"]);t!==void 0&&h!=null&&S(t,["toolConfig"],P8(n,h));const p=N(e,["kmsKeyName"]);return t!==void 0&&p!=null&&S(t,["encryption_spec","kmsKeyName"],p),r}function E8(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["model"],MF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],M8(n,s,t)),t}function D8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Zc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function O8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Zc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function I8(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);return t!==void 0&&a!=null&&S(t,["expireTime"],a),r}function A8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Zc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],I8(n,s,t)),t}function R8(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);return t!==void 0&&a!=null&&S(t,["_query","pageToken"],a),r}function L8(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],R8(n,r,t)),t}function ix(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["model"]);a!=null&&S(t,["model"],a);const o=N(e,["createTime"]);o!=null&&S(t,["createTime"],o);const l=N(e,["updateTime"]);l!=null&&S(t,["updateTime"],l);const c=N(e,["expireTime"]);c!=null&&S(t,["expireTime"],c);const d=N(e,["usageMetadata"]);return d!=null&&S(t,["usageMetadata"],d),t}function F8(){return{}}function q8(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>ix(n,o))),S(t,["cachedContents"],a)}return t}function ax(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["model"]);a!=null&&S(t,["model"],a);const o=N(e,["createTime"]);o!=null&&S(t,["createTime"],o);const l=N(e,["updateTime"]);l!=null&&S(t,["updateTime"],l);const c=N(e,["expireTime"]);c!=null&&S(t,["expireTime"],c);const d=N(e,["usageMetadata"]);return d!=null&&S(t,["usageMetadata"],d),t}function z8(){return{}}function U8(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>ax(n,o))),S(t,["cachedContents"],a)}return t}var kf;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(kf||(kf={}));class ry{constructor(e,t,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,s)}init(e,t,r){var s,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(a=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class V8 extends Em{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ry(kf.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=E8(this.apiClient,e);return l=Rt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>ax(this.apiClient,h))}else{const d=a8(this.apiClient,e);return l=Rt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>ix(this.apiClient,h))}}async get(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=D8(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>ax(this.apiClient,h))}else{const d=o8(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>ix(this.apiClient,h))}}async delete(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=O8(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=z8(),p=new dM;return Object.assign(p,h),p})}else{const d=l8(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(()=>{const h=F8(),p=new dM;return Object.assign(p,h),p})}}async update(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=A8(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>ax(this.apiClient,h))}else{const d=d8(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>ix(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=L8(this.apiClient,e);return l=Rt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=U8(this.apiClient,h),x=new uM;return Object.assign(x,p),x})}else{const d=f8(this.apiClient,e);return l=Rt("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=q8(this.apiClient,h),x=new uM;return Object.assign(x,p),x})}}}function yM(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kn(n){return this instanceof Kn?(this.v=n,this):new Kn(n)}function Qh(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(v){return function(w){return Promise.resolve(w).then(v,p)}}function l(v,w){r[v]&&(s[v]=function(_){return new Promise(function(j,T){a.push([v,_,j,T])>1||c(v,_)})},w&&(s[v]=w(s[v])))}function c(v,w){try{d(r[v](w))}catch(_){x(a[0][3],_)}}function d(v){v.value instanceof Kn?Promise.resolve(v.value.v).then(h,p):x(a[0][2],v)}function h(v){c("next",v)}function p(v){c("throw",v)}function x(v,w){v(w),a.shift(),a.length&&c(a[0][0],a[0][1])}}function ox(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof yM=="function"?yM(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(l,c){o=n[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},o)}}function B8(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:zF(t)}function zF(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function W8(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function vM(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const s=[];let a=!0;for(;r<t&&n[r].role==="model";)s.push(n[r]),a&&!zF(n[r])&&(a=!1),r++;a?e.push(...s):e.pop()}return e}class $8{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new H8(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class H8{constructor(e,t,r,s={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=s,this.history=a,this.sendPromise=Promise.resolve(),W8(a)}async sendMessage(e){var t;await this.sendPromise;const r=Ws(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,o,l;const c=await s,d=(o=(a=c.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content,h=c.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let x=[];h!=null&&(x=(l=h.slice(p))!==null&&l!==void 0?l:[]);const v=d?[d]:[];this.recordHistory(r,v,x)})(),await this.sendPromise,s}async sendMessageStream(e){var t;await this.sendPromise;const r=Ws(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const a=await s;return this.processStreamResponse(a,r)}getHistory(e=!1){const t=e?vM(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var r,s;return Qh(this,arguments,function*(){var o,l,c,d;const h=[];try{for(var p=!0,x=ox(e),v;v=yield Kn(x.next()),o=v.done,!o;p=!0){d=v.value,p=!1;const w=d;if(B8(w)){const _=(s=(r=w.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;_!==void 0&&h.push(_)}yield yield Kn(w)}}catch(w){l={error:w}}finally{try{!p&&!o&&(c=x.return)&&(yield Kn(c.call(x)))}finally{if(l)throw l.error}}this.recordHistory(t,h)})}recordHistory(e,t,r){let s=[];t.length>0&&t.every(a=>a.role!==void 0)?s=t:s.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...vM(r)):this.history.push(e),this.history.push(...s)}}function Y8(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);return t!==void 0&&a!=null&&S(t,["_query","pageToken"],a),r}function G8(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],Y8(n,r,t)),t}function Z8(n,e){const t={},r=N(e,["details"]);r!=null&&S(t,["details"],r);const s=N(e,["message"]);s!=null&&S(t,["message"],s);const a=N(e,["code"]);return a!=null&&S(t,["code"],a),t}function K8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["mimeType"]);a!=null&&S(t,["mimeType"],a);const o=N(e,["sizeBytes"]);o!=null&&S(t,["sizeBytes"],o);const l=N(e,["createTime"]);l!=null&&S(t,["createTime"],l);const c=N(e,["expirationTime"]);c!=null&&S(t,["expirationTime"],c);const d=N(e,["updateTime"]);d!=null&&S(t,["updateTime"],d);const h=N(e,["sha256Hash"]);h!=null&&S(t,["sha256Hash"],h);const p=N(e,["uri"]);p!=null&&S(t,["uri"],p);const x=N(e,["downloadUri"]);x!=null&&S(t,["downloadUri"],x);const v=N(e,["state"]);v!=null&&S(t,["state"],v);const w=N(e,["source"]);w!=null&&S(t,["source"],w);const _=N(e,["videoMetadata"]);_!=null&&S(t,["videoMetadata"],_);const j=N(e,["error"]);return j!=null&&S(t,["error"],Z8(n,j)),t}function J8(n,e){const t={},r=N(e,["file"]);r!=null&&S(t,["file"],K8(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function Q8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","file"],LF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function X8(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","file"],LF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function e7(n,e){const t={},r=N(e,["details"]);r!=null&&S(t,["details"],r);const s=N(e,["message"]);s!=null&&S(t,["message"],s);const a=N(e,["code"]);return a!=null&&S(t,["code"],a),t}function gS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["mimeType"]);a!=null&&S(t,["mimeType"],a);const o=N(e,["sizeBytes"]);o!=null&&S(t,["sizeBytes"],o);const l=N(e,["createTime"]);l!=null&&S(t,["createTime"],l);const c=N(e,["expirationTime"]);c!=null&&S(t,["expirationTime"],c);const d=N(e,["updateTime"]);d!=null&&S(t,["updateTime"],d);const h=N(e,["sha256Hash"]);h!=null&&S(t,["sha256Hash"],h);const p=N(e,["uri"]);p!=null&&S(t,["uri"],p);const x=N(e,["downloadUri"]);x!=null&&S(t,["downloadUri"],x);const v=N(e,["state"]);v!=null&&S(t,["state"],v);const w=N(e,["source"]);w!=null&&S(t,["source"],w);const _=N(e,["videoMetadata"]);_!=null&&S(t,["videoMetadata"],_);const j=N(e,["error"]);return j!=null&&S(t,["error"],e7(n,j)),t}function t7(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["files"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>gS(n,o))),S(t,["files"],a)}return t}function n7(){return{}}function r7(){return{}}let s7=class extends Em{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ry(kf.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>gS(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=G8(this.apiClient,e);return a=Rt("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=t7(this.apiClient,c),h=new MH;return Object.assign(h,d),h})}}async createInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=J8(this.apiClient,e);return a=Rt("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=n7(),d=new EH;return Object.assign(d,c),d})}}async get(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Q8(this.apiClient,e);return a=Rt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>gS(this.apiClient,c))}}async delete(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=X8(this.apiClient,e);return a=Rt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=r7(),d=new DH;return Object.assign(d,c),d})}}};function i7(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function a7(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function UF(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],i7(n,r)),t}function o7(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],a7(n,r)),t}function l7(n,e){const t={},r=N(e,["speaker"]);r!=null&&S(t,["speaker"],r);const s=N(e,["voiceConfig"]);return s!=null&&S(t,["voiceConfig"],UF(n,s)),t}function c7(n,e){const t={},r=N(e,["speakerVoiceConfigs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>l7(n,a))),S(t,["speakerVoiceConfigs"],s)}return t}function d7(n,e){const t={},r=N(e,["voiceConfig"]);r!=null&&S(t,["voiceConfig"],UF(n,r));const s=N(e,["multiSpeakerVoiceConfig"]);s!=null&&S(t,["multiSpeakerVoiceConfig"],c7(n,s));const a=N(e,["languageCode"]);return a!=null&&S(t,["languageCode"],a),t}function u7(n,e){const t={},r=N(e,["voiceConfig"]);if(r!=null&&S(t,["voiceConfig"],o7(n,r)),N(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=N(e,["languageCode"]);return s!=null&&S(t,["languageCode"],s),t}function f7(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function h7(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function m7(n,e){const t={};if(N(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function p7(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function g7(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],f7(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],m7(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function x7(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],h7(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],p7(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function y7(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>g7(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function v7(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>x7(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function b7(n,e){const t={},r=N(e,["behavior"]);r!=null&&S(t,["behavior"],r);const s=N(e,["description"]);s!=null&&S(t,["description"],s);const a=N(e,["name"]);a!=null&&S(t,["name"],a);const o=N(e,["parameters"]);o!=null&&S(t,["parameters"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],l),t}function w7(n,e){const t={};if(N(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=N(e,["description"]);r!=null&&S(t,["description"],r);const s=N(e,["name"]);s!=null&&S(t,["name"],s);const a=N(e,["parameters"]);a!=null&&S(t,["parameters"],a);const o=N(e,["response"]);return o!=null&&S(t,["response"],o),t}function _7(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function j7(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function N7(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],_7(n,r)),t}function S7(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],j7(n,r)),t}function C7(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function T7(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function k7(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],C7(n,r)),t}function P7(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],T7(n,r)),t}function M7(){return{}}function E7(n,e){const t={},r=N(e,["apiKeyString"]);return r!=null&&S(t,["apiKeyString"],r),t}function D7(n,e){const t={},r=N(e,["apiKeyConfig"]);r!=null&&S(t,["apiKeyConfig"],E7(n,r));const s=N(e,["authType"]);s!=null&&S(t,["authType"],s);const a=N(e,["googleServiceAccountConfig"]);a!=null&&S(t,["googleServiceAccountConfig"],a);const o=N(e,["httpBasicAuthConfig"]);o!=null&&S(t,["httpBasicAuthConfig"],o);const l=N(e,["oauthConfig"]);l!=null&&S(t,["oauthConfig"],l);const c=N(e,["oidcConfig"]);return c!=null&&S(t,["oidcConfig"],c),t}function O7(n,e){const t={},r=N(e,["authConfig"]);return r!=null&&S(t,["authConfig"],D7(n,r)),t}function I7(){return{}}function A7(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>b7(n,d))),S(t,["functionDeclarations"],c)}if(N(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=N(e,["googleSearch"]);s!=null&&S(t,["googleSearch"],N7(n,s));const a=N(e,["googleSearchRetrieval"]);if(a!=null&&S(t,["googleSearchRetrieval"],k7(n,a)),N(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(N(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");N(e,["urlContext"])!=null&&S(t,["urlContext"],I7());const l=N(e,["codeExecution"]);return l!=null&&S(t,["codeExecution"],l),t}function R7(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>w7(n,p))),S(t,["functionDeclarations"],h)}const s=N(e,["retrieval"]);s!=null&&S(t,["retrieval"],s);const a=N(e,["googleSearch"]);a!=null&&S(t,["googleSearch"],S7(n,a));const o=N(e,["googleSearchRetrieval"]);o!=null&&S(t,["googleSearchRetrieval"],P7(n,o)),N(e,["enterpriseWebSearch"])!=null&&S(t,["enterpriseWebSearch"],M7());const c=N(e,["googleMaps"]);if(c!=null&&S(t,["googleMaps"],O7(n,c)),N(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=N(e,["codeExecution"]);return d!=null&&S(t,["codeExecution"],d),t}function L7(n,e){const t={},r=N(e,["handle"]);if(r!=null&&S(t,["handle"],r),N(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function F7(n,e){const t={},r=N(e,["handle"]);r!=null&&S(t,["handle"],r);const s=N(e,["transparent"]);return s!=null&&S(t,["transparent"],s),t}function bM(){return{}}function wM(){return{}}function q7(n,e){const t={},r=N(e,["disabled"]);r!=null&&S(t,["disabled"],r);const s=N(e,["startOfSpeechSensitivity"]);s!=null&&S(t,["startOfSpeechSensitivity"],s);const a=N(e,["endOfSpeechSensitivity"]);a!=null&&S(t,["endOfSpeechSensitivity"],a);const o=N(e,["prefixPaddingMs"]);o!=null&&S(t,["prefixPaddingMs"],o);const l=N(e,["silenceDurationMs"]);return l!=null&&S(t,["silenceDurationMs"],l),t}function z7(n,e){const t={},r=N(e,["disabled"]);r!=null&&S(t,["disabled"],r);const s=N(e,["startOfSpeechSensitivity"]);s!=null&&S(t,["startOfSpeechSensitivity"],s);const a=N(e,["endOfSpeechSensitivity"]);a!=null&&S(t,["endOfSpeechSensitivity"],a);const o=N(e,["prefixPaddingMs"]);o!=null&&S(t,["prefixPaddingMs"],o);const l=N(e,["silenceDurationMs"]);return l!=null&&S(t,["silenceDurationMs"],l),t}function U7(n,e){const t={},r=N(e,["automaticActivityDetection"]);r!=null&&S(t,["automaticActivityDetection"],q7(n,r));const s=N(e,["activityHandling"]);s!=null&&S(t,["activityHandling"],s);const a=N(e,["turnCoverage"]);return a!=null&&S(t,["turnCoverage"],a),t}function V7(n,e){const t={},r=N(e,["automaticActivityDetection"]);r!=null&&S(t,["automaticActivityDetection"],z7(n,r));const s=N(e,["activityHandling"]);s!=null&&S(t,["activityHandling"],s);const a=N(e,["turnCoverage"]);return a!=null&&S(t,["turnCoverage"],a),t}function B7(n,e){const t={},r=N(e,["targetTokens"]);return r!=null&&S(t,["targetTokens"],r),t}function W7(n,e){const t={},r=N(e,["targetTokens"]);return r!=null&&S(t,["targetTokens"],r),t}function $7(n,e){const t={},r=N(e,["triggerTokens"]);r!=null&&S(t,["triggerTokens"],r);const s=N(e,["slidingWindow"]);return s!=null&&S(t,["slidingWindow"],B7(n,s)),t}function H7(n,e){const t={},r=N(e,["triggerTokens"]);r!=null&&S(t,["triggerTokens"],r);const s=N(e,["slidingWindow"]);return s!=null&&S(t,["slidingWindow"],W7(n,s)),t}function Y7(n,e){const t={},r=N(e,["proactiveAudio"]);return r!=null&&S(t,["proactiveAudio"],r),t}function G7(n,e){const t={},r=N(e,["proactiveAudio"]);return r!=null&&S(t,["proactiveAudio"],r),t}function Z7(n,e,t){const r={},s=N(e,["generationConfig"]);t!==void 0&&s!=null&&S(t,["setup","generationConfig"],s);const a=N(e,["responseModalities"]);t!==void 0&&a!=null&&S(t,["setup","generationConfig","responseModalities"],a);const o=N(e,["temperature"]);t!==void 0&&o!=null&&S(t,["setup","generationConfig","temperature"],o);const l=N(e,["topP"]);t!==void 0&&l!=null&&S(t,["setup","generationConfig","topP"],l);const c=N(e,["topK"]);t!==void 0&&c!=null&&S(t,["setup","generationConfig","topK"],c);const d=N(e,["maxOutputTokens"]);t!==void 0&&d!=null&&S(t,["setup","generationConfig","maxOutputTokens"],d);const h=N(e,["mediaResolution"]);t!==void 0&&h!=null&&S(t,["setup","generationConfig","mediaResolution"],h);const p=N(e,["seed"]);t!==void 0&&p!=null&&S(t,["setup","generationConfig","seed"],p);const x=N(e,["speechConfig"]);t!==void 0&&x!=null&&S(t,["setup","generationConfig","speechConfig"],d7(n,AF(n,x)));const v=N(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&S(t,["setup","generationConfig","enableAffectiveDialog"],v);const w=N(e,["systemInstruction"]);t!==void 0&&w!=null&&S(t,["setup","systemInstruction"],y7(n,Ws(n,w)));const _=N(e,["tools"]);if(t!==void 0&&_!=null){let I=ny(n,_);Array.isArray(I)&&(I=I.map(q=>A7(n,ty(n,q)))),S(t,["setup","tools"],I)}const j=N(e,["sessionResumption"]);t!==void 0&&j!=null&&S(t,["setup","sessionResumption"],L7(n,j));const T=N(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&S(t,["setup","inputAudioTranscription"],bM());const P=N(e,["outputAudioTranscription"]);t!==void 0&&P!=null&&S(t,["setup","outputAudioTranscription"],bM());const D=N(e,["realtimeInputConfig"]);t!==void 0&&D!=null&&S(t,["setup","realtimeInputConfig"],U7(n,D));const M=N(e,["contextWindowCompression"]);t!==void 0&&M!=null&&S(t,["setup","contextWindowCompression"],$7(n,M));const O=N(e,["proactivity"]);return t!==void 0&&O!=null&&S(t,["setup","proactivity"],Y7(n,O)),r}function K7(n,e,t){const r={},s=N(e,["generationConfig"]);t!==void 0&&s!=null&&S(t,["setup","generationConfig"],s);const a=N(e,["responseModalities"]);t!==void 0&&a!=null&&S(t,["setup","generationConfig","responseModalities"],a);const o=N(e,["temperature"]);t!==void 0&&o!=null&&S(t,["setup","generationConfig","temperature"],o);const l=N(e,["topP"]);t!==void 0&&l!=null&&S(t,["setup","generationConfig","topP"],l);const c=N(e,["topK"]);t!==void 0&&c!=null&&S(t,["setup","generationConfig","topK"],c);const d=N(e,["maxOutputTokens"]);t!==void 0&&d!=null&&S(t,["setup","generationConfig","maxOutputTokens"],d);const h=N(e,["mediaResolution"]);t!==void 0&&h!=null&&S(t,["setup","generationConfig","mediaResolution"],h);const p=N(e,["seed"]);t!==void 0&&p!=null&&S(t,["setup","generationConfig","seed"],p);const x=N(e,["speechConfig"]);t!==void 0&&x!=null&&S(t,["setup","generationConfig","speechConfig"],u7(n,AF(n,x)));const v=N(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&S(t,["setup","generationConfig","enableAffectiveDialog"],v);const w=N(e,["systemInstruction"]);t!==void 0&&w!=null&&S(t,["setup","systemInstruction"],v7(n,Ws(n,w)));const _=N(e,["tools"]);if(t!==void 0&&_!=null){let I=ny(n,_);Array.isArray(I)&&(I=I.map(q=>R7(n,ty(n,q)))),S(t,["setup","tools"],I)}const j=N(e,["sessionResumption"]);t!==void 0&&j!=null&&S(t,["setup","sessionResumption"],F7(n,j));const T=N(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&S(t,["setup","inputAudioTranscription"],wM());const P=N(e,["outputAudioTranscription"]);t!==void 0&&P!=null&&S(t,["setup","outputAudioTranscription"],wM());const D=N(e,["realtimeInputConfig"]);t!==void 0&&D!=null&&S(t,["setup","realtimeInputConfig"],V7(n,D));const M=N(e,["contextWindowCompression"]);t!==void 0&&M!=null&&S(t,["setup","contextWindowCompression"],H7(n,M));const O=N(e,["proactivity"]);return t!==void 0&&O!=null&&S(t,["setup","proactivity"],G7(n,O)),r}function J7(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["setup","model"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],Z7(n,s,t)),t}function Q7(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["setup","model"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],K7(n,s,t)),t}function X7(){return{}}function e9(){return{}}function t9(){return{}}function n9(){return{}}function r9(n,e){const t={},r=N(e,["media"]);r!=null&&S(t,["mediaChunks"],EF(n,r));const s=N(e,["audio"]);s!=null&&S(t,["audio"],RH(n,s));const a=N(e,["audioStreamEnd"]);a!=null&&S(t,["audioStreamEnd"],a);const o=N(e,["video"]);o!=null&&S(t,["video"],AH(n,o));const l=N(e,["text"]);return l!=null&&S(t,["text"],l),N(e,["activityStart"])!=null&&S(t,["activityStart"],X7()),N(e,["activityEnd"])!=null&&S(t,["activityEnd"],t9()),t}function s9(n,e){const t={},r=N(e,["media"]);if(r!=null&&S(t,["mediaChunks"],EF(n,r)),N(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=N(e,["audioStreamEnd"]);if(s!=null&&S(t,["audioStreamEnd"],s),N(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(N(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return N(e,["activityStart"])!=null&&S(t,["activityStart"],e9()),N(e,["activityEnd"])!=null&&S(t,["activityEnd"],n9()),t}function VF(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["weight"]);return s!=null&&S(t,["weight"],s),t}function i9(n,e){const t={},r=N(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>VF(n,a))),S(t,["weightedPrompts"],s)}return t}function BF(n,e){const t={},r=N(e,["temperature"]);r!=null&&S(t,["temperature"],r);const s=N(e,["topK"]);s!=null&&S(t,["topK"],s);const a=N(e,["seed"]);a!=null&&S(t,["seed"],a);const o=N(e,["guidance"]);o!=null&&S(t,["guidance"],o);const l=N(e,["bpm"]);l!=null&&S(t,["bpm"],l);const c=N(e,["density"]);c!=null&&S(t,["density"],c);const d=N(e,["brightness"]);d!=null&&S(t,["brightness"],d);const h=N(e,["scale"]);h!=null&&S(t,["scale"],h);const p=N(e,["muteBass"]);p!=null&&S(t,["muteBass"],p);const x=N(e,["muteDrums"]);x!=null&&S(t,["muteDrums"],x);const v=N(e,["onlyBassAndDrums"]);v!=null&&S(t,["onlyBassAndDrums"],v);const w=N(e,["musicGenerationMode"]);return w!=null&&S(t,["musicGenerationMode"],w),t}function a9(n,e){const t={},r=N(e,["musicGenerationConfig"]);return r!=null&&S(t,["musicGenerationConfig"],BF(n,r)),t}function WF(n,e){const t={},r=N(e,["model"]);return r!=null&&S(t,["model"],r),t}function $F(n,e){const t={},r=N(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>VF(n,a))),S(t,["weightedPrompts"],s)}return t}function xS(n,e){const t={},r=N(e,["setup"]);r!=null&&S(t,["setup"],WF(n,r));const s=N(e,["clientContent"]);s!=null&&S(t,["clientContent"],$F(n,s));const a=N(e,["musicGenerationConfig"]);a!=null&&S(t,["musicGenerationConfig"],BF(n,a));const o=N(e,["playbackControl"]);return o!=null&&S(t,["playbackControl"],o),t}function o9(){return{}}function l9(){return{}}function c9(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function d9(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function u9(n,e){const t={},r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function f9(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function h9(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],c9(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],u9(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function m9(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],d9(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],f9(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function p9(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>h9(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function g9(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>m9(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function _M(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["finished"]);return s!=null&&S(t,["finished"],s),t}function jM(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["finished"]);return s!=null&&S(t,["finished"],s),t}function x9(n,e){const t={},r=N(e,["retrievedUrl"]);r!=null&&S(t,["retrievedUrl"],r);const s=N(e,["urlRetrievalStatus"]);return s!=null&&S(t,["urlRetrievalStatus"],s),t}function y9(n,e){const t={},r=N(e,["urlMetadata"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>x9(n,a))),S(t,["urlMetadata"],s)}return t}function v9(n,e){const t={},r=N(e,["modelTurn"]);r!=null&&S(t,["modelTurn"],p9(n,r));const s=N(e,["turnComplete"]);s!=null&&S(t,["turnComplete"],s);const a=N(e,["interrupted"]);a!=null&&S(t,["interrupted"],a);const o=N(e,["groundingMetadata"]);o!=null&&S(t,["groundingMetadata"],o);const l=N(e,["generationComplete"]);l!=null&&S(t,["generationComplete"],l);const c=N(e,["inputTranscription"]);c!=null&&S(t,["inputTranscription"],_M(n,c));const d=N(e,["outputTranscription"]);d!=null&&S(t,["outputTranscription"],_M(n,d));const h=N(e,["urlContextMetadata"]);return h!=null&&S(t,["urlContextMetadata"],y9(n,h)),t}function b9(n,e){const t={},r=N(e,["modelTurn"]);r!=null&&S(t,["modelTurn"],g9(n,r));const s=N(e,["turnComplete"]);s!=null&&S(t,["turnComplete"],s);const a=N(e,["interrupted"]);a!=null&&S(t,["interrupted"],a);const o=N(e,["groundingMetadata"]);o!=null&&S(t,["groundingMetadata"],o);const l=N(e,["generationComplete"]);l!=null&&S(t,["generationComplete"],l);const c=N(e,["inputTranscription"]);c!=null&&S(t,["inputTranscription"],jM(n,c));const d=N(e,["outputTranscription"]);return d!=null&&S(t,["outputTranscription"],jM(n,d)),t}function w9(n,e){const t={},r=N(e,["id"]);r!=null&&S(t,["id"],r);const s=N(e,["args"]);s!=null&&S(t,["args"],s);const a=N(e,["name"]);return a!=null&&S(t,["name"],a),t}function _9(n,e){const t={},r=N(e,["args"]);r!=null&&S(t,["args"],r);const s=N(e,["name"]);return s!=null&&S(t,["name"],s),t}function j9(n,e){const t={},r=N(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>w9(n,a))),S(t,["functionCalls"],s)}return t}function N9(n,e){const t={},r=N(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>_9(n,a))),S(t,["functionCalls"],s)}return t}function S9(n,e){const t={},r=N(e,["ids"]);return r!=null&&S(t,["ids"],r),t}function C9(n,e){const t={},r=N(e,["ids"]);return r!=null&&S(t,["ids"],r),t}function Up(n,e){const t={},r=N(e,["modality"]);r!=null&&S(t,["modality"],r);const s=N(e,["tokenCount"]);return s!=null&&S(t,["tokenCount"],s),t}function Vp(n,e){const t={},r=N(e,["modality"]);r!=null&&S(t,["modality"],r);const s=N(e,["tokenCount"]);return s!=null&&S(t,["tokenCount"],s),t}function T9(n,e){const t={},r=N(e,["promptTokenCount"]);r!=null&&S(t,["promptTokenCount"],r);const s=N(e,["cachedContentTokenCount"]);s!=null&&S(t,["cachedContentTokenCount"],s);const a=N(e,["responseTokenCount"]);a!=null&&S(t,["responseTokenCount"],a);const o=N(e,["toolUsePromptTokenCount"]);o!=null&&S(t,["toolUsePromptTokenCount"],o);const l=N(e,["thoughtsTokenCount"]);l!=null&&S(t,["thoughtsTokenCount"],l);const c=N(e,["totalTokenCount"]);c!=null&&S(t,["totalTokenCount"],c);const d=N(e,["promptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(w=>Up(n,w))),S(t,["promptTokensDetails"],v)}const h=N(e,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(w=>Up(n,w))),S(t,["cacheTokensDetails"],v)}const p=N(e,["responseTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(w=>Up(n,w))),S(t,["responseTokensDetails"],v)}const x=N(e,["toolUsePromptTokensDetails"]);if(x!=null){let v=x;Array.isArray(v)&&(v=v.map(w=>Up(n,w))),S(t,["toolUsePromptTokensDetails"],v)}return t}function k9(n,e){const t={},r=N(e,["promptTokenCount"]);r!=null&&S(t,["promptTokenCount"],r);const s=N(e,["cachedContentTokenCount"]);s!=null&&S(t,["cachedContentTokenCount"],s);const a=N(e,["candidatesTokenCount"]);a!=null&&S(t,["responseTokenCount"],a);const o=N(e,["toolUsePromptTokenCount"]);o!=null&&S(t,["toolUsePromptTokenCount"],o);const l=N(e,["thoughtsTokenCount"]);l!=null&&S(t,["thoughtsTokenCount"],l);const c=N(e,["totalTokenCount"]);c!=null&&S(t,["totalTokenCount"],c);const d=N(e,["promptTokensDetails"]);if(d!=null){let w=d;Array.isArray(w)&&(w=w.map(_=>Vp(n,_))),S(t,["promptTokensDetails"],w)}const h=N(e,["cacheTokensDetails"]);if(h!=null){let w=h;Array.isArray(w)&&(w=w.map(_=>Vp(n,_))),S(t,["cacheTokensDetails"],w)}const p=N(e,["candidatesTokensDetails"]);if(p!=null){let w=p;Array.isArray(w)&&(w=w.map(_=>Vp(n,_))),S(t,["responseTokensDetails"],w)}const x=N(e,["toolUsePromptTokensDetails"]);if(x!=null){let w=x;Array.isArray(w)&&(w=w.map(_=>Vp(n,_))),S(t,["toolUsePromptTokensDetails"],w)}const v=N(e,["trafficType"]);return v!=null&&S(t,["trafficType"],v),t}function P9(n,e){const t={},r=N(e,["timeLeft"]);return r!=null&&S(t,["timeLeft"],r),t}function M9(n,e){const t={},r=N(e,["timeLeft"]);return r!=null&&S(t,["timeLeft"],r),t}function E9(n,e){const t={},r=N(e,["newHandle"]);r!=null&&S(t,["newHandle"],r);const s=N(e,["resumable"]);s!=null&&S(t,["resumable"],s);const a=N(e,["lastConsumedClientMessageIndex"]);return a!=null&&S(t,["lastConsumedClientMessageIndex"],a),t}function D9(n,e){const t={},r=N(e,["newHandle"]);r!=null&&S(t,["newHandle"],r);const s=N(e,["resumable"]);s!=null&&S(t,["resumable"],s);const a=N(e,["lastConsumedClientMessageIndex"]);return a!=null&&S(t,["lastConsumedClientMessageIndex"],a),t}function O9(n,e){const t={};N(e,["setupComplete"])!=null&&S(t,["setupComplete"],o9());const s=N(e,["serverContent"]);s!=null&&S(t,["serverContent"],v9(n,s));const a=N(e,["toolCall"]);a!=null&&S(t,["toolCall"],j9(n,a));const o=N(e,["toolCallCancellation"]);o!=null&&S(t,["toolCallCancellation"],S9(n,o));const l=N(e,["usageMetadata"]);l!=null&&S(t,["usageMetadata"],T9(n,l));const c=N(e,["goAway"]);c!=null&&S(t,["goAway"],P9(n,c));const d=N(e,["sessionResumptionUpdate"]);return d!=null&&S(t,["sessionResumptionUpdate"],E9(n,d)),t}function I9(n,e){const t={};N(e,["setupComplete"])!=null&&S(t,["setupComplete"],l9());const s=N(e,["serverContent"]);s!=null&&S(t,["serverContent"],b9(n,s));const a=N(e,["toolCall"]);a!=null&&S(t,["toolCall"],N9(n,a));const o=N(e,["toolCallCancellation"]);o!=null&&S(t,["toolCallCancellation"],C9(n,o));const l=N(e,["usageMetadata"]);l!=null&&S(t,["usageMetadata"],k9(n,l));const c=N(e,["goAway"]);c!=null&&S(t,["goAway"],M9(n,c));const d=N(e,["sessionResumptionUpdate"]);return d!=null&&S(t,["sessionResumptionUpdate"],D9(n,d)),t}function A9(){return{}}function R9(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["weight"]);return s!=null&&S(t,["weight"],s),t}function L9(n,e){const t={},r=N(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>R9(n,a))),S(t,["weightedPrompts"],s)}return t}function F9(n,e){const t={},r=N(e,["temperature"]);r!=null&&S(t,["temperature"],r);const s=N(e,["topK"]);s!=null&&S(t,["topK"],s);const a=N(e,["seed"]);a!=null&&S(t,["seed"],a);const o=N(e,["guidance"]);o!=null&&S(t,["guidance"],o);const l=N(e,["bpm"]);l!=null&&S(t,["bpm"],l);const c=N(e,["density"]);c!=null&&S(t,["density"],c);const d=N(e,["brightness"]);d!=null&&S(t,["brightness"],d);const h=N(e,["scale"]);h!=null&&S(t,["scale"],h);const p=N(e,["muteBass"]);p!=null&&S(t,["muteBass"],p);const x=N(e,["muteDrums"]);x!=null&&S(t,["muteDrums"],x);const v=N(e,["onlyBassAndDrums"]);v!=null&&S(t,["onlyBassAndDrums"],v);const w=N(e,["musicGenerationMode"]);return w!=null&&S(t,["musicGenerationMode"],w),t}function q9(n,e){const t={},r=N(e,["clientContent"]);r!=null&&S(t,["clientContent"],L9(n,r));const s=N(e,["musicGenerationConfig"]);return s!=null&&S(t,["musicGenerationConfig"],F9(n,s)),t}function z9(n,e){const t={},r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);s!=null&&S(t,["mimeType"],s);const a=N(e,["sourceMetadata"]);return a!=null&&S(t,["sourceMetadata"],q9(n,a)),t}function U9(n,e){const t={},r=N(e,["audioChunks"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>z9(n,a))),S(t,["audioChunks"],s)}return t}function V9(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["filteredReason"]);return s!=null&&S(t,["filteredReason"],s),t}function B9(n,e){const t={};N(e,["setupComplete"])!=null&&S(t,["setupComplete"],A9());const s=N(e,["serverContent"]);s!=null&&S(t,["serverContent"],U9(n,s));const a=N(e,["filteredPrompt"]);return a!=null&&S(t,["filteredPrompt"],V9(n,a)),t}function W9(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function $9(n,e){const t={};if(N(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function H9(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],W9(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],$9(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function sy(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>H9(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function Y9(n,e){const t={};if(N(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=N(e,["category"]);r!=null&&S(t,["category"],r);const s=N(e,["threshold"]);return s!=null&&S(t,["threshold"],s),t}function G9(n,e){const t={},r=N(e,["behavior"]);r!=null&&S(t,["behavior"],r);const s=N(e,["description"]);s!=null&&S(t,["description"],s);const a=N(e,["name"]);a!=null&&S(t,["name"],a);const o=N(e,["parameters"]);o!=null&&S(t,["parameters"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],l),t}function Z9(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function K9(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],Z9(n,r)),t}function J9(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function Q9(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],J9(n,r)),t}function X9(){return{}}function eY(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>G9(n,d))),S(t,["functionDeclarations"],c)}if(N(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=N(e,["googleSearch"]);s!=null&&S(t,["googleSearch"],K9(n,s));const a=N(e,["googleSearchRetrieval"]);if(a!=null&&S(t,["googleSearchRetrieval"],Q9(n,a)),N(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(N(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");N(e,["urlContext"])!=null&&S(t,["urlContext"],X9());const l=N(e,["codeExecution"]);return l!=null&&S(t,["codeExecution"],l),t}function tY(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function nY(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function rY(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],nY(n,r)),t}function sY(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],tY(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],rY(n,s)),t}function iY(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function HF(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],iY(n,r)),t}function aY(n,e){const t={},r=N(e,["speaker"]);r!=null&&S(t,["speaker"],r);const s=N(e,["voiceConfig"]);return s!=null&&S(t,["voiceConfig"],HF(n,s)),t}function oY(n,e){const t={},r=N(e,["speakerVoiceConfigs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>aY(n,a))),S(t,["speakerVoiceConfigs"],s)}return t}function lY(n,e){const t={},r=N(e,["voiceConfig"]);r!=null&&S(t,["voiceConfig"],HF(n,r));const s=N(e,["multiSpeakerVoiceConfig"]);s!=null&&S(t,["multiSpeakerVoiceConfig"],oY(n,s));const a=N(e,["languageCode"]);return a!=null&&S(t,["languageCode"],a),t}function cY(n,e){const t={},r=N(e,["includeThoughts"]);r!=null&&S(t,["includeThoughts"],r);const s=N(e,["thinkingBudget"]);return s!=null&&S(t,["thinkingBudget"],s),t}function dY(n,e,t){const r={},s=N(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],sy(n,Ws(n,s)));const a=N(e,["temperature"]);a!=null&&S(r,["temperature"],a);const o=N(e,["topP"]);o!=null&&S(r,["topP"],o);const l=N(e,["topK"]);l!=null&&S(r,["topK"],l);const c=N(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const d=N(e,["maxOutputTokens"]);d!=null&&S(r,["maxOutputTokens"],d);const h=N(e,["stopSequences"]);h!=null&&S(r,["stopSequences"],h);const p=N(e,["responseLogprobs"]);p!=null&&S(r,["responseLogprobs"],p);const x=N(e,["logprobs"]);x!=null&&S(r,["logprobs"],x);const v=N(e,["presencePenalty"]);v!=null&&S(r,["presencePenalty"],v);const w=N(e,["frequencyPenalty"]);w!=null&&S(r,["frequencyPenalty"],w);const _=N(e,["seed"]);_!=null&&S(r,["seed"],_);const j=N(e,["responseMimeType"]);j!=null&&S(r,["responseMimeType"],j);const T=N(e,["responseSchema"]);if(T!=null&&S(r,["responseSchema"],Px(n,T)),N(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(N(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=N(e,["safetySettings"]);if(t!==void 0&&P!=null){let U=P;Array.isArray(U)&&(U=U.map(W=>Y9(n,W))),S(t,["safetySettings"],U)}const D=N(e,["tools"]);if(t!==void 0&&D!=null){let U=ny(n,D);Array.isArray(U)&&(U=U.map(W=>eY(n,ty(n,W)))),S(t,["tools"],U)}const M=N(e,["toolConfig"]);if(t!==void 0&&M!=null&&S(t,["toolConfig"],sY(n,M)),N(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const O=N(e,["cachedContent"]);t!==void 0&&O!=null&&S(t,["cachedContent"],Zc(n,O));const I=N(e,["responseModalities"]);I!=null&&S(r,["responseModalities"],I);const q=N(e,["mediaResolution"]);q!=null&&S(r,["mediaResolution"],q);const F=N(e,["speechConfig"]);if(F!=null&&S(r,["speechConfig"],lY(n,IF(n,F))),N(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const V=N(e,["thinkingConfig"]);return V!=null&&S(r,["thinkingConfig"],cY(n,V)),r}function NM(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);if(s!=null){let o=ka(n,s);Array.isArray(o)&&(o=o.map(l=>sy(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["generationConfig"],dY(n,a,t)),t}function uY(n,e,t){const r={},s=N(e,["taskType"]);t!==void 0&&s!=null&&S(t,["requests[]","taskType"],s);const a=N(e,["title"]);t!==void 0&&a!=null&&S(t,["requests[]","title"],a);const o=N(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&S(t,["requests[]","outputDimensionality"],o),N(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(N(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function fY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);s!=null&&S(t,["requests[]","content"],OF(n,s));const a=N(e,["config"]);a!=null&&S(t,["config"],uY(n,a,t));const o=N(e,["model"]);return o!==void 0&&S(t,["requests[]","model"],Un(n,o)),t}function hY(n,e,t){const r={};if(N(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(N(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=N(e,["numberOfImages"]);t!==void 0&&s!=null&&S(t,["parameters","sampleCount"],s);const a=N(e,["aspectRatio"]);t!==void 0&&a!=null&&S(t,["parameters","aspectRatio"],a);const o=N(e,["guidanceScale"]);if(t!==void 0&&o!=null&&S(t,["parameters","guidanceScale"],o),N(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=N(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&S(t,["parameters","safetySetting"],l);const c=N(e,["personGeneration"]);t!==void 0&&c!=null&&S(t,["parameters","personGeneration"],c);const d=N(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&S(t,["parameters","includeSafetyAttributes"],d);const h=N(e,["includeRaiReason"]);t!==void 0&&h!=null&&S(t,["parameters","includeRaiReason"],h);const p=N(e,["language"]);t!==void 0&&p!=null&&S(t,["parameters","language"],p);const x=N(e,["outputMimeType"]);t!==void 0&&x!=null&&S(t,["parameters","outputOptions","mimeType"],x);const v=N(e,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&S(t,["parameters","outputOptions","compressionQuality"],v),N(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(N(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function mY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["config"]);return a!=null&&S(t,["config"],hY(n,a,t)),t}function pY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function gY(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);t!==void 0&&o!=null&&S(t,["_query","filter"],o);const l=N(e,["queryBase"]);return t!==void 0&&l!=null&&S(t,["_url","models_url"],FF(n,l)),r}function xY(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],gY(n,r,t)),t}function yY(n,e,t){const r={},s=N(e,["displayName"]);t!==void 0&&s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);t!==void 0&&a!=null&&S(t,["description"],a);const o=N(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&S(t,["defaultCheckpointId"],o),r}function vY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],yY(n,s,t)),t}function bY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function wY(n,e){const t={};if(N(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(N(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(N(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function _Y(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);if(s!=null){let o=ka(n,s);Array.isArray(o)&&(o=o.map(l=>sy(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["config"],wY(n,a)),t}function jY(n,e){const t={};if(N(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=N(e,["imageBytes"]);r!=null&&S(t,["bytesBase64Encoded"],Kc(n,r));const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function NY(n,e,t){const r={},s=N(e,["numberOfVideos"]);if(t!==void 0&&s!=null&&S(t,["parameters","sampleCount"],s),N(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(N(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=N(e,["durationSeconds"]);if(t!==void 0&&a!=null&&S(t,["parameters","durationSeconds"],a),N(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=N(e,["aspectRatio"]);if(t!==void 0&&o!=null&&S(t,["parameters","aspectRatio"],o),N(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=N(e,["personGeneration"]);if(t!==void 0&&l!=null&&S(t,["parameters","personGeneration"],l),N(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=N(e,["negativePrompt"]);if(t!==void 0&&c!=null&&S(t,["parameters","negativePrompt"],c),N(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function SY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["image"]);a!=null&&S(t,["instances[0]","image"],jY(n,a));const o=N(e,["config"]);return o!=null&&S(t,["config"],NY(n,o,t)),t}function CY(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function TY(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function kY(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],CY(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],TY(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function Uf(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>kY(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function PY(n,e){const t={},r=N(e,["featureSelectionPreference"]);return r!=null&&S(t,["featureSelectionPreference"],r),t}function MY(n,e){const t={},r=N(e,["method"]);r!=null&&S(t,["method"],r);const s=N(e,["category"]);s!=null&&S(t,["category"],s);const a=N(e,["threshold"]);return a!=null&&S(t,["threshold"],a),t}function EY(n,e){const t={};if(N(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=N(e,["description"]);r!=null&&S(t,["description"],r);const s=N(e,["name"]);s!=null&&S(t,["name"],s);const a=N(e,["parameters"]);a!=null&&S(t,["parameters"],a);const o=N(e,["response"]);return o!=null&&S(t,["response"],o),t}function DY(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function OY(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],DY(n,r)),t}function IY(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function AY(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],IY(n,r)),t}function RY(){return{}}function LY(n,e){const t={},r=N(e,["apiKeyString"]);return r!=null&&S(t,["apiKeyString"],r),t}function FY(n,e){const t={},r=N(e,["apiKeyConfig"]);r!=null&&S(t,["apiKeyConfig"],LY(n,r));const s=N(e,["authType"]);s!=null&&S(t,["authType"],s);const a=N(e,["googleServiceAccountConfig"]);a!=null&&S(t,["googleServiceAccountConfig"],a);const o=N(e,["httpBasicAuthConfig"]);o!=null&&S(t,["httpBasicAuthConfig"],o);const l=N(e,["oauthConfig"]);l!=null&&S(t,["oauthConfig"],l);const c=N(e,["oidcConfig"]);return c!=null&&S(t,["oidcConfig"],c),t}function qY(n,e){const t={},r=N(e,["authConfig"]);return r!=null&&S(t,["authConfig"],FY(n,r)),t}function YF(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>EY(n,p))),S(t,["functionDeclarations"],h)}const s=N(e,["retrieval"]);s!=null&&S(t,["retrieval"],s);const a=N(e,["googleSearch"]);a!=null&&S(t,["googleSearch"],OY(n,a));const o=N(e,["googleSearchRetrieval"]);o!=null&&S(t,["googleSearchRetrieval"],AY(n,o)),N(e,["enterpriseWebSearch"])!=null&&S(t,["enterpriseWebSearch"],RY());const c=N(e,["googleMaps"]);if(c!=null&&S(t,["googleMaps"],qY(n,c)),N(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=N(e,["codeExecution"]);return d!=null&&S(t,["codeExecution"],d),t}function zY(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function UY(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function VY(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],UY(n,r)),t}function BY(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],zY(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],VY(n,s)),t}function WY(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function $Y(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],WY(n,r)),t}function HY(n,e){const t={},r=N(e,["voiceConfig"]);if(r!=null&&S(t,["voiceConfig"],$Y(n,r)),N(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=N(e,["languageCode"]);return s!=null&&S(t,["languageCode"],s),t}function YY(n,e){const t={},r=N(e,["includeThoughts"]);r!=null&&S(t,["includeThoughts"],r);const s=N(e,["thinkingBudget"]);return s!=null&&S(t,["thinkingBudget"],s),t}function GY(n,e,t){const r={},s=N(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],Uf(n,Ws(n,s)));const a=N(e,["temperature"]);a!=null&&S(r,["temperature"],a);const o=N(e,["topP"]);o!=null&&S(r,["topP"],o);const l=N(e,["topK"]);l!=null&&S(r,["topK"],l);const c=N(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const d=N(e,["maxOutputTokens"]);d!=null&&S(r,["maxOutputTokens"],d);const h=N(e,["stopSequences"]);h!=null&&S(r,["stopSequences"],h);const p=N(e,["responseLogprobs"]);p!=null&&S(r,["responseLogprobs"],p);const x=N(e,["logprobs"]);x!=null&&S(r,["logprobs"],x);const v=N(e,["presencePenalty"]);v!=null&&S(r,["presencePenalty"],v);const w=N(e,["frequencyPenalty"]);w!=null&&S(r,["frequencyPenalty"],w);const _=N(e,["seed"]);_!=null&&S(r,["seed"],_);const j=N(e,["responseMimeType"]);j!=null&&S(r,["responseMimeType"],j);const T=N(e,["responseSchema"]);T!=null&&S(r,["responseSchema"],Px(n,T));const P=N(e,["routingConfig"]);P!=null&&S(r,["routingConfig"],P);const D=N(e,["modelSelectionConfig"]);D!=null&&S(r,["modelConfig"],PY(n,D));const M=N(e,["safetySettings"]);if(t!==void 0&&M!=null){let Y=M;Array.isArray(Y)&&(Y=Y.map(ae=>MY(n,ae))),S(t,["safetySettings"],Y)}const O=N(e,["tools"]);if(t!==void 0&&O!=null){let Y=ny(n,O);Array.isArray(Y)&&(Y=Y.map(ae=>YF(n,ty(n,ae)))),S(t,["tools"],Y)}const I=N(e,["toolConfig"]);t!==void 0&&I!=null&&S(t,["toolConfig"],BY(n,I));const q=N(e,["labels"]);t!==void 0&&q!=null&&S(t,["labels"],q);const F=N(e,["cachedContent"]);t!==void 0&&F!=null&&S(t,["cachedContent"],Zc(n,F));const V=N(e,["responseModalities"]);V!=null&&S(r,["responseModalities"],V);const U=N(e,["mediaResolution"]);U!=null&&S(r,["mediaResolution"],U);const W=N(e,["speechConfig"]);W!=null&&S(r,["speechConfig"],HY(n,IF(n,W)));const $=N(e,["audioTimestamp"]);$!=null&&S(r,["audioTimestamp"],$);const ne=N(e,["thinkingConfig"]);return ne!=null&&S(r,["thinkingConfig"],YY(n,ne)),r}function SM(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);if(s!=null){let o=ka(n,s);Array.isArray(o)&&(o=o.map(l=>Uf(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["generationConfig"],GY(n,a,t)),t}function ZY(n,e,t){const r={},s=N(e,["taskType"]);t!==void 0&&s!=null&&S(t,["instances[]","task_type"],s);const a=N(e,["title"]);t!==void 0&&a!=null&&S(t,["instances[]","title"],a);const o=N(e,["outputDimensionality"]);t!==void 0&&o!=null&&S(t,["parameters","outputDimensionality"],o);const l=N(e,["mimeType"]);t!==void 0&&l!=null&&S(t,["instances[]","mimeType"],l);const c=N(e,["autoTruncate"]);return t!==void 0&&c!=null&&S(t,["parameters","autoTruncate"],c),r}function KY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);s!=null&&S(t,["instances[]","content"],OF(n,s));const a=N(e,["config"]);return a!=null&&S(t,["config"],ZY(n,a,t)),t}function JY(n,e,t){const r={},s=N(e,["outputGcsUri"]);t!==void 0&&s!=null&&S(t,["parameters","storageUri"],s);const a=N(e,["negativePrompt"]);t!==void 0&&a!=null&&S(t,["parameters","negativePrompt"],a);const o=N(e,["numberOfImages"]);t!==void 0&&o!=null&&S(t,["parameters","sampleCount"],o);const l=N(e,["aspectRatio"]);t!==void 0&&l!=null&&S(t,["parameters","aspectRatio"],l);const c=N(e,["guidanceScale"]);t!==void 0&&c!=null&&S(t,["parameters","guidanceScale"],c);const d=N(e,["seed"]);t!==void 0&&d!=null&&S(t,["parameters","seed"],d);const h=N(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&S(t,["parameters","safetySetting"],h);const p=N(e,["personGeneration"]);t!==void 0&&p!=null&&S(t,["parameters","personGeneration"],p);const x=N(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&S(t,["parameters","includeSafetyAttributes"],x);const v=N(e,["includeRaiReason"]);t!==void 0&&v!=null&&S(t,["parameters","includeRaiReason"],v);const w=N(e,["language"]);t!==void 0&&w!=null&&S(t,["parameters","language"],w);const _=N(e,["outputMimeType"]);t!==void 0&&_!=null&&S(t,["parameters","outputOptions","mimeType"],_);const j=N(e,["outputCompressionQuality"]);t!==void 0&&j!=null&&S(t,["parameters","outputOptions","compressionQuality"],j);const T=N(e,["addWatermark"]);t!==void 0&&T!=null&&S(t,["parameters","addWatermark"],T);const P=N(e,["enhancePrompt"]);return t!==void 0&&P!=null&&S(t,["parameters","enhancePrompt"],P),r}function QY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["config"]);return a!=null&&S(t,["config"],JY(n,a,t)),t}function _C(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["gcsUri"],r);const s=N(e,["imageBytes"]);s!=null&&S(t,["bytesBase64Encoded"],Kc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function XY(n,e){const t={},r=N(e,["maskMode"]);r!=null&&S(t,["maskMode"],r);const s=N(e,["segmentationClasses"]);s!=null&&S(t,["maskClasses"],s);const a=N(e,["maskDilation"]);return a!=null&&S(t,["dilation"],a),t}function eG(n,e){const t={},r=N(e,["controlType"]);r!=null&&S(t,["controlType"],r);const s=N(e,["enableControlImageComputation"]);return s!=null&&S(t,["computeControl"],s),t}function tG(n,e){const t={},r=N(e,["styleDescription"]);return r!=null&&S(t,["styleDescription"],r),t}function nG(n,e){const t={},r=N(e,["subjectType"]);r!=null&&S(t,["subjectType"],r);const s=N(e,["subjectDescription"]);return s!=null&&S(t,["subjectDescription"],s),t}function rG(n,e){const t={},r=N(e,["referenceImage"]);r!=null&&S(t,["referenceImage"],_C(n,r));const s=N(e,["referenceId"]);s!=null&&S(t,["referenceId"],s);const a=N(e,["referenceType"]);a!=null&&S(t,["referenceType"],a);const o=N(e,["maskImageConfig"]);o!=null&&S(t,["maskImageConfig"],XY(n,o));const l=N(e,["controlImageConfig"]);l!=null&&S(t,["controlImageConfig"],eG(n,l));const c=N(e,["styleImageConfig"]);c!=null&&S(t,["styleImageConfig"],tG(n,c));const d=N(e,["subjectImageConfig"]);return d!=null&&S(t,["subjectImageConfig"],nG(n,d)),t}function sG(n,e,t){const r={},s=N(e,["outputGcsUri"]);t!==void 0&&s!=null&&S(t,["parameters","storageUri"],s);const a=N(e,["negativePrompt"]);t!==void 0&&a!=null&&S(t,["parameters","negativePrompt"],a);const o=N(e,["numberOfImages"]);t!==void 0&&o!=null&&S(t,["parameters","sampleCount"],o);const l=N(e,["aspectRatio"]);t!==void 0&&l!=null&&S(t,["parameters","aspectRatio"],l);const c=N(e,["guidanceScale"]);t!==void 0&&c!=null&&S(t,["parameters","guidanceScale"],c);const d=N(e,["seed"]);t!==void 0&&d!=null&&S(t,["parameters","seed"],d);const h=N(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&S(t,["parameters","safetySetting"],h);const p=N(e,["personGeneration"]);t!==void 0&&p!=null&&S(t,["parameters","personGeneration"],p);const x=N(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&S(t,["parameters","includeSafetyAttributes"],x);const v=N(e,["includeRaiReason"]);t!==void 0&&v!=null&&S(t,["parameters","includeRaiReason"],v);const w=N(e,["language"]);t!==void 0&&w!=null&&S(t,["parameters","language"],w);const _=N(e,["outputMimeType"]);t!==void 0&&_!=null&&S(t,["parameters","outputOptions","mimeType"],_);const j=N(e,["outputCompressionQuality"]);t!==void 0&&j!=null&&S(t,["parameters","outputOptions","compressionQuality"],j);const T=N(e,["editMode"]);t!==void 0&&T!=null&&S(t,["parameters","editMode"],T);const P=N(e,["baseSteps"]);return t!==void 0&&P!=null&&S(t,["parameters","editConfig","baseSteps"],P),r}function iG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["referenceImages"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>rG(n,c))),S(t,["instances[0]","referenceImages"],l)}const o=N(e,["config"]);return o!=null&&S(t,["config"],sG(n,o,t)),t}function aG(n,e,t){const r={},s=N(e,["includeRaiReason"]);t!==void 0&&s!=null&&S(t,["parameters","includeRaiReason"],s);const a=N(e,["outputMimeType"]);t!==void 0&&a!=null&&S(t,["parameters","outputOptions","mimeType"],a);const o=N(e,["outputCompressionQuality"]);t!==void 0&&o!=null&&S(t,["parameters","outputOptions","compressionQuality"],o);const l=N(e,["numberOfImages"]);t!==void 0&&l!=null&&S(t,["parameters","sampleCount"],l);const c=N(e,["mode"]);return t!==void 0&&c!=null&&S(t,["parameters","mode"],c),r}function oG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["image"]);s!=null&&S(t,["instances[0]","image"],_C(n,s));const a=N(e,["upscaleFactor"]);a!=null&&S(t,["parameters","upscaleConfig","upscaleFactor"],a);const o=N(e,["config"]);return o!=null&&S(t,["config"],aG(n,o,t)),t}function lG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function cG(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);t!==void 0&&o!=null&&S(t,["_query","filter"],o);const l=N(e,["queryBase"]);return t!==void 0&&l!=null&&S(t,["_url","models_url"],FF(n,l)),r}function dG(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],cG(n,r,t)),t}function uG(n,e,t){const r={},s=N(e,["displayName"]);t!==void 0&&s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);t!==void 0&&a!=null&&S(t,["description"],a);const o=N(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&S(t,["defaultCheckpointId"],o),r}function fG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],uG(n,s,t)),t}function hG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Un(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function mG(n,e,t){const r={},s=N(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],Uf(n,Ws(n,s)));const a=N(e,["tools"]);if(t!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>YF(n,c))),S(t,["tools"],l)}const o=N(e,["generationConfig"]);return t!==void 0&&o!=null&&S(t,["generationConfig"],o),r}function pG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);if(s!=null){let o=ka(n,s);Array.isArray(o)&&(o=o.map(l=>Uf(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["config"],mG(n,a,t)),t}function gG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["contents"]);if(s!=null){let o=ka(n,s);Array.isArray(o)&&(o=o.map(l=>Uf(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["config"],a),t}function xG(n,e,t){const r={},s=N(e,["numberOfVideos"]);t!==void 0&&s!=null&&S(t,["parameters","sampleCount"],s);const a=N(e,["outputGcsUri"]);t!==void 0&&a!=null&&S(t,["parameters","storageUri"],a);const o=N(e,["fps"]);t!==void 0&&o!=null&&S(t,["parameters","fps"],o);const l=N(e,["durationSeconds"]);t!==void 0&&l!=null&&S(t,["parameters","durationSeconds"],l);const c=N(e,["seed"]);t!==void 0&&c!=null&&S(t,["parameters","seed"],c);const d=N(e,["aspectRatio"]);t!==void 0&&d!=null&&S(t,["parameters","aspectRatio"],d);const h=N(e,["resolution"]);t!==void 0&&h!=null&&S(t,["parameters","resolution"],h);const p=N(e,["personGeneration"]);t!==void 0&&p!=null&&S(t,["parameters","personGeneration"],p);const x=N(e,["pubsubTopic"]);t!==void 0&&x!=null&&S(t,["parameters","pubsubTopic"],x);const v=N(e,["negativePrompt"]);t!==void 0&&v!=null&&S(t,["parameters","negativePrompt"],v);const w=N(e,["enhancePrompt"]);return t!==void 0&&w!=null&&S(t,["parameters","enhancePrompt"],w),r}function yG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Un(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["image"]);a!=null&&S(t,["instances[0]","image"],_C(n,a));const o=N(e,["config"]);return o!=null&&S(t,["config"],xG(n,o,t)),t}function vG(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function bG(n,e){const t={},r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function wG(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],vG(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],bG(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function _G(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>wG(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function jG(n,e){const t={},r=N(e,["citationSources"]);return r!=null&&S(t,["citations"],r),t}function NG(n,e){const t={},r=N(e,["retrievedUrl"]);r!=null&&S(t,["retrievedUrl"],r);const s=N(e,["urlRetrievalStatus"]);return s!=null&&S(t,["urlRetrievalStatus"],s),t}function SG(n,e){const t={},r=N(e,["urlMetadata"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>NG(n,a))),S(t,["urlMetadata"],s)}return t}function CG(n,e){const t={},r=N(e,["content"]);r!=null&&S(t,["content"],_G(n,r));const s=N(e,["citationMetadata"]);s!=null&&S(t,["citationMetadata"],jG(n,s));const a=N(e,["tokenCount"]);a!=null&&S(t,["tokenCount"],a);const o=N(e,["finishReason"]);o!=null&&S(t,["finishReason"],o);const l=N(e,["urlContextMetadata"]);l!=null&&S(t,["urlContextMetadata"],SG(n,l));const c=N(e,["avgLogprobs"]);c!=null&&S(t,["avgLogprobs"],c);const d=N(e,["groundingMetadata"]);d!=null&&S(t,["groundingMetadata"],d);const h=N(e,["index"]);h!=null&&S(t,["index"],h);const p=N(e,["logprobsResult"]);p!=null&&S(t,["logprobsResult"],p);const x=N(e,["safetyRatings"]);return x!=null&&S(t,["safetyRatings"],x),t}function CM(n,e){const t={},r=N(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>CG(n,c))),S(t,["candidates"],l)}const s=N(e,["modelVersion"]);s!=null&&S(t,["modelVersion"],s);const a=N(e,["promptFeedback"]);a!=null&&S(t,["promptFeedback"],a);const o=N(e,["usageMetadata"]);return o!=null&&S(t,["usageMetadata"],o),t}function TG(n,e){const t={},r=N(e,["values"]);return r!=null&&S(t,["values"],r),t}function kG(){return{}}function PG(n,e){const t={},r=N(e,["embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>TG(n,o))),S(t,["embeddings"],a)}return N(e,["metadata"])!=null&&S(t,["metadata"],kG()),t}function MG(n,e){const t={},r=N(e,["bytesBase64Encoded"]);r!=null&&S(t,["imageBytes"],Kc(n,r));const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function GF(n,e){const t={},r=N(e,["safetyAttributes","categories"]);r!=null&&S(t,["categories"],r);const s=N(e,["safetyAttributes","scores"]);s!=null&&S(t,["scores"],s);const a=N(e,["contentType"]);return a!=null&&S(t,["contentType"],a),t}function EG(n,e){const t={},r=N(e,["_self"]);r!=null&&S(t,["image"],MG(n,r));const s=N(e,["raiFilteredReason"]);s!=null&&S(t,["raiFilteredReason"],s);const a=N(e,["_self"]);return a!=null&&S(t,["safetyAttributes"],GF(n,a)),t}function DG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>EG(n,o))),S(t,["generatedImages"],a)}const s=N(e,["positivePromptSafetyAttributes"]);return s!=null&&S(t,["positivePromptSafetyAttributes"],GF(n,s)),t}function OG(n,e){const t={},r=N(e,["baseModel"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["createTime"]);s!=null&&S(t,["createTime"],s);const a=N(e,["updateTime"]);return a!=null&&S(t,["updateTime"],a),t}function yS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);a!=null&&S(t,["description"],a);const o=N(e,["version"]);o!=null&&S(t,["version"],o);const l=N(e,["_self"]);l!=null&&S(t,["tunedModelInfo"],OG(n,l));const c=N(e,["inputTokenLimit"]);c!=null&&S(t,["inputTokenLimit"],c);const d=N(e,["outputTokenLimit"]);d!=null&&S(t,["outputTokenLimit"],d);const h=N(e,["supportedGenerationMethods"]);return h!=null&&S(t,["supportedActions"],h),t}function IG(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["_self"]);if(s!=null){let a=qF(n,s);Array.isArray(a)&&(a=a.map(o=>yS(n,o))),S(t,["models"],a)}return t}function AG(){return{}}function RG(n,e){const t={},r=N(e,["totalTokens"]);r!=null&&S(t,["totalTokens"],r);const s=N(e,["cachedContentTokenCount"]);return s!=null&&S(t,["cachedContentTokenCount"],s),t}function LG(n,e){const t={},r=N(e,["video","uri"]);r!=null&&S(t,["uri"],r);const s=N(e,["video","encodedVideo"]);s!=null&&S(t,["videoBytes"],Kc(n,s));const a=N(e,["encoding"]);return a!=null&&S(t,["mimeType"],a),t}function FG(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],LG(n,r)),t}function qG(n,e){const t={},r=N(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>FG(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function zG(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response","generateVideoResponse"]);return l!=null&&S(t,["response"],qG(n,l)),t}function UG(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function VG(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function BG(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],UG(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],VG(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function WG(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>BG(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function $G(n,e){const t={},r=N(e,["citations"]);return r!=null&&S(t,["citations"],r),t}function HG(n,e){const t={},r=N(e,["content"]);r!=null&&S(t,["content"],WG(n,r));const s=N(e,["citationMetadata"]);s!=null&&S(t,["citationMetadata"],$G(n,s));const a=N(e,["finishMessage"]);a!=null&&S(t,["finishMessage"],a);const o=N(e,["finishReason"]);o!=null&&S(t,["finishReason"],o);const l=N(e,["avgLogprobs"]);l!=null&&S(t,["avgLogprobs"],l);const c=N(e,["groundingMetadata"]);c!=null&&S(t,["groundingMetadata"],c);const d=N(e,["index"]);d!=null&&S(t,["index"],d);const h=N(e,["logprobsResult"]);h!=null&&S(t,["logprobsResult"],h);const p=N(e,["safetyRatings"]);return p!=null&&S(t,["safetyRatings"],p),t}function TM(n,e){const t={},r=N(e,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>HG(n,h))),S(t,["candidates"],d)}const s=N(e,["createTime"]);s!=null&&S(t,["createTime"],s);const a=N(e,["responseId"]);a!=null&&S(t,["responseId"],a);const o=N(e,["modelVersion"]);o!=null&&S(t,["modelVersion"],o);const l=N(e,["promptFeedback"]);l!=null&&S(t,["promptFeedback"],l);const c=N(e,["usageMetadata"]);return c!=null&&S(t,["usageMetadata"],c),t}function YG(n,e){const t={},r=N(e,["truncated"]);r!=null&&S(t,["truncated"],r);const s=N(e,["token_count"]);return s!=null&&S(t,["tokenCount"],s),t}function GG(n,e){const t={},r=N(e,["values"]);r!=null&&S(t,["values"],r);const s=N(e,["statistics"]);return s!=null&&S(t,["statistics"],YG(n,s)),t}function ZG(n,e){const t={},r=N(e,["billableCharacterCount"]);return r!=null&&S(t,["billableCharacterCount"],r),t}function KG(n,e){const t={},r=N(e,["predictions[]","embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>GG(n,o))),S(t,["embeddings"],a)}const s=N(e,["metadata"]);return s!=null&&S(t,["metadata"],ZG(n,s)),t}function JG(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["gcsUri"],r);const s=N(e,["bytesBase64Encoded"]);s!=null&&S(t,["imageBytes"],Kc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function ZF(n,e){const t={},r=N(e,["safetyAttributes","categories"]);r!=null&&S(t,["categories"],r);const s=N(e,["safetyAttributes","scores"]);s!=null&&S(t,["scores"],s);const a=N(e,["contentType"]);return a!=null&&S(t,["contentType"],a),t}function jC(n,e){const t={},r=N(e,["_self"]);r!=null&&S(t,["image"],JG(n,r));const s=N(e,["raiFilteredReason"]);s!=null&&S(t,["raiFilteredReason"],s);const a=N(e,["_self"]);a!=null&&S(t,["safetyAttributes"],ZF(n,a));const o=N(e,["prompt"]);return o!=null&&S(t,["enhancedPrompt"],o),t}function QG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>jC(n,o))),S(t,["generatedImages"],a)}const s=N(e,["positivePromptSafetyAttributes"]);return s!=null&&S(t,["positivePromptSafetyAttributes"],ZF(n,s)),t}function XG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>jC(n,a))),S(t,["generatedImages"],s)}return t}function eZ(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>jC(n,a))),S(t,["generatedImages"],s)}return t}function tZ(n,e){const t={},r=N(e,["endpoint"]);r!=null&&S(t,["name"],r);const s=N(e,["deployedModelId"]);return s!=null&&S(t,["deployedModelId"],s),t}function nZ(n,e){const t={},r=N(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["createTime"]);s!=null&&S(t,["createTime"],s);const a=N(e,["updateTime"]);return a!=null&&S(t,["updateTime"],a),t}function rZ(n,e){const t={},r=N(e,["checkpointId"]);r!=null&&S(t,["checkpointId"],r);const s=N(e,["epoch"]);s!=null&&S(t,["epoch"],s);const a=N(e,["step"]);return a!=null&&S(t,["step"],a),t}function vS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);a!=null&&S(t,["description"],a);const o=N(e,["versionId"]);o!=null&&S(t,["version"],o);const l=N(e,["deployedModels"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(v=>tZ(n,v))),S(t,["endpoints"],x)}const c=N(e,["labels"]);c!=null&&S(t,["labels"],c);const d=N(e,["_self"]);d!=null&&S(t,["tunedModelInfo"],nZ(n,d));const h=N(e,["defaultCheckpointId"]);h!=null&&S(t,["defaultCheckpointId"],h);const p=N(e,["checkpoints"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(v=>rZ(n,v))),S(t,["checkpoints"],x)}return t}function sZ(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["_self"]);if(s!=null){let a=qF(n,s);Array.isArray(a)&&(a=a.map(o=>vS(n,o))),S(t,["models"],a)}return t}function iZ(){return{}}function aZ(n,e){const t={},r=N(e,["totalTokens"]);return r!=null&&S(t,["totalTokens"],r),t}function oZ(n,e){const t={},r=N(e,["tokensInfo"]);return r!=null&&S(t,["tokensInfo"],r),t}function lZ(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["uri"],r);const s=N(e,["bytesBase64Encoded"]);s!=null&&S(t,["videoBytes"],Kc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function cZ(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],lZ(n,r)),t}function dZ(n,e){const t={},r=N(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>cZ(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function uZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],dZ(n,l)),t}const fZ="Content-Type",hZ="X-Server-Timeout",mZ="User-Agent",bS="x-goog-api-client",pZ="0.15.0",gZ=`google-genai-sdk/${pZ}`,xZ="v1beta1",yZ="v1beta",kM=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class KF extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class wS extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class vZ{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:xZ,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:yZ,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const s=[this.getRequestUrlInternal(t)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.unaryApiCall(s,a,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[s,a]of Object.entries(t))typeof a=="object"?r[s]=Object.assign(Object.assign({},r[s]),a):a!==void 0&&(r[s]=a);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.streamApiCall(s,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r){if(t&&t.timeout||r){const s=new AbortController,a=s.signal;t.timeout&&t?.timeout>0&&setTimeout(()=>s.abort(),t.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=a}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async s=>(await PM(s),new mS(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async s=>(await PM(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return Qh(this,arguments,function*(){const s=(t=e?.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield Kn(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=a.decode(c);try{const p=JSON.parse(d);if("error"in p){const x=JSON.parse(JSON.stringify(p.error)),v=x.status,w=x.code,_=`got status: ${v}. ${JSON.stringify(p)}`;if(w>=400&&w<500)throw new KF(_);if(w>=500&&w<600)throw new wS(_)}}catch(p){const x=p;if(x.name==="ClientError"||x.name==="ServerError")throw p}o+=d;let h=o.match(kM);for(;h;){const p=h[1];try{const x=new Response(p,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Kn(new mS(x)),o=o.slice(h[0].length),h=o.match(kM)}catch(x){throw new Error(`exception parsing stream chunk ${p}. ${x}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=gZ+" "+this.clientOptions.userAgentExtra;return e[mZ]=t,e[bS]=t,e[fZ]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))t.append(r,s);e.timeout&&e.timeout>0&&t.append(hZ,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var r;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const a=this.clientOptions.uploader,o=await a.stat(e);s.sizeBytes=String(o.size);const l=(r=t?.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,t);return a.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var r;let s={};t?.httpOptions?s=t.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const a={file:e},o=await this.request({path:Rt("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:s});if(!o||!o?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o?.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function PM(n){var e;if(n===void 0)throw new wS("response is undefined");if(!n.ok){const t=n.status,r=n.statusText;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const a=`got status: ${t} ${r}. ${JSON.stringify(s)}`;throw t>=400&&t<500?new KF(a):t>=500&&t<600?new wS(a):new Error(a)}}const bZ="mcp_used/unknown";function _S(n){for(const e of n)if(NC(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function jS(n){var e;n[bS]=(((e=n[bS])!==null&&e!==void 0?e:"")+` ${bZ}`).trimStart()}function wZ(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>NC(s)))!==null&&r!==void 0?r:!1}function _Z(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>!NC(s)))!==null&&r!==void 0?r:!1}function NC(n){return n!==null&&typeof n=="object"&&"tool"in n&&"callTool"in n}async function jZ(n,e,t){const r=new IH,s=JSON.parse(t.data),a=B9(n,s);Object.assign(r,a),e(r)}class NZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),o=TZ(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),c=`${s}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${l}`;let d=()=>{};const h=new Promise(D=>{d=D}),p=e.callbacks,x=function(){d({})},v=this.apiClient,w={onopen:x,onmessage:D=>{jZ(v,p.onmessage,D)},onerror:(t=p?.onerror)!==null&&t!==void 0?t:function(D){},onclose:(r=p?.onclose)!==null&&r!==void 0?r:function(D){}},_=this.webSocketFactory.create(c,CZ(o),w);_.connect(),await h;const j=Un(this.apiClient,e.model),T=WF(this.apiClient,{model:j}),P=xS(this.apiClient,{setup:T});return _.send(JSON.stringify(P)),new SZ(_,this.apiClient)}}class SZ{constructor(e,t){this.conn=e,this.apiClient=t}async setClientContent(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=i9(this.apiClient,e),r=$F(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=a9(this.apiClient,e),r=xS(this.apiClient,t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const t=xS(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(af.PLAY)}pause(){this.sendPlaybackControl(af.PAUSE)}stop(){this.sendPlaybackControl(af.STOP)}resetContext(){this.sendPlaybackControl(af.RESET_CONTEXT)}close(){this.conn.close()}}function CZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function TZ(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const kZ="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function PZ(n,e,t){const r=new OH;let s;if(t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),n.isVertexAI()){const a=I9(n,s);Object.assign(r,a)}else{const a=O9(n,s);Object.assign(r,a)}e(r)}class MZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new NZ(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,s,a,o,l;const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const p=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&_S(e.config.tools)&&jS(p);const x=IZ(p);if(this.apiClient.isVertexAI())h=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x);else{const V=this.apiClient.getApiKey();h=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${V}`}let v=()=>{};const w=new Promise(V=>{v=V}),_=e.callbacks,j=function(){var V;(V=_?.onopen)===null||V===void 0||V.call(_),v({})},T=this.apiClient,P={onopen:j,onmessage:V=>{PZ(T,_.onmessage,V)},onerror:(t=_?.onerror)!==null&&t!==void 0?t:function(V){},onclose:(r=_?.onclose)!==null&&r!==void 0?r:function(V){}},D=this.webSocketFactory.create(h,OZ(x),P);D.connect(),await w;let M=Un(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&M.startsWith("publishers/")){const V=this.apiClient.getProject(),U=this.apiClient.getLocation();M=`projects/${V}/locations/${U}/`+M}let O={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[um.AUDIO]}:e.config.responseModalities=[um.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I=(l=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[],q=[];for(const V of I)if(this.isCallableTool(V)){const U=V;q.push(await U.tool())}else q.push(V);q.length>0&&(e.config.tools=q);const F={model:M,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?O=Q7(this.apiClient,F):O=J7(this.apiClient,F),delete O.config,D.send(JSON.stringify(O)),new DZ(D,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const EZ={turnComplete:!0};class DZ{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=ka(e,t.turns),e.isVertexAI()?r=r.map(s=>Uf(e,s)):r=r.map(s=>sy(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const a of r){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(kZ)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},EZ),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:s9(this.apiClient,e)}:t={realtimeInput:r9(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function OZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function IZ(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const MM=10;function EM(n){var e,t,r;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const o of(t=n?.tools)!==null&&t!==void 0?t:[])if(lx(o)){s=!0;break}if(!s)return!0;const a=(r=n?.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function lx(n){return"callTool"in n&&typeof n.callTool=="function"}function DM(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class AZ extends Em{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,s,a,o,l;if(t.config&&t.config.tools&&_S(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),jS(t.config.httpOptions.headers)),!wZ(t)||EM(t.config))return await this.generateContentInternal(t);if(_Z(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");const c=await this.transformCallableTools(t);let d,h;const p=ka(this.apiClient,c.contents),x=(a=(s=(r=c.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&a!==void 0?a:MM;let v=0;for(;v<x&&(d=await this.generateContentInternal(c),!(!d.functionCalls||d.functionCalls.length===0));){const w=d.candidates[0].content,_=[];for(const j of(l=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[])if(lx(j)){const P=await j.callTool(d.functionCalls);_.push(...P)}v++,h={role:"user",parts:_},c.contents=ka(this.apiClient,c.contents),c.contents.push(w),c.contents.push(h),DM(c.config)&&(p.push(w),p.push(h))}return DM(c.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async t=>{if(t.config&&t.config.tools&&_S(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),jS(t.config.httpOptions.headers)),EM(t.config)){const r=await this.transformCallableTools(t);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var s;let a;const o=[];if(r?.generatedImages)for(const c of r.generatedImages)c&&c?.safetyAttributes&&((s=c?.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?a=c?.safetyAttributes:o.push(c);let l;return a?l={generatedImages:o,positivePromptSafetyAttributes:a}:l={generatedImages:o},l}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new ry(kf.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async transformCallableTools(e){var t;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const s=await Promise.all(r.map(async o=>lx(o)?await o.tool():o)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};return a.config.tools=s,a}async initAfcToolsMap(e){var t,r,s;const a=new Map;for(const o of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(lx(o)){const l=o,c=await l.tool();for(const d of(s=c.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(a.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);a.set(d.name,l)}}return a}async processAfcStream(e){var t,r,s;const a=(s=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:MM;let o=!1,l=0;const c=await this.initAfcToolsMap(e);return(function(d,h,p){var x,v;return Qh(this,arguments,function*(){for(var w,_,j,T;l<a;){o&&(l++,o=!1);const O=yield Kn(d.transformCallableTools(p)),I=yield Kn(d.generateContentStreamInternal(O)),q=[],F=[];try{for(var P=!0,D=(_=void 0,ox(I)),M;M=yield Kn(D.next()),w=M.done,!w;P=!0){T=M.value,P=!1;const V=T;if(yield yield Kn(V),V.candidates&&(!((x=V.candidates[0])===null||x===void 0)&&x.content)){F.push(V.candidates[0].content);for(const U of(v=V.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(l<a&&U.functionCall){if(!U.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(U.functionCall.name)){const W=yield Kn(h.get(U.functionCall.name).callTool([U.functionCall]));q.push(...W)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${U.functionCall.name}`)}}}}catch(V){_={error:V}}finally{try{!P&&!w&&(j=D.return)&&(yield Kn(j.call(D)))}finally{if(_)throw _.error}}if(q.length>0){o=!0;const V=new yh;V.candidates=[{content:{role:"user",parts:q}}],yield yield Kn(V);const U=[];U.push(...F),U.push({role:"user",parts:q});const W=ka(d.apiClient,p.contents).concat(U);p.contents=W}else break}})})(this,c,e)}async generateContentInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=SM(this.apiClient,e);return l=Rt("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=TM(this.apiClient,h),x=new yh;return Object.assign(x,p),x})}else{const d=NM(this.apiClient,e);return l=Rt("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=CM(this.apiClient,h),x=new yh;return Object.assign(x,p),x})}}async generateContentStreamInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=SM(this.apiClient,e);l=Rt("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return Qh(this,arguments,function*(){var x,v,w,_;try{for(var j=!0,T=ox(p),P;P=yield Kn(T.next()),x=P.done,!x;j=!0){_=P.value,j=!1;const M=TM(h,yield Kn(_.json())),O=new yh;Object.assign(O,M),yield yield Kn(O)}}catch(D){v={error:D}}finally{try{!j&&!x&&(w=T.return)&&(yield Kn(w.call(T)))}finally{if(v)throw v.error}}})})}else{const d=NM(this.apiClient,e);l=Rt("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),o.then(function(p){return Qh(this,arguments,function*(){var x,v,w,_;try{for(var j=!0,T=ox(p),P;P=yield Kn(T.next()),x=P.done,!x;j=!0){_=P.value,j=!1;const M=CM(h,yield Kn(_.json())),O=new yh;Object.assign(O,M),yield yield Kn(O)}}catch(D){v={error:D}}finally{try{!j&&!x&&(w=T.return)&&(yield Kn(w.call(T)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=KY(this.apiClient,e);return l=Rt("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=KG(this.apiClient,h),x=new sM;return Object.assign(x,p),x})}else{const d=fY(this.apiClient,e);return l=Rt("{model}:batchEmbedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=PG(this.apiClient,h),x=new sM;return Object.assign(x,p),x})}}async generateImagesInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=QY(this.apiClient,e);return l=Rt("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=QG(this.apiClient,h),x=new iM;return Object.assign(x,p),x})}else{const d=mY(this.apiClient,e);return l=Rt("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=DG(this.apiClient,h),x=new iM;return Object.assign(x,p),x})}}async editImageInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=iG(this.apiClient,e);return a=Rt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=XG(this.apiClient,c),h=new TH;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=oG(this.apiClient,e);return a=Rt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=eZ(this.apiClient,c),h=new kH;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=lG(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>vS(this.apiClient,h))}else{const d=pY(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>yS(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=dG(this.apiClient,e);return l=Rt("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=sZ(this.apiClient,h),x=new aM;return Object.assign(x,p),x})}else{const d=xY(this.apiClient,e);return l=Rt("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=IG(this.apiClient,h),x=new aM;return Object.assign(x,p),x})}}async update(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=fG(this.apiClient,e);return l=Rt("{model}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>vS(this.apiClient,h))}else{const d=vY(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>yS(this.apiClient,h))}}async delete(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=hG(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=iZ(),p=new oM;return Object.assign(p,h),p})}else{const d=bY(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(()=>{const h=AG(),p=new oM;return Object.assign(p,h),p})}}async countTokens(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=pG(this.apiClient,e);return l=Rt("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=aZ(this.apiClient,h),x=new lM;return Object.assign(x,p),x})}else{const d=_Y(this.apiClient,e);return l=Rt("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=RG(this.apiClient,h),x=new lM;return Object.assign(x,p),x})}}async computeTokens(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=gG(this.apiClient,e);return a=Rt("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=oZ(this.apiClient,c),h=new PH;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=yG(this.apiClient,e);return l=Rt("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>uZ(this.apiClient,h))}else{const d=SY(this.apiClient,e);return l=Rt("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>zG(this.apiClient,h))}}}function RZ(n,e){const t={},r=N(e,["operationName"]);r!=null&&S(t,["_url","operationName"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function LZ(n,e){const t={},r=N(e,["operationName"]);r!=null&&S(t,["_url","operationName"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function FZ(n,e){const t={},r=N(e,["operationName"]);r!=null&&S(t,["operationName"],r);const s=N(e,["resourceName"]);s!=null&&S(t,["_url","resourceName"],s);const a=N(e,["config"]);return a!=null&&S(t,["config"],a),t}function qZ(n,e){const t={},r=N(e,["video","uri"]);r!=null&&S(t,["uri"],r);const s=N(e,["video","encodedVideo"]);s!=null&&S(t,["videoBytes"],Kc(n,s));const a=N(e,["encoding"]);return a!=null&&S(t,["mimeType"],a),t}function zZ(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],qZ(n,r)),t}function UZ(n,e){const t={},r=N(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>zZ(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function VZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response","generateVideoResponse"]);return l!=null&&S(t,["response"],UZ(n,l)),t}function BZ(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["uri"],r);const s=N(e,["bytesBase64Encoded"]);s!=null&&S(t,["videoBytes"],Kc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function WZ(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],BZ(n,r)),t}function $Z(n,e){const t={},r=N(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>WZ(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function OM(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],$Z(n,l)),t}class HZ extends Em{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;return r&&"httpOptions"in r&&(a=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=LZ(this.apiClient,e);return l=Rt("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>OM(this.apiClient,h))}else{const d=RZ(this.apiClient,e);return l=Rt("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>VZ(this.apiClient,h))}}async fetchPredictVideosOperationInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=FZ(this.apiClient,e);return a=Rt("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>OM(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}function YZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function GZ(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);return t!==void 0&&o!=null&&S(t,["_query","filter"],o),r}function ZZ(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],GZ(n,r,t)),t}function KZ(n,e){const t={},r=N(e,["textInput"]);r!=null&&S(t,["textInput"],r);const s=N(e,["output"]);return s!=null&&S(t,["output"],s),t}function JZ(n,e){const t={};if(N(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=N(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>KZ(n,a))),S(t,["examples","examples"],s)}return t}function QZ(n,e,t){const r={};if(N(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=N(e,["tunedModelDisplayName"]);if(t!==void 0&&s!=null&&S(t,["displayName"],s),N(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=N(e,["epochCount"]);t!==void 0&&a!=null&&S(t,["tuningTask","hyperparameters","epochCount"],a);const o=N(e,["learningRateMultiplier"]);if(o!=null&&S(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),N(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(N(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=N(e,["batchSize"]);t!==void 0&&l!=null&&S(t,["tuningTask","hyperparameters","batchSize"],l);const c=N(e,["learningRate"]);return t!==void 0&&c!=null&&S(t,["tuningTask","hyperparameters","learningRate"],c),r}function XZ(n,e){const t={},r=N(e,["baseModel"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["trainingDataset"]);s!=null&&S(t,["tuningTask","trainingData"],JZ(n,s));const a=N(e,["config"]);return a!=null&&S(t,["config"],QZ(n,a,t)),t}function eK(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function tK(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);return t!==void 0&&o!=null&&S(t,["_query","filter"],o),r}function nK(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],tK(n,r,t)),t}function rK(n,e,t){const r={},s=N(e,["gcsUri"]);if(t!==void 0&&s!=null&&S(t,["supervisedTuningSpec","trainingDatasetUri"],s),N(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function sK(n,e){const t={},r=N(e,["gcsUri"]);return r!=null&&S(t,["validationDatasetUri"],r),t}function iK(n,e,t){const r={},s=N(e,["validationDataset"]);t!==void 0&&s!=null&&S(t,["supervisedTuningSpec"],sK(n,s));const a=N(e,["tunedModelDisplayName"]);t!==void 0&&a!=null&&S(t,["tunedModelDisplayName"],a);const o=N(e,["description"]);t!==void 0&&o!=null&&S(t,["description"],o);const l=N(e,["epochCount"]);t!==void 0&&l!=null&&S(t,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=N(e,["learningRateMultiplier"]);t!==void 0&&c!=null&&S(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=N(e,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&S(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=N(e,["adapterSize"]);if(t!==void 0&&h!=null&&S(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),N(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(N(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function aK(n,e){const t={},r=N(e,["baseModel"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["trainingDataset"]);s!=null&&S(t,["supervisedTuningSpec","trainingDatasetUri"],rK(n,s,t));const a=N(e,["config"]);return a!=null&&S(t,["config"],iK(n,a,t)),t}function oK(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["model"],r);const s=N(e,["name"]);return s!=null&&S(t,["endpoint"],s),t}function JF(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["state"]);s!=null&&S(t,["state"],RF(n,s));const a=N(e,["createTime"]);a!=null&&S(t,["createTime"],a);const o=N(e,["tuningTask","startTime"]);o!=null&&S(t,["startTime"],o);const l=N(e,["tuningTask","completeTime"]);l!=null&&S(t,["endTime"],l);const c=N(e,["updateTime"]);c!=null&&S(t,["updateTime"],c);const d=N(e,["description"]);d!=null&&S(t,["description"],d);const h=N(e,["baseModel"]);h!=null&&S(t,["baseModel"],h);const p=N(e,["_self"]);p!=null&&S(t,["tunedModel"],oK(n,p));const x=N(e,["distillationSpec"]);x!=null&&S(t,["distillationSpec"],x);const v=N(e,["experiment"]);v!=null&&S(t,["experiment"],v);const w=N(e,["labels"]);w!=null&&S(t,["labels"],w);const _=N(e,["pipelineJob"]);_!=null&&S(t,["pipelineJob"],_);const j=N(e,["tunedModelDisplayName"]);return j!=null&&S(t,["tunedModelDisplayName"],j),t}function lK(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["tunedModels"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>JF(n,o))),S(t,["tuningJobs"],a)}return t}function cK(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);return o!=null&&S(t,["error"],o),t}function dK(n,e){const t={},r=N(e,["checkpointId"]);r!=null&&S(t,["checkpointId"],r);const s=N(e,["epoch"]);s!=null&&S(t,["epoch"],s);const a=N(e,["step"]);a!=null&&S(t,["step"],a);const o=N(e,["endpoint"]);return o!=null&&S(t,["endpoint"],o),t}function uK(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["model"],r);const s=N(e,["endpoint"]);s!=null&&S(t,["endpoint"],s);const a=N(e,["checkpoints"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>dK(n,l))),S(t,["checkpoints"],o)}return t}function NS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["state"]);s!=null&&S(t,["state"],RF(n,s));const a=N(e,["createTime"]);a!=null&&S(t,["createTime"],a);const o=N(e,["startTime"]);o!=null&&S(t,["startTime"],o);const l=N(e,["endTime"]);l!=null&&S(t,["endTime"],l);const c=N(e,["updateTime"]);c!=null&&S(t,["updateTime"],c);const d=N(e,["error"]);d!=null&&S(t,["error"],d);const h=N(e,["description"]);h!=null&&S(t,["description"],h);const p=N(e,["baseModel"]);p!=null&&S(t,["baseModel"],p);const x=N(e,["tunedModel"]);x!=null&&S(t,["tunedModel"],uK(n,x));const v=N(e,["supervisedTuningSpec"]);v!=null&&S(t,["supervisedTuningSpec"],v);const w=N(e,["tuningDataStats"]);w!=null&&S(t,["tuningDataStats"],w);const _=N(e,["encryptionSpec"]);_!=null&&S(t,["encryptionSpec"],_);const j=N(e,["partnerModelTuningSpec"]);j!=null&&S(t,["partnerModelTuningSpec"],j);const T=N(e,["distillationSpec"]);T!=null&&S(t,["distillationSpec"],T);const P=N(e,["experiment"]);P!=null&&S(t,["experiment"],P);const D=N(e,["labels"]);D!=null&&S(t,["labels"],D);const M=N(e,["pipelineJob"]);M!=null&&S(t,["pipelineJob"],M);const O=N(e,["tunedModelDisplayName"]);return O!=null&&S(t,["tunedModelDisplayName"],O),t}function fK(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["tuningJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>NS(n,o))),S(t,["tuningJobs"],a)}return t}class hK extends Em{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new ry(kf.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:hS.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=eK(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>NS(this.apiClient,h))}else{const d=YZ(this.apiClient,e);return l=Rt("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>JF(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=nK(this.apiClient,e);return l=Rt("tuningJobs",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=fK(this.apiClient,h),x=new cM;return Object.assign(x,p),x})}else{const d=ZZ(this.apiClient,e);return l=Rt("tunedModels",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=lK(this.apiClient,h),x=new cM;return Object.assign(x,p),x})}}async tuneInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=aK(this.apiClient,e);return a=Rt("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>NS(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=XZ(this.apiClient,e);return a=Rt("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>cK(this.apiClient,c))}}}class mK{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const pK=1024*1024*8,gK=3,xK=1e3,yK=2,fb="x-goog-upload-status";async function vK(n,e,t){var r,s,a;let o=0,l=0,c=new mS(new Response),d="upload";for(o=n.size;l<o;){const p=Math.min(pK,o-l),x=n.slice(l,l+p);l+p>=o&&(d+=", finalize");let v=0,w=xK;for(;v<gK&&(c=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(p)}}}),!(!((r=c?.headers)===null||r===void 0)&&r[fb]));)v++,await wK(w),w=w*yK;if(l+=p,((s=c?.headers)===null||s===void 0?void 0:s[fb])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await c?.json();if(((a=c?.headers)===null||a===void 0?void 0:a[fb])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function bK(n){return{size:n.size,type:n.type}}function wK(n){return new Promise(e=>setTimeout(e,n))}class _K{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await vK(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await bK(e)}}class jK{create(e,t,r){return new NK(e,t,r)}}class NK{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const IM="x-goog-api-key";class SK{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(IM)===null&&e.append(IM,this.apiKey)}}const CK="gl-node/";class TK{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=CH(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new SK(this.apiKey);this.apiClient=new vZ({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:CK+"web",uploader:new _K,downloader:new mK}),this.models=new AZ(this.apiClient),this.live=new MZ(this.apiClient,s,new jK),this.chats=new $8(this.models,this.apiClient),this.caches=new V8(this.apiClient),this.files=new s7(this.apiClient),this.operations=new HZ(this.apiClient),this.tunings=new hK(this.apiClient)}}const fm="onboarding-documents",SS="avatars",AM="support-attachments",vh="logo",bh="background",kK="task-attachments",PK="your-google-genai-api-key";let hl=null;hl=new TK({apiKey:PK});const CS=n=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(CS);const e={...n};if(typeof e.name=="string"&&typeof e.path=="string"){const t=e.path.startsWith("avatars/")?SS:fm,{data:{publicUrl:r}}=Me.storage.from(t).getPublicUrl(e.path);e.preview=r,e.url=r}for(const t in e)e[t]=CS(e[t]);return e},TS=async(n,e,t)=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return Promise.all(n.map(s=>TS(s,e,t)));const r={...n};if(r.file instanceof File){const s=r.file,a=`${e}/documents/${Date.now()}_${s.name}`,{error:o}=await Me.storage.from(fm).upload(a,s);if(o)throw o;try{await Me.from("user_documents").insert({user_id:e,submission_id:t||null,name:r.name||s.name,bucket:fm,path:a,file_type:s.type,file_size:s.size})}catch(l){console.error("Failed to record uploaded document:",l)}return{name:r.name||s.name,type:s.type,size:s.size,path:a}}if(typeof r.name=="string"&&r.path)return{name:r.name,type:r.type,size:r.size,path:r.path};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(r[s]=await TS(r[s],e,t));return r},MK=async n=>await(await fetch(n)).blob(),fn=n=>{if(Array.isArray(n))return n.map(e=>fn(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)&&!(n instanceof File)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/[A-Z]/g,s=>`_${s.toLowerCase()}`);e[r]=fn(n[t])}return e}return n},gt=n=>{if(Array.isArray(n))return n.map(e=>gt(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/_([a-z])/g,s=>s[1].toUpperCase());e[r]=gt(n[t])}return CS(e)}return n},ue={getInitialAppData:async()=>{const{data:n,error:e}=await Me.from("settings").select("*").eq("id","singleton").single();if(e)throw new Error("Failed to fetch core application settings.");const{data:t,error:r}=await Me.from("roles").select("*");if(r)throw new Error("Failed to fetch user roles.");const{data:s,error:a}=await Me.from("holidays").select("*");if(a)throw new Error("Failed to fetch holidays.");return{settings:gt(n),roles:(t||[]).map(gt),holidays:(s||[]).map(gt)}},getVerificationSubmissions:async(n,e)=>{let t=Me.from("onboarding_submissions").select("*");n&&(t=t.eq("status",n)),e&&(t=t.eq("organization_id",e));const{data:r,error:s}=await t.order("created_at",{ascending:!1});if(s)throw s;return(r||[]).map(gt)},getOnboardingDataById:async n=>{const{data:e,error:t}=await Me.from("onboarding_submissions").select("*").eq("id",n).single();if(t&&t.code!=="PGRST116")throw t;return e?gt(e):null},_saveSubmission:async(n,e)=>{const{data:{session:t}}=await Me.auth.getSession();if(!t?.user)throw new Error("User not authenticated");const r=n.id&&!n.id.startsWith("draft_")?n.id:crypto.randomUUID(),s=await TS(n,t.user.id,r),a={...fn(s),id:r,user_id:t.user.id,status:e?"draft":n.status};delete a.file,delete a.confirm_account_number;const{data:o,error:l}=await Me.from("onboarding_submissions").upsert(a,{onConflict:"id"}).select("id").single();if(l)throw l;return{draftId:o.id}},saveDraft:async n=>ue._saveSubmission(n,!0),submitOnboarding:async n=>{const{draftId:e}=await ue._saveSubmission(n,!1),t=await ue.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve submitted data.");return t},updateOnboarding:async n=>{const{draftId:e}=await ue._saveSubmission(n,n.status==="draft"),t=await ue.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve updated data.");return t},verifySubmission:async n=>{const{error:e}=await Me.from("onboarding_submissions").update({status:"verified",portal_sync_status:"pending_sync"}).eq("id",n);if(e)throw e},requestChanges:async(n,e)=>{const{error:t}=await Me.from("onboarding_submissions").update({status:"rejected"}).eq("id",n);if(t)throw t},syncPortals:async n=>{const{data:e,error:t}=await Me.functions.invoke("sync-portals",{body:{submissionId:n}});if(t)throw t;return gt(e)},deleteFile:async n=>{const{error:e}=await Me.storage.from(fm).remove([n]);if(e)throw e},uploadDocument:async(n,e=fm,t,r)=>{const{data:{session:s}}=await Me.auth.getSession(),a=s?.user?.id||"anonymous_user",o=`${a}/documents/${Date.now()}_${n.name}`,{error:l}=await Me.storage.from(e).upload(o,n);if(l)throw l;const{data:c}=Me.storage.from(e).getPublicUrl(o);if(!c.publicUrl)throw new Error("Could not get public URL for uploaded file.");try{await Me.from("user_documents").insert({user_id:a,submission_id:t||null,name:r||n.name,bucket:e,path:o,file_type:n.type,file_size:n.size})}catch(d){console.error("Failed to insert user_documents record:",d)}return{url:c.publicUrl,path:o}},getUsers:async()=>{const{data:n,error:e}=await Me.from("users").select("*, role_id");if(e)throw e;return(n||[]).map(t=>gt({...t,role:t.role_id}))},getUsersWithManagers:async()=>{const{data:n,error:e}=await Me.from("users").select("*, reporting_manager_id, role_id");if(e)throw e;const t=(n||[]).map(s=>gt({...s,role:s.role_id})),r=new Map(t.map(s=>[s.id,s.name]));return t.map(s=>({...s,managerName:s.reportingManagerId?r.get(s.reportingManagerId):void 0}))},getFieldOfficers:async()=>ue.getUsers().then(n=>n.filter(e=>e.role==="field_officer")),getNearbyUsers:async()=>{const n=await ue.getUsers();let e={};try{const t=new Date;t.setHours(0,0,0,0);const r=new Date,s=await ue.getAllAttendanceEvents(t.toISOString(),r.toISOString()),a={};s.forEach(o=>{const{userId:l,type:c,timestamp:d}=o;l&&(!a[l]||new Date(d)>new Date(a[l].timestamp))&&(a[l]={type:c.toLowerCase(),timestamp:d})}),e=Object.fromEntries(Object.entries(a).map(([o,l])=>{const c=l.type.toLowerCase().replace(/[-_\s]/g,""),d=c==="checkin";return console.log(`User ${o}: latest event type = "${l.type}", normalized = "${c}", isCheckIn = ${d}`),[o,d]}))}catch(t){console.warn("Failed to compute user availability:",t)}return n.map(t=>({...t,isAvailable:e[t.id]??!1}))},updateUser:async(n,e)=>{const{role:t,...r}=e,s=fn(r);if(t&&(s.role_id=t),"photo_url"in s){const{data:{session:l}}=await Me.auth.getSession();if(!l?.user)throw new Error("User not authenticated for photo upload");const c=l.user.id,{data:d}=await Me.from("users").select("photo_url").eq("id",n).single(),h=d?.photo_url,p=async x=>{if(x)try{const w=new URL(x).pathname.split("/public/")[1];if(w){const[_,...j]=w.split("/"),T=j.join("/");T&&await Me.storage.from(_).remove([T])}}catch(v){console.error("Failed to process old avatar URL for deletion:",v)}};if(s.photo_url&&s.photo_url.startsWith("data:")){await p(h);const x=await MK(s.photo_url),v=s.photo_url.split(";")[0].split("/")[1]||"jpg",w=`${c}/${Date.now()}.${v}`,{error:_}=await Me.storage.from(SS).upload(w,x,{upsert:!0});if(_)throw _;const{data:{publicUrl:j}}=Me.storage.from(SS).getPublicUrl(w);s.photo_url=j}else s.photo_url===null&&await p(h)}const{data:a,error:o}=await Me.from("users").update(s).eq("id",n).select().single();if(o)throw o;return gt({...a,role:a.role_id})},createUser:async n=>{const{role:e,...t}=n,r=fn(t);e&&(r.role_id=e);const{data:s,error:a}=await Me.from("users").insert(r).select().single();if(a)throw a;return gt({...s,role:s.role_id})},deleteUser:async n=>{const{error:e}=await Me.from("users").delete().eq("id",n);if(e)throw e},updateUserReportingManager:async(n,e)=>{const{error:t}=await Me.from("users").update({reporting_manager_id:e}).eq("id",n);if(t)throw t},getOrganizations:async()=>{const{data:n,error:e}=await Me.from("organizations").select("*").order("short_name");if(e)throw e;return(n||[]).map(gt)},createOrganization:async n=>{const{data:e,error:t}=await Me.from("organizations").insert(fn(n)).select().single();if(t)throw t;return gt(e)},getOrganizationStructure:async()=>{const{data:n,error:e}=await Me.from("organization_groups").select("*");if(e)throw e;const{data:t,error:r}=await Me.from("companies").select("*");if(r)throw r;const{data:s,error:a}=await Me.from("entities").select("*");if(a)throw a;const o=(n||[]).map(gt),l=(t||[]).map(gt),c=(s||[]).map(gt),d=new Map;return l.forEach(h=>{const p={...h,entities:c.filter(x=>x.companyId===h.id)};d.has(h.groupId)||d.set(h.groupId,[]),d.get(h.groupId).push(p)}),o.map(h=>({...h,companies:d.get(h.id)||[],locations:[]}))},getSiteConfigurations:async()=>{const{data:n,error:e}=await Me.from("site_configurations").select("*");if(e)throw e;return(n||[]).map(gt)},bulkUploadOrganizations:async n=>{const{count:e,error:t}=await Me.from("organizations").upsert(fn(n),{onConflict:"id"});if(t)throw t;return{count:e||0}},getModules:async()=>{const{data:n,error:e}=await Me.from("app_modules").select("*");if(e)throw e;return(n||[]).map(gt)},saveModules:async n=>{const{error:e}=await Me.from("app_modules").upsert(fn(n));if(e)throw e},getRoles:async()=>{const{data:n,error:e}=await Me.from("roles").select("*");if(e)throw e;return(n||[]).map(gt)},saveRoles:async n=>{const{error:e}=await Me.from("roles").upsert(fn(n));if(e)throw e},getHolidays:async()=>{const{data:n,error:e}=await Me.from("holidays").select("*");if(e)throw e;return(n||[]).map(gt)},addHoliday:async n=>{const{data:e,error:t}=await Me.from("holidays").insert(fn(n)).select().single();if(t)throw t;return gt(e)},removeHoliday:async n=>{const{error:e}=await Me.from("holidays").delete().eq("id",n);if(e)throw e},getAttendanceEvents:async(n,e,t)=>{const{data:r,error:s}=await Me.from("attendance_events").select("*").eq("user_id",n).gte("timestamp",e).lte("timestamp",t);if(s)throw s;return(r||[]).map(gt)},getAllAttendanceEvents:async(n,e)=>{const{data:t,error:r}=await Me.from("attendance_events").select("*").gte("timestamp",n).lte("timestamp",e);if(r)throw r;return(t||[]).map(gt)},getAttendanceDashboardData:async(n,e,t,r="UTC")=>{const{data:s,error:a}=await Me.rpc("get_attendance_dashboard_data",{start_date_iso:$e(n,"yyyy-MM-dd"),end_date_iso:$e(e,"yyyy-MM-dd"),current_date_iso:$e(t,"yyyy-MM-dd"),p_timezone:r});if(a)throw new Error("Could not load attendance dashboard data from the database function.");return s},addAttendanceEvent:async n=>{const{error:e}=await Me.from("attendance_events").insert(fn(n));if(e)throw e},getLocations:async()=>{const{data:n,error:e}=await Me.from("locations").select("*, created_by_user:created_by (id, name)");if(e)throw e;return(n||[]).map(t=>{const r=gt(t),a=r.createdByUser?.name||void 0,{createdByUser:o,...l}=r;return{...l,createdByName:a}})},getUserLocations:async n=>{const{data:e,error:t}=await Me.from("user_locations").select("location_id:location_id (*), id").eq("user_id",n);if(t)throw t;return(e||[]).map(r=>{const s=r.location_id||{};return gt(s)})},createLocation:async n=>{const e=fn(n),{data:t,error:r}=await Me.from("locations").insert(e).select("*").single();if(r)throw r;return gt(t)},assignLocationToUser:async(n,e)=>{const{error:t}=await Me.from("user_locations").insert({user_id:n,location_id:e});if(t)throw t},updateLocation:async(n,e)=>{const t=fn(e),{data:r,error:s}=await Me.from("locations").update(t).eq("id",n).select("*").single();if(s)throw s;return gt(r)},deleteLocation:async n=>{const{error:e}=await Me.from("locations").delete().eq("id",n);if(e)throw e},unassignLocationFromUser:async(n,e)=>{const{error:t}=await Me.from("user_locations").delete().match({user_id:n,location_id:e});if(t)throw t},uploadLogo:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await Me.storage.from(vh).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:s}}=Me.storage.from(vh).getPublicUrl(t);return s},getLogos:async()=>{const{data:n,error:e}=await Me.storage.from(vh).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=Me.storage.from(vh).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteLogo:async n=>{const{error:e}=await Me.storage.from(vh).remove([n]);if(e)throw e},uploadBackground:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await Me.storage.from(bh).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:s}}=Me.storage.from(bh).getPublicUrl(t);return s},getBackgroundImages:async()=>{const{data:n,error:e}=await Me.storage.from(bh).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=Me.storage.from(bh).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteBackground:async n=>{const{error:e}=await Me.storage.from(bh).remove([n]);if(e)throw e},getAttendanceSettings:async()=>{const{data:n,error:e}=await Me.from("settings").select("attendance_settings").eq("id","singleton").single();if(e)throw e;if(!n?.attendance_settings)throw new Error("Attendance settings are not configured.");return gt(n.attendance_settings)},saveAttendanceSettings:async n=>{const{error:e}=await Me.from("settings").upsert({id:"singleton",attendance_settings:fn(n),updated_at:new Date().toISOString()},{onConflict:"id"});if(e)throw console.error("Error saving attendance settings:",e),e},getRecurringHolidays:async()=>{const{data:n,error:e}=await Me.from("recurring_holidays").select("*");if(e)throw e;return(n||[]).map(t=>({id:t.id,type:t.role_type,day:t.day,n:t.occurrence}))},addRecurringHoliday:async n=>{const e={role_type:n.type||"office",day:n.day,occurrence:n.n},{data:t,error:r}=await Me.from("recurring_holidays").insert(e).select().single();if(r)throw r;return{id:t.id,type:t.role_type,day:t.day,n:t.occurrence}},deleteRecurringHoliday:async n=>{const{error:e}=await Me.from("recurring_holidays").delete().eq("id",n);if(e)throw e},createAssignment:async(n,e,t)=>{const r=(await ue.getOrganizations()).find(s=>s.id===e);await ue.createTask({name:`Visit ${r?.shortName||"site"} for verification`,description:`Perform on-site duties and verification tasks for ${r?.shortName}.`,dueDate:t,priority:"Medium",assignedToId:n})},getLeaveBalancesForUser:async n=>{const e=_=>["hr","admin","finance"].includes(_)?"office":"field",{data:t,error:r}=await Me.from("settings").select("attendance_settings").eq("id","singleton").single();if(r||!t?.attendance_settings)throw new Error("Could not load attendance rules.");const{data:s,error:a}=await Me.from("users").select("role_id").eq("id",n).single();if(a)throw a;const o=e(s.role_id),l=gt(t.attendance_settings)[o],[{data:c,error:d},{data:h,error:p},{data:x,error:v}]=await Promise.all([Me.from("leave_requests").select("leave_type, start_date, end_date, day_option").eq("user_id",n).eq("status","approved"),Me.from("comp_off_logs").select("*").eq("user_id",n),Me.from("extra_work_logs").select("hours_worked").eq("user_id",n).eq("claim_type","OT").eq("status","Approved").gte("work_date",$e(pi(new Date),"yyyy-MM-dd")).lte("work_date",$e(Ta(new Date),"yyyy-MM-dd"))]);if(d||p||v)throw new Error("Failed to fetch all leave balance data.");const w={userId:n,earnedTotal:l.annualEarnedLeaves||0,earnedUsed:0,sickTotal:l.annualSickLeaves||0,sickUsed:0,floatingTotal:(l.monthlyFloatingLeaves||0)*12,floatingUsed:0,compOffTotal:(h||[]).length,compOffUsed:(h||[]).filter(_=>_.status==="used").length,otHoursThisMonth:(x||[]).reduce((_,j)=>_+(j.hours_worked||0),0)};return(c||[]).forEach(_=>{const j=_.day_option==="half"?.5:Mm(new Date(_.end_date),new Date(_.start_date))+1;_.leave_type==="Earned"&&(w.earnedUsed+=j),_.leave_type==="Sick"&&(w.sickUsed+=j),_.leave_type==="Floating"&&(w.floatingUsed+=j)}),w},submitLeaveRequest:async n=>{const{data:e,error:t}=await Me.from("users").select("reporting_manager_id").eq("id",n.userId).single();if(t)throw t;const{data:r,error:s}=await Me.from("leave_requests").insert({...fn(n),status:"pending_manager_approval",current_approver_id:e.reporting_manager_id||null,approval_history:[]}).select("*").single();if(s)throw s;return gt(r)},getLeaveRequests:async n=>{let e=Me.from("leave_requests").select("*");n?.userId&&(e=e.eq("user_id",n.userId)),n?.userIds&&(e=e.in("user_id",n.userIds)),n?.status&&(e=e.eq("status",n.status)),n?.forApproverId&&(e=e.eq("current_approver_id",n.forApproverId)),n?.startDate&&n?.endDate&&(e=e.lte("start_date",n.endDate).gte("end_date",n.startDate));const{data:t,error:r}=await e.order("start_date",{ascending:!1});if(r)throw r;return(t||[]).map(gt)},getTasks:async()=>{const{data:n,error:e}=await Me.from("tasks").select("*").order("created_at",{ascending:!1});if(e)throw e;return(n||[]).map(gt)},createTask:async n=>{const{data:e,error:t}=await Me.from("tasks").insert(fn({...n,status:"To Do",escalationStatus:"None"})).select().single();if(t)throw t;return gt(e)},updateTask:async(n,e)=>{if(e?.completionPhoto&&e.completionPhoto.file){const s=e.completionPhoto,a=s.file;try{const{path:o}=await ue.uploadDocument(a,kK);e.completionPhoto={name:s.name,type:s.type,size:s.size,path:o}}catch(o){console.error("Failed to upload task completion photo:",o),delete e.completionPhoto}}const{data:t,error:r}=await Me.from("tasks").update(fn(e)).eq("id",n).select().single();if(r)throw r;return gt(t)},deleteTask:async n=>{const{error:e}=await Me.from("tasks").delete().eq("id",n);if(e)throw e},runAutomaticEscalations:async()=>{const{data:n,error:e}=await Me.functions.invoke("run-escalations");if(e)throw e;return gt(n)},getNotifications:async n=>{const{data:e,error:t}=await Me.from("notifications").select("*").eq("user_id",n).order("created_at",{ascending:!1});if(t)throw t;return(e||[]).map(gt)},createNotification:async n=>{const{data:e,error:t}=await Me.from("notifications").insert(fn(n)).select().single();if(t)throw t;return gt(e)},markNotificationAsRead:async n=>{await Me.from("notifications").update({is_read:!0}).eq("id",n)},markAllNotificationsAsRead:async n=>{await Me.from("notifications").update({is_read:!0}).eq("user_id",n).eq("is_read",!1)},createAuthUser:async n=>{const{name:e,email:t,password:r,role:s}=n;try{const{error:a}=await Me.functions.invoke("admin-create-user",{body:{name:e,email:t,password:r,role:s}});if(a)throw a;const l=(await ue.getUsers()).find(c=>c.email===t);if(l)return l;console.warn("admin-create-user completed but user not found; falling back to client side signup")}catch(a){const o=typeof a?.message=="string"?a.message:String(a);if(!o.toLowerCase().includes("failed to send a request")&&!o.toLowerCase().includes("edge function"))throw a;console.warn("Edge function not reachable, falling back to client side signup");const{data:l,error:c}=await Me.auth.signUp({email:t,password:r,options:{data:{name:e}}});if(c||!l?.user)throw c||new Error("Failed to sign up user");const d=l.user;try{await Me.from("users").upsert({id:d.id,name:e,email:t,role_id:s},{onConflict:"id"})}catch(h){console.warn("Failed to upsert user profile after fallback signup:",h)}return{id:d.id,name:e,email:t,role:s,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}}return{id:"",name:e,email:t,role:s,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}},getPolicies:async()=>{const{data:n,error:e}=await Me.from("policies").select("*");if(e)throw e;return(n||[]).map(gt)},createPolicy:async n=>{const{data:e,error:t}=await Me.from("policies").insert(fn(n)).select().single();if(t)throw t;return gt(e)},getInsurances:async()=>{const{data:n,error:e}=await Me.from("insurances").select("*");if(e)throw e;return(n||[]).map(gt)},createInsurance:async n=>{const{data:e,error:t}=await Me.from("insurances").insert(fn(n)).select().single();if(t)throw t;return gt(e)},getApprovalWorkflowSettings:async()=>{const{data:n,error:e}=await Me.from("settings").select("approval_workflow_settings").eq("id","singleton").single();if(e)throw e;if(!n?.approval_workflow_settings)throw new Error("Approval workflow settings are not configured.");return gt(n.approval_workflow_settings)},updateApprovalWorkflowSettings:async n=>{const{error:e}=await Me.from("settings").update({approval_workflow_settings:fn({finalConfirmationRole:n})}).eq("id","singleton");if(e)throw e},approveLeaveRequest:async(n,e)=>{const{data:t,error:r}=await Me.from("leave_requests").select("approval_history").eq("id",n).single();if(r)throw r;const{finalConfirmationRole:s}=await ue.getApprovalWorkflowSettings(),{data:a}=await Me.from("users").select("id").eq("role_id",s).limit(1).single(),{data:o,error:l}=await Me.from("users").select("name").eq("id",e).single();if(l)throw l;const c={approver_id:e,approver_name:o.name,status:"approved",timestamp:new Date().toISOString()},d=[...t.approval_history||[],c],{error:h}=await Me.from("leave_requests").update({status:"pending_hr_confirmation",current_approver_id:a?.id,approval_history:d}).eq("id",n);if(h)throw h},rejectLeaveRequest:async(n,e,t="")=>{const{data:r,error:s}=await Me.from("leave_requests").select("approval_history").eq("id",n).single();if(s)throw s;const{data:a,error:o}=await Me.from("users").select("name").eq("id",e).single();if(o)throw o;const l={approver_id:e,approver_name:a.name,status:"rejected",timestamp:new Date().toISOString(),comments:t},c=[...r.approval_history||[],l],{error:d}=await Me.from("leave_requests").update({status:"rejected",current_approver_id:null,approval_history:c}).eq("id",n);if(d)throw d},confirmLeaveByHR:async(n,e)=>{const{data:t,error:r}=await Me.from("leave_requests").select("leave_type, user_id, approval_history").eq("id",n).single();if(r)throw r;const{data:s,error:a}=await Me.from("users").select("name").eq("id",e).single();if(a)throw a;const o={approver_id:e,approver_name:s.name,status:"approved",timestamp:new Date().toISOString(),comments:"Final approval."},l=[...t.approval_history||[],o],{error:c}=await Me.from("leave_requests").update({status:"approved",current_approver_id:null,approval_history:l}).eq("id",n);if(c)throw c;if(t.leave_type==="Comp Off"){const{data:d,error:h}=await Me.from("comp_off_logs").select("id").eq("user_id",t.user_id).eq("status","earned").limit(1).single();if(h&&h.code!=="PGRST116")throw h;d&&await Me.from("comp_off_logs").update({status:"used",leave_request_id:n}).eq("id",d.id)}},submitExtraWorkClaim:async n=>{const{error:e}=await Me.from("extra_work_logs").insert(fn({...n,status:"Pending"}));if(e)throw e},getExtraWorkLogs:async n=>{let e=Me.from("extra_work_logs").select("*");n?e=e.eq("user_id",n):e=e.eq("status","Pending");const{data:t,error:r}=await e.order("work_date",{ascending:!1});if(r)throw r;return(t||[]).map(gt)},approveExtraWorkClaim:async(n,e)=>{const{data:t,error:r}=await Me.from("users").select("name").eq("id",e).single();if(r)throw r;const{data:s,error:a}=await Me.from("extra_work_logs").select("*").eq("id",n).single();if(a)throw a;if(!s)throw new Error("Claim not found.");const{error:o}=await Me.from("extra_work_logs").update({status:"Approved",approver_id:e,approver_name:t.name,approved_at:new Date().toISOString()}).eq("id",n);if(o)throw o;s.claim_type==="Comp Off"&&await ue.addCompOffLog({userId:s.user_id,userName:s.user_name,dateEarned:s.work_date,reason:`Claim approved: ${s.reason}`,status:"earned",grantedById:e,grantedByName:t.name})},rejectExtraWorkClaim:async(n,e,t)=>{const{data:r,error:s}=await Me.from("users").select("name").eq("id",e).single();if(s)throw s;const{error:a}=await Me.from("extra_work_logs").update({status:"Rejected",approver_id:e,approver_name:r.name,rejection_reason:t}).eq("id",n);if(a)throw a},getManpowerDetails:async n=>{const{data:e,error:t}=await Me.rpc("get_manpower_details",{site_id_param:n});if(t)throw t;return gt(e)},addCompOffLog:async n=>{const{data:e,error:t}=await Me.from("comp_off_logs").insert(fn(n)).select().single();if(t)throw t;return gt(e)},exportAllData:async()=>{const n=["users","organizations","onboarding_submissions","settings"],e={};for(const t of n){const{data:r,error:s}=await Me.from(t).select("*");if(s)throw new Error(`Failed to export ${t}`);e[t]=r}return gt(e)},getPincodeDetails:async n=>new Promise(e=>setTimeout(()=>e({city:"Bengaluru",state:"Karnataka"}),500)),suggestDepartmentForDesignation:async n=>{const e={"Security Guard":"Security","Housekeeping Staff":"Housekeeping","Site Manager":"Management"},t=Object.keys(e).find(r=>n.toLowerCase().includes(r.toLowerCase()));return Promise.resolve(t?e[t]:null)},verifyBankAccountWithPerfios:async n=>{console.log("Mock verifying bank account:",n),await new Promise(t=>setTimeout(t,1500));const e=Math.random()>.1;return{success:e,message:e?"Bank account verified successfully.":"Account holder name did not match.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:e,uan:null,esi:null,accountHolderName:e,accountNumber:e,ifscCode:!0}}},verifyAadhaar:async n=>{console.log("Mock verifying Aadhaar:",n),await new Promise(t=>setTimeout(t,1e3));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"Aadhaar details verified.":"Invalid Aadhaar number.",verifiedFields:{name:null,dob:null,aadhaar:e,bank:null,uan:null,esi:null}}},lookupUan:async n=>{console.log("Mock looking up UAN:",n),await new Promise(t=>setTimeout(t,1200));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"UAN found and linked.":"UAN not found in EPFO database.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:null,uan:e,esi:null}}},extractDataFromImage:async(n,e,t,r)=>{if(!hl)return console.warn("AI feature disabled: cannot extract data from image. Returning empty result."),{};const a=(await hl.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:`Extract the structured data from this document image. It is a ${r||"document"}.`},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:t}})).text.trim();return JSON.parse(a)},crossVerifyNames:async(n,e)=>{if(!hl){const s=n.trim().toLowerCase()===e.trim().toLowerCase();return{isMatch:s,reason:s?"Names are identical (case-insensitive match) without AI.":"AI disabled; simple case-insensitive comparison used."}}const r=(await hl.models.generateContent({model:"gemini-2.5-flash",contents:`Are these two names referring to the same person? Name 1: "${n}", Name 2: "${e}". Respond in JSON format with two keys: "isMatch" (boolean) and "reason" (a brief string explanation).`,config:{responseMimeType:"application/json",responseSchema:{type:et.OBJECT,properties:{isMatch:{type:et.BOOLEAN},reason:{type:et.STRING}}}}})).text.trim();return JSON.parse(r)},verifyFingerprintImage:async(n,e)=>{if(!hl)return{containsFingerprints:!1,reason:"AI disabled; cannot detect fingerprints."};const r=(await hl.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:'Does this image contain one or more human fingerprints? The image might be a scan from paper. Respond in JSON with "containsFingerprints" (boolean) and "reason" (string).'},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:{type:et.OBJECT,properties:{containsFingerprints:{type:et.BOOLEAN},reason:{type:et.STRING}}}}})).text.trim();return JSON.parse(r)},enhanceDocumentPhoto:async(n,e)=>{if(!hl)return console.warn("AI disabled; returning original document photo without enhancement."),n;const t=await hl.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{text:"Enhance this document photo. Improve contrast, correct perspective to be flat, and make text as clear as possible. Return only the enhanced image."},{inlineData:{data:n,mimeType:e}}]},config:{responseModalities:[um.IMAGE]}});for(const r of t.candidates[0].content.parts)if(r.inlineData)return r.inlineData.data;throw new Error("AI did not return an enhanced image.")},getSiteStaffDesignations:async()=>{const{data:n,error:e}=await Me.from("site_staff_designations").select("*");if(e)throw e;return(n||[]).map(gt)},updateManpowerDetails:async(n,e)=>{console.log("Mock updating manpower for",n,e),await new Promise(t=>setTimeout(t,500))},getCompOffLogs:async n=>{const{data:e,error:t}=await Me.from("comp_off_logs").select("*").eq("user_id",n).order("date_earned",{ascending:!1});if(t)throw t;return(e||[]).map(gt)},checkCompOffTableExists:async()=>{const{error:n}=await Me.from("comp_off_logs").select("id").limit(1);if(n)throw n},getAllSiteAssets:async()=>Promise.resolve({}),updateSiteAssets:async(n,e)=>(console.log("Mock updating assets for site",n,e),Promise.resolve()),getBackOfficeIdSeries:async()=>{const{data:n,error:e}=await Me.from("back_office_id_series").select("*");if(e)throw e;return(n||[]).map(gt)},updateBackOfficeIdSeries:async n=>{const{error:e}=await Me.from("back_office_id_series").upsert(fn(n),{onConflict:"id"});if(e)throw e},updateSiteStaffDesignations:async n=>{const{error:e}=await Me.from("site_staff_designations").upsert(fn(n),{onConflict:"id"});if(e)throw e},getAllSiteIssuedTools:async()=>Promise.resolve({}),getToolsList:async()=>Promise.resolve({}),updateSiteIssuedTools:async(n,e)=>{console.log("Mock updating tools for site",n,e)},getAllSiteGentsUniforms:async()=>Promise.resolve({}),getMasterGentsUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteGentsUniforms:async(n,e)=>{console.log("Mock updating gents uniforms for",n,e)},getAllSiteUniformDetails:async()=>Promise.resolve({}),updateSiteUniformDetails:async(n,e)=>{console.log("Mock updating uniform details for",n,e)},getAllSiteLadiesUniforms:async()=>Promise.resolve({}),getMasterLadiesUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteLadiesUniforms:async(n,e)=>{console.log("Mock updating ladies uniforms for",n,e)},getUniformRequests:async()=>{const{data:n,error:e}=await Me.from("uniform_requests").select("*");if(e)throw e;return(n||[]).map(gt)},submitUniformRequest:async n=>{const{data:e,error:t}=await Me.from("uniform_requests").insert(fn(n)).select().single();if(t)throw t;return gt(e)},updateUniformRequest:async n=>{const{data:e,error:t}=await Me.from("uniform_requests").update(fn(n)).eq("id",n.id).select().single();if(t)throw t;return gt(e)},deleteUniformRequest:async n=>{const{error:e}=await Me.from("uniform_requests").delete().eq("id",n);if(e)throw e},getInvoiceStatuses:async n=>(console.log("Mock fetching invoice statuses for",n),Promise.resolve({})),getInvoiceSummaryData:async(n,e)=>(console.log("Mock fetching invoice data for",n,e),Promise.resolve({siteName:"Mock Site",siteAddress:"Mock Address",invoiceNumber:"INV-001",invoiceDate:"2023-01-31",statementMonth:"January-2023",lineItems:[]})),getSupportTickets:async()=>{const{data:n,error:e}=await Me.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))");if(e)throw e;return(n||[]).map(gt)},getSupportTicketById:async n=>{const{data:e,error:t}=await Me.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))").eq("id",n).single();if(t)throw t;return gt(e)},createSupportTicket:async n=>{const e=n.attachment;if(e&&e.file instanceof File)try{const{path:s}=await ue.uploadDocument(e.file,AM);n.attachment={name:e.name,type:e.type,size:e.size,path:s}}catch(s){console.error("Failed to upload support ticket attachment:",s),delete n.attachment}const{data:t,error:r}=await Me.from("support_tickets").insert(fn(n)).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(r)throw r;return gt(t)},updateSupportTicket:async(n,e)=>{const t=e.attachment;if(t&&t.file instanceof File)try{const{path:a}=await ue.uploadDocument(t.file,AM);e.attachment={name:t.name,type:t.type,size:t.size,path:a}}catch(a){console.error("Failed to upload updated support ticket attachment:",a),delete e.attachment}const{data:r,error:s}=await Me.from("support_tickets").update(fn(e)).eq("id",n).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(s)throw s;return gt(r)},addTicketPost:async(n,e)=>{const{data:t,error:r}=await Me.from("ticket_posts").insert(fn(e)).select("*, comments:ticket_comments(*)").single();if(r)throw r;return gt(t)},togglePostLike:async(n,e)=>{const{data:t,error:r}=await Me.from("ticket_posts").select("likes").eq("id",n).single();if(r)throw r;const s=t.likes||[],a=s.includes(e)?s.filter(l=>l!==e):[...s,e],{error:o}=await Me.from("ticket_posts").update({likes:a}).eq("id",n);if(o)throw o},addPostComment:async(n,e)=>{const{data:t,error:r}=await Me.from("ticket_comments").insert(fn(e)).select().single();if(r)throw r;return gt(t)},getVerificationCostBreakdown:async(n,e)=>{const{data:t,error:r}=await Me.from("onboarding_submissions").select("id, employee_id, personal, enrollment_date, verification_usage").gte("enrollment_date",n).lte("enrollment_date",e);if(r)throw r;return(t||[]).map(s=>{const a=gt(s);return{id:a.id,employeeId:a.personal.employeeId,employeeName:`${a.personal.firstName} ${a.personal.lastName}`,enrollmentDate:a.enrollmentDate,totalCost:0,breakdown:a.verificationUsage||[]}})},generatePdf:async(n,e)=>{try{const t=(await cm(async()=>{const{default:r}=await import("./html2pdf-DYPOspIo.js").then(s=>s.h);return{default:r}},[],import.meta.url)).default;await t().set(e).from(n).save()}catch(t){throw console.error("PDF generation failed:",t),t}},batchResolveAddresses:async n=>{if(n.length===0)return{};const e=c=>parseFloat(c.toFixed(6)),t=Array.from(new Set(n.map(c=>`${e(c.lat)},${e(c.lon)}`))).map(c=>{const[d,h]=c.split(",").map(Number);return{lat:d,lon:h}}),r={},s=[],a=t.map(c=>c.lat),{data:o,error:l}=await Me.from("location_cache").select("*").in("latitude",a);!l&&o&&o.forEach(c=>{const d=e(parseFloat(c.latitude)),h=e(parseFloat(c.longitude)),p=`${d},${h}`;t.some(x=>e(x.lat)===d&&e(x.lon)===h)&&(r[p]=c.address)}),t.forEach(c=>{const d=`${e(c.lat)},${e(c.lon)}`;r[d]||s.push(c)}),console.log("Geocoding API: Found",Object.keys(r).length,"cached,",s.length,"missing");for(const c of s)try{const d=await cm(()=>Promise.resolve().then(()=>DK),void 0,import.meta.url).then(p=>p.reverseGeocode(c.lat,c.lon)),h=`${e(c.lat)},${e(c.lon)}`;r[h]=d,await Me.from("location_cache").insert({latitude:e(c.lat),longitude:e(c.lon),address:d}),console.log("Geocoding API: Fetched and cached",h,"->",d),await new Promise(p=>setTimeout(p,1e3))}catch(d){console.error(`Failed to resolve address for ${c.lat},${c.lon}`,d);const h=`${e(c.lat)},${e(c.lon)}`;r[h]=`${c.lat.toFixed(4)}, ${c.lon.toFixed(4)}`}return r},sendSecurityAlert:async(n,e,t,r)=>{const{data:s,error:a}=await Me.from("users").select("reporting_manager_id").eq("id",n).single();if(a||!s?.reporting_manager_id){console.warn("Could not find reporting manager for security alert");return}const o=t==="developer_mode"?"attempted to access the application with Developer Mode enabled":"attempted to access the application with Location Spoofing detected",l=r?` using device: ${r}`:"";await ue.createNotification({userId:s.reporting_manager_id,title:" Security Alert",message:`${e} ${o}${l}. Access was blocked for security reasons.`,type:"security",link:"/user-management"})},sendDeviceChangeAlert:async(n,e,t,r)=>{const{data:s,error:a}=await Me.from("users").select("reporting_manager_id").eq("id",n).single();if(a||!s?.reporting_manager_id){console.warn("Could not find reporting manager for device change alert");return}await ue.createNotification({userId:s.reporting_manager_id,title:" Device Change Detected",message:`${e} logged in from a new device. Previous device: ${t}, New device: ${r}`,type:"info",link:"/user-management"})}},EK=(n,e,t="Operation timed out")=>{const r=new Promise((s,a)=>{setTimeout(()=>a(new Error(t)),e)});return Promise.race([n,r])};function kS(n,e,t,r){const s=h=>h*Math.PI/180,o=s(t-n),l=s(r-e),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(s(n))*Math.cos(s(t))*Math.sin(l/2)*Math.sin(l/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}async function hm(n,e){const t=`${n.toFixed(4)}, ${e.toFixed(4)}`;try{const r=`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${n}&lon=${e}&zoom=16&addressdetails=1`,s=await fetch(r);if(!s.ok)return t;const a=await s.json();if(a.display_name)return a.display_name;if(a.address){const{road:o,suburb:l,city:c,village:d,town:h,state:p,country:x}=a.address;return[o,l,c||d||h,p,x].filter(Boolean).join(", ")}return t}catch(r){return console.warn("Reverse geocode failed:",r),t}}function iy(n=50,e=1e4){return new Promise((t,r)=>{if(!("geolocation"in navigator))return r(new Error("Geolocation is not supported by this browser."));let s=null;const a=setTimeout(()=>{s?(navigator.geolocation.clearWatch(o),t(s)):(navigator.geolocation.clearWatch(o),r(new Error("Unable to acquire a precise position within the timeout period")))},e),o=navigator.geolocation.watchPosition(l=>{(!s||l.coords.accuracy<s.coords.accuracy)&&(s=l),l.coords.accuracy<=n&&(clearTimeout(a),navigator.geolocation.clearWatch(o),t(l))},l=>{clearTimeout(a),navigator.geolocation.clearWatch(o),r(l)},{enableHighAccuracy:!0,maximumAge:0})})}const DK=Object.freeze(Object.defineProperty({__proto__:null,calculateDistanceMeters:kS,getPrecisePosition:iy,reverseGeocode:hm},Symbol.toStringTag,{value:"Module"})),Bp=n=>{const e=n.toLowerCase();return e.includes("timed out")?"The request took too long. Please check your internet connection and try again.":e.includes("invalid api key")||e.includes("configuration")?"System configuration error. Please contact support.":e.includes("failed to fetch")||e.includes("network")?"Unable to connect. Please check your internet connection.":e.includes("invalid login credentials")?'Incorrect email or password. If you use Google Sign-In, please click "Sign in with Google".':e.includes("user already registered")||e.includes("already exists")?"This email is already registered. Please sign in.":e.includes("email not confirmed")?"Please verify your email address. Check your inbox for the confirmation link.":e.includes("too many requests")||e.includes("rate limit")?"Too many attempts. Please wait a few minutes before trying again.":e.includes("weak password")?"Password is too weak. Please use a stronger password.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again or contact support.")},hb=()=>{const n=new Date().getHours();return n<12?"Good Morning":n<17?"Good Afternoon":"Good Evening"},jt=Aa()((n,e)=>({user:null,isInitialized:!1,isCheckedIn:!1,isAttendanceLoading:!0,lastCheckInTime:null,lastCheckOutTime:null,error:null,loading:!1,isLoginAnimationPending:!1,setLoginAnimationPending:t=>n({isLoginAnimationPending:t}),setUser:t=>n({user:t,error:null,loading:!1}),setInitialized:t=>n({isInitialized:t}),setLoading:t=>n({loading:t}),resetAttendance:()=>n({isCheckedIn:!1,isAttendanceLoading:!1,lastCheckInTime:null,lastCheckOutTime:null,isLoginAnimationPending:!1}),setError:t=>n({error:t}),loginWithEmail:async(t,r,s)=>{n({error:null,loading:!0});try{await ja.signOut()}catch{}try{const{data:a,error:o}=await EK(ja.signInWithPassword(t,r),2e4,"Login attempt timed out. Please check your network connection.").catch(c=>({data:{user:null,session:null},error:{message:c.message}}));if(o||!a.user||!a.session){const c=Bp(o?.message||"Invalid login credentials");return n({error:c,loading:!1}),{error:{message:c}}}s?(localStorage.setItem("rememberedEmail",t),localStorage.setItem("supabase.auth.rememberMe",a.session.refresh_token)):(localStorage.removeItem("rememberedEmail"),localStorage.removeItem("supabase.auth.rememberMe"));const l=await ja.getAppUserProfile(a.user);if(l){n({user:l,error:null,loading:!1});try{const c=`greetingSent_${l.id}`,d=hb();await ue.createNotification({userId:l.id,message:`${d}, ${l.name||"there"}! Welcome back to Paradigm Services.`,type:"greeting"})}catch(c){console.error("Failed to send login greeting notification",c)}return{error:null}}else{await ja.signOut();const c="Login successful, but failed to retrieve user profile. Please try again.";return n({user:null,error:c,loading:!1}),{error:{message:c}}}}catch(a){console.error("Unexpected error during login flow:",a);const o=Bp("Unexpected error during login flow");return n({user:null,error:o,loading:!1}),{error:{message:o}}}},signUp:async(t,r,s)=>{n({error:null,loading:!0});const{error:a}=await ja.signUpWithPassword({email:r,password:s,options:{data:{name:t}}});if(a){const o=Bp(a.message);return n({error:o,loading:!1}),{error:{message:o}}}return n({loading:!1}),{error:null}},loginWithGoogle:async()=>{n({error:null,loading:!0});const{error:t}=await ja.signInWithGoogle();if(t){const r=Bp(t.message);return n({error:r,loading:!1}),{error:{message:r}}}return n({loading:!1}),{error:null}},sendPasswordReset:async t=>{const{error:r}=await ja.resetPasswordForEmail(t);return r?{error:{message:r.message}}:{error:null}},logout:async()=>{const t=e().user;if(t)try{const r=hb(),s=new Date().getHours()>=20?"Good Night":r;await ue.createNotification({userId:t.id,message:`${s}, ${t.name||"there"}! Thanks for your hard work today.`,type:"greeting"})}catch(r){console.error("Failed to send logout farewell notification",r)}localStorage.removeItem("supabase.auth.rememberMe"),await ja.signOut()},updateUserProfile:t=>n(r=>({user:r.user?{...r.user,...t}:null})),checkAttendanceStatus:async()=>{const{user:t}=e();if(!t){n({isAttendanceLoading:!1});return}n({isAttendanceLoading:!0});try{const r=new Date,s=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0).toISOString(),a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999).toISOString(),o=await ue.getAttendanceEvents(t.id,s,a);if(o.length===0){n({isCheckedIn:!1,lastCheckInTime:null,lastCheckOutTime:null,isAttendanceLoading:!1});return}o.sort((h,p)=>new Date(h.timestamp).getTime()-new Date(p.timestamp).getTime());const l=o.find(h=>h.type==="check-in"),c=[...o].reverse().find(h=>h.type==="check-out"),d=o[o.length-1];n({isCheckedIn:d?.type==="check-in",lastCheckInTime:l?l.timestamp:null,lastCheckOutTime:c?c.timestamp:null,isAttendanceLoading:!1})}catch(r){console.error("Failed to check attendance status:",r),n({isAttendanceLoading:!1})}},toggleCheckInStatus:async()=>{const{user:t,isCheckedIn:r}=e();if(!t)return{success:!1,message:"User not found"};const s=r?"check-out":"check-in";try{let a=null;try{a=await iy()}catch{}(!a||!a.coords)&&(a=await new Promise(p=>{navigator.geolocation.getCurrentPosition(x=>p(x),()=>p(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}));const o=async(p,x,v)=>{await ue.addAttendanceEvent({userId:t.id,timestamp:new Date().toISOString(),type:s,latitude:p,longitude:x,locationId:v}),await e().checkAttendanceStatus();try{const w=hb(),_=s==="check-in"?"checking in":"checking out";await ue.createNotification({userId:t.id,message:`${w}, ${t.name||"there"}! Thanks for ${_}.`,type:"greeting"})}catch(w){console.warn("Failed to send user attendance notification",w)}try{const w=await ue.getAttendanceSettings();if((["admin","hr","finance","developer"].includes(t.role)?w?.office:w?.field)?.enableAttendanceNotifications){const T=[];t.reportingManagerId&&T.push({id:t.reportingManagerId});const P=await ue.getNearbyUsers();for(const I of P)T.find(q=>q.id===I.id)||T.push({id:I.id});const D=t.name||"An employee",M=v?"":p&&x?` at ${p.toFixed(4)}, ${x.toFixed(4)}`:"",O=`${D} ${s.replace("-"," ")}${M}`;await Promise.all(T.map(I=>ue.createNotification({userId:I.id,message:O,type:"greeting"})))}}catch(w){console.warn("Failed to create manager notifications:",w)}return{success:!0,message:`Successfully ${s.replace("-"," ")}!`}};if(!a||!a.coords)return await o(void 0,void 0,null);const{latitude:l,longitude:c,accuracy:d}=a.coords;if(typeof d=="number"&&d>1e3)return await o(l,c,null);let h=null;try{const p=await ue.getUserLocations(t.id);for(const x of p)if(kS(l,c,x.latitude,x.longitude)<=x.radius){h=x.id;break}if(!h){const x=await ue.getLocations();for(const v of x)if(kS(l,c,v.latitude,v.longitude)<=v.radius){h=v.id;try{await ue.assignLocationToUser(t.id,v.id)}catch(_){console.warn("Failed to autoassign location to user:",_)}break}}}catch(p){console.warn("Geofencing check failed:",p)}if(!h)try{let p=null;try{p=await hm(l,c)}catch(w){console.warn("Reverse geocode failed for new location:",w)}const v=await ue.createLocation({name:p||null,latitude:l,longitude:c,radius:100,address:p||null,createdBy:t.id});try{await ue.assignLocationToUser(t.id,v.id)}catch(w){console.warn("Failed to autoassign new location to user:",w)}h=v.id}catch(p){console.warn("Failed to create a new geofence location:",p),h=null}return await o(l,c,h)}catch(a){return console.error("Error during attendance update:",a),{success:!1,message:"Failed to update attendance."}}}})),OK={};function yu(n,e){let t;try{t=n()}catch{return}return{getItem:s=>{var a;const o=c=>c===null?null:JSON.parse(c,void 0),l=(a=t.getItem(s))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(s,a)=>t.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>t.removeItem(s)}}const mm=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return mm(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return mm(r)(t)}}}},IK=(n,e)=>(t,r,s)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:j=>j,version:0,merge:(j,T)=>({...T,...j}),...e},o=!1;const l=new Set,c=new Set;let d;try{d=a.getStorage()}catch{}if(!d)return n((...j)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...j)},r,s);const h=mm(a.serialize),p=()=>{const j=a.partialize({...r()});let T;const P=h({state:j,version:a.version}).then(D=>d.setItem(a.name,D)).catch(D=>{T=D});if(T)throw T;return P},x=s.setState;s.setState=(j,T)=>{x(j,T),p()};const v=n((...j)=>{t(...j),p()},r,s);let w;const _=()=>{var j;if(!d)return;o=!1,l.forEach(P=>P(r()));const T=((j=a.onRehydrateStorage)==null?void 0:j.call(a,r()))||void 0;return mm(d.getItem.bind(d))(a.name).then(P=>{if(P)return a.deserialize(P)}).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==a.version){if(a.migrate)return a.migrate(P.state,P.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return P.state}).then(P=>{var D;return w=a.merge(P,(D=r())!=null?D:v),t(w,!0),p()}).then(()=>{T?.(w,void 0),o=!0,c.forEach(P=>P(w))}).catch(P=>{T?.(void 0,P)})};return s.persist={setOptions:j=>{a={...a,...j},j.getStorage&&(d=j.getStorage())},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:j=>(l.add(j),()=>{l.delete(j)}),onFinishHydration:j=>(c.add(j),()=>{c.delete(j)})},_(),w||v},AK=(n,e)=>(t,r,s)=>{let a={storage:yu(()=>localStorage),partialize:_=>_,version:0,merge:(_,j)=>({...j,..._}),...e},o=!1;const l=new Set,c=new Set;let d=a.storage;if(!d)return n((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(..._)},r,s);const h=()=>{const _=a.partialize({...r()});return d.setItem(a.name,{state:_,version:a.version})},p=s.setState;s.setState=(_,j)=>{p(_,j),h()};const x=n((..._)=>{t(..._),h()},r,s);s.getInitialState=()=>x;let v;const w=()=>{var _,j;if(!d)return;o=!1,l.forEach(P=>{var D;return P((D=r())!=null?D:x)});const T=((j=a.onRehydrateStorage)==null?void 0:j.call(a,(_=r())!=null?_:x))||void 0;return mm(d.getItem.bind(d))(a.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==a.version){if(a.migrate)return[!0,a.migrate(P.state,P.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var D;const[M,O]=P;if(v=a.merge(O,(D=r())!=null?D:x),t(v,!0),M)return h()}).then(()=>{T?.(v,void 0),v=r(),o=!0,c.forEach(P=>P(v))}).catch(P=>{T?.(void 0,P)})};return s.persist={setOptions:_=>{a={...a,..._},_.storage&&(d=_.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:_=>(l.add(_),()=>{l.delete(_)}),onFinishHydration:_=>(c.add(_),()=>{c.delete(_)})},a.skipHydration||w(),v||x},RK=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((OK?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),IK(n,e)):AK(n,e),Vf=RK,Jc=Aa(Vf(n=>({theme:"light",isAutomatic:!0,setTheme:e=>n({theme:e,isAutomatic:!1}),setAutomatic:e=>n({isAutomatic:e}),_setThemeInternal:e=>n({theme:e})}),{name:"paradigm-app-theme",storage:yu(()=>localStorage)})),LK={esiCtcThreshold:21e3,enforceManpowerLimit:!1,manpowerLimitRule:"warn",allowSalaryEdit:!1,salaryThreshold:21e3,defaultPolicySingle:"1L",defaultPolicyMarried:"2L",enableEsiRule:!1,enableGmcRule:!1,enforceFamilyValidation:!0,rulesByDesignation:{}},Qc=Aa()(n=>({...LK,init:e=>{e&&n(e)},updateRules:e=>n(t=>({...t,...e}))})),FK={unverified:[],admin:["view_all_submissions","manage_users","manage_sites","view_entity_management","view_developer_settings","view_operations_dashboard","view_site_dashboard","create_enrollment","manage_roles_and_permissions","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_approval_workflow","download_attendance_report","manage_tasks","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","view_field_officer_tracking","manage_modules","access_support_desk"],hr:["view_all_submissions","manage_users","manage_sites","view_entity_management","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","download_attendance_report","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","access_support_desk"],finance:["view_invoice_summary","view_verification_costing","view_own_attendance","apply_for_leave"],developer:["view_developer_settings"],operation_manager:["view_operations_dashboard","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_tasks","access_support_desk"],site_manager:["view_site_dashboard","create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"],field_officer:["create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"]},Ji=Aa(Vf((n,e)=>({permissions:FK,initRoles:t=>{if(!t)return;const s={...e().permissions};let a=!1;t.forEach(o=>{s[o.id]||(s[o.id]=[],a=!0)}),a&&n({permissions:s})},addRolePermissionEntry:t=>{n(r=>({permissions:{...r.permissions,[t.id]:[]}}))},removeRolePermissionEntry:t=>{n(r=>{const s={...r.permissions};return delete s[t],{permissions:s}})},renameRolePermissionEntry:(t,r)=>{n(s=>{const a={...s.permissions};return a[t]&&(a[r]=a[t],delete a[t]),{permissions:a}})},setRolePermissions:(t,r)=>{n(s=>({permissions:{...s.permissions,[t]:r}}))}}),{name:"paradigm_app_permissions_v2",storage:yu(()=>localStorage)})),qK={enablePincodeVerification:!0},zK={office:{minimumHoursFullDay:8,minimumHoursHalfDay:4,annualEarnedLeaves:5,annualSickLeaves:12,monthlyFloatingLeaves:1,annualCompOffLeaves:5,enableAttendanceNotifications:!1,sickLeaveCertificateThreshold:2},field:{minimumHoursFullDay:9,minimumHoursHalfDay:5,annualEarnedLeaves:10,annualSickLeaves:10,monthlyFloatingLeaves:0,annualCompOffLeaves:10,enableAttendanceNotifications:!0,sickLeaveCertificateThreshold:3}},UK={applicability:"Optional - Opt-in Default",optInDisclaimer:"Please note that currently the GMC facility covers only spouse and two children. If you would like to continue, please select below relationships and submit.",coverageDetails:"Spouse and two children",optOutDisclaimer:"Please note that you are opting out of the GMC Facility. You will have to submit a declaration to the company towards the same along with proof of your existing insurance.",requireAlternateInsurance:!0,collectProvider:!0,collectStartDate:!0,collectEndDate:!0,collectExtentOfCover:!0},VK={enabled:!0,clientId:"",clientSecret:""},BK={enabled:!0},WK={enabled:!0},$K={email:{enabled:!1}},HK=[{id:"cost_1",name:"Profile Picture",cost:0},{id:"cost_2",name:"Mobile to Form Prefill",cost:7},{id:"cost_3",name:"KYC OCR (Plus)",cost:1.5},{id:"cost_4",name:"Aadhaar Mobile Link",cost:2.5},{id:"cost_5",name:"EPF UAN Lookup",cost:2.5},{id:"cost_6",name:"Cheque OCR",cost:3},{id:"cost_7",name:"Bank AC Verification Advanced",cost:2.25},{id:"cost_8",name:"PAN Profile Detailed",cost:5},{id:"cost_9",name:"Aadhaar Verification",cost:1.75},{id:"cost_10",name:"Voter ID OCR",cost:1.5},{id:"cost_11",name:"Driving License OCR",cost:1.5},{id:"cost_12",name:"Education Certificate OCR",cost:2},{id:"cost_13",name:"Experience/Salary Slip OCR",cost:2},{id:"cost_14",name:"ESI Card OCR",cost:1.5}],YK={enableProvisionalSites:!1},gi=Aa()(Vf(n=>({address:qK,attendance:zK,officeHolidays:[],fieldHolidays:[],recurringHolidays:[],gmcPolicy:UK,perfiosApi:VK,geminiApi:BK,otp:WK,notifications:$K,verificationCosts:HK,siteManagement:YK,initSettings:e=>{if(e){const{holidays:t,attendanceSettings:r,recurringHolidays:s}=e,a=t.filter(l=>l.type==="office"),o=t.filter(l=>l.type==="field");n({officeHolidays:a,fieldHolidays:o,attendance:r,recurringHolidays:s||[]})}},updateAddressSettings:e=>n(t=>({address:{...t.address,...e}})),updateAttendanceSettings:e=>n({attendance:e}),updateGmcPolicySettings:e=>n(t=>({gmcPolicy:{...t.gmcPolicy,...e}})),updatePerfiosApiSettings:e=>n(t=>({perfiosApi:{...t.perfiosApi,...e}})),updateGeminiApiSettings:e=>n(t=>({geminiApi:{...t.geminiApi,...e}})),updateOtpSettings:e=>n(t=>({otp:{...t.otp,...e}})),updateNotificationSettings:e=>n(t=>({notifications:{...t.notifications,...e,email:{...t.notifications.email,...e.email}}})),updateVerificationCosts:e=>n({verificationCosts:e}),updateSiteManagementSettings:e=>n(t=>({siteManagement:{...t.siteManagement,...e}})),addHoliday:async(e,t)=>{const r=await ue.addHoliday({...t,type:e});n(s=>{const a=e==="office"?"officeHolidays":"fieldHolidays",o=[...s[a],r].sort((l,c)=>new Date(l.date).getTime()-new Date(c.date).getTime());return{[a]:o}})},removeHoliday:async(e,t)=>{await ue.removeHoliday(t),n(r=>{const s=e==="office"?"officeHolidays":"fieldHolidays";return{[s]:r[s].filter(a=>a.id!==t)}})},addRecurringHoliday:async e=>{const t=await ue.addRecurringHoliday(e);n(r=>({recurringHolidays:[...r.recurringHolidays,t]}))},removeRecurringHoliday:async e=>{await ue.deleteRecurringHoliday(e),n(t=>({recurringHolidays:t.recurringHolidays.filter(r=>r.id!==e)}))}}),{name:"paradigm_app_settings",storage:yu(()=>localStorage)})),Ft=n=>{const[e,t]=E.useState(window.matchMedia(n).matches);return E.useEffect(()=>{const r=window.matchMedia(n),s=()=>t(r.matches);try{r.addEventListener("change",s)}catch{r.addListener(s)}return()=>{try{r.removeEventListener("change",s)}catch{r.removeListener(s)}}},[n]),e},RM=()=>({id:`draft_${Date.now()}`,status:"draft",enrollmentDate:new Date().toISOString().split("T")[0],personal:{employeeId:`PARA-${Math.floor(1e3+Math.random()*9e3)}`,firstName:"",lastName:"",dob:"",gender:"",maritalStatus:"",bloodGroup:"",mobile:"",alternateMobile:"",email:"",emergencyContactName:"",emergencyContactNumber:"",relationship:"",salary:null,verifiedStatus:{}},address:{present:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},permanent:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},sameAsPresent:!0},family:[],education:[],bank:{accountHolderName:"",accountNumber:"",confirmAccountNumber:"",ifscCode:"",bankName:"",branchName:"",verifiedStatus:{}},uan:{hasPreviousPf:!1,verifiedStatus:{},salarySlip:null},esi:{hasEsi:!1,verifiedStatus:{}},gmc:{isOptedIn:null,policyAmount:"",nomineeName:"",nomineeRelation:"",selectedSpouseId:"",selectedChildIds:[],gmcPolicyCopy:null,declarationAccepted:!1},organization:{designation:"",department:"",reportingManager:"",organizationId:"",organizationName:"",joiningDate:$e(new Date,"yyyy-MM-dd"),workType:"Full-time",defaultSalary:null},uniforms:[],biometrics:{signatureImage:null,fingerprints:{leftThumb:null,leftIndex:null,leftMiddle:null,leftRing:null,leftLittle:null,rightThumb:null,rightIndex:null,rightMiddle:null,rightRing:null,rightLittle:null}},salaryChangeRequest:null,requiresManualVerification:!1,formsGenerated:!1,verificationUsage:[]}),$n=Aa(n=>({data:RM(),setData:e=>n({data:e}),updatePersonal:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,...e}}})),setPersonalVerifiedStatus:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,verifiedStatus:{...t.data.personal.verifiedStatus,...e}}}})),updateAddress:e=>n(t=>({data:{...t.data,address:{...t.data.address,...e}}})),setAddressVerifiedStatus:(e,t)=>n(r=>({data:{...r.data,address:{...r.data.address,[e]:{...r.data.address[e],verifiedStatus:{...r.data.address[e].verifiedStatus,...t}}}}})),updateFamily:e=>n(t=>({data:{...t.data,family:e}})),updateEducation:e=>n(t=>({data:{...t.data,education:e}})),updateBank:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,...e}}})),setBankVerifiedStatus:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,verifiedStatus:{...t.data.bank.verifiedStatus,...e}}}})),updateUan:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,...e}}})),setUanVerifiedStatus:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,verifiedStatus:{...t.data.uan.verifiedStatus,...e}}}})),updateEsi:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,...e}}})),setEsiVerifiedStatus:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,verifiedStatus:{...t.data.esi.verifiedStatus,...e}}}})),updateGmc:e=>n(t=>({data:{...t.data,gmc:{...t.data.gmc,...e}}})),updateOrganization:e=>n(t=>({data:{...t.data,organization:{...t.data.organization,...e}}})),updateUniforms:e=>n(t=>({data:{...t.data,uniforms:e}})),updateBiometrics:e=>n(t=>({data:{...t.data,biometrics:{...t.data.biometrics,...e}}})),setSalaryChangeRequest:e=>n(t=>({data:{...t.data,salaryChangeRequest:e}})),setRequiresManualVerification:e=>n(t=>({data:{...t.data,requiresManualVerification:e}})),setFormsGenerated:e=>n(t=>({data:{...t.data,formsGenerated:e}})),logVerificationUsage:e=>n(t=>{const r=JSON.parse(JSON.stringify(t.data.verificationUsage||[])),s=r.find(a=>a.name===e);return s?s.count+=1:r.push({name:e,count:1}),{data:{...t.data,verificationUsage:r}}}),reset:()=>n({data:RM()}),addFamilyMember:()=>n(e=>({data:{...e.data,family:[...e.data.family,{id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""}]}})),updateFamilyMember:(e,t)=>n(r=>({data:{...r.data,family:r.data.family.map(s=>s.id===e?{...s,...t}:s)}})),removeFamilyMember:e=>n(t=>({data:{...t.data,family:t.data.family.filter(r=>r.id!==e)}})),addEducationRecord:()=>n(e=>({data:{...e.data,education:[...e.data.education,{id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""}]}})),updateEducationRecord:(e,t)=>n(r=>({data:{...r.data,education:r.data.education.map(s=>s.id===e?{...s,...t}:s)}})),removeEducationRecord:e=>n(t=>({data:{...t.data,education:t.data.education.filter(r=>r.id!==e)}})),addOrUpdateEmergencyContactAsFamilyMember:()=>n(e=>{const{personal:t,family:r}=e.data,{emergencyContactName:s,emergencyContactNumber:a,relationship:o}=t;if(s&&["Spouse","Child","Father","Mother"].includes(o)){const c=r.find(d=>d.name.toLowerCase()===s.toLowerCase()&&d.relation===o);if(c){if(c.phone!==a){const d=r.map(h=>h.id===c.id?{...h,phone:a}:h);return{data:{...e.data,family:d}}}}else{const d={id:`fam_emergency_${Date.now()}`,name:s,relation:o,phone:a,dob:"",gender:"",dependent:!1,idProof:null,occupation:""};return{data:{...e.data,family:[...r,d]}}}}return e})}));const GK=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),QF=(...n)=>n.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");var ZK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const KK=E.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:a,iconNode:o,...l},c)=>E.createElement("svg",{ref:c,...ZK,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:QF("lucide",s),...l},[...o.map(([d,h])=>E.createElement(d,h)),...Array.isArray(a)?a:[a]]));const Ae=(n,e)=>{const t=E.forwardRef(({className:r,...s},a)=>E.createElement(KK,{ref:a,iconNode:e,className:QF(`lucide-${GK(n)}`,r),...s}));return t.displayName=`${n}`,t};const Wh=Ae("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const JK=Ae("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);const Ra=Ae("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const QK=Ae("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const XK=Ae("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const eJ=Ae("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);const tJ=Ae("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const nJ=Ae("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);const Pf=Ae("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);const rJ=Ae("BriefcaseBusiness",[["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2",key:"1ksdt3"}],["path",{d:"M22 13a18.15 18.15 0 0 1-20 0",key:"12hx5q"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const XF=Ae("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const Hi=Ae("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const sJ=Ae("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);const iJ=Ae("CalendarCheck2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]]);const aJ=Ae("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);const oJ=Ae("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);const lJ=Ae("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);const Pa=Ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const SC=Ae("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);const cJ=Ae("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);const _l=Ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const vu=Ae("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const ay=Ae("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Mf=Ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const dJ=Ae("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const uJ=Ae("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);const fJ=Ae("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);const e3=Ae("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const Yi=Ae("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const LM=Ae("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const FM=Ae("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const hJ=Ae("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const pm=Ae("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const t3=Ae("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);const n3=Ae("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);const Bc=Ae("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const mJ=Ae("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);const r3=Ae("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);const pJ=Ae("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);const PS=Ae("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);const yi=Ae("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);const gJ=Ae("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);const Sl=Ae("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const xJ=Ae("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);const yJ=Ae("FileDigit",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["rect",{width:"4",height:"6",x:"2",y:"12",rx:"2",key:"jm304g"}],["path",{d:"M10 12h2v6",key:"12zw74"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);const s3=Ae("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);const MS=Ae("FilePenLine",[["path",{d:"m18 5-3-3H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"h0fsxq"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.4 9.6a2 2 0 1 1 3 3L17 17l-4 1 1-4Z",key:"dyo8mm"}]]);const ls=Ae("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const vJ=Ae("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);const bJ=Ae("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);const wJ=Ae("Files",[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]]);const i3=Ae("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);const qM=Ae("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);const _J=Ae("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);const jJ=Ae("GitPullRequest",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]]);const a3=Ae("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const NJ=Ae("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6h0",key:"1uc279"}],["path",{d:"M14 6h0a6 6 0 0 1 6 6v3",key:"1j9mnm"}]]);const CC=Ae("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);const TC=Ae("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);const SJ=Ae("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);const o3=Ae("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const Cl=Ae("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);const iu=Ae("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const CJ=Ae("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);const l3=Ae("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);const Mx=Ae("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);const kC=Ae("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);const TJ=Ae("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);const _t=Ae("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const ES=Ae("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const Ex=Ae("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);const wo=Ae("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const c3=Ae("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);const Bf=Ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const Tl=Ae("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const d3=Ae("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);const DS=Ae("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const zM=Ae("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]);const gm=Ae("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);const kJ=Ae("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const PJ=Ae("MousePointerClick",[["path",{d:"m9 9 5 12 1.8-5.2L21 14Z",key:"1b76lo"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}]]);const MJ=Ae("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);const EJ=Ae("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);const DJ=Ae("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);const xm=Ae("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);const OJ=Ae("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);const Ef=Ae("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const u3=Ae("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);const IJ=Ae("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);const Bt=Ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const OS=Ae("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const AJ=Ae("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);const Ss=Ae("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const Ea=Ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const PC=Ae("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);const Dm=Ae("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const f3=Ae("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);const oy=Ae("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const h3=Ae("ShieldHalf",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 22V2",key:"zs6s6o"}]]);const RJ=Ae("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);const ym=Ae("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const Df=Ae("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);const LJ=Ae("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);const vm=Ae("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);const cr=Ae("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);const m3=Ae("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const p3=Ae("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);const g3=Ae("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);const x3=Ae("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const FJ=Ae("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);const qJ=Ae("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);const rn=Ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const UM=Ae("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const Da=Ae("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const Wc=Ae("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const hu=Ae("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);const $c=Ae("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const Dx=Ae("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);const kl=Ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const Gi=Ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const y3=Ae("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);const v3=Ae("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);const xi=Ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const zJ=Ae("ZapOff",[["path",{d:"M10.513 4.856 13.12 2.17a.5.5 0 0 1 .86.46l-1.377 4.317",key:"193nxd"}],["path",{d:"M15.656 10H20a1 1 0 0 1 .78 1.63l-1.72 1.773",key:"27a7lr"}],["path",{d:"M16.273 16.273 10.88 21.83a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4a1 1 0 0 1-.78-1.63l4.507-4.643",key:"1e0qe9"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const IS=Ae("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);const MC=Ae("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);const EC=Ae("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Wp="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",DC="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",OC=Aa(Vf(n=>({currentLogo:Wp,defaultLogo:Wp,setCurrentLogo:e=>n({currentLogo:e}),setDefaultLogo:()=>n(e=>({defaultLogo:e.currentLogo})),resetToDefault:()=>n(e=>({currentLogo:e.defaultLogo})),resetToOriginal:()=>n({currentLogo:Wp,defaultLogo:Wp})}),{name:"paradigm-app-logo",storage:yu(()=>localStorage)})),Zi=({className:n="",localPath:e})=>{const t=OC(s=>s.currentLogo),r=e||t;return i.jsx("img",{src:r,alt:"Paradigm Logo",className:`w-auto object-contain ${!n.includes("h-")&&"h-10"} ${n}`})},se=({children:n,className:e="",variant:t="primary",size:r="md",isLoading:s=!1,...a})=>{const l=`btn-${t}`,c=`btn-${r}`;return i.jsx("button",{className:`btn ${l} ${c} ${e}`,disabled:s||a.disabled,...a,children:s?i.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):n})},b3=Aa(Vf(n=>({autoClickOnHover:!0,autoScrollOnHover:!0,setAutoClickOnHover:e=>n({autoClickOnHover:e}),setAutoScrollOnHover:e=>n({autoScrollOnHover:e})}),{name:"paradigm-ui-settings",storage:yu(()=>localStorage)})),ly=Aa((n,e)=>({notifications:[],unreadCount:0,isLoading:!1,error:null,fetchNotifications:async()=>{const t=jt.getState().user;if(t){n({isLoading:!0,error:null});try{const r=await ue.getNotifications(t.id),s=r.filter(a=>!a.isRead).length;n({notifications:r,unreadCount:s,isLoading:!1})}catch{n({error:"Failed to fetch notifications.",isLoading:!1})}}},markAsRead:async t=>{const r=e().notifications.find(s=>s.id===t);if(!(r&&r.isRead))try{await ue.markNotificationAsRead(t),n(s=>({notifications:s.notifications.map(a=>a.id===t?{...a,isRead:!0}:a),unreadCount:Math.max(0,s.unreadCount-1)}))}catch(s){console.error("Failed to mark notification as read",s)}},markAllAsRead:async()=>{const t=jt.getState().user;if(t&&e().unreadCount!==0)try{await ue.markAllNotificationsAsRead(t.id),n(r=>({notifications:r.notifications.map(s=>({...s,isRead:!0})),unreadCount:0}))}catch(r){console.error("Failed to mark all notifications as read",r)}}})),UJ=({type:n})=>{const e={task_assigned:$c,task_escalated:Da,provisional_site_reminder:t3,security:ym,info:iu,greeting:x3},t={task_assigned:"text-blue-500 dark:text-blue-400",task_escalated:"text-orange-500 dark:text-orange-400",provisional_site_reminder:"text-purple-500 dark:text-purple-400",security:"text-red-500 dark:text-red-400",info:"text-blue-400 dark:text-blue-300",greeting:"text-yellow-500 dark:text-yellow-400"},r=e[n]||Pf;return i.jsx(r,{className:`h-5 w-5 ${t[n]}`})},VJ=({className:n=""})=>{const{notifications:e,unreadCount:t,markAsRead:r,markAllAsRead:s}=ly(),[a,o]=E.useState(!1),l=E.useRef(null),c=E.useRef(null),d=St();E.useEffect(()=>{const x=v=>{l.current&&!l.current.contains(v.target)&&c.current&&!c.current.contains(v.target)&&o(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const h=x=>{r(x.id),x.linkTo&&d(x.linkTo),o(!1)},p=()=>{s()};return i.jsxs("div",{className:`relative notification-bell ${n}`,children:[i.jsxs("button",{ref:c,onClick:()=>o(!a),className:"btn-icon relative p-2 rounded-full hover:bg-page text-muted","aria-label":`Notifications (${t} unread)`,children:[i.jsx(Pf,{className:"h-5 w-5"}),t>0&&i.jsx("span",{className:"notification-dot absolute top-0 right-0 block h-2.5 w-2.5 rounded-full bg-red-500"})]}),a&&i4.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[90] md:hidden",onClick:()=>o(!1)}),i.jsxs("div",{ref:l,className:"fixed inset-x-4 top-20 bottom-20 z-[100] flex flex-col bg-white dark:!bg-[#0d1f12] rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-800 md:absolute md:inset-auto md:top-16 md:right-4 md:mt-2 md:w-[400px] md:h-auto md:max-h-[600px] md:bottom-auto animate-in fade-in zoom-in-95 duration-200 overflow-hidden",style:{position:window.innerWidth>=768?"absolute":"fixed"},children:[i.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 dark:border-white/10 bg-gray-50 dark:!bg-[#0d1f12]",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-lg text-gray-900 dark:text-white",children:"Notifications"}),i.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:["You have ",t," unread messages"]})]}),i.jsx("div",{className:"flex items-center gap-2",children:t>0&&i.jsx("span",{onClick:p,className:"relative isolate overflow-hidden before:!content-none after:!content-none text-xs h-8 px-4 flex items-center justify-center rounded-3xl !bg-[#32CD32] hover:!bg-[#28a428] !text-[#0D1A0D] !font-bold cursor-pointer transition-colors",style:{backgroundImage:"none"},children:i.jsx("span",{className:"relative z-10",children:"Mark all read"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-white dark:!bg-[#0d1f12] dark:[color-scheme:dark]",children:e.slice(0,10).length>0?i.jsx("div",{className:"divide-y divide-gray-100 dark:divide-white/20",children:e.slice(0,10).map(x=>i.jsxs("div",{onClick:()=>h(x),className:`group flex items-start gap-4 p-5 cursor-pointer transition-all duration-200 ${x.isRead?"bg-white dark:!bg-[#0d1f12] hover:bg-gray-50 dark:hover:!bg-[#152b1b]":"bg-emerald-50 dark:!bg-[#0d1f12] hover:bg-emerald-100 dark:hover:!bg-[#152b1b]"}`,children:[i.jsx("div",{className:`flex-shrink-0 p-2.5 rounded-full ${x.isRead?"bg-gray-100 dark:bg-[#1a2e1a]":"bg-white dark:bg-[#1a2e1a] shadow-sm"}`,children:i.jsx(UJ,{type:x.type})}),i.jsxs("div",{className:"flex-1 min-w-0 pt-1",children:[i.jsx("p",{className:`text-sm font-medium leading-snug mb-1.5 ${x.isRead?"text-gray-600 dark:text-gray-300":"text-gray-900 dark:text-white"}`,children:x.message}),i.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 flex items-center gap-1",children:cu(new Date(x.createdAt),{addSuffix:!0})})]}),!x.isRead&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 mt-2.5 flex-shrink-0 shadow-[0_0_8px_rgba(16,185,129,0.5)]"})]},x.id))}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center p-8",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-[#1a2e1a] rounded-full flex items-center justify-center mb-4",children:i.jsx(Pf,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),i.jsx("h5",{className:"text-gray-900 dark:text-white font-medium mb-1",children:"No notifications"}),i.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"You're all caught up! Check back later."})]})})]})]}),document.body)]})},Yr=({isOpen:n,onClose:e,onConfirm:t,title:r,children:s,confirmButtonVariant:a="danger",confirmButtonText:o="Confirm",isConfirming:l=!1,isLoading:c})=>{if(!n)return null;const d=c!==void 0?c:l;return i.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black bg-opacity-50","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card shadow-card flex flex-col animate-fade-in-scale overflow-hidden w-full h-full sm:w-full sm:h-full sm:max-w-full sm:rounded-none md:w-auto md:h-auto md:max-w-md md:max-h-[90vh] md:rounded-xl",children:[i.jsx("div",{className:"flex-shrink-0 p-6 border-b border-border",children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:r})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsx("div",{className:"text-sm text-muted",children:s})}),i.jsx("div",{className:"flex-shrink-0 p-6 border-t border-border bg-card",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx(se,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),i.jsx(se,{onClick:t,variant:a,isLoading:d,children:o})]})})]})})},BJ=({className:n})=>i.jsxs("svg",{viewBox:"0 0 144 144",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:n,children:[i.jsx("circle",{cx:"72",cy:"72",r:"72",fill:"#F0EBE3"}),i.jsx("path",{d:"M109.5 144H34.5C34.5 119.464 51.18 99 72 99C92.82 99 109.5 119.464 109.5 144Z",fill:"white"}),i.jsx("path",{d:"M84 99C84 105.627 78.6274 111 72 111C65.3726 111 60 105.627 60 99H84Z",fill:"#E1C699"}),i.jsx("path",{d:"M96 87C96 70.4315 85.3726 57 72 57C58.6274 57 48 70.4315 48 87H96Z",fill:"#4A4A4A"}),i.jsx("rect",{x:"62",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"}),i.jsx("rect",{x:"77",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"})]}),mb=[BJ],$i=({className:n,photoUrl:e,seed:t})=>{const{user:r}=jt();if(e)return i.jsx("img",{src:e,alt:"Profile",className:`object-cover ${n||""}`});const s=t||r?.id;if(!s){const l=mb[0];return i.jsx(l,{className:`text-muted/60 ${n||""}`})}const a=s.charCodeAt(s.length-1)%mb.length,o=mb[a];return i.jsx(o,{className:n||""})},w3=({setIsMobileMenuOpen:n})=>{const{user:e,logout:t}=jt(),{permissions:r}=Ji(),s=St(),[a,o]=E.useState(!1),[l,c]=E.useState(!1),d=E.useRef(null),h=Ft("(max-width: 767px)");ds(),E.useEffect(()=>{const w=_=>{d.current&&!d.current.contains(_.target)&&o(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);const p=w=>w.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase()),x=()=>{n?.(!1),o(!1),c(!0)},v=async()=>{c(!1),await t(),s("/auth/login",{replace:!0})};return i.jsxs(i.Fragment,{children:[i.jsx(Yr,{isOpen:l,onClose:()=>c(!1),onConfirm:v,title:"Confirm Log Out",children:"Are you sure you want to log out?"}),i.jsx("header",{className:"sticky top-0 z-40 bg-[#041b0f] md:bg-gray-50/50 backdrop-blur-md border-b border-[#1f3d2b] md:border-gray-200/50 transition-all duration-200",style:{paddingTop:"env(safe-area-inset-top)"},children:i.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center h-16",children:[i.jsx("div",{className:"flex-1 flex justify-center md:justify-start min-w-0 px-2",children:h&&i.jsx("div",{className:"flex items-center justify-center bg-transparent p-2 border-0",children:i.jsx(Zi,{className:"border-0 h-[52px]"})})}),i.jsx("div",{className:"flex-none flex justify-end w-auto min-w-10",children:i.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[i.jsx(VJ,{}),!h&&e&&i.jsxs("div",{className:"relative",ref:d,children:[i.jsxs("button",{onClick:()=>o(!a),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-page transition-colors","aria-expanded":a,"aria-haspopup":"true",children:[i.jsx($i,{photoUrl:e.photoUrl,seed:e.id,className:"h-8 w-8 rounded-lg"}),i.jsxs("div",{className:"text-left hidden sm:block",children:[i.jsx("span",{className:"text-sm font-semibold",children:e.name}),i.jsx("span",{className:"text-xs text-muted block",children:p(e.role)})]}),i.jsx(vu,{className:"h-4 w-4 text-muted"})]}),a&&i.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-card rounded-xl shadow-card border border-border py-1 z-40 animate-fade-in-down",role:"menu",children:[i.jsxs(Ma,{to:"/profile",onClick:()=>o(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(kl,{className:"mr-2 h-4 w-4"}),"Profile"]}),e&&r[e.role]?.includes("apply_for_leave")&&i.jsxs(Ma,{to:"/leaves/dashboard",onClick:()=>o(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(PS,{className:"mr-2 h-4 w-4"}),"Tracker"]}),i.jsxs("button",{onClick:x,className:"flex items-center w-full text-left px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(wo,{className:"mr-2 h-4 w-4"}),"Log Out"]})]})]})]})})]})})})]})},_3=[{to:"/verification/dashboard",label:"All Submissions",icon:l3,permission:"view_all_submissions"},{to:"/developer/api",label:"API Settings",icon:Dm,permission:"view_developer_settings"},{to:"/attendance/dashboard",label:"Attendance",icon:Pa,permission:"view_own_attendance"},{to:"/hr/attendance-settings",label:"Attendance Rules",icon:iJ,permission:"manage_attendance_rules"},{to:"/support",label:"Backend Support",icon:Mx,permission:"access_support_desk"},{to:"/hr/entities",label:"Client Management",icon:XF,permission:"view_entity_management"},{to:"/hr/enrollment-rules",label:"Enrollment Rules",icon:t3,permission:"manage_enrollment_rules"},{to:"/hr/policies-and-insurance",label:"Insurance Management",icon:h3,permission:"manage_insurance"},{to:"/billing/summary",label:"Invoice Summary",icon:yJ,permission:"view_invoice_summary"},{to:"/billing/cost-analysis",label:"Verification Costing",icon:Cl,permission:"view_verification_costing"},{to:"/admin/approval-workflow",label:"Leave Approval Settings",icon:_J,permission:"manage_approval_workflow"},{to:"/hr/leave-management",label:"Leave Management",icon:jJ,permission:"manage_leave_requests"},{to:"/admin/modules",label:"Module Management",icon:DJ,permission:"manage_modules"},{to:"/onboarding",label:"New Enrollment",icon:$c,permission:"create_enrollment"},{to:"/operations/dashboard",label:"Operations",icon:rJ,permission:"view_operations_dashboard"},{to:"/profile",label:"Profile",icon:kl,permission:"view_own_attendance"},{to:"/admin/roles",label:"Role Management",icon:oy,permission:"manage_roles_and_permissions"},{to:"/site/dashboard",label:"Site Dashboard",icon:TC,permission:"view_site_dashboard"},{to:"/admin/sites",label:"Site Management",icon:Hi,permission:"manage_sites"},{to:"/tasks",label:"Task Management",icon:kC,permission:"manage_tasks"},{to:"/uniforms",label:"Uniform Management",icon:Df,permission:"manage_uniforms"},{to:"/admin/users",label:"User Management",icon:Gi,permission:"manage_users"},{to:"/hr/field-officer-tracking",label:"User Activity Tracking",icon:d3,permission:"view_field_officer_tracking"},{to:"/hr/locations",label:"Geo Locations",icon:Tl,permission:"manage_attendance_rules"},{to:"/attendance/locations",label:"My Locations",icon:MJ,permission:"view_own_attendance"}],WJ=({isCollapsed:n,onLinkClick:e,onExpand:t,hideHeader:r=!1,mode:s="light",isMobile:a=!1})=>{const{user:o}=jt(),{permissions:l}=Ji(),c=o?_3.filter(h=>l[o.role]?.includes(h.permission)).sort((h,p)=>h.label.localeCompare(p.label)):[],d=h=>{if(a&&n&&t){h.preventDefault(),t();return}e&&e()};return i.jsxs("div",{className:"flex flex-col",children:[r&&n&&i.jsx("div",{className:"p-4 border-b border-[#1f3d2b] bg-[#041b0f] flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",children:i.jsxs("button",{onClick:()=>window.location.href="/#/profile",className:"btn-icon inline-flex items-center justify-center p-2 rounded-md text-white hover:bg-white/10 focus:outline-none","aria-label":"Go to profile page",children:[i.jsx("span",{className:"sr-only",children:"Go to profile"}),i.jsx(Ra,{className:"block h-6 w-6"})]})}),r&&!n&&i.jsx("div",{className:"p-4 border-b border-[#1f3d2b] bg-[#041b0f] flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0"}),!r&&i.jsx("div",{className:"p-4 border-b border-gray-200 bg-white flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",children:n?i.jsx("div",{className:"h-8 w-8 overflow-hidden",children:i.jsx(Zi,{className:"h-8 max-w-none object-left object-cover"})}):i.jsx(Zi,{})}),i.jsx("nav",{className:"px-3 py-4 space-y-1.5",children:c.map(h=>i.jsx(x4,{to:h.to,onClick:d,className:({isActive:p})=>`group flex items-center px-3 py-3 rounded-xl text-sm font-medium transition-all duration-200 ease-in-out ${n?"justify-center":""} ${s==="light"?p?"text-white shadow-sm border":"text-gray-500 hover:bg-gray-50 hover:text-gray-900":p?"bg-[#1c3a23] text-white shadow-sm border border-white/5":"text-white hover:bg-white/5 hover:text-white/90"}`,style:({isActive:p})=>p?s==="light"?{backgroundColor:"#006B3F",borderColor:"#005632"}:{}:{},title:h.label,children:({isActive:p})=>i.jsxs(i.Fragment,{children:[i.jsx(h.icon,{className:`h-5 w-5 flex-shrink-0 transition-colors duration-200 ${s==="light"?p?"text-white":"text-gray-400 group-hover:text-gray-600":p?"text-white":"text-white group-hover:text-white"} ${n?"":"mr-3"}`}),!n&&i.jsx("span",{children:h.label})]})},h.to))})]})},$J=()=>{const{user:n}=jt(),{fetchNotifications:e}=ly(),{permissions:t}=Ji(),{autoScrollOnHover:r}=b3();ds();const s=Ft("(max-width: 767px)"),a=E.useRef(null),o=E.useRef(null),[l,c]=E.useState(!0),[d,h]=E.useState(0),[p,x]=E.useState(!1);E.useEffect(()=>{c(s)},[s]);const v=E.useCallback(()=>{o.current!==null&&(clearInterval(o.current),o.current=null)},[]),w=E.useCallback(_=>{v();const j=a.current;if(!j)return;const T=()=>{j.scrollBy({top:_==="up"?-window.innerHeight*.8:window.innerHeight*.8,behavior:"smooth"})};T(),o.current=window.setInterval(T,300)},[v]);return E.useEffect(()=>{const _=()=>{const T=a.current;T&&(x(T.scrollHeight>T.clientHeight),h(T.scrollTop))},j=a.current;return j?.addEventListener("scroll",_,{passive:!0}),window.addEventListener("resize",_),_(),()=>{j?.removeEventListener("scroll",_),window.removeEventListener("resize",_),v()}},[v]),E.useEffect(()=>{n&&e()},[n,e]),n?i.jsxs("div",{className:`flex min-h-screen ${s?"bg-[#041b0f]":"bg-page"} ${s?"":"p-4 md:p-6 lg:p-8 gap-4 md:gap-6 lg:gap-8"}`,children:[s&&!l&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 transition-opacity duration-300",onClick:()=>c(!0)}),i.jsxs("aside",{className:`flex flex-col flex-shrink-0 transition-all duration-300 ease-in-out ${s?l?"w-16":"w-64":l?"w-20":"w-72"} ${s?"bg-[#041b0f] border-r border-[#1f3d2b]":"bg-white border-r border-gray-200/60"} ${s?"fixed left-0 top-0 bottom-0 z-50":""}`,children:[i.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:i.jsx(WJ,{isCollapsed:l,mode:s?"dark":"light",onLinkClick:s?()=>c(!0):void 0,onExpand:()=>c(!1),hideHeader:s,isMobile:s})}),i.jsx("div",{className:`flex-shrink-0 px-2 pt-2 mt-auto flex items-center ${s?"border-t border-[#1f3d2b]":"border-t border-border"}`,children:i.jsx("button",{onClick:()=>c(!l),className:`flex-1 flex items-center justify-center p-2 rounded-lg transition-colors ${s?"text-white/70 hover:bg-white/10":"text-muted hover:bg-page"}`,title:l?"Expand sidebar":"Collapse sidebar",children:l?i.jsx(fJ,{className:"h-5 w-5"}):i.jsx(uJ,{className:"h-5 w-5"})})})]}),i.jsxs("div",{className:`flex-1 flex flex-col ${s?"bg-[#041b0f]":"bg-gray-50/50"} ${s&&l?"ml-16":""}`,children:[i.jsx(w3,{}),i.jsx("main",{ref:a,className:`flex-1 overflow-y-auto ${s?"bg-[#041b0f]":"bg-page"}`,children:i.jsx("div",{className:"p-4",children:i.jsx(vf,{})})})]}),p&&!s&&i.jsxs("div",{className:"fixed bottom-8 right-8 z-50 flex flex-col gap-2 no-print",children:[i.jsx(se,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:r?()=>w("up"):void 0,onMouseLeave:v,onMouseDown:()=>w("up"),onMouseUp:v,onTouchStart:()=>w("up"),onTouchEnd:v,disabled:d<=0,"aria-label":"Scroll Up",children:i.jsx(dJ,{className:"h-5 w-5"})}),i.jsx(se,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:r?()=>w("down"):void 0,onMouseLeave:v,onMouseDown:()=>w("down"),onMouseUp:v,onTouchStart:()=>w("down"),onTouchEnd:v,disabled:a.current?Math.ceil(a.current.clientHeight+d)>=a.current.scrollHeight:!1,"aria-label":"Scroll Down",children:i.jsx(vu,{className:"h-5 w-5"})})]})]}):i.jsx(vl,{to:"/auth/login",replace:!0})},HJ=()=>{const{user:n}=jt(),{permissions:e}=Ji();if(!n)return null;const t=e[n.role]||[],r=[{to:"/mobile-home",label:"Home",icon:TC,show:!0},{to:"/attendance/dashboard",label:"Attendance",icon:aJ,show:t.includes("view_own_attendance")},{to:"/tasks",label:"Tasks",icon:kC,show:t.includes("manage_tasks")},{to:"/profile",label:"Profile",icon:kl,show:!0}];return i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-[#041b0f] border-t border-[#1f3d2b] z-40",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:i.jsx("div",{className:"flex justify-around items-center h-16",children:r.filter(s=>s.show).map(s=>i.jsxs(x4,{to:s.to,className:({isActive:a})=>`flex flex-col items-center justify-center flex-1 h-full transition-colors ${a?"text-[#22c55e]":"text-gray-400"}`,children:[i.jsx(s.icon,{className:"w-6 h-6"}),i.jsx("span",{className:"text-xs mt-1",children:s.label})]},s.to))})})},YJ=()=>{const[n,e]=E.useState(!0),t=E.useRef(0),r=E.useRef(!1);return E.useEffect(()=>{const s=()=>{r.current||(window.requestAnimationFrame(()=>{const a=window.scrollY;a<t.current||a<10?e(!0):a>t.current&&a>10&&e(!1),t.current=a,r.current=!1}),r.current=!0)};return window.addEventListener("scroll",s,{passive:!0}),()=>window.removeEventListener("scroll",s)},[]),i.jsxs("div",{className:"flex flex-col min-h-screen bg-[#041b0f]",children:[i.jsx("div",{className:`sticky top-0 z-50 transition-transform duration-200 ${n?"translate-y-0":"-translate-y-full"}`,children:i.jsx(w3,{})}),i.jsx("main",{className:"flex-1 overflow-y-auto px-4 pt-2",style:{paddingBottom:"calc(9.1rem + env(safe-area-inset-bottom))"},children:i.jsx(vf,{})}),i.jsx(HJ,{})]})},GJ=["https://picsum.photos/seed/corporate_campus/1200/900","https://picsum.photos/seed/luxury_complex/1200/900","https://picsum.photos/seed/office_interior/1200/900","https://picsum.photos/seed/landscaping/1200/900","https://picsum.photos/seed/lobby_design/1200/900"],j3=Aa(Vf((n,e)=>({backgroundImages:GJ,addBackgroundImage:t=>{const r=e();return r.backgroundImages.includes(t)?!1:(n({backgroundImages:[...r.backgroundImages,t]}),!0)},removeBackgroundImage:t=>n(r=>({backgroundImages:r.backgroundImages.filter((s,a)=>a!==t)}))}),{name:"paradigm-auth-layout-settings",storage:yu(()=>localStorage)})),ZJ=()=>{const{backgroundImages:n}=j3(),[e,t]=E.useState(0),r=ds();E.useEffect(()=>{if(n.length>1){const o=setInterval(()=>{t(l=>(l+1)%n.length)},5e3);return()=>clearInterval(o)}},[n.length]);const s=E.useMemo(()=>n&&n.length>0?n:["https://picsum.photos/seed/default_fallback_1/1200/900"],[n]),a=E.useMemo(()=>r.pathname.includes("signup")?{title:"Create an Account",subtitle:"Join our platform to get started."}:r.pathname.includes("forgot-password")?{title:"Forgot Password?",subtitle:"No worries, we'll send you reset instructions."}:r.pathname.includes("update-password")?{title:"Set a New Password",subtitle:"Please enter your new password."}:{title:"Sign In",subtitle:"Enter your credentials to access your account."},[r.pathname]);return i.jsxs("div",{className:"min-h-screen font-sans flex items-center justify-center bg-page relative overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[s.map((o,l)=>i.jsx("div",{className:`absolute inset-0 w-full h-full bg-cover bg-center transition-opacity duration-1000 ease-in-out ${l===e?"opacity-100":"opacity-0"}`,style:{backgroundImage:`url(${o})`}},l)),i.jsx("div",{className:"absolute inset-0 bg-black/30"})," "]}),i.jsx("div",{className:"relative w-full max-w-3xl lg:max-w-4xl xl:max-w-5xl p-4",children:i.jsxs("div",{className:"auth-card-container w-full grid md:grid-cols-2 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-md bg-black/40 border border-[#041b0f] md:border-white/10",children:[i.jsxs("div",{className:"hidden md:flex flex-col justify-between p-6 lg:p-10 xl:p-16 bg-gradient-to-br from-black/40 to-black/70",children:[i.jsxs("div",{children:[i.jsx(Zi,{className:"h-8 lg:h-12 xl:h-14"}),i.jsx("h1",{className:"text-xl lg:text-2xl xl:text-4xl font-bold text-white mt-6 lg:mt-8 leading-tight drop-shadow-lg",children:"Welcome to the Future of Onboarding."}),i.jsx("p",{className:"text-white/80 mt-4 max-w-md drop-shadow-lg text-xs lg:text-sm xl:text-base",children:"Streamlining the journey for every new member of the Paradigm family."})]}),i.jsx("div",{children:i.jsxs("p",{className:"text-white/50 text-[10px] lg:text-xs mt-4",children:[" ",new Date().getFullYear()," Paradigm Services. All rights reserved."]})})]}),i.jsx("div",{className:"p-6 lg:p-10 xl:p-16 flex flex-col justify-center bg-[#050505]/85 backdrop-blur-xl border-l border-white/10",children:i.jsxs("div",{className:"w-full max-w-md mx-auto",children:[i.jsx("div",{className:"md:hidden flex justify-center mb-8",children:i.jsx(Zi,{className:"h-12"})}),i.jsx("h2",{className:"text-xl lg:text-2xl xl:text-3xl font-bold text-white mb-2",children:a.title}),i.jsx("p",{className:"text-gray-300 mb-4 lg:mb-6 xl:mb-8 text-xs lg:text-sm xl:text-base",children:a.subtitle}),i.jsx(vf,{})]})})]})})]})};function KJ(){const[n,e]=E.useState({isSecure:!0,issues:[],developerModeEnabled:!1,locationSpoofingDetected:!1});return E.useEffect(()=>{const t=()=>{const s=[];let a=!1,o=!1;("geolocation"in navigator,!1)&&(o=!0,s.push("Location spoofing detected. Please disable location mocking apps to continue."));const c=s.length===0;e({isSecure:c,issues:s,developerModeEnabled:a,locationSpoofingDetected:o})};t();const r=setInterval(t,2e3);return window.addEventListener("resize",t),()=>{clearInterval(r),window.removeEventListener("resize",t)}},[]),n}const JJ=({issues:n,onDismiss:e})=>{const[t,r]=E.useState(!1);return E.useEffect(()=>{const s=()=>{r(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),t?i.jsx("div",{className:"fixed inset-0 z-50 bg-white overflow-y-auto",children:i.jsxs("div",{className:"min-h-screen p-4 flex flex-col",children:[i.jsx("div",{className:"flex justify-center mt-8 mb-6",children:i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(ym,{className:"w-8 h-8 text-red-600"})})}),i.jsx("h2",{className:"text-xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),i.jsxs("div",{className:"space-y-3 mb-4",children:[i.jsx("p",{className:"text-gray-700 text-center text-sm",children:"Access to this application has been temporarily blocked for security reasons:"}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:i.jsx("ul",{className:"space-y-2",children:n.map((s,a)=>i.jsxs("li",{className:"flex items-start gap-2 text-xs text-red-800",children:[i.jsx(Da,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:s})]},a))})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2 text-sm",children:"To continue:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs text-blue-800",children:[i.jsx("li",{children:"Close browser developer tools (F12)"}),i.jsx("li",{children:"Disable any location spoofing apps or extensions"}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:i.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&i.jsx(se,{onClick:e,variant:"outline",className:"w-full mt-auto",size:"sm",children:"I Understand"})]})}):i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 animate-in fade-in zoom-in duration-300",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(ym,{className:"w-10 h-10 text-red-600"})})}),i.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),i.jsxs("div",{className:"space-y-3 mb-6",children:[i.jsx("p",{className:"text-gray-700 text-center",children:"Access to this application has been temporarily blocked for security reasons:"}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsx("ul",{className:"space-y-2",children:n.map((s,a)=>i.jsxs("li",{className:"flex items-start gap-2 text-sm text-red-800",children:[i.jsx(Da,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:s})]},a))})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"To continue:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[i.jsx("li",{children:"Close browser developer tools (F12)"}),i.jsx("li",{children:"Disable any location spoofing apps or extensions"}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6",children:i.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&i.jsx(se,{onClick:e,variant:"outline",className:"w-full",children:"I Understand"})]})})},QJ=({children:n})=>{const{user:e}=jt(),t=KJ(),[r,s]=E.useState(!1),a=e&&(e.role==="admin"||e.role==="developer");return E.useEffect(()=>{if(e&&!a&&!t.isSecure&&!r){const o=t.developerModeEnabled?"developer_mode":"location_spoofing";ue.sendSecurityAlert(e.id,e.name,o,void 0).catch(l=>console.error("Failed to send security alert:",l)),s(!0)}},[e,t,r,a]),e&&!a&&!t.isSecure?i.jsx(JJ,{issues:t.issues}):i.jsx(i.Fragment,{children:n})};var Of;(function(n){n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE"})(Of||(Of={}));class mf extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const XJ=n=>{var e,t;return n?.androidBridge?"android":!((t=(e=n?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},eQ=n=>{const e=n.CapacitorCustomPlatform||null,t=n.Capacitor||{},r=t.Plugins=t.Plugins||{},s=()=>e!==null?e.name:XJ(n),a=()=>s()!=="web",o=p=>{const x=d.get(p);return!!(x?.platforms.has(s())||l(p))},l=p=>{var x;return(x=t.PluginHeaders)===null||x===void 0?void 0:x.find(v=>v.name===p)},c=p=>n.console.error(p),d=new Map,h=(p,x={})=>{const v=d.get(p);if(v)return console.warn(`Capacitor plugin "${p}" already registered. Cannot register plugins twice.`),v.proxy;const w=s(),_=l(p);let j;const T=async()=>(!j&&w in x?j=typeof x[w]=="function"?j=await x[w]():j=x[w]:e!==null&&!j&&"web"in x&&(j=typeof x.web=="function"?j=await x.web():j=x.web),j),P=(F,V)=>{var U,W;if(_){const $=_?.methods.find(ne=>V===ne.name);if($)return $.rtype==="promise"?ne=>t.nativePromise(p,V.toString(),ne):(ne,Y)=>t.nativeCallback(p,V.toString(),ne,Y);if(F)return(U=F[V])===null||U===void 0?void 0:U.bind(F)}else{if(F)return(W=F[V])===null||W===void 0?void 0:W.bind(F);throw new mf(`"${p}" plugin is not implemented on ${w}`,Of.Unimplemented)}},D=F=>{let V;const U=(...W)=>{const $=T().then(ne=>{const Y=P(ne,F);if(Y){const ae=Y(...W);return V=ae?.remove,ae}else throw new mf(`"${p}.${F}()" is not implemented on ${w}`,Of.Unimplemented)});return F==="addListener"&&($.remove=async()=>V()),$};return U.toString=()=>`${F.toString()}() { [capacitor code] }`,Object.defineProperty(U,"name",{value:F,writable:!1,configurable:!1}),U},M=D("addListener"),O=D("removeListener"),I=(F,V)=>{const U=M({eventName:F},V),W=async()=>{const ne=await U;O({eventName:F,callbackId:ne},V)},$=new Promise(ne=>U.then(()=>ne({remove:W})));return $.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await W()},$},q=new Proxy({},{get(F,V){switch(V){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return _?I:M;case"removeListener":return O;default:return D(V)}}});return r[p]=q,d.set(p,{name:p,proxy:q,platforms:new Set([...Object.keys(x),..._?[w]:[]])}),q};return t.convertFileSrc||(t.convertFileSrc=p=>p),t.getPlatform=s,t.handleError=c,t.isNativePlatform=a,t.isPluginAvailable=o,t.registerPlugin=h,t.Exception=mf,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},tQ=n=>n.Capacitor=eQ(n),Ox=tQ(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Xc=Ox.registerPlugin;class IC{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,t);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const s=this.listeners[e];if(!s){if(r){let a=this.retainedEventArguments[e];a||(a=[]),a.push(t),this.retainedEventArguments[e]=a}return}s.forEach(a=>a(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new Ox.Exception(e,Of.Unimplemented)}unavailable(e="not available"){return new Ox.Exception(e,Of.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const s=r.indexOf(t);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}}const VM=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),BM=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class nQ extends IC{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,a]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=BM(s).trim(),a=BM(a).trim(),t[s]=a}),t}async setCookie(e){try{const t=VM(e.key),r=VM(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,a=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${s}; path=${a}; ${o};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Xc("CapacitorCookies",{web:()=>new nQ});const rQ=async n=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>t(s),r.readAsDataURL(n)}),sQ=(n={})=>{const e=Object.keys(n);return Object.keys(n).map(s=>s.toLocaleLowerCase()).reduce((s,a,o)=>(s[a]=n[e[o]],s),{})},iQ=(n,e=!0)=>n?Object.entries(n).reduce((r,s)=>{const[a,o]=s;let l,c;return Array.isArray(o)?(c="",o.forEach(d=>{l=e?encodeURIComponent(d):d,c+=`${a}=${l}&`}),c.slice(0,-1)):(l=e?encodeURIComponent(o):o,c=`${a}=${l}`),`${r}&${c}`},"").substr(1):null,aQ=(n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),s=sQ(n.headers)["content-type"]||"";if(typeof n.data=="string")t.body=n.data;else if(s.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[o,l]of Object.entries(n.data||{}))a.set(o,l);t.body=a.toString()}else if(s.includes("multipart/form-data")||n.data instanceof FormData){const a=new FormData;if(n.data instanceof FormData)n.data.forEach((l,c)=>{a.append(c,l)});else for(const l of Object.keys(n.data))a.append(l,n.data[l]);t.body=a;const o=new Headers(t.headers);o.delete("content-type"),t.headers=o}else(s.includes("application/json")||typeof n.data=="object")&&(t.body=JSON.stringify(n.data));return t};class oQ extends IC{async request(e){const t=aQ(e,e.webFetchExtra),r=iQ(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,a=await fetch(s,t),o=a.headers.get("content-type")||"";let{responseType:l="text"}=a.ok?e:{};o.includes("application/json")&&(l="json");let c,d;switch(l){case"arraybuffer":case"blob":d=await a.blob(),c=await rQ(d);break;case"json":c=await a.json();break;case"document":case"text":default:c=await a.text()}const h={};return a.headers.forEach((p,x)=>{h[x]=p}),{data:c,headers:h,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Xc("CapacitorHttp",{web:()=>new oQ});function lQ(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return new Proxy({},{get(r,s){return(a,o,l)=>{const c=n.Capacitor.Plugins[t];if(c===void 0){l(new Error(`Capacitor plugin ${t} not found`));return}if(typeof c[s]!="function"){l(new Error(`Method ${s} not found in Capacitor plugin ${t}`));return}(async()=>{try{const d=await c[s](a);o(d)}catch(d){l(d)}})()}}})}})}function cQ(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return n.cordova.plugins[t]}})}function N3(n=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!n?lQ(window):window.cordova!==void 0&&cQ(window))}const WM=Xc("Geolocation",{web:()=>cm(()=>import("./web-C8fKSWRD.js"),[],import.meta.url).then(n=>new n.GeolocationWeb)});N3();var of;(function(n){n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS"})(of||(of={}));var Xh;(function(n){n.Rear="REAR",n.Front="FRONT"})(Xh||(Xh={}));var $M;(function(n){n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl"})($M||($M={}));class dQ extends IC{async getPhoto(e){return new Promise(async(t,r)=>{if(e.webUseInput||e.source===of.Photos)this.fileInputExperience(e,t,r);else if(e.source===of.Prompt){let s=document.querySelector("pwa-action-sheet");s||(s=document.createElement("pwa-action-sheet"),document.body.appendChild(s)),s.header=e.promptLabelHeader||"Photo",s.cancelable=!1,s.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],s.addEventListener("onSelection",async a=>{a.detail===0?this.fileInputExperience(e,t,r):this.cameraExperience(e,t,r)})}else this.cameraExperience(e,t,r)})}async pickImages(e){return new Promise(async(t,r)=>{this.multipleFileInputExperience(t,r)})}async cameraExperience(e,t,r){if(customElements.get("pwa-camera-modal")){const s=document.createElement("pwa-camera-modal");s.facingMode=e.direction===Xh.Front?"user":"environment",document.body.appendChild(s);try{await s.componentOnReady(),s.addEventListener("onPhoto",async a=>{const o=a.detail;o===null?r(new mf("User cancelled photos app")):o instanceof Error?r(o):t(await this._getCameraPhoto(o,e)),s.dismiss(),document.body.removeChild(s)}),s.present()}catch{this.fileInputExperience(e,t,r)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,t,r)}fileInputExperience(e,t,r){let s=document.querySelector("#_capacitor-camera-input");const a=()=>{var o;(o=s.parentNode)===null||o===void 0||o.removeChild(s)};s||(s=document.createElement("input"),s.id="_capacitor-camera-input",s.type="file",s.hidden=!0,document.body.appendChild(s),s.addEventListener("change",o=>{const l=s.files[0];let c="jpeg";if(l.type==="image/png"?c="png":l.type==="image/gif"&&(c="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){const d=new FileReader;d.addEventListener("load",()=>{if(e.resultType==="dataUrl")t({dataUrl:d.result,format:c});else if(e.resultType==="base64"){const h=d.result.split(",")[1];t({base64String:h,format:c})}a()}),d.readAsDataURL(l)}else t({webPath:URL.createObjectURL(l),format:c}),a()}),s.addEventListener("cancel",o=>{r(new mf("User cancelled photos app")),a()})),s.accept="image/*",s.capture=!0,e.source===of.Photos||e.source===of.Prompt?s.removeAttribute("capture"):e.direction===Xh.Front?s.capture="user":e.direction===Xh.Rear&&(s.capture="environment"),s.click()}multipleFileInputExperience(e,t){let r=document.querySelector("#_capacitor-camera-input-multiple");const s=()=>{var a;(a=r.parentNode)===null||a===void 0||a.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input-multiple",r.type="file",r.hidden=!0,r.multiple=!0,document.body.appendChild(r),r.addEventListener("change",a=>{const o=[];for(let l=0;l<r.files.length;l++){const c=r.files[l];let d="jpeg";c.type==="image/png"?d="png":c.type==="image/gif"&&(d="gif"),o.push({webPath:URL.createObjectURL(c),format:d})}e({photos:o}),s()}),r.addEventListener("cancel",a=>{t(new mf("User cancelled photos app")),s()})),r.accept="image/*",r.click()}_getCameraPhoto(e,t){return new Promise((r,s)=>{const a=new FileReader,o=e.type.split("/")[1];t.resultType==="uri"?r({webPath:URL.createObjectURL(e),format:o,saved:!1}):(a.readAsDataURL(e),a.onloadend=()=>{const l=a.result;t.resultType==="dataUrl"?r({dataUrl:l,format:o,saved:!1}):r({base64String:l.split(",")[1],format:o,saved:!1})},a.onerror=l=>{s(l)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const HM=Xc("Camera",{web:()=>new dQ}),YM=Xc("PushNotifications",{});var GM;(function(n){n.Documents="DOCUMENTS",n.Data="DATA",n.Library="LIBRARY",n.Cache="CACHE",n.External="EXTERNAL",n.ExternalStorage="EXTERNAL_STORAGE",n.ExternalCache="EXTERNAL_CACHE",n.LibraryNoCloud="LIBRARY_NO_CLOUD",n.Temporary="TEMPORARY"})(GM||(GM={}));var ZM;(function(n){n.UTF8="utf8",n.ASCII="ascii",n.UTF16="utf16"})(ZM||(ZM={}));const KM=Xc("Filesystem",{web:()=>cm(()=>import("./web-BnaX1XbT.js"),[],import.meta.url).then(n=>new n.FilesystemWeb)});N3();const uQ=Xc("App",{web:()=>cm(()=>import("./web-B3LLqPC1.js"),[],import.meta.url).then(n=>new n.AppWeb)}),fQ=Xc("SecurityCheck"),hQ=({children:n})=>{const[e,t]=E.useState({location:!1,camera:!1,notification:!1,microphone:!1,storage:!1}),[r,s]=E.useState({developerMode:!1}),[a,o]=E.useState(!0),l=Ox.isNativePlatform(),c=async()=>{if(!l){o(!1);return}try{let p=!1;try{p=(await fQ.getSecurityStatus()).developerMode}catch(M){console.warn("Failed to check security status or plugin not available",M)}const x=await WM.checkPermissions(),v=x.location==="granted"||x.coarseLocation==="granted",w=await HM.checkPermissions(),_=w.camera==="granted"||w.photos==="granted";let j=!1;try{j=(await YM.checkPermissions()).receive==="granted"}catch(M){console.warn("Push details not available or failed",M)}const P=(await KM.checkPermissions()).publicStorage==="granted";let D=!1;try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(O=>O.stop()),D=!0}catch{D=!1}t({location:v,camera:_,notification:j,storage:P,microphone:D}),s({developerMode:p})}catch(p){console.error("Error checking permissions:",p)}finally{o(!1)}},d=async()=>{if(l){if(!e.location)try{await WM.requestPermissions()}catch{}if(!e.camera)try{await HM.requestPermissions()}catch{}if(!e.notification)try{await YM.requestPermissions()}catch{}if(!e.storage)try{await KM.requestPermissions()}catch{}if(!e.microphone)try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(x=>x.stop())}catch{}await c()}};return E.useEffect(()=>{c();const p=uQ.addListener("appStateChange",({isActive:x})=>{x&&c()});return()=>{p.then(x=>x.remove())}},[l]),l?a?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):r.developerMode?i.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 px-6 text-center",children:i.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg max-w-md w-full",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-red-100",children:i.jsx("svg",{className:"h-10 w-10 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Security Alert"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Developer Options are enabled on this device."}),i.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 text-left",children:[i.jsxs("p",{className:"text-sm text-yellow-700",children:["To continue using this application, you must ",i.jsx("strong",{children:"disable Developer Options"})," in your device settings."]}),i.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"This is required to prevent location spoofing (Fake GPS) and ensure data integrity."})]}),i.jsx("button",{onClick:()=>c(),className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200",children:"I have disabled them, Retry"})]})}):e.location&&e.camera&&e.notification&&e.storage&&e.microphone?i.jsx(i.Fragment,{children:n}):i.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-50 px-6 text-center",children:i.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg max-w-md w-full",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-yellow-100",children:i.jsx("svg",{className:"h-10 w-10 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Permissions Required"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"To use this application, you must grant access to Location, Camera, Notifications, Microphone, and Storage."}),i.jsxs("div",{className:"w-full space-y-4 mb-6 text-left text-sm",children:[i.jsx(wh,{label:"Location",granted:e.location}),i.jsx(wh,{label:"Camera",granted:e.camera}),i.jsx(wh,{label:"Notifications",granted:e.notification}),i.jsx(wh,{label:"Microphone",granted:e.microphone}),i.jsx(wh,{label:"Storage",granted:e.storage})]}),i.jsx("button",{onClick:d,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200",children:"Grant Permissions"})]})}):i.jsx(i.Fragment,{children:n})},wh=({label:n,granted:e})=>i.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-0",children:[i.jsx("span",{className:"font-medium text-gray-700",children:n}),i.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded-full ${e?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e?"ALLOWED":"MISSING"})]}),mQ=({onComplete:n})=>{const e=Ft("(max-width: 767px)"),[t,r]=E.useState("prompt"),[s,a]=E.useState("prompt"),[o,l]=E.useState(!1),[c,d]=E.useState(null),h=t==="granted"&&s==="granted";E.useEffect(()=>{(!e||h)&&n()},[e,h,n]);const p=async()=>{l(!0),d(null);try{try{const x=await navigator.mediaDevices.getUserMedia({video:!0});a("granted"),x.getTracks().forEach(v=>v.stop())}catch{throw a("denied"),new Error("Camera permission was denied.")}try{await new Promise((x,v)=>{navigator.geolocation.getCurrentPosition(()=>{r("granted"),x(!0)},()=>{r("denied"),v(new Error("Location permission was denied."))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})}catch{throw new Error("Location permission was denied.")}n()}catch(x){d(x.message||"Permissions are required to use this app.")}finally{l(!1)}};return e?i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4 text-center",children:[i.jsx("div",{className:"splash-logo",children:i.jsx(Zi,{className:"h-16 mb-8"})}),i.jsxs("div",{className:"max-w-md",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Permissions Required"}),i.jsx("p",{className:"text-gray-600 mb-8",children:"To ensure the best experience and enable features like location-based check-ins and photo uploads, we need access to your device's Camera and Location."}),i.jsxs("div",{className:"space-y-4 mb-8",children:[i.jsxs("div",{className:`p-4 rounded-lg border ${t==="granted"?"bg-green-100 border-green-300":"bg-gray-100 border-gray-300"}`,children:[i.jsx("p",{className:"font-semibold",children:"Location Access"}),i.jsx("p",{className:"text-sm",children:t==="granted"?"Permission Granted":"Needed for check-in/out"})]}),i.jsxs("div",{className:`p-4 rounded-lg border ${s==="granted"?"bg-green-100 border-green-300":"bg-gray-100 border-gray-300"}`,children:[i.jsx("p",{className:"font-semibold",children:"Camera Access"}),i.jsx("p",{className:"text-sm",children:s==="granted"?"Permission Granted":"Needed for identity verification"})]})]}),i.jsx(se,{onClick:p,disabled:o,children:o?"Requesting...":"Grant Permissions"}),c&&i.jsx("p",{className:"text-red-500 mt-4",children:c}),i.jsx("p",{className:"text-xs text-gray-500 mt-8",children:"You can manage these permissions in your device settings at any time."})]})]}):null},pQ=()=>{const[n,e]=E.useState(!1),t=()=>{e(!0)};return n?i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4",children:[i.jsx("div",{className:"splash-logo",children:i.jsx(Zi,{className:"h-16 mb-8"})}),i.jsx("p",{className:"text-gray-600",children:"Loading Application..."})]}):i.jsx(mQ,{onComplete:t})},gQ=()=>{const{user:n,logout:e}=jt(),{permissions:t}=Ji(),r=St();if(!n)return null;const s=_3.filter(o=>t[n.role]?.includes(o.permission)).sort((o,l)=>o.label.localeCompare(l.label)),a=async()=>{await e(),r("/auth/login")};return i.jsxs("div",{className:"min-h-[calc(100vh-180px)] flex flex-col pb-4 bg-[#041b0f]",children:[i.jsx("div",{className:"bg-[#041b0f] p-6 rounded-3xl shadow-lg -mx-4 mb-6",children:i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx($i,{photoUrl:n.photoUrl,seed:n.id,className:"h-14 w-14 rounded-full border-2 border-[#22c55e]"}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold text-white",children:["Hi, ",n.name.split(" ")[0]]}),i.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:n.role.replace(/_/g," ")})]})]})})}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsx("h2",{className:"text-lg font-semibold text-white mb-4 px-2",children:"Apps & Features"}),i.jsx("div",{className:"grid grid-cols-3 gap-3 px-2 flex-1 content-start",children:s.map(o=>i.jsxs("div",{onClick:()=>r(o.to),className:"flex flex-col items-center justify-center p-4 bg-[#041b0f] border border-[#1f3d2b] rounded-2xl active:scale-95 transition-transform duration-150 shadow-md min-h-[110px]",children:[i.jsx("div",{className:"p-3 bg-[#041b0f] rounded-full mb-2 text-[#22c55e]",children:i.jsx(o.icon,{className:"w-7 h-7"})}),i.jsx("span",{className:"text-xs text-center text-gray-300 font-medium leading-tight",children:o.label})]},o.to))})]}),i.jsx("div",{className:"px-2 mt-6",children:i.jsxs("button",{onClick:a,className:"w-full flex items-center justify-center space-x-2 p-4 bg-[#1f2937] text-white rounded-xl font-semibold active:bg-[#374151] transition-colors",children:[i.jsx(wo,{className:"w-5 h-5"}),i.jsx("span",{children:"Log Out"})]})})]})};var Om=n=>n.type==="checkbox",ru=n=>n instanceof Date,Vs=n=>n==null;const S3=n=>typeof n=="object";var vr=n=>!Vs(n)&&!Array.isArray(n)&&S3(n)&&!ru(n),C3=n=>vr(n)&&n.target?Om(n.target)?n.target.checked:n.target.value:n,xQ=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,T3=(n,e)=>n.has(xQ(e)),yQ=n=>{const e=n.constructor&&n.constructor.prototype;return vr(e)&&e.hasOwnProperty("isPrototypeOf")},AC=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Fn(n){let e;const t=Array.isArray(n),r=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(AC&&(n instanceof Blob||r))&&(t||vr(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!yQ(n))e=n;else for(const s in n)n.hasOwnProperty(s)&&(e[s]=Fn(n[s]));else return n;return e}var cy=n=>/^\w*$/.test(n),An=n=>n===void 0,dy=n=>Array.isArray(n)?n.filter(Boolean):[],RC=n=>dy(n.replace(/["|']|\]/g,"").split(/\.|\[/)),nt=(n,e,t)=>{if(!e||!vr(n))return t;const r=(cy(e)?[e]:RC(e)).reduce((s,a)=>Vs(s)?s:s[a],n);return An(r)||r===n?An(n[e])?t:n[e]:r},di=n=>typeof n=="boolean",hn=(n,e,t)=>{let r=-1;const s=cy(e)?[e]:RC(e),a=s.length,o=a-1;for(;++r<a;){const l=s[r];let c=t;if(r!==o){const d=n[l];c=vr(d)||Array.isArray(d)?d:isNaN(+s[r+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=c,n=n[l]}};const Ix={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Wi={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},dl={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},k3=ot.createContext(null);k3.displayName="HookFormContext";const uy=()=>ot.useContext(k3);var P3=(n,e,t,r=!0)=>{const s={defaultValues:e._defaultValues};for(const a in n)Object.defineProperty(s,a,{get:()=>{const o=a;return e._proxyFormState[o]!==Wi.all&&(e._proxyFormState[o]=!r||Wi.all),t&&(t[o]=!0),n[o]}});return s};const fy=typeof window<"u"?ot.useLayoutEffect:ot.useEffect;function vQ(n){const e=uy(),{control:t=e.control,disabled:r,name:s,exact:a}=n||{},[o,l]=ot.useState(t._formState),c=ot.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return fy(()=>t._subscribe({name:s,formState:c.current,exact:a,callback:d=>{!r&&l({...t._formState,...d})}}),[s,r,a]),ot.useEffect(()=>{c.current.isValid&&t._setValid(!0)},[t]),ot.useMemo(()=>P3(o,t,c.current,!1),[o,t])}var mi=n=>typeof n=="string",AS=(n,e,t,r,s)=>mi(n)?(r&&e.watch.add(n),nt(t,n,s)):Array.isArray(n)?n.map(a=>(r&&e.watch.add(a),nt(t,a))):(r&&(e.watchAll=!0),t),RS=n=>Vs(n)||!S3(n);function Na(n,e,t=new WeakSet){if(RS(n)||RS(e))return n===e;if(ru(n)&&ru(e))return n.getTime()===e.getTime();const r=Object.keys(n),s=Object.keys(e);if(r.length!==s.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const a of r){const o=n[a];if(!s.includes(a))return!1;if(a!=="ref"){const l=e[a];if(ru(o)&&ru(l)||vr(o)&&vr(l)||Array.isArray(o)&&Array.isArray(l)?!Na(o,l,t):o!==l)return!1}}return!0}function au(n){const e=uy(),{control:t=e.control,name:r,defaultValue:s,disabled:a,exact:o,compute:l}=n||{},c=ot.useRef(s),d=ot.useRef(l),h=ot.useRef(void 0),p=ot.useRef(t),x=ot.useRef(r);d.current=l;const[v,w]=ot.useState(()=>{const M=t._getWatch(r,c.current);return d.current?d.current(M):M}),_=ot.useCallback(M=>{const O=AS(r,t._names,M||t._formValues,!1,c.current);return d.current?d.current(O):O},[t._formValues,t._names,r]),j=ot.useCallback(M=>{if(!a){const O=AS(r,t._names,M||t._formValues,!1,c.current);if(d.current){const I=d.current(O);Na(I,h.current)||(w(I),h.current=I)}else w(O)}},[t._formValues,t._names,a,r]);fy(()=>((p.current!==t||!Na(x.current,r))&&(p.current=t,x.current=r,j()),t._subscribe({name:r,formState:{values:!0},exact:o,callback:M=>{j(M.values)}})),[t,o,r,j]),ot.useEffect(()=>t._removeUnmounted());const T=p.current!==t,P=x.current,D=ot.useMemo(()=>{if(a)return null;const M=!T&&!Na(P,r);return T||M?_():null},[a,T,r,P,_]);return D!==null?D:v}function bQ(n){const e=uy(),{name:t,disabled:r,control:s=e.control,shouldUnregister:a,defaultValue:o}=n,l=T3(s._names.array,t),c=ot.useMemo(()=>nt(s._formValues,t,nt(s._defaultValues,t,o)),[s,t,o]),d=au({control:s,name:t,defaultValue:c,exact:!0}),h=vQ({control:s,name:t,exact:!0}),p=ot.useRef(n),x=ot.useRef(void 0),v=ot.useRef(s.register(t,{...n.rules,value:d,...di(n.disabled)?{disabled:n.disabled}:{}}));p.current=n;const w=ot.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!nt(h.errors,t)},isDirty:{enumerable:!0,get:()=>!!nt(h.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!nt(h.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!nt(h.validatingFields,t)},error:{enumerable:!0,get:()=>nt(h.errors,t)}}),[h,t]),_=ot.useCallback(D=>v.current.onChange({target:{value:C3(D),name:t},type:Ix.CHANGE}),[t]),j=ot.useCallback(()=>v.current.onBlur({target:{value:nt(s._formValues,t),name:t},type:Ix.BLUR}),[t,s._formValues]),T=ot.useCallback(D=>{const M=nt(s._fields,t);M&&D&&(M._f.ref={focus:()=>D.focus&&D.focus(),select:()=>D.select&&D.select(),setCustomValidity:O=>D.setCustomValidity(O),reportValidity:()=>D.reportValidity()})},[s._fields,t]),P=ot.useMemo(()=>({name:t,value:d,...di(r)||h.disabled?{disabled:h.disabled||r}:{},onChange:_,onBlur:j,ref:T}),[t,r,h.disabled,_,j,T,d]);return ot.useEffect(()=>{const D=s._options.shouldUnregister||a,M=x.current;M&&M!==t&&!l&&s.unregister(M),s.register(t,{...p.current.rules,...di(p.current.disabled)?{disabled:p.current.disabled}:{}});const O=(I,q)=>{const F=nt(s._fields,I);F&&F._f&&(F._f.mount=q)};if(O(t,!0),D){const I=Fn(nt(s._options.defaultValues,t,p.current.defaultValue));hn(s._defaultValues,t,I),An(nt(s._formValues,t))&&hn(s._formValues,t,I)}return!l&&s.register(t),x.current=t,()=>{(l?D&&!s._state.action:D)?s.unregister(t):O(t,!1)}},[t,s,l,a]),ot.useEffect(()=>{s._setDisabledField({disabled:r,name:t})},[r,t,s]),ot.useMemo(()=>({field:P,formState:h,fieldState:w}),[P,h,w])}const _e=n=>n.render(bQ(n));var M3=(n,e,t,r,s)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[r]:s||!0}}:{},$s=n=>Array.isArray(n)?n:[n],JM=()=>{let n=[];return{get observers(){return n},next:s=>{for(const a of n)a.next&&a.next(s)},subscribe:s=>(n.push(s),{unsubscribe:()=>{n=n.filter(a=>a!==s)}}),unsubscribe:()=>{n=[]}}};function E3(n,e){const t={};for(const r in n)if(n.hasOwnProperty(r)){const s=n[r],a=e[r];if(s&&vr(s)&&a){const o=E3(s,a);vr(o)&&(t[r]=o)}else n[r]&&(t[r]=a)}return t}var ss=n=>vr(n)&&!Object.keys(n).length,LC=n=>n.type==="file",Sa=n=>typeof n=="function",Ax=n=>{if(!AC)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},D3=n=>n.type==="select-multiple",FC=n=>n.type==="radio",wQ=n=>FC(n)||Om(n),pb=n=>Ax(n)&&n.isConnected;function _Q(n,e){const t=e.slice(0,-1).length;let r=0;for(;r<t;)n=An(n)?r++:n[e[r++]];return n}function jQ(n){for(const e in n)if(n.hasOwnProperty(e)&&!An(n[e]))return!1;return!0}function ir(n,e){const t=Array.isArray(e)?e:cy(e)?[e]:RC(e),r=t.length===1?n:_Q(n,t),s=t.length-1,a=t[s];return r&&delete r[a],s!==0&&(vr(r)&&ss(r)||Array.isArray(r)&&jQ(r))&&ir(n,t.slice(0,-1)),n}var NQ=n=>{for(const e in n)if(Sa(n[e]))return!0;return!1};function O3(n){return Array.isArray(n)||vr(n)&&!NQ(n)}function LS(n,e={}){for(const t in n)O3(n[t])?(e[t]=Array.isArray(n[t])?[]:{},LS(n[t],e[t])):An(n[t])||(e[t]=!0);return e}function sf(n,e,t){t||(t=LS(e));for(const r in n)O3(n[r])?An(e)||RS(t[r])?t[r]=LS(n[r],Array.isArray(n[r])?[]:{}):sf(n[r],Vs(e)?{}:e[r],t[r]):t[r]=!Na(n[r],e[r]);return t}const QM={value:!1,isValid:!1},XM={value:!0,isValid:!0};var I3=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!An(n[0].attributes.value)?An(n[0].value)||n[0].value===""?XM:{value:n[0].value,isValid:!0}:XM:QM}return QM},A3=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:r})=>An(n)?n:e?n===""?NaN:n&&+n:t&&mi(n)?new Date(n):r?r(n):n;const eE={isValid:!1,value:null};var R3=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,eE):eE;function tE(n){const e=n.ref;return LC(e)?e.files:FC(e)?R3(n.refs).value:D3(e)?[...e.selectedOptions].map(({value:t})=>t):Om(e)?I3(n.refs).value:A3(An(e.value)?n.ref.value:e.value,n)}var SQ=(n,e,t,r)=>{const s={};for(const a of n){const o=nt(e,a);o&&hn(s,a,o._f)}return{criteriaMode:t,names:[...n],fields:s,shouldUseNativeValidation:r}},Rx=n=>n instanceof RegExp,_h=n=>An(n)?n:Rx(n)?n.source:vr(n)?Rx(n.value)?n.value.source:n.value:n,lf=n=>({isOnSubmit:!n||n===Wi.onSubmit,isOnBlur:n===Wi.onBlur,isOnChange:n===Wi.onChange,isOnAll:n===Wi.all,isOnTouch:n===Wi.onTouched});const nE="AsyncFunction";var CQ=n=>!!n&&!!n.validate&&!!(Sa(n.validate)&&n.validate.constructor.name===nE||vr(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===nE)),TQ=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),FS=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(r=>n.startsWith(r)&&/^\.\w+/.test(n.slice(r.length))));const pf=(n,e,t,r)=>{for(const s of t||Object.keys(n)){const a=nt(n,s);if(a){const{_f:o,...l}=a;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],s)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(pf(l,e))break}else if(vr(l)&&pf(l,e))break}}};function rE(n,e,t){const r=nt(n,t);if(r||cy(t))return{error:r,name:t};const s=t.split(".");for(;s.length;){const a=s.join("."),o=nt(e,a),l=nt(n,a);if(o&&!Array.isArray(o)&&t!==a)return{name:t};if(l&&l.type)return{name:a,error:l};if(l&&l.root&&l.root.type)return{name:`${a}.root`,error:l.root};s.pop()}return{name:t}}var kQ=(n,e,t,r)=>{t(n);const{name:s,...a}=n;return ss(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(o=>e[o]===(!r||Wi.all))},PQ=(n,e,t)=>!n||!e||n===e||$s(n).some(r=>r&&(t?r===e:r.startsWith(e)||e.startsWith(r))),MQ=(n,e,t,r,s)=>s.isOnAll?!1:!t&&s.isOnTouch?!(e||n):(t?r.isOnBlur:s.isOnBlur)?!n:(t?r.isOnChange:s.isOnChange)?n:!0,EQ=(n,e)=>!dy(nt(n,e)).length&&ir(n,e),L3=(n,e,t)=>{const r=$s(nt(n,t));return hn(r,"root",e[t]),hn(n,t,r),n};function sE(n,e,t="validate"){if(mi(n)||Array.isArray(n)&&n.every(mi)||di(n)&&!n)return{type:t,message:mi(n)?n:"",ref:e}}var Zu=n=>vr(n)&&!Rx(n)?n:{value:n,message:""},qS=async(n,e,t,r,s,a)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:h,min:p,max:x,pattern:v,validate:w,name:_,valueAsNumber:j,mount:T}=n._f,P=nt(t,_);if(!T||e.has(_))return{};const D=l?l[0]:o,M=$=>{s&&D.reportValidity&&(D.setCustomValidity(di($)?"":$||""),D.reportValidity())},O={},I=FC(o),q=Om(o),F=I||q,V=(j||LC(o))&&An(o.value)&&An(P)||Ax(o)&&o.value===""||P===""||Array.isArray(P)&&!P.length,U=M3.bind(null,_,r,O),W=($,ne,Y,ae=dl.maxLength,J=dl.minLength)=>{const ee=$?ne:Y;O[_]={type:$?ae:J,message:ee,ref:o,...U($?ae:J,ee)}};if(a?!Array.isArray(P)||!P.length:c&&(!F&&(V||Vs(P))||di(P)&&!P||q&&!I3(l).isValid||I&&!R3(l).isValid)){const{value:$,message:ne}=mi(c)?{value:!!c,message:c}:Zu(c);if($&&(O[_]={type:dl.required,message:ne,ref:D,...U(dl.required,ne)},!r))return M(ne),O}if(!V&&(!Vs(p)||!Vs(x))){let $,ne;const Y=Zu(x),ae=Zu(p);if(!Vs(P)&&!isNaN(P)){const J=o.valueAsNumber||P&&+P;Vs(Y.value)||($=J>Y.value),Vs(ae.value)||(ne=J<ae.value)}else{const J=o.valueAsDate||new Date(P),ee=oe=>new Date(new Date().toDateString()+" "+oe),X=o.type=="time",Z=o.type=="week";mi(Y.value)&&P&&($=X?ee(P)>ee(Y.value):Z?P>Y.value:J>new Date(Y.value)),mi(ae.value)&&P&&(ne=X?ee(P)<ee(ae.value):Z?P<ae.value:J<new Date(ae.value))}if(($||ne)&&(W(!!$,Y.message,ae.message,dl.max,dl.min),!r))return M(O[_].message),O}if((d||h)&&!V&&(mi(P)||a&&Array.isArray(P))){const $=Zu(d),ne=Zu(h),Y=!Vs($.value)&&P.length>+$.value,ae=!Vs(ne.value)&&P.length<+ne.value;if((Y||ae)&&(W(Y,$.message,ne.message),!r))return M(O[_].message),O}if(v&&!V&&mi(P)){const{value:$,message:ne}=Zu(v);if(Rx($)&&!P.match($)&&(O[_]={type:dl.pattern,message:ne,ref:o,...U(dl.pattern,ne)},!r))return M(ne),O}if(w){if(Sa(w)){const $=await w(P,t),ne=sE($,D);if(ne&&(O[_]={...ne,...U(dl.validate,ne.message)},!r))return M(ne.message),O}else if(vr(w)){let $={};for(const ne in w){if(!ss($)&&!r)break;const Y=sE(await w[ne](P,t),D,ne);Y&&($={...Y,...U(ne,Y.message)},M(Y.message),r&&(O[_]=$))}if(!ss($)&&(O[_]={ref:D,...$},!r))return O}}return M(!0),O};const DQ={mode:Wi.onSubmit,reValidateMode:Wi.onChange,shouldFocusError:!0};function OQ(n={}){let e={...DQ,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:Sa(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},s=vr(e.defaultValues)||vr(e.values)?Fn(e.defaultValues||e.values)||{}:{},a=e.shouldUnregister?{}:Fn(s),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...h};const x={array:JM(),state:JM()},v=e.criteriaMode===Wi.all,w=te=>le=>{clearTimeout(d),d=setTimeout(te,le)},_=async te=>{if(!e.disabled&&(h.isValid||p.isValid||te)){const le=e.resolver?ss((await q()).errors):await V(r,!0);le!==t.isValid&&x.state.next({isValid:le})}},j=(te,le)=>{!e.disabled&&(h.isValidating||h.validatingFields||p.isValidating||p.validatingFields)&&((te||Array.from(l.mount)).forEach(ye=>{ye&&(le?hn(t.validatingFields,ye,le):ir(t.validatingFields,ye))}),x.state.next({validatingFields:t.validatingFields,isValidating:!ss(t.validatingFields)}))},T=(te,le=[],ye,Ve,ze=!0,Le=!0)=>{if(Ve&&ye&&!e.disabled){if(o.action=!0,Le&&Array.isArray(nt(r,te))){const rt=ye(nt(r,te),Ve.argA,Ve.argB);ze&&hn(r,te,rt)}if(Le&&Array.isArray(nt(t.errors,te))){const rt=ye(nt(t.errors,te),Ve.argA,Ve.argB);ze&&hn(t.errors,te,rt),EQ(t.errors,te)}if((h.touchedFields||p.touchedFields)&&Le&&Array.isArray(nt(t.touchedFields,te))){const rt=ye(nt(t.touchedFields,te),Ve.argA,Ve.argB);ze&&hn(t.touchedFields,te,rt)}(h.dirtyFields||p.dirtyFields)&&(t.dirtyFields=sf(s,a)),x.state.next({name:te,isDirty:W(te,le),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else hn(a,te,le)},P=(te,le)=>{hn(t.errors,te,le),x.state.next({errors:t.errors})},D=te=>{t.errors=te,x.state.next({errors:t.errors,isValid:!1})},M=(te,le,ye,Ve)=>{const ze=nt(r,te);if(ze){const Le=nt(a,te,An(ye)?nt(s,te):ye);An(Le)||Ve&&Ve.defaultChecked||le?hn(a,te,le?Le:tE(ze._f)):Y(te,Le),o.mount&&_()}},O=(te,le,ye,Ve,ze)=>{let Le=!1,rt=!1;const Xe={name:te};if(!e.disabled){if(!ye||Ve){(h.isDirty||p.isDirty)&&(rt=t.isDirty,t.isDirty=Xe.isDirty=W(),Le=rt!==Xe.isDirty);const tt=Na(nt(s,te),le);rt=!!nt(t.dirtyFields,te),tt?ir(t.dirtyFields,te):hn(t.dirtyFields,te,!0),Xe.dirtyFields=t.dirtyFields,Le=Le||(h.dirtyFields||p.dirtyFields)&&rt!==!tt}if(ye){const tt=nt(t.touchedFields,te);tt||(hn(t.touchedFields,te,ye),Xe.touchedFields=t.touchedFields,Le=Le||(h.touchedFields||p.touchedFields)&&tt!==ye)}Le&&ze&&x.state.next(Xe)}return Le?Xe:{}},I=(te,le,ye,Ve)=>{const ze=nt(t.errors,te),Le=(h.isValid||p.isValid)&&di(le)&&t.isValid!==le;if(e.delayError&&ye?(c=w(()=>P(te,ye)),c(e.delayError)):(clearTimeout(d),c=null,ye?hn(t.errors,te,ye):ir(t.errors,te)),(ye?!Na(ze,ye):ze)||!ss(Ve)||Le){const rt={...Ve,...Le&&di(le)?{isValid:le}:{},errors:t.errors,name:te};t={...t,...rt},x.state.next(rt)}},q=async te=>{j(te,!0);const le=await e.resolver(a,e.context,SQ(te||l.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return j(te),le},F=async te=>{const{errors:le}=await q(te);if(te)for(const ye of te){const Ve=nt(le,ye);Ve?hn(t.errors,ye,Ve):ir(t.errors,ye)}else t.errors=le;return le},V=async(te,le,ye={valid:!0})=>{for(const Ve in te){const ze=te[Ve];if(ze){const{_f:Le,...rt}=ze;if(Le){const Xe=l.array.has(Le.name),tt=ze._f&&CQ(ze._f);tt&&h.validatingFields&&j([Le.name],!0);const qt=await qS(ze,l.disabled,a,v,e.shouldUseNativeValidation&&!le,Xe);if(tt&&h.validatingFields&&j([Le.name]),qt[Le.name]&&(ye.valid=!1,le))break;!le&&(nt(qt,Le.name)?Xe?L3(t.errors,qt,Le.name):hn(t.errors,Le.name,qt[Le.name]):ir(t.errors,Le.name))}!ss(rt)&&await V(rt,le,ye)}}return ye.valid},U=()=>{for(const te of l.unMount){const le=nt(r,te);le&&(le._f.refs?le._f.refs.every(ye=>!pb(ye)):!pb(le._f.ref))&&ie(te)}l.unMount=new Set},W=(te,le)=>!e.disabled&&(te&&le&&hn(a,te,le),!Na(oe(),s)),$=(te,le,ye)=>AS(te,l,{...o.mount?a:An(le)?s:mi(te)?{[te]:le}:le},ye,le),ne=te=>dy(nt(o.mount?a:s,te,e.shouldUnregister?nt(s,te,[]):[])),Y=(te,le,ye={})=>{const Ve=nt(r,te);let ze=le;if(Ve){const Le=Ve._f;Le&&(!Le.disabled&&hn(a,te,A3(le,Le)),ze=Ax(Le.ref)&&Vs(le)?"":le,D3(Le.ref)?[...Le.ref.options].forEach(rt=>rt.selected=ze.includes(rt.value)):Le.refs?Om(Le.ref)?Le.refs.forEach(rt=>{(!rt.defaultChecked||!rt.disabled)&&(Array.isArray(ze)?rt.checked=!!ze.find(Xe=>Xe===rt.value):rt.checked=ze===rt.value||!!ze)}):Le.refs.forEach(rt=>rt.checked=rt.value===ze):LC(Le.ref)?Le.ref.value="":(Le.ref.value=ze,Le.ref.type||x.state.next({name:te,values:Fn(a)})))}(ye.shouldDirty||ye.shouldTouch)&&O(te,ze,ye.shouldTouch,ye.shouldDirty,!0),ye.shouldValidate&&Z(te)},ae=(te,le,ye)=>{for(const Ve in le){if(!le.hasOwnProperty(Ve))return;const ze=le[Ve],Le=te+"."+Ve,rt=nt(r,Le);(l.array.has(te)||vr(ze)||rt&&!rt._f)&&!ru(ze)?ae(Le,ze,ye):Y(Le,ze,ye)}},J=(te,le,ye={})=>{const Ve=nt(r,te),ze=l.array.has(te),Le=Fn(le);hn(a,te,Le),ze?(x.array.next({name:te,values:Fn(a)}),(h.isDirty||h.dirtyFields||p.isDirty||p.dirtyFields)&&ye.shouldDirty&&x.state.next({name:te,dirtyFields:sf(s,a),isDirty:W(te,Le)})):Ve&&!Ve._f&&!Vs(Le)?ae(te,Le,ye):Y(te,Le,ye),FS(te,l)&&x.state.next({...t,name:te}),x.state.next({name:o.mount?te:void 0,values:Fn(a)})},ee=async te=>{o.mount=!0;const le=te.target;let ye=le.name,Ve=!0;const ze=nt(r,ye),Le=tt=>{Ve=Number.isNaN(tt)||ru(tt)&&isNaN(tt.getTime())||Na(tt,nt(a,ye,tt))},rt=lf(e.mode),Xe=lf(e.reValidateMode);if(ze){let tt,qt;const bt=le.type?tE(ze._f):C3(te),Et=te.type===Ix.BLUR||te.type===Ix.FOCUS_OUT,Xt=!TQ(ze._f)&&!e.resolver&&!nt(t.errors,ye)&&!ze._f.deps||MQ(Et,nt(t.touchedFields,ye),t.isSubmitted,Xe,rt),en=FS(ye,l,Et);hn(a,ye,bt),Et?(!le||!le.readOnly)&&(ze._f.onBlur&&ze._f.onBlur(te),c&&c(0)):ze._f.onChange&&ze._f.onChange(te);const Yt=O(ye,bt,Et),Ut=!ss(Yt)||en;if(!Et&&x.state.next({name:ye,type:te.type,values:Fn(a)}),Xt)return(h.isValid||p.isValid)&&(e.mode==="onBlur"?Et&&_():Et||_()),Ut&&x.state.next({name:ye,...en?{}:Yt});if(!Et&&en&&x.state.next({...t}),e.resolver){const{errors:Rn}=await q([ye]);if(Le(bt),Ve){const Nn=rE(t.errors,r,ye),an=rE(Rn,r,Nn.name||ye);tt=an.error,ye=an.name,qt=ss(Rn)}}else j([ye],!0),tt=(await qS(ze,l.disabled,a,v,e.shouldUseNativeValidation))[ye],j([ye]),Le(bt),Ve&&(tt?qt=!1:(h.isValid||p.isValid)&&(qt=await V(r,!0)));Ve&&(ze._f.deps&&(!Array.isArray(ze._f.deps)||ze._f.deps.length>0)&&Z(ze._f.deps),I(ye,qt,tt,Yt))}},X=(te,le)=>{if(nt(t.errors,le)&&te.focus)return te.focus(),1},Z=async(te,le={})=>{let ye,Ve;const ze=$s(te);if(e.resolver){const Le=await F(An(te)?te:ze);ye=ss(Le),Ve=te?!ze.some(rt=>nt(Le,rt)):ye}else te?(Ve=(await Promise.all(ze.map(async Le=>{const rt=nt(r,Le);return await V(rt&&rt._f?{[Le]:rt}:rt)}))).every(Boolean),!(!Ve&&!t.isValid)&&_()):Ve=ye=await V(r);return x.state.next({...!mi(te)||(h.isValid||p.isValid)&&ye!==t.isValid?{}:{name:te},...e.resolver||!te?{isValid:ye}:{},errors:t.errors}),le.shouldFocus&&!Ve&&pf(r,X,te?ze:l.mount),Ve},oe=(te,le)=>{let ye={...o.mount?a:s};return le&&(ye=E3(le.dirtyFields?t.dirtyFields:t.touchedFields,ye)),An(te)?ye:mi(te)?nt(ye,te):te.map(Ve=>nt(ye,Ve))},H=(te,le)=>({invalid:!!nt((le||t).errors,te),isDirty:!!nt((le||t).dirtyFields,te),error:nt((le||t).errors,te),isValidating:!!nt(t.validatingFields,te),isTouched:!!nt((le||t).touchedFields,te)}),Q=te=>{te&&$s(te).forEach(le=>ir(t.errors,le)),x.state.next({errors:te?t.errors:{}})},re=(te,le,ye)=>{const Ve=(nt(r,te,{_f:{}})._f||{}).ref,ze=nt(t.errors,te)||{},{ref:Le,message:rt,type:Xe,...tt}=ze;hn(t.errors,te,{...tt,...le,ref:Ve}),x.state.next({name:te,errors:t.errors,isValid:!1}),ye&&ye.shouldFocus&&Ve&&Ve.focus&&Ve.focus()},de=(te,le)=>Sa(te)?x.state.subscribe({next:ye=>"values"in ye&&te($(void 0,le),ye)}):$(te,le,!0),ce=te=>x.state.subscribe({next:le=>{PQ(te.name,le.name,te.exact)&&kQ(le,te.formState||h,Ue,te.reRenderRoot)&&te.callback({values:{...a},...t,...le,defaultValues:s})}}).unsubscribe,pe=te=>(o.mount=!0,p={...p,...te.formState},ce({...te,formState:p})),ie=(te,le={})=>{for(const ye of te?$s(te):l.mount)l.mount.delete(ye),l.array.delete(ye),le.keepValue||(ir(r,ye),ir(a,ye)),!le.keepError&&ir(t.errors,ye),!le.keepDirty&&ir(t.dirtyFields,ye),!le.keepTouched&&ir(t.touchedFields,ye),!le.keepIsValidating&&ir(t.validatingFields,ye),!e.shouldUnregister&&!le.keepDefaultValue&&ir(s,ye);x.state.next({values:Fn(a)}),x.state.next({...t,...le.keepDirty?{isDirty:W()}:{}}),!le.keepIsValid&&_()},xe=({disabled:te,name:le})=>{(di(te)&&o.mount||te||l.disabled.has(le))&&(te?l.disabled.add(le):l.disabled.delete(le))},Ce=(te,le={})=>{let ye=nt(r,te);const Ve=di(le.disabled)||di(e.disabled);return hn(r,te,{...ye||{},_f:{...ye&&ye._f?ye._f:{ref:{name:te}},name:te,mount:!0,...le}}),l.mount.add(te),ye?xe({disabled:di(le.disabled)?le.disabled:e.disabled,name:te}):M(te,!0,le.value),{...Ve?{disabled:le.disabled||e.disabled}:{},...e.progressive?{required:!!le.required,min:_h(le.min),max:_h(le.max),minLength:_h(le.minLength),maxLength:_h(le.maxLength),pattern:_h(le.pattern)}:{},name:te,onChange:ee,onBlur:ee,ref:ze=>{if(ze){Ce(te,le),ye=nt(r,te);const Le=An(ze.value)&&ze.querySelectorAll&&ze.querySelectorAll("input,select,textarea")[0]||ze,rt=wQ(Le),Xe=ye._f.refs||[];if(rt?Xe.find(tt=>tt===Le):Le===ye._f.ref)return;hn(r,te,{_f:{...ye._f,...rt?{refs:[...Xe.filter(pb),Le,...Array.isArray(nt(s,te))?[{}]:[]],ref:{type:Le.type,name:te}}:{ref:Le}}}),M(te,!1,void 0,Le)}else ye=nt(r,te,{}),ye._f&&(ye._f.mount=!1),(e.shouldUnregister||le.shouldUnregister)&&!(T3(l.array,te)&&o.action)&&l.unMount.add(te)}}},ve=()=>e.shouldFocusError&&pf(r,X,l.mount),Oe=te=>{di(te)&&(x.state.next({disabled:te}),pf(r,(le,ye)=>{const Ve=nt(r,ye);Ve&&(le.disabled=Ve._f.disabled||te,Array.isArray(Ve._f.refs)&&Ve._f.refs.forEach(ze=>{ze.disabled=Ve._f.disabled||te}))},0,!1))},Pe=(te,le)=>async ye=>{let Ve;ye&&(ye.preventDefault&&ye.preventDefault(),ye.persist&&ye.persist());let ze=Fn(a);if(x.state.next({isSubmitting:!0}),e.resolver){const{errors:Le,values:rt}=await q();t.errors=Le,ze=Fn(rt)}else await V(r);if(l.disabled.size)for(const Le of l.disabled)ir(ze,Le);if(ir(t.errors,"root"),ss(t.errors)){x.state.next({errors:{}});try{await te(ze,ye)}catch(Le){Ve=Le}}else le&&await le({...t.errors},ye),ve(),setTimeout(ve);if(x.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ss(t.errors)&&!Ve,submitCount:t.submitCount+1,errors:t.errors}),Ve)throw Ve},Ie=(te,le={})=>{nt(r,te)&&(An(le.defaultValue)?J(te,Fn(nt(s,te))):(J(te,le.defaultValue),hn(s,te,Fn(le.defaultValue))),le.keepTouched||ir(t.touchedFields,te),le.keepDirty||(ir(t.dirtyFields,te),t.isDirty=le.defaultValue?W(te,Fn(nt(s,te))):W()),le.keepError||(ir(t.errors,te),h.isValid&&_()),x.state.next({...t}))},Fe=(te,le={})=>{const ye=te?Fn(te):s,Ve=Fn(ye),ze=ss(te),Le=ze?s:Ve;if(le.keepDefaultValues||(s=ye),!le.keepValues){if(le.keepDirtyValues){const rt=new Set([...l.mount,...Object.keys(sf(s,a))]);for(const Xe of Array.from(rt))nt(t.dirtyFields,Xe)?hn(Le,Xe,nt(a,Xe)):J(Xe,nt(Le,Xe))}else{if(AC&&An(te))for(const rt of l.mount){const Xe=nt(r,rt);if(Xe&&Xe._f){const tt=Array.isArray(Xe._f.refs)?Xe._f.refs[0]:Xe._f.ref;if(Ax(tt)){const qt=tt.closest("form");if(qt){qt.reset();break}}}}if(le.keepFieldsRef)for(const rt of l.mount)J(rt,nt(Le,rt));else r={}}a=e.shouldUnregister?le.keepDefaultValues?Fn(s):{}:Fn(Le),x.array.next({values:{...Le}}),x.state.next({values:{...Le}})}l={mount:le.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!h.isValid||!!le.keepIsValid||!!le.keepDirtyValues||!e.shouldUnregister&&!ss(Le),o.watch=!!e.shouldUnregister,x.state.next({submitCount:le.keepSubmitCount?t.submitCount:0,isDirty:ze?!1:le.keepDirty?t.isDirty:!!(le.keepDefaultValues&&!Na(te,s)),isSubmitted:le.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ze?{}:le.keepDirtyValues?le.keepDefaultValues&&a?sf(s,a):t.dirtyFields:le.keepDefaultValues&&te?sf(s,te):le.keepDirty?t.dirtyFields:{},touchedFields:le.keepTouched?t.touchedFields:{},errors:le.keepErrors?t.errors:{},isSubmitSuccessful:le.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},we=(te,le)=>Fe(Sa(te)?te(a):te,le),Ne=(te,le={})=>{const ye=nt(r,te),Ve=ye&&ye._f;if(Ve){const ze=Ve.refs?Ve.refs[0]:Ve.ref;ze.focus&&(ze.focus(),le.shouldSelect&&Sa(ze.select)&&ze.select())}},Ue=te=>{t={...t,...te}},qe={control:{register:Ce,unregister:ie,getFieldState:H,handleSubmit:Pe,setError:re,_subscribe:ce,_runSchema:q,_focusError:ve,_getWatch:$,_getDirty:W,_setValid:_,_setFieldArray:T,_setDisabledField:xe,_setErrors:D,_getFieldArray:ne,_reset:Fe,_resetDefaultValues:()=>Sa(e.defaultValues)&&e.defaultValues().then(te=>{we(te,e.resetOptions),x.state.next({isLoading:!1})}),_removeUnmounted:U,_disableForm:Oe,_subjects:x,_proxyFormState:h,get _fields(){return r},get _formValues(){return a},get _state(){return o},set _state(te){o=te},get _defaultValues(){return s},get _names(){return l},set _names(te){l=te},get _formState(){return t},get _options(){return e},set _options(te){e={...e,...te}}},subscribe:pe,trigger:Z,register:Ce,handleSubmit:Pe,watch:de,setValue:J,getValues:oe,reset:we,resetField:Ie,clearErrors:Q,unregister:ie,setError:re,setFocus:Ne,getFieldState:H};return{...qe,formControl:qe}}var Nc=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const n=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=(Math.random()*16+n)%16|0;return(e=="x"?t:t&3|8).toString(16)})},gb=(n,e,t={})=>t.shouldFocus||An(t.shouldFocus)?t.focusName||`${n}.${An(t.focusIndex)?e:t.focusIndex}.`:"",xb=(n,e)=>[...n,...$s(e)],yb=n=>Array.isArray(n)?n.map(()=>{}):void 0;function vb(n,e,t){return[...n.slice(0,e),...$s(t),...n.slice(e)]}var bb=(n,e,t)=>Array.isArray(n)?(An(n[t])&&(n[t]=void 0),n.splice(t,0,n.splice(e,1)[0]),n):[],wb=(n,e)=>[...$s(e),...$s(n)];function IQ(n,e){let t=0;const r=[...n];for(const s of e)r.splice(s-t,1),t++;return dy(r).length?r:[]}var _b=(n,e)=>An(e)?[]:IQ(n,$s(e).sort((t,r)=>t-r)),jb=(n,e,t)=>{[n[e],n[t]]=[n[t],n[e]]},iE=(n,e,t)=>(n[e]=t,n);function js(n){const e=uy(),{control:t=e.control,name:r,keyName:s="id",shouldUnregister:a,rules:o}=n,[l,c]=ot.useState(t._getFieldArray(r)),d=ot.useRef(t._getFieldArray(r).map(Nc)),h=ot.useRef(!1);t._names.array.add(r),ot.useMemo(()=>o&&l.length>=0&&t.register(r,o),[t,r,l.length,o]),fy(()=>t._subjects.array.subscribe({next:({values:M,name:O})=>{if(O===r||!O){const I=nt(M,r);Array.isArray(I)&&(c(I),d.current=I.map(Nc))}}}).unsubscribe,[t,r]);const p=ot.useCallback(M=>{h.current=!0,t._setFieldArray(r,M)},[t,r]),x=(M,O)=>{const I=$s(Fn(M)),q=xb(t._getFieldArray(r),I);t._names.focus=gb(r,q.length-1,O),d.current=xb(d.current,I.map(Nc)),p(q),c(q),t._setFieldArray(r,q,xb,{argA:yb(M)})},v=(M,O)=>{const I=$s(Fn(M)),q=wb(t._getFieldArray(r),I);t._names.focus=gb(r,0,O),d.current=wb(d.current,I.map(Nc)),p(q),c(q),t._setFieldArray(r,q,wb,{argA:yb(M)})},w=M=>{const O=_b(t._getFieldArray(r),M);d.current=_b(d.current,M),p(O),c(O),!Array.isArray(nt(t._fields,r))&&hn(t._fields,r,void 0),t._setFieldArray(r,O,_b,{argA:M})},_=(M,O,I)=>{const q=$s(Fn(O)),F=vb(t._getFieldArray(r),M,q);t._names.focus=gb(r,M,I),d.current=vb(d.current,M,q.map(Nc)),p(F),c(F),t._setFieldArray(r,F,vb,{argA:M,argB:yb(O)})},j=(M,O)=>{const I=t._getFieldArray(r);jb(I,M,O),jb(d.current,M,O),p(I),c(I),t._setFieldArray(r,I,jb,{argA:M,argB:O},!1)},T=(M,O)=>{const I=t._getFieldArray(r);bb(I,M,O),bb(d.current,M,O),p(I),c(I),t._setFieldArray(r,I,bb,{argA:M,argB:O},!1)},P=(M,O)=>{const I=Fn(O),q=iE(t._getFieldArray(r),M,I);d.current=[...q].map((F,V)=>!F||V===M?Nc():d.current[V]),p(q),c([...q]),t._setFieldArray(r,q,iE,{argA:M,argB:I},!0,!1)},D=M=>{const O=$s(Fn(M));d.current=O.map(Nc),p([...O]),c([...O]),t._setFieldArray(r,[...O],I=>I,{},!0,!1)};return ot.useEffect(()=>{if(t._state.action=!1,FS(r,t._names)&&t._subjects.state.next({...t._formState}),h.current&&(!lf(t._options.mode).isOnSubmit||t._formState.isSubmitted)&&!lf(t._options.reValidateMode).isOnSubmit)if(t._options.resolver)t._runSchema([r]).then(M=>{const O=nt(M.errors,r),I=nt(t._formState.errors,r);(I?!O&&I.type||O&&(I.type!==O.type||I.message!==O.message):O&&O.type)&&(O?hn(t._formState.errors,r,O):ir(t._formState.errors,r),t._subjects.state.next({errors:t._formState.errors}))});else{const M=nt(t._fields,r);M&&M._f&&!(lf(t._options.reValidateMode).isOnSubmit&&lf(t._options.mode).isOnSubmit)&&qS(M,t._names.disabled,t._formValues,t._options.criteriaMode===Wi.all,t._options.shouldUseNativeValidation,!0).then(O=>!ss(O)&&t._subjects.state.next({errors:L3(t._formState.errors,O,r)}))}t._subjects.state.next({name:r,values:Fn(t._formValues)}),t._names.focus&&pf(t._fields,(M,O)=>{if(t._names.focus&&O.startsWith(t._names.focus)&&M.focus)return M.focus(),1}),t._names.focus="",t._setValid(),h.current=!1},[l,r,t]),ot.useEffect(()=>(!nt(t._formValues,r)&&t._setFieldArray(r),()=>{const M=(O,I)=>{const q=nt(t._fields,O);q&&q._f&&(q._f.mount=I)};t._options.shouldUnregister||a?t.unregister(r):M(r,!1)}),[r,t,s,a]),{swap:ot.useCallback(j,[p,r,t]),move:ot.useCallback(T,[p,r,t]),prepend:ot.useCallback(v,[p,r,t]),append:ot.useCallback(x,[p,r,t]),remove:ot.useCallback(w,[p,r,t]),insert:ot.useCallback(_,[p,r,t]),update:ot.useCallback(P,[p,r,t]),replace:ot.useCallback(D,[p,r,t]),fields:ot.useMemo(()=>l.map((M,O)=>({...M,[s]:d.current[O]||Nc()})),[l,s])}}function tn(n={}){const e=ot.useRef(void 0),t=ot.useRef(void 0),[r,s]=ot.useState({isDirty:!1,isValidating:!1,isLoading:Sa(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:Sa(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:r},n.defaultValues&&!Sa(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=OQ(n);e.current={...l,formState:r}}const a=e.current.control;return a._options=n,fy(()=>{const o=a._subscribe({formState:a._proxyFormState,callback:()=>s({...a._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),a._formState.isReady=!0,o},[a]),ot.useEffect(()=>a._disableForm(n.disabled),[a,n.disabled]),ot.useEffect(()=>{n.mode&&(a._options.mode=n.mode),n.reValidateMode&&(a._options.reValidateMode=n.reValidateMode)},[a,n.mode,n.reValidateMode]),ot.useEffect(()=>{n.errors&&(a._setErrors(n.errors),a._focusError())},[a,n.errors]),ot.useEffect(()=>{n.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,n.shouldUnregister]),ot.useEffect(()=>{if(a._proxyFormState.isDirty){const o=a._getDirty();o!==r.isDirty&&a._subjects.state.next({isDirty:o})}},[a,r.isDirty]),ot.useEffect(()=>{n.values&&!Na(n.values,t.current)?(a._reset(n.values,{keepFieldsRef:!0,...a._options.resetOptions}),t.current=n.values,s(o=>({...o}))):a._resetDefaultValues()},[a,n.values]),ot.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),e.current.formState=P3(r,a),e.current}const aE=(n,e,t)=>{if(n&&"reportValidity"in n){const r=nt(t,e);n.setCustomValidity(r&&r.message||""),n.reportValidity()}},F3=(n,e)=>{for(const t in e.fields){const r=e.fields[t];r&&r.ref&&"reportValidity"in r.ref?aE(r.ref,t,n):r.refs&&r.refs.forEach(s=>aE(s,t,n))}},AQ=(n,e)=>{e.shouldUseNativeValidation&&F3(n,e);const t={};for(const r in n){const s=nt(e.fields,r),a=Object.assign(n[r]||{},{ref:s&&s.ref});if(RQ(e.names||Object.keys(n),r)){const o=Object.assign({},nt(t,r));hn(o,"root",a),hn(t,r,o)}else hn(t,r,a)}return t},RQ=(n,e)=>n.some(t=>t.startsWith(e+"."));function En(n,e,t){return e===void 0&&(e={}),t===void 0&&(t={}),function(r,s,a){try{return Promise.resolve((function(o,l){try{var c=(e.context,Promise.resolve(n[t.mode==="sync"?"validateSync":"validate"](r,Object.assign({abortEarly:!1},e,{context:s}))).then(function(d){return a.shouldUseNativeValidation&&F3({},a),{values:t.raw?r:d,errors:{}}}))}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c})(0,function(o){if(!o.inner)throw o;return{values:{},errors:AQ((l=o,c=!a.shouldUseNativeValidation&&a.criteriaMode==="all",(l.inner||[]).reduce(function(d,h){if(d[h.path]||(d[h.path]={message:h.message,type:h.type}),c){var p=d[h.path].types,x=p&&p[h.type];d[h.path]=M3(h.path,c,d,h.type,x?[].concat(x,h.message):h.message)}return d},{})),a)};var l,c}))}catch(o){return Promise.reject(o)}}}var Nb,oE;function LQ(){if(oE)return Nb;oE=1;function n(T){this._maxSize=T,this.clear()}n.prototype.clear=function(){this._size=0,this._values=Object.create(null)},n.prototype.get=function(T){return this._values[T]},n.prototype.set=function(T,P){return this._size>=this._maxSize&&this.clear(),T in this._values||this._size++,this._values[T]=P};var e=/[^.^\]^[]+|(?=\[\]|\.\.)/g,t=/^\d+$/,r=/^\d/,s=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,a=/^\s*(['"]?)(.*?)(\1)\s*$/,o=512,l=new n(o),c=new n(o),d=new n(o);Nb={Cache:n,split:p,normalizePath:h,setter:function(T){var P=h(T);return c.get(T)||c.set(T,function(M,O){for(var I=0,q=P.length,F=M;I<q-1;){var V=P[I];if(V==="__proto__"||V==="constructor"||V==="prototype")return M;F=F[P[I++]]}F[P[I]]=O})},getter:function(T,P){var D=h(T);return d.get(T)||d.set(T,function(O){for(var I=0,q=D.length;I<q;)if(O!=null||!P)O=O[D[I++]];else return;return O})},join:function(T){return T.reduce(function(P,D){return P+(v(D)||t.test(D)?"["+D+"]":(P?".":"")+D)},"")},forEach:function(T,P,D){x(Array.isArray(T)?T:p(T),P,D)}};function h(T){return l.get(T)||l.set(T,p(T).map(function(P){return P.replace(a,"$2")}))}function p(T){return T.match(e)||[""]}function x(T,P,D){var M=T.length,O,I,q,F;for(I=0;I<M;I++)O=T[I],O&&(j(O)&&(O='"'+O+'"'),F=v(O),q=!F&&/^\d+$/.test(O),P.call(D,O,F,q,I,T))}function v(T){return typeof T=="string"&&T&&["'",'"'].indexOf(T.charAt(0))!==-1}function w(T){return T.match(r)&&!T.match(t)}function _(T){return s.test(T)}function j(T){return!v(T)&&(w(T)||_(T))}return Nb}var ou=LQ(),Sb,lE;function FQ(){if(lE)return Sb;lE=1;const n=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,e=h=>h.match(n)||[],t=h=>h[0].toUpperCase()+h.slice(1),r=(h,p)=>e(h).join(p).toLowerCase(),s=h=>e(h).reduce((p,x)=>`${p}${p?x[0].toUpperCase()+x.slice(1).toLowerCase():x.toLowerCase()}`,"");return Sb={words:e,upperFirst:t,camelCase:s,pascalCase:h=>t(s(h)),snakeCase:h=>r(h,"_"),kebabCase:h=>r(h,"-"),sentenceCase:h=>t(r(h," ")),titleCase:h=>e(h).map(t).join(" ")},Sb}var Cb=FQ(),$p={exports:{}},cE;function qQ(){if(cE)return $p.exports;cE=1,$p.exports=function(s){return n(e(s),s)},$p.exports.array=n;function n(s,a){var o=s.length,l=new Array(o),c={},d=o,h=t(a),p=r(s);for(a.forEach(function(v){if(!p.has(v[0])||!p.has(v[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});d--;)c[d]||x(s[d],d,new Set);return l;function x(v,w,_){if(_.has(v)){var j;try{j=", node was:"+JSON.stringify(v)}catch{j=""}throw new Error("Cyclic dependency"+j)}if(!p.has(v))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(v));if(!c[w]){c[w]=!0;var T=h.get(v)||new Set;if(T=Array.from(T),w=T.length){_.add(v);do{var P=T[--w];x(P,p.get(P),_)}while(w);_.delete(v)}l[--o]=v}}}function e(s){for(var a=new Set,o=0,l=s.length;o<l;o++){var c=s[o];a.add(c[0]),a.add(c[1])}return Array.from(a)}function t(s){for(var a=new Map,o=0,l=s.length;o<l;o++){var c=s[o];a.has(c[0])||a.set(c[0],new Set),a.has(c[1])||a.set(c[1],new Set),a.get(c[0]).add(c[1])}return a}function r(s){for(var a=new Map,o=0,l=s.length;o<l;o++)a.set(s[o],o);return a}return $p.exports}var zQ=qQ();const UQ=gu(zQ),VQ=Object.prototype.toString,BQ=Error.prototype.toString,WQ=RegExp.prototype.toString,$Q=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",HQ=/^Symbol\((.*)\)(.*)$/;function YQ(n){return n!=+n?"NaN":n===0&&1/n<0?"-0":""+n}function dE(n,e=!1){if(n==null||n===!0||n===!1)return""+n;const t=typeof n;if(t==="number")return YQ(n);if(t==="string")return e?`"${n}"`:n;if(t==="function")return"[Function "+(n.name||"anonymous")+"]";if(t==="symbol")return $Q.call(n).replace(HQ,"Symbol($1)");const r=VQ.call(n).slice(8,-1);return r==="Date"?isNaN(n.getTime())?""+n:n.toISOString(n):r==="Error"||n instanceof Error?"["+BQ.call(n)+"]":r==="RegExp"?WQ.call(n):null}function jl(n,e){let t=dE(n,e);return t!==null?t:JSON.stringify(n,function(r,s){let a=dE(this[r],e);return a!==null?a:s},2)}function q3(n){return n==null?[]:[].concat(n)}let z3,U3,V3,GQ=/\$\{\s*(\w+)\s*\}/g;z3=Symbol.toStringTag;class uE{constructor(e,t,r,s){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[z3]="Error",this.name="ValidationError",this.value=t,this.path=r,this.type=s,this.errors=[],this.inner=[],q3(e).forEach(a=>{if(ws.isError(a)){this.errors.push(...a.errors);const o=a.inner.length?a.inner:[a];this.inner.push(...o)}else this.errors.push(a)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}U3=Symbol.hasInstance;V3=Symbol.toStringTag;class ws extends Error{static formatError(e,t){const r=t.label||t.path||"this";return t=Object.assign({},t,{path:r,originalPath:t.path}),typeof e=="string"?e.replace(GQ,(s,a)=>jl(t[a])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,r,s,a){const o=new uE(e,t,r,s);if(a)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[V3]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,ws)}static[U3](e){return uE[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let go={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:n,type:e,value:t,originalValue:r})=>{const s=r!=null&&r!==t?` (cast from the value \`${jl(r,!0)}\`).`:".";return e!=="mixed"?`${n} must be a \`${e}\` type, but the final value was: \`${jl(t,!0)}\``+s:`${n} must match the configured type. The validated value was: \`${jl(t,!0)}\``+s}},Us={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},Mc={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},zS={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},US={isValue:"${path} field must be ${value}"},cx={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},dx={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},ZQ={notType:n=>{const{path:e,value:t,spec:r}=n,s=r.types.length;if(Array.isArray(t)){if(t.length<s)return`${e} tuple value has too few items, expected a length of ${s} but got ${t.length} for value: \`${jl(t,!0)}\``;if(t.length>s)return`${e} tuple value has too many items, expected a length of ${s} but got ${t.length} for value: \`${jl(t,!0)}\``}return ws.formatError(go.notType,n)}};Object.assign(Object.create(null),{mixed:go,string:Us,number:Mc,date:zS,object:cx,array:dx,boolean:US,tuple:ZQ});const hy=n=>n&&n.__isYupSchema__;class Lx{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:r,then:s,otherwise:a}=t,o=typeof r=="function"?r:(...l)=>l.every(c=>c===r);return new Lx(e,(l,c)=>{var d;let h=o(...l)?s:a;return(d=h?.(c))!=null?d:c})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let r=this.refs.map(a=>a.getValue(t?.value,t?.parent,t?.context)),s=this.fn(r,e,t);if(s===void 0||s===e)return e;if(!hy(s))throw new TypeError("conditions must return a schema object");return s.resolve(t)}}const Hp={context:"$",value:"."};function qC(n,e){return new ed(n,e)}class ed{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===Hp.context,this.isValue=this.key[0]===Hp.value,this.isSibling=!this.isContext&&!this.isValue;let r=this.isContext?Hp.context:this.isValue?Hp.value:"";this.path=this.key.slice(r.length),this.getter=this.path&&ou.getter(this.path,!0),this.map=t.map}getValue(e,t,r){let s=this.isContext?r:this.isValue?e:t;return this.getter&&(s=this.getter(s||{})),this.map&&(s=this.map(s)),s}cast(e,t){return this.getValue(e,t?.parent,t?.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}ed.prototype.__isYupRef=!0;const Ca=n=>n==null;function Ku(n){function e({value:t,path:r="",options:s,originalValue:a,schema:o},l,c){const{name:d,test:h,params:p,message:x,skipAbsent:v}=n;let{parent:w,context:_,abortEarly:j=o.spec.abortEarly,disableStackTrace:T=o.spec.disableStackTrace}=s;const P={value:t,parent:w,context:_};function D(W={}){const $=B3(Object.assign({value:t,originalValue:a,label:o.spec.label,path:W.path||r,spec:o.spec,disableStackTrace:W.disableStackTrace||T},p,W.params),P),ne=new ws(ws.formatError(W.message||x,$),t,$.path,W.type||d,$.disableStackTrace);return ne.params=$,ne}const M=j?l:c;let O={path:r,parent:w,type:d,from:s.from,createError:D,resolve(W){return W3(W,P)},options:s,originalValue:a,schema:o};const I=W=>{ws.isError(W)?M(W):W?c(null):M(D())},q=W=>{ws.isError(W)?M(W):l(W)};if(v&&Ca(t))return I(!0);let V;try{var U;if(V=h.call(O,t,O),typeof((U=V)==null?void 0:U.then)=="function"){if(s.sync)throw new Error(`Validation test of type: "${O.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(V).then(I,q)}}catch(W){q(W);return}I(V)}return e.OPTIONS=n,e}function B3(n,e){if(!n)return n;for(const t of Object.keys(n))n[t]=W3(n[t],e);return n}function W3(n,e){return ed.isRef(n)?n.getValue(e.value,e.parent,e.context):n}function KQ(n,e,t,r=t){let s,a,o;return e?(ou.forEach(e,(l,c,d)=>{let h=c?l.slice(1,l.length-1):l;n=n.resolve({context:r,parent:s,value:t});let p=n.type==="tuple",x=d?parseInt(h,10):0;if(n.innerType||p){if(p&&!d)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&x>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${l}, in the path: ${e}. because there is no value at that index. `);s=t,t=t&&t[x],n=p?n.spec.types[x]:n.innerType}if(!d){if(!n.fields||!n.fields[h])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${n.type}")`);s=t,t=t&&t[h],n=n.fields[h]}a=h,o=c?"["+l+"]":"."+l}),{schema:n,parent:s,parentPath:a}):{parent:s,parentPath:e,schema:n}}class Fx extends Set{describe(){const e=[];for(const t of this.values())e.push(ed.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const r of this.values())t.push(e(r));return t}clone(){return new Fx(this.values())}merge(e,t){const r=this.clone();return e.forEach(s=>r.add(s)),t.forEach(s=>r.delete(s)),r}}function cf(n,e=new Map){if(hy(n)||!n||typeof n!="object")return n;if(e.has(n))return e.get(n);let t;if(n instanceof Date)t=new Date(n.getTime()),e.set(n,t);else if(n instanceof RegExp)t=new RegExp(n),e.set(n,t);else if(Array.isArray(n)){t=new Array(n.length),e.set(n,t);for(let r=0;r<n.length;r++)t[r]=cf(n[r],e)}else if(n instanceof Map){t=new Map,e.set(n,t);for(const[r,s]of n.entries())t.set(r,cf(s,e))}else if(n instanceof Set){t=new Set,e.set(n,t);for(const r of n)t.add(cf(r,e))}else if(n instanceof Object){t={},e.set(n,t);for(const[r,s]of Object.entries(n))t[r]=cf(s,e)}else throw Error(`Unable to clone ${n}`);return t}function JQ(n){if(!(n!=null&&n.length))return;const e=[];let t="",r=!1,s=!1;for(let a=0;a<n.length;a++){const o=n[a];if(o==="["&&!s){t&&(e.push(...t.split(".").filter(Boolean)),t=""),r=!0;continue}if(o==="]"&&!s){t&&(/^\d+$/.test(t)?e.push(t):e.push(t.replace(/^"|"$/g,"")),t=""),r=!1;continue}if(o==='"'){s=!s;continue}if(o==="."&&!r&&!s){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(...t.split(".").filter(Boolean)),e}function QQ(n,e){const t=e?`${e}.${n.path}`:n.path;return n.errors.map(r=>({message:r,path:JQ(t)}))}function $3(n,e){var t;if(!((t=n.inner)!=null&&t.length)&&n.errors.length)return QQ(n,e);const r=e?`${e}.${n.path}`:n.path;return n.inner.flatMap(s=>$3(s,r))}class Ys{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new Fx,this._blacklist=new Fx,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(go.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e?.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=cf(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let r=e(this);return this._mutate=t,r}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,r=e.clone();const s=Object.assign({},t.spec,r.spec);return r.spec=s,r.internalTests=Object.assign({},t.internalTests,r.internalTests),r._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),r._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),r.tests=t.tests,r.exclusiveTests=t.exclusiveTests,r.withMutation(a=>{e.tests.forEach(o=>{a.test(o.OPTIONS)})}),r.transforms=[...t.transforms,...r.transforms],r}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let r=t.conditions;t=t.clone(),t.conditions=[],t=r.reduce((s,a)=>a.resolve(s,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,r,s,a;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(r=e.abortEarly)!=null?r:this.spec.abortEarly,recursive:(s=e.recursive)!=null?s:this.spec.recursive,disableStackTrace:(a=e.disableStackTrace)!=null?a:this.spec.disableStackTrace})}cast(e,t={}){let r=this.resolve(Object.assign({},t,{value:e})),s=t.assert==="ignore-optionality",a=r._cast(e,t);if(t.assert!==!1&&!r.isType(a)){if(s&&Ca(a))return a;let o=jl(e),l=jl(a);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${r.type}". 

attempted value: ${o} 
`+(l!==o?`result of cast: ${l}`:""))}return a}_cast(e,t){let r=e===void 0?e:this.transforms.reduce((s,a)=>a.call(this,s,e,this,t),e);return r===void 0&&(r=this.getDefault(t)),r}_validate(e,t={},r,s){let{path:a,originalValue:o=e,strict:l=this.spec.strict}=t,c=e;l||(c=this._cast(c,Object.assign({assert:!1},t)));let d=[];for(let h of Object.values(this.internalTests))h&&d.push(h);this.runTests({path:a,value:c,originalValue:o,options:t,tests:d},r,h=>{if(h.length)return s(h,c);this.runTests({path:a,value:c,originalValue:o,options:t,tests:this.tests},r,s)})}runTests(e,t,r){let s=!1,{tests:a,value:o,originalValue:l,path:c,options:d}=e,h=_=>{s||(s=!0,t(_,o))},p=_=>{s||(s=!0,r(_,o))},x=a.length,v=[];if(!x)return p([]);let w={value:o,originalValue:l,path:c,options:d,schema:this};for(let _=0;_<a.length;_++){const j=a[_];j(w,h,function(P){P&&(Array.isArray(P)?v.push(...P):v.push(P)),--x<=0&&p(v)})}}asNestedTest({key:e,index:t,parent:r,parentPath:s,originalParent:a,options:o}){const l=e??t;if(l==null)throw TypeError("Must include `key` or `index` for nested validations");const c=typeof l=="number";let d=r[l];const h=Object.assign({},o,{strict:!0,parent:r,value:d,originalValue:a[l],key:void 0,[c?"index":"key"]:l,path:c||l.includes(".")?`${s||""}[${c?l:`"${l}"`}]`:(s?`${s}.`:"")+e});return(p,x,v)=>this.resolve(h)._validate(d,h,x,v)}validate(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),a=(r=t?.disableStackTrace)!=null?r:s.spec.disableStackTrace;return new Promise((o,l)=>s._validate(e,t,(c,d)=>{ws.isError(c)&&(c.value=d),l(c)},(c,d)=>{c.length?l(new ws(c,d,void 0,void 0,a)):o(d)}))}validateSync(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),a,o=(r=t?.disableStackTrace)!=null?r:s.spec.disableStackTrace;return s._validate(e,Object.assign({},t,{sync:!0}),(l,c)=>{throw ws.isError(l)&&(l.value=c),l},(l,c)=>{if(l.length)throw new ws(l,e,void 0,void 0,o);a=c}),a}isValid(e,t){return this.validate(e,t).then(()=>!0,r=>{if(ws.isError(r))return!1;throw r})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(r){if(ws.isError(r))return!1;throw r}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):cf(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const r=this.clone({nullable:e});return r.internalTests.nullable=Ku({message:t,name:"nullable",test(s){return s===null?this.schema.spec.nullable:!0}}),r}optionality(e,t){const r=this.clone({optional:e});return r.internalTests.optionality=Ku({message:t,name:"optionality",test(s){return s===void 0?this.schema.spec.optional:!0}}),r}optional(){return this.optionality(!0)}defined(e=go.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=go.notNull){return this.nullability(!1,e)}required(e=go.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=go.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let r=this.clone(),s=Ku(t),a=t.exclusive||t.name&&r.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(r.exclusiveTests[t.name]=!!t.exclusive),r.tests=r.tests.filter(o=>!(o.OPTIONS.name===t.name&&(a||o.OPTIONS.test===s.OPTIONS.test))),r.tests.push(s),r}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let r=this.clone(),s=q3(e).map(a=>new ed(a));return s.forEach(a=>{a.isSibling&&r.deps.push(a.key)}),r.conditions.push(typeof t=="function"?new Lx(s,t):Lx.fromOptions(s,t)),r}typeError(e){let t=this.clone();return t.internalTests.typeError=Ku({message:e,name:"typeError",skipAbsent:!0,test(r){return this.schema._typeCheck(r)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=go.oneOf){let r=this.clone();return e.forEach(s=>{r._whitelist.add(s),r._blacklist.delete(s)}),r.internalTests.whiteList=Ku({message:t,name:"oneOf",skipAbsent:!0,test(s){let a=this.schema._whitelist,o=a.resolveAll(this.resolve);return o.includes(s)?!0:this.createError({params:{values:Array.from(a).join(", "),resolved:o}})}}),r}notOneOf(e,t=go.notOneOf){let r=this.clone();return e.forEach(s=>{r._blacklist.add(s),r._whitelist.delete(s)}),r.internalTests.blacklist=Ku({message:t,name:"notOneOf",test(s){let a=this.schema._blacklist,o=a.resolveAll(this.resolve);return o.includes(s)?this.createError({params:{values:Array.from(a).join(", "),resolved:o}}):!0}}),r}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:r,meta:s,optional:a,nullable:o}=t.spec;return{meta:s,label:r,optional:a,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.filter((c,d,h)=>h.findIndex(p=>p.OPTIONS.name===c.OPTIONS.name)===d).map(c=>{const d=c.OPTIONS.params&&e?B3(Object.assign({},c.OPTIONS.params),e):c.OPTIONS.params;return{name:c.OPTIONS.name,params:d}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(r){try{return{value:await e.validate(r,{abortEarly:!1})}}catch(s){if(s instanceof ws)return{issues:$3(s)};throw s}}}}}Ys.prototype.__isYupSchema__=!0;for(const n of["validate","validateSync"])Ys.prototype[`${n}At`]=function(e,t,r={}){const{parent:s,parentPath:a,schema:o}=KQ(this,e,t,r.context);return o[n](s&&s[a],Object.assign({},r,{parent:s,path:e}))};for(const n of["equals","is"])Ys.prototype[n]=Ys.prototype.oneOf;for(const n of["not","nope"])Ys.prototype[n]=Ys.prototype.notOneOf;const XQ=()=>!0;function Wt(n){return new H3(n)}class H3 extends Ys{constructor(e){super(typeof e=="function"?{type:"mixed",check:e}:Object.assign({type:"mixed",check:XQ},e))}}Wt.prototype=H3.prototype;function is(){return new Y3}class Y3 extends Ys{constructor(){super({type:"boolean",check(e){return e instanceof Boolean&&(e=e.valueOf()),typeof e=="boolean"}}),this.withMutation(()=>{this.transform((e,t)=>{if(this.spec.coerce&&!this.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e})})}isTrue(e=US.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test(t){return Ca(t)||t===!0}})}isFalse(e=US.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test(t){return Ca(t)||t===!1}})}default(e){return super.default(e)}defined(e){return super.defined(e)}optional(){return super.optional()}required(e){return super.required(e)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(e){return super.nonNullable(e)}strip(e){return super.strip(e)}}is.prototype=Y3.prototype;const eX=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function tX(n){const e=VS(n);if(!e)return Date.parse?Date.parse(n):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function VS(n){var e,t;const r=eX.exec(n);return r?{year:ul(r[1]),month:ul(r[2],1)-1,day:ul(r[3],1),hour:ul(r[4]),minute:ul(r[5]),second:ul(r[6]),millisecond:r[7]?ul(r[7].substring(0,3)):0,precision:(e=(t=r[7])==null?void 0:t.length)!=null?e:void 0,z:r[8]||void 0,plusMinus:r[9]||void 0,hourOffset:ul(r[10]),minuteOffset:ul(r[11])}:null}function ul(n,e=0){return Number(n)||e}let nX=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,rX=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,sX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,iX="^\\d{4}-\\d{2}-\\d{2}",aX="\\d{2}:\\d{2}:\\d{2}",oX="(([+-]\\d{2}(:?\\d{2})?)|Z)",lX=new RegExp(`${iX}T${aX}(\\.\\d+)?${oX}$`),cX=n=>Ca(n)||n===n.trim(),dX={}.toString();function ge(){return new G3}class G3 extends Ys{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce||this.isType(e)||Array.isArray(e))return e;const r=e!=null&&e.toString?e.toString():e;return r===dX?e:r})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||go.required,name:"required",skipAbsent:!0,test:r=>!!r.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=Us.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t=Us.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t=Us.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}matches(e,t){let r=!1,s,a;return t&&(typeof t=="object"?{excludeEmptyString:r=!1,message:s,name:a}=t:s=t),this.test({name:a||"matches",message:s||Us.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&r||o.search(e)!==-1})}email(e=Us.email){return this.matches(nX,{name:"email",message:e,excludeEmptyString:!0})}url(e=Us.url){return this.matches(rX,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=Us.uuid){return this.matches(sX,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",r,s;return e&&(typeof e=="object"?{message:t="",allowOffset:r=!1,precision:s=void 0}=e:t=e),this.matches(lX,{name:"datetime",message:t||Us.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||Us.datetime_offset,params:{allowOffset:r},skipAbsent:!0,test:a=>{if(!a||r)return!0;const o=VS(a);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||Us.datetime_precision,params:{precision:s},skipAbsent:!0,test:a=>{if(!a||s==null)return!0;const o=VS(a);return o?o.precision===s:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=Us.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:cX})}lowercase(e=Us.lowercase){return this.transform(t=>Ca(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Ca(t)||t===t.toLowerCase()})}uppercase(e=Us.uppercase){return this.transform(t=>Ca(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Ca(t)||t===t.toUpperCase()})}}ge.prototype=G3.prototype;let uX=n=>n!=+n;function as(){return new Z3}class Z3 extends Ys{constructor(){super({type:"number",check(e){return e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&!uX(e)}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce)return e;let r=e;if(typeof r=="string"){if(r=r.replace(/\s/g,""),r==="")return NaN;r=+r}return this.isType(r)||r===null?r:parseFloat(r)})})}min(e,t=Mc.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r>=this.resolve(e)}})}max(e,t=Mc.max){return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r<=this.resolve(e)}})}lessThan(e,t=Mc.lessThan){return this.test({message:t,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test(r){return r<this.resolve(e)}})}moreThan(e,t=Mc.moreThan){return this.test({message:t,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test(r){return r>this.resolve(e)}})}positive(e=Mc.positive){return this.moreThan(0,e)}negative(e=Mc.negative){return this.lessThan(0,e)}integer(e=Mc.integer){return this.test({name:"integer",message:e,skipAbsent:!0,test:t=>Number.isInteger(t)})}truncate(){return this.transform(e=>Ca(e)?e:e|0)}round(e){var t;let r=["ceil","floor","round","trunc"];if(e=((t=e)==null?void 0:t.toLowerCase())||"round",e==="trunc")return this.truncate();if(r.indexOf(e.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+r.join(", "));return this.transform(s=>Ca(s)?s:Math[e](s))}}as.prototype=Z3.prototype;let fX=new Date(""),hX=n=>Object.prototype.toString.call(n)==="[object Date]";class zC extends Ys{constructor(){super({type:"date",check(e){return hX(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t)=>!this.spec.coerce||this.isType(e)||e===null?e:(e=tX(e),isNaN(e)?zC.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let r;if(ed.isRef(e))r=e;else{let s=this.cast(e);if(!this._typeCheck(s))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);r=s}return r}min(e,t=zS.min){let r=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s>=this.resolve(r)}})}max(e,t=zS.max){let r=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(s){return s<=this.resolve(r)}})}}zC.INVALID_DATE=fX;function mX(n,e=[]){let t=[],r=new Set,s=new Set(e.map(([o,l])=>`${o}-${l}`));function a(o,l){let c=ou.split(o)[0];r.add(c),s.has(`${l}-${c}`)||t.push([l,c])}for(const o of Object.keys(n)){let l=n[o];r.add(o),ed.isRef(l)&&l.isSibling?a(l.path,o):hy(l)&&"deps"in l&&l.deps.forEach(c=>a(c,o))}return UQ.array(Array.from(r),t).reverse()}function fE(n,e){let t=1/0;return n.some((r,s)=>{var a;if((a=e.path)!=null&&a.includes(r))return t=s,!0}),t}function K3(n){return(e,t)=>fE(n,e)-fE(n,t)}const J3=(n,e,t)=>{if(typeof n!="string")return n;let r=n;try{r=JSON.parse(n)}catch{}return t.isType(r)?r:n};function ux(n){if("fields"in n){const e={};for(const[t,r]of Object.entries(n.fields))e[t]=ux(r);return n.setFields(e)}if(n.type==="array"){const e=n.optional();return e.innerType&&(e.innerType=ux(e.innerType)),e}return n.type==="tuple"?n.optional().clone({types:n.spec.types.map(ux)}):"optional"in n?n.optional():n}const pX=(n,e)=>{const t=[...ou.normalizePath(e)];if(t.length===1)return t[0]in n;let r=t.pop(),s=ou.getter(ou.join(t),!0)(n);return!!(s&&r in s)};let hE=n=>Object.prototype.toString.call(n)==="[object Object]";function mE(n,e){let t=Object.keys(n.fields);return Object.keys(e).filter(r=>t.indexOf(r)===-1)}const gX=K3([]);function Pt(n){return new Q3(n)}class Q3 extends Ys{constructor(e){super({type:"object",check(t){return hE(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=gX,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var r;let s=super._cast(e,t);if(s===void 0)return this.getDefault(t);if(!this._typeCheck(s))return s;let a=this.fields,o=(r=t.stripUnknown)!=null?r:this.spec.noUnknown,l=[].concat(this._nodes,Object.keys(s).filter(p=>!this._nodes.includes(p))),c={},d=Object.assign({},t,{parent:c,__validating:t.__validating||!1}),h=!1;for(const p of l){let x=a[p],v=p in s,w=s[p];if(x){let _;d.path=(t.path?`${t.path}.`:"")+p,x=x.resolve({value:w,context:t.context,parent:c});let j=x instanceof Ys?x.spec:void 0,T=j?.strict;if(j!=null&&j.strip){h=h||p in s;continue}_=!t.__validating||!T?x.cast(w,d):w,_!==void 0&&(c[p]=_)}else v&&!o&&(c[p]=w);(v!==p in c||c[p]!==w)&&(h=!0)}return h?c:s}_validate(e,t={},r,s){let{from:a=[],originalValue:o=e,recursive:l=this.spec.recursive}=t;t.from=[{schema:this,value:o},...a],t.__validating=!0,t.originalValue=o,super._validate(e,t,r,(c,d)=>{if(!l||!hE(d)){s(c,d);return}o=o||d;let h=[];for(let p of this._nodes){let x=this.fields[p];!x||ed.isRef(x)||h.push(x.asNestedTest({options:t,key:p,parent:d,parentPath:t.path,originalParent:o}))}this.runTests({tests:h,value:d,originalValue:o,options:t},r,p=>{s(p.sort(this._sortErrors).concat(c),d)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),r=t.fields;for(let[s,a]of Object.entries(this.fields)){const o=r[s];r[s]=o===void 0?a:o}return t.withMutation(s=>s.setFields(r,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(r=>{var s;const a=this.fields[r];let o=e;(s=o)!=null&&s.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[r]})),t[r]=a&&"getDefault"in a?a.getDefault(o):void 0}),t}setFields(e,t){let r=this.clone();return r.fields=e,r._nodes=mX(e,t),r._sortErrors=K3(Object.keys(e)),t&&(r._excludedEdges=t),r}shape(e,t=[]){return this.clone().withMutation(r=>{let s=r._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),s=[...r._excludedEdges,...t]),r.setFields(Object.assign(r.fields,e),s)})}partial(){const e={};for(const[t,r]of Object.entries(this.fields))e[t]="optional"in r&&r.optional instanceof Function?r.optional():r;return this.setFields(e)}deepPartial(){return ux(this)}pick(e){const t={};for(const r of e)this.fields[r]&&(t[r]=this.fields[r]);return this.setFields(t,this._excludedEdges.filter(([r,s])=>e.includes(r)&&e.includes(s)))}omit(e){const t=[];for(const r of Object.keys(this.fields))e.includes(r)||t.push(r);return this.pick(t)}from(e,t,r){let s=ou.getter(e,!0);return this.transform(a=>{if(!a)return a;let o=a;return pX(a,e)&&(o=Object.assign({},a),r||delete o[e],o[t]=s(a)),o})}json(){return this.transform(J3)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||cx.exact,test(t){if(t==null)return!0;const r=mE(this.schema,t);return r.length===0||this.createError({params:{properties:r.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=cx.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let r=this.test({name:"noUnknown",exclusive:!0,message:t,test(s){if(s==null)return!0;const a=mE(this.schema,s);return!e||a.length===0||this.createError({params:{unknown:a.join(", ")}})}});return r.spec.noUnknown=e,r}unknown(e=!0,t=cx.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const r={};for(const s of Object.keys(t))r[e(s)]=t[s];return r})}camelCase(){return this.transformKeys(Cb.camelCase)}snakeCase(){return this.transformKeys(Cb.snakeCase)}constantCase(){return this.transformKeys(e=>Cb.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);r.fields={};for(const[a,o]of Object.entries(t.fields)){var s;let l=e;(s=l)!=null&&s.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[a]})),r.fields[a]=o.describe(l)}return r}}Pt.prototype=Q3.prototype;function _s(n){return new X3(n)}class X3 extends Ys{constructor(e){super({type:"array",spec:{types:e},check(t){return Array.isArray(t)}}),this.innerType=void 0,this.innerType=e}_cast(e,t){const r=super._cast(e,t);if(!this._typeCheck(r)||!this.innerType)return r;let s=!1;const a=r.map((o,l)=>{const c=this.innerType.cast(o,Object.assign({},t,{path:`${t.path||""}[${l}]`,parent:r,originalValue:o,value:o,index:l}));return c!==o&&(s=!0),c});return s?a:r}_validate(e,t={},r,s){var a;let o=this.innerType,l=(a=t.recursive)!=null?a:this.spec.recursive;t.originalValue!=null&&t.originalValue,super._validate(e,t,r,(c,d)=>{var h;if(!l||!o||!this._typeCheck(d)){s(c,d);return}let p=new Array(d.length);for(let v=0;v<d.length;v++){var x;p[v]=o.asNestedTest({options:t,index:v,parent:d,parentPath:t.path,originalParent:(x=t.originalValue)!=null?x:e})}this.runTests({value:d,tests:p,originalValue:(h=t.originalValue)!=null?h:e,options:t},r,v=>s(v.concat(c),d))})}clone(e){const t=super.clone(e);return t.innerType=this.innerType,t}json(){return this.transform(J3)}concat(e){let t=super.concat(e);return t.innerType=this.innerType,e.innerType&&(t.innerType=t.innerType?t.innerType.concat(e.innerType):e.innerType),t}of(e){let t=this.clone();if(!hy(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+jl(e));return t.innerType=e,t.spec=Object.assign({},t.spec,{types:e}),t}length(e,t=dx.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t){return t=t||dx.min,this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t){return t=t||dx.max,this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}ensure(){return this.default(()=>[]).transform((e,t)=>this._typeCheck(e)?e:t==null?[]:[].concat(t))}compact(e){let t=e?(r,s,a)=>!e(r,s,a):r=>!!r;return this.transform(r=>r!=null?r.filter(t):r)}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);if(t.innerType){var s;let a=e;(s=a)!=null&&s.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[0]})),r.innerType=t.innerType.describe(a)}return r}}_s.prototype=X3.prototype;const je=({label:n,id:e,error:t,registration:r,...s})=>{const{className:a,...o}=s,d=`form-input ${t?"form-input--error":""} ${a||""}`,h=i.jsx("input",{id:e,className:d,"aria-invalid":!!t,...r,...o});return i.jsxs("div",{children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsx("div",{className:n?"mt-1":"",children:h}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},Pn=E.forwardRef(({id:n,label:e,description:t,className:r,labelClassName:s,inputClassName:a,...o},l)=>{const c=n||o.name;return i.jsxs("div",{className:`relative flex items-start ${r}`,children:[i.jsx("div",{className:"flex h-6 items-center",children:i.jsx("input",{id:c,"aria-describedby":t?`${c}-description`:void 0,type:"checkbox",ref:l,className:`h-4 w-4 rounded border-gray-300 text-accent focus:ring-accent cursor-pointer ${a||""}`,...o})}),i.jsxs("div",{className:"ml-3 text-sm leading-6",children:[i.jsx("label",{htmlFor:c,className:`font-medium text-primary-text cursor-pointer ${s}`,children:e}),t&&i.jsx("p",{id:`${c}-description`,className:"text-muted",children:t})]})]})});Pn.displayName="Checkbox";function xX(){const[n,e]=E.useState(null),[t,r]=E.useState(!1),[s,a]=E.useState(null);return E.useEffect(()=>{const l=(()=>{const p=navigator.userAgent,x=`${window.screen.width}x${window.screen.height}`,v=Intl.DateTimeFormat().resolvedOptions().timeZone,w=navigator.language,_=navigator.platform,j=navigator.hardwareConcurrency||0,T=`${p}|${x}|${v}|${w}|${_}|${j}`;let P=0;for(let I=0;I<T.length;I++){const q=T.charCodeAt(I);P=(P<<5)-P+q,P=P&P}const D="dev_"+Math.abs(P).toString(36),M=()=>p.indexOf("Chrome")>-1?"Chrome":p.indexOf("Firefox")>-1?"Firefox":p.indexOf("Safari")>-1?"Safari":p.indexOf("Edge")>-1?"Edge":"Unknown",O=()=>p.indexOf("Win")>-1?"Windows":p.indexOf("Mac")>-1?"MacOS":p.indexOf("Linux")>-1?"Linux":p.indexOf("Android")>-1?"Android":p.indexOf("iOS")>-1?"iOS":"Unknown";return{deviceId:D,deviceName:`${O()} - ${M()}`,browser:M(),os:O(),timestamp:new Date().toISOString()}})();e(l);const c=localStorage.getItem("device_id"),d=localStorage.getItem("device_name"),h=localStorage.getItem("device_timestamp");c&&c!==l.deviceId&&(r(!0),a({deviceId:c,deviceName:d||"Unknown Device",browser:"",os:"",timestamp:h||new Date().toISOString()})),localStorage.setItem("device_id",l.deviceId),localStorage.setItem("device_name",l.deviceName),localStorage.setItem("device_timestamp",l.timestamp)},[]),{deviceInfo:n,isNewDevice:t,previousDevice:s}}const yX=Pt({email:ge().email("Must be a valid email").required("Email is required"),password:ge().required("Password is required"),rememberMe:is().optional()}).defined(),vX=n=>n.role==="unverified"?"/pending-approval":"/profile",bX=()=>{const{user:n,loginWithEmail:e,loginWithGoogle:t,error:r,setError:s,loading:a,setLoginAnimationPending:o,isLoginAnimationPending:l}=jt(),c=St(),d=ds(),{deviceInfo:h,isNewDevice:p,previousDevice:x}=xX(),[v,w]=E.useState(!1),[_,j]=E.useState(!1);E.useEffect(()=>{s(null);const F=new URLSearchParams(d.hash.substring(1)),V=F.get("error_code"),U=F.get("error_description");V==="otp_expired"&&U&&(s("Email confirmation link has expired or is invalid. Please try signing up again or request a new confirmation email."),c("/auth/login",{replace:!0}))},[s,d,c]),E.useEffect(()=>{n&&p&&x&&!v&&(ue.sendDeviceChangeAlert(n.id,n.name,x.deviceName,h?.deviceName||"Unknown Device").catch(F=>console.error("Failed to send device change alert:",F)),w(!0))},[n,p,x,v,h]),E.useEffect(()=>{n&&!l&&c(vX(n),{replace:!0})},[n,c,l]);const{register:T,handleSubmit:P,setValue:D,formState:{errors:M}}=tn({resolver:En(yX)});E.useEffect(()=>{const F=localStorage.getItem("rememberedEmail");F&&(D("email",F),D("rememberMe",!0)),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&D("rememberMe",!0)},[D]);const O=async F=>{o(!0);const U=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:F.rememberMe||!1;(await e(F.email,F.password,U)).error?o(!1):(j(!0),setTimeout(()=>{o(!1)},1500))},I=async()=>{await t()},q=a||_;return i.jsxs(i.Fragment,{children:[i.jsxs("form",{onSubmit:P(O),className:"space-y-3",children:[i.jsxs("fieldset",{disabled:q,className:"space-y-3",children:[i.jsxs("div",{className:"relative group",children:[i.jsx(Bf,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),i.jsx(je,{id:"email",type:"email",autoComplete:"email",placeholder:"Email",registration:T("email"),error:M.email?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),i.jsxs("div",{className:"relative group",children:[i.jsx(ES,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),i.jsx(je,{id:"password",type:"password",autoComplete:"current-password",placeholder:"Password",registration:T("password"),error:M.password?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-center justify-between gap-3",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(Pn,{id:"rememberMe",label:"Remember me",labelClassName:"text-white font-medium",...T("rememberMe"),inputClassName:"text-[#22c55e] border-white/20 rounded bg-black/40 focus:ring-[#22c55e]"})}),i.jsx(Ma,{to:"/auth/forgot-password",className:`text-sm font-medium !text-white hover:text-gray-200 transition-colors auth-link ${q?"pointer-events-none opacity-50":""}`,"aria-disabled":q,onClick:F=>{q&&F.preventDefault()},children:"Forgot your password?"})]})]}),i.jsx("div",{className:"min-h-[24px] flex items-center justify-center",children:r&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-400 text-center p-2 bg-red-500/10 rounded-lg border border-red-500/20",children:[i.jsx(Da,{className:"h-4 w-4 flex-shrink-0"}),i.jsx("span",{children:r})]})}),i.jsx(se,{type:"submit",className:`w-full !font-bold !py-3 !rounded-full shadow-lg transition-all transform hover:scale-[1.02] signin-btn ${_?"!bg-[#22c55e] !border-[#22c55e] !text-white hover:!bg-[#22c55e]":"!bg-transparent border border-[#22c55e] !text-[#22c55e] hover:!bg-[#22c55e] hover:!text-white shadow-green-500/20"}`,isLoading:a&&!_,size:"lg",disabled:q&&!_,children:_?i.jsx(_l,{className:"w-6 h-6 animate-bounce"}):"Sign In"})]}),i.jsxs("div",{className:"flex items-center my-6",children:[i.jsx("div",{className:"flex-1 border-t border-white/10"}),i.jsx("span",{className:"px-4 text-sm text-gray-400 font-medium",children:"OR"}),i.jsx("div",{className:"flex-1 border-t border-white/10"})]}),i.jsxs("button",{type:"button",onClick:I,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 hover:bg-gray-100 font-bold py-3 rounded-full transition-all transform hover:scale-[1.02] shadow-lg google-btn",disabled:q,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 48 48",children:[i.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),i.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),i.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.519-3.487-11.181-8.264l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),i.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C39.99,35.508,44,30.021,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),"Sign in with Google"]}),i.jsx("div",{className:"text-center mt-4",children:i.jsxs("p",{className:"text-sm text-gray-300",children:["Don't have an account?"," ",i.jsx(Ma,{to:"/auth/signup",className:"font-medium !text-white hover:text-gray-200 auth-link",children:"Sign Up"})]})})]})},wX=Pt({name:ge().required("Your name is required"),email:ge().email("Must be a valid email").required("Email is required"),password:ge().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:ge().oneOf([qC("password")],"Passwords must match").required("Please confirm your password")}).defined(),_X=()=>{const{signUp:n}=jt(),[e,t]=E.useState(""),[r,s]=E.useState(!1),{register:a,handleSubmit:o,formState:{errors:l,isSubmitting:c}}=tn({resolver:En(wX)}),d=async h=>{t("");const{error:p}=await n(h.name,h.email,h.password);p?t(p.message):s(!0)};return r?i.jsxs("div",{className:"text-center",children:[i.jsx(c3,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Confirm your email"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"We've sent a confirmation link to your email address. Please click the link to activate your account."}),i.jsx("div",{className:"mt-6",children:i.jsx(Ma,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",children:" Back to Login"})})]}):i.jsxs("form",{onSubmit:o(d),className:"space-y-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(kl,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(je,{id:"name",type:"text",placeholder:"Full Name",registration:a("name"),error:l.name?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Bf,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(je,{id:"email",type:"email",placeholder:"Email Address",registration:a("email"),error:l.email?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(ES,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(je,{id:"password",type:"password",placeholder:"Password",registration:a("password"),error:l.password?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(ES,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(je,{id:"confirmPassword",type:"password",placeholder:"Confirm Password",registration:a("confirmPassword"),error:l.confirmPassword?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),e&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),i.jsx("div",{className:"pt-2",children:i.jsx(se,{type:"submit",className:"w-full",isLoading:c,size:"lg",children:"Sign Up"})}),i.jsx("div",{className:"text-center pt-2",children:i.jsx(Ma,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",children:"Already have an account? Sign In"})})]})},jX=Pt({email:ge().email("Must be a valid email").required("Email is required")}).defined(),NX=()=>{const{sendPasswordReset:n}=jt(),[e,t]=E.useState(""),[r,s]=E.useState(!1),a=St();E.useEffect(()=>{if(r){const p=setTimeout(()=>{a("/auth/login",{replace:!0})},3e3);return()=>clearTimeout(p)}},[r,a]);const{register:o,handleSubmit:l,formState:{errors:c,isSubmitting:d}}=tn({resolver:En(jX)}),h=async p=>{t("");const{error:x}=await n(p.email);x&&x.message.includes("rate limit")?t("Too many attempts. Please wait a few minutes before trying again."):s(!0)};return r?i.jsxs("div",{className:"text-center",children:[i.jsx(c3,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Check your email"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"If an account exists for the email you provided, we've sent password reset instructions. Redirecting to login..."})]}):i.jsx(i.Fragment,{children:i.jsxs("form",{onSubmit:l(h),className:"space-y-6",children:[i.jsxs("div",{className:"relative group",children:[i.jsx(Bf,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none z-10"}),i.jsx(je,{id:"email",type:"email",autoComplete:"email",placeholder:"Email Address",registration:o("email"),error:c.email?.message,className:"!pl-12 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-400 focus:!border-[#22c55e] !py-3 !rounded-xl transition-all"})]}),e&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),i.jsx("div",{children:i.jsx(se,{type:"submit",className:"w-full",isLoading:d,size:"lg",children:"Send Reset Link"})}),i.jsx("div",{className:"text-center",children:i.jsx(Ma,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",children:" Back to Login"})})]})})},SX=Pt({password:ge().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:ge().oneOf([qC("password")],"Passwords must match").required("Please confirm your password")}).defined(),CX=n=>{const e=n.toLowerCase();return e.includes("weak password")?"Password is too weak. Please use at least 6 characters.":e.includes("requires a recent login")?"For your security, please sign in again to continue.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again.")},TX=()=>{const[n,e]=E.useState(""),[t,r]=E.useState(!1),s=St(),{user:a,logout:o}=jt();E.useEffect(()=>{a||e("Invalid or expired password reset session. Please request a new password reset link.")},[a]);const{register:l,handleSubmit:c,formState:{errors:d,isSubmitting:h}}=tn({resolver:En(SX)}),p=async x=>{e("");const{error:v}=await ja.updateUserPassword(x.password);v?e(CX(v.message)):(r(!0),await o(),setTimeout(()=>s("/auth/login",{replace:!0}),2e3))};return t?i.jsxs("div",{className:"text-center",children:[i.jsx(Yi,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Password Updated!"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"Your password has been changed successfully. You will be redirected to the login page shortly."}),i.jsx("div",{className:"mt-6",children:i.jsx(Ma,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",children:" Back to Login Now"})})]}):n&&!a?i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-3xl font-bold text-white",children:"Link Expired"}),i.jsx("p",{className:"text-sm text-gray-300 mt-1",children:"This password reset link is no longer valid."}),i.jsxs("div",{className:"mt-6 flex flex-col gap-4",children:[i.jsx(Ma,{to:"/auth/forgot-password",className:"font-medium text-white/80 hover:text-white",children:"Request a new link"}),i.jsx("div",{className:"auth-separator",children:"OR"}),i.jsx(se,{onClick:()=>s("/auth/login"),className:"w-full",size:"lg",children:"Back to Sign In"})]})]}):i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm text-center text-gray-300 -mt-6 mb-6",children:["for ",i.jsx("span",{className:"font-semibold text-white",children:a?.email}),"."]}),i.jsxs("form",{onSubmit:c(p),className:"space-y-6",children:[i.jsx(je,{id:"password",type:"password",placeholder:"New Password",autoComplete:"new-password",registration:l("password"),error:d.password?.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),i.jsx(je,{id:"confirmPassword",type:"password",placeholder:"Confirm New Password",autoComplete:"new-password",registration:l("confirmPassword"),error:d.confirmPassword?.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),n&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:n}),i.jsx("div",{children:i.jsx(se,{type:"submit",className:"w-full",isLoading:h,size:"lg",disabled:!a,children:"Update Password"})})]})]})},kX=()=>{const n=St(),{logout:e}=jt(),t=async()=>{await e(),n("/auth/login",{replace:!0})},r=()=>{n(-1)};return i.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 relative",children:i.jsxs("div",{className:"w-full max-w-md bg-card rounded-2xl shadow-card p-8 text-center relative z-10",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"p-4 rounded-full bg-red-100",children:i.jsx(wo,{className:"h-10 w-10 text-red-600"})})}),i.jsx("h1",{className:"text-2xl font-bold text-primary-text mb-2",children:"Log Out"}),i.jsx("p",{className:"text-muted mb-8",children:"Are you sure you want to log out? You will need to sign in again to access your account."}),i.jsxs("div",{className:"flex flex-col gap-3",children:[i.jsx(se,{onClick:t,variant:"danger",className:"w-full !py-3 !text-lg shadow-lg shadow-red-100",children:"Yes, Log Out"}),i.jsx(se,{onClick:r,variant:"secondary",className:"w-full !py-3",children:"Cancel"})]})]})})},PX=()=>{const{logout:n,user:e}=jt(),t=St(),r=async()=>{await n(),t("/auth/login",{replace:!0})};return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:i.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[i.jsx(Zi,{className:"h-10 mx-auto mb-6"}),i.jsx(SJ,{className:"h-16 w-16 text-accent mx-auto mb-4"}),i.jsx("h2",{className:"text-2xl font-bold text-primary-text mb-2",children:"Account Pending Approval"}),i.jsxs("p",{className:"text-muted mb-6",children:["Welcome, ",e?.name||"user","! Your account has been created successfully and is pending approval. An administrator will review your details and perform a security check before activating your account."]}),i.jsx("div",{className:"flex justify-center",children:i.jsxs(se,{onClick:r,variant:"secondary",children:[i.jsx(wo,{className:"mr-2 h-4 w-4"}),"Log Out"]})})]})})},MX=()=>{const n=St();return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:i.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx(f3,{className:"h-16 w-16 text-red-500"})}),i.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Access Denied"}),i.jsx("p",{className:"text-muted mb-6",children:"You do not have the necessary permissions to view this page. If you believe this is an error, please contact your administrator."}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx(se,{onClick:()=>n(-1),variant:"secondary",children:"Go Back"}),i.jsx(se,{onClick:async()=>{await jt.getState().logout(),n("/auth/login")},children:"Login"})]})]})})},EX=()=>{const n=St(),{data:e,reset:t}=$n(),{user:r}=jt(),s=e.personal.firstName||e.personal.lastName,a=Ft("(max-width: 767px)"),o=()=>{t(),n("/onboarding/select-organization")},l=()=>{n("/onboarding/add/personal")};return a?i.jsx("div",{className:"flex flex-col items-center justify-center text-center relative min-h-[70vh]",children:i.jsxs("div",{className:"p-8 max-w-sm w-full bg-transparent",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"p-4 rounded-full bg-black/20",children:i.jsx(MS,{className:"h-10 w-10 text-emerald-400"})})}),i.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to Employee Onboarding"}),i.jsx("p",{className:"text-gray-400 text-sm mb-8",children:"We need to collect some information to get you set up. This should only take a few minutes."}),i.jsxs("div",{className:"flex flex-col gap-3",children:[s&&i.jsx(se,{onClick:l,variant:"secondary",className:"w-full !py-3",children:"Continue Previous Application"}),i.jsx(se,{onClick:o,variant:"primary",className:"w-full !py-3 !text-lg",children:"Start New Application"})]})]})}):i.jsx("div",{className:"h-full flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-card p-8 sm:p-12 rounded-2xl shadow-card text-center w-full",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"bg-accent-light p-4 rounded-full",children:i.jsx(MS,{className:"h-12 w-12 text-accent-dark"})})}),i.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Welcome to Employee Onboarding"}),i.jsx("p",{className:"text-muted mb-8 max-w-md mx-auto",children:"We need to collect some information to get you set up. This should only take a few minutes."}),i.jsxs("div",{className:"mt-10 flex justify-center items-center gap-4 flex-wrap",children:[s&&i.jsx(se,{onClick:l,variant:"secondary",children:"Continue Draft"}),i.jsx(se,{onClick:o,variant:"primary",children:s?"Start Fresh":"Start New Application"})]})]})})},Ke=({label:n,id:e,error:t,registration:r,children:s,...a})=>{const{className:o,...l}=a,h=`form-input ${t?"form-input--error":""} ${o||""}`,p=i.jsx("select",{id:e,className:h,"aria-invalid":!!t,...r,...l,children:s});return i.jsxs("div",{children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsx("div",{className:n?"mt-1":"",children:p}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},DX=()=>{const n=St(),{updateOrganization:e,updatePersonal:t}=$n(),{enforceManpowerLimit:r,manpowerLimitRule:s}=Qc(),{user:a}=jt(),[o,l]=E.useState(!0),[c,d]=E.useState([]),[h,p]=E.useState([]),[x,v]=E.useState([]),[w,_]=E.useState(""),[j,T]=E.useState(""),[P,D]=E.useState(""),[M,O]=E.useState(""),[I,q]=E.useState([]),[F,V]=E.useState(window.innerWidth<768);E.useEffect(()=>{const Z=()=>V(window.innerWidth<768);return window.addEventListener("resize",Z),()=>window.removeEventListener("resize",Z)},[]);const[U,W]=E.useState({isOverLimit:!1,message:""}),$=a?.role==="field_officer"&&F;E.useEffect(()=>{(async()=>{l(!0);try{const[oe,H,Q]=await Promise.all([ue.getOrganizationStructure(),ue.getOrganizations(),ue.getSiteStaffDesignations()]);d(oe),p(H),v(Q)}catch(oe){console.error("Failed to fetch organization structure",oe)}finally{l(!1)}})()},[]);const ne=E.useMemo(()=>c.find(Z=>Z.id===w),[c,w]),Y=E.useMemo(()=>ne?.companies||[],[ne]),ae=E.useMemo(()=>Y.find(Z=>Z.id===j),[Y,j]),J=E.useMemo(()=>ae?.entities||[],[ae]);E.useEffect(()=>{O("");const Z=J.find(oe=>oe.id===P);q(Z?x:[])},[P,J,x]),E.useEffect(()=>{(async()=>{if(W({isOverLimit:!1,message:""}),!P||!r)return;const H=J.find(de=>de.id===P)?.organizationId;if(!H)return;const re=h.find(de=>de.id===H)?.manpowerApprovedCount;if(re==null){W({isOverLimit:!1,message:"Manpower limit not set for this site."});return}try{const ce=(await ue.getVerificationSubmissions()).filter(pe=>pe.organizationId===H&&(pe.status==="verified"||pe.status==="pending")).length;if(ce>=re){const pe=`Manpower limit of ${re} reached (${ce} deployed).`;W({isOverLimit:!0,message:pe})}else{const pe=`Manpower: ${ce} / ${re} deployed.`;W({isOverLimit:!1,message:pe})}}catch{W({isOverLimit:!1,message:"Could not verify manpower count."})}})()},[P,h,J,r]);const ee=()=>{const Z=J.find(oe=>oe.id===P);if(Z?.organizationId){const oe=h.find(Q=>Q.id===Z.organizationId),H=x.find(Q=>Q.designation===M);oe&&H?(e({organizationId:oe.id,organizationName:oe.shortName,joiningDate:$e(new Date,"yyyy-MM-dd"),workType:"Full-time",designation:M,department:H.department,defaultSalary:H.monthlySalary||null}),t({salary:H.monthlySalary||null}),n("/onboarding/pre-upload")):console.error("Organization or Designation details not found.")}};if(o)return i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})});const X=!P||!M||U.isOverLimit&&s==="block";return $?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header text-white",children:[i.jsx("button",{onClick:()=>n("/onboarding"),"aria-label":"Go back",className:"text-white",children:i.jsx(Ra,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-xl font-bold",children:"New Enrollment"})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Hi,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Select Site"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Choose the client and site for the new employee."})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("select",{value:w,onChange:Z=>{_(Z.target.value),T(""),D("")},className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs("select",{value:j,onChange:Z=>{T(Z.target.value),D("")},disabled:!w,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Company --"}),Y.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs("select",{value:P,onChange:Z=>D(Z.target.value),disabled:!j,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Client/Site --"}),J.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs("select",{value:M,onChange:Z=>O(Z.target.value),disabled:!P,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Designation --"}),I.map(Z=>i.jsx("option",{value:Z.designation,children:Z.designation},Z.id))]}),U.message&&i.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${U.isOverLimit?"bg-red-900/50 text-red-300 border border-red-500/50":"bg-green-900/50 text-green-300 border border-green-500/50"}`,children:U.message})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center justify-between gap-4",children:[i.jsx("button",{onClick:()=>n("/onboarding"),className:"fo-btn-secondary px-6",children:"Back"}),i.jsx("button",{onClick:ee,disabled:X,className:"fo-btn-primary flex-1",children:"Continue"})]})]}):i.jsx("div",{className:"p-4 md:p-0",children:i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Hi,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Select Site"}),i.jsx("p",{className:"text-muted",children:"Choose the client and site for the new employee."})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs(Ke,{label:"Company Group",id:"group",value:w,onChange:Z=>{_(Z.target.value),T(""),D("")},children:[i.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs(Ke,{label:"Company",id:"company",value:j,onChange:Z=>{T(Z.target.value),D("")},disabled:!w,children:[i.jsx("option",{value:"",children:"-- Select a Company --"}),Y.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs(Ke,{label:"Client / Site",id:"entity",value:P,onChange:Z=>D(Z.target.value),disabled:!j,children:[i.jsx("option",{value:"",children:"-- Select a Client/Site --"}),J.map(Z=>i.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),i.jsxs(Ke,{label:"Designation",id:"designation",value:M,onChange:Z=>O(Z.target.value),disabled:!P,children:[i.jsx("option",{value:"",children:"-- Select a Designation --"}),I.map(Z=>i.jsx("option",{value:Z.designation,children:Z.designation},Z.id))]})]}),U.message&&i.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${U.isOverLimit?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:U.message}),i.jsx("div",{className:"mt-8 pt-6 border-t flex justify-end",children:i.jsxs(se,{onClick:ee,disabled:X,children:["Continue ",i.jsx(QK,{className:"ml-2 h-4 w-4"})]})})]})})},pE=({steps:n,currentStepIndex:e,onStepClick:t,highestStepReached:r,isMobileOptimized:s=!1})=>{const[a,o]=E.useState(0),l=4,c=Math.ceil(n.length/l);E.useEffect(()=>{if(s){const x=Math.floor(e/l);o(x)}},[e,s,l]);const d=()=>{o(x=>Math.min(x+1,c-1))},h=()=>{o(x=>Math.max(x-1,0))},p=E.useMemo(()=>{if(!s)return[];const x=a*l,v=x+l;return Array.from({length:n.length},(w,_)=>_).slice(x,v)},[a,l,n.length,s]);if(!s){const x=e>0?e/(n.length-1)*100:0,w=100/n.length/2;return i.jsx("nav",{"aria-label":"Onboarding Progress",className:"py-4",children:i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"absolute top-4 h-1",style:{left:`${w}%`,right:`${w}%`},children:[i.jsx("div",{className:"w-full h-full bg-border rounded-full"}),i.jsx("div",{className:"absolute top-0 left-0 h-full bg-accent rounded-full transition-all duration-500 ease-in-out",style:{width:`${x}%`}})]}),i.jsx("ol",{role:"list",className:"relative flex items-center",children:n.map((_,j)=>{const T=j<e,P=j===e,D=j<=r;return i.jsx("li",{className:"flex-1",children:i.jsxs("div",{className:"relative flex flex-col items-center group",children:[i.jsx("button",{type:"button",onClick:()=>D&&t(j),disabled:!D,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-accent-dark rounded-full disabled:cursor-not-allowed","aria-current":P?"step":void 0,title:_.label,children:i.jsx("div",{className:`relative flex items-center justify-center w-9 h-9 rounded-full transition-all duration-300 border-2 z-10 ${T?"bg-accent border-accent text-white":""} ${P?"bg-card border-accent text-accent scale-110":""} ${!T&&!P?"bg-card border-border text-muted":""} ${D?"group-hover:border-accent-dark":""}`,children:T?i.jsx(_l,{className:"w-5 h-5"}):ot.createElement(_.icon,{className:"w-5 h-5"})})}),i.jsx("span",{className:`hidden sm:block absolute top-12 w-24 text-center text-xs transition-colors duration-300 ${P?"text-accent font-bold":"text-muted"} ${D?"group-hover:text-primary-text":""}`,children:_.label})]})},_.key)})})]})})}return i.jsxs("nav",{"aria-label":"Onboarding Progress",className:"bg-card rounded-2xl mx-4 my-2 p-2 flex items-center gap-1",children:[i.jsx("button",{type:"button",onClick:h,disabled:a===0,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Previous steps",children:i.jsx(ay,{className:"h-6 w-6"})}),i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx("ol",{role:"list",className:"flex items-center justify-around",children:p.map(x=>{const v=n[x],w=x<e,_=x===e,j=x<=r;return i.jsx("li",{className:"flex-shrink-0",children:i.jsx("div",{className:"relative flex flex-col items-center group",children:i.jsx("button",{type:"button",onClick:()=>j&&t(x),disabled:!j,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-full disabled:cursor-not-allowed","aria-current":_?"step":void 0,title:v.label,children:i.jsx("div",{className:`relative flex items-center justify-center w-10 h-10 rounded-full transition-all duration-300 border-2 z-10
                      ${w?"bg-green-600 border-green-600 text-white":""}
                      ${_?"bg-transparent border-green-500 text-white scale-110":""}
                      ${!w&&!_?`bg-transparent ${j?"border-gray-500 text-gray-400 group-hover:border-emerald-400":"border-gray-700 text-gray-600 opacity-50"}`:""}`,children:w?i.jsx(_l,{className:"w-6 h-6 text-white"}):ot.createElement(v.icon,{className:"w-6 h-6"})})})})},v.key)})})}),i.jsx("button",{type:"button",onClick:d,disabled:a>=c-1,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Next steps",children:i.jsx(Mf,{className:"h-6 w-6"})})]})},ht=({message:n,type:e,onDismiss:t})=>{E.useEffect(()=>{const a=setTimeout(()=>{t()},5e3);return()=>{clearTimeout(a)}},[t]);const r=e==="success"?"bg-green-500":"bg-red-500",s=e==="success"?Yi:pm;return i.jsxs("div",{className:`fixed top-5 right-5 z-50 flex items-center p-4 rounded-lg text-white shadow-lg ${r}`,children:[i.jsx(s,{className:"h-6 w-6 mr-3"}),i.jsx("span",{className:"text-sm font-medium",children:n}),i.jsx("button",{onClick:t,className:"ml-4 -mr-2 p-1.5 rounded-md hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white",children:i.jsx(xi,{className:"h-5 w-5"})})]})},e5=[{key:"personal",label:"Personal",icon:kl},{key:"address",label:"Address",icon:Tl},{key:"organization",label:"Organization",icon:Hi},{key:"family",label:"Family",icon:Gi},{key:"education",label:"Education",icon:a3},{key:"bank",label:"Bank",icon:Cl},{key:"uan",label:"UAN/PF",icon:XK},{key:"esi",label:"ESI",icon:RJ},{key:"gmc",label:"GMC",icon:CC},{key:"uniform",label:"Uniform",icon:Df},{key:"documents",label:"Documents",icon:wJ},{key:"biometrics",label:"Biometrics",icon:i3},{key:"review",label:"Review",icon:xJ}],zi=e5.map(n=>n.key),OX=()=>{const n=St(),e=ds(),{data:t,reset:r,setData:s}=$n(),{user:a}=jt(),{salaryThreshold:o}=Qc(),[l,c]=E.useState(!1),[d,h]=E.useState(!0),[p,x]=E.useState(null),[v]=y4(),[w,_]=E.useState(!1),[j,T]=E.useState("idle"),P=E.useRef(null),D=Ft("(max-width: 767px)"),M=E.useRef(null),O=e.pathname.split("/").pop(),I=E.useMemo(()=>zi.indexOf(O),[O]),[q,F]=E.useState(0);E.useEffect(()=>{const X=t.personal.firstName==="Ravi"&&t.status==="draft";if(t.status!=="draft"||X){F(zi.length-1);return}const Z=sessionStorage.getItem(`onboarding_progress_${t.id}`),oe=Z?parseInt(Z,10):0,H=Math.max(oe,I);F(H),I>oe&&sessionStorage.setItem(`onboarding_progress_${t.id}`,String(I))},[t,I]);const V=E.useMemo(()=>e5.map((X,Z)=>({...X,status:Z<I?"complete":Z===I?"current":"upcoming"})),[I]);E.useEffect(()=>{const X=v.get("id");X?(async oe=>{h(!0);try{const H=await ue.getOnboardingDataById(oe);H?(s(H),T("saved")):(x({message:"Could not find submission data.",type:"error"}),r())}catch(H){console.error("Failed to fetch submission data",H),x({message:"Failed to load submission data.",type:"error"}),r()}finally{h(!1)}})(X):h(!1)},[v,s,r]);const U=E.useCallback(async()=>{T("saving");try{const{draftId:X}=await ue.saveDraft(t);X!==t.id&&s({...t,id:X}),T("saved")}catch{x({message:"Auto-save failed. Check your connection.",type:"error"}),T("dirty")}},[t,s]);E.useEffect(()=>((!t.id||t.id.startsWith("draft_")||t.status==="draft")&&!d&&(j!=="saving"&&T("dirty"),P.current&&clearTimeout(P.current),P.current=window.setTimeout(()=>{U()},2e3)),()=>{P.current&&clearTimeout(P.current)}),[t,d,U,j]);const W=async()=>{P.current&&clearTimeout(P.current),await U();const X=M.current;if(M.current=null,X)n(`/onboarding/add/${X}`);else if(I<zi.length-1){let Z=I+1;O==="esi"&&zi[Z]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||Z++),Z<zi.length&&n(`/onboarding/add/${zi[Z]}`)}},$=X=>{X<=q&&n(`/onboarding/add/${zi[X]}`)},ne=()=>{if(I>0){let X=I-1;O==="uniform"&&zi[X]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||X--),X>=0?n(`/onboarding/add/${zi[X]}`):n("/onboarding/select-organization")}else n("/onboarding/select-organization")},Y=async()=>{c(!0);const X={...t,status:"pending"};try{!!t.id&&!t.id.startsWith("draft_")?(await ue.updateOnboarding(X),x({message:"Application updated successfully!",type:"success"})):(await ue.submitOnboarding(X),x({message:"Application submitted successfully!",type:"success"})),setTimeout(()=>{r(),a?.role==="site_manager"?n("/site/dashboard"):n("/onboarding")},2e3)}catch{x({message:"Failed to submit application.",type:"error"}),c(!1)}},ae=()=>{sessionStorage.removeItem(`onboarding_progress_${t.id}`),r(),_(!1),n("/onboarding/add/personal",{replace:!0}),x({message:"Form has been cleared.",type:"success"})},J=X=>{if(X.key!=="ArrowUp"&&X.key!=="ArrowDown"&&X.key!=="Enter")return;const Z=X.target;if(X.key==="Enter"&&Z.tagName!=="TEXTAREA"&&Z.tagName!=="BUTTON"&&X.preventDefault(),X.key==="Enter"&&Z.tagName==="BUTTON"||(X.key==="ArrowUp"||X.key==="ArrowDown")&&(Z.tagName==="TEXTAREA"||Z.type==="number"))return;const oe=X.currentTarget,H=Array.from(oe.querySelectorAll('input:not([type="hidden"]):not([readonly]), select, textarea, button')).filter(de=>!de.hasAttribute("disabled")&&de.offsetParent!==null),Q=H.indexOf(document.activeElement);if(Q===-1)return;(X.key==="ArrowUp"||X.key==="ArrowDown")&&X.preventDefault();let re=Q;if(X.key==="ArrowUp"?re=Q-1:re=Q+1,re>=0&&re<H.length)H[re].focus();else if(X.key==="Enter"&&re>=H.length){const de=document.getElementById("save-and-next-button");de&&de.click()}};if(d)return i.jsxs("div",{className:"flex justify-center items-center h-full text-muted",children:[i.jsx(_t,{className:"h-8 w-8 animate-spin mr-4"}),i.jsx("p",{children:"Loading application data..."})]});const ee=zi[I]==="review";return D?i.jsxs("div",{className:"h-full flex flex-col",children:[p&&i.jsx(ht,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(pE,{steps:V,currentStepIndex:I,onStepClick:$,highestStepReached:q,isMobileOptimized:!0}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4 pb-28",onKeyDown:J,children:i.jsx("div",{className:"bg-card p-6 rounded-2xl",children:i.jsx(vf,{context:{onValidated:W,onSubmit:Y,isSubmitting:l,setToast:x}})})}),i.jsxs("footer",{className:"fixed bottom-0 left-0 right-0 p-4 flex items-center justify-between gap-2 bg-card border-t border-[#123820] z-10",children:[i.jsx(se,{type:"button",onClick:ne,variant:"secondary",children:"Back"}),i.jsx(se,{type:"button",onClick:()=>n("/onboarding"),variant:"secondary",className:"!p-3 !rounded-full","aria-label":"Go to Home",children:i.jsx(TC,{className:"h-5 w-5"})}),i.jsx(se,{id:"save-and-next-button",type:"submit",form:`${zi[I]}-form`,children:ee?"Submit":"Next"})]})]}):i.jsx("div",{className:"p-4 md:p-0",children:i.jsxs("div",{className:`transition-opacity duration-300 ${l?"opacity-50 pointer-events-none":""}`,children:[p&&i.jsx(ht,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Yr,{isOpen:w,onClose:()=>_(!1),onConfirm:ae,title:"Confirm Clear Form",children:"Are you sure you want to clear all data entered in this form? This action cannot be undone."}),i.jsx(pE,{steps:V,currentStepIndex:I,onStepClick:$,highestStepReached:q,isMobileOptimized:D}),i.jsx("div",{className:"mt-8 bg-card p-6 sm:p-8 rounded-xl shadow-card",onKeyDown:J,children:i.jsx(vf,{context:{onValidated:W,onSubmit:Y,isSubmitting:l,setToast:x}})}),i.jsxs("div",{className:"mt-8 flex justify-between items-center",children:[i.jsx(se,{onClick:ne,disabled:I===0,variant:"secondary",children:"Back"}),i.jsxs("div",{className:"flex flex-wrap gap-4 justify-end items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted italic transition-opacity duration-300 min-h-[20px]",children:[j==="saving"&&i.jsxs(i.Fragment,{children:[i.jsx(_t,{className:"h-4 w-4 animate-spin"}),i.jsx("span",{children:"Saving..."})]}),j==="saved"&&i.jsxs(i.Fragment,{children:[i.jsx(Yi,{className:"h-4 w-4 text-accent"}),i.jsx("span",{children:"Draft saved"})]}),j==="dirty"&&i.jsx("span",{className:"text-gray-500",children:"Unsaved changes"})]}),!ee&&i.jsx(se,{id:"save-and-next-button",type:"submit",form:`${zi[I]}-form`,children:"Save & Next"})]})]})]})})},UC=({status:n})=>{const t={pending:"status-chip--pending",verified:"status-chip--verified",rejected:"status-chip--rejected",draft:"status-chip--draft"}[n]||"status-chip--draft";return i.jsx("span",{className:`status-chip ${t}`,children:n})},Hr=({className:n=""})=>i.jsx("div",{className:`skeleton-pulse rounded-md ${n}`}),IX=({rows:n,cols:e})=>i.jsx("div",{className:"space-y-4",children:Array.from({length:n}).map((t,r)=>i.jsx("div",{className:"bg-card rounded-2xl border border-border p-4 space-y-3",children:Array.from({length:e}).map((s,a)=>i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx(Hr,{className:"h-4 w-1/4"}),i.jsx(Hr,{className:"h-4 w-1/2"})]},a))},r))}),AX=({rows:n,cols:e})=>i.jsx(i.Fragment,{children:Array.from({length:n}).map((t,r)=>i.jsx("tr",{children:Array.from({length:e}).map((s,a)=>i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"space-y-2",children:[i.jsx(Hr,{className:`h-4 ${a===0?"w-3/4":"w-full"}`}),a===0&&i.jsx(Hr,{className:"h-3 w-1/2"})]})},a))},r))}),Oa=({rows:n=5,cols:e=4,isMobile:t=!1,mobileCols:r})=>t?i.jsx(IX,{rows:n,cols:r||e}):i.jsx(AX,{rows:n,cols:e}),RX=({submission:n,isSyncing:e})=>{if(n.status!=="verified"||!n.portalSyncStatus)return i.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});if(e)return i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[i.jsx(_t,{className:"h-4 w-4 animate-spin"})," Syncing..."]});const t=n.uan?.hasPreviousPf,r=[{label:"Aadhaar",verified:n.personal?.verifiedStatus?.idProofNumber},{label:"Bank",verified:n.bank?.verifiedStatus?.accountNumber},...t?[{label:"UAN",verified:n.uan?.verifiedStatus?.uanNumber}]:[]],s=n.portalSyncStatus==="synced"||n.portalSyncStatus==="failed",a=({label:o,status:l})=>{const c=s&&l===!0,d=s&&l===!1,h=c?vm:d?m3:p3,p=c?"text-green-600":d?"text-red-600":"text-muted",x=c?"Verified":d?"Failed":"Pending Verification";return i.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-medium ${p}`,title:x,children:[i.jsx(h,{className:"h-4 w-4"}),i.jsx("span",{children:o})]})};return i.jsx("div",{className:"flex flex-row gap-3 items-center",children:r.map(o=>i.jsx(a,{label:o.label,status:o.verified},o.label))})},LX=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState("all"),[o,l]=E.useState(""),[c,d]=E.useState(null),[h,p]=E.useState(null),x=St(),v=Ft("(max-width: 767px)"),w=E.useCallback(async()=>{r(!0);try{const M=await ue.getVerificationSubmissions(s==="all"?void 0:s);e(M)}catch(M){console.error("Failed to fetch submissions",M)}finally{r(!1)}},[s]);E.useEffect(()=>{w();const M=Me.channel("submissions-feed").on("postgres_changes",{event:"*",schema:"public",table:"onboarding_submissions"},O=>{console.log("Real-time change received!",O),w()}).subscribe();return()=>{Me.removeChannel(M)}},[w]);const _=E.useMemo(()=>n?n.filter(M=>M.personal.firstName?.toLowerCase().includes(o.toLowerCase())||M.personal.lastName?.toLowerCase().includes(o.toLowerCase())||M.personal.employeeId?.toLowerCase().includes(o.toLowerCase())||M.organizationName?.toLowerCase().includes(o.toLowerCase())):[],[n,o]),j=async(M,O)=>{e(I=>I.map(q=>q.id===O?{...q,status:M==="approve"?"verified":"rejected",portalSyncStatus:M==="approve"?"pending_sync":void 0}:q));try{M==="approve"?await ue.verifySubmission(O):await ue.requestChanges(O,"Changes requested by admin.")}catch(I){console.error(`Failed to ${M} submission`,I)}},T=async M=>{d(M);try{const O=await ue.syncPortals(M);e(I=>I.map(q=>q.id===M?O:q)),O.portalSyncStatus==="synced"?p({message:"Portals synced successfully!",type:"success"}):p({message:"Portal sync failed. Check details.",type:"error"})}catch{p({message:"An error occurred during sync.",type:"error"})}finally{d(null)}},P=["all","pending","verified","rejected"],D=s==="verified"?4:5;return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx("h2",{className:"text-2xl font-semibold text-primary-text mb-6",children:"Onboarding Forms"}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[i.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:i.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:P.map(M=>i.jsx("button",{onClick:()=>a(M),className:`${s===M?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize`,children:M},M))})}),i.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ea,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name, ID, site...",value:o,onChange:M=>l(M.target.value),className:"form-input block w-full pl-10 pr-3 py-2 border-border rounded-lg leading-5 placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site"}),s!=="verified"&&i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Verification"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-card md:divide-y-0",children:t?v?i.jsx("tr",{children:i.jsx("td",{colSpan:D,children:i.jsx(Oa,{rows:3,cols:4,isMobile:!0})})}):i.jsx(Oa,{rows:5,cols:D}):_.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:D,className:"text-center py-10 text-muted",children:"No submissions found."})}):_.map(M=>i.jsxs("tr",{className:M.requiresManualVerification?"bg-orange-50":"",children:[i.jsx("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[M.requiresManualVerification&&i.jsx("span",{title:"Manual verification required due to data mismatch.",children:i.jsx(Da,{className:"h-4 w-4 text-orange-500 mr-2 flex-shrink-0"})}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[M.personal.firstName," ",M.personal.lastName]}),i.jsx("div",{className:"text-sm text-muted",children:M.personal.employeeId})]})]})}),i.jsx("td",{"data-label":"Site",className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-primary-text",children:M.organizationName}),s!=="verified"&&i.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(UC,{status:M.status})}),i.jsx("td",{"data-label":"Portal Verification",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(RX,{submission:M,isSyncing:c===M.id})}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(se,{variant:"icon",size:"sm",onClick:()=>x(`/onboarding/add/personal?id=${M.id}`),title:"View Details","aria-label":`View details for ${M.personal.firstName}`,children:i.jsx(Sl,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>x(`/onboarding/pdf/${M.id}`),title:"Download Forms","aria-label":`Download forms for ${M.personal.firstName}`,children:i.jsx(ls,{className:"h-4 w-4"})}),M.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx(se,{variant:"icon",size:"sm",onClick:()=>j("approve",M.id),title:"Verify","aria-label":`Verify submission for ${M.personal.firstName}`,children:i.jsx(vm,{className:"h-4 w-4 text-green-600"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>j("reject",M.id),title:"Request Changes","aria-label":`Request changes for ${M.personal.firstName}`,children:i.jsx(m3,{className:"h-4 w-4 text-red-600"})})]}),M.status==="verified"&&(M.portalSyncStatus==="pending_sync"||M.portalSyncStatus==="failed")&&i.jsxs(se,{variant:"outline",size:"sm",onClick:()=>T(M.id),isLoading:c===M.id,title:"Push data to government portals",children:[c!==M.id&&i.jsx(PC,{className:"h-4 w-4 mr-1"}),"Sync Portals"]})]})})]},M.id))})]})})]})},Qi=({title:n,children:e})=>i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:n}),e&&i.jsx("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:e})]}),FX=({isOpen:n,onClose:e,onApprove:t,user:r,isConfirming:s})=>{const[a,o]=E.useState([]),[l,c]=E.useState(""),[d,h]=E.useState(!0);E.useEffect(()=>{n&&(h(!0),ue.getRoles().then(x=>{const v=x.filter(w=>w.id!=="unverified"&&w.id!=="admin");o(v),v.length>0&&c(v[0].id),h(!1)}))},[n]);const p=()=>{r&&l&&t(r.id,l)};return!n||!r?null:i.jsx(Yr,{isOpen:n,onClose:e,onConfirm:p,title:"Approve User Account",confirmButtonText:"Confirm Approval",confirmButtonVariant:"primary",isConfirming:s,children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{children:["You are approving the account for ",i.jsx("strong",{className:"text-primary-text",children:r.name})," (",r.email,")."]}),i.jsx("p",{children:"Please assign a role to activate their account."}),d?i.jsx("p",{children:"Loading roles..."}):i.jsx(Ke,{label:"Assign Role",id:"approval-role",value:l,onChange:x=>c(x.target.value),children:a.map(x=>i.jsx("option",{value:x.id,children:x.displayName},x.id))})]})})},qX=({isOpen:n,onClose:e,userId:t,userName:r,onSuccess:s})=>{const[a,o]=E.useState([]),[l,c]=E.useState([]),[d,h]=E.useState(!0),[p,x]=E.useState(!1),[v,w]=E.useState(""),[_,j]=E.useState(null);E.useEffect(()=>{n&&t&&T()},[n,t]);const T=async()=>{h(!0);try{const[I,q]=await Promise.all([ue.getUserLocations(t),ue.getLocations()]);o(I),c(q)}catch(I){console.error("Failed to load locations:",I),j({message:"Failed to load locations.",type:"error"})}finally{h(!1)}},P=async I=>{x(!0);try{await ue.assignLocationToUser(t,I);const q=await ue.getUserLocations(t);o(q),j({message:"Location assigned successfully!",type:"success"}),s?.()}catch(q){console.error("Failed to assign location:",q),j({message:q.message||"Failed to assign location.",type:"error"})}finally{x(!1)}},D=async I=>{x(!0);try{await ue.unassignLocationFromUser(t,I);const q=await ue.getUserLocations(t);o(q),j({message:"Location unassigned successfully!",type:"success"}),s?.()}catch(q){console.error("Failed to unassign location:",q),j({message:q.message||"Failed to unassign location.",type:"error"})}finally{x(!1)}},M=I=>a.some(q=>q.id===I),O=l.filter(I=>!M(I.id)).filter(I=>v===""||I.name?.toLowerCase().includes(v.toLowerCase())||I.address?.toLowerCase().includes(v.toLowerCase()));return i.jsxs(i.Fragment,{children:[_&&i.jsx(ht,{message:_.message,type:_.type,onDismiss:()=>j(null)}),i.jsx(Yr,{isOpen:n,onClose:e,title:`Manage Locations for ${r}`,children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-primary-text mb-3",children:["Assigned Locations (",a.length,")"]}),d?i.jsx("p",{className:"text-sm text-muted",children:"Loading..."}):a.length===0?i.jsx("p",{className:"text-sm text-muted bg-gray-50 p-3 rounded-lg",children:"No locations assigned yet."}):i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:a.map(I=>i.jsxs("div",{className:"flex items-start justify-between bg-accent/10 border border-accent/30 rounded-lg p-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm text-primary-text",children:I.name||"Unnamed"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:I.address||"No address"})]}),i.jsx("button",{type:"button",onClick:()=>D(I.id),disabled:p,className:"text-red-500 hover:text-red-700 disabled:opacity-50 p-1",title:"Remove",children:i.jsx(xi,{className:"h-5 w-5"})})]},I.id))})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-primary-text mb-3",children:["Available Locations (",O.length,")"]}),i.jsx(je,{type:"text",placeholder:"Search locations...",value:v,onChange:I=>w(I.target.value),className:"mb-3"}),d?i.jsx("p",{className:"text-sm text-muted",children:"Loading..."}):O.length===0?i.jsx("p",{className:"text-sm text-muted bg-gray-50 p-3 rounded-lg",children:v?"No locations found.":"All assigned."}):i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:O.map(I=>i.jsxs("div",{className:"flex items-start justify-between border border-border rounded-lg p-3 hover:bg-gray-50",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm text-primary-text",children:I.name||"Unnamed"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:I.address||"No address"}),i.jsxs("p",{className:"text-xs text-muted mt-1",children:[I.latitude.toFixed(4),", ",I.longitude.toFixed(4),"  Radius: ",I.radius,"m"]})]}),i.jsx("button",{type:"button",onClick:()=>P(I.id),disabled:p,className:"text-accent hover:text-accent-dark disabled:opacity-50 p-1",title:"Assign",children:i.jsx(Bt,{className:"h-5 w-5"})})]},I.id))})]}),i.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:i.jsx(se,{onClick:e,variant:"secondary",children:"Done"})})]})})]})},zX=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[d,h]=E.useState(!1),[p,x]=E.useState(!1),[v,w]=E.useState(null),[_,j]=E.useState(null),[T,P]=E.useState(null),D=Ft("(max-width: 767px)"),M=E.useCallback(async()=>{s(!0);try{const $=await ue.getUsers();t($)}catch{P({message:"Failed to fetch users.",type:"error"})}finally{s(!1)}},[]);E.useEffect(()=>{M()},[M]);const O=()=>{n("/admin/users/add")},I=$=>{n(`/admin/users/edit/${$.id}`)},q=$=>{w($),h(!0)},F=$=>{w($),c(!0)},V=async($,ne)=>{o(!0);try{await ue.updateUser($,{role:ne}),P({message:"User approved successfully!",type:"success"}),h(!1),M()}catch{P({message:"Failed to approve user.",type:"error"})}finally{o(!1)}},U=async()=>{if(v){o(!0);try{await ue.deleteUser(v.id),P({message:"User deleted. Remember to also remove them from Supabase Auth.",type:"success"}),c(!1),M()}catch{P({message:"Failed to delete user.",type:"error"})}finally{o(!1)}}},W=$=>$?$.replace(/_/g," ").replace(/\b\w/g,ne=>ne.toUpperCase()):"N/A";return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[T&&i.jsx(ht,{message:T.message,type:T.type,onDismiss:()=>P(null)}),i.jsx(FX,{isOpen:d,onClose:()=>h(!1),onApprove:V,user:v,isConfirming:a}),i.jsxs(Yr,{isOpen:l,onClose:()=>c(!1),onConfirm:U,title:"Confirm Deletion",isConfirming:a,children:['Are you sure you want to delete the user "',v?.name,'"? This action cannot be undone.']}),i.jsx(qX,{isOpen:p,onClose:()=>x(!1),userId:_?.id||"",userName:_?.name||""}),i.jsx(Qi,{title:"User Management",children:i.jsxs(se,{onClick:O,children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add User"]})}),i.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 text-blue-800 p-4 rounded-lg text-sm",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(iu,{className:"h-5 w-5 mr-3 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold",children:"Adding New Users"}),i.jsxs("p",{className:"mt-1",children:["Use the ",i.jsx("strong",{children:"Add User"})," button below to create a new user. Provide their name, email, role and a temporary password. The system will automatically provision their login, send them a verification email and create their profile."]}),i.jsx("p",{className:"mt-2",children:"Once they confirm their email they can sign in using the password you set. You can edit or delete users at any time from this page."})]})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Email"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:r?D?i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsx(Oa,{rows:3,cols:4,isMobile:!0})})}):i.jsx(Oa,{rows:5,cols:4}):e.map($=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Name",className:"px-6 py-4 font-medium",children:$.name}),i.jsx("td",{"data-label":"Email",className:"px-6 py-4 text-sm text-muted",children:$.email}),i.jsxs("td",{"data-label":"Role",className:"px-6 py-4 text-sm text-muted",children:[i.jsxs("div",{className:"flex items-center md:justify-start justify-end",children:[i.jsx(oy,{className:"h-4 w-4 mr-2 text-accent"}),W($.role)]}),$.role==="unverified"&&i.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800 ml-2",children:"Pending Approval"})]}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[$.role==="unverified"&&i.jsxs(se,{variant:"outline",size:"sm",onClick:()=>q($),"aria-label":`Approve user ${$.name}`,title:`Approve user ${$.name}`,children:[i.jsx(hu,{className:"h-4 w-4 mr-2"}),"Approve"]}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>I($),"aria-label":`Edit user ${$.name}`,title:`Edit user ${$.name}`,children:i.jsx(cr,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",onClick:()=>F($),"aria-label":`Delete user ${$.name}`,title:`Delete user ${$.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})})]},$.id))})]})})]})};var Tb,gE;function UX(){if(gE)return Tb;gE=1;var n=!1,e,t,r,s,a,o,l,c,d,h,p,x,v,w,_;function j(){if(!n){n=!0;var P=navigator.userAgent,D=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(P),M=/(Mac OS X)|(Windows)|(Linux)/.exec(P);if(x=/\b(iPhone|iP[ao]d)/.exec(P),v=/\b(iP[ao]d)/.exec(P),h=/Android/i.exec(P),w=/FBAN\/\w+;/i.exec(P),_=/Mobile/i.exec(P),p=!!/Win64/.exec(P),D){e=D[1]?parseFloat(D[1]):D[5]?parseFloat(D[5]):NaN,e&&document&&document.documentMode&&(e=document.documentMode);var O=/(?:Trident\/(\d+.\d+))/.exec(P);o=O?parseFloat(O[1])+4:e,t=D[2]?parseFloat(D[2]):NaN,r=D[3]?parseFloat(D[3]):NaN,s=D[4]?parseFloat(D[4]):NaN,s?(D=/(?:Chrome\/(\d+\.\d+))/.exec(P),a=D&&D[1]?parseFloat(D[1]):NaN):a=NaN}else e=t=r=a=s=NaN;if(M){if(M[1]){var I=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(P);l=I?parseFloat(I[1].replace("_",".")):!0}else l=!1;c=!!M[2],d=!!M[3]}else l=c=d=!1}}var T={ie:function(){return j()||e},ieCompatibilityMode:function(){return j()||o>e},ie64:function(){return T.ie()&&p},firefox:function(){return j()||t},opera:function(){return j()||r},webkit:function(){return j()||s},safari:function(){return T.webkit()},chrome:function(){return j()||a},windows:function(){return j()||c},osx:function(){return j()||l},linux:function(){return j()||d},iphone:function(){return j()||x},mobile:function(){return j()||x||v||h||_},nativeApp:function(){return j()||w},android:function(){return j()||h},ipad:function(){return j()||v}};return Tb=T,Tb}var kb,xE;function VX(){if(xE)return kb;xE=1;var n=!!(typeof window<"u"&&window.document&&window.document.createElement),e={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};return kb=e,kb}var Pb,yE;function BX(){if(yE)return Pb;yE=1;var n=VX(),e;n.canUseDOM&&(e=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function t(r,s){if(!n.canUseDOM||s&&!("addEventListener"in document))return!1;var a="on"+r,o=a in document;if(!o){var l=document.createElement("div");l.setAttribute(a,"return;"),o=typeof l[a]=="function"}return!o&&e&&r==="wheel"&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o}return Pb=t,Pb}var Mb,vE;function WX(){if(vE)return Mb;vE=1;var n=UX(),e=BX(),t=10,r=40,s=800;function a(o){var l=0,c=0,d=0,h=0;return"detail"in o&&(c=o.detail),"wheelDelta"in o&&(c=-o.wheelDelta/120),"wheelDeltaY"in o&&(c=-o.wheelDeltaY/120),"wheelDeltaX"in o&&(l=-o.wheelDeltaX/120),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(l=c,c=0),d=l*t,h=c*t,"deltaY"in o&&(h=o.deltaY),"deltaX"in o&&(d=o.deltaX),(d||h)&&o.deltaMode&&(o.deltaMode==1?(d*=r,h*=r):(d*=s,h*=s)),d&&!l&&(l=d<1?-1:1),h&&!c&&(c=h<1?-1:1),{spinX:l,spinY:c,pixelX:d,pixelY:h}}return a.getEventType=function(){return n.firefox()?"DOMMouseScroll":e("wheel")?"wheel":"mousewheel"},Mb=a,Mb}var Eb,bE;function $X(){return bE||(bE=1,Eb=WX()),Eb}var HX=$X();const YX=gu(HX);function GX(n,e,t,r,s,a){a===void 0&&(a=0);var o=If(n,e,a),l=o.width,c=o.height,d=Math.min(l,t),h=Math.min(c,r);return d>h*s?{width:h*s,height:h}:{width:d,height:d/s}}function ZX(n){return n.width>n.height?n.width/n.naturalWidth:n.height/n.naturalHeight}function jh(n,e,t,r,s){s===void 0&&(s=0);var a=If(e.width,e.height,s),o=a.width,l=a.height;return{x:wE(n.x,o,t.width,r),y:wE(n.y,l,t.height,r)}}function wE(n,e,t,r){var s=e*r/2-t/2;return my(n,-s,s)}function _E(n,e){return Math.sqrt(Math.pow(n.y-e.y,2)+Math.pow(n.x-e.x,2))}function jE(n,e){return Math.atan2(e.y-n.y,e.x-n.x)*180/Math.PI}function KX(n,e,t,r,s,a,o){a===void 0&&(a=0),o===void 0&&(o=!0);var l=o?JX:QX,c=If(e.width,e.height,a),d=If(e.naturalWidth,e.naturalHeight,a),h={x:l(100,((c.width-t.width/s)/2-n.x/s)/c.width*100),y:l(100,((c.height-t.height/s)/2-n.y/s)/c.height*100),width:l(100,t.width/c.width*100/s),height:l(100,t.height/c.height*100/s)},p=Math.round(l(d.width,h.width*d.width/100)),x=Math.round(l(d.height,h.height*d.height/100)),v=d.width>=d.height*r,w=v?{width:Math.round(x*r),height:x}:{width:p,height:Math.round(p/r)},_=pr(pr({},w),{x:Math.round(l(d.width-w.width,h.x*d.width/100)),y:Math.round(l(d.height-w.height,h.y*d.height/100))});return{croppedAreaPercentages:h,croppedAreaPixels:_}}function JX(n,e){return Math.min(n,Math.max(0,e))}function QX(n,e){return e}function XX(n,e,t,r,s,a){var o=If(e.width,e.height,t),l=my(r.width/o.width*(100/n.width),s,a),c={x:l*o.width/2-r.width/2-o.width*l*(n.x/100),y:l*o.height/2-r.height/2-o.height*l*(n.y/100)};return{crop:c,zoom:l}}function eee(n,e,t){var r=ZX(e);return t.height>t.width?t.height/(n.height*r):t.width/(n.width*r)}function tee(n,e,t,r,s,a){t===void 0&&(t=0);var o=If(e.naturalWidth,e.naturalHeight,t),l=my(eee(n,e,r),s,a),c=r.height>r.width?r.height/n.height:r.width/n.width,d={x:((o.width-n.width)/2-n.x)*c,y:((o.height-n.height)/2-n.y)*c};return{crop:d,zoom:l}}function NE(n,e){return{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}function nee(n){return n*Math.PI/180}function If(n,e,t){var r=nee(t);return{width:Math.abs(Math.cos(r)*n)+Math.abs(Math.sin(r)*e),height:Math.abs(Math.sin(r)*n)+Math.abs(Math.cos(r)*e)}}function my(n,e,t){return Math.min(Math.max(n,e),t)}function Yp(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.filter(function(t){return typeof t=="string"&&t.length>0}).join(" ").trim()}var ree=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,see=1,iee=3,aee=1,oee=(function(n){sC(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.cropperRef=E.createRef(),t.imageRef=E.createRef(),t.videoRef=E.createRef(),t.containerPosition={x:0,y:0},t.containerRef=null,t.styleRef=null,t.containerRect=null,t.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},t.dragStartPosition={x:0,y:0},t.dragStartCrop={x:0,y:0},t.gestureZoomStart=0,t.gestureRotationStart=0,t.isTouching=!1,t.lastPinchDistance=0,t.lastPinchRotation=0,t.rafDragTimeout=null,t.rafPinchTimeout=null,t.wheelTimer=null,t.currentDoc=typeof document<"u"?document:null,t.currentWindow=typeof window<"u"?window:null,t.resizeObserver=null,t.previousCropSize=null,t.isInitialized=!1,t.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},t.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!t.containerRef)){var r=!0;t.resizeObserver=new window.ResizeObserver(function(s){if(r){r=!1;return}t.computeSizes()}),t.resizeObserver.observe(t.containerRef)}},t.preventZoomSafari=function(r){return r.preventDefault()},t.cleanEvents=function(){t.currentDoc&&(t.currentDoc.removeEventListener("mousemove",t.onMouseMove),t.currentDoc.removeEventListener("mouseup",t.onDragStopped),t.currentDoc.removeEventListener("touchmove",t.onTouchMove),t.currentDoc.removeEventListener("touchend",t.onDragStopped),t.currentDoc.removeEventListener("gesturechange",t.onGestureChange),t.currentDoc.removeEventListener("gestureend",t.onGestureEnd),t.currentDoc.removeEventListener("scroll",t.onScroll))},t.clearScrollEvent=function(){t.containerRef&&t.containerRef.removeEventListener("wheel",t.onWheel),t.wheelTimer&&clearTimeout(t.wheelTimer)},t.onMediaLoad=function(){var r=t.computeSizes();r&&(t.previousCropSize=r,t.emitCropData(),t.setInitialCrop(r),t.isInitialized=!0),t.props.onMediaLoaded&&t.props.onMediaLoaded(t.mediaSize)},t.setInitialCrop=function(r){if(t.props.initialCroppedAreaPercentages){var s=XX(t.props.initialCroppedAreaPercentages,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),a=s.crop,o=s.zoom;t.props.onCropChange(a),t.props.onZoomChange&&t.props.onZoomChange(o)}else if(t.props.initialCroppedAreaPixels){var l=tee(t.props.initialCroppedAreaPixels,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),a=l.crop,o=l.zoom;t.props.onCropChange(a),t.props.onZoomChange&&t.props.onZoomChange(o)}},t.computeSizes=function(){var r,s,a,o,l,c,d=t.imageRef.current||t.videoRef.current;if(d&&t.containerRef){t.containerRect=t.containerRef.getBoundingClientRect(),t.saveContainerPosition();var h=t.containerRect.width/t.containerRect.height,p=((r=t.imageRef.current)===null||r===void 0?void 0:r.naturalWidth)||((s=t.videoRef.current)===null||s===void 0?void 0:s.videoWidth)||0,x=((a=t.imageRef.current)===null||a===void 0?void 0:a.naturalHeight)||((o=t.videoRef.current)===null||o===void 0?void 0:o.videoHeight)||0,v=d.offsetWidth<p||d.offsetHeight<x,w=p/x,_=void 0;if(v)switch(t.state.mediaObjectFit){default:case"contain":_=h>w?{width:t.containerRect.height*w,height:t.containerRect.height}:{width:t.containerRect.width,height:t.containerRect.width/w};break;case"horizontal-cover":_={width:t.containerRect.width,height:t.containerRect.width/w};break;case"vertical-cover":_={width:t.containerRect.height*w,height:t.containerRect.height};break}else _={width:d.offsetWidth,height:d.offsetHeight};t.mediaSize=pr(pr({},_),{naturalWidth:p,naturalHeight:x}),t.props.setMediaSize&&t.props.setMediaSize(t.mediaSize);var j=t.props.cropSize?t.props.cropSize:GX(t.mediaSize.width,t.mediaSize.height,t.containerRect.width,t.containerRect.height,t.props.aspect,t.props.rotation);return(((l=t.state.cropSize)===null||l===void 0?void 0:l.height)!==j.height||((c=t.state.cropSize)===null||c===void 0?void 0:c.width)!==j.width)&&t.props.onCropSizeChange&&t.props.onCropSizeChange(j),t.setState({cropSize:j},t.recomputeCropPosition),t.props.setCropSize&&t.props.setCropSize(j),j}},t.saveContainerPosition=function(){if(t.containerRef){var r=t.containerRef.getBoundingClientRect();t.containerPosition={x:r.left,y:r.top}}},t.onMouseDown=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("mousemove",t.onMouseMove),t.currentDoc.addEventListener("mouseup",t.onDragStopped),t.saveContainerPosition(),t.onDragStart(e.getMousePoint(r)))},t.onMouseMove=function(r){return t.onDrag(e.getMousePoint(r))},t.onScroll=function(r){t.currentDoc&&(r.preventDefault(),t.saveContainerPosition())},t.onTouchStart=function(r){t.currentDoc&&(t.isTouching=!0,!(t.props.onTouchRequest&&!t.props.onTouchRequest(r))&&(t.currentDoc.addEventListener("touchmove",t.onTouchMove,{passive:!1}),t.currentDoc.addEventListener("touchend",t.onDragStopped),t.saveContainerPosition(),r.touches.length===2?t.onPinchStart(r):r.touches.length===1&&t.onDragStart(e.getTouchPoint(r.touches[0]))))},t.onTouchMove=function(r){r.preventDefault(),r.touches.length===2?t.onPinchMove(r):r.touches.length===1&&t.onDrag(e.getTouchPoint(r.touches[0]))},t.onGestureStart=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("gesturechange",t.onGestureChange),t.currentDoc.addEventListener("gestureend",t.onGestureEnd),t.gestureZoomStart=t.props.zoom,t.gestureRotationStart=t.props.rotation)},t.onGestureChange=function(r){if(r.preventDefault(),!t.isTouching){var s=e.getMousePoint(r),a=t.gestureZoomStart-1+r.scale;if(t.setNewZoom(a,s,{shouldUpdatePosition:!0}),t.props.onRotationChange){var o=t.gestureRotationStart+r.rotation;t.props.onRotationChange(o)}}},t.onGestureEnd=function(r){t.cleanEvents()},t.onDragStart=function(r){var s,a,o=r.x,l=r.y;t.dragStartPosition={x:o,y:l},t.dragStartCrop=pr({},t.props.crop),(a=(s=t.props).onInteractionStart)===null||a===void 0||a.call(s)},t.onDrag=function(r){var s=r.x,a=r.y;t.currentWindow&&(t.rafDragTimeout&&t.currentWindow.cancelAnimationFrame(t.rafDragTimeout),t.rafDragTimeout=t.currentWindow.requestAnimationFrame(function(){if(t.state.cropSize&&!(s===void 0||a===void 0)){var o=s-t.dragStartPosition.x,l=a-t.dragStartPosition.y,c={x:t.dragStartCrop.x+o,y:t.dragStartCrop.y+l},d=t.props.restrictPosition?jh(c,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):c;t.props.onCropChange(d)}}))},t.onDragStopped=function(){var r,s;t.isTouching=!1,t.cleanEvents(),t.emitCropData(),(s=(r=t.props).onInteractionEnd)===null||s===void 0||s.call(r)},t.onWheel=function(r){if(t.currentWindow&&!(t.props.onWheelRequest&&!t.props.onWheelRequest(r))){r.preventDefault();var s=e.getMousePoint(r),a=YX(r).pixelY,o=t.props.zoom-a*t.props.zoomSpeed/200;t.setNewZoom(o,s,{shouldUpdatePosition:!0}),t.state.hasWheelJustStarted||t.setState({hasWheelJustStarted:!0},function(){var l,c;return(c=(l=t.props).onInteractionStart)===null||c===void 0?void 0:c.call(l)}),t.wheelTimer&&clearTimeout(t.wheelTimer),t.wheelTimer=t.currentWindow.setTimeout(function(){return t.setState({hasWheelJustStarted:!1},function(){var l,c;return(c=(l=t.props).onInteractionEnd)===null||c===void 0?void 0:c.call(l)})},250)}},t.getPointOnContainer=function(r,s){var a=r.x,o=r.y;if(!t.containerRect)throw new Error("The Cropper is not mounted");return{x:t.containerRect.width/2-(a-s.x),y:t.containerRect.height/2-(o-s.y)}},t.getPointOnMedia=function(r){var s=r.x,a=r.y,o=t.props,l=o.crop,c=o.zoom;return{x:(s+l.x)/c,y:(a+l.y)/c}},t.setNewZoom=function(r,s,a){var o=a===void 0?{}:a,l=o.shouldUpdatePosition,c=l===void 0?!0:l;if(!(!t.state.cropSize||!t.props.onZoomChange)){var d=my(r,t.props.minZoom,t.props.maxZoom);if(c){var h=t.getPointOnContainer(s,t.containerPosition),p=t.getPointOnMedia(h),x={x:p.x*d-h.x,y:p.y*d-h.y},v=t.props.restrictPosition?jh(x,t.mediaSize,t.state.cropSize,d,t.props.rotation):x;t.props.onCropChange(v)}t.props.onZoomChange(d)}},t.getCropData=function(){if(!t.state.cropSize)return null;var r=t.props.restrictPosition?jh(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;return KX(r,t.mediaSize,t.state.cropSize,t.getAspect(),t.props.zoom,t.props.rotation,t.props.restrictPosition)},t.emitCropData=function(){var r=t.getCropData();if(r){var s=r.croppedAreaPercentages,a=r.croppedAreaPixels;t.props.onCropComplete&&t.props.onCropComplete(s,a),t.props.onCropAreaChange&&t.props.onCropAreaChange(s,a)}},t.emitCropAreaChange=function(){var r=t.getCropData();if(r){var s=r.croppedAreaPercentages,a=r.croppedAreaPixels;t.props.onCropAreaChange&&t.props.onCropAreaChange(s,a)}},t.recomputeCropPosition=function(){if(t.state.cropSize){var r=t.props.crop;if(t.isInitialized&&t.previousCropSize){var s=Math.abs(t.previousCropSize.width-t.state.cropSize.width)>1e-6||Math.abs(t.previousCropSize.height-t.state.cropSize.height)>1e-6;if(s){var a=t.state.cropSize.width/t.previousCropSize.width,o=t.state.cropSize.height/t.previousCropSize.height;r={x:t.props.crop.x*a,y:t.props.crop.y*o}}}var l=t.props.restrictPosition?jh(r,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):r;t.previousCropSize=t.state.cropSize,t.props.onCropChange(l),t.emitCropData()}},t.onKeyDown=function(r){var s,a,o=t.props,l=o.crop,c=o.onCropChange,d=o.keyboardStep,h=o.zoom,p=o.rotation,x=d;if(t.state.cropSize){r.shiftKey&&(x*=.2);var v=pr({},l);switch(r.key){case"ArrowUp":v.y-=x,r.preventDefault();break;case"ArrowDown":v.y+=x,r.preventDefault();break;case"ArrowLeft":v.x-=x,r.preventDefault();break;case"ArrowRight":v.x+=x,r.preventDefault();break;default:return}t.props.restrictPosition&&(v=jh(v,t.mediaSize,t.state.cropSize,h,p)),r.repeat||(a=(s=t.props).onInteractionStart)===null||a===void 0||a.call(s),c(v)}},t.onKeyUp=function(r){var s,a;switch(r.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":r.preventDefault();break;default:return}t.emitCropData(),(a=(s=t.props).onInteractionEnd)===null||a===void 0||a.call(s)},t}return e.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=ree,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},e.prototype.componentWillUnmount=function(){var t,r;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((r=this.styleRef.parentNode)===null||r===void 0||r.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},e.prototype.componentDidUpdate=function(t){var r,s,a,o,l,c,d,h,p;t.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):t.aspect!==this.props.aspect?this.computeSizes():t.objectFit!==this.props.objectFit?this.computeSizes():t.zoom!==this.props.zoom?this.recomputeCropPosition():((r=t.cropSize)===null||r===void 0?void 0:r.height)!==((s=this.props.cropSize)===null||s===void 0?void 0:s.height)||((a=t.cropSize)===null||a===void 0?void 0:a.width)!==((o=this.props.cropSize)===null||o===void 0?void 0:o.width)?this.computeSizes():(((l=t.crop)===null||l===void 0?void 0:l.x)!==((c=this.props.crop)===null||c===void 0?void 0:c.x)||((d=t.crop)===null||d===void 0?void 0:d.y)!==((h=this.props.crop)===null||h===void 0?void 0:h.y))&&this.emitCropAreaChange(),t.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),t.video!==this.props.video&&((p=this.videoRef.current)===null||p===void 0||p.load());var x=this.getObjectFit();x!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:x},this.computeSizes)},e.prototype.getAspect=function(){var t=this.props,r=t.cropSize,s=t.aspect;return r?r.width/r.height:s},e.prototype.getObjectFit=function(){var t,r,s,a;if(this.props.objectFit==="cover"){var o=this.imageRef.current||this.videoRef.current;if(o&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var l=this.containerRect.width/this.containerRect.height,c=((t=this.imageRef.current)===null||t===void 0?void 0:t.naturalWidth)||((r=this.videoRef.current)===null||r===void 0?void 0:r.videoWidth)||0,d=((s=this.imageRef.current)===null||s===void 0?void 0:s.naturalHeight)||((a=this.videoRef.current)===null||a===void 0?void 0:a.videoHeight)||0,h=c/d;return h<l?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},e.prototype.onPinchStart=function(t){var r=e.getTouchPoint(t.touches[0]),s=e.getTouchPoint(t.touches[1]);this.lastPinchDistance=_E(r,s),this.lastPinchRotation=jE(r,s),this.onDragStart(NE(r,s))},e.prototype.onPinchMove=function(t){var r=this;if(!(!this.currentDoc||!this.currentWindow)){var s=e.getTouchPoint(t.touches[0]),a=e.getTouchPoint(t.touches[1]),o=NE(s,a);this.onDrag(o),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var l=_E(s,a),c=r.props.zoom*(l/r.lastPinchDistance);r.setNewZoom(c,o,{shouldUpdatePosition:!1}),r.lastPinchDistance=l;var d=jE(s,a),h=r.props.rotation+(d-r.lastPinchRotation);r.props.onRotationChange&&r.props.onRotationChange(h),r.lastPinchRotation=d})}},e.prototype.render=function(){var t=this,r,s=this.props,a=s.image,o=s.video,l=s.mediaProps,c=s.cropperProps,d=s.transform,h=s.crop,p=h.x,x=h.y,v=s.rotation,w=s.zoom,_=s.cropShape,j=s.showGrid,T=s.roundCropAreaPixels,P=s.style,D=P.containerStyle,M=P.cropAreaStyle,O=P.mediaStyle,I=s.classes,q=I.containerClassName,F=I.cropAreaClassName,V=I.mediaClassName,U=(r=this.state.mediaObjectFit)!==null&&r!==void 0?r:this.getObjectFit();return E.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function($){return t.containerRef=$},"data-testid":"container",style:D,className:Yp("reactEasyCrop_Container",q)},a?E.createElement("img",pr({alt:"",className:Yp("reactEasyCrop_Image",U==="contain"&&"reactEasyCrop_Contain",U==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",U==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",V)},l,{src:a,ref:this.imageRef,style:pr(pr({},O),{transform:d||"translate(".concat(p,"px, ").concat(x,"px) rotate(").concat(v,"deg) scale(").concat(w,")")}),onLoad:this.onMediaLoad})):o&&E.createElement("video",pr({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:Yp("reactEasyCrop_Video",U==="contain"&&"reactEasyCrop_Contain",U==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",U==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",V)},l,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:pr(pr({},O),{transform:d||"translate(".concat(p,"px, ").concat(x,"px) rotate(").concat(v,"deg) scale(").concat(w,")")}),controls:!1}),(Array.isArray(o)?o:[{src:o}]).map(function(W){return E.createElement("source",pr({key:W.src},W))})),this.state.cropSize&&E.createElement("div",pr({ref:this.cropperRef,style:pr(pr({},M),{width:T?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:T?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:Yp("reactEasyCrop_CropArea",_==="round"&&"reactEasyCrop_CropAreaRound",j&&"reactEasyCrop_CropAreaGrid",F)},c)))},e.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:iee,minZoom:see,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:aee},e.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e})(E.Component);const lee=n=>new Promise((e,t)=>{const r=new Image;r.addEventListener("load",()=>e(r)),r.addEventListener("error",s=>t(s)),r.src=n});async function cee(n,e){const t=await lee(n),r=document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("No 2d context");return r.width=e.width,r.height=e.height,s.drawImage(t,e.x,e.y,e.width,e.height,0,0,e.width,e.height),r.toDataURL("image/jpeg",.9)}const t5=({isOpen:n,onClose:e,onCapture:t,captureGuidance:r="none"})=>{const s=E.useRef(null),a=E.useRef(null),o=E.useRef(null),[l,c]=E.useState(null),[d,h]=E.useState(null),[p,x]=E.useState(!1),[v,w]=E.useState(""),[_,j]=E.useState(!1),[T,P]=E.useState({x:0,y:0}),[D,M]=E.useState(1),[O,I]=E.useState(null),[q,F]=E.useState(null),[V,U]=E.useState([]),[W,$]=E.useState(0),[ne,Y]=E.useState(!1),[ae,J]=E.useState(!1),[ee,X]=E.useState(!1),[Z,oe]=E.useState(!1),[H,Q]=E.useState(),re=E.useCallback(()=>{o.current&&(o.current.getTracks().forEach(Ne=>Ne.stop()),o.current=null)},[]),de=E.useCallback(async Ne=>{re(),c(null),j(!1),Y(!1);try{const Ue={video:Ne?{deviceId:{exact:Ne}}:{facingMode:"environment"}},Be=await navigator.mediaDevices.getUserMedia(Ue);o.current=Be,s.current&&(s.current.srcObject=Be),h(null);const qe=Be.getVideoTracks()[0];if(qe){const te=qe.getCapabilities();J(!!te.torch),Q(qe.getSettings().facingMode)}else J(!1)}catch(Ue){console.error("Error accessing camera:",Ue),h("Could not access camera. Please check permissions.")}},[re]);E.useEffect(()=>{if(!n){re();return}let Ne=!1;return(async()=>{try{const Be=await navigator.mediaDevices.getUserMedia({video:!0});if(Ne){Be.getTracks().forEach(le=>le.stop());return}const te=(await navigator.mediaDevices.enumerateDevices()).filter(le=>le.kind==="videoinput");if(Be.getTracks().forEach(le=>le.stop()),Ne)return;if(U(te),te.length>0){let le=W;le>=te.length&&(le=0),await de(te[le].deviceId)}else h("No camera found.")}catch(Be){console.error(Be),h("Could not access camera.")}})(),()=>{Ne=!0,re()}},[n,W,de,re]);const ce=()=>{if(s.current&&a.current){const Ne=s.current,Ue=a.current;Ue.width=Ne.videoWidth,Ue.height=Ne.videoHeight,Ue.getContext("2d")?.drawImage(Ne,0,0,Ne.videoWidth,Ne.videoHeight),c(Ue.toDataURL("image/jpeg",.9)),re()}},pe=()=>{H==="user"&&ee?(oe(!0),setTimeout(()=>{ce(),oe(!1)},100)):ce()},ie=()=>{h(null),c(null),F(null),j(!1),M(1)},xe=async()=>{if(!o.current||!ae)return;const Ne=o.current.getVideoTracks()[0];try{await Ne.applyConstraints({advanced:[{torch:!ne}]}),Y(!ne)}catch(Ue){console.error("Failed to toggle flash",Ue)}},Ce=E.useCallback((Ne,Ue)=>{I(Ue)},[]),ve=()=>{j(!0),M(1)},Oe=async()=>{try{if(l&&O){const Ne=await cee(l,O);F(Ne),j(!1)}}catch(Ne){console.error(Ne),h("Failed to crop image")}},Pe=()=>{j(!1),M(1),F(null)},Ie=async()=>{const Ne=q||l;if(Ne){x(!0);try{const Ue=Ne.split(",")[1];w("Enhancing photo...");const qe=(r==="document"?await ue.enhanceDocumentPhoto(Ue,"image/jpeg"):null)||Ue;t(qe,"image/jpeg"),e()}catch(Ue){h(Ue.message||"Processing failed.")}finally{x(!1)}}},Fe=()=>{re(),e()};if(!n)return null;const we=q||l;return i.jsxs("div",{className:"fixed inset-0 z-[200] flex flex-col bg-black text-white",children:[Z&&i.jsx("div",{className:"absolute inset-0 bg-white z-50"}),p&&i.jsxs("div",{className:"absolute inset-0 z-40 flex flex-col items-center justify-center bg-black/80",children:[i.jsx(_t,{className:"h-12 w-12 animate-spin text-white"}),i.jsx("p",{className:"mt-4 text-lg font-semibold",children:v})]}),i.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 bg-gradient-to-b from-black/70 to-transparent z-30 flex justify-between items-center",children:[i.jsx(se,{variant:"icon",className:"!text-white hover:!bg-white/20 !p-2",onClick:Fe,children:i.jsx(Ra,{className:"h-6 w-6"})}),i.jsx("h3",{className:"text-lg font-bold flex-1 text-center",children:_?"Crop Photo":l?"Preview":"Capture Photo"}),i.jsx("div",{className:"w-10"})]}),i.jsxs("div",{className:"flex-grow relative flex items-center justify-center overflow-hidden bg-black",children:[d&&!l&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white p-4 text-center bg-black/50 z-10",children:d}),_&&l?i.jsx("div",{className:"absolute inset-0",children:i.jsx(oee,{image:l,crop:T,zoom:D,aspect:r==="profile"?1:4/3,onCropChange:P,onCropComplete:Ce,onZoomChange:M,cropShape:r==="profile"?"round":"rect",style:{containerStyle:{backgroundColor:"transparent"},mediaStyle:{objectFit:"contain"}},classes:{containerClassName:"bg-black/30"}})}):i.jsxs(i.Fragment,{children:[i.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,muted:!0,className:`w-full h-full object-cover ${l?"hidden":""}`}),we&&i.jsx("img",{src:we,alt:"Preview",className:"w-full h-full object-contain"})]}),i.jsx("canvas",{ref:a,className:"hidden"})]}),i.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent z-30",children:[d&&!l&&i.jsx("div",{className:"mb-2 p-3 bg-red-500/30 text-white text-sm rounded-lg text-center",children:d}),_&&i.jsx("div",{className:"mb-4 px-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(EC,{className:"h-5 w-5 text-white/70"}),i.jsx("input",{type:"range",min:1,max:3,step:.1,value:D,onChange:Ne=>M(Number(Ne.target.value)),className:"flex-1 h-1 bg-white/20 rounded-lg"}),i.jsx(MC,{className:"h-5 w-5 text-white/70"})]})}),i.jsx("div",{className:"flex justify-around items-center",children:_?i.jsxs(i.Fragment,{children:[i.jsx(se,{onClick:Pe,variant:"secondary",size:"lg",className:"!rounded-full !px-6",children:"Cancel"}),i.jsxs(se,{onClick:Oe,size:"lg",className:"!rounded-full !px-6",children:[i.jsx(_l,{className:"h-5 w-5 mr-2"})," Apply"]})]}):l?i.jsxs(i.Fragment,{children:[i.jsx(se,{onClick:ie,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:i.jsx(OS,{className:"h-6 w-6"})}),i.jsx(se,{onClick:ve,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:i.jsx(pJ,{className:"h-6 w-6"})}),i.jsx(se,{onClick:Ie,size:"lg",className:"!rounded-full !p-4",children:i.jsx(_l,{className:"h-6 w-6"})})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"w-16 h-16 flex items-center justify-center",children:[H==="environment"&&ae&&i.jsx(se,{onClick:xe,variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3",children:ne?i.jsx(zJ,{className:"h-6 w-6"}):i.jsx(IS,{className:"h-6 w-6"})}),H==="user"&&i.jsx(se,{onClick:()=>X(!ee),variant:"icon",className:`!rounded-full !p-3 ${ee?"!text-yellow-400":"!text-white"} hover:!bg-white/20`,children:i.jsx(x3,{className:"h-6 w-6"})})]}),i.jsx(se,{onClick:pe,disabled:!!d||!o.current,size:"lg",className:"!rounded-full !w-20 !h-20",children:i.jsx(SC,{className:"h-8 w-8"})}),i.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:V.length>1&&i.jsx(se,{onClick:()=>$(Ne=>(Ne+1)%V.length),variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3",children:i.jsx(OS,{className:"h-6 w-6"})})})]})})]})]})},dee=({isOpen:n,onClose:e,imageUrl:t})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 p-4",onClick:e,role:"dialog","aria-modal":"true",children:i.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",onClick:r=>r.stopPropagation(),children:[i.jsx("img",{src:t,alt:"Document Preview",className:"max-w-full max-h-full object-contain rounded-lg"}),i.jsx("button",{onClick:e,className:"absolute top-0 right-0 m-2 p-2 bg-black/50 rounded-full text-white hover:bg-black/80 transition-colors","aria-label":"Close image preview",children:i.jsx(xi,{className:"h-6 w-6"})})]})}):null,yt=({label:n,file:e,onFileChange:t,allowedTypes:r=["image/jpeg","image/png","application/pdf"],error:s,allowCapture:a=!1,costingItemName:o,verificationStatus:l,onOcrComplete:c,ocrSchema:d,setToast:h,docType:p,onVerification:x})=>{const[v,w]=E.useState(!1),[_,j]=E.useState(""),[T,P]=E.useState(!1),[D,M]=E.useState(!1),{logVerificationUsage:O}=$n.getState(),I=E.useMemo(()=>{const Y=n.toLowerCase();return Y.includes("photo")?"profile":["proof","document","card","slip","passbook","cheque","certificate"].some(ae=>Y.includes(ae))?"document":"none"},[n]),q=E.useCallback(async Y=>{if(!r.includes(Y.type)){j(`Invalid file type. Allowed: ${r.join(", ")}.`);return}if(Y.size>5*1024*1024){j("File size must be less than 5MB.");return}j(""),w(!0);const ae=URL.createObjectURL(Y);let J={name:Y.name,type:Y.type,size:Y.size,preview:ae,file:Y};t(J),o&&O(o);try{const ee=new FileReader;ee.readAsDataURL(Y),ee.onloadend=async()=>{try{const X=ee.result.split(",")[1];if(x){const Z=await x(X,Y.type);if(!Z.success){j(Z.reason),w(!1);return}}if(c&&d&&h)try{const Z=await ue.extractDataFromImage(X,Y.type,d,p);c(Z)}catch(Z){console.error("OCR failed:",Z),h({message:"AI extraction failed. Please check the document.",type:"error"})}}catch(X){j(X.message||"Processing failed.")}finally{w(!1)}},ee.onerror=()=>{throw new Error("Could not read file for processing.")}}catch(ee){j(ee.message||"Processing failed."),w(!1)}},[r,t,o,O,c,d,h,p,x]),F=E.useCallback(async(Y,ae)=>{const J=await(await fetch(`data:${ae};base64,${Y}`)).blob(),ee=new File([J],`capture-${Date.now()}.jpg`,{type:ae});q(ee)},[q]),V=()=>{e&&URL.revokeObjectURL(e.preview),t(null),j("")},U=`file-upload-${n.replace(/\s+/g,"-")}`,W=s||_,ne=(Y=>{const ae=Y.toLowerCase();return ae.includes("profile photo")?kl:ae.includes("id proof")||ae.includes("aadhaar")||ae.includes("pan")||ae.includes("voter")?r3:ae.includes("bank proof")?Cl:ae.includes("signature")?MS:ae.includes("fingerprint")?i3:ae.includes("certificate")?a3:ls})(n);return i.jsxs("div",{className:"w-full",children:[i.jsx(dee,{isOpen:D,onClose:()=>M(!1),imageUrl:e?.preview||""}),T&&i.jsx(t5,{isOpen:T,onClose:()=>P(!1),onCapture:F,captureGuidance:I}),i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("label",{className:"block text-sm font-medium text-muted",htmlFor:U,children:n}),l===!0&&i.jsx("span",{title:"Verified",children:i.jsx(Yi,{className:"h-4 w-4 text-green-400"})}),l===!1&&i.jsx("span",{title:"Verification Failed",children:i.jsx(pm,{className:"h-4 w-4 text-red-400"})})]}),i.jsx("div",{className:"w-full text-center transition-all duration-300",children:e?i.jsxs("div",{className:"w-full flex flex-col h-full bg-page p-2 border border-border rounded-lg relative pro-dark-theme:bg-[#0d2c18] pro-dark-theme:border-[#123820]",children:[i.jsxs("div",{className:"flex-grow w-full rounded-md overflow-hidden group relative bg-black/10 flex items-center justify-center min-h-[100px]",children:[v?i.jsxs("div",{className:"flex flex-col items-center text-muted",children:[i.jsx(_t,{className:"h-8 w-8 animate-spin"}),i.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):e.type.startsWith("image/")?i.jsx("img",{src:e.preview,alt:"preview",className:"max-w-full max-h-28 object-contain"}):i.jsxs("div",{className:"text-muted p-2",children:[i.jsx(bJ,{className:"h-10 w-10 mx-auto"}),i.jsx("span",{className:"text-xs mt-1 block break-all",children:e.name})]}),i.jsx("label",{htmlFor:U,className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-md cursor-pointer",children:i.jsx(OS,{className:"h-6 w-6 text-white"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 flex-shrink-0",children:[e.type.startsWith("image/")&&i.jsxs("button",{type:"button",onClick:()=>M(!0),className:"text-xs font-medium text-accent hover:underline flex items-center gap-1 p-1",children:[i.jsx(Sl,{className:"h-3 w-3"})," View"]}),i.jsxs("button",{type:"button",onClick:V,className:"text-xs font-medium text-red-500 hover:underline flex items-center gap-1 p-1",children:[i.jsx(rn,{className:"h-3 w-3"})," Remove"]})]})]}):i.jsxs("label",{htmlFor:U,className:`
                        cursor-pointer flex flex-col items-center justify-center
                        p-6 border-2 border-dashed rounded-lg transition-colors
                        border-border hover:border-accent hover:bg-accent-light
                        pro-dark-theme:border-gray-600 pro-dark-theme:hover:border-accent pro-dark-theme:hover:bg-accent-light
                        ${W?"!border-red-500":""}
                    `,children:[i.jsx("div",{className:"p-3 bg-accent-light rounded-full text-accent-dark pro-dark-theme:bg-accent/20 pro-dark-theme:text-accent",children:i.jsx(ne,{className:"h-8 w-8"})}),i.jsx("p",{className:"font-semibold text-primary-text mt-2",children:"Click to upload"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:"or drag & drop"}),a&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-xs text-muted my-2",children:"OR"}),i.jsxs(se,{type:"button",onClick:Y=>{Y.preventDefault(),P(!0)},variant:"secondary",size:"sm",children:[i.jsx(SC,{className:"h-4 w-4 mr-2"}),"Capture with Camera"]})]})]})}),i.jsx("input",{id:U,type:"file",className:"sr-only",onChange:Y=>Y.target.files?.[0]&&q(Y.target.files[0]),accept:r.join(",")}),i.jsx("div",{className:"text-center mt-1 min-h-[16px]",children:W&&i.jsx("p",{className:"text-xs text-red-500",children:W})})]})};var Db={},Nh={},Ob={exports:{}},Ib,SE;function uee(){if(SE)return Ib;SE=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Ib=n,Ib}var Ab,CE;function fee(){if(CE)return Ab;CE=1;var n=uee();function e(){}function t(){}return t.resetWarningCache=e,Ab=function(){function r(o,l,c,d,h,p){if(p!==n){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}r.isRequired=r;function s(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:t,resetWarningCache:e};return a.PropTypes=a,a},Ab}var TE;function Ml(){return TE||(TE=1,Ob.exports=fee()()),Ob.exports}var Sh={},Bd={},Rb={exports:{}};var kE;function bu(){return kE||(kE=1,(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var a="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(a=s(a,r(l)))}return a}function r(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return t.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var o="";for(var l in a)e.call(a,l)&&a[l]&&(o=s(o,l));return o}function s(a,o){return o?a?a+" "+o:a+o:a}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(Rb)),Rb.exports}var Lb={},Fb={},qb={},zb={},PE;function Re(){if(PE)return zb;PE=1,zb.toDate=n;function n(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}return zb}var Ub={},ME;function un(){if(ME)return Ub;ME=1,Ub.constructFrom=n;function n(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}return Ub}var EE;function El(){if(EE)return qb;EE=1,qb.addDays=t;var n=Re(),e=un();function t(r,s){const a=(0,n.toDate)(r);return isNaN(s)?(0,e.constructFrom)(r,NaN):(s&&a.setDate(a.getDate()+s),a)}return qb}var Vb={},DE;function Im(){if(DE)return Vb;DE=1,Vb.addMonths=t;var n=Re(),e=un();function t(r,s){const a=(0,n.toDate)(r);if(isNaN(s))return(0,e.constructFrom)(r,NaN);if(!s)return a;const o=a.getDate(),l=(0,e.constructFrom)(r,a.getTime());l.setMonth(a.getMonth()+s+1,0);const c=l.getDate();return o>=c?l:(a.setFullYear(l.getFullYear(),l.getMonth(),o),a)}return Vb}var OE;function n5(){if(OE)return Fb;OE=1,Fb.add=s;var n=El(),e=Im(),t=un(),r=Re();function s(a,o){const{years:l=0,months:c=0,weeks:d=0,days:h=0,hours:p=0,minutes:x=0,seconds:v=0}=o,w=(0,r.toDate)(a),_=c||l?(0,e.addMonths)(w,c+l*12):w,j=h||d?(0,n.addDays)(_,h+d*7):_,T=x+p*60,D=(v+T*60)*1e3;return(0,t.constructFrom)(a,j.getTime()+D)}return Fb}var Bb={},Wb={},IE;function r5(){if(IE)return Wb;IE=1,Wb.isSaturday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===6}return Wb}var $b={},AE;function s5(){if(AE)return $b;AE=1,$b.isSunday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===0}return $b}var Hb={},RE;function py(){if(RE)return Hb;RE=1,Hb.isWeekend=e;var n=Re();function e(t){const r=(0,n.toDate)(t).getDay();return r===0||r===6}return Hb}var LE;function i5(){if(LE)return Bb;LE=1,Bb.addBusinessDays=a;var n=un(),e=r5(),t=s5(),r=py(),s=Re();function a(o,l){const c=(0,s.toDate)(o),d=(0,r.isWeekend)(c);if(isNaN(l))return(0,n.constructFrom)(o,NaN);const h=c.getHours(),p=l<0?-1:1,x=Math.trunc(l/5);c.setDate(c.getDate()+x*7);let v=Math.abs(l%5);for(;v>0;)c.setDate(c.getDate()+p),(0,r.isWeekend)(c)||(v-=1);return d&&(0,r.isWeekend)(c)&&l!==0&&((0,e.isSaturday)(c)&&c.setDate(c.getDate()+(p<0?2:-1)),(0,t.isSunday)(c)&&c.setDate(c.getDate()+(p<0?1:-2))),c.setHours(h),c}return Bb}var Yb={},Gb={},FE;function Am(){if(FE)return Gb;FE=1,Gb.addMilliseconds=t;var n=Re(),e=un();function t(r,s){const a=+(0,n.toDate)(r);return(0,e.constructFrom)(r,a+s)}return Gb}var Ot={},qE;function Qt(){if(qE)return Ot;qE=1,Ot.secondsInYear=Ot.secondsInWeek=Ot.secondsInQuarter=Ot.secondsInMonth=Ot.secondsInMinute=Ot.secondsInHour=Ot.secondsInDay=Ot.quartersInYear=Ot.monthsInYear=Ot.monthsInQuarter=Ot.minutesInYear=Ot.minutesInMonth=Ot.minutesInHour=Ot.minutesInDay=Ot.minTime=Ot.millisecondsInWeek=Ot.millisecondsInSecond=Ot.millisecondsInMinute=Ot.millisecondsInHour=Ot.millisecondsInDay=Ot.maxTime=Ot.daysInYear=Ot.daysInWeek=void 0,Ot.daysInWeek=7;const n=Ot.daysInYear=365.2425,e=Ot.maxTime=Math.pow(10,8)*24*60*60*1e3;Ot.minTime=-e,Ot.millisecondsInWeek=6048e5,Ot.millisecondsInDay=864e5,Ot.millisecondsInMinute=6e4,Ot.millisecondsInHour=36e5,Ot.millisecondsInSecond=1e3,Ot.minutesInYear=525600,Ot.minutesInMonth=43200,Ot.minutesInDay=1440,Ot.minutesInHour=60,Ot.monthsInQuarter=3,Ot.monthsInYear=12,Ot.quartersInYear=4;const t=Ot.secondsInHour=3600;Ot.secondsInMinute=60;const r=Ot.secondsInDay=t*24;Ot.secondsInWeek=r*7;const s=Ot.secondsInYear=r*n,a=Ot.secondsInMonth=s/12;return Ot.secondsInQuarter=a*3,Ot}var zE;function VC(){if(zE)return Yb;zE=1,Yb.addHours=t;var n=Am(),e=Qt();function t(r,s){return(0,n.addMilliseconds)(r,s*e.millisecondsInHour)}return Yb}var Zb={},Kb={},Jb={},Qb={},Gp={},UE;function Cs(){if(UE)return Gp;UE=1,Gp.getDefaultOptions=e,Gp.setDefaultOptions=t;let n={};function e(){return n}function t(r){n=r}return Gp}var VE;function ko(){if(VE)return Qb;VE=1,Qb.startOfWeek=t;var n=Re(),e=Cs();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?7:0)+c-o;return l.setDate(l.getDate()-d),l.setHours(0,0,0,0),l}return Qb}var BE;function Dl(){if(BE)return Jb;BE=1,Jb.startOfISOWeek=e;var n=ko();function e(t){return(0,n.startOfWeek)(t,{weekStartsOn:1})}return Jb}var WE;function wu(){if(WE)return Kb;WE=1,Kb.getISOWeekYear=r;var n=un(),e=Dl(),t=Re();function r(s){const a=(0,t.toDate)(s),o=a.getFullYear(),l=(0,n.constructFrom)(s,0);l.setFullYear(o+1,0,4),l.setHours(0,0,0,0);const c=(0,e.startOfISOWeek)(l),d=(0,n.constructFrom)(s,0);d.setFullYear(o,0,4),d.setHours(0,0,0,0);const h=(0,e.startOfISOWeek)(d);return a.getTime()>=c.getTime()?o+1:a.getTime()>=h.getTime()?o:o-1}return Kb}var Xb={},e0={},t0={},$E;function gy(){if($E)return t0;$E=1,t0.startOfDay=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setHours(0,0,0,0),r}return t0}var n0={},HE;function td(){if(HE)return n0;HE=1,n0.getTimezoneOffsetInMilliseconds=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+t-+s}return n0}var YE;function nd(){if(YE)return e0;YE=1,e0.differenceInCalendarDays=r;var n=Qt(),e=gy(),t=td();function r(s,a){const o=(0,e.startOfDay)(s),l=(0,e.startOfDay)(a),c=+o-(0,t.getTimezoneOffsetInMilliseconds)(o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l);return Math.round((c-d)/n.millisecondsInDay)}return e0}var r0={},GE;function Rm(){if(GE)return r0;GE=1,r0.startOfISOWeekYear=r;var n=wu(),e=Dl(),t=un();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);return o.setFullYear(a,0,4),o.setHours(0,0,0,0),(0,e.startOfISOWeek)(o)}return r0}var ZE;function a5(){if(ZE)return Xb;ZE=1,Xb.setISOWeekYear=s;var n=un(),e=nd(),t=Rm(),r=Re();function s(a,o){let l=(0,r.toDate)(a);const c=(0,e.differenceInCalendarDays)(l,(0,t.startOfISOWeekYear)(l)),d=(0,n.constructFrom)(a,0);return d.setFullYear(o,0,4),d.setHours(0,0,0,0),l=(0,t.startOfISOWeekYear)(d),l.setDate(l.getDate()+c),l}return Xb}var KE;function o5(){if(KE)return Zb;KE=1,Zb.addISOWeekYears=t;var n=wu(),e=a5();function t(r,s){return(0,e.setISOWeekYear)(r,(0,n.getISOWeekYear)(r)+s)}return Zb}var s0={},JE;function BC(){if(JE)return s0;JE=1,s0.addMinutes=t;var n=Am(),e=Qt();function t(r,s){return(0,n.addMilliseconds)(r,s*e.millisecondsInMinute)}return s0}var i0={},QE;function WC(){if(QE)return i0;QE=1,i0.addQuarters=e;var n=Im();function e(t,r){const s=r*3;return(0,n.addMonths)(t,s)}return i0}var a0={},XE;function l5(){if(XE)return a0;XE=1,a0.addSeconds=e;var n=Am();function e(t,r){return(0,n.addMilliseconds)(t,r*1e3)}return a0}var o0={},eD;function xy(){if(eD)return o0;eD=1,o0.addWeeks=e;var n=El();function e(t,r){const s=r*7;return(0,n.addDays)(t,s)}return o0}var l0={},tD;function c5(){if(tD)return l0;tD=1,l0.addYears=e;var n=Im();function e(t,r){return(0,n.addMonths)(t,r*12)}return l0}var c0={},nD;function hee(){if(nD)return c0;nD=1,c0.areIntervalsOverlapping=e;var n=Re();function e(t,r,s){const[a,o]=[+(0,n.toDate)(t.start),+(0,n.toDate)(t.end)].sort((d,h)=>d-h),[l,c]=[+(0,n.toDate)(r.start),+(0,n.toDate)(r.end)].sort((d,h)=>d-h);return s?.inclusive?a<=c&&l<=o:a<c&&l<o}return c0}var d0={},u0={},rD;function d5(){if(rD)return u0;rD=1,u0.max=e;var n=Re();function e(t){let r;return t.forEach(function(s){const a=(0,n.toDate)(s);(r===void 0||r<a||isNaN(Number(a)))&&(r=a)}),r||new Date(NaN)}return u0}var f0={},sD;function u5(){if(sD)return f0;sD=1,f0.min=e;var n=Re();function e(t){let r;return t.forEach(s=>{const a=(0,n.toDate)(s);(!r||r>a||isNaN(+a))&&(r=a)}),r||new Date(NaN)}return f0}var iD;function mee(){if(iD)return d0;iD=1,d0.clamp=t;var n=d5(),e=u5();function t(r,s){return(0,e.min)([(0,n.max)([r,s.start]),s.end])}return d0}var h0={},aD;function pee(){if(aD)return h0;aD=1,h0.closestIndexTo=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);if(isNaN(Number(s)))return NaN;const a=s.getTime();let o,l;return r.forEach(function(c,d){const h=(0,n.toDate)(c);if(isNaN(Number(h))){o=NaN,l=NaN;return}const p=Math.abs(a-h.getTime());(o==null||p<l)&&(o=d,l=p)}),o}return h0}var m0={},oD;function gee(){if(oD)return m0;oD=1,m0.closestTo=t;var n=un(),e=Re();function t(r,s){const a=(0,e.toDate)(r);if(isNaN(Number(a)))return(0,n.constructFrom)(r,NaN);const o=a.getTime();let l,c;return s.forEach(d=>{const h=(0,e.toDate)(d);if(isNaN(Number(h))){l=(0,n.constructFrom)(r,NaN),c=NaN;return}const p=Math.abs(o-h.getTime());(l==null||p<c)&&(l=h,c=p)}),l}return m0}var p0={},lD;function Wf(){if(lD)return p0;lD=1,p0.compareAsc=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getTime()-a.getTime();return o<0?-1:o>0?1:o}return p0}var g0={},cD;function xee(){if(cD)return g0;cD=1,g0.compareDesc=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getTime()-a.getTime();return o>0?-1:o<0?1:o}return g0}var x0={},dD;function Zs(){if(dD)return x0;dD=1,x0.constructNow=e;var n=un();function e(t){return(0,n.constructFrom)(t,Date.now())}return x0}var y0={},uD;function yee(){if(uD)return y0;uD=1,y0.daysToWeeks=e;var n=Qt();function e(t){const r=t/n.daysInWeek,s=Math.trunc(r);return s===0?0:s}return y0}var v0={},b0={},fD;function Lm(){if(fD)return b0;fD=1,b0.isSameDay=e;var n=gy();function e(t,r){const s=(0,n.startOfDay)(t),a=(0,n.startOfDay)(r);return+s==+a}return b0}var w0={},_0={},hD;function f5(){if(hD)return _0;hD=1,_0.isDate=n;function n(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}return _0}var mD;function rd(){if(mD)return w0;mD=1,w0.isValid=t;var n=f5(),e=Re();function t(r){if(!(0,n.isDate)(r)&&typeof r!="number")return!1;const s=(0,e.toDate)(r);return!isNaN(Number(s))}return w0}var pD;function vee(){if(pD)return v0;pD=1,v0.differenceInBusinessDays=o;var n=El(),e=nd(),t=Lm(),r=rd(),s=py(),a=Re();function o(l,c){const d=(0,a.toDate)(l);let h=(0,a.toDate)(c);if(!(0,r.isValid)(d)||!(0,r.isValid)(h))return NaN;const p=(0,e.differenceInCalendarDays)(d,h),x=p<0?-1:1,v=Math.trunc(p/7);let w=v*5;for(h=(0,n.addDays)(h,v*7);!(0,t.isSameDay)(d,h);)w+=(0,s.isWeekend)(h)?0:x,h=(0,n.addDays)(h,x);return w===0?0:w}return v0}var j0={},gD;function h5(){if(gD)return j0;gD=1,j0.differenceInCalendarISOWeekYears=e;var n=wu();function e(t,r){return(0,n.getISOWeekYear)(t)-(0,n.getISOWeekYear)(r)}return j0}var N0={},xD;function bee(){if(xD)return N0;xD=1,N0.differenceInCalendarISOWeeks=r;var n=Qt(),e=Dl(),t=td();function r(s,a){const o=(0,e.startOfISOWeek)(s),l=(0,e.startOfISOWeek)(a),c=+o-(0,t.getTimezoneOffsetInMilliseconds)(o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l);return Math.round((c-d)/n.millisecondsInWeek)}return N0}var S0={},yD;function $C(){if(yD)return S0;yD=1,S0.differenceInCalendarMonths=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getFullYear()-a.getFullYear(),l=s.getMonth()-a.getMonth();return o*12+l}return S0}var C0={},T0={},vD;function m5(){if(vD)return T0;vD=1,T0.getQuarter=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return Math.trunc(r.getMonth()/3)+1}return T0}var bD;function p5(){if(bD)return C0;bD=1,C0.differenceInCalendarQuarters=t;var n=m5(),e=Re();function t(r,s){const a=(0,e.toDate)(r),o=(0,e.toDate)(s),l=a.getFullYear()-o.getFullYear(),c=(0,n.getQuarter)(a)-(0,n.getQuarter)(o);return l*4+c}return C0}var k0={},wD;function HC(){if(wD)return k0;wD=1,k0.differenceInCalendarWeeks=r;var n=Qt(),e=ko(),t=td();function r(s,a,o){const l=(0,e.startOfWeek)(s,o),c=(0,e.startOfWeek)(a,o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l),h=+c-(0,t.getTimezoneOffsetInMilliseconds)(c);return Math.round((d-h)/n.millisecondsInWeek)}return k0}var P0={},_D;function YC(){if(_D)return P0;_D=1,P0.differenceInCalendarYears=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()-a.getFullYear()}return P0}var M0={},jD;function GC(){if(jD)return M0;jD=1,M0.differenceInDays=t;var n=nd(),e=Re();function t(s,a){const o=(0,e.toDate)(s),l=(0,e.toDate)(a),c=r(o,l),d=Math.abs((0,n.differenceInCalendarDays)(o,l));o.setDate(o.getDate()-c*d);const h=+(r(o,l)===-c),p=c*(d-h);return p===0?0:p}function r(s,a){const o=s.getFullYear()-a.getFullYear()||s.getMonth()-a.getMonth()||s.getDate()-a.getDate()||s.getHours()-a.getHours()||s.getMinutes()-a.getMinutes()||s.getSeconds()-a.getSeconds()||s.getMilliseconds()-a.getMilliseconds();return o<0?-1:o>0?1:o}return M0}var E0={},D0={},ND;function sd(){if(ND)return D0;ND=1,D0.getRoundingMethod=n;function n(e){return t=>{const s=(e?Math[e]:Math.trunc)(t);return s===0?0:s}}return D0}var O0={},SD;function yy(){if(SD)return O0;SD=1,O0.differenceInMilliseconds=e;var n=Re();function e(t,r){return+(0,n.toDate)(t)-+(0,n.toDate)(r)}return O0}var CD;function ZC(){if(CD)return E0;CD=1,E0.differenceInHours=r;var n=sd(),e=Qt(),t=yy();function r(s,a,o){const l=(0,t.differenceInMilliseconds)(s,a)/e.millisecondsInHour;return(0,n.getRoundingMethod)(o?.roundingMethod)(l)}return E0}var I0={},A0={},TD;function g5(){if(TD)return A0;TD=1,A0.subISOWeekYears=e;var n=o5();function e(t,r){return(0,n.addISOWeekYears)(t,-r)}return A0}var kD;function wee(){if(kD)return I0;kD=1,I0.differenceInISOWeekYears=s;var n=Wf(),e=h5(),t=g5(),r=Re();function s(a,o){let l=(0,r.toDate)(a);const c=(0,r.toDate)(o),d=(0,n.compareAsc)(l,c),h=Math.abs((0,e.differenceInCalendarISOWeekYears)(l,c));l=(0,t.subISOWeekYears)(l,d*h);const p=+((0,n.compareAsc)(l,c)===-d),x=d*(h-p);return x===0?0:x}return I0}var R0={},PD;function KC(){if(PD)return R0;PD=1,R0.differenceInMinutes=r;var n=sd(),e=Qt(),t=yy();function r(s,a,o){const l=(0,t.differenceInMilliseconds)(s,a)/e.millisecondsInMinute;return(0,n.getRoundingMethod)(o?.roundingMethod)(l)}return R0}var L0={},F0={},q0={},MD;function JC(){if(MD)return q0;MD=1,q0.endOfDay=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setHours(23,59,59,999),r}return q0}var z0={},ED;function QC(){if(ED)return z0;ED=1,z0.endOfMonth=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(23,59,59,999),r}return z0}var DD;function x5(){if(DD)return F0;DD=1,F0.isLastDayOfMonth=r;var n=JC(),e=QC(),t=Re();function r(s){const a=(0,t.toDate)(s);return+(0,n.endOfDay)(a)==+(0,e.endOfMonth)(a)}return F0}var OD;function vy(){if(OD)return L0;OD=1,L0.differenceInMonths=s;var n=Wf(),e=$C(),t=x5(),r=Re();function s(a,o){const l=(0,r.toDate)(a),c=(0,r.toDate)(o),d=(0,n.compareAsc)(l,c),h=Math.abs((0,e.differenceInCalendarMonths)(l,c));let p;if(h<1)p=0;else{l.getMonth()===1&&l.getDate()>27&&l.setDate(30),l.setMonth(l.getMonth()-d*h);let x=(0,n.compareAsc)(l,c)===-d;(0,t.isLastDayOfMonth)((0,r.toDate)(a))&&h===1&&(0,n.compareAsc)(a,c)===1&&(x=!1),p=d*(h-Number(x))}return p===0?0:p}return L0}var U0={},ID;function _ee(){if(ID)return U0;ID=1,U0.differenceInQuarters=t;var n=sd(),e=vy();function t(r,s,a){const o=(0,e.differenceInMonths)(r,s)/3;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return U0}var V0={},AD;function by(){if(AD)return V0;AD=1,V0.differenceInSeconds=t;var n=sd(),e=yy();function t(r,s,a){const o=(0,e.differenceInMilliseconds)(r,s)/1e3;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return V0}var B0={},RD;function jee(){if(RD)return B0;RD=1,B0.differenceInWeeks=t;var n=sd(),e=GC();function t(r,s,a){const o=(0,e.differenceInDays)(r,s)/7;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return B0}var W0={},LD;function y5(){if(LD)return W0;LD=1,W0.differenceInYears=r;var n=Wf(),e=YC(),t=Re();function r(s,a){const o=(0,t.toDate)(s),l=(0,t.toDate)(a),c=(0,n.compareAsc)(o,l),d=Math.abs((0,e.differenceInCalendarYears)(o,l));o.setFullYear(1584),l.setFullYear(1584);const h=(0,n.compareAsc)(o,l)===-c,p=c*(d-+h);return p===0?0:p}return W0}var $0={},FD;function v5(){if(FD)return $0;FD=1,$0.eachDayOfInterval=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setDate(c.getDate()+d),c.setHours(0,0,0,0);return o?h.reverse():h}return $0}var H0={},qD;function Nee(){if(qD)return H0;qD=1,H0.eachHourOfInterval=t;var n=VC(),e=Re();function t(r,s){const a=(0,e.toDate)(r.start),o=(0,e.toDate)(r.end);let l=+a>+o;const c=l?+a:+o;let d=l?o:a;d.setMinutes(0,0,0);let h=s?.step??1;if(!h)return[];h<0&&(h=-h,l=!l);const p=[];for(;+d<=c;)p.push((0,e.toDate)(d)),d=(0,n.addHours)(d,h);return l?p.reverse():p}return H0}var Y0={},G0={},zD;function XC(){if(zD)return G0;zD=1,G0.startOfMinute=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setSeconds(0,0),r}return G0}var UD;function See(){if(UD)return Y0;UD=1,Y0.eachMinuteOfInterval=r;var n=BC(),e=XC(),t=Re();function r(s,a){const o=(0,e.startOfMinute)((0,t.toDate)(s.start)),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?+o:+l;let h=c?l:o,p=a?.step??1;if(!p)return[];p<0&&(p=-p,c=!c);const x=[];for(;+h<=d;)x.push((0,t.toDate)(h)),h=(0,n.addMinutes)(h,p);return c?x.reverse():x}return Y0}var Z0={},VD;function Cee(){if(VD)return Z0;VD=1,Z0.eachMonthOfInterval=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0),c.setDate(1);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setMonth(c.getMonth()+d);return o?h.reverse():h}return Z0}var K0={},J0={},BD;function e1(){if(BD)return J0;BD=1,J0.startOfQuarter=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3;return r.setMonth(a,1),r.setHours(0,0,0,0),r}return J0}var WD;function Tee(){if(WD)return K0;WD=1,K0.eachQuarterOfInterval=r;var n=WC(),e=e1(),t=Re();function r(s,a){const o=(0,t.toDate)(s.start),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?+(0,e.startOfQuarter)(o):+(0,e.startOfQuarter)(l);let h=c?(0,e.startOfQuarter)(l):(0,e.startOfQuarter)(o),p=a?.step??1;if(!p)return[];p<0&&(p=-p,c=!c);const x=[];for(;+h<=d;)x.push((0,t.toDate)(h)),h=(0,n.addQuarters)(h,p);return c?x.reverse():x}return K0}var Q0={},$D;function kee(){if($D)return Q0;$D=1,Q0.eachWeekOfInterval=r;var n=xy(),e=ko(),t=Re();function r(s,a){const o=(0,t.toDate)(s.start),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?(0,e.startOfWeek)(l,a):(0,e.startOfWeek)(o,a),h=c?(0,e.startOfWeek)(o,a):(0,e.startOfWeek)(l,a);d.setHours(15),h.setHours(15);const p=+h.getTime();let x=d,v=a?.step??1;if(!v)return[];v<0&&(v=-v,c=!c);const w=[];for(;+x<=p;)x.setHours(0),w.push((0,t.toDate)(x)),x=(0,n.addWeeks)(x,v),x.setHours(15);return c?w.reverse():w}return Q0}var X0={},HD;function t1(){if(HD)return X0;HD=1,X0.eachWeekendOfInterval=t;var n=v5(),e=py();function t(r){const s=(0,n.eachDayOfInterval)(r),a=[];let o=0;for(;o<s.length;){const l=s[o++];(0,e.isWeekend)(l)&&a.push(l)}return a}return X0}var ew={},tw={},YD;function wy(){if(YD)return tw;YD=1,tw.startOfMonth=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setDate(1),r.setHours(0,0,0,0),r}return tw}var GD;function Pee(){if(GD)return ew;GD=1,ew.eachWeekendOfMonth=r;var n=t1(),e=QC(),t=wy();function r(s){const a=(0,t.startOfMonth)(s),o=(0,e.endOfMonth)(s);return(0,n.eachWeekendOfInterval)({start:a,end:o})}return ew}var nw={},rw={},ZD;function b5(){if(ZD)return rw;ZD=1,rw.endOfYear=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(23,59,59,999),r}return rw}var sw={},KD;function n1(){if(KD)return sw;KD=1,sw.startOfYear=t;var n=Re(),e=un();function t(r){const s=(0,n.toDate)(r),a=(0,e.constructFrom)(r,0);return a.setFullYear(s.getFullYear(),0,1),a.setHours(0,0,0,0),a}return sw}var JD;function Mee(){if(JD)return nw;JD=1,nw.eachWeekendOfYear=r;var n=t1(),e=b5(),t=n1();function r(s){const a=(0,t.startOfYear)(s),o=(0,e.endOfYear)(s);return(0,n.eachWeekendOfInterval)({start:a,end:o})}return nw}var iw={},QD;function Eee(){if(QD)return iw;QD=1,iw.eachYearOfInterval=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0),c.setMonth(0,1);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setFullYear(c.getFullYear()+d);return o?h.reverse():h}return iw}var aw={},XD;function Dee(){if(XD)return aw;XD=1,aw.endOfDecade=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=9+Math.floor(s/10)*10;return r.setFullYear(a,11,31),r.setHours(23,59,59,999),r}return aw}var ow={},e2;function Oee(){if(e2)return ow;e2=1,ow.endOfHour=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setMinutes(59,59,999),r}return ow}var lw={},cw={},t2;function w5(){if(t2)return cw;t2=1,cw.endOfWeek=t;var n=Re(),e=Cs();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?-7:0)+6-(c-o);return l.setDate(l.getDate()+d),l.setHours(23,59,59,999),l}return cw}var n2;function Iee(){if(n2)return lw;n2=1,lw.endOfISOWeek=e;var n=w5();function e(t){return(0,n.endOfWeek)(t,{weekStartsOn:1})}return lw}var dw={},r2;function Aee(){if(r2)return dw;r2=1,dw.endOfISOWeekYear=r;var n=wu(),e=Dl(),t=un();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const l=(0,e.startOfISOWeek)(o);return l.setMilliseconds(l.getMilliseconds()-1),l}return dw}var uw={},s2;function Ree(){if(s2)return uw;s2=1,uw.endOfMinute=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setSeconds(59,999),r}return uw}var fw={},i2;function Lee(){if(i2)return fw;i2=1,fw.endOfQuarter=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3+3;return r.setMonth(a,0),r.setHours(23,59,59,999),r}return fw}var hw={},a2;function Fee(){if(a2)return hw;a2=1,hw.endOfSecond=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setMilliseconds(999),r}return hw}var mw={},o2;function qee(){if(o2)return mw;o2=1,mw.endOfToday=e;var n=JC();function e(){return(0,n.endOfDay)(Date.now())}return mw}var pw={},l2;function zee(){if(l2)return pw;l2=1,pw.endOfTomorrow=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s+1),a.setHours(23,59,59,999),a}return pw}var gw={},c2;function Uee(){if(c2)return gw;c2=1,gw.endOfYesterday=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s-1),a.setHours(23,59,59,999),a}return gw}var xw={},yw={},Zp={},Kp={},d2;function Vee(){if(d2)return Kp;d2=1,Kp.formatDistance=void 0;const n={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},e=(t,r,s)=>{let a;const o=n[t];return typeof o=="string"?a=o:r===1?a=o.one:a=o.other.replace("{{count}}",r.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};return Kp.formatDistance=e,Kp}var Jp={},vw={},u2;function Bee(){if(u2)return vw;u2=1,vw.buildFormatLongFn=n;function n(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}return vw}var f2;function Wee(){if(f2)return Jp;f2=1,Jp.formatLong=void 0;var n=Bee();const e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},t={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},r={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"};return Jp.formatLong={date:(0,n.buildFormatLongFn)({formats:e,defaultWidth:"full"}),time:(0,n.buildFormatLongFn)({formats:t,defaultWidth:"full"}),dateTime:(0,n.buildFormatLongFn)({formats:r,defaultWidth:"full"})},Jp}var Qp={},h2;function $ee(){if(h2)return Qp;h2=1,Qp.formatRelative=void 0;const n={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},e=(t,r,s,a)=>n[t];return Qp.formatRelative=e,Qp}var Xp={},bw={},m2;function Hee(){if(m2)return bw;m2=1,bw.buildLocalizeFn=n;function n(e){return(t,r)=>{const s=r?.context?String(r.context):"standalone";let a;if(s==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=r?.width?String(r.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=r?.width?String(r.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(t):t;return a[o]}}return bw}var p2;function Yee(){if(p2)return Xp;p2=1,Xp.localize=void 0;var n=Hee();const e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},t={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},r={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},s={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},a={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},o={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},l=(c,d)=>{const h=Number(c),p=h%100;if(p>20||p<10)switch(p%10){case 1:return h+"st";case 2:return h+"nd";case 3:return h+"rd"}return h+"th"};return Xp.localize={ordinalNumber:l,era:(0,n.buildLocalizeFn)({values:e,defaultWidth:"wide"}),quarter:(0,n.buildLocalizeFn)({values:t,defaultWidth:"wide",argumentCallback:c=>c-1}),month:(0,n.buildLocalizeFn)({values:r,defaultWidth:"wide"}),day:(0,n.buildLocalizeFn)({values:s,defaultWidth:"wide"}),dayPeriod:(0,n.buildLocalizeFn)({values:a,defaultWidth:"wide",formattingValues:o,defaultFormattingWidth:"wide"})},Xp}var eg={},ww={},g2;function Gee(){if(g2)return ww;g2=1,ww.buildMatchFn=n;function n(r){return(s,a={})=>{const o=a.width,l=o&&r.matchPatterns[o]||r.matchPatterns[r.defaultMatchWidth],c=s.match(l);if(!c)return null;const d=c[0],h=o&&r.parsePatterns[o]||r.parsePatterns[r.defaultParseWidth],p=Array.isArray(h)?t(h,w=>w.test(d)):e(h,w=>w.test(d));let x;x=r.valueCallback?r.valueCallback(p):p,x=a.valueCallback?a.valueCallback(x):x;const v=s.slice(d.length);return{value:x,rest:v}}}function e(r,s){for(const a in r)if(Object.prototype.hasOwnProperty.call(r,a)&&s(r[a]))return a}function t(r,s){for(let a=0;a<r.length;a++)if(s(r[a]))return a}return ww}var _w={},x2;function Zee(){if(x2)return _w;x2=1,_w.buildMatchPatternFn=n;function n(e){return(t,r={})=>{const s=t.match(e.matchPattern);if(!s)return null;const a=s[0],o=t.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=r.valueCallback?r.valueCallback(l):l;const c=t.slice(a.length);return{value:l,rest:c}}}return _w}var y2;function Kee(){if(y2)return eg;y2=1,eg.match=void 0;var n=Gee(),e=Zee();const t=/^(\d+)(th|st|nd|rd)?/i,r=/\d+/i,s={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},a={any:[/^b/i,/^(a|c)/i]},o={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},l={any:[/1/i,/2/i,/3/i,/4/i]},c={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},d={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},h={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},p={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},x={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},v={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}};return eg.match={ordinalNumber:(0,e.buildMatchPatternFn)({matchPattern:t,parsePattern:r,valueCallback:w=>parseInt(w,10)}),era:(0,n.buildMatchFn)({matchPatterns:s,defaultMatchWidth:"wide",parsePatterns:a,defaultParseWidth:"any"}),quarter:(0,n.buildMatchFn)({matchPatterns:o,defaultMatchWidth:"wide",parsePatterns:l,defaultParseWidth:"any",valueCallback:w=>w+1}),month:(0,n.buildMatchFn)({matchPatterns:c,defaultMatchWidth:"wide",parsePatterns:d,defaultParseWidth:"any"}),day:(0,n.buildMatchFn)({matchPatterns:h,defaultMatchWidth:"wide",parsePatterns:p,defaultParseWidth:"any"}),dayPeriod:(0,n.buildMatchFn)({matchPatterns:x,defaultMatchWidth:"any",parsePatterns:v,defaultParseWidth:"any"})},eg}var v2;function _5(){if(v2)return Zp;v2=1,Zp.enUS=void 0;var n=Vee(),e=Wee(),t=$ee(),r=Yee(),s=Kee();return Zp.enUS={code:"en-US",formatDistance:n.formatDistance,formatLong:e.formatLong,formatRelative:t.formatRelative,localize:r.localize,match:s.match,options:{weekStartsOn:0,firstWeekContainsDate:1}},Zp}var b2;function $f(){return b2||(b2=1,(function(n){Object.defineProperty(n,"defaultLocale",{enumerable:!0,get:function(){return e.enUS}});var e=_5()})(yw)),yw}var tg={},jw={},w2;function j5(){if(w2)return jw;w2=1,jw.getDayOfYear=r;var n=nd(),e=n1(),t=Re();function r(s){const a=(0,t.toDate)(s);return(0,n.differenceInCalendarDays)(a,(0,e.startOfYear)(a))+1}return jw}var Nw={},_2;function r1(){if(_2)return Nw;_2=1,Nw.getISOWeek=s;var n=Qt(),e=Dl(),t=Rm(),r=Re();function s(a){const o=(0,r.toDate)(a),l=+(0,e.startOfISOWeek)(o)-+(0,t.startOfISOWeekYear)(o);return Math.round(l/n.millisecondsInWeek)+1}return Nw}var Sw={},Cw={},Tw={},j2;function _y(){if(j2)return Tw;j2=1,Tw.getWeekYear=s;var n=un(),e=ko(),t=Re(),r=Cs();function s(a,o){const l=(0,t.toDate)(a),c=l.getFullYear(),d=(0,r.getDefaultOptions)(),h=o?.firstWeekContainsDate??o?.locale?.options?.firstWeekContainsDate??d.firstWeekContainsDate??d.locale?.options?.firstWeekContainsDate??1,p=(0,n.constructFrom)(a,0);p.setFullYear(c+1,0,h),p.setHours(0,0,0,0);const x=(0,e.startOfWeek)(p,o),v=(0,n.constructFrom)(a,0);v.setFullYear(c,0,h),v.setHours(0,0,0,0);const w=(0,e.startOfWeek)(v,o);return l.getTime()>=x.getTime()?c+1:l.getTime()>=w.getTime()?c:c-1}return Tw}var N2;function s1(){if(N2)return Cw;N2=1,Cw.startOfWeekYear=s;var n=un(),e=_y(),t=ko(),r=Cs();function s(a,o){const l=(0,r.getDefaultOptions)(),c=o?.firstWeekContainsDate??o?.locale?.options?.firstWeekContainsDate??l.firstWeekContainsDate??l.locale?.options?.firstWeekContainsDate??1,d=(0,e.getWeekYear)(a,o),h=(0,n.constructFrom)(a,0);return h.setFullYear(d,0,c),h.setHours(0,0,0,0),(0,t.startOfWeek)(h,o)}return Cw}var S2;function i1(){if(S2)return Sw;S2=1,Sw.getWeek=s;var n=Qt(),e=ko(),t=s1(),r=Re();function s(a,o){const l=(0,r.toDate)(a),c=+(0,e.startOfWeek)(l,o)-+(0,t.startOfWeekYear)(l,o);return Math.round(c/n.millisecondsInWeek)+1}return Sw}var kw={},C2;function Hf(){if(C2)return kw;C2=1,kw.addLeadingZeros=n;function n(e,t){const r=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return r+s}return kw}var ng={},T2;function N5(){if(T2)return ng;T2=1,ng.lightFormatters=void 0;var n=Hf();return ng.lightFormatters={y(e,t){const r=e.getFullYear(),s=r>0?r:1-r;return(0,n.addLeadingZeros)(t==="yy"?s%100:s,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):(0,n.addLeadingZeros)(r+1,2)},d(e,t){return(0,n.addLeadingZeros)(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return(0,n.addLeadingZeros)(e.getHours()%12||12,t.length)},H(e,t){return(0,n.addLeadingZeros)(e.getHours(),t.length)},m(e,t){return(0,n.addLeadingZeros)(e.getMinutes(),t.length)},s(e,t){return(0,n.addLeadingZeros)(e.getSeconds(),t.length)},S(e,t){const r=t.length,s=e.getMilliseconds(),a=Math.trunc(s*Math.pow(10,r-3));return(0,n.addLeadingZeros)(a,t.length)}},ng}var k2;function Jee(){if(k2)return tg;k2=1,tg.formatters=void 0;var n=j5(),e=r1(),t=wu(),r=i1(),s=_y(),a=Hf(),o=N5();const l={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"};tg.formatters={G:function(p,x,v){const w=p.getFullYear()>0?1:0;switch(x){case"G":case"GG":case"GGG":return v.era(w,{width:"abbreviated"});case"GGGGG":return v.era(w,{width:"narrow"});case"GGGG":default:return v.era(w,{width:"wide"})}},y:function(p,x,v){if(x==="yo"){const w=p.getFullYear(),_=w>0?w:1-w;return v.ordinalNumber(_,{unit:"year"})}return o.lightFormatters.y(p,x)},Y:function(p,x,v,w){const _=(0,s.getWeekYear)(p,w),j=_>0?_:1-_;if(x==="YY"){const T=j%100;return(0,a.addLeadingZeros)(T,2)}return x==="Yo"?v.ordinalNumber(j,{unit:"year"}):(0,a.addLeadingZeros)(j,x.length)},R:function(p,x){const v=(0,t.getISOWeekYear)(p);return(0,a.addLeadingZeros)(v,x.length)},u:function(p,x){const v=p.getFullYear();return(0,a.addLeadingZeros)(v,x.length)},Q:function(p,x,v){const w=Math.ceil((p.getMonth()+1)/3);switch(x){case"Q":return String(w);case"QQ":return(0,a.addLeadingZeros)(w,2);case"Qo":return v.ordinalNumber(w,{unit:"quarter"});case"QQQ":return v.quarter(w,{width:"abbreviated",context:"formatting"});case"QQQQQ":return v.quarter(w,{width:"narrow",context:"formatting"});case"QQQQ":default:return v.quarter(w,{width:"wide",context:"formatting"})}},q:function(p,x,v){const w=Math.ceil((p.getMonth()+1)/3);switch(x){case"q":return String(w);case"qq":return(0,a.addLeadingZeros)(w,2);case"qo":return v.ordinalNumber(w,{unit:"quarter"});case"qqq":return v.quarter(w,{width:"abbreviated",context:"standalone"});case"qqqqq":return v.quarter(w,{width:"narrow",context:"standalone"});case"qqqq":default:return v.quarter(w,{width:"wide",context:"standalone"})}},M:function(p,x,v){const w=p.getMonth();switch(x){case"M":case"MM":return o.lightFormatters.M(p,x);case"Mo":return v.ordinalNumber(w+1,{unit:"month"});case"MMM":return v.month(w,{width:"abbreviated",context:"formatting"});case"MMMMM":return v.month(w,{width:"narrow",context:"formatting"});case"MMMM":default:return v.month(w,{width:"wide",context:"formatting"})}},L:function(p,x,v){const w=p.getMonth();switch(x){case"L":return String(w+1);case"LL":return(0,a.addLeadingZeros)(w+1,2);case"Lo":return v.ordinalNumber(w+1,{unit:"month"});case"LLL":return v.month(w,{width:"abbreviated",context:"standalone"});case"LLLLL":return v.month(w,{width:"narrow",context:"standalone"});case"LLLL":default:return v.month(w,{width:"wide",context:"standalone"})}},w:function(p,x,v,w){const _=(0,r.getWeek)(p,w);return x==="wo"?v.ordinalNumber(_,{unit:"week"}):(0,a.addLeadingZeros)(_,x.length)},I:function(p,x,v){const w=(0,e.getISOWeek)(p);return x==="Io"?v.ordinalNumber(w,{unit:"week"}):(0,a.addLeadingZeros)(w,x.length)},d:function(p,x,v){return x==="do"?v.ordinalNumber(p.getDate(),{unit:"date"}):o.lightFormatters.d(p,x)},D:function(p,x,v){const w=(0,n.getDayOfYear)(p);return x==="Do"?v.ordinalNumber(w,{unit:"dayOfYear"}):(0,a.addLeadingZeros)(w,x.length)},E:function(p,x,v){const w=p.getDay();switch(x){case"E":case"EE":case"EEE":return v.day(w,{width:"abbreviated",context:"formatting"});case"EEEEE":return v.day(w,{width:"narrow",context:"formatting"});case"EEEEEE":return v.day(w,{width:"short",context:"formatting"});case"EEEE":default:return v.day(w,{width:"wide",context:"formatting"})}},e:function(p,x,v,w){const _=p.getDay(),j=(_-w.weekStartsOn+8)%7||7;switch(x){case"e":return String(j);case"ee":return(0,a.addLeadingZeros)(j,2);case"eo":return v.ordinalNumber(j,{unit:"day"});case"eee":return v.day(_,{width:"abbreviated",context:"formatting"});case"eeeee":return v.day(_,{width:"narrow",context:"formatting"});case"eeeeee":return v.day(_,{width:"short",context:"formatting"});case"eeee":default:return v.day(_,{width:"wide",context:"formatting"})}},c:function(p,x,v,w){const _=p.getDay(),j=(_-w.weekStartsOn+8)%7||7;switch(x){case"c":return String(j);case"cc":return(0,a.addLeadingZeros)(j,x.length);case"co":return v.ordinalNumber(j,{unit:"day"});case"ccc":return v.day(_,{width:"abbreviated",context:"standalone"});case"ccccc":return v.day(_,{width:"narrow",context:"standalone"});case"cccccc":return v.day(_,{width:"short",context:"standalone"});case"cccc":default:return v.day(_,{width:"wide",context:"standalone"})}},i:function(p,x,v){const w=p.getDay(),_=w===0?7:w;switch(x){case"i":return String(_);case"ii":return(0,a.addLeadingZeros)(_,x.length);case"io":return v.ordinalNumber(_,{unit:"day"});case"iii":return v.day(w,{width:"abbreviated",context:"formatting"});case"iiiii":return v.day(w,{width:"narrow",context:"formatting"});case"iiiiii":return v.day(w,{width:"short",context:"formatting"});case"iiii":default:return v.day(w,{width:"wide",context:"formatting"})}},a:function(p,x,v){const _=p.getHours()/12>=1?"pm":"am";switch(x){case"a":case"aa":return v.dayPeriod(_,{width:"abbreviated",context:"formatting"});case"aaa":return v.dayPeriod(_,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return v.dayPeriod(_,{width:"narrow",context:"formatting"});case"aaaa":default:return v.dayPeriod(_,{width:"wide",context:"formatting"})}},b:function(p,x,v){const w=p.getHours();let _;switch(w===12?_=l.noon:w===0?_=l.midnight:_=w/12>=1?"pm":"am",x){case"b":case"bb":return v.dayPeriod(_,{width:"abbreviated",context:"formatting"});case"bbb":return v.dayPeriod(_,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return v.dayPeriod(_,{width:"narrow",context:"formatting"});case"bbbb":default:return v.dayPeriod(_,{width:"wide",context:"formatting"})}},B:function(p,x,v){const w=p.getHours();let _;switch(w>=17?_=l.evening:w>=12?_=l.afternoon:w>=4?_=l.morning:_=l.night,x){case"B":case"BB":case"BBB":return v.dayPeriod(_,{width:"abbreviated",context:"formatting"});case"BBBBB":return v.dayPeriod(_,{width:"narrow",context:"formatting"});case"BBBB":default:return v.dayPeriod(_,{width:"wide",context:"formatting"})}},h:function(p,x,v){if(x==="ho"){let w=p.getHours()%12;return w===0&&(w=12),v.ordinalNumber(w,{unit:"hour"})}return o.lightFormatters.h(p,x)},H:function(p,x,v){return x==="Ho"?v.ordinalNumber(p.getHours(),{unit:"hour"}):o.lightFormatters.H(p,x)},K:function(p,x,v){const w=p.getHours()%12;return x==="Ko"?v.ordinalNumber(w,{unit:"hour"}):(0,a.addLeadingZeros)(w,x.length)},k:function(p,x,v){let w=p.getHours();return w===0&&(w=24),x==="ko"?v.ordinalNumber(w,{unit:"hour"}):(0,a.addLeadingZeros)(w,x.length)},m:function(p,x,v){return x==="mo"?v.ordinalNumber(p.getMinutes(),{unit:"minute"}):o.lightFormatters.m(p,x)},s:function(p,x,v){return x==="so"?v.ordinalNumber(p.getSeconds(),{unit:"second"}):o.lightFormatters.s(p,x)},S:function(p,x){return o.lightFormatters.S(p,x)},X:function(p,x,v){const w=p.getTimezoneOffset();if(w===0)return"Z";switch(x){case"X":return d(w);case"XXXX":case"XX":return h(w);case"XXXXX":case"XXX":default:return h(w,":")}},x:function(p,x,v){const w=p.getTimezoneOffset();switch(x){case"x":return d(w);case"xxxx":case"xx":return h(w);case"xxxxx":case"xxx":default:return h(w,":")}},O:function(p,x,v){const w=p.getTimezoneOffset();switch(x){case"O":case"OO":case"OOO":return"GMT"+c(w,":");case"OOOO":default:return"GMT"+h(w,":")}},z:function(p,x,v){const w=p.getTimezoneOffset();switch(x){case"z":case"zz":case"zzz":return"GMT"+c(w,":");case"zzzz":default:return"GMT"+h(w,":")}},t:function(p,x,v){const w=Math.trunc(p.getTime()/1e3);return(0,a.addLeadingZeros)(w,x.length)},T:function(p,x,v){const w=p.getTime();return(0,a.addLeadingZeros)(w,x.length)}};function c(p,x=""){const v=p>0?"-":"+",w=Math.abs(p),_=Math.trunc(w/60),j=w%60;return j===0?v+String(_):v+String(_)+x+(0,a.addLeadingZeros)(j,2)}function d(p,x){return p%60===0?(p>0?"-":"+")+(0,a.addLeadingZeros)(Math.abs(p)/60,2):h(p,x)}function h(p,x=""){const v=p>0?"-":"+",w=Math.abs(p),_=(0,a.addLeadingZeros)(Math.trunc(w/60),2),j=(0,a.addLeadingZeros)(w%60,2);return v+_+x+j}return tg}var rg={},P2;function S5(){if(P2)return rg;P2=1,rg.longFormatters=void 0;const n=(r,s)=>{switch(r){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},e=(r,s)=>{switch(r){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},t=(r,s)=>{const a=r.match(/(P+)(p+)?/)||[],o=a[1],l=a[2];if(!l)return n(r,s);let c;switch(o){case"P":c=s.dateTime({width:"short"});break;case"PP":c=s.dateTime({width:"medium"});break;case"PPP":c=s.dateTime({width:"long"});break;case"PPPP":default:c=s.dateTime({width:"full"});break}return c.replace("{{date}}",n(o,s)).replace("{{time}}",e(l,s))};return rg.longFormatters={p:e,P:t},rg}var Ch={},M2;function C5(){if(M2)return Ch;M2=1,Ch.isProtectedDayOfYearToken=r,Ch.isProtectedWeekYearToken=s,Ch.warnOrThrowProtectedError=a;const n=/^D+$/,e=/^Y+$/,t=["D","DD","YY","YYYY"];function r(l){return n.test(l)}function s(l){return e.test(l)}function a(l,c,d){const h=o(l,c,d);if(console.warn(h),t.includes(l))throw new RangeError(h)}function o(l,c,d){const h=l[0]==="Y"?"years":"days of the month";return`Use \`${l.toLowerCase()}\` instead of \`${l}\` (in \`${c}\`) for formatting ${h} to the input \`${d}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}return Ch}var E2;function T5(){return E2||(E2=1,(function(n){n.format=n.formatDate=v,Object.defineProperty(n,"formatters",{enumerable:!0,get:function(){return r.formatters}}),Object.defineProperty(n,"longFormatters",{enumerable:!0,get:function(){return s.longFormatters}});var e=$f(),t=Cs(),r=Jee(),s=S5(),a=C5(),o=rd(),l=Re();const c=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,d=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,h=/^'([^]*?)'?$/,p=/''/g,x=/[a-zA-Z]/;function v(_,j,T){const P=(0,t.getDefaultOptions)(),D=T?.locale??P.locale??e.defaultLocale,M=T?.firstWeekContainsDate??T?.locale?.options?.firstWeekContainsDate??P.firstWeekContainsDate??P.locale?.options?.firstWeekContainsDate??1,O=T?.weekStartsOn??T?.locale?.options?.weekStartsOn??P.weekStartsOn??P.locale?.options?.weekStartsOn??0,I=(0,l.toDate)(_);if(!(0,o.isValid)(I))throw new RangeError("Invalid time value");let q=j.match(d).map(V=>{const U=V[0];if(U==="p"||U==="P"){const W=s.longFormatters[U];return W(V,D.formatLong)}return V}).join("").match(c).map(V=>{if(V==="''")return{isToken:!1,value:"'"};const U=V[0];if(U==="'")return{isToken:!1,value:w(V)};if(r.formatters[U])return{isToken:!0,value:V};if(U.match(x))throw new RangeError("Format string contains an unescaped latin alphabet character `"+U+"`");return{isToken:!1,value:V}});D.localize.preprocessor&&(q=D.localize.preprocessor(I,q));const F={firstWeekContainsDate:M,weekStartsOn:O,locale:D};return q.map(V=>{if(!V.isToken)return V.value;const U=V.value;(!T?.useAdditionalWeekYearTokens&&(0,a.isProtectedWeekYearToken)(U)||!T?.useAdditionalDayOfYearTokens&&(0,a.isProtectedDayOfYearToken)(U))&&(0,a.warnOrThrowProtectedError)(U,j,String(_));const W=r.formatters[U[0]];return W(I,U,D.localize,F)}).join("")}function w(_){const j=_.match(h);return j?j[1].replace(p,"'"):_}})(xw)),xw}var Pw={},D2;function k5(){if(D2)return Pw;D2=1,Pw.formatDistance=c;var n=Wf(),e=Qt(),t=vy(),r=by(),s=Re(),a=$f(),o=Cs(),l=td();function c(d,h,p){const x=(0,o.getDefaultOptions)(),v=p?.locale??x.locale??a.defaultLocale,w=2520,_=(0,n.compareAsc)(d,h);if(isNaN(_))throw new RangeError("Invalid time value");const j=Object.assign({},p,{addSuffix:p?.addSuffix,comparison:_});let T,P;_>0?(T=(0,s.toDate)(h),P=(0,s.toDate)(d)):(T=(0,s.toDate)(d),P=(0,s.toDate)(h));const D=(0,r.differenceInSeconds)(P,T),M=((0,l.getTimezoneOffsetInMilliseconds)(P)-(0,l.getTimezoneOffsetInMilliseconds)(T))/1e3,O=Math.round((D-M)/60);let I;if(O<2)return p?.includeSeconds?D<5?v.formatDistance("lessThanXSeconds",5,j):D<10?v.formatDistance("lessThanXSeconds",10,j):D<20?v.formatDistance("lessThanXSeconds",20,j):D<40?v.formatDistance("halfAMinute",0,j):D<60?v.formatDistance("lessThanXMinutes",1,j):v.formatDistance("xMinutes",1,j):O===0?v.formatDistance("lessThanXMinutes",1,j):v.formatDistance("xMinutes",O,j);if(O<45)return v.formatDistance("xMinutes",O,j);if(O<90)return v.formatDistance("aboutXHours",1,j);if(O<e.minutesInDay){const q=Math.round(O/60);return v.formatDistance("aboutXHours",q,j)}else{if(O<w)return v.formatDistance("xDays",1,j);if(O<e.minutesInMonth){const q=Math.round(O/e.minutesInDay);return v.formatDistance("xDays",q,j)}else if(O<e.minutesInMonth*2)return I=Math.round(O/e.minutesInMonth),v.formatDistance("aboutXMonths",I,j)}if(I=(0,t.differenceInMonths)(P,T),I<12){const q=Math.round(O/e.minutesInMonth);return v.formatDistance("xMonths",q,j)}else{const q=I%12,F=Math.trunc(I/12);return q<3?v.formatDistance("aboutXYears",F,j):q<9?v.formatDistance("overXYears",F,j):v.formatDistance("almostXYears",F+1,j)}}return Pw}var Mw={},O2;function P5(){if(O2)return Mw;O2=1,Mw.formatDistanceStrict=l;var n=$f(),e=Cs(),t=sd(),r=td(),s=Wf(),a=Qt(),o=Re();function l(c,d,h){const p=(0,e.getDefaultOptions)(),x=h?.locale??p.locale??n.defaultLocale,v=(0,s.compareAsc)(c,d);if(isNaN(v))throw new RangeError("Invalid time value");const w=Object.assign({},h,{addSuffix:h?.addSuffix,comparison:v});let _,j;v>0?(_=(0,o.toDate)(d),j=(0,o.toDate)(c)):(_=(0,o.toDate)(c),j=(0,o.toDate)(d));const T=(0,t.getRoundingMethod)(h?.roundingMethod??"round"),P=j.getTime()-_.getTime(),D=P/a.millisecondsInMinute,M=(0,r.getTimezoneOffsetInMilliseconds)(j)-(0,r.getTimezoneOffsetInMilliseconds)(_),O=(P-M)/a.millisecondsInMinute,I=h?.unit;let q;if(I?q=I:D<1?q="second":D<60?q="minute":D<a.minutesInDay?q="hour":O<a.minutesInMonth?q="day":O<a.minutesInYear?q="month":q="year",q==="second"){const F=T(P/1e3);return x.formatDistance("xSeconds",F,w)}else if(q==="minute"){const F=T(D);return x.formatDistance("xMinutes",F,w)}else if(q==="hour"){const F=T(D/60);return x.formatDistance("xHours",F,w)}else if(q==="day"){const F=T(O/a.minutesInDay);return x.formatDistance("xDays",F,w)}else if(q==="month"){const F=T(O/a.minutesInMonth);return F===12&&I!=="month"?x.formatDistance("xYears",1,w):x.formatDistance("xMonths",F,w)}else{const F=T(O/a.minutesInYear);return x.formatDistance("xYears",F,w)}}return Mw}var Ew={},I2;function Qee(){if(I2)return Ew;I2=1,Ew.formatDistanceToNow=t;var n=Zs(),e=k5();function t(r,s){return(0,e.formatDistance)(r,(0,n.constructNow)(r),s)}return Ew}var Dw={},A2;function Xee(){if(A2)return Dw;A2=1,Dw.formatDistanceToNowStrict=t;var n=P5(),e=Zs();function t(r,s){return(0,n.formatDistanceStrict)(r,(0,e.constructNow)(r),s)}return Dw}var Ow={},R2;function ete(){if(R2)return Ow;R2=1,Ow.formatDuration=r;var n=$f(),e=Cs();const t=["years","months","weeks","days","hours","minutes","seconds"];function r(s,a){const o=(0,e.getDefaultOptions)(),l=a?.locale??o.locale??n.defaultLocale,c=a?.format??t,d=a?.zero??!1,h=a?.delimiter??" ";return l.formatDistance?c.reduce((x,v)=>{const w=`x${v.replace(/(^.)/,j=>j.toUpperCase())}`,_=s[v];return _!==void 0&&(d||s[v])?x.concat(l.formatDistance(w,_)):x},[]).join(h):""}return Ow}var Iw={},L2;function tte(){if(L2)return Iw;L2=1,Iw.formatISO=t;var n=Re(),e=Hf();function t(r,s){const a=(0,n.toDate)(r);if(isNaN(a.getTime()))throw new RangeError("Invalid time value");const o=s?.format??"extended",l=s?.representation??"complete";let c="",d="";const h=o==="extended"?"-":"",p=o==="extended"?":":"";if(l!=="time"){const x=(0,e.addLeadingZeros)(a.getDate(),2),v=(0,e.addLeadingZeros)(a.getMonth()+1,2);c=`${(0,e.addLeadingZeros)(a.getFullYear(),4)}${h}${v}${h}${x}`}if(l!=="date"){const x=a.getTimezoneOffset();if(x!==0){const P=Math.abs(x),D=(0,e.addLeadingZeros)(Math.trunc(P/60),2),M=(0,e.addLeadingZeros)(P%60,2);d=`${x<0?"+":"-"}${D}:${M}`}else d="Z";const v=(0,e.addLeadingZeros)(a.getHours(),2),w=(0,e.addLeadingZeros)(a.getMinutes(),2),_=(0,e.addLeadingZeros)(a.getSeconds(),2),j=c===""?"":"T",T=[v,w,_].join(p);c=`${c}${j}${T}${d}`}return c}return Iw}var Aw={},F2;function nte(){if(F2)return Aw;F2=1,Aw.formatISO9075=r;var n=rd(),e=Re(),t=Hf();function r(s,a){const o=(0,e.toDate)(s);if(!(0,n.isValid)(o))throw new RangeError("Invalid time value");const l=a?.format??"extended",c=a?.representation??"complete";let d="";const h=l==="extended"?"-":"",p=l==="extended"?":":"";if(c!=="time"){const x=(0,t.addLeadingZeros)(o.getDate(),2),v=(0,t.addLeadingZeros)(o.getMonth()+1,2);d=`${(0,t.addLeadingZeros)(o.getFullYear(),4)}${h}${v}${h}${x}`}if(c!=="date"){const x=(0,t.addLeadingZeros)(o.getHours(),2),v=(0,t.addLeadingZeros)(o.getMinutes(),2),w=(0,t.addLeadingZeros)(o.getSeconds(),2);d=`${d}${d===""?"":" "}${x}${p}${v}${p}${w}`}return d}return Aw}var Rw={},q2;function rte(){if(q2)return Rw;q2=1,Rw.formatISODuration=n;function n(e){const{years:t=0,months:r=0,days:s=0,hours:a=0,minutes:o=0,seconds:l=0}=e;return`P${t}Y${r}M${s}DT${a}H${o}M${l}S`}return Rw}var Lw={},z2;function ste(){if(z2)return Lw;z2=1,Lw.formatRFC3339=r;var n=rd(),e=Re(),t=Hf();function r(s,a){const o=(0,e.toDate)(s);if(!(0,n.isValid)(o))throw new RangeError("Invalid time value");const l=a?.fractionDigits??0,c=(0,t.addLeadingZeros)(o.getDate(),2),d=(0,t.addLeadingZeros)(o.getMonth()+1,2),h=o.getFullYear(),p=(0,t.addLeadingZeros)(o.getHours(),2),x=(0,t.addLeadingZeros)(o.getMinutes(),2),v=(0,t.addLeadingZeros)(o.getSeconds(),2);let w="";if(l>0){const T=o.getMilliseconds(),P=Math.trunc(T*Math.pow(10,l-3));w="."+(0,t.addLeadingZeros)(P,l)}let _="";const j=o.getTimezoneOffset();if(j!==0){const T=Math.abs(j),P=(0,t.addLeadingZeros)(Math.trunc(T/60),2),D=(0,t.addLeadingZeros)(T%60,2);_=`${j<0?"+":"-"}${P}:${D}`}else _="Z";return`${h}-${d}-${c}T${p}:${x}:${v}${w}${_}`}return Lw}var Fw={},U2;function ite(){if(U2)return Fw;U2=1,Fw.formatRFC7231=a;var n=rd(),e=Re(),t=Hf();const r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function a(o){const l=(0,e.toDate)(o);if(!(0,n.isValid)(l))throw new RangeError("Invalid time value");const c=r[l.getUTCDay()],d=(0,t.addLeadingZeros)(l.getUTCDate(),2),h=s[l.getUTCMonth()],p=l.getUTCFullYear(),x=(0,t.addLeadingZeros)(l.getUTCHours(),2),v=(0,t.addLeadingZeros)(l.getUTCMinutes(),2),w=(0,t.addLeadingZeros)(l.getUTCSeconds(),2);return`${c}, ${d} ${h} ${p} ${x}:${v}:${w} GMT`}return Fw}var qw={},V2;function ate(){if(V2)return qw;V2=1,qw.formatRelative=a;var n=nd(),e=T5(),t=Re(),r=$f(),s=Cs();function a(o,l,c){const d=(0,t.toDate)(o),h=(0,t.toDate)(l),p=(0,s.getDefaultOptions)(),x=c?.locale??p.locale??r.defaultLocale,v=c?.weekStartsOn??c?.locale?.options?.weekStartsOn??p.weekStartsOn??p.locale?.options?.weekStartsOn??0,w=(0,n.differenceInCalendarDays)(d,h);if(isNaN(w))throw new RangeError("Invalid time value");let _;w<-6?_="other":w<-1?_="lastWeek":w<0?_="yesterday":w<1?_="today":w<2?_="tomorrow":w<7?_="nextWeek":_="other";const j=x.formatRelative(_,d,h,{locale:x,weekStartsOn:v});return(0,e.format)(d,j,{locale:x,weekStartsOn:v})}return qw}var zw={},B2;function ote(){if(B2)return zw;B2=1,zw.fromUnixTime=e;var n=Re();function e(t){return(0,n.toDate)(t*1e3)}return zw}var Uw={},W2;function M5(){if(W2)return Uw;W2=1,Uw.getDate=e;var n=Re();function e(t){return(0,n.toDate)(t).getDate()}return Uw}var Vw={},$2;function jy(){if($2)return Vw;$2=1,Vw.getDay=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()}return Vw}var Bw={},H2;function E5(){if(H2)return Bw;H2=1,Bw.getDaysInMonth=t;var n=Re(),e=un();function t(r){const s=(0,n.toDate)(r),a=s.getFullYear(),o=s.getMonth(),l=(0,e.constructFrom)(r,0);return l.setFullYear(a,o+1,0),l.setHours(0,0,0,0),l.getDate()}return Bw}var Ww={},$w={},Y2;function D5(){if(Y2)return $w;Y2=1,$w.isLeapYear=e;var n=Re();function e(t){const s=(0,n.toDate)(t).getFullYear();return s%400===0||s%4===0&&s%100!==0}return $w}var G2;function lte(){if(G2)return Ww;G2=1,Ww.getDaysInYear=t;var n=D5(),e=Re();function t(r){const s=(0,e.toDate)(r);return String(new Date(s))==="Invalid Date"?NaN:(0,n.isLeapYear)(s)?366:365}return Ww}var Hw={},Z2;function cte(){if(Z2)return Hw;Z2=1,Hw.getDecade=e;var n=Re();function e(t){const s=(0,n.toDate)(t).getFullYear();return Math.floor(s/10)*10}return Hw}var Yw={},K2;function O5(){if(K2)return Yw;K2=1,Yw.getDefaultOptions=e;var n=Cs();function e(){return Object.assign({},(0,n.getDefaultOptions)())}return Yw}var Gw={},J2;function dte(){if(J2)return Gw;J2=1,Gw.getHours=e;var n=Re();function e(t){return(0,n.toDate)(t).getHours()}return Gw}var Zw={},Q2;function I5(){if(Q2)return Zw;Q2=1,Zw.getISODay=e;var n=Re();function e(t){let s=(0,n.toDate)(t).getDay();return s===0&&(s=7),s}return Zw}var Kw={},X2;function ute(){if(X2)return Kw;X2=1,Kw.getISOWeeksInYear=r;var n=xy(),e=Qt(),t=Rm();function r(s){const a=(0,t.startOfISOWeekYear)(s),l=+(0,t.startOfISOWeekYear)((0,n.addWeeks)(a,60))-+a;return Math.round(l/e.millisecondsInWeek)}return Kw}var Jw={},eO;function fte(){if(eO)return Jw;eO=1,Jw.getMilliseconds=e;var n=Re();function e(t){return(0,n.toDate)(t).getMilliseconds()}return Jw}var Qw={},tO;function hte(){if(tO)return Qw;tO=1,Qw.getMinutes=e;var n=Re();function e(t){return(0,n.toDate)(t).getMinutes()}return Qw}var Xw={},nO;function mte(){if(nO)return Xw;nO=1,Xw.getMonth=e;var n=Re();function e(t){return(0,n.toDate)(t).getMonth()}return Xw}var e_={},rO;function pte(){if(rO)return e_;rO=1,e_.getOverlappingDaysInIntervals=r;var n=td(),e=Qt(),t=Re();function r(s,a){const[o,l]=[+(0,t.toDate)(s.start),+(0,t.toDate)(s.end)].sort((_,j)=>_-j),[c,d]=[+(0,t.toDate)(a.start),+(0,t.toDate)(a.end)].sort((_,j)=>_-j);if(!(o<d&&c<l))return 0;const p=c<o?o:c,x=p-(0,n.getTimezoneOffsetInMilliseconds)(p),v=d>l?l:d,w=v-(0,n.getTimezoneOffsetInMilliseconds)(v);return Math.ceil((w-x)/e.millisecondsInDay)}return e_}var t_={},sO;function gte(){if(sO)return t_;sO=1,t_.getSeconds=e;var n=Re();function e(t){return(0,n.toDate)(t).getSeconds()}return t_}var n_={},iO;function xte(){if(iO)return n_;iO=1,n_.getTime=e;var n=Re();function e(t){return(0,n.toDate)(t).getTime()}return n_}var r_={},aO;function yte(){if(aO)return r_;aO=1,r_.getUnixTime=e;var n=Re();function e(t){return Math.trunc(+(0,n.toDate)(t)/1e3)}return r_}var s_={},oO;function vte(){if(oO)return s_;oO=1,s_.getWeekOfMonth=s;var n=M5(),e=jy(),t=wy(),r=Cs();function s(a,o){const l=(0,r.getDefaultOptions)(),c=o?.weekStartsOn??o?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,d=(0,n.getDate)(a);if(isNaN(d))return NaN;const h=(0,e.getDay)((0,t.startOfMonth)(a));let p=c-h;p<=0&&(p+=7);const x=d-p;return Math.ceil(x/7)+1}return s_}var i_={},a_={},lO;function A5(){if(lO)return a_;lO=1,a_.lastDayOfMonth=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(0,0,0,0),r}return a_}var cO;function bte(){if(cO)return i_;cO=1,i_.getWeeksInMonth=r;var n=HC(),e=A5(),t=wy();function r(s,a){return(0,n.differenceInCalendarWeeks)((0,e.lastDayOfMonth)(s),(0,t.startOfMonth)(s),a)+1}return i_}var o_={},dO;function wte(){if(dO)return o_;dO=1,o_.getYear=e;var n=Re();function e(t){return(0,n.toDate)(t).getFullYear()}return o_}var l_={},uO;function _te(){if(uO)return l_;uO=1,l_.hoursToMilliseconds=e;var n=Qt();function e(t){return Math.trunc(t*n.millisecondsInHour)}return l_}var c_={},fO;function jte(){if(fO)return c_;fO=1,c_.hoursToMinutes=e;var n=Qt();function e(t){return Math.trunc(t*n.minutesInHour)}return c_}var d_={},hO;function Nte(){if(hO)return d_;hO=1,d_.hoursToSeconds=e;var n=Qt();function e(t){return Math.trunc(t*n.secondsInHour)}return d_}var u_={},mO;function Ste(){if(mO)return u_;mO=1,u_.interval=e;var n=Re();function e(t,r,s){const a=(0,n.toDate)(t);if(isNaN(+a))throw new TypeError("Start date is invalid");const o=(0,n.toDate)(r);if(isNaN(+o))throw new TypeError("End date is invalid");if(s?.assertPositive&&+a>+o)throw new TypeError("End date must be after start date");return{start:a,end:o}}return u_}var f_={},pO;function Cte(){if(pO)return f_;pO=1,f_.intervalToDuration=c;var n=n5(),e=GC(),t=ZC(),r=KC(),s=vy(),a=by(),o=y5(),l=Re();function c(d){const h=(0,l.toDate)(d.start),p=(0,l.toDate)(d.end),x={},v=(0,o.differenceInYears)(p,h);v&&(x.years=v);const w=(0,n.add)(h,{years:x.years}),_=(0,s.differenceInMonths)(p,w);_&&(x.months=_);const j=(0,n.add)(w,{months:x.months}),T=(0,e.differenceInDays)(p,j);T&&(x.days=T);const P=(0,n.add)(j,{days:x.days}),D=(0,t.differenceInHours)(p,P);D&&(x.hours=D);const M=(0,n.add)(P,{hours:x.hours}),O=(0,r.differenceInMinutes)(p,M);O&&(x.minutes=O);const I=(0,n.add)(M,{minutes:x.minutes}),q=(0,a.differenceInSeconds)(p,I);return q&&(x.seconds=q),x}return f_}var h_={},gO;function Tte(){if(gO)return h_;gO=1,h_.intlFormat=e;var n=Re();function e(r,s,a){let o;return t(s)?o=s:a=s,new Intl.DateTimeFormat(a?.locale,o).format((0,n.toDate)(r))}function t(r){return r!==void 0&&!("locale"in r)}return h_}var m_={},xO;function kte(){if(xO)return m_;xO=1,m_.intlFormatDistance=h;var n=Qt(),e=nd(),t=$C(),r=p5(),s=HC(),a=YC(),o=ZC(),l=KC(),c=by(),d=Re();function h(p,x,v){let w=0,_;const j=(0,d.toDate)(p),T=(0,d.toDate)(x);if(v?.unit)_=v?.unit,_==="second"?w=(0,c.differenceInSeconds)(j,T):_==="minute"?w=(0,l.differenceInMinutes)(j,T):_==="hour"?w=(0,o.differenceInHours)(j,T):_==="day"?w=(0,e.differenceInCalendarDays)(j,T):_==="week"?w=(0,s.differenceInCalendarWeeks)(j,T):_==="month"?w=(0,t.differenceInCalendarMonths)(j,T):_==="quarter"?w=(0,r.differenceInCalendarQuarters)(j,T):_==="year"&&(w=(0,a.differenceInCalendarYears)(j,T));else{const D=(0,c.differenceInSeconds)(j,T);Math.abs(D)<n.secondsInMinute?(w=(0,c.differenceInSeconds)(j,T),_="second"):Math.abs(D)<n.secondsInHour?(w=(0,l.differenceInMinutes)(j,T),_="minute"):Math.abs(D)<n.secondsInDay&&Math.abs((0,e.differenceInCalendarDays)(j,T))<1?(w=(0,o.differenceInHours)(j,T),_="hour"):Math.abs(D)<n.secondsInWeek&&(w=(0,e.differenceInCalendarDays)(j,T))&&Math.abs(w)<7?_="day":Math.abs(D)<n.secondsInMonth?(w=(0,s.differenceInCalendarWeeks)(j,T),_="week"):Math.abs(D)<n.secondsInQuarter?(w=(0,t.differenceInCalendarMonths)(j,T),_="month"):Math.abs(D)<n.secondsInYear&&(0,r.differenceInCalendarQuarters)(j,T)<4?(w=(0,r.differenceInCalendarQuarters)(j,T),_="quarter"):(w=(0,a.differenceInCalendarYears)(j,T),_="year")}return new Intl.RelativeTimeFormat(v?.locale,{localeMatcher:v?.localeMatcher,numeric:v?.numeric||"auto",style:v?.style}).format(w,_)}return m_}var p_={},yO;function Pte(){if(yO)return p_;yO=1,p_.isAfter=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getTime()>a.getTime()}return p_}var g_={},vO;function Mte(){if(vO)return g_;vO=1,g_.isBefore=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return+s<+a}return g_}var x_={},bO;function Ete(){if(bO)return x_;bO=1,x_.isEqual=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return+s==+a}return x_}var y_={},wO;function Dte(){if(wO)return y_;wO=1,y_.isExists=n;function n(e,t,r){const s=new Date(e,t,r);return s.getFullYear()===e&&s.getMonth()===t&&s.getDate()===r}return y_}var v_={},_O;function Ote(){if(_O)return v_;_O=1,v_.isFirstDayOfMonth=e;var n=Re();function e(t){return(0,n.toDate)(t).getDate()===1}return v_}var b_={},jO;function Ite(){if(jO)return b_;jO=1,b_.isFriday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===5}return b_}var w_={},NO;function Ate(){if(NO)return w_;NO=1,w_.isFuture=e;var n=Re();function e(t){return+(0,n.toDate)(t)>Date.now()}return w_}var __={},j_={},sg={},ig={},ag={},Sc={},N_={},SO;function R5(){if(SO)return N_;SO=1,N_.transpose=e;var n=un();function e(t,r){const s=r instanceof Date?(0,n.constructFrom)(r,0):new r(0);return s.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),s.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),s}return N_}var CO;function L5(){if(CO)return Sc;CO=1,Sc.ValueSetter=Sc.Setter=Sc.DateToSystemTimezoneSetter=void 0;var n=R5(),e=un();const t=10;let r=class{subPriority=0;validate(l,c){return!0}};Sc.Setter=r;class s extends r{constructor(l,c,d,h,p){super(),this.value=l,this.validateValue=c,this.setValue=d,this.priority=h,p&&(this.subPriority=p)}validate(l,c){return this.validateValue(l,this.value,c)}set(l,c,d){return this.setValue(l,c,this.value,d)}}Sc.ValueSetter=s;class a extends r{priority=t;subPriority=-1;set(l,c){return c.timestampIsSet?l:(0,e.constructFrom)(l,(0,n.transpose)(l,Date))}}return Sc.DateToSystemTimezoneSetter=a,Sc}var TO;function pn(){if(TO)return ag;TO=1,ag.Parser=void 0;var n=L5();let e=class{run(r,s,a,o){const l=this.parse(r,s,a,o);return l?{setter:new n.ValueSetter(l.value,this.validate,this.set,this.priority,this.subPriority),rest:l.rest}:null}validate(r,s,a){return!0}};return ag.Parser=e,ag}var kO;function Rte(){if(kO)return ig;kO=1,ig.EraParser=void 0;var n=pn();let e=class extends n.Parser{priority=140;parse(r,s,a){switch(s){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,s,a){return s.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}incompatibleTokens=["R","u","t","T"]};return ig.EraParser=e,ig}var og={},va={},Ju={},PO;function Ts(){return PO||(PO=1,Ju.timezonePatterns=Ju.numericPatterns=void 0,Ju.numericPatterns={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Ju.timezonePatterns={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/}),Ju}var MO;function jn(){if(MO)return va;MO=1,va.dayPeriodEnumToHours=c,va.isLeapYearIndex=h,va.mapValue=t,va.normalizeTwoDigitYear=d,va.parseAnyDigitsSigned=a,va.parseNDigits=o,va.parseNDigitsSigned=l,va.parseNumericPattern=r,va.parseTimezonePattern=s;var n=Qt(),e=Ts();function t(p,x){return p&&{value:x(p.value),rest:p.rest}}function r(p,x){const v=x.match(p);return v?{value:parseInt(v[0],10),rest:x.slice(v[0].length)}:null}function s(p,x){const v=x.match(p);if(!v)return null;if(v[0]==="Z")return{value:0,rest:x.slice(1)};const w=v[1]==="+"?1:-1,_=v[2]?parseInt(v[2],10):0,j=v[3]?parseInt(v[3],10):0,T=v[5]?parseInt(v[5],10):0;return{value:w*(_*n.millisecondsInHour+j*n.millisecondsInMinute+T*n.millisecondsInSecond),rest:x.slice(v[0].length)}}function a(p){return r(e.numericPatterns.anyDigitsSigned,p)}function o(p,x){switch(p){case 1:return r(e.numericPatterns.singleDigit,x);case 2:return r(e.numericPatterns.twoDigits,x);case 3:return r(e.numericPatterns.threeDigits,x);case 4:return r(e.numericPatterns.fourDigits,x);default:return r(new RegExp("^\\d{1,"+p+"}"),x)}}function l(p,x){switch(p){case 1:return r(e.numericPatterns.singleDigitSigned,x);case 2:return r(e.numericPatterns.twoDigitsSigned,x);case 3:return r(e.numericPatterns.threeDigitsSigned,x);case 4:return r(e.numericPatterns.fourDigitsSigned,x);default:return r(new RegExp("^-?\\d{1,"+p+"}"),x)}}function c(p){switch(p){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function d(p,x){const v=x>0,w=v?x:1-x;let _;if(w<=50)_=p||100;else{const j=w+50,T=Math.trunc(j/100)*100,P=p>=j%100;_=p+T-(P?100:0)}return v?_:1-_}function h(p){return p%400===0||p%4===0&&p%100!==0}return va}var EO;function Lte(){if(EO)return og;EO=1,og.YearParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(s,a,o){const l=c=>({year:c,isTwoDigitYear:a==="yy"});switch(a){case"y":return(0,e.mapValue)((0,e.parseNDigits)(4,s),l);case"yo":return(0,e.mapValue)(o.ordinalNumber(s,{unit:"year"}),l);default:return(0,e.mapValue)((0,e.parseNDigits)(a.length,s),l)}}validate(s,a){return a.isTwoDigitYear||a.year>0}set(s,a,o){const l=s.getFullYear();if(o.isTwoDigitYear){const d=(0,e.normalizeTwoDigitYear)(o.year,l);return s.setFullYear(d,0,1),s.setHours(0,0,0,0),s}const c=!("era"in a)||a.era===1?o.year:1-o.year;return s.setFullYear(c,0,1),s.setHours(0,0,0,0),s}};return og.YearParser=t,og}var lg={},DO;function Fte(){if(DO)return lg;DO=1,lg.LocalWeekYearParser=void 0;var n=_y(),e=ko(),t=pn(),r=jn();let s=class extends t.Parser{priority=130;parse(o,l,c){const d=h=>({year:h,isTwoDigitYear:l==="YY"});switch(l){case"Y":return(0,r.mapValue)((0,r.parseNDigits)(4,o),d);case"Yo":return(0,r.mapValue)(c.ordinalNumber(o,{unit:"year"}),d);default:return(0,r.mapValue)((0,r.parseNDigits)(l.length,o),d)}}validate(o,l){return l.isTwoDigitYear||l.year>0}set(o,l,c,d){const h=(0,n.getWeekYear)(o,d);if(c.isTwoDigitYear){const x=(0,r.normalizeTwoDigitYear)(c.year,h);return o.setFullYear(x,0,d.firstWeekContainsDate),o.setHours(0,0,0,0),(0,e.startOfWeek)(o,d)}const p=!("era"in l)||l.era===1?c.year:1-c.year;return o.setFullYear(p,0,d.firstWeekContainsDate),o.setHours(0,0,0,0),(0,e.startOfWeek)(o,d)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]};return lg.LocalWeekYearParser=s,lg}var cg={},OO;function qte(){if(OO)return cg;OO=1,cg.ISOWeekYearParser=void 0;var n=Dl(),e=un(),t=pn(),r=jn();let s=class extends t.Parser{priority=130;parse(o,l){return l==="R"?(0,r.parseNDigitsSigned)(4,o):(0,r.parseNDigitsSigned)(l.length,o)}set(o,l,c){const d=(0,e.constructFrom)(o,0);return d.setFullYear(c,0,4),d.setHours(0,0,0,0),(0,n.startOfISOWeek)(d)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]};return cg.ISOWeekYearParser=s,cg}var dg={},IO;function zte(){if(IO)return dg;IO=1,dg.ExtendedYearParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=130;parse(s,a){return a==="u"?(0,e.parseNDigitsSigned)(4,s):(0,e.parseNDigitsSigned)(a.length,s)}set(s,a,o){return s.setFullYear(o,0,1),s.setHours(0,0,0,0),s}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]};return dg.ExtendedYearParser=t,dg}var ug={},AO;function Ute(){if(AO)return ug;AO=1,ug.QuarterParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=120;parse(s,a,o){switch(a){case"Q":case"QQ":return(0,e.parseNDigits)(a.length,s);case"Qo":return o.ordinalNumber(s,{unit:"quarter"});case"QQQ":return o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(s,{width:"wide",context:"formatting"})||o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"})}}validate(s,a){return a>=1&&a<=4}set(s,a,o){return s.setMonth((o-1)*3,1),s.setHours(0,0,0,0),s}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]};return ug.QuarterParser=t,ug}var fg={},RO;function Vte(){if(RO)return fg;RO=1,fg.StandAloneQuarterParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=120;parse(s,a,o){switch(a){case"q":case"qq":return(0,e.parseNDigits)(a.length,s);case"qo":return o.ordinalNumber(s,{unit:"quarter"});case"qqq":return o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(s,{width:"wide",context:"standalone"})||o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"})}}validate(s,a){return a>=1&&a<=4}set(s,a,o){return s.setMonth((o-1)*3,1),s.setHours(0,0,0,0),s}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]};return fg.StandAloneQuarterParser=t,fg}var hg={},LO;function Bte(){if(LO)return hg;LO=1,hg.MonthParser=void 0;var n=Ts(),e=pn(),t=jn();let r=class extends e.Parser{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(a,o,l){const c=d=>d-1;switch(o){case"M":return(0,t.mapValue)((0,t.parseNumericPattern)(n.numericPatterns.month,a),c);case"MM":return(0,t.mapValue)((0,t.parseNDigits)(2,a),c);case"Mo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"month"}),c);case"MMM":return l.month(a,{width:"abbreviated",context:"formatting"})||l.month(a,{width:"narrow",context:"formatting"});case"MMMMM":return l.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return l.month(a,{width:"wide",context:"formatting"})||l.month(a,{width:"abbreviated",context:"formatting"})||l.month(a,{width:"narrow",context:"formatting"})}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.setMonth(l,1),a.setHours(0,0,0,0),a}};return hg.MonthParser=r,hg}var mg={},FO;function Wte(){if(FO)return mg;FO=1,mg.StandAloneMonthParser=void 0;var n=Ts(),e=pn(),t=jn();let r=class extends e.Parser{priority=110;parse(a,o,l){const c=d=>d-1;switch(o){case"L":return(0,t.mapValue)((0,t.parseNumericPattern)(n.numericPatterns.month,a),c);case"LL":return(0,t.mapValue)((0,t.parseNDigits)(2,a),c);case"Lo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"month"}),c);case"LLL":return l.month(a,{width:"abbreviated",context:"standalone"})||l.month(a,{width:"narrow",context:"standalone"});case"LLLLL":return l.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return l.month(a,{width:"wide",context:"standalone"})||l.month(a,{width:"abbreviated",context:"standalone"})||l.month(a,{width:"narrow",context:"standalone"})}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.setMonth(l,1),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};return mg.StandAloneMonthParser=r,mg}var pg={},S_={},qO;function F5(){if(qO)return S_;qO=1,S_.setWeek=t;var n=i1(),e=Re();function t(r,s,a){const o=(0,e.toDate)(r),l=(0,n.getWeek)(o,a)-s;return o.setDate(o.getDate()-l*7),o}return S_}var zO;function $te(){if(zO)return pg;zO=1,pg.LocalWeekParser=void 0;var n=F5(),e=ko(),t=Ts(),r=pn(),s=jn();let a=class extends r.Parser{priority=100;parse(l,c,d){switch(c){case"w":return(0,s.parseNumericPattern)(t.numericPatterns.week,l);case"wo":return d.ordinalNumber(l,{unit:"week"});default:return(0,s.parseNDigits)(c.length,l)}}validate(l,c){return c>=1&&c<=53}set(l,c,d,h){return(0,e.startOfWeek)((0,n.setWeek)(l,d,h),h)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};return pg.LocalWeekParser=a,pg}var gg={},C_={},UO;function q5(){if(UO)return C_;UO=1,C_.setISOWeek=t;var n=r1(),e=Re();function t(r,s){const a=(0,e.toDate)(r),o=(0,n.getISOWeek)(a)-s;return a.setDate(a.getDate()-o*7),a}return C_}var VO;function Hte(){if(VO)return gg;VO=1,gg.ISOWeekParser=void 0;var n=q5(),e=Dl(),t=Ts(),r=pn(),s=jn();let a=class extends r.Parser{priority=100;parse(l,c,d){switch(c){case"I":return(0,s.parseNumericPattern)(t.numericPatterns.week,l);case"Io":return d.ordinalNumber(l,{unit:"week"});default:return(0,s.parseNDigits)(c.length,l)}}validate(l,c){return c>=1&&c<=53}set(l,c,d){return(0,e.startOfISOWeek)((0,n.setISOWeek)(l,d))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};return gg.ISOWeekParser=a,gg}var xg={},BO;function Yte(){if(BO)return xg;BO=1,xg.DateParser=void 0;var n=Ts(),e=pn(),t=jn();const r=[31,28,31,30,31,30,31,31,30,31,30,31],s=[31,29,31,30,31,30,31,31,30,31,30,31];let a=class extends e.Parser{priority=90;subPriority=1;parse(l,c,d){switch(c){case"d":return(0,t.parseNumericPattern)(n.numericPatterns.date,l);case"do":return d.ordinalNumber(l,{unit:"date"});default:return(0,t.parseNDigits)(c.length,l)}}validate(l,c){const d=l.getFullYear(),h=(0,t.isLeapYearIndex)(d),p=l.getMonth();return h?c>=1&&c<=s[p]:c>=1&&c<=r[p]}set(l,c,d){return l.setDate(d),l.setHours(0,0,0,0),l}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]};return xg.DateParser=a,xg}var yg={},WO;function Gte(){if(WO)return yg;WO=1,yg.DayOfYearParser=void 0;var n=Ts(),e=pn(),t=jn();let r=class extends e.Parser{priority=90;subpriority=1;parse(a,o,l){switch(o){case"D":case"DD":return(0,t.parseNumericPattern)(n.numericPatterns.dayOfYear,a);case"Do":return l.ordinalNumber(a,{unit:"date"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){const l=a.getFullYear();return(0,t.isLeapYearIndex)(l)?o>=1&&o<=366:o>=1&&o<=365}set(a,o,l){return a.setMonth(0,l),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};return yg.DayOfYearParser=r,yg}var vg={},T_={},$O;function Ny(){if($O)return T_;$O=1,T_.setDay=r;var n=El(),e=Re(),t=Cs();function r(s,a,o){const l=(0,t.getDefaultOptions)(),c=o?.weekStartsOn??o?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,d=(0,e.toDate)(s),h=d.getDay(),x=(a%7+7)%7,v=7-c,w=a<0||a>6?a-(h+v)%7:(x+v)%7-(h+v)%7;return(0,n.addDays)(d,w)}return T_}var HO;function Zte(){if(HO)return vg;HO=1,vg.DayParser=void 0;var n=Ny(),e=pn();let t=class extends e.Parser{priority=90;parse(s,a,o){switch(a){case"E":case"EE":case"EEE":return o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(s,{width:"wide",context:"formatting"})||o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"})}}validate(s,a){return a>=0&&a<=6}set(s,a,o,l){return s=(0,n.setDay)(s,o,l),s.setHours(0,0,0,0),s}incompatibleTokens=["D","i","e","c","t","T"]};return vg.DayParser=t,vg}var bg={},YO;function Kte(){if(YO)return bg;YO=1,bg.LocalDayParser=void 0;var n=Ny(),e=pn(),t=jn();let r=class extends e.Parser{priority=90;parse(a,o,l,c){const d=h=>{const p=Math.floor((h-1)/7)*7;return(h+c.weekStartsOn+6)%7+p};switch(o){case"e":case"ee":return(0,t.mapValue)((0,t.parseNDigits)(o.length,a),d);case"eo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"day"}),d);case"eee":return l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"});case"eeeee":return l.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"});case"eeee":default:return l.day(a,{width:"wide",context:"formatting"})||l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"})}}validate(a,o){return o>=0&&o<=6}set(a,o,l,c){return a=(0,n.setDay)(a,l,c),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]};return bg.LocalDayParser=r,bg}var wg={},GO;function Jte(){if(GO)return wg;GO=1,wg.StandAloneLocalDayParser=void 0;var n=Ny(),e=pn(),t=jn();let r=class extends e.Parser{priority=90;parse(a,o,l,c){const d=h=>{const p=Math.floor((h-1)/7)*7;return(h+c.weekStartsOn+6)%7+p};switch(o){case"c":case"cc":return(0,t.mapValue)((0,t.parseNDigits)(o.length,a),d);case"co":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"day"}),d);case"ccc":return l.day(a,{width:"abbreviated",context:"standalone"})||l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"});case"ccccc":return l.day(a,{width:"narrow",context:"standalone"});case"cccccc":return l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"});case"cccc":default:return l.day(a,{width:"wide",context:"standalone"})||l.day(a,{width:"abbreviated",context:"standalone"})||l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"})}}validate(a,o){return o>=0&&o<=6}set(a,o,l,c){return a=(0,n.setDay)(a,l,c),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};return wg.StandAloneLocalDayParser=r,wg}var _g={},k_={},ZO;function z5(){if(ZO)return k_;ZO=1,k_.setISODay=r;var n=El(),e=I5(),t=Re();function r(s,a){const o=(0,t.toDate)(s),l=(0,e.getISODay)(o),c=a-l;return(0,n.addDays)(o,c)}return k_}var KO;function Qte(){if(KO)return _g;KO=1,_g.ISODayParser=void 0;var n=z5(),e=pn(),t=jn();let r=class extends e.Parser{priority=90;parse(a,o,l){const c=d=>d===0?7:d;switch(o){case"i":case"ii":return(0,t.parseNDigits)(o.length,a);case"io":return l.ordinalNumber(a,{unit:"day"});case"iii":return(0,t.mapValue)(l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c);case"iiiii":return(0,t.mapValue)(l.day(a,{width:"narrow",context:"formatting"}),c);case"iiiiii":return(0,t.mapValue)(l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c);case"iiii":default:return(0,t.mapValue)(l.day(a,{width:"wide",context:"formatting"})||l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c)}}validate(a,o){return o>=1&&o<=7}set(a,o,l){return a=(0,n.setISODay)(a,l),a.setHours(0,0,0,0),a}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]};return _g.ISODayParser=r,_g}var jg={},JO;function Xte(){if(JO)return jg;JO=1,jg.AMPMParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"a":case"aa":case"aaa":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["b","B","H","k","t","T"]};return jg.AMPMParser=t,jg}var Ng={},QO;function ene(){if(QO)return Ng;QO=1,Ng.AMPMMidnightParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"b":case"bb":case"bbb":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["a","B","H","k","t","T"]};return Ng.AMPMMidnightParser=t,Ng}var Sg={},XO;function tne(){if(XO)return Sg;XO=1,Sg.DayPeriodParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"B":case"BB":case"BBB":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["a","b","t","T"]};return Sg.DayPeriodParser=t,Sg}var Cg={},eI;function nne(){if(eI)return Cg;eI=1,Cg.Hour1to12Parser=void 0;var n=Ts(),e=pn(),t=jn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"h":return(0,t.parseNumericPattern)(n.numericPatterns.hour12h,a);case"ho":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=1&&o<=12}set(a,o,l){const c=a.getHours()>=12;return c&&l<12?a.setHours(l+12,0,0,0):!c&&l===12?a.setHours(0,0,0,0):a.setHours(l,0,0,0),a}incompatibleTokens=["H","K","k","t","T"]};return Cg.Hour1to12Parser=r,Cg}var Tg={},tI;function rne(){if(tI)return Tg;tI=1,Tg.Hour0to23Parser=void 0;var n=Ts(),e=pn(),t=jn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"H":return(0,t.parseNumericPattern)(n.numericPatterns.hour23h,a);case"Ho":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=23}set(a,o,l){return a.setHours(l,0,0,0),a}incompatibleTokens=["a","b","h","K","k","t","T"]};return Tg.Hour0to23Parser=r,Tg}var kg={},nI;function sne(){if(nI)return kg;nI=1,kg.Hour0To11Parser=void 0;var n=Ts(),e=pn(),t=jn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"K":return(0,t.parseNumericPattern)(n.numericPatterns.hour11h,a);case"Ko":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.getHours()>=12&&l<12?a.setHours(l+12,0,0,0):a.setHours(l,0,0,0),a}incompatibleTokens=["h","H","k","t","T"]};return kg.Hour0To11Parser=r,kg}var Pg={},rI;function ine(){if(rI)return Pg;rI=1,Pg.Hour1To24Parser=void 0;var n=Ts(),e=pn(),t=jn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"k":return(0,t.parseNumericPattern)(n.numericPatterns.hour24h,a);case"ko":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=1&&o<=24}set(a,o,l){const c=l<=24?l%24:l;return a.setHours(c,0,0,0),a}incompatibleTokens=["a","b","h","H","K","t","T"]};return Pg.Hour1To24Parser=r,Pg}var Mg={},sI;function ane(){if(sI)return Mg;sI=1,Mg.MinuteParser=void 0;var n=Ts(),e=pn(),t=jn();let r=class extends e.Parser{priority=60;parse(a,o,l){switch(o){case"m":return(0,t.parseNumericPattern)(n.numericPatterns.minute,a);case"mo":return l.ordinalNumber(a,{unit:"minute"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=59}set(a,o,l){return a.setMinutes(l,0,0),a}incompatibleTokens=["t","T"]};return Mg.MinuteParser=r,Mg}var Eg={},iI;function one(){if(iI)return Eg;iI=1,Eg.SecondParser=void 0;var n=Ts(),e=pn(),t=jn();let r=class extends e.Parser{priority=50;parse(a,o,l){switch(o){case"s":return(0,t.parseNumericPattern)(n.numericPatterns.second,a);case"so":return l.ordinalNumber(a,{unit:"second"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=59}set(a,o,l){return a.setSeconds(l,0),a}incompatibleTokens=["t","T"]};return Eg.SecondParser=r,Eg}var Dg={},aI;function lne(){if(aI)return Dg;aI=1,Dg.FractionOfSecondParser=void 0;var n=pn(),e=jn();let t=class extends n.Parser{priority=30;parse(s,a){const o=l=>Math.trunc(l*Math.pow(10,-a.length+3));return(0,e.mapValue)((0,e.parseNDigits)(a.length,s),o)}set(s,a,o){return s.setMilliseconds(o),s}incompatibleTokens=["t","T"]};return Dg.FractionOfSecondParser=t,Dg}var Og={},oI;function cne(){if(oI)return Og;oI=1,Og.ISOTimezoneWithZParser=void 0;var n=un(),e=td(),t=Ts(),r=pn(),s=jn();let a=class extends r.Parser{priority=10;parse(l,c){switch(c){case"X":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalMinutes,l);case"XX":return(0,s.parseTimezonePattern)(t.timezonePatterns.basic,l);case"XXXX":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalSeconds,l);case"XXXXX":return(0,s.parseTimezonePattern)(t.timezonePatterns.extendedOptionalSeconds,l);case"XXX":default:return(0,s.parseTimezonePattern)(t.timezonePatterns.extended,l)}}set(l,c,d){return c.timestampIsSet?l:(0,n.constructFrom)(l,l.getTime()-(0,e.getTimezoneOffsetInMilliseconds)(l)-d)}incompatibleTokens=["t","T","x"]};return Og.ISOTimezoneWithZParser=a,Og}var Ig={},lI;function dne(){if(lI)return Ig;lI=1,Ig.ISOTimezoneParser=void 0;var n=un(),e=td(),t=Ts(),r=pn(),s=jn();let a=class extends r.Parser{priority=10;parse(l,c){switch(c){case"x":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalMinutes,l);case"xx":return(0,s.parseTimezonePattern)(t.timezonePatterns.basic,l);case"xxxx":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalSeconds,l);case"xxxxx":return(0,s.parseTimezonePattern)(t.timezonePatterns.extendedOptionalSeconds,l);case"xxx":default:return(0,s.parseTimezonePattern)(t.timezonePatterns.extended,l)}}set(l,c,d){return c.timestampIsSet?l:(0,n.constructFrom)(l,l.getTime()-(0,e.getTimezoneOffsetInMilliseconds)(l)-d)}incompatibleTokens=["t","T","X"]};return Ig.ISOTimezoneParser=a,Ig}var Ag={},cI;function une(){if(cI)return Ag;cI=1,Ag.TimestampSecondsParser=void 0;var n=un(),e=pn(),t=jn();let r=class extends e.Parser{priority=40;parse(a){return(0,t.parseAnyDigitsSigned)(a)}set(a,o,l){return[(0,n.constructFrom)(a,l*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"};return Ag.TimestampSecondsParser=r,Ag}var Rg={},dI;function fne(){if(dI)return Rg;dI=1,Rg.TimestampMillisecondsParser=void 0;var n=un(),e=pn(),t=jn();let r=class extends e.Parser{priority=20;parse(a){return(0,t.parseAnyDigitsSigned)(a)}set(a,o,l){return[(0,n.constructFrom)(a,l),{timestampIsSet:!0}]}incompatibleTokens="*"};return Rg.TimestampMillisecondsParser=r,Rg}var uI;function hne(){if(uI)return sg;uI=1,sg.parsers=void 0;var n=Rte(),e=Lte(),t=Fte(),r=qte(),s=zte(),a=Ute(),o=Vte(),l=Bte(),c=Wte(),d=$te(),h=Hte(),p=Yte(),x=Gte(),v=Zte(),w=Kte(),_=Jte(),j=Qte(),T=Xte(),P=ene(),D=tne(),M=nne(),O=rne(),I=sne(),q=ine(),F=ane(),V=one(),U=lne(),W=cne(),$=dne(),ne=une(),Y=fne();return sg.parsers={G:new n.EraParser,y:new e.YearParser,Y:new t.LocalWeekYearParser,R:new r.ISOWeekYearParser,u:new s.ExtendedYearParser,Q:new a.QuarterParser,q:new o.StandAloneQuarterParser,M:new l.MonthParser,L:new c.StandAloneMonthParser,w:new d.LocalWeekParser,I:new h.ISOWeekParser,d:new p.DateParser,D:new x.DayOfYearParser,E:new v.DayParser,e:new w.LocalDayParser,c:new _.StandAloneLocalDayParser,i:new j.ISODayParser,a:new T.AMPMParser,b:new P.AMPMMidnightParser,B:new D.DayPeriodParser,h:new M.Hour1to12Parser,H:new O.Hour0to23Parser,K:new I.Hour0To11Parser,k:new q.Hour1To24Parser,m:new F.MinuteParser,s:new V.SecondParser,S:new U.FractionOfSecondParser,X:new W.ISOTimezoneWithZParser,x:new $.ISOTimezoneParser,t:new ne.TimestampSecondsParser,T:new Y.TimestampMillisecondsParser},sg}var fI;function U5(){return fI||(fI=1,(function(n){Object.defineProperty(n,"longFormatters",{enumerable:!0,get:function(){return a.longFormatters}}),n.parse=_,Object.defineProperty(n,"parsers",{enumerable:!0,get:function(){return l.parsers}});var e=un(),t=O5(),r=$f(),s=Re(),a=S5(),o=C5(),l=hne(),c=L5();const d=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,h=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,p=/^'([^]*?)'?$/,x=/''/g,v=/\S/,w=/[a-zA-Z]/;function _(T,P,D,M){const O=(0,t.getDefaultOptions)(),I=M?.locale??O.locale??r.defaultLocale,q=M?.firstWeekContainsDate??M?.locale?.options?.firstWeekContainsDate??O.firstWeekContainsDate??O.locale?.options?.firstWeekContainsDate??1,F=M?.weekStartsOn??M?.locale?.options?.weekStartsOn??O.weekStartsOn??O.locale?.options?.weekStartsOn??0;if(P==="")return T===""?(0,s.toDate)(D):(0,e.constructFrom)(D,NaN);const V={firstWeekContainsDate:q,weekStartsOn:F,locale:I},U=[new c.DateToSystemTimezoneSetter],W=P.match(h).map(J=>{const ee=J[0];if(ee in a.longFormatters){const X=a.longFormatters[ee];return X(J,I.formatLong)}return J}).join("").match(d),$=[];for(let J of W){!M?.useAdditionalWeekYearTokens&&(0,o.isProtectedWeekYearToken)(J)&&(0,o.warnOrThrowProtectedError)(J,P,T),!M?.useAdditionalDayOfYearTokens&&(0,o.isProtectedDayOfYearToken)(J)&&(0,o.warnOrThrowProtectedError)(J,P,T);const ee=J[0],X=l.parsers[ee];if(X){const{incompatibleTokens:Z}=X;if(Array.isArray(Z)){const H=$.find(Q=>Z.includes(Q.token)||Q.token===ee);if(H)throw new RangeError(`The format string mustn't contain \`${H.fullToken}\` and \`${J}\` at the same time`)}else if(X.incompatibleTokens==="*"&&$.length>0)throw new RangeError(`The format string mustn't contain \`${J}\` and any other token at the same time`);$.push({token:ee,fullToken:J});const oe=X.run(T,J,I.match,V);if(!oe)return(0,e.constructFrom)(D,NaN);U.push(oe.setter),T=oe.rest}else{if(ee.match(w))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ee+"`");if(J==="''"?J="'":ee==="'"&&(J=j(J)),T.indexOf(J)===0)T=T.slice(J.length);else return(0,e.constructFrom)(D,NaN)}}if(T.length>0&&v.test(T))return(0,e.constructFrom)(D,NaN);const ne=U.map(J=>J.priority).sort((J,ee)=>ee-J).filter((J,ee,X)=>X.indexOf(J)===ee).map(J=>U.filter(ee=>ee.priority===J).sort((ee,X)=>X.subPriority-ee.subPriority)).map(J=>J[0]);let Y=(0,s.toDate)(D);if(isNaN(Y.getTime()))return(0,e.constructFrom)(D,NaN);const ae={};for(const J of ne){if(!J.validate(Y,V))return(0,e.constructFrom)(D,NaN);const ee=J.set(Y,ae,V);Array.isArray(ee)?(Y=ee[0],Object.assign(ae,ee[1])):Y=ee}return(0,e.constructFrom)(D,Y)}function j(T){return T.match(p)[1].replace(x,"'")}})(j_)),j_}var hI;function mne(){if(hI)return __;hI=1,__.isMatch=t;var n=rd(),e=U5();function t(r,s,a){return(0,n.isValid)((0,e.parse)(r,s,new Date,a))}return __}var P_={},mI;function pne(){if(mI)return P_;mI=1,P_.isMonday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===1}return P_}var M_={},pI;function gne(){if(pI)return M_;pI=1,M_.isPast=e;var n=Re();function e(t){return+(0,n.toDate)(t)<Date.now()}return M_}var E_={},D_={},gI;function V5(){if(gI)return D_;gI=1,D_.startOfHour=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setMinutes(0,0,0),r}return D_}var xI;function B5(){if(xI)return E_;xI=1,E_.isSameHour=e;var n=V5();function e(t,r){const s=(0,n.startOfHour)(t),a=(0,n.startOfHour)(r);return+s==+a}return E_}var O_={},I_={},yI;function a1(){if(yI)return I_;yI=1,I_.isSameWeek=e;var n=ko();function e(t,r,s){const a=(0,n.startOfWeek)(t,s),o=(0,n.startOfWeek)(r,s);return+a==+o}return I_}var vI;function W5(){if(vI)return O_;vI=1,O_.isSameISOWeek=e;var n=a1();function e(t,r){return(0,n.isSameWeek)(t,r,{weekStartsOn:1})}return O_}var A_={},bI;function xne(){if(bI)return A_;bI=1,A_.isSameISOWeekYear=e;var n=Rm();function e(t,r){const s=(0,n.startOfISOWeekYear)(t),a=(0,n.startOfISOWeekYear)(r);return+s==+a}return A_}var R_={},wI;function $5(){if(wI)return R_;wI=1,R_.isSameMinute=e;var n=XC();function e(t,r){const s=(0,n.startOfMinute)(t),a=(0,n.startOfMinute)(r);return+s==+a}return R_}var L_={},_I;function H5(){if(_I)return L_;_I=1,L_.isSameMonth=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()}return L_}var F_={},jI;function Y5(){if(jI)return F_;jI=1,F_.isSameQuarter=e;var n=e1();function e(t,r){const s=(0,n.startOfQuarter)(t),a=(0,n.startOfQuarter)(r);return+s==+a}return F_}var q_={},z_={},NI;function G5(){if(NI)return z_;NI=1,z_.startOfSecond=e;var n=Re();function e(t){const r=(0,n.toDate)(t);return r.setMilliseconds(0),r}return z_}var SI;function Z5(){if(SI)return q_;SI=1,q_.isSameSecond=e;var n=G5();function e(t,r){const s=(0,n.startOfSecond)(t),a=(0,n.startOfSecond)(r);return+s==+a}return q_}var U_={},CI;function K5(){if(CI)return U_;CI=1,U_.isSameYear=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()===a.getFullYear()}return U_}var V_={},TI;function yne(){if(TI)return V_;TI=1,V_.isThisHour=t;var n=Zs(),e=B5();function t(r){return(0,e.isSameHour)(r,(0,n.constructNow)(r))}return V_}var B_={},kI;function vne(){if(kI)return B_;kI=1,B_.isThisISOWeek=t;var n=Zs(),e=W5();function t(r){return(0,e.isSameISOWeek)(r,(0,n.constructNow)(r))}return B_}var W_={},PI;function bne(){if(PI)return W_;PI=1,W_.isThisMinute=t;var n=Zs(),e=$5();function t(r){return(0,e.isSameMinute)(r,(0,n.constructNow)(r))}return W_}var $_={},MI;function wne(){if(MI)return $_;MI=1,$_.isThisMonth=t;var n=Zs(),e=H5();function t(r){return(0,e.isSameMonth)(r,(0,n.constructNow)(r))}return $_}var H_={},EI;function _ne(){if(EI)return H_;EI=1,H_.isThisQuarter=t;var n=Zs(),e=Y5();function t(r){return(0,e.isSameQuarter)(r,(0,n.constructNow)(r))}return H_}var Y_={},DI;function jne(){if(DI)return Y_;DI=1,Y_.isThisSecond=t;var n=Zs(),e=Z5();function t(r){return(0,e.isSameSecond)(r,(0,n.constructNow)(r))}return Y_}var G_={},OI;function Nne(){if(OI)return G_;OI=1,G_.isThisWeek=t;var n=Zs(),e=a1();function t(r,s){return(0,e.isSameWeek)(r,(0,n.constructNow)(r),s)}return G_}var Z_={},II;function Sne(){if(II)return Z_;II=1,Z_.isThisYear=t;var n=Zs(),e=K5();function t(r){return(0,e.isSameYear)(r,(0,n.constructNow)(r))}return Z_}var K_={},AI;function Cne(){if(AI)return K_;AI=1,K_.isThursday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===4}return K_}var J_={},RI;function Tne(){if(RI)return J_;RI=1,J_.isToday=t;var n=Zs(),e=Lm();function t(r){return(0,e.isSameDay)(r,(0,n.constructNow)(r))}return J_}var Q_={},LI;function kne(){if(LI)return Q_;LI=1,Q_.isTomorrow=r;var n=El(),e=Zs(),t=Lm();function r(s){return(0,t.isSameDay)(s,(0,n.addDays)((0,e.constructNow)(s),1))}return Q_}var X_={},FI;function Pne(){if(FI)return X_;FI=1,X_.isTuesday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===2}return X_}var ej={},qI;function Mne(){if(qI)return ej;qI=1,ej.isWednesday=e;var n=Re();function e(t){return(0,n.toDate)(t).getDay()===3}return ej}var tj={},zI;function Ene(){if(zI)return tj;zI=1,tj.isWithinInterval=e;var n=Re();function e(t,r){const s=+(0,n.toDate)(t),[a,o]=[+(0,n.toDate)(r.start),+(0,n.toDate)(r.end)].sort((l,c)=>l-c);return s>=a&&s<=o}return tj}var nj={},rj={},UI;function Sy(){if(UI)return rj;UI=1,rj.subDays=e;var n=El();function e(t,r){return(0,n.addDays)(t,-r)}return rj}var VI;function Dne(){if(VI)return nj;VI=1,nj.isYesterday=r;var n=Zs(),e=Lm(),t=Sy();function r(s){return(0,e.isSameDay)(s,(0,t.subDays)((0,n.constructNow)(s),1))}return nj}var sj={},BI;function One(){if(BI)return sj;BI=1,sj.lastDayOfDecade=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=9+Math.floor(s/10)*10;return r.setFullYear(a+1,0,0),r.setHours(0,0,0,0),r}return sj}var ij={},aj={},WI;function J5(){if(WI)return aj;WI=1,aj.lastDayOfWeek=t;var n=Re(),e=Cs();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?-7:0)+6-(c-o);return l.setHours(0,0,0,0),l.setDate(l.getDate()+d),l}return aj}var $I;function Ine(){if($I)return ij;$I=1,ij.lastDayOfISOWeek=e;var n=J5();function e(t){return(0,n.lastDayOfWeek)(t,{weekStartsOn:1})}return ij}var oj={},HI;function Ane(){if(HI)return oj;HI=1,oj.lastDayOfISOWeekYear=r;var n=wu(),e=Dl(),t=un();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const l=(0,e.startOfISOWeek)(o);return l.setDate(l.getDate()-1),l}return oj}var lj={},YI;function Rne(){if(YI)return lj;YI=1,lj.lastDayOfQuarter=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3+3;return r.setMonth(a,0),r.setHours(0,0,0,0),r}return lj}var cj={},GI;function Lne(){if(GI)return cj;GI=1,cj.lastDayOfYear=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(0,0,0,0),r}return cj}var dj={},ZI;function Fne(){return ZI||(ZI=1,(function(n){n.lightFormat=c,Object.defineProperty(n,"lightFormatters",{enumerable:!0,get:function(){return r.lightFormatters}});var e=rd(),t=Re(),r=N5();const s=/(\w)\1*|''|'(''|[^'])+('|$)|./g,a=/^'([^]*?)'?$/,o=/''/g,l=/[a-zA-Z]/;function c(h,p){const x=(0,t.toDate)(h);if(!(0,e.isValid)(x))throw new RangeError("Invalid time value");const v=p.match(s);return v?v.map(_=>{if(_==="''")return"'";const j=_[0];if(j==="'")return d(_);const T=r.lightFormatters[j];if(T)return T(x,_);if(j.match(l))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");return _}).join(""):""}function d(h){const p=h.match(a);return p?p[1].replace(o,"'"):h}})(dj)),dj}var uj={},KI;function qne(){if(KI)return uj;KI=1,uj.milliseconds=e;var n=Qt();function e({years:t,months:r,weeks:s,days:a,hours:o,minutes:l,seconds:c}){let d=0;t&&(d+=t*n.daysInYear),r&&(d+=r*(n.daysInYear/12)),s&&(d+=s*7),a&&(d+=a);let h=d*24*60*60;return o&&(h+=o*60*60),l&&(h+=l*60),c&&(h+=c),Math.trunc(h*1e3)}return uj}var fj={},JI;function zne(){if(JI)return fj;JI=1,fj.millisecondsToHours=e;var n=Qt();function e(t){const r=t/n.millisecondsInHour;return Math.trunc(r)}return fj}var hj={},QI;function Une(){if(QI)return hj;QI=1,hj.millisecondsToMinutes=e;var n=Qt();function e(t){const r=t/n.millisecondsInMinute;return Math.trunc(r)}return hj}var mj={},XI;function Vne(){if(XI)return mj;XI=1,mj.millisecondsToSeconds=e;var n=Qt();function e(t){const r=t/n.millisecondsInSecond;return Math.trunc(r)}return mj}var pj={},eA;function Bne(){if(eA)return pj;eA=1,pj.minutesToHours=e;var n=Qt();function e(t){const r=t/n.minutesInHour;return Math.trunc(r)}return pj}var gj={},tA;function Wne(){if(tA)return gj;tA=1,gj.minutesToMilliseconds=e;var n=Qt();function e(t){return Math.trunc(t*n.millisecondsInMinute)}return gj}var xj={},nA;function $ne(){if(nA)return xj;nA=1,xj.minutesToSeconds=e;var n=Qt();function e(t){return Math.trunc(t*n.secondsInMinute)}return xj}var yj={},rA;function Hne(){if(rA)return yj;rA=1,yj.monthsToQuarters=e;var n=Qt();function e(t){const r=t/n.monthsInQuarter;return Math.trunc(r)}return yj}var vj={},sA;function Yne(){if(sA)return vj;sA=1,vj.monthsToYears=e;var n=Qt();function e(t){const r=t/n.monthsInYear;return Math.trunc(r)}return vj}var bj={},iA;function id(){if(iA)return bj;iA=1,bj.nextDay=t;var n=El(),e=jy();function t(r,s){let a=s-(0,e.getDay)(r);return a<=0&&(a+=7),(0,n.addDays)(r,a)}return bj}var wj={},aA;function Gne(){if(aA)return wj;aA=1,wj.nextFriday=e;var n=id();function e(t){return(0,n.nextDay)(t,5)}return wj}var _j={},oA;function Zne(){if(oA)return _j;oA=1,_j.nextMonday=e;var n=id();function e(t){return(0,n.nextDay)(t,1)}return _j}var jj={},lA;function Kne(){if(lA)return jj;lA=1,jj.nextSaturday=e;var n=id();function e(t){return(0,n.nextDay)(t,6)}return jj}var Nj={},cA;function Jne(){if(cA)return Nj;cA=1,Nj.nextSunday=e;var n=id();function e(t){return(0,n.nextDay)(t,0)}return Nj}var Sj={},dA;function Qne(){if(dA)return Sj;dA=1,Sj.nextThursday=e;var n=id();function e(t){return(0,n.nextDay)(t,4)}return Sj}var Cj={},uA;function Xne(){if(uA)return Cj;uA=1,Cj.nextTuesday=e;var n=id();function e(t){return(0,n.nextDay)(t,2)}return Cj}var Tj={},fA;function ere(){if(fA)return Tj;fA=1,Tj.nextWednesday=e;var n=id();function e(t){return(0,n.nextDay)(t,3)}return Tj}var kj={},hA;function tre(){if(hA)return kj;hA=1,kj.parseISO=e;var n=Qt();function e(O,I){const q=I?.additionalDigits??2,F=o(O);let V;if(F.date){const ne=l(F.date,q);V=c(ne.restDateString,ne.year)}if(!V||isNaN(V.getTime()))return new Date(NaN);const U=V.getTime();let W=0,$;if(F.time&&(W=h(F.time),isNaN(W)))return new Date(NaN);if(F.timezone){if($=x(F.timezone),isNaN($))return new Date(NaN)}else{const ne=new Date(U+W),Y=new Date(0);return Y.setFullYear(ne.getUTCFullYear(),ne.getUTCMonth(),ne.getUTCDate()),Y.setHours(ne.getUTCHours(),ne.getUTCMinutes(),ne.getUTCSeconds(),ne.getUTCMilliseconds()),Y}return new Date(U+W+$)}const t={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},r=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,s=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,a=/^([+-])(\d{2})(?::?(\d{2}))?$/;function o(O){const I={},q=O.split(t.dateTimeDelimiter);let F;if(q.length>2)return I;if(/:/.test(q[0])?F=q[0]:(I.date=q[0],F=q[1],t.timeZoneDelimiter.test(I.date)&&(I.date=O.split(t.timeZoneDelimiter)[0],F=O.substr(I.date.length,O.length))),F){const V=t.timezone.exec(F);V?(I.time=F.replace(V[1],""),I.timezone=V[1]):I.time=F}return I}function l(O,I){const q=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+I)+"})|(\\d{2}|[+-]\\d{"+(2+I)+"})$)"),F=O.match(q);if(!F)return{year:NaN,restDateString:""};const V=F[1]?parseInt(F[1]):null,U=F[2]?parseInt(F[2]):null;return{year:U===null?V:U*100,restDateString:O.slice((F[1]||F[2]).length)}}function c(O,I){if(I===null)return new Date(NaN);const q=O.match(r);if(!q)return new Date(NaN);const F=!!q[4],V=d(q[1]),U=d(q[2])-1,W=d(q[3]),$=d(q[4]),ne=d(q[5])-1;if(F)return P(I,$,ne)?v(I,$,ne):new Date(NaN);{const Y=new Date(0);return!j(I,U,W)||!T(I,V)?new Date(NaN):(Y.setUTCFullYear(I,U,Math.max(V,W)),Y)}}function d(O){return O?parseInt(O):1}function h(O){const I=O.match(s);if(!I)return NaN;const q=p(I[1]),F=p(I[2]),V=p(I[3]);return D(q,F,V)?q*n.millisecondsInHour+F*n.millisecondsInMinute+V*1e3:NaN}function p(O){return O&&parseFloat(O.replace(",","."))||0}function x(O){if(O==="Z")return 0;const I=O.match(a);if(!I)return 0;const q=I[1]==="+"?-1:1,F=parseInt(I[2]),V=I[3]&&parseInt(I[3])||0;return M(F,V)?q*(F*n.millisecondsInHour+V*n.millisecondsInMinute):NaN}function v(O,I,q){const F=new Date(0);F.setUTCFullYear(O,0,4);const V=F.getUTCDay()||7,U=(I-1)*7+q+1-V;return F.setUTCDate(F.getUTCDate()+U),F}const w=[31,null,31,30,31,30,31,31,30,31,30,31];function _(O){return O%400===0||O%4===0&&O%100!==0}function j(O,I,q){return I>=0&&I<=11&&q>=1&&q<=(w[I]||(_(O)?29:28))}function T(O,I){return I>=1&&I<=(_(O)?366:365)}function P(O,I,q){return I>=1&&I<=53&&q>=0&&q<=6}function D(O,I,q){return O===24?I===0&&q===0:q>=0&&q<60&&I>=0&&I<60&&O>=0&&O<25}function M(O,I){return I>=0&&I<=59}return kj}var Pj={},mA;function nre(){if(mA)return Pj;mA=1,Pj.parseJSON=n;function n(e){const t=e.match(/(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})(?:\.(\d{0,7}))?(?:Z|(.)(\d{2}):?(\d{2})?)?/);return t?new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4]-(+t[9]||0)*(t[8]=="-"?-1:1),+t[5]-(+t[10]||0)*(t[8]=="-"?-1:1),+t[6],+((t[7]||"0")+"00").substring(0,3))):new Date(NaN)}return Pj}var Mj={},pA;function ad(){if(pA)return Mj;pA=1,Mj.previousDay=t;var n=jy(),e=Sy();function t(r,s){let a=(0,n.getDay)(r)-s;return a<=0&&(a+=7),(0,e.subDays)(r,a)}return Mj}var Ej={},gA;function rre(){if(gA)return Ej;gA=1,Ej.previousFriday=e;var n=ad();function e(t){return(0,n.previousDay)(t,5)}return Ej}var Dj={},xA;function sre(){if(xA)return Dj;xA=1,Dj.previousMonday=e;var n=ad();function e(t){return(0,n.previousDay)(t,1)}return Dj}var Oj={},yA;function ire(){if(yA)return Oj;yA=1,Oj.previousSaturday=e;var n=ad();function e(t){return(0,n.previousDay)(t,6)}return Oj}var Ij={},vA;function are(){if(vA)return Ij;vA=1,Ij.previousSunday=e;var n=ad();function e(t){return(0,n.previousDay)(t,0)}return Ij}var Aj={},bA;function ore(){if(bA)return Aj;bA=1,Aj.previousThursday=e;var n=ad();function e(t){return(0,n.previousDay)(t,4)}return Aj}var Rj={},wA;function lre(){if(wA)return Rj;wA=1,Rj.previousTuesday=e;var n=ad();function e(t){return(0,n.previousDay)(t,2)}return Rj}var Lj={},_A;function cre(){if(_A)return Lj;_A=1,Lj.previousWednesday=e;var n=ad();function e(t){return(0,n.previousDay)(t,3)}return Lj}var Fj={},jA;function dre(){if(jA)return Fj;jA=1,Fj.quartersToMonths=e;var n=Qt();function e(t){return Math.trunc(t*n.monthsInQuarter)}return Fj}var qj={},NA;function ure(){if(NA)return qj;NA=1,qj.quartersToYears=e;var n=Qt();function e(t){const r=t/n.quartersInYear;return Math.trunc(r)}return qj}var zj={},SA;function fre(){if(SA)return zj;SA=1,zj.roundToNearestHours=r;var n=sd(),e=un(),t=Re();function r(s,a){const o=a?.nearestTo??1;if(o<1||o>12)return(0,e.constructFrom)(s,NaN);const l=(0,t.toDate)(s),c=l.getMinutes()/60,d=l.getSeconds()/60/60,h=l.getMilliseconds()/1e3/60/60,p=l.getHours()+c+d+h,x=a?.roundingMethod??"round",w=(0,n.getRoundingMethod)(x)(p/o)*o,_=(0,e.constructFrom)(s,l);return _.setHours(w,0,0,0),_}return zj}var Uj={},CA;function hre(){if(CA)return Uj;CA=1,Uj.roundToNearestMinutes=r;var n=sd(),e=un(),t=Re();function r(s,a){const o=a?.nearestTo??1;if(o<1||o>30)return(0,e.constructFrom)(s,NaN);const l=(0,t.toDate)(s),c=l.getSeconds()/60,d=l.getMilliseconds()/1e3/60,h=l.getMinutes()+c+d,p=a?.roundingMethod??"round",v=(0,n.getRoundingMethod)(p)(h/o)*o,w=(0,e.constructFrom)(s,l);return w.setMinutes(v,0,0),w}return Uj}var Vj={},TA;function mre(){if(TA)return Vj;TA=1,Vj.secondsToHours=e;var n=Qt();function e(t){const r=t/n.secondsInHour;return Math.trunc(r)}return Vj}var Bj={},kA;function pre(){if(kA)return Bj;kA=1,Bj.secondsToMilliseconds=e;var n=Qt();function e(t){return t*n.millisecondsInSecond}return Bj}var Wj={},PA;function gre(){if(PA)return Wj;PA=1,Wj.secondsToMinutes=e;var n=Qt();function e(t){const r=t/n.secondsInMinute;return Math.trunc(r)}return Wj}var $j={},Hj={},MA;function o1(){if(MA)return Hj;MA=1,Hj.setMonth=r;var n=un(),e=E5(),t=Re();function r(s,a){const o=(0,t.toDate)(s),l=o.getFullYear(),c=o.getDate(),d=(0,n.constructFrom)(s,0);d.setFullYear(l,a,15),d.setHours(0,0,0,0);const h=(0,e.getDaysInMonth)(d);return o.setMonth(a,Math.min(c,h)),o}return Hj}var EA;function xre(){if(EA)return $j;EA=1,$j.set=r;var n=un(),e=o1(),t=Re();function r(s,a){let o=(0,t.toDate)(s);return isNaN(+o)?(0,n.constructFrom)(s,NaN):(a.year!=null&&o.setFullYear(a.year),a.month!=null&&(o=(0,e.setMonth)(o,a.month)),a.date!=null&&o.setDate(a.date),a.hours!=null&&o.setHours(a.hours),a.minutes!=null&&o.setMinutes(a.minutes),a.seconds!=null&&o.setSeconds(a.seconds),a.milliseconds!=null&&o.setMilliseconds(a.milliseconds),o)}return $j}var Yj={},DA;function yre(){if(DA)return Yj;DA=1,Yj.setDate=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setDate(r),s}return Yj}var Gj={},OA;function vre(){if(OA)return Gj;OA=1,Gj.setDayOfYear=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setMonth(0),s.setDate(r),s}return Gj}var Zj={},IA;function bre(){if(IA)return Zj;IA=1,Zj.setDefaultOptions=e;var n=Cs();function e(t){const r={},s=(0,n.getDefaultOptions)();for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&(r[a]=s[a]);for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(t[a]===void 0?delete r[a]:r[a]=t[a]);(0,n.setDefaultOptions)(r)}return Zj}var Kj={},AA;function wre(){if(AA)return Kj;AA=1,Kj.setHours=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setHours(r),s}return Kj}var Jj={},RA;function _re(){if(RA)return Jj;RA=1,Jj.setMilliseconds=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setMilliseconds(r),s}return Jj}var Qj={},LA;function jre(){if(LA)return Qj;LA=1,Qj.setMinutes=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setMinutes(r),s}return Qj}var Xj={},FA;function Nre(){if(FA)return Xj;FA=1,Xj.setQuarter=t;var n=o1(),e=Re();function t(r,s){const a=(0,e.toDate)(r),o=Math.trunc(a.getMonth()/3)+1,l=s-o;return(0,n.setMonth)(a,a.getMonth()+l*3)}return Xj}var eN={},qA;function Sre(){if(qA)return eN;qA=1,eN.setSeconds=e;var n=Re();function e(t,r){const s=(0,n.toDate)(t);return s.setSeconds(r),s}return eN}var tN={},zA;function Cre(){if(zA)return tN;zA=1,tN.setWeekYear=a;var n=un(),e=nd(),t=s1(),r=Re(),s=Cs();function a(o,l,c){const d=(0,s.getDefaultOptions)(),h=c?.firstWeekContainsDate??c?.locale?.options?.firstWeekContainsDate??d.firstWeekContainsDate??d.locale?.options?.firstWeekContainsDate??1;let p=(0,r.toDate)(o);const x=(0,e.differenceInCalendarDays)(p,(0,t.startOfWeekYear)(p,c)),v=(0,n.constructFrom)(o,0);return v.setFullYear(l,0,h),v.setHours(0,0,0,0),p=(0,t.startOfWeekYear)(v,c),p.setDate(p.getDate()+x),p}return tN}var nN={},UA;function Tre(){if(UA)return nN;UA=1,nN.setYear=t;var n=un(),e=Re();function t(r,s){const a=(0,e.toDate)(r);return isNaN(+a)?(0,n.constructFrom)(r,NaN):(a.setFullYear(s),a)}return nN}var rN={},VA;function kre(){if(VA)return rN;VA=1,rN.startOfDecade=e;var n=Re();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=Math.floor(s/10)*10;return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}return rN}var sN={},BA;function Pre(){if(BA)return sN;BA=1,sN.startOfToday=e;var n=gy();function e(){return(0,n.startOfDay)(Date.now())}return sN}var iN={},WA;function Mre(){if(WA)return iN;WA=1,iN.startOfTomorrow=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s+1),a.setHours(0,0,0,0),a}return iN}var aN={},$A;function Ere(){if($A)return aN;$A=1,aN.startOfYesterday=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s-1),a.setHours(0,0,0,0),a}return aN}var oN={},lN={},HA;function Q5(){if(HA)return lN;HA=1,lN.subMonths=e;var n=Im();function e(t,r){return(0,n.addMonths)(t,-r)}return lN}var YA;function Dre(){if(YA)return oN;YA=1,oN.sub=r;var n=Sy(),e=Q5(),t=un();function r(s,a){const{years:o=0,months:l=0,weeks:c=0,days:d=0,hours:h=0,minutes:p=0,seconds:x=0}=a,v=(0,e.subMonths)(s,l+o*12),w=(0,n.subDays)(v,d+c*7),_=p+h*60,T=(x+_*60)*1e3;return(0,t.constructFrom)(s,w.getTime()-T)}return oN}var cN={},GA;function Ore(){if(GA)return cN;GA=1,cN.subBusinessDays=e;var n=i5();function e(t,r){return(0,n.addBusinessDays)(t,-r)}return cN}var dN={},ZA;function Ire(){if(ZA)return dN;ZA=1,dN.subHours=e;var n=VC();function e(t,r){return(0,n.addHours)(t,-r)}return dN}var uN={},KA;function Are(){if(KA)return uN;KA=1,uN.subMilliseconds=e;var n=Am();function e(t,r){return(0,n.addMilliseconds)(t,-r)}return uN}var fN={},JA;function Rre(){if(JA)return fN;JA=1,fN.subMinutes=e;var n=BC();function e(t,r){return(0,n.addMinutes)(t,-r)}return fN}var hN={},QA;function Lre(){if(QA)return hN;QA=1,hN.subQuarters=e;var n=WC();function e(t,r){return(0,n.addQuarters)(t,-r)}return hN}var mN={},XA;function Fre(){if(XA)return mN;XA=1,mN.subSeconds=e;var n=l5();function e(t,r){return(0,n.addSeconds)(t,-r)}return mN}var pN={},eR;function qre(){if(eR)return pN;eR=1,pN.subWeeks=e;var n=xy();function e(t,r){return(0,n.addWeeks)(t,-r)}return pN}var gN={},tR;function zre(){if(tR)return gN;tR=1,gN.subYears=e;var n=c5();function e(t,r){return(0,n.addYears)(t,-r)}return gN}var xN={},nR;function Ure(){if(nR)return xN;nR=1,xN.weeksToDays=e;var n=Qt();function e(t){return Math.trunc(t*n.daysInWeek)}return xN}var yN={},rR;function Vre(){if(rR)return yN;rR=1,yN.yearsToDays=e;var n=Qt();function e(t){return Math.trunc(t*n.daysInYear)}return yN}var vN={},sR;function Bre(){if(sR)return vN;sR=1,vN.yearsToMonths=e;var n=Qt();function e(t){return Math.trunc(t*n.monthsInYear)}return vN}var bN={},iR;function Wre(){if(iR)return bN;iR=1,bN.yearsToQuarters=e;var n=Qt();function e(t){return Math.trunc(t*n.quartersInYear)}return bN}var aR;function _u(){return aR||(aR=1,(function(n){var e=n5();Object.keys(e).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===e[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return e[g]}})});var t=i5();Object.keys(t).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===t[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return t[g]}})});var r=El();Object.keys(r).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===r[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return r[g]}})});var s=VC();Object.keys(s).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===s[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return s[g]}})});var a=o5();Object.keys(a).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===a[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return a[g]}})});var o=Am();Object.keys(o).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===o[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return o[g]}})});var l=BC();Object.keys(l).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===l[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return l[g]}})});var c=Im();Object.keys(c).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===c[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return c[g]}})});var d=WC();Object.keys(d).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===d[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return d[g]}})});var h=l5();Object.keys(h).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===h[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return h[g]}})});var p=xy();Object.keys(p).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===p[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return p[g]}})});var x=c5();Object.keys(x).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===x[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return x[g]}})});var v=hee();Object.keys(v).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===v[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return v[g]}})});var w=mee();Object.keys(w).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===w[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return w[g]}})});var _=pee();Object.keys(_).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _[g]}})});var j=gee();Object.keys(j).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===j[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return j[g]}})});var T=Wf();Object.keys(T).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===T[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return T[g]}})});var P=xee();Object.keys(P).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===P[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return P[g]}})});var D=un();Object.keys(D).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===D[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return D[g]}})});var M=Zs();Object.keys(M).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===M[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return M[g]}})});var O=yee();Object.keys(O).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===O[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return O[g]}})});var I=vee();Object.keys(I).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===I[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return I[g]}})});var q=nd();Object.keys(q).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===q[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return q[g]}})});var F=h5();Object.keys(F).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===F[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return F[g]}})});var V=bee();Object.keys(V).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===V[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return V[g]}})});var U=$C();Object.keys(U).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===U[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return U[g]}})});var W=p5();Object.keys(W).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===W[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return W[g]}})});var $=HC();Object.keys($).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $[g]}})});var ne=YC();Object.keys(ne).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ne[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ne[g]}})});var Y=GC();Object.keys(Y).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Y[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Y[g]}})});var ae=ZC();Object.keys(ae).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ae[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ae[g]}})});var J=wee();Object.keys(J).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===J[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return J[g]}})});var ee=yy();Object.keys(ee).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ee[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ee[g]}})});var X=KC();Object.keys(X).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===X[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return X[g]}})});var Z=vy();Object.keys(Z).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Z[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Z[g]}})});var oe=_ee();Object.keys(oe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oe[g]}})});var H=by();Object.keys(H).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===H[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return H[g]}})});var Q=jee();Object.keys(Q).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Q[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Q[g]}})});var re=y5();Object.keys(re).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===re[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return re[g]}})});var de=v5();Object.keys(de).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===de[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return de[g]}})});var ce=Nee();Object.keys(ce).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ce[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ce[g]}})});var pe=See();Object.keys(pe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pe[g]}})});var ie=Cee();Object.keys(ie).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ie[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ie[g]}})});var xe=Tee();Object.keys(xe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xe[g]}})});var Ce=kee();Object.keys(Ce).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ce[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ce[g]}})});var ve=t1();Object.keys(ve).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ve[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ve[g]}})});var Oe=Pee();Object.keys(Oe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oe[g]}})});var Pe=Mee();Object.keys(Pe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pe[g]}})});var Ie=Eee();Object.keys(Ie).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ie[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ie[g]}})});var Fe=JC();Object.keys(Fe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fe[g]}})});var we=Dee();Object.keys(we).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===we[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return we[g]}})});var Ne=Oee();Object.keys(Ne).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ne[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ne[g]}})});var Ue=Iee();Object.keys(Ue).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ue[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ue[g]}})});var Be=Aee();Object.keys(Be).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Be[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Be[g]}})});var qe=Ree();Object.keys(qe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qe[g]}})});var te=QC();Object.keys(te).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===te[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return te[g]}})});var le=Lee();Object.keys(le).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===le[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return le[g]}})});var ye=Fee();Object.keys(ye).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ye[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ye[g]}})});var Ve=qee();Object.keys(Ve).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ve[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ve[g]}})});var ze=zee();Object.keys(ze).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ze[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ze[g]}})});var Le=w5();Object.keys(Le).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Le[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Le[g]}})});var rt=b5();Object.keys(rt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===rt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return rt[g]}})});var Xe=Uee();Object.keys(Xe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xe[g]}})});var tt=T5();Object.keys(tt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===tt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return tt[g]}})});var qt=k5();Object.keys(qt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qt[g]}})});var bt=P5();Object.keys(bt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bt[g]}})});var Et=Qee();Object.keys(Et).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Et[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Et[g]}})});var Xt=Xee();Object.keys(Xt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xt[g]}})});var en=ete();Object.keys(en).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===en[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return en[g]}})});var Yt=tte();Object.keys(Yt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yt[g]}})});var Ut=nte();Object.keys(Ut).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ut[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ut[g]}})});var Rn=rte();Object.keys(Rn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rn[g]}})});var Nn=ste();Object.keys(Nn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Nn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Nn[g]}})});var an=ite();Object.keys(an).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===an[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return an[g]}})});var rr=ate();Object.keys(rr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===rr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return rr[g]}})});var Hn=ote();Object.keys(Hn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Hn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Hn[g]}})});var lt=M5();Object.keys(lt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===lt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return lt[g]}})});var Vn=jy();Object.keys(Vn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vn[g]}})});var br=j5();Object.keys(br).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===br[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return br[g]}})});var vn=E5();Object.keys(vn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vn[g]}})});var us=lte();Object.keys(us).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===us[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return us[g]}})});var Ks=cte();Object.keys(Ks).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ks[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ks[g]}})});var Gr=O5();Object.keys(Gr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gr[g]}})});var Xi=dte();Object.keys(Xi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xi[g]}})});var La=I5();Object.keys(La).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===La[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return La[g]}})});var ea=r1();Object.keys(ea).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ea[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ea[g]}})});var Po=wu();Object.keys(Po).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Po[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Po[g]}})});var ta=ute();Object.keys(ta).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ta[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ta[g]}})});var cd=fte();Object.keys(cd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===cd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return cd[g]}})});var dr=hte();Object.keys(dr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dr[g]}})});var dt=mte();Object.keys(dt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dt[g]}})});var na=pte();Object.keys(na).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===na[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return na[g]}})});var Fa=m5();Object.keys(Fa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fa[g]}})});var Ol=gte();Object.keys(Ol).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ol[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ol[g]}})});var Il=xte();Object.keys(Il).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Il[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Il[g]}})});var Mo=yte();Object.keys(Mo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mo[g]}})});var ks=i1();Object.keys(ks).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ks[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ks[g]}})});var Js=vte();Object.keys(Js).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Js[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Js[g]}})});var Eo=_y();Object.keys(Eo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Eo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Eo[g]}})});var dd=bte();Object.keys(dd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dd[g]}})});var Al=wte();Object.keys(Al).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Al[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Al[g]}})});var Rl=_te();Object.keys(Rl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rl[g]}})});var Ll=jte();Object.keys(Ll).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ll[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ll[g]}})});var Do=Nte();Object.keys(Do).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Do[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Do[g]}})});var ud=Ste();Object.keys(ud).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ud[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ud[g]}})});var qa=Cte();Object.keys(qa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qa[g]}})});var Cn=Tte();Object.keys(Cn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Cn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Cn[g]}})});var fd=kte();Object.keys(fd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fd[g]}})});var Oo=Pte();Object.keys(Oo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oo[g]}})});var Fl=Mte();Object.keys(Fl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fl[g]}})});var za=f5();Object.keys(za).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===za[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return za[g]}})});var Io=Ete();Object.keys(Io).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Io[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Io[g]}})});var bi=Dte();Object.keys(bi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bi[g]}})});var ra=Ote();Object.keys(ra).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ra[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ra[g]}})});var Rr=Ite();Object.keys(Rr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rr[g]}})});var sa=Ate();Object.keys(sa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===sa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return sa[g]}})});var Dt=x5();Object.keys(Dt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Dt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Dt[g]}})});var bn=D5();Object.keys(bn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bn[g]}})});var Ua=mne();Object.keys(Ua).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ua[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ua[g]}})});var wi=pne();Object.keys(wi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wi[g]}})});var fs=gne();Object.keys(fs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fs[g]}})});var _i=Lm();Object.keys(_i).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_i[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _i[g]}})});var Mt=B5();Object.keys(Mt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mt[g]}})});var gn=W5();Object.keys(gn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gn[g]}})});var Ao=xne();Object.keys(Ao).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ao[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ao[g]}})});var Va=$5();Object.keys(Va).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Va[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Va[g]}})});var ur=H5();Object.keys(ur).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ur[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ur[g]}})});var ql=Y5();Object.keys(ql).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ql[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ql[g]}})});var ji=Z5();Object.keys(ji).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ji[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ji[g]}})});var Lr=a1();Object.keys(Lr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Lr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Lr[g]}})});var Dn=K5();Object.keys(Dn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Dn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Dn[g]}})});var hs=r5();Object.keys(hs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hs[g]}})});var Kt=s5();Object.keys(Kt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Kt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Kt[g]}})});var Ni=yne();Object.keys(Ni).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ni[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ni[g]}})});var Ba=vne();Object.keys(Ba).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ba[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ba[g]}})});var Qs=bne();Object.keys(Qs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qs[g]}})});var Wa=wne();Object.keys(Wa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wa[g]}})});var $a=_ne();Object.keys($a).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$a[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $a[g]}})});var ia=jne();Object.keys(ia).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ia[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ia[g]}})});var aa=Nne();Object.keys(aa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===aa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return aa[g]}})});var Si=Sne();Object.keys(Si).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Si[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Si[g]}})});var Fr=Cne();Object.keys(Fr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fr[g]}})});var ms=Tne();Object.keys(ms).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ms[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ms[g]}})});var Zr=kne();Object.keys(Zr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zr[g]}})});var oa=Pne();Object.keys(oa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oa[g]}})});var Ct=rd();Object.keys(Ct).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ct[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ct[g]}})});var Yn=Mne();Object.keys(Yn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yn[g]}})});var ln=py();Object.keys(ln).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ln[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ln[g]}})});var Ro=Ene();Object.keys(Ro).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ro[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ro[g]}})});var Xs=Dne();Object.keys(Xs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xs[g]}})});var Lo=One();Object.keys(Lo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Lo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Lo[g]}})});var Ha=Ine();Object.keys(Ha).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ha[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ha[g]}})});var Kr=Ane();Object.keys(Kr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Kr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Kr[g]}})});var Ya=A5();Object.keys(Ya).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ya[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ya[g]}})});var la=Rne();Object.keys(la).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===la[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return la[g]}})});var Tn=J5();Object.keys(Tn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Tn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Tn[g]}})});var qr=Lne();Object.keys(qr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qr[g]}})});var ei=Fne();Object.keys(ei).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ei[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ei[g]}})});var ca=d5();Object.keys(ca).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ca[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ca[g]}})});var hd=qne();Object.keys(hd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hd[g]}})});var zl=zne();Object.keys(zl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zl[g]}})});var da=Une();Object.keys(da).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===da[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return da[g]}})});var Ga=Vne();Object.keys(Ga).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ga[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ga[g]}})});var Za=u5();Object.keys(Za).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Za[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Za[g]}})});var Ht=Bne();Object.keys(Ht).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ht[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ht[g]}})});var Ps=Wne();Object.keys(Ps).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ps[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ps[g]}})});var wr=$ne();Object.keys(wr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wr[g]}})});var Ms=Hne();Object.keys(Ms).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ms[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ms[g]}})});var Fo=Yne();Object.keys(Fo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fo[g]}})});var Ka=id();Object.keys(Ka).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ka[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ka[g]}})});var Ci=Gne();Object.keys(Ci).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ci[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ci[g]}})});var Ul=Zne();Object.keys(Ul).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ul[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ul[g]}})});var fr=Kne();Object.keys(fr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fr[g]}})});var Ti=Jne();Object.keys(Ti).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ti[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ti[g]}})});var qo=Qne();Object.keys(qo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qo[g]}})});var ti=Xne();Object.keys(ti).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ti[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ti[g]}})});var md=ere();Object.keys(md).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===md[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return md[g]}})});var Mr=U5();Object.keys(Mr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mr[g]}})});var zo=tre();Object.keys(zo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zo[g]}})});var ki=nre();Object.keys(ki).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ki[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ki[g]}})});var zr=ad();Object.keys(zr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zr[g]}})});var Uo=rre();Object.keys(Uo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Uo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Uo[g]}})});var Vl=sre();Object.keys(Vl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vl[g]}})});var Vo=ire();Object.keys(Vo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vo[g]}})});var pd=are();Object.keys(pd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pd[g]}})});var Ja=ore();Object.keys(Ja).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ja[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ja[g]}})});var Bl=lre();Object.keys(Bl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bl[g]}})});var gd=cre();Object.keys(gd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gd[g]}})});var xd=dre();Object.keys(xd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xd[g]}})});var Bo=ure();Object.keys(Bo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bo[g]}})});var yd=fre();Object.keys(yd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===yd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return yd[g]}})});var Wo=hre();Object.keys(Wo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wo[g]}})});var Wl=mre();Object.keys(Wl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wl[g]}})});var Qa=pre();Object.keys(Qa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qa[g]}})});var ni=gre();Object.keys(ni).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ni[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ni[g]}})});var vd=xre();Object.keys(vd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vd[g]}})});var ri=yre();Object.keys(ri).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ri[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ri[g]}})});var Er=Ny();Object.keys(Er).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Er[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Er[g]}})});var $l=vre();Object.keys($l).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$l[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $l[g]}})});var Hl=bre();Object.keys(Hl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Hl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Hl[g]}})});var Yl=wre();Object.keys(Yl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yl[g]}})});var $o=z5();Object.keys($o).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$o[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $o[g]}})});var Ho=q5();Object.keys(Ho).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ho[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ho[g]}})});var bd=a5();Object.keys(bd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bd[g]}})});var wd=_re();Object.keys(wd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wd[g]}})});var Gl=jre();Object.keys(Gl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gl[g]}})});var _d=o1();Object.keys(_d).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_d[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _d[g]}})});var Ur=Nre();Object.keys(Ur).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ur[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ur[g]}})});var Es=Sre();Object.keys(Es).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Es[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Es[g]}})});var ua=F5();Object.keys(ua).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ua[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ua[g]}})});var ps=Cre();Object.keys(ps).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ps[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ps[g]}})});var Zl=Tre();Object.keys(Zl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zl[g]}})});var si=gy();Object.keys(si).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===si[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return si[g]}})});var Kl=kre();Object.keys(Kl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Kl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Kl[g]}})});var Pi=V5();Object.keys(Pi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pi[g]}})});var Yo=Dl();Object.keys(Yo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yo[g]}})});var gs=Rm();Object.keys(gs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gs[g]}})});var jd=XC();Object.keys(jd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===jd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return jd[g]}})});var Ds=wy();Object.keys(Ds).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ds[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ds[g]}})});var Xa=e1();Object.keys(Xa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xa[g]}})});var Jl=G5();Object.keys(Jl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jl[g]}})});var eo=Pre();Object.keys(eo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===eo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return eo[g]}})});var fa=Mre();Object.keys(fa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fa[g]}})});var _r=ko();Object.keys(_r).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_r[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _r[g]}})});var Nd=s1();Object.keys(Nd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Nd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Nd[g]}})});var xs=n1();Object.keys(xs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xs[g]}})});var Sd=Ere();Object.keys(Sd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Sd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Sd[g]}})});var Jr=Dre();Object.keys(Jr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jr[g]}})});var Mi=Ore();Object.keys(Mi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mi[g]}})});var to=Sy();Object.keys(to).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===to[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return to[g]}})});var no=Ire();Object.keys(no).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===no[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return no[g]}})});var ha=g5();Object.keys(ha).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ha[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ha[g]}})});var ro=Are();Object.keys(ro).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ro[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ro[g]}})});var so=Rre();Object.keys(so).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===so[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return so[g]}})});var Ei=Q5();Object.keys(Ei).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ei[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ei[g]}})});var io=Lre();Object.keys(io).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===io[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return io[g]}})});var Go=Fre();Object.keys(Go).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Go[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Go[g]}})});var Ql=qre();Object.keys(Ql).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ql[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ql[g]}})});var Vr=zre();Object.keys(Vr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vr[g]}})});var Os=Re();Object.keys(Os).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Os[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Os[g]}})});var Xl=R5();Object.keys(Xl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xl[g]}})});var Zo=Ure();Object.keys(Zo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zo[g]}})});var ec=Vre();Object.keys(ec).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ec[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ec[g]}})});var Ko=Bre();Object.keys(Ko).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ko[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ko[g]}})});var Jo=Wre();Object.keys(Jo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jo[g]}})})})(Lb)),Lb}var oR;function Cy(){if(oR)return Bd;oR=1,Object.defineProperty(Bd,"__esModule",{value:!0}),Bd.rangeShape=Bd.default=void 0;var n=o(Gs()),e=s(Ml()),t=s(bu()),r=_u();function s(v){return v&&v.__esModule?v:{default:v}}function a(v){if(typeof WeakMap!="function")return null;var w=new WeakMap,_=new WeakMap;return(a=function(j){return j?_:w})(v)}function o(v,w){if(v&&v.__esModule)return v;if(v===null||typeof v!="object"&&typeof v!="function")return{default:v};var _=a(w);if(_&&_.has(v))return _.get(v);var j={__proto__:null},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in v)if(P!=="default"&&Object.prototype.hasOwnProperty.call(v,P)){var D=T?Object.getOwnPropertyDescriptor(v,P):null;D&&(D.get||D.set)?Object.defineProperty(j,P,D):j[P]=v[P]}return j.default=v,_&&_.set(v,j),j}function l(){return l=Object.assign?Object.assign.bind():function(v){for(var w=1;w<arguments.length;w++){var _=arguments[w];for(var j in _)Object.prototype.hasOwnProperty.call(_,j)&&(v[j]=_[j])}return v},l.apply(this,arguments)}function c(v,w,_){return w=d(w),w in v?Object.defineProperty(v,w,{value:_,enumerable:!0,configurable:!0,writable:!0}):v[w]=_,v}function d(v){var w=h(v,"string");return typeof w=="symbol"?w:String(w)}function h(v,w){if(typeof v!="object"||!v)return v;var _=v[Symbol.toPrimitive];if(_!==void 0){var j=_.call(v,w);if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(w==="string"?String:Number)(v)}let p=class extends n.Component{constructor(w,_){super(w,_),c(this,"handleKeyEvent",j=>{const{day:T,onMouseDown:P,onMouseUp:D}=this.props;[13,32].includes(j.keyCode)&&(j.type==="keydown"?P(T):D(T))}),c(this,"handleMouseEvent",j=>{const{day:T,disabled:P,onPreviewChange:D,onMouseEnter:M,onMouseDown:O,onMouseUp:I}=this.props,q={};if(P){D();return}switch(j.type){case"mouseenter":M(T),D(T),q.hover=!0;break;case"blur":case"mouseleave":q.hover=!1;break;case"mousedown":q.active=!0,O(T);break;case"mouseup":j.stopPropagation(),q.active=!1,I(T);break;case"focus":D(T);break}Object.keys(q).length&&this.setState(q)}),c(this,"getClassNames",()=>{const{isPassive:j,isToday:T,isWeekend:P,isStartOfWeek:D,isEndOfWeek:M,isStartOfMonth:O,isEndOfMonth:I,disabled:q,styles:F}=this.props;return(0,t.default)(F.day,{[F.dayPassive]:j,[F.dayDisabled]:q,[F.dayToday]:T,[F.dayWeekend]:P,[F.dayStartOfWeek]:D,[F.dayEndOfWeek]:M,[F.dayStartOfMonth]:O,[F.dayEndOfMonth]:I,[F.dayHovered]:this.state.hover,[F.dayActive]:this.state.active})}),c(this,"renderPreviewPlaceholder",()=>{const{preview:j,day:T,styles:P}=this.props;if(!j)return null;const D=j.startDate?(0,r.endOfDay)(j.startDate):null,M=j.endDate?(0,r.startOfDay)(j.endDate):null,O=(!D||(0,r.isAfter)(T,D))&&(!M||(0,r.isBefore)(T,M)),I=!O&&(0,r.isSameDay)(T,D),q=!O&&(0,r.isSameDay)(T,M);return n.default.createElement("span",{className:(0,t.default)({[P.dayStartPreview]:I,[P.dayInPreview]:O,[P.dayEndPreview]:q}),style:{color:j.color}})}),c(this,"renderSelectionPlaceholders",()=>{const{styles:j,ranges:T,day:P}=this.props;return this.props.displayMode==="date"?(0,r.isSameDay)(this.props.day,this.props.date)?n.default.createElement("span",{className:j.selected,style:{color:this.props.color}}):null:T.reduce((M,O)=>{let I=O.startDate,q=O.endDate;I&&q&&(0,r.isBefore)(q,I)&&([I,q]=[q,I]),I=I?(0,r.endOfDay)(I):null,q=q?(0,r.startOfDay)(q):null;const F=(!I||(0,r.isAfter)(P,I))&&(!q||(0,r.isBefore)(P,q)),V=!F&&(0,r.isSameDay)(P,I),U=!F&&(0,r.isSameDay)(P,q);return F||V||U?[...M,{isStartEdge:V,isEndEdge:U,isInRange:F,...O}]:M},[]).map((M,O)=>n.default.createElement("span",{key:O,className:(0,t.default)({[j.startEdge]:M.isStartEdge,[j.endEdge]:M.isEndEdge,[j.inRange]:M.isInRange}),style:{color:M.color||this.props.color}}))}),this.state={hover:!1,active:!1}}render(){const{dayContentRenderer:w}=this.props;return n.default.createElement("button",l({type:"button",onMouseEnter:this.handleMouseEvent,onMouseLeave:this.handleMouseEvent,onFocus:this.handleMouseEvent,onMouseDown:this.handleMouseEvent,onMouseUp:this.handleMouseEvent,onBlur:this.handleMouseEvent,onPauseCapture:this.handleMouseEvent,onKeyDown:this.handleKeyEvent,onKeyUp:this.handleKeyEvent,className:this.getClassNames(this.props.styles)},this.props.disabled||this.props.isPassive?{tabIndex:-1}:{},{style:{color:this.props.color}}),this.renderSelectionPlaceholders(),this.renderPreviewPlaceholder(),n.default.createElement("span",{className:this.props.styles.dayNumber},w?.(this.props.day)||n.default.createElement("span",null,(0,r.format)(this.props.day,this.props.dayDisplayFormat))))}};p.defaultProps={};const x=Bd.rangeShape=e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string,key:e.default.string,autoFocus:e.default.bool,disabled:e.default.bool,showDateDisplay:e.default.bool});return p.propTypes={day:e.default.object.isRequired,dayDisplayFormat:e.default.string,date:e.default.object,ranges:e.default.arrayOf(x),preview:e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string}),onPreviewChange:e.default.func,previewColor:e.default.string,disabled:e.default.bool,isPassive:e.default.bool,isToday:e.default.bool,isWeekend:e.default.bool,isStartOfWeek:e.default.bool,isEndOfWeek:e.default.bool,isStartOfMonth:e.default.bool,isEndOfMonth:e.default.bool,color:e.default.string,displayMode:e.default.oneOf(["dateRange","date"]),styles:e.default.object,onMouseDown:e.default.func,onMouseUp:e.default.func,onMouseEnter:e.default.func,dayContentRenderer:e.default.func},Bd.default=p,Bd}var Th={},Wd={},lR;function Ty(){if(lR)return Wd;lR=1,Object.defineProperty(Wd,"__esModule",{value:!0}),Wd.calcFocusDate=r,Wd.findNextRangeIndex=s,Wd.generateStyles=o,Wd.getMonthDisplayRange=a;var n=t(bu()),e=_u();function t(l){return l&&l.__esModule?l:{default:l}}function r(l,c){const{shownDate:d,date:h,months:p,ranges:x,focusedRange:v,displayMode:w}=c;let _;if(w==="dateRange"){const T=x[v[0]]||{};_={start:T.startDate,end:T.endDate}}else _={start:h,end:h};_.start=(0,e.startOfMonth)(_.start||new Date),_.end=(0,e.endOfMonth)(_.end||_.start);const j=_.start||_.end||d||new Date;return l?(0,e.differenceInCalendarMonths)(_.start,_.end)>p?l:j:d||j}function s(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const d=l.findIndex((h,p)=>p>c&&h.autoFocus!==!1&&!h.disabled);return d!==-1?d:l.findIndex(h=>h.autoFocus!==!1&&!h.disabled)}function a(l,c,d){const h=(0,e.startOfMonth)(l,c),p=(0,e.endOfMonth)(l,c),x=(0,e.startOfWeek)(h,c);let v=(0,e.endOfWeek)(p,c);return d&&(0,e.differenceInCalendarDays)(v,x)<=34&&(v=(0,e.addDays)(v,7)),{start:x,end:v,startDateOfMonth:h,endDateOfMonth:p}}function o(l){return l.length?l.filter(d=>!!d).reduce((d,h)=>(Object.keys(h).forEach(p=>{d[p]=(0,n.default)(d[p],h[p])}),d),{}):{}}return Wd}var cR;function $re(){if(cR)return Th;cR=1,Object.defineProperty(Th,"__esModule",{value:!0}),Th.default=void 0;var n=l(Gs()),e=a(Ml()),t=l(Cy()),r=_u(),s=Ty();function a(p){return p&&p.__esModule?p:{default:p}}function o(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(o=function(w){return w?v:x})(p)}function l(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=o(x);if(v&&v.has(p))return v.get(p);var w={__proto__:null},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var T=_?Object.getOwnPropertyDescriptor(p,j):null;T&&(T.get||T.set)?Object.defineProperty(w,j,T):w[j]=p[j]}return w.default=p,v&&v.set(p,w),w}function c(){return c=Object.assign?Object.assign.bind():function(p){for(var x=1;x<arguments.length;x++){var v=arguments[x];for(var w in v)Object.prototype.hasOwnProperty.call(v,w)&&(p[w]=v[w])}return p},c.apply(this,arguments)}function d(p,x,v){const w=new Date;return n.default.createElement("div",{className:p.weekDays},(0,r.eachDayOfInterval)({start:(0,r.startOfWeek)(w,x),end:(0,r.endOfWeek)(w,x)}).map((_,j)=>n.default.createElement("span",{className:p.weekDay,key:j},(0,r.format)(_,v,x))))}let h=class extends n.PureComponent{render(){const x=new Date,{displayMode:v,focusedRange:w,drag:_,styles:j,disabledDates:T,disabledDay:P}=this.props,D=this.props.minDate&&(0,r.startOfDay)(this.props.minDate),M=this.props.maxDate&&(0,r.endOfDay)(this.props.maxDate),O=(0,s.getMonthDisplayRange)(this.props.month,this.props.dateOptions,this.props.fixedHeight);let I=this.props.ranges;if(v==="dateRange"&&_.status){let{startDate:F,endDate:V}=_.range;I=I.map((U,W)=>W!==w[0]?U:{...U,startDate:F,endDate:V})}const q=this.props.showPreview&&!_.disablePreview;return n.default.createElement("div",{className:j.month,style:this.props.style},this.props.showMonthName?n.default.createElement("div",{className:j.monthName},(0,r.format)(this.props.month,this.props.monthDisplayFormat,this.props.dateOptions)):null,this.props.showWeekDays&&d(j,this.props.dateOptions,this.props.weekdayDisplayFormat),n.default.createElement("div",{className:j.days,onMouseLeave:this.props.onMouseLeave},(0,r.eachDayOfInterval)({start:O.start,end:O.end}).map((F,V)=>{const U=(0,r.isSameDay)(F,O.startDateOfMonth),W=(0,r.isSameDay)(F,O.endDateOfMonth),$=D&&(0,r.isBefore)(F,D)||M&&(0,r.isAfter)(F,M),ne=T.some(ae=>(0,r.isSameDay)(ae,F)),Y=P(F);return n.default.createElement(t.default,c({},this.props,{ranges:I,day:F,preview:q?this.props.preview:null,isWeekend:(0,r.isWeekend)(F,this.props.dateOptions),isToday:(0,r.isSameDay)(F,x),isStartOfWeek:(0,r.isSameDay)(F,(0,r.startOfWeek)(F,this.props.dateOptions)),isEndOfWeek:(0,r.isSameDay)(F,(0,r.endOfWeek)(F,this.props.dateOptions)),isStartOfMonth:U,isEndOfMonth:W,key:V,disabled:$||ne||Y,isPassive:!(0,r.isWithinInterval)(F,{start:O.startDateOfMonth,end:O.endDateOfMonth}),styles:j,onMouseDown:this.props.onDragSelectionStart,onMouseUp:this.props.onDragSelectionEnd,onMouseEnter:this.props.onDragSelectionMove,dragRange:_.range,drag:_.status}))})))}};return h.defaultProps={},h.propTypes={style:e.default.object,styles:e.default.object,month:e.default.object,drag:e.default.object,dateOptions:e.default.object,disabledDates:e.default.array,disabledDay:e.default.func,preview:e.default.shape({startDate:e.default.object,endDate:e.default.object}),showPreview:e.default.bool,displayMode:e.default.oneOf(["dateRange","date"]),minDate:e.default.object,maxDate:e.default.object,ranges:e.default.arrayOf(t.rangeShape),focusedRange:e.default.arrayOf(e.default.number),onDragSelectionStart:e.default.func,onDragSelectionEnd:e.default.func,onDragSelectionMove:e.default.func,onMouseLeave:e.default.func,monthDisplayFormat:e.default.string,weekdayDisplayFormat:e.default.string,dayDisplayFormat:e.default.string,showWeekDays:e.default.bool,showMonthName:e.default.bool,fixedHeight:e.default.bool},Th.default=h,Th}var kh={},dR;function Hre(){if(dR)return kh;dR=1,Object.defineProperty(kh,"__esModule",{value:!0}),kh.default=void 0;var n=o(Gs()),e=s(Ml()),t=s(bu()),r=_u();function s(p){return p&&p.__esModule?p:{default:p}}function a(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(a=function(w){return w?v:x})(p)}function o(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=a(x);if(v&&v.has(p))return v.get(p);var w={__proto__:null},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var T=_?Object.getOwnPropertyDescriptor(p,j):null;T&&(T.get||T.set)?Object.defineProperty(w,j,T):w[j]=p[j]}return w.default=p,v&&v.set(p,w),w}function l(p,x,v){return x=c(x),x in p?Object.defineProperty(p,x,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[x]=v,p}function c(p){var x=d(p,"string");return typeof x=="symbol"?x:String(x)}function d(p,x){if(typeof p!="object"||!p)return p;var v=p[Symbol.toPrimitive];if(v!==void 0){var w=v.call(p,x);if(typeof w!="object")return w;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(p)}let h=class extends n.PureComponent{constructor(x,v){super(x,v),l(this,"onKeyDown",w=>{const{value:_}=this.state;w.key==="Enter"&&this.update(_)}),l(this,"onChange",w=>{this.setState({value:w.target.value,changed:!0,invalid:!1})}),l(this,"onBlur",()=>{const{value:w}=this.state;this.update(w)}),this.state={invalid:!1,changed:!1,value:this.formatDate(x)}}componentDidUpdate(x){const{value:v}=x;(0,r.isEqual)(v,this.props.value)||this.setState({value:this.formatDate(this.props)})}formatDate(x){let{value:v,dateDisplayFormat:w,dateOptions:_}=x;return v&&(0,r.isValid)(v)?(0,r.format)(v,w,_):""}update(x){const{invalid:v,changed:w}=this.state;if(v||!w||!x)return;const{onChange:_,dateDisplayFormat:j,dateOptions:T}=this.props,P=(0,r.parse)(x,j,new Date,T);(0,r.isValid)(P)?this.setState({changed:!1},()=>_(P)):this.setState({invalid:!0})}render(){const{className:x,readOnly:v,placeholder:w,ariaLabel:_,disabled:j,onFocus:T}=this.props,{value:P,invalid:D}=this.state;return n.default.createElement("span",{className:(0,t.default)("rdrDateInput",x)},n.default.createElement("input",{readOnly:v,disabled:j,value:P,placeholder:w,"aria-label":_,onKeyDown:this.onKeyDown,onChange:this.onChange,onBlur:this.onBlur,onFocus:T}),D&&n.default.createElement("span",{className:"rdrWarning"},""))}};return h.propTypes={value:e.default.object,placeholder:e.default.string,disabled:e.default.bool,readOnly:e.default.bool,dateOptions:e.default.object,dateDisplayFormat:e.default.string,ariaLabel:e.default.string,className:e.default.string,onFocus:e.default.func.isRequired,onChange:e.default.func.isRequired},h.defaultProps={readOnly:!0,disabled:!1,dateDisplayFormat:"MMM D, YYYY"},kh.default=h,kh}var Lg={},uR;function Yre(){return uR||(uR=1,(function(n){(function(e,t){t(n,Gs(),r4())})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Lg,function(e,t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function s(Q){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(re){return typeof re}:function(re){return re&&typeof Symbol=="function"&&re.constructor===Symbol&&re!==Symbol.prototype?"symbol":typeof re},s(Q)}function a(Q,re){if(!(Q instanceof re))throw new TypeError("Cannot call a class as a function")}function o(Q,re){for(var de=0;de<re.length;de++){var ce=re[de];ce.enumerable=ce.enumerable||!1,ce.configurable=!0,"value"in ce&&(ce.writable=!0),Object.defineProperty(Q,P(ce.key),ce)}}function l(Q,re,de){return re&&o(Q.prototype,re),de&&o(Q,de),Object.defineProperty(Q,"prototype",{writable:!1}),Q}function c(Q,re,de){return re=x(re),d(Q,p()?Reflect.construct(re,de||[],x(Q).constructor):re.apply(Q,de))}function d(Q,re){if(re&&(s(re)=="object"||typeof re=="function"))return re;if(re!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(Q)}function h(Q){if(Q===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Q}function p(){try{var Q=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(p=function(){return!!Q})()}function x(Q){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(re){return re.__proto__||Object.getPrototypeOf(re)},x(Q)}function v(Q,re){if(typeof re!="function"&&re!==null)throw new TypeError("Super expression must either be null or a function");Q.prototype=Object.create(re&&re.prototype,{constructor:{value:Q,writable:!0,configurable:!0}}),Object.defineProperty(Q,"prototype",{writable:!1}),re&&w(Q,re)}function w(Q,re){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(de,ce){return de.__proto__=ce,de},w(Q,re)}function _(Q,re){var de=Object.keys(Q);if(Object.getOwnPropertySymbols){var ce=Object.getOwnPropertySymbols(Q);re&&(ce=ce.filter(function(pe){return Object.getOwnPropertyDescriptor(Q,pe).enumerable})),de.push.apply(de,ce)}return de}function j(Q){for(var re=1;re<arguments.length;re++){var de=arguments[re]!=null?arguments[re]:{};re%2?_(Object(de),!0).forEach(function(ce){T(Q,ce,de[ce])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(de)):_(Object(de)).forEach(function(ce){Object.defineProperty(Q,ce,Object.getOwnPropertyDescriptor(de,ce))})}return Q}function T(Q,re,de){return(re=P(re))in Q?Object.defineProperty(Q,re,{value:de,enumerable:!0,configurable:!0,writable:!0}):Q[re]=de,Q}function P(Q){var re=D(Q,"string");return s(re)=="symbol"?re:re+""}function D(Q,re){if(s(Q)!="object"||!Q)return Q;var de=Q[Symbol.toPrimitive];if(de!==void 0){var ce=de.call(Q,re);if(s(ce)!="object")return ce;throw new TypeError("@@toPrimitive must return a primitive value.")}return(re==="string"?String:Number)(Q)}var M={x:"clientWidth",y:"clientHeight"},O={x:"clientTop",y:"clientLeft"},I={x:"innerWidth",y:"innerHeight"},q={x:"offsetWidth",y:"offsetHeight"},F={x:"offsetLeft",y:"offsetTop"},V={x:"overflowX",y:"overflowY"},U={x:"scrollWidth",y:"scrollHeight"},W={x:"scrollLeft",y:"scrollTop"},$={x:"width",y:"height"},ne=function(){},Y=(function(){if(typeof window>"u")return!1;var Q=!1;try{document.createElement("div").addEventListener("test",ne,{get passive(){return Q=!0,!1}})}catch{}return Q})()?{passive:!0}:!1,ae="ReactList failed to reach a stable state.",J=40,ee=function(re,de){for(var ce in de)if(re[ce]!==de[ce])return!1;return!0},X=function(re){for(var de=re.props.axis,ce=re.getEl(),pe=V[de];ce=ce.parentElement;)switch(window.getComputedStyle(ce)[pe]){case"auto":case"scroll":case"overlay":return ce}return window},Z=function(re){var de=re.props.axis,ce=re.scrollParent;return ce===window?window[I[de]]:ce[M[de]]},oe=function(re,de){var ce=re.length,pe=re.minSize,ie=re.type,xe=de.from,Ce=de.size,ve=de.itemsPerRow;Ce=Math.max(Ce,pe);var Oe=Ce%ve;return Oe&&(Ce+=ve-Oe),Ce>ce&&(Ce=ce),xe=ie==="simple"||!xe?0:Math.max(Math.min(xe,ce-Ce),0),(Oe=xe%ve)&&(xe-=Oe,Ce+=Oe),xe===de.from&&Ce===de.size?de:j(j({},de),{},{from:xe,size:Ce})},H=e.default=(function(Q){function re(de){var ce;return a(this,re),ce=c(this,re,[de]),ce.state=oe(de,{itemsPerRow:1,from:de.initialIndex,size:0}),ce.cache={},ce.cachedScrollPosition=null,ce.prevPrevState={},ce.unstable=!1,ce.updateCounter=0,ce}return v(re,Q),l(re,[{key:"componentDidMount",value:function(){this.updateFrameAndClearCache=this.updateFrameAndClearCache.bind(this),window.addEventListener("resize",this.updateFrameAndClearCache),this.updateFrame(this.scrollTo.bind(this,this.props.initialIndex))}},{key:"componentDidUpdate",value:function(ce){var pe=this;if(this.props.axis!==ce.axis&&this.clearSizeCache(),!this.unstable){if(++this.updateCounter>J)return this.unstable=!0,console.error(ae);this.updateCounterTimeoutId||(this.updateCounterTimeoutId=setTimeout(function(){pe.updateCounter=0,delete pe.updateCounterTimeoutId},0)),this.updateFrame()}}},{key:"maybeSetState",value:function(ce,pe){if(ee(this.state,ce))return pe();this.setState(ce,pe)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateFrameAndClearCache),this.scrollParent.removeEventListener("scroll",this.updateFrameAndClearCache,Y),this.scrollParent.removeEventListener("mousewheel",ne,Y)}},{key:"getOffset",value:function(ce){var pe=this.props.axis,ie=ce[O[pe]]||0,xe=F[pe];do ie+=ce[xe]||0;while(ce=ce.offsetParent);return ie}},{key:"getEl",value:function(){return this.el||this.items}},{key:"getScrollPosition",value:function(){if(typeof this.cachedScrollPosition=="number")return this.cachedScrollPosition;var ce=this.scrollParent,pe=this.props.axis,ie=W[pe],xe=ce===window?document.body[ie]||document.documentElement[ie]:ce[ie],Ce=this.getScrollSize()-this.props.scrollParentViewportSizeGetter(this),ve=Math.max(0,Math.min(xe,Ce)),Oe=this.getEl();return this.cachedScrollPosition=this.getOffset(ce)+ve-this.getOffset(Oe),this.cachedScrollPosition}},{key:"setScroll",value:function(ce){var pe=this.scrollParent,ie=this.props.axis;if(ce+=this.getOffset(this.getEl()),pe===window)return window.scrollTo(0,ce);ce-=this.getOffset(this.scrollParent),pe[W[ie]]=ce}},{key:"getScrollSize",value:function(){var ce=this.scrollParent,pe=document,ie=pe.body,xe=pe.documentElement,Ce=U[this.props.axis];return ce===window?Math.max(ie[Ce],xe[Ce]):ce[Ce]}},{key:"hasDeterminateSize",value:function(){var ce=this.props,pe=ce.itemSizeGetter,ie=ce.type;return ie==="uniform"||pe}},{key:"getStartAndEnd",value:function(){var ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.threshold,pe=this.getScrollPosition(),ie=Math.max(0,pe-ce),xe=pe+this.props.scrollParentViewportSizeGetter(this)+ce;return this.hasDeterminateSize()&&(xe=Math.min(xe,this.getSpaceBefore(this.props.length))),{start:ie,end:xe}}},{key:"getItemSizeAndItemsPerRow",value:function(){var ce=this.props,pe=ce.axis,ie=ce.useStaticSize,xe=this.state,Ce=xe.itemSize,ve=xe.itemsPerRow;if(ie&&Ce&&ve)return{itemSize:Ce,itemsPerRow:ve};var Oe=this.items.children;if(!Oe.length)return{};var Pe=Oe[0],Ie=Pe[q[pe]],Fe=Math.abs(Ie-Ce);if((isNaN(Fe)||Fe>=1)&&(Ce=Ie),!Ce)return{};var we=F[pe],Ne=Pe[we];ve=1;for(var Ue=Oe[ve];Ue&&Ue[we]===Ne;Ue=Oe[ve])++ve;return{itemSize:Ce,itemsPerRow:ve}}},{key:"clearSizeCache",value:function(){this.cachedScrollPosition=null}},{key:"updateFrameAndClearCache",value:function(ce){return this.clearSizeCache(),this.updateFrame(ce)}},{key:"updateFrame",value:function(ce){switch(this.updateScrollParent(),typeof ce!="function"&&(ce=ne),this.props.type){case"simple":return this.updateSimpleFrame(ce);case"variable":return this.updateVariableFrame(ce);case"uniform":return this.updateUniformFrame(ce)}}},{key:"updateScrollParent",value:function(){var ce=this.scrollParent;this.scrollParent=this.props.scrollParentGetter(this),ce!==this.scrollParent&&(ce&&(ce.removeEventListener("scroll",this.updateFrameAndClearCache),ce.removeEventListener("mousewheel",ne)),this.clearSizeCache(),this.scrollParent.addEventListener("scroll",this.updateFrameAndClearCache,Y),this.scrollParent.addEventListener("mousewheel",ne,Y))}},{key:"updateSimpleFrame",value:function(ce){var pe=this.getStartAndEnd(),ie=pe.end,xe=this.items.children,Ce=0;if(xe.length){var ve=this.props.axis,Oe=xe[0],Pe=xe[xe.length-1];Ce=this.getOffset(Pe)+Pe[q[ve]]-this.getOffset(Oe)}if(Ce>ie)return ce();var Ie=this.props,Fe=Ie.pageSize,we=Ie.length,Ne=Math.min(this.state.size+Fe,we);this.maybeSetState({size:Ne},ce)}},{key:"updateVariableFrame",value:function(ce){this.props.itemSizeGetter||this.cacheSizes();for(var pe=this.getStartAndEnd(),ie=pe.start,xe=pe.end,Ce=this.props,ve=Ce.length,Oe=Ce.pageSize,Pe=0,Ie=0,Fe=0,we=ve-1;Ie<we;){var Ne=this.getSizeOfItem(Ie);if(Ne==null||Pe+Ne>ie)break;Pe+=Ne,++Ie}for(var Ue=ve-Ie;Fe<Ue&&Pe<xe;){var Be=this.getSizeOfItem(Ie+Fe);if(Be==null){Fe=Math.min(Fe+Oe,Ue);break}Pe+=Be,++Fe}this.maybeSetState(oe(this.props,{from:Ie,itemsPerRow:1,size:Fe}),ce)}},{key:"updateUniformFrame",value:function(ce){var pe=this.getItemSizeAndItemsPerRow(),ie=pe.itemSize,xe=pe.itemsPerRow;if(!ie||!xe)return ce();var Ce=this.getStartAndEnd(),ve=Ce.start,Oe=Ce.end,Pe=oe(this.props,{from:Math.floor(ve/ie)*xe,size:(Math.ceil((Oe-ve)/ie)+1)*xe,itemsPerRow:xe}),Ie=Pe.from,Fe=Pe.size;return this.maybeSetState({itemsPerRow:xe,from:Ie,itemSize:ie,size:Fe},ce)}},{key:"getSpaceBefore",value:function(ce){var pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(pe[ce]!=null)return pe[ce];var ie=this.state,xe=ie.itemSize,Ce=ie.itemsPerRow;if(xe)return pe[ce]=Math.floor(ce/Ce)*xe;for(var ve=ce;ve>0&&pe[--ve]==null;);for(var Oe=pe[ve]||0,Pe=ve;Pe<ce;++Pe){pe[Pe]=Oe;var Ie=this.getSizeOfItem(Pe);if(Ie==null)break;Oe+=Ie}return pe[ce]=Oe}},{key:"cacheSizes",value:function(){for(var ce=this.cache,pe=this.state.from,ie=this.items.children,xe=q[this.props.axis],Ce=0,ve=ie.length;Ce<ve;++Ce)ce[pe+Ce]=ie[Ce][xe]}},{key:"getSizeOfItem",value:function(ce){var pe=this.cache,ie=this.items,xe=this.props,Ce=xe.axis,ve=xe.itemSizeGetter,Oe=xe.itemSizeEstimator,Pe=xe.type,Ie=this.state,Fe=Ie.from,we=Ie.itemSize,Ne=Ie.size;if(we)return we;if(ve)return ve(ce);if(ce in pe)return pe[ce];if(Pe==="simple"&&ce>=Fe&&ce<Fe+Ne&&ie){var Ue=ie.children[ce-Fe];if(Ue)return Ue[q[Ce]]}if(Oe)return Oe(ce,pe)}},{key:"scrollTo",value:function(ce){ce!=null&&this.setScroll(this.getSpaceBefore(ce))}},{key:"scrollAround",value:function(ce){var pe=this.getScrollPosition(),ie=this.getSpaceBefore(ce),xe=ie-this.props.scrollParentViewportSizeGetter(this)+this.getSizeOfItem(ce),Ce=Math.min(xe,ie),ve=Math.max(xe,ie);if(pe<=Ce)return this.setScroll(Ce);if(pe>ve)return this.setScroll(ve)}},{key:"getVisibleRange",value:function(){for(var ce=this.state,pe=ce.from,ie=ce.size,xe=this.getStartAndEnd(0),Ce=xe.start,ve=xe.end,Oe={},Pe,Ie,Fe=pe;Fe<pe+ie;++Fe){var we=this.getSpaceBefore(Fe,Oe),Ne=we+this.getSizeOfItem(Fe);Pe==null&&Ne>Ce&&(Pe=Fe),Pe!=null&&we<ve&&(Ie=Fe)}return[Pe,Ie]}},{key:"renderItems",value:function(){for(var ce=this,pe=this.props,ie=pe.itemRenderer,xe=pe.itemsRenderer,Ce=this.state,ve=Ce.from,Oe=Ce.size,Pe=[],Ie=0;Ie<Oe;++Ie)Pe.push(ie(ve+Ie,Ie));return xe(Pe,function(Fe){return ce.items=Fe})}},{key:"render",value:function(){var ce=this,pe=this.props,ie=pe.axis,xe=pe.length,Ce=pe.type,ve=pe.useTranslate3d,Oe=this.state,Pe=Oe.from,Ie=Oe.itemsPerRow,Fe=this.renderItems();if(Ce==="simple")return Fe;var we={position:"relative"},Ne={},Ue=Math.ceil(xe/Ie)*Ie,Be=this.getSpaceBefore(Ue,Ne);Be&&(we[$[ie]]=Be,ie==="x"&&(we.overflowX="hidden"));var qe=this.getSpaceBefore(Pe,Ne),te=ie==="x"?qe:0,le=ie==="y"?qe:0,ye=ve?"translate3d(".concat(te,"px, ").concat(le,"px, 0)"):"translate(".concat(te,"px, ").concat(le,"px)"),Ve={msTransform:ye,WebkitTransform:ye,transform:ye};return(0,r.jsx)("div",{style:we,ref:function(Le){return ce.el=Le},children:(0,r.jsx)("div",{style:Ve,children:Fe})})}}],[{key:"getDerivedStateFromProps",value:function(ce,pe){var ie=oe(ce,pe);return ie===pe?null:ie}}])})(t.Component);T(H,"displayName","ReactList"),T(H,"defaultProps",{axis:"y",itemRenderer:function(re,de){return(0,r.jsx)("div",{children:re},de)},itemsRenderer:function(re,de){return(0,r.jsx)("div",{ref:de,children:re})},length:0,minSize:1,pageSize:10,scrollParentGetter:X,scrollParentViewportSizeGetter:Z,threshold:100,type:"simple",useStaticSize:!1,useTranslate3d:!1})})})(Lg)),Lg}function Gre(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=Object.keys(n),r=Object.keys(e),s=t.length;if(r.length!==s)return!1;for(var a=0;a<s;a++){var o=t[a];if(n[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}function Zre(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=n.length;if(e.length!==t)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}const Kre=Object.freeze(Object.defineProperty({__proto__:null,shallowEqualArrays:Zre,shallowEqualObjects:Gre},Symbol.toStringTag,{value:"Module"})),Jre=n4(Kre);var Ph={},fR;function ky(){return fR||(fR=1,Object.defineProperty(Ph,"__esModule",{value:!0}),Ph.default=void 0,Ph.default={dateRangeWrapper:"rdrDateRangeWrapper",calendarWrapper:"rdrCalendarWrapper",dateDisplay:"rdrDateDisplay",dateDisplayItem:"rdrDateDisplayItem",dateDisplayItemActive:"rdrDateDisplayItemActive",monthAndYearWrapper:"rdrMonthAndYearWrapper",monthAndYearPickers:"rdrMonthAndYearPickers",nextPrevButton:"rdrNextPrevButton",month:"rdrMonth",weekDays:"rdrWeekDays",weekDay:"rdrWeekDay",days:"rdrDays",day:"rdrDay",dayNumber:"rdrDayNumber",dayPassive:"rdrDayPassive",dayToday:"rdrDayToday",dayStartOfWeek:"rdrDayStartOfWeek",dayEndOfWeek:"rdrDayEndOfWeek",daySelected:"rdrDaySelected",dayDisabled:"rdrDayDisabled",dayStartOfMonth:"rdrDayStartOfMonth",dayEndOfMonth:"rdrDayEndOfMonth",dayWeekend:"rdrDayWeekend",dayStartPreview:"rdrDayStartPreview",dayInPreview:"rdrDayInPreview",dayEndPreview:"rdrDayEndPreview",dayHovered:"rdrDayHovered",dayActive:"rdrDayActive",inRange:"rdrInRange",endEdge:"rdrEndEdge",startEdge:"rdrStartEdge",prevButton:"rdrPprevButton",nextButton:"rdrNextButton",selected:"rdrSelected",months:"rdrMonths",monthPicker:"rdrMonthPicker",yearPicker:"rdrYearPicker",dateDisplayWrapper:"rdrDateDisplayWrapper",definedRangesWrapper:"rdrDefinedRangesWrapper",staticRanges:"rdrStaticRanges",staticRange:"rdrStaticRange",inputRanges:"rdrInputRanges",inputRange:"rdrInputRange",inputRangeInput:"rdrInputRangeInput",dateRangePickerWrapper:"rdrDateRangePickerWrapper",staticRangeLabel:"rdrStaticRangeLabel",staticRangeSelected:"rdrStaticRangeSelected",monthName:"rdrMonthName",infiniteMonths:"rdrInfiniteMonths",monthsVertical:"rdrMonthsVertical",monthsHorizontal:"rdrMonthsHorizontal"}),Ph}var Mh={},hR;function Qre(){if(hR)return Mh;hR=1,Object.defineProperty(Mh,"__esModule",{value:!0}),Mh.ariaLabelsShape=void 0;var n=e(Ml());function e(t){return t&&t.__esModule?t:{default:t}}return Mh.ariaLabelsShape=n.default.shape({dateInput:n.default.objectOf(n.default.shape({startDate:n.default.string,endDate:n.default.string})),monthPicker:n.default.string,yearPicker:n.default.string,prevButton:n.default.string,nextButton:n.default.string}),Mh}var mR;function X5(){if(mR)return Sh;mR=1,Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.default=void 0;var n=_(Gs()),e=v(Ml()),t=Cy(),r=v($re()),s=v(Hre()),a=Ty(),o=v(bu()),l=v(Yre()),c=Jre,d=_u(),h=_5(),p=v(ky()),x=Qre();function v(O){return O&&O.__esModule?O:{default:O}}function w(O){if(typeof WeakMap!="function")return null;var I=new WeakMap,q=new WeakMap;return(w=function(F){return F?q:I})(O)}function _(O,I){if(O&&O.__esModule)return O;if(O===null||typeof O!="object"&&typeof O!="function")return{default:O};var q=w(I);if(q&&q.has(O))return q.get(O);var F={__proto__:null},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in O)if(U!=="default"&&Object.prototype.hasOwnProperty.call(O,U)){var W=V?Object.getOwnPropertyDescriptor(O,U):null;W&&(W.get||W.set)?Object.defineProperty(F,U,W):F[U]=O[U]}return F.default=O,q&&q.set(O,F),F}function j(){return j=Object.assign?Object.assign.bind():function(O){for(var I=1;I<arguments.length;I++){var q=arguments[I];for(var F in q)Object.prototype.hasOwnProperty.call(q,F)&&(O[F]=q[F])}return O},j.apply(this,arguments)}function T(O,I,q){return I=P(I),I in O?Object.defineProperty(O,I,{value:q,enumerable:!0,configurable:!0,writable:!0}):O[I]=q,O}function P(O){var I=D(O,"string");return typeof I=="symbol"?I:String(I)}function D(O,I){if(typeof O!="object"||!O)return O;var q=O[Symbol.toPrimitive];if(q!==void 0){var F=q.call(O,I);if(typeof F!="object")return F;throw new TypeError("@@toPrimitive must return a primitive value.")}return(I==="string"?String:Number)(O)}let M=class BS extends n.PureComponent{constructor(I,q){var F;super(I,q),F=this,T(this,"focusToDate",function(V){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:F.props,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!U.scroll.enabled){if(W&&U.preventSnapRefocus){const Y=(0,d.differenceInCalendarMonths)(V,F.state.focusedDate),ae=U.calendarFocus==="forwards"&&Y>=0,J=U.calendarFocus==="backwards"&&Y<=0;if((ae||J)&&Math.abs(Y)<U.months)return}F.setState({focusedDate:V});return}const $=(0,d.differenceInCalendarMonths)(V,U.minDate,F.dateOptions),ne=F.list.getVisibleRange();W&&ne.includes($)||(F.isFirstRender=!0,F.list.scrollTo($),F.setState({focusedDate:V}))}),T(this,"updateShownDate",function(){let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:F.props;const U=V.scroll.enabled?{...V,months:F.list.getVisibleRange().length}:V,W=(0,a.calcFocusDate)(F.state.focusedDate,U);F.focusToDate(W,U)}),T(this,"updatePreview",V=>{if(!V){this.setState({preview:null});return}const U={startDate:V,endDate:V,color:this.props.color};this.setState({preview:U})}),T(this,"changeShownDate",function(V){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"set";const{focusedDate:W}=F.state,{onShownDateChange:$,minDate:ne,maxDate:Y}=F.props,ae={monthOffset:()=>(0,d.addMonths)(W,V),setMonth:()=>(0,d.setMonth)(W,V),setYear:()=>(0,d.setYear)(W,V),set:()=>V},J=(0,d.min)([(0,d.max)([ae[U](),ne]),Y]);F.focusToDate(J,F.props,!1),$&&$(J)}),T(this,"handleRangeFocusChange",(V,U)=>{this.props.onRangeFocusChange&&this.props.onRangeFocusChange([V,U])}),T(this,"handleScroll",()=>{const{onShownDateChange:V,minDate:U}=this.props,{focusedDate:W}=this.state,{isFirstRender:$}=this,ne=this.list.getVisibleRange();if(ne[0]===void 0)return;const Y=(0,d.addMonths)(U,ne[0]||0);!(0,d.isSameMonth)(Y,W)&&!$&&(this.setState({focusedDate:Y}),V&&V(Y)),this.isFirstRender=!1}),T(this,"renderMonthAndYear",(V,U,W)=>{const{showMonthArrow:$,minDate:ne,maxDate:Y,showMonthAndYearPickers:ae,ariaLabels:J}=W,ee=(Y||BS.defaultProps.maxDate).getFullYear(),X=(ne||BS.defaultProps.minDate).getFullYear(),Z=this.styles;return n.default.createElement("div",{onMouseUp:oe=>oe.stopPropagation(),className:Z.monthAndYearWrapper},$?n.default.createElement("button",{type:"button",className:(0,o.default)(Z.nextPrevButton,Z.prevButton),onClick:()=>U(-1,"monthOffset"),"aria-label":J.prevButton},n.default.createElement("i",null)):null,ae?n.default.createElement("span",{className:Z.monthAndYearPickers},n.default.createElement("span",{className:Z.monthPicker},n.default.createElement("select",{value:V.getMonth(),onChange:oe=>U(oe.target.value,"setMonth"),"aria-label":J.monthPicker},this.state.monthNames.map((oe,H)=>n.default.createElement("option",{key:H,value:H},oe)))),n.default.createElement("span",{className:Z.monthAndYearDivider}),n.default.createElement("span",{className:Z.yearPicker},n.default.createElement("select",{value:V.getFullYear(),onChange:oe=>U(oe.target.value,"setYear"),"aria-label":J.yearPicker},new Array(ee-X+1).fill(ee).map((oe,H)=>{const Q=oe-H;return n.default.createElement("option",{key:Q,value:Q},Q)})))):n.default.createElement("span",{className:Z.monthAndYearPickers},this.state.monthNames[V.getMonth()]," ",V.getFullYear()),$?n.default.createElement("button",{type:"button",className:(0,o.default)(Z.nextPrevButton,Z.nextButton),onClick:()=>U(1,"monthOffset"),"aria-label":J.nextButton},n.default.createElement("i",null)):null)}),T(this,"renderDateDisplay",()=>{const{focusedRange:V,color:U,ranges:W,rangeColors:$,dateDisplayFormat:ne,editableDateInputs:Y,startDatePlaceholder:ae,endDatePlaceholder:J,ariaLabels:ee}=this.props,X=$[V[0]]||U,Z=this.styles;return n.default.createElement("div",{className:Z.dateDisplayWrapper},W.map((oe,H)=>oe.showDateDisplay===!1||oe.disabled&&!oe.showDateDisplay?null:n.default.createElement("div",{className:Z.dateDisplay,key:H,style:{color:oe.color||X}},n.default.createElement(s.default,{className:(0,o.default)(Z.dateDisplayItem,{[Z.dateDisplayItemActive]:V[0]===H&&V[1]===0}),readOnly:!Y,disabled:oe.disabled,value:oe.startDate,placeholder:ae,dateOptions:this.dateOptions,dateDisplayFormat:ne,ariaLabel:ee.dateInput&&ee.dateInput[oe.key]&&ee.dateInput[oe.key].startDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(H,0)}),n.default.createElement(s.default,{className:(0,o.default)(Z.dateDisplayItem,{[Z.dateDisplayItemActive]:V[0]===H&&V[1]===1}),readOnly:!Y,disabled:oe.disabled,value:oe.endDate,placeholder:J,dateOptions:this.dateOptions,dateDisplayFormat:ne,ariaLabel:ee.dateInput&&ee.dateInput[oe.key]&&ee.dateInput[oe.key].endDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(H,1)}))))}),T(this,"onDragSelectionStart",V=>{const{onChange:U,dragSelectionEnabled:W}=this.props;W?this.setState({drag:{status:!0,range:{startDate:V,endDate:V},disablePreview:!0}}):U&&U(V)}),T(this,"onDragSelectionEnd",V=>{const{updateRange:U,displayMode:W,onChange:$,dragSelectionEnabled:ne}=this.props;if(!ne)return;if(W==="date"||!this.state.drag.status){$&&$(V);return}const Y={startDate:this.state.drag.range.startDate,endDate:V};W!=="dateRange"||(0,d.isSameDay)(Y.startDate,V)?this.setState({drag:{status:!1,range:{}}},()=>$&&$(V)):this.setState({drag:{status:!1,range:{}}},()=>{U&&U(Y)})}),T(this,"onDragSelectionMove",V=>{const{drag:U}=this.state;!U.status||!this.props.dragSelectionEnabled||this.setState({drag:{status:U.status,range:{startDate:U.range.startDate,endDate:V},disablePreview:!0}})}),T(this,"estimateMonthSize",(V,U)=>{const{direction:W,minDate:$}=this.props,{scrollArea:ne}=this.state;if(U&&(this.listSizeCache=U,U[V]))return U[V];if(W==="horizontal")return ne.monthWidth;const Y=(0,d.addMonths)($,V),{start:ae,end:J}=(0,a.getMonthDisplayRange)(Y,this.dateOptions);return(0,d.differenceInDays)(J,ae,this.dateOptions)+1>35?ne.longMonthHeight:ne.monthHeight}),this.dateOptions={locale:I.locale},I.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=I.weekStartsOn),this.styles=(0,a.generateStyles)([p.default,I.classNames]),this.listSizeCache={},this.isFirstRender=!0,this.state={monthNames:this.getMonthNames(),focusedDate:(0,a.calcFocusDate)(null,I),drag:{status:!1,range:{startDate:null,endDate:null},disablePreview:!1},scrollArea:this.calcScrollArea(I)}}getMonthNames(){return[...Array(12).keys()].map(I=>this.props.locale.localize.month(I))}calcScrollArea(I){const{direction:q,months:F,scroll:V}=I;if(!V.enabled)return{enabled:!1};const U=V.longMonthHeight||V.monthHeight;return q==="vertical"?{enabled:!0,monthHeight:V.monthHeight||220,longMonthHeight:U||260,calendarWidth:"auto",calendarHeight:(V.calendarHeight||U||240)*F}:{enabled:!0,monthWidth:V.monthWidth||332,calendarWidth:(V.calendarWidth||V.monthWidth||332)*F,monthHeight:U||300,calendarHeight:U||300}}componentDidMount(){this.props.scroll.enabled&&setTimeout(()=>this.focusToDate(this.state.focusedDate))}componentDidUpdate(I){const F={dateRange:"ranges",date:"date"}[this.props.displayMode];this.props[F]!==I[F]&&this.updateShownDate(this.props),(I.locale!==this.props.locale||I.weekStartsOn!==this.props.weekStartsOn)&&(this.dateOptions={locale:this.props.locale},this.props.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=this.props.weekStartsOn),this.setState({monthNames:this.getMonthNames()})),(0,c.shallowEqualObjects)(I.scroll,this.props.scroll)||this.setState({scrollArea:this.calcScrollArea(this.props)})}renderWeekdays(){const I=new Date;return n.default.createElement("div",{className:this.styles.weekDays},(0,d.eachDayOfInterval)({start:(0,d.startOfWeek)(I,this.dateOptions),end:(0,d.endOfWeek)(I,this.dateOptions)}).map((q,F)=>n.default.createElement("span",{className:this.styles.weekDay,key:F},(0,d.format)(q,this.props.weekdayDisplayFormat,this.dateOptions))))}render(){const{showDateDisplay:I,onPreviewChange:q,scroll:F,direction:V,disabledDates:U,disabledDay:W,maxDate:$,minDate:ne,rangeColors:Y,color:ae,navigatorRenderer:J,className:ee,preview:X}=this.props,{scrollArea:Z,focusedDate:oe}=this.state,H=V==="vertical",Q=J||this.renderMonthAndYear,re=this.props.ranges.map((de,ce)=>({...de,color:de.color||Y[ce]||ae}));return n.default.createElement("div",{className:(0,o.default)(this.styles.calendarWrapper,ee),onMouseUp:()=>this.setState({drag:{status:!1,range:{}}}),onMouseLeave:()=>{this.setState({drag:{status:!1,range:{}}})}},I&&this.renderDateDisplay(),Q(oe,this.changeShownDate,this.props),F.enabled?n.default.createElement("div",null,H&&this.renderWeekdays(this.dateOptions),n.default.createElement("div",{className:(0,o.default)(this.styles.infiniteMonths,H?this.styles.monthsVertical:this.styles.monthsHorizontal),onMouseLeave:()=>q&&q(),style:{width:Z.calendarWidth+11,height:Z.calendarHeight+11},onScroll:this.handleScroll},n.default.createElement(l.default,{length:(0,d.differenceInCalendarMonths)((0,d.endOfMonth)($),(0,d.addDays)((0,d.startOfMonth)(ne),-1),this.dateOptions),treshold:500,type:"variable",ref:de=>this.list=de,itemSizeEstimator:this.estimateMonthSize,axis:H?"y":"x",itemRenderer:(de,ce)=>{const pe=(0,d.addMonths)(ne,de);return n.default.createElement(r.default,j({},this.props,{onPreviewChange:q||this.updatePreview,preview:X||this.state.preview,ranges:re,key:ce,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:U,disabledDay:W,month:pe,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>q&&q(),styles:this.styles,style:H?{height:this.estimateMonthSize(de)}:{height:Z.monthHeight,width:this.estimateMonthSize(de)},showMonthName:!0,showWeekDays:!H}))}}))):n.default.createElement("div",{className:(0,o.default)(this.styles.months,H?this.styles.monthsVertical:this.styles.monthsHorizontal)},new Array(this.props.months).fill(null).map((de,ce)=>{let pe=(0,d.addMonths)(this.state.focusedDate,ce);return this.props.calendarFocus==="backwards"&&(pe=(0,d.subMonths)(this.state.focusedDate,this.props.months-1-ce)),n.default.createElement(r.default,j({},this.props,{onPreviewChange:q||this.updatePreview,preview:X||this.state.preview,ranges:re,key:ce,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:U,disabledDay:W,month:pe,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>q&&q(),styles:this.styles,showWeekDays:!H||ce===0,showMonthName:!H||ce>0}))})))}};return M.defaultProps={showMonthArrow:!0,showMonthAndYearPickers:!0,disabledDates:[],disabledDay:()=>{},classNames:{},locale:h.enUS,ranges:[],focusedRange:[0,0],dateDisplayFormat:"MMM d, yyyy",monthDisplayFormat:"MMM yyyy",weekdayDisplayFormat:"E",dayDisplayFormat:"d",showDateDisplay:!0,showPreview:!0,displayMode:"date",months:1,color:"#3d91ff",scroll:{enabled:!1},direction:"vertical",maxDate:(0,d.addYears)(new Date,20),minDate:(0,d.addYears)(new Date,-100),rangeColors:["#3d91ff","#3ecf8e","#fed14c"],startDatePlaceholder:"Early",endDatePlaceholder:"Continuous",editableDateInputs:!1,dragSelectionEnabled:!0,fixedHeight:!1,calendarFocus:"forwards",preventSnapRefocus:!1,ariaLabels:{}},M.propTypes={showMonthArrow:e.default.bool,showMonthAndYearPickers:e.default.bool,disabledDates:e.default.array,disabledDay:e.default.func,minDate:e.default.object,maxDate:e.default.object,date:e.default.object,onChange:e.default.func,onPreviewChange:e.default.func,onRangeFocusChange:e.default.func,classNames:e.default.object,locale:e.default.object,shownDate:e.default.object,onShownDateChange:e.default.func,ranges:e.default.arrayOf(t.rangeShape),preview:e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string}),dateDisplayFormat:e.default.string,monthDisplayFormat:e.default.string,weekdayDisplayFormat:e.default.string,weekStartsOn:e.default.number,dayDisplayFormat:e.default.string,focusedRange:e.default.arrayOf(e.default.number),initialFocusedRange:e.default.arrayOf(e.default.number),months:e.default.number,className:e.default.string,showDateDisplay:e.default.bool,showPreview:e.default.bool,displayMode:e.default.oneOf(["dateRange","date"]),color:e.default.string,updateRange:e.default.func,scroll:e.default.shape({enabled:e.default.bool,monthHeight:e.default.number,longMonthHeight:e.default.number,monthWidth:e.default.number,calendarWidth:e.default.number,calendarHeight:e.default.number}),direction:e.default.oneOf(["vertical","horizontal"]),startDatePlaceholder:e.default.string,endDatePlaceholder:e.default.string,navigatorRenderer:e.default.func,rangeColors:e.default.arrayOf(e.default.string),editableDateInputs:e.default.bool,dragSelectionEnabled:e.default.bool,fixedHeight:e.default.bool,calendarFocus:e.default.string,preventSnapRefocus:e.default.bool,ariaLabels:x.ariaLabelsShape},Sh.default=M,Sh}var pR;function e6(){if(pR)return Nh;pR=1,Object.defineProperty(Nh,"__esModule",{value:!0}),Nh.default=void 0;var n=h(Gs()),e=c(Ml()),t=c(X5()),r=Cy(),s=Ty(),a=_u(),o=c(bu()),l=c(ky());function c(j){return j&&j.__esModule?j:{default:j}}function d(j){if(typeof WeakMap!="function")return null;var T=new WeakMap,P=new WeakMap;return(d=function(D){return D?P:T})(j)}function h(j,T){if(j&&j.__esModule)return j;if(j===null||typeof j!="object"&&typeof j!="function")return{default:j};var P=d(T);if(P&&P.has(j))return P.get(j);var D={__proto__:null},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in j)if(O!=="default"&&Object.prototype.hasOwnProperty.call(j,O)){var I=M?Object.getOwnPropertyDescriptor(j,O):null;I&&(I.get||I.set)?Object.defineProperty(D,O,I):D[O]=j[O]}return D.default=j,P&&P.set(j,D),D}function p(){return p=Object.assign?Object.assign.bind():function(j){for(var T=1;T<arguments.length;T++){var P=arguments[T];for(var D in P)Object.prototype.hasOwnProperty.call(P,D)&&(j[D]=P[D])}return j},p.apply(this,arguments)}function x(j,T,P){return T=v(T),T in j?Object.defineProperty(j,T,{value:P,enumerable:!0,configurable:!0,writable:!0}):j[T]=P,j}function v(j){var T=w(j,"string");return typeof T=="symbol"?T:String(T)}function w(j,T){if(typeof j!="object"||!j)return j;var P=j[Symbol.toPrimitive];if(P!==void 0){var D=P.call(j,T);if(typeof D!="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(T==="string"?String:Number)(j)}let _=class extends n.Component{constructor(T,P){var D;super(T,P),D=this,x(this,"calcNewSelection",function(M){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const I=D.props.focusedRange||D.state.focusedRange,{ranges:q,onChange:F,maxDate:V,moveRangeOnFirstSelection:U,retainEndDateOnFirstSelection:W,disabledDates:$}=D.props,ne=I[0],Y=q[ne];if(!Y||!F)return{};let{startDate:ae,endDate:J}=Y;const ee=new Date;let X;if(!O)ae=M.startDate,J=M.endDate;else if(I[1]===0){const H=(0,a.differenceInCalendarDays)(J||ee,ae),Q=()=>U?(0,a.addDays)(M,H):W?!J||(0,a.isBefore)(M,J)?J:M:M||ee;ae=M,J=Q(),V&&(J=(0,a.min)([J,V])),X=[I[0],1]}else J=M;let Z=I[1]===0;(0,a.isBefore)(J,ae)&&(Z=!Z,[ae,J]=[J,ae]);const oe=$.filter(H=>(0,a.isWithinInterval)(H,{start:ae,end:J}));return oe.length>0&&(Z?ae=(0,a.addDays)((0,a.max)(oe),1):J=(0,a.addDays)((0,a.min)(oe),-1)),X||(X=[(0,s.findNextRangeIndex)(D.props.ranges,I[0]),0]),{wasValid:!(oe.length>0),range:{startDate:ae,endDate:J},nextFocusRange:X}}),x(this,"setSelection",(M,O)=>{const{onChange:I,ranges:q,onRangeFocusChange:F}=this.props,U=(this.props.focusedRange||this.state.focusedRange)[0],W=q[U];if(!W)return;const $=this.calcNewSelection(M,O);I({[W.key||`range${U+1}`]:{...W,...$.range}}),this.setState({focusedRange:$.nextFocusRange,preview:null}),F&&F($.nextFocusRange)}),x(this,"handleRangeFocusChange",M=>{this.setState({focusedRange:M}),this.props.onRangeFocusChange&&this.props.onRangeFocusChange(M)}),x(this,"updatePreview",M=>{if(!M){this.setState({preview:null});return}const{rangeColors:O,ranges:I}=this.props,q=this.props.focusedRange||this.state.focusedRange,F=I[q[0]]?.color||O[q[0]]||F;this.setState({preview:{...M.range,color:F}})}),this.state={focusedRange:T.initialFocusedRange||[(0,s.findNextRangeIndex)(T.ranges),0],preview:null},this.styles=(0,s.generateStyles)([l.default,T.classNames])}render(){return n.default.createElement(t.default,p({focusedRange:this.state.focusedRange,onRangeFocusChange:this.handleRangeFocusChange,preview:this.state.preview,onPreviewChange:T=>{this.updatePreview(T?this.calcNewSelection(T):null)}},this.props,{displayMode:"dateRange",className:(0,o.default)(this.styles.dateRangeWrapper,this.props.className),onChange:this.setSelection,updateRange:T=>this.setSelection(T,!1),ref:T=>{this.calendar=T}}))}};return _.defaultProps={classNames:{},ranges:[],moveRangeOnFirstSelection:!1,retainEndDateOnFirstSelection:!1,rangeColors:["#3d91ff","#3ecf8e","#fed14c"],disabledDates:[]},_.propTypes={...t.default.propTypes,onChange:e.default.func,onRangeFocusChange:e.default.func,className:e.default.string,ranges:e.default.arrayOf(r.rangeShape),moveRangeOnFirstSelection:e.default.bool,retainEndDateOnFirstSelection:e.default.bool},Nh.default=_,Nh}var Eh={},Dh={},Cc={},gR;function t6(){if(gR)return Cc;gR=1,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.createStaticRanges=r,Cc.defaultStaticRanges=Cc.defaultInputRanges=void 0;var n=_u();const e={startOfWeek:(0,n.startOfWeek)(new Date),endOfWeek:(0,n.endOfWeek)(new Date),startOfLastWeek:(0,n.startOfWeek)((0,n.addDays)(new Date,-7)),endOfLastWeek:(0,n.endOfWeek)((0,n.addDays)(new Date,-7)),startOfToday:(0,n.startOfDay)(new Date),endOfToday:(0,n.endOfDay)(new Date),startOfYesterday:(0,n.startOfDay)((0,n.addDays)(new Date,-1)),endOfYesterday:(0,n.endOfDay)((0,n.addDays)(new Date,-1)),startOfMonth:(0,n.startOfMonth)(new Date),endOfMonth:(0,n.endOfMonth)(new Date),startOfLastMonth:(0,n.startOfMonth)((0,n.addMonths)(new Date,-1)),endOfLastMonth:(0,n.endOfMonth)((0,n.addMonths)(new Date,-1))},t={range:{},isSelected(s){const a=this.range();return(0,n.isSameDay)(s.startDate,a.startDate)&&(0,n.isSameDay)(s.endDate,a.endDate)}};function r(s){return s.map(a=>({...t,...a}))}return Cc.defaultStaticRanges=r([{label:"Today",range:()=>({startDate:e.startOfToday,endDate:e.endOfToday})},{label:"Yesterday",range:()=>({startDate:e.startOfYesterday,endDate:e.endOfYesterday})},{label:"This Week",range:()=>({startDate:e.startOfWeek,endDate:e.endOfWeek})},{label:"Last Week",range:()=>({startDate:e.startOfLastWeek,endDate:e.endOfLastWeek})},{label:"This Month",range:()=>({startDate:e.startOfMonth,endDate:e.endOfMonth})},{label:"Last Month",range:()=>({startDate:e.startOfLastMonth,endDate:e.endOfLastMonth})}]),Cc.defaultInputRanges=[{label:"days up to today",range(s){return{startDate:(0,n.addDays)(e.startOfToday,(Math.max(Number(s),1)-1)*-1),endDate:e.endOfToday}},getCurrentValue(s){return(0,n.isSameDay)(s.endDate,e.endOfToday)?s.startDate?(0,n.differenceInCalendarDays)(e.endOfToday,s.startDate)+1:"":"-"}},{label:"days starting today",range(s){const a=new Date;return{startDate:a,endDate:(0,n.addDays)(a,Math.max(Number(s),1)-1)}},getCurrentValue(s){return(0,n.isSameDay)(s.startDate,e.startOfToday)?s.endDate?(0,n.differenceInCalendarDays)(s.endDate,e.startOfToday)+1:"":"-"}}],Cc}var Oh={},xR;function Xre(){if(xR)return Oh;xR=1,Object.defineProperty(Oh,"__esModule",{value:!0}),Oh.default=void 0;var n=s(Gs()),e=t(Ml());function t(p){return p&&p.__esModule?p:{default:p}}function r(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(r=function(w){return w?v:x})(p)}function s(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=r(x);if(v&&v.has(p))return v.get(p);var w={__proto__:null},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var T=_?Object.getOwnPropertyDescriptor(p,j):null;T&&(T.get||T.set)?Object.defineProperty(w,j,T):w[j]=p[j]}return w.default=p,v&&v.set(p,w),w}function a(p,x,v){return x=o(x),x in p?Object.defineProperty(p,x,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[x]=v,p}function o(p){var x=l(p,"string");return typeof x=="symbol"?x:String(x)}function l(p,x){if(typeof p!="object"||!p)return p;var v=p[Symbol.toPrimitive];if(v!==void 0){var w=v.call(p,x);if(typeof w!="object")return w;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(p)}const c=0,d=99999;let h=class extends n.Component{constructor(x,v){super(x,v),a(this,"onChange",w=>{const{onChange:_}=this.props;let j=parseInt(w.target.value,10);j=isNaN(j)?0:Math.max(Math.min(d,j),c),_(j)})}shouldComponentUpdate(x){const{value:v,label:w,placeholder:_}=this.props;return v!==x.value||w!==x.label||_!==x.placeholder}render(){const{label:x,placeholder:v,value:w,styles:_,onBlur:j,onFocus:T}=this.props;return n.default.createElement("div",{className:_.inputRange},n.default.createElement("input",{className:_.inputRangeInput,placeholder:v,value:w,min:c,max:d,onChange:this.onChange,onFocus:T,onBlur:j}),n.default.createElement("span",{className:_.inputRangeLabel},x))}};return h.propTypes={value:e.default.oneOfType([e.default.string,e.default.number]),label:e.default.oneOfType([e.default.element,e.default.node]).isRequired,placeholder:e.default.string,styles:e.default.shape({inputRange:e.default.string,inputRangeInput:e.default.string,inputRangeLabel:e.default.string}).isRequired,onBlur:e.default.func.isRequired,onFocus:e.default.func.isRequired,onChange:e.default.func.isRequired},h.defaultProps={value:"",placeholder:"-"},Oh.default=h,Oh}var yR;function n6(){if(yR)return Dh;yR=1,Object.defineProperty(Dh,"__esModule",{value:!0}),Dh.default=void 0;var n=d(Gs()),e=l(Ml()),t=l(ky()),r=t6(),s=Cy(),a=l(Xre()),o=l(bu());function l(w){return w&&w.__esModule?w:{default:w}}function c(w){if(typeof WeakMap!="function")return null;var _=new WeakMap,j=new WeakMap;return(c=function(T){return T?j:_})(w)}function d(w,_){if(w&&w.__esModule)return w;if(w===null||typeof w!="object"&&typeof w!="function")return{default:w};var j=c(_);if(j&&j.has(w))return j.get(w);var T={__proto__:null},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in w)if(D!=="default"&&Object.prototype.hasOwnProperty.call(w,D)){var M=P?Object.getOwnPropertyDescriptor(w,D):null;M&&(M.get||M.set)?Object.defineProperty(T,D,M):T[D]=w[D]}return T.default=w,j&&j.set(w,T),T}function h(w,_,j){return _=p(_),_ in w?Object.defineProperty(w,_,{value:j,enumerable:!0,configurable:!0,writable:!0}):w[_]=j,w}function p(w){var _=x(w,"string");return typeof _=="symbol"?_:String(_)}function x(w,_){if(typeof w!="object"||!w)return w;var j=w[Symbol.toPrimitive];if(j!==void 0){var T=j.call(w,_);if(typeof T!="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(w)}let v=class extends n.Component{constructor(_){super(_),h(this,"handleRangeChange",j=>{const{onChange:T,ranges:P,focusedRange:D}=this.props,M=P[D[0]];!T||!M||T({[M.key||`range${D[0]+1}`]:{...M,...j}})}),this.state={rangeOffset:0,focusedInput:-1}}getRangeOptionValue(_){const{ranges:j=[],focusedRange:T=[]}=this.props;if(typeof _.getCurrentValue!="function")return"";const P=j[T[0]]||{};return _.getCurrentValue(P)||""}getSelectedRange(_,j){const T=_.findIndex(D=>!D.startDate||!D.endDate||D.disabled?!1:j.isSelected(D));return{selectedRange:_[T],focusedRangeIndex:T}}render(){const{headerContent:_,footerContent:j,onPreviewChange:T,inputRanges:P,staticRanges:D,ranges:M,renderStaticRangeLabel:O,rangeColors:I,className:q}=this.props;return n.default.createElement("div",{className:(0,o.default)(t.default.definedRangesWrapper,q)},_,n.default.createElement("div",{className:t.default.staticRanges},D.map((F,V)=>{const{selectedRange:U,focusedRangeIndex:W}=this.getSelectedRange(M,F);let $;return F.hasCustomRendering?$=O(F):$=F.label,n.default.createElement("button",{type:"button",className:(0,o.default)(t.default.staticRange,{[t.default.staticRangeSelected]:!!U}),style:{color:U?U.color||I[W]:null},key:V,onClick:()=>this.handleRangeChange(F.range(this.props)),onFocus:()=>T&&T(F.range(this.props)),onMouseOver:()=>T&&T(F.range(this.props)),onMouseLeave:()=>{T&&T()}},n.default.createElement("span",{tabIndex:-1,className:t.default.staticRangeLabel},$))})),n.default.createElement("div",{className:t.default.inputRanges},P.map((F,V)=>n.default.createElement(a.default,{key:V,styles:t.default,label:F.label,onFocus:()=>this.setState({focusedInput:V,rangeOffset:0}),onBlur:()=>this.setState({rangeOffset:0}),onChange:U=>this.handleRangeChange(F.range(U,this.props)),value:this.getRangeOptionValue(F)}))),j)}};return v.propTypes={inputRanges:e.default.array,staticRanges:e.default.array,ranges:e.default.arrayOf(s.rangeShape),focusedRange:e.default.arrayOf(e.default.number),onPreviewChange:e.default.func,onChange:e.default.func,footerContent:e.default.any,headerContent:e.default.any,rangeColors:e.default.arrayOf(e.default.string),className:e.default.string,renderStaticRangeLabel:e.default.func},v.defaultProps={inputRanges:r.defaultInputRanges,staticRanges:r.defaultStaticRanges,ranges:[],rangeColors:["#3d91ff","#3ecf8e","#fed14c"],focusedRange:[0,0]},Dh.default=v,Dh}var vR;function ese(){if(vR)return Eh;vR=1,Object.defineProperty(Eh,"__esModule",{value:!0}),Eh.default=void 0;var n=d(Gs()),e=l(Ml()),t=l(e6()),r=l(n6()),s=Ty(),a=l(bu()),o=l(ky());function l(x){return x&&x.__esModule?x:{default:x}}function c(x){if(typeof WeakMap!="function")return null;var v=new WeakMap,w=new WeakMap;return(c=function(_){return _?w:v})(x)}function d(x,v){if(x&&x.__esModule)return x;if(x===null||typeof x!="object"&&typeof x!="function")return{default:x};var w=c(v);if(w&&w.has(x))return w.get(x);var _={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in x)if(T!=="default"&&Object.prototype.hasOwnProperty.call(x,T)){var P=j?Object.getOwnPropertyDescriptor(x,T):null;P&&(P.get||P.set)?Object.defineProperty(_,T,P):_[T]=x[T]}return _.default=x,w&&w.set(x,_),_}function h(){return h=Object.assign?Object.assign.bind():function(x){for(var v=1;v<arguments.length;v++){var w=arguments[v];for(var _ in w)Object.prototype.hasOwnProperty.call(w,_)&&(x[_]=w[_])}return x},h.apply(this,arguments)}let p=class extends n.Component{constructor(v){super(v),this.state={focusedRange:[(0,s.findNextRangeIndex)(v.ranges),0]},this.styles=(0,s.generateStyles)([o.default,v.classNames])}render(){const{focusedRange:v}=this.state;return n.default.createElement("div",{className:(0,a.default)(this.styles.dateRangePickerWrapper,this.props.className)},n.default.createElement(r.default,h({focusedRange:v,onPreviewChange:w=>this.dateRange.updatePreview(w?this.dateRange.calcNewSelection(w,typeof w=="string"):null)},this.props,{range:this.props.ranges[v[0]],className:void 0})),n.default.createElement(t.default,h({onRangeFocusChange:w=>this.setState({focusedRange:w}),focusedRange:v},this.props,{ref:w=>this.dateRange=w,className:void 0})))}};return p.defaultProps={},p.propTypes={...t.default.propTypes,...r.default.propTypes,className:e.default.string},Eh.default=p,Eh}var bR;function tse(){return bR||(bR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Calendar",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"DateRange",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"DateRangePicker",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"DefinedRange",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"createStaticRanges",{enumerable:!0,get:function(){return a.createStaticRanges}}),Object.defineProperty(n,"defaultInputRanges",{enumerable:!0,get:function(){return a.defaultInputRanges}}),Object.defineProperty(n,"defaultStaticRanges",{enumerable:!0,get:function(){return a.defaultStaticRanges}});var e=o(e6()),t=o(X5()),r=o(ese()),s=o(n6()),a=t6();function o(l){return l&&l.__esModule?l:{default:l}}})(Db)),Db}var bm=tse();const kn=({label:n,id:e,error:t,value:r,onChange:s,maxDate:a,minDate:o,...l})=>{const[c,d]=E.useState(!1),[h,p]=E.useState(!1),x=E.useRef(null),{theme:v}=Jc(),w=v==="dark";E.useEffect(()=>{p(document.body.classList.contains("field-officer-dark-theme"))},[]);const _=I=>{s&&s($e(I,"yyyy-MM-dd")),d(!1)};E.useEffect(()=>{const I=q=>{x.current&&!x.current.contains(q.target)&&d(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]);const{className:j,...T}=l,M=`${h?"fo-input":"form-input"} ${t?h?"fo-input--error":"form-input--error":""} flex justify-between items-center cursor-pointer ${j||""}`,O=r?new Date(r+"T12:00:00"):new Date;return i.jsxs("div",{ref:x,children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsxs("div",{className:n?"mt-1 relative":"relative",children:[i.jsxs("div",{id:e,className:M,onClick:()=>d(!c),role:"button","aria-haspopup":"dialog","aria-expanded":c,"aria-label":`Date picker for ${n}`,children:[i.jsx("span",{className:r?"":"text-muted",children:r?$e(O,"dd MMM, yyyy"):"Select date"}),i.jsx(Pa,{className:"h-4 w-4 text-muted"})]}),c&&i.jsx("div",{className:`absolute z-50 mt-1 rounded-lg shadow-lg overflow-hidden ${w?"dark-calendar bg-[#041b0f] border border-[#1f3d2b]":"bg-white border border-gray-200"}`,children:i.jsx(bm.Calendar,{date:O,onChange:_,maxDate:a,minDate:o,color:w?"#10B981":"#005D22"})})]}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},r6=["Apartment","Villa","Vilament","Rowhouse","Combined","Commercial Office","Commercial Retail","Commercial","Public",""],nse=Pt({organizationId:ge().required(),location:ge().optional().nullable(),entityId:ge().optional(),billingName:ge().optional().nullable(),registeredAddress:ge().optional().nullable(),gstNumber:ge().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,{message:"Invalid GST Number format",excludeEmptyString:!0}),panNumber:ge().optional().nullable().transform(n=>n?.toUpperCase()||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,{message:"Invalid PAN format",excludeEmptyString:!0}),email1:ge().email("Invalid email format").optional().nullable(),email2:ge().email("Invalid email format").optional().nullable(),email3:ge().email("Invalid email format").optional().nullable(),eShramNumber:ge().optional().nullable(),shopAndEstablishmentCode:ge().optional().nullable(),keyAccountManager:ge().optional(),siteAreaSqFt:as().typeError("Must be a number").nullable().optional(),projectType:ge().oneOf(r6).optional(),apartmentCount:as().typeError("Must be a number").nullable().optional(),agreementDetails:Pt({fromDate:ge().optional().nullable(),toDate:ge().optional().nullable().test("is-after-from","To Date must be after From Date",function(n){const{fromDate:e}=this.parent;return!e||!n?!0:new Date(n.replace(/-/g,"/"))>=new Date(e.replace(/-/g,"/"))}),renewalIntervalDays:as().typeError("Must be a number").nullable().optional().min(0,"Cannot be negative"),softCopy:Wt().nullable().optional(),scannedCopy:Wt().nullable().optional(),agreementDate:ge().optional().nullable(),addendum1Date:ge().optional().nullable(),addendum2Date:ge().optional().nullable()}).optional(),siteOperations:Pt({form6Applicable:is().default(!1),form6RenewalTaskCreation:is().optional(),form6ValidityFrom:ge().nullable().when("form6Applicable",{is:!0,then:n=>n.required("From Date is required")}),form6ValidityTo:ge().nullable().when("form6Applicable",{is:!0,then:n=>n.required("To Date is required")}),form6Document:Wt().nullable().when("form6Applicable",{is:!0,then:n=>n.required("Document is required")}),minWageRevisionApplicable:is().default(!1),minWageRevisionTaskCreation:is().optional(),minWageRevisionValidityFrom:ge().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("From Date is required")}),minWageRevisionValidityTo:ge().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("To Date is required")}),minWageRevisionDocument:Wt().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("Document is required")}),holidays:Pt({numberOfDays:as().nullable().min(0),list:_s().of(Pt({id:ge(),date:ge().required(),description:ge().required()})),salaryPayment:ge().oneOf(["Full Payment","Duty Payment","Nil Payment",""]),billing:ge().oneOf(["Full Payment","Duty Payment","Nil Payment",""])}).optional(),costingSheetLink:ge().url("Must be a valid URL").nullable().optional(),tools:Pt({dcCopy1:Wt().nullable().optional(),dcCopy2:Wt().nullable().optional(),list:_s().of(Pt({id:ge(),name:ge().required(),brand:ge().optional(),size:ge().optional(),quantity:as().nullable().min(0),issueDate:ge().required(),picture:Wt().nullable().optional()}))}).optional(),sims:Pt({issuedCount:as().nullable().min(0),details:_s().of(Pt({id:ge(),mobileNumber:ge().required().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),allocatedTo:ge().optional(),plan:ge().optional(),ownerName:ge().optional()}))}).optional(),equipment:Pt({issued:_s().of(Pt({id:ge(),name:ge().required(),brand:ge().optional(),modelNumber:ge().optional(),serialNumber:ge().optional(),accessories:ge().optional(),condition:ge().oneOf(["New","Old",""]),issueDate:ge().required(),picture:Wt().nullable().optional()})),intermittent:Pt({billing:ge().oneOf(["To Be Billed","Not to be Billed",""]),frequency:ge().oneOf(["Monthly","Bi-Monthly","Quarterly","Half Yearly","Yearly",""]),taskCreation:is().default(!1),durationDays:as().nullable().min(0)}).optional()}).optional(),billingCycleFrom:ge().nullable().optional(),uniformDeductions:is().default(!1)}).optional(),insuranceStatus:Pt({isCompliant:is().required()}).optional().nullable(),assets:_s().optional(),issuedTools:_s().optional()}).defined(),wR=({title:n,children:e})=>{const[t,r]=E.useState(!1);return i.jsxs("div",{className:"border border-border rounded-lg bg-page",children:[i.jsxs("button",{type:"button",onClick:()=>r(!t),className:"w-full flex justify-between items-center p-3 font-medium text-left text-primary-text",children:[i.jsx("span",{children:n}),i.jsx(vu,{className:`h-5 w-5 transform transition-transform ${t?"rotate-180":""}`})]}),t&&i.jsx("div",{className:"p-4 border-t border-border bg-card",children:e})]})},s6=({isOpen:n,onClose:e,onSave:t,organization:r,allClients:s,initialData:a})=>{const[o,l]=E.useState("General"),c=Ft("(max-width: 767px)"),{register:d,handleSubmit:h,control:p,watch:x,setValue:v,formState:{errors:w},reset:_}=tn({resolver:En(nse),defaultValues:{siteOperations:{form6Applicable:!1,minWageRevisionApplicable:!1,uniformDeductions:!1}}}),{fields:j,append:T,remove:P}=js({control:p,name:"siteOperations.holidays.list"});js({control:p,name:"siteOperations.tools.list"}),js({control:p,name:"siteOperations.sims.details"}),js({control:p,name:"siteOperations.equipment.issued"}),E.useEffect(()=>{n&&_(a||{organizationId:r.id})},[n,a,r.id,_]);const D=x("entityId"),M=x("siteOperations.form6Applicable"),O=x("siteOperations.minWageRevisionApplicable");E.useEffect(()=>{if(D){const F=s.find(V=>V.id===D);F&&(v("registeredAddress",F.registeredAddress||""),v("gstNumber",F.gstNumber||""),v("panNumber",F.panNumber||""),v("email1",F.email||""),v("eShramNumber",F.eShramNumber||""),v("shopAndEstablishmentCode",F.shopAndEstablishmentCode||""))}},[D,s,v]);const I=F=>{t(r.id,F)},q=({tabName:F})=>i.jsx("button",{type:"button",onClick:()=>l(F),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${o===F?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:F});return n?i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4 flex items-center justify-center",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale",onClick:F=>F.stopPropagation(),children:i.jsxs("form",{onSubmit:h(I),className:"p-6",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Site Configuration"}),i.jsxs("p",{className:"text-sm text-muted mb-4",children:["For: ",r.shortName]}),i.jsx("div",{className:"mb-6",children:c?i.jsxs(Ke,{label:"Configuration Section",id:"site-config-tabs",value:o,onChange:F=>l(F.target.value),className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"General",children:"General"}),i.jsx("option",{value:"Compliance",children:"Compliance"}),i.jsx("option",{value:"Agreement",children:"Agreement"}),i.jsx("option",{value:"Site Operations",children:"Site Operations"})]}):i.jsx("div",{className:"border-b border-border",children:i.jsxs("nav",{className:"-mb-px flex space-x-4",children:[i.jsx(q,{tabName:"General"}),i.jsx(q,{tabName:"Compliance"}),i.jsx(q,{tabName:"Agreement"}),i.jsx(q,{tabName:"Site Operations"})]})})}),i.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2 space-y-4",children:[o==="General"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(je,{label:"Location",id:"location",registration:d("location"),error:w.location?.message}),i.jsx(je,{label:"Billing Name",id:"billingName",registration:d("billingName"),error:w.billingName?.message}),i.jsx(je,{label:"Key Account Manager",id:"keyAccountManager",registration:d("keyAccountManager"),error:w.keyAccountManager?.message}),i.jsx(je,{label:"Site Area (Sq.ft)",id:"siteAreaSqFt",type:"number",registration:d("siteAreaSqFt"),error:w.siteAreaSqFt?.message}),i.jsxs(Ke,{label:"Type of Project",id:"projectType",registration:d("projectType"),error:w.projectType?.message,children:[i.jsx("option",{value:"",children:"-- Select Type --"}),r6.filter(Boolean).map(F=>i.jsx("option",{value:F,children:F},F))]}),i.jsx(je,{label:"No of Apartments/Villas",id:"apartmentCount",type:"number",registration:d("apartmentCount"),error:w.apartmentCount?.message})]}),o==="Compliance"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx("div",{className:"md:col-span-2",children:i.jsx(_e,{name:"entityId",control:p,render:({field:F})=>i.jsxs(Ke,{label:"Link to Client (Prefills data)",id:"entityId",...F,error:w.entityId?.message,children:[i.jsx("option",{value:"",children:"-- Select Client --"}),s.map(V=>i.jsxs("option",{value:V.id,children:[V.name," (",V.companyName,")"]},V.id))]})})}),i.jsx(je,{label:"GST Number",id:"gstNumber",registration:d("gstNumber"),error:w.gstNumber?.message}),i.jsx(je,{label:"PAN Number",id:"panNumber",registration:d("panNumber"),error:w.panNumber?.message}),i.jsx(je,{label:"Email Address 1",id:"email1",registration:d("email1"),error:w.email1?.message}),i.jsx(je,{label:"Email Address 2",id:"email2",registration:d("email2"),error:w.email2?.message}),i.jsx(je,{label:"Email Address 3",id:"email3",registration:d("email3"),error:w.email3?.message}),i.jsx(je,{label:"E-Shram Number",id:"eShramNumber",registration:d("eShramNumber"),error:w.eShramNumber?.message}),i.jsx(je,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:d("shopAndEstablishmentCode"),error:w.shopAndEstablishmentCode?.message})]}),o==="Agreement"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(_e,{name:"agreementDetails.fromDate",control:p,render:({field:F})=>i.jsx(kn,{label:"From Date",id:"agreementDetails.fromDate",value:F.value,onChange:F.onChange,error:w.agreementDetails?.fromDate?.message})}),i.jsx(_e,{name:"agreementDetails.toDate",control:p,render:({field:F})=>i.jsx(kn,{label:"To Date",id:"agreementDetails.toDate",value:F.value,onChange:F.onChange,error:w.agreementDetails?.toDate?.message})}),i.jsx(je,{label:"Renewal Interval (Days)",id:"agreementDetails.renewalIntervalDays",type:"number",registration:d("agreementDetails.renewalIntervalDays"),error:w.agreementDetails?.renewalIntervalDays?.message}),i.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(_e,{name:"agreementDetails.softCopy",control:p,render:({field:F})=>i.jsx(yt,{label:"Soft Copy",file:F.value,onFileChange:F.onChange})}),i.jsx(_e,{name:"agreementDetails.scannedCopy",control:p,render:({field:F})=>i.jsx(yt,{label:"Scanned Copy",file:F.value,onFileChange:F.onChange})})]}),i.jsx(_e,{name:"agreementDetails.agreementDate",control:p,render:({field:F})=>i.jsx(kn,{label:"Agreement Dated",id:"agreementDetails.agreementDate",value:F.value,onChange:F.onChange,error:w.agreementDetails?.agreementDate?.message})}),i.jsx(_e,{name:"agreementDetails.addendum1Date",control:p,render:({field:F})=>i.jsx(kn,{label:"Addendum 1 Dated",id:"agreementDetails.addendum1Date",value:F.value,onChange:F.onChange,error:w.agreementDetails?.addendum1Date?.message})}),i.jsx(_e,{name:"agreementDetails.addendum2Date",control:p,render:({field:F})=>i.jsx(kn,{label:"Addendum 2 Dated",id:"agreementDetails.addendum2Date",value:F.value,onChange:F.onChange,error:w.agreementDetails?.addendum2Date?.message})})]}),o==="Site Operations"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(wR,{title:"Compliance Forms",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(_e,{name:"siteOperations.form6Applicable",control:p,render:({field:F})=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:F.value,onChange:F.onChange})," Form 6 Applicable"]})}),M&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[i.jsx(_e,{name:"siteOperations.form6ValidityFrom",control:p,render:({field:F})=>i.jsx(kn,{label:"Valid From",id:"form6from",value:F.value,onChange:F.onChange,error:w.siteOperations?.form6ValidityFrom?.message})}),i.jsx(_e,{name:"siteOperations.form6ValidityTo",control:p,render:({field:F})=>i.jsx(kn,{label:"Valid To",id:"form6to",value:F.value,onChange:F.onChange,error:w.siteOperations?.form6ValidityTo?.message})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(_e,{name:"siteOperations.form6Document",control:p,render:({field:F})=>i.jsx(yt,{label:"Form 6 Document",file:F.value,onFileChange:F.onChange,error:w.siteOperations?.form6Document?.message})})})]})]}),i.jsxs("div",{children:[i.jsx(_e,{name:"siteOperations.minWageRevisionApplicable",control:p,render:({field:F})=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:F.value,onChange:F.onChange})," Min. Wage Revision Applicable"]})}),O&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[i.jsx(_e,{name:"siteOperations.minWageRevisionValidityFrom",control:p,render:({field:F})=>i.jsx(kn,{label:"Valid From",id:"minwagefrom",value:F.value,onChange:F.onChange,error:w.siteOperations?.minWageRevisionValidityFrom?.message})}),i.jsx(_e,{name:"siteOperations.minWageRevisionValidityTo",control:p,render:({field:F})=>i.jsx(kn,{label:"Valid To",id:"minwageto",value:F.value,onChange:F.onChange,error:w.siteOperations?.minWageRevisionValidityTo?.message})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(_e,{name:"siteOperations.minWageRevisionDocument",control:p,render:({field:F})=>i.jsx(yt,{label:"Min. Wage Document",file:F.value,onFileChange:F.onChange,error:w.siteOperations?.minWageRevisionDocument?.message})})})]})]})]})}),i.jsx(wR,{title:"Holidays",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx(je,{label:"Number of National & Festival Holidays",id:"holiday-count",type:"number",registration:d("siteOperations.holidays.numberOfDays")}),i.jsxs(Ke,{label:"Salary Payment for Holiday",id:"holiday-salary",registration:d("siteOperations.holidays.salaryPayment"),children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Full Payment"}),i.jsx("option",{children:"Duty Payment"}),i.jsx("option",{children:"Nil Payment"})]}),i.jsxs(Ke,{label:"Billing for Holiday",id:"holiday-billing",registration:d("siteOperations.holidays.billing"),children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Full Payment"}),i.jsx("option",{children:"Duty Payment"}),i.jsx("option",{children:"Nil Payment"})]}),i.jsx("h5",{className:"font-semibold pt-2 border-t",children:"Holiday List"}),j.map((F,V)=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[i.jsx("div",{className:"col-span-6",children:i.jsx(je,{label:"Description",id:`holiday-desc-${V}`,...d(`siteOperations.holidays.list.${V}.description`)})}),i.jsx("div",{className:"col-span-5",children:i.jsx(_e,{name:`siteOperations.holidays.list.${V}.date`,control:p,render:({field:U})=>i.jsx(kn,{label:"Date",id:`holiday-date-${V}`,value:U.value,onChange:U.onChange})})}),i.jsx("div",{className:"col-span-1",children:i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>P(V),children:i.jsx(rn,{className:"h-4 text-red-500"})})})]},F.id)),i.jsxs(se,{type:"button",variant:"outline",size:"sm",onClick:()=>T({id:`hol_${Date.now()}`,date:"",description:""}),children:[i.jsx(Bt,{className:"h-4 mr-1"})," Add Holiday"]})]})})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[i.jsx(se,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(se,{type:"submit",children:"Save Configuration"})]})]})})}):null},rse=({isOpen:n,onClose:e,siteName:t,details:r,isLoading:s,onSave:a,designations:o})=>{const[l,c]=E.useState([]),[d,h]=E.useState(!1),p=E.useRef(null),[x,v]=E.useState(!1),w=E.useMemo(()=>{const I=new Set;return o.filter(q=>I.has(q.designation)?!1:(I.add(q.designation),!0)).sort((q,F)=>q.designation.localeCompare(F.designation))},[o]),_=()=>{const I=p.current;if(I){const q=I.scrollHeight>I.clientHeight,F=I.scrollHeight-I.scrollTop<=I.clientHeight+1;v(q&&!F)}else v(!1)};E.useEffect(()=>{if(n){c(JSON.parse(JSON.stringify(r)));const I=setTimeout(_,150);return()=>clearTimeout(I)}},[r,n,s]);const j=(I,q,F)=>{const V=[...l],U=V[I];if(q==="count"){const W=Number(F);U.count=isNaN(W)?0:W}else U.designation=String(F);c(V)},T=()=>{c([...l,{designation:"",count:0,tempId:`new_${Date.now()}`}]),setTimeout(_,50)},P=I=>{const q=l.filter((F,V)=>V!==I);c(q),setTimeout(_,50)},D=async()=>{h(!0);const I=l.filter(q=>q.designation.trim()!=="").map(({tempId:q,...F})=>F);await a(I),h(!1)},M=ot.useMemo(()=>l.reduce((I,q)=>I+(Number(q.count)||0),0),[l]),O=I=>{if(I.key!=="ArrowUp"&&I.key!=="ArrowDown")return;const q=I.target;if(q.tagName!=="INPUT"&&q.tagName!=="SELECT")return;const F=q.getAttribute("data-row-index"),V=q.getAttribute("data-col-index");if(!F||!V||q.type==="number")return;I.preventDefault();const U=I.currentTarget,W=parseInt(F,10),$=parseInt(V,10),ne=I.key==="ArrowUp"?W-1:W+1,Y=U.querySelector(`[data-row-index="${ne}"][data-col-index="${$}"]`);Y&&Y.focus()};return n?i4.createPortal(i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm sm:max-w-lg md:max-w-2xl m-4 animate-fade-in-scale flex flex-col",onClick:I=>I.stopPropagation(),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Allocate Manpower"}),i.jsxs("p",{className:"text-sm text-muted mb-4",children:["For site: ",t]}),i.jsxs("div",{className:"flex-grow relative overflow-hidden",children:[i.jsx("div",{ref:p,onScroll:_,onKeyDown:O,className:"overflow-y-auto pr-2 min-h-[300px] max-h-[60vh] h-full",children:s?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-12 gap-4 sticky top-0 bg-page p-2 rounded-t-lg z-10",children:[i.jsx("div",{className:"col-span-6 font-medium text-sm text-muted",children:"Designation"}),i.jsx("div",{className:"col-span-4 font-medium text-sm text-muted",children:"Count"}),i.jsx("div",{className:"col-span-2"})]}),l.length>0?l.map((I,q)=>i.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[i.jsx("div",{className:"col-span-6",children:i.jsxs(Ke,{id:`designation-${q}`,value:I.designation,onChange:F=>j(q,"designation",F.target.value),className:"py-1.5","data-row-index":q,"data-col-index":0,"aria-label":`Designation for row ${q+1}`,children:[i.jsx("option",{value:"",children:"Select Designation"}),w.map(F=>i.jsx("option",{value:F.designation,children:F.designation},F.id))]})}),i.jsx("div",{className:"col-span-4",children:i.jsx(je,{id:`count-${q}`,type:"number",value:I.count,onChange:F=>j(q,"count",F.target.value),min:"0",step:"0.01",className:"py-1.5","data-row-index":q,"data-col-index":1,"aria-label":`Count for row ${q+1}`})}),i.jsx("div",{className:"col-span-2 text-right",children:i.jsx(se,{variant:"icon",size:"sm",onClick:()=>P(q),title:"Remove row","aria-label":`Remove row ${q+1}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},I.tempId||q)):i.jsx("p",{className:"text-center text-muted py-10",children:"No designations added yet. Click below to start."}),i.jsxs(se,{variant:"outline",size:"sm",onClick:T,className:"mt-4",children:[i.jsx(Bt,{className:"h-4 w-4 mr-2"})," Add Designation"]})]})}),x&&i.jsx("div",{className:"absolute bottom-0 left-0 right-2 h-16 bg-gradient-to-t from-card to-transparent pointer-events-none"})]}),i.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-between items-center",children:[i.jsxs("div",{className:"font-semibold",children:["Total Manpower: ",i.jsx("span",{className:"text-accent",children:M.toFixed(2)})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx(se,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),i.jsx(se,{onClick:D,isLoading:d,disabled:s,children:"Save Changes"})]})]})]})}),document.getElementById("modal-root")):null},wN=["id","shortName","fullName","address","manpowerApprovedCount","reportingManagerName","managerName","fieldOfficerNames","backendFieldOfficerNames"],sse=(n,e)=>{const t=e.join(","),r=n.map(s=>e.map(a=>{let o=s[a];return Array.isArray(o)&&(o=o.join(";")),o=o==null?"":String(o),o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...r].join(`
`)},ise=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,"")),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),a[l]=d}),r.push(a)}return r},ase=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState([]),[d,h]=E.useState(!0),[p,x]=E.useState(!1),[v,w]=E.useState(!1),[_,j]=E.useState(!1),[T,P]=E.useState(null),[D,M]=E.useState(null),[O,I]=E.useState(null),[q,F]=E.useState([]),[V,U]=E.useState(!1),W=E.useRef(null),$=Ft("(max-width: 767px)"),{siteManagement:ne}=gi(),Y=E.useCallback(async()=>{h(!0);try{const[re,de,ce,pe]=await Promise.all([ue.getOrganizations().catch(xe=>(console.error("Failed to fetch organizations:",xe),[])),ue.getOrganizationStructure().catch(xe=>(console.error("Failed to fetch organization structure:",xe),[])),ue.getSiteConfigurations().catch(xe=>(console.error("Failed to fetch site configurations:",xe),[])),ue.getSiteStaffDesignations().catch(xe=>(console.error("Failed to fetch site staff designations:",xe),I({message:"Could not load designation list. Manpower editing may be affected.",type:"error"}),[]))]);t(re),s(ce),c(pe);const ie=de.flatMap(xe=>xe.companies.flatMap(Ce=>Ce.entities.map(ve=>({...ve,companyName:Ce.name}))));o(ie)}catch{I({message:"An unexpected error occurred while fetching data.",type:"error"})}finally{h(!1)}},[]);E.useEffect(()=>{Y()},[Y]);const ae=re=>{P(re),x(!0)},J=re=>{M(re),w(!0)},ee=(re,de)=>{s(ce=>{const pe=[...ce],ie=pe.findIndex(xe=>xe.organizationId===re);return ie>-1?pe[ie]=de:pe.push(de),pe}),I({message:"Site configuration saved.",type:"success"}),x(!1)},X=async()=>{D&&(t(re=>re.filter(de=>de.id!==D.id)),s(re=>re.filter(de=>de.organizationId!==D.id)),I({message:"Site deleted.",type:"success"}),w(!1))},Z=async re=>{M(re),U(!0),j(!0);try{const de=await ue.getManpowerDetails(re.id);F(de)}catch{I({message:"Could not load manpower details.",type:"error"})}finally{U(!1)}},oe=async re=>{if(D)try{await ue.updateManpowerDetails(D.id,re);const de=re.reduce((ce,pe)=>ce+(Number(pe.count)||0),0);t(ce=>ce.map(pe=>pe.id===D.id?{...pe,manpowerApprovedCount:de}:pe)),j(!1),I({message:"Manpower details updated successfully.",type:"success"})}catch{I({message:"Failed to save manpower details.",type:"error"})}},H=()=>{const re=sse(e,wN),de=new Blob([re],{type:"text/csv;charset=utf-8;"}),ce=document.createElement("a");ce.href=URL.createObjectURL(de),ce.setAttribute("download","sites_export.csv"),document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),I({message:"Sites exported successfully.",type:"success"})},Q=re=>{const de=re.target.files?.[0];if(!de)return;const ce=new FileReader;ce.onload=async pe=>{try{const ie=pe.target?.result;if(!ie)throw new Error("File is empty or could not be read.");const xe=ise(ie);if(xe.length===0)throw new Error("No data rows found in the CSV file.");const Ce=Object.keys(xe[0]);if(!wN.every(Ie=>Ce.includes(Ie)))throw new Error(`CSV is missing headers. Required: ${wN.join(", ")}`);const Oe=xe.map(Ie=>({id:Ie.id,shortName:Ie.shortName,fullName:Ie.fullName,address:Ie.address,manpowerApprovedCount:parseFloat(Ie.manpowerApprovedCount)||0,reportingManagerName:Ie.reportingManagerName||void 0,managerName:Ie.managerName||void 0,fieldOfficerNames:Ie.fieldOfficerNames?Ie.fieldOfficerNames.split(";").map(Fe=>Fe.trim()).filter(Fe=>Fe):void 0,backendFieldOfficerNames:Ie.backendFieldOfficerNames?Ie.backendFieldOfficerNames.split(";").map(Fe=>Fe.trim()).filter(Fe=>Fe):void 0})),{count:Pe}=await ue.bulkUploadOrganizations(Oe);I({message:`${Pe} sites imported/updated successfully.`,type:"success"}),Y()}catch(ie){I({message:ie.message||"Failed to import CSV.",type:"error"})}finally{re.target&&(re.target.value="")}},ce.readAsText(de)};return i.jsxs("div",{className:"p-4 md:p-8",children:[O&&i.jsx(ht,{message:O.message,type:O.type,onDismiss:()=>I(null)}),i.jsx("input",{type:"file",ref:W,className:"hidden",accept:".csv",onChange:Q}),i.jsx("input",{type:"file",ref:W,className:"hidden",accept:".csv",onChange:Q}),p&&T&&i.jsx(s6,{isOpen:p,onClose:()=>x(!1),onSave:ee,organization:T,allClients:a,initialData:r.find(re=>re.organizationId===T.id)}),D&&i.jsx(rse,{isOpen:_,onClose:()=>j(!1),siteName:D.shortName,details:q,isLoading:V,onSave:oe,designations:l}),i.jsxs(Yr,{isOpen:v,onClose:()=>w(!1),onConfirm:X,title:"Confirm Deletion",children:['Are you sure you want to delete the site "',D?.shortName,'"? This action cannot be undone.']}),i.jsxs("div",{className:"bg-card p-4 rounded-2xl mb-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Site Management"}),!$&&i.jsxs("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:[i.jsxs(se,{variant:"outline",onClick:()=>n("/admin/sites/quick-add"),className:"mr-2 hover:bg-gray-100",children:[i.jsx(Bt,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),i.jsxs(se,{onClick:()=>n("/admin/sites/add"),className:"mr-2 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[i.jsx(Bt,{className:"w-5 h-5 mr-2"}),"Add Site"]}),i.jsxs(se,{variant:"outline",onClick:()=>W.current?.click(),className:"mr-2 hover:bg-gray-100",children:[i.jsx(Wc,{className:"w-5 h-5 mr-2"}),"Import"]}),i.jsxs(se,{variant:"outline",onClick:H,className:"hover:bg-gray-100",children:[i.jsx(yi,{className:"w-5 h-5 mr-2"}),"Export"]})]})]}),$&&i.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[i.jsxs(se,{onClick:()=>n("/admin/sites/add"),className:"w-full justify-center bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[i.jsx(Bt,{className:"w-5 h-5 mr-2"}),"Add Site"]}),i.jsxs(se,{variant:"outline",onClick:()=>n("/admin/sites/quick-add"),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(Bt,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs(se,{variant:"outline",onClick:()=>W.current?.click(),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(Wc,{className:"w-5 h-5 mr-2"}),"Import"]}),i.jsxs(se,{variant:"outline",onClick:H,className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(yi,{className:"w-5 h-5 mr-2"}),"Export"]})]})]})]}),i.jsx("div",{className:"bg-card rounded-2xl shadow-sm border border-border overflow-hidden",children:d?i.jsx("div",{className:"overflow-x-auto",children:i.jsx("table",{className:"w-full",children:i.jsx("tbody",{className:"divide-y divide-border",children:i.jsx(Oa,{cols:5,rows:5})})})}):e.length===0?i.jsxs("div",{className:"p-8 text-center text-muted",children:[i.jsx(Hi,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),i.jsx("p",{children:"No sites found. Add a new site to get started."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-muted/50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Location"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-muted uppercase tracking-wider",children:"Manpower"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Key Staff"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:e.map(re=>{r.find(pe=>pe.organizationId===re.id);const de=!!re.provisionalCreationDate,ce=de&&re.provisionalCreationDate?90-KB(new Date,new Date(re.provisionalCreationDate)):0;return i.jsxs("tr",{className:"hover:bg-muted/5 transition-colors",children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center",children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-primary-text",children:re.shortName}),i.jsx("div",{className:"text-xs text-muted",children:re.fullName}),de&&i.jsxs("div",{className:`mt-1 text-xs px-2 py-0.5 rounded-full inline-flex items-center gap-1 ${ce>30?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[i.jsx(e3,{className:"w-3 h-3"}),ce>0?`${ce} days left`:"Expired"]})]})})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"text-sm text-primary-text max-w-xs truncate",title:re.address,children:re.address})}),i.jsx("td",{className:"px-6 py-4 text-center",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:re.manpowerApprovedCount||0})}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"text-xs space-y-1",children:[re.reportingManagerName&&i.jsxs("div",{className:"flex items-center gap-1",title:"Reporting Manager",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:"RM:"})," ",re.reportingManagerName]}),re.managerName&&i.jsxs("div",{className:"flex items-center gap-1",title:"Site Manager",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:"SM:"})," ",re.managerName]}),re.fieldOfficerNames&&re.fieldOfficerNames.length>0&&i.jsxs("div",{className:"flex items-start gap-1",title:"Field Officers",children:[i.jsx("span",{className:"font-semibold text-primary-text whitespace-nowrap",children:"FO:"}),i.jsx("span",{className:"truncate max-w-[150px]",children:re.fieldOfficerNames.join(", ")})]}),re.backendFieldOfficerNames&&re.backendFieldOfficerNames.length>0&&i.jsxs("div",{className:"flex items-start gap-1",title:"Backend Field Officers",children:[i.jsx("span",{className:"font-semibold text-primary-text whitespace-nowrap",children:"BFO:"}),i.jsx("span",{className:"truncate max-w-[150px]",children:re.backendFieldOfficerNames.join(", ")})]})]})}),i.jsx("td",{className:"px-6 py-4 text-right whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx(se,{variant:"icon",size:"sm",onClick:()=>Z(re),title:"Manpower Details",children:i.jsx(Gi,{className:"w-4 h-4 text-blue-600"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>ae(re),title:"Configure Site",children:i.jsx(Dm,{className:"w-4 h-4 text-gray-600"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>J(re),title:"Delete Site",children:i.jsx(rn,{className:"w-4 h-4 text-red-600"})})]})})]},re.id)})})]})})})]})},ose=({isOpen:n,onClose:e,onSave:t,title:r,initialName:s=""})=>{const[a,o]=E.useState(s),[l,c]=E.useState("");E.useEffect(()=>{n&&(o(s),c(""))},[n,s]);const d=()=>{if(!a.trim()){c("Role name cannot be empty.");return}t(a.trim()),e()};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm m-4 animate-fade-in-scale",onClick:h=>h.stopPropagation(),children:i.jsxs("form",{onSubmit:h=>{h.preventDefault(),d()},children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-4",children:r}),i.jsx(je,{label:"Role Display Name",id:"role-name",value:a,onChange:h=>o(h.target.value),error:l,autoFocus:!0}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(se,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(se,{type:"submit",children:"Save"})]})]})})}):null},wm=[{key:"apply_for_leave",name:"Apply for Leave",description:"Allows users to request time off."},{key:"create_enrollment",name:"Create Enrollment",description:"Access the multi-step form to onboard new employees."},{key:"view_developer_settings",name:"Developer Settings",description:"Access API settings and other developer tools."},{key:"download_attendance_report",name:"Download Attendance Report",description:"Generate and download attendance reports in CSV format."},{key:"manage_approval_workflow",name:"Manage Approval Workflow",description:"Set up reporting managers for leave approvals."},{key:"manage_attendance_rules",name:"Manage Attendance Rules",description:"Set work hours, holidays, and leave allocations."},{key:"manage_enrollment_rules",name:"Manage Enrollment Rules",description:"Set rules for ESI/GMC, manpower limits, and documents."},{key:"manage_insurance",name:"Manage Insurance",description:"Create and manage company insurance plans."},{key:"manage_leave_requests",name:"Manage Leave Requests",description:"Approve or reject leave requests for employees."},{key:"manage_modules",name:"Manage Modules",description:"Create, edit, and group permissions into modules."},{key:"manage_policies",name:"Manage Policies",description:"Create and manage company policies."},{key:"manage_roles_and_permissions",name:"Manage Roles & Permissions",description:"Access this page to edit role permissions."},{key:"manage_sites",name:"Manage Sites",description:"Create, edit, and delete organizations/sites."},{key:"manage_tasks",name:"Manage Tasks",description:"Create, assign, and manage all organizational tasks, including escalations."},{key:"manage_uniforms",name:"Manage Uniforms",description:"Manage uniform requests and site configurations."},{key:"manage_users",name:"Manage Users",description:"Create, edit, and delete user accounts."},{key:"view_operations_dashboard",name:"Operations Dashboard",description:"View the operations management dashboard."},{key:"view_site_dashboard",name:"Site Dashboard",description:"View the dashboard for a specific site/organization."},{key:"view_all_attendance",name:"View All Attendance",description:"Allows users to see attendance records for all employees."},{key:"view_all_submissions",name:"View All Submissions",description:"Access the main dashboard to view all employee submissions."},{key:"view_entity_management",name:"View Entity Management",description:"Access the HR dashboard for managing company entities."},{key:"view_field_officer_tracking",name:"View Field Officer Tracking",description:"Track user check-in/out locations and activity on a map."},{key:"view_invoice_summary",name:"View Invoice Summary",description:"View and generate monthly invoices for sites."},{key:"view_own_attendance",name:"View Own Attendance",description:"Allows users to see their own attendance records."},{key:"view_verification_costing",name:"View Verification Costing",description:"Analyze costs associated with third-party document verifications."}].sort((n,e)=>n.name.localeCompare(e.name)),lse=()=>{const n=St(),{permissions:e,setRolePermissions:t,addRolePermissionEntry:r,removeRolePermissionEntry:s,renameRolePermissionEntry:a}=Ji(),[o,l]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState(!0),[x,v]=E.useState(null),[w,_]=E.useState(!1),[j,T]=E.useState(!1),[P,D]=E.useState(null),[M,O]=E.useState(!1),[I,q]=E.useState(null),F=E.useRef(null),V=Ft("(max-width: 767px)");E.useEffect(()=>{(async()=>{p(!0);try{const[ee,X]=await Promise.all([ue.getRoles(),ue.getModules()]);l(ee),d(X.sort((Z,oe)=>Z.name.localeCompare(oe.name)))}catch(ee){console.error("Failed to load data",ee),v({message:"Failed to load page data.",type:"error"})}finally{p(!1)}})()},[]),E.useEffect(()=>{const J=ee=>{F.current&&!F.current.contains(ee.target)&&q(null)};return document.addEventListener("mousedown",J),()=>document.removeEventListener("mousedown",J)},[]);const U=(J,ee,X)=>{const Z=e[J]||[],oe=X?[...Z,ee]:Z.filter(H=>H!==ee);t(J,oe)},W=async J=>{const ee=J.toLowerCase().replace(/\s+/g,"_");if(M&&P){if(P.id==="admin"){v({message:"The Admin role cannot be renamed.",type:"error"});return}if(o.some(Z=>Z.id===ee&&Z.id!==P.id)){v({message:`A role with ID '${ee}' already exists.`,type:"error"});return}const X=o.map(Z=>Z.id===P.id?{...Z,displayName:J,id:ee}:Z);await ue.saveRoles(X),l(X),a(P.id,ee),v({message:"Role renamed.",type:"success"})}else{if(o.some(oe=>oe.id===ee)){v({message:`A role with ID '${ee}' already exists.`,type:"error"});return}const X={id:ee,displayName:J},Z=[...o,X];await ue.saveRoles(Z),l(Z),r(X),v({message:"Role added successfully.",type:"success"})}},$=async()=>{if(!P||P.id==="admin"){v({message:"This role cannot be deleted.",type:"error"}),T(!1);return}const J=o.filter(ee=>ee.id!==P.id);await ue.saveRoles(J),l(J),s(P.id),v({message:`Role '${P.displayName}' deleted.`,type:"success"}),T(!1)},ne=E.useMemo(()=>new Map(wm.map(J=>[J.key,J])),[]),Y=E.useMemo(()=>{const J=new Set(c.flatMap(ee=>ee.permissions));return wm.filter(ee=>!J.has(ee.key))},[c]),ae=J=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Permission",className:"px-4 py-4",children:i.jsxs("div",{className:"flex flex-col items-end text-right md:items-start md:text-left",children:[i.jsx("div",{className:"font-semibold text-primary-text",children:J.name}),i.jsx("div",{className:"text-xs text-muted",children:J.description})]})}),o.map(ee=>{const X=e[ee.id]?.includes(J.key),Z=ee.id==="admin",oe=Z?"Admin role has all permissions by default and cannot be changed.":"";return i.jsx("td",{"data-label":ee.displayName,className:"px-4 py-4 text-center align-middle",children:i.jsx("div",{className:"flex justify-center",children:i.jsxs("label",{className:`relative flex items-center justify-center w-5 h-5 ${Z?"cursor-not-allowed":"cursor-pointer"}`,children:[i.jsx("input",{type:"checkbox",className:"sr-only peer",checked:X,onChange:H=>U(ee.id,J.key,H.target.checked),disabled:Z,title:oe}),i.jsx("span",{className:`w-5 h-5 bg-white border border-gray-300 rounded flex items-center justify-center peer-focus-visible:ring-2 peer-focus-visible:ring-offset-2 peer-focus-visible:ring-accent-dark peer-checked:border-accent ${Z?"opacity-50":""}`,children:X?i.jsx(_l,{className:"w-4 h-4 text-accent"}):i.jsx(xi,{className:"w-4 h-4 text-red-500"})})]})})},ee.id)})]},J.key);return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)}),i.jsx(ose,{isOpen:w,onClose:()=>_(!1),onSave:W,title:M?"Rename Role":"Add New Role",initialName:M?P?.displayName:""}),i.jsxs(Yr,{isOpen:j,onClose:()=>T(!1),onConfirm:$,title:"Confirm Deletion",children:['Are you sure you want to delete the role "',P?.displayName,'"? This action cannot be undone.']}),i.jsx(Qi,{title:"Role & Permission Management",children:i.jsxs("button",{onClick:()=>n("/admin/roles/add"),className:"btn btn-primary btn-md",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Role"]})}),i.jsx("p",{className:"text-muted text-sm -mt-4 mb-6",children:"Assign permissions to user roles. Changes are saved automatically."}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-4 py-3 text-left font-bold text-primary-text",children:"Permission"}),o.map(J=>i.jsx("th",{scope:"col",className:"px-4 py-3 text-center font-bold text-primary-text w-40",children:i.jsxs("div",{className:"flex items-center justify-center gap-1",children:[i.jsx("span",{children:J.displayName}),J.id!=="admin"&&i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>q(J.id===I?null:J.id),children:i.jsx(gJ,{className:"h-4 w-4 text-muted"})}),I===J.id&&i.jsxs("div",{ref:F,className:"absolute right-0 mt-2 w-32 bg-card border rounded-md shadow-lg z-10",children:[i.jsxs("button",{onClick:()=>{n(`/admin/roles/edit/${J.id}`),q(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center",children:[i.jsx(cr,{className:"mr-2 h-4 w-4"}),"Edit"]}),i.jsxs("button",{onClick:()=>{D(J),T(!0),q(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center text-red-600",children:[i.jsx(rn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})},J.id))]})}),h?i.jsx("tbody",{children:V?i.jsx("tr",{children:i.jsx("td",{colSpan:o.length+1||2,children:i.jsx(Oa,{rows:3,cols:2,isMobile:!0})})}):i.jsx(Oa,{rows:10,cols:o.length+1||5})}):i.jsxs(i.Fragment,{children:[c.map(J=>i.jsxs("tbody",{className:"divide-y divide-border",children:[i.jsx("tr",{className:"bg-page/50",children:i.jsx("td",{colSpan:o.length+1,className:"p-2 font-bold text-primary-text",children:J.name})}),J.permissions.map(ee=>{const X=ne.get(ee);return X?ae(X):null})]},J.id)),Y.length>0&&i.jsxs("tbody",{className:"divide-y divide-border",children:[i.jsx("tr",{className:"bg-page/50",children:i.jsx("td",{colSpan:o.length+1,className:"p-2 font-bold text-primary-text",children:"Uncategorized"})}),Y.map(ae)]})]})]})})]})},cse=Pt({id:ge().required(),name:ge().required("Module name is required"),description:ge().required("Description is required"),permissions:_s().of(ge().required()).min(1,"At least one permission must be selected")}).defined(),dse=({isOpen:n,onClose:e,onSave:t,initialData:r})=>{const{register:s,handleSubmit:a,control:o,reset:l,formState:{errors:c}}=tn({resolver:En(cse)});return E.useEffect(()=>{n&&l(r||{id:`mod_${Date.now()}`,name:"",description:"",permissions:[]})},[n,r,l]),n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-2xl my-8 animate-fade-in-scale flex flex-col",onClick:d=>d.stopPropagation(),children:i.jsxs("form",{onSubmit:a(t),children:[i.jsx("div",{className:"p-4 border-b",children:i.jsxs("h3",{className:"text-xl font-bold",children:[r?"Edit":"Add"," Module"]})}),i.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[i.jsx(je,{label:"Module Name",...s("name"),error:c.name?.message}),i.jsx(je,{label:"Description",...s("description"),error:c.description?.message}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Permissions"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 p-4 border rounded-lg h-64 overflow-y-auto bg-page",children:i.jsx(_e,{name:"permissions",control:o,render:({field:d})=>i.jsx(i.Fragment,{children:wm.map(h=>i.jsx(Pn,{id:`perm-${h.key}`,label:h.name,checked:d.value?.includes(h.key)||!1,onChange:p=>{const x=p?[...d.value||[],h.key]:(d.value||[]).filter(v=>v!==h.key);d.onChange(x)}},h.key))})})}),c.permissions&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:Array.isArray(c.permissions)?c.permissions[0]?.message:c.permissions.message})]})]}),i.jsxs("div",{className:"p-4 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(se,{type:"submit",children:"Save Module"})]})]})})}):null},use=({count:n=6})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:n}).map((e,t)=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Hr,{className:"h-5 w-5 rounded-full"}),i.jsx(Hr,{className:"h-5 w-1/2"})]}),i.jsx(Hr,{className:"h-4 w-full"}),i.jsx(Hr,{className:"h-4 w-3/4"}),i.jsx(Hr,{className:"h-3 w-1/4"})]},t))}),fse=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(null),[l,c]=E.useState(!1),[d,h]=E.useState(!1),[p,x]=E.useState(null);E.useEffect(()=>{(async()=>{s(!0);try{const j=await ue.getModules();t(j)}catch{o({message:"Failed to load modules.",type:"error"})}finally{s(!1)}})()},[]);const v=async _=>{const j=[...e],T=j.findIndex(P=>P.id===_.id);T>-1?j[T]=_:j.push(_);try{await ue.saveModules(j),t(j.sort((P,D)=>P.name.localeCompare(D.name))),o({message:`Module '${_.name}' saved.`,type:"success"}),c(!1)}catch{o({message:"Failed to save module.",type:"error"})}},w=async()=>{if(!p)return;const _=e.filter(j=>j.id!==p.id);try{await ue.saveModules(_),t(_),o({message:`Module '${p.name}' deleted.`,type:"success"}),h(!1)}catch{o({message:"Failed to delete module.",type:"error"})}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a&&i.jsx(ht,{...a,onDismiss:()=>o(null)}),i.jsx(dse,{isOpen:l,onClose:()=>c(!1),onSave:v,initialData:p}),i.jsxs(Yr,{isOpen:d,onClose:()=>h(!1),onConfirm:w,title:"Confirm Deletion",children:['Are you sure you want to delete the module "',p?.name,'"?']}),i.jsx(Qi,{title:"Module Management",children:i.jsxs(se,{onClick:()=>n("/admin/modules/add"),children:[i.jsx(Bt,{className:"mr-2 h-4"})," Add Module"]})}),r?i.jsx(use,{count:6}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(_=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col",children:[i.jsxs("div",{className:"flex-grow",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx(xm,{className:"h-5 w-5 text-accent"}),i.jsx("h4",{className:"font-bold text-primary-text",children:_.name})]}),i.jsx("p",{className:"text-sm text-muted mb-3",children:_.description}),i.jsxs("p",{className:"text-xs font-semibold text-muted",children:[_.permissions.length," permissions"]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border flex justify-end gap-2",children:[i.jsx(se,{variant:"icon",onClick:()=>{x(_),c(!0)},title:`Edit ${_.name}`,className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(cr,{className:"h-5 w-5"})}),i.jsx(se,{variant:"icon",onClick:()=>{x(_),h(!0)},title:`Delete ${_.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]},_.id))})]})},_N=({title:n,icon:e,children:t})=>i.jsxs("div",{className:"bg-page p-4 rounded-lg",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(e,{className:"h-5 w-5 text-accent-dark mr-3"}),i.jsx("h4",{className:"font-semibold text-primary-text",children:n})]}),i.jsx("div",{className:"space-y-4",children:t})]}),hse=({isOpen:n,onClose:e})=>{const{currentLogo:t,defaultLogo:r,setCurrentLogo:s,setDefaultLogo:a,resetToDefault:o,resetToOriginal:l}=OC(),{backgroundImages:c,addBackgroundImage:d,removeBackgroundImage:h}=j3(),p=b3(),[x,v]=E.useState(null),w=D=>{if(D){const M=new FileReader;M.readAsDataURL(D.file),M.onloadend=()=>{const O=M.result;s(O),v({message:"Active logo updated!",type:"success"})},M.onerror=()=>{v({message:"Failed to read logo file.",type:"error"})}}},_=()=>{a(),v({message:"Active logo has been set as the new default.",type:"success"})},j=()=>{o(),v({message:"Logo has been reset to your default.",type:"success"})},T=()=>{l(),v({message:"Logo has been reset to the system original.",type:"success"})},P=D=>{if(D&&!D.url){const M=new FileReader;M.readAsDataURL(D.file),M.onloadend=()=>{const O=M.result,I=d(O);v(I?{message:"Background image added.",type:"success"}:{message:"This image has already been added.",type:"error"})},M.onerror=()=>{v({message:"Failed to read image file.",type:"error"})}}};return n?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:[x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)}),i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale flex flex-col",onClick:D=>D.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Page Interface Settings"}),i.jsx(se,{variant:"icon",onClick:e,children:i.jsx(xi,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[75vh]",children:[i.jsxs(_N,{title:"Branding & Logo",icon:o3,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the active and default logos for your application."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pt-4 items-start",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Active Logo"}),i.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:i.jsx("img",{src:t,alt:"Current Active Logo",className:"max-h-24 w-auto"})}),i.jsx(yt,{label:"Change Active Logo",file:null,onFileChange:w,allowedTypes:["image/jpeg","image/png"]})]}),i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Default Logo"}),i.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:i.jsx("img",{src:r,alt:"Default Logo",className:"max-h-24 w-auto"})})]}),i.jsx("div",{className:"flex-grow"}),i.jsxs("div",{className:"space-y-2 mt-4",children:[i.jsx(se,{type:"button",className:"w-full",onClick:_,children:"Set Active Logo as Default"}),i.jsx(se,{type:"button",className:"w-full",variant:"outline",onClick:j,children:"Use Default Logo"}),i.jsx("div",{className:"text-center pt-2",children:i.jsx("button",{type:"button",onClick:T,className:"text-xs text-muted hover:text-primary-text underline",children:"Reset to System Original"})})]})]})]})]}),i.jsxs(_N,{title:"Login Screen Background",icon:l3,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the background images for the login screen carousel."}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:c.map((D,M)=>i.jsxs("div",{className:"relative group aspect-video bg-page rounded-md overflow-hidden",children:[i.jsx("img",{src:D,className:"w-full h-full object-cover",alt:`Background ${M+1}`}),i.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:i.jsx(se,{variant:"icon",onClick:()=>h(M),className:"!rounded-full !bg-white/20 hover:!bg-white/40",children:i.jsx(rn,{className:"h-5 w-5 text-white"})})})]},`${D.substring(0,30)}-${M}`))}),i.jsx("div",{className:"mt-4",children:i.jsx(yt,{label:"Add new background image",file:null,onFileChange:P,allowedTypes:["image/jpeg","image/png","image/webp"]})})]}),i.jsxs(_N,{title:"Interaction Settings",icon:PJ,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize hover and auto-scroll behaviors for easier navigation."}),i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsx(Pn,{id:"auto-click-hover-modal",label:"Enable Auto-Click on Hover",description:"Automatically switch tabs or pages by hovering over them.",checked:p.autoClickOnHover,onChange:p.setAutoClickOnHover}),i.jsx(Pn,{id:"auto-scroll-hover-modal",label:"Enable Auto-Scroll on Hover",description:"Automatically scroll the page by hovering over the up/down arrows.",checked:p.autoScrollOnHover,onChange:p.setAutoScrollOnHover})]})]})]}),i.jsx("div",{className:"p-4 border-t flex justify-end",children:i.jsx(se,{variant:"primary",onClick:e,children:"Done"})})]})]}):null},Qu=({title:n,icon:e,children:t,className:r})=>i.jsxs("div",{className:`border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card ${r||""}`,children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(e,{className:"h-6 w-6 text-accent-dark"})}),i.jsx("div",{children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:n})})]}),i.jsx("div",{className:"space-y-4",children:t})]}),mse=()=>{const n=gi(),[e,t]=E.useState(!1),[r,s]=E.useState(null),[a,o]=E.useState(!1),l=async()=>{t(!0),s(null);try{const c=await ue.exportAllData(),d=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(c,null,2))}`,h=document.createElement("a");h.href=d,h.download=`paradigm_backup_${new Date().toISOString()}.json`,document.body.appendChild(h),h.click(),document.body.removeChild(h),s({message:"Data exported successfully!",type:"success"})}catch{s({message:"Failed to export data.",type:"error"})}finally{t(!1)}};return i.jsxs("div",{className:"space-y-8 p-4 md:p-0",children:[r&&i.jsx(ht,{message:r.message,type:r.type,onDismiss:()=>s(null)}),i.jsx(hse,{isOpen:a,onClose:()=>o(!1)}),i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"System Settings"})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[i.jsxs("div",{className:"space-y-8",children:[i.jsxs(Qu,{title:"Page Interface",icon:o3,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize the application's branding, login screen, and user interaction settings."}),i.jsx("div",{className:"pt-4",children:i.jsx(se,{type:"button",onClick:()=>o(!0),children:"Open Interface Settings"})})]}),i.jsxs(Qu,{title:"Verification APIs",icon:oy,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure third-party services for employee verification."}),i.jsxs("div",{className:"space-y-6 pt-4",children:[i.jsx("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:i.jsx(Pn,{id:"gemini-enabled",label:"Enable Gemini API OCR Verification",description:"Use Google's Gemini API for document data extraction. This is a powerful fallback or primary OCR. API key must be configured on the backend.",checked:n.geminiApi.enabled,onChange:c=>n.updateGeminiApiSettings({enabled:c})})}),i.jsxs("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:[i.jsx(Pn,{id:"perfios-enabled",label:"Enable Perfios API Verification",description:"Use Perfios for Bank, Aadhaar, and UAN verification.",checked:n.perfiosApi.enabled,onChange:c=>n.updatePerfiosApiSettings({enabled:c})}),i.jsxs("div",{className:`mt-4 space-y-4 transition-opacity ${n.perfiosApi.enabled?"opacity-100":"opacity-50 pointer-events-none"}`,children:[i.jsx(je,{label:"Perfios Client ID",value:n.perfiosApi.clientId,onChange:c=>n.updatePerfiosApiSettings({clientId:c.target.value})}),i.jsx(je,{label:"Perfios Client Secret",type:"password",value:n.perfiosApi.clientSecret,onChange:c=>n.updatePerfiosApiSettings({clientSecret:c.target.value})})]})]})]})]}),i.jsxs(Qu,{title:"Authentication Settings",icon:Ef,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage how users sign in to the application."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Pn,{id:"otp-enabled",label:"Enable OTP Phone Sign-In",description:"Allow users to sign in using a one-time password sent via SMS.",checked:n.otp.enabled,onChange:c=>n.updateOtpSettings({enabled:c})})})]})]}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs(Qu,{title:"Client & Site Management",icon:Hi,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Control workflows for site creation and management."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Pn,{id:"enable-provisional-sites",label:"Enable Provisional Site Creation",description:"Allows HR/Admins to create a site with just a name, providing a 90-day grace period to complete the full configuration for easier onboarding.",checked:n.siteManagement.enableProvisionalSites,onChange:c=>n.updateSiteManagementSettings({enableProvisionalSites:c})})})]}),i.jsxs(Qu,{title:"System & Data",icon:Dm,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage core system settings and data operations."}),i.jsxs("div",{className:"space-y-6 pt-4",children:[i.jsx(Pn,{id:"pincode-verification",label:"Enable Pincode API Verification",description:"Auto-fill City/State from pincode during onboarding.",checked:n.address.enablePincodeVerification,onChange:c=>n.updateAddressSettings({enablePincodeVerification:c})}),i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:"Backup & Export"}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Download all data from the active data source (Mock Data)."}),i.jsxs(se,{type:"button",variant:"outline",onClick:l,isLoading:e,children:[i.jsx(yi,{className:"mr-2 h-4 w-4"})," Export All Data"]})]})]})]}),i.jsxs(Qu,{title:"Notification Settings",icon:Bf,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure how the system sends notifications."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Pn,{id:"email-notif-enabled",label:"Enable Email Notifications",description:"Send emails for important events like task assignments. SMTP must be configured on the backend.",checked:n.notifications.email.enabled,onChange:c=>n.updateNotificationSettings({email:{enabled:c}})})})]})]})]})]})},Pr=({title:n,subtitle:e})=>i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text form-header-title",children:n}),i.jsx("p",{className:"mt-2 text-sm text-muted",children:e})]}),pse=({title:n,value:e,icon:t})=>i.jsxs("div",{className:"bg-card p-4 rounded-2xl flex flex-col md:flex-row items-start md:items-center col-span-1 gap-3 md:gap-0",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light md:mr-4",children:i.jsx(t,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-muted font-medium",children:n}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:e})]})]}),_o=ot.memo(pse),gse=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState(null),[p,x]=E.useState([{startDate:new Date(new Date().setMonth(new Date().getMonth()-1)),endDate:new Date,key:"selection"}]),[v,w]=E.useState(!1),[_,j]=E.useState(""),[T,P]=E.useState(""),[D,M]=E.useState($e(new Date,"yyyy-MM-dd"));E.useEffect(()=>{(async()=>{c(!0);try{const[U,W,$]=await Promise.all([ue.getVerificationSubmissions(),ue.getFieldOfficers(),ue.getOrganizations()]);t(U),s(W),o($)}catch{h({message:"Failed to load dashboard data.",type:"error"})}finally{c(!1)}})()},[]);const O=E.useMemo(()=>{const V=p[0].startDate,U=p[0].endDate;if(!V||!U)return e;const W=new Date(U);return W.setHours(23,59,59,999),e.filter($=>{const ne=new Date($.enrollmentDate.replace(/-/g,"/"));return ne>=V&&ne<=W})},[e,p]),I=E.useMemo(()=>({total:O.length,verified:O.filter(V=>V.status==="verified").length,rejected:O.filter(V=>V.status==="rejected").length}),[O]),q=async V=>{if(V.preventDefault(),!_||!T||!D){h({message:"Please fill all fields for assignment.",type:"error"});return}try{await ue.createAssignment(_,T,D),h({message:"Assignment created successfully (mocked).",type:"success"})}catch{h({message:"Failed to create assignment.",type:"error"})}},F=p[0].startDate&&p[0].endDate?`${$e(p[0].startDate,"MMM d, yyyy")} - ${$e(p[0].endDate,"MMM d, yyyy")}`:"Select Date";return i.jsxs("div",{className:"p-4 space-y-8",children:[d&&i.jsx(ht,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsx("div",{className:"bg-card p-4 rounded-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Operations Dashboard"}),i.jsxs("div",{className:"relative",children:[i.jsxs(se,{variant:"outline",onClick:()=>w(!v),children:[i.jsx(Pa,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:F})]}),v&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:i.jsx(bm.DateRangePicker,{onChange:V=>{x([V.selection]),w(!1)},months:1,ranges:p,direction:"horizontal"})})]})]})}),i.jsx("div",{className:"bg-gradient-to-br from-accent/10 to-accent/5 border-2 border-accent/30 rounded-2xl p-6 cursor-pointer hover:border-accent hover:shadow-lg transition-all group",onClick:()=>n("/operations/team-activity"),children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"bg-accent rounded-xl p-3 group-hover:scale-110 transition-transform",children:i.jsx(Wh,{className:"h-6 w-6 text-white"})}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Team Activity Monitor"})]}),i.jsx("p",{className:"text-muted mb-4",children:"Track your field team in real-time. Monitor check-ins, working hours, locations, and communicate instantly with your team members."}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("span",{className:"px-3 py-1 bg-green-500/10 text-green-600 rounded-full text-xs font-medium",children:"Real-time tracking"}),i.jsx("span",{className:"px-3 py-1 bg-blue-500/10 text-blue-600 rounded-full text-xs font-medium",children:"Location monitoring"}),i.jsx("span",{className:"px-3 py-1 bg-purple-500/10 text-purple-600 rounded-full text-xs font-medium",children:"Quick communication"})]})]}),i.jsx("div",{className:"flex-shrink-0 ml-4",children:i.jsx(se,{onClick:V=>{V.stopPropagation(),n("/operations/team-activity")},style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:"View Team Activity "})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsx(_o,{title:"Total Submissions",value:I.total,icon:ls}),i.jsx(_o,{title:"Verified Employees",value:I.verified,icon:hu}),i.jsx(_o,{title:"Rejected Applications",value:I.rejected,icon:Dx})]}),i.jsxs("div",{className:"bg-card p-6 rounded-2xl",children:[i.jsx(Pr,{title:"Assign Field Officer",subtitle:"Assign a field officer to an organization for a specific date."}),i.jsxs("form",{onSubmit:q,className:"grid grid-cols-1 md:grid-cols-4 gap-6 items-end",children:[i.jsx("div",{className:"md:col-span-1",children:i.jsxs(Ke,{label:"Field Officer",id:"officer",value:_,onChange:V=>j(V.target.value),children:[i.jsx("option",{value:"",children:"Select Officer"}),r.map(V=>i.jsx("option",{value:V.id,children:V.name},V.id))]})}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs(Ke,{label:"Organization/Site",id:"site",value:T,onChange:V=>P(V.target.value),children:[i.jsx("option",{value:"",children:"Select Site"}),a.map(V=>i.jsx("option",{value:V.id,children:V.shortName},V.id))]})}),i.jsx("div",{className:"md:col-span-1",children:i.jsx(kn,{label:"Assignment Date",id:"assignmentDate",value:D,onChange:M})}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs(se,{type:"submit",className:"w-full",children:[i.jsx(PC,{className:"mr-2 h-4 w-4"}),"Assign"]})})]})]})]})},xse=()=>{const{user:n}=jt(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(null),l=Ft("(max-width: 767px)");E.useEffect(()=>{c();const w=setInterval(c,3e4);return()=>clearInterval(w)},[n]);const c=async()=>{if(n)try{s(!0);const w=await ue.getUsers();let _=[];n.role==="admin"||n.role==="developer"?_=w.filter(D=>D.role==="operation_manager"||D.role==="field_officer"):n.role==="operation_manager"&&(_=w.filter(D=>D.role==="field_officer"&&D.reportingManagerId===n.id));const j=new Date;j.setHours(0,0,0,0);const T=new Date;T.setHours(23,59,59,999);const P=await Promise.all(_.map(async D=>{try{const O=(await ue.getAttendanceEvents(D.id,j.toISOString(),T.toISOString())).sort(($,ne)=>new Date(ne.timestamp).getTime()-new Date($.timestamp).getTime()),I=O.filter($=>$.type.toLowerCase().replace(/[-_\s]/g,"")==="checkin"),q=O.filter($=>$.type.toLowerCase().replace(/[-_\s]/g,"")==="checkout"),F=I[0],V=q[0];let U=0;for(let $=0;$<q.length;$++){const ne=q[$],Y=I.find(ae=>new Date(ae.timestamp)<new Date(ne.timestamp));if(Y){const ae=new Date(ne.timestamp).getTime()-new Date(Y.timestamp).getTime();U+=ae/(1e3*60*60)}}const W=F&&(!V||new Date(F.timestamp)>new Date(V.timestamp));if(W&&F){const $=Date.now()-new Date(F.timestamp).getTime();U+=$/(1e3*60*60)}return{...D,lastCheckIn:F?.timestamp,lastCheckOut:V?.timestamp,currentLocation:F?{latitude:F.latitude||0,longitude:F.longitude||0,address:F.address||void 0}:void 0,todayWorkingHours:U,todayTravelDistance:0,isCurrentlyWorking:W,isPresent:I.length>0}}catch(M){return console.error(`Error fetching data for ${D.name}:`,M),{...D,isPresent:!1,isCurrentlyWorking:!1}}}));t(P)}catch(w){console.error("Error fetching team members:",w)}finally{s(!1)}},d=w=>{if(!w)return;const _=w.replace(/\D/g,"").slice(-10);window.location.href=`tel:+91${_}`},h=w=>{if(!w)return;const _=w.replace(/\D/g,"").slice(-10);window.location.href=`sms:+91${_}`},p=w=>{if(!w)return"0h 0m";const _=Math.floor(w),j=Math.floor((w-_)*60);return`${_}h ${j}m`};if(r)return i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})});const x=({member:w})=>i.jsx("div",{className:"bg-card border border-border rounded-xl p-4 hover:border-accent transition-all cursor-pointer",onClick:()=>o(w),children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx($i,{photoUrl:w.photoUrl,seed:w.id,className:"w-12 h-12 rounded-full"}),i.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ring-2 ring-white ${w.isCurrentlyWorking?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":w.isPresent?"bg-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.8)]":"bg-gray-400"}`})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-primary-text truncate",children:w.name}),i.jsx("p",{className:"text-xs text-muted",children:w.role.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())}),i.jsxs("div",{className:"mt-2 space-y-1",children:[i.jsx("div",{className:"flex items-center gap-2 text-xs",children:w.isCurrentlyWorking?i.jsxs(i.Fragment,{children:[i.jsx(Wh,{className:"h-3 w-3 text-green-500"}),i.jsx("span",{className:"text-green-500 font-medium",children:"Working"})]}):w.isPresent?i.jsxs(i.Fragment,{children:[i.jsx(LM,{className:"h-3 w-3 text-yellow-500"}),i.jsx("span",{className:"text-yellow-500",children:"Checked Out"})]}):i.jsxs(i.Fragment,{children:[i.jsx(pm,{className:"h-3 w-3 text-gray-400"}),i.jsx("span",{className:"text-gray-400",children:"Absent"})]})}),w.todayWorkingHours>0&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted",children:[i.jsx(Bc,{className:"h-3 w-3"}),i.jsx("span",{children:p(w.todayWorkingHours)})]})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx(se,{variant:"icon",size:"sm",onClick:_=>{_.stopPropagation(),d(w.phone)},className:"hover:bg-accent/10",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:i.jsx(Ef,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:_=>{_.stopPropagation(),h(w.phone)},className:"hover:bg-accent/10",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:i.jsx(gm,{className:"h-4 w-4"})})]})]})}),v=({member:w})=>i.jsxs("div",{className:"bg-card border border-border rounded-xl p-6",children:[i.jsxs("div",{className:"flex items-start justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx($i,{photoUrl:w.photoUrl,seed:w.id,className:"w-16 h-16 rounded-full"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:w.name}),i.jsx("p",{className:"text-sm text-muted",children:w.role.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())})]})]}),l&&i.jsx(se,{variant:"secondary",size:"sm",onClick:()=>o(null),children:"Close"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Ex,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Last Check In"})]}),i.jsx("p",{className:"text-sm font-bold text-primary-text",children:w.lastCheckIn?$e(new Date(w.lastCheckIn),"hh:mm a"):"Not checked in"}),w.lastCheckIn&&i.jsx("p",{className:"text-xs text-muted mt-1",children:cu(new Date(w.lastCheckIn),{addSuffix:!0})})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(wo,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Last Check Out"})]}),i.jsx("p",{className:"text-sm font-bold text-primary-text",children:w.lastCheckOut?$e(new Date(w.lastCheckOut),"hh:mm a"):"Not checked out"}),w.lastCheckOut&&i.jsx("p",{className:"text-xs text-muted mt-1",children:cu(new Date(w.lastCheckOut),{addSuffix:!0})})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Bc,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Working Hours Today"})]}),i.jsx("p",{className:"text-lg font-bold text-primary-text",children:p(w.todayWorkingHours)})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Wh,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Status"})]}),i.jsx("p",{className:`text-lg font-bold ${w.isCurrentlyWorking?"text-green-500":w.isPresent?"text-yellow-500":"text-gray-400"}`,children:w.isCurrentlyWorking?"Working":w.isPresent?"Checked Out":"Absent"})]})]}),w.currentLocation&&i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Tl,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Current Location"})]}),i.jsx("p",{className:"text-sm text-primary-text",children:w.currentLocation.address||"Location not available"}),w.currentLocation.latitude!==0&&i.jsx("a",{href:`https://www.google.com/maps?q=${w.currentLocation.latitude},${w.currentLocation.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-accent hover:underline mt-2 inline-block",children:"View on map "})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(se,{onClick:()=>d(w.phone),className:"flex-1",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:[i.jsx(Ef,{className:"h-4 w-4 mr-2"}),"Call"]}),i.jsxs(se,{onClick:()=>h(w.phone),className:"flex-1",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:[i.jsx(gm,{className:"h-4 w-4 mr-2"}),"Message"]})]})]});return i.jsxs("div",{className:"p-4 lg:p-8 space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-primary-text",children:"Team Activity"}),i.jsx("p",{className:"text-sm text-muted mt-1",children:n?.role==="operation_manager"?"Monitor your field team in real-time":"Monitor all operation managers and field officers"})]}),i.jsxs(se,{onClick:c,variant:"secondary",size:"sm",children:[i.jsx(Wh,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(kl,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Total Team"})]}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:e.length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Wh,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Working Now"})]}),i.jsx("p",{className:"text-2xl font-bold text-green-500",children:e.filter(w=>w.isCurrentlyWorking).length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(LM,{className:"h-4 w-4 text-yellow-500"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Present"})]}),i.jsx("p",{className:"text-2xl font-bold text-yellow-500",children:e.filter(w=>w.isPresent).length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(pm,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Absent"})]}),i.jsx("p",{className:"text-2xl font-bold text-gray-400",children:e.filter(w=>!w.isPresent).length})]})]}),l&&a?i.jsx(v,{member:a}):i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-2 space-y-3",children:e.length===0?i.jsxs("div",{className:"bg-card border border-border rounded-xl p-12 text-center",children:[i.jsx(kl,{className:"h-12 w-12 mx-auto text-muted mb-4 opacity-50"}),i.jsx("p",{className:"text-muted",children:"No team members found"})]}):e.map(w=>i.jsx(x,{member:w},w.id))}),!l&&a&&i.jsx("div",{className:"lg:col-span-1 sticky top-6 self-start",children:i.jsx(v,{member:a})})]})]})},yse=({status:n})=>{if(!n)return i.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});const e={pending_sync:"sync-chip--pending_sync",synced:"sync-chip--synced",failed:"sync-chip--failed"},t={pending_sync:"Pending Sync",synced:"Synced",failed:"Failed"},r=e[n];return i.jsx("span",{className:`sync-chip ${r}`,children:t[n]})},vse=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState("all"),[o,l]=E.useState(""),[c,d]=E.useState(null),h=St(),{user:p}=jt(),x=Ft("(max-width: 767px)"),[v,w]=E.useState([]),[_,j]=E.useState(p?.organizationId),T=p&&p.role==="admin";E.useEffect(()=>{T&&ue.getOrganizations().then(I=>{w(I),I.length>0&&!_&&j(I[0].id)})},[T,_]);const P=E.useCallback(async()=>{if(!_){p?.organizationId&&r(!1);return}r(!0);try{const I=await ue.getVerificationSubmissions(s==="all"?void 0:s,_);e(I)}catch(I){console.error("Failed to fetch submissions",I)}finally{r(!1)}},[s,_,p?.organizationId]);E.useEffect(()=>{P()},[P]);const D=E.useMemo(()=>n.filter(I=>I.personal.firstName.toLowerCase().includes(o.toLowerCase())||I.personal.lastName.toLowerCase().includes(o.toLowerCase())||I.personal.employeeId.toLowerCase().includes(o.toLowerCase())),[n,o]),M=v.find(I=>I.id===_)?.shortName||p?.organizationName,O=["all","pending","verified","rejected"];return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Site Dashboard"}),i.jsxs("p",{className:"text-muted",children:["Viewing submissions for site: ",i.jsx("span",{className:"font-semibold text-accent-dark",children:M||"N/A"})]})]}),!x&&i.jsxs("div",{className:"flex items-center gap-4",children:[T&&i.jsx("div",{className:"w-full sm:w-56",children:i.jsxs(Ke,{label:"",id:"org-selector",value:_,onChange:I=>j(I.target.value),children:[i.jsx("option",{value:"",children:"Select a Site"}),v.map(I=>i.jsx("option",{value:I.id,children:I.shortName},I.id))]})}),i.jsxs(se,{onClick:()=>h("/onboarding/select-organization"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx($c,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]})]}),x&&i.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[T&&i.jsxs(Ke,{label:"Select Site",id:"org-selector-mobile",value:_,onChange:I=>j(I.target.value),children:[i.jsx("option",{value:"",children:"Select a Site"}),v.map(I=>i.jsx("option",{value:I.id,children:I.shortName},I.id))]}),i.jsxs(se,{onClick:()=>h("/onboarding/select-organization"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx($c,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center my-6 gap-4",children:[i.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:i.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:O.map(I=>i.jsx("button",{onClick:()=>a(I),className:`${s===I?"border-emerald-500 text-emerald-700":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize transition-colors duration-200`,children:I},I))})}),i.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ea,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name or ID...",value:o,onChange:I=>l(I.target.value),className:"block w-full pl-10 pr-3 py-2 border border-border rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Sync"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading submissions..."})}):_?D.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No submissions found for this site."})}):D.map(I=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:[i.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[I.personal.firstName," ",I.personal.lastName]}),i.jsx("div",{className:"text-sm text-muted",children:I.personal.employeeId})]}),i.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(UC,{status:I.status})}),i.jsx("td",{"data-label":"Portal Sync",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(yse,{status:I.portalSyncStatus})}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[i.jsx(se,{variant:"icon",size:"sm",onClick:()=>h(`/onboarding/add/personal?id=${I.id}`),title:"View/Edit Details",children:i.jsx(Sl,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>h(`/onboarding/pdf/${I.id}`),title:"Download Forms",children:i.jsx(ls,{className:"h-4 w-4"})})]})})]},I.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Please select a site to view submissions."})})})]})})]})},WS=({file:n,onFileChange:e})=>{const[t,r]=E.useState(!1),[s,a]=E.useState(""),[o,l]=E.useState(!1),c=E.useCallback(async v=>{if(v&&v.type.startsWith("image/")){a("");const w={name:v.name,type:v.type,size:v.size,preview:URL.createObjectURL(v),file:v};e(w)}},[e]),d=async v=>{const w=v.target.files?.[0];w&&c(w)},h=E.useCallback(async(v,w)=>{const _=await(await fetch(`data:${w};base64,${v}`)).blob(),j=new File([_],`capture-${Date.now()}.jpg`,{type:w});c(j)},[c]),p=()=>{n&&URL.revokeObjectURL(n.preview),e(null),a("")},x="avatar-upload";return i.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[o&&i.jsx(t5,{isOpen:o,onClose:()=>l(!1),onCapture:h,captureGuidance:"profile"}),i.jsxs("div",{className:"relative w-40 h-40",children:[i.jsx("div",{className:`w-full h-full rounded-full bg-page flex items-center justify-center overflow-hidden border-2 transition-colors ${s?"border-red-500":"border-border"}`,children:t?i.jsxs("div",{className:"flex flex-col items-center text-muted",children:[i.jsx(_t,{className:"h-8 w-8 animate-spin"}),i.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):n?.preview?i.jsx("img",{src:n.preview,alt:"Profile preview",className:"w-full h-full object-cover"}):i.jsx($i,{})}),n&&!t&&i.jsx("button",{type:"button",onClick:p,id:"avatar-delete-button",className:"avatar-delete-btn btn-icon absolute top-2 right-2 p-1.5 rounded-full transition-colors !bg-white/90 !text-red-600 hover:!bg-red-100","aria-label":"Remove photo",children:i.jsx(rn,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("label",{htmlFor:x,className:`cursor-pointer inline-flex items-center justify-center font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200 rounded-full bg-accent text-white hover:bg-accent-dark focus:ring-accent px-4 py-2 text-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[i.jsx(cr,{className:"w-4 h-4 mr-2"}),n?"Change":"Upload"]}),i.jsx("input",{id:x,name:x,type:"file",className:"sr-only",onChange:d,accept:"image/*",disabled:t}),i.jsxs("button",{type:"button",onClick:()=>l(!0),disabled:t,className:`avatar-capture-btn inline-flex items-center justify-center px-4 py-2 font-semibold rounded-full transition-colors duration-200 text-sm border border-red-200 !text-red-600 hover:!bg-red-50 !bg-card/70 backdrop-blur-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[i.jsx(SC,{className:"w-4 h-4 mr-2"}),"Capture"]})]}),s&&i.jsxs("p",{className:"text-xs text-red-600 text-center max-w-[160px] flex items-center gap-1",children:[i.jsx(Da,{className:"h-3 w-3 flex-shrink-0"})," ",s]})]})},bse=Pt({name:ge().required("Name is required"),email:ge().email("Must be a valid email").required("Email is required"),phone:ge().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number").optional().nullable()}).defined(),wse=()=>{const{user:n,updateUserProfile:e,isCheckedIn:t,isAttendanceLoading:r,toggleCheckInStatus:s,logout:a,lastCheckInTime:o,lastCheckOutTime:l,checkAttendanceStatus:c}=jt(),{permissions:d}=Ji(),h=St(),{theme:p,setTheme:x,isAutomatic:v,setAutomatic:w}=Jc(),[_,j]=E.useState(!1),[T,P]=E.useState(!1),[D,M]=E.useState(null),[O,I]=E.useState("prompt"),F=Ft("(max-width: 767px)");E.useEffect(()=>{const re=async()=>{if(!navigator.permissions?.query){I("prompt");return}try{const de=await navigator.permissions.query({name:"camera"}),ce=await navigator.permissions.query({name:"geolocation"});de.state==="granted"&&ce.state==="granted"?I("granted"):de.state==="denied"||ce.state==="denied"?I("denied"):I("prompt");const pe=()=>re();de.onchange=pe,ce.onchange=pe}catch(de){console.warn("Permissions API not fully supported. Defaulting to 'prompt'.",de),I("prompt")}};re()},[]);const{register:V,handleSubmit:U,formState:{errors:W,isDirty:$},getValues:ne,trigger:Y,reset:ae}=tn({resolver:En(bse),defaultValues:{name:n?.name||"",email:n?.email||"",phone:n?.phone||""}});E.useEffect(()=>{n&&ae({name:n.name||"",email:n.email||"",phone:n.phone||""})},[n,ae]);const J=async re=>{if(!n)return;const de=n.photoUrl;e({photoUrl:re?.preview});try{let ce=null;re&&re.file&&(ce=await new Promise((ie,xe)=>{const Ce=new FileReader;Ce.onloadend=()=>ie(Ce.result),Ce.onerror=xe,Ce.readAsDataURL(re.file)}));const pe=await ue.updateUser(n.id,{photoUrl:ce});e(pe),M({message:`Profile photo ${ce?"updated":"removed"}.`,type:"success"})}catch(ce){console.error(ce),M({message:"Failed to save photo.",type:"error"}),e({photoUrl:de})}},ee=async re=>{if(n){j(!0);try{const de=await ue.updateUser(n.id,re);e(de),ae(re),M({message:"Profile updated successfully!",type:"success"})}catch{M({message:"Failed to update profile.",type:"error"})}finally{j(!1)}}},X=T,Z=()=>{h("/auth/logout")},oe=re=>re?$e(new Date(re),"hh:mm a"):"--:--";n&&d[n.role]?.includes("manage_tasks");const H=re=>re.replace(/_/g," ").replace(/\b\w/g,de=>de.toUpperCase());if(!n)return i.jsx("div",{children:"Loading user profile..."});const Q=n.photoUrl?{preview:n.photoUrl,name:"Profile Photo",type:"image/jpeg",size:0}:null;return F?i.jsxs("div",{className:"p-4 space-y-8 md:bg-transparent bg-[#041b0f]",children:[D&&i.jsx(ht,{message:D.message,type:D.type,onDismiss:()=>M(null)}),i.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[i.jsx(WS,{file:Q,onFileChange:J}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold",children:n.name}),i.jsx("p",{className:"text-muted",children:n.role.replace(/_/g," ").replace(/\b\w/g,re=>re.toUpperCase())})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Profile Details"}),i.jsxs("form",{onSubmit:U(ee),className:"space-y-4",children:[i.jsx(je,{label:"Full Name",id:"name",error:W.name?.message,registration:V("name")}),i.jsx(je,{label:"Email Address",id:"email",type:"email",error:W.email?.message,registration:V("email"),readOnly:!0,className:"!bg-gray-700/50"}),i.jsx(je,{label:"Phone Number",id:"phone",type:"tel",error:W.phone?.message,registration:V("phone")}),i.jsx("div",{className:"flex justify-end pt-2",children:i.jsx(se,{type:"submit",isLoading:_,disabled:!$,children:"Save Changes"})})]})]}),i.jsxs("section",{className:"hidden md:block",children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Appearance"}),i.jsxs("div",{className:"p-4 rounded-lg bg-[#041b0f] md:bg-[#243524] border border-[#374151] space-y-4",children:[i.jsx(Pn,{id:"theme-automatic-mobile",label:"Automatic",description:"Switch themes based on screen size.",checked:v,onChange:re=>w(re.target.checked)}),i.jsx(Pn,{id:"theme-dark-mode-mobile",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:p==="dark",onChange:re=>x(re.target.checked?"dark":"light"),disabled:v})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Work Hours Tracking"}),i.jsxs("div",{className:"fo-attendance-card space-y-4",children:[i.jsxs("div",{className:"flex justify-around",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"fo-attendance-time",children:"Last Check In"}),i.jsx("p",{className:"fo-attendance-time",children:i.jsx("strong",{children:oe(o)})})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"fo-attendance-time",children:"Last Check Out"}),i.jsx("p",{className:"fo-attendance-time",children:i.jsx("strong",{children:oe(l)})})]})]}),r?i.jsx("div",{className:"flex items-center justify-center text-muted h-[56px]",children:i.jsx(_t,{className:"h-6 w-6 animate-spin"})}):i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(se,{onClick:()=>h("/attendance/check-in"),variant:"primary",className:"flex-1 !py-4 text-lg font-bold shadow-lg transition-all rounded-2xl",disabled:t||X,children:[i.jsx(Ex,{className:"mr-3 h-6 w-6"})," Check In"]}),i.jsxs(se,{onClick:()=>h("/attendance/check-out"),variant:"danger",className:"flex-1 !py-4 text-lg font-bold shadow-lg transition-all rounded-2xl",disabled:!t||X,children:[i.jsx(wo,{className:"mr-3 h-6 w-6"})," Check Out"]})]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Account Actions"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(se,{onClick:()=>h("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center !py-3",title:"View your leave history and balances",children:[i.jsx(PS,{className:"mr-2 h-5 w-5"})," Leave Tracker"]}),i.jsxs(se,{onClick:Z,variant:"danger",className:"w-full justify-center !py-3",children:[i.jsx(wo,{className:"mr-2 h-5 w-5"})," Log Out"]})]})]})]})]}):i.jsxs("div",{className:"w-full space-y-8",children:[D&&i.jsx(ht,{message:D.message,type:D.type,onDismiss:()=>M(null)}),i.jsxs("div",{className:"relative overflow-hidden md:bg-white md:p-6 md:rounded-2xl md:shadow-lg flex flex-col md:flex-row items-center gap-6 border border-gray-100",children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-[#006b3f] border-b-4 border-[#005632] shadow-lg"}),i.jsx("div",{className:"relative z-10",children:i.jsx(WS,{file:Q,onFileChange:J})}),i.jsxs("div",{className:"text-center md:text-left relative z-10 flex-1 mt-16 md:mt-0",children:[i.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-primary-text tracking-tight",children:n.name}),i.jsx("div",{className:"flex items-center justify-center md:justify-start gap-2 mt-1.5",children:i.jsx("span",{className:"px-2.5 py-0.5 rounded-full bg-emerald-100 text-emerald-800 border border-emerald-200 text-xs md:text-sm font-medium",children:H(n.role)})}),i.jsx("p",{className:"text-gray-500 mt-1.5 font-medium text-sm md:text-base",children:n.email})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[i.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-blue-50 rounded-lg",children:i.jsx(kl,{className:"h-5 w-5 text-blue-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Profile Details"})]}),i.jsxs("form",{onSubmit:U(ee),className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[i.jsx(je,{label:"Full Name",id:"name",error:W.name?.message,registration:V("name"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),i.jsx(je,{label:"Phone Number",id:"phone",type:"tel",error:W.phone?.message,registration:V("phone"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(je,{label:"Email Address",id:"email",type:"email",error:W.email?.message,registration:V("email"),readOnly:!0,className:"bg-gray-100/50 text-gray-500 cursor-not-allowed border-gray-200"})})]}),i.jsx("div",{className:"flex justify-end pt-3 border-t border-gray-100",children:i.jsx(se,{type:"submit",isLoading:_,disabled:!$,className:"px-6",children:"Save Changes"})})]})]}),i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-purple-50 rounded-lg",children:i.jsx(n3,{className:"h-5 w-5 text-purple-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Work Hours Tracking"})]}),i.jsxs("div",{className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[i.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[i.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check In"}),i.jsx("p",{className:"text-2xl md:text-3xl font-bold text-emerald-600",children:oe(o)})]}),i.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[i.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check Out"}),i.jsx("p",{className:"text-2xl md:text-3xl font-bold text-rose-600",children:oe(l)})]})]}),r?i.jsx("div",{className:"flex items-center justify-center h-[56px] bg-gray-50 rounded-xl",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-gray-400"})}):i.jsxs("div",{className:"flex gap-4",children:[i.jsxs(se,{onClick:()=>h("/attendance/check-in"),variant:"primary",className:"flex-1 !py-3 text-base md:text-lg shadow-lg shadow-emerald-100 hover:shadow-emerald-200 transition-all",disabled:t||X,children:[i.jsx(Ex,{className:"mr-2 h-5 w-5"})," Check In"]}),i.jsxs(se,{onClick:()=>h("/attendance/check-out"),variant:"danger",className:"flex-1 !py-3 text-base md:text-lg shadow-lg shadow-red-100 hover:shadow-red-200 transition-all",disabled:!t||X,children:[i.jsx(wo,{className:"mr-2 h-5 w-5"})," Check Out"]})]})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Appearance"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:i.jsx(Pn,{id:"theme-automatic-desktop",label:"Automatic",description:"Switch themes based on screen size.",checked:v,onChange:re=>w(re.target.checked)})}),i.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:i.jsx(Pn,{id:"theme-dark-mode-desktop",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:p==="dark",onChange:re=>x(re.target.checked?"dark":"light"),disabled:v})})]})]}),i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Account Actions"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs(se,{onClick:()=>h("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center py-3 bg-gray-50 hover:bg-gray-100 border-gray-200",title:"View your leave history and balances",children:[i.jsx(PS,{className:"mr-2 h-4 w-4"})," Leave Tracker"]}),i.jsxs(se,{onClick:Z,variant:"danger",className:"w-full justify-center py-3",isLoading:_,children:[i.jsx(wo,{className:"mr-2 h-4 w-4"})," Log Out"]})]})]})]})]})]})};function Fm(n){return n+.5|0}const Ic=(n,e,t)=>Math.max(Math.min(n,t),e);function $h(n){return Ic(Fm(n*2.55),0,255)}function zc(n){return Ic(Fm(n*255),0,255)}function yl(n){return Ic(Fm(n/2.55)/100,0,1)}function _R(n){return Ic(Fm(n*100),0,100)}const Ui={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},$S=[..."0123456789ABCDEF"],_se=n=>$S[n&15],jse=n=>$S[(n&240)>>4]+$S[n&15],Fg=n=>(n&240)>>4===(n&15),Nse=n=>Fg(n.r)&&Fg(n.g)&&Fg(n.b)&&Fg(n.a);function Sse(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&Ui[n[1]]*17,g:255&Ui[n[2]]*17,b:255&Ui[n[3]]*17,a:e===5?Ui[n[4]]*17:255}:(e===7||e===9)&&(t={r:Ui[n[1]]<<4|Ui[n[2]],g:Ui[n[3]]<<4|Ui[n[4]],b:Ui[n[5]]<<4|Ui[n[6]],a:e===9?Ui[n[7]]<<4|Ui[n[8]]:255})),t}const Cse=(n,e)=>n<255?e(n):"";function Tse(n){var e=Nse(n)?_se:jse;return n?"#"+e(n.r)+e(n.g)+e(n.b)+Cse(n.a,e):void 0}const kse=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function i6(n,e,t){const r=e*Math.min(t,1-t),s=(a,o=(a+n/30)%12)=>t-r*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function Pse(n,e,t){const r=(s,a=(s+n/60)%6)=>t-t*e*Math.max(Math.min(a,4-a,1),0);return[r(5),r(3),r(1)]}function Mse(n,e,t){const r=i6(n,1,.5);let s;for(e+t>1&&(s=1/(e+t),e*=s,t*=s),s=0;s<3;s++)r[s]*=1-e-t,r[s]+=e;return r}function Ese(n,e,t,r,s){return n===s?(e-t)/r+(e<t?6:0):e===s?(t-n)/r+2:(n-e)/r+4}function l1(n){const t=n.r/255,r=n.g/255,s=n.b/255,a=Math.max(t,r,s),o=Math.min(t,r,s),l=(a+o)/2;let c,d,h;return a!==o&&(h=a-o,d=l>.5?h/(2-a-o):h/(a+o),c=Ese(t,r,s,h,a),c=c*60+.5),[c|0,d||0,l]}function c1(n,e,t,r){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,r)).map(zc)}function d1(n,e,t){return c1(i6,n,e,t)}function Dse(n,e,t){return c1(Mse,n,e,t)}function Ose(n,e,t){return c1(Pse,n,e,t)}function a6(n){return(n%360+360)%360}function Ise(n){const e=kse.exec(n);let t=255,r;if(!e)return;e[5]!==r&&(t=e[6]?$h(+e[5]):zc(+e[5]));const s=a6(+e[2]),a=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=Dse(s,a,o):e[1]==="hsv"?r=Ose(s,a,o):r=d1(s,a,o),{r:r[0],g:r[1],b:r[2],a:t}}function Ase(n,e){var t=l1(n);t[0]=a6(t[0]+e),t=d1(t),n.r=t[0],n.g=t[1],n.b=t[2]}function Rse(n){if(!n)return;const e=l1(n),t=e[0],r=_R(e[1]),s=_R(e[2]);return n.a<255?`hsla(${t}, ${r}%, ${s}%, ${yl(n.a)})`:`hsl(${t}, ${r}%, ${s}%)`}const jR={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},NR={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Lse(){const n={},e=Object.keys(NR),t=Object.keys(jR);let r,s,a,o,l;for(r=0;r<e.length;r++){for(o=l=e[r],s=0;s<t.length;s++)a=t[s],l=l.replace(a,jR[a]);a=parseInt(NR[o],16),n[l]=[a>>16&255,a>>8&255,a&255]}return n}let qg;function Fse(n){qg||(qg=Lse(),qg.transparent=[0,0,0,0]);const e=qg[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const qse=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function zse(n){const e=qse.exec(n);let t=255,r,s,a;if(e){if(e[7]!==r){const o=+e[7];t=e[8]?$h(o):Ic(o*255,0,255)}return r=+e[1],s=+e[3],a=+e[5],r=255&(e[2]?$h(r):Ic(r,0,255)),s=255&(e[4]?$h(s):Ic(s,0,255)),a=255&(e[6]?$h(a):Ic(a,0,255)),{r,g:s,b:a,a:t}}}function Use(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${yl(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const jN=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Xu=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function Vse(n,e,t){const r=Xu(yl(n.r)),s=Xu(yl(n.g)),a=Xu(yl(n.b));return{r:zc(jN(r+t*(Xu(yl(e.r))-r))),g:zc(jN(s+t*(Xu(yl(e.g))-s))),b:zc(jN(a+t*(Xu(yl(e.b))-a))),a:n.a+t*(e.a-n.a)}}function zg(n,e,t){if(n){let r=l1(n);r[e]=Math.max(0,Math.min(r[e]+r[e]*t,e===0?360:1)),r=d1(r),n.r=r[0],n.g=r[1],n.b=r[2]}}function o6(n,e){return n&&Object.assign(e||{},n)}function SR(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=zc(n[3]))):(e=o6(n,{r:0,g:0,b:0,a:1}),e.a=zc(e.a)),e}function Bse(n){return n.charAt(0)==="r"?zse(n):Ise(n)}class _m{constructor(e){if(e instanceof _m)return e;const t=typeof e;let r;t==="object"?r=SR(e):t==="string"&&(r=Sse(e)||Fse(e)||Bse(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=o6(this._rgb);return e&&(e.a=yl(e.a)),e}set rgb(e){this._rgb=SR(e)}rgbString(){return this._valid?Use(this._rgb):void 0}hexString(){return this._valid?Tse(this._rgb):void 0}hslString(){return this._valid?Rse(this._rgb):void 0}mix(e,t){if(e){const r=this.rgb,s=e.rgb;let a;const o=t===a?.5:t,l=2*o-1,c=r.a-s.a,d=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;a=1-d,r.r=255&d*r.r+a*s.r+.5,r.g=255&d*r.g+a*s.g+.5,r.b=255&d*r.b+a*s.b+.5,r.a=o*r.a+(1-o)*s.a,this.rgb=r}return this}interpolate(e,t){return e&&(this._rgb=Vse(this._rgb,e._rgb,t)),this}clone(){return new _m(this.rgb)}alpha(e){return this._rgb.a=zc(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Fm(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return zg(this._rgb,2,e),this}darken(e){return zg(this._rgb,2,-e),this}saturate(e){return zg(this._rgb,1,e),this}desaturate(e){return zg(this._rgb,1,-e),this}rotate(e){return Ase(this._rgb,e),this}}function fl(){}const Wse=(()=>{let n=0;return()=>n++})();function yn(n){return n==null}function Tr(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function nn(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function cs(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function ho(n,e){return cs(n)?n:e}function Gt(n,e){return typeof n>"u"?e:n}const $se=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,l6=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function qn(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function _n(n,e,t,r){let s,a,o;if(Tr(n))for(a=n.length,s=0;s<a;s++)e.call(t,n[s],s);else if(nn(n))for(o=Object.keys(n),a=o.length,s=0;s<a;s++)e.call(t,n[o[s]],o[s])}function qx(n,e){let t,r,s,a;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(s=n[t],a=e[t],s.datasetIndex!==a.datasetIndex||s.index!==a.index)return!1;return!0}function zx(n){if(Tr(n))return n.map(zx);if(nn(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let s=0;for(;s<r;++s)e[t[s]]=zx(n[t[s]]);return e}return n}function c6(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function Hse(n,e,t,r){if(!c6(n))return;const s=e[n],a=t[n];nn(s)&&nn(a)?jm(s,a,r):e[n]=zx(a)}function jm(n,e,t){const r=Tr(e)?e:[e],s=r.length;if(!nn(n))return n;t=t||{};const a=t.merger||Hse;let o;for(let l=0;l<s;++l){if(o=r[l],!nn(o))continue;const c=Object.keys(o);for(let d=0,h=c.length;d<h;++d)a(c[d],n,o,t)}return n}function em(n,e){return jm(n,e,{merger:Yse})}function Yse(n,e,t){if(!c6(n))return;const r=e[n],s=t[n];nn(r)&&nn(s)?em(r,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=zx(s))}const CR={"":n=>n,x:n=>n.x,y:n=>n.y};function Gse(n){const e=n.split("."),t=[];let r="";for(const s of e)r+=s,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}function Zse(n){const e=Gse(n);return t=>{for(const r of e){if(r==="")break;t=t&&t[r]}return t}}function mu(n,e){return(CR[e]||(CR[e]=Zse(e)))(n)}function u1(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Nm=n=>typeof n<"u",Hc=n=>typeof n=="function",TR=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function Kse(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Mn=Math.PI,Xn=2*Mn,Jse=Xn+Mn,Ux=Number.POSITIVE_INFINITY,Qse=Mn/180,kr=Mn/2,$d=Mn/4,kR=Mn*2/3,d6=Math.log10,No=Math.sign;function tm(n,e,t){return Math.abs(n-e)<t}function PR(n){const e=Math.round(n);n=tm(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(d6(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function Xse(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r===0&&(e.push(r),e.push(n/r));return t===(t|0)&&e.push(t),e.sort((s,a)=>s-a).pop(),e}function eie(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Sm(n){return!eie(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function tie(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function nie(n,e,t){let r,s,a;for(r=0,s=n.length;r<s;r++)a=n[r][t],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function bl(n){return n*(Mn/180)}function rie(n){return n*(180/Mn)}function MR(n){if(!cs(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function u6(n,e){const t=e.x-n.x,r=e.y-n.y,s=Math.sqrt(t*t+r*r);let a=Math.atan2(r,t);return a<-.5*Mn&&(a+=Xn),{angle:a,distance:s}}function HS(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function sie(n,e){return(n-e+Jse)%Xn-Mn}function ui(n){return(n%Xn+Xn)%Xn}function Cm(n,e,t,r){const s=ui(n),a=ui(e),o=ui(t),l=ui(a-s),c=ui(o-s),d=ui(s-a),h=ui(s-o);return s===a||s===o||r&&a===o||l>c&&d<h}function os(n,e,t){return Math.max(e,Math.min(t,n))}function iie(n){return os(n,-32768,32767)}function wl(n,e,t,r=1e-6){return n>=Math.min(e,t)-r&&n<=Math.max(e,t)+r}function f1(n,e,t){t=t||(o=>n[o]<e);let r=n.length-1,s=0,a;for(;r-s>1;)a=s+r>>1,t(a)?s=a:r=a;return{lo:s,hi:r}}const su=(n,e,t,r)=>f1(n,t,r?s=>{const a=n[s][e];return a<t||a===t&&n[s+1][e]===t}:s=>n[s][e]<t),aie=(n,e,t)=>f1(n,t,r=>n[r][e]>=t);function oie(n,e,t){let r=0,s=n.length;for(;r<s&&n[r]<e;)r++;for(;s>r&&n[s-1]>t;)s--;return r>0||s<n.length?n.slice(r,s):n}const f6=["push","pop","shift","splice","unshift"];function lie(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),f6.forEach(t=>{const r="_onData"+u1(t),s=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...a){const o=s.apply(this,a);return n._chartjs.listeners.forEach(l=>{typeof l[r]=="function"&&l[r](...a)}),o}})})}function ER(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,s=r.indexOf(e);s!==-1&&r.splice(s,1),!(r.length>0)&&(f6.forEach(a=>{delete n[a]}),delete n._chartjs)}function h6(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const m6=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function p6(n,e){let t=[],r=!1;return function(...s){t=s,r||(r=!0,m6.call(window,()=>{r=!1,n.apply(e,t)}))}}function cie(n,e){let t;return function(...r){return e?(clearTimeout(t),t=setTimeout(n,e,r)):n.apply(this,r),e}}const g6=n=>n==="start"?"left":n==="end"?"right":"center",ci=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,die=(n,e,t,r)=>n===(r?"left":"right")?t:n==="center"?(e+t)/2:e;function uie(n,e,t){const r=e.length;let s=0,a=r;if(n._sorted){const{iScale:o,vScale:l,_parsed:c}=n,d=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,h=o.axis,{min:p,max:x,minDefined:v,maxDefined:w}=o.getUserBounds();if(v){if(s=Math.min(su(c,h,p).lo,t?r:su(e,h,o.getPixelForValue(p)).lo),d){const _=c.slice(0,s+1).reverse().findIndex(j=>!yn(j[l.axis]));s-=Math.max(0,_)}s=os(s,0,r-1)}if(w){let _=Math.max(su(c,o.axis,x,!0).hi+1,t?0:su(e,h,o.getPixelForValue(x),!0).hi+1);if(d){const j=c.slice(_-1).findIndex(T=>!yn(T[l.axis]));_+=Math.max(0,j)}a=os(_,s,r)-s}else a=r-s}return{start:s,count:a}}function fie(n){const{xScale:e,yScale:t,_scaleRanges:r}=n,s={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!r)return n._scaleRanges=s,!0;const a=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,s),a}const Ug=n=>n===0||n===1,DR=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Xn/t)),OR=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Xn/t)+1,nm={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*kr)+1,easeOutSine:n=>Math.sin(n*kr),easeInOutSine:n=>-.5*(Math.cos(Mn*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Ug(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Ug(n)?n:DR(n,.075,.3),easeOutElastic:n=>Ug(n)?n:OR(n,.075,.3),easeInOutElastic(n){return Ug(n)?n:n<.5?.5*DR(n*2,.1125,.45):.5+.5*OR(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-nm.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?nm.easeInBounce(n*2)*.5:nm.easeOutBounce(n*2-1)*.5+.5};function h1(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function IR(n){return h1(n)?n:new _m(n)}function NN(n){return h1(n)?n:new _m(n).saturate(.5).darken(.1).hexString()}const hie=["x","y","borderWidth","radius","tension"],mie=["color","borderColor","backgroundColor"];function pie(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:mie},numbers:{type:"number",properties:hie}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function gie(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const AR=new Map;function xie(n,e){e=e||{};const t=n+JSON.stringify(e);let r=AR.get(t);return r||(r=new Intl.NumberFormat(n,e),AR.set(t,r)),r}function m1(n,e,t){return xie(e,t).format(n)}const yie={values(n){return Tr(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const r=this.chart.options.locale;let s,a=n;if(t.length>1){const d=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(d<1e-4||d>1e15)&&(s="scientific"),a=vie(n,t)}const o=d6(Math.abs(a)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:s,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),m1(n,r,c)}};function vie(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var x6={formatters:yie};function bie(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:x6.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const pu=Object.create(null),YS=Object.create(null);function rm(n,e){if(!e)return n;const t=e.split(".");for(let r=0,s=t.length;r<s;++r){const a=t[r];n=n[a]||(n[a]=Object.create(null))}return n}function SN(n,e,t){return typeof e=="string"?jm(rm(n,e),t):jm(rm(n,""),e)}class wie{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,s)=>NN(s.backgroundColor),this.hoverBorderColor=(r,s)=>NN(s.borderColor),this.hoverColor=(r,s)=>NN(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return SN(this,e,t)}get(e){return rm(this,e)}describe(e,t){return SN(YS,e,t)}override(e,t){return SN(pu,e,t)}route(e,t,r,s){const a=rm(this,e),o=rm(this,r),l="_"+t;Object.defineProperties(a,{[l]:{value:a[t],writable:!0},[t]:{enumerable:!0,get(){const c=this[l],d=o[s];return nn(c)?Object.assign({},d,c):Gt(c,d)},set(c){this[l]=c}}})}apply(e){e.forEach(t=>t(this))}}var lr=new wie({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[pie,gie,bie]);function _ie(n){return!n||yn(n.size)||yn(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function RR(n,e,t,r,s){let a=e[s];return a||(a=e[s]=n.measureText(s).width,t.push(s)),a>r&&(r=a),r}function Hd(n,e,t){const r=n.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*r)/r+s}function LR(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function GS(n,e,t,r){y6(n,e,t,r,null)}function y6(n,e,t,r,s){let a,o,l,c,d,h,p,x;const v=e.pointStyle,w=e.rotation,_=e.radius;let j=(w||0)*Qse;if(v&&typeof v=="object"&&(a=v.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){n.save(),n.translate(t,r),n.rotate(j),n.drawImage(v,-v.width/2,-v.height/2,v.width,v.height),n.restore();return}if(!(isNaN(_)||_<=0)){switch(n.beginPath(),v){default:s?n.ellipse(t,r,s/2,_,0,0,Xn):n.arc(t,r,_,0,Xn),n.closePath();break;case"triangle":h=s?s/2:_,n.moveTo(t+Math.sin(j)*h,r-Math.cos(j)*_),j+=kR,n.lineTo(t+Math.sin(j)*h,r-Math.cos(j)*_),j+=kR,n.lineTo(t+Math.sin(j)*h,r-Math.cos(j)*_),n.closePath();break;case"rectRounded":d=_*.516,c=_-d,o=Math.cos(j+$d)*c,p=Math.cos(j+$d)*(s?s/2-d:c),l=Math.sin(j+$d)*c,x=Math.sin(j+$d)*(s?s/2-d:c),n.arc(t-p,r-l,d,j-Mn,j-kr),n.arc(t+x,r-o,d,j-kr,j),n.arc(t+p,r+l,d,j,j+kr),n.arc(t-x,r+o,d,j+kr,j+Mn),n.closePath();break;case"rect":if(!w){c=Math.SQRT1_2*_,h=s?s/2:c,n.rect(t-h,r-c,2*h,2*c);break}j+=$d;case"rectRot":p=Math.cos(j)*(s?s/2:_),o=Math.cos(j)*_,l=Math.sin(j)*_,x=Math.sin(j)*(s?s/2:_),n.moveTo(t-p,r-l),n.lineTo(t+x,r-o),n.lineTo(t+p,r+l),n.lineTo(t-x,r+o),n.closePath();break;case"crossRot":j+=$d;case"cross":p=Math.cos(j)*(s?s/2:_),o=Math.cos(j)*_,l=Math.sin(j)*_,x=Math.sin(j)*(s?s/2:_),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o);break;case"star":p=Math.cos(j)*(s?s/2:_),o=Math.cos(j)*_,l=Math.sin(j)*_,x=Math.sin(j)*(s?s/2:_),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o),j+=$d,p=Math.cos(j)*(s?s/2:_),o=Math.cos(j)*_,l=Math.sin(j)*_,x=Math.sin(j)*(s?s/2:_),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o);break;case"line":o=s?s/2:Math.cos(j)*_,l=Math.sin(j)*_,n.moveTo(t-o,r-l),n.lineTo(t+o,r+l);break;case"dash":n.moveTo(t,r),n.lineTo(t+Math.cos(j)*(s?s/2:_),r+Math.sin(j)*_);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function Tm(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Py(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function My(n){n.restore()}function jie(n,e,t,r,s){if(!e)return n.lineTo(t.x,t.y);if(s==="middle"){const a=(e.x+t.x)/2;n.lineTo(a,e.y),n.lineTo(a,t.y)}else s==="after"!=!!r?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function Nie(n,e,t,r){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function Sie(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),yn(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function Cie(n,e,t,r,s){if(s.strikethrough||s.underline){const a=n.measureText(r),o=e-a.actualBoundingBoxLeft,l=e+a.actualBoundingBoxRight,c=t-a.actualBoundingBoxAscent,d=t+a.actualBoundingBoxDescent,h=s.strikethrough?(c+d)/2:d;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(o,h),n.lineTo(l,h),n.stroke()}}function Tie(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Vx(n,e,t,r,s,a={}){const o=Tr(e)?e:[e],l=a.strokeWidth>0&&a.strokeColor!=="";let c,d;for(n.save(),n.font=s.string,Sie(n,a),c=0;c<o.length;++c)d=o[c],a.backdrop&&Tie(n,a.backdrop),l&&(a.strokeColor&&(n.strokeStyle=a.strokeColor),yn(a.strokeWidth)||(n.lineWidth=a.strokeWidth),n.strokeText(d,t,r,a.maxWidth)),n.fillText(d,t,r,a.maxWidth),Cie(n,t,r,d,a),r+=Number(s.lineHeight);n.restore()}function Bx(n,e){const{x:t,y:r,w:s,h:a,radius:o}=e;n.arc(t+o.topLeft,r+o.topLeft,o.topLeft,1.5*Mn,Mn,!0),n.lineTo(t,r+a-o.bottomLeft),n.arc(t+o.bottomLeft,r+a-o.bottomLeft,o.bottomLeft,Mn,kr,!0),n.lineTo(t+s-o.bottomRight,r+a),n.arc(t+s-o.bottomRight,r+a-o.bottomRight,o.bottomRight,kr,0,!0),n.lineTo(t+s,r+o.topRight),n.arc(t+s-o.topRight,r+o.topRight,o.topRight,0,-kr,!0),n.lineTo(t+o.topLeft,r)}const kie=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Pie=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Mie(n,e){const t=(""+n).match(kie);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const Eie=n=>+n||0;function p1(n,e){const t={},r=nn(e),s=r?Object.keys(e):e,a=nn(n)?r?o=>Gt(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of s)t[o]=Eie(a(o));return t}function v6(n){return p1(n,{top:"y",right:"x",bottom:"y",left:"x"})}function gf(n){return p1(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Ia(n){const e=v6(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Hs(n,e){n=n||{},e=e||lr.font;let t=Gt(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let r=Gt(n.style,e.style);r&&!(""+r).match(Pie)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const s={family:Gt(n.family,e.family),lineHeight:Mie(Gt(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:Gt(n.weight,e.weight),string:""};return s.string=_ie(s),s}function Vg(n,e,t,r){let s,a,o;for(s=0,a=n.length;s<a;++s)if(o=n[s],o!==void 0&&o!==void 0)return o}function Die(n,e,t){const{min:r,max:s}=n,a=l6(e,(s-r)/2),o=(l,c)=>t&&l===0?0:l+c;return{min:o(r,-Math.abs(a)),max:o(s,a)}}function ju(n,e){return Object.assign(Object.create(n),e)}function g1(n,e=[""],t,r,s=()=>n[0]){const a=t||n;typeof r>"u"&&(r=j6("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:a,_fallback:r,_getTarget:s,override:l=>g1([l,...n],e,a,r)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete n[0][c],!0},get(l,c){return w6(l,c,()=>zie(c,e,n,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(l,c){return qR(l).includes(c)},ownKeys(l){return qR(l)},set(l,c,d){const h=l._storage||(l._storage=s());return l[c]=h[c]=d,delete l._keys,!0}})}function Af(n,e,t,r){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:b6(n,r),setContext:a=>Af(n,a,t,r),override:a=>Af(n.override(a),e,t,r)};return new Proxy(s,{deleteProperty(a,o){return delete a[o],delete n[o],!0},get(a,o,l){return w6(a,o,()=>Iie(a,o,l))},getOwnPropertyDescriptor(a,o){return a._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(a,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(a,o,l){return n[o]=l,delete a[o],!0}})}function b6(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:t,indexable:r,isScriptable:Hc(t)?t:()=>t,isIndexable:Hc(r)?r:()=>r}}const Oie=(n,e)=>n?n+u1(e):e,x1=(n,e)=>nn(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function w6(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const r=t();return n[e]=r,r}function Iie(n,e,t){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=n;let l=r[e];return Hc(l)&&o.isScriptable(e)&&(l=Aie(e,l,n,t)),Tr(l)&&l.length&&(l=Rie(e,l,n,o.isIndexable)),x1(e,l)&&(l=Af(l,s,a&&a[e],o)),l}function Aie(n,e,t,r){const{_proxy:s,_context:a,_subProxy:o,_stack:l}=t;if(l.has(n))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+n);l.add(n);let c=e(a,o||r);return l.delete(n),x1(n,c)&&(c=y1(s._scopes,s,n,c)),c}function Rie(n,e,t,r){const{_proxy:s,_context:a,_subProxy:o,_descriptors:l}=t;if(typeof a.index<"u"&&r(n))return e[a.index%e.length];if(nn(e[0])){const c=e,d=s._scopes.filter(h=>h!==c);e=[];for(const h of c){const p=y1(d,s,n,h);e.push(Af(p,a,o&&o[n],l))}}return e}function _6(n,e,t){return Hc(n)?n(e,t):n}const Lie=(n,e)=>n===!0?e:typeof n=="string"?mu(e,n):void 0;function Fie(n,e,t,r,s){for(const a of e){const o=Lie(t,a);if(o){n.add(o);const l=_6(o._fallback,t,s);if(typeof l<"u"&&l!==t&&l!==r)return l}else if(o===!1&&typeof r<"u"&&t!==r)return null}return!1}function y1(n,e,t,r){const s=e._rootScopes,a=_6(e._fallback,t,r),o=[...n,...s],l=new Set;l.add(r);let c=FR(l,o,t,a||t,r);return c===null||typeof a<"u"&&a!==t&&(c=FR(l,o,a,c,r),c===null)?!1:g1(Array.from(l),[""],s,a,()=>qie(e,t,r))}function FR(n,e,t,r,s){for(;t;)t=Fie(n,e,t,r,s);return t}function qie(n,e,t){const r=n._getTarget();e in r||(r[e]={});const s=r[e];return Tr(s)&&nn(t)?t:s||{}}function zie(n,e,t,r){let s;for(const a of e)if(s=j6(Oie(a,n),t),typeof s<"u")return x1(n,s)?y1(t,r,n,s):s}function j6(n,e){for(const t of e){if(!t)continue;const r=t[n];if(typeof r<"u")return r}}function qR(n){let e=n._keys;return e||(e=n._keys=Uie(n._scopes)),e}function Uie(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(r);return Array.from(e)}const Vie=Number.EPSILON||1e-14,Rf=(n,e)=>e<n.length&&!n[e].skip&&n[e],N6=n=>n==="x"?"y":"x";function Bie(n,e,t,r){const s=n.skip?e:n,a=e,o=t.skip?e:t,l=HS(a,s),c=HS(o,a);let d=l/(l+c),h=c/(l+c);d=isNaN(d)?0:d,h=isNaN(h)?0:h;const p=r*d,x=r*h;return{previous:{x:a.x-p*(o.x-s.x),y:a.y-p*(o.y-s.y)},next:{x:a.x+x*(o.x-s.x),y:a.y+x*(o.y-s.y)}}}function Wie(n,e,t){const r=n.length;let s,a,o,l,c,d=Rf(n,0);for(let h=0;h<r-1;++h)if(c=d,d=Rf(n,h+1),!(!c||!d)){if(tm(e[h],0,Vie)){t[h]=t[h+1]=0;continue}s=t[h]/e[h],a=t[h+1]/e[h],l=Math.pow(s,2)+Math.pow(a,2),!(l<=9)&&(o=3/Math.sqrt(l),t[h]=s*o*e[h],t[h+1]=a*o*e[h])}}function $ie(n,e,t="x"){const r=N6(t),s=n.length;let a,o,l,c=Rf(n,0);for(let d=0;d<s;++d){if(o=l,l=c,c=Rf(n,d+1),!l)continue;const h=l[t],p=l[r];o&&(a=(h-o[t])/3,l[`cp1${t}`]=h-a,l[`cp1${r}`]=p-a*e[d]),c&&(a=(c[t]-h)/3,l[`cp2${t}`]=h+a,l[`cp2${r}`]=p+a*e[d])}}function Hie(n,e="x"){const t=N6(e),r=n.length,s=Array(r).fill(0),a=Array(r);let o,l,c,d=Rf(n,0);for(o=0;o<r;++o)if(l=c,c=d,d=Rf(n,o+1),!!c){if(d){const h=d[e]-c[e];s[o]=h!==0?(d[t]-c[t])/h:0}a[o]=l?d?No(s[o-1])!==No(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}Wie(n,s,a),$ie(n,a,e)}function Bg(n,e,t){return Math.max(Math.min(n,t),e)}function Yie(n,e){let t,r,s,a,o,l=Tm(n[0],e);for(t=0,r=n.length;t<r;++t)o=a,a=l,l=t<r-1&&Tm(n[t+1],e),a&&(s=n[t],o&&(s.cp1x=Bg(s.cp1x,e.left,e.right),s.cp1y=Bg(s.cp1y,e.top,e.bottom)),l&&(s.cp2x=Bg(s.cp2x,e.left,e.right),s.cp2y=Bg(s.cp2y,e.top,e.bottom)))}function Gie(n,e,t,r,s){let a,o,l,c;if(e.spanGaps&&(n=n.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")Hie(n,s);else{let d=r?n[n.length-1]:n[0];for(a=0,o=n.length;a<o;++a)l=n[a],c=Bie(d,l,n[Math.min(a+1,o-(r?0:1))%o],e.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,d=l}e.capBezierPoints&&Yie(n,t)}function v1(){return typeof window<"u"&&typeof document<"u"}function b1(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Wx(n,e,t){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*e.parentNode[t])):r=n,r}const Ey=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function Zie(n,e){return Ey(n).getPropertyValue(e)}const Kie=["top","right","bottom","left"];function lu(n,e,t){const r={};t=t?"-"+t:"";for(let s=0;s<4;s++){const a=Kie[s];r[a]=parseFloat(n[e+"-"+a+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const Jie=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function Qie(n,e){const t=n.touches,r=t&&t.length?t[0]:n,{offsetX:s,offsetY:a}=r;let o=!1,l,c;if(Jie(s,a,n.target))l=s,c=a;else{const d=e.getBoundingClientRect();l=r.clientX-d.left,c=r.clientY-d.top,o=!0}return{x:l,y:c,box:o}}function Jd(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:r}=e,s=Ey(t),a=s.boxSizing==="border-box",o=lu(s,"padding"),l=lu(s,"border","width"),{x:c,y:d,box:h}=Qie(n,t),p=o.left+(h&&l.left),x=o.top+(h&&l.top);let{width:v,height:w}=e;return a&&(v-=o.width+l.width,w-=o.height+l.height),{x:Math.round((c-p)/v*t.width/r),y:Math.round((d-x)/w*t.height/r)}}function Xie(n,e,t){let r,s;if(e===void 0||t===void 0){const a=n&&b1(n);if(!a)e=n.clientWidth,t=n.clientHeight;else{const o=a.getBoundingClientRect(),l=Ey(a),c=lu(l,"border","width"),d=lu(l,"padding");e=o.width-d.width-c.width,t=o.height-d.height-c.height,r=Wx(l.maxWidth,a,"clientWidth"),s=Wx(l.maxHeight,a,"clientHeight")}}return{width:e,height:t,maxWidth:r||Ux,maxHeight:s||Ux}}const Ac=n=>Math.round(n*10)/10;function eae(n,e,t,r){const s=Ey(n),a=lu(s,"margin"),o=Wx(s.maxWidth,n,"clientWidth")||Ux,l=Wx(s.maxHeight,n,"clientHeight")||Ux,c=Xie(n,e,t);let{width:d,height:h}=c;if(s.boxSizing==="content-box"){const x=lu(s,"border","width"),v=lu(s,"padding");d-=v.width+x.width,h-=v.height+x.height}return d=Math.max(0,d-a.width),h=Math.max(0,r?d/r:h-a.height),d=Ac(Math.min(d,o,c.maxWidth)),h=Ac(Math.min(h,l,c.maxHeight)),d&&!h&&(h=Ac(d/2)),(e!==void 0||t!==void 0)&&r&&c.height&&h>c.height&&(h=c.height,d=Ac(Math.floor(h*r))),{width:d,height:h}}function zR(n,e,t){const r=e||1,s=Ac(n.height*r),a=Ac(n.width*r);n.height=Ac(n.height),n.width=Ac(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==r||o.height!==s||o.width!==a?(n.currentDevicePixelRatio=r,o.height=s,o.width=a,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const tae=(function(){let n=!1;try{const e={get passive(){return n=!0,!1}};v1()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n})();function UR(n,e){const t=Zie(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Qd(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function nae(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:r==="middle"?t<.5?n.y:e.y:r==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function rae(n,e,t,r){const s={x:n.cp2x,y:n.cp2y},a={x:e.cp1x,y:e.cp1y},o=Qd(n,s,t),l=Qd(s,a,t),c=Qd(a,e,t),d=Qd(o,l,t),h=Qd(l,c,t);return Qd(d,h,t)}const sae=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,r){return t-r},leftForLtr(t,r){return t-r}}},iae=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function xf(n,e,t){return n?sae(e,t):iae()}function S6(n,e){let t,r;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=r)}function C6(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function T6(n){return n==="angle"?{between:Cm,compare:sie,normalize:ui}:{between:wl,compare:(e,t)=>e-t,normalize:e=>e}}function VR({start:n,end:e,count:t,loop:r,style:s}){return{start:n%t,end:e%t,loop:r&&(e-n+1)%t===0,style:s}}function aae(n,e,t){const{property:r,start:s,end:a}=t,{between:o,normalize:l}=T6(r),c=e.length;let{start:d,end:h,loop:p}=n,x,v;if(p){for(d+=c,h+=c,x=0,v=c;x<v&&o(l(e[d%c][r]),s,a);++x)d--,h--;d%=c,h%=c}return h<d&&(h+=c),{start:d,end:h,loop:p,style:n.style}}function k6(n,e,t){if(!t)return[n];const{property:r,start:s,end:a}=t,o=e.length,{compare:l,between:c,normalize:d}=T6(r),{start:h,end:p,loop:x,style:v}=aae(n,e,t),w=[];let _=!1,j=null,T,P,D;const M=()=>c(s,D,T)&&l(s,D)!==0,O=()=>l(a,T)===0||c(a,D,T),I=()=>_||M(),q=()=>!_||O();for(let F=h,V=h;F<=p;++F)P=e[F%o],!P.skip&&(T=d(P[r]),T!==D&&(_=c(T,s,a),j===null&&I()&&(j=l(T,s)===0?F:V),j!==null&&q()&&(w.push(VR({start:j,end:F,loop:x,count:o,style:v})),j=null),V=F,D=T));return j!==null&&w.push(VR({start:j,end:p,loop:x,count:o,style:v})),w}function P6(n,e){const t=[],r=n.segments;for(let s=0;s<r.length;s++){const a=k6(r[s],n.points,e);a.length&&t.push(...a)}return t}function oae(n,e,t,r){let s=0,a=e-1;if(t&&!r)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,t&&(a+=s);a>s&&n[a%e].skip;)a--;return a%=e,{start:s,end:a}}function lae(n,e,t,r){const s=n.length,a=[];let o=e,l=n[e],c;for(c=e+1;c<=t;++c){const d=n[c%s];d.skip||d.stop?l.skip||(r=!1,a.push({start:e%s,end:(c-1)%s,loop:r}),e=o=d.stop?c:null):(o=c,l.skip&&(e=c)),l=d}return o!==null&&a.push({start:e%s,end:o%s,loop:r}),a}function cae(n,e){const t=n.points,r=n.options.spanGaps,s=t.length;if(!s)return[];const a=!!n._loop,{start:o,end:l}=oae(t,s,a,r);if(r===!0)return BR(n,[{start:o,end:l,loop:a}],t,e);const c=l<o?l+s:l,d=!!n._fullLoop&&o===0&&l===s-1;return BR(n,lae(t,o,c,d),t,e)}function BR(n,e,t,r){return!r||!r.setContext||!t?e:dae(n,e,t,r)}function dae(n,e,t,r){const s=n._chart.getContext(),a=WR(n.options),{_datasetIndex:o,options:{spanGaps:l}}=n,c=t.length,d=[];let h=a,p=e[0].start,x=p;function v(w,_,j,T){const P=l?-1:1;if(w!==_){for(w+=c;t[w%c].skip;)w-=P;for(;t[_%c].skip;)_+=P;w%c!==_%c&&(d.push({start:w%c,end:_%c,loop:j,style:T}),h=T,p=_%c)}}for(const w of e){p=l?p:w.start;let _=t[p%c],j;for(x=p+1;x<=w.end;x++){const T=t[x%c];j=WR(r.setContext(ju(s,{type:"segment",p0:_,p1:T,p0DataIndex:(x-1)%c,p1DataIndex:x%c,datasetIndex:o}))),uae(j,h)&&v(p,x-1,w.loop,h),_=T,h=j}p<x-1&&v(p,x-1,w.loop,h)}return d}function WR(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function uae(n,e){if(!e)return!1;const t=[],r=function(s,a){return h1(a)?(t.includes(a)||t.push(a),t.indexOf(a)):a};return JSON.stringify(n,r)!==JSON.stringify(e,r)}function Wg(n,e,t){return n.options.clip?n[t]:e[t]}function fae(n,e){const{xScale:t,yScale:r}=n;return t&&r?{left:Wg(t,e,"left"),right:Wg(t,e,"right"),top:Wg(r,e,"top"),bottom:Wg(r,e,"bottom")}:e}function M6(n,e){const t=e._clip;if(t.disabled)return!1;const r=fae(e,n.chartArea);return{left:t.left===!1?0:r.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:r.right+(t.right===!0?0:t.right),top:t.top===!1?0:r.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:r.bottom+(t.bottom===!0?0:t.bottom)}}class hae{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,s){const a=t.listeners[s],o=t.duration;a.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(r-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=m6.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,s)=>{if(!r.running||!r.items.length)return;const a=r.items;let o=a.length-1,l=!1,c;for(;o>=0;--o)c=a[o],c._active?(c._total>r.duration&&(r.duration=c._total),c.tick(e),l=!0):(a[o]=a[a.length-1],a.pop());l&&(s.draw(),this._notify(s,r,e,"progress")),a.length||(r.running=!1,this._notify(s,r,e,"complete"),r.initial=!1),t+=a.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,s)=>Math.max(r,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let s=r.length-1;for(;s>=0;--s)r[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ml=new hae;const $R="transparent",mae={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const r=IR(n||$R),s=r.valid&&IR(e||$R);return s&&s.valid?s.mix(r,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class pae{constructor(e,t,r,s){const a=t[r];s=Vg([e.to,s,a,e.from]);const o=Vg([e.from,a,s]);this._active=!0,this._fn=e.fn||mae[e.type||typeof o],this._easing=nm[e.easing]||nm.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const s=this._target[this._prop],a=r-this._start,o=this._duration-a;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=Vg([e.to,t,s,e.from]),this._from=Vg([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,s=this._prop,a=this._from,o=this._loop,l=this._to;let c;if(this._active=a!==l&&(o||t<r),!this._active){this._target[s]=l,this._notify(!0);return}if(t<0){this._target[s]=a;return}c=t/r%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[s]=this._fn(a,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let s=0;s<r.length;s++)r[s][t]()}}class E6{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!nn(e))return;const t=Object.keys(lr.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const a=e[s];if(!nn(a))return;const o={};for(const l of t)o[l]=a[l];(Tr(a.properties)&&a.properties||[s]).forEach(l=>{(l===s||!r.has(l))&&r.set(l,o)})})}_animateOptions(e,t){const r=t.options,s=xae(e,r);if(!s)return[];const a=this._createAnimations(s,r);return r.$shared&&gae(e.options.$animations,r).then(()=>{e.options=r},()=>{}),a}_createAnimations(e,t){const r=this._properties,s=[],a=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const d=o[c];if(d.charAt(0)==="$")continue;if(d==="options"){s.push(...this._animateOptions(e,t));continue}const h=t[d];let p=a[d];const x=r.get(d);if(p)if(x&&p.active()){p.update(x,h,l);continue}else p.cancel();if(!x||!x.duration){e[d]=h;continue}a[d]=p=new pae(x,e,d,h),s.push(p)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return ml.add(this._chart,r),!0}}function gae(n,e){const t=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const a=n[r[s]];a&&a.active()&&t.push(a.wait())}return Promise.all(t)}function xae(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function HR(n,e){const t=n&&n.options||{},r=t.reverse,s=t.min===void 0?e:0,a=t.max===void 0?e:0;return{start:r?a:s,end:r?s:a}}function yae(n,e,t){if(t===!1)return!1;const r=HR(n,t),s=HR(e,t);return{top:s.end,right:r.end,bottom:s.start,left:r.start}}function vae(n){let e,t,r,s;return nn(n)?(e=n.top,t=n.right,r=n.bottom,s=n.left):e=t=r=s=n,{top:e,right:t,bottom:r,left:s,disabled:n===!1}}function D6(n,e){const t=[],r=n._getSortedDatasetMetas(e);let s,a;for(s=0,a=r.length;s<a;++s)t.push(r[s].index);return t}function YR(n,e,t,r={}){const s=n.keys,a=r.mode==="single";let o,l,c,d;if(e===null)return;let h=!1;for(o=0,l=s.length;o<l;++o){if(c=+s[o],c===t){if(h=!0,r.all)continue;break}d=n.values[c],cs(d)&&(a||e===0||No(e)===No(d))&&(e+=d)}return!h&&!r.all?0:e}function bae(n,e){const{iScale:t,vScale:r}=e,s=t.axis==="x"?"x":"y",a=r.axis==="x"?"x":"y",o=Object.keys(n),l=new Array(o.length);let c,d,h;for(c=0,d=o.length;c<d;++c)h=o[c],l[c]={[s]:h,[a]:n[h]};return l}function CN(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function wae(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function _ae(n){const{min:e,max:t,minDefined:r,maxDefined:s}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function jae(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function GR(n,e,t,r){for(const s of e.getMatchingVisibleMetas(r).reverse()){const a=n[s.index];if(t&&a>0||!t&&a<0)return s.index}return null}function ZR(n,e){const{chart:t,_cachedMeta:r}=n,s=t._stacks||(t._stacks={}),{iScale:a,vScale:o,index:l}=r,c=a.axis,d=o.axis,h=wae(a,o,r),p=e.length;let x;for(let v=0;v<p;++v){const w=e[v],{[c]:_,[d]:j}=w,T=w._stacks||(w._stacks={});x=T[d]=jae(s,h,_),x[l]=j,x._top=GR(x,o,!0,r.type),x._bottom=GR(x,o,!1,r.type);const P=x._visualValues||(x._visualValues={});P[l]=j}}function TN(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function Nae(n,e){return ju(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Sae(n,e,t){return ju(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Ih(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const s of e){const a=s._stacks;if(!a||a[r]===void 0||a[r][t]===void 0)return;delete a[r][t],a[r]._visualValues!==void 0&&a[r]._visualValues[t]!==void 0&&delete a[r]._visualValues[t]}}}const kN=n=>n==="reset"||n==="none",KR=(n,e)=>e?n:Object.assign({},n),Cae=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:D6(t,!0),values:null};class Dy{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=CN(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Ih(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),s=(p,x,v,w)=>p==="x"?x:p==="r"?w:v,a=t.xAxisID=Gt(r.xAxisID,TN(e,"x")),o=t.yAxisID=Gt(r.yAxisID,TN(e,"y")),l=t.rAxisID=Gt(r.rAxisID,TN(e,"r")),c=t.indexAxis,d=t.iAxisID=s(c,a,o,l),h=t.vAxisID=s(c,o,a,l);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(d),t.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&ER(this._data,this),e._stacked&&Ih(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(nn(t)){const s=this._cachedMeta;this._data=bae(t,s)}else if(r!==t){if(r){ER(r,this);const s=this._cachedMeta;Ih(s),s._parsed=[]}t&&Object.isExtensible(t)&&lie(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let s=!1;this._dataCheck();const a=t._stacked;t._stacked=CN(t.vScale,t),t.stack!==r.stack&&(s=!0,Ih(t),t.stack=r.stack),this._resyncElements(e),(s||a!==t._stacked)&&(ZR(this,t._parsed),t._stacked=CN(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:s}=this,{iScale:a,_stacked:o}=r,l=a.axis;let c=e===0&&t===s.length?!0:r._sorted,d=e>0&&r._parsed[e-1],h,p,x;if(this._parsing===!1)r._parsed=s,r._sorted=!0,x=s;else{Tr(s[e])?x=this.parseArrayData(r,s,e,t):nn(s[e])?x=this.parseObjectData(r,s,e,t):x=this.parsePrimitiveData(r,s,e,t);const v=()=>p[l]===null||d&&p[l]<d[l];for(h=0;h<t;++h)r._parsed[h+e]=p=x[h],c&&(v()&&(c=!1),d=p);r._sorted=c}o&&ZR(this,x)}parsePrimitiveData(e,t,r,s){const{iScale:a,vScale:o}=e,l=a.axis,c=o.axis,d=a.getLabels(),h=a===o,p=new Array(s);let x,v,w;for(x=0,v=s;x<v;++x)w=x+r,p[x]={[l]:h||a.parse(d[w],w),[c]:o.parse(t[w],w)};return p}parseArrayData(e,t,r,s){const{xScale:a,yScale:o}=e,l=new Array(s);let c,d,h,p;for(c=0,d=s;c<d;++c)h=c+r,p=t[h],l[c]={x:a.parse(p[0],h),y:o.parse(p[1],h)};return l}parseObjectData(e,t,r,s){const{xScale:a,yScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=new Array(s);let h,p,x,v;for(h=0,p=s;h<p;++h)x=h+r,v=t[x],d[h]={x:a.parse(mu(v,l),x),y:o.parse(mu(v,c),x)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const s=this.chart,a=this._cachedMeta,o=t[e.axis],l={keys:D6(s,!0),values:t._stacks[e.axis]._visualValues};return YR(l,o,a.index,{mode:r})}updateRangeFromParsed(e,t,r,s){const a=r[t.axis];let o=a===null?NaN:a;const l=s&&r._stacks[t.axis];s&&l&&(s.values=l,o=YR(s,a,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const r=this._cachedMeta,s=r._parsed,a=r._sorted&&e===r.iScale,o=s.length,l=this._getOtherScale(e),c=Cae(t,r,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:p}=_ae(l);let x,v;function w(){v=s[x];const _=v[l.axis];return!cs(v[e.axis])||h>_||p<_}for(x=0;x<o&&!(!w()&&(this.updateRangeFromParsed(d,e,v,c),a));++x);if(a){for(x=o-1;x>=0;--x)if(!w()){this.updateRangeFromParsed(d,e,v,c);break}}return d}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let s,a,o;for(s=0,a=t.length;s<a;++s)o=t[s][e.axis],cs(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,s=t.vScale,a=this.getParsed(e);return{label:r?""+r.getLabelForValue(a[r.axis]):"",value:s?""+s.getLabelForValue(a[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=vae(Gt(this.options.clip,yae(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,s=r.data||[],a=t.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||s.length-l,d=this.options.drawActiveElementsOnTop;let h;for(r.dataset&&r.dataset.draw(e,a,l,c),h=l;h<l+c;++h){const p=s[h];p.hidden||(p.active&&d?o.push(p):p.draw(e,a))}for(h=0;h<o.length;++h)o[h].draw(e,a)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const s=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];a=o.$context||(o.$context=Sae(this.getContext(),e,o)),a.parsed=this.getParsed(e),a.raw=s.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=Nae(this.chart.getContext(),this.index)),a.dataset=s,a.index=a.datasetIndex=this.index;return a.active=!!t,a.mode=r,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const s=t==="active",a=this._cachedDataOpts,o=e+"-"+t,l=a[o],c=this.enableOptionSharing&&Nm(r);if(l)return KR(l,c);const d=this.chart.config,h=d.datasetElementScopeKeys(this._type,e),p=s?[`${e}Hover`,"hover",e,""]:[e,""],x=d.getOptionScopes(this.getDataset(),h),v=Object.keys(lr.elements[e]),w=()=>this.getContext(r,s,t),_=d.resolveNamedOptions(x,v,w,p);return _.$shared&&(_.$shared=c,a[o]=Object.freeze(KR(_,c))),_}_resolveAnimations(e,t,r){const s=this.chart,a=this._cachedDataOpts,o=`animation-${t}`,l=a[o];if(l)return l;let c;if(s.options.animation!==!1){const h=this.chart.config,p=h.datasetAnimationScopeKeys(this._type,t),x=h.getOptionScopes(this.getDataset(),p);c=h.createResolver(x,this.getContext(e,r,t))}const d=new E6(s,c&&c.animations);return c&&c._cacheable&&(a[o]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||kN(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),s=this._sharedOptions,a=this.getSharedOptions(r),o=this.includeOptions(t,a)||a!==s;return this.updateSharedOptions(a,t,r),{sharedOptions:a,includeOptions:o}}updateElement(e,t,r,s){kN(s)?Object.assign(e,r):this._resolveAnimations(t,s).update(e,r)}updateSharedOptions(e,t,r){e&&!kN(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,s){e.active=s;const a=this.getStyle(t,s);this._resolveAnimations(t,r,s).update(e,{options:!s&&this.getSharedOptions(a)||a})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[l,c,d]of this._syncList)this[l](c,d);this._syncList=[];const s=r.length,a=t.length,o=Math.min(a,s);o&&this.parse(0,o),a>s?this._insertElements(s,a-s,e):a<s&&this._removeElements(a,s-a)}_insertElements(e,t,r=!0){const s=this._cachedMeta,a=s.data,o=e+t;let l;const c=d=>{for(d.length+=t,l=d.length-1;l>=o;l--)d[l]=d[l-t]};for(c(a),l=e;l<o;++l)a[l]=new this.dataElementType;this._parsing&&c(s._parsed),this.parse(e,t),r&&this.updateElements(a,e,t,"reset")}updateElements(e,t,r,s){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const s=r._parsed.splice(e,t);r._stacked&&Ih(r,s)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,s]=e;this[t](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Tae(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let r=[];for(let s=0,a=t.length;s<a;s++)r=r.concat(t[s].controller.getAllParsedValues(n));n._cache.$bar=h6(r.sort((s,a)=>s-a))}return n._cache.$bar}function kae(n){const e=n.iScale,t=Tae(e,n.type);let r=e._length,s,a,o,l;const c=()=>{o===32767||o===-32768||(Nm(l)&&(r=Math.min(r,Math.abs(o-l)||r)),l=o)};for(s=0,a=t.length;s<a;++s)o=e.getPixelForValue(t[s]),c();for(l=void 0,s=0,a=e.ticks.length;s<a;++s)o=e.getPixelForTick(s),c();return r}function Pae(n,e,t,r){const s=t.barThickness;let a,o;return yn(s)?(a=e.min*t.categoryPercentage,o=t.barPercentage):(a=s*r,o=1),{chunk:a/r,ratio:o,start:e.pixels[n]-a/2}}function Mae(n,e,t,r){const s=e.pixels,a=s[n];let o=n>0?s[n-1]:null,l=n<s.length-1?s[n+1]:null;const c=t.categoryPercentage;o===null&&(o=a-(l===null?e.end-e.start:l-a)),l===null&&(l=a+a-o);const d=a-(a-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/r,ratio:t.barPercentage,start:d}}function Eae(n,e,t,r){const s=t.parse(n[0],r),a=t.parse(n[1],r),o=Math.min(s,a),l=Math.max(s,a);let c=o,d=l;Math.abs(o)>Math.abs(l)&&(c=l,d=o),e[t.axis]=d,e._custom={barStart:c,barEnd:d,start:s,end:a,min:o,max:l}}function O6(n,e,t,r){return Tr(n)?Eae(n,e,t,r):e[t.axis]=t.parse(n,r),e}function JR(n,e,t,r){const s=n.iScale,a=n.vScale,o=s.getLabels(),l=s===a,c=[];let d,h,p,x;for(d=t,h=t+r;d<h;++d)x=e[d],p={},p[s.axis]=l||s.parse(o[d],d),c.push(O6(x,p,a,d));return c}function PN(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function Dae(n,e,t){return n!==0?No(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function Oae(n){let e,t,r,s,a;return n.horizontal?(e=n.base>n.x,t="left",r="right"):(e=n.base<n.y,t="bottom",r="top"),e?(s="end",a="start"):(s="start",a="end"),{start:t,end:r,reverse:e,top:s,bottom:a}}function Iae(n,e,t,r){let s=e.borderSkipped;const a={};if(!s){n.borderSkipped=a;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:d,bottom:h}=Oae(n);s==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===r?s=d:(t._bottom||0)===r?s=h:(a[QR(h,o,l,c)]=!0,s=d)),a[QR(s,o,l,c)]=!0,n.borderSkipped=a}function QR(n,e,t,r){return r?(n=Aae(n,e,t),n=XR(n,t,e)):n=XR(n,e,t),n}function Aae(n,e,t){return n===e?t:n===t?e:n}function XR(n,e,t){return n==="start"?e:n==="end"?t:n}function Rae(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class Lae extends Dy{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,r,s){return JR(e,t,r,s)}parseArrayData(e,t,r,s){return JR(e,t,r,s)}parseObjectData(e,t,r,s){const{iScale:a,vScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=a.axis==="x"?l:c,h=o.axis==="x"?l:c,p=[];let x,v,w,_;for(x=r,v=r+s;x<v;++x)_=t[x],w={},w[a.axis]=a.parse(mu(_,d),x),p.push(O6(mu(_,h),w,o,x));return p}updateRangeFromParsed(e,t,r,s){super.updateRangeFromParsed(e,t,r,s);const a=r._custom;a&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:s}=t,a=this.getParsed(e),o=a._custom,l=PN(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(a[s.axis]);return{label:""+r.getLabelForValue(a[r.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,s){const a=s==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),d=l.isHorizontal(),h=this._getRuler(),{sharedOptions:p,includeOptions:x}=this._getSharedOptions(t,s);for(let v=t;v<t+r;v++){const w=this.getParsed(v),_=a||yn(w[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(v),j=this._calculateBarIndexPixels(v,h),T=(w._stacks||{})[l.axis],P={horizontal:d,base:_.base,enableBorderRadius:!T||PN(w._custom)||o===T._top||o===T._bottom,x:d?_.head:j.center,y:d?j.center:_.head,height:d?j.size:Math.abs(_.size),width:d?Math.abs(_.size):j.size};x&&(P.options=p||this.resolveDataElementOptions(v,e[v].active?"active":s));const D=P.options||e[v].options;Iae(P,D,T,o),Rae(P,D,h.ratio),this.updateElement(e[v],v,P,s)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),a=r.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),c=l&&l[r.axis],d=h=>{const p=h._parsed.find(v=>v[r.axis]===c),x=p&&p[h.vScale.axis];if(yn(x)||isNaN(x))return!0};for(const h of s)if(!(t!==void 0&&d(h))&&((a===!1||o.indexOf(h.stack)===-1||a===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[Gt(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,r){const s=this._getStacks(e,r),a=t!==void 0?s.indexOf(t):-1;return a===-1?s.length-1:a}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,s=[];let a,o;for(a=0,o=t.data.length;a<o;++a)s.push(r.getPixelForValue(this.getParsed(a)[r.axis],a));const l=e.barThickness;return{min:l||kae(t),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:s},options:{base:a,minBarLength:o}}=this,l=a||0,c=this.getParsed(e),d=c._custom,h=PN(d);let p=c[t.axis],x=0,v=r?this.applyStack(t,c,r):p,w,_;v!==p&&(x=v-p,v=p),h&&(p=d.barStart,v=d.barEnd-d.barStart,p!==0&&No(p)!==No(d.barEnd)&&(x=0),x+=p);const j=!yn(a)&&!h?a:x;let T=t.getPixelForValue(j);if(this.chart.getDataVisibility(e)?w=t.getPixelForValue(x+v):w=T,_=w-T,Math.abs(_)<o){_=Dae(_,t,l)*o,p===l&&(T-=_/2);const P=t.getPixelForDecimal(0),D=t.getPixelForDecimal(1),M=Math.min(P,D),O=Math.max(P,D);T=Math.max(Math.min(T,O),M),w=T+_,r&&!h&&(c._stacks[t.axis]._visualValues[s]=t.getValueForPixel(w)-t.getValueForPixel(T))}if(T===t.getPixelForValue(l)){const P=No(_)*t.getLineWidthForValue(l)/2;T+=P,_-=P}return{size:_,base:T,head:w,center:w+_/2}}_calculateBarIndexPixels(e,t){const r=t.scale,s=this.options,a=s.skipNull,o=Gt(s.maxBarThickness,1/0);let l,c;const d=this._getAxisCount();if(t.grouped){const h=a?this._getStackCount(e):t.stackCount,p=s.barThickness==="flex"?Mae(e,t,s,h*d):Pae(e,t,s,h*d),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,v=this._getAxis().indexOf(Gt(x,this.getFirstScaleIdForIndexAxis())),w=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+v;l=p.start+p.chunk*w+p.chunk/2,c=Math.min(o,p.chunk*p.ratio)}else l=r.getPixelForValue(this.getParsed(e)[r.axis],e),c=Math.min(o,t.min*t.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,s=r.length;let a=0;for(;a<s;++a)this.getParsed(a)[t.axis]!==null&&!r[a].hidden&&r[a].draw(this._ctx)}}function Fae(n,e,t){let r=1,s=1,a=0,o=0;if(e<Xn){const l=n,c=l+e,d=Math.cos(l),h=Math.sin(l),p=Math.cos(c),x=Math.sin(c),v=(D,M,O)=>Cm(D,l,c,!0)?1:Math.max(M,M*t,O,O*t),w=(D,M,O)=>Cm(D,l,c,!0)?-1:Math.min(M,M*t,O,O*t),_=v(0,d,p),j=v(kr,h,x),T=w(Mn,d,p),P=w(Mn+kr,h,x);r=(_-T)/2,s=(j-P)/2,a=-(_+T)/2,o=-(j+P)/2}return{ratioX:r,ratioY:s,offsetX:a,offsetY:o}}class qae extends Dy{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:r,textAlign:s,color:a,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((c,d)=>{const p=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:p.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(d),lineDash:p.borderDash,lineDashOffset:p.borderDashOffset,lineJoin:p.borderJoinStyle,lineWidth:p.borderWidth,strokeStyle:p.borderColor,textAlign:s,pointStyle:r,borderRadius:o&&(l||p.borderRadius),index:d}}):[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=r;else{let a=c=>+r[c];if(nn(r[e])){const{key:c="value"}=this._parsing;a=d=>+mu(r[d],c)}let o,l;for(o=e,l=e+t;o<l;++o)s._parsed[o]=a(o)}}_getRotation(){return bl(this.options.rotation-90)}_getCircumference(){return bl(this.options.circumference)}_getRotationExtents(){let e=Xn,t=-Xn;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const s=this.chart.getDatasetMeta(r).controller,a=s._getRotation(),o=s._getCircumference();e=Math.min(e,a),t=Math.max(t,a+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,s=this._cachedMeta,a=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,l=Math.max((Math.min(r.width,r.height)-o)/2,0),c=Math.min($se(this.options.cutout,l),1),d=this._getRingWeight(this.index),{circumference:h,rotation:p}=this._getRotationExtents(),{ratioX:x,ratioY:v,offsetX:w,offsetY:_}=Fae(p,h,c),j=(r.width-o)/x,T=(r.height-o)/v,P=Math.max(Math.min(j,T)/2,0),D=l6(this.options.radius,P),M=Math.max(D*c,0),O=(D-M)/this._getVisibleDatasetWeightTotal();this.offsetX=w*D,this.offsetY=_*D,s.total=this.calculateTotal(),this.outerRadius=D-O*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-O*d,0),this.updateElements(a,0,a.length,e)}_circumference(e,t){const r=this.options,s=this._cachedMeta,a=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*a/Xn)}updateElements(e,t,r,s){const a=s==="reset",o=this.chart,l=o.chartArea,d=o.options.animation,h=(l.left+l.right)/2,p=(l.top+l.bottom)/2,x=a&&d.animateScale,v=x?0:this.innerRadius,w=x?0:this.outerRadius,{sharedOptions:_,includeOptions:j}=this._getSharedOptions(t,s);let T=this._getRotation(),P;for(P=0;P<t;++P)T+=this._circumference(P,a);for(P=t;P<t+r;++P){const D=this._circumference(P,a),M=e[P],O={x:h+this.offsetX,y:p+this.offsetY,startAngle:T,endAngle:T+D,circumference:D,outerRadius:w,innerRadius:v};j&&(O.options=_||this.resolveDataElementOptions(P,M.active?"active":s)),T+=D,this.updateElement(M,P,O,s)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r=0,s;for(s=0;s<t.length;s++){const a=e._parsed[s];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(s)&&!t[s].hidden&&(r+=Math.abs(a))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Xn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,s=r.data.labels||[],a=m1(t._parsed[e],r.options.locale);return{label:s[e]||"",value:a}}getMaxBorderWidth(e){let t=0;const r=this.chart;let s,a,o,l,c;if(!e){for(s=0,a=r.data.datasets.length;s<a;++s)if(r.isDatasetVisible(s)){o=r.getDatasetMeta(s),e=o.data,l=o.controller;break}}if(!e)return 0;for(s=0,a=e.length;s<a;++s)c=l.resolveDataElementOptions(s),c.borderAlign!=="inner"&&(t=Math.max(t,c.borderWidth||0,c.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,s=e.length;r<s;++r){const a=this.resolveDataElementOptions(r);t=Math.max(t,a.offset||0,a.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(Gt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class zae extends Dy{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:s=[],_dataset:a}=t,o=this.chart._animationsDisabled;let{start:l,count:c}=uie(t,s,o);this._drawStart=l,this._drawCount=c,fie(t)&&(l=0,c=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!a._decimated,r.points=s;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:d},e),this.updateElements(s,l,c,e)}updateElements(e,t,r,s){const a=s==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:d}=this._cachedMeta,{sharedOptions:h,includeOptions:p}=this._getSharedOptions(t,s),x=o.axis,v=l.axis,{spanGaps:w,segment:_}=this.options,j=Sm(w)?w:Number.POSITIVE_INFINITY,T=this.chart._animationsDisabled||a||s==="none",P=t+r,D=e.length;let M=t>0&&this.getParsed(t-1);for(let O=0;O<D;++O){const I=e[O],q=T?I:{};if(O<t||O>=P){q.skip=!0;continue}const F=this.getParsed(O),V=yn(F[v]),U=q[x]=o.getPixelForValue(F[x],O),W=q[v]=a||V?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,F,c):F[v],O);q.skip=isNaN(U)||isNaN(W)||V,q.stop=O>0&&Math.abs(F[x]-M[x])>j,_&&(q.parsed=F,q.raw=d.data[O]),p&&(q.options=h||this.resolveDataElementOptions(O,I.active?"active":s)),T||this.updateElement(I,O,q,s),M=F}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,s=e.data||[];if(!s.length)return r;const a=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,a,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}function Yd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class w1{static override(e){Object.assign(w1.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Yd()}parse(){return Yd()}format(){return Yd()}add(){return Yd()}diff(){return Yd()}startOf(){return Yd()}endOf(){return Yd()}}var Uae={_date:w1};function Vae(n,e,t,r){const{controller:s,data:a,_sorted:o}=n,l=s._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&a.length){const d=l._reversePixels?aie:su;if(r){if(s._sharedOptions){const h=a[0],p=typeof h.getRange=="function"&&h.getRange(e);if(p){const x=d(a,e,t-p),v=d(a,e,t+p);return{lo:x.lo,hi:v.hi}}}}else{const h=d(a,e,t);if(c){const{vScale:p}=s._cachedMeta,{_parsed:x}=n,v=x.slice(0,h.lo+1).reverse().findIndex(_=>!yn(_[p.axis]));h.lo-=Math.max(0,v);const w=x.slice(h.hi).findIndex(_=>!yn(_[p.axis]));h.hi+=Math.max(0,w)}return h}}return{lo:0,hi:a.length-1}}function Oy(n,e,t,r,s){const a=n.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,c=a.length;l<c;++l){const{index:d,data:h}=a[l],{lo:p,hi:x}=Vae(a[l],e,o,s);for(let v=p;v<=x;++v){const w=h[v];w.skip||r(w,d,v)}}}function Bae(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(r,s){const a=e?Math.abs(r.x-s.x):0,o=t?Math.abs(r.y-s.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}function MN(n,e,t,r,s){const a=[];return!s&&!n.isPointInArea(e)||Oy(n,t,e,function(l,c,d){!s&&!Tm(l,n.chartArea,0)||l.inRange(e.x,e.y,r)&&a.push({element:l,datasetIndex:c,index:d})},!0),a}function Wae(n,e,t,r){let s=[];function a(o,l,c){const{startAngle:d,endAngle:h}=o.getProps(["startAngle","endAngle"],r),{angle:p}=u6(o,{x:e.x,y:e.y});Cm(p,d,h)&&s.push({element:o,datasetIndex:l,index:c})}return Oy(n,t,e,a),s}function $ae(n,e,t,r,s,a){let o=[];const l=Bae(t);let c=Number.POSITIVE_INFINITY;function d(h,p,x){const v=h.inRange(e.x,e.y,s);if(r&&!v)return;const w=h.getCenterPoint(s);if(!(!!a||n.isPointInArea(w))&&!v)return;const j=l(e,w);j<c?(o=[{element:h,datasetIndex:p,index:x}],c=j):j===c&&o.push({element:h,datasetIndex:p,index:x})}return Oy(n,t,e,d),o}function EN(n,e,t,r,s,a){return!a&&!n.isPointInArea(e)?[]:t==="r"&&!r?Wae(n,e,t,s):$ae(n,e,t,r,s,a)}function eL(n,e,t,r,s){const a=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return Oy(n,t,e,(c,d,h)=>{c[o]&&c[o](e[t],s)&&(a.push({element:c,datasetIndex:d,index:h}),l=l||c.inRange(e.x,e.y,s))}),r&&!l?[]:a}var Hae={modes:{index(n,e,t,r){const s=Jd(e,n),a=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?MN(n,s,a,r,o):EN(n,s,a,!1,r,o),c=[];return l.length?(n.getSortedVisibleDatasetMetas().forEach(d=>{const h=l[0].index,p=d.data[h];p&&!p.skip&&c.push({element:p,datasetIndex:d.index,index:h})}),c):[]},dataset(n,e,t,r){const s=Jd(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?MN(n,s,a,r,o):EN(n,s,a,!1,r,o);if(l.length>0){const c=l[0].datasetIndex,d=n.getDatasetMeta(c).data;l=[];for(let h=0;h<d.length;++h)l.push({element:d[h],datasetIndex:c,index:h})}return l},point(n,e,t,r){const s=Jd(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return MN(n,s,a,r,o)},nearest(n,e,t,r){const s=Jd(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return EN(n,s,a,t.intersect,r,o)},x(n,e,t,r){const s=Jd(e,n);return eL(n,s,"x",t.intersect,r)},y(n,e,t,r){const s=Jd(e,n);return eL(n,s,"y",t.intersect,r)}}};const I6=["left","top","right","bottom"];function Ah(n,e){return n.filter(t=>t.pos===e)}function tL(n,e){return n.filter(t=>I6.indexOf(t.pos)===-1&&t.box.axis===e)}function Rh(n,e){return n.sort((t,r)=>{const s=e?r:t,a=e?t:r;return s.weight===a.weight?s.index-a.index:s.weight-a.weight})}function Yae(n){const e=[];let t,r,s,a,o,l;for(t=0,r=(n||[]).length;t<r;++t)s=n[t],{position:a,options:{stack:o,stackWeight:l=1}}=s,e.push({index:t,box:s,pos:a,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&a+o,stackWeight:l});return e}function Gae(n){const e={};for(const t of n){const{stack:r,pos:s,stackWeight:a}=t;if(!r||!I6.includes(s))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=a}return e}function Zae(n,e){const t=Gae(n),{vBoxMaxWidth:r,hBoxMaxHeight:s}=e;let a,o,l;for(a=0,o=n.length;a<o;++a){l=n[a];const{fullSize:c}=l.box,d=t[l.stack],h=d&&l.stackWeight/d.weight;l.horizontal?(l.width=h?h*r:c&&e.availableWidth,l.height=s):(l.width=r,l.height=h?h*s:c&&e.availableHeight)}return t}function Kae(n){const e=Yae(n),t=Rh(e.filter(d=>d.box.fullSize),!0),r=Rh(Ah(e,"left"),!0),s=Rh(Ah(e,"right")),a=Rh(Ah(e,"top"),!0),o=Rh(Ah(e,"bottom")),l=tL(e,"x"),c=tL(e,"y");return{fullSize:t,leftAndTop:r.concat(a),rightAndBottom:s.concat(c).concat(o).concat(l),chartArea:Ah(e,"chartArea"),vertical:r.concat(s).concat(c),horizontal:a.concat(o).concat(l)}}function nL(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function A6(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function Jae(n,e,t,r){const{pos:s,box:a}=t,o=n.maxPadding;if(!nn(s)){t.size&&(n[s]-=t.size);const p=r[t.stack]||{size:0,count:1};p.size=Math.max(p.size,t.horizontal?a.height:a.width),t.size=p.size/p.count,n[s]+=t.size}a.getPadding&&A6(o,a.getPadding());const l=Math.max(0,e.outerWidth-nL(o,n,"left","right")),c=Math.max(0,e.outerHeight-nL(o,n,"top","bottom")),d=l!==n.w,h=c!==n.h;return n.w=l,n.h=c,t.horizontal?{same:d,other:h}:{same:h,other:d}}function Qae(n){const e=n.maxPadding;function t(r){const s=Math.max(e[r]-n[r],0);return n[r]+=s,s}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function Xae(n,e){const t=e.maxPadding;function r(s){const a={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{a[o]=Math.max(e[o],t[o])}),a}return r(n?["left","right"]:["top","bottom"])}function Hh(n,e,t,r){const s=[];let a,o,l,c,d,h;for(a=0,o=n.length,d=0;a<o;++a){l=n[a],c=l.box,c.update(l.width||e.w,l.height||e.h,Xae(l.horizontal,e));const{same:p,other:x}=Jae(e,t,l,r);d|=p&&s.length,h=h||x,c.fullSize||s.push(l)}return d&&Hh(s,e,t,r)||h}function $g(n,e,t,r,s){n.top=t,n.left=e,n.right=e+r,n.bottom=t+s,n.width=r,n.height=s}function rL(n,e,t,r){const s=t.padding;let{x:a,y:o}=e;for(const l of n){const c=l.box,d=r[l.stack]||{placed:0,weight:1},h=l.stackWeight/d.weight||1;if(l.horizontal){const p=e.w*h,x=d.size||c.height;Nm(d.start)&&(o=d.start),c.fullSize?$g(c,s.left,o,t.outerWidth-s.right-s.left,x):$g(c,e.left+d.placed,o,p,x),d.start=o,d.placed+=p,o=c.bottom}else{const p=e.h*h,x=d.size||c.width;Nm(d.start)&&(a=d.start),c.fullSize?$g(c,a,s.top,x,t.outerHeight-s.bottom-s.top):$g(c,a,e.top+d.placed,x,p),d.start=a,d.placed+=p,a=c.right}}e.x=a,e.y=o}var Rc={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const s=Ia(n.options.layout.padding),a=Math.max(e-s.width,0),o=Math.max(t-s.height,0),l=Kae(n.boxes),c=l.vertical,d=l.horizontal;_n(n.boxes,_=>{typeof _.beforeLayout=="function"&&_.beforeLayout()});const h=c.reduce((_,j)=>j.box.options&&j.box.options.display===!1?_:_+1,0)||1,p=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:a,availableHeight:o,vBoxMaxWidth:a/2/h,hBoxMaxHeight:o/2}),x=Object.assign({},s);A6(x,Ia(r));const v=Object.assign({maxPadding:x,w:a,h:o,x:s.left,y:s.top},s),w=Zae(c.concat(d),p);Hh(l.fullSize,v,p,w),Hh(c,v,p,w),Hh(d,v,p,w)&&Hh(c,v,p,w),Qae(v),rL(l.leftAndTop,v,p,w),v.x+=v.w,v.y+=v.h,rL(l.rightAndBottom,v,p,w),n.chartArea={left:v.left,top:v.top,right:v.left+v.w,bottom:v.top+v.h,height:v.h,width:v.w},_n(l.chartArea,_=>{const j=_.box;Object.assign(j,n.chartArea),j.update(v.w,v.h,{left:0,top:0,right:0,bottom:0})})}};class R6{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,s){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):r)}}isAttached(e){return!0}updateConfig(e){}}class eoe extends R6{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const fx="$chartjs",toe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},sL=n=>n===null||n==="";function noe(n,e){const t=n.style,r=n.getAttribute("height"),s=n.getAttribute("width");if(n[fx]={initial:{height:r,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",sL(s)){const a=UR(n,"width");a!==void 0&&(n.width=a)}if(sL(r))if(n.style.height==="")n.height=n.width/(e||2);else{const a=UR(n,"height");a!==void 0&&(n.height=a)}return n}const L6=tae?{passive:!0}:!1;function roe(n,e,t){n&&n.addEventListener(e,t,L6)}function soe(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,L6)}function ioe(n,e){const t=toe[n.type]||n.type,{x:r,y:s}=Jd(n,e);return{type:t,chart:e,native:n,x:r!==void 0?r:null,y:s!==void 0?s:null}}function $x(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function aoe(n,e,t){const r=n.canvas,s=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||$x(l.addedNodes,r),o=o&&!$x(l.removedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function ooe(n,e,t){const r=n.canvas,s=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||$x(l.removedNodes,r),o=o&&!$x(l.addedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const km=new Map;let iL=0;function F6(){const n=window.devicePixelRatio;n!==iL&&(iL=n,km.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function loe(n,e){km.size||window.addEventListener("resize",F6),km.set(n,e)}function coe(n){km.delete(n),km.size||window.removeEventListener("resize",F6)}function doe(n,e,t){const r=n.canvas,s=r&&b1(r);if(!s)return;const a=p6((l,c)=>{const d=s.clientWidth;t(l,c),d<s.clientWidth&&t()},window),o=new ResizeObserver(l=>{const c=l[0],d=c.contentRect.width,h=c.contentRect.height;d===0&&h===0||a(d,h)});return o.observe(s),loe(n,a),o}function DN(n,e,t){t&&t.disconnect(),e==="resize"&&coe(n)}function uoe(n,e,t){const r=n.canvas,s=p6(a=>{n.ctx!==null&&t(ioe(a,n))},n);return roe(r,e,s),s}class foe extends R6{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(noe(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[fx])return!1;const r=t[fx].initial;["height","width"].forEach(a=>{const o=r[a];yn(o)?t.removeAttribute(a):t.setAttribute(a,o)});const s=r.style||{};return Object.keys(s).forEach(a=>{t.style[a]=s[a]}),t.width=t.width,delete t[fx],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),o={attach:aoe,detach:ooe,resize:doe}[t]||uoe;s[t]=o(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),s=r[t];if(!s)return;({attach:DN,detach:DN,resize:DN}[t]||soe)(e,t,s),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,s){return eae(e,t,r,s)}isAttached(e){const t=e&&b1(e);return!!(t&&t.isConnected)}}function hoe(n){return!v1()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?eoe:foe}let od=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return Sm(this.x)&&Sm(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const s={};return e.forEach(a=>{s[a]=r[a]&&r[a].active()?r[a]._to:this[a]}),s}};function moe(n,e){const t=n.options.ticks,r=poe(n),s=Math.min(t.maxTicksLimit||r,r),a=t.major.enabled?xoe(e):[],o=a.length,l=a[0],c=a[o-1],d=[];if(o>s)return yoe(e,d,a,o/s),d;const h=goe(a,e,s);if(o>0){let p,x;const v=o>1?Math.round((c-l)/(o-1)):null;for(Hg(e,d,h,yn(v)?0:l-v,l),p=0,x=o-1;p<x;p++)Hg(e,d,h,a[p],a[p+1]);return Hg(e,d,h,c,yn(v)?e.length:c+v),d}return Hg(e,d,h),d}function poe(n){const e=n.options.offset,t=n._tickSize(),r=n._length/t+(e?0:1),s=n._maxLength/t;return Math.floor(Math.min(r,s))}function goe(n,e,t){const r=voe(n),s=e.length/t;if(!r)return Math.max(s,1);const a=Xse(r);for(let o=0,l=a.length-1;o<l;o++){const c=a[o];if(c>s)return c}return Math.max(s,1)}function xoe(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}function yoe(n,e,t,r){let s=0,a=t[0],o;for(r=Math.ceil(r),o=0;o<n.length;o++)o===a&&(e.push(n[o]),s++,a=t[s*r])}function Hg(n,e,t,r,s){const a=Gt(r,0),o=Math.min(Gt(s,n.length),n.length);let l=0,c,d,h;for(t=Math.ceil(t),s&&(c=s-r,t=c/Math.floor(c/t)),h=a;h<0;)l++,h=Math.round(a+l*t);for(d=Math.max(a,0);d<o;d++)d===h&&(e.push(n[d]),l++,h=Math.round(a+l*t))}function voe(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}const boe=n=>n==="left"?"right":n==="right"?"left":n,aL=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,oL=(n,e)=>Math.min(e||n,n);function lL(n,e){const t=[],r=n.length/e,s=n.length;let a=0;for(;a<s;a+=r)t.push(n[Math.floor(a)]);return t}function woe(n,e,t){const r=n.ticks.length,s=Math.min(e,r-1),a=n._startPixel,o=n._endPixel,l=1e-6;let c=n.getPixelForTick(s),d;if(!(t&&(r===1?d=Math.max(c-a,o-c):e===0?d=(n.getPixelForTick(1)-c)/2:d=(c-n.getPixelForTick(s-1))/2,c+=s<e?d:-d,c<a-l||c>o+l)))return c}function _oe(n,e){_n(n,t=>{const r=t.gc,s=r.length/2;let a;if(s>e){for(a=0;a<s;++a)delete t.data[r[a]];r.splice(0,s)}})}function Lh(n){return n.drawTicks?n.tickLength:0}function cL(n,e){if(!n.display)return 0;const t=Hs(n.font,e),r=Ia(n.padding);return(Tr(n.text)?n.text.length:1)*t.lineHeight+r.height}function joe(n,e){return ju(n,{scale:e,type:"scale"})}function Noe(n,e,t){return ju(n,{tick:t,index:e,type:"tick"})}function Soe(n,e,t){let r=g6(n);return(t&&e!=="right"||!t&&e==="right")&&(r=boe(r)),r}function Coe(n,e,t,r){const{top:s,left:a,bottom:o,right:l,chart:c}=n,{chartArea:d,scales:h}=c;let p=0,x,v,w;const _=o-s,j=l-a;if(n.isHorizontal()){if(v=ci(r,a,l),nn(t)){const T=Object.keys(t)[0],P=t[T];w=h[T].getPixelForValue(P)+_-e}else t==="center"?w=(d.bottom+d.top)/2+_-e:w=aL(n,t,e);x=l-a}else{if(nn(t)){const T=Object.keys(t)[0],P=t[T];v=h[T].getPixelForValue(P)-j+e}else t==="center"?v=(d.left+d.right)/2-j+e:v=aL(n,t,e);w=ci(r,o,s),p=t==="left"?-kr:kr}return{titleX:v,titleY:w,maxWidth:x,rotation:p}}class Yf extends od{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:s}=this;return e=ho(e,Number.POSITIVE_INFINITY),t=ho(t,Number.NEGATIVE_INFINITY),r=ho(r,Number.POSITIVE_INFINITY),s=ho(s,Number.NEGATIVE_INFINITY),{min:ho(e,r),max:ho(t,s),minDefined:cs(e),maxDefined:cs(t)}}getMinMax(e){let{min:t,max:r,minDefined:s,maxDefined:a}=this.getUserBounds(),o;if(s&&a)return{min:t,max:r};const l=this.getMatchingVisibleMetas();for(let c=0,d=l.length;c<d;++c)o=l[c].controller.getMinMax(this,e),s||(t=Math.min(t,o.min)),a||(r=Math.max(r,o.max));return t=a&&t>r?r:t,r=s&&t>r?t:r,{min:ho(t,ho(r,t)),max:ho(r,ho(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){qn(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:s,grace:a,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Die(this,a,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?lL(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=moe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,r;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,e=!e),this._startPixel=t,this._endPixel=r,this._reversePixels=e,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){qn(this.options.afterUpdate,[this])}beforeSetDimensions(){qn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){qn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),qn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){qn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,s,a;for(r=0,s=e.length;r<s;r++)a=e[r],a.label=qn(t.callback,[a.value,r,e],this)}afterTickToLabelConversion(){qn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){qn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=oL(this.ticks.length,e.ticks.maxTicksLimit),s=t.minRotation||0,a=t.maxRotation;let o=s,l,c,d;if(!this._isVisible()||!t.display||s>=a||r<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),p=h.widest.width,x=h.highest.height,v=os(this.chart.width-p,0,this.maxWidth);l=e.offset?this.maxWidth/r:v/(r-1),p+6>l&&(l=v/(r-(e.offset?.5:1)),c=this.maxHeight-Lh(e.grid)-t.padding-cL(e.title,this.chart.options.font),d=Math.sqrt(p*p+x*x),o=rie(Math.min(Math.asin(os((h.highest.height+6)/l,-1,1)),Math.asin(os(c/d,-1,1))-Math.asin(os(x/d,-1,1)))),o=Math.max(s,Math.min(a,o))),this.labelRotation=o}afterCalculateLabelRotation(){qn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){qn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:s,grid:a}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=cL(s,t.options.font);if(l?(e.width=this.maxWidth,e.height=Lh(a)+c):(e.height=this.maxHeight,e.width=Lh(a)+c),r.display&&this.ticks.length){const{first:d,last:h,widest:p,highest:x}=this._getLabelSizes(),v=r.padding*2,w=bl(this.labelRotation),_=Math.cos(w),j=Math.sin(w);if(l){const T=r.mirror?0:j*p.width+_*x.height;e.height=Math.min(this.maxHeight,e.height+T+v)}else{const T=r.mirror?0:_*p.width+j*x.height;e.width=Math.min(this.maxWidth,e.width+T+v)}this._calculatePadding(d,h,j,_)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,s){const{ticks:{align:a,padding:o},position:l}=this.options,c=this.labelRotation!==0,d=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,p=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,v=0;c?d?(x=s*e.width,v=r*t.height):(x=r*e.height,v=s*t.width):a==="start"?v=t.width:a==="end"?x=e.width:a!=="inner"&&(x=e.width/2,v=t.width/2),this.paddingLeft=Math.max((x-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((v-p+o)*this.width/(this.width-p),0)}else{let h=t.height/2,p=e.height/2;a==="start"?(h=0,p=e.height):a==="end"&&(h=t.height,p=0),this.paddingTop=h+o,this.paddingBottom=p+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){qn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,r;for(t=0,r=e.length;t<r;t++)yn(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=lL(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:s,_longestTextCache:a}=this,o=[],l=[],c=Math.floor(t/oL(t,r));let d=0,h=0,p,x,v,w,_,j,T,P,D,M,O;for(p=0;p<t;p+=c){if(w=e[p].label,_=this._resolveTickFontOptions(p),s.font=j=_.string,T=a[j]=a[j]||{data:{},gc:[]},P=_.lineHeight,D=M=0,!yn(w)&&!Tr(w))D=RR(s,T.data,T.gc,D,w),M=P;else if(Tr(w))for(x=0,v=w.length;x<v;++x)O=w[x],!yn(O)&&!Tr(O)&&(D=RR(s,T.data,T.gc,D,O),M+=P);o.push(D),l.push(M),d=Math.max(D,d),h=Math.max(M,h)}_oe(a,t);const I=o.indexOf(d),q=l.indexOf(h),F=V=>({width:o[V]||0,height:l[V]||0});return{first:F(0),last:F(t-1),widest:F(I),highest:F(q),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return iie(this._alignToPixels?Hd(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=Noe(this.getContext(),e,r))}return this.$context||(this.$context=joe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=bl(this.labelRotation),r=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),a=this._getLabelSizes(),o=e.autoSkipPadding||0,l=a?a.widest.width+o:0,c=a?a.highest.height+o:0;return this.isHorizontal()?c*r>l*s?l/r:c/s:c*s<l*r?c/r:l/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,s=this.options,{grid:a,position:o,border:l}=s,c=a.offset,d=this.isHorizontal(),p=this.ticks.length+(c?1:0),x=Lh(a),v=[],w=l.setContext(this.getContext()),_=w.display?w.width:0,j=_/2,T=function(J){return Hd(r,J,_)};let P,D,M,O,I,q,F,V,U,W,$,ne;if(o==="top")P=T(this.bottom),q=this.bottom-x,V=P-j,W=T(e.top)+j,ne=e.bottom;else if(o==="bottom")P=T(this.top),W=e.top,ne=T(e.bottom)-j,q=P+j,V=this.top+x;else if(o==="left")P=T(this.right),I=this.right-x,F=P-j,U=T(e.left)+j,$=e.right;else if(o==="right")P=T(this.left),U=e.left,$=T(e.right)-j,I=P+j,F=this.left+x;else if(t==="x"){if(o==="center")P=T((e.top+e.bottom)/2+.5);else if(nn(o)){const J=Object.keys(o)[0],ee=o[J];P=T(this.chart.scales[J].getPixelForValue(ee))}W=e.top,ne=e.bottom,q=P+j,V=q+x}else if(t==="y"){if(o==="center")P=T((e.left+e.right)/2);else if(nn(o)){const J=Object.keys(o)[0],ee=o[J];P=T(this.chart.scales[J].getPixelForValue(ee))}I=P-j,F=I-x,U=e.left,$=e.right}const Y=Gt(s.ticks.maxTicksLimit,p),ae=Math.max(1,Math.ceil(p/Y));for(D=0;D<p;D+=ae){const J=this.getContext(D),ee=a.setContext(J),X=l.setContext(J),Z=ee.lineWidth,oe=ee.color,H=X.dash||[],Q=X.dashOffset,re=ee.tickWidth,de=ee.tickColor,ce=ee.tickBorderDash||[],pe=ee.tickBorderDashOffset;M=woe(this,D,c),M!==void 0&&(O=Hd(r,M,Z),d?I=F=U=$=O:q=V=W=ne=O,v.push({tx1:I,ty1:q,tx2:F,ty2:V,x1:U,y1:W,x2:$,y2:ne,width:Z,color:oe,borderDash:H,borderDashOffset:Q,tickWidth:re,tickColor:de,tickBorderDash:ce,tickBorderDashOffset:pe}))}return this._ticksLength=p,this._borderValue=P,v}_computeLabelItems(e){const t=this.axis,r=this.options,{position:s,ticks:a}=r,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:h,mirror:p}=a,x=Lh(r.grid),v=x+h,w=p?-h:v,_=-bl(this.labelRotation),j=[];let T,P,D,M,O,I,q,F,V,U,W,$,ne="middle";if(s==="top")I=this.bottom-w,q=this._getXAxisLabelAlignment();else if(s==="bottom")I=this.top+w,q=this._getXAxisLabelAlignment();else if(s==="left"){const ae=this._getYAxisLabelAlignment(x);q=ae.textAlign,O=ae.x}else if(s==="right"){const ae=this._getYAxisLabelAlignment(x);q=ae.textAlign,O=ae.x}else if(t==="x"){if(s==="center")I=(e.top+e.bottom)/2+v;else if(nn(s)){const ae=Object.keys(s)[0],J=s[ae];I=this.chart.scales[ae].getPixelForValue(J)+v}q=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")O=(e.left+e.right)/2-v;else if(nn(s)){const ae=Object.keys(s)[0],J=s[ae];O=this.chart.scales[ae].getPixelForValue(J)}q=this._getYAxisLabelAlignment(x).textAlign}t==="y"&&(c==="start"?ne="top":c==="end"&&(ne="bottom"));const Y=this._getLabelSizes();for(T=0,P=l.length;T<P;++T){D=l[T],M=D.label;const ae=a.setContext(this.getContext(T));F=this.getPixelForTick(T)+a.labelOffset,V=this._resolveTickFontOptions(T),U=V.lineHeight,W=Tr(M)?M.length:1;const J=W/2,ee=ae.color,X=ae.textStrokeColor,Z=ae.textStrokeWidth;let oe=q;o?(O=F,q==="inner"&&(T===P-1?oe=this.options.reverse?"left":"right":T===0?oe=this.options.reverse?"right":"left":oe="center"),s==="top"?d==="near"||_!==0?$=-W*U+U/2:d==="center"?$=-Y.highest.height/2-J*U+U:$=-Y.highest.height+U/2:d==="near"||_!==0?$=U/2:d==="center"?$=Y.highest.height/2-J*U:$=Y.highest.height-W*U,p&&($*=-1),_!==0&&!ae.showLabelBackdrop&&(O+=U/2*Math.sin(_))):(I=F,$=(1-W)*U/2);let H;if(ae.showLabelBackdrop){const Q=Ia(ae.backdropPadding),re=Y.heights[T],de=Y.widths[T];let ce=$-Q.top,pe=0-Q.left;switch(ne){case"middle":ce-=re/2;break;case"bottom":ce-=re;break}switch(q){case"center":pe-=de/2;break;case"right":pe-=de;break;case"inner":T===P-1?pe-=de:T>0&&(pe-=de/2);break}H={left:pe,top:ce,width:de+Q.width,height:re+Q.height,color:ae.backdropColor}}j.push({label:M,font:V,textOffset:$,options:{rotation:_,color:ee,strokeColor:X,strokeWidth:Z,textAlign:oe,textBaseline:ne,translation:[O,I],backdrop:H}})}return j}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-bl(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:s,padding:a}}=this.options,o=this._getLabelSizes(),l=e+a,c=o.widest.width;let d,h;return t==="left"?s?(h=this.right+a,r==="near"?d="left":r==="center"?(d="center",h+=c/2):(d="right",h+=c)):(h=this.right-l,r==="near"?d="right":r==="center"?(d="center",h-=c/2):(d="left",h=this.left)):t==="right"?s?(h=this.left+a,r==="near"?d="right":r==="center"?(d="center",h-=c/2):(d="left",h-=c)):(h=this.left+l,r==="near"?d="left":r==="center"?(d="center",h+=c/2):(d="right",h=this.right)):d="right",{textAlign:d,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:s,width:a,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,s,a,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(a=>a.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,r=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,o;const l=(c,d,h)=>{!h.width||!h.color||(r.save(),r.lineWidth=h.width,r.strokeStyle=h.color,r.setLineDash(h.borderDash||[]),r.lineDashOffset=h.borderDashOffset,r.beginPath(),r.moveTo(c.x,c.y),r.lineTo(d.x,d.y),r.stroke(),r.restore())};if(t.display)for(a=0,o=s.length;a<o;++a){const c=s[a];t.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),t.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:s}}=this,a=r.setContext(this.getContext()),o=r.display?a.width:0;if(!o)return;const l=s.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,h,p,x;this.isHorizontal()?(d=Hd(e,this.left,o)-o/2,h=Hd(e,this.right,l)+l/2,p=x=c):(p=Hd(e,this.top,o)-o/2,x=Hd(e,this.bottom,l)+l/2,d=h=c),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(d,p),t.lineTo(h,x),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,s=this._computeLabelArea();s&&Py(r,s);const a=this.getLabelItems(e);for(const o of a){const l=o.options,c=o.font,d=o.label,h=o.textOffset;Vx(r,d,0,h,c,l)}s&&My(r)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:s}}=this;if(!r.display)return;const a=Hs(r.font),o=Ia(r.padding),l=r.align;let c=a.lineHeight/2;t==="bottom"||t==="center"||nn(t)?(c+=o.bottom,Tr(r.text)&&(c+=a.lineHeight*(r.text.length-1))):c+=o.top;const{titleX:d,titleY:h,maxWidth:p,rotation:x}=Coe(this,c,t,l);Vx(e,r.text,0,0,a,{color:r.color,maxWidth:p,rotation:x,textAlign:Soe(l,t,s),textBaseline:"middle",translation:[d,h]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=Gt(e.grid&&e.grid.z,-1),s=Gt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Yf.prototype.draw?[{z:t,draw:a=>{this.draw(a)}}]:[{z:r,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:t,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",s=[];let a,o;for(a=0,o=t.length;a<o;++a){const l=t[a];l[r]===this.id&&(!e||l.type===e)&&s.push(l)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Hs(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Yg{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;Poe(t)&&(r=this.register(t));const s=this.items,a=e.id,o=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in s||(s[a]=e,Toe(e,o,r),this.override&&lr.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,s=this.scope;r in t&&delete t[r],s&&r in lr[s]&&(delete lr[s][r],this.override&&delete pu[r])}}function Toe(n,e,t){const r=jm(Object.create(null),[t?lr.get(t):{},lr.get(e),n.defaults]);lr.set(e,r),n.defaultRoutes&&koe(e,n.defaultRoutes),n.descriptors&&lr.describe(e,n.descriptors)}function koe(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),s=r.pop(),a=[n].concat(r).join("."),o=e[t].split("."),l=o.pop(),c=o.join(".");lr.route(a,s,c,l)})}function Poe(n){return"id"in n&&"defaults"in n}class Moe{constructor(){this.controllers=new Yg(Dy,"datasets",!0),this.elements=new Yg(od,"elements"),this.plugins=new Yg(Object,"plugins"),this.scales=new Yg(Yf,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(s=>{const a=r||this._getRegistryForType(s);r||a.isForType(s)||a===this.plugins&&s.id?this._exec(e,a,s):_n(s,o=>{const l=r||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,r){const s=u1(e);qn(r["before"+s],[],r),t[e](r),qn(r["after"+s],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return s}}var po=new Moe;class Eoe{constructor(){this._init=void 0}notify(e,t,r,s){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=s?this._descriptors(e).filter(s):this._descriptors(e),o=this._notify(a,e,t,r);return t==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,r,s){s=s||{};for(const a of e){const o=a.plugin,l=o[r],c=[t,s,a.options];if(qn(l,c,o)===!1&&s.cancelable)return!1}return!0}invalidate(){yn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,s=Gt(r.options&&r.options.plugins,{}),a=Doe(r);return s===!1&&!t?[]:Ioe(e,a,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,s=(a,o)=>a.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(s(t,r),e,"stop"),this._notify(s(r,t),e,"start")}}function Doe(n){const e={},t=[],r=Object.keys(po.plugins.items);for(let a=0;a<r.length;a++)t.push(po.getPlugin(r[a]));const s=n.plugins||[];for(let a=0;a<s.length;a++){const o=s[a];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function Ooe(n,e){return!e&&n===!1?null:n===!0?{}:n}function Ioe(n,{plugins:e,localIds:t},r,s){const a=[],o=n.getContext();for(const l of e){const c=l.id,d=Ooe(r[c],s);d!==null&&a.push({plugin:l,options:Aoe(n.config,{plugin:l,local:t[c]},d,o)})}return a}function Aoe(n,{plugin:e,local:t},r,s){const a=n.pluginScopeKeys(e),o=n.getOptionScopes(r,a);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ZS(n,e){const t=lr.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function Roe(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function Loe(n,e){return n===e?"_index_":"_value_"}function dL(n){if(n==="x"||n==="y"||n==="r")return n}function Foe(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function KS(n,...e){if(dL(n))return n;for(const t of e){const r=t.axis||Foe(t.position)||n.length>1&&dL(n[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function uL(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function qoe(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(r=>r.xAxisID===n||r.yAxisID===n);if(t.length)return uL(n,"x",t[0])||uL(n,"y",t[0])}return{}}function zoe(n,e){const t=pu[n.type]||{scales:{}},r=e.scales||{},s=ZS(n.type,e),a=Object.create(null);return Object.keys(r).forEach(o=>{const l=r[o];if(!nn(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=KS(o,l,qoe(o,n),lr.scales[l.type]),d=Loe(c,s),h=t.scales||{};a[o]=em(Object.create(null),[{axis:c},l,h[c],h[d]])}),n.data.datasets.forEach(o=>{const l=o.type||n.type,c=o.indexAxis||ZS(l,e),h=(pu[l]||{}).scales||{};Object.keys(h).forEach(p=>{const x=Roe(p,c),v=o[x+"AxisID"]||x;a[v]=a[v]||Object.create(null),em(a[v],[{axis:x},r[v],h[p]])})}),Object.keys(a).forEach(o=>{const l=a[o];em(l,[lr.scales[l.type],lr.scale])}),a}function q6(n){const e=n.options||(n.options={});e.plugins=Gt(e.plugins,{}),e.scales=zoe(n,e)}function z6(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function Uoe(n){return n=n||{},n.data=z6(n.data),q6(n),n}const fL=new Map,U6=new Set;function Gg(n,e){let t=fL.get(n);return t||(t=e(),fL.set(n,t),U6.add(t)),t}const Fh=(n,e,t)=>{const r=mu(e,t);r!==void 0&&n.add(r)};class Voe{constructor(e){this._config=Uoe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=z6(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),q6(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Gg(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Gg(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Gg(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return Gg(`${r}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let s=r.get(e);return(!s||t)&&(s=new Map,r.set(e,s)),s}getOptionScopes(e,t,r){const{options:s,type:a}=this,o=this._cachedScopes(e,r),l=o.get(t);if(l)return l;const c=new Set;t.forEach(h=>{e&&(c.add(e),h.forEach(p=>Fh(c,e,p))),h.forEach(p=>Fh(c,s,p)),h.forEach(p=>Fh(c,pu[a]||{},p)),h.forEach(p=>Fh(c,lr,p)),h.forEach(p=>Fh(c,YS,p))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),U6.has(t)&&o.set(t,d),d}chartOptionScopes(){const{options:e,type:t}=this;return[e,pu[t]||{},lr.datasets[t]||{},{type:t},lr,YS]}resolveNamedOptions(e,t,r,s=[""]){const a={$shared:!0},{resolver:o,subPrefixes:l}=hL(this._resolverCache,e,s);let c=o;if(Woe(o,t)){a.$shared=!1,r=Hc(r)?r():r;const d=this.createResolver(e,r,l);c=Af(o,r,d)}for(const d of t)a[d]=c[d];return a}createResolver(e,t,r=[""],s){const{resolver:a}=hL(this._resolverCache,e,r);return nn(t)?Af(a,t,void 0,s):a}}function hL(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const s=t.join();let a=r.get(s);return a||(a={resolver:g1(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},r.set(s,a)),a}const Boe=n=>nn(n)&&Object.getOwnPropertyNames(n).some(e=>Hc(n[e]));function Woe(n,e){const{isScriptable:t,isIndexable:r}=b6(n);for(const s of e){const a=t(s),o=r(s),l=(o||a)&&n[s];if(a&&(Hc(l)||Boe(l))||o&&Tr(l))return!0}return!1}var $oe="4.5.1";const Hoe=["top","bottom","left","right","chartArea"];function mL(n,e){return n==="top"||n==="bottom"||Hoe.indexOf(n)===-1&&e==="x"}function pL(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function gL(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),qn(t&&t.onComplete,[n],e)}function Yoe(n){const e=n.chart,t=e.options.animation;qn(t&&t.onProgress,[n],e)}function V6(n){return v1()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const hx={},xL=n=>{const e=V6(n);return Object.values(hx).filter(t=>t.canvas===e).pop()};function Goe(n,e,t){const r=Object.keys(n);for(const s of r){const a=+s;if(a>=e){const o=n[s];delete n[s],(t>0||a>e)&&(n[a+t]=o)}}}function Zoe(n,e,t,r){return!t||n.type==="mouseout"?null:r?e:n}class Iy{static defaults=lr;static instances=hx;static overrides=pu;static registry=po;static version=$oe;static getChart=xL;static register(...e){po.add(...e),yL()}static unregister(...e){po.remove(...e),yL()}constructor(e,t){const r=this.config=new Voe(t),s=V6(e),a=xL(s);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||hoe(s)),this.platform.updateConfig(r);const l=this.platform.acquireContext(s,o.aspectRatio),c=l&&l.canvas,d=c&&c.height,h=c&&c.width;if(this.id=Wse(),this.ctx=l,this.canvas=c,this.width=h,this.height=d,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Eoe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=cie(p=>this.update(p),o.resizeDelay||0),this._dataChanges=[],hx[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}ml.listen(this,"complete",gL),ml.listen(this,"progress",Yoe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:s,_aspectRatio:a}=this;return yn(e)?t&&a?a:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return po}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():zR(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return LR(this.canvas,this.ctx),this}stop(){return ml.stop(this),this}resize(e,t){ml.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,s=this.canvas,a=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,e,t,a),l=r.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,zR(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),qn(r.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};_n(t,(r,s)=>{r.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,s=Object.keys(r).reduce((o,l)=>(o[l]=!1,o),{});let a=[];t&&(a=a.concat(Object.keys(t).map(o=>{const l=t[o],c=KS(o,l),d=c==="r",h=c==="x";return{options:l,dposition:d?"chartArea":h?"bottom":"left",dtype:d?"radialLinear":h?"category":"linear"}}))),_n(a,o=>{const l=o.options,c=l.id,d=KS(c,l),h=Gt(l.type,o.dtype);(l.position===void 0||mL(l.position,d)!==mL(o.dposition))&&(l.position=o.dposition),s[c]=!0;let p=null;if(c in r&&r[c].type===h)p=r[c];else{const x=po.getScale(h);p=new x({id:c,type:h,ctx:this.ctx,chart:this}),r[p.id]=p}p.init(l,e)}),_n(s,(o,l)=>{o||delete r[l]}),_n(r,o=>{Rc.configure(this,o,o.options),Rc.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((s,a)=>s.index-a.index),r>t){for(let s=t;s<r;++s)this._destroyDatasetMeta(s);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(pL("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,s)=>{t.filter(a=>a===r._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,s;for(this._removeUnreferencedMetasets(),r=0,s=t.length;r<s;r++){const a=t[r];let o=this.getDatasetMeta(r);const l=a.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=l,o.indexAxis=a.indexAxis||ZS(l,this.options),o.order=a.order||0,o.index=r,o.label=""+a.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const c=po.getController(l),{datasetElementType:d,dataElementType:h}=lr.datasets[l];Object.assign(c,{dataElementType:po.getElement(h),datasetElementType:d&&po.getElement(d)}),o.controller=new c(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){_n(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let d=0,h=this.data.datasets.length;d<h;d++){const{controller:p}=this.getDatasetMeta(d),x=!s&&a.indexOf(p)===-1;p.buildOrUpdateElements(x),o=Math.max(+p.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),s||_n(a,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(pL("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){_n(this.scales,e=>{Rc.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!TR(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:s,count:a}of t){const o=r==="_removeElements"?-a:a;Goe(e,s,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=a=>new Set(e.filter(o=>o[0]===a).map((o,l)=>l+","+o.splice(1).join(","))),s=r(0);for(let a=1;a<t;a++)if(!TR(s,r(a)))return;return Array.from(s).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Rc.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],_n(this.boxes,s=>{r&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,a)=>{s._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,Hc(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),s={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(r.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ml.has(this)?this.attached&&!ml.running(this)&&ml.start(this):(this.draw(),gL({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let s,a;for(s=0,a=t.length;s<a;++s){const o=t[s];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r={meta:e,index:e.index,cancelable:!0},s=M6(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(s&&Py(t,s),e.controller.draw(),s&&My(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return Tm(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,s){const a=Hae.modes[t];return typeof a=="function"?a(this,e,r,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let s=r.filter(a=>a&&a._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=ju(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const s=r?"show":"hide",a=this.getDatasetMeta(e),o=a.controller._resolveAnimations(void 0,s);Nm(t)?(a.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(a,{visible:r}),this.update(l=>l.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),ml.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),LR(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete hx[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(a,o)=>{t.addEventListener(this,a,o),e[a]=o},s=(a,o,l)=>{a.offsetX=o,a.offsetY=l,this._eventHandler(a)};_n(this.options.events,a=>r(a,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(c,d)=>{t.addEventListener(this,c,d),e[c]=d},s=(c,d)=>{e[c]&&(t.removeEventListener(this,c,d),delete e[c])},a=(c,d)=>{this.canvas&&this.resize(c,d)};let o;const l=()=>{s("attach",l),this.attached=!0,this.resize(),r("resize",a),r("detach",o)};o=()=>{this.attached=!1,s("resize",a),this._stop(),this._resize(0,0),r("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){_n(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},_n(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const s=r?"set":"remove";let a,o,l,c;for(t==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+s+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){o=e[l];const d=o&&this.getDatasetMeta(o.datasetIndex).controller;d&&d[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:a,index:o})=>{const l=this.getDatasetMeta(a);if(!l)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:l.data[o],index:o}});!qx(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const s=this.options.hover,a=(c,d)=>c.filter(h=>!d.some(p=>h.datasetIndex===p.datasetIndex&&h.index===p.index)),o=a(t,e),l=r?e:a(e,t);o.length&&this.updateHoverStyle(o,s.mode,!1),l.length&&s.mode&&this.updateHoverStyle(l,s.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,s)===!1)return;const a=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(a||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:s=[],options:a}=this,o=t,l=this._getActiveElements(e,s,r,o),c=Kse(e),d=Zoe(e,this._lastEvent,r,c);r&&(this._lastEvent=null,qn(a.onHover,[e,l,this],this),c&&qn(a.onClick,[e,l,this],this));const h=!qx(l,s);return(h||t)&&(this._active=l,this._updateHoverStyles(l,s,t)),this._lastEvent=d,h}_getActiveElements(e,t,r,s){if(e.type==="mouseout")return[];if(!r)return t;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,s)}}function yL(){return _n(Iy.instances,n=>n._plugins.invalidate())}function Koe(n,e,t){const{startAngle:r,x:s,y:a,outerRadius:o,innerRadius:l,options:c}=e,{borderWidth:d,borderJoinStyle:h}=c,p=Math.min(d/o,ui(r-t));if(n.beginPath(),n.arc(s,a,o-d/2,r+p/2,t-p/2),l>0){const x=Math.min(d/l,ui(r-t));n.arc(s,a,l+d/2,t-x/2,r+x/2,!0)}else{const x=Math.min(d/2,o*ui(r-t));if(h==="round")n.arc(s,a,x,t-Mn/2,r+Mn/2,!0);else if(h==="bevel"){const v=2*x*x,w=-v*Math.cos(t+Mn/2)+s,_=-v*Math.sin(t+Mn/2)+a,j=v*Math.cos(r+Mn/2)+s,T=v*Math.sin(r+Mn/2)+a;n.lineTo(w,_),n.lineTo(j,T)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function Joe(n,e,t){const{startAngle:r,pixelMargin:s,x:a,y:o,outerRadius:l,innerRadius:c}=e;let d=s/l;n.beginPath(),n.arc(a,o,l,r-d,t+d),c>s?(d=s/c,n.arc(a,o,c,t+d,r-d,!0)):n.arc(a,o,s,t+kr,r-kr),n.closePath(),n.clip()}function Qoe(n){return p1(n,["outerStart","outerEnd","innerStart","innerEnd"])}function Xoe(n,e,t,r){const s=Qoe(n.options.borderRadius),a=(t-e)/2,o=Math.min(a,r*e/2),l=c=>{const d=(t-Math.min(a,c))*r/2;return os(c,0,Math.min(a,d))};return{outerStart:l(s.outerStart),outerEnd:l(s.outerEnd),innerStart:os(s.innerStart,0,o),innerEnd:os(s.innerEnd,0,o)}}function ef(n,e,t,r){return{x:t+n*Math.cos(e),y:r+n*Math.sin(e)}}function Hx(n,e,t,r,s,a){const{x:o,y:l,startAngle:c,pixelMargin:d,innerRadius:h}=e,p=Math.max(e.outerRadius+r+t-d,0),x=h>0?h+r+t+d:0;let v=0;const w=s-c;if(r){const ae=h>0?h-r:0,J=p>0?p-r:0,ee=(ae+J)/2,X=ee!==0?w*ee/(ee+r):w;v=(w-X)/2}const _=Math.max(.001,w*p-t/Mn)/p,j=(w-_)/2,T=c+j+v,P=s-j-v,{outerStart:D,outerEnd:M,innerStart:O,innerEnd:I}=Xoe(e,x,p,P-T),q=p-D,F=p-M,V=T+D/q,U=P-M/F,W=x+O,$=x+I,ne=T+O/W,Y=P-I/$;if(n.beginPath(),a){const ae=(V+U)/2;if(n.arc(o,l,p,V,ae),n.arc(o,l,p,ae,U),M>0){const Z=ef(F,U,o,l);n.arc(Z.x,Z.y,M,U,P+kr)}const J=ef($,P,o,l);if(n.lineTo(J.x,J.y),I>0){const Z=ef($,Y,o,l);n.arc(Z.x,Z.y,I,P+kr,Y+Math.PI)}const ee=(P-I/x+(T+O/x))/2;if(n.arc(o,l,x,P-I/x,ee,!0),n.arc(o,l,x,ee,T+O/x,!0),O>0){const Z=ef(W,ne,o,l);n.arc(Z.x,Z.y,O,ne+Math.PI,T-kr)}const X=ef(q,T,o,l);if(n.lineTo(X.x,X.y),D>0){const Z=ef(q,V,o,l);n.arc(Z.x,Z.y,D,T-kr,V)}}else{n.moveTo(o,l);const ae=Math.cos(V)*p+o,J=Math.sin(V)*p+l;n.lineTo(ae,J);const ee=Math.cos(U)*p+o,X=Math.sin(U)*p+l;n.lineTo(ee,X)}n.closePath()}function ele(n,e,t,r,s){const{fullCircles:a,startAngle:o,circumference:l}=e;let c=e.endAngle;if(a){Hx(n,e,t,r,c,s);for(let d=0;d<a;++d)n.fill();isNaN(l)||(c=o+(l%Xn||Xn))}return Hx(n,e,t,r,c,s),n.fill(),c}function tle(n,e,t,r,s){const{fullCircles:a,startAngle:o,circumference:l,options:c}=e,{borderWidth:d,borderJoinStyle:h,borderDash:p,borderDashOffset:x,borderRadius:v}=c,w=c.borderAlign==="inner";if(!d)return;n.setLineDash(p||[]),n.lineDashOffset=x,w?(n.lineWidth=d*2,n.lineJoin=h||"round"):(n.lineWidth=d,n.lineJoin=h||"bevel");let _=e.endAngle;if(a){Hx(n,e,t,r,_,s);for(let j=0;j<a;++j)n.stroke();isNaN(l)||(_=o+(l%Xn||Xn))}w&&Joe(n,e,_),c.selfJoin&&_-o>=Mn&&v===0&&h!=="miter"&&Koe(n,e,_),a||(Hx(n,e,t,r,_,s),n.stroke())}class nle extends od{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,r){const s=this.getProps(["x","y"],r),{angle:a,distance:o}=u6(s,{x:e,y:t}),{startAngle:l,endAngle:c,innerRadius:d,outerRadius:h,circumference:p}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),x=(this.options.spacing+this.options.borderWidth)/2,v=Gt(p,c-l),w=Cm(a,l,c)&&l!==c,_=v>=Xn||w,j=wl(o,d+x,h+x);return _&&j}getCenterPoint(e){const{x:t,y:r,startAngle:s,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:d}=this.options,h=(s+a)/2,p=(o+l+d+c)/2;return{x:t+Math.cos(h)*p,y:r+Math.sin(h)*p}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:r}=this,s=(t.offset||0)/4,a=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=r>Xn?Math.floor(r/Xn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*s,Math.sin(l)*s);const c=1-Math.sin(Math.min(Mn,r||0)),d=s*c;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,ele(e,this,d,a,o),tle(e,this,d,a,o),e.restore()}}function B6(n,e,t=e){n.lineCap=Gt(t.borderCapStyle,e.borderCapStyle),n.setLineDash(Gt(t.borderDash,e.borderDash)),n.lineDashOffset=Gt(t.borderDashOffset,e.borderDashOffset),n.lineJoin=Gt(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Gt(t.borderWidth,e.borderWidth),n.strokeStyle=Gt(t.borderColor,e.borderColor)}function rle(n,e,t){n.lineTo(t.x,t.y)}function sle(n){return n.stepped?jie:n.tension||n.cubicInterpolationMode==="monotone"?Nie:rle}function W6(n,e,t={}){const r=n.length,{start:s=0,end:a=r-1}=t,{start:o,end:l}=e,c=Math.max(s,o),d=Math.min(a,l),h=s<o&&a<o||s>l&&a>l;return{count:r,start:c,loop:e.loop,ilen:d<c&&!h?r+d-c:d-c}}function ile(n,e,t,r){const{points:s,options:a}=e,{count:o,start:l,loop:c,ilen:d}=W6(s,t,r),h=sle(a);let{move:p=!0,reverse:x}=r||{},v,w,_;for(v=0;v<=d;++v)w=s[(l+(x?d-v:v))%o],!w.skip&&(p?(n.moveTo(w.x,w.y),p=!1):h(n,_,w,x,a.stepped),_=w);return c&&(w=s[(l+(x?d:0))%o],h(n,_,w,x,a.stepped)),!!c}function ale(n,e,t,r){const s=e.points,{count:a,start:o,ilen:l}=W6(s,t,r),{move:c=!0,reverse:d}=r||{};let h=0,p=0,x,v,w,_,j,T;const P=M=>(o+(d?l-M:M))%a,D=()=>{_!==j&&(n.lineTo(h,j),n.lineTo(h,_),n.lineTo(h,T))};for(c&&(v=s[P(0)],n.moveTo(v.x,v.y)),x=0;x<=l;++x){if(v=s[P(x)],v.skip)continue;const M=v.x,O=v.y,I=M|0;I===w?(O<_?_=O:O>j&&(j=O),h=(p*h+M)/++p):(D(),n.lineTo(M,O),w=I,p=0,_=j=O),T=O}D()}function JS(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?ale:ile}function ole(n){return n.stepped?nae:n.tension||n.cubicInterpolationMode==="monotone"?rae:Qd}function lle(n,e,t,r){let s=e._path;s||(s=e._path=new Path2D,e.path(s,t,r)&&s.closePath()),B6(n,e.options),n.stroke(s)}function cle(n,e,t,r){const{segments:s,options:a}=e,o=JS(e);for(const l of s)B6(n,a,l.style),n.beginPath(),o(n,e,l,{start:t,end:t+r-1})&&n.closePath(),n.stroke()}const dle=typeof Path2D=="function";function ule(n,e,t,r){dle&&!e.options.segment?lle(n,e,t,r):cle(n,e,t,r)}class Ay extends od{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const s=r.spanGaps?this._loop:this._fullLoop;Gie(this._points,r,e,s,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=cae(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,s=e[t],a=this.points,o=P6(this,{property:t,start:s,end:s});if(!o.length)return;const l=[],c=ole(r);let d,h;for(d=0,h=o.length;d<h;++d){const{start:p,end:x}=o[d],v=a[p],w=a[x];if(v===w){l.push(v);continue}const _=Math.abs((s-v[t])/(w[t]-v[t])),j=c(v,w,_,r.stepped);j[t]=e[t],l.push(j)}return l.length===1?l[0]:l}pathSegment(e,t,r){return JS(this)(e,this,t,r)}path(e,t,r){const s=this.segments,a=JS(this);let o=this._loop;t=t||0,r=r||this.points.length-t;for(const l of s)o&=a(e,this,l,{start:t,end:t+r-1});return!!o}draw(e,t,r,s){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),ule(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function vL(n,e,t,r){const s=n.options,{[t]:a}=n.getProps([t],r);return Math.abs(e-a)<s.radius+s.hitRadius}class fle extends od{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,r){const s=this.options,{x:a,y:o}=this.getProps(["x","y"],r);return Math.pow(e-a,2)+Math.pow(t-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,t){return vL(this,e,"x",t)}inYRange(e,t){return vL(this,e,"y",t)}getCenterPoint(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const r=t&&e.borderWidth||0;return(t+r)*2}draw(e,t){const r=this.options;this.skip||r.radius<.1||!Tm(this,t,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,GS(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function $6(n,e){const{x:t,y:r,base:s,width:a,height:o}=n.getProps(["x","y","base","width","height"],e);let l,c,d,h,p;return n.horizontal?(p=o/2,l=Math.min(t,s),c=Math.max(t,s),d=r-p,h=r+p):(p=a/2,l=t-p,c=t+p,d=Math.min(r,s),h=Math.max(r,s)),{left:l,top:d,right:c,bottom:h}}function Lc(n,e,t,r){return n?0:os(e,t,r)}function hle(n,e,t){const r=n.options.borderWidth,s=n.borderSkipped,a=v6(r);return{t:Lc(s.top,a.top,0,t),r:Lc(s.right,a.right,0,e),b:Lc(s.bottom,a.bottom,0,t),l:Lc(s.left,a.left,0,e)}}function mle(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,a=gf(s),o=Math.min(e,t),l=n.borderSkipped,c=r||nn(s);return{topLeft:Lc(!c||l.top||l.left,a.topLeft,0,o),topRight:Lc(!c||l.top||l.right,a.topRight,0,o),bottomLeft:Lc(!c||l.bottom||l.left,a.bottomLeft,0,o),bottomRight:Lc(!c||l.bottom||l.right,a.bottomRight,0,o)}}function ple(n){const e=$6(n),t=e.right-e.left,r=e.bottom-e.top,s=hle(n,t/2,r/2),a=mle(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:a},inner:{x:e.left+s.l,y:e.top+s.t,w:t-s.l-s.r,h:r-s.t-s.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,a.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(s.b,s.r))}}}}function ON(n,e,t,r){const s=e===null,a=t===null,l=n&&!(s&&a)&&$6(n,r);return l&&(s||wl(e,l.left,l.right))&&(a||wl(t,l.top,l.bottom))}function gle(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function xle(n,e){n.rect(e.x,e.y,e.w,e.h)}function IN(n,e,t={}){const r=n.x!==t.x?-e:0,s=n.y!==t.y?-e:0,a=(n.x+n.w!==t.x+t.w?e:0)-r,o=(n.y+n.h!==t.y+t.h?e:0)-s;return{x:n.x+r,y:n.y+s,w:n.w+a,h:n.h+o,radius:n.radius}}class yle extends od{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:s}}=this,{inner:a,outer:o}=ple(this),l=gle(o.radius)?Bx:xle;e.save(),(o.w!==a.w||o.h!==a.h)&&(e.beginPath(),l(e,IN(o,t,a)),e.clip(),l(e,IN(a,-t,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),l(e,IN(a,t)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,t,r){return ON(this,e,t,r)}inXRange(e,t){return ON(this,e,null,t)}inYRange(e,t){return ON(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:s,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(t+s)/2:t,y:a?r:(r+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}function vle(n,e,t){const r=n.segments,s=n.points,a=e.points,o=[];for(const l of r){let{start:c,end:d}=l;d=Ry(c,d,s);const h=QS(t,s[c],s[d],l.loop);if(!e.segments){o.push({source:l,target:h,start:s[c],end:s[d]});continue}const p=P6(e,h);for(const x of p){const v=QS(t,a[x.start],a[x.end],x.loop),w=k6(l,s,v);for(const _ of w)o.push({source:_,target:x,start:{[t]:bL(h,v,"start",Math.max)},end:{[t]:bL(h,v,"end",Math.min)}})}}return o}function QS(n,e,t,r){if(r)return;let s=e[n],a=t[n];return n==="angle"&&(s=ui(s),a=ui(a)),{property:n,start:s,end:a}}function ble(n,e){const{x:t=null,y:r=null}=n||{},s=e.points,a=[];return e.segments.forEach(({start:o,end:l})=>{l=Ry(o,l,s);const c=s[o],d=s[l];r!==null?(a.push({x:c.x,y:r}),a.push({x:d.x,y:r})):t!==null&&(a.push({x:t,y:c.y}),a.push({x:t,y:d.y}))}),a}function Ry(n,e,t){for(;e>n;e--){const r=t[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function bL(n,e,t,r){return n&&e?r(n[t],e[t]):n?n[t]:e?e[t]:0}function H6(n,e){let t=[],r=!1;return Tr(n)?(r=!0,t=n):t=ble(n,e),t.length?new Ay({points:t,options:{tension:0},_loop:r,_fullLoop:r}):null}function wL(n){return n&&n.fill!==!1}function wle(n,e,t){let s=n[e].fill;const a=[e];let o;if(!t)return s;for(;s!==!1&&a.indexOf(s)===-1;){if(!cs(s))return s;if(o=n[s],!o)return!1;if(o.visible)return s;a.push(s),s=o.fill}return!1}function _le(n,e,t){const r=Cle(n);if(nn(r))return isNaN(r.value)?!1:r;let s=parseFloat(r);return cs(s)&&Math.floor(s)===s?jle(r[0],e,s,t):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function jle(n,e,t,r){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=r?!1:t}function Nle(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:nn(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function Sle(n,e,t){let r;return n==="start"?r=t:n==="end"?r=e.options.reverse?e.min:e.max:nn(n)?r=n.value:r=e.getBaseValue(),r}function Cle(n){const e=n.options,t=e.fill;let r=Gt(t&&t.target,t);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function Tle(n){const{scale:e,index:t,line:r}=n,s=[],a=r.segments,o=r.points,l=kle(e,t);l.push(H6({x:null,y:e.bottom},r));for(let c=0;c<a.length;c++){const d=a[c];for(let h=d.start;h<=d.end;h++)Ple(s,o[h],l)}return new Ay({points:s,options:{}})}function kle(n,e){const t=[],r=n.getMatchingVisibleMetas("line");for(let s=0;s<r.length;s++){const a=r[s];if(a.index===e)break;a.hidden||t.unshift(a.dataset)}return t}function Ple(n,e,t){const r=[];for(let s=0;s<t.length;s++){const a=t[s],{first:o,last:l,point:c}=Mle(a,e,"x");if(!(!c||o&&l)){if(o)r.unshift(c);else if(n.push(c),!l)break}}n.push(...r)}function Mle(n,e,t){const r=n.interpolate(e,t);if(!r)return{};const s=r[t],a=n.segments,o=n.points;let l=!1,c=!1;for(let d=0;d<a.length;d++){const h=a[d],p=o[h.start][t],x=o[h.end][t];if(wl(s,p,x)){l=s===p,c=s===x;break}}return{first:l,last:c,point:r}}class Y6{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,r){const{x:s,y:a,radius:o}=this;return t=t||{start:0,end:Xn},e.arc(s,a,o,t.end,t.start,!0),!r.bounds}interpolate(e){const{x:t,y:r,radius:s}=this,a=e.angle;return{x:t+Math.cos(a)*s,y:r+Math.sin(a)*s,angle:a}}}function Ele(n){const{chart:e,fill:t,line:r}=n;if(cs(t))return Dle(e,t);if(t==="stack")return Tle(n);if(t==="shape")return!0;const s=Ole(n);return s instanceof Y6?s:H6(s,r)}function Dle(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function Ole(n){return(n.scale||{}).getPointPositionForValue?Ale(n):Ile(n)}function Ile(n){const{scale:e={},fill:t}=n,r=Nle(t,e);if(cs(r)){const s=e.isHorizontal();return{x:s?r:null,y:s?null:r}}return null}function Ale(n){const{scale:e,fill:t}=n,r=e.options,s=e.getLabels().length,a=r.reverse?e.max:e.min,o=Sle(t,e,a),l=[];if(r.grid.circular){const c=e.getPointPositionForValue(0,a);return new Y6({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(o)})}for(let c=0;c<s;++c)l.push(e.getPointPositionForValue(c,o));return l}function AN(n,e,t){const r=Ele(e),{chart:s,index:a,line:o,scale:l,axis:c}=e,d=o.options,h=d.fill,p=d.backgroundColor,{above:x=p,below:v=p}=h||{},w=s.getDatasetMeta(a),_=M6(s,w);r&&o.points.length&&(Py(n,t),Rle(n,{line:o,target:r,above:x,below:v,area:t,scale:l,axis:c,clip:_}),My(n))}function Rle(n,e){const{line:t,target:r,above:s,below:a,area:o,scale:l,clip:c}=e,d=t._loop?"angle":e.axis;n.save();let h=a;a!==s&&(d==="x"?(_L(n,r,o.top),RN(n,{line:t,target:r,color:s,scale:l,property:d,clip:c}),n.restore(),n.save(),_L(n,r,o.bottom)):d==="y"&&(jL(n,r,o.left),RN(n,{line:t,target:r,color:a,scale:l,property:d,clip:c}),n.restore(),n.save(),jL(n,r,o.right),h=s)),RN(n,{line:t,target:r,color:h,scale:l,property:d,clip:c}),n.restore()}function _L(n,e,t){const{segments:r,points:s}=e;let a=!0,o=!1;n.beginPath();for(const l of r){const{start:c,end:d}=l,h=s[c],p=s[Ry(c,d,s)];a?(n.moveTo(h.x,h.y),a=!1):(n.lineTo(h.x,t),n.lineTo(h.x,h.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(p.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function jL(n,e,t){const{segments:r,points:s}=e;let a=!0,o=!1;n.beginPath();for(const l of r){const{start:c,end:d}=l,h=s[c],p=s[Ry(c,d,s)];a?(n.moveTo(h.x,h.y),a=!1):(n.lineTo(t,h.y),n.lineTo(h.x,h.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(t,p.y)}n.lineTo(t,e.first().y),n.closePath(),n.clip()}function RN(n,e){const{line:t,target:r,property:s,color:a,scale:o,clip:l}=e,c=vle(t,r,s);for(const{source:d,target:h,start:p,end:x}of c){const{style:{backgroundColor:v=a}={}}=d,w=r!==!0;n.save(),n.fillStyle=v,Lle(n,o,l,w&&QS(s,p,x)),n.beginPath();const _=!!t.pathSegment(n,d);let j;if(w){_?n.closePath():NL(n,r,x,s);const T=!!r.pathSegment(n,h,{move:_,reverse:!0});j=_&&T,j||NL(n,r,p,s)}n.closePath(),n.fill(j?"evenodd":"nonzero"),n.restore()}}function Lle(n,e,t,r){const s=e.chart.chartArea,{property:a,start:o,end:l}=r||{};if(a==="x"||a==="y"){let c,d,h,p;a==="x"?(c=o,d=s.top,h=l,p=s.bottom):(c=s.left,d=o,h=s.right,p=l),n.beginPath(),t&&(c=Math.max(c,t.left),h=Math.min(h,t.right),d=Math.max(d,t.top),p=Math.min(p,t.bottom)),n.rect(c,d,h-c,p-d),n.clip()}}function NL(n,e,t,r){const s=e.interpolate(t,r);s&&n.lineTo(s.x,s.y)}var Fle={id:"filler",afterDatasetsUpdate(n,e,t){const r=(n.data.datasets||[]).length,s=[];let a,o,l,c;for(o=0;o<r;++o)a=n.getDatasetMeta(o),l=a.dataset,c=null,l&&l.options&&l instanceof Ay&&(c={visible:n.isDatasetVisible(o),index:o,fill:_le(l,o,r),chart:n,axis:a.controller.options.indexAxis,scale:a.vScale,line:l}),a.$filler=c,s.push(c);for(o=0;o<r;++o)c=s[o],!(!c||c.fill===!1)&&(c.fill=wle(s,o,t.propagate))},beforeDraw(n,e,t){const r=t.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),a=n.chartArea;for(let o=s.length-1;o>=0;--o){const l=s[o].$filler;l&&(l.line.updateControlPoints(a,l.axis),r&&l.fill&&AN(n.ctx,l,a))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const r=n.getSortedVisibleDatasetMetas();for(let s=r.length-1;s>=0;--s){const a=r[s].$filler;wL(a)&&AN(n.ctx,a,n.chartArea)}},beforeDatasetDraw(n,e,t){const r=e.meta.$filler;!wL(r)||t.drawTime!=="beforeDatasetDraw"||AN(n.ctx,r,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const SL=(n,e)=>{let{boxHeight:t=e,boxWidth:r=e}=n;return n.usePointStyle&&(t=Math.min(t,e),r=n.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(e,t)}},qle=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class CL extends od{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=qn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(r=>e.filter(r,this.chart.data))),e.sort&&(t=t.sort((r,s)=>e.sort(r,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,s=Hs(r.font),a=s.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=SL(r,a);let d,h;t.font=s.string,this.isHorizontal()?(d=this.maxWidth,h=this._fitRows(o,a,l,c)+10):(h=this.maxHeight,d=this._fitCols(o,s,l,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(h,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,s){const{ctx:a,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],h=s+l;let p=e;a.textAlign="left",a.textBaseline="middle";let x=-1,v=-h;return this.legendItems.forEach((w,_)=>{const j=r+t/2+a.measureText(w.text).width;(_===0||d[d.length-1]+j+2*l>o)&&(p+=h,d[d.length-(_>0?0:1)]=0,v+=h,x++),c[_]={left:0,top:v,row:x,width:j,height:s},d[d.length-1]+=j+l}),p}_fitCols(e,t,r,s){const{ctx:a,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],h=o-e;let p=l,x=0,v=0,w=0,_=0;return this.legendItems.forEach((j,T)=>{const{itemWidth:P,itemHeight:D}=zle(r,t,a,j,s);T>0&&v+D+2*l>h&&(p+=x+l,d.push({width:x,height:v}),w+=x+l,_++,x=v=0),c[T]={left:w,top:v,col:_,width:P,height:D},x=Math.max(x,P),v+=D+l}),p+=x,d.push({width:x,height:v}),p}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:s},rtl:a}}=this,o=xf(a,this.left,this.width);if(this.isHorizontal()){let l=0,c=ci(r,this.left+s,this.right-this.lineWidths[l]);for(const d of t)l!==d.row&&(l=d.row,c=ci(r,this.left+s,this.right-this.lineWidths[l])),d.top+=this.top+e+s,d.left=o.leftForLtr(o.x(c),d.width),c+=d.width+s}else{let l=0,c=ci(r,this.top+e+s,this.bottom-this.columnSizes[l].height);for(const d of t)d.col!==l&&(l=d.col,c=ci(r,this.top+e+s,this.bottom-this.columnSizes[l].height)),d.top=c,d.left+=this.left+s,d.left=o.leftForLtr(o.x(d.left),d.width),c+=d.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Py(e,this),this._draw(),My(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:s}=this,{align:a,labels:o}=e,l=lr.color,c=xf(e.rtl,this.left,this.width),d=Hs(o.font),{padding:h}=o,p=d.size,x=p/2;let v;this.drawTitle(),s.textAlign=c.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=d.string;const{boxWidth:w,boxHeight:_,itemHeight:j}=SL(o,p),T=function(I,q,F){if(isNaN(w)||w<=0||isNaN(_)||_<0)return;s.save();const V=Gt(F.lineWidth,1);if(s.fillStyle=Gt(F.fillStyle,l),s.lineCap=Gt(F.lineCap,"butt"),s.lineDashOffset=Gt(F.lineDashOffset,0),s.lineJoin=Gt(F.lineJoin,"miter"),s.lineWidth=V,s.strokeStyle=Gt(F.strokeStyle,l),s.setLineDash(Gt(F.lineDash,[])),o.usePointStyle){const U={radius:_*Math.SQRT2/2,pointStyle:F.pointStyle,rotation:F.rotation,borderWidth:V},W=c.xPlus(I,w/2),$=q+x;y6(s,U,W,$,o.pointStyleWidth&&w)}else{const U=q+Math.max((p-_)/2,0),W=c.leftForLtr(I,w),$=gf(F.borderRadius);s.beginPath(),Object.values($).some(ne=>ne!==0)?Bx(s,{x:W,y:U,w,h:_,radius:$}):s.rect(W,U,w,_),s.fill(),V!==0&&s.stroke()}s.restore()},P=function(I,q,F){Vx(s,F.text,I,q+j/2,d,{strikethrough:F.hidden,textAlign:c.textAlign(F.textAlign)})},D=this.isHorizontal(),M=this._computeTitleHeight();D?v={x:ci(a,this.left+h,this.right-r[0]),y:this.top+h+M,line:0}:v={x:this.left+h,y:ci(a,this.top+M+h,this.bottom-t[0].height),line:0},S6(this.ctx,e.textDirection);const O=j+h;this.legendItems.forEach((I,q)=>{s.strokeStyle=I.fontColor,s.fillStyle=I.fontColor;const F=s.measureText(I.text).width,V=c.textAlign(I.textAlign||(I.textAlign=o.textAlign)),U=w+x+F;let W=v.x,$=v.y;c.setWidth(this.width),D?q>0&&W+U+h>this.right&&($=v.y+=O,v.line++,W=v.x=ci(a,this.left+h,this.right-r[v.line])):q>0&&$+O>this.bottom&&(W=v.x=W+t[v.line].width+h,v.line++,$=v.y=ci(a,this.top+M+h,this.bottom-t[v.line].height));const ne=c.x(W);if(T(ne,$,I),W=die(V,W+w+x,D?W+U:this.right,e.rtl),P(c.x(W),$,I),D)v.x+=U+h;else if(typeof I.text!="string"){const Y=d.lineHeight;v.y+=G6(I,Y)+h}else v.y+=O}),C6(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=Hs(t.font),s=Ia(t.padding);if(!t.display)return;const a=xf(e.rtl,this.left,this.width),o=this.ctx,l=t.position,c=r.size/2,d=s.top+c;let h,p=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),h=this.top+d,p=ci(e.align,p,this.right-x);else{const w=this.columnSizes.reduce((_,j)=>Math.max(_,j.height),0);h=d+ci(e.align,this.top,this.bottom-w-e.labels.padding-this._computeTitleHeight())}const v=ci(l,p,p+x);o.textAlign=a.textAlign(g6(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=r.string,Vx(o,t.text,v,h,r)}_computeTitleHeight(){const e=this.options.title,t=Hs(e.font),r=Ia(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,s,a;if(wl(e,this.left,this.right)&&wl(t,this.top,this.bottom)){for(a=this.legendHitBoxes,r=0;r<a.length;++r)if(s=a[r],wl(e,s.left,s.left+s.width)&&wl(t,s.top,s.top+s.height))return this.legendItems[r]}return null}handleEvent(e){const t=this.options;if(!Ble(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,a=qle(s,r);s&&!a&&qn(t.onLeave,[e,s,this],this),this._hoveredItem=r,r&&!a&&qn(t.onHover,[e,r,this],this)}else r&&qn(t.onClick,[e,r,this],this)}}function zle(n,e,t,r,s){const a=Ule(r,n,e,t),o=Vle(s,r,e.lineHeight);return{itemWidth:a,itemHeight:o}}function Ule(n,e,t,r){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((a,o)=>a.length>o.length?a:o)),e+t.size/2+r.measureText(s).width}function Vle(n,e,t){let r=n;return typeof e.text!="string"&&(r=G6(e,t)),r}function G6(n,e){const t=n.text?n.text.length:0;return e*t}function Ble(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var Wle={id:"legend",_element:CL,start(n,e,t){const r=n.legend=new CL({ctx:n.ctx,options:t,chart:n});Rc.configure(n,r,t),Rc.addBox(n,r)},stop(n){Rc.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const r=n.legend;Rc.configure(n,r,t),r.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const r=e.datasetIndex,s=t.chart;s.isDatasetVisible(r)?(s.hide(r),e.hidden=!0):(s.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:s,color:a,useBorderRadius:o,borderRadius:l}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(t?0:void 0),h=Ia(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:a,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:d.borderColor,pointStyle:r||d.pointStyle,rotation:d.rotation,textAlign:s||d.textAlign,borderRadius:o&&(l||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};const Yh={average(n){if(!n.length)return!1;let e,t,r=new Set,s=0,a=0;for(e=0,t=n.length;e<t;++e){const l=n[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();r.add(c.x),s+=c.y,++a}}return a===0||r.size===0?!1:{x:[...r].reduce((l,c)=>l+c)/r.size,y:s/a}},nearest(n,e){if(!n.length)return!1;let t=e.x,r=e.y,s=Number.POSITIVE_INFINITY,a,o,l;for(a=0,o=n.length;a<o;++a){const c=n[a].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),h=HS(e,d);h<s&&(s=h,l=c)}}if(l){const c=l.tooltipPosition();t=c.x,r=c.y}return{x:t,y:r}}};function mo(n,e){return e&&(Tr(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function pl(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function $le(n,e){const{element:t,datasetIndex:r,index:s}=e,a=n.getDatasetMeta(r).controller,{label:o,value:l}=a.getLabelAndValue(s);return{chart:n,label:o,parsed:a.getParsed(s),raw:n.data.datasets[r].data[s],formattedValue:l,dataset:a.getDataset(),dataIndex:s,datasetIndex:r,element:t}}function TL(n,e){const t=n.chart.ctx,{body:r,footer:s,title:a}=n,{boxWidth:o,boxHeight:l}=e,c=Hs(e.bodyFont),d=Hs(e.titleFont),h=Hs(e.footerFont),p=a.length,x=s.length,v=r.length,w=Ia(e.padding);let _=w.height,j=0,T=r.reduce((M,O)=>M+O.before.length+O.lines.length+O.after.length,0);if(T+=n.beforeBody.length+n.afterBody.length,p&&(_+=p*d.lineHeight+(p-1)*e.titleSpacing+e.titleMarginBottom),T){const M=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;_+=v*M+(T-v)*c.lineHeight+(T-1)*e.bodySpacing}x&&(_+=e.footerMarginTop+x*h.lineHeight+(x-1)*e.footerSpacing);let P=0;const D=function(M){j=Math.max(j,t.measureText(M).width+P)};return t.save(),t.font=d.string,_n(n.title,D),t.font=c.string,_n(n.beforeBody.concat(n.afterBody),D),P=e.displayColors?o+2+e.boxPadding:0,_n(r,M=>{_n(M.before,D),_n(M.lines,D),_n(M.after,D)}),P=0,t.font=h.string,_n(n.footer,D),t.restore(),j+=w.width,{width:j,height:_}}function Hle(n,e){const{y:t,height:r}=e;return t<r/2?"top":t>n.height-r/2?"bottom":"center"}function Yle(n,e,t,r){const{x:s,width:a}=r,o=t.caretSize+t.caretPadding;if(n==="left"&&s+a+o>e.width||n==="right"&&s-a-o<0)return!0}function Gle(n,e,t,r){const{x:s,width:a}=t,{width:o,chartArea:{left:l,right:c}}=n;let d="center";return r==="center"?d=s<=(l+c)/2?"left":"right":s<=a/2?d="left":s>=o-a/2&&(d="right"),Yle(d,n,e,t)&&(d="center"),d}function kL(n,e,t){const r=t.yAlign||e.yAlign||Hle(n,t);return{xAlign:t.xAlign||e.xAlign||Gle(n,e,t,r),yAlign:r}}function Zle(n,e){let{x:t,width:r}=n;return e==="right"?t-=r:e==="center"&&(t-=r/2),t}function Kle(n,e,t){let{y:r,height:s}=n;return e==="top"?r+=t:e==="bottom"?r-=s+t:r-=s/2,r}function PL(n,e,t,r){const{caretSize:s,caretPadding:a,cornerRadius:o}=n,{xAlign:l,yAlign:c}=t,d=s+a,{topLeft:h,topRight:p,bottomLeft:x,bottomRight:v}=gf(o);let w=Zle(e,l);const _=Kle(e,c,d);return c==="center"?l==="left"?w+=d:l==="right"&&(w-=d):l==="left"?w-=Math.max(h,x)+s:l==="right"&&(w+=Math.max(p,v)+s),{x:os(w,0,r.width-e.width),y:os(_,0,r.height-e.height)}}function Zg(n,e,t){const r=Ia(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-r.right:n.x+r.left}function ML(n){return mo([],pl(n))}function Jle(n,e,t){return ju(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function EL(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const Z6={beforeTitle:fl,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:fl,beforeBody:fl,beforeLabel:fl,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return yn(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:fl,afterBody:fl,beforeFooter:fl,footer:fl,afterFooter:fl};function zs(n,e,t,r){const s=n[e].call(t,r);return typeof s>"u"?Z6[e].call(t,r):s}class DL extends od{static positioners=Yh;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&t.options.animation&&r.animations,a=new E6(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=Jle(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:r}=t,s=zs(r,"beforeTitle",this,e),a=zs(r,"title",this,e),o=zs(r,"afterTitle",this,e);let l=[];return l=mo(l,pl(s)),l=mo(l,pl(a)),l=mo(l,pl(o)),l}getBeforeBody(e,t){return ML(zs(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,s=[];return _n(e,a=>{const o={before:[],lines:[],after:[]},l=EL(r,a);mo(o.before,pl(zs(l,"beforeLabel",this,a))),mo(o.lines,zs(l,"label",this,a)),mo(o.after,pl(zs(l,"afterLabel",this,a))),s.push(o)}),s}getAfterBody(e,t){return ML(zs(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,s=zs(r,"beforeFooter",this,e),a=zs(r,"footer",this,e),o=zs(r,"afterFooter",this,e);let l=[];return l=mo(l,pl(s)),l=mo(l,pl(a)),l=mo(l,pl(o)),l}_createItems(e){const t=this._active,r=this.chart.data,s=[],a=[],o=[];let l=[],c,d;for(c=0,d=t.length;c<d;++c)l.push($le(this.chart,t[c]));return e.filter&&(l=l.filter((h,p,x)=>e.filter(h,p,x,r))),e.itemSort&&(l=l.sort((h,p)=>e.itemSort(h,p,r))),_n(l,h=>{const p=EL(e.callbacks,h);s.push(zs(p,"labelColor",this,h)),a.push(zs(p,"labelPointStyle",this,h)),o.push(zs(p,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const r=this.options.setContext(this.getContext()),s=this._active;let a,o=[];if(!s.length)this.opacity!==0&&(a={opacity:0});else{const l=Yh[r.position].call(this,s,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const c=this._size=TL(this,r),d=Object.assign({},l,c),h=kL(this.chart,r,d),p=PL(r,d,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,a={opacity:1,x:p.x,y:p.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,s){const a=this.getCaretPosition(e,r,s);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}getCaretPosition(e,t,r){const{xAlign:s,yAlign:a}=this,{caretSize:o,cornerRadius:l}=r,{topLeft:c,topRight:d,bottomLeft:h,bottomRight:p}=gf(l),{x,y:v}=e,{width:w,height:_}=t;let j,T,P,D,M,O;return a==="center"?(M=v+_/2,s==="left"?(j=x,T=j-o,D=M+o,O=M-o):(j=x+w,T=j+o,D=M-o,O=M+o),P=j):(s==="left"?T=x+Math.max(c,h)+o:s==="right"?T=x+w-Math.max(d,p)-o:T=this.caretX,a==="top"?(D=v,M=D-o,j=T-o,P=T+o):(D=v+_,M=D+o,j=T+o,P=T-o),O=D),{x1:j,x2:T,x3:P,y1:D,y2:M,y3:O}}drawTitle(e,t,r){const s=this.title,a=s.length;let o,l,c;if(a){const d=xf(r.rtl,this.x,this.width);for(e.x=Zg(this,r.titleAlign,r),t.textAlign=d.textAlign(r.titleAlign),t.textBaseline="middle",o=Hs(r.titleFont),l=r.titleSpacing,t.fillStyle=r.titleColor,t.font=o.string,c=0;c<a;++c)t.fillText(s[c],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,c+1===a&&(e.y+=r.titleMarginBottom-l)}}_drawColorBox(e,t,r,s,a){const o=this.labelColors[r],l=this.labelPointStyles[r],{boxHeight:c,boxWidth:d}=a,h=Hs(a.bodyFont),p=Zg(this,"left",a),x=s.x(p),v=c<h.lineHeight?(h.lineHeight-c)/2:0,w=t.y+v;if(a.usePointStyle){const _={radius:Math.min(d,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},j=s.leftForLtr(x,d)+d/2,T=w+c/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,GS(e,_,j,T),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,GS(e,_,j,T)}else{e.lineWidth=nn(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const _=s.leftForLtr(x,d),j=s.leftForLtr(s.xPlus(x,1),d-2),T=gf(o.borderRadius);Object.values(T).some(P=>P!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,Bx(e,{x:_,y:w,w:d,h:c,radius:T}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Bx(e,{x:j,y:w+1,w:d-2,h:c-2,radius:T}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(_,w,d,c),e.strokeRect(_,w,d,c),e.fillStyle=o.backgroundColor,e.fillRect(j,w+1,d-2,c-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:s}=this,{bodySpacing:a,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:d,boxPadding:h}=r,p=Hs(r.bodyFont);let x=p.lineHeight,v=0;const w=xf(r.rtl,this.x,this.width),_=function(F){t.fillText(F,w.x(e.x+v),e.y+x/2),e.y+=x+a},j=w.textAlign(o);let T,P,D,M,O,I,q;for(t.textAlign=o,t.textBaseline="middle",t.font=p.string,e.x=Zg(this,j,r),t.fillStyle=r.bodyColor,_n(this.beforeBody,_),v=l&&j!=="right"?o==="center"?d/2+h:d+2+h:0,M=0,I=s.length;M<I;++M){for(T=s[M],P=this.labelTextColors[M],t.fillStyle=P,_n(T.before,_),D=T.lines,l&&D.length&&(this._drawColorBox(t,e,M,w,r),x=Math.max(p.lineHeight,c)),O=0,q=D.length;O<q;++O)_(D[O]),x=p.lineHeight;_n(T.after,_)}v=0,x=p.lineHeight,_n(this.afterBody,_),e.y-=a}drawFooter(e,t,r){const s=this.footer,a=s.length;let o,l;if(a){const c=xf(r.rtl,this.x,this.width);for(e.x=Zg(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=c.textAlign(r.footerAlign),t.textBaseline="middle",o=Hs(r.footerFont),t.fillStyle=r.footerColor,t.font=o.string,l=0;l<a;++l)t.fillText(s[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,t,r,s){const{xAlign:a,yAlign:o}=this,{x:l,y:c}=e,{width:d,height:h}=r,{topLeft:p,topRight:x,bottomLeft:v,bottomRight:w}=gf(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(l+p,c),o==="top"&&this.drawCaret(e,t,r,s),t.lineTo(l+d-x,c),t.quadraticCurveTo(l+d,c,l+d,c+x),o==="center"&&a==="right"&&this.drawCaret(e,t,r,s),t.lineTo(l+d,c+h-w),t.quadraticCurveTo(l+d,c+h,l+d-w,c+h),o==="bottom"&&this.drawCaret(e,t,r,s),t.lineTo(l+v,c+h),t.quadraticCurveTo(l,c+h,l,c+h-v),o==="center"&&a==="left"&&this.drawCaret(e,t,r,s),t.lineTo(l,c+p),t.quadraticCurveTo(l,c,l+p,c),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,s=r&&r.x,a=r&&r.y;if(s||a){const o=Yh[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=TL(this,e),c=Object.assign({},o,this._size),d=kL(t,e,c),h=PL(e,c,d,t);(s._to!==h.x||a._to!==h.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},a={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=Ia(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=r,this.drawBackground(a,e,s,t),S6(e,t.textDirection),a.y+=o.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),C6(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,s=e.map(({datasetIndex:l,index:c})=>{const d=this.chart.getDatasetMeta(l);if(!d)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:d.data[c],index:c}}),a=!qx(r,s),o=this._positionChanged(s,t);(a||o)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,a=this._active||[],o=this._getActiveElements(e,a,t,r),l=this._positionChanged(o,e),c=t||!qx(o,a)||l;return c&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),c}_getActiveElements(e,t,r,s){const a=this.options;if(e.type==="mouseout")return[];if(!s)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,a.mode,a,r);return a.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:r,caretY:s,options:a}=this,o=Yh[a.position].call(this,e,t);return o!==!1&&(r!==o.x||s!==o.y)}}var Qle={id:"tooltip",_element:DL,positioners:Yh,afterInit(n,e,t){t&&(n.tooltip=new DL({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Z6},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Xle=(n,e,t,r)=>(typeof e=="string"?(t=n.push(e)-1,r.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function ece(n,e,t,r){const s=n.indexOf(e);if(s===-1)return Xle(n,e,t,r);const a=n.lastIndexOf(e);return s!==a?t:s}const tce=(n,e)=>n===null?null:os(Math.round(n),0,e);function OL(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class nce extends Yf{static id="category";static defaults={ticks:{callback:OL}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const r=this.getLabels();for(const{index:s,label:a}of t)r[s]===a&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(yn(e))return null;const r=this.getLabels();return t=isFinite(t)&&r[t]===e?t:ece(r,e,Gt(t,e),this._addedLabels),tce(t,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),t||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,s=[];let a=this.getLabels();a=e===0&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=t;o++)s.push({value:o});return s}getLabelForValue(e){return OL.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function rce(n,e){const t=[],{bounds:s,step:a,min:o,max:l,precision:c,count:d,maxTicks:h,maxDigits:p,includeBounds:x}=n,v=a||1,w=h-1,{min:_,max:j}=e,T=!yn(o),P=!yn(l),D=!yn(d),M=(j-_)/(p+1);let O=PR((j-_)/w/v)*v,I,q,F,V;if(O<1e-14&&!T&&!P)return[{value:_},{value:j}];V=Math.ceil(j/O)-Math.floor(_/O),V>w&&(O=PR(V*O/w/v)*v),yn(c)||(I=Math.pow(10,c),O=Math.ceil(O*I)/I),s==="ticks"?(q=Math.floor(_/O)*O,F=Math.ceil(j/O)*O):(q=_,F=j),T&&P&&a&&tie((l-o)/a,O/1e3)?(V=Math.round(Math.min((l-o)/O,h)),O=(l-o)/V,q=o,F=l):D?(q=T?o:q,F=P?l:F,V=d-1,O=(F-q)/V):(V=(F-q)/O,tm(V,Math.round(V),O/1e3)?V=Math.round(V):V=Math.ceil(V));const U=Math.max(MR(O),MR(q));I=Math.pow(10,yn(c)?U:c),q=Math.round(q*I)/I,F=Math.round(F*I)/I;let W=0;for(T&&(x&&q!==o?(t.push({value:o}),q<o&&W++,tm(Math.round((q+W*O)*I)/I,o,IL(o,M,n))&&W++):q<o&&W++);W<V;++W){const $=Math.round((q+W*O)*I)/I;if(P&&$>l)break;t.push({value:$})}return P&&x&&F!==l?t.length&&tm(t[t.length-1].value,l,IL(l,M,n))?t[t.length-1].value=l:t.push({value:l}):(!P||F===l)&&t.push({value:F}),t}function IL(n,e,{horizontal:t,minRotation:r}){const s=bl(r),a=(t?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+n).length;return Math.min(e/a,o)}class sce extends Yf{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return yn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:s,max:a}=this;const o=c=>s=t?s:c,l=c=>a=r?a:c;if(e){const c=No(s),d=No(a);c<0&&d<0?l(0):c>0&&d>0&&o(0)}if(s===a){let c=a===0?1:Math.abs(a*.05);l(a+c),e||o(s-c)}this.min=s,this.max=a}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,s;return r?(s=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),t=t||11),t&&(s=Math.min(t,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const s={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},a=this._range||this,o=rce(s,a);return e.bounds==="ticks"&&nie(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const s=(r-t)/Math.max(e.length-1,1)/2;t-=s,r+=s}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return m1(e,this.chart.options.locale,this.options.ticks.format)}}class ice extends sce{static id="linear";static defaults={ticks:{callback:x6.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=cs(e)?e:0,this.max=cs(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=bl(this.options.ticks.minRotation),s=(e?Math.sin(r):Math.cos(r))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const Ly={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Bs=Object.keys(Ly);function AL(n,e){return n-e}function RL(n,e){if(yn(e))return null;const t=n._adapter,{parser:r,round:s,isoWeekday:a}=n._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),cs(o)||(o=typeof r=="string"?t.parse(o,r):t.parse(o)),o===null?null:(s&&(o=s==="week"&&(Sm(a)||a===!0)?t.startOf(o,"isoWeek",a):t.startOf(o,s)),+o)}function LL(n,e,t,r){const s=Bs.length;for(let a=Bs.indexOf(n);a<s-1;++a){const o=Ly[Bs[a]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=r)return Bs[a]}return Bs[s-1]}function ace(n,e,t,r,s){for(let a=Bs.length-1;a>=Bs.indexOf(t);a--){const o=Bs[a];if(Ly[o].common&&n._adapter.diff(s,r,o)>=e-1)return o}return Bs[t?Bs.indexOf(t):0]}function oce(n){for(let e=Bs.indexOf(n)+1,t=Bs.length;e<t;++e)if(Ly[Bs[e]].common)return Bs[e]}function FL(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:r,hi:s}=f1(t,e),a=t[r]>=e?t[r]:t[s];n[a]=!0}}function lce(n,e,t,r){const s=n._adapter,a=+s.startOf(e[0].value,r),o=e[e.length-1].value;let l,c;for(l=a;l<=o;l=+s.add(l,1,r))c=t[l],c>=0&&(e[c].major=!0);return e}function qL(n,e,t){const r=[],s={},a=e.length;let o,l;for(o=0;o<a;++o)l=e[o],s[l]=o,r.push({value:l,major:!1});return a===0||!t?r:lce(n,r,s,t)}class zL extends Yf{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),s=this._adapter=new Uae._date(e.adapters.date);s.init(t),em(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:RL(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:s,max:a,minDefined:o,maxDefined:l}=this.getUserBounds();function c(d){!o&&!isNaN(d.min)&&(s=Math.min(s,d.min)),!l&&!isNaN(d.max)&&(a=Math.max(a,d.max))}(!o||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),s=cs(s)&&!isNaN(s)?s:+t.startOf(Date.now(),r),a=cs(a)&&!isNaN(a)?a:+t.endOf(Date.now(),r)+1,this.min=Math.min(s,a-1),this.max=Math.max(s+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,s=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const a=this.min,o=this.max,l=oie(s,a,o);return this._unit=t.unit||(r.autoSkip?LL(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):ace(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:oce(this._unit),this.initOffsets(s),e.reverse&&l.reverse(),qL(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,s,a;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?r=a:r=(a-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=os(t,0,o),r=os(r,0,o),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,s=this.options,a=s.time,o=a.unit||LL(a.minUnit,t,r,this._getLabelCapacity(t)),l=Gt(s.ticks.stepSize,1),c=o==="week"?a.isoWeekday:!1,d=Sm(c)||c===!0,h={};let p=t,x,v;if(d&&(p=+e.startOf(p,"isoWeek",c)),p=+e.startOf(p,d?"day":o),e.diff(r,t,o)>1e5*l)throw new Error(t+" and "+r+" are too far apart with stepSize of "+l+" "+o);const w=s.ticks.source==="data"&&this.getDataTimestamps();for(x=p,v=0;x<r;x=+e.add(x,l,o),v++)FL(h,x,w);return(x===r||s.bounds==="ticks"||v===1)&&FL(h,x,w),Object.keys(h).sort(AL).map(_=>+_)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,a=this._unit,o=t||s[a];return this._adapter.format(e,o)}_tickFormatFunction(e,t,r,s){const a=this.options,o=a.ticks.callback;if(o)return qn(o,[e,t,r],this);const l=a.time.displayFormats,c=this._unit,d=this._majorUnit,h=c&&l[c],p=d&&l[d],x=r[t],v=d&&p&&x&&x.major;return this._adapter.format(e,s||(v?p:h))}generateTickLabels(e){let t,r,s;for(t=0,r=e.length;t<r;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,s=bl(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(s),o=Math.sin(s),l=this._resolveTickFontOptions(0).size;return{w:r*a+l*o,h:r*o+l*a}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,s=r[t.unit]||r.millisecond,a=this._tickFormatFunction(e,0,qL(this,[e],this._majorUnit),s),o=this._getLabelSize(a),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,r=s.length;t<r;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const s=this.getLabels();for(t=0,r=s.length;t<r;++t)e.push(RL(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return h6(e.sort(AL))}}function Kg(n,e,t){let r=0,s=n.length-1,a,o,l,c;t?(e>=n[r].pos&&e<=n[s].pos&&({lo:r,hi:s}=su(n,"pos",e)),{pos:a,time:l}=n[r],{pos:o,time:c}=n[s]):(e>=n[r].time&&e<=n[s].time&&({lo:r,hi:s}=su(n,"time",e)),{time:a,pos:l}=n[r],{time:o,pos:c}=n[s]);const d=o-a;return d?l+(c-l)*(e-a)/d:l}class zhe extends zL{static id="timeseries";static defaults=zL.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Kg(t,this.min),this._tableRange=Kg(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,s=[],a=[];let o,l,c,d,h;for(o=0,l=e.length;o<l;++o)d=e[o],d>=t&&d<=r&&s.push(d);if(s.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(o=0,l=s.length;o<l;++o)h=s[o+1],c=s[o-1],d=s[o],Math.round((h+c)/2)!==d&&a.push({time:d,pos:o/(l-1)});return a}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(t)||r.length===1)&&r.push(t),r.sort((s,a)=>s-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Kg(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return Kg(this._table,r*this._tableRange+this._minPos,!0)}}Iy.register(Lae,yle,nce,ice,zae,Ay,fle,qae,nle,Qle,Wle,Fle);const UL=({title:n,icon:e,children:t})=>i.jsxs("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card col-span-1",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(e,{className:"h-5 w-5 mr-3 text-muted"}),i.jsx("h3",{className:"font-semibold text-primary-text",children:n})]}),i.jsx("div",{className:"h-64 md:h-80 relative",children:t})]}),cce=({data:n})=>{const e=E.useRef(null),t=E.useRef(null);return E.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const r=e.current.getContext("2d");r&&(t.current=new Iy(r,{type:"bar",data:{labels:n.labels,datasets:[{label:"Present",data:n.present,backgroundColor:"#005D22",borderColor:"#004218",borderWidth:1,borderRadius:4},{label:"Absent",data:n.absent,backgroundColor:"#EF4444",borderColor:"#DC2626",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}}))}return()=>{t.current&&t.current.destroy()}},[n]),i.jsx("div",{className:"h-full w-full flex flex-col",children:i.jsx("div",{className:"flex-grow relative",children:i.jsx("canvas",{ref:e})})})},dce=({data:n})=>{const e=E.useRef(null),t=E.useRef(null);return E.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const r=e.current.getContext("2d");if(r){const s=r.createLinearGradient(0,0,0,200);s.addColorStop(0,"rgba(0, 93, 34, 0.4)"),s.addColorStop(1,"rgba(0, 93, 34, 0)"),t.current=new Iy(r,{type:"line",data:{labels:n.labels,datasets:[{label:"Average Hours Worked",data:n.hours,borderColor:"#005D22",backgroundColor:s,fill:!0,tension:.4,pointBackgroundColor:"#005D22",pointRadius:0,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"},ticks:{stepSize:1,precision:0,callback:a=>{const o=typeof a=="string"?parseFloat(a):a;return Math.round(o)}}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}})}}return()=>{t.current&&t.current.destroy()}},[n]),i.jsx("div",{className:"h-full w-full flex flex-col",children:i.jsx("div",{className:"flex-grow relative",children:i.jsx("canvas",{ref:e})})})},uce=({data:n,dateRange:e})=>i.jsxs("div",{className:"p-8 font-sans text-sm text-black bg-white",children:[i.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-6",children:[i.jsx(Zi,{className:"h-10",localPath:DC}),i.jsxs("div",{className:"text-right",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Attendance Log"}),i.jsxs("p",{className:"text-gray-600",children:[$e(e.startDate,"dd MMM yyyy")," to ",$e(e.endDate,"dd MMM yyyy")]})]})]}),i.jsxs("table",{className:"w-full mt-6 text-left border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"p-2 border border-gray-300",children:"User"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Date"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Time"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Event"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Location"})]})}),i.jsx("tbody",{children:n.map((t,r)=>i.jsxs("tr",{className:"border-b",children:[i.jsx("td",{className:"p-2 border border-gray-300",children:t.userName}),i.jsx("td",{className:"p-2 border border-gray-300",children:t.date}),i.jsx("td",{className:"p-2 border border-gray-300",children:t.time}),i.jsx("td",{className:"p-2 border border-gray-300 capitalize",children:t.type.replace("-"," ")}),i.jsx("td",{className:"p-2 border border-gray-300",children:t.locationName||(t.latitude?`${t.latitude?.toFixed(4)}, ${t.longitude?.toFixed(4)}`:"N/A")})]},`${t.userName}-${t.date}-${t.time}-${r}`))})]})]}),fce=({data:n,dateRange:e})=>{const r=[];for(let s=0;s<n.length;s+=15)r.push(n.slice(s,s+15));return r.length===0?null:i.jsx("div",{children:r.map((s,a)=>{const o=15-s.length,l=a===r.length-1;return i.jsxs("div",{style:{padding:a===0?"40px":"0px 40px 40px 40px",paddingTop:a===0?"40px":"0px",marginTop:a===0?"0px":"-40px",fontFamily:'"Courier New", Courier, monospace',fontSize:"14px",color:"#000",backgroundColor:"#fff",width:"1123px",height:"794px",boxSizing:"border-box",letterSpacing:"0.5px",pageBreakAfter:l?"auto":"always",position:"relative",display:"flex",flexDirection:"column"},children:[i.jsx("table",{style:{width:"100%",borderBottom:"2px solid #000",marginBottom:"16px",paddingBottom:"8px"},children:i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{style:{width:"50%",verticalAlign:"top",textAlign:"left"},children:i.jsx(Zi,{className:"h-14",localPath:DC})}),i.jsxs("td",{style:{width:"50%",verticalAlign:"top",textAlign:"right"},children:[i.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"1px"},children:"Basic Attendance Report"}),i.jsxs("div",{style:{fontSize:"12px",color:"#333",marginBottom:"4px"},children:[$e(e.startDate,"dd MMM yyyy")," -"," ",$e(e.endDate,"dd MMM yyyy")]}),i.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["Generated: ",$e(new Date,"dd MMM yyyy HH:mm")]})]})]})})}),i.jsx("div",{style:{flexGrow:1},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #000",tableLayout:"fixed"},children:[i.jsx("thead",{style:{display:"table-header-group"},children:i.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"28%",fontSize:"11px",fontWeight:"bold"},children:"Employee Name"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Date"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Status"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check In"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check Out"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"15%",fontSize:"11px",fontWeight:"bold"},children:"Hours"})]})}),i.jsxs("tbody",{children:[s.map((c,d)=>i.jsxs("tr",{style:{backgroundColor:d%2===0?"#fff":"#fafafa"},children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle",wordWrap:"break-word",whiteSpace:"normal",lineHeight:"1.4"},children:c.userName}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:$e(new Date(String(c.date).replace(/-/g,"/")),"dd MMM yyyy")}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.status}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.checkIn||"-"}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.checkOut||"-"}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.duration||"-"})]},`${c.userName}-${c.date}-${d}`)),Array.from({length:o}).map((c,d)=>i.jsxs("tr",{style:{backgroundColor:"#fff"},children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",height:"33px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""})]},`empty-${d}`))]})]})}),i.jsxs("div",{style:{marginTop:"10px",borderTop:"1px solid #ccc",paddingTop:"8px",textAlign:"center",fontSize:"10px",color:"#888"},children:["Paradigm Services - Confidential Report - Page ",a+1," of ",r.length]})]},a)})})},hce=({data:n,dateRange:e})=>{const t=xo({start:e.startDate,end:e.endDate});return i.jsxs("div",{className:"p-8 font-sans text-[9px] text-black bg-white",children:[i.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-4",children:[i.jsx(Zi,{className:"h-8",localPath:DC}),i.jsxs("div",{className:"text-right",children:[i.jsx("h1",{className:"text-lg font-bold",children:"Monthly Attendance Report"}),i.jsxs("p",{className:"text-gray-600",children:[$e(e.startDate,"dd MMM yyyy")," to ",$e(e.endDate,"dd MMM yyyy")]})]})]}),i.jsxs("table",{className:"w-full border-collapse border border-gray-400 text-center",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-200 font-bold",children:[i.jsx("td",{className:"border p-1 border-gray-400 text-left",children:"Employee Name"}),t.map((r,s)=>i.jsx("td",{className:"border p-1 border-gray-400",children:$e(r,"d")},s)),i.jsx("td",{className:"border p-1 border-gray-400",children:"P"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"1/2P"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"A"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"WO"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"H"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"WOP"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"HP"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"Total"})]})}),i.jsx("tbody",{children:n.map((r,s)=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1 border-gray-400 text-left",children:r.userName}),r.statuses.map((a,o)=>i.jsx("td",{className:"border p-1 border-gray-400",children:a},o)),i.jsx("td",{className:"border p-1 border-gray-400",children:r.presentDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.halfDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.absentDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.weekOffs}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.holidays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.weekendPresents}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.holidayPresents}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.totalPayableDays})]},s))})]})]})},mce=()=>{const n=Ft("(max-width: 639px)"),{user:e}=jt(),{permissions:t}=Ji(),{recurringHolidays:r}=gi(),[s,a]=E.useState([]),[o,l]=E.useState([]),[c,d]=E.useState(null),[h,p]=E.useState(!0),[x,v]=E.useState({startDate:sx(),endDate:cb(),key:"selection"}),w=E.useMemo(()=>[x],[x]),[_,j]=E.useState("Today"),[T,P]=E.useState(!1),D=E.useRef(null),[M,O]=E.useState("all"),[I,q]=E.useState("all"),[F,V]=E.useState("all"),[U,W]=E.useState("basic"),[$,ne]=E.useState(!1),[Y,ae]=E.useState(null),[J,ee]=E.useState({}),X=E.useRef(null),Z=e&&t[e.role]?.includes("download_attendance_report"),H=!(e&&t[e.role]?.includes("view_all_attendance")),[Q,re]=E.useState({present:0,absent:0,ot:0,compOff:0}),[de,ce]=E.useState([]);E.useEffect(()=>{const we=Ne=>{D.current&&!D.current.contains(Ne.target)&&P(!1)};return document.addEventListener("mousedown",we),()=>document.removeEventListener("mousedown",we)},[]),E.useEffect(()=>{Z&&ue.getUsers().then(a)},[Z]),E.useEffect(()=>{(async()=>{if(!(!H||!e||!x.startDate||!x.endDate)){p(!0);try{const Ne=hf(x.startDate,7),Ue=Ne.toISOString(),Be=x.endDate.toISOString(),[qe,te]=await Promise.all([ue.getAttendanceEvents(e.id,Ue,Be),ue.getCompOffLogs(e.id)]);let ye=xo({start:Ne,end:x.endDate}).map(tt=>{const qt=$e(tt,"yyyy-MM-dd"),bt=qe.filter(an=>$e(new Date(an.timestamp),"yyyy-MM-dd")===qt);let Et="Absent",Xt="-",en="-",Yt=0;const Ut=$e(tt,"EEEE"),Rn=Ut==="Sunday";if(r.some(an=>{if(an.day.toLowerCase()!==Ut.toLowerCase())return!1;const rr=Math.ceil(tt.getDate()/7),Hn=e.role==="field_officer"?"field":"office";return an.n===rr&&(an.type||"office")===Hn})?Et="Holiday":Rn&&(Et="Weekend"),bt.length>0){Et="Present",bt.sort((Hn,lt)=>new Date(Hn.timestamp).getTime()-new Date(lt.timestamp).getTime());const an=bt.find(Hn=>Hn.type==="check-in"),rr=[...bt].reverse().find(Hn=>Hn.type==="check-out");if(an&&(Xt=$e(new Date(an.timestamp),"hh:mm a")),rr&&(en=$e(new Date(rr.timestamp),"hh:mm a"),an)){const lt=ff(new Date(rr.timestamp),new Date(an.timestamp))/60;lt>8&&(Yt=Math.round((lt-8)*10)/10)}}return{rawDate:tt,date:$e(tt,"dd MMM, yyyy"),day:Ut,checkIn:Xt,checkOut:en,status:Et,ot:Yt}});ye.forEach((tt,qt)=>{if(tt.status==="Weekend"&&tt.day==="Sunday"){let bt=0;const Et=Math.max(0,qt-6);for(let Xt=qt-1;Xt>=Et;Xt--)ye[Xt].status==="Absent"&&bt++;bt>=4&&(tt.status="Absent")}});const Ve=ye.filter(tt=>tt.rawDate>=x.startDate),ze=Ve.filter(tt=>tt.status==="Present").length,Le=Ve.filter(tt=>tt.status==="Absent"&&tt.rawDate<=new Date).length,rt=Ve.reduce((tt,qt)=>tt+qt.ot,0),Xe=te.filter(tt=>{const qt=new Date(tt.dateEarned);return qt>=x.startDate&&qt<=x.endDate&&tt.status==="earned"}).length;re({present:ze,absent:Le,ot:Math.round(rt*10)/10,compOff:Xe}),ce(Ve.reverse())}catch(Ne){console.error("Failed to fetch employee attendance",Ne)}finally{p(!1)}}})()},[H,e,x,r]);const pe=E.useCallback(async(we,Ne)=>{p(!0);try{let Ue=s;Ue.length===0&&(Ue=await ue.getUsers(),a(Ue));const Be=new Date,qe=we<Be?we:sx(),te=Ne>Be?Ne:cb(),[le,ye]=await Promise.all([ue.getAllAttendanceEvents(qe.toISOString(),te.toISOString()),ue.getLeaveRequests({startDate:qe.toISOString(),endDate:te.toISOString(),status:"approved"})]);l(le);const Ve=$e(Be,"yyyy-MM-dd"),ze=le.filter(Ut=>$e(new Date(Ut.timestamp),"yyyy-MM-dd")===Ve),Le=new Set(ze.map(Ut=>Ut.userId)).size,rt=ye.filter(Ut=>{const Rn=new Date(Ut.startDate),Nn=new Date(Ut.endDate);return Be>=Rn&&Be<=Nn}),Xe=new Set(rt.map(Ut=>Ut.userId)).size,tt=Ue.length,qt=Math.max(0,tt-Le-Xe),bt=xo({start:we,end:Ne}),Et=bt.map(Ut=>$e(Ut,"dd MMM")),Xt=[],en=[],Yt=[];bt.forEach(Ut=>{const Rn=$e(Ut,"yyyy-MM-dd"),Nn=le.filter(vn=>$e(new Date(vn.timestamp),"yyyy-MM-dd")===Rn),an=new Set(Nn.map(vn=>vn.userId)).size,rr=ye.filter(vn=>{const us=new Date(vn.startDate),Ks=new Date(vn.endDate);return Ut>=us&&Ut<=Ks}),Hn=new Set(rr.map(vn=>vn.userId)).size,lt=Math.max(0,tt-an-Hn);Xt.push(an),en.push(lt);let Vn=0;const br={};Nn.forEach(vn=>{br[vn.userId]||(br[vn.userId]=[]),br[vn.userId].push(vn)}),Object.values(br).forEach(vn=>{vn.sort((Gr,Xi)=>new Date(Gr.timestamp).getTime()-new Date(Xi.timestamp).getTime());const us=vn.find(Gr=>Gr.type==="check-in"),Ks=[...vn].reverse().find(Gr=>Gr.type==="check-out");if(us&&Ks){const Gr=ff(new Date(Ks.timestamp),new Date(us.timestamp));Vn+=Gr/60}}),Yt.push(an>0?parseFloat((Vn/an).toFixed(1)):0)}),d({totalEmployees:tt,presentToday:Le,absentToday:qt,onLeaveToday:Xe,attendanceTrend:{labels:Et,present:Xt,absent:en},productivityTrend:{labels:Et,hours:Yt}})}catch(Ue){console.error("Failed to load dashboard data",Ue)}finally{p(!1)}},[s]);E.useEffect(()=>{x.startDate&&x.endDate&&pe(x.startDate,x.endDate)},[x,pe]),E.useEffect(()=>{if(U!=="log"||!x.startDate||!x.endDate)return;const we=Ue=>parseFloat(Ue.toFixed(6));(async()=>{const Ue=M==="all"?s:s.filter(le=>le.id===M),Be=new Set(Ue.map(le=>le.id)),qe=o.filter(le=>{if(!Be.has(le.userId)||new Date(le.timestamp)<x.startDate||new Date(le.timestamp)>x.endDate||le.locationName||!le.latitude||!le.longitude)return!1;const ye=`${we(le.latitude)},${we(le.longitude)}`;return!J[ye]});if(console.log("Geocoding: Events to process:",qe.length),qe.length===0)return;const te=qe.map(le=>({lat:le.latitude,lon:le.longitude}));console.log("Geocoding: Fetching addresses for",te.length,"unique coordinates");try{const le=await ue.batchResolveAddresses(te);console.log("Geocoding: Resolved addresses:",Object.keys(le).length),ee(ye=>({...ye,...le}))}catch(le){console.error("Batch geocoding failed:",le)}})()},[o,x,M,U,s]);const ie=we=>{j(we);const Ne=new Date;let Ue=sx(),Be=cb();we==="This Month"?(Ue=pi(Ne),Be=Ta(Ne)):we==="This Year"?(Ue=xF(Ne),Be=eW(Ne)):we==="Last 7 Days"?Ue=hf(Ne,6):we==="Last 30 Days"&&(Ue=hf(Ne,29)),Be>Ne&&(Be=Ne),v({startDate:Ue,endDate:Be,key:"selection"})},xe=we=>{v(we.selection),j("Custom"),P(!1)},Ce=E.useMemo(()=>{const we=x.endDate,Ne=new Date;return $e(we,"yyyy-MM-dd")===$e(Ne,"yyyy-MM-dd")?"Today":`on ${$e(we,"MMM d")}`},[x]),ve=E.useMemo(()=>{if(!x.startDate||!x.endDate)return[];const we=[],Ne=xo({start:x.startDate,end:x.endDate});(M==="all"?s:s.filter(qe=>qe.id===M)).forEach(qe=>{Ne.forEach(te=>{const le=$e(te,"yyyy-MM-dd"),ye=o.filter(bt=>bt.userId===qe.id&&$e(new Date(bt.timestamp),"yyyy-MM-dd")===le);let Ve="Absent",ze="",Le="",rt="";const Xe=$e(te,"EEEE"),tt=Xe==="Sunday";if(r.some(bt=>{if(bt.day.toLowerCase()!==Xe.toLowerCase())return!1;const Et=te.getDate(),Xt=Math.ceil(Et/7),en=qe.role==="field_staff"?"field":"office",Yt=bt.type||"office";return bt.n===Xt&&Yt===en})?Ve="Holiday":tt&&(Ve="Weekend"),ye.length>0){const bt=[...ye].sort((en,Yt)=>new Date(en.timestamp).getTime()-new Date(Yt.timestamp).getTime()),Et=bt.find(en=>en.type==="check-in"),Xt=[...bt].reverse().find(en=>en.type==="check-out");if(Et&&(Ve="Present",ze=$e(new Date(Et.timestamp),"HH:mm")),Xt&&(Le=$e(new Date(Xt.timestamp),"HH:mm")),Et&&Xt){const en=new Date(Et.timestamp),Yt=new Date(Xt.timestamp),Ut=ff(Yt,en),Rn=Math.floor(Ut/60),Nn=Ut%60;rt=`${Rn}h ${Nn}m`}}we.push({userName:qe.name,date:le,status:Ve,checkIn:ze,checkOut:Le,duration:rt})})});let Be=I==="all"?we:we.filter(qe=>qe.status===I);return F!=="all"&&(Be=Be.filter(qe=>{const te=qe.checkIn&&qe.checkIn!=="-"&&qe.checkIn!=="",le=qe.checkOut&&qe.checkOut!=="-"&&qe.checkOut!=="";switch(F){case"complete":return te&&le;case"missing_checkout":return te&&!le;case"missing_checkin":return!te&&le;case"incomplete":return!te||!le;default:return!0}})),Be},[s,o,x,M,I,F,r]),Oe=E.useMemo(()=>{if(!x.startDate||!x.endDate)return[];const we=Be=>parseFloat(Be.toFixed(6)),Ne=M==="all"?s:s.filter(Be=>Be.id===M),Ue=new Set(Ne.map(Be=>Be.id));return o.filter(Be=>Ue.has(Be.userId)).map(Be=>{const qe=s.find(ye=>ye.id===Be.userId),te=Be.latitude&&Be.longitude?`${we(Be.latitude)},${we(Be.longitude)}`:"",le=J[te];return{userName:qe?.name||"Unknown",date:$e(new Date(Be.timestamp),"yyyy-MM-dd"),time:$e(new Date(Be.timestamp),"HH:mm:ss"),type:Be.type,locationName:Be.locationName||le||(Be.latitude?`${Be.latitude.toFixed(4)}, ${Be.longitude.toFixed(4)}`:"N/A"),latitude:Be.latitude,longitude:Be.longitude}}).sort((Be,qe)=>Be.date!==qe.date?Be.date.localeCompare(qe.date):Be.time.localeCompare(qe.time))},[s,o,x,M,J]),Pe=E.useMemo(()=>{if(!x.startDate||!x.endDate)return[];const we=xo({start:x.startDate,end:x.endDate});return(M==="all"?s:s.filter(Ue=>Ue.id===M)).map(Ue=>{const Be=[];let qe=0,te=0,le=0,ye=0,Ve=0,ze=0,Le=0;we.forEach(Xe=>{const tt=$e(Xe,"yyyy-MM-dd"),bt=o.filter(Ut=>Ut.userId===Ue.id&&$e(new Date(Ut.timestamp),"yyyy-MM-dd")===tt).some(Ut=>Ut.type==="check-in"),Et=$e(Xe,"EEEE"),Xt=Et==="Sunday",en=r.some(Ut=>{if(Ut.day.toLowerCase()!==Et.toLowerCase())return!1;const Rn=Xe.getDate(),Nn=Math.ceil(Rn/7),an=Ue.role==="field_staff"?"field":"office",rr=Ut.type||"office";return Ut.n===Nn&&rr===an});let Yt="";bt?en?(Yt="HP",Le++):Xt?(Yt="WOP",ze++):(Yt="P",qe++):en?(Yt="H",Ve++):Xt?(Yt="WO",ye++):(Yt="A",te++),Be.push(Yt)});const rt=qe+ye+Ve+ze+Le+le*.5;return{userName:Ue.name,statuses:Be,presentDays:qe,absentDays:te,halfDays:le,weekOffs:ye,holidays:Ve,weekendPresents:ze,holidayPresents:Le,totalPayableDays:rt}})},[s,o,x,M,r]),Ie=E.useMemo(()=>U==="basic"?i.jsx(fce,{data:ve,dateRange:x}):U==="log"?i.jsx(uce,{data:Oe,dateRange:x}):U==="monthly"?i.jsx(hce,{data:Pe,dateRange:x}):null,[U,ve,Oe,Pe,x]),Fe=()=>{ne(!0);try{let we="data:text/csv;charset=utf-8,",Ne=`Attendance_Report_${$e(new Date,"yyyy-MM-dd")}.csv`;if(U==="basic")we+=`Employee Name,Date,Status,Check In,Check Out,Hours
`,ve.forEach(qe=>{we+=`"${qe.userName}","${qe.date}","${qe.status}","${qe.checkIn}","${qe.checkOut}","${qe.duration}"
`});else if(U==="log")we+=`User,Date,Time,Event,Location,Latitude,Longitude
`,Oe.forEach(qe=>{we+=`"${qe.userName}","${qe.date}","${qe.time}","${qe.type}","${qe.locationName||""}","${qe.latitude||""}","${qe.longitude||""}"
`});else if(U==="monthly"){const te=xo({start:x.startDate,end:x.endDate}).map(le=>$e(le,"dd MMM")).join(",");we+=`Employee Name,${te},Present,Absent,Half Days,Week Offs,Holidays,Weekend Presents,Holiday Presents,Total Payable Days
`,Pe.forEach(le=>{const ye=le.statuses.join(",");we+=`"${le.userName}",${ye},"${le.presentDays}","${le.absentDays}","${le.halfDays}","${le.weekOffs}","${le.holidays}","${le.weekendPresents}","${le.holidayPresents}","${le.totalPayableDays}"
`})}const Ue=encodeURI(we),Be=document.createElement("a");Be.setAttribute("href",Ue),Be.setAttribute("download",Ne),document.body.appendChild(Be),Be.click(),document.body.removeChild(Be),ae({message:"CSV downloaded successfully.",type:"success"})}catch(we){console.error("CSV generation failed:",we),ae({message:"Failed to generate CSV.",type:"error"})}finally{ne(!1)}};return h&&!c&&!H?i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):H?i.jsxs("div",{className:"p-4 space-y-6 pb-24 md:bg-transparent bg-[#041b0f]",children:[i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Attendance"}),i.jsxs("div",{className:"bg-card p-3 rounded-xl shadow-sm border border-border flex flex-wrap items-center gap-2",children:[["Today","This Month","Last 30 Days"].map(we=>i.jsx(se,{type:"button",variant:_===we?"primary":"outline",onClick:()=>ie(we),className:_===we?"text-white shadow-md border":"bg-card text-primary-text border border-border hover:bg-accent-light",style:_===we?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},children:we},we)),i.jsxs("div",{className:"relative",ref:D,children:[i.jsxs(se,{type:"button",variant:_==="Custom"?"primary":"outline",onClick:()=>P(!T),className:_==="Custom"?"text-white shadow-md border":"bg-card text-primary-text border border-border hover:bg-accent-light",style:_==="Custom"?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},children:[i.jsx(Pa,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:_==="Custom"?`${$e(x.startDate,"dd MMM")} - ${$e(x.endDate,"dd MMM")}`:"Custom"})]}),T&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-50 bg-white dark:bg-gray-950 border border-border rounded-lg shadow-xl w-[300px] sm:w-auto overflow-hidden",children:i.jsx("div",{className:"text-gray-900",children:i.jsx(bm.DateRangePicker,{onChange:xe,months:1,ranges:w,direction:"horizontal",maxDate:new Date})})})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-emerald-600 text-white rounded-full mb-3 shadow-lg shadow-emerald-200 dark:shadow-none",children:i.jsx(hu,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Present"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:Q.present})]}),i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-rose-600 text-white rounded-full mb-3 shadow-lg shadow-rose-200 dark:shadow-none",children:i.jsx(Dx,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Absent"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:Q.absent})]}),i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-blue-600 text-white rounded-full mb-3 shadow-lg shadow-blue-200 dark:shadow-none",children:i.jsx(Bc,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Overtime"}),i.jsxs("p",{className:"text-2xl font-bold text-primary-text",children:[Q.ot,"h"]})]}),i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-purple-600 text-white rounded-full mb-3 shadow-lg shadow-purple-200 dark:shadow-none",children:i.jsx(UM,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Comp Offs"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:Q.compOff})]})]}),i.jsxs("div",{className:"bg-card rounded-xl shadow-sm border border-border overflow-hidden",children:[i.jsx("div",{className:"p-4 border-b border-border font-semibold text-primary-text",children:"Attendance Logs"}),i.jsx("div",{className:"divide-y divide-border",children:h?i.jsx("div",{className:"p-8 text-center text-muted",children:i.jsx(_t,{className:"h-6 w-6 animate-spin mx-auto"})}):de.length===0?i.jsx("div",{className:"p-8 text-center text-muted",children:"No records found for this period."}):de.map((we,Ne)=>i.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-900/50 transition-colors",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-primary-text",children:we.date}),i.jsx("p",{className:"text-xs text-muted",children:we.day})]}),i.jsxs("div",{className:"flex flex-col items-end gap-1.5",children:[i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider shadow-sm
                                            ${we.status==="Present"?"bg-emerald-500 text-white dark:bg-emerald-600":we.status==="Absent"?"bg-rose-500 text-white dark:bg-rose-600":we.status==="Holiday"?"bg-amber-500 text-white dark:bg-amber-600":we.status==="Weekend"?"bg-indigo-500 text-white dark:bg-indigo-600":"bg-gray-500 text-white dark:bg-gray-600"}`,children:we.status}),(we.checkIn!=="-"||we.checkOut!=="-")&&i.jsxs("div",{className:"text-xs text-muted font-medium",children:[we.checkIn," - ",we.checkOut]}),we.ot>0&&i.jsxs("span",{className:"text-[10px] text-blue-600 dark:text-blue-400 font-bold",children:["+",we.ot,"h OT"]})]})]},Ne))})]})]}):i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Attendance Dashboard"})}),i.jsxs("div",{className:"hidden md:flex bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex-wrap items-end gap-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Today","Last 7 Days","This Month"].map(we=>i.jsx(se,{type:"button",onClick:()=>ie(we),className:_===we?"text-white shadow-md border":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50",style:_===we?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},children:we},we)),i.jsxs("div",{className:"relative",ref:D,children:[i.jsxs(se,{type:"button",variant:"outline",onClick:()=>P(!T),className:"hover:bg-gray-100",children:[i.jsx(Pa,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:_==="Custom"?`${$e(x.startDate,"dd MMM, yyyy")} - ${$e(x.endDate,"dd MMM, yyyy")}`:"Custom Range"})]}),T&&i.jsxs("div",{className:"absolute top-full left-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 p-3",children:[i.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:$e(x.startDate,"yyyy-MM-dd"),max:$e(new Date,"yyyy-MM-dd"),onChange:we=>{const Ne=new Date(we.target.value);let Ue=x.endDate;Ne>Ue&&(Ue=Ne),v({startDate:Ne,endDate:Ue,key:"selection"}),j("Custom")}}),i.jsx("span",{className:"text-sm",children:"to"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:$e(x.endDate,"yyyy-MM-dd"),max:$e(new Date,"yyyy-MM-dd"),onChange:we=>{const Ne=new Date(we.target.value);let Ue=x.startDate;Ne<Ue&&(Ue=Ne),v({startDate:Ue,endDate:Ne,key:"selection"}),j("Custom")}})]}),i.jsx(bm.DateRangePicker,{onChange:xe,months:n?1:2,ranges:w,direction:"horizontal",maxDate:new Date})]})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Report Type"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none",value:U,onChange:we=>W(we.target.value),children:[i.jsx("option",{value:"basic",children:"Basic Report"}),i.jsx("option",{value:"log",children:"Attendance Log"}),i.jsx("option",{value:"monthly",children:"Monthly Report"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Employee"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none max-w-[200px]",value:M,onChange:we=>O(we.target.value),children:[i.jsx("option",{value:"all",children:"All Employees"}),s.map(we=>i.jsx("option",{value:we.id,children:we.name},we.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Status"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none max-w-[200px]",value:I,onChange:we=>q(we.target.value),children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"Present",children:"Present"}),i.jsx("option",{value:"Half Day",children:"Half Day"}),i.jsx("option",{value:"Absent",children:"Absent"}),i.jsx("option",{value:"On Leave (Full)",children:"On Leave (Full)"}),i.jsx("option",{value:"On Leave (Half)",children:"On Leave (Half)"}),i.jsx("option",{value:"Holiday",children:"Holiday"}),i.jsx("option",{value:"Weekend",children:"Weekend"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Record Type"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none max-w-[200px]",value:F,onChange:we=>V(we.target.value),children:[i.jsx("option",{value:"all",children:"All Records"}),i.jsx("option",{value:"complete",children:"Complete (Check-in & Check-out)"}),i.jsx("option",{value:"missing_checkout",children:"Missing Check-out"}),i.jsx("option",{value:"missing_checkin",children:"Missing Check-in"}),i.jsx("option",{value:"incomplete",children:"Incomplete (Any Missing)"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(_o,{title:"Total Employees",value:c?.totalEmployees||0,icon:Gi}),i.jsx(_o,{title:`Present ${Ce}`,value:c?.presentToday||0,icon:hu}),i.jsx(_o,{title:`Absent ${Ce}`,value:c?.absentToday||0,icon:Dx}),i.jsx(_o,{title:`On Leave ${Ce}`,value:c?.onLeaveToday||0,icon:Bc})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx(UL,{title:"Attendance Trend",icon:tJ,children:c?i.jsx(cce,{data:c.attendanceTrend}):i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})}),i.jsx(UL,{title:"Productivity Trend (Avg. Hours)",icon:UM,children:c?i.jsx(dce,{data:c.productivityTrend}):i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})})]}),i.jsx("div",{style:{position:"fixed",top:"0",left:"0",width:"1123px",zIndex:-1e3,opacity:0,pointerEvents:"none"},children:i.jsx("div",{ref:X,className:"w-full bg-white",children:Ie})}),i.jsxs("div",{className:"hidden md:block bg-white p-6 rounded-xl shadow-sm border border-gray-100 overflow-auto max-h-[600px]",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold",children:"Report Preview"}),Z&&i.jsxs(se,{type:"button",onClick:Fe,disabled:$,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[$?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(s3,{className:"mr-2 h-4 w-4"}),$?"Generating...":"Download CSV"]})]}),i.jsx("div",{className:"border p-4 rounded bg-gray-50",children:Ie})]}),Y&&i.jsx(ht,{message:Y.message,type:Y.type,onDismiss:()=>ae(null)})]})},pce=n=>n.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),gce=(n,e,t,r)=>{const a=n*Math.PI/180,o=t*Math.PI/180,l=(t-n)*Math.PI/180,c=(r-e)*Math.PI/180,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},xce=()=>{const{user:n}=jt(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState(!0),[l,c]=E.useState(!1),[d,h]=E.useState(null),[p,x]=E.useState(""),[v,w]=E.useState(""),[_,j]=E.useState(""),[T,P]=E.useState(""),[D,M]=E.useState(null),[O,I]=E.useState([]),[q,F]=E.useState(!1),[V,U]=E.useState(""),W=n&&["admin","hr"].includes(n.role);E.useEffect(()=>{(async()=>{if(n)try{const[Q,re]=await Promise.all([ue.getUserLocations(n.id),ue.getLocations()]);t(Q),s(re)}catch(Q){console.error(Q),h({message:"Failed to load locations.",type:"error"})}finally{o(!1)}})()},[n]);const $=H=>{const Q=H.target.value,re=pce(Q);x(re)},ne=async()=>{c(!0);try{const H=await iy().catch(()=>null);let Q,re;if(H&&H.coords&&(Q=H.coords.latitude,re=H.coords.longitude),Q===void 0||re===void 0){const de=await new Promise(ce=>{navigator.geolocation.getCurrentPosition(pe=>ce(pe),()=>ce(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})});de&&de.coords&&(Q=de.coords.latitude,re=de.coords.longitude)}if(Q===void 0||re===void 0)throw new Error("Unable to retrieve current location.");w(Q.toString()),j(re.toString());try{const de=await hm(Q,re);P(de)}catch(de){console.warn("Reverse geocode failed:",de)}h({message:"Coordinates and address filled. Please enter a location name.",type:"success"})}catch(H){console.error(H),h({message:H.message||"Failed to get current location.",type:"error"})}finally{c(!1)}},Y=async()=>{if(!n||O.length===0){h({message:"Please select at least one location.",type:"error"});return}F(!0);try{await Promise.all(O.map(Q=>ue.assignLocationToUser(n.id,Q))),h({message:"Locations assigned successfully!",type:"success"}),I([]);const H=await ue.getUserLocations(n.id);t(H)}catch(H){console.error(H),h({message:H.message||"Failed to assign locations.",type:"error"})}finally{F(!1)}},ae=H=>{I(Q=>Q.includes(H)?Q.filter(re=>re!==H):[...Q,H])},J=async()=>{if(!n)return;if(!D&&!W){h({message:"You do not have permission to add locations.",type:"error"});return}if(!p.trim()){h({message:"Please enter a location name.",type:"error"});return}const H=parseFloat(v),Q=parseFloat(_);if(isNaN(H)||isNaN(Q)){h({message:"Please provide valid coordinates.",type:"error"});return}if(r.find(de=>de.id!==D&&de.name?.toLowerCase()===p.toLowerCase())){h({message:`Location "${p}" already exists. Please use a different name.`,type:"error"});return}if(!D&&r.find(ce=>gce(H,Q,ce.latitude,ce.longitude)<10)){h({message:"A location already exists at these coordinates.",type:"error"});return}c(!0);try{if(D)await ue.updateLocation(D,{name:p,latitude:H,longitude:Q,radius:100,address:T||null}),h({message:"Location updated successfully.",type:"success"});else{const ie=await ue.createLocation({name:p,latitude:H,longitude:Q,radius:100,address:T||null,createdBy:n.id});await ue.assignLocationToUser(n.id,ie.id),h({message:"Location added successfully.",type:"success"})}const[ce,pe]=await Promise.all([ue.getUserLocations(n.id),ue.getLocations()]);t(ce),s(pe),Z()}catch(de){console.error(de),h({message:de.message||"Failed to save location.",type:"error"})}finally{c(!1)}},ee=H=>{M(H.id),x(H.name||""),w(H.latitude.toString()),j(H.longitude.toString()),P(H.address||""),window.scrollTo({top:0,behavior:"smooth"})},X=async H=>{if(!n||!W){h({message:"You do not have permission to delete locations.",type:"error"});return}if(window.confirm("Are you sure you want to delete this location? It will be removed from all users."))try{await ue.deleteLocation(H),h({message:"Location deleted successfully.",type:"success"});const[Q,re]=await Promise.all([ue.getUserLocations(n.id),ue.getLocations()]);t(Q),s(re)}catch(Q){console.error(Q),h({message:Q.message||"Failed to delete location.",type:"error"})}},Z=()=>{x(""),w(""),j(""),P(""),M(null)},oe=e.filter((H,Q,re)=>H.address?Q===re.findIndex(de=>de.address===H.address):!0);return i.jsxs("div",{className:"p-4 md:p-6 w-full",children:[d&&i.jsx(ht,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center",children:[i.jsx(Tl,{className:"h-6 w-6 mr-2"})," My Locations"]}),i.jsxs("p",{className:"text-muted mb-6",children:["These are the geofenced locations assigned to you. You may check in/out only when within one of these locations. ",W?"Use the form below to add a new location.":"You can edit location names by clicking the edit button."]}),(W||D)&&i.jsxs("div",{className:"bg-gray-50 border border-border rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:D?"Edit Location":"Add New Location"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(je,{label:"Location Name (required) *",id:"locationName",value:p,onChange:$,placeholder:"e.g. Office HQ",required:!0}),i.jsx(je,{label:"Latitude",id:"latitude",type:"number",value:v,onChange:H=>w(H.target.value),placeholder:"12.9716",step:"any",disabled:D&&!W}),i.jsx(je,{label:"Longitude",id:"longitude",type:"number",value:_,onChange:H=>j(H.target.value),placeholder:"77.5946",step:"any",disabled:D&&!W}),i.jsx(je,{label:"Address (optional)",id:"address",value:T,onChange:H=>P(H.target.value),placeholder:"Street, City, State",disabled:D&&!W})]}),i.jsxs("div",{className:"flex gap-4 flex-wrap",children:[W&&i.jsxs(se,{onClick:ne,variant:"secondary",isLoading:l,disabled:l,children:[i.jsx(u3,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),i.jsx(se,{onClick:J,isLoading:l,disabled:l||!p.trim(),children:D?"Save Changes":"Add Location"}),D&&i.jsx(se,{onClick:Z,variant:"secondary",children:"Cancel"})]})]})]}),i.jsx("div",{className:"mt-6",children:a?i.jsx("p",{children:"Loading locations..."}):e.length===0?i.jsx("div",{children:W?i.jsx("p",{className:"text-muted text-center md:text-left",children:"No locations assigned. Use the form above to add one."}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Select Your Locations"}),i.jsx("p",{className:"text-sm text-blue-800 mb-4",children:"You don't have any locations assigned yet. Please select the locations where you'll be working from the list below."})]}),r.length===0?i.jsx("p",{className:"text-muted text-center",children:"No locations available. Contact your administrator."}):i.jsxs("div",{children:[i.jsx("div",{className:"mb-4",children:i.jsx(je,{type:"text",placeholder:"Search by name or address...",value:V,onChange:H=>U(H.target.value)})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:r.filter(H=>V===""||H.name?.toLowerCase().includes(V.toLowerCase())||H.address?.toLowerCase().includes(V.toLowerCase())).map(H=>i.jsx("div",{onClick:()=>ae(H.id),className:`border rounded-lg p-4 cursor-pointer transition-all ${O.includes(H.id)?"border-accent bg-accent/10 shadow-md":"border-border hover:border-accent/50 hover:bg-gray-50"}`,children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("input",{type:"checkbox",checked:O.includes(H.id),onChange:()=>{},className:"mt-1 mr-3 h-5 w-5 text-accent rounded focus:ring-accent"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:H.name||"Unnamed Location"}),i.jsx("button",{type:"button",onClick:Q=>{Q.stopPropagation(),ee(H)},className:"text-blue-600 hover:text-blue-800 p-1",title:"Edit Name",children:i.jsx(cr,{className:"h-4 w-4"})})]}),i.jsx("p",{className:"text-sm text-muted mt-1",children:H.address||"No address"}),i.jsxs("p",{className:"text-xs text-muted mt-2",children:["Coordinates: ",H.latitude.toFixed(4),", ",H.longitude.toFixed(4),"  Radius: ",H.radius,"m"]})]})]})},H.id))}),i.jsx("div",{className:"flex justify-center",children:i.jsx(se,{onClick:Y,isLoading:q,disabled:q||O.length===0,children:O.length===0?"Select Locations Above":`Assign ${O.length} Location${O.length>1?"s":""}`})})]})]})}):i.jsxs("div",{className:"space-y-4 md:space-y-0 md:grid md:grid-cols-1 md:gap-4",children:[i.jsx("div",{className:"md:hidden space-y-4",children:oe.map(H=>i.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-primary-text",children:H.name||H.address||"Unnamed Location"}),i.jsx("p",{className:"text-sm text-muted",children:H.address})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-500 hover:text-blue-700 p-1",title:W?"Edit Location":"Edit Name",onClick:()=>ee(H),children:i.jsx(cr,{className:"h-5 w-5"})}),W&&i.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 p-1",title:"Delete Location",onClick:()=>X(H.id),children:i.jsx(rn,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Radius"}),i.jsxs("p",{children:[H.radius,"m"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Coordinates"}),i.jsxs("p",{children:[H.latitude?.toFixed(4),", ",H.longitude?.toFixed(4)]})]})]})]},H.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[i.jsx("thead",{className:"bg-page text-primary-text",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),i.jsx("tbody",{children:oe.map(H=>i.jsxs("tr",{className:"border-b border-border",children:[i.jsx("td",{className:"p-3",children:H.name||"-"}),i.jsx("td",{className:"p-3",children:H.radius}),i.jsxs("td",{className:"p-3",children:[H.latitude?.toFixed(4),", ",H.longitude?.toFixed(4)]}),i.jsx("td",{className:"p-3",children:H.address||"-"}),i.jsxs("td",{className:"p-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-800",title:W?"Edit Location":"Edit Name",onClick:()=>ee(H),children:i.jsx(cr,{className:"h-4 w-4"})}),W&&i.jsx("button",{type:"button",className:"text-red-600 hover:text-red-800",title:"Delete Location",onClick:()=>X(H.id),children:i.jsx(rn,{className:"h-4 w-4"})})]})]},H.id))})]})})]})})]})},VL=()=>{const n=St(),e=ds(),{toggleCheckInStatus:t,isCheckedIn:r}=jt(),[s,a]=E.useState(!1),[o,l]=E.useState(null),c=e.pathname.includes("check-in"),d=c?"Check In":"Check Out",h=c?Ex:wo,p=c?"bg-emerald-100":"bg-red-100",x=c?"text-emerald-600":"text-red-600",v=async()=>{a(!0);const{success:_,message:j}=await t();l({message:j,type:_?"success":"error"}),a(!1),_&&setTimeout(()=>{n("/profile",{replace:!0})},1500)},w=()=>{n(-1)};return i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 relative",children:[o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)}),i.jsxs("div",{className:"w-full max-w-md bg-card rounded-2xl shadow-card p-8 text-center relative z-10",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:`p-4 rounded-full ${p}`,children:i.jsx(h,{className:`h-10 w-10 ${x}`})})}),i.jsx("h1",{className:"text-2xl font-bold text-primary-text mb-2",children:d}),i.jsxs("p",{className:"text-muted mb-8",children:["Are you sure you want to ",d.toLowerCase(),"?"]}),i.jsxs("div",{className:"flex flex-col gap-3",children:[i.jsxs(se,{onClick:v,variant:c?"primary":"danger",className:"w-full !py-3 !text-lg shadow-lg",isLoading:s,children:["Yes, ",d]}),i.jsx(se,{onClick:w,variant:"secondary",className:"w-full !py-3",disabled:s,children:"Cancel"})]})]})]})},yce=()=>{const{attendance:n,officeHolidays:e,fieldHolidays:t,recurringHolidays:r,addHoliday:s,removeHoliday:a,addRecurringHoliday:o,removeRecurringHoliday:l,updateAttendanceSettings:c}=gi(),[d,h]=E.useState(n),[p,x]=E.useState(!1),[v,w]=E.useState(!1),[_,j]=E.useState("office"),[T,P]=E.useState(""),[D,M]=E.useState(""),[O,I]=E.useState(3),[q,F]=E.useState("Saturday"),[V,U]=E.useState(null);E.useEffect(()=>{h(n)},[n]),E.useEffect(()=>{x(JSON.stringify(d)!==JSON.stringify(n))},[d,n]);const W=d[_],$=_==="office"?e:t,ne=async J=>{if(J.preventDefault(),T&&D){if($.some(ee=>ee.date===D)){U({message:"A holiday for this date already exists.",type:"error"});return}try{await s(_,{name:T,date:D}),P(""),M(""),U({message:"Holiday added successfully.",type:"success"})}catch{U({message:"Failed to add holiday.",type:"error"})}}else U({message:"Please provide both a name and a date.",type:"error"})},Y=(J,ee)=>{h(X=>({...X,[_]:{...X[_],[J]:ee}}))},ae=async()=>{w(!0);try{await ue.saveAttendanceSettings(d),c(d),U({message:"Attendance rules saved successfully!",type:"success"})}catch{U({message:"Failed to save attendance rules.",type:"error"})}finally{w(!1)}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full pb-40",children:[V&&i.jsx(ht,{message:V.message,type:V.type,onDismiss:()=>U(null)}),i.jsx(Qi,{title:"Attendance & Leave Rules",children:i.jsxs(se,{onClick:ae,isLoading:v,disabled:!p,children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),i.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Set company-wide rules for attendance and leave calculation."}),i.jsx("div",{className:"mb-6 border-b border-border",children:i.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[i.jsx("button",{onClick:()=>j("office"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${_==="office"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Office Staff"}),i.jsx("button",{onClick:()=>j("field"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${_==="field"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Field Staff"})]})}),_==="office"&&i.jsx("p",{className:"text-sm text-muted -mt-4 mb-4",children:"These rules apply to Admin, HR, and Finance roles."}),_==="field"&&i.jsx("p",{className:"text-sm text-muted -mt-4 mb-4",children:"These rules apply to all other roles (e.g., Field Officers, Managers)."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Bc,{className:"mr-2 h-5 w-5 text-muted"}),"Work Hours"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx(je,{label:"Minimum Hours for Full Day",id:"minHoursFull",type:"number",value:W.minimumHoursFullDay,onChange:J=>Y("minimumHoursFullDay",parseFloat(J.target.value)||0)}),i.jsx(je,{label:"Minimum Hours for Half Day",id:"minHoursHalf",type:"number",value:W.minimumHoursHalfDay,onChange:J=>Y("minimumHoursHalfDay",parseFloat(J.target.value)||0)})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Mx,{className:"mr-2 h-5 w-5 text-muted"}),"Leave Allocation"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx(je,{label:"Annual Earned Leaves",id:"annualEarnedLeaves",type:"number",value:W.annualEarnedLeaves,onChange:J=>Y("annualEarnedLeaves",parseInt(J.target.value,10)||0)}),i.jsx(je,{label:"Annual Sick Leaves",id:"annualSickLeaves",type:"number",value:W.annualSickLeaves,onChange:J=>Y("annualSickLeaves",parseInt(J.target.value,10)||0)}),i.jsx(je,{label:"Monthly Floating Holidays",id:"monthlyFloatingLeaves",type:"number",value:W.monthlyFloatingLeaves,onChange:J=>Y("monthlyFloatingLeaves",parseInt(J.target.value,10)||0)}),i.jsx(je,{label:"Annual Compensatory Off",id:"annualCompOffLeaves",type:"number",value:W.annualCompOffLeaves,onChange:J=>Y("annualCompOffLeaves",parseInt(J.target.value,10)||0)}),i.jsx(je,{label:"Sick Leave Cert. After (Days)",id:"sickLeaveCertThreshold",type:"number",value:W.sickLeaveCertificateThreshold,onChange:J=>Y("sickLeaveCertificateThreshold",parseInt(J.target.value,10)||0),title:"Require a doctor's certificate if total sick leave taken exceeds this number of days."})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Pf,{className:"mr-2 h-5 w-5 text-muted"}),"Notifications"]}),i.jsx(Pn,{id:"attendance-notifications",label:"Enable Check-in/Check-out Notifications",description:"Send a notification to Site Managers, Ops Managers, and HR when a Field Officer checks in or out.",checked:W.enableAttendanceNotifications,onChange:J=>Y("enableAttendanceNotifications",J.target.checked)})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Pa,{className:"mr-2 h-5 w-5 text-muted"}),"Recurring Holidays"]}),i.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Add Recurring Holiday"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[i.jsxs(Ke,{label:"Occurrence",value:O,onChange:J=>I(parseInt(J.target.value)),children:[i.jsx("option",{value:1,children:"1st"}),i.jsx("option",{value:2,children:"2nd"}),i.jsx("option",{value:3,children:"3rd"}),i.jsx("option",{value:4,children:"4th"}),i.jsx("option",{value:5,children:"5th"})]}),i.jsxs(Ke,{label:"Day",value:q,onChange:J=>F(J.target.value),children:[i.jsx("option",{value:"Monday",children:"Monday"}),i.jsx("option",{value:"Tuesday",children:"Tuesday"}),i.jsx("option",{value:"Wednesday",children:"Wednesday"}),i.jsx("option",{value:"Thursday",children:"Thursday"}),i.jsx("option",{value:"Friday",children:"Friday"}),i.jsx("option",{value:"Saturday",children:"Saturday"}),i.jsx("option",{value:"Sunday",children:"Sunday"})]}),i.jsxs(se,{type:"button",onClick:async()=>{try{await o({day:q,n:O,type:_}),U({message:"Recurring holiday added successfully.",type:"success"})}catch{U({message:"Failed to add recurring holiday.",type:"error"})}},size:"sm",className:"w-full sm:w-auto",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Rule"]})]})]}),i.jsxs("div",{className:"mt-4 space-y-2",children:[r.filter(J=>(J.type||"office")===_).map((J,ee)=>i.jsxs("div",{className:"flex justify-between items-start p-4 pr-6 border border-white/10 rounded-lg bg-white/5 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("p",{className:"font-medium text-primary-text truncate",children:[J.n===1?"1st":J.n===2?"2nd":J.n===3?"3rd":J.n+"th"," ",J.day]}),i.jsx("p",{className:"text-sm text-muted",children:"Repeats every month"})]}),i.jsx("div",{className:"ml-4 shrink-0",children:i.jsx(se,{variant:"icon",onClick:async()=>{if(J.id)try{await l(J.id),U({message:"Recurring holiday removed successfully.",type:"success"})}catch{U({message:"Failed to remove recurring holiday.",type:"error"})}},className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})})]},J.id||ee)),r.filter(J=>(J.type||"office")===_).length===0&&i.jsx("p",{className:"text-center text-muted py-4",children:"No recurring holidays configured."})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Pa,{className:"mr-2 h-5 w-5 text-muted"}),"Holiday List"]}),i.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Add New Holiday"}),i.jsxs("form",{onSubmit:ne,className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[i.jsx(je,{label:"Holiday Name",id:"holidayName",value:T,onChange:J=>P(J.target.value)}),i.jsx(kn,{label:"Date",id:"holidayDate",value:D,onChange:M}),i.jsxs(se,{type:"submit",size:"sm",className:"w-full sm:w-auto",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add"]})]})]}),i.jsx("div",{className:"mt-4 space-y-2",children:$.length>0?$.map(J=>i.jsxs("div",{className:"flex justify-between items-start p-4 pr-6 border border-white/10 rounded-lg bg-white/5 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium text-primary-text truncate",children:J.name}),i.jsx("p",{className:"text-sm text-muted",children:new Date(J.date.replace(/-/g,"/")).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})})]}),i.jsx("div",{className:"ml-4 shrink-0",children:i.jsx(se,{variant:"icon",onClick:()=>a(_,J.id),"aria-label":`Remove ${J.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})})]},J.id)):i.jsxs("p",{className:"text-center text-muted py-4",children:["No holidays added yet for ",_," staff."]})})]})]})]})},vce=()=>{const{user:n}=jt(),{officeHolidays:e,fieldHolidays:t,attendance:r,recurringHolidays:s}=gi(),[a,o]=E.useState(new Date),[l,c]=E.useState([]),[d,h]=E.useState(!1),p=E.useMemo(()=>n?.role==="field_officer"?t:e,[n,t,e]),x=E.useMemo(()=>{const D=n?.role==="field_officer"?"field":"office";return s.filter(M=>(M.type||"office")===D)},[n,s]);E.useEffect(()=>{console.log("Active Recurring Rules:",x)},[x]);const v=E.useMemo(()=>{const D=[],M=pi(a),O=Ta(a),I=xo({start:M,end:O}),q=(n?.role==="field_officer"?r?.field?.monthlyFloatingLeaves:r?.office?.monthlyFloatingLeaves)??0;let F=0;return x.forEach(V=>{if(F>=q)return;let U=0;for(const W of I)if($e(W,"EEEE").toLowerCase()===V.day.toLowerCase()&&(U++,U===V.n)){D.push(W),F++;break}}),D},[a,x,r,n]);E.useEffect(()=>{console.log("Calculated Recurring Holiday Dates:",v)},[v]),E.useEffect(()=>{const D=async()=>{if(n){h(!0);try{const I=pi(a).toISOString(),q=Ta(a).toISOString(),F=await ue.getAttendanceEvents(n.id,I,q);c(F)}catch(I){console.error("Failed to fetch attendance events",I)}finally{h(!1)}}},M=async()=>{try{console.log("Fetching attendance settings...");const I=await ue.getAttendanceSettings();console.log("Fetched settings:",I),gi.getState().updateAttendanceSettings(I)}catch(I){console.error("Failed to fetch attendance settings",I)}},O=async()=>{try{console.log("Fetching recurring holidays...");const I=await ue.getRecurringHolidays();console.log("Fetched recurring holidays:",I),gi.setState({recurringHolidays:I})}catch(I){console.error("Failed to fetch recurring holidays",I)}};D(),M(),O()},[n,a]);const w=E.useMemo(()=>xo({start:pi(a),end:Ta(a)}),[a]),_=D=>{const M=l.some(F=>uf(new Date(F.timestamp),D)&&(F.type.toLowerCase().includes("check")||F.type.toLowerCase().includes("in"))),O=v.some(F=>uf(F,D)),I=p.some(F=>uf(new Date(F.date),D));return(O||I)&&M?"holiday-present":O?"floating-holiday":I?"holiday":M?"present":ZW(Uc(new Date),Uc(D))?"absent":"neutral"},j=D=>{switch(D){case"present":return"bg-emerald-500 text-white border-emerald-600 shadow-sm";case"absent":return"bg-rose-500 text-white border-rose-600 shadow-sm";case"holiday":return"bg-red-600 text-white border-red-700 shadow-sm";case"floating-holiday":return"bg-amber-500 text-white border-amber-600 shadow-sm";case"holiday-present":return"bg-violet-600 text-white border-violet-700 shadow-sm";default:return"bg-gray-50 text-gray-400 border-gray-100"}},T=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],P=xC(pi(a));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-none bg-transparent p-3 rounded-xl shadow-none w-full md:w-full md:max-w-[320px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Attendance Calendar"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(se,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>o(bC(a)),children:i.jsx(ay,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-sm",children:$e(a,"MMMM yyyy")}),i.jsx(se,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>o(ey(a,1)),children:i.jsx(Mf,{className:"h-3 w-3"})})]})]}),d?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(_t,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[T.map(D=>i.jsx("div",{className:"text-center text-xs font-medium text-muted py-1",children:D},D)),Array.from({length:P}).map((D,M)=>i.jsx("div",{className:"aspect-square"},`empty-${M}`)),w.map(D=>{const M=_(D),O=j(M);return i.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${O} transition-colors`,children:i.jsx("span",{className:"text-sm font-semibold",children:$e(D,"d")})},D.toISOString())})]}),i.jsxs("div",{className:"mt-3 flex gap-3 text-xs text-muted justify-center flex-wrap",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-emerald-500 border border-emerald-600 rounded-sm"})," Present"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-rose-500 border border-rose-600 rounded-sm"})," Absent"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-red-600 border border-red-700 rounded-sm"})," Holiday"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-amber-500 border border-amber-600 rounded-sm"})," Floating Holiday"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-violet-600 border border-violet-700 rounded-sm"})," Holiday Present"]})]})]})},bce=({logs:n,isLoading:e=!1})=>{const[t,r]=E.useState(new Date),s=E.useMemo(()=>xo({start:pi(t),end:Ta(t)}),[t]),a=d=>n.some(p=>{const x=new Date(p.dateEarned.replace(/-/g,"/"));return uf(x,d)})?"earned":"neutral",o=d=>{switch(d){case"earned":return"bg-blue-600 text-white border-blue-700 shadow-sm";default:return"bg-gray-50 text-gray-400 border-gray-100"}},l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],c=xC(pi(t));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-none bg-transparent p-3 rounded-xl shadow-none w-full md:w-full md:max-w-[320px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Comp Off Tracker"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(se,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>r(bC(t)),children:i.jsx(ay,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-sm",children:$e(t,"MMMM yyyy")}),i.jsx(se,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>r(ey(t,1)),children:i.jsx(Mf,{className:"h-3 w-3"})})]})]}),e?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(_t,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[l.map(d=>i.jsx("div",{className:"text-center text-xs font-medium text-muted py-1",children:d},d)),Array.from({length:c}).map((d,h)=>i.jsx("div",{className:"aspect-square"},`empty-${h}`)),s.map(d=>{const h=a(d),p=o(h);return i.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${p} transition-colors`,children:i.jsx("span",{className:"text-sm font-semibold",children:$e(d,"d")})},d.toISOString())})]}),i.jsx("div",{className:"mt-3 flex gap-3 text-xs text-muted justify-center",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-600 border border-blue-700 rounded-sm"})," Comp Off Earned"]})})]})},wce=()=>{const{user:n}=jt(),[e,t]=E.useState(new Date),[r,s]=E.useState([]),[a,o]=E.useState(!1);E.useEffect(()=>{(async()=>{if(n){o(!0);try{const x=pi(e).toISOString(),v=Ta(e).toISOString(),w=await ue.getAttendanceEvents(n.id,x,v);s(w)}catch(x){console.error("Failed to fetch attendance events",x)}finally{o(!1)}}})()},[n,e]);const l=E.useMemo(()=>xo({start:pi(e),end:Ta(e)}),[e]),c=p=>{const x=r.filter(P=>uf(new Date(P.timestamp),p));if(x.length===0)return 0;const v=[...x].sort((P,D)=>new Date(P.timestamp).getTime()-new Date(D.timestamp).getTime());let w=0,_=null;v.forEach(P=>{const D=new Date(P.timestamp);P.type==="check-in"?_=D:P.type==="check-out"&&_&&(w+=ff(D,_),_=null)});const j=w/60,T=Math.max(0,j-8);return parseFloat(T.toFixed(1))},d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h=xC(pi(e));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-0 bg-transparent p-3 rounded-xl shadow-none w-full",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"OT Calendar"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(se,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>t(bC(e)),children:i.jsx(ay,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-xs",children:$e(e,"MMMM yyyy")}),i.jsx(se,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>t(ey(e,1)),children:i.jsx(Mf,{className:"h-3 w-3"})})]})]}),a?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(_t,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[d.map(p=>i.jsx("div",{className:"text-center text-[10px] font-medium text-muted py-1",children:p},p)),Array.from({length:h}).map((p,x)=>i.jsx("div",{className:"aspect-square"},`empty-${x}`)),l.map(p=>{const x=c(p),v=x>0;return i.jsxs("div",{className:`aspect-square rounded border flex flex-col items-center justify-center transition-colors ${v?"bg-blue-600 text-white border-blue-700 shadow-sm":"bg-gray-50 text-gray-400 border-gray-100"}`,children:[i.jsx("span",{className:"text-xs font-semibold",children:$e(p,"d")}),v&&i.jsxs("span",{className:"text-[8px] font-bold",children:["+",x,"h"]})]},p.toISOString())})]}),i.jsx("div",{className:"mt-3 flex gap-3 text-[10px] text-muted justify-center flex-wrap",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-600 border border-blue-700 rounded-sm"})," Overtime (>8h)"]})})]})},_ce=()=>{const{user:n}=jt(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState("day"),[l,c]=E.useState(new Date),[d,h]=E.useState({});Ft("(max-width: 767px)");const p=async()=>{if(n){s(!0);try{let T,P;switch(a){case"day":T=Uc(l),P=mC(l);break;case"week":T=So(l,{weekStartsOn:1}),P=nP(l,{weekStartsOn:1});break;case"month":T=pi(l),P=Ta(l);break}const D=await ue.getAttendanceEvents(n.id,T.toISOString(),P.toISOString());t(D);const M=D.filter(O=>O.latitude&&O.longitude).map(O=>({lat:O.latitude,lon:O.longitude}));if(M.length>0)try{const O=await ue.batchResolveAddresses(M);h(O)}catch(O){console.error("Failed to fetch location addresses:",O)}}catch(T){console.error("Failed to fetch attendance events:",T)}finally{s(!1)}}};E.useEffect(()=>{p()},[n,a,l]);const x=E.useMemo(()=>{const T={};return e.forEach(P=>{const D=$e(new Date(P.timestamp),"yyyy-MM-dd");T[D]||(T[D]={date:D,events:[],checkIns:[],checkOuts:[],totalMinutes:0}),T[D].events.push(P),P.type==="check-in"?T[D].checkIns.push(P):P.type==="check-out"&&T[D].checkOuts.push(P)}),Object.values(T).forEach(P=>{const D=[...P.events].sort((I,q)=>new Date(I.timestamp).getTime()-new Date(q.timestamp).getTime());let M=0,O=null;D.forEach(I=>{const q=new Date(I.timestamp);I.type==="check-in"?O=q:I.type==="check-out"&&O&&(M+=ff(q,O),O=null)}),P.totalMinutes=M}),Object.values(T).sort((P,D)=>D.date.localeCompare(P.date))},[e]),v=T=>{const P=Math.floor(T/60),D=T%60;return`${P}h ${D}m`},w=T=>{o(T)},_=T=>{const P=new Date(l);switch(a){case"day":P.setDate(P.getDate()+(T==="next"?1:-1));break;case"week":P.setDate(P.getDate()+(T==="next"?7:-7));break;case"month":P.setMonth(P.getMonth()+(T==="next"?1:-1));break}c(P)},j=()=>{switch(a){case"day":return $e(l,"dd MMM, yyyy");case"week":const T=So(l,{weekStartsOn:1}),P=nP(l,{weekStartsOn:1});return`${$e(T,"dd MMM")} - ${$e(P,"dd MMM, yyyy")}`;case"month":return $e(l,"MMMM yyyy")}};return n?i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-indigo-50 rounded-lg",children:i.jsx(Bc,{className:"h-5 w-5 text-indigo-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Employee Log"})]}),i.jsxs("div",{className:"mb-6 space-y-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>w("day"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="day"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Day"}),i.jsx("button",{onClick:()=>w("week"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="week"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Week"}),i.jsx("button",{onClick:()=>w("month"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="month"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Month"})]}),i.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[i.jsx("button",{onClick:()=>_("prev"),className:"px-3 py-1 bg-white rounded-md shadow-sm hover:bg-gray-100 transition-colors",children:""}),i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-gray-900",children:[i.jsx(Pa,{className:"h-4 w-4"}),i.jsx("span",{children:j()})]}),i.jsx("button",{onClick:()=>_("next"),className:"px-3 py-1 bg-white rounded-md shadow-sm hover:bg-gray-100 transition-colors",children:""})]})]}),i.jsx("div",{className:"space-y-4",children:r?i.jsx("div",{className:"flex items-center justify-center py-10",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-indigo-600"})}):x.length===0?i.jsxs("div",{className:"text-center py-10 text-gray-500",children:[i.jsx(Pa,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{className:"font-medium",children:"No attendance records found"}),i.jsx("p",{className:"text-sm mt-1",children:"Check-in to start tracking your attendance"})]}):x.map(T=>i.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl border border-gray-200 overflow-hidden",children:[i.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-500 px-4 py-3 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 text-white",children:[i.jsx(Pa,{className:"h-4 w-4"}),i.jsx("span",{className:"font-semibold",children:$e(new Date(T.date),"EEEE, dd MMMM yyyy")})]}),i.jsx("div",{className:"text-white text-sm font-medium bg-white/20 px-3 py-1 rounded-full",children:v(T.totalMinutes)})]}),i.jsx("div",{className:"p-4 space-y-3",children:T.events.sort((P,D)=>new Date(P.timestamp).getTime()-new Date(D.timestamp).getTime()).map((P,D)=>i.jsx("div",{className:`p-3 rounded-lg border-l-4 ${P.type==="check-in"?"bg-emerald-50 border-emerald-500":"bg-rose-50 border-rose-500"}`,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`p-2 rounded-lg ${P.type==="check-in"?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:i.jsx(Bc,{className:"h-4 w-4"})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900 capitalize",children:P.type.replace("-"," ")}),i.jsx("div",{className:"text-sm text-gray-600",children:$e(new Date(P.timestamp),"hh:mm a")})]})]}),P.latitude&&P.longitude&&i.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-600 bg-white px-3 py-1.5 rounded-lg border border-gray-200 max-w-md",children:[i.jsx(Tl,{className:"h-4 w-4 text-indigo-600 flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-xs break-words",children:d[`${P.latitude.toFixed(6)},${P.longitude.toFixed(6)}`]||`${P.latitude.toFixed(4)}, ${P.longitude.toFixed(4)}`})]})]})},`${P.timestamp}-${D}`))}),i.jsx("div",{className:"bg-gray-50 px-4 py-3 border-t border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Check-ins:"}),i.jsx("span",{className:"ml-2 font-semibold text-emerald-600",children:T.checkIns.length})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Check-outs:"}),i.jsx("span",{className:"ml-2 font-semibold text-rose-600",children:T.checkOuts.length})]})]})})]},T.date))})]}):null},BL=({title:n,value:e,icon:t})=>i.jsxs("div",{className:"bg-card p-3 md:p-4 rounded-xl flex flex-col md:flex-row items-center md:items-center gap-2 md:gap-4 border border-border text-center md:text-left w-full",children:[i.jsx("div",{className:"bg-accent-light p-2 md:p-3 rounded-full flex-shrink-0",children:i.jsx(t,{className:"h-5 w-5 md:h-6 md:w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-xs md:text-sm text-muted font-medium",children:n}),i.jsx("p",{className:"text-lg md:text-2xl font-bold text-primary-text",children:e})]})]}),jce=({status:n})=>{const e={pending_manager_approval:"leave-status-chip--pending_manager_approval",pending_hr_confirmation:"leave-status-chip--pending_hr_confirmation",approved:"leave-status-chip--approved",rejected:"leave-status-chip--rejected"},t=n.replace(/_/g," ");return i.jsx("span",{className:`leave-status-chip ${e[n]}`,children:t})},Nce=n=>Pt({leaveType:ge().oneOf(["Earned","Sick","Floating","Comp Off"]).required("Leave type is required"),startDate:ge().required("Start date is required"),endDate:ge().required("End date is required").test("is-after-start","End date must be on or after start date",function(e){const{startDate:t}=this.parent;return!t||!e?!0:new Date(e.replace(/-/g,"/"))>=new Date(t.replace(/-/g,"/"))}),reason:ge().required("A reason for the leave is required").min(10,"Please provide a more detailed reason."),dayOption:ge().oneOf(["full","half"]).optional(),doctorCertificate:Wt().when(["leaveType","startDate","endDate"],{is:(e,t,r)=>e!=="Sick"||!t||!r?!1:Mm(new Date(r.replace(/-/g,"/")),new Date(t.replace(/-/g,"/")))+1>n,then:e=>e.required(`A doctor's certificate is required for sick leave longer than ${n} days.`),otherwise:e=>e.nullable().optional()})}),Sce=({isOpen:n,onClose:e,onSuccess:t,user:r,isMobile:s,setToast:a})=>{const{attendance:{office:{sickLeaveCertificateThreshold:o}}}=gi(),l=E.useMemo(()=>Nce(o),[o]),{register:c,control:d,handleSubmit:h,watch:p,formState:{errors:x},reset:v}=tn({resolver:En(l),defaultValues:{leaveType:"Earned",startDate:$e(new Date,"yyyy-MM-dd"),endDate:$e(new Date,"yyyy-MM-dd"),dayOption:"full"}}),w=p("startDate"),_=p("endDate"),j=p("leaveType"),P=E.useMemo(()=>!w||!_?!1:uf(new Date(w.replace(/-/g,"/")),new Date(_.replace(/-/g,"/"))),[w,_])&&j==="Earned",D=E.useMemo(()=>j!=="Sick"||!w||!_?!1:Mm(new Date(_.replace(/-/g,"/")),new Date(w.replace(/-/g,"/")))+1>o,[j,w,_,o]),M=async O=>{try{await ue.submitLeaveRequest({...O,userId:r.id,userName:r.name}),t()}catch{a({message:"Failed to submit leave request.",type:"error"})}};return n?i.jsx("div",{className:`fixed inset-0 z-40 bg-card ${s?"flex flex-col":"flex items-center justify-center bg-black/50 p-4"}`,children:i.jsxs("div",{className:`w-full ${s?"flex flex-col h-full":"max-w-2xl bg-card rounded-xl shadow-lg"}`,children:[i.jsxs("header",{className:`p-4 flex-shrink-0 flex items-center gap-4 ${s?"fo-mobile-header":"border-b"}`,children:[i.jsx(se,{variant:"icon",onClick:e,"aria-label":"Go back",children:i.jsx(Ra,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-lg font-semibold",children:s?"New Leave Request":"Submit a New Leave Request"})]}),i.jsxs("form",{id:"leave-form",onSubmit:h(M),className:"flex-grow overflow-y-auto p-4 space-y-4",children:[i.jsx(_e,{name:"leaveType",control:d,render:({field:O})=>i.jsxs(Ke,{label:"Leave Type",...O,error:x.leaveType?.message,className:s?"pro-select pro-select-arrow":"",children:[i.jsx("option",{children:"Earned"}),i.jsx("option",{children:"Sick"}),i.jsx("option",{children:"Floating"}),i.jsx("option",{children:"Comp Off"})]})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(_e,{name:"startDate",control:d,render:({field:O})=>i.jsx(kn,{label:"Start Date",id:"startDate",value:O.value,onChange:O.onChange,error:x.startDate?.message})}),i.jsx(_e,{name:"endDate",control:d,render:({field:O})=>i.jsx(kn,{label:"End Date",id:"endDate",value:O.value,onChange:O.onChange,error:x.endDate?.message})})]}),P&&i.jsx(_e,{name:"dayOption",control:d,render:({field:O})=>i.jsxs(Ke,{label:"Day Option",...O,className:s?"pro-select pro-select-arrow":"",children:[i.jsx("option",{value:"full",children:"Full Day"}),i.jsx("option",{value:"half",children:"Half Day"})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Reason"}),i.jsx("textarea",{...c("reason"),rows:4,className:`mt-1 form-input ${x.reason?"form-input--error":""}`}),x.reason&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.reason.message})]}),D&&i.jsx(_e,{name:"doctorCertificate",control:d,render:({field:O,fieldState:I})=>i.jsx(yt,{label:"Doctor's Certificate (Required)",file:O.value,onFileChange:O.onChange,error:I.error?.message,allowCapture:!0})})]}),i.jsxs("footer",{className:`p-4 flex-shrink-0 flex items-center justify-end gap-2 ${s?"":"border-t"}`,children:[i.jsx(se,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(se,{type:"submit",form:"leave-form",children:"Submit Request"})]})]})}):null},Cce=()=>{const{user:n}=jt(),[e,t]=E.useState(null),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState(!1),[p,x]=E.useState("all"),[v,w]=E.useState(null),_=Ft("(max-width: 767px)"),[j,T]=E.useState(!1),[P,D]=E.useState(0),M=E.useCallback(async()=>{if(n){c(!0),h(!1);try{const[V,U,W]=await Promise.all([ue.getLeaveBalancesForUser(n.id),ue.getLeaveRequests({userId:n.id,status:p==="all"?void 0:p}),ue.getCompOffLogs(n.id).catch($=>{if($&&$.message&&($.message.includes("comp_off_logs")||$.message.includes('relation "public.comp_off_logs" does not exist')))return h(!0),[];throw $})]);if(t(V),s(U),o(W),n.role==="field_officer"){const $=new Date,ne=pi($).toISOString(),Y=Ta($).toISOString(),ae=await ue.getAttendanceEvents(n.id,ne,Y),J={};ae.forEach(X=>{const Z=$e(new Date(X.timestamp),"yyyy-MM-dd");J[Z]||(J[Z]=[]),J[Z].push(X)});let ee=0;Object.values(J).forEach(X=>{const Z=[...X].sort((re,de)=>new Date(re.timestamp).getTime()-new Date(de.timestamp).getTime());let oe=0,H=null;Z.forEach(re=>{const de=new Date(re.timestamp);re.type==="check-in"?H=de:re.type==="check-out"&&H&&(oe+=ff(de,H),H=null)});const Q=oe/60;Q>8&&(ee+=Q-8)}),D(parseFloat(ee.toFixed(1)))}}catch(V){let U="Failed to load leave data.";V&&typeof V.message=="string"&&V.message.includes('relation "leave_requests" does not exist')&&(U='Database setup error: The "leave_requests" table is missing.'),console.error("Failed to load leave data",V),d||w({message:U,type:"error"})}finally{c(!1)}}},[n,p]);E.useEffect(()=>{M()},[M]);const O=()=>{w({message:"Leave request submitted successfully!",type:"success"}),T(!1),M()},I=V=>V.replace(/_/g," ").replace(/\b\w/g,U=>U.toUpperCase()),q=["all","pending_manager_approval","pending_hr_confirmation","approved","rejected"],F=e?[{title:"Earned Leave",value:`${e.earnedTotal-e.earnedUsed} / ${e.earnedTotal}`,icon:XF},{title:"Sick Leave",value:`${e.sickTotal-e.sickUsed} / ${e.sickTotal}`,icon:CC},{title:"Floating Holiday",value:`${e.floatingTotal-e.floatingUsed} / ${e.floatingTotal}`,icon:IJ},{title:"Compensatory Off",value:`${e.compOffTotal-e.compOffUsed} / ${e.compOffTotal}`,icon:oJ}]:[];return i.jsxs("div",{className:"p-4 space-y-6",children:[v&&i.jsx(ht,{message:v.message,type:v.type,onDismiss:()=>w(null)}),n&&i.jsx(Sce,{isOpen:j,onClose:()=>T(!1),onSuccess:O,user:n,isMobile:_,setToast:w}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Leave Requests"}),!_&&i.jsxs(se,{onClick:()=>T(!0),children:[i.jsx(Bt,{className:"mr-2 h-4"})," New Request"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6 justify-items-center md:justify-items-start",children:[F.map(V=>i.jsx(BL,{...V},V.title)),n?.role==="field_officer"&&i.jsx(BL,{title:"Overtime Hours",value:`${P} hrs`,icon:Bc})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[i.jsx(vce,{}),i.jsx(bce,{logs:a,isLoading:l}),n?.role==="field_officer"&&i.jsx(wce,{})]}),_&&i.jsx("div",{className:"my-4 w-full",children:i.jsxs(se,{onClick:()=>T(!0),size:"lg",className:"w-full justify-center text-lg",children:[i.jsx(Bt,{className:"mr-2 h-5"})," New Request"]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full md:w-full",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:i.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 space-y-2 md:space-y-0","aria-label":"Tabs",children:q.map(V=>i.jsx("button",{onClick:()=>x(V),className:`whitespace-nowrap font-medium text-base rounded-lg md:rounded-none w-full md:w-auto text-left px-4 py-2 md:px-1 md:py-3 md:bg-transparent md:border-b-2
                                    ${p===V?"bg-accent-light text-accent-dark md:border-accent":"text-muted hover:bg-accent-light hover:text-accent-dark md:border-transparent md:hover:border-accent"}`,children:I(V)},V))})})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Dates"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted text-lg",children:"No requests found."})}):r.map(V=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Type",className:"px-4 py-3 font-medium text-base",children:[V.leaveType," ",V.dayOption&&`(${V.dayOption})`]}),i.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted text-base",children:[$e(new Date(V.startDate.replace(/-/g,"/")),"dd MMM")," - ",$e(new Date(V.endDate.replace(/-/g,"/")),"dd MMM")]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate text-base",children:V.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3 text-base",children:i.jsx(jce,{status:V.status})})]},V.id))})]})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full md:w-full",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Compensatory Off Tracker"}),d?i.jsxs("div",{className:"text-center py-10 text-muted bg-page rounded-lg",children:[i.jsx(Da,{className:"h-8 w-8 mx-auto mb-2 text-yellow-500"}),i.jsx("p",{className:"font-semibold",children:"Feature Unavailable"}),i.jsx("p",{className:"text-sm",children:"The Compensatory Off feature is disabled because the required 'comp_off_logs' table is missing in the database."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date Earned"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason for Comp-Off"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Granted By"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted text-lg",children:"No comp-off history found."})}):a.map(V=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Date Earned",className:"px-4 py-3 font-medium",children:$e(new Date(V.dateEarned.replace(/-/g,"/")),"dd MMM, yyyy")}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted",children:V.reason}),i.jsx("td",{"data-label":"Granted By",className:"px-4 py-3 text-muted",children:V.grantedByName||"-"}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full capitalize ${V.status==="earned"?"bg-blue-100 text-blue-800":"bg-gray-200 text-gray-800"}`,children:V.status})})]},V.id))})]})})]}),i.jsx(_ce,{})]})},Tce=({isOpen:n,onClose:e,onConfirm:t,isConfirming:r})=>{const[s,a]=E.useState(""),[o,l]=E.useState(""),c=()=>{if(!s.trim()){l("A reason for rejection is required.");return}t(s)},d=()=>{a(""),l(""),e()};return n?i.jsx(Yr,{isOpen:n,onClose:d,onConfirm:c,title:"Reject Claim",confirmButtonText:"Confirm Rejection",isConfirming:r,children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{children:"Please provide a reason for rejecting this claim. This will be visible to the employee."}),i.jsxs("div",{children:[i.jsx("textarea",{value:s,onChange:h=>{a(h.target.value),o&&l("")},rows:3,className:`mt-1 form-input ${o?"form-input--error":""}`,placeholder:"e.g., Overtime was not pre-approved."}),o&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:o})]})]})}):null},kce=({status:n})=>{const e={pending_manager_approval:"bg-yellow-100 text-yellow-800",pending_hr_confirmation:"bg-blue-100 text-blue-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},t=n.replace(/_/g," ");return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:t})},Pce=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},Mce=()=>{const n=St(),{user:e}=jt(),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(!0),[c,d]=E.useState("pending_manager_approval"),[h,p]=E.useState(null),[x,v]=E.useState(null),w=Ft("(max-width: 767px)"),[_,j]=E.useState(!0),[T,P]=E.useState(!1),[D,M]=E.useState(null);E.useEffect(()=>{(async()=>{try{await ue.checkCompOffTableExists(),j(!0)}catch{j(!1)}})()},[]);const O=E.useCallback(async()=>{if(e){l(!0);try{const $=["admin","hr","operation_manager","site_manager"].includes(e.role),[ne,Y]=await Promise.all([ue.getLeaveRequests({forApproverId:e.id,status:c!=="all"&&c!=="claims"?c:void 0}),$?ue.getExtraWorkLogs():Promise.resolve([])]);r(ne),a(Y)}catch{p({message:"Failed to load approval data.",type:"error"})}finally{l(!1)}}},[e,c]);E.useEffect(()=>{O()},[O]);const I=async($,ne)=>{if(e){v($);try{switch(ne){case"approve":await ue.approveLeaveRequest($,e.id);break;case"reject":await ue.rejectLeaveRequest($,e.id);break;case"confirm":await ue.confirmLeaveByHR($,e.id);break}p({message:"Request actioned successfully.",type:"success"}),O()}catch{p({message:"Failed to update request.",type:"error"})}finally{v(null)}}},q=async $=>{if(e){v($);try{await ue.approveExtraWorkClaim($,e.id),p({message:"Claim approved successfully.",type:"success"}),O()}catch{p({message:"Failed to approve claim.",type:"error"})}finally{v(null)}}},F=async $=>{if(!(!e||!D)){v(D.id);try{await ue.rejectExtraWorkClaim(D.id,e.id,$),p({message:"Claim rejected successfully.",type:"success"}),O()}catch{p({message:"Failed to reject claim.",type:"error"})}finally{v(null),P(!1),M(null)}}},V=["pending_manager_approval","claims","pending_hr_confirmation","approved","rejected","all"],U=({request:$})=>{if(!e||$.status==="approved"||$.status==="rejected")return null;if($.currentApproverId===e.id){if($.status==="pending_manager_approval")return i.jsxs("div",{className:"flex gap-2",children:[i.jsx(se,{size:"sm",variant:"icon",onClick:()=>I($.id,"approve"),disabled:x===$.id,title:"Approve","aria-label":"Approve request",children:i.jsx(_l,{className:"h-4 w-4 text-green-600"})}),i.jsx(se,{size:"sm",variant:"icon",onClick:()=>I($.id,"reject"),disabled:x===$.id,title:"Reject","aria-label":"Reject request",children:i.jsx(xi,{className:"h-4 w-4 text-red-600"})})]});if($.status==="pending_hr_confirmation"&&(e.role==="hr"||e.role==="admin"))return i.jsxs("div",{className:"flex gap-2",children:[i.jsx(se,{size:"sm",variant:"icon",onClick:()=>I($.id,"confirm"),disabled:x===$.id,title:"Confirm & Finalize","aria-label":"Confirm and finalize request",children:i.jsx(_l,{className:"h-4 w-4 text-blue-600"})}),i.jsx(se,{size:"sm",variant:"icon",onClick:()=>I($.id,"reject"),disabled:x===$.id,title:"Reject","aria-label":"Reject request",children:i.jsx(xi,{className:"h-4 w-4 text-red-600"})})]})}return null},W=$=>$.replace(/_/g," ").replace(/\b\w/g,ne=>ne.toUpperCase());return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(Tce,{isOpen:T,onClose:()=>{P(!1),M(null)},onConfirm:F,isConfirming:!!x}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Leave Approval Inbox"}),!w&&i.jsxs(se,{onClick:()=>n("/hr/leave-management/grant-comp-off"),disabled:!_,title:_?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})]}),w&&i.jsx("div",{className:"mb-6",children:i.jsxs(se,{onClick:()=>n("/hr/leave-management/grant-comp-off"),disabled:!_,title:_?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})}),i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:i.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 md:overflow-x-auto space-y-1 md:space-y-0","aria-label":"Tabs",children:V.map($=>i.jsx("button",{onClick:()=>d($),className:`whitespace-nowrap font-medium text-sm rounded-lg md:rounded-none w-full md:w-auto text-left md:text-center px-4 py-3 md:px-1 md:py-3 md:bg-transparent md:border-b-2 transition-colors duration-200
                                ${c===$?"bg-emerald-50 text-emerald-700 md:border-emerald-500 md:bg-transparent":"text-muted hover:bg-emerald-50 hover:text-emerald-700 md:border-transparent md:hover:border-emerald-500"}`,children:W($)},$))})})}),c==="claims"?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date & Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Claim"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:o?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10",children:i.jsx(_t,{className:"h-6 w-6 animate-spin mx-auto"})})}):s.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No pending claims found."})}):s.map($=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:$.userName}),i.jsxs("td",{"data-label":"Date & Type",className:"px-4 py-3 text-muted",children:[$e(new Date($.workDate),"dd MMM, yyyy")," (",$.workType,")"]}),i.jsxs("td",{"data-label":"Claim",className:"px-4 py-3 text-muted",children:[$.claimType,$.claimType==="OT"?` (${$.hoursWorked} hrs)`:""]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:$.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(Pce,{status:$.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex md:justify-start justify-end gap-2",children:[i.jsx(se,{size:"sm",variant:"icon",onClick:()=>q($.id),disabled:x===$.id,title:"Approve Claim",children:i.jsx(_l,{className:"h-4 w-4 text-green-600"})}),i.jsx(se,{size:"sm",variant:"icon",onClick:()=>{M($),P(!0)},disabled:x===$.id,title:"Reject Claim",children:i.jsx(xi,{className:"h-4 w-4 text-red-600"})})]})})]},$.id))})]})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Dates"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:o?w?i.jsx("tr",{children:i.jsx("td",{colSpan:6,children:i.jsx(Oa,{rows:3,cols:6,isMobile:!0})})}):i.jsx(Oa,{rows:5,cols:6}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No requests found for this filter."})}):t.map($=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:$.userName}),i.jsxs("td",{"data-label":"Type",className:"px-4 py-3 text-muted",children:[$.leaveType," ",$.dayOption&&`(${$.dayOption})`]}),i.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted",children:[$e(new Date($.startDate.replace(/-/g,"/")),"dd MMM")," - ",$e(new Date($.endDate.replace(/-/g,"/")),"dd MMM")]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:$.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(kce,{status:$.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsx("div",{className:"flex md:justify-start justify-end",children:x===$.id?i.jsx(_t,{className:"h-4 w-4 animate-spin"}):i.jsx(U,{request:$})})})]},$.id))})]})})]})},K6=({users:n,externalSearchQuery:e,externalZoom:t,showControls:r=!0})=>{const s=E.useRef(null),a=E.useRef(null),[o,l]=E.useState(null),[c,d]=E.useState(null),[h,p]=E.useState({x:0,y:0}),[x,v]=E.useState(""),[w,_]=E.useState(1),[j,T]=E.useState({x:0,y:0}),P=e!==void 0?e:x,D=t!==void 0?t:w,M=v,O=_,I=E.useRef(null),q=E.useRef(!1),F=E.useRef({x:0,y:0}),V=E.useRef(!1),U=E.useRef({x:0,y:0}),W=E.useRef(0),$=E.useRef(new Map),ne=E.useRef(window.devicePixelRatio||1);E.useEffect(()=>{n.forEach(ie=>{if(ie.photoUrl&&!$.current.has(ie.id)){const xe=new Image;xe.crossOrigin="anonymous",xe.src=ie.photoUrl,xe.onload=()=>{$.current.set(ie.id,xe)}}})},[n]);const Y=()=>{const ie=new Map;n.forEach(Ce=>{ie.set(Ce.id,{...Ce,children:[]})});const xe=[];return n.forEach(Ce=>{const ve=ie.get(Ce.id);if(Ce.reportingManagerId){const Oe=ie.get(Ce.reportingManagerId);Oe?Oe.children.push(ve):xe.push(ve)}else xe.push(ve)}),xe},ae=(ie,xe=50,Ce=50,ve=0)=>{let we=xe;const Ne=[];let Ue=1/0,Be=-1/0,qe=1/0,te=-1/0;ie.forEach(ye=>{if(ye.level=ve,ye.children&&ye.children.length>0){const Ve=ae(ye.children,we,Ce+120+120,ve+1),ze=Ve.width,Le=we+ze/2-180/2;ye.x=Le,ye.y=Ce,Ne.push(ye),Ne.push(...Ve.nodes),Ue=Math.min(Ue,Le,Ve.bounds.minX),Be=Math.max(Be,Le+180,Ve.bounds.maxX),qe=Math.min(qe,Ce,Ve.bounds.minY),te=Math.max(te,Ce+120,Ve.bounds.maxY),we+=ze+20}else ye.x=we,ye.y=Ce,Ne.push(ye),Ue=Math.min(Ue,we),Be=Math.max(Be,we+180),qe=Math.min(qe,Ce),te=Math.max(te,Ce+120),we+=200});const le=Math.max(0,we-xe-20);return{width:Math.max(le,180),nodes:Ne,bounds:{minX:isFinite(Ue)?Ue:0,maxX:isFinite(Be)?Be:180,minY:isFinite(qe)?qe:0,maxY:isFinite(te)?te:300}}},J=(ie,xe,Ce,ve)=>{if(xe.x===void 0||xe.y===void 0||Ce.x===void 0||Ce.y===void 0)return;const Oe=(xe.x+90)*D+j.x,Pe=(xe.y+120)*D+j.y,Ie=(Ce.x+90)*D+j.x,Fe=Ce.y*D+j.y,we=ie.createLinearGradient(Oe,Pe,Ie,Fe),Ne=ve*5e-4%1;we.addColorStop(0,"#E0E7FF"),we.addColorStop(Ne,"#818CF8"),we.addColorStop(1,"#E0E7FF"),ie.save(),ie.strokeStyle=we,ie.lineWidth=2*D,ie.lineCap="round",ie.shadowColor="rgba(99, 102, 241, 0.2)",ie.shadowBlur=4,ie.beginPath(),ie.moveTo(Oe,Pe);const Ue=(Pe+Fe)/2;ie.bezierCurveTo(Oe,Ue,Ie,Ue,Ie,Fe),ie.stroke(),ie.restore();const qe=(ve*5e-4+xe.id.charCodeAt(0)*.1)%1,te={x:Oe,y:Pe},le={x:Oe,y:(Pe+Fe)/2},ye={x:Ie,y:(Pe+Fe)/2},Ve={x:Ie,y:Fe},ze=3*(le.x-te.x),Le=3*(ye.x-le.x)-ze,rt=Ve.x-te.x-ze-Le,Xe=3*(le.y-te.y),tt=3*(ye.y-le.y)-Xe,qt=Ve.y-te.y-Xe-tt,bt=rt*qe*qe*qe+Le*qe*qe+ze*qe+te.x,Et=qt*qe*qe*qe+tt*qe*qe+Xe*qe+te.y;ie.save(),ie.fillStyle="#6366F1",ie.shadowColor="#6366F1",ie.shadowBlur=8,ie.beginPath(),ie.arc(bt,Et,3*D,0,Math.PI*2),ie.fill(),ie.restore()},ee=(ie,xe,Ce,ve,Oe)=>{if(xe.x===void 0||xe.y===void 0)return null;const Pe=xe.x*D+j.x,Ie=xe.y*D+j.y,Fe=180*D,we=120*D,Ne=48*D,Ue=!!P&&xe.name.toLowerCase().includes(P.toLowerCase());ie.save(),ie.shadowColor=ve?"rgba(99, 102, 241, 0.4)":"rgba(0, 0, 0, 0.08)",ie.shadowBlur=(ve?24:12)*D,ie.shadowOffsetY=(ve?8:4)*D;const Be=ie.createLinearGradient(Pe,Ie,Pe,Ie+we);Be.addColorStop(0,"#FFFFFF"),Be.addColorStop(1,"#FAFAFA"),ie.fillStyle=Be;const qe=16*D;ie.beginPath(),ie.roundRect?ie.roundRect(Pe,Ie,Fe,we,qe):(ie.moveTo(Pe+qe,Ie),ie.lineTo(Pe+Fe-qe,Ie),ie.quadraticCurveTo(Pe+Fe,Ie,Pe+Fe,Ie+qe),ie.lineTo(Pe+Fe,Ie+we-qe),ie.quadraticCurveTo(Pe+Fe,Ie+we,Pe+Fe-qe,Ie+we),ie.lineTo(Pe+qe,Ie+we),ie.quadraticCurveTo(Pe,Ie+we,Pe,Ie+we-qe),ie.lineTo(Pe,Ie+qe),ie.quadraticCurveTo(Pe,Ie,Pe+qe,Ie)),ie.fill(),ie.lineWidth=(ve?2:1)*D,ie.strokeStyle=ve?"#6366F1":Ce?"#A5B4FC":Ue?"#22C55E":"#E5E7EB",ie.stroke(),ie.restore(),(ve||Ue)&&(ie.save(),ie.globalAlpha=.05,ie.fillStyle=ve?"#6366F1":"#22C55E",ie.beginPath(),ie.roundRect&&ie.roundRect(Pe,Ie,Fe,we,qe),ie.fill(),ie.restore());const te=Pe+(Fe-Ne)/2,le=Ie+16*D;ie.save(),ie.beginPath(),ie.arc(te+Ne/2,le+Ne/2,Ne/2,0,Math.PI*2),ie.clip();const ye=$.current.get(xe.id);if(ye&&ye.complete)ie.drawImage(ye,te,le,Ne,Ne);else{const tt=ie.createLinearGradient(te,le,te+Ne,le+Ne);tt.addColorStop(0,"#818CF8"),tt.addColorStop(1,"#4F46E5"),ie.fillStyle=tt,ie.fillRect(te,le,Ne,Ne),ie.fillStyle="#FFF",ie.font=`600 ${Math.max(12,16*D)}px "Inter", sans-serif`,ie.textAlign="center",ie.textBaseline="middle";const qt=xe.name.split(" ").map(bt=>bt[0]).join("").substring(0,2).toUpperCase();ie.fillText(qt,te+Ne/2,le+Ne/2+1*D)}if(ie.restore(),ie.save(),ie.strokeStyle=ve?"#6366F1":"#FFF",ie.lineWidth=2*D,ie.beginPath(),ie.arc(te+Ne/2,le+Ne/2,Ne/2,0,Math.PI*2),ie.stroke(),ie.restore(),xe.level!==void 0&&xe.level>0){const tt=18*D,qt=te+Ne-tt/2,bt=le+Ne-tt/2;ie.save(),ie.fillStyle="#10B981",ie.shadowColor="rgba(16, 185, 129, 0.4)",ie.shadowBlur=4*D,ie.beginPath(),ie.arc(qt,bt,tt/2,0,Math.PI*2),ie.fill(),ie.fillStyle="#FFF",ie.font=`700 ${Math.max(8,9*D)}px "Inter", sans-serif`,ie.textAlign="center",ie.textBaseline="middle",ie.fillText(`L${xe.level}`,qt,bt+1*D),ie.restore()}ie.save(),ie.fillStyle="#111827",ie.font=`600 ${Math.max(11,13*D)}px "Inter", sans-serif`,ie.textAlign="center",ie.textBaseline="top";const Ve=le+Ne+12*D;let ze=xe.name;const Le=Fe-24*D;if(ie.measureText(ze).width>Le){for(;ie.measureText(ze+"...").width>Le&&ze.length>0;)ze=ze.substring(0,ze.length-1);ze+="..."}ie.fillText(ze,Pe+Fe/2,Ve),ie.fillStyle="#6B7280",ie.font=`500 ${Math.max(9,11*D)}px "Inter", sans-serif`;const rt=Ve+18*D;let Xe=(xe.role||"").replace(/_/g," ");if(Xe=Xe?Xe.charAt(0).toUpperCase()+Xe.slice(1).toLowerCase():"",ie.measureText(Xe).width>Le){for(;ie.measureText(Xe+"...").width>Le&&Xe.length>0;)Xe=Xe.substring(0,Xe.length-1);Xe+="..."}return ie.fillText(Xe,Pe+Fe/2,rt),ie.restore(),{x:Pe,y:Ie,width:Fe,height:we}},X=(ie,xe)=>{const Ce=Y(),ve=ae(Ce),Oe=new Map;return ve.nodes.forEach(Pe=>{Pe.children&&Pe.children.forEach(Ie=>{J(ie,Pe,Ie,xe)})}),ve.nodes.forEach(Pe=>{const Ie=o?.id===Pe.id,Fe=c?.id===Pe.id,we=ee(ie,Pe,Ie,Fe);we&&Oe.set(Pe.id,we)}),{nodePositions:Oe,layout:ve}},Z=ie=>{const xe=ie??s.current;if(!xe)return;const Ce=xe.getBoundingClientRect(),ve=Y(),Pe=ae(ve).bounds,Ie=180,Fe=120,we=Math.max(1,Pe.maxX-Pe.minX+Ie),Ne=Math.max(1,Pe.maxY-Pe.minY+Fe),Ue=Pe.minX+we/2,Be=Pe.minY+Ne/2,qe=.98,te=Ce.width*qe/we,le=Ce.height*qe/Ne;let ye=Math.min(te,le);ye=Math.max(.3,Math.min(ye,1.5));const Ve=t!==void 0?t:ye,ze=Ce.width/2-Ue*Ve,Le=Ce.height/2-Be*Ve;t===void 0&&O(ye),T({x:ze,y:Le})};E.useEffect(()=>{if(n.length>0){const ie=setTimeout(()=>Z(),100);return()=>clearTimeout(ie)}},[n.length]),E.useEffect(()=>{t!==void 0&&n.length>0&&Z()},[t]),E.useEffect(()=>{const ie=()=>{const xe=s.current,Ce=a.current;if(!xe||!Ce)return;const ve=window.devicePixelRatio||1;ne.current=ve;const Oe=Ce.getBoundingClientRect(),Pe=Math.max(1,Oe.width),Ie=Math.max(1,Oe.height);xe.width=Math.round(Pe*ve),xe.height=Math.round(Ie*ve),xe.style.width=`${Pe}px`,xe.style.height=`${Ie}px`;const Fe=xe.getContext("2d");Fe&&(Fe.setTransform(ve,0,0,ve,0,0),Z(xe))};return ie(),window.addEventListener("resize",ie),()=>window.removeEventListener("resize",ie)},[n]),E.useEffect(()=>{const ie=s.current,xe=ie?.getContext("2d");if(!ie||!xe)return;const Ce=ne.current;let ve=0;const Oe=()=>{W.current+=16,xe.clearRect(0,0,ie.width/Ce,ie.height/Ce);const Pe=ie.width/Ce,Ie=ie.height/Ce,Fe=xe.createLinearGradient(0,0,Pe,Ie);Fe.addColorStop(0,"#FAFAFA"),Fe.addColorStop(1,"#F3F4F6"),xe.fillStyle=Fe,xe.fillRect(0,0,Pe,Ie);const{nodePositions:we}=X(xe,W.current);let Ne=!1;for(const[Ue,Be]of we.entries())if(h.x>=Be.x&&h.x<=Be.x+Be.width&&h.y>=Be.y&&h.y<=Be.y+Be.height){const qe=n.find(te=>te.id===Ue);if(qe){l(qe),Ne=!0;break}}!Ne&&o&&l(null),ve=requestAnimationFrame(Oe),I.current=ve};return I.current=requestAnimationFrame(Oe),()=>{I.current&&cancelAnimationFrame(I.current)}},[n,o,c,h,D,j,P]);const oe=ie=>{q.current=!0,V.current=!1;const xe=ie.nativeEvent.offsetX,Ce=ie.nativeEvent.offsetY;U.current={x:xe,y:Ce},F.current={x:xe,y:Ce}},H=ie=>{const xe=ie.nativeEvent.offsetX,Ce=ie.nativeEvent.offsetY;if(p({x:xe,y:Ce}),q.current){const ve=(xe-U.current.x)*1.3,Oe=(Ce-U.current.y)*1.3;Math.sqrt(Math.pow(xe-F.current.x,2)+Math.pow(Ce-F.current.y,2))>5&&(V.current=!0),T(Ie=>({x:Ie.x+ve,y:Ie.y+Oe})),U.current={x:xe,y:Ce}}},Q=()=>{q.current=!1},re=()=>{o&&!V.current&&d(c?.id===o.id?null:o),V.current=!1},de=()=>O(ie=>Math.min(ie+.2,2.5)),ce=()=>O(ie=>Math.max(ie-.2,.4)),pe=()=>{Z(),d(null),M("")};return i.jsxs("div",{className:"relative w-full h-full bg-gradient-to-br from-slate-50 to-slate-100",ref:a,children:[r&&i.jsxs("div",{className:"absolute top-4 left-4 z-20 flex flex-col gap-3",children:[i.jsxs("div",{className:"bg-white/90 backdrop-blur-md border border-slate-200 rounded-xl shadow-xl p-3 min-w-[280px]",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Ea,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),i.jsx("input",{type:"text",placeholder:"Search employees...",value:P,onChange:ie=>M(ie.target.value),className:"w-full pl-10 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),P&&i.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:[n.filter(ie=>ie.name.toLowerCase().includes(P.toLowerCase())).length," results"]})]}),i.jsxs("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 rounded-2xl shadow-lg p-3 flex flex-col gap-3 min-w-[240px]",children:[i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsx("button",{onClick:ce,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Zoom Out",children:i.jsx(EC,{className:"w-5 h-5"})}),i.jsx("div",{className:"flex-1 px-2",children:i.jsx("input",{type:"range",min:"40",max:"250",value:Math.round(D*100),onChange:ie=>O(parseInt(ie.target.value)/100),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-indigo-500 [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-md [&::-webkit-slider-thumb]:transition-transform [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-indigo-500 [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:border-0 [&::-moz-range-thumb]:shadow-md",title:"Zoom Slider"})}),i.jsx("button",{onClick:de,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Zoom In",children:i.jsx(MC,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"px-2 min-w-[60px] text-center font-semibold text-slate-700 text-sm tabular-nums bg-slate-100 rounded-lg py-1",children:[Math.round(D*100),"%"]}),i.jsx("div",{className:"w-px h-6 bg-slate-200"}),i.jsx("button",{onClick:pe,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Reset View",children:i.jsx(DS,{className:"w-5 h-5"})})]})]})]}),i.jsx("canvas",{ref:s,className:"w-full h-full cursor-grab active:cursor-grabbing",onMouseDown:oe,onMouseMove:H,onMouseUp:Q,onMouseLeave:Q,onClick:re}),o&&o.x!==void 0&&o.y!==void 0&&i.jsx("div",{className:"absolute pointer-events-none z-10 transform -translate-x-1/2 transition-all duration-200",style:{left:`${o.x*D+j.x+90*D}px`,top:`${Math.max(10,o.y*D+j.y-10)}px`},children:i.jsx("div",{className:"bg-white/95 backdrop-blur-xl border border-indigo-200 rounded-2xl shadow-2xl p-5 min-w-[320px] animate-fade-in-scale",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsxs("div",{className:"flex-shrink-0 relative",children:[o.photoUrl?i.jsx("img",{src:o.photoUrl,alt:o.name,className:"w-20 h-20 rounded-2xl object-cover border-3 border-indigo-500 shadow-lg"}):i.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-indigo-600 flex items-center justify-center text-white font-bold text-2xl border-3 border-white shadow-lg",children:o.name.split(" ").map(ie=>ie[0]).join("").substring(0,2).toUpperCase()}),o.level!==void 0&&o.level>0&&i.jsxs("div",{className:"absolute -bottom-2 -right-2 bg-emerald-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg",children:["L",o.level]})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-slate-900 text-xl mb-1 truncate",children:o.name}),i.jsx("p",{className:"text-sm text-indigo-600 font-medium capitalize mb-3 truncate",children:o.role.replace(/_/g," ")}),i.jsxs("div",{className:"space-y-2",children:[o.email&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(Bf,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{className:"truncate",children:o.email})]}),o.phone&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(Ef,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{children:o.phone})]}),o.managerName&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(Gi,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsxs("span",{className:"truncate",children:["Reports to: ",i.jsx("strong",{children:o.managerName})]})]})]}),i.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200",children:i.jsxs("p",{className:"text-xs text-slate-500 italic",children:["Click to ",c?.id===o.id?"deselect":"select and focus"]})})]})]})})}),r&&i.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-white/90 backdrop-blur-md px-6 py-3 rounded-full border border-slate-200 shadow-xl",children:i.jsxs("p",{className:"text-sm text-slate-700 font-medium flex items-center gap-3",children:[i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),"Drag to pan"]}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Hover for details"}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Click to select"})]})}),r&&i.jsxs("div",{className:"absolute top-4 right-4 bg-white/90 backdrop-blur-md border border-slate-200 rounded-2xl shadow-xl p-4 max-w-[200px]",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-900 mb-3 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),"Org Hierarchy"]}),i.jsxs("div",{className:"space-y-2.5",children:[i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded bg-gradient-to-br from-purple-500 to-indigo-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Team Member"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded bg-gradient-to-br from-emerald-400 to-emerald-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Search Match"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-8 h-0.5 bg-gradient-to-r from-indigo-400 to-purple-500 flex-shrink-0 shadow-sm"}),i.jsx("span",{children:"Reports To"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-emerald-500 text-white text-[8px] font-bold flex items-center justify-center flex-shrink-0",children:"L2"}),i.jsx("span",{children:"Level Badge"})]})]}),c&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[i.jsx("p",{className:"text-xs font-semibold text-indigo-600 mb-1",children:"Selected:"}),i.jsx("p",{className:"text-xs text-slate-700 font-medium truncate",children:c.name})]})]}),i.jsxs("div",{className:"absolute bottom-6 right-6 bg-slate-900/80 backdrop-blur-sm text-white text-xs px-3 py-2 rounded-full font-mono",children:[n.length," employees"]})]})},Ece=({users:n})=>{const[e,t]=E.useState(!1),[r,s]=E.useState(""),[a,o]=E.useState(null),[l,c]=E.useState(!0),d=()=>{s(""),o(null),setTimeout(()=>{},100)},h=()=>o(v=>Math.min((v??80)+10,250)),p=()=>o(v=>Math.max((v??80)-10,40)),x=i.jsxs("div",{className:`flex flex-col ${e?"h-screen":"h-[75vh] min-h-[500px]"}`,children:[i.jsx("div",{className:"flex-shrink-0 bg-white border-b border-slate-200 px-4 py-3",children:i.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3",children:[i.jsxs("div",{className:"relative flex-shrink-0 w-full md:w-64",children:[i.jsx(Ea,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),i.jsx("input",{type:"text",placeholder:"Search employees...",value:r,onChange:v=>s(v.target.value),className:"w-full pl-10 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),i.jsx("div",{className:"flex-1"}),i.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 rounded-lg px-3 py-2 border border-slate-200",children:[i.jsx("button",{onClick:p,className:"p-1.5 hover:bg-slate-200/60 rounded-md transition-colors text-slate-600 hover:text-slate-900",title:"Zoom Out",children:i.jsx(EC,{className:"w-4 h-4"})}),i.jsx("input",{type:"range",min:"40",max:"250",value:a??80,disabled:a===null,onChange:v=>o(parseInt(v.target.value)),className:"w-24 h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-primary [&::-webkit-slider-thumb]:cursor-pointer [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-primary [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:border-0"}),i.jsx("span",{className:"text-xs font-semibold text-slate-700 min-w-[45px] text-center",children:a?`${a}%`:"Auto"}),i.jsx("button",{onClick:h,className:"p-1.5 hover:bg-slate-200/60 rounded-md transition-colors text-slate-600 hover:text-slate-900",title:"Zoom In",children:i.jsx(MC,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:d,className:"px-3 py-2 text-sm font-medium text-slate-700 hover:text-slate-900 bg-slate-50 hover:bg-slate-100 border border-slate-200 rounded-lg transition-colors flex items-center gap-2",children:[i.jsx(DS,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Reset"})]}),i.jsxs("button",{onClick:()=>t(!e),className:"px-3 py-2 text-sm font-medium text-white bg-primary hover:bg-primary/90 rounded-lg transition-colors flex items-center gap-2",children:[e?i.jsx(kJ,{className:"w-4 h-4"}):i.jsx(DS,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:e?"Exit":"Full Screen"})]})]})]})}),i.jsxs("div",{className:"flex-1 bg-slate-50 relative overflow-hidden",children:[i.jsx(K6,{users:n,externalSearchQuery:r,externalZoom:a!==null?a/100:void 0,showControls:!1}),i.jsx("div",{className:`absolute bottom-4 right-4 z-20 ${l?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"bg-white/95 backdrop-blur-sm border border-slate-200 rounded-xl shadow-lg px-4 py-3 min-w-[200px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h4",{className:"text-xs font-bold text-slate-900 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),"Legend"]}),i.jsx("button",{onClick:()=>c(!l),className:"md:hidden text-slate-400 hover:text-slate-600",children:i.jsx(iu,{className:"w-3 h-3"})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-purple-500 to-indigo-600 border border-white shadow-sm flex-shrink-0"}),i.jsx("span",{children:"Team Member"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-emerald-400 to-emerald-600 border border-white shadow-sm flex-shrink-0"}),i.jsx("span",{children:"Search Match"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-6 h-0.5 bg-gradient-to-r from-indigo-400 to-purple-500 flex-shrink-0 shadow-sm"}),i.jsx("span",{children:"Reports To"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded-full bg-emerald-500 text-white text-[8px] font-bold flex items-center justify-center flex-shrink-0",children:"L2"}),i.jsx("span",{children:"Level Badge"})]})]})]})}),i.jsx("button",{onClick:()=>c(!l),className:"md:hidden absolute bottom-4 right-4 z-30 bg-white border border-slate-200 rounded-full p-2 shadow-lg",children:i.jsx(iu,{className:"w-5 h-5 text-slate-600"})})]}),r&&i.jsx("div",{className:"flex-shrink-0 bg-white border-t border-slate-200 px-4 py-2",children:i.jsxs("p",{className:"text-xs text-slate-600",children:[n.filter(v=>v.name.toLowerCase().includes(r.toLowerCase())).length," results found"]})})]});return e?i.jsx("div",{className:"fixed inset-0 z-50 bg-white",children:x}):i.jsx("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:x})},Dce=()=>{St();const[n,e]=E.useState([]),[t,r]=E.useState([]),[s,a]=E.useState("hr"),[o,l]=E.useState(!0),[c,d]=E.useState(!1),[h,p]=E.useState(null),[x,v]=E.useState("table"),w=E.useCallback(async()=>{l(!0);try{const[T,P,D]=await Promise.all([ue.getUsersWithManagers(),ue.getApprovalWorkflowSettings(),ue.getRoles()]);e(T),a(P.finalConfirmationRole),r(D.filter(M=>["admin","hr","operation_manager"].includes(M.id)))}catch{p({message:"Failed to load workflow data.",type:"error"})}finally{l(!1)}},[]);E.useEffect(()=>{w()},[w]);const _=(T,P)=>{e(D=>D.map(M=>M.id===T?{...M,reportingManagerId:P||void 0}:M))},j=async()=>{d(!0);try{await Promise.all(n.map(T=>ue.updateUserReportingManager(T.id,T.reportingManagerId||null))),await ue.updateApprovalWorkflowSettings(s),p({message:"Workflow saved successfully!",type:"success"}),w()}catch{p({message:"Failed to save workflow.",type:"error"})}finally{d(!1)}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(Qi,{title:"Leave Approval Settings",children:i.jsxs(se,{onClick:j,isLoading:c,children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save Workflow"]})}),i.jsxs("section",{className:"mb-8",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text mb-2",children:"Final Confirmation Step"}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Select the role responsible for the final confirmation of a leave request after it has been approved by the reporting manager chain."}),i.jsx("div",{className:"max-w-xs",children:i.jsx(Ke,{label:"Final Confirmation Role",id:"final-approver",value:s,onChange:T=>a(T.target.value),children:t.map(T=>i.jsx("option",{value:T.id,children:T.displayName},T.id))})})]}),i.jsxs("section",{children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-1",children:"Reporting Structure"}),i.jsx("p",{className:"text-sm text-muted",children:"View and manage organizational hierarchy"})]})}),i.jsx("div",{className:"border-b border-border mb-6",children:i.jsxs("div",{className:"flex gap-1 overflow-x-auto",children:[i.jsxs("button",{onClick:()=>v("table"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="table"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(FJ,{className:"w-4 h-4"}),"Table View"]}),i.jsxs("button",{onClick:()=>v("2d"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="2d"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(EJ,{className:"w-4 h-4"}),"2D Workflow Chart"]})]})}),o?i.jsx("div",{className:"flex justify-center items-center py-10",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted"})}):i.jsxs(i.Fragment,{children:[x==="table"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-muted mb-4",children:"For each employee, assign a reporting manager. Leave requests will be sent to this manager for first-level approval."}),i.jsx("div",{className:"overflow-x-auto hidden md:block border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase w-1/2",children:"Reporting Manager"})]})}),i.jsx("tbody",{className:"bg-card divide-y divide-border",children:n.map(T=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 font-medium text-primary-text",children:T.name}),i.jsx("td",{className:"px-6 py-4 text-sm text-muted capitalize",children:t.find(P=>P.id===T.role)?.displayName||T.role.replace(/_/g," ")}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs(Ke,{label:"",id:`manager-for-desktop-${T.id}`,value:T.reportingManagerId||"",onChange:P=>_(T.id,P.target.value),className:"w-full",children:[i.jsx("option",{value:"",children:"None (Reports to Final Approver)"}),n.filter(P=>P.id!==T.id).map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})})]},T.id))})]})}),i.jsx("div",{className:"space-y-3 md:hidden",children:n.map(T=>i.jsxs("div",{className:"bg-card rounded-lg border border-border overflow-hidden",children:[i.jsxs("div",{className:"p-3",children:[i.jsx("p",{className:"font-semibold text-primary-text",children:T.name}),i.jsx("p",{className:"text-sm text-muted capitalize",children:t.find(P=>P.id===T.role)?.displayName||T.role.replace(/_/g," ")})]}),i.jsxs("div",{className:"p-3 border-t border-border",children:[i.jsx("label",{className:"text-sm text-muted block mb-1",children:"Manager"}),i.jsxs(Ke,{id:`manager-for-mobile-${T.id}`,value:T.reportingManagerId||"",onChange:P=>_(T.id,P.target.value),children:[i.jsx("option",{value:"",children:"None"}),n.filter(P=>P.id!==T.id).map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})]})]},T.id))})]}),x==="2d"&&i.jsx(Ece,{users:n})]})]})]})},Oce=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState(!0);E.useEffect(()=>{(async()=>{try{const l=await ue.getUsersWithManagers();t(l)}catch(l){console.error("Failed to load users",l)}finally{s(!1)}})()},[]);const a=()=>{n("/admin/approval-workflow")};return r?i.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-slate-50",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-primary"})}):i.jsxs("div",{className:"w-screen h-screen relative bg-slate-50 overflow-hidden",children:[i.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-50 p-3 bg-white rounded-full shadow-xl hover:bg-gray-50 transition-all duration-200 border border-gray-200 group",title:"Close Full Screen",children:i.jsx(xi,{className:"h-6 w-6 text-gray-600 group-hover:text-red-500 transition-colors"})}),i.jsx(K6,{users:e})]})},_1=Aa(n=>({tasks:[],isLoading:!1,error:null,fetchTasks:async()=>{n({isLoading:!0,error:null});try{const e=await ue.getTasks();n({tasks:e,isLoading:!1})}catch{n({error:"Failed to fetch tasks.",isLoading:!1})}},createTask:async e=>{try{const t=await ue.createTask(e);n(r=>({tasks:[t,...r.tasks]}))}catch(t){throw console.error("Failed to create task",t),new Error("Failed to create task.")}},updateTask:async(e,t)=>{try{const r=await ue.updateTask(e,t);n(s=>({tasks:s.tasks.map(a=>a.id===e?r:a)}))}catch(r){throw console.error("Failed to update task",r),new Error("Failed to update task.")}},deleteTask:async e=>{try{await ue.deleteTask(e),n(t=>({tasks:t.tasks.filter(r=>r.id!==e)}))}catch(t){throw console.error("Failed to delete task",t),new Error("Failed to delete task.")}},runAutomaticEscalations:async()=>{try{const{updatedTasks:e,newNotifications:t}=await ue.runAutomaticEscalations();if(e.length>0&&n(r=>({tasks:r.tasks.map(s=>e.find(a=>a.id===s.id)||s)})),t.length>0){const r=t.map(s=>ue.createNotification(s));await Promise.all(r),ly.getState().fetchNotifications()}}catch(e){console.error("Failed to run automatic escalations",e)}}})),Ice=Pt({completionNotes:ge().required("Completion notes are required").min(10,"Please provide more detail."),completionPhoto:Wt().required("A photo proof of completion is required.").nullable()}).defined(),Ace=({isOpen:n,onClose:e,task:t,setToast:r})=>{const{updateTask:s}=_1(),[a,o]=ot.useState(!1),{handleSubmit:l,formState:{errors:c},reset:d,control:h}=tn({resolver:En(Ice),defaultValues:{completionNotes:"",completionPhoto:null}}),p=async x=>{o(!0);try{await s(t.id,{...x,status:"Done"}),r({message:"Task completed successfully!",type:"success"}),e()}catch{r({message:"Failed to complete task.",type:"error"})}finally{o(!1)}};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:x=>x.stopPropagation(),children:i.jsxs("form",{onSubmit:l(p),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Complete Task: ",t.name]}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Provide a summary and photo proof of your work."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"completionNotes",className:"block text-sm font-medium text-muted",children:"Completion Notes"}),i.jsx("textarea",{id:"completionNotes",rows:4,...h.register("completionNotes"),className:`mt-1 bg-card border ${c.completionNotes?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`}),c.completionNotes&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionNotes.message})]}),i.jsx(_e,{name:"completionPhoto",control:h,render:({field:x})=>i.jsx(yt,{label:"Upload Photo Proof",file:x.value,onFileChange:x.onChange,allowedTypes:["image/jpeg","image/png"]})}),c.completionPhoto&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionPhoto.message})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(se,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:a,children:"Mark as Done"})]})]})})}):null},Rce=n=>{const e=new Date;e.setHours(0,0,0,0);const t=o=>o?new Date(o):null;if(n.status==="Done"||!n.dueDate)return{date:n.dueDate?$e(t(n.dueDate),"dd MMM, yyyy"):"-",isOverdue:!1};let r=null;const s=t(n.dueDate);switch(n.escalationStatus){case"None":r=n.escalationLevel1DurationDays?xl(s,n.escalationLevel1DurationDays):s;break;case"Level 1":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays){const o=xl(s,n.escalationLevel1DurationDays);r=xl(o,n.escalationLevel2DurationDays)}break;case"Level 2":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays&&n.escalationEmailDurationDays){const o=xl(s,n.escalationLevel1DurationDays),l=xl(o,n.escalationLevel2DurationDays);r=xl(l,n.escalationEmailDurationDays)}break}r||(r=s);const a=r?r<e:!1;return{date:$e(r,"dd MMM, yyyy"),isOverdue:a}},Lce=()=>{const n=St(),{user:e}=jt(),{tasks:t,isLoading:r,error:s,fetchTasks:a,deleteTask:o,runAutomaticEscalations:l}=_1(),{theme:c}=Jc(),d=c==="dark",[h,p]=E.useState(!1),[x,v]=E.useState(!1),[w,_]=E.useState(null),[j,T]=E.useState(null),[P,D]=E.useState([]),[M,O]=E.useState("all"),[I,q]=E.useState("all"),[F,V]=E.useState("all"),U=Ft("(max-width: 767px)");E.useEffect(()=>{(async()=>{ue.getUsers().then(D),await a(),await l()})()},[a,l]);const W=()=>{n("/tasks/add")},$=Q=>{n(`/tasks/edit/${Q.id}`)},ne=Q=>{_(Q),p(!0)},Y=Q=>{_(Q),v(!0)},ae=async()=>{if(w)try{await o(w.id),T({message:"Task deleted.",type:"success"}),v(!1)}catch{T({message:"Failed to delete task.",type:"error"})}},J=E.useMemo(()=>t.filter(Q=>{if(M!=="all"&&Q.status!==M||I!=="all"&&Q.priority!==I)return!1;if(F==="unassigned"){if(Q.assignedToId)return!1}else if(F!=="all"&&Q.assignedToId!==F)return!1;return!0}),[t,M,I,F]),ee=()=>{O("all"),q("all"),V("all")},X=M!=="all"||I!=="all"||F!=="all",Z=Q=>{const re={High:d?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800",Medium:d?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800",Low:d?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${re[Q]}`,children:Q})},oe=Q=>{const re={"To Do":d?"bg-gray-500/20 text-gray-300":"bg-gray-100 text-gray-800","In Progress":d?"bg-indigo-500/20 text-indigo-300":"bg-indigo-100 text-indigo-800",Done:d?"bg-green-500/20 text-green-300":"bg-green-100 text-green-800"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${re[Q]}`,children:Q})},H=Q=>{if(Q==="None")return null;const re={None:"","Level 1":d?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-800","Level 2":d?"bg-amber-500/20 text-amber-400":"bg-amber-100 text-amber-800","Email Sent":d?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${re[Q]}`,children:Q})};return i.jsxs("div",{className:`min-h-screen ${U?"bg-[#041b0f] text-white p-4 pb-24":`p-4 ${d?"bg-[#041b0f] border border-white/10":"md:bg-card"} md:p-6 md:rounded-xl md:shadow-card`}`,children:[j&&i.jsx(ht,{message:j.message,type:j.type,onDismiss:()=>T(null)}),j&&i.jsx(ht,{message:j.message,type:j.type,onDismiss:()=>T(null)}),h&&w&&i.jsx(Ace,{isOpen:h,onClose:()=>p(!1),task:w,setToast:T}),i.jsxs(Yr,{isOpen:x,onClose:()=>v(!1),onConfirm:ae,title:"Confirm Deletion",children:['Are you sure you want to delete the task "',w?.name,'"?']}),i.jsx("div",{className:"mb-6",children:i.jsx("h1",{className:`text-2xl font-bold ${U||d?"text-white":"text-gray-900"}`,children:"Task Management"})}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 md:items-end justify-between",children:[i.jsxs("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${U||d?"text-gray-300":"text-gray-700"}`,children:"Filter by Status"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${U||d?"bg-[#152b1b] border-white/10 text-white":"bg-white border-gray-300 text-gray-900"}`,value:M,onChange:Q=>O(Q.target.value),children:[i.jsx("option",{value:"all",className:U||d?"bg-[#041b0f]":"",children:"All Statuses"}),i.jsx("option",{value:"To Do",className:U||d?"bg-[#041b0f]":"",children:"To Do"}),i.jsx("option",{value:"In Progress",className:U||d?"bg-[#041b0f]":"",children:"In Progress"}),i.jsx("option",{value:"Done",className:U||d?"bg-[#041b0f]":"",children:"Done"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${U||d?"text-gray-300":"text-gray-700"}`,children:"Filter by Priority"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${U||d?"bg-[#152b1b] border-white/10 text-white":"bg-white border-gray-300 text-gray-900"}`,value:I,onChange:Q=>q(Q.target.value),children:[i.jsx("option",{value:"all",className:U||d?"bg-[#041b0f]":"",children:"All Priorities"}),i.jsx("option",{value:"Low",className:U||d?"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:U||d?"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:U||d?"bg-[#041b0f]":"",children:"High"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${U||d?"text-gray-300":"text-gray-700"}`,children:"Filter by Assignee"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${U||d?"bg-[#152b1b] border-white/10 text-white":"bg-white border-gray-300 text-gray-900"}`,value:F,onChange:Q=>V(Q.target.value),children:[i.jsx("option",{value:"all",className:U||d?"bg-[#041b0f]":"",children:"All Users"}),i.jsx("option",{value:"unassigned",className:U||d?"bg-[#041b0f]":"",children:"Unassigned"}),P.map(Q=>i.jsx("option",{value:Q.id,className:U||d?"bg-[#041b0f]":"",children:Q.name},Q.id))]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 mt-4 md:mt-0",children:[X&&i.jsxs(se,{variant:"secondary",onClick:ee,className:U||d?"!bg-[#152b1b] !text-white !border-white/10":"",children:[i.jsx(xi,{className:"mr-2 h-4 w-4"})," Clear Filters"]}),i.jsxs("button",{onClick:W,className:`flex items-center justify-center transition-colors ${U?"!bg-[#32CD32] hover:!bg-[#28a428] !text-[#0D1A0D] !font-bold !border-none shadow-none text-sm py-3 px-6 rounded-xl":"bg-emerald-600 text-white hover:bg-emerald-700 rounded-lg px-6 py-2.5 font-medium"}`,children:[i.jsx(Bt,{className:"mr-2 h-5 w-5"})," Add Task"]})]})]}),s&&i.jsx("p",{className:"text-red-500 mb-4",children:s}),i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:U?"hidden":d?"bg-white/5 text-white":"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Task Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Priority"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Next Due Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Assigned To"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Escalation"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:`divide-y md:divide-y-0 ${U?"divide-white/10 space-y-4 block":d?"divide-white/10 bg-[#041b0f]":"divide-border md:bg-card"}`,children:r?U?i.jsx("tr",{children:i.jsx("td",{colSpan:7,children:i.jsx(Oa,{rows:3,cols:7,isMobile:!0})})}):i.jsx(Oa,{rows:5,cols:7}):J.map(Q=>{const{date:re,isOverdue:de}=Rce(Q);return U?i.jsxs("div",{className:"bg-[#152b1b] p-4 rounded-xl border border-white/5 mb-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-white text-lg",children:Q.name}),i.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Due: ",i.jsx("span",{className:de?"text-red-400 font-bold":"",children:re||"-"})]})]}),Z(Q.priority)]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500 block text-xs",children:"Assigned To"}),i.jsx("span",{className:"text-gray-300",children:Q.assignedToName||"-"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500 block text-xs",children:"Status"}),i.jsx("span",{className:"text-gray-300",children:Q.status})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 border-t border-white/10 pt-3",children:[i.jsx("button",{onClick:()=>$(Q),className:"p-2 text-gray-400 hover:text-white bg-white/5 rounded-lg",children:i.jsx(cr,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>Y(Q),className:"p-2 text-red-400 hover:text-red-300 bg-red-500/10 rounded-lg",children:i.jsx(rn,{className:"h-4 w-4"})}),Q.assignedToId===e?.id&&Q.status!=="Done"&&i.jsxs("button",{onClick:()=>ne(Q),className:"flex items-center px-3 py-2 bg-emerald-500/10 text-emerald-400 rounded-lg text-sm font-medium",children:[i.jsx(Yi,{className:"h-4 w-4 mr-1.5"})," Complete"]})]})]},Q.id):i.jsxs("tr",{className:de?"bg-red-50":d?"text-gray-300 hover:bg-white/5":"",children:[i.jsx("td",{"data-label":"Task Name",className:"px-6 py-4 font-medium",children:Q.name}),i.jsx("td",{"data-label":"Priority",className:"px-6 py-4",children:Z(Q.priority)}),i.jsx("td",{"data-label":"Next Due Date",className:`px-6 py-4 text-sm ${de?"font-bold text-red-600":"text-muted"}`,children:re||"-"}),i.jsx("td",{"data-label":"Assigned To",className:"px-6 py-4 text-sm text-muted",children:Q.assignedToName||"-"}),i.jsx("td",{"data-label":"Status",className:"px-6 py-4 text-sm text-muted",children:oe(Q.status)}),i.jsx("td",{"data-label":"Escalation",className:"px-6 py-4 text-sm text-muted",children:H(Q.escalationStatus)}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[i.jsx(se,{variant:"icon",size:"sm",onClick:()=>$(Q),title:"Edit Task",children:i.jsx(cr,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>Y(Q),title:"Delete Task",children:i.jsx(rn,{className:"h-4 w-4 text-red-600"})}),Q.assignedToId===e?.id&&Q.status!=="Done"&&i.jsxs(se,{variant:"outline",size:"sm",onClick:()=>ne(Q),children:[i.jsx(Yi,{className:"h-4 w-4 mr-2"})," Complete"]})]})})]},Q.id)})})]}),!r&&J.length===0&&i.jsxs("div",{className:"text-center py-10 text-muted",children:[i.jsx("p",{className:U||d?"text-gray-400":"",children:"No tasks found matching your criteria."}),X&&i.jsx(se,{variant:"secondary",size:"sm",className:"mt-2",onClick:ee,children:"Clear filters"})]})]})]})},Fce=Pt({id:ge().required(),name:ge().required("Client name is required"),organizationId:ge().optional(),location:ge().optional(),registeredAddress:ge().optional(),registrationType:ge().oneOf(["CIN","ROC","ROF","Society","Trust",""]).optional(),registrationNumber:ge().optional(),gstNumber:ge().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,"Invalid GST Number format").optional(),panNumber:ge().transform(n=>n?.toUpperCase()||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,"Invalid PAN format").optional(),email:ge().email("Invalid email format").optional(),eShramNumber:ge().optional(),shopAndEstablishmentCode:ge().optional(),epfoCode:ge().optional(),esicCode:ge().optional(),psaraLicenseNumber:ge().optional(),psaraValidTill:ge().optional().nullable(),insuranceIds:_s().of(ge().required()).optional(),policyIds:_s().of(ge().required()).optional()}).defined(),qce=({isOpen:n,onClose:e,onSave:t,initialData:r,companyName:s})=>{const[a,o]=E.useState("General"),[l,c]=E.useState([]),[d,h]=E.useState([]),[p,x]=E.useState(!0),{register:v,handleSubmit:w,formState:{errors:_},reset:j,control:T}=tn({resolver:En(Fce)}),P=!!r;E.useEffect(()=>{n&&(x(!0),Promise.all([ue.getPolicies(),ue.getInsurances()]).then(([O,I])=>{c(O),h(I),x(!1)}),j(r||{id:`new_${Date.now()}`,name:"",location:"",registeredAddress:"",registrationType:"",registrationNumber:"",gstNumber:"",panNumber:"",email:"",eShramNumber:"",shopAndEstablishmentCode:"",epfoCode:"",esicCode:"",psaraLicenseNumber:"",psaraValidTill:"",insuranceIds:[],policyIds:[]}))},[r,j,n]);const D=O=>{t(O)};if(!n)return null;const M=({tabName:O})=>i.jsx("button",{type:"button",onClick:()=>o(O),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${a===O?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:O});return i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-3xl my-8 mx-auto animate-fade-in-scale",onClick:O=>O.stopPropagation(),children:i.jsxs("form",{onSubmit:w(D),children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:P?"Edit Client":"Add New Client"}),i.jsxs("p",{className:"text-sm text-muted",children:["for ",s]})]}),i.jsx("div",{className:"border-b border-border mb-6",children:i.jsxs("nav",{className:"-mb-px flex space-x-4",children:[i.jsx(M,{tabName:"General"}),i.jsx(M,{tabName:"Registration"}),i.jsx(M,{tabName:"Compliance"}),i.jsx(M,{tabName:"Policies & Insurance"})]})}),i.jsxs("div",{className:"space-y-6 min-h-[300px]",children:[a==="General"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(je,{label:"Client Name (as per document)",id:"name",registration:v("name"),error:_.name?.message}),i.jsx(je,{label:"Location / City",id:"location",registration:v("location"),error:_.location?.message}),i.jsx(je,{label:"Registered Address",id:"registeredAddress",registration:v("registeredAddress"),error:_.registeredAddress?.message})]}),a==="Registration"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsxs(Ke,{label:"Registration Type",id:"registrationType",registration:v("registrationType"),error:_.registrationType?.message,children:[i.jsx("option",{value:"",children:"Select Type"}),i.jsx("option",{value:"CIN",children:"CIN"}),i.jsx("option",{value:"ROC",children:"ROC"}),i.jsx("option",{value:"ROF",children:"ROF"}),i.jsx("option",{value:"Society",children:"Society"}),i.jsx("option",{value:"Trust",children:"Trust"})]}),i.jsx(je,{label:"Registration Number",id:"registrationNumber",registration:v("registrationNumber"),error:_.registrationNumber?.message}),i.jsx(je,{label:"GST Number",id:"gstNumber",registration:v("gstNumber"),error:_.gstNumber?.message}),i.jsx(je,{label:"PAN Number",id:"panNumber",registration:v("panNumber"),error:_.panNumber?.message}),i.jsx(je,{label:"Email Address",id:"email",type:"email",registration:v("email"),error:_.email?.message})]}),a==="Compliance"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(je,{label:"E-Shram Number",id:"eShramNumber",registration:v("eShramNumber"),error:_.eShramNumber?.message}),i.jsx(je,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:v("shopAndEstablishmentCode"),error:_.shopAndEstablishmentCode?.message}),i.jsx(je,{label:"EPFO Code",id:"epfoCode",registration:v("epfoCode"),error:_.epfoCode?.message}),i.jsx(je,{label:"ESIC Code",id:"esicCode",registration:v("esicCode"),error:_.esicCode?.message}),i.jsx(je,{label:"PSARA License Number",id:"psaraLicenseNumber",registration:v("psaraLicenseNumber"),error:_.psaraLicenseNumber?.message}),i.jsx(_e,{name:"psaraValidTill",control:T,render:({field:O})=>i.jsx(kn,{label:"PSARA Valid Till",id:"psaraValidTill",value:O.value,onChange:O.onChange,error:_.psaraValidTill?.message})})]}),a==="Policies & Insurance"&&(p?i.jsx(_t,{className:"mx-auto h-6 w-6 animate-spin text-muted"}):i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsx(_e,{name:"policyIds",control:T,render:({field:O})=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Policies"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:l.map(I=>i.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:O.value?.includes(I.id),onChange:q=>{const F=q.target.checked?[...O.value||[],I.id]:(O.value||[]).filter(V=>V!==I.id);O.onChange(F)}}),i.jsx("span",{className:"ml-3 text-sm",children:I.name})]},I.id))})]})}),i.jsx(_e,{name:"insuranceIds",control:T,render:({field:O})=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Insurance"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:d.map(I=>i.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:O.value?.includes(I.id),onChange:q=>{const F=q.target.checked?[...O.value||[],I.id]:(O.value||[]).filter(V=>V!==I.id);O.onChange(F)}}),i.jsxs("span",{className:"ml-3 text-sm",children:[I.type," - ",I.provider]})]},I.id))})]})})]}))]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[i.jsx(se,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(se,{type:"submit",children:P?"Save Changes":"Add Client"})]})]})})})},Jg=({number:n,title:e,children:t})=>i.jsxs("div",{children:[i.jsxs("h4",{className:"font-bold text-lg text-primary-text mb-2",children:["Step ",n,": ",e]}),i.jsx("div",{className:"text-sm text-muted space-y-2",children:t})]}),zce=({isOpen:n,onClose:e})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-3xl my-8 animate-fade-in-scale flex flex-col",onClick:t=>t.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex items-center gap-3",children:[i.jsx(ls,{className:"h-6 w-6 text-accent"}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"How to Use Import Templates"})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[70vh]",children:[i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(Da,{className:"h-5 w-5 text-red-500 mr-3 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-red-800",children:"The Golden Rule: Do Not Modify the Template Structure"}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:"You must **NEVER** add, delete, rename, or reorder columns. Any changes to the header row will cause the import to fail. This rule ensures data integrity."})]})]})}),i.jsxs(Jg,{number:1,title:"Get the Template",children:[i.jsx("p",{children:"You have two options for getting a file to work with:"}),i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(ls,{className:"h-4 w-4"})," Download Template:"]}),i.jsx("span",{children:"Provides a blank CSV file with only the correct header row. Use this for adding **new** records in bulk."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(s3,{className:"h-4 w-4"})," Export Data:"]}),i.jsx("span",{children:"Provides a CSV file filled with all the current data from the system. Use this for **updating existing** records in bulk."})]})]})]}),i.jsx(Jg,{number:2,title:"Edit Your Data",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(cr,{className:"h-4 w-4"})," To Update Existing Data:"]}),i.jsx("span",{children:"Use the file from **Export Data**. Find the row you want to change and edit its values. Do **NOT** edit the ID columns (e.g., `GroupId`, `EntityId`). These are used by the system to identify records."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(Bt,{className:"h-4 w-4"})," To Add New Data:"]}),i.jsx("span",{children:"Add a new row at the bottom of the file. Leave the ID columns blank; the system will generate them automatically. Fill in all other required information."})]}),i.jsxs("li",{children:[i.jsx("strong",{className:"text-primary-text",children:"Complex Data (JSON):"}),i.jsx("span",{children:"For Site Configuration, some columns like `agreementDetails` contain complex data. This is exported as a JSON text string. Only edit this text if you are familiar with JSON, as incorrect formatting will cause the import to fail."})]})]})}),i.jsx(Jg,{number:3,title:"Save and Import",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsx("strong",{className:"text-primary-text",children:"Save as CSV:"}),i.jsx("span",{children:"After making your changes, save your file. If you are using Excel or Google Sheets, make sure to **Save As** or **Download As** a **CSV (Comma-Separated Values)** file."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(vJ,{className:"h-4 w-4"})," Import:"]}),i.jsx("span",{children:"Go back to the application, click **Import**, and select the CSV file you just saved."})]})]})}),i.jsx(Jg,{number:4,title:"Review Feedback",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-green-600 flex items-center gap-2",children:[i.jsx(Yi,{className:"h-4 w-4"})," Success:"]}),i.jsx("span",{children:"You will see a success message indicating how many records were imported."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-red-600 flex items-center gap-2",children:[i.jsx(Da,{className:"h-4 w-4"})," Error:"]}),i.jsx("span",{children:'If the import fails, a specific error message will appear. The most common error is a "Header mismatch," which means you have violated the Golden Rule. If this happens, download a fresh template and carefully copy your data into it.'})]})]})})]}),i.jsx("div",{className:"p-4 border-t flex justify-end",children:i.jsx(se,{onClick:e,children:"Close"})})]})}):null,ld=({title:n})=>i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8 bg-page rounded-lg min-h-[400px]",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text mb-2",children:n}),i.jsx("p",{className:"text-muted max-w-sm",children:"Configuration for this section will be available here. The form details will be provided in a future update."})]}),WL=["Site Name","Designation","Quantity","Billing Rate","Billing Model","Holiday Billing Policy","Holiday Payment Policy","Uniform Deduction"],Uce=n=>{if(n.length===0)return"";const e=Object.keys(n[0]);return[e.join(","),...n.map(r=>e.map(s=>{const a=String(r[s]??"");return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(","))].join(`
`)},Vce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim()),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'""')),a[l]=d}),r.push(a)}return r},Bce=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState({}),[c,d]=E.useState(null),h=E.useRef(null),{register:p,control:x,handleSubmit:v,watch:w,setValue:_}=tn({defaultValues:{resources:[],serviceChargePercentage:10}}),{fields:j,append:T,remove:P,replace:D}=js({control:x,name:"resources"});E.useEffect(()=>{ue.getOrganizations().then(e).finally(()=>r(!1))},[]);const M=async ae=>{if(!ae){D([]);return}a(!0);try{const J=await ue.getManpowerDetails(ae),ee=J.filter(X=>X.count>0).map(X=>({id:`res_${X.designation.replace(/\s/g,"_")}_${Date.now()}`,siteId:ae,designation:X.designation,quantity:X.count,billingRate:null,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"}));if(!o[ae]){const X=J.map(Z=>Z.designation);l(Z=>({...Z,[ae]:X}))}D(ee)}catch(J){console.error("Failed to load manpower",J),d({message:"Failed to load manpower details.",type:"error"})}finally{a(!1)}},O=async(ae,J)=>{if(_(`resources.${J}.designation`,""),ae&&!o[ae])try{const X=(await ue.getManpowerDetails(ae)).map(Z=>Z.designation);l(Z=>({...Z,[ae]:X}))}catch(ee){console.error(`Failed to load designations for site ${ae}`,ee)}},I=w("resources"),q=w("serviceChargePercentage"),F=()=>{T({id:`res_${Date.now()}`,siteId:"",designation:"",quantity:1,billingRate:0,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"})},{subTotal:V,serviceCharge:U,grandTotal:W}=ot.useMemo(()=>{const J=(Array.isArray(I)?I:[]).reduce((oe,H)=>{const Q=Number(H.quantity)||0,re=Number(H.billingRate)||0;return oe+Q*re},0),ee=Number(q)||0,X=J*(ee/100),Z=J+X;return{subTotal:J,serviceCharge:X,grandTotal:Z}},[I,q]),$=()=>{const ae=[Object.fromEntries(WL.map(Z=>[Z,""]))],J=Uce(ae),ee=new Blob([J],{type:"text/csv;charset=utf-8;"}),X=document.createElement("a");X.href=URL.createObjectURL(ee),X.setAttribute("download","costing_resource_template.csv"),document.body.appendChild(X),X.click(),document.body.removeChild(X)},ne=ae=>{const J=ae.target.files?.[0];if(!J)return;const ee=new FileReader;ee.onload=async X=>{try{const Z=X.target?.result;if(!Z)throw new Error("File is empty.");const oe=Vce(Z);if(oe.length===0)throw new Error("No data rows found in CSV.");const H=Object.keys(oe[0]);if(!WL.every(ie=>H.includes(ie)))throw new Error("CSV file is missing required headers.");const re=new Map(n.map(ie=>[ie.shortName.toLowerCase(),ie.id])),de=new Set;for(const ie of oe){const xe=ie["Site Name"]?.trim().toLowerCase();if(xe){const Ce=re.get(xe);typeof Ce=="string"&&de.add(Ce)}}const ce=[...de].filter(ie=>!o[ie]);if(ce.length>0){const ie=ce.map(Ce=>ue.getManpowerDetails(Ce).then(ve=>({siteId:Ce,designations:ve.map(Oe=>Oe.designation)}))),xe=await Promise.all(ie);l(Ce=>{const ve={...Ce};return xe.forEach(Oe=>{ve[Oe.siteId]=Oe.designations}),ve})}const pe=oe.map(ie=>{const xe=ie["Site Name"]?.trim().toLowerCase(),Ce=xe?re.get(xe):void 0;return Ce?{id:`res_imported_${Date.now()}_${Math.random()}`,siteId:Ce,designation:ie.Designation||"",quantity:parseFloat(ie.Quantity)||0,billingRate:parseFloat(ie["Billing Rate"])||0,billingModel:ie["Billing Model"]||"Per Month",holidayBillingPolicy:ie["Holiday Billing Policy"]||"",holidayPaymentPolicy:ie["Holiday Payment Policy"]||"",uniformDeduction:ie["Uniform Deduction"]||"Yes"}:null}).filter(ie=>ie!==null);D(pe),d({message:`Successfully imported ${pe.length} resources.`,type:"success"})}catch(Z){d({message:Z.message||"Failed to import CSV.",type:"error"})}finally{ae.target&&(ae.target.value="")}},ee.readAsText(J)},Y=ae=>{console.log("Saving Costing & Resource Data:",ae),d({message:"Configuration saved successfully (mocked).",type:"success"})};return i.jsxs("form",{onSubmit:v(Y),className:"space-y-6",children:[c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsx("input",{type:"file",ref:h,className:"hidden",accept:".csv",onChange:ne}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Costing & Resource Configuration"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsxs(Ke,{label:"Load Manpower from Site",id:"site-selector",onChange:ae=>M(ae.target.value),disabled:t||s,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),n.map(ae=>i.jsx("option",{value:ae.id,children:ae.shortName},ae.id))]}),s&&i.jsx(_t,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 md:flex md:flex-wrap md:justify-end md:gap-2",children:[i.jsxs(se,{type:"button",variant:"outline",onClick:$,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Download Template",children:[i.jsx(yi,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Template"})]}),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>h.current?.click(),className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Import",children:[i.jsx(Wc,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Import"})]}),i.jsxs(se,{type:"button",variant:"outline",onClick:F,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Add Resource",children:[i.jsx(Bt,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Add Resource"})]}),i.jsxs(se,{type:"submit",className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Save",children:[i.jsx(Ss,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Save"})]})]}),i.jsx("div",{className:"space-y-4",children:j.map((ae,J)=>{const ee=w(`resources.${J}.siteId`);return i.jsxs("div",{className:"p-4 border border-border rounded-xl relative bg-page/50",children:[i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>P(J),className:"absolute top-2 right-2","aria-label":"Remove Resource",children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsx(_e,{control:x,name:`resources.${J}.siteId`,render:({field:X})=>i.jsxs(Ke,{label:"Site",id:`res-site-${J}`,...X,onChange:Z=>{X.onChange(Z),O(Z.target.value,J)},children:[i.jsx("option",{value:"",children:"Select Site"}),n.map(Z=>i.jsx("option",{value:Z.id,children:Z.shortName},Z.id))]})}),i.jsxs(Ke,{label:"Designation",id:`res-desig-${J}`,...p(`resources.${J}.designation`),disabled:!ee,children:[i.jsx("option",{value:"",children:"Select Designation"}),(o[ee]||[]).map(X=>i.jsx("option",{value:X,children:X},X))]}),i.jsx(je,{label:"Quantity",id:`res-qty-${J}`,type:"number",step:"0.01",...p(`resources.${J}.quantity`)}),i.jsx(je,{label:"Billing Rate",id:`res-rate-${J}`,type:"number",step:"0.01",...p(`resources.${J}.billingRate`)}),i.jsxs(Ke,{label:"Billing Model",id:`res-billing-${J}`,...p(`resources.${J}.billingModel`),children:[i.jsx("option",{children:"Per Month"}),i.jsx("option",{children:"Per Day"}),i.jsx("option",{children:"Per Hour"}),i.jsx("option",{children:"Lumpsum"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:`res-hol-bill-${J}`,className:"block text-sm font-medium text-muted",children:"Holiday Billing Policy"}),i.jsx("textarea",{id:`res-hol-bill-${J}`,...p(`resources.${J}.holidayBillingPolicy`),rows:3,className:"mt-1 form-input"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`res-hol-pay-${J}`,className:"block text-sm font-medium text-muted",children:"Holiday Payment Policy"}),i.jsx("textarea",{id:`res-hol-pay-${J}`,...p(`resources.${J}.holidayPaymentPolicy`),rows:3,className:"mt-1 form-input"})]}),i.jsxs(Ke,{label:"Uniform Deduction",id:`res-uniform-${J}`,...p(`resources.${J}.uniformDeduction`),children:[i.jsx("option",{children:"Yes"}),i.jsx("option",{children:"No"})]})]})]},ae.id)})}),j.length>0&&i.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:i.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsx("span",{className:"text-muted font-medium",children:"Sub Total"}),i.jsx("span",{className:"font-semibold text-primary-text",children:V.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-muted font-medium",children:"Service Charges"}),i.jsx("div",{className:"w-20",children:i.jsx(je,{"aria-label":"Service charge percentage",id:"service-charge-perc",type:"number",...p("serviceChargePercentage")})}),i.jsx("span",{className:"text-muted font-medium",children:"%"})]}),i.jsx("span",{className:"font-semibold text-primary-text",children:U.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),i.jsxs("div",{className:"flex justify-between items-center pt-2 mt-2 border-t-2 border-primary-text",children:[i.jsx("span",{className:"font-bold text-lg",children:"Grand Total"}),i.jsx("span",{className:"font-bold text-lg",children:W.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]})]})}),j.length===0&&i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:t?i.jsx(_t,{className:"h-5 w-5 animate-spin mx-auto"}):'Select a site to load manpower or click "Add Resource" to begin.'})]})},J6=["Department","Designation","PermanentId","TemporaryId"],Wce=n=>{const e=J6.join(","),t=n.map(r=>[r.department,r.designation,r.permanentId,r.temporaryId].map(s=>{const a=String(s??"");return a.includes(",")?`"${a}"`:a}).join(","));return[e,...t].join(`
`)},$ce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim());if(!["Department","Designation","PermanentId","TemporaryId"].every(s=>t.includes(s)))throw new Error("CSV is missing required headers.");return e.slice(1).map(s=>{const a=s.split(","),o={};return t.forEach((l,c)=>{l==="Department"&&(o.department=a[c]),l==="Designation"&&(o.designation=a[c]),l==="PermanentId"&&(o.permanentId=a[c]),l==="TemporaryId"&&(o.temporaryId=a[c])}),o})},Hce=()=>{const[n,e]=E.useState(!0),[t,r]=E.useState(null),s=E.useRef(null),{register:a,control:o,handleSubmit:l,reset:c,watch:d}=tn({defaultValues:{series:[]}}),{append:h,remove:p,replace:x}=js({control:o,name:"series"});E.useEffect(()=>{e(!0),ue.getBackOfficeIdSeries().then(M=>c({series:M})).catch(()=>r({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const v=d("series"),w=E.useMemo(()=>Array.isArray(v)?v.reduce((M,O,I)=>{const q=O.department||"Uncategorized";return M[q]||(M[q]=[]),M[q].push({...O,originalIndex:I}),M},{}):{},[v]),_=()=>{h({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:""})},j=async M=>{try{await ue.updateBackOfficeIdSeries(M.series),r({message:"Configuration saved successfully.",type:"success"})}catch{r({message:"Failed to save configuration.",type:"error"})}},T=()=>{if(!Array.isArray(v)||v.length===0){r({message:"No data to export.",type:"error"});return}const M=Wce(v),O=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(O),I.setAttribute("download","back_office_id_series.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},P=()=>{const M=J6.join(","),O=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(O),I.setAttribute("download","id_series_template.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},D=M=>{const O=M.target.files?.[0];if(!O)return;const I=new FileReader;I.onload=q=>{try{const F=q.target?.result,U=$ce(F).map(W=>({id:`imported_${Date.now()}_${Math.random()}`,department:W.department||"",designation:W.designation||"",permanentId:W.permanentId||"",temporaryId:W.temporaryId||""}));x(U),r({message:`Imported ${U.length} records.`,type:"success"})}catch(F){r({message:F.message||"Failed to import CSV.",type:"error"})}finally{M.target&&(M.target.value="")}},I.readAsText(O)};return i.jsxs("form",{onSubmit:l(j),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(ht,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:D}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Back Office Department & Emp ID Series"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(se,{type:"button",variant:"outline",onClick:P,children:[i.jsx(ls,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Wc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(se,{type:"button",variant:"outline",onClick:T,children:[i.jsx(yi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(se,{type:"submit",children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsx("div",{className:"space-y-6",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(w).length===0?i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No ID series defined. Click "Add Designation" to begin.'}):Object.entries(w).map(([M,O])=>i.jsxs("div",{className:"border border-border rounded-xl",children:[i.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:i.jsx(je,{"aria-label":`Department for ${M}`,id:`series.${O[0].originalIndex}.department`,...a(`series.${O[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),i.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(O)&&O.map(I=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-10 gap-2 items-center",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Designation","aria-label":`Designation for ${M}`,id:`series.${I.originalIndex}.designation`,...a(`series.${I.originalIndex}.designation`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${I.designation}`,id:`series.${I.originalIndex}.permanentId`,...a(`series.${I.originalIndex}.permanentId`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${I.designation}`,id:`series.${I.originalIndex}.temporaryId`,...a(`series.${I.originalIndex}.temporaryId`)})}),i.jsx("div",{className:"md:col-span-1 text-right",children:i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>p(I.originalIndex),"aria-label":`Remove ${I.designation}`,title:`Remove ${I.designation}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},I.id))})]},M))}),i.jsxs(se,{type:"button",onClick:_,variant:"outline",className:"mt-6",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},Yx=["Department","Designation","PermanentId","TemporaryId","MonthlySalary"],Yce=n=>{const e=Yx.join(","),t=n.map(r=>[r.department,r.designation,r.permanentId,r.temporaryId,r.monthlySalary].map(s=>{const a=String(s??"");return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(","));return[e,...t].join(`
`)},Gce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,""));if(!Yx.every(s=>t.includes(s)))throw new Error(`CSV is missing required headers: ${Yx.join(", ")}`);const r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((c,d)=>{let h=(o[d]||"").trim();h.startsWith('"')&&h.endsWith('"')&&(h=h.substring(1,h.length-1).replace(/""/g,'""')),a[c]=h});const l=parseFloat(a.MonthlySalary);r.push({department:a.Department,designation:a.Designation,permanentId:a.PermanentId,temporaryId:a.TemporaryId,monthlySalary:isNaN(l)?null:l})}return r},Zce=()=>{const[n,e]=E.useState(!0),[t,r]=E.useState(null),s=E.useRef(null),{register:a,control:o,handleSubmit:l,reset:c,watch:d}=tn({defaultValues:{designations:[]}}),{append:h,remove:p,replace:x}=js({control:o,name:"designations"});E.useEffect(()=>{e(!0),ue.getSiteStaffDesignations().then(M=>c({designations:M})).catch(()=>r({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const v=d("designations"),w=E.useMemo(()=>Array.isArray(v)?v.reduce((M,O,I)=>{const q=O.department||"Uncategorized";return M[q]||(M[q]=[]),M[q].push({...O,originalIndex:I}),M},{}):{},[v]),_=()=>{h({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:"",monthlySalary:null})},j=async M=>{try{await ue.updateSiteStaffDesignations(M.designations),r({message:"Configuration saved successfully.",type:"success"})}catch{r({message:"Failed to save configuration.",type:"error"})}},T=()=>{if(!Array.isArray(v)||v.length===0){r({message:"No data to export.",type:"error"});return}const M=Yce(v),O=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(O),I.setAttribute("download","site_staff_designations.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},P=()=>{const M=Yx.join(","),O=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(O),I.setAttribute("download","site_staff_template.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},D=M=>{const O=M.target.files?.[0];if(!O)return;const I=new FileReader;I.onload=q=>{try{const F=q.target?.result,U=Gce(F).map(W=>({id:`imported_${Date.now()}_${Math.random()}`,department:W.department||"",designation:W.designation||"",permanentId:W.permanentId||"",temporaryId:W.temporaryId||"",monthlySalary:W.monthlySalary||null}));x(U),r({message:`Imported ${U.length} records.`,type:"success"})}catch(F){r({message:F.message||"Failed to import CSV.",type:"error"})}finally{M.target&&(M.target.value="")}},I.readAsText(O)};return i.jsxs("form",{onSubmit:l(j),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(ht,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:D}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Staff Designation & ID Series"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(se,{type:"button",variant:"outline",onClick:P,children:[i.jsx(ls,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Wc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(se,{type:"button",variant:"outline",onClick:T,children:[i.jsx(yi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(se,{type:"submit",children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsx("div",{className:"space-y-6",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(w).length===0?i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No designations defined. Click "Add Designation" to begin.'}):Object.entries(w).map(([M,O])=>i.jsxs("div",{className:"border border-border rounded-xl",children:[i.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:i.jsx(je,{"aria-label":`Department for ${M}`,id:`designations.${O[0].originalIndex}.department`,...a(`designations.${O[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),i.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(O)&&O.map(I=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-center",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Designation","aria-label":`Designation for ${M}`,id:`designations.${I.originalIndex}.designation`,...a(`designations.${I.originalIndex}.designation`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${I.designation}`,id:`designations.${I.originalIndex}.permanentId`,...a(`designations.${I.originalIndex}.permanentId`)})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(je,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${I.designation}`,id:`designations.${I.originalIndex}.temporaryId`,...a(`designations.${I.originalIndex}.temporaryId`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{placeholder:"Monthly Salary (Gross)","aria-label":`Salary for ${I.designation}`,id:`designations.${I.originalIndex}.monthlySalary`,type:"number",...a(`designations.${I.originalIndex}.monthlySalary`,{valueAsNumber:!0})})}),i.jsx("div",{className:"md:col-span-1 text-right",children:i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>p(I.originalIndex),"aria-label":`Remove ${I.designation}`,title:`Remove ${I.designation}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},I.id))})]},M))}),i.jsxs(se,{type:"button",onClick:_,variant:"outline",className:"mt-4",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},Kce=({id:n,label:e,checked:t,onChange:r,description:s,disabled:a})=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{className:"flex-grow flex flex-col",children:[i.jsx("span",{className:"text-sm font-medium text-primary-text",children:e}),s&&i.jsx("span",{className:"text-sm text-muted",children:s})]}),i.jsxs("div",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",id:n,className:"sr-only peer",checked:t,onChange:o=>r(o.target.checked),disabled:a}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-accent-dark peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent"})]})]}),XS=["Applicability","OptInDisclaimer","CoverageDetails","OptOutDisclaimer","RequireAlternateInsurance","CollectProvider","CollectStartDate","CollectEndDate","CollectExtentOfCover"],Jce={applicability:"Optional - Opt-in Default",optInDisclaimer:"",coverageDetails:"",optOutDisclaimer:"",requireAlternateInsurance:!1,collectProvider:!1,collectStartDate:!1,collectEndDate:!1,collectExtentOfCover:!1},Qce=n=>{const e=XS.join(","),t=XS.map(r=>{const s=r.charAt(0).toLowerCase()+r.slice(1);let a=n[s];return typeof a=="string"&&(a.includes(",")||a.includes(`
`)||a.includes('"'))?`"${a.replace(/"/g,'""')}"`:a});return[e,t.join(",")].join(`
`)},Xce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)throw new Error("CSV file must have a header and at least one data row.");const t=e[0].split(",").map(a=>a.trim()),r=e[1].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[],s={};return t.forEach((a,o)=>{const l=a.charAt(0).toLowerCase()+a.slice(1);let c=(r[o]||"").trim();c.startsWith('"')&&c.endsWith('"')&&(c=c.substring(1,c.length-1).replace(/""/g,'""')),l==="applicability"?s[l]=c:typeof Jce[l]=="boolean"?s[l]=c.toLowerCase()==="true":s[l]=c}),s},Qg=({label:n,...e})=>i.jsxs("label",{className:"flex items-center gap-2 text-sm text-muted",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",...e}),n]}),ede=()=>{const{gmcPolicy:n,updateGmcPolicySettings:e}=gi(),[t,r]=E.useState(null),s=E.useRef(null),{register:a,handleSubmit:o,control:l,watch:c,reset:d,formState:{isDirty:h}}=tn({defaultValues:n});E.useEffect(()=>{d(n)},[n,d]);const p=c("requireAlternateInsurance"),x=c("applicability")==="Mandatory",v=T=>{e(T),r({message:"GMC policy settings saved.",type:"success"})},w=()=>{const T=Qce(n),P=new Blob([T],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a");D.href=URL.createObjectURL(P),D.setAttribute("download","gmc_policy_settings.csv"),document.body.appendChild(D),D.click(),document.body.removeChild(D)},_=()=>{const T=XS.join(","),P=new Blob([T],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a");D.href=URL.createObjectURL(P),D.setAttribute("download","gmc_policy_template.csv"),document.body.appendChild(D),D.click(),document.body.removeChild(D)},j=T=>{const P=T.target.files?.[0];if(!P)return;const D=new FileReader;D.onload=M=>{try{const O=M.target?.result,I=Xce(O);d(I),r({message:"Settings imported from CSV. Review and save.",type:"success"})}catch(O){r({message:O.message||"Failed to import CSV.",type:"error"})}finally{T.target&&(T.target.value="")}},D.readAsText(P)};return i.jsxs("form",{onSubmit:o(v),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(ht,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:j}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"GMC Policy Configuration"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(se,{type:"button",variant:"outline",onClick:_,children:[i.jsx(ls,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Wc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(se,{type:"button",variant:"outline",onClick:w,children:[i.jsx(yi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(se,{type:"submit",disabled:!h,children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{children:i.jsx(_e,{name:"applicability",control:l,render:({field:T})=>i.jsxs(Ke,{label:"Applicability",...T,children:[i.jsx("option",{children:"Mandatory"}),i.jsx("option",{children:"Optional - Opt-in Default"}),i.jsx("option",{children:"Optional - Opt-out Default"})]})})}),i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-In Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-In Disclaimer"}),i.jsx("textarea",{...a("optInDisclaimer"),rows:3,className:"form-input mt-1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Coverage Details"}),i.jsx("textarea",{...a("coverageDetails"),rows:2,className:"form-input mt-1"})]})]}),!x&&i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-Out Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-Out Disclaimer"}),i.jsx("textarea",{...a("optOutDisclaimer"),rows:3,className:"form-input mt-1"})]}),i.jsx(_e,{name:"requireAlternateInsurance",control:l,render:({field:T})=>i.jsx(Kce,{id:"require-alt-ins",label:"Require proof of alternate insurance on opt-out",checked:T.value,onChange:T.onChange})}),p&&i.jsxs("div",{className:"p-4 bg-page rounded-lg space-y-3",children:[i.jsx("p",{className:"text-sm text-muted",children:"Collect the following from employees who opt out:"}),i.jsx(_e,{name:"collectProvider",control:l,render:({field:T})=>i.jsx(Qg,{label:"Provider Name",checked:T.value,onChange:T.onChange})}),i.jsx(_e,{name:"collectStartDate",control:l,render:({field:T})=>i.jsx(Qg,{label:"Policy Start Date",checked:T.value,onChange:T.onChange})}),i.jsx(_e,{name:"collectEndDate",control:l,render:({field:T})=>i.jsx(Qg,{label:"Policy End Date",checked:T.value,onChange:T.onChange})}),i.jsx(_e,{name:"collectExtentOfCover",control:l,render:({field:T})=>i.jsx(Qg,{label:"Extent of Cover (Sum Assured)",checked:T.value,onChange:T.onChange})})]})]})]})]})},Q6=[{key:"Phone",label:"Phone",icon:LJ},{key:"Computer",label:"Computer / Laptop",icon:CJ},{key:"Vehicle",label:"Vehicle",icon:cJ},{key:"Sim",label:"SIM Card",icon:mJ},{key:"IdCard",label:"Identity Card",icon:hJ},{key:"Petrocard",label:"Petrocard",icon:r3},{key:"Tools",label:"Tools",icon:NJ},{key:"Other",label:"Other Asset",icon:xm}],tde=({assetType:n,...e})=>{switch(n){case"Phone":return i.jsx(nde,{...e});case"Computer":return i.jsx(sde,{...e});case"Vehicle":return i.jsx(ode,{...e});case"Sim":return i.jsx(rde,{...e});case"IdCard":return i.jsx(ide,{...e});case"Petrocard":return i.jsx(ade,{...e});case"Tools":return i.jsx(lde,{...e});case"Other":return i.jsx(cde,{...e});default:return null}},nde=({index:n,control:e})=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4",children:[i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(je,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.imei`,control:e,render:({field:t})=>i.jsx(je,{label:"IMEI Number",...t})}),i.jsx(_e,{name:`assets.${n}.color`,control:e,render:({field:t})=>i.jsx(je,{label:"Colour",...t})}),i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Charger",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Charger"}),i.jsx("option",{children:"Without Charger"})]})}),i.jsx(_e,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Display Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Body Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),rde=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(_e,{name:`assets.${n}.number`,control:e,render:({field:t})=>i.jsx(je,{label:"SIM Number",...t})})}),sde=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.computerType`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Type",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Laptop"}),i.jsx("option",{children:"Desktop"}),i.jsx("option",{children:"Tab"})]})}),i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(je,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>i.jsx(je,{label:"Serial Number",...t})}),i.jsx(_e,{name:`assets.${n}.windowsKey`,control:e,render:({field:t})=>i.jsx(je,{label:"Windows Key",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Charger",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Charger"}),i.jsx("option",{children:"Without Charger"})]})}),i.jsx(_e,{name:`assets.${n}.bagStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Bag",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Bag"}),i.jsx("option",{children:"Without Bag"})]})}),i.jsx(_e,{name:`assets.${n}.mouseStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Mouse",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Mouse"}),i.jsx("option",{children:"Without Mouse"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Display Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Body Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.officeStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"MS Office",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Office"}),i.jsx("option",{children:"Without Office"})]})}),i.jsx(_e,{name:`assets.${n}.antivirusStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Antivirus",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Antivirus"}),i.jsx("option",{children:"Without Antivirus"})]})})]}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),ide=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(_e,{name:`assets.${n}.issueDate`,control:e,render:({field:t})=>i.jsx(kn,{label:"Date Issued",id:t.name,value:t.value,onChange:t.onChange})})}),ade=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(_e,{name:`assets.${n}.number`,control:e,render:({field:t})=>i.jsx(je,{label:"Petrocard Number",...t})})}),ode=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.vehicleType`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Vehicle Type",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Bicycle"}),i.jsx("option",{children:"Two Wheeler"}),i.jsx("option",{children:"Three Wheeler"}),i.jsx("option",{children:"Four Wheeler"})]})}),i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(je,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.vehicleNumber`,control:e,render:({field:t})=>i.jsx(je,{label:"Vehicle Number",...t})}),i.jsx(_e,{name:`assets.${n}.chassisNumber`,control:e,render:({field:t})=>i.jsx(je,{label:"Chassis Number",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.dlNumber`,control:e,render:({field:t})=>i.jsx(je,{label:"DL Number of User",...t})}),i.jsx(_e,{name:`assets.${n}.kmsAtIssue`,control:e,render:({field:t})=>i.jsx(je,{label:"Kms at issue",type:"number",...t})}),i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.finesStatus`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"Violations / Fines",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Existing"}),i.jsx("option",{children:"Nil"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.insuranceValidity`,control:e,render:({field:t})=>i.jsx(kn,{label:"Insurance Validity",id:t.name,value:t.value,onChange:t.onChange})}),i.jsx(_e,{name:`assets.${n}.pollutionCertValidity`,control:e,render:({field:t})=>i.jsx(kn,{label:"Pollution Cert. Validity",id:t.name,value:t.value,onChange:t.onChange})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`assets.${n}.dlFrontPic`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture of DL (Front)",file:t.value,onFileChange:t.onChange})}),i.jsx(_e,{name:`assets.${n}.dlBackPic`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture of DL (Back)",file:t.value,onFileChange:t.onChange})}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture of Vehicle",file:t.value,onFileChange:t.onChange})})]})]}),lde=({index:n,control:e})=>{const{fields:t,append:r,remove:s}=js({control:e,name:`assets.${n}.toolList`});return i.jsxs("div",{className:"space-y-4 pt-4",children:[t.map((a,o)=>i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("div",{className:"flex-1",children:i.jsx(_e,{name:`assets.${n}.toolList.${o}.name`,control:e,render:({field:l})=>i.jsx(je,{label:"Tool Name",...l})})}),i.jsx("div",{className:"flex-1",children:i.jsx(_e,{name:`assets.${n}.toolList.${o}.description`,control:e,render:({field:l})=>i.jsx(je,{label:"Description",...l})})}),i.jsx("div",{children:i.jsx(_e,{name:`assets.${n}.toolList.${o}.quantity`,control:e,render:({field:l})=>i.jsx(je,{label:"Quantity",type:"number",...l})})}),i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>s(o),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]},a.id)),i.jsxs(se,{type:"button",variant:"outline",size:"sm",onClick:()=>r({id:`tool_${Date.now()}`,name:"",description:"",quantity:1}),children:[i.jsx(Bt,{className:"mr-1 h-4 w-4"})," Add Tool"]}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:a})=>i.jsx(yt,{label:"Picture of Tools",file:a.value,onFileChange:a.onChange})})]})},cde=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.name`,control:e,render:({field:t})=>i.jsx(je,{label:"Asset Name",placeholder:"e.g. Printer",...t})}),i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(je,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.model`,control:e,render:({field:t})=>i.jsx(je,{label:"Model No.",...t})}),i.jsx(_e,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>i.jsx(je,{label:"Serial Number",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ke,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.issueCondition`,control:e,render:({field:t})=>i.jsx(je,{label:"Condition at time of issue",...t})})]}),i.jsx("div",{children:i.jsx(_e,{name:`assets.${n}.accessories`,control:e,render:({field:t})=>i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Accessories List"}),i.jsx("textarea",{...t,rows:3,className:"form-input mt-1"})]})})}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(yt,{label:"Picture of Asset",file:t.value,onFileChange:t.onChange})})]}),dde=({item:n,index:e,control:t,errors:r,remove:s})=>{const[a,o]=E.useState(()=>n.id.startsWith("new_")),l=Q6.find(p=>p.key===n.type),c=l?.icon||xm,h=(p=>"brand"in p&&p.brand?`${p.brand} ${p.type}`:"number"in p&&p.number?`${p.type} - ${p.number}`:"name"in p&&p.name?p.name:"vehicleNumber"in p&&p.vehicleNumber?p.vehicleNumber:l?.label||"Asset")(n);return i.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[i.jsxs("div",{className:"flex items-center p-3",children:[i.jsxs("button",{type:"button",onClick:()=>o(!a),className:"flex items-center gap-3 flex-grow text-left",children:[i.jsx(c,{className:"h-5 w-5 text-muted flex-shrink-0"}),i.jsx("span",{className:"font-semibold text-primary-text",children:h})]}),i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>s(e),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})}),i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>o(!a),children:i.jsx(vu,{className:`h-5 w-5 transform transition-transform ${a?"rotate-180":""}`})})]}),a&&i.jsx("div",{className:"p-4 border-t border-border",children:i.jsx(tde,{assetType:n.type,index:e,control:t,errors:r})})]})},ude=({site:n,initialAssets:e,onSave:t,onBack:r,setToast:s})=>{const[a,o]=E.useState(!1),[l,c]=E.useState(!1),d=E.useRef(null),{control:h,handleSubmit:p,reset:x,formState:{errors:v}}=tn(),{fields:w,append:_,remove:j}=js({control:h,name:"assets"});E.useEffect(()=>{x({assets:e})},[e,x]),E.useEffect(()=>{const D=M=>{d.current&&!d.current.contains(M.target)&&c(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[]);const T=D=>{const M={id:`new_${D}_${Date.now()}`,type:D};let O;switch(D){case"Phone":O={...M,type:"Phone",brand:"",condition:"",chargerStatus:"",displayStatus:"",bodyStatus:"",imei:"",color:""};break;case"Sim":O={...M,type:"Sim",number:""};break;case"Computer":O={...M,type:"Computer",computerType:"",brand:"",condition:"",bagStatus:"",mouseStatus:"",chargerStatus:"",displayStatus:"",bodyStatus:"",serialNumber:"",windowsKey:"",officeStatus:"",antivirusStatus:""};break;case"IdCard":O={...M,type:"IdCard",issueDate:""};break;case"Petrocard":O={...M,type:"Petrocard",number:""};break;case"Vehicle":O={...M,type:"Vehicle",vehicleType:"",brand:"",dlNumber:"",condition:"",kmsAtIssue:null,vehicleNumber:"",chassisNumber:"",insuranceValidity:"",pollutionCertValidity:"",finesStatus:""};break;case"Tools":O={...M,type:"Tools",toolList:[]};break;case"Other":O={...M,type:"Other",name:"",brand:"",model:"",serialNumber:"",condition:"",issueCondition:"",accessories:""};break;default:return}_(O),c(!1)},P=async D=>{o(!0);try{await t(n.id,D.assets)}catch{}finally{o(!1)}};return i.jsxs("form",{onSubmit:p(P),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsxs(se,{type:"button",onClick:r,variant:"outline",size:"sm",className:"mb-2",children:[i.jsx(Ra,{className:"mr-2 h-4 w-4"})," Back to List"]}),i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Assets for: ",n.shortName]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"relative",ref:d,children:[i.jsxs(se,{type:"button",onClick:()=>c(!l),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Asset"]}),l&&i.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-card border rounded-lg shadow-lg z-10",children:Q6.map(D=>i.jsxs("button",{type:"button",className:"w-full text-left px-4 py-2 text-sm hover:bg-page flex items-center gap-3",onClick:()=>T(D.key),children:[i.jsx(D.icon,{className:"h-4 w-4 text-muted"}),i.jsx("span",{children:D.label})]},D.key))})]}),i.jsxs(se,{type:"submit",isLoading:a,children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),i.jsx("div",{className:"space-y-4",children:w.length>0?w.map((D,M)=>i.jsx(dde,{item:D,index:M,control:h,errors:v,remove:j},D.id)):i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No assets found for this site. Click "Add Asset" to begin.'})})]})},fde=({sites:n,allAssets:e,searchTerm:t,setSearchTerm:r,onViewDetails:s})=>{const a=(o=[])=>{if(!o||o.length===0)return"No assets assigned.";const l=o.reduce((c,d)=>(c[d.type]=(c[d.type]||0)+1,c),{});return Object.entries(l).map(([c,d])=>`${d} ${c}(s)`).join(", ")};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Asset Overview"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsx(Ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx(je,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>r(o.target.value)})]})]}),i.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Asset Summary"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),i.jsx("td",{className:"px-4 py-3 text-muted",children:a(e[o.id])}),i.jsx("td",{className:"px-4 py-3",children:i.jsx(se,{variant:"icon",size:"sm",onClick:()=>s(o.id),title:"View Details",children:i.jsx(Sl,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},hde=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState(null),[s,a]=E.useState([]),[o,l]=E.useState({}),[c,d]=E.useState(!0),[h,p]=E.useState(""),[x,v]=E.useState(null);E.useEffect(()=>{d(!0),Promise.all([ue.getOrganizations(),ue.getAllSiteAssets()]).then(([T,P])=>{a(T.sort((D,M)=>D.shortName.localeCompare(M.shortName))),l(P)}).catch(()=>v({message:"Failed to load asset configuration.",type:"error"})).finally(()=>d(!1))},[]);const w=async(T,P)=>{try{await ue.updateSiteAssets(T,P),l(D=>({...D,[T]:P})),v({message:"Assets saved successfully.",type:"success"})}catch(D){throw v({message:"Failed to save assets.",type:"error"}),D}},_=T=>{r(T),e("detail")},j=E.useMemo(()=>h?s.filter(T=>T.shortName.toLowerCase().includes(h.toLowerCase())):s,[s,h]);return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{children:[x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)}),n==="detail"&&t?i.jsx(ude,{site:s.find(T=>T.id===t),initialAssets:o[t]||[],onSave:w,onBack:()=>e("list"),setToast:v}):i.jsx(fde,{sites:j,allAssets:o,searchTerm:h,setSearchTerm:p,onViewDetails:_})]})},mde=({control:n,index:e,remove:t,masterTools:r})=>{const[s,a]=E.useState(!0),o=au({control:n,name:`tools.${e}.department`}),l=au({control:n,name:`tools.${e}.name`}),c=o?r[o]||[]:[],d=l||"New Tool",h=o||"Select a department";return i.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[i.jsxs("div",{className:"flex items-center p-3",children:[i.jsxs("button",{type:"button",onClick:()=>a(!s),className:"flex items-center gap-3 flex-grow text-left",children:[i.jsx(v3,{className:"h-5 w-5 text-muted flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold text-primary-text",children:d}),i.jsx("p",{className:"text-sm text-muted",children:h})]})]}),i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>t(e),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})}),i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>a(!s),children:i.jsx(vu,{className:`h-5 w-5 transform transition-transform ${s?"rotate-180":""}`})})]}),s&&i.jsxs("div",{className:"p-4 border-t border-border space-y-4 animate-fade-in-down",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`tools.${e}.department`,control:n,render:({field:p})=>i.jsxs(Ke,{label:"Department",...p,children:[i.jsx("option",{value:"",children:"Select Department"}),Object.keys(r).map(x=>i.jsx("option",{value:x,children:x},x))]})}),i.jsx(_e,{name:`tools.${e}.name`,control:n,render:({field:p})=>i.jsxs(Ke,{label:"Tool Name",...p,disabled:!o,children:[i.jsx("option",{value:"",children:"Select Tool"}),c.map(x=>i.jsx("option",{value:x.name,children:x.name},x.id))]})}),i.jsx(_e,{name:`tools.${e}.quantity`,control:n,render:({field:p})=>i.jsx(je,{label:"Quantity",type:"number",...p})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`tools.${e}.picture`,control:n,render:({field:p})=>i.jsx(yt,{label:"Picture of Tool",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.inwardDcCopy`,control:n,render:({field:p})=>i.jsx(yt,{label:"Inward DC Copy",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.deliveryCopy`,control:n,render:({field:p})=>i.jsx(yt,{label:"Delivery Copy",file:p.value,onFileChange:p.onChange})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end",children:[i.jsx(_e,{name:`tools.${e}.invoiceCopy`,control:n,render:({field:p})=>i.jsx(yt,{label:"Invoice",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.signedReceipt`,control:n,render:({field:p})=>i.jsx(yt,{label:"Signed Receipt",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.receiverName`,control:n,render:({field:p})=>i.jsx(je,{label:"Receiver's Name",...p})})]})]})]})},pde=({site:n,initialTools:e,masterTools:t,onSave:r,onBack:s})=>{const[a,o]=E.useState(!1),{control:l,handleSubmit:c,reset:d}=tn(),{fields:h,append:p,remove:x}=js({control:l,name:"tools"});E.useEffect(()=>{d({tools:e})},[e,d]);const v=()=>{p({id:`new_tool_${Date.now()}`,department:"",name:"",quantity:1})},w=async _=>{o(!0);try{await r(n.id,_.tools)}finally{o(!1)}};return i.jsxs("form",{onSubmit:c(w),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsxs(se,{type:"button",onClick:s,variant:"outline",size:"sm",className:"mb-2",children:[i.jsx(Ra,{className:"mr-2 h-4 w-4"})," Back to List"]}),i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Tools for: ",n.shortName]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(se,{type:"button",onClick:v,children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Tool"]}),i.jsxs(se,{type:"submit",isLoading:a,children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),i.jsx("div",{className:"space-y-4",children:h.length>0?h.map((_,j)=>i.jsx(mde,{control:l,index:j,remove:x,masterTools:t},_.id)):i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No tools found for this site. Click "Add Tool" to begin.'})})]})},gde=({sites:n,allIssuedTools:e,searchTerm:t,setSearchTerm:r,onViewDetails:s})=>{const a=(o=[])=>{if(!o||o.length===0)return"No tools issued.";const l=o.reduce((d,h)=>d+(h.quantity||0),0),c=new Set(o.map(d=>d.department)).size;return`${l} tools issued across ${c} department${c>1?"s":""}.`};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Site Tools Overview"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsx(Ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx(je,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>r(o.target.value)})]})]}),i.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Tools Summary"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),i.jsx("td",{className:"px-4 py-3 text-muted",children:a(e[o.id])}),i.jsx("td",{className:"px-4 py-3",children:i.jsx(se,{variant:"icon",size:"sm",onClick:()=>s(o.id),title:"View Details",children:i.jsx(Sl,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},xde=()=>{const[n,e]=E.useState(null),[t,r]=E.useState([]),[s,a]=E.useState({}),[o,l]=E.useState({}),[c,d]=E.useState(!0),[h,p]=E.useState(""),[x,v]=E.useState(null);E.useEffect(()=>{d(!0),Promise.all([ue.getOrganizations(),ue.getAllSiteIssuedTools(),ue.getToolsList()]).then(([j,T,P])=>{r(j.sort((D,M)=>D.shortName.localeCompare(M.shortName))),a(T),l(P)}).catch(()=>v({message:"Failed to load initial configuration.",type:"error"})).finally(()=>d(!1))},[]);const w=async(j,T)=>{try{await ue.updateSiteIssuedTools(j,T),a(P=>({...P,[j]:T})),v({message:"Tools list saved successfully.",type:"success"})}catch(P){throw v({message:"Failed to save tools list.",type:"error"}),P}},_=E.useMemo(()=>h?t.filter(j=>j.shortName.toLowerCase().includes(h.toLowerCase())):t,[t,h]);return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{children:[x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)}),n?i.jsx(pde,{site:t.find(j=>j.id===n),initialTools:s[n]||[],masterTools:o,onSave:w,onBack:()=>e(null)}):i.jsx(gde,{sites:_,allIssuedTools:s,searchTerm:h,setSearchTerm:p,onViewDetails:e})]})},yde=()=>i.jsx(ld,{title:"Attendance Format"}),vde=()=>i.jsx(ld,{title:"Attendance Overview"}),bde=()=>i.jsx(ld,{title:"Daily Attendance Summary"}),wde=()=>i.jsx(ld,{title:"Notification & Mail Configuration"}),_de=()=>i.jsx(ld,{title:"Onboarding Rejection Reasons"}),jde=()=>i.jsx(ld,{title:"Salary Breakup"}),Nde=()=>i.jsx(ld,{title:"Salary Line Item"}),$L=(n,e)=>{const t=e.join(","),r=n.map(s=>e.map(a=>{const o=s[a]===null||s[a]===void 0?"":String(s[a]);return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...r].join(`
`)},HL=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,"")),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),a[l]=d}),r.push(a)}return r},LN=["GroupId","GroupName","CompanyId","CompanyName","EntityId","EntityName","organizationId","Location","RegisteredAddress","RegistrationType","RegistrationNumber","GSTNumber","PANNumber","Email","EShramNumber","ShopAndEstablishmentCode","EPFOCode","ESICCode","PSARALicenseNumber","PSARAValidTill"],FN=["organizationId","organizationName","location","entityId","billingName","registeredAddress","gstNumber","panNumber","email1","email2","email3","eShramNumber","shopAndEstablishmentCode","keyAccountManager","siteAreaSqFt","projectType","apartmentCount","agreementDetails","siteOperations"],YL=(n,e)=>{const t=new Blob([n],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(t),r.setAttribute("download",e),document.body.appendChild(r),r.click(),document.body.removeChild(r)},Sde=({isOpen:n,onClose:e,onSave:t,title:r,label:s,initialName:a=""})=>{const[o,l]=E.useState(a),[c,d]=E.useState("");E.useEffect(()=>{n&&l(a)},[n,a]);const h=()=>{if(!o.trim()){d("Name cannot be empty.");return}t(o),e()};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4",onClick:p=>p.stopPropagation(),children:[i.jsx("h3",{className:"text-lg font-bold",children:r}),i.jsx("div",{className:"mt-4",children:i.jsx(je,{label:s,id:"name-input",value:o,onChange:p=>{l(p.target.value),d("")},error:c})}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(se,{onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(se,{onClick:h,children:"Save"})]})]})}):null},qN=[{key:"client_structure",label:"Client Structure",icon:n3},{key:"site_configuration",label:"Site Configuration",icon:Dm},{key:"costing_resource",label:"Costing & Resource",icon:sJ},{key:"backoffice_heads",label:"Back Office & ID Series",icon:Gi},{key:"staff_designation",label:"Staff Designation",icon:eJ},{key:"gmc_policy",label:"GMC Policy",icon:CC},{key:"asset",label:"Asset Management",icon:JK},{key:"tools_list",label:"Tools List",icon:v3},{key:"attendance_format",label:"Attendance Format",icon:lJ},{key:"attendance_overview",label:"Attendance Overview",icon:nJ},{key:"notification_template",label:"Notification & Mail",icon:Bf},{key:"onboard_reject_reason",label:"Onboarding Rejection Reasons",icon:Dx},{key:"salary_template",label:"Salary Breakup",icon:Cl},{key:"salary_line_item",label:"Salary Line Item",icon:Cl}],Cde=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState(null),[p,x]=E.useState({}),[v,w]=E.useState("client_structure"),_=E.useRef(null),[j,T]=E.useState(""),[P,D]=E.useState(null),[M,O]=E.useState(!1),I=Ft("(max-width: 767px)"),[q,F]=E.useState({isOpen:!1,initialData:null,companyName:""}),[V,U]=E.useState({isOpen:!1,mode:"add",type:"group",title:"",label:""}),[W,$]=E.useState({isOpen:!1,type:"group",id:"",name:""}),[ne,Y]=E.useState({isOpen:!1,org:null}),ae=E.useMemo(()=>e.flatMap(ve=>ve.companies.flatMap(Oe=>Oe.entities.map(Pe=>({...Pe,companyName:Oe.name})))),[e]);E.useEffect(()=>{(async()=>{c(!0);try{const[Oe,Pe,Ie]=await Promise.all([ue.getOrganizationStructure(),ue.getOrganizations(),ue.getSiteConfigurations()]);t(Oe),s(Pe),o(Ie)}catch{h({message:"Failed to load data.",type:"error"})}finally{c(!1)}})()},[]);const J=E.useMemo(()=>{if(!j.trim())return e;const ve=j.toLowerCase();return e.map(Oe=>{if(Oe.name.toLowerCase().includes(ve))return Oe;const Pe=Oe.companies.map(Ie=>{if(Ie.name.toLowerCase().includes(ve))return Ie;const Fe=Ie.entities.filter(we=>we.name.toLowerCase().includes(ve));return Fe.length>0?{...Ie,entities:Fe}:null}).filter(Boolean);return Pe.length>0?{...Oe,companies:Pe}:null}).filter(Boolean)},[e,j]),ee=E.useMemo(()=>{if(!j.trim())return r;const ve=j.toLowerCase();return r.filter(Oe=>Oe.shortName.toLowerCase().includes(ve))},[r,j]),X=ve=>x(Oe=>({...Oe,[ve]:!Oe[ve]})),Z=()=>{h({message:"All changes saved successfully (mocked).",type:"success"})},oe=ve=>F({isOpen:!0,initialData:null,companyName:ve}),H=(ve,Oe)=>F({isOpen:!0,initialData:ve,companyName:Oe}),Q=ve=>{h({message:ve.id.startsWith("new_")?"Client added.":"Client updated.",type:"success"}),F({isOpen:!1,initialData:null,companyName:""})},re=(ve,Oe,Pe)=>$({isOpen:!0,type:ve,id:Oe,name:Pe}),de=()=>{const{type:ve,id:Oe,name:Pe}=W;ve==="group"?t(Ie=>Ie.filter(Fe=>Fe.id!==Oe)):ve==="company"?t(Ie=>Ie.map(Fe=>({...Fe,companies:Fe.companies.filter(we=>we.id!==Oe)}))):ve==="client"&&t(Ie=>Ie.map(Fe=>({...Fe,companies:Fe.companies.map(we=>({...we,entities:we.entities.filter(Ne=>Ne.id!==Oe)}))}))),h({message:`${ve.charAt(0).toUpperCase()+ve.slice(1)} '${Pe}' deleted.`,type:"success"}),$({isOpen:!1,type:"group",id:"",name:""})},ce=ve=>{const{mode:Oe,type:Pe,id:Ie,groupId:Fe}=V;if(Oe==="add"){if(Pe==="group"){const we={id:`group_${Date.now()}`,name:ve,locations:[],companies:[]};t(Ne=>[...Ne,we]),h({message:`Group '${ve}' added.`,type:"success"})}else if(Pe==="company"&&Fe){const we={id:`comp_${Date.now()}`,name:ve,entities:[]};t(Ne=>Ne.map(Ue=>Ue.id===Fe?{...Ue,companies:[...Ue.companies,we]}:Ue)),h({message:`Company '${ve}' added.`,type:"success"})}}else Pe==="group"&&Ie?(t(we=>we.map(Ne=>Ne.id===Ie?{...Ne,name:ve}:Ne)),h({message:"Group updated.",type:"success"})):Pe==="company"&&Ie&&Fe&&(t(we=>we.map(Ne=>Ne.id===Fe?{...Ne,companies:Ne.companies.map(Ue=>Ue.id===Ie?{...Ue,name:ve}:Ue)}:Ne)),h({message:"Company updated.",type:"success"}));U({isOpen:!1,mode:"add",type:"group",title:"",label:""})},pe=()=>{let ve,Oe,Pe;if(v==="client_structure"){Pe=LN;const Ie=e.flatMap(Fe=>Fe.companies.flatMap(we=>we.entities.map(Ne=>({GroupId:Fe.id,GroupName:Fe.name,CompanyId:we.id,CompanyName:we.name,EntityId:Ne.id,EntityName:Ne.name,organizationId:Ne.organizationId||"",Location:Ne.location||"",RegisteredAddress:Ne.registeredAddress||"",RegistrationType:Ne.registrationType||"",RegistrationNumber:Ne.registrationNumber||"",GSTNumber:Ne.gstNumber||"",PANNumber:Ne.panNumber||"",Email:Ne.email||"",EShramNumber:Ne.eShramNumber||"",ShopAndEstablishmentCode:Ne.shopAndEstablishmentCode||"",EPFOCode:Ne.epfoCode||"",ESICCode:Ne.esicCode||"",PSARALicenseNumber:Ne.psaraLicenseNumber||"",PSARAValidTill:Ne.psaraValidTill||""}))));ve=$L(Ie,Pe),Oe="client_structure_export.csv"}else if(v==="site_configuration"){Pe=FN;const Ie=r.map(Fe=>{const we=a.find(Ne=>Ne.organizationId===Fe.id);return{organizationId:Fe.id,organizationName:Fe.shortName,...we||{},agreementDetails:JSON.stringify(we?.agreementDetails||{}),siteOperations:JSON.stringify(we?.siteOperations||{})}});ve=$L(Ie,Pe),Oe="site_configuration_export.csv"}else{h({message:"Export not implemented for this view.",type:"error"});return}YL(ve,Oe),h({message:"Data exported successfully.",type:"success"})},ie=()=>{let ve,Oe;if(v==="client_structure")ve=LN,Oe="client_structure_template.csv";else if(v==="site_configuration")ve=FN,Oe="site_configuration_template.csv";else{h({message:"Template not available for this view.",type:"error"});return}YL(ve.join(","),Oe)},xe=ve=>{const Oe=ve.target.files?.[0];if(!Oe)return;const Pe=new FileReader;Pe.onload=Ie=>{try{const Fe=Ie.target?.result;if(!Fe)throw new Error("File is empty.");const we=Fe.trim().replace(/\r/g,"").split(`
`);if(we.length<1)throw new Error("CSV file is empty.");const Ne=we[0].split(",").map(Ue=>Ue.trim().replace(/"/g,""));if(v==="client_structure"){if(Ne.join(",")!==LN.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const Ue=HL(Fe);if(Ue.length===0)throw new Error("No data rows found.");const Be=new Map;for(const te of Ue){Be.has(te.GroupId)||Be.set(te.GroupId,{group:{id:te.GroupId,name:te.GroupName,locations:[],companies:[]},companiesMap:new Map});const le=Be.get(te.GroupId);le.companiesMap.has(te.CompanyId)||le.companiesMap.set(te.CompanyId,{id:te.CompanyId,name:te.CompanyName,entities:[]});const ye=le.companiesMap.get(te.CompanyId),Ve={id:te.EntityId,name:te.EntityName,organizationId:te.organizationId,location:te.Location,registeredAddress:te.RegisteredAddress,registrationType:te.RegistrationType||"",registrationNumber:te.RegistrationNumber,gstNumber:te.GSTNumber,panNumber:te.PANNumber,email:te.Email,eShramNumber:te.EShramNumber,shopAndEstablishmentCode:te.ShopAndEstablishmentCode,epfoCode:te.EPFOCode,esicCode:te.ESICCode,psaraLicenseNumber:te.PSARALicenseNumber,psaraValidTill:te.PSARAValidTill};ye.entities.push(Ve)}const qe=Array.from(Be.values()).map(te=>(te.group.companies=Array.from(te.companiesMap.values()),te.group));t(qe),h({message:`Successfully imported ${Ue.length} client records.`,type:"success"})}else if(v==="site_configuration"){if(Ne.join(",")!==FN.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const Ue=HL(Fe);if(Ue.length===0)throw new Error("No data rows found.");const Be=Ue.map(qe=>{const te={};for(const le of Object.keys(qe))if(le==="agreementDetails"||le==="siteOperations")try{te[le]=JSON.parse(qe[le])}catch{console.warn(`Could not parse JSON for ${le} in row for site ${qe.organizationId}`),te[le]={}}else te[le]=qe[le];return te});o(qe=>{const te=[...qe];return Be.forEach(le=>{const ye=te.findIndex(Ve=>Ve.organizationId===le.organizationId);ye>-1?te[ye]=le:te.push(le)}),te}),h({message:`Successfully imported ${Be.length} site configurations.`,type:"success"})}else h({message:"Import not implemented for this view.",type:"error"})}catch(Fe){h({message:Fe.message||"Failed to import CSV.",type:"error"})}finally{ve.target&&(ve.target.value="")}},Pe.readAsText(Oe)},Ce=()=>{switch(v){case"client_structure":return i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsxs(se,{onClick:()=>n("/hr/entity-management/add-group"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Bt,{className:"mr-2 h-4"}),"Add Group"]}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(se,{type:"button",variant:"outline",onClick:ie,className:"hover:bg-gray-100",children:[i.jsx(ls,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>_.current?.click(),className:"hover:bg-gray-100",children:[i.jsx(Wc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(se,{type:"button",variant:"outline",onClick:pe,className:"hover:bg-gray-100",children:[i.jsx(yi,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),i.jsx("div",{className:"space-y-2",children:J.map(Oe=>i.jsxs("div",{className:"border-b border-border",children:[i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>X(Oe.id),children:i.jsx(Mf,{className:`h-5 w-5 transition-transform ${p[Oe.id]?"rotate-90":""}`})}),i.jsx(Hi,{className:"h-5 w-5 text-muted"}),i.jsx("span",{className:"font-semibold",children:Oe.name})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(se,{size:"sm",className:"!p-1.5",onClick:()=>U({isOpen:!0,mode:"add",type:"company",groupId:Oe.id,title:`Add Company to ${Oe.name}`,label:"Company Name"}),title:"Add Company",children:i.jsx(Bt,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",onClick:()=>U({isOpen:!0,mode:"edit",type:"group",id:Oe.id,initialName:Oe.name,title:"Edit Group Name",label:"Group Name"}),title:"Edit group name",className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(cr,{className:"h-5 w-5"})}),i.jsx(se,{variant:"icon",onClick:()=>re("group",Oe.id,Oe.name),title:"Delete group",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]}),p[Oe.id]&&i.jsx("div",{className:"pl-6 pr-3 pb-3 space-y-2",children:Oe.companies.map(Pe=>i.jsxs("div",{className:"border border-border rounded-lg",children:[i.jsxs("div",{className:"p-2 flex items-center justify-between bg-card",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>X(Pe.id),children:i.jsx(Mf,{className:`h-5 w-5 transition-transform ${p[Pe.id]?"rotate-90":""}`})}),i.jsxs("span",{children:[Pe.name," (",Pe.entities.length," clients)"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(se,{variant:"icon",size:"sm",title:`View ${Pe.entities.length} clients`,onClick:()=>D({companyName:Pe.name,clients:Pe.entities}),children:i.jsx(Sl,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>oe(Pe.name),title:"Add client",children:i.jsx(Bt,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",onClick:()=>U({isOpen:!0,mode:"edit",type:"company",id:Pe.id,groupId:Oe.id,initialName:Pe.name,title:"Edit Company Name",label:"Company Name"}),title:"Edit company name",className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(cr,{className:"h-5 w-5"})}),i.jsx(se,{variant:"icon",onClick:()=>re("company",Pe.id,Pe.name),title:"Delete company",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]}),p[Pe.id]&&i.jsx("div",{className:"p-2",children:Pe.entities.map(Ie=>i.jsxs("div",{className:"p-2 flex items-center justify-between hover:bg-page rounded",children:[i.jsx("span",{children:Ie.name}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(se,{variant:"icon",onClick:()=>H(Ie,Pe.name),className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(cr,{className:"h-5 w-5"})}),i.jsx(se,{variant:"icon",onClick:()=>re("client",Ie.id,Ie.name),className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]},Ie.id))})]},Pe.id))})]},Oe.id))})]});case"site_configuration":return i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Sites Configuration"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(se,{type:"button",variant:"outline",onClick:ie,children:[i.jsx(ls,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>_.current?.click(),children:[i.jsx(Wc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(se,{type:"button",variant:"outline",onClick:pe,children:[i.jsx(yi,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Configuration Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:ee.map(Oe=>{const Pe=a.find(Fe=>Fe.organizationId===Oe.id),Ie=!!Pe&&(!!Pe.billingName||!!Pe.keyAccountManager);return i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Hi,{className:"h-5 w-5 text-muted"}),i.jsx("span",{children:Oe.shortName})]})}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:Ie?i.jsxs("span",{className:"flex items-center text-green-600",children:[i.jsx(Yi,{className:"h-4 w-4 mr-1"})," Complete"]}):i.jsxs("span",{className:"flex items-center text-yellow-600",children:[i.jsx(e3,{className:"h-4 w-4 mr-1"})," Incomplete"]})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs(se,{size:"sm",variant:"outline",onClick:()=>Y({isOpen:!0,org:Oe}),children:[i.jsx(Sl,{className:"mr-2 h-4 w-4"})," View / Edit"]})})]},Oe.id)})})]})})]});case"costing_resource":return i.jsx(Bce,{});case"backoffice_heads":return i.jsx(Hce,{});case"staff_designation":return i.jsx(Zce,{});case"gmc_policy":return i.jsx(ede,{});case"asset":return i.jsx(hde,{});case"tools_list":return i.jsx(xde,{});case"attendance_format":return i.jsx(yde,{});case"attendance_overview":return i.jsx(vde,{});case"daily_attendance":return i.jsx(bde,{});case"notification_template":return i.jsx(wde,{});case"onboard_reject_reason":return i.jsx(_de,{});case"salary_template":return i.jsx(jde,{});case"salary_line_item":return i.jsx(Nde,{});default:const ve=qN.find(Oe=>Oe.key===v);return i.jsx(ld,{title:ve?.label||"Configuration"})}};return i.jsxs("div",{className:"p-4 space-y-6",children:[d&&i.jsx(ht,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsx(zce,{isOpen:M,onClose:()=>O(!1)}),q.isOpen&&i.jsx(qce,{...q,onClose:()=>F(ve=>({...ve,isOpen:!1})),onSave:Q}),i.jsx(Sde,{isOpen:V.isOpen,onClose:()=>U({isOpen:!1,mode:"add",type:"group",title:"",label:""}),onSave:ce,title:V.title,label:V.label,initialName:V.initialName}),i.jsxs(Yr,{isOpen:W.isOpen,onClose:()=>$(ve=>({...ve,isOpen:!1})),onConfirm:de,title:"Confirm Deletion",children:["Are you sure you want to delete the ",W.type,' "',W.name,'"? This action cannot be undone.']}),ne.isOpen&&ne.org&&i.jsx(s6,{isOpen:ne.isOpen,onClose:()=>Y({isOpen:!1,org:null}),onSave:()=>{},organization:ne.org,allClients:ae,initialData:a.find(ve=>ve.organizationId===ne.org?.id)}),P&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",onClick:()=>D(null),children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 animate-fade-in-scale",onClick:ve=>ve.stopPropagation(),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text mb-4",children:["Clients in ",P.companyName]}),P.clients.length>0?i.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:P.clients.map(ve=>i.jsx("li",{className:"text-sm p-2 bg-page rounded-md",children:ve.name},ve.id))}):i.jsx("p",{className:"text-muted text-center py-4",children:"No clients found for this company."}),i.jsx("div",{className:"mt-6 text-right",children:i.jsx(se,{onClick:()=>D(null),variant:"secondary",children:"Close"})})]})}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Client Management"}),!I&&i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(se,{variant:"outline",onClick:()=>O(!0),className:"hover:bg-gray-100",children:[i.jsx(FM,{className:"mr-2 h-4 w-4"})," Help"]}),i.jsx("input",{type:"file",ref:_,className:"hidden",accept:".csv",onChange:xe}),i.jsxs(se,{onClick:Z,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save All Changes"]})]})]}),I&&i.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[i.jsxs(se,{onClick:Z,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save All Changes"]}),i.jsxs(se,{variant:"outline",onClick:()=>O(!0),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(FM,{className:"mr-2 h-4 w-4"})," Help"]}),i.jsx("input",{type:"file",ref:_,className:"hidden",accept:".csv",onChange:xe})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx("input",{type:"text",placeholder:"Search across all clients and sites...",value:j,onChange:ve=>T(ve.target.value),className:"form-input pl-10 w-full"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx("nav",{className:"md:col-span-1",children:I?i.jsx(Ke,{label:"Configuration Section",id:"hr-config-select",value:v,onChange:ve=>w(ve.target.value),children:qN.map(ve=>i.jsx("option",{value:ve.key,children:ve.label},ve.key))}):i.jsx("div",{className:"space-y-1",children:qN.map(ve=>i.jsxs("button",{onClick:()=>w(ve.key),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg text-left transition-colors ${v===ve.key?"text-white":"text-muted hover:bg-accent-light hover:text-accent-dark"}`,style:v===ve.key?{backgroundColor:"#006B3F"}:{},children:[i.jsx(ve.icon,{className:"h-5 w-5"}),i.jsx("span",{children:ve.label})]},ve.key))})}),i.jsx("main",{className:"md:col-span-3",children:l?i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent mx-auto mt-16"}):Ce()})]})]})},Tde=({isOpen:n,onSave:e,onClose:t,initialData:r})=>{const[s,a]=E.useState(r?.name||""),[o,l]=E.useState(r?.description||""),[c,d]=E.useState(!1);E.useEffect(()=>{n&&(a(r?.name||""),l(r?.description||""),d(!1))},[n,r]);const h=async p=>{if(p&&p.preventDefault(),!!s.trim()){d(!0);try{await e({name:s.trim(),description:o.trim()})}catch(x){console.error("Error saving policy:",x),d(!1)}}};return i.jsx(Yr,{isOpen:n,onClose:t,onConfirm:h,title:`${r?"Edit":"Add"} Policy`,confirmButtonText:"Save Policy",isLoading:c,children:i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"policy-name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"policy-name",value:s,onChange:p=>a(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"policy-description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"policy-description",value:o,onChange:p=>l(p.target.value),placeholder:"Description",className:"form-input",rows:3,disabled:c})]})]})})},kde=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(!1),[l,c]=E.useState(null),[d,h]=E.useState(null),p=E.useRef(!0);E.useEffect(()=>(p.current=!0,()=>{p.current=!1}),[]);const x=E.useCallback(async()=>{s(!0);try{const j=await ue.getPolicies();p.current&&t(j)}catch(j){console.error("Error fetching policies:",j),p.current&&h({message:"Failed to fetch policies.",type:"error"})}finally{p.current&&s(!1)}},[]);E.useEffect(()=>{x()},[x]);const v=async j=>{try{l?h({message:"Policy updated.",type:"success"}):(await ue.createPolicy(j),p.current&&h({message:"Policy created successfully!",type:"success"})),p.current&&(o(!1),c(null),x())}catch(T){throw console.error("Error saving policy:",T),p.current&&h({message:"Failed to save policy. Please try again.",type:"error"}),T}},w=()=>{n("/hr/policies/add")},_=j=>{c(j),o(!0)};return i.jsxs("div",{children:[d&&i.jsx(ht,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsx(Tde,{isOpen:a,onSave:v,onClose:()=>{o(!1),c(null)},initialData:l}),i.jsx(Qi,{title:"Policy Management",children:i.jsxs(se,{onClick:w,children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Policy"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Description"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):e.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:'No policies found. Click "Add Policy" to create one.'})}):e.map(j=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Policy Name",className:"px-6 py-4 font-medium",children:j.name}),i.jsx("td",{"data-label":"Description",className:"px-6 py-4 text-sm text-muted",children:j.description||""}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:i.jsx(se,{variant:"icon",size:"sm",onClick:()=>_(j),children:i.jsx(cr,{className:"h-4 w-4"})})})})]},j.id))})]})})]})},Pde=Pt({type:ge().oneOf(["GMC","GPA","WCA","Other"]).required("Type is required"),provider:ge().required("Provider is required"),policyNumber:ge().required("Policy number is required"),validTill:ge().required("Valid till date is required")}).defined(),Mde=({onSave:n,onClose:e,initialData:t})=>{const{register:r,handleSubmit:s,control:a,formState:{errors:o},reset:l}=tn({resolver:En(Pde)});E.useEffect(()=>{l(t||{type:"GMC",provider:"",policyNumber:"",validTill:""})},[t,l]);const c=d=>{n(d)};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4",onClick:d=>d.stopPropagation(),children:i.jsxs("form",{onSubmit:s(c),children:[i.jsxs("h3",{className:"text-lg font-bold mb-4",children:[t?"Edit":"Add"," Insurance"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(Ke,{label:"Insurance Type",id:"type",registration:r("type"),error:o.type?.message,children:[i.jsx("option",{children:"GMC"}),i.jsx("option",{children:"GPA"}),i.jsx("option",{children:"WCA"}),i.jsx("option",{children:"Other"})]}),i.jsx(je,{label:"Provider",id:"provider",registration:r("provider"),error:o.provider?.message}),i.jsx(je,{label:"Policy Number",id:"policyNumber",registration:r("policyNumber"),error:o.policyNumber?.message}),i.jsx(_e,{name:"validTill",control:a,render:({field:d})=>i.jsx(kn,{label:"Valid Till",id:"validTill",value:d.value,onChange:d.onChange,error:o.validTill?.message})})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[i.jsx(se,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(se,{type:"submit",children:"Save Insurance"})]})]})})})},Ede=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState(null),[c,d]=E.useState(null),h=E.useCallback(async()=>{r(!0);try{const x=await ue.getInsurances();e(x)}catch{d({message:"Failed to fetch insurance policies.",type:"error"})}finally{r(!1)}},[]);E.useEffect(()=>{h()},[h]);const p=async x=>{try{o||(await ue.createInsurance(x),d({message:"Insurance created.",type:"success"})),a(!1),h()}catch{d({message:"Failed to save insurance.",type:"error"})}};return i.jsxs("div",{children:[c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)}),s&&i.jsx(Mde,{onSave:p,onClose:()=>a(!1),initialData:o}),i.jsx(Qi,{title:"Insurance Management",children:i.jsxs(se,{onClick:()=>{l(null),a(!0)},children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Insurance"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Provider"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Number"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Valid Till"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:5,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):n.map(x=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Type",className:"px-6 py-4 font-medium",children:x.type}),i.jsx("td",{"data-label":"Provider",className:"px-6 py-4 text-sm text-muted",children:x.provider}),i.jsx("td",{"data-label":"Policy Number",className:"px-6 py-4 text-sm text-muted",children:x.policyNumber}),i.jsx("td",{"data-label":"Valid Till",className:"px-6 py-4 text-sm text-muted",children:x.validTill}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:i.jsx(se,{variant:"icon",size:"sm",onClick:()=>{l(x),a(!0)},children:i.jsx(cr,{className:"h-4 w-4"})})})})]},x.id))})]})})]})},Dde=()=>{const[n,e]=E.useState("policies");return i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Policies & Insurance"})}),i.jsx("div",{children:i.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[i.jsxs("button",{onClick:()=>e("policies"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="policies"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[i.jsx(ls,{className:"h-5 w-5"}),i.jsx("span",{children:"Company Policies"})]}),i.jsxs("button",{onClick:()=>e("insurance"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="insurance"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[i.jsx(h3,{className:"h-5 w-5"}),i.jsx("span",{children:"Insurance Plans"})]})]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[n==="policies"&&i.jsx(kde,{}),n==="insurance"&&i.jsx(Ede,{})]})]})},Xg={documents:{aadhaar:!1,pan:!1,bankProof:!1,educationCertificate:!1,salarySlip:!1,uanProof:!1,familyAadhaar:!1},verifications:{requireBengaluruAddress:!1,requireDobVerification:!1}},Ode=()=>{const n=Qc(),[e,t]=E.useState(null),[r,s]=E.useState([]),[a,o]=E.useState("Administrator");E.useEffect(()=>{ue.getSiteStaffDesignations().then(P=>{const D=[...new Set(P.map(M=>M.designation))];D.includes("Administrator")||D.unshift("Administrator"),s(D.map((M,O)=>({id:`${O}`,designation:M,department:"",permanentId:"",temporaryId:""})))})},[]);const{register:l,handleSubmit:c,control:d,formState:{isDirty:h},watch:p,reset:x,setValue:v}=tn({defaultValues:n});E.useEffect(()=>{x(n)},[n,x]),E.useEffect(()=>{n.rulesByDesignation?.[a]||(Object.keys(Xg.documents).forEach(D=>{v(`rulesByDesignation.${a}.documents.${D}`,!0,{shouldDirty:!0})}),Object.keys(Xg.verifications).forEach(D=>{v(`rulesByDesignation.${a}.verifications.${D}`,!0,{shouldDirty:!0})}))},[a,n.rulesByDesignation,v]);const w=p("enforceManpowerLimit"),_=p("enableEsiRule"),j=p("enableGmcRule"),T=P=>{n.updateRules(P),t({message:"Enrollment rules saved successfully!",type:"success"}),x(P)};return i.jsxs("form",{onSubmit:c(T),className:"p-4 space-y-8 w-full",children:[e&&i.jsx(ht,{message:e.message,type:e.type,onDismiss:()=>t(null)}),i.jsx(Qi,{title:"Enrollment Rules",children:i.jsxs(se,{type:"submit",disabled:!h,children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(ls,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"Designation-Specific Rules"}),i.jsx("p",{className:"text-muted",children:"Set mandatory documents and verifications for specific roles."})]})]}),i.jsx("div",{className:"mb-4",children:i.jsx(Ke,{label:"Configure rules for designation",value:a,onChange:P=>o(P.target.value),children:r.map(P=>i.jsx("option",{value:P.designation,children:P.designation},P.id))})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Mandatory Documents"}),i.jsx("div",{className:"space-y-3",children:Object.keys(Xg.documents).map(P=>i.jsx(_e,{name:`rulesByDesignation.${a}.documents.${P}`,control:d,defaultValue:!0,render:({field:D})=>i.jsx(Pn,{id:`${a}-${P}`,label:P.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()),checked:D.value,onChange:D.onChange})},P))})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Data Verifications"}),i.jsx("div",{className:"space-y-3",children:Object.keys(Xg.verifications).map(P=>i.jsx(_e,{name:`rulesByDesignation.${a}.verifications.${P}`,control:d,defaultValue:!0,render:({field:D})=>i.jsx(Pn,{id:`${a}-${P}`,label:P.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()),checked:D.value,onChange:D.onChange})},P))})]})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Cl,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"ESI Eligibility"}),i.jsx("p",{className:"text-muted",children:"Define salary threshold for statutory insurance."})]}),i.jsx(_e,{name:"enableEsiRule",control:d,render:({field:P})=>i.jsx(Pn,{id:"enableEsiRule",label:"Enable Rule",checked:P.value,onChange:P.onChange})})]}),i.jsx("div",{className:`transition-opacity ${_?"opacity-100":"opacity-50 pointer-events-none"}`,children:i.jsxs("div",{className:"max-w-sm",children:[i.jsx(je,{label:"ESI Eligibility Gross Salary Threshold",id:"esiCtcThreshold",type:"number",registration:l("esiCtcThreshold",{valueAsNumber:!0}),disabled:!_}),i.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees at or below this amount are eligible for ESI. Those above are eligible for GMC."})]})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Cl,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"GMC/Insurance Policy Rules"}),i.jsx("p",{className:"text-muted",children:"Set default GMC policies."})]}),i.jsx(_e,{name:"enableGmcRule",control:d,render:({field:P})=>i.jsx(Pn,{id:"enableGmcRule",label:"Enable Rule",checked:P.value,onChange:P.onChange})})]}),i.jsxs("div",{className:`transition-opacity ${j?"opacity-100":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[i.jsx(je,{label:"GMC Salary Threshold",id:"salaryThreshold",type:"number",registration:l("salaryThreshold",{valueAsNumber:!0}),disabled:!j}),i.jsx(_e,{name:"defaultPolicySingle",control:d,render:({field:P})=>i.jsxs(Ke,{label:"Policy (Single)",...P,disabled:!j,children:[i.jsx("option",{value:"1L",children:"1 Lakh"}),i.jsx("option",{value:"2L",children:"2 Lakh"})]})}),i.jsx(_e,{name:"defaultPolicyMarried",control:d,render:({field:P})=>i.jsxs(Ke,{label:"Policy (Married)",...P,disabled:!j,children:[i.jsx("option",{value:"1L",children:"1 Lakh"}),i.jsx("option",{value:"2L",children:"2 Lakh"})]})})]}),i.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees with a salary *above* this threshold will be eligible for GMC."})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Gi,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Manpower Allocation"}),i.jsx("p",{className:"text-muted",children:"Set rules for enrolling based on approved manpower."})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(_e,{name:"enforceManpowerLimit",control:d,render:({field:P})=>i.jsx(Pn,{id:"enforceManpowerLimit",label:"Enforce Manpower Allocation Limits",description:"Check new enrollments against the approved manpower count for the site.",checked:P.value,onChange:P.onChange})}),i.jsx("div",{className:`max-w-sm transition-opacity ${w?"opacity-100":"opacity-50 pointer-events-none"}`,children:i.jsxs(Ke,{label:"Action When Limit is Reached",id:"manpowerLimitRule",registration:l("manpowerLimitRule"),disabled:!w,children:[i.jsx("option",{value:"warn",children:"Warn field officer but allow enrollment"}),i.jsx("option",{value:"block",children:"Block enrollment and require approval"})]})})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(cr,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Field Officer Permissions"}),i.jsx("p",{className:"text-muted",children:"Control what field officers can do during enrollment."})]})]}),i.jsx("div",{className:"space-y-4",children:i.jsx(_e,{name:"allowSalaryEdit",control:d,render:({field:P})=>i.jsx(Pn,{id:"allowSalaryEdit",label:"Allow Salary Editing",description:"Permit field officers to edit default salary, triggering an approval workflow.",checked:P.value??!1,onChange:P.onChange})})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(hu,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Family Details Validation"}),i.jsx("p",{className:"text-muted",children:"Set rules for validating family member details."})]})]}),i.jsx("div",{className:"space-y-4",children:i.jsx(_e,{name:"enforceFamilyValidation",control:d,render:({field:P})=>i.jsx(Pn,{id:"enforceFamilyValidation",label:"Enforce Strict Family Validation",description:"Enable checks for duplicates, age, and gender based on relationship.",checked:P.value??!1,onChange:P.onChange})})})]})]})},Ide=()=>{const{id:n}=Ff(),e=St(),[t,r]=E.useState(null),[s,a]=E.useState(!0),[o,l]=E.useState(!1),c=E.useRef(null),{data:d,setFormsGenerated:h}=$n(),p=OC(O=>O.currentLogo),[x,v]=E.useState(!1);E.useEffect(()=>{(async()=>{if(n&&!n.startsWith("draft_")){a(!0);const I=await ue.getOnboardingDataById(n);r(I||null),a(!1)}else r(d),a(!1)})()},[n,d]);const w=async()=>{const O=c.current;if(O&&t){v(!0);try{const I=O.outerHTML,q={margin:0,filename:`Onboarding_Forms_${t?.personal.employeeId}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ue.generatePdf(I,q)}catch(I){console.error("PDF generation failed:",I)}finally{v(!1)}}},_=()=>{h(!0),e(`/onboarding/add/review?id=${n}`)};if(s||x)return i.jsx("div",{className:"text-center p-10",children:i.jsx(_t,{className:"h-8 w-8 animate-spin mx-auto"})});if(!t)return i.jsx("div",{className:"text-center p-10 text-red-500",children:"Could not find employee data."});const j=t,T=`${j.personal.firstName} ${j.personal.middleName||""} ${j.personal.lastName}`.replace(/\s+/g," ").trim(),P=j.family.find(O=>O.relation==="Father")?.name||"",D=j.family.find(O=>O.relation==="Spouse")?.name||"",M=j.family.find(O=>O.relation==="Mother")?.name||"";return i.jsx("div",{className:"bg-page",children:i.jsxs("div",{className:"max-w-4xl p-4 sm:p-6 lg:p-8",children:[i.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card no-print mb-8 sticky top-4 z-10",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsxs(se,{type:"button",onClick:()=>e(-1),variant:"secondary",children:[i.jsx(Ra,{className:"mr-2 h-4 w-4"})," Go Back"]}),i.jsxs("div",{className:"text-center",children:[i.jsx("h2",{className:"font-bold text-lg",children:"Review Official Forms"}),i.jsx("p",{className:"text-sm text-muted",children:"Please confirm these details before submitting."})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(se,{type:"button",onClick:w,variant:"outline",disabled:x,children:[x?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(yi,{className:"mr-2 h-4 w-4"}),x?"Generating...":"Download"]}),i.jsx(se,{type:"button",onClick:_,children:"Confirm & Continue"})]})]})}),i.jsxs("div",{ref:c,className:"bg-white rounded-xl border border-border shadow-lg",children:[i.jsx("div",{className:"pdf-page p-8 font-serif text-sm text-black",children:i.jsxs("div",{className:"border-4 border-black p-6 h-full flex flex-col",children:[i.jsx("h1",{className:"text-center text-xl font-bold tracking-widest mb-8",children:"EMPLOYEE PERSONAL DATA"}),i.jsx("div",{className:"w-64 mx-auto border-2 border-black p-2 my-8",children:i.jsx("img",{src:p,alt:"Paradigm Logo",className:"w-full"})}),i.jsxs("div",{className:"mt-auto space-y-8 text-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S NAME"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:T})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"SITE"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.organization.organizationName})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"DESIGNATION"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.organization.designation})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S ID NO."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.personal.employeeId})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"PF No."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.uan.pfNumber||j.uan.uanNumber})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"ESI NO."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.esi.esiNumber})]})]})]})}),i.jsx("div",{className:"page-break"}),i.jsx("div",{className:"pdf-page p-8 font-serif text-xs text-black",children:i.jsxs("div",{className:"border-2 border-black p-4 h-full relative",children:[i.jsx("div",{className:"absolute top-4 right-4 w-48",children:i.jsx("img",{src:p,alt:"Paradigm Logo",className:"w-full"})}),i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h2",{className:"font-bold",children:["EMPLOYEE ID No. : ",i.jsx("span",{className:"font-normal underline",children:j.personal.employeeId})]}),i.jsx("h1",{className:"text-center font-bold text-base tracking-wider",children:"PERSONAL DATA"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("p",{children:["1. Name: ",i.jsx("span",{className:"underline",children:T})]}),i.jsxs("p",{children:["2. Father's Name: ",i.jsx("span",{className:"underline",children:P})]}),i.jsxs("p",{children:["3. Mother's Name: ",i.jsx("span",{className:"underline",children:M})]}),i.jsxs("p",{children:["4. Reference by: ",i.jsx("span",{className:"underline"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["5. Date of Birth: ",i.jsx("span",{className:"underline",children:j.personal.dob})]}),i.jsxs("p",{children:["6. Age: ",i.jsx("span",{className:"underline",children:j.personal.dob?new Date().getFullYear()-new Date(j.personal.dob).getFullYear():""})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["7. Qualification: ",i.jsx("span",{className:"underline",children:j.education[0]?.degree||""})]}),i.jsxs("p",{children:["8. Experience: ",i.jsx("span",{className:"underline"})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["9. Designation: ",i.jsx("span",{className:"underline",children:j.organization.designation})]}),i.jsxs("p",{children:["10. Net Salary Offered: ",i.jsx("span",{className:"underline",children:j.personal.salary?.toLocaleString("en-IN")})]})]}),i.jsxs("p",{children:["11. Present Address: ",i.jsx("span",{className:"underline",children:`${j.address.present.line1}, ${j.address.present.city}, ${j.address.present.state} - ${j.address.present.pincode}`})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["12. Permanent Address: ",i.jsx("span",{className:"underline",children:j.address.sameAsPresent?"Same as Present":`${j.address.permanent.line1}, ${j.address.permanent.city}`})]}),i.jsxs("p",{children:["Ph. No.: ",i.jsx("span",{className:"underline",children:j.personal.mobile})," Alternate Ph. No.: ",i.jsx("span",{className:"underline",children:j.personal.alternateMobile||""})]})]}),i.jsx("p",{children:"13. Left hand thumb impression"}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{})]}),i.jsx("p",{children:"14. Right hand thumb impression"}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["15. Marital Status: ",i.jsx("span",{className:"underline",children:j.personal.maritalStatus})]}),i.jsxs("p",{children:["16. Name of the Spouse: ",i.jsx("span",{className:"underline",children:D})," Contact No.: ",i.jsx("span",{className:"underline"})]})]}),i.jsxs("p",{children:["17. Languages Known: to Speak ",i.jsx("span",{className:"underline"})," to Write ",i.jsx("span",{className:"underline"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["18. Date of Joining: ",i.jsx("span",{className:"underline",children:j.organization.joiningDate})]}),i.jsx("p",{children:"19. ID Card:"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["20. ESI Number: ",i.jsx("span",{className:"underline",children:j.esi.esiNumber})]}),i.jsxs("p",{children:["21. PF Number: ",i.jsx("span",{className:"underline",children:j.uan.pfNumber||j.uan.uanNumber})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"22. Uniform Details: "}),i.jsx("p",{children:"23. Shoe Details: "})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["24. Name of the Site: ",i.jsx("span",{className:"underline",children:j.organization.organizationName})]}),i.jsx("p",{children:"25. Site / Estate Manager: "})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"26. Record enclosed: "}),i.jsx("p",{children:"28. Reference Name:"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"27. Hirer: "}),i.jsx("p",{className:"ml-24",children:"Reference Ph.:"})]}),i.jsxs("p",{children:["29. Emergency Contact Name: ",i.jsx("span",{className:"underline",children:j.personal.emergencyContactName})," Ph.: ",i.jsx("span",{className:"underline",children:j.personal.emergencyContactNumber})," Blood Group: ",i.jsx("span",{className:"underline",children:j.personal.bloodGroup})]})]}),i.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between",children:[i.jsx("p",{children:"Employee Signature:"}),i.jsx("p",{children:"Documented by:"})]})]})})]})]})})},Ade=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-blue-100 text-blue-800",Issued:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},ex=({title:n,sizes:e,headers:t,control:r,quantityType:s,quantities:a,readOnly:o=!1})=>{const l=Array.from(new Set(e.map(d=>d.fit))),c=Array.from(new Set(e.map(d=>d.size))).sort((d,h)=>{const p=parseInt(String(d)),x=parseInt(String(h));return!isNaN(p)&&!isNaN(x)?p-x:String(d).localeCompare(String(h))});return i.jsxs("div",{className:"border rounded-lg flex flex-col overflow-hidden",children:[i.jsx("h4",{className:"p-3 font-semibold bg-page border-b flex-shrink-0",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:"Size"}),t.map(d=>i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:d.label},String(d.key))),i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted w-20",children:"Qty"})]})}),i.jsx("tbody",{className:"divide-y",children:c.map(d=>i.jsx(ot.Fragment,{children:l.map((h,p)=>{const x=e.find(v=>v.size===d&&v.fit===h);return x?i.jsxs("tr",{children:[p===0&&i.jsx("td",{rowSpan:l.filter(v=>e.some(w=>w.size===d&&w.fit===v)).length,className:"px-2 py-2 align-middle font-semibold border-r",children:d}),t.map(v=>i.jsx("td",{className:"px-2 py-2",children:x[v.key]},String(v.key))),i.jsx("td",{className:"px-2 py-2",children:o?i.jsx("span",{className:"font-semibold block text-center pr-4",children:a?.[x.id]||0}):i.jsx(_e,{name:`${s}.${x.id}`,control:r,render:({field:v})=>i.jsx(je,{"aria-label":`Quantity for ${n} size ${d} ${h}`,type:"number",...v,value:v.value||"",onChange:w=>v.onChange(parseInt(w.target.value)||null),className:"!py-1.5"})})})]},x.id):null})},d))})]})})]})},Rde=({request:n,onClose:e,masterUniforms:t})=>{if(!n)return null;const{pantsQuantities:r,shirtsQuantities:s}=E.useMemo(()=>{const o={},l={};return n.items.forEach(c=>{c.category==="Pants"?o[c.sizeId]=c.quantity:l[c.sizeId]=c.quantity}),{pantsQuantities:o,shirtsQuantities:l}},[n.items]),a=n.gender==="Gents"?t.gents:t.ladies;return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-6xl my-4 animate-fade-in-scale flex flex-col max-h-[90vh]",onClick:o=>o.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-start flex-shrink-0",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Uniform Request Details"}),i.jsxs("p",{className:"text-sm text-muted",children:[n.siteName," - ",$e(new Date(n.requestedDate),"dd MMM, yyyy")]})]}),i.jsx(se,{variant:"icon",onClick:e,children:i.jsx(xi,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-6",children:i.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:n.gender==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(ex,{readOnly:!0,title:"Gents' Pants",sizes:a.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],quantities:r}),i.jsx(ex,{readOnly:!0,title:"Gents' Shirts",sizes:a.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],quantities:s})]}):i.jsxs(i.Fragment,{children:[i.jsx(ex,{readOnly:!0,title:"Ladies' Pants",sizes:a.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],quantities:r}),i.jsx(ex,{readOnly:!0,title:"Ladies' Shirts",sizes:a.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],quantities:s})]})})}),i.jsx("div",{className:"p-4 border-t flex justify-end flex-shrink-0",children:i.jsx(se,{variant:"secondary",onClick:e,children:"Close"})})]})})},Lde=()=>{const n=St(),[e,t]=E.useState("list"),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(null),[d,h]=E.useState(!0),[p,x]=E.useState(null),[v,w]=E.useState(null),[_,j]=E.useState(null),[T,P]=E.useState(null),D=async()=>{h(!0);try{const[q,F,V,U]=await Promise.all([ue.getUniformRequests(),ue.getOrganizations(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);s(q),o(F),c({gents:V,ladies:U})}catch{x({message:"Failed to load uniform data.",type:"error"})}finally{h(!1)}};E.useEffect(()=>{D()},[]);const M=()=>{n("/uniforms/request/new")},O=q=>{n(`/uniforms/request/edit/${q.id}`)},I=async()=>{if(_)try{await ue.deleteUniformRequest(_.id),x({message:"Request deleted.",type:"success"}),j(null),D()}catch{x({message:"Failed to delete request.",type:"error"})}};return d?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"p-4 space-y-6",children:[p&&i.jsx(ht,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Yr,{isOpen:!!_,onClose:()=>j(null),onConfirm:I,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),l&&i.jsx(Rde,{request:T,onClose:()=>P(null),masterUniforms:l}),i.jsx("div",{className:"bg-card p-4 rounded-2xl",children:i.jsx(Qi,{title:"Uniform Management",children:e==="list"&&i.jsxs(se,{onClick:M,children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," New Uniform Request"]})})}),e==="list"&&i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site / Employee"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Gender"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Requested By"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Source"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{children:r.map(q=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Site",className:"px-4 py-3 font-medium",children:[i.jsx("p",{children:q.siteName}),q.source==="Individual"&&q.employeeDetails?.[0]?.employeeName&&i.jsxs("p",{className:"text-xs text-muted",children:["For: ",q.employeeDetails[0].employeeName]}),q.source==="Enrollment"&&i.jsxs("p",{className:"text-xs text-muted",children:["(",q.employeeDetails?.length||0," employees)"]})]}),i.jsx("td",{"data-label":"Gender",className:"px-4 py-3 text-muted",children:q.gender}),i.jsx("td",{"data-label":"Requested By",className:"px-4 py-3 text-muted",children:q.requestedByName||"System"}),i.jsx("td",{"data-label":"Source",className:"px-4 py-3 text-muted",children:q.source||"Bulk"}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(Ade,{status:q.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[i.jsx(se,{variant:"icon",size:"sm",onClick:()=>P(q),title:"View Request",children:i.jsx(Sl,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>O(q),title:"Edit Request",disabled:q.source==="Enrollment",children:i.jsx(cr,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>j(q),title:"Delete Request",disabled:q.source==="Enrollment",children:i.jsx(rn,{className:"h-4 w-4 text-red-600"})})]})})]},q.id))})]}),r.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No uniform requests found."})]})]})},Fde=({item:n})=>{const[e,t]=E.useState(!1);return i.jsxs("div",{className:"bg-card rounded-xl border border-border p-4",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-primary-text",children:n.employeeName}),i.jsx("p",{className:"text-sm text-muted",children:n.employeeId}),i.jsx("p",{className:"text-xs text-muted mt-1",children:$e(new Date(n.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")})]}),i.jsx("div",{className:"text-right",children:i.jsxs("p",{className:"text-lg font-bold text-accent",children:["",n.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),n.breakdown.length>0&&i.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[i.jsxs("button",{onClick:()=>t(!e),className:"flex justify-between items-center w-full text-sm text-muted",children:[i.jsx("span",{children:"Details"}),i.jsx(vu,{className:`h-4 w-4 transition-transform ${e?"rotate-180":""}`})]}),e&&i.jsx("ul",{className:"list-disc list-inside space-y-1 mt-2 text-sm text-muted animate-fade-in-down",children:n.breakdown.map((r,s)=>i.jsxs("li",{children:[r.name,": ",(r.cost||0).toFixed(2)]},s))})]})]})},qde=()=>i.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,e)=>i.jsxs("div",{className:"bg-card rounded-xl border border-border p-4 space-y-3 skeleton-pulse",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-5 w-32 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-24 bg-gray-300 rounded"})]}),i.jsx("div",{className:"h-6 w-20 bg-gray-300 rounded"})]}),i.jsx("div",{className:"h-4 w-1/4 bg-gray-300 rounded mt-2"})]},e))}),zde=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),{verificationCosts:s,updateVerificationCosts:a}=gi(),[o,l]=E.useState(s),[c,d]=E.useState(!1),[h,p]=E.useState([{startDate:hf(new Date,29),endDate:new Date,key:"selection"}]),[x,v]=E.useState("Last 30 Days"),[w,_]=E.useState(!1),j=E.useRef(null),[T,P]=E.useState(null),D=E.useRef(null),M=Ft("(max-width: 767px)"),O=E.useCallback(async()=>{const Z=h[0]?.startDate,oe=h[0]?.endDate;if(!(!Z||!oe)){r(!0);try{const H=await ue.getVerificationCostBreakdown($e(Z,"yyyy-MM-dd"),$e(oe,"yyyy-MM-dd"));e(H)}catch(H){console.error("Failed to fetch cost breakdown",H),P({message:"Failed to load verification data.",type:"error"})}finally{r(!1)}}},[h]);E.useEffect(()=>{O()},[O]),E.useEffect(()=>{const Z=oe=>{j.current&&!j.current.contains(oe.target)&&_(!1)};return document.addEventListener("mousedown",Z),()=>document.removeEventListener("mousedown",Z)},[]),E.useEffect(()=>{l(s)},[s]),E.useEffect(()=>{d(JSON.stringify(o)!==JSON.stringify(s))},[o,s]);const I=(Z,oe,H)=>{l(Q=>Q.map(re=>re.id===Z?oe==="cost"?{...re,cost:parseFloat(H)||0}:{...re,name:H}:re))},q=()=>{l(Z=>[...Z,{id:`new_${Date.now()}`,name:"New Verification Type",cost:0}])},F=Z=>{l(oe=>oe.filter(H=>H.id!==Z))},V=()=>{a(o),P({message:"Costs updated successfully!",type:"success"})},U=E.useMemo(()=>{const Z=new Map(s.map(oe=>[oe.name,oe.cost]));return n.map(oe=>{const H=oe.breakdown.map(re=>({...re,cost:Number(Z.get(re.name))||0})),Q=H.reduce((re,de)=>re+(de.cost||0)*de.count,0);return{...oe,breakdown:H,totalCost:Q}})},[n,s]),W=E.useMemo(()=>{const Z=U.length,oe=U.reduce((Q,re)=>Q+re.totalCost,0),H=Z>0?oe/Z:0;return{totalEmployees:Z,totalCost:oe,averageCost:H}},[U]),$=E.useMemo(()=>{const Z={};return U.forEach(oe=>{oe.breakdown.forEach(H=>{Z[H.name]||(Z[H.name]={count:0,total:0}),Z[H.name].count+=H.count,Z[H.name].total+=(H.cost||0)*H.count})}),Object.entries(Z).map(([oe,H])=>({name:oe,...H}))},[U]),[ne,Y]=E.useState(!1),ae=async Z=>{{const oe=D.current;if(!oe){P({message:"Could not find report to export.",type:"error"});return}Y(!0);try{const H=oe.outerHTML,Q={margin:.5,filename:`Cost_Analysis_Report_${$e(h[0].startDate,"yyyy-MM-dd")}_to_${$e(h[0].endDate,"yyyy-MM-dd")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ue.generatePdf(H,Q)}catch(H){console.error("PDF generation failed:",H),P({message:"Failed to generate PDF.",type:"error"})}finally{Y(!1)}}},J=[{label:"Today",value:"Today"},{label:"Last 7 Days",value:"Last 7 Days"},{label:"Last 30 Days",value:"Last 30 Days"}],ee=Z=>{const oe=new Date;let H=new Date;Z==="Today"?H=sx():Z==="Last 7 Days"?H=hf(oe,6):Z==="Last 30 Days"&&(H=hf(oe,29)),v(Z),p([{startDate:H,endDate:oe,key:"selection"}]),_(!1)},X=Z=>{p([Z.selection])};return i.jsxs("div",{className:"p-4 space-y-6",children:[T&&i.jsx(ht,{message:T.message,type:T.type,onDismiss:()=>P(null)}),i.jsx(Qi,{title:"Verification Costing",children:i.jsx("div",{className:"w-full sm:w-auto",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:flex sm:items-center sm:flex-wrap",children:[i.jsxs(se,{onClick:()=>ae(),variant:"outline",size:"sm",disabled:ne||t||U.length===0,children:[ne?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(yi,{className:"mr-2 h-4 w-4"}),ne?"Generating PDF...":"Download PDF"]}),J.map(Z=>i.jsx(se,{variant:x===Z.value?"outline":"secondary",size:"sm",onClick:()=>ee(Z.value),className:"justify-center",children:Z.label},Z.value)),i.jsxs("div",{className:"relative",ref:j,children:[i.jsxs(se,{variant:x==="Custom"?"outline":"secondary",size:"sm",onClick:()=>{_(Z=>!Z),v("Custom")},className:"w-full justify-center",children:[i.jsx(Pa,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Custom Range"})]}),w&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:i.jsx(bm.DateRangePicker,{onChange:X,ranges:h,maxDate:new Date,direction:"horizontal"})})]})]})})}),i.jsx("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"cursor-pointer flex justify-between items-center list-none",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2 text-primary-text",children:[i.jsx(Dm,{className:"h-5 w-5 text-muted"})," Cost Configuration"]}),i.jsx(vu,{className:"transition-transform group-open:rotate-180"})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t",children:[i.jsx("div",{className:"space-y-2",children:o.map(Z=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[i.jsx("div",{className:"col-span-12 sm:col-span-6",children:i.jsx(je,{"aria-label":"Cost Item Name",value:Z.name,onChange:oe=>I(Z.id,"name",oe.target.value),className:"!py-2"})}),i.jsx("div",{className:"col-span-8 sm:col-span-4",children:i.jsx(je,{"aria-label":"Cost Value",type:"number",step:"0.01",value:Z.cost||0,onChange:oe=>I(Z.id,"cost",oe.target.value),className:"!py-2"})}),i.jsx("div",{className:"col-span-4 sm:col-span-2 text-right",children:i.jsx(se,{variant:"icon",onClick:()=>F(Z.id),"aria-label":`Remove ${Z.name}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},Z.id))}),i.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[i.jsxs(se,{type:"button",variant:"outline",size:"sm",onClick:q,children:[i.jsx(Bt,{className:"mr-2 h-4"})," Add Cost Item"]}),i.jsxs(se,{onClick:V,disabled:!c,children:[i.jsx(Ss,{className:"mr-2 h-4"})," Save Costs"]})]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx(_o,{title:"Total Verification Cost",value:`${W.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Cl}),i.jsx(_o,{title:"Total Verified Employees",value:W.totalEmployees,icon:Gi}),i.jsx(_o,{title:"Avg. Cost Per Employee",value:`${W.averageCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Cl})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Verification Usage Breakdown"}),t?i.jsx("div",{className:"flex justify-center items-center h-24",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted"})}):$.length>0?i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:$.map(Z=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border",children:[i.jsx("p",{className:"text-sm font-medium text-muted",children:Z.name}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:Z.count}),i.jsxs("p",{className:"text-sm font-semibold text-accent-dark",children:["Total: ",Z.total.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Z.name))}):i.jsx("p",{className:"text-center text-muted py-8",children:"No verification data for this period."})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx("div",{className:"flex justify-between items-center",children:i.jsx("h3",{className:"text-lg font-semibold text-primary-text",children:"Detailed Report"})}),i.jsx("div",{ref:D,className:"mt-4 pt-4 border-t border-border",children:M?t?i.jsx(qde,{}):U.length===0?i.jsx("p",{className:"text-center text-muted py-8",children:"No report data for this period."}):i.jsx("div",{className:"space-y-4",children:U.map(Z=>i.jsx(Fde,{item:Z},Z.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Enrollment Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Cost Breakdown"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase",children:"Total Cost"})]})}),i.jsx("tbody",{children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted mx-auto"})})}):U.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No report data for this period."})}):U.map(Z=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Employee",className:"px-6 py-4",children:[i.jsx("div",{className:"font-medium text-primary-text",children:Z.employeeName}),i.jsx("div",{className:"text-sm text-muted",children:Z.employeeId})]}),i.jsx("td",{"data-label":"Enrollment Date",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:$e(new Date(Z.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")}),i.jsx("td",{"data-label":"Cost Breakdown",className:"px-6 py-4 text-sm text-muted",children:i.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[Z.breakdown.map((oe,H)=>i.jsxs("li",{children:[oe.name,": ",(oe.cost||0).toFixed(2)]},H)),Z.breakdown.length===0&&i.jsx("li",{children:"No verifications performed"})]})}),i.jsxs("td",{"data-label":"Total Cost",className:"px-6 py-4 whitespace-nowrap text-right font-semibold text-primary-text",children:["",Z.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Z.id))})]})})})]})]})},Ude=({status:n})=>{if(!n)return i.jsx("span",{className:"text-xs text-muted",children:"-"});const e={"Not Generated":"bg-slate-700 text-white dark:bg-slate-600 dark:text-slate-200",Generated:"bg-sky-100 text-sky-800 dark:bg-sky-500/20 dark:text-sky-300",Sent:"bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-300",Paid:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${e[n]}`,children:n})},Vde=({invoiceData:n,discount:e,setDiscount:t,roundOff:r,setRoundOff:s})=>{const a=l=>new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l),o=E.useMemo(()=>{if(!n)return null;const l=n.lineItems.reduce((x,v)=>{const w=v.deployment*v.ratePerMonth;return v.description.toLowerCase().includes("deduction")?x-w:x+w},0),c=l*.1,d=l+c-e,h=d*.09,p=d+h+h+r;return{subTotal:l,serviceCharge:c,grandTotal:d,gst:h,finalTotal:p}},[n,e,r]);return o?i.jsxs("div",{className:"p-4 bg-white text-black text-[10px] printable-area",children:[i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("div",{children:[i.jsxs("p",{children:["Name : ",n.siteName]}),i.jsxs("p",{children:["Address : ",n.siteAddress]}),i.jsxs("p",{children:["City : ",n.siteAddress.split(",").pop()?.trim()]})]}),i.jsxs("div",{className:"border border-black",children:[i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Invoice No"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceNumber})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Date"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceDate})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Month"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.statementMonth.split("-")[0]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-black",children:"Due Date"}),i.jsx("div",{className:"p-1",children:"January 15, 2023"})]})]})]}),i.jsx("div",{className:"my-4 flex justify-center",children:i.jsx(Zi,{className:"h-10"})}),i.jsxs("h2",{className:"text-center font-bold text-sm underline mb-2",children:[n.siteName," Summary Statement for the month of ",n.statementMonth]}),i.jsxs("table",{className:"w-full border-collapse border border-black",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"font-bold bg-gray-200",children:[i.jsx("td",{className:"border p-1 border-black",children:"Sl.No"}),i.jsx("td",{className:"border p-1 border-black",children:"Description"}),i.jsx("td",{className:"border p-1 border-black",children:"Deployment"}),i.jsx("td",{className:"border p-1 border-black",children:"No of Days"}),i.jsx("td",{className:"border p-1 border-black",children:"Rate/Day"}),i.jsx("td",{className:"border p-1 border-black",children:"Rate/Month"}),i.jsx("td",{className:"border p-1 border-black",children:"Amount(Rs)"})]})}),i.jsxs("tbody",{children:[i.jsx("tr",{children:i.jsxs("td",{className:"border p-1 border-black font-bold",colSpan:7,children:["SERVICES (01/",$e(new Date(n.statementMonth),"MM/yyyy")," to ",$e(new Date(n.invoiceDate),"dd/MM/yyyy"),")"]})}),n.lineItems.map((l,c)=>{const d=l.deployment*l.ratePerMonth,h=l.description.toLowerCase().includes("deduction"),p=l.deployment===0;return i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1 border-black text-center",children:c+1}),i.jsx("td",{className:`border p-1 border-black ${h?"text-red-600":""}`,children:l.description}),i.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":l.deployment}),i.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":l.noOfDays}),i.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":a(l.ratePerDay)}),i.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":a(l.ratePerMonth)}),i.jsx("td",{className:`border p-1 border-black text-right ${h?"text-red-600":""}`,children:a(d)})]},l.id)}),Array.from({length:Math.max(0,10-n.lineItems.length)}).map((l,c)=>i.jsx("tr",{children:i.jsx("td",{className:"border p-1 border-black h-6",colSpan:7})},`spacer-${c}`))]}),i.jsxs("tfoot",{children:[i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Sub Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:a(o.subTotal)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Admin,Overheads and Service Charges 10% on Sub Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.serviceCharge)})]}),i.jsxs("tr",{className:"no-print",children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold text-red-600",children:"Discount"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:i.jsx(je,{type:"number",value:e,onChange:l=>t(parseFloat(l.target.value)||0),className:"text-right !p-1"})})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Grand Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:a(o.grandTotal)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"Central GST"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.gst)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"State GST"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.gst)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Round off"}),i.jsxs("td",{colSpan:2,className:"border p-1 border-black text-right",children:[i.jsx("span",{className:"print-only",children:a(r)}),i.jsx("span",{className:"no-print",children:i.jsx(je,{type:"number",step:"0.01",value:r,onChange:l=>s(parseFloat(l.target.value)||0),className:"text-right !p-1"})})]})]}),i.jsxs("tr",{className:"bg-gray-200 font-bold text-base",children:[i.jsx("td",{colSpan:5,className:"border p-2 border-black",children:"Payable for Services rendered"}),i.jsx("td",{colSpan:2,className:"border p-2 border-black text-right",children:a(o.finalTotal)})]})]})]})]}):null},Bde=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState($e(new Date,"yyyy-MM")),[c,d]=E.useState({}),[h,p]=E.useState({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),[x,v]=E.useState(0),[w,_]=E.useState(.2),[j,T]=E.useState(null),P=E.useRef(null),[D,M]=E.useState(!1);E.useEffect(()=>{ue.getOrganizations().then(V=>e(V.sort((U,W)=>U.shortName.localeCompare(W.shortName)))).catch(()=>T({message:"Failed to load sites.",type:"error"})).finally(()=>r(!1))},[]);const O=E.useCallback(async V=>{a(!0);try{const U=new Date(V+"-02"),W=await ue.getInvoiceStatuses(U);d(W)}catch{T({message:"Failed to fetch invoice statuses.",type:"error"})}finally{a(!1)}},[]);E.useEffect(()=>{o&&O(o)},[o,O]);const I=async V=>{p({isOpen:!0,site:V,invoiceData:null,isLoading:!0});try{const U=new Date(o+"-02"),W=await ue.getInvoiceSummaryData(V.id,U);p({isOpen:!0,site:V,invoiceData:W,isLoading:!1})}catch{T({message:"Failed to fetch invoice data.",type:"error"}),p({isOpen:!1,site:null,invoiceData:null,isLoading:!1})}},q=async()=>{const V=P.current;if(!V||!h.invoiceData){T({message:"Could not find invoice to export.",type:"error"});return}M(!0);try{const U=V.outerHTML,W={margin:.25,filename:`Invoice_${h.invoiceData.siteName.replace(" ","_")}_${h.invoiceData.statementMonth}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ue.generatePdf(U,W)}catch(U){console.error("PDF generation failed:",U),T({message:"Failed to generate PDF.",type:"error"})}finally{M(!1)}},F=()=>{p({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),v(0),_(.2)};return t?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"p-4 md:p-0",children:[j&&i.jsx(ht,{message:j.message,type:j.type,onDismiss:()=>T(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx(Qi,{title:"Invoice Summary"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Monthly Invoice Status"}),i.jsx("div",{className:"md:w-56",children:i.jsx(je,{label:"",id:"month-select",type:"month",value:o,onChange:V=>l(V.target.value)})})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Invoice Status"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:n.map(V=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:V.shortName}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:s?i.jsx(_t,{className:"h-4 w-4 animate-spin"}):i.jsx(Ude,{status:c[V.id]})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[i.jsx(se,{variant:"icon",size:"sm",onClick:()=>I(V),disabled:c[V.id]==="Not Generated"||s,title:"View Invoice",children:i.jsx(Sl,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>I(V),disabled:c[V.id]==="Not Generated"||s,title:"Download Invoice",children:i.jsx(yi,{className:"h-4 w-4"})})]})})]},V.id))})]})})]})]}),h.isOpen&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:F,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl m-4 animate-fade-in-scale flex flex-col",onClick:V=>V.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center no-print",children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Invoice for ",h.site?.shortName]}),i.jsx(se,{variant:"icon",onClick:F,children:i.jsx(xi,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-4 max-h-[70vh]",children:h.isLoading?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):h.invoiceData?i.jsx("div",{ref:P,children:i.jsx(Vde,{invoiceData:h.invoiceData,discount:x,setDiscount:v,roundOff:w,setRoundOff:_})}):i.jsx("p",{className:"text-center text-muted",children:"No data to display."})}),i.jsx("div",{className:"p-4 border-t flex justify-end no-print",children:i.jsxs(se,{onClick:q,disabled:!h.invoiceData||D,children:[D?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(yi,{className:"mr-2 h-4 w-4"}),D?"Generating...":"Download PDF"]})})]})})]})};var Gh={exports:{}};var Wde=Gh.exports,GL;function $de(){return GL||(GL=1,(function(n,e){(function(t,r){r(e)})(Wde,(function(t){var r="1.9.4";function s(f){var y,C,A,B;for(C=1,A=arguments.length;C<A;C++){B=arguments[C];for(y in B)f[y]=B[y]}return f}var a=Object.create||(function(){function f(){}return function(y){return f.prototype=y,new f}})();function o(f,y){var C=Array.prototype.slice;if(f.bind)return f.bind.apply(f,C.call(arguments,1));var A=C.call(arguments,2);return function(){return f.apply(y,A.length?A.concat(C.call(arguments)):arguments)}}var l=0;function c(f){return"_leaflet_id"in f||(f._leaflet_id=++l),f._leaflet_id}function d(f,y,C){var A,B,K,he;return he=function(){A=!1,B&&(K.apply(C,B),B=!1)},K=function(){A?B=arguments:(f.apply(C,arguments),setTimeout(he,y),A=!0)},K}function h(f,y,C){var A=y[1],B=y[0],K=A-B;return f===A&&C?f:((f-B)%K+K)%K+B}function p(){return!1}function x(f,y){if(y===!1)return f;var C=Math.pow(10,y===void 0?6:y);return Math.round(f*C)/C}function v(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function w(f){return v(f).split(/\s+/)}function _(f,y){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?a(f.options):{});for(var C in y)f.options[C]=y[C];return f.options}function j(f,y,C){var A=[];for(var B in f)A.push(encodeURIComponent(C?B.toUpperCase():B)+"="+encodeURIComponent(f[B]));return(!y||y.indexOf("?")===-1?"?":"&")+A.join("&")}var T=/\{ *([\w_ -]+) *\}/g;function P(f,y){return f.replace(T,function(C,A){var B=y[A];if(B===void 0)throw new Error("No value provided for variable "+C);return typeof B=="function"&&(B=B(y)),B})}var D=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function M(f,y){for(var C=0;C<f.length;C++)if(f[C]===y)return C;return-1}var O="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function I(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var q=0;function F(f){var y=+new Date,C=Math.max(0,16-(y-q));return q=y+C,window.setTimeout(f,C)}var V=window.requestAnimationFrame||I("RequestAnimationFrame")||F,U=window.cancelAnimationFrame||I("CancelAnimationFrame")||I("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function W(f,y,C){if(C&&V===F)f.call(y);else return V.call(window,o(f,y))}function $(f){f&&U.call(window,f)}var ne={__proto__:null,extend:s,create:a,bind:o,get lastId(){return l},stamp:c,throttle:d,wrapNum:h,falseFn:p,formatNum:x,trim:v,splitWords:w,setOptions:_,getParamString:j,template:P,isArray:D,indexOf:M,emptyImageUrl:O,requestFn:V,cancelFn:U,requestAnimFrame:W,cancelAnimFrame:$};function Y(){}Y.extend=function(f){var y=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},C=y.__super__=this.prototype,A=a(C);A.constructor=y,y.prototype=A;for(var B in this)Object.prototype.hasOwnProperty.call(this,B)&&B!=="prototype"&&B!=="__super__"&&(y[B]=this[B]);return f.statics&&s(y,f.statics),f.includes&&(ae(f.includes),s.apply(null,[A].concat(f.includes))),s(A,f),delete A.statics,delete A.includes,A.options&&(A.options=C.options?a(C.options):{},s(A.options,f.options)),A._initHooks=[],A.callInitHooks=function(){if(!this._initHooksCalled){C.callInitHooks&&C.callInitHooks.call(this),this._initHooksCalled=!0;for(var K=0,he=A._initHooks.length;K<he;K++)A._initHooks[K].call(this)}},y},Y.include=function(f){var y=this.prototype.options;return s(this.prototype,f),f.options&&(this.prototype.options=y,this.mergeOptions(f.options)),this},Y.mergeOptions=function(f){return s(this.prototype.options,f),this},Y.addInitHook=function(f){var y=Array.prototype.slice.call(arguments,1),C=typeof f=="function"?f:function(){this[f].apply(this,y)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(C),this};function ae(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=D(f)?f:[f];for(var y=0;y<f.length;y++)f[y]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var J={on:function(f,y,C){if(typeof f=="object")for(var A in f)this._on(A,f[A],y);else{f=w(f);for(var B=0,K=f.length;B<K;B++)this._on(f[B],y,C)}return this},off:function(f,y,C){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var A in f)this._off(A,f[A],y);else{f=w(f);for(var B=arguments.length===1,K=0,he=f.length;K<he;K++)B?this._off(f[K]):this._off(f[K],y,C)}return this},_on:function(f,y,C,A){if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}if(this._listens(f,y,C)===!1){C===this&&(C=void 0);var B={fn:y,ctx:C};A&&(B.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(B)}},_off:function(f,y,C){var A,B,K;if(this._events&&(A=this._events[f],!!A)){if(arguments.length===1){if(this._firingCount)for(B=0,K=A.length;B<K;B++)A[B].fn=p;delete this._events[f];return}if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}var he=this._listens(f,y,C);if(he!==!1){var Se=A[he];this._firingCount&&(Se.fn=p,this._events[f]=A=A.slice()),A.splice(he,1)}}},fire:function(f,y,C){if(!this.listens(f,C))return this;var A=s({},y,{type:f,target:this,sourceTarget:y&&y.sourceTarget||this});if(this._events){var B=this._events[f];if(B){this._firingCount=this._firingCount+1||1;for(var K=0,he=B.length;K<he;K++){var Se=B[K],Ee=Se.fn;Se.once&&this.off(f,Ee,Se.ctx),Ee.call(Se.ctx||this,A)}this._firingCount--}}return C&&this._propagateEvent(A),this},listens:function(f,y,C,A){typeof f!="string"&&console.warn('"string" type argument expected');var B=y;typeof y!="function"&&(A=!!y,B=void 0,C=void 0);var K=this._events&&this._events[f];if(K&&K.length&&this._listens(f,B,C)!==!1)return!0;if(A){for(var he in this._eventParents)if(this._eventParents[he].listens(f,y,C,A))return!0}return!1},_listens:function(f,y,C){if(!this._events)return!1;var A=this._events[f]||[];if(!y)return!!A.length;C===this&&(C=void 0);for(var B=0,K=A.length;B<K;B++)if(A[B].fn===y&&A[B].ctx===C)return B;return!1},once:function(f,y,C){if(typeof f=="object")for(var A in f)this._on(A,f[A],y,!0);else{f=w(f);for(var B=0,K=f.length;B<K;B++)this._on(f[B],y,C,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[c(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[c(f)],this},_propagateEvent:function(f){for(var y in this._eventParents)this._eventParents[y].fire(f.type,s({layer:f.target,propagatedFrom:f.target},f),!0)}};J.addEventListener=J.on,J.removeEventListener=J.clearAllEventListeners=J.off,J.addOneTimeEventListener=J.once,J.fireEvent=J.fire,J.hasEventListeners=J.listens;var ee=Y.extend(J);function X(f,y,C){this.x=C?Math.round(f):f,this.y=C?Math.round(y):y}var Z=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};X.prototype={clone:function(){return new X(this.x,this.y)},add:function(f){return this.clone()._add(oe(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(oe(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new X(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new X(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Z(this.x),this.y=Z(this.y),this},distanceTo:function(f){f=oe(f);var y=f.x-this.x,C=f.y-this.y;return Math.sqrt(y*y+C*C)},equals:function(f){return f=oe(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=oe(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function oe(f,y,C){return f instanceof X?f:D(f)?new X(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new X(f.x,f.y):new X(f,y,C)}function H(f,y){if(f)for(var C=y?[f,y]:f,A=0,B=C.length;A<B;A++)this.extend(C[A])}H.prototype={extend:function(f){var y,C;if(!f)return this;if(f instanceof X||typeof f[0]=="number"||"x"in f)y=C=oe(f);else if(f=Q(f),y=f.min,C=f.max,!y||!C)return this;return!this.min&&!this.max?(this.min=y.clone(),this.max=C.clone()):(this.min.x=Math.min(y.x,this.min.x),this.max.x=Math.max(C.x,this.max.x),this.min.y=Math.min(y.y,this.min.y),this.max.y=Math.max(C.y,this.max.y)),this},getCenter:function(f){return oe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return oe(this.min.x,this.max.y)},getTopRight:function(){return oe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var y,C;return typeof f[0]=="number"||f instanceof X?f=oe(f):f=Q(f),f instanceof H?(y=f.min,C=f.max):y=C=f,y.x>=this.min.x&&C.x<=this.max.x&&y.y>=this.min.y&&C.y<=this.max.y},intersects:function(f){f=Q(f);var y=this.min,C=this.max,A=f.min,B=f.max,K=B.x>=y.x&&A.x<=C.x,he=B.y>=y.y&&A.y<=C.y;return K&&he},overlaps:function(f){f=Q(f);var y=this.min,C=this.max,A=f.min,B=f.max,K=B.x>y.x&&A.x<C.x,he=B.y>y.y&&A.y<C.y;return K&&he},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var y=this.min,C=this.max,A=Math.abs(y.x-C.x)*f,B=Math.abs(y.y-C.y)*f;return Q(oe(y.x-A,y.y-B),oe(C.x+A,C.y+B))},equals:function(f){return f?(f=Q(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function Q(f,y){return!f||f instanceof H?f:new H(f,y)}function re(f,y){if(f)for(var C=y?[f,y]:f,A=0,B=C.length;A<B;A++)this.extend(C[A])}re.prototype={extend:function(f){var y=this._southWest,C=this._northEast,A,B;if(f instanceof ce)A=f,B=f;else if(f instanceof re){if(A=f._southWest,B=f._northEast,!A||!B)return this}else return f?this.extend(pe(f)||de(f)):this;return!y&&!C?(this._southWest=new ce(A.lat,A.lng),this._northEast=new ce(B.lat,B.lng)):(y.lat=Math.min(A.lat,y.lat),y.lng=Math.min(A.lng,y.lng),C.lat=Math.max(B.lat,C.lat),C.lng=Math.max(B.lng,C.lng)),this},pad:function(f){var y=this._southWest,C=this._northEast,A=Math.abs(y.lat-C.lat)*f,B=Math.abs(y.lng-C.lng)*f;return new re(new ce(y.lat-A,y.lng-B),new ce(C.lat+A,C.lng+B))},getCenter:function(){return new ce((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ce(this.getNorth(),this.getWest())},getSouthEast:function(){return new ce(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof ce||"lat"in f?f=pe(f):f=de(f);var y=this._southWest,C=this._northEast,A,B;return f instanceof re?(A=f.getSouthWest(),B=f.getNorthEast()):A=B=f,A.lat>=y.lat&&B.lat<=C.lat&&A.lng>=y.lng&&B.lng<=C.lng},intersects:function(f){f=de(f);var y=this._southWest,C=this._northEast,A=f.getSouthWest(),B=f.getNorthEast(),K=B.lat>=y.lat&&A.lat<=C.lat,he=B.lng>=y.lng&&A.lng<=C.lng;return K&&he},overlaps:function(f){f=de(f);var y=this._southWest,C=this._northEast,A=f.getSouthWest(),B=f.getNorthEast(),K=B.lat>y.lat&&A.lat<C.lat,he=B.lng>y.lng&&A.lng<C.lng;return K&&he},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,y){return f?(f=de(f),this._southWest.equals(f.getSouthWest(),y)&&this._northEast.equals(f.getNorthEast(),y)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function de(f,y){return f instanceof re?f:new re(f,y)}function ce(f,y,C){if(isNaN(f)||isNaN(y))throw new Error("Invalid LatLng object: ("+f+", "+y+")");this.lat=+f,this.lng=+y,C!==void 0&&(this.alt=+C)}ce.prototype={equals:function(f,y){if(!f)return!1;f=pe(f);var C=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return C<=(y===void 0?1e-9:y)},toString:function(f){return"LatLng("+x(this.lat,f)+", "+x(this.lng,f)+")"},distanceTo:function(f){return xe.distance(this,pe(f))},wrap:function(){return xe.wrapLatLng(this)},toBounds:function(f){var y=180*f/40075017,C=y/Math.cos(Math.PI/180*this.lat);return de([this.lat-y,this.lng-C],[this.lat+y,this.lng+C])},clone:function(){return new ce(this.lat,this.lng,this.alt)}};function pe(f,y,C){return f instanceof ce?f:D(f)&&typeof f[0]!="object"?f.length===3?new ce(f[0],f[1],f[2]):f.length===2?new ce(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new ce(f.lat,"lng"in f?f.lng:f.lon,f.alt):y===void 0?null:new ce(f,y,C)}var ie={latLngToPoint:function(f,y){var C=this.projection.project(f),A=this.scale(y);return this.transformation._transform(C,A)},pointToLatLng:function(f,y){var C=this.scale(y),A=this.transformation.untransform(f,C);return this.projection.unproject(A)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var y=this.projection.bounds,C=this.scale(f),A=this.transformation.transform(y.min,C),B=this.transformation.transform(y.max,C);return new H(A,B)},infinite:!1,wrapLatLng:function(f){var y=this.wrapLng?h(f.lng,this.wrapLng,!0):f.lng,C=this.wrapLat?h(f.lat,this.wrapLat,!0):f.lat,A=f.alt;return new ce(C,y,A)},wrapLatLngBounds:function(f){var y=f.getCenter(),C=this.wrapLatLng(y),A=y.lat-C.lat,B=y.lng-C.lng;if(A===0&&B===0)return f;var K=f.getSouthWest(),he=f.getNorthEast(),Se=new ce(K.lat-A,K.lng-B),Ee=new ce(he.lat-A,he.lng-B);return new re(Se,Ee)}},xe=s({},ie,{wrapLng:[-180,180],R:6371e3,distance:function(f,y){var C=Math.PI/180,A=f.lat*C,B=y.lat*C,K=Math.sin((y.lat-f.lat)*C/2),he=Math.sin((y.lng-f.lng)*C/2),Se=K*K+Math.cos(A)*Math.cos(B)*he*he,Ee=2*Math.atan2(Math.sqrt(Se),Math.sqrt(1-Se));return this.R*Ee}}),Ce=6378137,ve={R:Ce,MAX_LATITUDE:85.0511287798,project:function(f){var y=Math.PI/180,C=this.MAX_LATITUDE,A=Math.max(Math.min(C,f.lat),-C),B=Math.sin(A*y);return new X(this.R*f.lng*y,this.R*Math.log((1+B)/(1-B))/2)},unproject:function(f){var y=180/Math.PI;return new ce((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*y,f.x*y/this.R)},bounds:(function(){var f=Ce*Math.PI;return new H([-f,-f],[f,f])})()};function Oe(f,y,C,A){if(D(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=y,this._c=C,this._d=A}Oe.prototype={transform:function(f,y){return this._transform(f.clone(),y)},_transform:function(f,y){return y=y||1,f.x=y*(this._a*f.x+this._b),f.y=y*(this._c*f.y+this._d),f},untransform:function(f,y){return y=y||1,new X((f.x/y-this._b)/this._a,(f.y/y-this._d)/this._c)}};function Pe(f,y,C,A){return new Oe(f,y,C,A)}var Ie=s({},xe,{code:"EPSG:3857",projection:ve,transformation:(function(){var f=.5/(Math.PI*ve.R);return Pe(f,.5,-f,.5)})()}),Fe=s({},Ie,{code:"EPSG:900913"});function we(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function Ne(f,y){var C="",A,B,K,he,Se,Ee;for(A=0,K=f.length;A<K;A++){for(Se=f[A],B=0,he=Se.length;B<he;B++)Ee=Se[B],C+=(B?"L":"M")+Ee.x+" "+Ee.y;C+=y?dt.svg?"z":"x":""}return C||"M0 0"}var Ue=document.documentElement.style,Be="ActiveXObject"in window,qe=Be&&!document.addEventListener,te="msLaunchUri"in navigator&&!("documentMode"in document),le=dr("webkit"),ye=dr("android"),Ve=dr("android 2")||dr("android 3"),ze=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Le=ye&&dr("Google")&&ze<537&&!("AudioNode"in window),rt=!!window.opera,Xe=!te&&dr("chrome"),tt=dr("gecko")&&!le&&!rt&&!Be,qt=!Xe&&dr("safari"),bt=dr("phantom"),Et="OTransition"in Ue,Xt=navigator.platform.indexOf("Win")===0,en=Be&&"transition"in Ue,Yt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ve,Ut="MozPerspective"in Ue,Rn=!window.L_DISABLE_3D&&(en||Yt||Ut)&&!Et&&!bt,Nn=typeof orientation<"u"||dr("mobile"),an=Nn&&le,rr=Nn&&Yt,Hn=!window.PointerEvent&&window.MSPointerEvent,lt=!!(window.PointerEvent||Hn),Vn="ontouchstart"in window||!!window.TouchEvent,br=!window.L_NO_TOUCH&&(Vn||lt),vn=Nn&&rt,us=Nn&&tt,Ks=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Gr=(function(){var f=!1;try{var y=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",p,y),window.removeEventListener("testPassiveEventSupport",p,y)}catch{}return f})(),Xi=(function(){return!!document.createElement("canvas").getContext})(),La=!!(document.createElementNS&&we("svg").createSVGRect),ea=!!La&&(function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Po=!La&&(function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var y=f.firstChild;return y.style.behavior="url(#default#VML)",y&&typeof y.adj=="object"}catch{return!1}})(),ta=navigator.platform.indexOf("Mac")===0,cd=navigator.platform.indexOf("Linux")===0;function dr(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var dt={ie:Be,ielt9:qe,edge:te,webkit:le,android:ye,android23:Ve,androidStock:Le,opera:rt,chrome:Xe,gecko:tt,safari:qt,phantom:bt,opera12:Et,win:Xt,ie3d:en,webkit3d:Yt,gecko3d:Ut,any3d:Rn,mobile:Nn,mobileWebkit:an,mobileWebkit3d:rr,msPointer:Hn,pointer:lt,touch:br,touchNative:Vn,mobileOpera:vn,mobileGecko:us,retina:Ks,passiveEvents:Gr,canvas:Xi,svg:La,vml:Po,inlineSvg:ea,mac:ta,linux:cd},na=dt.msPointer?"MSPointerDown":"pointerdown",Fa=dt.msPointer?"MSPointerMove":"pointermove",Ol=dt.msPointer?"MSPointerUp":"pointerup",Il=dt.msPointer?"MSPointerCancel":"pointercancel",Mo={touchstart:na,touchmove:Fa,touchend:Ol,touchcancel:Il},ks={touchstart:Cn,touchmove:qa,touchend:qa,touchcancel:qa},Js={},Eo=!1;function dd(f,y,C){return y==="touchstart"&&ud(),ks[y]?(C=ks[y].bind(this,C),f.addEventListener(Mo[y],C,!1),C):(console.warn("wrong event specified:",y),p)}function Al(f,y,C){if(!Mo[y]){console.warn("wrong event specified:",y);return}f.removeEventListener(Mo[y],C,!1)}function Rl(f){Js[f.pointerId]=f}function Ll(f){Js[f.pointerId]&&(Js[f.pointerId]=f)}function Do(f){delete Js[f.pointerId]}function ud(){Eo||(document.addEventListener(na,Rl,!0),document.addEventListener(Fa,Ll,!0),document.addEventListener(Ol,Do,!0),document.addEventListener(Il,Do,!0),Eo=!0)}function qa(f,y){if(y.pointerType!==(y.MSPOINTER_TYPE_MOUSE||"mouse")){y.touches=[];for(var C in Js)y.touches.push(Js[C]);y.changedTouches=[y],f(y)}}function Cn(f,y){y.MSPOINTER_TYPE_TOUCH&&y.pointerType===y.MSPOINTER_TYPE_TOUCH&&Tn(y),qa(f,y)}function fd(f){var y={},C,A;for(A in f)C=f[A],y[A]=C&&C.bind?C.bind(f):C;return f=y,y.type="dblclick",y.detail=2,y.isTrusted=!1,y._simulated=!0,y}var Oo=200;function Fl(f,y){f.addEventListener("dblclick",y);var C=0,A;function B(K){if(K.detail!==1){A=K.detail;return}if(!(K.pointerType==="mouse"||K.sourceCapabilities&&!K.sourceCapabilities.firesTouchEvents)){var he=ei(K);if(!(he.some(function(Ee){return Ee instanceof HTMLLabelElement&&Ee.attributes.for})&&!he.some(function(Ee){return Ee instanceof HTMLInputElement||Ee instanceof HTMLSelectElement}))){var Se=Date.now();Se-C<=Oo?(A++,A===2&&y(fd(K))):A=1,C=Se}}}return f.addEventListener("click",B),{dblclick:y,simDblclick:B}}function za(f,y){f.removeEventListener("dblclick",y.dblclick),f.removeEventListener("click",y.simDblclick)}var Io=ji(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),bi=ji(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ra=bi==="webkitTransition"||bi==="OTransition"?bi+"End":"transitionend";function Rr(f){return typeof f=="string"?document.getElementById(f):f}function sa(f,y){var C=f.style[y]||f.currentStyle&&f.currentStyle[y];if((!C||C==="auto")&&document.defaultView){var A=document.defaultView.getComputedStyle(f,null);C=A?A[y]:null}return C==="auto"?null:C}function Dt(f,y,C){var A=document.createElement(f);return A.className=y||"",C&&C.appendChild(A),A}function bn(f){var y=f.parentNode;y&&y.removeChild(f)}function Ua(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function wi(f){var y=f.parentNode;y&&y.lastChild!==f&&y.appendChild(f)}function fs(f){var y=f.parentNode;y&&y.firstChild!==f&&y.insertBefore(f,y.firstChild)}function _i(f,y){if(f.classList!==void 0)return f.classList.contains(y);var C=Va(f);return C.length>0&&new RegExp("(^|\\s)"+y+"(\\s|$)").test(C)}function Mt(f,y){if(f.classList!==void 0)for(var C=w(y),A=0,B=C.length;A<B;A++)f.classList.add(C[A]);else if(!_i(f,y)){var K=Va(f);Ao(f,(K?K+" ":"")+y)}}function gn(f,y){f.classList!==void 0?f.classList.remove(y):Ao(f,v((" "+Va(f)+" ").replace(" "+y+" "," ")))}function Ao(f,y){f.className.baseVal===void 0?f.className=y:f.className.baseVal=y}function Va(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function ur(f,y){"opacity"in f.style?f.style.opacity=y:"filter"in f.style&&ql(f,y)}function ql(f,y){var C=!1,A="DXImageTransform.Microsoft.Alpha";try{C=f.filters.item(A)}catch{if(y===1)return}y=Math.round(y*100),C?(C.Enabled=y!==100,C.Opacity=y):f.style.filter+=" progid:"+A+"(opacity="+y+")"}function ji(f){for(var y=document.documentElement.style,C=0;C<f.length;C++)if(f[C]in y)return f[C];return!1}function Lr(f,y,C){var A=y||new X(0,0);f.style[Io]=(dt.ie3d?"translate("+A.x+"px,"+A.y+"px)":"translate3d("+A.x+"px,"+A.y+"px,0)")+(C?" scale("+C+")":"")}function Dn(f,y){f._leaflet_pos=y,dt.any3d?Lr(f,y):(f.style.left=y.x+"px",f.style.top=y.y+"px")}function hs(f){return f._leaflet_pos||new X(0,0)}var Kt,Ni,Ba;if("onselectstart"in document)Kt=function(){Ct(window,"selectstart",Tn)},Ni=function(){ln(window,"selectstart",Tn)};else{var Qs=ji(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Kt=function(){if(Qs){var f=document.documentElement.style;Ba=f[Qs],f[Qs]="none"}},Ni=function(){Qs&&(document.documentElement.style[Qs]=Ba,Ba=void 0)}}function Wa(){Ct(window,"dragstart",Tn)}function $a(){ln(window,"dragstart",Tn)}var ia,aa;function Si(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(Fr(),ia=f,aa=f.style.outlineStyle,f.style.outlineStyle="none",Ct(window,"keydown",Fr))}function Fr(){ia&&(ia.style.outlineStyle=aa,ia=void 0,aa=void 0,ln(window,"keydown",Fr))}function ms(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function Zr(f){var y=f.getBoundingClientRect();return{x:y.width/f.offsetWidth||1,y:y.height/f.offsetHeight||1,boundingClientRect:y}}var oa={__proto__:null,TRANSFORM:Io,TRANSITION:bi,TRANSITION_END:ra,get:Rr,getStyle:sa,create:Dt,remove:bn,empty:Ua,toFront:wi,toBack:fs,hasClass:_i,addClass:Mt,removeClass:gn,setClass:Ao,getClass:Va,setOpacity:ur,testProp:ji,setTransform:Lr,setPosition:Dn,getPosition:hs,get disableTextSelection(){return Kt},get enableTextSelection(){return Ni},disableImageDrag:Wa,enableImageDrag:$a,preventOutline:Si,restoreOutline:Fr,getSizedParentNode:ms,getScale:Zr};function Ct(f,y,C,A){if(y&&typeof y=="object")for(var B in y)Lo(f,B,y[B],C);else{y=w(y);for(var K=0,he=y.length;K<he;K++)Lo(f,y[K],C,A)}return this}var Yn="_leaflet_events";function ln(f,y,C,A){if(arguments.length===1)Ro(f),delete f[Yn];else if(y&&typeof y=="object")for(var B in y)Ha(f,B,y[B],C);else if(y=w(y),arguments.length===2)Ro(f,function(Se){return M(y,Se)!==-1});else for(var K=0,he=y.length;K<he;K++)Ha(f,y[K],C,A);return this}function Ro(f,y){for(var C in f[Yn]){var A=C.split(/\d/)[0];(!y||y(A))&&Ha(f,A,null,null,C)}}var Xs={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Lo(f,y,C,A){var B=y+c(C)+(A?"_"+c(A):"");if(f[Yn]&&f[Yn][B])return this;var K=function(Se){return C.call(A||f,Se||window.event)},he=K;!dt.touchNative&&dt.pointer&&y.indexOf("touch")===0?K=dd(f,y,K):dt.touch&&y==="dblclick"?K=Fl(f,K):"addEventListener"in f?y==="touchstart"||y==="touchmove"||y==="wheel"||y==="mousewheel"?f.addEventListener(Xs[y]||y,K,dt.passiveEvents?{passive:!1}:!1):y==="mouseenter"||y==="mouseleave"?(K=function(Se){Se=Se||window.event,da(f,Se)&&he(Se)},f.addEventListener(Xs[y],K,!1)):f.addEventListener(y,he,!1):f.attachEvent("on"+y,K),f[Yn]=f[Yn]||{},f[Yn][B]=K}function Ha(f,y,C,A,B){B=B||y+c(C)+(A?"_"+c(A):"");var K=f[Yn]&&f[Yn][B];if(!K)return this;!dt.touchNative&&dt.pointer&&y.indexOf("touch")===0?Al(f,y,K):dt.touch&&y==="dblclick"?za(f,K):"removeEventListener"in f?f.removeEventListener(Xs[y]||y,K,!1):f.detachEvent("on"+y,K),f[Yn][B]=null}function Kr(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function Ya(f){return Lo(f,"wheel",Kr),this}function la(f){return Ct(f,"mousedown touchstart dblclick contextmenu",Kr),f._leaflet_disable_click=!0,this}function Tn(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function qr(f){return Tn(f),Kr(f),this}function ei(f){if(f.composedPath)return f.composedPath();for(var y=[],C=f.target;C;)y.push(C),C=C.parentNode;return y}function ca(f,y){if(!y)return new X(f.clientX,f.clientY);var C=Zr(y),A=C.boundingClientRect;return new X((f.clientX-A.left)/C.x-y.clientLeft,(f.clientY-A.top)/C.y-y.clientTop)}var hd=dt.linux&&dt.chrome?window.devicePixelRatio:dt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function zl(f){return dt.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/hd:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function da(f,y){var C=y.relatedTarget;if(!C)return!0;try{for(;C&&C!==f;)C=C.parentNode}catch{return!1}return C!==f}var Ga={__proto__:null,on:Ct,off:ln,stopPropagation:Kr,disableScrollPropagation:Ya,disableClickPropagation:la,preventDefault:Tn,stop:qr,getPropagationPath:ei,getMousePosition:ca,getWheelDelta:zl,isExternalTarget:da,addListener:Ct,removeListener:ln},Za=ee.extend({run:function(f,y,C,A){this.stop(),this._el=f,this._inProgress=!0,this._duration=C||.25,this._easeOutPower=1/Math.max(A||.5,.2),this._startPos=hs(f),this._offset=y.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=W(this._animate,this),this._step()},_step:function(f){var y=+new Date-this._startTime,C=this._duration*1e3;y<C?this._runFrame(this._easeOut(y/C),f):(this._runFrame(1),this._complete())},_runFrame:function(f,y){var C=this._startPos.add(this._offset.multiplyBy(f));y&&C._round(),Dn(this._el,C),this.fire("step")},_complete:function(){$(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),Ht=ee.extend({options:{crs:Ie,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,y){y=_(this,y),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),y.maxBounds&&this.setMaxBounds(y.maxBounds),y.zoom!==void 0&&(this._zoom=this._limitZoom(y.zoom)),y.center&&y.zoom!==void 0&&this.setView(pe(y.center),y.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=bi&&dt.any3d&&!dt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ct(this._proxy,ra,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,y,C){if(y=y===void 0?this._zoom:this._limitZoom(y),f=this._limitCenter(pe(f),y,this.options.maxBounds),C=C||{},this._stop(),this._loaded&&!C.reset&&C!==!0){C.animate!==void 0&&(C.zoom=s({animate:C.animate},C.zoom),C.pan=s({animate:C.animate,duration:C.duration},C.pan));var A=this._zoom!==y?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,y,C.zoom):this._tryAnimatedPan(f,C.pan);if(A)return clearTimeout(this._sizeTimer),this}return this._resetView(f,y,C.pan&&C.pan.noMoveStart),this},setZoom:function(f,y){return this._loaded?this.setView(this.getCenter(),f,{zoom:y}):(this._zoom=f,this)},zoomIn:function(f,y){return f=f||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,y)},zoomOut:function(f,y){return f=f||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,y)},setZoomAround:function(f,y,C){var A=this.getZoomScale(y),B=this.getSize().divideBy(2),K=f instanceof X?f:this.latLngToContainerPoint(f),he=K.subtract(B).multiplyBy(1-1/A),Se=this.containerPointToLatLng(B.add(he));return this.setView(Se,y,{zoom:C})},_getBoundsCenterZoom:function(f,y){y=y||{},f=f.getBounds?f.getBounds():de(f);var C=oe(y.paddingTopLeft||y.padding||[0,0]),A=oe(y.paddingBottomRight||y.padding||[0,0]),B=this.getBoundsZoom(f,!1,C.add(A));if(B=typeof y.maxZoom=="number"?Math.min(y.maxZoom,B):B,B===1/0)return{center:f.getCenter(),zoom:B};var K=A.subtract(C).divideBy(2),he=this.project(f.getSouthWest(),B),Se=this.project(f.getNorthEast(),B),Ee=this.unproject(he.add(Se).divideBy(2).add(K),B);return{center:Ee,zoom:B}},fitBounds:function(f,y){if(f=de(f),!f.isValid())throw new Error("Bounds are not valid.");var C=this._getBoundsCenterZoom(f,y);return this.setView(C.center,C.zoom,y)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,y){return this.setView(f,this._zoom,{pan:y})},panBy:function(f,y){if(f=oe(f).round(),y=y||{},!f.x&&!f.y)return this.fire("moveend");if(y.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Za,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),y.noMoveStart||this.fire("movestart"),y.animate!==!1){Mt(this._mapPane,"leaflet-pan-anim");var C=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,C,y.duration||.25,y.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,y,C){if(C=C||{},C.animate===!1||!dt.any3d)return this.setView(f,y,C);this._stop();var A=this.project(this.getCenter()),B=this.project(f),K=this.getSize(),he=this._zoom;f=pe(f),y=y===void 0?he:y;var Se=Math.max(K.x,K.y),Ee=Se*this.getZoomScale(he,y),We=B.distanceTo(A)||1,st=1.42,Nt=st*st;function $t(xn){var cc=xn?-1:1,qy=xn?Ee:Se,zy=Ee*Ee-Se*Se+cc*Nt*Nt*We*We,el=2*qy*Nt*We,tl=zy/el,nl=Math.sqrt(tl*tl+1)-tl,Tu=nl<1e-9?-18:Math.log(nl);return Tu}function jr(xn){return(Math.exp(xn)-Math.exp(-xn))/2}function hr(xn){return(Math.exp(xn)+Math.exp(-xn))/2}function ys(xn){return jr(xn)/hr(xn)}var Qr=$t(0);function oc(xn){return Se*(hr(Qr)/hr(Qr+st*xn))}function eh(xn){return Se*(hr(Qr)*ys(Qr+st*xn)-jr(Qr))/Nt}function lo(xn){return 1-Math.pow(1-xn,1.5)}var $m=Date.now(),Xo=($t(1)-Qr)/st,Oi=C.duration?1e3*C.duration:1e3*Xo*.8;function lc(){var xn=(Date.now()-$m)/Oi,cc=lo(xn)*Xo;xn<=1?(this._flyToFrame=W(lc,this),this._move(this.unproject(A.add(B.subtract(A).multiplyBy(eh(cc)/We)),he),this.getScaleZoom(Se/oc(cc),he),{flyTo:!0})):this._move(f,y)._moveEnd(!0)}return this._moveStart(!0,C.noMoveStart),lc.call(this),this},flyToBounds:function(f,y){var C=this._getBoundsCenterZoom(f,y);return this.flyTo(C.center,C.zoom,y)},setMaxBounds:function(f){return f=de(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var y=this.options.minZoom;return this.options.minZoom=f,this._loaded&&y!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var y=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&y!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,y){this._enforcingBounds=!0;var C=this.getCenter(),A=this._limitCenter(C,this._zoom,de(f));return C.equals(A)||this.panTo(A,y),this._enforcingBounds=!1,this},panInside:function(f,y){y=y||{};var C=oe(y.paddingTopLeft||y.padding||[0,0]),A=oe(y.paddingBottomRight||y.padding||[0,0]),B=this.project(this.getCenter()),K=this.project(f),he=this.getPixelBounds(),Se=Q([he.min.add(C),he.max.subtract(A)]),Ee=Se.getSize();if(!Se.contains(K)){this._enforcingBounds=!0;var We=K.subtract(Se.getCenter()),st=Se.extend(K).getSize().subtract(Ee);B.x+=We.x<0?-st.x:st.x,B.y+=We.y<0?-st.y:st.y,this.panTo(this.unproject(B),y),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=s({animate:!1,pan:!0},f===!0?{animate:!0}:f);var y=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var C=this.getSize(),A=y.divideBy(2).round(),B=C.divideBy(2).round(),K=A.subtract(B);return!K.x&&!K.y?this:(f.animate&&f.pan?this.panBy(K):(f.pan&&this._rawPanBy(K),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:y,newSize:C}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=s({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var y=o(this._handleGeolocationResponse,this),C=o(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(y,C,f):navigator.geolocation.getCurrentPosition(y,C,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var y=f.code,C=f.message||(y===1?"permission denied":y===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:y,message:"Geolocation error: "+C+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var y=f.coords.latitude,C=f.coords.longitude,A=new ce(y,C),B=A.toBounds(f.coords.accuracy*2),K=this._locateOptions;if(K.setView){var he=this.getBoundsZoom(B);this.setView(A,K.maxZoom?Math.min(he,K.maxZoom):he)}var Se={latlng:A,bounds:B,timestamp:f.timestamp};for(var Ee in f.coords)typeof f.coords[Ee]=="number"&&(Se[Ee]=f.coords[Ee]);this.fire("locationfound",Se)}},addHandler:function(f,y){if(!y)return this;var C=this[f]=new y(this);return this._handlers.push(C),this.options[f]&&C.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),bn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&($(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)bn(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,y){var C="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),A=Dt("div",C,y||this._mapPane);return f&&(this._panes[f]=A),A},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),y=this.unproject(f.getBottomLeft()),C=this.unproject(f.getTopRight());return new re(y,C)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,y,C){f=de(f),C=oe(C||[0,0]);var A=this.getZoom()||0,B=this.getMinZoom(),K=this.getMaxZoom(),he=f.getNorthWest(),Se=f.getSouthEast(),Ee=this.getSize().subtract(C),We=Q(this.project(Se,A),this.project(he,A)).getSize(),st=dt.any3d?this.options.zoomSnap:1,Nt=Ee.x/We.x,$t=Ee.y/We.y,jr=y?Math.max(Nt,$t):Math.min(Nt,$t);return A=this.getScaleZoom(jr,A),st&&(A=Math.round(A/(st/100))*(st/100),A=y?Math.ceil(A/st)*st:Math.floor(A/st)*st),Math.max(B,Math.min(K,A))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new X(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,y){var C=this._getTopLeftPoint(f,y);return new H(C,C.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,y){var C=this.options.crs;return y=y===void 0?this._zoom:y,C.scale(f)/C.scale(y)},getScaleZoom:function(f,y){var C=this.options.crs;y=y===void 0?this._zoom:y;var A=C.zoom(f*C.scale(y));return isNaN(A)?1/0:A},project:function(f,y){return y=y===void 0?this._zoom:y,this.options.crs.latLngToPoint(pe(f),y)},unproject:function(f,y){return y=y===void 0?this._zoom:y,this.options.crs.pointToLatLng(oe(f),y)},layerPointToLatLng:function(f){var y=oe(f).add(this.getPixelOrigin());return this.unproject(y)},latLngToLayerPoint:function(f){var y=this.project(pe(f))._round();return y._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(pe(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(de(f))},distance:function(f,y){return this.options.crs.distance(pe(f),pe(y))},containerPointToLayerPoint:function(f){return oe(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return oe(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var y=this.containerPointToLayerPoint(oe(f));return this.layerPointToLatLng(y)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(pe(f)))},mouseEventToContainerPoint:function(f){return ca(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var y=this._container=Rr(f);if(y){if(y._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ct(y,"scroll",this._onScroll,this),this._containerId=c(y)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&dt.any3d,Mt(f,"leaflet-container"+(dt.touch?" leaflet-touch":"")+(dt.retina?" leaflet-retina":"")+(dt.ielt9?" leaflet-oldie":"")+(dt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var y=sa(f,"position");y!=="absolute"&&y!=="relative"&&y!=="fixed"&&y!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Dn(this._mapPane,new X(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Mt(f.markerPane,"leaflet-zoom-hide"),Mt(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,y,C){Dn(this._mapPane,new X(0,0));var A=!this._loaded;this._loaded=!0,y=this._limitZoom(y),this.fire("viewprereset");var B=this._zoom!==y;this._moveStart(B,C)._move(f,y)._moveEnd(B),this.fire("viewreset"),A&&this.fire("load")},_moveStart:function(f,y){return f&&this.fire("zoomstart"),y||this.fire("movestart"),this},_move:function(f,y,C,A){y===void 0&&(y=this._zoom);var B=this._zoom!==y;return this._zoom=y,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),A?C&&C.pinch&&this.fire("zoom",C):((B||C&&C.pinch)&&this.fire("zoom",C),this.fire("move",C)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return $(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){Dn(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[c(this._container)]=this;var y=f?ln:Ct;y(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&y(window,"resize",this._onResize,this),dt.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){$(this._resizeRequest),this._resizeRequest=W(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,y){for(var C=[],A,B=y==="mouseout"||y==="mouseover",K=f.target||f.srcElement,he=!1;K;){if(A=this._targets[c(K)],A&&(y==="click"||y==="preclick")&&this._draggableMoved(A)){he=!0;break}if(A&&A.listens(y,!0)&&(B&&!da(K,f)||(C.push(A),B))||K===this._container)break;K=K.parentNode}return!C.length&&!he&&!B&&this.listens(y,!0)&&(C=[this]),C},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var y=f.target||f.srcElement;if(!(!this._loaded||y._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(y))){var C=f.type;C==="mousedown"&&Si(y),this._fireDOMEvent(f,C)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,y,C){if(f.type==="click"){var A=s({},f);A.type="preclick",this._fireDOMEvent(A,A.type,C)}var B=this._findEventTargets(f,y);if(C){for(var K=[],he=0;he<C.length;he++)C[he].listens(y,!0)&&K.push(C[he]);B=K.concat(B)}if(B.length){y==="contextmenu"&&Tn(f);var Se=B[0],Ee={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var We=Se.getLatLng&&(!Se._radius||Se._radius<=10);Ee.containerPoint=We?this.latLngToContainerPoint(Se.getLatLng()):this.mouseEventToContainerPoint(f),Ee.layerPoint=this.containerPointToLayerPoint(Ee.containerPoint),Ee.latlng=We?Se.getLatLng():this.layerPointToLatLng(Ee.layerPoint)}for(he=0;he<B.length;he++)if(B[he].fire(y,Ee,!0),Ee.originalEvent._stopped||B[he].options.bubblingMouseEvents===!1&&M(this._mouseEvents,y)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,y=this._handlers.length;f<y;f++)this._handlers[f].disable()},whenReady:function(f,y){return this._loaded?f.call(y||this,{target:this}):this.on("load",f,y),this},_getMapPanePos:function(){return hs(this._mapPane)||new X(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,y){var C=f&&y!==void 0?this._getNewPixelOrigin(f,y):this.getPixelOrigin();return C.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,y){var C=this.getSize()._divideBy(2);return this.project(f,y)._subtract(C)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,y,C){var A=this._getNewPixelOrigin(C,y);return this.project(f,y)._subtract(A)},_latLngBoundsToNewLayerBounds:function(f,y,C){var A=this._getNewPixelOrigin(C,y);return Q([this.project(f.getSouthWest(),y)._subtract(A),this.project(f.getNorthWest(),y)._subtract(A),this.project(f.getSouthEast(),y)._subtract(A),this.project(f.getNorthEast(),y)._subtract(A)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,y,C){if(!C)return f;var A=this.project(f,y),B=this.getSize().divideBy(2),K=new H(A.subtract(B),A.add(B)),he=this._getBoundsOffset(K,C,y);return Math.abs(he.x)<=1&&Math.abs(he.y)<=1?f:this.unproject(A.add(he),y)},_limitOffset:function(f,y){if(!y)return f;var C=this.getPixelBounds(),A=new H(C.min.add(f),C.max.add(f));return f.add(this._getBoundsOffset(A,y))},_getBoundsOffset:function(f,y,C){var A=Q(this.project(y.getNorthEast(),C),this.project(y.getSouthWest(),C)),B=A.min.subtract(f.min),K=A.max.subtract(f.max),he=this._rebound(B.x,-K.x),Se=this._rebound(B.y,-K.y);return new X(he,Se)},_rebound:function(f,y){return f+y>0?Math.round(f-y)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(y))},_limitZoom:function(f){var y=this.getMinZoom(),C=this.getMaxZoom(),A=dt.any3d?this.options.zoomSnap:1;return A&&(f=Math.round(f/A)*A),Math.max(y,Math.min(C,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){gn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,y){var C=this._getCenterOffset(f)._trunc();return(y&&y.animate)!==!0&&!this.getSize().contains(C)?!1:(this.panBy(C,y),!0)},_createAnimProxy:function(){var f=this._proxy=Dt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(y){var C=Io,A=this._proxy.style[C];Lr(this._proxy,this.project(y.center,y.zoom),this.getZoomScale(y.zoom,1)),A===this._proxy.style[C]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){bn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),y=this.getZoom();Lr(this._proxy,this.project(f,y),this.getZoomScale(y,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,y,C){if(this._animatingZoom)return!0;if(C=C||{},!this._zoomAnimated||C.animate===!1||this._nothingToAnimate()||Math.abs(y-this._zoom)>this.options.zoomAnimationThreshold)return!1;var A=this.getZoomScale(y),B=this._getCenterOffset(f)._divideBy(1-1/A);return C.animate!==!0&&!this.getSize().contains(B)?!1:(W(function(){this._moveStart(!0,C.noMoveStart||!1)._animateZoom(f,y,!0)},this),!0)},_animateZoom:function(f,y,C,A){this._mapPane&&(C&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=y,Mt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:y,noUpdate:A}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&gn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ps(f,y){return new Ht(f,y)}var wr=Y.extend({options:{position:"topright"},initialize:function(f){_(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var y=this._map;return y&&y.removeControl(this),this.options.position=f,y&&y.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var y=this._container=this.onAdd(f),C=this.getPosition(),A=f._controlCorners[C];return Mt(y,"leaflet-control"),C.indexOf("bottom")!==-1?A.insertBefore(y,A.firstChild):A.appendChild(y),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(bn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),Ms=function(f){return new wr(f)};Ht.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},y="leaflet-",C=this._controlContainer=Dt("div",y+"control-container",this._container);function A(B,K){var he=y+B+" "+y+K;f[B+K]=Dt("div",he,C)}A("top","left"),A("top","right"),A("bottom","left"),A("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)bn(this._controlCorners[f]);bn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Fo=wr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,y,C,A){return C<A?-1:A<C?1:0}},initialize:function(f,y,C){_(this,C),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var A in f)this._addLayer(f[A],A);for(A in y)this._addLayer(y[A],A,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var y=0;y<this._layers.length;y++)this._layers[y].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return wr.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,y){return this._addLayer(f,y),this._map?this._update():this},addOverlay:function(f,y){return this._addLayer(f,y,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var y=this._getLayer(c(f));return y&&this._layers.splice(this._layers.indexOf(y),1),this._map?this._update():this},expand:function(){Mt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(Mt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):gn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return gn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",y=this._container=Dt("div",f),C=this.options.collapsed;y.setAttribute("aria-haspopup",!0),la(y),Ya(y);var A=this._section=Dt("section",f+"-list");C&&(this._map.on("click",this.collapse,this),Ct(y,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var B=this._layersLink=Dt("a",f+"-toggle",y);B.href="#",B.title="Layers",B.setAttribute("role","button"),Ct(B,{keydown:function(K){K.keyCode===13&&this._expandSafely()},click:function(K){Tn(K),this._expandSafely()}},this),C||this.expand(),this._baseLayersList=Dt("div",f+"-base",A),this._separator=Dt("div",f+"-separator",A),this._overlaysList=Dt("div",f+"-overlays",A),y.appendChild(A)},_getLayer:function(f){for(var y=0;y<this._layers.length;y++)if(this._layers[y]&&c(this._layers[y].layer)===f)return this._layers[y]},_addLayer:function(f,y,C){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:y,overlay:C}),this.options.sortLayers&&this._layers.sort(o(function(A,B){return this.options.sortFunction(A.layer,B.layer,A.name,B.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ua(this._baseLayersList),Ua(this._overlaysList),this._layerControlInputs=[];var f,y,C,A,B=0;for(C=0;C<this._layers.length;C++)A=this._layers[C],this._addItem(A),y=y||A.overlay,f=f||!A.overlay,B+=A.overlay?0:1;return this.options.hideSingleBase&&(f=f&&B>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=y&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var y=this._getLayer(c(f.target)),C=y.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;C&&this._map.fire(C,y)},_createRadioElement:function(f,y){var C='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(y?' checked="checked"':"")+"/>",A=document.createElement("div");return A.innerHTML=C,A.firstChild},_addItem:function(f){var y=document.createElement("label"),C=this._map.hasLayer(f.layer),A;f.overlay?(A=document.createElement("input"),A.type="checkbox",A.className="leaflet-control-layers-selector",A.defaultChecked=C):A=this._createRadioElement("leaflet-base-layers_"+c(this),C),this._layerControlInputs.push(A),A.layerId=c(f.layer),Ct(A,"click",this._onInputClick,this);var B=document.createElement("span");B.innerHTML=" "+f.name;var K=document.createElement("span");y.appendChild(K),K.appendChild(A),K.appendChild(B);var he=f.overlay?this._overlaysList:this._baseLayersList;return he.appendChild(y),this._checkDisabledLayers(),y},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,y,C,A=[],B=[];this._handlingClick=!0;for(var K=f.length-1;K>=0;K--)y=f[K],C=this._getLayer(y.layerId).layer,y.checked?A.push(C):y.checked||B.push(C);for(K=0;K<B.length;K++)this._map.hasLayer(B[K])&&this._map.removeLayer(B[K]);for(K=0;K<A.length;K++)this._map.hasLayer(A[K])||this._map.addLayer(A[K]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,y,C,A=this._map.getZoom(),B=f.length-1;B>=0;B--)y=f[B],C=this._getLayer(y.layerId).layer,y.disabled=C.options.minZoom!==void 0&&A<C.options.minZoom||C.options.maxZoom!==void 0&&A>C.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,Ct(f,"click",Tn),this.expand();var y=this;setTimeout(function(){ln(f,"click",Tn),y._preventClick=!1})}}),Ka=function(f,y,C){return new Fo(f,y,C)},Ci=wr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var y="leaflet-control-zoom",C=Dt("div",y+" leaflet-bar"),A=this.options;return this._zoomInButton=this._createButton(A.zoomInText,A.zoomInTitle,y+"-in",C,this._zoomIn),this._zoomOutButton=this._createButton(A.zoomOutText,A.zoomOutTitle,y+"-out",C,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),C},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,y,C,A,B){var K=Dt("a",C,A);return K.innerHTML=f,K.href="#",K.title=y,K.setAttribute("role","button"),K.setAttribute("aria-label",y),la(K),Ct(K,"click",qr),Ct(K,"click",B,this),Ct(K,"click",this._refocusOnMap,this),K},_updateDisabled:function(){var f=this._map,y="leaflet-disabled";gn(this._zoomInButton,y),gn(this._zoomOutButton,y),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(Mt(this._zoomOutButton,y),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(Mt(this._zoomInButton,y),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ht.mergeOptions({zoomControl:!0}),Ht.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ci,this.addControl(this.zoomControl))});var Ul=function(f){return new Ci(f)},fr=wr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var y="leaflet-control-scale",C=Dt("div",y),A=this.options;return this._addScales(A,y+"-line",C),f.on(A.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),C},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,y,C){f.metric&&(this._mScale=Dt("div",y,C)),f.imperial&&(this._iScale=Dt("div",y,C))},_update:function(){var f=this._map,y=f.getSize().y/2,C=f.distance(f.containerPointToLatLng([0,y]),f.containerPointToLatLng([this.options.maxWidth,y]));this._updateScales(C)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var y=this._getRoundNum(f),C=y<1e3?y+" m":y/1e3+" km";this._updateScale(this._mScale,C,y/f)},_updateImperial:function(f){var y=f*3.2808399,C,A,B;y>5280?(C=y/5280,A=this._getRoundNum(C),this._updateScale(this._iScale,A+" mi",A/C)):(B=this._getRoundNum(y),this._updateScale(this._iScale,B+" ft",B/y))},_updateScale:function(f,y,C){f.style.width=Math.round(this.options.maxWidth*C)+"px",f.innerHTML=y},_getRoundNum:function(f){var y=Math.pow(10,(Math.floor(f)+"").length-1),C=f/y;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:1,y*C}}),Ti=function(f){return new fr(f)},qo='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ti=wr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(dt.inlineSvg?qo+" ":"")+"Leaflet</a>"},initialize:function(f){_(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=Dt("div","leaflet-control-attribution"),la(this._container);for(var y in f._layers)f._layers[y].getAttribution&&this.addAttribution(f._layers[y].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var y in this._attributions)this._attributions[y]&&f.push(y);var C=[];this.options.prefix&&C.push(this.options.prefix),f.length&&C.push(f.join(", ")),this._container.innerHTML=C.join(' <span aria-hidden="true">|</span> ')}}});Ht.mergeOptions({attributionControl:!0}),Ht.addInitHook(function(){this.options.attributionControl&&new ti().addTo(this)});var md=function(f){return new ti(f)};wr.Layers=Fo,wr.Zoom=Ci,wr.Scale=fr,wr.Attribution=ti,Ms.layers=Ka,Ms.zoom=Ul,Ms.scale=Ti,Ms.attribution=md;var Mr=Y.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Mr.addTo=function(f,y){return f.addHandler(y,this),this};var zo={Events:J},ki=dt.touch?"touchstart mousedown":"mousedown",zr=ee.extend({options:{clickTolerance:3},initialize:function(f,y,C,A){_(this,A),this._element=f,this._dragStartTarget=y||f,this._preventOutline=C},enable:function(){this._enabled||(Ct(this._dragStartTarget,ki,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(zr._dragging===this&&this.finishDrag(!0),ln(this._dragStartTarget,ki,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!_i(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){zr._dragging===this&&this.finishDrag();return}if(!(zr._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(zr._dragging=this,this._preventOutline&&Si(this._element),Wa(),Kt(),!this._moving)){this.fire("down");var y=f.touches?f.touches[0]:f,C=ms(this._element);this._startPoint=new X(y.clientX,y.clientY),this._startPos=hs(this._element),this._parentScale=Zr(C);var A=f.type==="mousedown";Ct(document,A?"mousemove":"touchmove",this._onMove,this),Ct(document,A?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var y=f.touches&&f.touches.length===1?f.touches[0]:f,C=new X(y.clientX,y.clientY)._subtract(this._startPoint);!C.x&&!C.y||Math.abs(C.x)+Math.abs(C.y)<this.options.clickTolerance||(C.x/=this._parentScale.x,C.y/=this._parentScale.y,Tn(f),this._moved||(this.fire("dragstart"),this._moved=!0,Mt(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Mt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(C),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),Dn(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){gn(document.body,"leaflet-dragging"),this._lastTarget&&(gn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ln(document,"mousemove touchmove",this._onMove,this),ln(document,"mouseup touchend touchcancel",this._onUp,this),$a(),Ni();var y=this._moved&&this._moving;this._moving=!1,zr._dragging=!1,y&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function Uo(f,y,C){var A,B=[1,4,2,8],K,he,Se,Ee,We,st,Nt,$t;for(K=0,st=f.length;K<st;K++)f[K]._code=ni(f[K],y);for(Se=0;Se<4;Se++){for(Nt=B[Se],A=[],K=0,st=f.length,he=st-1;K<st;he=K++)Ee=f[K],We=f[he],Ee._code&Nt?We._code&Nt||($t=Qa(We,Ee,Nt,y,C),$t._code=ni($t,y),A.push($t)):(We._code&Nt&&($t=Qa(We,Ee,Nt,y,C),$t._code=ni($t,y),A.push($t)),A.push(Ee));f=A}return f}function Vl(f,y){var C,A,B,K,he,Se,Ee,We,st;if(!f||f.length===0)throw new Error("latlngs not passed");Er(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var Nt=pe([0,0]),$t=de(f),jr=$t.getNorthWest().distanceTo($t.getSouthWest())*$t.getNorthEast().distanceTo($t.getNorthWest());jr<1700&&(Nt=Vo(f));var hr=f.length,ys=[];for(C=0;C<hr;C++){var Qr=pe(f[C]);ys.push(y.project(pe([Qr.lat-Nt.lat,Qr.lng-Nt.lng])))}for(Se=Ee=We=0,C=0,A=hr-1;C<hr;A=C++)B=ys[C],K=ys[A],he=B.y*K.x-K.y*B.x,Ee+=(B.x+K.x)*he,We+=(B.y+K.y)*he,Se+=he*3;Se===0?st=ys[0]:st=[Ee/Se,We/Se];var oc=y.unproject(oe(st));return pe([oc.lat+Nt.lat,oc.lng+Nt.lng])}function Vo(f){for(var y=0,C=0,A=0,B=0;B<f.length;B++){var K=pe(f[B]);y+=K.lat,C+=K.lng,A++}return pe([y/A,C/A])}var pd={__proto__:null,clipPolygon:Uo,polygonCenter:Vl,centroid:Vo};function Ja(f,y){if(!y||!f.length)return f.slice();var C=y*y;return f=yd(f,C),f=xd(f,C),f}function Bl(f,y,C){return Math.sqrt(ri(f,y,C,!0))}function gd(f,y,C){return ri(f,y,C)}function xd(f,y){var C=f.length,A=typeof Uint8Array<"u"?Uint8Array:Array,B=new A(C);B[0]=B[C-1]=1,Bo(f,B,y,0,C-1);var K,he=[];for(K=0;K<C;K++)B[K]&&he.push(f[K]);return he}function Bo(f,y,C,A,B){var K=0,he,Se,Ee;for(Se=A+1;Se<=B-1;Se++)Ee=ri(f[Se],f[A],f[B],!0),Ee>K&&(he=Se,K=Ee);K>C&&(y[he]=1,Bo(f,y,C,A,he),Bo(f,y,C,he,B))}function yd(f,y){for(var C=[f[0]],A=1,B=0,K=f.length;A<K;A++)vd(f[A],f[B])>y&&(C.push(f[A]),B=A);return B<K-1&&C.push(f[K-1]),C}var Wo;function Wl(f,y,C,A,B){var K=A?Wo:ni(f,C),he=ni(y,C),Se,Ee,We;for(Wo=he;;){if(!(K|he))return[f,y];if(K&he)return!1;Se=K||he,Ee=Qa(f,y,Se,C,B),We=ni(Ee,C),Se===K?(f=Ee,K=We):(y=Ee,he=We)}}function Qa(f,y,C,A,B){var K=y.x-f.x,he=y.y-f.y,Se=A.min,Ee=A.max,We,st;return C&8?(We=f.x+K*(Ee.y-f.y)/he,st=Ee.y):C&4?(We=f.x+K*(Se.y-f.y)/he,st=Se.y):C&2?(We=Ee.x,st=f.y+he*(Ee.x-f.x)/K):C&1&&(We=Se.x,st=f.y+he*(Se.x-f.x)/K),new X(We,st,B)}function ni(f,y){var C=0;return f.x<y.min.x?C|=1:f.x>y.max.x&&(C|=2),f.y<y.min.y?C|=4:f.y>y.max.y&&(C|=8),C}function vd(f,y){var C=y.x-f.x,A=y.y-f.y;return C*C+A*A}function ri(f,y,C,A){var B=y.x,K=y.y,he=C.x-B,Se=C.y-K,Ee=he*he+Se*Se,We;return Ee>0&&(We=((f.x-B)*he+(f.y-K)*Se)/Ee,We>1?(B=C.x,K=C.y):We>0&&(B+=he*We,K+=Se*We)),he=f.x-B,Se=f.y-K,A?he*he+Se*Se:new X(B,K)}function Er(f){return!D(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function $l(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Er(f)}function Hl(f,y){var C,A,B,K,he,Se,Ee,We;if(!f||f.length===0)throw new Error("latlngs not passed");Er(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var st=pe([0,0]),Nt=de(f),$t=Nt.getNorthWest().distanceTo(Nt.getSouthWest())*Nt.getNorthEast().distanceTo(Nt.getNorthWest());$t<1700&&(st=Vo(f));var jr=f.length,hr=[];for(C=0;C<jr;C++){var ys=pe(f[C]);hr.push(y.project(pe([ys.lat-st.lat,ys.lng-st.lng])))}for(C=0,A=0;C<jr-1;C++)A+=hr[C].distanceTo(hr[C+1])/2;if(A===0)We=hr[0];else for(C=0,K=0;C<jr-1;C++)if(he=hr[C],Se=hr[C+1],B=he.distanceTo(Se),K+=B,K>A){Ee=(K-A)/B,We=[Se.x-Ee*(Se.x-he.x),Se.y-Ee*(Se.y-he.y)];break}var Qr=y.unproject(oe(We));return pe([Qr.lat+st.lat,Qr.lng+st.lng])}var Yl={__proto__:null,simplify:Ja,pointToSegmentDistance:Bl,closestPointOnSegment:gd,clipSegment:Wl,_getEdgeIntersection:Qa,_getBitCode:ni,_sqClosestPointOnSegment:ri,isFlat:Er,_flat:$l,polylineCenter:Hl},$o={project:function(f){return new X(f.lng,f.lat)},unproject:function(f){return new ce(f.y,f.x)},bounds:new H([-180,-90],[180,90])},Ho={R:6378137,R_MINOR:6356752314245179e-9,bounds:new H([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var y=Math.PI/180,C=this.R,A=f.lat*y,B=this.R_MINOR/C,K=Math.sqrt(1-B*B),he=K*Math.sin(A),Se=Math.tan(Math.PI/4-A/2)/Math.pow((1-he)/(1+he),K/2);return A=-C*Math.log(Math.max(Se,1e-10)),new X(f.lng*y*C,A)},unproject:function(f){for(var y=180/Math.PI,C=this.R,A=this.R_MINOR/C,B=Math.sqrt(1-A*A),K=Math.exp(-f.y/C),he=Math.PI/2-2*Math.atan(K),Se=0,Ee=.1,We;Se<15&&Math.abs(Ee)>1e-7;Se++)We=B*Math.sin(he),We=Math.pow((1-We)/(1+We),B/2),Ee=Math.PI/2-2*Math.atan(K*We)-he,he+=Ee;return new ce(he*y,f.x*y/C)}},bd={__proto__:null,LonLat:$o,Mercator:Ho,SphericalMercator:ve},wd=s({},xe,{code:"EPSG:3395",projection:Ho,transformation:(function(){var f=.5/(Math.PI*Ho.R);return Pe(f,.5,-f,.5)})()}),Gl=s({},xe,{code:"EPSG:4326",projection:$o,transformation:Pe(1/180,1,-1/180,.5)}),_d=s({},ie,{projection:$o,transformation:Pe(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,y){var C=y.lng-f.lng,A=y.lat-f.lat;return Math.sqrt(C*C+A*A)},infinite:!0});ie.Earth=xe,ie.EPSG3395=wd,ie.EPSG3857=Ie,ie.EPSG900913=Fe,ie.EPSG4326=Gl,ie.Simple=_d;var Ur=ee.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[c(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[c(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var y=f.target;if(y.hasLayer(this)){if(this._map=y,this._zoomAnimated=y._zoomAnimated,this.getEvents){var C=this.getEvents();y.on(C,this),this.once("remove",function(){y.off(C,this)},this)}this.onAdd(y),this.fire("add"),y.fire("layeradd",{layer:this})}}});Ht.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var y=c(f);return this._layers[y]?this:(this._layers[y]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var y=c(f);return this._layers[y]?(this._loaded&&f.onRemove(this),delete this._layers[y],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return c(f)in this._layers},eachLayer:function(f,y){for(var C in this._layers)f.call(y,this._layers[C]);return this},_addLayers:function(f){f=f?D(f)?f:[f]:[];for(var y=0,C=f.length;y<C;y++)this.addLayer(f[y])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[c(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var y=c(f);this._zoomBoundLayers[y]&&(delete this._zoomBoundLayers[y],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,y=-1/0,C=this._getZoomSpan();for(var A in this._zoomBoundLayers){var B=this._zoomBoundLayers[A].options;f=B.minZoom===void 0?f:Math.min(f,B.minZoom),y=B.maxZoom===void 0?y:Math.max(y,B.maxZoom)}this._layersMaxZoom=y===-1/0?void 0:y,this._layersMinZoom=f===1/0?void 0:f,C!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Es=Ur.extend({initialize:function(f,y){_(this,y),this._layers={};var C,A;if(f)for(C=0,A=f.length;C<A;C++)this.addLayer(f[C])},addLayer:function(f){var y=this.getLayerId(f);return this._layers[y]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var y=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[y]&&this._map.removeLayer(this._layers[y]),delete this._layers[y],this},hasLayer:function(f){var y=typeof f=="number"?f:this.getLayerId(f);return y in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var y=Array.prototype.slice.call(arguments,1),C,A;for(C in this._layers)A=this._layers[C],A[f]&&A[f].apply(A,y);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,y){for(var C in this._layers)f.call(y,this._layers[C]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return c(f)}}),ua=function(f,y){return new Es(f,y)},ps=Es.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),Es.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),Es.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new re;for(var y in this._layers){var C=this._layers[y];f.extend(C.getBounds?C.getBounds():C.getLatLng())}return f}}),Zl=function(f,y){return new ps(f,y)},si=Y.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){_(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,y){var C=this._getIconUrl(f);if(!C){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var A=this._createImg(C,y&&y.tagName==="IMG"?y:null);return this._setIconStyles(A,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),A},_setIconStyles:function(f,y){var C=this.options,A=C[y+"Size"];typeof A=="number"&&(A=[A,A]);var B=oe(A),K=oe(y==="shadow"&&C.shadowAnchor||C.iconAnchor||B&&B.divideBy(2,!0));f.className="leaflet-marker-"+y+" "+(C.className||""),K&&(f.style.marginLeft=-K.x+"px",f.style.marginTop=-K.y+"px"),B&&(f.style.width=B.x+"px",f.style.height=B.y+"px")},_createImg:function(f,y){return y=y||document.createElement("img"),y.src=f,y},_getIconUrl:function(f){return dt.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function Kl(f){return new si(f)}var Pi=si.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof Pi.imagePath!="string"&&(Pi.imagePath=this._detectIconPath()),(this.options.imagePath||Pi.imagePath)+si.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var y=function(C,A,B){var K=A.exec(C);return K&&K[B]};return f=y(f,/^url\((['"])?(.+)\1\)$/,2),f&&y(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=Dt("div","leaflet-default-icon-path",document.body),y=sa(f,"background-image")||sa(f,"backgroundImage");if(document.body.removeChild(f),y=this._stripUrl(y),y)return y;var C=document.querySelector('link[href$="leaflet.css"]');return C?C.href.substring(0,C.href.length-11-1):""}}),Yo=Mr.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new zr(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Mt(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&gn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var y=this._marker,C=y._map,A=this._marker.options.autoPanSpeed,B=this._marker.options.autoPanPadding,K=hs(y._icon),he=C.getPixelBounds(),Se=C.getPixelOrigin(),Ee=Q(he.min._subtract(Se).add(B),he.max._subtract(Se).subtract(B));if(!Ee.contains(K)){var We=oe((Math.max(Ee.max.x,K.x)-Ee.max.x)/(he.max.x-Ee.max.x)-(Math.min(Ee.min.x,K.x)-Ee.min.x)/(he.min.x-Ee.min.x),(Math.max(Ee.max.y,K.y)-Ee.max.y)/(he.max.y-Ee.max.y)-(Math.min(Ee.min.y,K.y)-Ee.min.y)/(he.min.y-Ee.min.y)).multiplyBy(A);C.panBy(We,{animate:!1}),this._draggable._newPos._add(We),this._draggable._startPos._add(We),Dn(y._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=W(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&($(this._panRequest),this._panRequest=W(this._adjustPan.bind(this,f)))},_onDrag:function(f){var y=this._marker,C=y._shadow,A=hs(y._icon),B=y._map.layerPointToLatLng(A);C&&Dn(C,A),y._latlng=B,f.latlng=B,f.oldLatLng=this._oldLatLng,y.fire("move",f).fire("drag",f)},_onDragEnd:function(f){$(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),gs=Ur.extend({options:{icon:new Pi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,y){_(this,y),this._latlng=pe(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var y=this._latlng;return this._latlng=pe(f),this.update(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,y="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),C=f.icon.createIcon(this._icon),A=!1;C!==this._icon&&(this._icon&&this._removeIcon(),A=!0,f.title&&(C.title=f.title),C.tagName==="IMG"&&(C.alt=f.alt||"")),Mt(C,y),f.keyboard&&(C.tabIndex="0",C.setAttribute("role","button")),this._icon=C,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ct(C,"focus",this._panOnFocus,this);var B=f.icon.createShadow(this._shadow),K=!1;B!==this._shadow&&(this._removeShadow(),K=!0),B&&(Mt(B,y),B.alt=""),this._shadow=B,f.opacity<1&&this._updateOpacity(),A&&this.getPane().appendChild(this._icon),this._initInteraction(),B&&K&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ln(this._icon,"focus",this._panOnFocus,this),bn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&bn(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&Dn(this._icon,f),this._shadow&&Dn(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(y)},_initInteraction:function(){if(this.options.interactive&&(Mt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Yo)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Yo(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&ur(this._icon,f),this._shadow&&ur(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var y=this.options.icon.options,C=y.iconSize?oe(y.iconSize):oe(0,0),A=y.iconAnchor?oe(y.iconAnchor):oe(0,0);f.panInside(this._latlng,{paddingTopLeft:A,paddingBottomRight:C.subtract(A)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function jd(f,y){return new gs(f,y)}var Ds=Ur.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return _(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Xa=Ds.extend({options:{fill:!0,radius:10},initialize:function(f,y){_(this,y),this._latlng=pe(f),this._radius=this.options.radius},setLatLng:function(f){var y=this._latlng;return this._latlng=pe(f),this.redraw(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var y=f&&f.radius||this._radius;return Ds.prototype.setStyle.call(this,f),this.setRadius(y),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,y=this._radiusY||f,C=this._clickTolerance(),A=[f+C,y+C];this._pxBounds=new H(this._point.subtract(A),this._point.add(A))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Jl(f,y){return new Xa(f,y)}var eo=Xa.extend({initialize:function(f,y,C){if(typeof y=="number"&&(y=s({},C,{radius:y})),_(this,y),this._latlng=pe(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new re(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:Ds.prototype.setStyle,_project:function(){var f=this._latlng.lng,y=this._latlng.lat,C=this._map,A=C.options.crs;if(A.distance===xe.distance){var B=Math.PI/180,K=this._mRadius/xe.R/B,he=C.project([y+K,f]),Se=C.project([y-K,f]),Ee=he.add(Se).divideBy(2),We=C.unproject(Ee).lat,st=Math.acos((Math.cos(K*B)-Math.sin(y*B)*Math.sin(We*B))/(Math.cos(y*B)*Math.cos(We*B)))/B;(isNaN(st)||st===0)&&(st=K/Math.cos(Math.PI/180*y)),this._point=Ee.subtract(C.getPixelOrigin()),this._radius=isNaN(st)?0:Ee.x-C.project([We,f-st]).x,this._radiusY=Ee.y-he.y}else{var Nt=A.unproject(A.project(this._latlng).subtract([this._mRadius,0]));this._point=C.latLngToLayerPoint(this._latlng),this._radius=this._point.x-C.latLngToLayerPoint(Nt).x}this._updateBounds()}});function fa(f,y,C){return new eo(f,y,C)}var _r=Ds.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,y){_(this,y),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var y=1/0,C=null,A=ri,B,K,he=0,Se=this._parts.length;he<Se;he++)for(var Ee=this._parts[he],We=1,st=Ee.length;We<st;We++){B=Ee[We-1],K=Ee[We];var Nt=A(f,B,K,!0);Nt<y&&(y=Nt,C=A(f,B,K))}return C&&(C.distance=Math.sqrt(y)),C},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Hl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,y){return y=y||this._defaultShape(),f=pe(f),y.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new re,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return Er(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var y=[],C=Er(f),A=0,B=f.length;A<B;A++)C?(y[A]=pe(f[A]),this._bounds.extend(y[A])):y[A]=this._convertLatLngs(f[A]);return y},_project:function(){var f=new H;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),y=new X(f,f);this._rawPxBounds&&(this._pxBounds=new H([this._rawPxBounds.min.subtract(y),this._rawPxBounds.max.add(y)]))},_projectLatlngs:function(f,y,C){var A=f[0]instanceof ce,B=f.length,K,he;if(A){for(he=[],K=0;K<B;K++)he[K]=this._map.latLngToLayerPoint(f[K]),C.extend(he[K]);y.push(he)}else for(K=0;K<B;K++)this._projectLatlngs(f[K],y,C)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var y=this._parts,C,A,B,K,he,Se,Ee;for(C=0,B=0,K=this._rings.length;C<K;C++)for(Ee=this._rings[C],A=0,he=Ee.length;A<he-1;A++)Se=Wl(Ee[A],Ee[A+1],f,A,!0),Se&&(y[B]=y[B]||[],y[B].push(Se[0]),(Se[1]!==Ee[A+1]||A===he-2)&&(y[B].push(Se[1]),B++))}},_simplifyPoints:function(){for(var f=this._parts,y=this.options.smoothFactor,C=0,A=f.length;C<A;C++)f[C]=Ja(f[C],y)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,y){var C,A,B,K,he,Se,Ee=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(C=0,K=this._parts.length;C<K;C++)for(Se=this._parts[C],A=0,he=Se.length,B=he-1;A<he;B=A++)if(!(!y&&A===0)&&Bl(f,Se[B],Se[A])<=Ee)return!0;return!1}});function Nd(f,y){return new _r(f,y)}_r._flat=$l;var xs=_r.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Vl(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var y=_r.prototype._convertLatLngs.call(this,f),C=y.length;return C>=2&&y[0]instanceof ce&&y[0].equals(y[C-1])&&y.pop(),y},_setLatLngs:function(f){_r.prototype._setLatLngs.call(this,f),Er(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Er(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,y=this.options.weight,C=new X(y,y);if(f=new H(f.min.subtract(C),f.max.add(C)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var A=0,B=this._rings.length,K;A<B;A++)K=Uo(this._rings[A],f,!0),K.length&&this._parts.push(K)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var y=!1,C,A,B,K,he,Se,Ee,We;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(K=0,Ee=this._parts.length;K<Ee;K++)for(C=this._parts[K],he=0,We=C.length,Se=We-1;he<We;Se=he++)A=C[he],B=C[Se],A.y>f.y!=B.y>f.y&&f.x<(B.x-A.x)*(f.y-A.y)/(B.y-A.y)+A.x&&(y=!y);return y||_r.prototype._containsPoint.call(this,f,!0)}});function Sd(f,y){return new xs(f,y)}var Jr=ps.extend({initialize:function(f,y){_(this,y),this._layers={},f&&this.addData(f)},addData:function(f){var y=D(f)?f:f.features,C,A,B;if(y){for(C=0,A=y.length;C<A;C++)B=y[C],(B.geometries||B.geometry||B.features||B.coordinates)&&this.addData(B);return this}var K=this.options;if(K.filter&&!K.filter(f))return this;var he=Mi(f,K);return he?(he.feature=io(f),he.defaultOptions=he.options,this.resetStyle(he),K.onEachFeature&&K.onEachFeature(f,he),this.addLayer(he)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=s({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(y){this._setLayerStyle(y,f)},this)},_setLayerStyle:function(f,y){f.setStyle&&(typeof y=="function"&&(y=y(f.feature)),f.setStyle(y))}});function Mi(f,y){var C=f.type==="Feature"?f.geometry:f,A=C?C.coordinates:null,B=[],K=y&&y.pointToLayer,he=y&&y.coordsToLatLng||no,Se,Ee,We,st;if(!A&&!C)return null;switch(C.type){case"Point":return Se=he(A),to(K,f,Se,y);case"MultiPoint":for(We=0,st=A.length;We<st;We++)Se=he(A[We]),B.push(to(K,f,Se,y));return new ps(B);case"LineString":case"MultiLineString":return Ee=ha(A,C.type==="LineString"?0:1,he),new _r(Ee,y);case"Polygon":case"MultiPolygon":return Ee=ha(A,C.type==="Polygon"?1:2,he),new xs(Ee,y);case"GeometryCollection":for(We=0,st=C.geometries.length;We<st;We++){var Nt=Mi({geometry:C.geometries[We],type:"Feature",properties:f.properties},y);Nt&&B.push(Nt)}return new ps(B);case"FeatureCollection":for(We=0,st=C.features.length;We<st;We++){var $t=Mi(C.features[We],y);$t&&B.push($t)}return new ps(B);default:throw new Error("Invalid GeoJSON object.")}}function to(f,y,C,A){return f?f(y,C):new gs(C,A&&A.markersInheritOptions&&A)}function no(f){return new ce(f[1],f[0],f[2])}function ha(f,y,C){for(var A=[],B=0,K=f.length,he;B<K;B++)he=y?ha(f[B],y-1,C):(C||no)(f[B]),A.push(he);return A}function ro(f,y){return f=pe(f),f.alt!==void 0?[x(f.lng,y),x(f.lat,y),x(f.alt,y)]:[x(f.lng,y),x(f.lat,y)]}function so(f,y,C,A){for(var B=[],K=0,he=f.length;K<he;K++)B.push(y?so(f[K],Er(f[K])?0:y-1,C,A):ro(f[K],A));return!y&&C&&B.length>0&&B.push(B[0].slice()),B}function Ei(f,y){return f.feature?s({},f.feature,{geometry:y}):io(y)}function io(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var Go={toGeoJSON:function(f){return Ei(this,{type:"Point",coordinates:ro(this.getLatLng(),f)})}};gs.include(Go),eo.include(Go),Xa.include(Go),_r.include({toGeoJSON:function(f){var y=!Er(this._latlngs),C=so(this._latlngs,y?1:0,!1,f);return Ei(this,{type:(y?"Multi":"")+"LineString",coordinates:C})}}),xs.include({toGeoJSON:function(f){var y=!Er(this._latlngs),C=y&&!Er(this._latlngs[0]),A=so(this._latlngs,C?2:y?1:0,!0,f);return y||(A=[A]),Ei(this,{type:(C?"Multi":"")+"Polygon",coordinates:A})}}),Es.include({toMultiPoint:function(f){var y=[];return this.eachLayer(function(C){y.push(C.toGeoJSON(f).geometry.coordinates)}),Ei(this,{type:"MultiPoint",coordinates:y})},toGeoJSON:function(f){var y=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(y==="MultiPoint")return this.toMultiPoint(f);var C=y==="GeometryCollection",A=[];return this.eachLayer(function(B){if(B.toGeoJSON){var K=B.toGeoJSON(f);if(C)A.push(K.geometry);else{var he=io(K);he.type==="FeatureCollection"?A.push.apply(A,he.features):A.push(he)}}}),C?Ei(this,{geometries:A,type:"GeometryCollection"}):{type:"FeatureCollection",features:A}}});function Ql(f,y){return new Jr(f,y)}var Vr=Ql,Os=Ur.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,y,C){this._url=f,this._bounds=de(y),_(this,C)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Mt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){bn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&wi(this._image),this},bringToBack:function(){return this._map&&fs(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=de(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",y=this._image=f?this._url:Dt("img");if(Mt(y,"leaflet-image-layer"),this._zoomAnimated&&Mt(y,"leaflet-zoom-animated"),this.options.className&&Mt(y,this.options.className),y.onselectstart=p,y.onmousemove=p,y.onload=o(this.fire,this,"load"),y.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=y.src;return}y.src=this._url,y.alt=this.options.alt},_animateZoom:function(f){var y=this._map.getZoomScale(f.zoom),C=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;Lr(this._image,C,y)},_reset:function(){var f=this._image,y=new H(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),C=y.getSize();Dn(f,y.min),f.style.width=C.x+"px",f.style.height=C.y+"px"},_updateOpacity:function(){ur(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),Xl=function(f,y,C){return new Os(f,y,C)},Zo=Os.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",y=this._image=f?this._url:Dt("video");if(Mt(y,"leaflet-image-layer"),this._zoomAnimated&&Mt(y,"leaflet-zoom-animated"),this.options.className&&Mt(y,this.options.className),y.onselectstart=p,y.onmousemove=p,y.onloadeddata=o(this.fire,this,"load"),f){for(var C=y.getElementsByTagName("source"),A=[],B=0;B<C.length;B++)A.push(C[B].src);this._url=C.length>0?A:[y.src];return}D(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(y.style,"objectFit")&&(y.style.objectFit="fill"),y.autoplay=!!this.options.autoplay,y.loop=!!this.options.loop,y.muted=!!this.options.muted,y.playsInline=!!this.options.playsInline;for(var K=0;K<this._url.length;K++){var he=Dt("source");he.src=this._url[K],y.appendChild(he)}}});function ec(f,y,C){return new Zo(f,y,C)}var Ko=Os.extend({_initImage:function(){var f=this._image=this._url;Mt(f,"leaflet-image-layer"),this._zoomAnimated&&Mt(f,"leaflet-zoom-animated"),this.options.className&&Mt(f,this.options.className),f.onselectstart=p,f.onmousemove=p}});function Jo(f,y,C){return new Ko(f,y,C)}var g=Ur.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,y){f&&(f instanceof ce||D(f))?(this._latlng=pe(f),_(this,y)):(_(this,f),this._source=y),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&ur(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&ur(this._container,1),this.bringToFront(),this.options.interactive&&(Mt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(ur(this._container,0),this._removeTimeout=setTimeout(o(bn,void 0,this._container),200)):bn(this._container),this.options.interactive&&(gn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=pe(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&wi(this._container),this},bringToBack:function(){return this._map&&fs(this._container),this},_prepareOpen:function(f){var y=this._source;if(!y._map)return!1;if(y instanceof ps){y=null;var C=this._source._layers;for(var A in C)if(C[A]._map){y=C[A];break}if(!y)return!1;this._source=y}if(!f)if(y.getCenter)f=y.getCenter();else if(y.getLatLng)f=y.getLatLng();else if(y.getBounds)f=y.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,y=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof y=="string")f.innerHTML=y;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(y)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),y=oe(this.options.offset),C=this._getAnchor();this._zoomAnimated?Dn(this._container,f.add(C)):y=y.add(f).add(C);var A=this._containerBottom=-y.y,B=this._containerLeft=-Math.round(this._containerWidth/2)+y.x;this._container.style.bottom=A+"px",this._container.style.left=B+"px"}},_getAnchor:function(){return[0,0]}});Ht.include({_initOverlay:function(f,y,C,A){var B=y;return B instanceof f||(B=new f(A).setContent(y)),C&&B.setLatLng(C),B}}),Ur.include({_initOverlay:function(f,y,C,A){var B=C;return B instanceof f?(_(B,A),B._source=this):(B=y&&!A?y:new f(A,this),B.setContent(C)),B}});var Nu=g.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,g.prototype.openOn.call(this,f)},onAdd:function(f){g.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ds||this._source.on("preclick",Kr))},onRemove:function(f){g.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ds||this._source.off("preclick",Kr))},getEvents:function(){var f=g.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",y=this._container=Dt("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),C=this._wrapper=Dt("div",f+"-content-wrapper",y);if(this._contentNode=Dt("div",f+"-content",C),la(y),Ya(this._contentNode),Ct(y,"contextmenu",Kr),this._tipContainer=Dt("div",f+"-tip-container",y),this._tip=Dt("div",f+"-tip",this._tipContainer),this.options.closeButton){var A=this._closeButton=Dt("a",f+"-close-button",y);A.setAttribute("role","button"),A.setAttribute("aria-label","Close popup"),A.href="#close",A.innerHTML='<span aria-hidden="true">&#215;</span>',Ct(A,"click",function(B){Tn(B),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,y=f.style;y.width="",y.whiteSpace="nowrap";var C=f.offsetWidth;C=Math.min(C,this.options.maxWidth),C=Math.max(C,this.options.minWidth),y.width=C+1+"px",y.whiteSpace="",y.height="";var A=f.offsetHeight,B=this.options.maxHeight,K="leaflet-popup-scrolled";B&&A>B?(y.height=B+"px",Mt(f,K)):gn(f,K),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),C=this._getAnchor();Dn(this._container,y.add(C))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,y=parseInt(sa(this._container,"marginBottom"),10)||0,C=this._container.offsetHeight+y,A=this._containerWidth,B=new X(this._containerLeft,-C-this._containerBottom);B._add(hs(this._container));var K=f.layerPointToContainerPoint(B),he=oe(this.options.autoPanPadding),Se=oe(this.options.autoPanPaddingTopLeft||he),Ee=oe(this.options.autoPanPaddingBottomRight||he),We=f.getSize(),st=0,Nt=0;K.x+A+Ee.x>We.x&&(st=K.x+A-We.x+Ee.x),K.x-st-Se.x<0&&(st=K.x-Se.x),K.y+C+Ee.y>We.y&&(Nt=K.y+C-We.y+Ee.y),K.y-Nt-Se.y<0&&(Nt=K.y-Se.y),(st||Nt)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([st,Nt]))}},_getAnchor:function(){return oe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),tc=function(f,y){return new Nu(f,y)};Ht.mergeOptions({closePopupOnClick:!0}),Ht.include({openPopup:function(f,y,C){return this._initOverlay(Nu,f,y,C).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),Ur.include({bindPopup:function(f,y){return this._popup=this._initOverlay(Nu,this._popup,f,y),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof ps||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){qr(f);var y=f.layer||f.target;if(this._popup._source===y&&!(y instanceof Ds)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=y,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var nc=g.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){g.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){g.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=g.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",y=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Dt("div",y),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var y,C,A=this._map,B=this._container,K=A.latLngToContainerPoint(A.getCenter()),he=A.layerPointToContainerPoint(f),Se=this.options.direction,Ee=B.offsetWidth,We=B.offsetHeight,st=oe(this.options.offset),Nt=this._getAnchor();Se==="top"?(y=Ee/2,C=We):Se==="bottom"?(y=Ee/2,C=0):Se==="center"?(y=Ee/2,C=We/2):Se==="right"?(y=0,C=We/2):Se==="left"?(y=Ee,C=We/2):he.x<K.x?(Se="right",y=0,C=We/2):(Se="left",y=Ee+(st.x+Nt.x)*2,C=We/2),f=f.subtract(oe(y,C,!0)).add(st).add(Nt),gn(B,"leaflet-tooltip-right"),gn(B,"leaflet-tooltip-left"),gn(B,"leaflet-tooltip-top"),gn(B,"leaflet-tooltip-bottom"),Mt(B,"leaflet-tooltip-"+Se),Dn(B,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&ur(this._container,f)},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(y)},_getAnchor:function(){return oe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Cd=function(f,y){return new nc(f,y)};Ht.include({openTooltip:function(f,y,C){return this._initOverlay(nc,f,y,C).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),Ur.include({bindTooltip:function(f,y){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(nc,this._tooltip,f,y),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var y=f?"off":"on",C={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?C.add=this._openTooltip:(C.mouseover=this._openTooltip,C.mouseout=this.closeTooltip,C.click=this._openTooltip,this._map?this._addFocusListeners():C.add=this._addFocusListeners),this._tooltip.options.sticky&&(C.mousemove=this._moveTooltip),this[y](C),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof ps||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var y=typeof f.getElement=="function"&&f.getElement();y&&(Ct(y,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),Ct(y,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var y=typeof f.getElement=="function"&&f.getElement();y&&y.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var y=this;this._map.once("moveend",function(){y._openOnceFlag=!1,y._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var y=f.latlng,C,A;this._tooltip.options.sticky&&f.originalEvent&&(C=this._map.mouseEventToContainerPoint(f.originalEvent),A=this._map.containerPointToLayerPoint(C),y=this._map.layerPointToLatLng(A)),this._tooltip.setLatLng(y)}});var Su=si.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var y=f&&f.tagName==="DIV"?f:document.createElement("div"),C=this.options;if(C.html instanceof Element?(Ua(y),y.appendChild(C.html)):y.innerHTML=C.html!==!1?C.html:"",C.bgPos){var A=oe(C.bgPos);y.style.backgroundPosition=-A.x+"px "+-A.y+"px"}return this._setIconStyles(y,"icon"),y},createShadow:function(){return null}});function qm(f){return new Su(f)}si.Default=Pi;var ao=Ur.extend({options:{tileSize:256,opacity:1,updateWhenIdle:dt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){_(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),bn(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(wi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(fs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof X?f:new X(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var y=this.getPane().children,C=-f(-1/0,1/0),A=0,B=y.length,K;A<B;A++)K=y[A].style.zIndex,y[A]!==this._container&&K&&(C=f(C,+K));isFinite(C)&&(this.options.zIndex=C+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!dt.ielt9){ur(this._container,this.options.opacity);var f=+new Date,y=!1,C=!1;for(var A in this._tiles){var B=this._tiles[A];if(!(!B.current||!B.loaded)){var K=Math.min(1,(f-B.loaded)/200);ur(B.el,K),K<1?y=!0:(B.active?C=!0:this._onOpaqueTile(B),B.active=!0)}}C&&!this._noPrune&&this._pruneTiles(),y&&($(this._fadeFrame),this._fadeFrame=W(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=Dt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,y=this.options.maxZoom;if(f!==void 0){for(var C in this._levels)C=Number(C),this._levels[C].el.children.length||C===f?(this._levels[C].el.style.zIndex=y-Math.abs(f-C),this._onUpdateLevel(C)):(bn(this._levels[C].el),this._removeTilesAtZoom(C),this._onRemoveLevel(C),delete this._levels[C]);var A=this._levels[f],B=this._map;return A||(A=this._levels[f]={},A.el=Dt("div","leaflet-tile-container leaflet-zoom-animated",this._container),A.el.style.zIndex=y,A.origin=B.project(B.unproject(B.getPixelOrigin()),f).round(),A.zoom=f,this._setZoomTransform(A,B.getCenter(),B.getZoom()),p(A.el.offsetWidth),this._onCreateLevel(A)),this._level=A,A}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var f,y,C=this._map.getZoom();if(C>this.options.maxZoom||C<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)y=this._tiles[f],y.retain=y.current;for(f in this._tiles)if(y=this._tiles[f],y.current&&!y.active){var A=y.coords;this._retainParent(A.x,A.y,A.z,A.z-5)||this._retainChildren(A.x,A.y,A.z,A.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var y in this._tiles)this._tiles[y].coords.z===f&&this._removeTile(y)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)bn(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,y,C,A){var B=Math.floor(f/2),K=Math.floor(y/2),he=C-1,Se=new X(+B,+K);Se.z=+he;var Ee=this._tileCoordsToKey(Se),We=this._tiles[Ee];return We&&We.active?(We.retain=!0,!0):(We&&We.loaded&&(We.retain=!0),he>A?this._retainParent(B,K,he,A):!1)},_retainChildren:function(f,y,C,A){for(var B=2*f;B<2*f+2;B++)for(var K=2*y;K<2*y+2;K++){var he=new X(B,K);he.z=C+1;var Se=this._tileCoordsToKey(he),Ee=this._tiles[Se];if(Ee&&Ee.active){Ee.retain=!0;continue}else Ee&&Ee.loaded&&(Ee.retain=!0);C+1<A&&this._retainChildren(B,K,C+1,A)}},_resetView:function(f){var y=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),y,y)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var y=this.options;return y.minNativeZoom!==void 0&&f<y.minNativeZoom?y.minNativeZoom:y.maxNativeZoom!==void 0&&y.maxNativeZoom<f?y.maxNativeZoom:f},_setView:function(f,y,C,A){var B=Math.round(y);this.options.maxZoom!==void 0&&B>this.options.maxZoom||this.options.minZoom!==void 0&&B<this.options.minZoom?B=void 0:B=this._clampZoom(B);var K=this.options.updateWhenZooming&&B!==this._tileZoom;(!A||K)&&(this._tileZoom=B,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),B!==void 0&&this._update(f),C||this._pruneTiles(),this._noPrune=!!C),this._setZoomTransforms(f,y)},_setZoomTransforms:function(f,y){for(var C in this._levels)this._setZoomTransform(this._levels[C],f,y)},_setZoomTransform:function(f,y,C){var A=this._map.getZoomScale(C,f.zoom),B=f.origin.multiplyBy(A).subtract(this._map._getNewPixelOrigin(y,C)).round();dt.any3d?Lr(f.el,B,A):Dn(f.el,B)},_resetGrid:function(){var f=this._map,y=f.options.crs,C=this._tileSize=this.getTileSize(),A=this._tileZoom,B=this._map.getPixelWorldBounds(this._tileZoom);B&&(this._globalTileRange=this._pxBoundsToTileRange(B)),this._wrapX=y.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,y.wrapLng[0]],A).x/C.x),Math.ceil(f.project([0,y.wrapLng[1]],A).x/C.y)],this._wrapY=y.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([y.wrapLat[0],0],A).y/C.x),Math.ceil(f.project([y.wrapLat[1],0],A).y/C.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var y=this._map,C=y._animatingZoom?Math.max(y._animateToZoom,y.getZoom()):y.getZoom(),A=y.getZoomScale(C,this._tileZoom),B=y.project(f,this._tileZoom).floor(),K=y.getSize().divideBy(A*2);return new H(B.subtract(K),B.add(K))},_update:function(f){var y=this._map;if(y){var C=this._clampZoom(y.getZoom());if(f===void 0&&(f=y.getCenter()),this._tileZoom!==void 0){var A=this._getTiledPixelBounds(f),B=this._pxBoundsToTileRange(A),K=B.getCenter(),he=[],Se=this.options.keepBuffer,Ee=new H(B.getBottomLeft().subtract([Se,-Se]),B.getTopRight().add([Se,-Se]));if(!(isFinite(B.min.x)&&isFinite(B.min.y)&&isFinite(B.max.x)&&isFinite(B.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var We in this._tiles){var st=this._tiles[We].coords;(st.z!==this._tileZoom||!Ee.contains(new X(st.x,st.y)))&&(this._tiles[We].current=!1)}if(Math.abs(C-this._tileZoom)>1){this._setView(f,C);return}for(var Nt=B.min.y;Nt<=B.max.y;Nt++)for(var $t=B.min.x;$t<=B.max.x;$t++){var jr=new X($t,Nt);if(jr.z=this._tileZoom,!!this._isValidTile(jr)){var hr=this._tiles[this._tileCoordsToKey(jr)];hr?hr.current=!0:he.push(jr)}}if(he.sort(function(Qr,oc){return Qr.distanceTo(K)-oc.distanceTo(K)}),he.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ys=document.createDocumentFragment();for($t=0;$t<he.length;$t++)this._addTile(he[$t],ys);this._level.el.appendChild(ys)}}}},_isValidTile:function(f){var y=this._map.options.crs;if(!y.infinite){var C=this._globalTileRange;if(!y.wrapLng&&(f.x<C.min.x||f.x>C.max.x)||!y.wrapLat&&(f.y<C.min.y||f.y>C.max.y))return!1}if(!this.options.bounds)return!0;var A=this._tileCoordsToBounds(f);return de(this.options.bounds).overlaps(A)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var y=this._map,C=this.getTileSize(),A=f.scaleBy(C),B=A.add(C),K=y.unproject(A,f.z),he=y.unproject(B,f.z);return[K,he]},_tileCoordsToBounds:function(f){var y=this._tileCoordsToNwSe(f),C=new re(y[0],y[1]);return this.options.noWrap||(C=this._map.wrapLatLngBounds(C)),C},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var y=f.split(":"),C=new X(+y[0],+y[1]);return C.z=+y[2],C},_removeTile:function(f){var y=this._tiles[f];y&&(bn(y.el),delete this._tiles[f],this.fire("tileunload",{tile:y.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){Mt(f,"leaflet-tile");var y=this.getTileSize();f.style.width=y.x+"px",f.style.height=y.y+"px",f.onselectstart=p,f.onmousemove=p,dt.ielt9&&this.options.opacity<1&&ur(f,this.options.opacity)},_addTile:function(f,y){var C=this._getTilePos(f),A=this._tileCoordsToKey(f),B=this.createTile(this._wrapCoords(f),o(this._tileReady,this,f));this._initTile(B),this.createTile.length<2&&W(o(this._tileReady,this,f,null,B)),Dn(B,C),this._tiles[A]={el:B,coords:f,current:!0},y.appendChild(B),this.fire("tileloadstart",{tile:B,coords:f})},_tileReady:function(f,y,C){y&&this.fire("tileerror",{error:y,tile:C,coords:f});var A=this._tileCoordsToKey(f);C=this._tiles[A],C&&(C.loaded=+new Date,this._map._fadeAnimated?(ur(C.el,0),$(this._fadeFrame),this._fadeFrame=W(this._updateOpacity,this)):(C.active=!0,this._pruneTiles()),y||(Mt(C.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:C.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),dt.ielt9||!this._map._fadeAnimated?W(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var y=new X(this._wrapX?h(f.x,this._wrapX):f.x,this._wrapY?h(f.y,this._wrapY):f.y);return y.z=f.z,y},_pxBoundsToTileRange:function(f){var y=this.getTileSize();return new H(f.min.unscaleBy(y).floor(),f.max.unscaleBy(y).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function rc(f){return new ao(f)}var oo=ao.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,y){this._url=f,y=_(this,y),y.detectRetina&&dt.retina&&y.maxZoom>0?(y.tileSize=Math.floor(y.tileSize/2),y.zoomReverse?(y.zoomOffset--,y.minZoom=Math.min(y.maxZoom,y.minZoom+1)):(y.zoomOffset++,y.maxZoom=Math.max(y.minZoom,y.maxZoom-1)),y.minZoom=Math.max(0,y.minZoom)):y.zoomReverse?y.minZoom=Math.min(y.maxZoom,y.minZoom):y.maxZoom=Math.max(y.minZoom,y.maxZoom),typeof y.subdomains=="string"&&(y.subdomains=y.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,y){return this._url===f&&y===void 0&&(y=!0),this._url=f,y||this.redraw(),this},createTile:function(f,y){var C=document.createElement("img");return Ct(C,"load",o(this._tileOnLoad,this,y,C)),Ct(C,"error",o(this._tileOnError,this,y,C)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(C.referrerPolicy=this.options.referrerPolicy),C.alt="",C.src=this.getTileUrl(f),C},getTileUrl:function(f){var y={r:dt.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var C=this._globalTileRange.max.y-f.y;this.options.tms&&(y.y=C),y["-y"]=C}return P(this._url,s(y,this.options))},_tileOnLoad:function(f,y){dt.ielt9?setTimeout(o(f,this,null,y),0):f(null,y)},_tileOnError:function(f,y,C){var A=this.options.errorTileUrl;A&&y.getAttribute("src")!==A&&(y.src=A),f(C,y)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,y=this.options.maxZoom,C=this.options.zoomReverse,A=this.options.zoomOffset;return C&&(f=y-f),f+A},_getSubdomain:function(f){var y=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[y]},_abortLoading:function(){var f,y;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(y=this._tiles[f].el,y.onload=p,y.onerror=p,!y.complete)){y.src=O;var C=this._tiles[f].coords;bn(y),delete this._tiles[f],this.fire("tileabort",{tile:y,coords:C})}},_removeTile:function(f){var y=this._tiles[f];if(y)return y.el.setAttribute("src",O),ao.prototype._removeTile.call(this,f)},_tileReady:function(f,y,C){if(!(!this._map||C&&C.getAttribute("src")===O))return ao.prototype._tileReady.call(this,f,y,C)}});function Gf(f,y){return new oo(f,y)}var Td=oo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,y){this._url=f;var C=s({},this.defaultWmsParams);for(var A in y)A in this.options||(C[A]=y[A]);y=_(this,y);var B=y.detectRetina&&dt.retina?2:1,K=this.getTileSize();C.width=K.x*B,C.height=K.y*B,this.wmsParams=C},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var y=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[y]=this._crs.code,oo.prototype.onAdd.call(this,f)},getTileUrl:function(f){var y=this._tileCoordsToNwSe(f),C=this._crs,A=Q(C.project(y[0]),C.project(y[1])),B=A.min,K=A.max,he=(this._wmsVersion>=1.3&&this._crs===Gl?[B.y,B.x,K.y,K.x]:[B.x,B.y,K.x,K.y]).join(","),Se=oo.prototype.getTileUrl.call(this,f);return Se+j(this.wmsParams,Se,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+he},setParams:function(f,y){return s(this.wmsParams,f),y||this.redraw(),this}});function zm(f,y){return new Td(f,y)}oo.WMS=Td,Gf.wms=zm;var Di=Ur.extend({options:{padding:.1},initialize:function(f){_(this,f),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Mt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,y){var C=this._map.getZoomScale(y,this._zoom),A=this._map.getSize().multiplyBy(.5+this.options.padding),B=this._map.project(this._center,y),K=A.multiplyBy(-C).add(B).subtract(this._map._getNewPixelOrigin(f,y));dt.any3d?Lr(this._container,K,C):Dn(this._container,K)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,y=this._map.getSize(),C=this._map.containerPointToLayerPoint(y.multiplyBy(-f)).round();this._bounds=new H(C,C.add(y.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Zf=Di.extend({options:{tolerance:0},getEvents:function(){var f=Di.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Di.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");Ct(f,"mousemove",this._onMouseMove,this),Ct(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ct(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){$(this._redrawRequest),delete this._ctx,bn(this._container),ln(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var y in this._layers)f=this._layers[y],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Di.prototype._update.call(this);var f=this._bounds,y=this._container,C=f.getSize(),A=dt.retina?2:1;Dn(y,f.min),y.width=A*C.x,y.height=A*C.y,y.style.width=C.x+"px",y.style.height=C.y+"px",dt.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){Di.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[c(f)]=f;var y=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=y),this._drawLast=y,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var y=f._order,C=y.next,A=y.prev;C?C.prev=A:this._drawLast=A,A?A.next=C:this._drawFirst=C,delete f._order,delete this._layers[c(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var y=f.options.dashArray.split(/[, ]+/),C=[],A,B;for(B=0;B<y.length;B++){if(A=Number(y[B]),isNaN(A))return;C.push(A)}f.options._dashArray=C}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||W(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var y=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new H,this._redrawBounds.extend(f._pxBounds.min.subtract([y,y])),this._redrawBounds.extend(f._pxBounds.max.add([y,y]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var y=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,y.x,y.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,y=this._redrawBounds;if(this._ctx.save(),y){var C=y.getSize();this._ctx.beginPath(),this._ctx.rect(y.min.x,y.min.y,C.x,C.y),this._ctx.clip()}this._drawing=!0;for(var A=this._drawFirst;A;A=A.next)f=A.layer,(!y||f._pxBounds&&f._pxBounds.intersects(y))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,y){if(this._drawing){var C,A,B,K,he=f._parts,Se=he.length,Ee=this._ctx;if(Se){for(Ee.beginPath(),C=0;C<Se;C++){for(A=0,B=he[C].length;A<B;A++)K=he[C][A],Ee[A?"lineTo":"moveTo"](K.x,K.y);y&&Ee.closePath()}this._fillStroke(Ee,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var y=f._point,C=this._ctx,A=Math.max(Math.round(f._radius),1),B=(Math.max(Math.round(f._radiusY),1)||A)/A;B!==1&&(C.save(),C.scale(1,B)),C.beginPath(),C.arc(y.x,y.y/B,A,0,Math.PI*2,!1),B!==1&&C.restore(),this._fillStroke(C,f)}},_fillStroke:function(f,y){var C=y.options;C.fill&&(f.globalAlpha=C.fillOpacity,f.fillStyle=C.fillColor||C.color,f.fill(C.fillRule||"evenodd")),C.stroke&&C.weight!==0&&(f.setLineDash&&f.setLineDash(y.options&&y.options._dashArray||[]),f.globalAlpha=C.opacity,f.lineWidth=C.weight,f.strokeStyle=C.color,f.lineCap=C.lineCap,f.lineJoin=C.lineJoin,f.stroke())},_onClick:function(f){for(var y=this._map.mouseEventToLayerPoint(f),C,A,B=this._drawFirst;B;B=B.next)C=B.layer,C.options.interactive&&C._containsPoint(y)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(C))&&(A=C);this._fireEvent(A?[A]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var y=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,y)}},_handleMouseOut:function(f){var y=this._hoveredLayer;y&&(gn(this._container,"leaflet-interactive"),this._fireEvent([y],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,y){if(!this._mouseHoverThrottled){for(var C,A,B=this._drawFirst;B;B=B.next)C=B.layer,C.options.interactive&&C._containsPoint(y)&&(A=C);A!==this._hoveredLayer&&(this._handleMouseOut(f),A&&(Mt(this._container,"leaflet-interactive"),this._fireEvent([A],f,"mouseover"),this._hoveredLayer=A)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,y,C){this._map._fireDOMEvent(y,C||y.type,f)},_bringToFront:function(f){var y=f._order;if(y){var C=y.next,A=y.prev;if(C)C.prev=A;else return;A?A.next=C:C&&(this._drawFirst=C),y.prev=this._drawLast,this._drawLast.next=y,y.next=null,this._drawLast=y,this._requestRedraw(f)}},_bringToBack:function(f){var y=f._order;if(y){var C=y.next,A=y.prev;if(A)A.next=C;else return;C?C.prev=A:A&&(this._drawLast=A),y.prev=null,y.next=this._drawFirst,this._drawFirst.prev=y,this._drawFirst=y,this._requestRedraw(f)}}});function Kf(f){return dt.canvas?new Zf(f):null}var sc=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Um={_initContainer:function(){this._container=Dt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Di.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var y=f._container=sc("shape");Mt(y,"leaflet-vml-shape "+(this.options.className||"")),y.coordsize="1 1",f._path=sc("path"),y.appendChild(f._path),this._updateStyle(f),this._layers[c(f)]=f},_addPath:function(f){var y=f._container;this._container.appendChild(y),f.options.interactive&&f.addInteractiveTarget(y)},_removePath:function(f){var y=f._container;bn(y),f.removeInteractiveTarget(y),delete this._layers[c(f)]},_updateStyle:function(f){var y=f._stroke,C=f._fill,A=f.options,B=f._container;B.stroked=!!A.stroke,B.filled=!!A.fill,A.stroke?(y||(y=f._stroke=sc("stroke")),B.appendChild(y),y.weight=A.weight+"px",y.color=A.color,y.opacity=A.opacity,A.dashArray?y.dashStyle=D(A.dashArray)?A.dashArray.join(" "):A.dashArray.replace(/( *, *)/g," "):y.dashStyle="",y.endcap=A.lineCap.replace("butt","flat"),y.joinstyle=A.lineJoin):y&&(B.removeChild(y),f._stroke=null),A.fill?(C||(C=f._fill=sc("fill")),B.appendChild(C),C.color=A.fillColor||A.color,C.opacity=A.fillOpacity):C&&(B.removeChild(C),f._fill=null)},_updateCircle:function(f){var y=f._point.round(),C=Math.round(f._radius),A=Math.round(f._radiusY||C);this._setPath(f,f._empty()?"M0 0":"AL "+y.x+","+y.y+" "+C+","+A+" 0,"+65535*360)},_setPath:function(f,y){f._path.v=y},_bringToFront:function(f){wi(f._container)},_bringToBack:function(f){fs(f._container)}},ii=dt.vml?sc:we,Qo=Di.extend({_initContainer:function(){this._container=ii("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ii("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){bn(this._container),ln(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Di.prototype._update.call(this);var f=this._bounds,y=f.getSize(),C=this._container;(!this._svgSize||!this._svgSize.equals(y))&&(this._svgSize=y,C.setAttribute("width",y.x),C.setAttribute("height",y.y)),Dn(C,f.min),C.setAttribute("viewBox",[f.min.x,f.min.y,y.x,y.y].join(" ")),this.fire("update")}},_initPath:function(f){var y=f._path=ii("path");f.options.className&&Mt(y,f.options.className),f.options.interactive&&Mt(y,"leaflet-interactive"),this._updateStyle(f),this._layers[c(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){bn(f._path),f.removeInteractiveTarget(f._path),delete this._layers[c(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var y=f._path,C=f.options;y&&(C.stroke?(y.setAttribute("stroke",C.color),y.setAttribute("stroke-opacity",C.opacity),y.setAttribute("stroke-width",C.weight),y.setAttribute("stroke-linecap",C.lineCap),y.setAttribute("stroke-linejoin",C.lineJoin),C.dashArray?y.setAttribute("stroke-dasharray",C.dashArray):y.removeAttribute("stroke-dasharray"),C.dashOffset?y.setAttribute("stroke-dashoffset",C.dashOffset):y.removeAttribute("stroke-dashoffset")):y.setAttribute("stroke","none"),C.fill?(y.setAttribute("fill",C.fillColor||C.color),y.setAttribute("fill-opacity",C.fillOpacity),y.setAttribute("fill-rule",C.fillRule||"evenodd")):y.setAttribute("fill","none"))},_updatePoly:function(f,y){this._setPath(f,Ne(f._parts,y))},_updateCircle:function(f){var y=f._point,C=Math.max(Math.round(f._radius),1),A=Math.max(Math.round(f._radiusY),1)||C,B="a"+C+","+A+" 0 1,0 ",K=f._empty()?"M0 0":"M"+(y.x-C)+","+y.y+B+C*2+",0 "+B+-C*2+",0 ";this._setPath(f,K)},_setPath:function(f,y){f._path.setAttribute("d",y)},_bringToFront:function(f){wi(f._path)},_bringToBack:function(f){fs(f._path)}});dt.vml&&Qo.include(Um);function Cu(f){return dt.svg||dt.vml?new Qo(f):null}Ht.include({getRenderer:function(f){var y=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return y||(y=this._renderer=this._createRenderer()),this.hasLayer(y)||this.addLayer(y),y},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var y=this._paneRenderers[f];return y===void 0&&(y=this._createRenderer({pane:f}),this._paneRenderers[f]=y),y},_createRenderer:function(f){return this.options.preferCanvas&&Kf(f)||Cu(f)}});var Vm=xs.extend({initialize:function(f,y){xs.prototype.initialize.call(this,this._boundsToLatLngs(f),y)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=de(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function Fy(f,y){return new Vm(f,y)}Qo.create=ii,Qo.pointsToPath=Ne,Jr.geometryToLayer=Mi,Jr.coordsToLatLng=no,Jr.coordsToLatLngs=ha,Jr.latLngToCoords=ro,Jr.latLngsToCoords=so,Jr.getFeature=Ei,Jr.asFeature=io,Ht.mergeOptions({boxZoom:!0});var ic=Mr.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){Ct(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ln(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){bn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Kt(),Wa(),this._startPoint=this._map.mouseEventToContainerPoint(f),Ct(document,{contextmenu:qr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Dt("div","leaflet-zoom-box",this._container),Mt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var y=new H(this._point,this._startPoint),C=y.getSize();Dn(this._box,y.min),this._box.style.width=C.x+"px",this._box.style.height=C.y+"px"},_finish:function(){this._moved&&(bn(this._box),gn(this._container,"leaflet-crosshair")),Ni(),$a(),ln(document,{contextmenu:qr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var y=new re(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(y).fire("boxzoomend",{boxZoomBounds:y})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ht.addInitHook("addHandler","boxZoom",ic),Ht.mergeOptions({doubleClickZoom:!0});var Bm=Mr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var y=this._map,C=y.getZoom(),A=y.options.zoomDelta,B=f.originalEvent.shiftKey?C-A:C+A;y.options.doubleClickZoom==="center"?y.setZoom(B):y.setZoomAround(f.containerPoint,B)}});Ht.addInitHook("addHandler","doubleClickZoom",Bm),Ht.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Jf=Mr.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new zr(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}Mt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){gn(this._map._container,"leaflet-grab"),gn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var y=de(this._map.options.maxBounds);this._offsetLimit=Q(this._map.latLngToContainerPoint(y.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(y.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var y=this._lastTime=+new Date,C=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(C),this._times.push(y),this._prunePositions(y)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),y=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=y.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,y){return f-(f-y)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),y=this._offsetLimit;f.x<y.min.x&&(f.x=this._viscousLimit(f.x,y.min.x)),f.y<y.min.y&&(f.y=this._viscousLimit(f.y,y.min.y)),f.x>y.max.x&&(f.x=this._viscousLimit(f.x,y.max.x)),f.y>y.max.y&&(f.y=this._viscousLimit(f.y,y.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,y=Math.round(f/2),C=this._initialWorldOffset,A=this._draggable._newPos.x,B=(A-y+C)%f+y-C,K=(A+y+C)%f-y-C,he=Math.abs(B+C)<Math.abs(K+C)?B:K;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=he},_onDragEnd:function(f){var y=this._map,C=y.options,A=!C.inertia||f.noInertia||this._times.length<2;if(y.fire("dragend",f),A)y.fire("moveend");else{this._prunePositions(+new Date);var B=this._lastPos.subtract(this._positions[0]),K=(this._lastTime-this._times[0])/1e3,he=C.easeLinearity,Se=B.multiplyBy(he/K),Ee=Se.distanceTo([0,0]),We=Math.min(C.inertiaMaxSpeed,Ee),st=Se.multiplyBy(We/Ee),Nt=We/(C.inertiaDeceleration*he),$t=st.multiplyBy(-Nt/2).round();!$t.x&&!$t.y?y.fire("moveend"):($t=y._limitOffset($t,y.options.maxBounds),W(function(){y.panBy($t,{duration:Nt,easeLinearity:he,noMoveStart:!0,animate:!0})}))}}});Ht.addInitHook("addHandler","dragging",Jf),Ht.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Qf=Mr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),Ct(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ln(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,y=document.documentElement,C=f.scrollTop||y.scrollTop,A=f.scrollLeft||y.scrollLeft;this._map._container.focus(),window.scrollTo(A,C)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var y=this._panKeys={},C=this.keyCodes,A,B;for(A=0,B=C.left.length;A<B;A++)y[C.left[A]]=[-1*f,0];for(A=0,B=C.right.length;A<B;A++)y[C.right[A]]=[f,0];for(A=0,B=C.down.length;A<B;A++)y[C.down[A]]=[0,f];for(A=0,B=C.up.length;A<B;A++)y[C.up[A]]=[0,-1*f]},_setZoomDelta:function(f){var y=this._zoomKeys={},C=this.keyCodes,A,B;for(A=0,B=C.zoomIn.length;A<B;A++)y[C.zoomIn[A]]=f;for(A=0,B=C.zoomOut.length;A<B;A++)y[C.zoomOut[A]]=-f},_addHooks:function(){Ct(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ln(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var y=f.keyCode,C=this._map,A;if(y in this._panKeys){if(!C._panAnim||!C._panAnim._inProgress)if(A=this._panKeys[y],f.shiftKey&&(A=oe(A).multiplyBy(3)),C.options.maxBounds&&(A=C._limitOffset(oe(A),C.options.maxBounds)),C.options.worldCopyJump){var B=C.wrapLatLng(C.unproject(C.project(C.getCenter()).add(A)));C.panTo(B)}else C.panBy(A)}else if(y in this._zoomKeys)C.setZoom(C.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[y]);else if(y===27&&C._popup&&C._popup.options.closeOnEscapeKey)C.closePopup();else return;qr(f)}}});Ht.addInitHook("addHandler","keyboard",Qf),Ht.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Sn=Mr.extend({addHooks:function(){Ct(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ln(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var y=zl(f),C=this._map.options.wheelDebounceTime;this._delta+=y,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var A=Math.max(C-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),A),qr(f)},_performZoom:function(){var f=this._map,y=f.getZoom(),C=this._map.options.zoomSnap||0;f._stop();var A=this._delta/(this._map.options.wheelPxPerZoomLevel*4),B=4*Math.log(2/(1+Math.exp(-Math.abs(A))))/Math.LN2,K=C?Math.ceil(B/C)*C:B,he=f._limitZoom(y+(this._delta>0?K:-K))-y;this._delta=0,this._startTime=null,he&&(f.options.scrollWheelZoom==="center"?f.setZoom(y+he):f.setZoomAround(this._lastMousePos,y+he))}});Ht.addInitHook("addHandler","scrollWheelZoom",Sn);var Xf=600;Ht.mergeOptions({tapHold:dt.touchNative&&dt.safari&&dt.mobile,tapTolerance:15});var kd=Mr.extend({addHooks:function(){Ct(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ln(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var y=f.touches[0];this._startPos=this._newPos=new X(y.clientX,y.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Ct(document,"touchend",Tn),Ct(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",y))},this),Xf),Ct(document,"touchend touchcancel contextmenu",this._cancel,this),Ct(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){ln(document,"touchend",Tn),ln(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),ln(document,"touchend touchcancel contextmenu",this._cancel,this),ln(document,"touchmove",this._onMove,this)},_onMove:function(f){var y=f.touches[0];this._newPos=new X(y.clientX,y.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,y){var C=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:y.screenX,screenY:y.screenY,clientX:y.clientX,clientY:y.clientY});C._simulated=!0,y.target.dispatchEvent(C)}});Ht.addInitHook("addHandler","tapHold",kd),Ht.mergeOptions({touchZoom:dt.touch,bounceAtZoomLimits:!0});var ac=Mr.extend({addHooks:function(){Mt(this._map._container,"leaflet-touch-zoom"),Ct(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){gn(this._map._container,"leaflet-touch-zoom"),ln(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var y=this._map;if(!(!f.touches||f.touches.length!==2||y._animatingZoom||this._zooming)){var C=y.mouseEventToContainerPoint(f.touches[0]),A=y.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=y.getSize()._divideBy(2),this._startLatLng=y.containerPointToLatLng(this._centerPoint),y.options.touchZoom!=="center"&&(this._pinchStartLatLng=y.containerPointToLatLng(C.add(A)._divideBy(2))),this._startDist=C.distanceTo(A),this._startZoom=y.getZoom(),this._moved=!1,this._zooming=!0,y._stop(),Ct(document,"touchmove",this._onTouchMove,this),Ct(document,"touchend touchcancel",this._onTouchEnd,this),Tn(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var y=this._map,C=y.mouseEventToContainerPoint(f.touches[0]),A=y.mouseEventToContainerPoint(f.touches[1]),B=C.distanceTo(A)/this._startDist;if(this._zoom=y.getScaleZoom(B,this._startZoom),!y.options.bounceAtZoomLimits&&(this._zoom<y.getMinZoom()&&B<1||this._zoom>y.getMaxZoom()&&B>1)&&(this._zoom=y._limitZoom(this._zoom)),y.options.touchZoom==="center"){if(this._center=this._startLatLng,B===1)return}else{var K=C._add(A)._divideBy(2)._subtract(this._centerPoint);if(B===1&&K.x===0&&K.y===0)return;this._center=y.unproject(y.project(this._pinchStartLatLng,this._zoom).subtract(K),this._zoom)}this._moved||(y._moveStart(!0,!1),this._moved=!0),$(this._animRequest);var he=o(y._move,y,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=W(he,this,!0),Tn(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,$(this._animRequest),ln(document,"touchmove",this._onTouchMove,this),ln(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ht.addInitHook("addHandler","touchZoom",ac),Ht.BoxZoom=ic,Ht.DoubleClickZoom=Bm,Ht.Drag=Jf,Ht.Keyboard=Qf,Ht.ScrollWheelZoom=Sn,Ht.TapHold=kd,Ht.TouchZoom=ac,t.Bounds=H,t.Browser=dt,t.CRS=ie,t.Canvas=Zf,t.Circle=eo,t.CircleMarker=Xa,t.Class=Y,t.Control=wr,t.DivIcon=Su,t.DivOverlay=g,t.DomEvent=Ga,t.DomUtil=oa,t.Draggable=zr,t.Evented=ee,t.FeatureGroup=ps,t.GeoJSON=Jr,t.GridLayer=ao,t.Handler=Mr,t.Icon=si,t.ImageOverlay=Os,t.LatLng=ce,t.LatLngBounds=re,t.Layer=Ur,t.LayerGroup=Es,t.LineUtil=Yl,t.Map=Ht,t.Marker=gs,t.Mixin=zo,t.Path=Ds,t.Point=X,t.PolyUtil=pd,t.Polygon=xs,t.Polyline=_r,t.Popup=Nu,t.PosAnimation=Za,t.Projection=bd,t.Rectangle=Vm,t.Renderer=Di,t.SVG=Qo,t.SVGOverlay=Ko,t.TileLayer=oo,t.Tooltip=nc,t.Transformation=Oe,t.Util=ne,t.VideoOverlay=Zo,t.bind=o,t.bounds=Q,t.canvas=Kf,t.circle=fa,t.circleMarker=Jl,t.control=Ms,t.divIcon=qm,t.extend=s,t.featureGroup=Zl,t.geoJSON=Ql,t.geoJson=Vr,t.gridLayer=rc,t.icon=Kl,t.imageOverlay=Xl,t.latLng=pe,t.latLngBounds=de,t.layerGroup=ua,t.map=Ps,t.marker=jd,t.point=oe,t.polygon=Sd,t.polyline=Nd,t.popup=tc,t.rectangle=Fy,t.setOptions=_,t.stamp=c,t.svg=Cu,t.svgOverlay=Jo,t.tileLayer=Gf,t.tooltip=Cd,t.transformation=Pe,t.version=r,t.videoOverlay=ec;var Wm=window.L;t.noConflict=function(){return window.L=Wm,this},window.L=t}))})(Gh,Gh.exports)),Gh.exports}var Hde=$de();const Ar=gu(Hde),Yde=({events:n,users:e})=>{const t=E.useRef(null),r=E.useRef(null),s=E.useRef(Ar.layerGroup()),a=E.useRef(null),{theme:o}=Jc();return E.useEffect(()=>{r.current&&!t.current&&(t.current=Ar.map(r.current,{zoomControl:!1}).setView([12.9716,77.5946],12),s.current.addTo(t.current),Ar.control.zoom({position:"bottomright"}).addTo(t.current)),setTimeout(()=>t.current?.invalidateSize(),100)},[]),E.useEffect(()=>{if(!t.current)return;const l=o==="dark",h=l?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",p=l?'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>':'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';a.current?(a.current.setUrl(h),t.current.attributionControl.setPrefix(p)):a.current=Ar.tileLayer(h,{attribution:p}).addTo(t.current)},[o]),E.useEffect(()=>{s.current.clearLayers();const l=new Map;n.forEach(h=>{if(h.latitude&&h.longitude){const p=l.get(h.userId);(!p||new Date(h.timestamp)>new Date(p.timestamp))&&l.set(h.userId,h)}});const c=new Map(e.map(h=>[h.id,h])),d=[];if(l.forEach(h=>{const p=c.get(h.userId);if(p&&h.latitude&&h.longitude){const x=Ar.divIcon({className:"",html:`<div class="user-marker" style="background-image: url(${p.photoUrl||`https://i.pravatar.cc/150?u=${p.id}`})"></div>`,iconSize:[48,48],iconAnchor:[24,56],popupAnchor:[0,-56]}),v=Ar.marker([h.latitude,h.longitude],{icon:x});v.bindPopup(`
                    <div class="user-marker-popup">
                        <p class="popup-name">${p.name}</p>
                        <p class="popup-time">Last seen: ${$e(new Date(h.timestamp),"hh:mm a")}</p>
                    </div>
                `),s.current.addLayer(v),d.push(v)}}),d.length>0&&t.current){const h=Ar.featureGroup(d);t.current.fitBounds(h.getBounds().pad(.5))}else t.current&&t.current.setView([12.9716,77.5946],12)},[n,e]),i.jsx("div",{ref:r,style:{height:"600px",width:"100%",borderRadius:"1rem",zIndex:0}})},Gde=({events:n,selectedUser:e})=>{const t=E.useRef(null),r=E.useRef(null),s=E.useRef(null),a=E.useRef(null),o=E.useRef(Ar.layerGroup()),l=E.useRef(null),{theme:c}=Jc(),d=E.useMemo(()=>n.filter(h=>h.userId===e&&h.latitude&&h.longitude).sort((h,p)=>new Date(h.timestamp).getTime()-new Date(p.timestamp).getTime()),[n,e]);return E.useEffect(()=>{r.current&&!t.current&&(t.current=Ar.map(r.current,{zoomControl:!1}).setView([12.9716,77.5946],12),o.current.addTo(t.current),Ar.control.zoom({position:"bottomright"}).addTo(t.current)),setTimeout(()=>t.current?.invalidateSize(),100)},[]),E.useEffect(()=>{if(!t.current)return;const h=c==="dark",v=h?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",w=h?'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>':'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';l.current?(l.current.setUrl(v),t.current.attributionControl.setPrefix(w)):l.current=Ar.tileLayer(v,{attribution:w}).addTo(t.current)},[c]),E.useEffect(()=>{if(!t.current)return;if(o.current.clearLayers(),s.current&&(t.current.removeLayer(s.current),s.current=null),a.current&&(t.current.removeLayer(a.current),a.current=null),d.length===0){t.current.setView([12.9716,77.5946],12);return}const h=d.map(I=>[I.latitude,I.longitude]);s.current=Ar.polyline(h,{color:"#00BFA6",weight:4}).addTo(t.current);const p=h[0],x=h[h.length-1],v=Ar.marker(p,{icon:Ar.divIcon({className:"",html:'<div style="width:16px;height:16px;border-radius:50%;background-color:#00BFA6;border:2px solid white;"></div>',iconSize:[16,16],iconAnchor:[8,8]})}),w=Ar.marker(x,{icon:Ar.divIcon({className:"",html:'<div style="width:16px;height:16px;border-radius:50%;background-color:#EF4444;border:2px solid white;"></div>',iconSize:[16,16],iconAnchor:[8,8]})});o.current.addLayer(v),o.current.addLayer(w);let _=h[0][0],j=h[0][0],T=h[0][1],P=h[0][1];h.forEach(([I,q])=>{_=Math.min(_,I),j=Math.max(j,I),T=Math.min(T,q),P=Math.max(P,q)});const D=[_,T],M=[j,P];a.current=Ar.rectangle([D,M],{color:"#FFB700",weight:2,fillOpacity:.1}).addTo(t.current);const O=Ar.latLngBounds(D,M);t.current.fitBounds(O.pad(.2))},[d]),i.jsx("div",{ref:r,style:{height:"600px",width:"100%",borderRadius:"1rem",zIndex:0}})},Zde=({event:n})=>i.jsxs("div",{className:"bg-card rounded-2xl border border-border overflow-hidden shadow-sm",children:[i.jsxs("div",{className:"p-3 bg-page flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium text-muted",children:"User"}),i.jsx("span",{className:"font-semibold text-primary-text",children:n.userName})]}),i.jsxs("div",{className:"p-3 space-y-3 text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Event"}),i.jsx("span",{className:"font-semibold capitalize text-primary-text",children:n.type.replace("-"," ")})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Timestamp"}),i.jsx("span",{className:"text-primary-text",children:$e(new Date(n.timestamp),"dd MMM, yy - hh:mm a")})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Location"}),n.latitude&&n.longitude?i.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${n.latitude},${n.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-accent hover:underline",children:[i.jsx(Tl,{className:"h-4 w-4 mr-1"})," View on Map"]}):i.jsx("span",{className:"text-primary-text",children:"-"})]})]})]}),Kde=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(!0),[c,d]=E.useState($e(new Date,"yyyy-MM-dd")),[h,p]=E.useState($e(new Date,"yyyy-MM-dd")),[x,v]=E.useState("all"),w=Ft("(max-width: 767px)"),_=E.useMemo(()=>s.filter(M=>M.role==="field_officer"),[s]),j=E.useCallback(async()=>{l(!0);try{const M=new Date(c);M.setHours(0,0,0,0);const O=new Date(h);O.setHours(23,59,59,999);const[I,q]=await Promise.all([ue.getAllAttendanceEvents(M.toISOString(),O.toISOString()),ue.getUsers()]);r(I),a(q)}catch(M){console.error("Failed to fetch tracking data",M)}finally{l(!1)}},[c,h]);E.useEffect(()=>{j()},[j]);const T=E.useMemo(()=>{let M=t;x!=="all"&&(M=M.filter(I=>I.userId===x));const O=new Map(s.map(I=>[I.id,I]));return M.map(I=>({...I,userName:O.get(I.userId)?.name||"Unknown User"})).sort((I,q)=>new Date(q.timestamp).getTime()-new Date(I.timestamp).getTime())},[t,s,x]),P=E.useMemo(()=>{const M=new Set(T.map(O=>O.userId));return s.filter(O=>M.has(O.id))},[T,s]),D=()=>o?i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):n==="map"?i.jsx(Yde,{events:T,users:P}):n==="route"?x==="all"?i.jsx("div",{className:"text-center py-10 text-muted",children:"Please select a specific user to view their route coverage."}):i.jsx(Gde,{events:T,selectedUser:x}):w?i.jsx("div",{className:"space-y-3",children:T.length===0?i.jsx("div",{className:"text-center py-10 text-muted",children:"No events found."}):T.map(M=>i.jsx(Zde,{event:M},M.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"User"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Event"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Timestamp"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Location"})]})}),i.jsx("tbody",{children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No events found."})}):T.map(M=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"User",className:"px-6 py-4 whitespace-nowrap font-medium",children:M.userName}),i.jsx("td",{"data-label":"Event",className:"px-6 py-4 whitespace-nowrap capitalize",children:M.type.replace("-"," ")}),i.jsx("td",{"data-label":"Timestamp",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:$e(new Date(M.timestamp),"dd MMM, yyyy - hh:mm a")}),i.jsx("td",{"data-label":"Location",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:M.latitude&&M.longitude?i.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${M.latitude},${M.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center md:justify-start justify-end text-accent hover:underline",children:[i.jsx(Tl,{className:"h-4 w-4 mr-1"})," View on Map"]}):"-"})]},M.id))})]})});return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text flex-shrink-0",children:"User Activity Tracking"}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto justify-end flex-wrap",children:[i.jsx("div",{className:"w-full sm:w-40",children:i.jsx(kn,{label:"",id:"start-date",value:c,onChange:d})}),i.jsx("div",{className:"w-full sm:w-40",children:i.jsx(kn,{label:"",id:"end-date",value:h,onChange:p})}),i.jsx("div",{className:"w-full sm:w-48",children:i.jsxs(Ke,{label:"",id:"user-select",value:x,onChange:M=>v(M.target.value),children:[i.jsx("option",{value:"all",children:"All Users"}),_.map(M=>i.jsx("option",{value:M.id,children:M.name},M.id))]})})]})]}),i.jsx("div",{className:"mt-4",children:i.jsxs("div",{className:"bg-page p-1 rounded-full flex items-center w-fit",children:[i.jsxs("button",{onClick:()=>e("list"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="list"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(TJ,{className:"h-4 w-4"}),"List View"]}),i.jsxs("button",{onClick:()=>e("map"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="map"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(d3,{className:"h-4 w-4"}),"Map View"]}),i.jsxs("button",{onClick:()=>e("route"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="route"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(AJ,{className:"h-4 w-4"}),"Route View"]})]})})]}),i.jsx("div",{className:"mt-6",children:D()})]})},Jde=(n,e,t,r)=>{const a=n*Math.PI/180,o=t*Math.PI/180,l=(t-n)*Math.PI/180,c=(r-e)*Math.PI/180,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},Qde=()=>{const{user:n}=jt(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState(""),[l,c]=E.useState("100"),[d,h]=E.useState(""),[p,x]=E.useState(""),[v,w]=E.useState(""),[_,j]=E.useState(""),[T,P]=E.useState([]),[D,M]=E.useState(!0),[O,I]=E.useState(null),[q,F]=E.useState(null);E.useEffect(()=>{(async()=>{try{const[X,Z]=await Promise.all([ue.getLocations(),ue.getUsers()]);t(X),s(Z)}catch(X){console.error(X),I({message:"Failed to load locations or users.",type:"error"})}finally{M(!1)}})()},[]);const V=ot.useMemo(()=>{const ee=new Map;return r.forEach(X=>ee.set(X.id,X.name)),ee},[r]),U=async()=>{try{const ee=await ue.getLocations();t(ee)}catch(ee){console.error(ee),I({message:"Failed to refresh locations.",type:"error"})}},W=async()=>{try{const ee=await iy(),{latitude:X,longitude:Z}=ee.coords;h(X.toString()),x(Z.toString());try{const oe=await hm(X,Z);v||w(oe),a||o(oe)}catch(oe){console.warn("Reverse geocode failed",oe)}}catch(ee){console.error(ee),I({message:"Unable to retrieve current location.",type:"error"})}},$=async()=>{const ee=parseFloat(l),X=parseFloat(d),Z=parseFloat(p);if(isNaN(ee)||ee<10||ee>1e3){I({message:"Radius must be between 10 and 1000 meters.",type:"error"});return}if(isNaN(X)||isNaN(Z)){I({message:"Please provide valid latitude and longitude.",type:"error"});return}try{const oe=v||await hm(X,Z);if(!q&&e.some(Q=>Jde(X,Z,Q.latitude,Q.longitude)<10)){I({message:"A location already exists at these coordinates. Please use a different location.",type:"error"});return}q?(await ue.updateLocation(q,{name:a||oe,latitude:X,longitude:Z,radius:ee,address:oe}),I({message:"Location updated successfully.",type:"success"}),F(null)):(await ue.createLocation({name:a||oe,latitude:X,longitude:Z,radius:ee,address:oe,createdBy:n?.id||null}),I({message:"Location created successfully.",type:"success"})),o(""),c("100"),h(""),x(""),w(""),await U()}catch(oe){console.error(oe);const H=oe?.message||(q?"Failed to update location.":"Failed to create location.");I({message:H,type:"error"})}},ne=async()=>{if(!_||T.length===0){I({message:"Please select a user and at least one location.",type:"error"});return}try{await Promise.all(T.map(ee=>ue.assignLocationToUser(_,ee))),I({message:"Location(s) assigned to user.",type:"success"}),j(""),P([])}catch(ee){console.error(ee),I({message:"Failed to assign location(s).",type:"error"})}},Y=ee=>{F(ee.id),o(ee.name||""),c(ee.radius.toString()),h(ee.latitude.toString()),x(ee.longitude.toString()),w(ee.address||""),window.scrollTo({top:0,behavior:"smooth"})},ae=()=>{F(null),o(""),c("100"),h(""),x(""),w("")},J=async ee=>{if(window.confirm("Are you sure you want to delete this location? This will remove it from all users and the database."))try{await ue.deleteLocation(ee),I({message:"Location deleted successfully from all users and database.",type:"success"}),await U()}catch(X){console.error(X);const Z=X?.message||"Failed to delete location.";I({message:Z,type:"error"})}};return i.jsxs("div",{className:"p-4 md:p-6 w-full",children:[O&&i.jsx(ht,{message:O.message,type:O.type,onDismiss:()=>I(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx(Qi,{title:"Location Management"}),i.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Define geofenced locations and assign them to staff. Only checkins within these locations will be accepted."})]}),i.jsxs("div",{className:"mt-6 space-y-6",children:[i.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Tl,{className:"h-5 w-5 mr-2 text-muted"})," ",q?"Edit Location":"Add New Location"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(je,{label:"Name (optional)",id:"locName",value:a,onChange:ee=>o(ee.target.value),placeholder:"e.g. Office HQ"}),i.jsx(je,{label:"Radius (meters)",id:"locRadius",type:"number",value:l,onChange:ee=>c(ee.target.value),min:"10",max:"1000"}),i.jsx(je,{label:"Latitude",id:"locLat",type:"number",value:d,onChange:ee=>h(ee.target.value),placeholder:"12.9716"}),i.jsx(je,{label:"Longitude",id:"locLng",type:"number",value:p,onChange:ee=>x(ee.target.value),placeholder:"77.5946"}),i.jsx(je,{label:"Address (optional)",id:"locAddr",value:v,onChange:ee=>w(ee.target.value),placeholder:"Street, City, State"})]}),i.jsxs("div",{className:"flex flex-wrap mt-4 gap-4",children:[i.jsxs(se,{variant:"secondary",onClick:W,children:[i.jsx(u3,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),q?i.jsxs(i.Fragment,{children:[i.jsxs(se,{onClick:$,children:[i.jsx(Ss,{className:"h-4 w-4 mr-2"})," Save Changes"]}),i.jsx(se,{variant:"secondary",onClick:ae,children:"Cancel"})]}):i.jsxs(se,{onClick:$,children:[i.jsx(Bt,{className:"h-4 w-4 mr-2"})," Add Location"]})]})]}),i.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Gi,{className:"h-5 w-5 mr-2 text-muted"})," Assign Location to User"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs(Ke,{label:"Select User",id:"assignUser",value:_,onChange:ee=>j(ee.target.value),children:[i.jsx("option",{value:"",children:"-- Select User --"}),r.map(ee=>i.jsx("option",{value:ee.id,children:ee.name},ee.id))]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Select Location(s)"}),i.jsx("div",{className:"border border-border rounded-lg p-3 max-h-48 overflow-y-auto bg-page",children:e.length===0?i.jsx("p",{className:"text-muted text-sm",children:"No locations available."}):e.map(ee=>i.jsxs("label",{className:"flex items-center justify-start gap-2 py-1 text-sm",children:[i.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-accent border-gray-300 rounded",checked:T.includes(ee.id),onChange:X=>{P(Z=>X.target.checked?[...Z,ee.id]:Z.filter(oe=>oe!==ee.id))}}),i.jsx("span",{children:ee.name||ee.address||`${ee.latitude.toFixed(4)}, ${ee.longitude.toFixed(4)}`})]},ee.id))})]})]}),i.jsx("div",{className:"flex justify-end mt-4",children:i.jsxs(se,{onClick:ne,className:"w-full md:w-auto",children:[i.jsx(Ss,{className:"h-4 w-4 mr-2"})," Assign"]})})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-xl font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Tl,{className:"h-5 w-5 mr-2 text-muted"})," Existing Locations"]}),D?i.jsx("p",{children:"Loading..."}):e.length===0?i.jsx("p",{className:"text-muted text-center md:text-left",children:"No locations defined yet."}):i.jsxs("div",{className:"space-y-4 md:space-y-0",children:[i.jsx("div",{className:"md:hidden space-y-4",children:e.map(ee=>i.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-primary-text",children:ee.name||"Unnamed Location"}),i.jsx("p",{className:"text-sm text-muted",children:ee.address})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-500 hover:text-blue-700 p-1",title:"Edit",onClick:()=>Y(ee),children:i.jsx(cr,{className:"h-5 w-5"})}),i.jsx("button",{type:"button",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",title:"Delete",onClick:()=>J(ee.id),children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Radius"}),i.jsxs("p",{children:[ee.radius,"m"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Coordinates"}),i.jsxs("p",{children:[ee.latitude.toFixed(4),", ",ee.longitude.toFixed(4)]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Created By"}),i.jsx("p",{children:ee.createdByName||V.get(ee.createdBy||"")||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Created At"}),i.jsx("p",{children:ee.createdAt?new Date(ee.createdAt).toLocaleDateString():"-"})]})]})]},ee.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[i.jsx("thead",{className:"bg-page text-primary-text",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created By"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created At"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),i.jsx("tbody",{children:e.map(ee=>i.jsxs("tr",{className:"border-b border-border",children:[i.jsx("td",{className:"p-3",children:ee.name||"-"}),i.jsx("td",{className:"p-3",children:ee.radius}),i.jsxs("td",{className:"p-3",children:[ee.latitude.toFixed(4),", ",ee.longitude.toFixed(4)]}),i.jsx("td",{className:"p-3",children:ee.address||"-"}),i.jsx("td",{className:"p-3",children:ee.createdByName||V.get(ee.createdBy||"")||"-"}),i.jsx("td",{className:"p-3",children:ee.createdAt?new Date(ee.createdAt).toLocaleString():"-"}),i.jsxs("td",{className:"p-3 whitespace-nowrap",children:[i.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-800 mr-3",title:"Edit",onClick:()=>Y(ee),children:i.jsx(cr,{className:"h-4 w-4"})}),i.jsx("button",{type:"button",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",title:"Delete",onClick:()=>J(ee.id),children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]},ee.id))})]})})]})]})]})]})},Xde=({isOpen:n,onClose:e,onOverride:t,employeeName:r,bankName:s,reason:a})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",children:[i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10 flex items-center justify-center rounded-full bg-red-100",children:i.jsx(Da,{className:"h-6 w-6 text-red-600"})}),i.jsxs("div",{className:"ml-4 flex-1",children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Verification Alert: Name Mismatch Found"}),i.jsxs("div",{className:"mt-2 text-sm text-muted space-y-2",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name on ID:"}),' "',r,'"']}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name on Bank Proof:"}),' "',s,'"']}),a&&i.jsxs("p",{className:"mt-2 p-2 bg-page rounded-md",children:[i.jsx("strong",{children:"AI Analysis:"})," ",i.jsx("em",{children:a})]}),i.jsx("p",{className:"mt-2",children:"Please upload the correct documents. If the names are different for a valid reason (e.g., maiden name), you can override this warning, but it will require manual verification by an administrator."})]})]})]}),i.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[i.jsx(se,{onClick:t,variant:"danger",children:"Override & Proceed"}),i.jsx(se,{onClick:e,variant:"secondary",children:"Re-upload Documents"})]})]})}):null,eue={documents:{aadhaar:!0,pan:!0,bankProof:!0,educationCertificate:!0,salarySlip:!0,uanProof:!0,familyAadhaar:!0},verifications:{requireBengaluruAddress:!0,requireDobVerification:!0}},tue=n=>{const e=Pt({id:ge().required(),relation:ge().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),phone:ge().when("relation",{is:"Child",then:r=>r.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:r=>r.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:n.documents.familyAadhaar?Wt().nonNullable("Aadhaar proof is required for each family member."):Wt().optional().nullable()}),t=Pt({id:ge().required(),document:n.documents.educationCertificate?Wt().nonNullable("Education certificate is required."):Wt().optional().nullable()});return Pt({photo:Wt().optional().nullable(),aadhaarLinkedMobile:ge().required("Aadhaar-linked mobile number is required.").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),alternateMobile:ge().optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),idProofType:ge().oneOf(["Aadhaar","PAN","Voter ID",""]).required(),idProofFront:Wt().nonNullable("Aadhaar (Front) is required."),idProofBack:Wt().nonNullable("Aadhaar (Back) is required."),bankProof:Wt().nonNullable("Bank proof document is required."),uanProof:Wt().nonNullable("UAN proof document is required."),salarySlip:n.documents.salarySlip?Wt().nonNullable("Salary slip is required."):Wt().optional().nullable(),family:_s().of(e).optional(),education:_s().of(t).optional()}).defined()},Gd=n=>new Promise((e,t)=>{const r=new FileReader;r.readAsDataURL(n),r.onload=()=>e({base64:r.result.split(",")[1],type:n.type}),r.onerror=s=>t(s)}),qh=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",nue=()=>{const n=St(),e=$n(),{user:t}=jt(),{rulesByDesignation:r}=Qc(),[s,a]=E.useState(!1),[o,l]=E.useState(null),[c,d]=E.useState({isOpen:!1,employeeName:"",bankName:"",reason:""}),[h,p]=E.useState(window.innerWidth<768),x=e.data.organization.designation,v=E.useMemo(()=>x&&r[x]?r[x]:eue,[x,r]),w=E.useMemo(()=>tue(v),[v]);E.useEffect(()=>{const Y=()=>p(window.innerWidth<768);return window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]),t?.role;const{control:_,handleSubmit:j,formState:{errors:T},getValues:P,watch:D}=tn({resolver:En(w),defaultValues:{aadhaarLinkedMobile:"",alternateMobile:"",photo:null,idProofType:"Aadhaar",idProofFront:null,idProofBack:null,bankProof:null,salarySlip:null,uanProof:null,family:[],education:[]}}),{fields:M,append:O,remove:I}=js({control:_,name:"family"}),{fields:q,append:F,remove:V}=js({control:_,name:"education"});D("idProofType");const U=D("family"),W=async(Y,ae=!1)=>{a(!0),e.setRequiresManualVerification(ae);try{const J={type:et.OBJECT,properties:{name:{type:et.STRING,description:"The person's full name as written on the card."},dob:{type:et.STRING,description:"The person's date of birth in YYYY-MM-DD format. If only year available, return YYYY-01-01."},gender:{type:et.STRING,description:"Gender: 'Male', 'Female', or 'Other'."},aadhaarNumber:{type:et.STRING,description:"The 12-digit Aadhaar number, if present."},panNumber:{type:et.STRING,description:"The 10-character PAN number, if present."},voterIdNumber:{type:et.STRING,description:"The Voter ID number, also known as EPIC number."}}},ee={type:et.OBJECT,properties:{address:{type:et.OBJECT,description:"The full address on the back of an Aadhaar card, parsed into components.",properties:{line1:{type:et.STRING,description:"Full address line(s) excluding city, state, pincode. e.g., 'S/O: John Doe, 123 Maple Street, Anytown'"},city:{type:et.STRING},state:{type:et.STRING},pincode:{type:et.STRING}}}}},X={type:et.OBJECT,properties:{accountHolderName:{type:et.STRING,description:"The account holder's full name."},accountNumber:{type:et.STRING,description:"The full bank account number."},ifscCode:{type:et.STRING,description:"The bank's IFSC code."},bankName:{type:et.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:et.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}}},Z={type:et.OBJECT,properties:{uanNumber:{type:et.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:et.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:et.STRING,description:"The 10 or 17-digit ESI number."}}},oe={type:et.OBJECT,properties:{uanNumber:{type:et.STRING}}},H={type:et.OBJECT,properties:{name:{type:et.STRING},dob:{type:et.STRING}}},Q={type:et.OBJECT,properties:{degree:{type:et.STRING},institution:{type:et.STRING},endYear:{type:et.STRING}}},re=[Y.idProofFront?Gd(Y.idProofFront.file):Promise.resolve(null),(Y.idProofType==="Aadhaar"||Y.idProofType==="Voter ID")&&Y.idProofBack?Gd(Y.idProofBack.file):Promise.resolve(null),Y.bankProof?Gd(Y.bankProof.file):Promise.resolve(null),Y.salarySlip?Gd(Y.salarySlip.file):Promise.resolve(null),Y.uanProof?Gd(Y.uanProof.file):Promise.resolve(null),...Y.family.map(lt=>lt.idProof?Gd(lt.idProof.file):Promise.resolve(null)),...Y.education.map(lt=>lt.document?Gd(lt.document.file):Promise.resolve(null))],[de,ce,pe,ie,xe,...Ce]=await Promise.all(re),ve=Ce.slice(0,Y.family.length),Oe=Ce.slice(Y.family.length),Pe=de?ue.extractDataFromImage(de.base64,de.type,J,Y.idProofType):Promise.resolve({}),Ie=ce&&Y.idProofType==="Aadhaar"?ue.extractDataFromImage(ce.base64,ce.type,ee,"Aadhaar"):Promise.resolve({}),Fe=pe?ue.extractDataFromImage(pe.base64,pe.type,X,"Bank"):Promise.resolve({}),we=ie?ue.extractDataFromImage(ie.base64,ie.type,Z,"Salary"):Promise.resolve(null),Ne=xe?ue.extractDataFromImage(xe.base64,xe.type,oe,"UAN"):Promise.resolve(null),Ue=ve.map(lt=>lt?ue.extractDataFromImage(lt.base64,lt.type,H,"Aadhaar"):Promise.resolve({})),Be=Oe.map(lt=>lt?ue.extractDataFromImage(lt.base64,lt.type,Q):Promise.resolve({})),[qe,te,le,ye,Ve,...ze]=await Promise.all([Pe,Ie,Fe,we,Ne,...Ue,...Be]),Le=ze.slice(0,ve.length),rt=ze.slice(ve.length),Xe={...qe,...te},tt=Xe.name||"",qt=le.accountHolderName||"";if(!ae&&tt&&qt){const{isMatch:lt,reason:Vn}=await ue.crossVerifyNames(tt,qt);if(!lt){d({isOpen:!0,employeeName:tt,bankName:qt,reason:Vn}),a(!1);return}}const bt={idProofType:Y.idProofType,idProofFront:Y.idProofFront,idProofBack:Y.idProofBack,photo:Y.photo,mobile:Y.aadhaarLinkedMobile,alternateMobile:Y.alternateMobile},Et={};if(Xe.name){const lt=Xe.name.split(" ");bt.firstName=qh(lt.shift()||""),bt.lastName=qh(lt.pop()||""),bt.middleName=qh(lt.join(" ")),bt.preferredName=bt.firstName,Et.name=!0}if(Xe.dob)try{bt.dob=$e(new Date(Xe.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd"),Et.dob=!0}catch{}if(Xe.gender){const lt=Xe.gender.toLowerCase().trim();lt.includes("male")||lt.includes("purush")||lt==="m"?bt.gender="Male":lt.includes("female")||lt.includes("mahila")||lt==="f"?bt.gender="Female":lt.includes("transgender")&&(bt.gender="Other")}(Xe.aadhaarNumber||Xe.panNumber||Xe.voterIdNumber)&&(bt.idProofNumber=(Xe.aadhaarNumber||Xe.panNumber||Xe.voterIdNumber).replace(/\s/g,""),Et.idProofNumber=!0);const Xt={bankProof:Y.bankProof},en={};if(le.accountHolderName&&(Xt.accountHolderName=qh(le.accountHolderName),en.accountHolderName=!0),le.accountNumber){const lt=le.accountNumber.replace(/\D/g,"");Xt.accountNumber=lt,Xt.confirmAccountNumber=lt,en.accountNumber=!0}le.ifscCode&&(Xt.ifscCode=le.ifscCode.toUpperCase().replace(/\s/g,""),en.ifscCode=!0),le.bankName&&(Xt.bankName=le.bankName),le.branchName&&(Xt.branchName=le.branchName);const Yt={salarySlip:Y.salarySlip,document:Y.uanProof},Ut={},Rn={},Nn={},an=Ve?.uanNumber||ye?.uanNumber;if(an){const lt=an.replace(/\D/g,"");lt.length===12&&(Yt.uanNumber=lt,Yt.hasPreviousPf=!0,Rn.uanNumber=!0)}if(ye?.pfNumber&&(Yt.pfNumber=ye.pfNumber,Yt.hasPreviousPf=!0),ye?.esiNumber){const lt=ye.esiNumber.replace(/\D/g,"");(lt.length===10||lt.length===17)&&(Ut.esiNumber=lt,Ut.hasEsi=!0,Nn.esiNumber=!0)}const rr=Le.map((lt,Vn)=>{const br=Y.family[Vn];let vn="";if(lt.dob)try{vn=$e(new Date(lt.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd")}catch{}return{id:`fam_preupload_${Date.now()}_${Vn}`,relation:br.relation,name:qh(lt.name)||"",dob:vn,gender:"",occupation:"",dependent:!1,idProof:br.idProof,phone:br.phone}}),Hn=rt.map((lt,Vn)=>{const br=Y.education[Vn];return{id:`edu_preupload_${Date.now()}_${Vn}`,degree:lt.degree||"",institution:lt.institution||"",startYear:"",endYear:lt.endYear||"",document:br.document}});Xe.address&&e.updateAddress({present:{...Xe.address,country:"India",verifiedStatus:{line1:!0,city:!0,state:!0,pincode:!0,country:!0}},permanent:{...Xe.address,country:"India"},sameAsPresent:!0}),e.updateBank(Xt),e.setBankVerifiedStatus(en),e.updateUan(Yt),e.setUanVerifiedStatus(Rn),e.updateEsi(Ut),e.setEsiVerifiedStatus(Nn),e.updateFamily(rr),e.updateEducation(Hn),e.updatePersonal(bt),e.setPersonalVerifiedStatus(Et),l({message:"Application auto-filled! Please review.",type:"success"}),n("/onboarding/add/personal")}catch(J){const ee=J instanceof Error?J.message:"An unexpected error occurred.";console.error("Document processing failed:",J),l({message:`Document processing failed: ${ee}`,type:"error"}),a(!1)}},$=Y=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),W(Y,!1)},ne=()=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),W(P(),!0)};return i.jsxs("div",{className:"relative",children:[s&&i.jsxs("div",{className:"absolute inset-0 bg-page/90 backdrop-blur-sm z-10 flex flex-col items-center justify-center rounded-xl animate-fade-in-scale",children:[i.jsx(_t,{className:"h-12 w-12 animate-spin text-accent"}),i.jsx("p",{className:"mt-4 text-lg font-semibold text-primary-text",children:"Processing Documents..."}),i.jsx("p",{className:"text-muted text-center max-w-xs",children:"Our AI is analyzing your files. This may take a moment."})]}),i.jsxs("div",{className:`bg-card p-8 rounded-xl shadow-card w-full transition-all ${s?"blur-sm pointer-events-none":""}`,children:[i.jsx(Xde,{...c,onClose:()=>d({isOpen:!1,employeeName:"",bankName:"",reason:""}),onOverride:ne}),i.jsxs("form",{onSubmit:j($),children:[i.jsx(Pr,{title:"Document Collection",subtitle:"Upload documents to auto-fill the application."}),i.jsxs("div",{className:"space-y-8 mt-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(_e,{name:"photo",control:_,render:({field:Y})=>i.jsx(yt,{label:"Profile Photo",file:Y.value,onFileChange:Y.onChange,allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsx(_e,{name:"aadhaarLinkedMobile",control:_,render:({field:Y,fieldState:ae})=>i.jsx(je,{label:"Aadhaar Linked Mobile Number",type:"tel",...Y,error:ae.error?.message})}),i.jsx(_e,{name:"alternateMobile",control:_,render:({field:Y,fieldState:ae})=>i.jsx(je,{label:"Alternative Mobile Number (Optional)",type:"tel",...Y,error:ae.error?.message})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(_e,{name:"idProofFront",control:_,render:({field:Y})=>i.jsx(yt,{label:"Aadhaar (Front Side)",file:Y.value,onFileChange:Y.onChange,error:T.idProofFront?.message,allowCapture:!0,verificationStatus:e.data.personal.verifiedStatus?.idProofNumber})}),i.jsx(_e,{name:"idProofBack",control:_,render:({field:Y})=>i.jsx(yt,{label:"Aadhaar (Back Side)",file:Y.value,onFileChange:Y.onChange,error:T.idProofBack?.message,allowCapture:!0,verificationStatus:e.data.personal.verifiedStatus?.idProofNumber})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(_e,{name:"bankProof",control:_,render:({field:Y})=>i.jsx(yt,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:Y.value,onFileChange:Y.onChange,error:T.bankProof?.message,allowCapture:!0,verificationStatus:e.data.bank.verifiedStatus?.accountNumber})}),i.jsx(_e,{name:"uanProof",control:_,render:({field:Y})=>i.jsx(yt,{label:"UAN Proof Document",file:Y.value,onFileChange:Y.onChange,error:T.uanProof?.message,allowCapture:!0,verificationStatus:e.data.uan.verifiedStatus?.uanNumber})})]}),v.documents.salarySlip&&i.jsx(_e,{name:"salarySlip",control:_,render:({field:Y})=>i.jsx(yt,{label:"Latest Salary Slip",file:Y.value,onFileChange:Y.onChange,error:T.salarySlip?.message,allowCapture:!0})}),v.documents.educationCertificate&&i.jsxs("div",{className:"pt-6 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[q.map((Y,ae)=>i.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 relative",children:[i.jsx(_e,{name:`education.${ae}.document`,control:_,render:({field:J,fieldState:ee})=>i.jsx(yt,{label:"Certificate",file:J.value,onFileChange:J.onChange,error:ee.error?.message,allowCapture:!0})}),i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>V(ae),className:"!absolute top-2 right-2",children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]},Y.id)),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>F({id:`edu_upload_${Date.now()}`,document:null}),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Certificate"]})]})]}),v.documents.familyAadhaar&&i.jsxs("div",{className:"pt-6 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[M.map((Y,ae)=>{const ee=U?.[ae]?.relation==="Child";return i.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 grid grid-cols-1 md:grid-cols-3 gap-4 items-start relative",children:[i.jsx(_e,{name:`family.${ae}.relation`,control:_,render:({field:X,fieldState:Z})=>i.jsxs(Ke,{label:"Relation",error:Z.error?.message,...X,children:[" ",i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})," "]})}),i.jsx(_e,{name:`family.${ae}.phone`,control:_,render:({field:X,fieldState:Z})=>i.jsx(je,{label:`Phone Number${ee?" (Optional)":""}`,type:"tel",...X,error:Z.error?.message})}),i.jsx("div",{className:"md:col-start-1 md:col-span-3",children:i.jsx(_e,{name:`family.${ae}.idProof`,control:_,render:({field:X,fieldState:Z})=>i.jsx(yt,{label:"Aadhaar Card",file:X.value,onFileChange:X.onChange,error:Z.error?.message,allowCapture:!0})})}),i.jsx(se,{type:"button",variant:"icon",size:"sm",onClick:()=>I(ae),className:"!absolute top-2 right-2",children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]},Y.id)}),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>O({id:`fam_upload_${Date.now()}`,relation:"",idProof:null,phone:""}),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-between items-center gap-4",children:[i.jsxs(se,{type:"button",variant:"secondary",onClick:()=>n(-1),children:[i.jsx(Ra,{className:"mr-2 h-4 w-4"})," Back"]}),i.jsx(se,{type:"submit",isLoading:s,children:"Process"})]})]})]})]})},rue=({count:n=3})=>i.jsx("div",{className:"space-y-2.5",children:Array.from({length:n}).map((e,t)=>i.jsxs("div",{className:"bg-[#041b0f] md:bg-[#243524] p-3 rounded-xl flex gap-4 items-start border border-transparent",children:[i.jsx(Hr,{className:"w-12 h-12 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"flex-grow space-y-2 mt-1",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx(Hr,{className:"h-4 w-1/2"}),i.jsx(Hr,{className:"h-5 w-20 rounded-full"})]}),i.jsx(Hr,{className:"h-3 w-1/3"}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[i.jsx(Hr,{className:"h-3 w-20"}),i.jsx(Hr,{className:"h-3 w-20"}),i.jsx(Hr,{className:"h-3 w-20"}),i.jsx(Hr,{className:"h-3 w-20"})]})]})]},t))}),tx=({label:n,checked:e})=>i.jsxs("div",{className:"flex items-center gap-1.5",children:[e?i.jsx(vm,{className:"h-4 w-4 text-emerald-400"}):i.jsx(p3,{className:"h-4 w-4 text-gray-500"}),i.jsx("span",{className:e?"text-gray-300":"text-gray-500",children:n})]}),sue=({submission:n})=>{const{esiCtcThreshold:e}=Qc(),t=E.useMemo(()=>{const{personal:r,uan:s,esi:a,gmc:o}=n,l=r.salary!=null&&r.salary<=e;let c=!1;return l?c=!a.hasEsi||a.hasEsi&&!!a.esiNumber:o.isOptedIn===!0?c=!0:o.isOptedIn===!1&&(c=!!o.gmcPolicyCopy&&!!o.declarationAccepted),{aadhaar:!!r.idProofFront,uan:!s.hasPreviousPf||s.hasPreviousPf&&!!s.uanNumber,pf:!s.hasPreviousPf||s.hasPreviousPf&&!!s.uanNumber,esiGmc:c}},[n,e]);return i.jsx(Ma,{to:`/onboarding/add/personal?id=${n.id}`,className:"block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-xl",children:i.jsxs("div",{className:"bg-[#041b0f] md:bg-[#243524] p-3 rounded-xl flex gap-4 items-start border border-transparent hover:border-emerald-500 transition-colors duration-200",children:[i.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 border-2 border-gray-600",children:i.jsx($i,{photoUrl:n.personal.photo?.preview,seed:n.id})}),i.jsxs("div",{className:"flex-grow",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx("p",{className:"font-semibold text-green-400",children:`${n.personal.firstName} ${n.personal.lastName}`}),i.jsx("div",{className:"flex-shrink-0",children:i.jsx(UC,{status:n.status})})]}),i.jsx("p",{className:"text-sm text-gray-400",children:n.personal.mobile}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[i.jsx(tx,{label:"Aadhaar",checked:t.aadhaar}),i.jsx(tx,{label:"UAN",checked:t.uan}),i.jsx(tx,{label:"PF",checked:t.pf}),i.jsx(tx,{label:"ESI / GMC",checked:t.esiGmc})]})]})]})})},iue=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState("in-progress"),[o,l]=E.useState(""),[c,d]=E.useState(null),h=St(),p=E.useRef(null);E.useEffect(()=>{(async()=>{r(!0);try{const T=await ue.getVerificationSubmissions();e(T)}catch{d({message:"Failed to load submissions.",type:"error"})}finally{r(!1)}})()},[]);const x=E.useMemo(()=>{const j={"in-progress":["pending","draft","rejected"],existing:["verified"]};return n.filter(T=>j[s].includes(T.status)).filter(T=>`${T.personal.firstName} ${T.personal.lastName}`.toLowerCase().includes(o.toLowerCase())||T.personal.mobile?.toLowerCase().includes(o.toLowerCase()))},[n,s,o]),v=()=>{h("/onboarding/select-organization")},w=()=>{p.current?.focus()},_=[{key:"in-progress",label:"IN PROGRESS"},{key:"existing",label:"EXISTING"}];return i.jsxs("div",{className:"h-full flex flex-col bg-[#041b0f] text-white",children:[c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header sticky top-0 z-10 bg-[#041b0f]/80 backdrop-blur-sm border-b border-[#374151]",children:[i.jsx("button",{onClick:()=>h("/onboarding"),"aria-label":"Go back",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(Ra,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-lg font-semibold",children:"On Boarding"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:w,"aria-label":"Search employee",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(Ea,{className:"h-6 w-6"})}),i.jsx("button",{onClick:v,"aria-label":"Add new employee",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx($c,{className:"h-6 w-6"})}),i.jsx("button",{onClick:()=>h("/profile"),"aria-label":"Exit to profile",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(xi,{className:"h-6 w-6"})})]})]}),i.jsx("div",{className:"px-4 pt-4 pb-3 flex-shrink-0",children:i.jsx("div",{className:"flex",children:_.map(j=>i.jsx("button",{onClick:()=>a(j.key),className:`flex-1 py-2 text-sm font-semibold uppercase tracking-wider transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-sm ${s===j.key?"border-b-2 border-emerald-400 text-emerald-400":"border-b-2 border-transparent text-gray-400 hover:text-white"}`,children:j.label},j.key))})}),i.jsxs("main",{className:"flex-1 overflow-y-auto px-4 space-y-2.5 pb-24",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-500"}),i.jsx("input",{ref:p,type:"text",placeholder:"Search by name or number...",value:o,onChange:j=>l(j.target.value),className:"form-input w-full !pl-10 !h-12 !rounded-md"})]}),t?i.jsx("div",{className:"pt-4",children:i.jsx(rue,{count:3})}):x.length>0?i.jsx("div",{className:"space-y-2.5",children:x.map(j=>i.jsx(sue,{submission:j},j.id))}):i.jsx("div",{className:"text-center pt-16 text-gray-500",children:i.jsxs("p",{children:["No ",s.replace("-"," ")," submissions found."]})})]})]})},aue=({status:n})=>{const e={"To Do":"bg-gray-500","In Progress":"bg-blue-500",Done:"bg-green-600"};return i.jsx("span",{className:`fo-status-badge ${e[n]}`,children:n})},oue=()=>{const{user:n}=jt(),[e,t]=E.useState("tasks"),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0);E.useEffect(()=>{if(!n)return;(async()=>{c(!0);try{const[p,x]=await Promise.all([ue.getTasks(),ue.getNotifications(n.id)]),v=p.filter(w=>w.assignedToId===n.id);s(v),o(x)}catch(p){console.error("Failed to load data for tasks page",p)}finally{c(!1)}})()},[n]);const d=h=>{const p=["HR","Admin","Ops Manager","Site Manager"];return p[h.charCodeAt(h.length-1)%p.length]};return i.jsxs("div",{children:[i.jsx("header",{className:"p-4 flex-shrink-0 text-center fo-mobile-header sticky top-0 bg-[#041b0f]/80 backdrop-blur-sm z-10 border-b border-[#374151]",children:i.jsx("h1",{children:"Tasks"})}),i.jsx("div",{className:"flex-shrink-0 p-4",children:i.jsxs("div",{className:"fo-tabs-container",children:[i.jsx("button",{onClick:()=>t("tasks"),className:`fo-tab-button ${e==="tasks"?"active":""}`,children:"Tasks"}),i.jsx("button",{onClick:()=>t("notifications"),className:`fo-tab-button ${e==="notifications"?"active":""}`,children:"Notifications"})]})}),i.jsx("main",{className:"p-4",children:l?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-muted"})}):e==="tasks"?r.length>0?i.jsx("div",{className:"space-y-4",children:r.map(h=>i.jsxs("div",{className:"fo-task-card",children:[i.jsxs("div",{className:"fo-task-header",children:[i.jsx("p",{className:"fo-task-title",children:h.name}),i.jsx(aue,{status:h.status})]}),i.jsx("p",{className:"text-sm text-gray-400 mb-2",children:h.description}),i.jsxs("div",{className:"fo-task-meta flex justify-between items-center",children:[i.jsxs("span",{children:["Due: ",h.dueDate?$e(new Date(h.dueDate),"dd MMM, yyyy"):"N/A"]}),i.jsxs("span",{children:["Assigned by: ",d(h.id)]})]})]},h.id))}):i.jsxs("div",{className:"text-center text-muted pt-16",children:[i.jsx(kC,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"You have no assigned tasks."})]}):a.length>0?i.jsx("div",{className:"divide-y divide-border",children:a.map(h=>i.jsxs("div",{className:"fo-notification-item",children:[i.jsx(Pf,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("p",{className:"text-sm text-gray-300",children:h.message}),i.jsx("p",{className:"text-xs text-muted mt-1",children:cu(new Date(h.createdAt),{addSuffix:!0})})]})]},h.id))}):i.jsxs("div",{className:"text-center text-muted pt-16",children:[i.jsx(Pf,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"You have no notifications."})]})})]})},lue=({status:n})=>{const e={Pending:"bg-yellow-900/50 text-yellow-300 border border-yellow-500/50",Approved:"bg-blue-900/50 text-blue-300 border border-blue-500/50",Issued:"bg-green-900/50 text-green-300 border border-green-500/50",Rejected:"bg-red-900/50 text-red-300 border border-red-500/50"};return i.jsx("span",{className:`fo-status-badge ${e[n]}`,children:n})},nx=({title:n,sizes:e,headers:t,control:r,quantityType:s})=>{const a=Array.from(new Set(e.map(l=>l.fit))),o=Array.from(new Set(e.map(l=>l.size))).sort((l,c)=>{const d=parseInt(String(l)),h=parseInt(String(c));return!isNaN(d)&&!isNaN(h)?d-h:String(l).localeCompare(String(c))});return i.jsxs("div",{className:"border border-border rounded-lg",children:[i.jsx("h4",{className:"p-3 font-semibold bg-accent text-white border-b border-accent",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:"Size"}),t.map(l=>i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:l.label},String(l.key))),i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted w-24",children:"Quantity"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:o.map(l=>i.jsx(ot.Fragment,{children:a.map((c,d)=>{const h=e.find(p=>p.size===l&&p.fit===c);return h?i.jsxs("tr",{children:[d===0&&i.jsx("td",{rowSpan:a.filter(p=>e.some(x=>x.size===l&&x.fit===p)).length,className:"px-3 py-2 align-middle font-semibold border-r",children:l}),t.map(p=>i.jsx("td",{className:"px-3 py-2",children:h[p.key]},String(p.key))),i.jsx("td",{className:"px-3 py-2",children:i.jsx(_e,{name:`${s}.${h.id}`,control:r,render:({field:p})=>i.jsx(je,{"aria-label":`Quantity for ${n} size ${l} ${c}`,type:"number",...p,value:p.value||"",onChange:x=>p.onChange(parseInt(x.target.value)||null),className:"!py-1.5"})})})]},h.id):null})},l))})]})})]})},cue=({onSave:n,onCancel:e,sites:t,masterUniforms:r,initialData:s})=>{const{register:a,control:o,handleSubmit:l,watch:c,reset:d}=tn({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),{data:h}=$n(),{user:p}=jt(),x=c("gender"),v=c("siteId");E.useEffect(()=>{if(s){const _={},j={};s.items.forEach(T=>{T.category==="Pants"?_[T.sizeId]=T.quantity:j[T.sizeId]=T.quantity}),d({siteId:s.siteId,gender:s.gender,pantsQuantities:_,shirtsQuantities:j})}else{const _=h.organization.organizationId||"",T=h.personal.gender==="Female"?"Ladies":"Gents";d({siteId:_,gender:T,pantsQuantities:{},shirtsQuantities:{}})}},[s,d,h]);const w=_=>{const j=t.find(M=>M.id===_.siteId);if(!j||!p)return;const T=x==="Gents"?[...r.gents.pants,...r.gents.shirts]:[...r.ladies.pants,...r.ladies.shirts],P=[];for(const[M,O]of Object.entries(_.pantsQuantities))if(O&&O>0){const I=T.find(q=>q.id===M);I&&P.push({sizeId:M,quantity:O,category:"Pants",sizeLabel:I.size,fit:I.fit})}for(const[M,O]of Object.entries(_.shirtsQuantities))if(O&&O>0){const I=T.find(q=>q.id===M);I&&P.push({sizeId:M,quantity:O,category:"Shirts",sizeLabel:I.size,fit:I.fit})}const D={id:s?.id||`new_${Date.now()}`,siteId:_.siteId,siteName:j.shortName,gender:_.gender,requestedDate:s?.requestedDate||new Date().toISOString(),status:s?.status||"Pending",items:P,source:"Individual",requestedById:p.id,requestedByName:p.name,employeeDetails:[{employeeName:`${h.personal.firstName} ${h.personal.lastName}`,employeeId:h.personal.employeeId,items:P.map(M=>({itemName:M.category,sizeLabel:M.sizeLabel,fit:M.fit,quantity:M.quantity}))}]};n(D)};return i.jsx("form",{onSubmit:l(w),children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(Ke,{label:"Select Site",value:v,...a("siteId"),required:!0,disabled:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),t.map(_=>i.jsx("option",{value:_.id,children:_.shortName},_.id))]}),i.jsxs(Ke,{label:"Select Uniform Type",value:x,...a("gender"),disabled:!0,children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(nx,{title:"Gents' Pants",sizes:r.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(nx,{title:"Gents' Shirts",sizes:r.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(nx,{title:"Ladies' Pants",sizes:r.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(nx,{title:"Ladies' Shirts",sizes:r.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]})}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#374151]",children:[i.jsx(se,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsxs(se,{type:"submit",children:[i.jsx(Ss,{className:"mr-2 h-4 w-4"})," Save Request"]})]})]})})},due=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(null),[c,d]=E.useState(!0),[h,p]=E.useState(null),[x,v]=E.useState(null),[w,_]=E.useState(null),j=St(),[T]=y4(),{updateUniforms:P}=$n(),D=T.get("from")==="onboarding",M=async()=>{d(!0);try{const[U,W,$,ne]=await Promise.all([ue.getUniformRequests(),ue.getOrganizations(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);r(U.sort((Y,ae)=>new Date(ae.requestedDate).getTime()-new Date(Y.requestedDate).getTime())),a(W),l({gents:$,ladies:ne})}catch{p({message:"Failed to load uniform data.",type:"error"})}finally{d(!1)}};E.useEffect(()=>{M()},[]),E.useEffect(()=>{D&&(e("form"),v(null))},[D]);const O=()=>{v(null),e("form")},I=U=>{v(U),e("form")},q=async U=>{if(D&&o){const W=U.gender==="Ladies"?[...o.ladies.pants,...o.ladies.shirts]:[...o.gents.pants,...o.gents.shirts],$=U.items.map(ne=>{const Y=W.find(ee=>ee.id===ne.sizeId),ae=ne.category==="Pants"?`${U.gender}' Pants`:`${U.gender}' Shirts`;return{itemId:`generic_${U.gender.toLowerCase()}_${ne.category==="Pants"?"pants":"shirts"}`,itemName:ae,sizeId:ne.sizeId,sizeLabel:Y?.size||"",fit:Y?.fit||"",quantity:ne.quantity}});P($),await ue.submitUniformRequest(U),j(-1);return}try{U.id.startsWith("new_")?(await ue.submitUniformRequest(U),p({message:"New request submitted.",type:"success"})):(await ue.updateUniformRequest(U),p({message:"Request updated.",type:"success"})),e("list"),M()}catch{p({message:"Failed to save request.",type:"error"})}},F=async()=>{if(w)try{await ue.deleteUniformRequest(w.id),p({message:"Request deleted.",type:"success"}),_(null),M()}catch{p({message:"Failed to delete request.",type:"error"})}},V=U=>U.reduce((W,$)=>W+$.quantity,0);if(c||!o)return i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-muted"})});if(n==="form"){const U=()=>{D?j(-1):e("list")};return i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header",children:[i.jsx("button",{onClick:U,"aria-label":"Go back",children:i.jsx(Ra,{className:"h-6 w-6"})}),i.jsxs("h1",{children:[x?"Edit":"New"," Request"]})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsx(cue,{onSave:q,onCancel:U,sites:s,masterUniforms:o,initialData:x})})]})}return i.jsxs("div",{className:"h-full flex flex-col",children:[h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(Yr,{isOpen:!!w,onClose:()=>_(null),onConfirm:F,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header",children:[i.jsx("h1",{className:"text-lg font-semibold",children:"Uniform Requests"}),i.jsx("button",{onClick:O,"aria-label":"New Uniform Request",children:i.jsx($c,{className:"h-6 w-6"})})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:t.length>0?t.map(U=>i.jsxs("div",{className:"bg-[#243524] p-3 rounded-xl border border-[#374151]",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-white",children:U.siteName}),i.jsx("p",{className:"text-xs text-gray-400",children:$e(new Date(U.requestedDate),"dd MMM, yyyy")})]}),i.jsx(lue,{status:U.status})]}),i.jsxs("div",{className:"mt-3 flex justify-between items-end",children:[i.jsxs("div",{className:"text-sm text-gray-300",children:[i.jsxs("p",{children:[U.gender," Uniforms"]}),i.jsxs("p",{className:"font-semibold",children:[V(U.items)," Items"]})]}),U.status==="Pending"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(se,{variant:"icon",size:"sm",onClick:()=>I(U),children:i.jsx(cr,{className:"h-4 w-4 text-gray-400"})}),i.jsx(se,{variant:"icon",size:"sm",onClick:()=>_(U),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]})]})]},U.id)):i.jsxs("div",{className:"text-center text-muted pt-16",children:[i.jsx(Df,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"No uniform requests found."}),i.jsxs(se,{onClick:O,className:"mt-4",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Create First Request"]})]})})]})},uue=({priority:n})=>{const e={Low:"bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.5)]",Medium:"bg-yellow-500 shadow-[0_0_8px_rgba(234,179,8,0.5)]",High:"bg-orange-500 shadow-[0_0_8px_rgba(249,115,22,0.5)]",Urgent:"bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]"};return i.jsx("span",{className:`w-3 h-3 rounded-full ${e[n]}`,title:`Priority: ${n}`})},fue=({status:n})=>{const e={Open:"bg-emerald-500/10 text-emerald-500 border-emerald-500/20","In Progress":"bg-blue-500/10 text-blue-500 border-blue-500/20","Pending Requester":"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",Resolved:"bg-purple-500/10 text-purple-500 border-purple-500/20",Closed:"bg-gray-500/10 text-gray-500 border-gray-500/20"};return i.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${e[n]}`,children:n})},hue=({ticket:n,onClick:e})=>i.jsxs("div",{onClick:e,className:"group bg-card hover:bg-accent/5 p-5 rounded-xl border border-border hover:border-accent cursor-pointer transition-all duration-300 flex flex-col justify-between h-full shadow-sm hover:shadow-md",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-start gap-3 mb-2",children:[i.jsx("h4",{className:"font-bold text-primary-text leading-snug group-hover:text-accent transition-colors line-clamp-2",children:n.title}),i.jsx("div",{className:"flex-shrink-0 mt-1",children:i.jsx(uue,{priority:n.priority})})]}),i.jsxs("p",{className:"text-xs text-muted font-mono",children:["#",n.ticketNumber]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[i.jsxs("div",{className:"flex justify-between items-center text-xs text-muted mb-3",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-700 flex items-center justify-center text-[10px] text-white font-bold",children:n.raisedByName.charAt(0)}),i.jsx("span",{children:n.raisedByName})]}),i.jsx("span",{children:cu(new Date(n.raisedAt),{addSuffix:!0})})]}),i.jsx("div",{className:"flex justify-between items-center",children:i.jsx(fue,{status:n.status})})]})]}),ZL=({user:n,onAction:e})=>i.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-card border border-border hover:border-accent/50 transition-colors",children:[i.jsxs("div",{className:"relative",children:[i.jsx($i,{photoUrl:n.photoUrl,seed:n.id,className:"w-12 h-12 rounded-full shadow-sm"}),i.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ${n.isAvailable?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":"bg-rose-600 shadow-[0_0_6px_rgba(225,29,72,0.6)]"} ring-2 ring-white`})]}),i.jsxs("div",{className:"flex-grow min-w-0",children:[i.jsx("p",{className:"text-sm font-bold text-primary-text truncate",children:n.name}),i.jsx("p",{className:"text-xs text-muted truncate",children:n.role.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(se,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Call",onClick:()=>e(n.phone),children:i.jsx(Ef,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Message",onClick:()=>e(n.phone),children:i.jsx(gm,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Video",onClick:()=>e(n.phone),children:i.jsx(y3,{className:"h-4 w-4"})})]})]}),mue=()=>{const n=St(),{user:e}=jt(),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(!0),[c,d]=E.useState(null),[h,p]=E.useState("All"),[x,v]=E.useState("All"),[w,_]=E.useState(""),[j,T]=E.useState(!1),[P,D]=E.useState(!1),M=Ft("(max-width: 767px)"),[O,I]=E.useState({status:"all",priority:"all",searchTerm:""});E.useEffect(()=>{(async()=>{if(e){l(!0);try{const[$,ne]=await Promise.all([ue.getSupportTickets(),ue.getNearbyUsers()]);r($),a(ne.filter(Y=>Y.id!==e.id))}catch{d({message:"Failed to load support data.",type:"error"})}finally{l(!1)}}})()},[e]);const q=E.useMemo(()=>t.filter(W=>{const $=O.status==="all"||W.status===O.status,ne=O.priority==="all"||W.priority===O.priority,Y=O.searchTerm===""||W.title.toLowerCase().includes(O.searchTerm.toLowerCase())||W.ticketNumber.toLowerCase().includes(O.searchTerm.toLowerCase())||W.description.toLowerCase().includes(O.searchTerm.toLowerCase());return $&&ne&&Y}),[t,O]),F=E.useMemo(()=>{const W=t.filter($=>$.status==="Resolved"&&$.raisedById===e?.id);return{open:t.filter($=>$.status==="Open").length,inProgress:t.filter($=>$.status==="In Progress").length,pendingYourAction:W.length}},[t,e]),V=W=>{if(!W){d({message:"User does not have a phone number.",type:"error"});return}let $=W.replace(/\D/g,"");if($.length>10&&($=$.slice(-10)),$.length!==10){d({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${$}`,"_blank")},U=({title:W,value:$,icon:ne,colorClass:Y})=>i.jsxs("div",{className:"bg-transparent p-5 rounded-2xl flex items-center justify-between transition-all",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted mb-1",children:W}),i.jsx("p",{className:`text-3xl font-bold ${Y.replace("bg-","text-").split(" ")[0]}`,children:$})]}),i.jsx("div",{className:`p-3 rounded-full bg-opacity-10 ${Y.replace("text-","bg-")} ${Y}`,children:ne})]});return i.jsxs("div",{className:"w-full p-4 lg:p-8 space-y-8",children:[c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsx(Yr,{isOpen:P,onClose:()=>D(!1),title:"Nearby Available Support",onConfirm:()=>D(!1),confirmButtonText:"Close",children:i.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:s.length>0?s.map(W=>i.jsx(ZL,{user:W,onAction:V},W.id)):i.jsxs("div",{className:"text-center py-8 text-muted",children:[i.jsx(Gi,{className:"h-10 w-10 mx-auto mb-2 opacity-20"}),i.jsx("p",{children:"No support staff found nearby."})]})})}),i.jsx("div",{className:"relative overflow-hidden rounded-3xl bg-transparent p-6 lg:p-10 transition-all",children:i.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg backdrop-blur-sm",children:i.jsx(Mx,{className:"h-6 w-6 text-emerald-600"})}),i.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-primary-text",children:"Support & Audit"})]}),i.jsx("p",{className:"text-muted max-w-xl text-sm",children:"Track issues, request audits, and connect with support staff in real-time."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 w-full lg:w-auto",children:[M&&i.jsxs(se,{onClick:()=>D(!0),variant:"secondary",className:"flex-1 lg:flex-none bg-gray-100 text-gray-900 hover:bg-gray-200 border-none shadow-none p-0 text-sm transition-colors",children:[i.jsx(hu,{className:"mr-1.5 h-3.5 w-3.5"})," Nearby"]}),i.jsxs(se,{onClick:()=>n("/support/ticket/new"),className:"flex-1 lg:flex-none",children:[i.jsx(Bt,{className:"mr-1.5 h-3.5 w-3.5"})," New Ticket"]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 lg:gap-6",children:[i.jsx(U,{title:"Open Tickets",value:F.open,icon:i.jsx(Mx,{className:"h-6 w-6"}),colorClass:"text-rose-500"}),i.jsx(U,{title:"In Progress",value:F.inProgress,icon:i.jsx(_t,{className:"h-6 w-6"}),colorClass:"text-blue-500"}),i.jsx(U,{title:"Pending Your Action",value:F.pendingYourAction,icon:i.jsx(hu,{className:"h-6 w-6"}),colorClass:"text-amber-500"})]}),i.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-8",children:[i.jsx("div",{className:"lg:col-span-2 space-y-6",children:i.jsxs("div",{className:"bg-transparent p-5 rounded-2xl",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[i.jsxs("div",{className:"relative flex-grow",children:[i.jsx(Ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(je,{id:"search",placeholder:"Search tickets...",className:"pl-10 bg-gray-50 border-gray-200",value:O.searchTerm,onChange:W=>I($=>({...$,searchTerm:W.target.value}))})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:"w-32 sm:w-40",children:i.jsxs(Ke,{value:O.status,onChange:W=>I($=>({...$,status:W.target.value})),className:"bg-gray-50 border-gray-200",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{children:"Open"}),i.jsx("option",{children:"In Progress"}),i.jsx("option",{value:"Pending Requester",children:"Pending"}),i.jsx("option",{children:"Resolved"}),i.jsx("option",{children:"Closed"})]})}),i.jsx("div",{className:"w-32 sm:w-40",children:i.jsxs(Ke,{value:O.priority,onChange:W=>I($=>({...$,priority:W.target.value})),className:"bg-gray-50 border-gray-200",children:[i.jsx("option",{value:"all",children:"All Priority"}),i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})})]})]}),o?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:q.length>0?q.map(W=>i.jsx(hue,{ticket:W,onClick:()=>n(`/support/ticket/${W.id}`)},W.id)):i.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-muted",children:[i.jsx("div",{className:"p-4 bg-accent/5 rounded-full mb-3",children:i.jsx(Ea,{className:"h-8 w-8 opacity-50"})}),i.jsx("p",{children:"No tickets match your filters."})]})})]})}),i.jsx("aside",{className:"hidden lg:block space-y-6",children:i.jsxs("div",{className:"bg-card p-6 rounded-2xl border border-border shadow-sm sticky top-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h3",{className:"font-bold text-lg text-primary-text flex items-center gap-2",children:[i.jsx(Gi,{className:"h-5 w-5 text-accent"})," Nearby Support"]}),i.jsxs("span",{className:"text-xs font-medium bg-accent/10 text-accent px-2 py-1 rounded-full",children:[s.filter(W=>W.isAvailable).length," Online"]})]}),i.jsx("div",{className:"space-y-3 max-h-[calc(100vh-200px)] overflow-y-auto pr-1 custom-scrollbar",children:s.length>0?s.map(W=>i.jsx(ZL,{user:W,onAction:V},W.id)):i.jsx("div",{className:"text-center py-8 text-muted",children:i.jsx("p",{children:"No support staff found nearby."})})})]})})]})]})},pue=({post:n,ticket:e,setTicket:t})=>{const{user:r}=jt(),[s,a]=E.useState(!1),[o,l]=E.useState(""),[c,d]=E.useState(!1),h=r?n.likes.includes(r.id):!1,p=async()=>{if(!r)return;const v=[...n.likes],w=h?n.likes.filter(_=>_!==r.id):[...n.likes,r.id];t(_=>_?{..._,posts:_.posts.map(j=>j.id===n.id?{...j,likes:w}:j)}:null);try{await ue.togglePostLike(n.id,r.id)}catch{t(j=>j?{...j,posts:j.posts.map(T=>T.id===n.id?{...T,likes:v}:T)}:null)}},x=async()=>{if(!(!o.trim()||!r)){d(!0);try{const v=await ue.addPostComment(n.id,{postId:n.id,authorId:r.id,authorName:r.name,content:o});t(w=>w?{...w,posts:w.posts.map(_=>_.id===n.id?{..._,comments:[..._.comments,v]}:_)}:null),l("")}catch{}finally{d(!1)}}};return i.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx($i,{seed:n.authorId,className:"w-10 h-10 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"w-full",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:n.authorName}),i.jsx("span",{className:"text-xs text-muted",children:n.authorRole.replace(/_/g," ")}),i.jsxs("span",{className:"text-xs text-muted",children:[" ",cu(new Date(n.createdAt),{addSuffix:!0})]})]}),i.jsx("p",{className:"text-sm text-muted mt-1 whitespace-pre-wrap",children:n.content}),i.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted",children:[i.jsxs("button",{onClick:p,className:`flex items-center gap-1.5 hover:text-accent transition-colors ${h?"text-accent font-semibold":""}`,children:[i.jsx(qJ,{className:`h-4 w-4 ${h?"fill-current":""}`}),i.jsxs("span",{children:[n.likes.length," Like",n.likes.length!==1&&"s"]})]}),i.jsxs("button",{onClick:()=>a(!s),className:"flex items-center gap-1.5 hover:text-accent transition-colors",children:[i.jsx(gm,{className:"h-4 w-4"}),i.jsxs("span",{children:[n.comments.length," Comment",n.comments.length!==1&&"s"]})]})]}),s&&i.jsxs("div",{className:"mt-4 space-y-3 pt-3 border-t border-border animate-fade-in-down",children:[n.comments.map(v=>i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx($i,{seed:v.authorId,className:"w-8 h-8 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"bg-page p-2 rounded-lg flex-grow",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"font-semibold text-sm text-primary-text",children:v.authorName}),i.jsx("span",{className:"text-xs text-muted",children:cu(new Date(v.createdAt),{addSuffix:!0})})]}),i.jsx("p",{className:"text-sm text-muted",children:v.content})]})]},v.id)),i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx($i,{className:"w-8 h-8 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("textarea",{value:o,onChange:v=>l(v.target.value),placeholder:"Write a comment...",rows:2,className:"form-input text-sm"}),i.jsx("div",{className:"text-right mt-1",children:i.jsx(se,{size:"sm",onClick:x,isLoading:c,children:"Post"})})]})]})]})]})]})})},gue=Pt({rating:as().min(1,"Please select a rating.").required(),feedback:ge().required("Feedback is required to close the ticket.").min(10,"Please provide more detailed feedback.")}).defined(),xue=({value:n,onChange:e})=>{const[t,r]=E.useState(0);return i.jsx("div",{className:"flex items-center justify-center gap-1",onMouseLeave:()=>r(0),children:[1,2,3,4,5].map(s=>i.jsx("button",{type:"button",onMouseEnter:()=>r(s),onClick:()=>e(s),className:"focus:outline-none",children:i.jsx(g3,{className:`h-8 w-8 cursor-pointer transition-colors ${(t||n)>=s?"text-yellow-400 fill-current":"text-gray-400"}`})},s))})},yue=({isOpen:n,onClose:e,onSubmit:t})=>{const[r,s]=E.useState(!1),{register:a,handleSubmit:o,control:l,formState:{errors:c}}=tn({resolver:En(gue),defaultValues:{rating:0,feedback:""}}),d=h=>{s(!0),t(h.rating,h.feedback),s(!1)};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:h=>h.stopPropagation(),children:i.jsxs("form",{onSubmit:o(d),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-2 text-center",children:"Ticket Resolved"}),i.jsx("p",{className:"text-sm text-muted text-center mb-4",children:"Please rate the support you received before closing this ticket."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx(_e,{name:"rating",control:l,render:({field:h})=>i.jsx(xue,{value:h.value,onChange:h.onChange})}),c.rating&&i.jsx("p",{className:"mt-2 text-xs text-red-500 text-center",children:c.rating.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted text-center",children:"Your Feedback"}),i.jsx("textarea",{...a("feedback"),rows:4,className:`mt-1 form-input ${c.feedback?"form-input--error":""}`}),c.feedback&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.feedback.message})]})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(se,{type:"button",onClick:e,variant:"secondary",children:"Not Now"}),i.jsx(se,{type:"submit",isLoading:r,children:"Confirm & Close"})]})]})})}):null},vue=({priority:n})=>{const e={Low:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",Medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",High:"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300",Urgent:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"};return i.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${e[n]}`,children:n})},bue=({status:n})=>{const e={Open:"status-chip--pending","In Progress":"sync-chip--pending_sync","Pending Requester":"leave-status-chip--pending_hr_confirmation",Resolved:"leave-status-chip--approved",Closed:"status-chip--draft"};return i.jsx("span",{className:`status-chip ${e[n]}`,children:n})},wue=()=>{const{id:n}=Ff(),e=St(),{user:t}=jt(),[r,s]=E.useState(null),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState(null),[p,x]=E.useState(""),[v,w]=E.useState(!1),[_,j]=E.useState(!1);Ft("(max-width: 1023px)"),E.useEffect(()=>{if(!n)return;(async()=>{c(!0);try{const[F,V]=await Promise.all([ue.getSupportTicketById(n),ue.getNearbyUsers()]);F?s(F):(h({message:"Ticket not found.",type:"error"}),e("/support")),o(V)}catch{h({message:"Failed to load ticket data.",type:"error"})}finally{c(!1)}})()},[n,e]);const T=async()=>{if(!(!p.trim()||!r||!t)){w(!0);try{const q=await ue.addTicketPost(r.id,{ticketId:r.id,authorId:t.id,authorName:t.name,authorRole:t.role,content:p});s(F=>F?{...F,posts:[...F.posts,q]}:null),x("")}catch{h({message:"Failed to add post.",type:"error"})}finally{w(!1)}}},P=async q=>{if(r)try{const F=await ue.updateSupportTicket(r.id,q);s(F),q.status&&h({message:`Ticket status updated to ${q.status}`,type:"success"})}catch{h({message:"Failed to update ticket.",type:"error"})}},D=async(q,F)=>{await P({status:"Closed",rating:q,feedback:F,closedAt:new Date().toISOString()}),j(!1)},M=q=>{if(!q){h({message:"User does not have a phone number.",type:"error"});return}let F=q.replace(/\D/g,"");if(F.length>10&&(F=F.slice(-10)),F.length!==10){h({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${F}`,"_blank")};if(l)return i.jsx("div",{className:"flex justify-center items-center h-screen",children:i.jsx(_t,{className:"h-12 w-12 animate-spin text-accent"})});if(!r)return null;const O=t?.id===r.raisedById,I=()=>r.status==="Closed"?null:i.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.status==="Open"&&i.jsx(se,{onClick:()=>P({status:"In Progress",assignedToId:t?.id,assignedToName:t?.name}),children:"Assign to Me"}),r.status==="In Progress"&&t?.id===r.assignedToId&&i.jsx(se,{onClick:()=>P({status:"Resolved",resolvedAt:new Date().toISOString()}),children:"Mark as Resolved"}),r.status==="Resolved"&&O&&i.jsx(se,{onClick:()=>j(!0),children:"Close Ticket"})]});return i.jsxs("div",{className:"p-4",children:[d&&i.jsx(ht,{message:d.message,type:d.type,onDismiss:()=>h(null)}),_&&i.jsx(yue,{isOpen:_,onClose:()=>j(!1),onSubmit:D}),i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx(se,{variant:"icon",onClick:()=>e("/support"),children:i.jsx(Ra,{})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl md:text-2xl font-bold text-primary-text",children:r.title}),i.jsxs("p",{className:"text-xs text-muted",children:["#",r.ticketNumber]})]})]}),i.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-6",children:[i.jsxs("main",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card space-y-4",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-start",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(bue,{status:r.status}),i.jsx(vue,{priority:r.priority})]}),i.jsxs("div",{className:"text-sm text-muted text-right",children:[i.jsxs("p",{children:["Raised by: ",i.jsx("span",{className:"font-semibold text-primary-text",children:r.raisedByName})]}),i.jsx("p",{children:$e(new Date(r.raisedAt),"dd MMM, yyyy - hh:mm a")})]})]}),i.jsx("p",{className:"text-sm text-muted whitespace-pre-wrap",children:r.description}),r.attachmentUrl&&i.jsxs("div",{className:"mt-4",children:[i.jsx("h5",{className:"text-sm font-semibold text-primary-text mb-2",children:"Attachment"}),i.jsx("a",{href:r.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"block border rounded-lg overflow-hidden max-w-xs hover:border-accent",children:i.jsx("img",{src:r.attachmentUrl,alt:"Attachment",className:"max-h-64 w-auto"})})]})]}),i.jsx("div",{className:"space-y-4",children:r.posts.map(q=>i.jsx(pue,{post:q,ticket:r,setTicket:s},q.id))}),r.status!=="Closed"&&i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card flex items-start gap-3",children:[i.jsx($i,{className:"w-10 h-10 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"w-full",children:[i.jsx("textarea",{value:p,onChange:q=>x(q.target.value),placeholder:"Add a public reply...",className:"form-input w-full",rows:3}),i.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[i.jsx(se,{variant:"icon",size:"sm",title:"Attach file",children:i.jsx(OJ,{className:"h-5 w-5"})}),i.jsxs(se,{onClick:T,isLoading:v,children:[i.jsx(PC,{className:"mr-2 h-4"})," Post"]})]})]})]})]}),i.jsxs("aside",{className:"space-y-6 mt-6 lg:mt-0",children:[i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[i.jsx("h3",{className:"font-semibold text-primary-text mb-3",children:"Ticket Details"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Assigned To:"})," ",i.jsx("span",{className:"font-semibold",children:r.assignedToName||"Unassigned"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Category:"})," ",i.jsx("span",{children:r.category})]}),r.resolvedAt&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Resolved:"})," ",i.jsx("span",{children:$e(new Date(r.resolvedAt),"dd MMM, yy")})]}),r.closedAt&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Closed:"})," ",i.jsx("span",{children:$e(new Date(r.closedAt),"dd MMM, yy")})]}),r.rating&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Rating:"})," ",i.jsxs("span",{className:"flex items-center gap-1",children:[r.rating," ",i.jsx(g3,{className:"h-4 w-4 text-yellow-400 fill-current"})]})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:I()})]}),i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[i.jsxs("h3",{className:"font-semibold text-primary-text mb-3 flex items-center gap-2",children:[i.jsx(Gi,{className:"h-5 w-5 text-muted"})," Nearby Users"]}),i.jsx("div",{className:"space-y-3",children:a.map(q=>i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx($i,{photoUrl:q.photoUrl,seed:q.id,className:"w-10 h-10 rounded-full"}),i.jsx("span",{className:"absolute bottom-0 right-0 block h-2.5 w-2.5 rounded-full bg-green-400 ring-2 ring-card"})]}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("p",{className:"text-sm font-semibold",children:q.name}),i.jsx("p",{className:"text-xs text-muted",children:q.role.replace(/_/g," ").replace(/\b\w/g,F=>F.toUpperCase())})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(se,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(q.phone),children:i.jsx(Ef,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(q.phone),children:i.jsx(gm,{className:"h-4 w-4"})}),i.jsx(se,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(q.phone),children:i.jsx(y3,{className:"h-4 w-4"})})]})]},q.id))})]})]})]})]})},_ue=Pt({id:ge().optional(),name:ge().required("Name is required"),email:ge().email("Invalid email").required("Email is required"),role:ge().required("Role is required"),password:ge().min(6,"Password must be at least 6 characters").required("Password is required for new users"),phone:ge().optional(),organizationId:ge().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:ge().optional(),reportingManagerId:ge().optional(),photoUrl:ge().optional().nullable()}).defined(),jue=Pt({id:ge().optional(),name:ge().required("Name is required"),email:ge().email("Invalid email").required("Email is required"),role:ge().required("Role is required"),phone:ge().optional(),organizationId:ge().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:ge().optional(),reportingManagerId:ge().optional(),photoUrl:ge().optional().nullable()}).defined(),KL=()=>{const n=St(),{id:e}=Ff(),t=!!e,r=Ft("(max-width: 767px)"),[s,a]=E.useState(!1),[o,l]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState(null),[x,v]=E.useState(null),w=t?jue:_ue,{register:_,handleSubmit:j,formState:{errors:T},reset:P,watch:D,setValue:M}=tn({resolver:En(w)}),O=D("role");E.useEffect(()=>{(async()=>{try{const[V,U]=await Promise.all([ue.getOrganizations(),ue.getRoles()]);if(l(V),d(U),t&&e){const $=(await ue.getUsers()).find(ne=>ne.id===e);$&&(v($),P($))}else P({name:"",email:"",role:"field_officer"})}catch{p({message:"Failed to load form data.",type:"error"})}})()},[e,t,P]);const I=F=>{const V=F.target.value,U=o.find(W=>W.id===V);M("organizationId",V),M("organizationName",U?.shortName||"")},q=async F=>{a(!0);try{if(t&&e){const{password:V,...U}=F;await ue.updateUser(e,U),p({message:"User updated successfully!",type:"success"})}else{const{name:V,email:U,password:W,role:$,...ne}=F;if(!W)throw new Error("Password is required when creating a new user");const Y=await ue.createAuthUser({name:V,email:U,password:W,role:$});ne&&Object.keys(ne).length>0&&await ue.updateUser(Y.id,ne),await ue.createNotification({userId:Y.id,message:`Welcome ${Y.name}! Your account has been created.`,type:"greeting"}),p({message:"User created successfully!",type:"success"})}setTimeout(()=>n("/admin/users"),1500)}catch(V){p({message:V.message||"Failed to save user.",type:"error"})}finally{a(!1)}};return r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit User":"Add User"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx($c,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit User":"Add New User"}),i.jsx("p",{className:"text-sm text-gray-400",children:t?"Update user information below.":"Create a new user account with initial credentials."})]}),i.jsxs("form",{onSubmit:j(q),className:"space-y-4",children:[i.jsx(je,{label:"Full Name",id:"name",registration:_("name"),error:T.name?.message}),i.jsx(je,{label:"Email",id:"email",type:"email",registration:_("email"),error:T.email?.message}),i.jsx(Ke,{label:"Role",id:"role",registration:_("role"),error:T.role?.message,children:c.map(F=>i.jsx("option",{value:F.id,children:F.displayName},F.id))}),!t&&i.jsx(je,{label:"Password",id:"password",type:"password",registration:_("password"),error:T.password?.message}),O==="site_manager"&&i.jsxs(Ke,{label:"Assigned Site",id:"organizationId",..._("organizationId"),error:T.organizationId?.message,onChange:I,children:[i.jsx("option",{value:"",children:"Select a Site"}),o.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/users"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:j(q),disabled:s,className:"fo-btn-primary flex-1",children:s?"Saving...":t?"Save Changes":"Create User"})]}),h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx($c,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit User":"Add New User"}),i.jsx("p",{className:"text-muted",children:t?"Update user information below.":"Create a new user account with initial credentials."})]})]}),i.jsxs("form",{onSubmit:j(q),className:"space-y-6",children:[i.jsx(je,{label:"Full Name",id:"name",registration:_("name"),error:T.name?.message}),i.jsx(je,{label:"Email",id:"email",type:"email",registration:_("email"),error:T.email?.message}),i.jsx(Ke,{label:"Role",id:"role",registration:_("role"),error:T.role?.message,children:c.map(F=>i.jsx("option",{value:F.id,children:F.displayName},F.id))}),!t&&i.jsx(je,{label:"Password",id:"password",type:"password",registration:_("password"),error:T.password?.message}),O==="site_manager"&&i.jsxs(Ke,{label:"Assigned Site",id:"organizationId",..._("organizationId"),error:T.organizationId?.message,onChange:I,children:[i.jsx("option",{value:"",children:"Select a Site"}),o.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/admin/users"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:s,children:t?"Save Changes":"Create User"})]})]})]}),h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)})]})},Nue=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(""),[o,l]=E.useState(!1),[c,d]=E.useState(null),h=async p=>{if(p.preventDefault(),!!t.trim()){l(!0);try{await ue.createPolicy({name:t.trim(),description:s.trim()}),d({message:"Policy created successfully!",type:"success"}),setTimeout(()=>n("/hr/policies-and-insurance"),1500)}catch{d({message:"Failed to save policy. Please try again.",type:"error"})}finally{l(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Policy"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(ls,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Policy"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new policy for your organization."})]}),i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:p=>r(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:o})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"description",value:s,onChange:p=>a(p.target.value),placeholder:"Description",className:"form-input",rows:4,disabled:o})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/policies-and-insurance"),disabled:o,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:h,disabled:o||!t.trim(),className:"fo-btn-primary flex-1",children:o?"Saving...":"Save Policy"})]}),c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(ls,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Policy"}),i.jsx("p",{className:"text-muted",children:"Create a new policy for your organization."})]})]}),i.jsxs("form",{onSubmit:h,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:p=>r(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:o})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"description",value:s,onChange:p=>a(p.target.value),placeholder:"Description",className:"form-input",rows:4,disabled:o})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/hr/policies-and-insurance"),variant:"secondary",disabled:o,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:o,disabled:!t.trim(),children:"Save Policy"})]})]})]}),c&&i.jsx(ht,{message:c.message,type:c.type,onDismiss:()=>d(null)})]})},Sue=Pt({title:ge().required("Title is required"),description:ge().required("Description is required"),category:ge().oneOf(["Software Developer","Admin","Operational","HR Query","Other"]).required("Category is required"),priority:ge().oneOf(["Low","Medium","High","Urgent"]).required("Priority is required"),assignedToId:ge().optional().nullable(),attachment:Wt().optional().nullable()}).defined(),Cue=()=>{const n=St(),{user:e}=jt(),[t,r]=E.useState(!1),[s,a]=E.useState([]),[o,l]=E.useState(null),c=Ft("(max-width: 767px)"),{register:d,handleSubmit:h,control:p,formState:{errors:x}}=tn({resolver:En(Sue),defaultValues:{category:"Software Developer",priority:"Medium",assignedToId:null,attachment:null}}),v=au({control:p,name:"category"});E.useEffect(()=>{ue.getUsers().then(a)},[]);const w=E.useMemo(()=>{if(!s)return[];switch(v){case"Software Developer":return s.filter(P=>P.role==="developer");case"Admin":return s.filter(P=>P.role==="admin");case"HR Query":return s.filter(P=>P.role==="hr");case"Operational":return s.filter(P=>["operation_manager","site_manager"].includes(P.role));default:const T=["admin","hr","developer","operation_manager","site_manager"];return s.filter(P=>T.includes(P.role))}},[s,v]),_=async T=>{if(e){r(!0);try{const P=s.find(D=>D.id===T.assignedToId);await ue.createSupportTicket({...T,attachment:T.attachment,status:"Open",raisedById:e.id,raisedByName:e.name,assignedToId:T.assignedToId||null,assignedToName:P?.name||null,resolvedAt:null,closedAt:null,rating:null,feedback:null}),l({message:"Ticket created successfully!",type:"success"}),setTimeout(()=>n("/support"),1500)}catch{l({message:"Failed to create ticket.",type:"error"})}finally{r(!1)}}},j="new-ticket-form";return c?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"New Support Ticket"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(zM,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Create New Ticket"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Submit a support request or report an issue."})]}),i.jsxs("form",{id:j,onSubmit:h(_),className:"space-y-4",children:[i.jsx(je,{placeholder:"Title / Subject",...d("title"),error:x.title?.message}),i.jsxs("div",{children:[i.jsx("textarea",{placeholder:"Description",...d("description"),rows:5,className:`form-input ${x.description?"form-input--error":""}`}),x.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.description.message})]}),i.jsx(_e,{name:"category",control:p,render:({field:T})=>i.jsxs(Ke,{...T,error:x.category?.message,children:[i.jsx("option",{children:"Software Developer"}),i.jsx("option",{children:"Admin"}),i.jsx("option",{children:"Operational"}),i.jsx("option",{children:"HR Query"}),i.jsx("option",{children:"Other"})]})}),i.jsx(_e,{name:"priority",control:p,render:({field:T})=>i.jsxs(Ke,{...T,error:x.priority?.message,children:[i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})}),i.jsx(_e,{name:"assignedToId",control:p,render:({field:T})=>i.jsxs(Ke,{...T,value:T.value??"",error:x.assignedToId?.message,children:[i.jsx("option",{value:"",children:"Unassigned"}),w.map(P=>i.jsxs("option",{value:P.id,children:[P.name," (",P.role.replace(/_/g," "),")"]},P.id))]})}),i.jsx(_e,{name:"attachment",control:p,render:({field:T,fieldState:P})=>i.jsx(yt,{label:"Attach Screenshot or Document (Image only)",file:T.value,onFileChange:T.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:P.error?.message})})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/support"),disabled:t,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",form:j,disabled:t,className:"fo-btn-primary flex-1",children:t?"Creating...":"Create Ticket"})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(zM,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Create New Ticket"}),i.jsx("p",{className:"text-muted",children:"Submit a support request or report an issue."})]})]}),i.jsxs("form",{id:j,onSubmit:h(_),className:"space-y-6",children:[i.jsx(je,{label:"Title / Subject",...d("title"),error:x.title?.message}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{...d("description"),rows:5,className:`form-input ${x.description?"form-input--error":""}`}),x.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.description.message})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(_e,{name:"category",control:p,render:({field:T})=>i.jsxs(Ke,{label:"Category",...T,error:x.category?.message,children:[i.jsx("option",{children:"Software Developer"}),i.jsx("option",{children:"Admin"}),i.jsx("option",{children:"Operational"}),i.jsx("option",{children:"HR Query"}),i.jsx("option",{children:"Other"})]})}),i.jsx(_e,{name:"priority",control:p,render:({field:T})=>i.jsxs(Ke,{label:"Priority",...T,error:x.priority?.message,children:[i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})})]}),i.jsx(_e,{name:"assignedToId",control:p,render:({field:T})=>i.jsxs(Ke,{label:"Assigned To (Optional)",...T,value:T.value??"",error:x.assignedToId?.message,children:[i.jsx("option",{value:"",children:"Unassigned"}),w.map(P=>i.jsxs("option",{value:P.id,children:[P.name," (",P.role.replace(/_/g," "),")"]},P.id))]})}),i.jsx(_e,{name:"attachment",control:p,render:({field:T,fieldState:P})=>i.jsx(yt,{label:"Attach Screenshot or Document (Image only)",file:T.value,onFileChange:T.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:P.error?.message})}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/support"),variant:"secondary",disabled:t,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:t,children:"Create Ticket"})]})]})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},Tue=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(!1),[o,l]=E.useState(null),c=async d=>{if(d.preventDefault(),!!t.trim()){a(!0);try{const h={id:`group_${Date.now()}`,name:t.trim(),locations:[],companies:[]};l({message:"Group created successfully!",type:"success"}),setTimeout(()=>n("/hr/entity-management"),1500)}catch{l({message:"Failed to create group. Please try again.",type:"error"})}finally{a(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Group"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Hi,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Group"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new organizational group."})]}),i.jsx("form",{onSubmit:c,className:"space-y-4",children:i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Group Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:d=>r(d.target.value),placeholder:"Enter group name",className:"form-input",required:!0,disabled:s})]})})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/entity-management"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:c,disabled:s||!t.trim(),className:"fo-btn-primary flex-1",children:s?"Saving...":"Create Group"})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Hi,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Group"}),i.jsx("p",{className:"text-muted",children:"Create a new organizational group."})]})]}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Group Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:d=>r(d.target.value),placeholder:"Enter group name",className:"form-input",required:!0,disabled:s})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/hr/entity-management"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:s,disabled:!t.trim(),children:"Create Group"})]})]})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},kue=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=E.useState([]),[s,a]=E.useState(""),[o,l]=E.useState(""),[c,d]=E.useState(""),[h,p]=E.useState(!1),[x,v]=E.useState(null),w=async _=>{if(_.preventDefault(),!(!s||!o||!c.trim())){p(!0);try{console.log("Granting comp off:",{userId:s,days:o,reason:c}),v({message:"Comp off granted successfully!",type:"success"}),setTimeout(()=>n("/hr/leave-management"),1500)}catch{v({message:"Failed to grant comp off.",type:"error"})}finally{p(!1)}}};return E.useEffect(()=>{(async()=>{try{const j=await ue.getUsers();r(j)}catch{v({message:"Failed to load users.",type:"error"})}})()},[]),e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Grant Comp Off"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(qM,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Grant Compensatory Off"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Grant comp off days to an employee."})]}),i.jsxs("form",{onSubmit:w,className:"space-y-4",children:[i.jsxs(Ke,{label:"Select Employee",id:"user",value:s,onChange:_=>a(_.target.value),error:!s&&s!==""?"Please select an employee":"",children:[i.jsx("option",{value:"",children:"Select an employee"}),t.map(_=>i.jsxs("option",{value:_.id,children:[_.name," - ",_.role]},_.id))]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"days",className:"block text-sm font-medium text-muted mb-1",children:["Number of Days ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"days",type:"number",step:"0.5",min:"0.5",value:o,onChange:_=>l(_.target.value),placeholder:"e.g. 1, 0.5, 2",className:"form-input",required:!0,disabled:h})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-muted mb-1",children:["Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"reason",value:c,onChange:_=>d(_.target.value),placeholder:"Reason for granting comp off",className:"form-input",rows:4,required:!0,disabled:h})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/leave-management"),disabled:h,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:w,disabled:h||!s||!o||!c.trim(),className:"fo-btn-primary flex-1",children:h?"Granting...":"Grant Comp Off"})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(qM,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Grant Compensatory Off"}),i.jsx("p",{className:"text-muted",children:"Grant comp off days to an employee."})]})]}),i.jsxs("form",{onSubmit:w,className:"space-y-6",children:[i.jsxs(Ke,{label:"Select Employee",id:"user",value:s,onChange:_=>a(_.target.value),children:[i.jsx("option",{value:"",children:"Select an employee"}),t.map(_=>i.jsxs("option",{value:_.id,children:[_.name," - ",_.role]},_.id))]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"days",className:"block text-sm font-medium text-muted mb-1",children:["Number of Days ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"days",type:"number",step:"0.5",min:"0.5",value:o,onChange:_=>l(_.target.value),placeholder:"e.g. 1, 0.5, 2",className:"form-input",required:!0,disabled:h})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-muted mb-1",children:["Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"reason",value:c,onChange:_=>d(_.target.value),placeholder:"Reason for granting comp off",className:"form-input",rows:4,required:!0,disabled:h})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/hr/leave-management"),variant:"secondary",disabled:h,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:h,disabled:!s||!o||!c.trim(),children:"Grant Comp Off"})]})]})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]})},Pue=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(""),[o,l]=E.useState(""),[c,d]=E.useState(!1),[h,p]=E.useState(null),x=async v=>{if(v.preventDefault(),!(!t.trim()||!s.trim())){d(!0);try{const w={id:t.toLowerCase().replace(/\s+/g,"_"),name:t.trim(),description:s.trim(),permissions:o.split(",").map(T=>T.trim()).filter(Boolean)},_=await ue.getModules();if(_.some(T=>T.id===w.id)){p({message:"Module with this ID already exists.",type:"error"}),d(!1);return}const j=[..._,w];await ue.saveModules(j),p({message:"Module created successfully!",type:"success"}),setTimeout(()=>n("/admin/modules"),1500)}catch{p({message:"Failed to create module. Please try again.",type:"error"})}finally{d(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Module"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(xm,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Module"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new system module."})]}),i.jsxs("form",{onSubmit:x,className:"space-y-4",children:[i.jsx(je,{label:"Module Name",id:"name",value:t,onChange:v=>r(v.target.value),placeholder:"e.g. HR Tasks & Management",required:!0,disabled:c,error:!t.trim()&&t!==""?"Module name is required":""}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:["Description ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"description",value:s,onChange:v=>a(v.target.value),placeholder:"Manage leaves, policies, insurance, uniforms, and tasks.",className:"form-input",rows:4,required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"permissions",className:"block text-sm font-medium text-muted mb-1",children:"Permissions (comma-separated)"}),i.jsx("input",{id:"permissions",value:o,onChange:v=>l(v.target.value),placeholder:"e.g. view_module, manage_module",className:"form-input",disabled:c})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/modules"),disabled:c,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:x,disabled:c||!t.trim()||!s.trim(),className:"fo-btn-primary flex-1",children:c?"Creating...":"Create Module"})]}),h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(xm,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Module"}),i.jsx("p",{className:"text-muted",children:"Create a new system module."})]})]}),i.jsxs("form",{onSubmit:x,className:"space-y-6",children:[i.jsx(je,{label:"Module Name",id:"name",value:t,onChange:v=>r(v.target.value),placeholder:"e.g. HR Tasks & Management",required:!0,disabled:c}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:["Description ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"description",value:s,onChange:v=>a(v.target.value),placeholder:"Manage leaves, policies, insurance, uniforms, and tasks.",className:"form-input",rows:4,required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"permissions",className:"block text-sm font-medium text-muted mb-1",children:"Permissions (comma-separated)"}),i.jsx("input",{id:"permissions",value:o,onChange:v=>l(v.target.value),placeholder:"e.g. view_module, manage_module",className:"form-input",disabled:c})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/admin/modules"),variant:"secondary",disabled:c,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:c,disabled:!t.trim()||!s.trim(),children:"Create Module"})]})]})]}),h&&i.jsx(ht,{message:h.message,type:h.type,onDismiss:()=>p(null)})]})},JL=()=>{const n=St(),{id:e}=Ff(),t=!!e,r=Ft("(max-width: 767px)"),{permissions:s,setRolePermissions:a,addRolePermissionEntry:o}=Ji(),[l,c]=E.useState(""),[d,h]=E.useState(""),[p,x]=E.useState([]),[v,w]=E.useState(!1),[_,j]=E.useState(null);E.useEffect(()=>{(async()=>{try{if(t&&e){const O=(await ue.getRoles()).find(I=>I.id===e);if(O){c(O.id),h(O.displayName);const I=s[O.id]||[];x(I)}}}catch{j({message:"Failed to load data.",type:"error"})}})()},[e,t,s]);const T=D=>{x(M=>M.includes(D)?M.filter(O=>O!==D):[...M,D])},P=async D=>{if(D.preventDefault(),!(!l.trim()||!d.trim())){w(!0);try{const M=t?l:l.toLowerCase().replace(/\s+/g,"_"),O={id:M,displayName:d.trim()},I=await ue.getRoles();let q=[...I];if(t)q=q.map(F=>F.id===M?O:F);else{if(I.some(F=>F.id===M)){j({message:"Role ID already exists.",type:"error"}),w(!1);return}q.push(O)}await ue.saveRoles(q),a(M,p),t||o(O),j({message:`Role ${t?"updated":"created"} successfully!`,type:"success"}),setTimeout(()=>n("/admin/roles"),1500)}catch{j({message:"Failed to save role. Please try again.",type:"error"})}finally{w(!1)}}};return r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Role":"Add Role"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(ym,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit Role":"Add New Role"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Define role permissions and access control."})]}),i.jsxs("form",{onSubmit:P,className:"space-y-4",children:[i.jsx(je,{label:"Role ID",id:"roleId",value:l,onChange:D=>c(D.target.value),placeholder:"e.g. admin, hr, field_officer",required:!0,disabled:v||t}),i.jsx(je,{label:"Display Name",id:"displayName",value:d,onChange:D=>h(D.target.value),placeholder:"e.g. Admin, HR, Field Officer",required:!0,disabled:v}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Permissions"}),i.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:wm.map(D=>i.jsxs("label",{className:"flex items-center gap-2 p-2 rounded hover:bg-page cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.includes(D.key),onChange:()=>T(D.key),className:"form-checkbox",disabled:v}),i.jsx("span",{className:"text-sm",children:D.name})]},D.key))})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/roles"),disabled:v,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:P,disabled:v||!l.trim()||!d.trim(),className:"fo-btn-primary flex-1",children:v?"Saving...":t?"Save Changes":"Create Role"})]}),_&&i.jsx(ht,{message:_.message,type:_.type,onDismiss:()=>j(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(ym,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit Role":"Add New Role"}),i.jsx("p",{className:"text-muted",children:"Define role permissions and access control."})]})]}),i.jsxs("form",{onSubmit:P,className:"space-y-6",children:[i.jsx(je,{label:"Role ID",id:"roleId",value:l,onChange:D=>c(D.target.value),placeholder:"e.g. admin, hr, field_officer",required:!0,disabled:v||t}),i.jsx(je,{label:"Display Name",id:"displayName",value:d,onChange:D=>h(D.target.value),placeholder:"e.g. Admin, HR, Field Officer",required:!0,disabled:v}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-muted mb-2",children:["Permissions (",p.length," selected)"]}),i.jsx("div",{className:"border border-border rounded-lg p-4 space-y-2 max-h-96 overflow-y-auto",children:wm.map(D=>i.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-page cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.includes(D.key),onChange:()=>T(D.key),className:"form-checkbox",disabled:v}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium",children:D.name}),D.description&&i.jsx("div",{className:"text-xs text-muted",children:D.description})]})]},D.key))})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/admin/roles"),variant:"secondary",disabled:v,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:v,disabled:!l.trim()||!d.trim(),children:t?"Save Changes":"Create Role"})]})]})]}),_&&i.jsx(ht,{message:_.message,type:_.type,onDismiss:()=>j(null)})]})},Mue=Pt({groupId:ge().required("Please select a group"),companyId:ge().required("Please select a company"),clientId:ge().required("Please select a client"),manpowerCount:as().typeError("Must be a number").min(0,"Cannot be negative").required("Manpower count is required")}).defined(),Eue=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(!1),[c,d]=E.useState(""),[h,p]=E.useState(!1),[x,v]=E.useState(null),w=E.useRef(null),{register:_,handleSubmit:j,watch:T,formState:{errors:P},setValue:D}=tn({resolver:En(Mue)}),M=T("groupId"),O=T("companyId");E.useEffect(()=>{a(!0),ue.getOrganizationStructure().then(r).catch(()=>v({message:"Failed to load organization structure.",type:"error"})).finally(()=>a(!1))},[]),E.useEffect(()=>{D("companyId",""),D("clientId",""),d("")},[M,D]),E.useEffect(()=>{D("clientId",""),d("")},[O,D]),E.useEffect(()=>{const W=$=>{w.current&&!w.current.contains($.target)&&p(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[]);const I=E.useMemo(()=>t.find(W=>W.id===M)?.companies||[],[t,M]),q=E.useMemo(()=>I.find(W=>W.id===O)?.entities||[],[I,O]),F=E.useMemo(()=>c?q.filter(W=>W.name.toLowerCase().includes(c.toLowerCase())):q,[q,c]),V=W=>{D("clientId",W.id,{shouldValidate:!0}),d(W.name),p(!1)},U=async W=>{const $=q.find(ne=>ne.id===W.clientId);if($){l(!0);try{if((await ue.getOrganizations()).some(ae=>ae.id===$.organizationId)){v({message:"A site for this client already exists.",type:"error"}),l(!1);return}const Y={id:$.organizationId||`site_${Date.now()}`,shortName:$.name,fullName:$.name,address:$.location||$.registeredAddress||"",manpowerApprovedCount:W.manpowerCount};await ue.createOrganization(Y),v({message:"Site added successfully!",type:"success"}),setTimeout(()=>n("/admin/sites"),1500)}catch{v({message:"Failed to add site. Please try again.",type:"error"})}finally{l(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Site"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Hi,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add Site from Client"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new site from an existing client entity."})]}),s?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("form",{onSubmit:j(U),className:"space-y-4",children:[i.jsxs(Ke,{label:"Group",id:"groupId",registration:_("groupId"),error:P.groupId?.message,children:[i.jsx("option",{value:"",children:"Select a Group"}),t.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs(Ke,{label:"Company",id:"companyId",registration:_("companyId"),error:P.companyId?.message,disabled:!M,children:[i.jsx("option",{value:"",children:"Select a Company"}),I.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs("div",{className:"relative",ref:w,children:[i.jsx(je,{label:"Client",id:"clientSearch",value:c,onChange:W=>{d(W.target.value),p(!0),D("clientId","")},onFocus:()=>p(!0),disabled:!O,error:P.clientId?.message,autoComplete:"off"}),h&&F.length>0&&i.jsx("ul",{className:"absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto shadow-lg",children:F.map(W=>i.jsx("li",{onClick:()=>V(W),className:"px-3 py-2 text-sm cursor-pointer hover:bg-page",children:W.name},W.id))})]}),i.jsx(je,{label:"Approved Manpower Count",id:"manpowerCount",type:"number",registration:_("manpowerCount"),error:P.manpowerCount?.message})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/sites"),disabled:o,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:j(U),disabled:o||s,className:"fo-btn-primary flex-1",children:o?"Adding...":"Add Site"})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Hi,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add Site from Client"}),i.jsx("p",{className:"text-muted",children:"Create a new site from an existing client entity."})]})]}),s?i.jsx("div",{className:"flex justify-center py-12",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("form",{onSubmit:j(U),className:"space-y-6",children:[i.jsxs(Ke,{label:"Group",id:"groupId",registration:_("groupId"),error:P.groupId?.message,children:[i.jsx("option",{value:"",children:"Select a Group"}),t.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs(Ke,{label:"Company",id:"companyId",registration:_("companyId"),error:P.companyId?.message,disabled:!M,children:[i.jsx("option",{value:"",children:"Select a Company"}),I.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs("div",{className:"relative",ref:w,children:[i.jsx(je,{label:"Client",id:"clientSearch",value:c,onChange:W=>{d(W.target.value),p(!0),D("clientId","")},onFocus:()=>p(!0),disabled:!O,error:P.clientId?.message,autoComplete:"off"}),h&&F.length>0&&i.jsx("ul",{className:"absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto shadow-lg",children:F.map(W=>i.jsx("li",{onClick:()=>V(W),className:"px-3 py-2 text-sm cursor-pointer hover:bg-page",children:W.name},W.id))})]}),i.jsx(je,{label:"Approved Manpower Count",id:"manpowerCount",type:"number",registration:_("manpowerCount"),error:P.manpowerCount?.message}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/admin/sites"),variant:"secondary",disabled:o,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:o,children:"Add Site"})]})]})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]})},Due=()=>{const n=St(),e=Ft("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(!1),[o,l]=E.useState(null),c=async d=>{if(d.preventDefault(),!!t.trim()){a(!0);try{const h={id:`SITE-${t.toUpperCase().replace(/\s/g,"").substring(0,4)}-${Date.now()%1e3}`,shortName:t.trim(),fullName:t.trim(),address:"To be configured",provisionalCreationDate:new Date().toISOString()};await ue.createOrganization(h),l({message:`Provisional site '${t}' created.`,type:"success"}),setTimeout(()=>n("/admin/sites"),1500)}catch(h){const p=h?.message||h?.error?.message||"Failed to create site.";l({message:`Failed to create site: ${p}`,type:"error"})}finally{a(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Quick Add Site"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(IS,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Quick Add Provisional Site"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new site with a 90-day grace period."})]}),i.jsxs("form",{onSubmit:c,className:"space-y-4",children:[i.jsx(je,{label:"New Site Name",id:"quick-add-site-name",value:t,onChange:d=>r(d.target.value),placeholder:"e.g. New Project Site",required:!0,disabled:s,autoFocus:!0}),i.jsx("p",{className:"text-xs text-muted",children:"This will create a new site with a 90-day grace period to complete the full configuration."})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/sites"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:c,disabled:s||!t.trim(),className:"fo-btn-primary flex-1",children:s?"Adding...":"Add Site"})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(IS,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Quick Add Provisional Site"}),i.jsx("p",{className:"text-muted",children:"Create a new site with a 90-day grace period to complete the full configuration."})]})]}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[i.jsx(je,{label:"New Site Name",id:"quick-add-site-name",value:t,onChange:d=>r(d.target.value),placeholder:"e.g. New Project Site",required:!0,disabled:s,autoFocus:!0}),i.jsx("p",{className:"text-sm text-muted -mt-4",children:"This will create a new site with a 90-day grace period to complete the full configuration."}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/admin/sites"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:s,disabled:!t.trim(),children:"Add Site"})]})]})]}),o&&i.jsx(ht,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},Oue=Pt({name:ge().required("Task name is required"),description:ge().required("Description is required"),dueDate:ge().required("A due date is required").nullable(),priority:ge().oneOf(["Low","Medium","High"]).required("Priority is required"),assignedToId:ge().required("An assignee is required"),escalationLevel1UserId:ge().optional(),escalationLevel1DurationDays:as().when("escalationLevel1UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationLevel2UserId:ge().optional(),escalationLevel2DurationDays:as().when("escalationLevel2UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationEmail:ge().email("Must be a valid email address").optional(),escalationEmailDurationDays:as().when("escalationEmail",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()})}).defined(),QL=()=>{const n=St(),{id:e}=Ff(),t=!!e,r=Ft("(max-width: 767px)"),{createTask:s,updateTask:a,tasks:o}=_1(),[l,c]=E.useState(!1),[d,h]=E.useState([]),[p,x]=E.useState(null),{permissions:v}=Ji(),{fetchNotifications:w}=ly(),{theme:_}=Jc(),j=_==="dark",{register:T,handleSubmit:P,formState:{errors:D},reset:M,control:O,watch:I}=tn({resolver:En(Oue),defaultValues:{priority:"Medium",assignedToId:"",dueDate:null}}),q=I("escalationLevel1UserId"),F=I("escalationLevel2UserId"),V=I("escalationEmail");E.useEffect(()=>{(async()=>{try{const X=await ue.getUsers();if(h(X),t&&e){let Z=o.find(oe=>oe.id===e);Z||(Z=(await ue.getTasks()).find(H=>H.id===e)),Z?M(Z):(x({message:"Task not found.",type:"error"}),setTimeout(()=>n("/tasks"),2e3))}}catch{x({message:"Failed to load data.",type:"error"})}})()},[e,t,o,M,n]);const U=async ee=>{c(!0);try{const X=d.find(oe=>oe.id===ee.assignedToId),Z={...ee,assignedToName:X?.name};if(t&&e?(await a(e,Z),x({message:"Task updated successfully!",type:"success"})):(await s(Z),x({message:"Task created successfully.",type:"success"})),X){const Q=(v[X.role]||[]).includes("manage_tasks")?"/tasks":"/onboarding/tasks";(!t||t&&e)&&(await ue.createNotification({userId:X.id,type:"task_assigned",message:`You have been assigned a new task: "${ee.name}"`,linkTo:Q}),w())}setTimeout(()=>n("/tasks"),1500)}catch{x({message:"Failed to save task.",type:"error"})}finally{c(!1)}},W="!bg-[#041b0f] !border-white/10 !text-white !placeholder-gray-500 !rounded-xl focus:!ring-emerald-500 focus:!border-emerald-500",$="text-gray-300 font-medium mb-1.5 block",ne="",Y="block text-sm font-medium text-muted mb-1",ae=j?W:ne,J=j?$:Y;return r?i.jsxs("div",{className:`h-full flex flex-col ${j?"bg-[#041b0f] text-white":""}`,children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Task":"Add Task"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:`${j?"bg-[#152b1b] border border-white/10":"bg-card"} rounded-2xl p-6 space-y-6`,children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:`inline-block p-3 rounded-full mb-2 ${j?"bg-emerald-500/20":"bg-accent-light"}`,children:i.jsx(vm,{className:`h-8 w-8 ${j?"text-emerald-400":"text-accent-dark"}`})}),i.jsx("h2",{className:`text-xl font-bold ${j?"text-white":"text-primary-text"}`,children:t?"Edit Task":"Create New Task"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Assign tasks and set deadlines."})]}),i.jsxs("form",{onSubmit:P(U),className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"name",className:J,children:"Task Name"}),i.jsx(je,{id:"name",registration:T("name"),error:D.name?.message,className:ae,placeholder:j?"Enter task name":""})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:J,children:"Description"}),i.jsx("textarea",{id:"description",rows:4,...T("description"),className:j?`w-full ${ae} px-3 py-3 outline-none`:`mt-1 bg-card border ${D.description?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`,placeholder:j?"Enter task description":""}),D.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:D.description.message})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:J,children:"Due Date"}),i.jsx(_e,{name:"dueDate",control:O,render:({field:ee})=>i.jsx(kn,{label:"",id:"dueDate",value:ee.value,onChange:ee.onChange,error:D.dueDate?.message,minDate:new Date,className:ae})})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"priority",className:J,children:"Priority"}),i.jsxs(Ke,{id:"priority",registration:T("priority"),error:D.priority?.message,className:ae,children:[i.jsx("option",{value:"Low",className:j?"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:j?"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:j?"bg-[#041b0f]":"",children:"High"})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"assignedToId",className:J,children:"Assign To"}),i.jsxs(Ke,{id:"assignedToId",registration:T("assignedToId"),error:D.assignedToId?.message,className:ae,children:[i.jsx("option",{value:"",className:j?"bg-[#041b0f]":"",children:"Select User"}),d.map(ee=>i.jsxs("option",{value:ee.id,className:j?"bg-[#041b0f]":"",children:[ee.name," (",ee.role.replace(/_/g," "),")"]},ee.id))]})]})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/tasks"),disabled:l,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:P(U),disabled:l,className:"fo-btn-primary flex-1",children:l?"Saving...":t?"Save Changes":"Create Task"})]}),p&&i.jsx(ht,{message:p.message,type:p.type,onDismiss:()=>x(null)})]}):i.jsxs("div",{className:`p-4 md:p-6 ${j?"text-white":""}`,children:[i.jsxs("div",{className:`${j?"bg-[#152b1b] border border-white/10":"bg-card"} p-8 rounded-xl shadow-card w-full max-w-3xl mx-auto`,children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:`p-3 rounded-full mr-4 ${j?"bg-emerald-500/20":"bg-accent-light"}`,children:i.jsx(vm,{className:`h-8 w-8 ${j?"text-emerald-400":"text-accent-dark"}`})}),i.jsxs("div",{children:[i.jsx("h2",{className:`text-2xl font-bold ${j?"text-white":"text-primary-text"}`,children:t?"Edit Task":"Create New Task"}),i.jsx("p",{className:j?"text-gray-400":"text-muted",children:"Assign tasks and set deadlines."})]})]}),i.jsxs("form",{onSubmit:P(U),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"name",className:J,children:"Task Name"}),i.jsx(je,{id:"name",registration:T("name"),error:D.name?.message,className:ae,placeholder:j?"Enter task name":""})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"description",className:J,children:"Description"}),i.jsx("textarea",{id:"description",rows:4,...T("description"),className:j?`w-full ${ae} px-3 py-3 outline-none`:`mt-1 bg-card border ${D.description?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`,placeholder:j?"Enter task description":""}),D.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:D.description.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:J,children:"Due Date"}),i.jsx(_e,{name:"dueDate",control:O,render:({field:ee})=>i.jsx(kn,{label:"",id:"dueDate",value:ee.value,onChange:ee.onChange,error:D.dueDate?.message,minDate:new Date,className:ae})})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"priority",className:J,children:"Priority"}),i.jsxs(Ke,{id:"priority",registration:T("priority"),error:D.priority?.message,className:ae,children:[i.jsx("option",{value:"Low",className:j?"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:j?"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:j?"bg-[#041b0f]":"",children:"High"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"assignedToId",className:J,children:"Assign To"}),i.jsxs(Ke,{id:"assignedToId",registration:T("assignedToId"),error:D.assignedToId?.message,className:ae,children:[i.jsx("option",{value:"",className:j?"bg-[#041b0f]":"",children:"Select User"}),d.map(ee=>i.jsxs("option",{value:ee.id,className:j?"bg-[#041b0f]":"",children:[ee.name," (",ee.role.replace(/_/g," "),")"]},ee.id))]})]})]}),i.jsxs("div",{className:`pt-6 border-t ${j?"border-white/10":"border-border"}`,children:[i.jsx("h4",{className:`text-lg font-semibold ${j?"text-white":"text-primary-text"} mb-1`,children:"Escalation Matrix (Optional)"}),i.jsx("p",{className:`text-sm ${j?"text-gray-400":"text-muted"} mb-6`,children:"Define who gets notified if this task becomes overdue."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel1UserId",className:J,children:"Escalation Level 1"}),i.jsxs(Ke,{id:"escalationLevel1UserId",registration:T("escalationLevel1UserId"),error:D.escalationLevel1UserId?.message,className:ae,children:[i.jsx("option",{value:"",className:j?"bg-[#041b0f]":"",children:"Select User"}),d.map(ee=>i.jsx("option",{value:ee.id,className:j?"bg-[#041b0f]":"",children:ee.name},ee.id))]})]}),q&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel1DurationDays",className:J,children:"Days until L1 Escalation"}),i.jsx(je,{id:"escalationLevel1DurationDays",type:"number",registration:T("escalationLevel1DurationDays"),error:D.escalationLevel1DurationDays?.message,className:ae})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel2UserId",className:J,children:"Escalation Level 2"}),i.jsxs(Ke,{id:"escalationLevel2UserId",registration:T("escalationLevel2UserId"),error:D.escalationLevel2UserId?.message,className:ae,children:[i.jsx("option",{value:"",className:j?"bg-[#041b0f]":"",children:"Select User"}),d.map(ee=>i.jsx("option",{value:ee.id,className:j?"bg-[#041b0f]":"",children:ee.name},ee.id))]})]}),F&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel2DurationDays",className:J,children:"Days until L2 Escalation"}),i.jsx(je,{id:"escalationLevel2DurationDays",type:"number",registration:T("escalationLevel2DurationDays"),error:D.escalationLevel2DurationDays?.message,className:ae})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"escalationEmail",className:J,children:"Final Escalation Email"}),i.jsx(je,{id:"escalationEmail",type:"email",registration:T("escalationEmail"),error:D.escalationEmail?.message,className:ae,placeholder:j?"Enter email address":""})]}),V&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"escalationEmailDurationDays",className:J,children:"Days until Final Escalation"}),i.jsx(je,{id:"escalationEmailDurationDays",type:"number",registration:T("escalationEmailDurationDays"),error:D.escalationEmailDurationDays?.message,className:ae})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/tasks"),variant:"secondary",disabled:l,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:l,children:t?"Save Changes":"Create Task"})]})]})]}),p&&i.jsx(ht,{message:p.message,type:p.type,onDismiss:()=>x(null)})]})},Tc=({title:n,sizes:e,headers:t,control:r,quantityType:s,quantities:a,readOnly:o=!1})=>{const l=Array.from(new Set(e.map(d=>d.fit))),c=Array.from(new Set(e.map(d=>d.size))).sort((d,h)=>{const p=parseInt(String(d)),x=parseInt(String(h));return!isNaN(p)&&!isNaN(x)?p-x:String(d).localeCompare(String(h))});return i.jsxs("div",{className:"border rounded-lg flex flex-col overflow-hidden bg-card",children:[i.jsx("h4",{className:"p-3 font-semibold bg-gray-50 dark:bg-white/5 border-b flex-shrink-0",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 dark:bg-white/5",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:"Size"}),t.map(d=>i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:d.label},String(d.key))),i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted w-20",children:"Qty"})]})}),i.jsx("tbody",{className:"divide-y dark:divide-white/10",children:c.map(d=>i.jsx(ot.Fragment,{children:l.map((h,p)=>{const x=e.find(v=>v.size===d&&v.fit===h);return x?i.jsxs("tr",{children:[p===0&&i.jsx("td",{rowSpan:l.filter(v=>e.some(w=>w.size===d&&w.fit===v)).length,className:"px-2 py-2 align-middle font-semibold border-r dark:border-white/10",children:d}),t.map(v=>i.jsx("td",{className:"px-2 py-2",children:x[v.key]},String(v.key))),i.jsx("td",{className:"px-2 py-2",children:o?i.jsx("span",{className:"font-semibold block text-center pr-4",children:a?.[x.id]||0}):i.jsx(_e,{name:`${s}.${x.id}`,control:r,render:({field:v})=>i.jsx(je,{"aria-label":`Quantity for ${n} size ${d} ${h}`,type:"number",...v,value:v.value||"",onChange:w=>v.onChange(parseInt(w.target.value)||null),className:"!py-1.5"})})})]},x.id):null})},d))})]})})]})},XL=()=>{const n=St(),{id:e}=Ff(),t=!!e,r=Ft("(max-width: 767px)"),[s,a]=E.useState([]),[o,l]=E.useState(null),[c,d]=E.useState(!0),[h,p]=E.useState(!1),[x,v]=E.useState(null),[w,_]=E.useState(null),{register:j,control:T,handleSubmit:P,watch:D,reset:M}=tn({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),O=D("gender");E.useEffect(()=>{(async()=>{d(!0);try{const[F,V,U]=await Promise.all([ue.getOrganizations(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);if(a(F),l({gents:V,ladies:U}),t&&e){const $=(await ue.getUniformRequests()).find(ne=>ne.id===e);if($){_($);const ne={},Y={};$.items.forEach(ae=>{ae.category==="Pants"?ne[ae.sizeId]=ae.quantity:Y[ae.sizeId]=ae.quantity}),M({siteId:$.siteId,gender:$.gender,pantsQuantities:ne,shirtsQuantities:Y})}else v({message:"Request not found.",type:"error"}),setTimeout(()=>n("/uniforms"),2e3)}}catch{v({message:"Failed to load data.",type:"error"})}finally{d(!1)}})()},[e,t,n,M]);const I=async q=>{if(!o)return;const F=s.find(V=>V.id===q.siteId);if(F){p(!0);try{const V=O==="Gents"?[...o.gents.pants,...o.gents.shirts]:[...o.ladies.pants,...o.ladies.shirts],U=[];for(const[$,ne]of Object.entries(q.pantsQuantities))if(ne&&ne>0){const Y=V.find(ae=>ae.id===$);Y&&U.push({sizeId:$,quantity:ne,category:"Pants",sizeLabel:Y.size,fit:Y.fit})}for(const[$,ne]of Object.entries(q.shirtsQuantities))if(ne&&ne>0){const Y=V.find(ae=>ae.id===$);Y&&U.push({sizeId:$,quantity:ne,category:"Shirts",sizeLabel:Y.size,fit:Y.fit})}const W={id:w?.id||`new_${Date.now()}`,siteId:q.siteId,siteName:F.shortName,gender:q.gender,requestedDate:w?.requestedDate||new Date().toISOString(),status:w?.status||"Pending",items:U};W.id.startsWith("new_")?(await ue.submitUniformRequest(W),v({message:"New request submitted.",type:"success"})):(await ue.updateUniformRequest(W),v({message:"Request updated.",type:"success"})),setTimeout(()=>n("/uniforms"),1500)}catch{v({message:"Failed to save request.",type:"error"})}finally{p(!1)}}};return c?i.jsx("div",{className:"flex justify-center items-center h-screen",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-emerald-600"})}):o?r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Request":"New Request"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Df,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit Uniform Request":"New Uniform Request"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Submit a request for new uniforms."})]}),i.jsxs("form",{onSubmit:P(I),className:"space-y-6",children:[i.jsxs(Ke,{label:"Select Site",...j("siteId"),required:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),s.map(q=>i.jsx("option",{value:q.id,children:q.shortName},q.id))]}),i.jsxs(Ke,{label:"Select Uniform Type",...j("gender"),children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]}),i.jsx("div",{className:"space-y-6",children:O==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Tc,{title:"Gents' Pants",sizes:o.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],control:T,quantityType:"pantsQuantities"}),i.jsx(Tc,{title:"Gents' Shirts",sizes:o.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],control:T,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Tc,{title:"Ladies' Pants",sizes:o.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:T,quantityType:"pantsQuantities"}),i.jsx(Tc,{title:"Ladies' Shirts",sizes:o.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:T,quantityType:"shirtsQuantities"})]})})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/uniforms"),disabled:h,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:P(I),disabled:h,className:"fo-btn-primary flex-1",children:h?"Saving...":"Save Request"})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Df,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit Uniform Request":"New Uniform Request"}),i.jsx("p",{className:"text-muted",children:"Submit a request for new uniforms."})]})]}),i.jsxs("form",{onSubmit:P(I),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(Ke,{label:"Select Site",...j("siteId"),required:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),s.map(q=>i.jsx("option",{value:q.id,children:q.shortName},q.id))]}),i.jsxs(Ke,{label:"Select Uniform Type",...j("gender"),children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]})]}),i.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:O==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Tc,{title:"Gents' Pants",sizes:o.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],control:T,quantityType:"pantsQuantities"}),i.jsx(Tc,{title:"Gents' Shirts",sizes:o.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],control:T,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Tc,{title:"Ladies' Pants",sizes:o.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:T,quantityType:"pantsQuantities"}),i.jsx(Tc,{title:"Ladies' Shirts",sizes:o.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:T,quantityType:"shirtsQuantities"})]})}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(se,{type:"button",onClick:()=>n("/uniforms"),variant:"secondary",disabled:h,children:"Cancel"}),i.jsx(se,{type:"submit",isLoading:h,children:h?"Saving...":"Save Request"})]})]})]}),x&&i.jsx(ht,{message:x.message,type:x.type,onDismiss:()=>v(null)})]}):null},yr=({label:n,isVerified:e,hasValue:t,error:r,registration:s,onManualInput:a,...o})=>{const{theme:l}=Jc(),c=l==="dark",h=s?{...s,onChange:async p=>{a&&a(),s?.onChange&&await s.onChange(p)}}:void 0;return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center mb-1",children:[i.jsx("label",{htmlFor:o.id,className:"block text-sm font-medium text-muted",children:n}),t&&(e?i.jsx("span",{className:`ml-2 flex items-center ${c?"text-green-400":"text-green-600"}`,title:"Verified from document",children:i.jsx(Yi,{className:"h-4 w-4"})}):i.jsx("span",{className:`ml-2 flex items-center ${c?"text-yellow-400":"text-yellow-500"}`,title:"Manually entered. Please verify.",children:i.jsx(Da,{className:"h-4 w-4"})}))]}),i.jsx(je,{id:o.id,error:r,registration:h,label:"",...o})]})},Iue=Pt({employeeId:ge().required(),firstName:ge().required("First name is required"),middleName:ge().optional(),lastName:ge().required("Last name is required"),preferredName:ge().optional(),dob:ge().required("Date of birth is required"),gender:ge().oneOf(["Male","Female","Other",""]).required("Gender is required"),maritalStatus:ge().oneOf(["Single","Married","Divorced","Widowed",""]).required("Marital status is required"),bloodGroup:ge().oneOf(["","A+","A-","B+","B-","AB+","AB-","O+","O-"]).required("Blood group is required"),mobile:ge().required("Mobile number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number"),alternateMobile:ge().optional().nullable(),email:ge().email("Must be a valid email").required("Email is required"),idProofType:ge().oneOf(["Aadhaar","PAN","Voter ID",""]).optional(),idProofNumber:ge().optional(),photo:Wt().optional().nullable(),idProofFront:Wt().optional().nullable(),idProofBack:Wt().optional().nullable(),emergencyContactName:ge().required("Emergency contact name is required"),emergencyContactNumber:ge().required("Emergency contact number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),relationship:ge().oneOf(["Spouse","Child","Father","Mother","Sibling","Other",""]).required("Relationship is required"),salary:as().typeError("Salary must be a number").min(0).required("Salary is required").nullable(),verifiedStatus:Pt().optional()}).defined(),Aue=()=>{const{onValidated:n}=vi(),{data:e,updatePersonal:t,addOrUpdateEmergencyContactAsFamilyMember:r,setPersonalVerifiedStatus:s}=$n(),{register:a,handleSubmit:o,formState:{errors:l},control:c,reset:d,watch:h}=tn({resolver:En(Iue),defaultValues:e.personal}),p=h();E.useEffect(()=>{d(e.personal)},[e.personal,d]),E.useEffect(()=>{let v;const w=h(_=>{clearTimeout(v),v=window.setTimeout(()=>{t(_)},500)});return()=>{w.unsubscribe(),clearTimeout(v)}},[h,t]);const x=async v=>{t(v),r(),await n()};return i.jsxs("form",{onSubmit:o(x),id:"personal-form",children:[i.jsx("div",{className:"text-left",children:i.jsx(Pr,{title:"Personal Details",subtitle:"Please provide your personal information as per your official documents."})}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-8 md:items-start",children:[i.jsx("div",{className:"flex-shrink-0 mx-auto md:mx-0",children:i.jsx(_e,{name:"photo",control:c,render:({field:v})=>i.jsx(WS,{file:v.value,onFileChange:w=>v.onChange(w)})})}),i.jsxs("div",{className:"w-full flex-grow grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(je,{label:"Employee ID",id:"employeeId",registration:a("employeeId"),error:l.employeeId?.message,readOnly:!0,className:"bg-gray-100"})}),i.jsx(yr,{label:"First Name",id:"firstName",registration:a("firstName"),error:l.firstName?.message,isVerified:e.personal.verifiedStatus?.name===!0,hasValue:!!p.firstName,onManualInput:()=>s({name:!1})}),i.jsx(je,{label:"Middle Name (Optional)",id:"middleName",registration:a("middleName")}),i.jsx(yr,{label:"Last Name",id:"lastName",registration:a("lastName"),error:l.lastName?.message,isVerified:e.personal.verifiedStatus?.name===!0,hasValue:!!p.lastName,onManualInput:()=>s({name:!1})}),i.jsx(je,{label:"Preferred Name (Optional)",id:"preferredName",registration:a("preferredName")}),i.jsx(_e,{name:"dob",control:c,render:({field:v})=>i.jsx(kn,{label:"Date of Birth",id:"dob",error:l.dob?.message,value:v.value,onChange:w=>{v.onChange(w),s({dob:!1})},maxDate:new Date})}),i.jsxs(Ke,{label:"Gender",id:"gender",registration:a("gender"),error:l.gender?.message,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{children:"Male"}),i.jsx("option",{children:"Female"}),i.jsx("option",{children:"Other"})]}),i.jsxs(Ke,{label:"Marital Status",id:"maritalStatus",registration:a("maritalStatus"),error:l.maritalStatus?.message,children:[i.jsx("option",{value:"",children:"Select Status"}),i.jsx("option",{children:"Single"}),i.jsx("option",{children:"Married"}),i.jsx("option",{children:"Divorced"}),i.jsx("option",{children:"Widowed"})]}),i.jsxs(Ke,{label:"Blood Group",id:"bloodGroup",registration:a("bloodGroup"),error:l.bloodGroup?.message,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"A+"}),i.jsx("option",{children:"A-"}),i.jsx("option",{children:"B+"}),i.jsx("option",{children:"B-"}),i.jsx("option",{children:"AB+"}),i.jsx("option",{children:"AB-"}),i.jsx("option",{children:"O+"}),i.jsx("option",{children:"O-"})]}),i.jsx(je,{label:"Mobile Number",id:"mobile",type:"tel",registration:a("mobile"),error:l.mobile?.message}),i.jsx(je,{label:"Alternate Mobile (Optional)",id:"alternateMobile",type:"tel",registration:a("alternateMobile")}),i.jsx(je,{label:"Email Address",id:"email",type:"email",registration:a("email"),error:l.email?.message}),i.jsx(je,{label:"Monthly Salary (Gross)",id:"salary",type:"number",registration:a("salary"),error:l.salary?.message}),i.jsxs("div",{className:"md:col-span-3 pt-4 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Emergency Contact"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[i.jsx(je,{label:"Contact Name",id:"emergencyContactName",registration:a("emergencyContactName"),error:l.emergencyContactName?.message}),i.jsx(je,{label:"Contact Number",id:"emergencyContactNumber",type:"tel",registration:a("emergencyContactNumber"),error:l.emergencyContactNumber?.message}),i.jsxs(Ke,{label:"Relationship",id:"relationship",registration:a("relationship"),error:l.relationship?.message,children:[i.jsx("option",{value:"",children:"Select Relationship"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"}),i.jsx("option",{children:"Sibling"}),i.jsx("option",{children:"Other"})]})]})]})]})]})]})},e4=Pt({line1:ge().required("Address line 1 is required"),line2:ge().optional(),city:ge().required("City is required"),state:ge().required("State is required"),country:ge().required("Country is required"),pincode:ge().required("Pincode is required").matches(/^[1-9][0-9]{5}$/,"Must be a valid 6-digit Indian pincode"),verifiedStatus:Pt().optional()}).defined(),Rue=Pt({present:e4.required(),permanent:e4.required(),sameAsPresent:is().required()}).defined(),Lue=()=>{const{onValidated:n}=vi(),{data:e,updateAddress:t,setAddressVerifiedStatus:r}=$n(),{address:s}=gi(),[a,o]=E.useState(!1),[l,c]=E.useState(""),{register:d,handleSubmit:h,formState:{errors:p},control:x,setValue:v,trigger:w,getValues:_,reset:j,watch:T}=tn({resolver:En(Rue),defaultValues:e.address}),P=au({control:x,name:"sameAsPresent"}),D=au({control:x,name:"present"}),M=au({control:x,name:"permanent"});E.useEffect(()=>{j(e.address)},[e.address,j]),E.useEffect(()=>{let F;const V=T(U=>{clearTimeout(F),F=window.setTimeout(()=>{t(U)},500)});return()=>{V.unsubscribe(),clearTimeout(F)}},[T,t]),E.useEffect(()=>{P&&(v("permanent",D),w("permanent"))},[P,D,v,w]);const O=(F,V)=>{r(F,{[V]:!1})},I=async F=>{const V=F.target.value;if(O("present","pincode"),s.enablePincodeVerification&&/^[1-9][0-9]{5}$/.test(V)){o(!0),c("");try{const U=await ue.getPincodeDetails(V);v("present.city",U.city,{shouldValidate:!0}),v("present.state",U.state,{shouldValidate:!0}),r("present",{city:!0,state:!0,pincode:!0})}catch{c("Invalid Pincode. Please check and try again.")}finally{o(!1)}}},q=async F=>{t(F),await n()};return i.jsxs("form",{onSubmit:h(q),id:"address-form",children:[i.jsx(Pr,{title:"Address Details",subtitle:"Your communication and permanent address."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Present Address"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(yr,{label:"Address Line 1",id:"present.line1",isVerified:!!e.address.present.verifiedStatus?.line1,hasValue:!!D?.line1,onManualInput:()=>O("present","line1"),error:p.present?.line1?.message,registration:d("present.line1")})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(je,{label:"Address Line 2 (Optional)",id:"present.line2",registration:d("present.line2")})}),i.jsx(yr,{label:"Country",id:"present.country",isVerified:!!e.address.present.verifiedStatus?.country,hasValue:!!D?.country,onManualInput:()=>O("present","country"),error:p.present?.country?.message,registration:d("present.country")}),i.jsxs("div",{className:"relative",children:[i.jsx(yr,{label:"Pincode",id:"present.pincode",type:"tel",isVerified:!!e.address.present.verifiedStatus?.pincode,hasValue:!!D?.pincode,error:p.present?.pincode?.message||l,registration:d("present.pincode"),onBlur:I}),a&&i.jsx(_t,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]}),i.jsx(yr,{label:"City",id:"present.city",isVerified:!!e.address.present.verifiedStatus?.city,hasValue:!!D?.city,onManualInput:()=>O("present","city"),error:p.present?.city?.message,registration:d("present.city")}),i.jsx(yr,{label:"State",id:"present.state",isVerified:!!e.address.present.verifiedStatus?.state,hasValue:!!D?.state,onManualInput:()=>O("present","state"),error:p.present?.state?.message,registration:d("present.state")})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Permanent Address"}),i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("input",{id:"sameAsPresent",type:"checkbox",...d("sameAsPresent"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),i.jsx("label",{htmlFor:"sameAsPresent",className:"ml-2 block text-sm text-muted",children:"Same as Present Address"})]}),!P&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(yr,{label:"Address Line 1",id:"permanent.line1",isVerified:!!e.address.permanent.verifiedStatus?.line1,hasValue:!!M?.line1,onManualInput:()=>O("permanent","line1"),error:p.permanent?.line1?.message,registration:d("permanent.line1")})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(je,{label:"Address Line 2 (Optional)",id:"permanent.line2",registration:d("permanent.line2")})}),i.jsx(yr,{label:"Country",id:"permanent.country",isVerified:!!e.address.permanent.verifiedStatus?.country,hasValue:!!M?.country,onManualInput:()=>O("permanent","country"),error:p.permanent?.country?.message,registration:d("permanent.country")}),i.jsx(yr,{label:"Pincode",id:"permanent.pincode",type:"tel",isVerified:!!e.address.permanent.verifiedStatus?.pincode,hasValue:!!M?.pincode,onManualInput:()=>O("permanent","pincode"),error:p.permanent?.pincode?.message,registration:d("permanent.pincode")}),i.jsx(yr,{label:"City",id:"permanent.city",isVerified:!!e.address.permanent.verifiedStatus?.city,hasValue:!!M?.city,onManualInput:()=>O("permanent","city"),error:p.permanent?.city?.message,registration:d("permanent.city")}),i.jsx(yr,{label:"State",id:"permanent.state",isVerified:!!e.address.permanent.verifiedStatus?.state,hasValue:!!M?.state,onManualInput:()=>O("permanent","state"),error:p.permanent?.state?.message,registration:d("permanent.state")})]})]})]})]})},Fue=Pt({designation:ge().required("Designation is required"),department:ge().required("Department is required"),reportingManager:ge().optional(),organizationId:ge().required("Organization is required"),organizationName:ge().required(),joiningDate:ge().required("Joining date is required"),workType:ge().oneOf(["Full-time","Part-time","Contract",""]).required("Work type is required"),site:ge().optional(),defaultSalary:as().nullable().optional()}).defined(),que=()=>{const{onValidated:n}=vi(),{user:e}=jt(),{data:t,updateOrganization:r}=$n(),[s,a]=E.useState([]),o=Ft("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:h,watch:p,setValue:x,reset:v}=tn({resolver:En(Fue),defaultValues:t.organization}),w=p("organizationId"),_=p("designation"),j=!!t.organization.organizationId;E.useEffect(()=>{ue.getOrganizations().then(a)},[]),E.useEffect(()=>{v(t.organization)},[t.organization,v]),E.useEffect(()=>{let P;const D=p(M=>{clearTimeout(P),P=window.setTimeout(()=>{r(M)},500)});return()=>{D.unsubscribe(),clearTimeout(P)}},[p,r]),E.useEffect(()=>{const P=s.find(D=>D.id===w);P&&x("organizationName",P.shortName)},[w,s,x]),E.useEffect(()=>{_&&ue.suggestDepartmentForDesignation(_).then(P=>{P&&x("department",P,{shouldValidate:!0})})},[_,x]);const T=async P=>{r(P),await n()};return o?i.jsx("form",{onSubmit:c(T),id:"organization-form",children:i.jsxs("div",{className:"space-y-6",children:[i.jsx("p",{className:"text-sm text-gray-400",children:"Provide the employment details for the new employee within the organization."}),i.jsxs("select",{...l("organizationId"),className:"pro-select pro-select-arrow",disabled:j,children:[i.jsx("option",{value:"",children:"Select Organization"}),s.map(P=>i.jsx("option",{value:P.id,children:P.shortName},P.id))]}),d.organizationId&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.organizationId.message}),i.jsx("input",{placeholder:"Designation",...l("designation"),className:"form-input"}),i.jsx("input",{placeholder:"Department",...l("department"),className:"form-input"}),i.jsx("input",{placeholder:"Reporting Manager",...l("reportingManager"),className:"form-input"}),i.jsx(_e,{name:"joiningDate",control:h,render:({field:P})=>i.jsx("input",{type:"date",...P,className:"form-input"})}),d.joiningDate&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.joiningDate.message}),i.jsxs("select",{...l("workType"),className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"Select Work Type"}),i.jsx("option",{children:"Full-time"}),i.jsx("option",{children:"Part-time"}),i.jsx("option",{children:"Contract"})]}),d.workType&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.workType.message})]})}):i.jsxs("form",{onSubmit:c(T),id:"organization-form",children:[i.jsx(Pr,{title:"Organization Details",subtitle:"Your employment details within the organization."}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsxs(Ke,{label:"Organization / Client",id:"organizationId",error:d.organizationId?.message,registration:l("organizationId"),disabled:j,children:[i.jsx("option",{value:"",children:"Select Organization"}),s.map(P=>i.jsx("option",{value:P.id,children:P.shortName},P.id))]}),i.jsx(je,{label:"Designation",id:"designation",error:d.designation?.message,registration:l("designation")}),i.jsx(je,{label:"Department",id:"department",error:d.department?.message,registration:l("department")}),i.jsx(je,{label:"Reporting Manager",id:"reportingManager",error:d.reportingManager?.message,registration:l("reportingManager")}),i.jsx(_e,{name:"joiningDate",control:h,render:({field:P})=>i.jsx(kn,{label:"Joining Date",id:"joiningDate",error:d.joiningDate?.message,value:P.value,onChange:P.onChange})}),i.jsxs(Ke,{label:"Work Type",id:"workType",error:d.workType?.message,registration:l("workType"),children:[i.jsx("option",{value:"",children:"Select Work Type"}),i.jsx("option",{children:"Full-time"}),i.jsx("option",{children:"Part-time"}),i.jsx("option",{children:"Contract"})]})]})]})},zue=()=>{const{onValidated:n,setToast:e}=vi(),{data:t,updateFamily:r}=$n(),{rulesByDesignation:s}=Qc(),a=Ft("(max-width: 767px)"),o=t.organization.designation,l=E.useMemo(()=>{const $=o&&s[o];return $?$.documents.familyAadhaar:!1},[o,s]),c=Pt({id:ge().required(),relation:ge().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),name:ge().required("Name is required"),dob:ge().required("Date of birth is required"),gender:ge().oneOf(["Male","Female","Other",""]).required("Gender is required"),occupation:ge().optional(),dependent:is().required(),phone:ge().when("relation",{is:"Child",then:$=>$.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:$=>$.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:Wt().nullable().when([],{is:()=>l,then:$=>$.test("is-required","Aadhaar proof is required for this designation.",ne=>ne!=null).nullable(),otherwise:$=>$.optional().nullable()})}),d=Pt({family:_s().of(c).required()}),{control:h,handleSubmit:p,formState:{errors:x},watch:v,setValue:w}=tn({resolver:En(d),defaultValues:{family:t.family}}),{fields:_,append:j,remove:T}=js({control:h,name:"family"}),[P,D]=E.useState(!1),[M,O]=E.useState(null);E.useEffect(()=>{let $;const ne=v(Y=>{clearTimeout($),$=window.setTimeout(()=>{r(Y.family)},500)});return()=>{ne.unsubscribe(),clearTimeout($)}},[v,r]);const I=$=>ne=>{let Y=!1;if(ne.name){const ae=ne.name.toLowerCase().replace(/\b(\w)/g,J=>J.toUpperCase());w(`family.${$}.name`,ae,{shouldValidate:!0}),Y=!0}if(ne.dob)try{const ae=ne.dob.replace(/[/.]/g,"-"),J=["dd-MM-yyyy","yyyy-MM-dd","MM-dd-yyyy","d-M-yyyy"];let ee=null;for(const X of J){const Z=B$(ae,X,new Date);if(!isNaN(Z.getTime())){ee=Z;break}}if(ee){const X=$e(ee,"yyyy-MM-dd");w(`family.${$}.dob`,X,{shouldValidate:!0}),Y=!0}}catch{console.error("Could not parse date from OCR:",ne.dob)}if(ne.gender){const ae=ne.gender.toLowerCase().trim();ae.includes("male")||ae.includes("purush")||ae==="m"?(w(`family.${$}.gender`,"Male",{shouldValidate:!0}),Y=!0):(ae.includes("female")||ae.includes("mahila")||ae==="f")&&(w(`family.${$}.gender`,"Female",{shouldValidate:!0}),Y=!0)}Y&&e({message:"Family member details auto-filled.",type:"success"})},q={type:et.OBJECT,properties:{name:{type:et.STRING},dob:{type:et.STRING},gender:{type:et.STRING}}},F=()=>{j({id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""})},V=$=>{O($),D(!0)},U=()=>{M!==null&&(T(M),D(!1),O(null))},W=async $=>{r($.family),await n()};return a?i.jsxs("form",{onSubmit:p(W),id:"family-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List your immediate family members."}),i.jsx("div",{className:"space-y-4",children:_.map(($,ne)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[i.jsx("button",{type:"button",onClick:()=>V(ne),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove family member",children:i.jsx(rn,{className:"h-5 w-5"})}),i.jsx(_e,{name:`family.${ne}.relation`,control:h,render:({field:Y})=>i.jsxs("select",{...Y,className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"Select Relation"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})]})}),i.jsx(_e,{name:`family.${ne}.name`,control:h,render:({field:Y})=>i.jsx("input",{placeholder:"Full Name",...Y,className:"form-input"})}),i.jsx(_e,{name:`family.${ne}.dob`,control:h,render:({field:Y})=>i.jsx("input",{type:"date",placeholder:"Date of Birth",...Y,className:"form-input"})}),i.jsx(_e,{name:`family.${ne}.phone`,control:h,render:({field:Y})=>i.jsx("input",{placeholder:"Phone Number",type:"tel",...Y,className:"form-input"})})]},$.id))}),i.jsxs(se,{type:"button",onClick:F,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]}):i.jsxs("form",{onSubmit:p(W),id:"family-form",children:[i.jsx(Yr,{isOpen:P,onClose:()=>D(!1),onConfirm:U,title:"Confirm Deletion",children:"Are you sure you want to remove this family member? This action cannot be undone."}),i.jsx(Pr,{title:"Family Details",subtitle:"List your immediate family members."}),i.jsx("div",{className:"space-y-6",children:_.map(($,ne)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[i.jsx("button",{type:"button",onClick:()=>V(ne),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${$.name}`,children:i.jsx(rn,{className:"h-4 w-4"})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`family.${ne}.relation`,control:h,render:({field:Y})=>i.jsxs(Ke,{label:"Relation",id:Y.name,error:x.family?.[ne]?.relation?.message,...Y,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})]})}),i.jsx(_e,{name:`family.${ne}.name`,control:h,render:({field:Y})=>i.jsx(je,{label:"Full Name",id:Y.name,error:x.family?.[ne]?.name?.message,...Y})}),i.jsx(_e,{name:`family.${ne}.dob`,control:h,render:({field:Y})=>i.jsx(kn,{label:"Date of Birth",id:Y.name,value:Y.value,onChange:Y.onChange,error:x.family?.[ne]?.dob?.message,maxDate:new Date})}),i.jsx(_e,{name:`family.${ne}.gender`,control:h,render:({field:Y})=>i.jsxs(Ke,{label:"Gender",id:Y.name,error:x.family?.[ne]?.gender?.message,...Y,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Male"}),i.jsx("option",{children:"Female"}),i.jsx("option",{children:"Other"})]})}),i.jsx(_e,{name:`family.${ne}.phone`,control:h,render:({field:Y})=>i.jsx(je,{label:"Phone Number",id:Y.name,type:"tel",error:x.family?.[ne]?.phone?.message,...Y,value:Y.value??""})}),i.jsx(_e,{name:`family.${ne}.occupation`,control:h,render:({field:Y})=>i.jsx(je,{label:"Occupation (Optional)",id:Y.name,...Y,value:Y.value??""})}),i.jsx("div",{className:"col-span-full md:col-span-1 flex items-center pt-5",children:i.jsx(_e,{name:`family.${ne}.dependent`,control:h,render:({field:Y})=>i.jsx(Pn,{id:Y.name,label:"Is a dependent?",checked:Y.value,onChange:Y.onChange})})}),i.jsx("div",{className:"col-span-full",children:i.jsx(_e,{name:`family.${ne}.idProof`,control:h,render:({field:Y,fieldState:ae})=>i.jsx(yt,{label:`Aadhaar Proof ${l?"(Mandatory)":"(Optional)"}`,file:Y.value,onFileChange:Y.onChange,onOcrComplete:I(ne),ocrSchema:q,setToast:e,error:ae.error?.message,docType:"Aadhaar"})})})]})]},$.id))}),i.jsxs(se,{type:"button",onClick:F,variant:"outline",className:"mt-6",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})},Uue=()=>{const{onValidated:n,setToast:e}=vi(),{user:t}=jt(),{data:r,updateEducation:s,updateEducationRecord:a}=$n(),o=Ft("(max-width: 767px)"),l=E.useMemo(()=>/manager|admin|head/i.test(r.organization.designation),[r.organization.designation]),c=E.useMemo(()=>Pt({id:ge().required(),degree:ge().required("Degree is required"),institution:ge().required("Institution is required"),startYear:ge().required("Start year is required").matches(/^\d{4}$/,"Must be a 4-digit year"),endYear:ge().required("End year is required").matches(/^\d{4}$/,"Must be a 4-digit year").test("is-after-start-year","End year must be on or after start year",function(ne){const{startYear:Y}=this.parent;return!Y||!ne||parseInt(ne)>=parseInt(Y)}),percentage:as().nullable().min(0).max(100).optional(),grade:ge().optional(),document:Wt().nullable().when([],{is:()=>l,then:ne=>ne.required("Certificate is mandatory for this role.").nullable(),otherwise:ne=>ne.optional().nullable()})}).defined(),[l]),d=Pt({education:_s().of(c).required()}),{control:h,handleSubmit:p,formState:{errors:x},setValue:v,reset:w,watch:_}=tn({resolver:En(d),context:{isAdminOrManager:l},mode:"onBlur"}),{fields:j,append:T,remove:P}=js({control:h,name:"education"}),[D,M]=E.useState(!1),[O,I]=E.useState(null);E.useEffect(()=>{w({education:r.education})},[r.education,w]),E.useEffect(()=>{let ne;const Y=_(ae=>{clearTimeout(ne),ne=window.setTimeout(()=>{s(ae.education)},500)});return()=>{Y.unsubscribe(),clearTimeout(ne)}},[_,s]);const q=()=>{T({id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""})},F=ne=>{I(ne),M(!0)},V=()=>{O!==null&&(P(O),M(!1),I(null))},U=async ne=>{s(ne.education),await n()},W=ne=>Y=>{const ae=j[ne].id,J={};if(Y.degree&&(v(`education.${ne}.degree`,Y.degree,{shouldValidate:!0}),J.degree=Y.degree),Y.institution&&(v(`education.${ne}.institution`,Y.institution,{shouldValidate:!0}),J.institution=Y.institution),Y.endYear){const ee=Y.endYear.toString();v(`education.${ne}.endYear`,ee,{shouldValidate:!0}),J.endYear=ee}Object.keys(J).length>0&&(a(ae,J),e({message:"Education details auto-filled.",type:"success"}))},$={type:et.OBJECT,properties:{degree:{type:et.STRING,description:"The name of the degree, diploma, or certificate."},institution:{type:et.STRING,description:"The name of the university, college, or institution."},endYear:{type:et.STRING,description:"The year of completion or graduation as a 4-digit number."}},required:["degree","institution","endYear"]};return o?i.jsxs("form",{onSubmit:p(U),id:"education-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List educational qualifications, starting with the most recent."}),i.jsx("div",{className:"space-y-4",children:j.map((ne,Y)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[i.jsx("button",{type:"button",onClick:()=>F(Y),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove qualification",children:i.jsx(rn,{className:"h-5 w-5"})}),i.jsx(_e,{name:`education.${Y}.degree`,control:h,render:({field:ae})=>i.jsx("input",{placeholder:"Degree / Certificate",...ae,className:"form-input"})}),i.jsx(_e,{name:`education.${Y}.institution`,control:h,render:({field:ae})=>i.jsx("input",{placeholder:"Institution / University",...ae,className:"form-input"})}),i.jsx(_e,{name:`education.${Y}.endYear`,control:h,render:({field:ae})=>i.jsx("input",{placeholder:"Year of Completion",type:"text",maxLength:4,...ae,className:"form-input"})}),i.jsx(_e,{name:`education.${Y}.document`,control:h,render:({field:ae,fieldState:J})=>i.jsx(yt,{label:`Certificate ${l?"(Mandatory)":"(Optional)"}`,file:ae.value,onFileChange:ae.onChange,error:J.error?.message,allowCapture:!0})})]},ne.id))}),i.jsxs(se,{type:"button",onClick:q,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]}):i.jsxs("form",{onSubmit:p(U),id:"education-form",children:[i.jsx(Yr,{isOpen:D,onClose:()=>M(!1),onConfirm:V,title:"Confirm Deletion",children:"Are you sure you want to remove this education record? This action cannot be undone."}),i.jsx(Pr,{title:"Education Details",subtitle:"List your educational qualifications, starting with the most recent."}),i.jsx("div",{className:"space-y-6",children:j.map((ne,Y)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[i.jsx("button",{type:"button",onClick:()=>F(Y),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${ne.degree}`,children:i.jsx(rn,{className:"h-4 w-4"})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(_e,{name:`education.${Y}.degree`,control:h,render:({field:ae})=>i.jsx(je,{label:"Degree / Certificate",id:ae.name,error:x.education?.[Y]?.degree?.message,...ae})}),i.jsx(_e,{name:`education.${Y}.institution`,control:h,render:({field:ae})=>i.jsx(je,{label:"Institution / University",id:ae.name,error:x.education?.[Y]?.institution?.message,...ae})}),i.jsx(_e,{name:`education.${Y}.startYear`,control:h,render:({field:ae})=>i.jsx(je,{label:"Start Year",id:ae.name,type:"text",maxLength:4,error:x.education?.[Y]?.startYear?.message,...ae})}),i.jsx(_e,{name:`education.${Y}.endYear`,control:h,render:({field:ae})=>i.jsx(je,{label:"End Year",id:ae.name,type:"text",maxLength:4,error:x.education?.[Y]?.endYear?.message,...ae})}),i.jsx(_e,{name:`education.${Y}.percentage`,control:h,render:({field:ae})=>i.jsx(je,{label:"Percentage (Optional)",id:ae.name,type:"number",error:x.education?.[Y]?.percentage?.message,...ae,value:ae.value??""})}),i.jsx(_e,{name:`education.${Y}.grade`,control:h,render:({field:ae})=>i.jsx(je,{label:"Grade (Optional)",id:ae.name,type:"text",error:x.education?.[Y]?.grade?.message,...ae,value:ae.value??""})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(_e,{name:`education.${Y}.document`,control:h,render:({field:ae,fieldState:J})=>i.jsx(yt,{label:`Upload Certificate ${l?"(Mandatory)":"(Optional)"}`,file:ae.value,onFileChange:ae.onChange,onOcrComplete:W(Y),ocrSchema:$,setToast:e,error:J.error?.message})})})]})]},ne.id))}),i.jsxs(se,{type:"button",onClick:q,variant:"outline",className:"mt-6",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})},eC=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",Vue=ge().matches(/^[a-zA-Z\s.'-]*$/,"Name can only contain letters and spaces").transform(eC),Bue=Pt({accountHolderName:Vue.required("Account holder name is required"),accountNumber:ge().required("Account number is required").matches(/^[0-9]+$/,"Must be only digits"),confirmAccountNumber:ge().oneOf([qC("accountNumber")],"Account numbers must match").required("Please confirm your account number"),ifscCode:ge().required("IFSC code is required").transform(n=>n.toUpperCase()).matches(/^[A-Z]{4}0[A-Z0-9]{6}$/,"Invalid IFSC code format (e.g., SBIN0123456)"),bankName:ge().required("Bank name is required"),branchName:ge().required("Branch name is required"),bankProof:Wt().optional().nullable(),verifiedStatus:Pt().optional()}).defined(),Wue=()=>{const{onValidated:n,setToast:e}=vi(),{user:t}=jt(),{data:r,updateBank:s,setBankVerifiedStatus:a}=$n(),o=Ft("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:h,setValue:p,watch:x,reset:v}=tn({resolver:En(Bue),defaultValues:r.bank});E.useEffect(()=>{v(r.bank)},[r.bank,v]),E.useEffect(()=>{let M;const O=x(I=>{clearTimeout(M),M=window.setTimeout(()=>{s(I)},500)});return()=>{O.unsubscribe(),clearTimeout(M)}},[x,s]);const w=x(),_=async M=>{s(M),await n()},j=M=>{const O=M.target.value;p("accountHolderName",eC(O),{shouldValidate:!0})},T=M=>{const O={};M.forEach(I=>{O[I]=!1}),a(O)},P=M=>{const O={},I={};if(M.accountHolderName){const q=eC(M.accountHolderName);p("accountHolderName",q,{shouldValidate:!0}),O.accountHolderName=q,I.accountHolderName=!0}if(M.accountNumber){const q=M.accountNumber.replace(/\D/g,"");p("accountNumber",q,{shouldValidate:!0}),p("confirmAccountNumber",q,{shouldValidate:!0}),O.accountNumber=q,O.confirmAccountNumber=q,I.accountNumber=!0}if(M.ifscCode){const q=M.ifscCode.toUpperCase().replace(/\s/g,"");p("ifscCode",q,{shouldValidate:!0}),O.ifscCode=q,I.ifscCode=!0}M.bankName&&(p("bankName",M.bankName,{shouldValidate:!0}),O.bankName=M.bankName),M.branchName&&(p("branchName",M.branchName,{shouldValidate:!0}),O.branchName=M.branchName),Object.keys(O).length>0&&s(O),a(I),e({message:"Bank details extracted. Please review.",type:"success"})},D={type:et.OBJECT,properties:{accountHolderName:{type:et.STRING,description:"The account holder's full name."},accountNumber:{type:et.STRING,description:"The full bank account number."},ifscCode:{type:et.STRING,description:"The bank's IFSC code."},bankName:{type:et.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:et.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}},required:["accountHolderName","accountNumber","ifscCode","bankName","branchName"]};return o?i.jsxs("form",{onSubmit:c(_),id:"bank-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Your salary will be credited to this account."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("input",{placeholder:"Account Holder Name",...l("accountHolderName"),onBlur:j,className:"form-input"}),i.jsx("input",{placeholder:"Bank Name",...l("bankName"),className:"form-input"}),i.jsx("input",{placeholder:"Account Number",...l("accountNumber"),className:"form-input"}),i.jsx("input",{placeholder:"Confirm Account Number",...l("confirmAccountNumber"),className:"form-input"}),i.jsx("input",{placeholder:"IFSC Code",...l("ifscCode"),className:"form-input"}),i.jsx("input",{placeholder:"Branch Name",...l("branchName"),className:"form-input"}),i.jsx(_e,{name:"bankProof",control:h,render:({field:M})=>i.jsx(yt,{label:"Upload Bank Proof (Optional)",file:M.value,onFileChange:M.onChange,allowCapture:!0})})]})]}):i.jsxs("form",{onSubmit:c(_),id:"bank-form",children:[i.jsx(Pr,{title:"Bank Details",subtitle:"Your salary will be credited to this account."}),i.jsxs("div",{className:"space-y-6",children:[i.jsx(_e,{name:"bankProof",control:h,render:({field:M})=>i.jsx(yt,{label:"Upload Bank Proof (Cancelled Cheque/Passbook)",file:M.value,onFileChange:M.onChange,onOcrComplete:P,ocrSchema:D,setToast:e})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 pt-6 border-t",children:[i.jsx(yr,{label:"Account Holder Name",id:"accountHolderName",hasValue:!!w.accountHolderName,isVerified:r.bank.verifiedStatus?.accountHolderName===!0,onManualInput:()=>T(["accountHolderName"]),error:d.accountHolderName?.message,registration:l("accountHolderName"),onBlur:j}),i.jsx(yr,{label:"Bank Name",id:"bankName",hasValue:!!w.bankName,isVerified:!1,error:d.bankName?.message,registration:l("bankName")}),i.jsx(yr,{label:"Account Number",id:"accountNumber",hasValue:!!w.accountNumber,isVerified:r.bank.verifiedStatus?.accountNumber===!0,onManualInput:()=>T(["accountNumber"]),error:d.accountNumber?.message,registration:l("accountNumber")}),i.jsx(yr,{label:"Confirm Account Number",id:"confirmAccountNumber",hasValue:!!w.confirmAccountNumber,isVerified:r.bank.verifiedStatus?.accountNumber===!0,onManualInput:()=>T(["accountNumber"]),error:d.confirmAccountNumber?.message,registration:l("confirmAccountNumber")}),i.jsx(yr,{label:"IFSC Code",id:"ifscCode",hasValue:!!w.ifscCode,isVerified:r.bank.verifiedStatus?.ifscCode===!0,onManualInput:()=>T(["ifscCode"]),error:d.ifscCode?.message,registration:l("ifscCode")}),i.jsx(yr,{label:"Branch Name",id:"branchName",hasValue:!!w.branchName,isVerified:!1,error:d.branchName?.message,registration:l("branchName")})]})]})]})},$ue=Pt({hasPreviousPf:is().required(),uanNumber:ge().when("hasPreviousPf",{is:!0,then:n=>n.required("UAN Number is required").matches(/^[0-9]{12}$/,"UAN must be 12 digits"),otherwise:n=>n.optional().nullable()}),pfNumber:ge().when("hasPreviousPf",{is:!0,then:n=>n.optional().nullable(),otherwise:n=>n.optional().nullable()}),document:Wt().optional().nullable(),salarySlip:Wt().optional().nullable(),verifiedStatus:Pt().optional()}).defined(),Hue=()=>{const{onValidated:n,setToast:e}=vi(),{user:t}=jt(),{data:r,updateUan:s,setUanVerifiedStatus:a}=$n(),o=Ft("(max-width: 767px)"),{register:l,control:c,handleSubmit:d,formState:{errors:h},setValue:p,watch:x,reset:v}=tn({resolver:En($ue),defaultValues:r.uan});E.useEffect(()=>{v(r.uan)},[r.uan,v]),E.useEffect(()=>{let M;const O=x(I=>{clearTimeout(M),M=window.setTimeout(()=>{s(I)},500)});return()=>{O.unsubscribe(),clearTimeout(M)}},[x,s]);const w=x("hasPreviousPf"),_=x(),j=async M=>{s(M),await n()},T=()=>{a({uanNumber:!1})},P=M=>{if(M.uanNumber){const O=M.uanNumber.replace(/\D/g,"");if(O.length===12){const I={uanNumber:O,hasPreviousPf:!0};p("uanNumber",O,{shouldValidate:!0}),p("hasPreviousPf",!0,{shouldValidate:!0}),s(I),a({uanNumber:!0}),e({message:"UAN extracted successfully.",type:"success"})}}},D={type:et.OBJECT,properties:{uanNumber:{type:et.STRING,description:"The 12-digit Universal Account Number (UAN)."}},required:["uanNumber"]};return o?i.jsxs("form",{onSubmit:d(j),id:"uan-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Universal Account Number if you have one."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",...l("hasPreviousPf"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"Do you have a previous PF account or UAN?"})]}),w&&i.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[i.jsx("input",{placeholder:"UAN Number",...l("uanNumber"),className:"form-input"}),i.jsx("input",{placeholder:"PF Number (Optional)",...l("pfNumber"),className:"form-input"}),i.jsx(_e,{name:"document",control:c,render:({field:M})=>i.jsx(yt,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,allowCapture:!0,costingItemName:"EPF UAN Lookup"})})]})]})]}):i.jsxs("form",{onSubmit:d(j),id:"uan-form",children:[i.jsx(Pr,{title:"UAN / PF Details",subtitle:"Provide your Universal Account Number if you have one."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"hasPreviousPf",type:"checkbox",...l("hasPreviousPf"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),i.jsx("label",{htmlFor:"hasPreviousPf",className:"ml-2 block text-sm text-muted",children:"Do you have a previous PF account or UAN?"})]}),r.uan.salarySlip&&i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-2",children:"Reference Salary Slip"}),i.jsx(yt,{label:"",file:r.uan.salarySlip,onFileChange:()=>{}})]}),w&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx(yr,{label:"UAN Number",id:"uanNumber",hasValue:!!_.uanNumber,isVerified:r.uan.verifiedStatus?.uanNumber===!0,onManualInput:T,registration:l("uanNumber"),error:h.uanNumber?.message}),i.jsx(je,{label:"PF Number (Optional)",id:"pfNumber",registration:l("pfNumber"),error:h.pfNumber?.message})]}),i.jsx(_e,{name:"document",control:c,render:({field:M})=>i.jsx(yt,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,onOcrComplete:P,ocrSchema:D,setToast:e,costingItemName:"EPF UAN Lookup"})})]})]})]})},Yue=Pt({hasEsi:is().required(),esiNumber:ge().when("hasEsi",{is:!0,then:n=>n.required("ESI Number is required").matches(/^(\d{10}|\d{17})$/,"ESI number must be 10 or 17 digits"),otherwise:n=>n.optional().nullable()}),esiRegistrationDate:ge().when("hasEsi",{is:!0,then:n=>n.required("Registration date is required").test("not-in-future","Registration date cannot be in the future",e=>e?new Date(e.replace(/-/g,"/"))<=new Date:!0),otherwise:n=>n.optional().nullable()}),esicBranch:ge().when("hasEsi",{is:!0,then:n=>n.required("ESIC Branch is required"),otherwise:n=>n.optional().nullable()}),document:Wt().optional().nullable(),verifiedStatus:Pt().optional()}),Gue=()=>{const{onValidated:n,setToast:e}=vi(),{user:t}=jt(),{data:r,updateEsi:s,setEsiVerifiedStatus:a}=$n(),{esiCtcThreshold:o,enableEsiRule:l}=Qc(),c=Ft("(max-width: 767px)"),{register:d,control:h,handleSubmit:p,formState:{errors:x},reset:v,setValue:w,watch:_}=tn({resolver:En(Yue),defaultValues:r.esi}),j=_("hasEsi"),T=_(),P=r.personal.salary!=null&&r.personal.salary<=o;E.useEffect(()=>{v(r.esi)},[r.esi,v]),E.useEffect(()=>{let q;const F=_(V=>{clearTimeout(q),q=window.setTimeout(()=>{s(V)},500)});return()=>{F.unsubscribe(),clearTimeout(q)}},[_,s]),E.useEffect(()=>{P||r.esi.hasEsi&&s({hasEsi:!1,esiNumber:"",esiRegistrationDate:"",esicBranch:""})},[P,r.esi.hasEsi,s]);const D=async q=>{s(q),await n()},M=()=>{a({esiNumber:!1})},O=q=>{if(q.esiNumber){const F=q.esiNumber.replace(/\D/g,"");if(F.length===10||F.length===17){const V={esiNumber:F,hasEsi:!0};w("esiNumber",F,{shouldValidate:!0}),w("hasEsi",!0,{shouldValidate:!0}),s(V),a({esiNumber:!0}),e({message:"ESI Number extracted successfully.",type:"success"})}}},I={type:et.OBJECT,properties:{esiNumber:{type:et.STRING,description:"The 10 or 17-digit ESI number."}},required:["esiNumber"]};if(c){if(!l||!P){const q=l?`Employee is not eligible for ESI as their gross salary is above the ${o.toLocaleString()} threshold.`:"ESI enrollment is currently disabled by company policy. This step is not applicable.";return i.jsx("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"esi-form",children:i.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-900/40 rounded-lg border border-blue-500/50",children:[i.jsx(iu,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),i.jsx("p",{className:"text-sm text-blue-300",children:q})]})})}return i.jsxs("form",{onSubmit:p(D),id:"esi-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Employee's State Insurance number if applicable."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",...d("hasEsi"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"Are you covered under ESI?"})]}),j&&i.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[i.jsx("input",{placeholder:"ESI Number",...d("esiNumber"),className:"form-input"}),i.jsx("input",{type:"date",...d("esiRegistrationDate"),className:"form-input"}),i.jsx("input",{placeholder:"ESIC Branch",...d("esicBranch"),className:"form-input"}),i.jsx(_e,{name:"document",control:h,render:({field:q})=>i.jsx(yt,{label:"Upload ESI Card",file:q.value,onFileChange:q.onChange,allowCapture:!0,costingItemName:"ESI Card OCR"})})]})]})]})}return l?P?i.jsxs("form",{onSubmit:p(D),id:"esi-form",children:[i.jsx(Pr,{title:"ESI Details",subtitle:"Provide your Employee's State Insurance number if applicable."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"hasEsi",type:"checkbox",...d("hasEsi"),className:"h-4 w-4 text-accent"}),i.jsx("label",{htmlFor:"hasEsi",className:"ml-2 block text-sm text-muted",children:"Are you covered under ESI?"})]}),j&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx(yr,{label:"ESI Number",id:"esiNumber",hasValue:!!T.esiNumber,isVerified:r.esi.verifiedStatus?.esiNumber===!0,onManualInput:M,registration:d("esiNumber"),error:x.esiNumber?.message}),i.jsx(_e,{name:"esiRegistrationDate",control:h,render:({field:q})=>i.jsx(kn,{label:"ESI Registration Date",id:"esiRegistrationDate",error:x.esiRegistrationDate?.message,value:q.value,onChange:q.onChange,maxDate:new Date})}),i.jsx(je,{label:"ESIC Branch",id:"esicBranch",registration:d("esicBranch"),error:x.esicBranch?.message})]}),i.jsx(_e,{name:"document",control:h,render:({field:q})=>i.jsx(yt,{label:"Upload ESI Card",file:q.value,onFileChange:q.onChange,onOcrComplete:O,ocrSchema:I,setToast:e,costingItemName:"ESI Card OCR"})})]})]})]}):i.jsxs("form",{onSubmit:async q=>{q.preventDefault(),await n()},id:"esi-form",children:[i.jsx(Pr,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),i.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[i.jsx(iu,{className:"h-5 w-5 text-blue-500 mr-3"}),i.jsxs("p",{className:"text-sm text-blue-700",children:["Employee is not eligible for ESI as their gross salary is above the $",o.toLocaleString()," threshold."]})]})]}):i.jsxs("form",{onSubmit:async q=>{q.preventDefault(),await n()},id:"esi-form",children:[i.jsx(Pr,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),i.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[i.jsx(iu,{className:"h-5 w-5 text-blue-500 mr-3"}),i.jsx("p",{className:"text-sm text-blue-700",children:"ESI enrollment is currently disabled by company policy. This step is not applicable."})]})]})},Zue=Pt({isOptedIn:is().nullable().required("Please choose whether you want to avail Group Medical Cover."),selectedSpouseId:ge().optional(),selectedChildIds:_s().of(ge().required()).optional(),gmcPolicyCopy:Wt().when("isOptedIn",{is:!1,then:n=>n.required("Please upload GMC policy copy (PNG, JPG, PDF up to 5MB)."),otherwise:n=>n.optional().nullable()}),declarationAccepted:is().when("isOptedIn",{is:!1,then:n=>n.oneOf([!0],"Please accept the declaration to proceed."),otherwise:n=>n.optional()}),policyAmount:ge().optional().nullable(),nomineeName:ge().optional().nullable(),nomineeRelation:ge().optional().nullable(),wantsToAddDependents:is().optional().nullable(),optOutReason:ge().optional().nullable(),alternateInsuranceProvider:ge().optional().nullable(),alternateInsuranceStartDate:ge().optional().nullable(),alternateInsuranceEndDate:ge().optional().nullable(),alternateInsuranceCoverage:ge().optional().nullable()}).defined(),Kue=()=>{const{onValidated:n}=vi(),{user:e}=jt(),{data:t,updateGmc:r}=$n(),s=Ft("(max-width: 767px)"),{control:a,handleSubmit:o,formState:{errors:l},watch:c,reset:d,setValue:h,getValues:p}=tn({resolver:En(Zue),defaultValues:t.gmc}),x=c("isOptedIn"),v=c("selectedSpouseId"),w=c("selectedChildIds")||[],_=E.useMemo(()=>t.family.find(M=>M.relation==="Spouse"),[t.family]),j=E.useMemo(()=>t.family.filter(M=>M.relation==="Child"),[t.family]),T=E.useMemo(()=>{const M=[];return _&&M.push(_),M.push(...j),M},[_,j]);E.useEffect(()=>{if(t.gmc.isOptedIn===!0){const M=!t.gmc.selectedSpouseId&&(!t.gmc.selectedChildIds||t.gmc.selectedChildIds.length===0),O=_||j.length>0;M&&O&&(h("selectedSpouseId",_?.id||"",{shouldDirty:!0}),h("selectedChildIds",j.map(I=>I.id),{shouldDirty:!0}))}},[t.gmc.isOptedIn,_,j,h,t.gmc.selectedSpouseId,t.gmc.selectedChildIds]),E.useEffect(()=>{d(t.gmc)},[t.gmc,d]),E.useEffect(()=>{let M;const O=c(I=>{clearTimeout(M),M=window.setTimeout(()=>{r(I)},500)});return()=>{O.unsubscribe(),clearTimeout(M)}},[c,r]);const P=async M=>{const O={...M};M.isOptedIn?(O.gmcPolicyCopy=null,O.declarationAccepted=!1):(O.selectedSpouseId="",O.selectedChildIds=[]),r(O),await n()},D=(M,O)=>{if(M.relation==="Spouse")h("selectedSpouseId",O?M.id:"",{shouldDirty:!0});else{const I=p("selectedChildIds")||[],q=O?[...I,M.id]:I.filter(F=>F!==M.id);h("selectedChildIds",q,{shouldDirty:!0})}};return s?i.jsxs("form",{onSubmit:o(P),id:"gmc-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please choose whether to enroll in the company's insurance plan."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-md font-semibold",children:"Would you like to Avail Group Medical Cover?"}),i.jsx(_e,{name:"isOptedIn",control:a,render:({field:M})=>i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!0?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!0),checked:M.value===!0,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!1?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!1),checked:M.value===!1,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),x===!0&&i.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[i.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Select Dependents"}),T.map(M=>{const O=M.relation==="Spouse"?v===M.id:w.includes(M.id);return i.jsx(Pn,{id:`dep-mob-${M.id}`,label:`${M.name} (${M.relation})`,checked:O,onChange:I=>D(M,I)},M.id)})]}),x===!1&&i.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[i.jsx(_e,{name:"gmcPolicyCopy",control:a,render:({field:M,fieldState:O})=>i.jsx(yt,{label:"Upload GMC Policy Copy",file:M.value,onFileChange:M.onChange,error:O.error?.message,allowCapture:!0})}),i.jsx(_e,{name:"declarationAccepted",control:a,render:({field:M,fieldState:O})=>i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",checked:M.value??!1,onChange:M.onChange,className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"I declare I will not avail company GMC and the uploaded policy is valid."})]})})]})]})]}):i.jsxs("form",{onSubmit:o(P),id:"gmc-form",children:[i.jsx(Pr,{title:"Group Medical Cover (GMC)",subtitle:"Please choose whether to enroll in the company's insurance plan."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Would you like to Avail Group Medical Cover?"}),i.jsx(_e,{name:"isOptedIn",control:a,render:({field:M})=>i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!0?"border-accent bg-accent-light":"border-border"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!0),checked:M.value===!0,className:"h-4 w-4 text-accent focus:ring-accent"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!1?"border-accent bg-accent-light":"border-border"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!1),checked:M.value===!1,className:"h-4 w-4 text-accent focus:ring-accent"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),l.isOptedIn&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:l.isOptedIn.message})]}),x===!0&&i.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[i.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Select Dependents for Policy"}),i.jsx("p",{className:"text-sm text-muted -mt-2 mb-2",children:"Spouse and children are included by default. Uncheck any dependents you do not want to include."}),i.jsx("div",{className:"space-y-2 p-4 border rounded-lg bg-page",children:T.length>0?T.map(M=>{const O=M.relation==="Spouse"?v===M.id:w.includes(M.id);return i.jsx(Pn,{id:`dep-${M.id}`,label:`${M.name} (${M.relation})`,checked:O,onChange:I=>D(M,I)},M.id)}):i.jsx("p",{className:"text-sm text-muted",children:'No spouse or children added. Please add them in the "Family Details" section to include them in the policy.'})})]}),x===!1&&i.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[i.jsx(_e,{name:"gmcPolicyCopy",control:a,render:({field:M,fieldState:O})=>i.jsx(yt,{label:"Upload GMC Policy Copy",file:M.value,onFileChange:M.onChange,allowedTypes:["image/png","image/jpeg","application/pdf"],error:O.error?.message})}),i.jsx(_e,{name:"declarationAccepted",control:a,render:({field:M,fieldState:O})=>i.jsxs("div",{className:"space-y-1",children:[i.jsx(Pn,{id:"declarationAccepted",label:"I declare that I will not avail company GMC and the uploaded policy is valid.",checked:M.value??!1,onChange:M.onChange}),O.error&&i.jsx("p",{className:"text-xs text-red-600",children:O.error.message})]})})]})]})]})},Jue=()=>{const{onValidated:n,setToast:e}=vi(),{user:t}=jt(),r=St(),{data:s,updateUniforms:a}=$n(),o=Ft("(max-width: 767px)"),[l,c]=E.useState(!0),[d,h]=E.useState(null),{gender:p}=s.personal,{organizationId:x,department:v,designation:w}=s.organization,{control:_,handleSubmit:j,reset:T,watch:P}=tn(),{fields:D,replace:M}=js({control:_,name:"uniforms"});E.useEffect(()=>{(async()=>{c(!0);try{const[V,U,W]=await Promise.all([ue.getAllSiteUniformDetails(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);h({details:V,gents:U,ladies:W})}catch{e({message:"Failed to load uniform configuration.",type:"error"})}finally{c(!1)}})()},[e]);const O=E.useMemo(()=>{if(!d||!x||!v||!w)return[];const F=d.details[x];if(!F)return[];const V=F.departments.find(W=>W.department===v);return V?V.designations.find(W=>W.designation===w)?.items||[]:[]},[d,x,v,w]);E.useEffect(()=>{const F=O.map(V=>{const U=s.uniforms.find($=>$.itemId===V.id),W=V.name.toLowerCase().includes("pant")?"Pants":"Shirts";return{itemId:V.id,itemName:V.name,category:W,sizeId:U?.sizeId||"",quantity:U?.quantity||1}});M(F)},[O,s.uniforms,M]),E.useEffect(()=>{let F;const V=P(U=>{clearTimeout(F),F=window.setTimeout(()=>{const W=U,$=p==="Female"?[...d?.ladies.pants||[],...d?.ladies.shirts||[]]:[...d?.gents.pants||[],...d?.gents.shirts||[]],ne=(W.uniforms||[]).filter(Y=>Y.sizeId&&Y.quantity>0).map(Y=>{const ae=$.find(J=>J.id===Y.sizeId);return{itemId:Y.itemId,itemName:Y.itemName,sizeId:Y.sizeId,sizeLabel:ae?.size||"",fit:ae?.fit||"",quantity:Y.quantity}});a(ne)},500)});return()=>{V.unsubscribe(),clearTimeout(F)}},[P,a,p,d]);const I=async F=>{const V=p==="Female"?[...d?.ladies.pants||[],...d?.ladies.shirts||[]]:[...d?.gents.pants||[],...d?.gents.shirts||[]],U=F.uniforms.filter(W=>W.sizeId&&W.quantity>0).map(W=>{const $=V.find(ne=>ne.id===W.sizeId);return{itemId:W.itemId,itemName:W.itemName,sizeId:W.sizeId,sizeLabel:$?.size||"",fit:$?.fit||"",quantity:W.quantity}});a(U),await n()};if(l)return i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})});if(O.length===0&&s.uniforms.length>0)return i.jsxs("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"uniform-form",children:[!o&&i.jsx(Pr,{title:"Uniform Details",subtitle:"The following items have been selected for this employee."}),i.jsxs("div",{className:"space-y-4",children:[s.uniforms.map(F=>i.jsx("div",{className:`p-4 border rounded-lg flex justify-between items-center ${o?"bg-[#243524] border-border":"bg-page"}`,children:i.jsxs("div",{children:[i.jsx("p",{className:`font-semibold ${o?"text-white":"text-primary-text"}`,children:F.itemName}),i.jsxs("p",{className:`text-sm ${o?"text-gray-400":"text-muted"}`,children:["Size: ",F.sizeLabel,", Fit: ",F.fit,", Quantity: ",F.quantity]})]})},F.itemId+F.sizeId)),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>r("/onboarding/uniforms?from=onboarding"),children:[i.jsx(cr,{className:"mr-2 h-4 w-4"}),"Edit Uniform Selection"]})]})]});if(!p||O.length===0){const F=p?"No uniform requirements found for the selected site, department, and designation.":"Please select a gender in 'Personal Details' to view uniform options.",V=p&&O.length===0;return i.jsxs("form",{onSubmit:async U=>{U.preventDefault(),await n()},id:"uniform-form",children:[!o&&i.jsx(Pr,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),i.jsxs("div",{className:`text-center p-8 rounded-lg ${o?"":"bg-page"}`,children:[i.jsx(Df,{className:`h-12 w-12 mx-auto ${o?"text-gray-500":"text-muted"}`}),i.jsx("p",{className:`mt-4 ${o?"text-gray-400":"text-muted"}`,children:F}),V&&i.jsxs("div",{className:"mt-6",children:[i.jsx("p",{className:`text-sm mb-4 ${o?"text-gray-500":"text-muted"}`,children:"You can proceed to the next step, or create a new site-level request if uniforms are needed."}),i.jsxs(se,{type:"button",onClick:()=>r("/onboarding/uniforms?from=onboarding"),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"}),"Create Site Uniform Request"]})]})]})]})}const q=p==="Female"?d?.ladies:d?.gents;return o?i.jsxs("form",{onSubmit:j(I),id:"uniform-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide uniform measurements for the employee."}),i.jsx("div",{className:"space-y-4",children:D.map((F,V)=>{const U=F.category==="Pants"?q?.pants:q?.shirts;return i.jsxs("div",{className:"p-4 border border-border rounded-xl space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:F.itemName}),i.jsx(_e,{name:`uniforms.${V}.sizeId`,control:_,render:({field:W})=>i.jsxs("select",{...W,className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"-- Select Size --"}),U?.map($=>i.jsxs("option",{value:$.id,children:["Size: ",$.size," - ",$.fit]},$.id))]})}),i.jsx(_e,{name:`uniforms.${V}.quantity`,control:_,render:({field:W})=>i.jsx("input",{type:"number",min:"1",...W,className:"form-input"})})]},F.id)})})]}):i.jsxs("form",{onSubmit:j(I),id:"uniform-form",children:[i.jsx(Pr,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),i.jsx("div",{className:"space-y-6",children:D.map((F,V)=>{const U=F.category==="Pants"?q?.pants:q?.shirts;return i.jsxs("div",{className:"p-4 border border-border rounded-xl bg-page/50",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:F.itemName}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(_e,{name:`uniforms.${V}.sizeId`,control:_,rules:{required:"Please select a size"},render:({field:W,fieldState:$})=>i.jsxs(Ke,{label:"Size & Fit",error:$.error?.message,...W,children:[i.jsx("option",{value:"",children:"-- Select Size --"}),U?.map(ne=>i.jsxs("option",{value:ne.id,children:["Size: ",ne.size," - ",ne.fit]},ne.id))]})}),i.jsx(_e,{name:`uniforms.${V}.quantity`,control:_,rules:{required:!0,min:1},render:({field:W})=>i.jsx(je,{label:"Quantity",type:"number",min:"1",...W})})]})]},F.id)})})]})},zh=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",Que=()=>{const{onValidated:n,setToast:e}=vi(),{user:t}=jt(),r=St(),{data:s,updatePersonal:a,updateBank:o,addEducationRecord:l,updateFamilyMember:c,updateEducationRecord:d,updateUan:h,updateEsi:p,updateGmc:x}=$n(),v=Ft("(max-width: 767px)"),w=U=>{const W={};if(U.name){const $=U.name.split(" ");W.firstName=zh($.shift()||""),W.lastName=zh($.pop()||""),W.middleName=zh($.join(" "))}if(U.dob)try{const $=new Date(U.dob);isNaN($.getTime())||(W.dob=$e($,"yyyy-MM-dd"))}catch{}U.aadhaarNumber&&(W.idProofNumber=U.aadhaarNumber.replace(/\s/g,""),W.idProofType="Aadhaar"),a(W)},_=U=>{const W={};if(U.accountHolderName&&(W.accountHolderName=zh(U.accountHolderName)),U.accountNumber){const $=U.accountNumber.replace(/\D/g,"");W.accountNumber=$,W.confirmAccountNumber=$}U.ifscCode&&(W.ifscCode=U.ifscCode.toUpperCase().replace(/\s/g,"")),o(W)},j=U=>{const W={};U.uanNumber&&(W.uanNumber=U.uanNumber.replace(/\D/g,""),W.hasPreviousPf=!0),h(W)},T=U=>{const W={};U.esiNumber&&(W.esiNumber=U.esiNumber.replace(/\D/g,""),W.hasEsi=!0),p(W)},P=U=>W=>{const $={};if(W.name&&($.name=zh(W.name)),W.dob)try{const ne=new Date(W.dob);isNaN(ne.getTime())||($.dob=$e(ne,"yyyy-MM-dd"))}catch{}c(U,$)},D=U=>W=>{const $={};W.degree&&($.degree=W.degree),W.institution&&($.institution=W.institution),W.endYear&&($.endYear=W.endYear.toString()),d(U,$)},M={type:et.OBJECT,properties:{name:{type:et.STRING},dob:{type:et.STRING},aadhaarNumber:{type:et.STRING}}},O={type:et.OBJECT,properties:{accountHolderName:{type:et.STRING},accountNumber:{type:et.STRING},ifscCode:{type:et.STRING}}},I={type:et.OBJECT,properties:{uanNumber:{type:et.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:et.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:et.STRING,description:"The 10 or 17-digit ESI number."}}},q={type:et.OBJECT,properties:{uanNumber:{type:et.STRING}}},F={type:et.OBJECT,properties:{esiNumber:{type:et.STRING}}},V={type:et.OBJECT,properties:{degree:{type:et.STRING},institution:{type:et.STRING},endYear:{type:et.STRING}}};return v?i.jsxs("form",{onSubmit:async U=>{U.preventDefault(),await n()},id:"documents-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Upload supporting documents. You can also do this within each relevant section."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(yt,{label:"ID Proof (Front Side)",file:s.personal.idProofFront,onFileChange:U=>a({idProofFront:U}),onOcrComplete:w,ocrSchema:M,setToast:e,allowCapture:!0,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(yt,{label:"ID Proof (Back Side)",file:s.personal.idProofBack,onFileChange:U=>a({idProofBack:U}),onOcrComplete:w,ocrSchema:M,setToast:e,allowCapture:!0,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(yt,{label:"Profile Photo",file:s.personal.photo,onFileChange:U=>a({photo:U}),allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]}),i.jsx(yt,{label:"Bank Proof",file:s.bank.bankProof,onFileChange:U=>o({bankProof:U}),onOcrComplete:_,ocrSchema:O,setToast:e,allowCapture:!0,docType:"Bank"}),i.jsx(yt,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:s.uan.salarySlip,onFileChange:U=>h({salarySlip:U}),onOcrComplete:U=>{j(U),T(U)},ocrSchema:I,setToast:e,allowCapture:!0,docType:"Salary"}),s.uan.hasPreviousPf&&i.jsx(yt,{label:"UAN Document",file:s.uan.document,onFileChange:U=>h({document:U}),onOcrComplete:j,ocrSchema:q,setToast:e,allowCapture:!0,docType:"UAN"}),s.esi.hasEsi&&i.jsx(yt,{label:"ESI Document",file:s.esi.document,onFileChange:U=>p({document:U}),onOcrComplete:T,ocrSchema:F,setToast:e,allowCapture:!0}),s.gmc.isOptedIn===!1&&i.jsx(yt,{label:"GMC Policy Copy",file:s.gmc.gmcPolicyCopy,onFileChange:U=>x({gmcPolicyCopy:U}),allowCapture:!0}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[i.jsx("h4",{className:"form-header-title mb-4",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[s.education.map(U=>i.jsx(yt,{label:`Certificate for ${U.degree||"Qualification"}`,file:U.document,onFileChange:W=>d(U.id,{document:W}),onOcrComplete:D(U.id),ocrSchema:V,setToast:e,allowCapture:!0},U.id)),i.jsxs(se,{type:"button",onClick:()=>r("/onboarding/add/education"),variant:"secondary",className:"w-full flex items-center justify-center",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Add / Edit Qualifications"})]})]})]}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[i.jsx("h4",{className:"form-header-title mb-4",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[s.family.map(U=>i.jsx(yt,{label:`ID Proof for ${U.name||"Family Member"}`,file:U.idProof,onFileChange:W=>c(U.id,{idProof:W}),onOcrComplete:P(U.id),ocrSchema:M,setToast:e,allowCapture:!0,docType:"Aadhaar"},U.id)),s.family.length===0&&i.jsx("p",{className:"text-sm text-gray-400",children:"No family members added."}),i.jsxs(se,{type:"button",onClick:()=>r("/onboarding/add/family"),variant:"secondary",className:"w-full flex items-center justify-center",children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Add/Edit on Family Page"})]})]})]})]})]}):i.jsxs("form",{onSubmit:async U=>{U.preventDefault(),await n()},id:"documents-form",children:[i.jsx(Pr,{title:"Document Collection",subtitle:"Upload supporting documents. You can also do this within each relevant section."}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("section",{children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx(yt,{label:"Employee ID Proof (Aadhaar/PAN) - Front Side",file:s.personal.idProofFront,onFileChange:U=>a({idProofFront:U}),onOcrComplete:w,ocrSchema:M,setToast:e,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(yt,{label:"Employee ID Proof (Aadhaar/PAN) - Back Side",file:s.personal.idProofBack,onFileChange:U=>a({idProofBack:U}),onOcrComplete:w,ocrSchema:M,setToast:e,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(yt,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:s.bank.bankProof,onFileChange:U=>o({bankProof:U}),onOcrComplete:_,ocrSchema:O,setToast:e,docType:"Bank"}),i.jsx(yt,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:s.uan.salarySlip,onFileChange:U=>h({salarySlip:U}),onOcrComplete:U=>{j(U),T(U)},ocrSchema:I,setToast:e,docType:"Salary"})]})}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[s.education.map(U=>i.jsx(yt,{label:`Certificate for ${U.degree||"New Qualification"}`,file:U.document,onFileChange:W=>d(U.id,{document:W}),onOcrComplete:D(U.id),ocrSchema:V,setToast:e},U.id)),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>l(),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[s.family.map(U=>i.jsx(yt,{label:`ID Proof for ${U.name||`(${U.relation})`}`,file:U.idProof,onFileChange:W=>c(U.id,{idProof:W}),onOcrComplete:P(U.id),ocrSchema:M,setToast:e,docType:"Aadhaar"},U.id)),s.family.length===0&&i.jsx("p",{className:"text-sm text-muted",children:"No family members added yet."}),i.jsxs(se,{type:"button",variant:"outline",onClick:()=>r("/onboarding/add/family"),children:[i.jsx(Bt,{className:"mr-2 h-4 w-4"})," Go to Family Page to Add/Edit"]})]})]})]})]})},Xue=Pt({signatureImage:Wt().required("A signature image is mandatory.").nullable(),fingerprints:Pt().shape({leftThumb:Wt().optional().nullable(),leftIndex:Wt().optional().nullable(),leftMiddle:Wt().optional().nullable(),leftRing:Wt().optional().nullable(),leftLittle:Wt().optional().nullable(),rightThumb:Wt().optional().nullable(),rightIndex:Wt().optional().nullable(),rightMiddle:Wt().optional().nullable(),rightRing:Wt().optional().nullable(),rightLittle:Wt().optional().nullable()})}).defined(),efe=[{hand:"Left",key:"leftThumb",name:"Thumb"},{hand:"Left",key:"leftIndex",name:"Index"},{hand:"Left",key:"leftMiddle",name:"Middle"},{hand:"Left",key:"leftRing",name:"Ring"},{hand:"Left",key:"leftLittle",name:"Little"},{hand:"Right",key:"rightThumb",name:"Thumb"},{hand:"Right",key:"rightIndex",name:"Index"},{hand:"Right",key:"rightMiddle",name:"Middle"},{hand:"Right",key:"rightRing",name:"Ring"},{hand:"Right",key:"rightLittle",name:"Little"}],tfe=()=>{const{onValidated:n}=vi(),{data:e,updateBiometrics:t}=$n(),{user:r}=jt(),s=Ft("(max-width: 767px)"),{control:a,handleSubmit:o,formState:{errors:l},reset:c,watch:d}=tn({resolver:En(Xue),defaultValues:e.biometrics});E.useEffect(()=>{c(e.biometrics)},[e.biometrics,c]),E.useEffect(()=>{const v=d(w=>{t(w)});return()=>v.unsubscribe()},[d,t]);const h=async(v,w)=>{try{const _=await ue.verifyFingerprintImage(v,w);return _.containsFingerprints?{success:!0,reason:""}:{success:!1,reason:_.reason||"Image does not appear to contain fingerprints. Please upload a clear scan."}}catch(_){return{success:!1,reason:_.message||"AI verification failed."}}},p=async v=>{t(v),await n()},x=v=>efe.filter(w=>w.hand===v).map(w=>i.jsx(_e,{name:`fingerprints.${w.key}`,control:a,render:({field:_})=>i.jsx(yt,{label:`${v} ${w.name}`,file:_.value,onFileChange:_.onChange,onVerification:h,allowCapture:!0})},w.key));return i.jsxs("form",{onSubmit:o(p),id:"biometrics-form",children:[!s&&i.jsx(Pr,{title:"Biometrics",subtitle:"Please provide fingerprint scans and a mandatory signature."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:`text-lg font-semibold text-center mb-4 ${s?"form-header-title":"text-primary-text"}`,children:["Signature ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("div",{className:"w-full",children:i.jsx(_e,{name:"signatureImage",control:a,render:({field:v,fieldState:w})=>i.jsx(yt,{label:"Upload or capture a signature",file:v.value,onFileChange:v.onChange,allowCapture:!0,error:w.error?.message})})})]}),i.jsx("div",{className:s?"":"my-8 border-t border-border"}),i.jsxs("div",{children:[i.jsx("h4",{className:`text-lg font-semibold text-center mb-4 ${s?"form-header-title":"text-primary-text"}`,children:"Fingerprints (Optional)"}),i.jsx("p",{className:`text-center mb-6 ${s?"text-gray-400":"text-muted"}`,children:"Upload scans for all 10 fingerprints, one image per finger."}),i.jsxs("div",{className:"w-full grid grid-cols-2 md:grid-cols-5 gap-4",children:[x("Left"),x("Right")]})]})]})]})},kc=({label:n,value:e})=>i.jsxs("div",{children:[i.jsx("dt",{className:"text-sm font-medium text-muted",children:n}),i.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),Pc=({label:n,value:e,status:t,isVerifying:r})=>i.jsxs("div",{children:[i.jsxs("dt",{className:"text-sm font-medium text-muted flex items-center",children:[n,r&&i.jsx(_t,{className:"h-4 w-4 text-muted animate-spin ml-2"}),!r&&t===!0&&i.jsx("span",{title:"Verified from document",className:"ml-2",children:i.jsx(Yi,{className:"h-4 w-4 text-green-500"})}),!r&&t===!1&&i.jsx("span",{title:"Verification Failed",className:"ml-2",children:i.jsx(pm,{className:"h-4 w-4 text-red-500"})})]}),i.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),Vi=({label:n,value:e})=>i.jsxs("div",{className:"flex justify-between items-start py-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:n}),i.jsx("span",{className:"text-sm text-white font-medium text-right max-w-[60%]",children:e||"-"})]}),nfe=()=>{const{onSubmit:n,isSubmitting:e}=vi(),{user:t}=jt(),{data:r,logVerificationUsage:s,setPersonalVerifiedStatus:a,setBankVerifiedStatus:o,setUanVerifiedStatus:l}=$n(),{perfiosApi:c}=gi(),d=St(),[h,p]=E.useState(window.innerWidth<768);E.useEffect(()=>{const O=()=>p(window.innerWidth<768);return window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[]);const x=t?.role==="field_officer"&&h,[v,w]=E.useState("idle"),[_,j]=E.useState(""),T=E.useMemo(()=>Object.entries(r.biometrics.fingerprints).filter(([,O])=>O!==null).map(([O])=>O.replace(/([A-Z])/g," $1").replace(/^./,I=>I.toUpperCase())),[r.biometrics.fingerprints]),P=async()=>{w("verifying"),j("");let O=!0;const I=[];try{s("Bank AC Verification Advanced");const q=await ue.verifyBankAccountWithPerfios({name:r.bank.accountHolderName,dob:r.personal.dob,aadhaar:r.personal.idProofNumber||null,pan:null,bank:{accountNumber:r.bank.accountNumber,ifsc:r.bank.ifscCode},uan:r.uan.uanNumber||null,esi:r.esi.esiNumber||null});if(I.push(`Bank: ${q.message}`),o({accountNumber:q.verifiedFields.accountNumber,accountHolderName:q.verifiedFields.accountHolderName}),q.success||(O=!1),r.personal.idProofType==="Aadhaar"&&r.personal.idProofNumber){s("Aadhaar Verification");const F=await ue.verifyAadhaar(r.personal.idProofNumber);I.push(`Aadhaar: ${F.message}`),a({idProofNumber:F.success}),F.success||(O=!1)}if(r.uan.hasPreviousPf&&r.uan.uanNumber){s("EPF UAN Lookup");const F=await ue.lookupUan(r.uan.uanNumber);I.push(`UAN: ${F.message}`),l({uanNumber:F.verifiedFields.uan}),F.success||(O=!1)}await ue.updateOnboarding($n.getState().data),j(I.join(`
`)),w(O?"success":"failed")}catch(q){w("failed"),j(q.message||"An unexpected error occurred during verification.")}},D=()=>{d(`/onboarding/pdf/${r.id||"draft"}`)},M=(v==="success"||!c.enabled)&&r.formsGenerated;return x?i.jsxs("form",{onSubmit:async O=>{O.preventDefault(),await n()},id:"review-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please review all your details carefully before submitting."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Personal Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Vi,{label:"Full Name",value:`${r.personal.firstName} ${r.personal.lastName}`}),i.jsx(Vi,{label:"Email",value:r.personal.email}),i.jsx(Vi,{label:"Mobile",value:r.personal.mobile}),i.jsx(Vi,{label:"Date of Birth",value:r.personal.dob})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Organization Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Vi,{label:"Site",value:r.organization.organizationName}),i.jsx(Vi,{label:"Designation",value:r.organization.designation}),i.jsx(Vi,{label:"Department",value:r.organization.department})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Bank Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Vi,{label:"Account Holder",value:r.bank.accountHolderName}),i.jsx(Vi,{label:"Account Number",value:"*".repeat(Math.max(0,r.bank.accountNumber.length-4))+r.bank.accountNumber.slice(-4)}),i.jsx(Vi,{label:"IFSC Code",value:r.bank.ifscCode})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Uniform Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Vi,{label:"Uniform Required",value:r.uniforms.length>0?"Yes":"No"}),r.uniforms.map(O=>i.jsx(Vi,{label:O.itemName,value:`${O.quantity} x Size ${O.sizeLabel} (${O.fit})`},O.itemId))]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Biometrics"}),r.biometrics.signatureImage&&i.jsxs("div",{className:"mb-4",children:[i.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Signature"}),i.jsx("img",{src:r.biometrics.signatureImage.preview,alt:"Signature",className:"h-24 bg-white border rounded-md mx-auto"})]}),T.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Fingerprints"}),i.jsx("ul",{className:"text-sm text-center text-gray-400 list-disc list-inside",children:T.map(O=>i.jsx("li",{children:O},O))})]})]})]})]}):i.jsxs("form",{onSubmit:async O=>{O.preventDefault(),await n()},id:"review-form",children:[i.jsx(Pr,{title:"Review & Submit",subtitle:"Please review all your details carefully before submitting."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Personal Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Pc,{label:"Full Name",value:`${r.personal.firstName} ${r.personal.lastName}`,status:r.personal.verifiedStatus?.name,isVerifying:!1}),i.jsx(kc,{label:"Email",value:r.personal.email}),i.jsx(kc,{label:"Mobile",value:r.personal.mobile}),i.jsx(Pc,{label:"Date of Birth",value:r.personal.dob,status:r.personal.verifiedStatus?.dob,isVerifying:!1}),i.jsx(kc,{label:"Gender",value:r.personal.gender}),i.jsx(Pc,{label:"Aadhaar Number",value:r.personal.idProofNumber,status:r.personal.verifiedStatus?.idProofNumber,isVerifying:v==="verifying"})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Organization Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(kc,{label:"Site / Client",value:r.organization.organizationName}),i.jsx(kc,{label:"Designation",value:r.organization.designation}),i.jsx(kc,{label:"Department",value:r.organization.department}),i.jsx(kc,{label:"Joining Date",value:r.organization.joiningDate})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Bank & Statutory Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Pc,{label:"Account Holder",value:r.bank.accountHolderName,status:r.bank.verifiedStatus?.accountHolderName,isVerifying:v==="verifying"}),i.jsx(Pc,{label:"Account Number",value:"*".repeat(Math.max(0,r.bank.accountNumber.length-4))+r.bank.accountNumber.slice(-4),status:r.bank.verifiedStatus?.accountNumber,isVerifying:v==="verifying"}),i.jsx(Pc,{label:"IFSC Code",value:r.bank.ifscCode,status:r.bank.verifiedStatus?.ifscCode,isVerifying:v==="verifying"}),i.jsx(kc,{label:"Bank Name",value:r.bank.bankName}),r.uan.hasPreviousPf&&i.jsx(Pc,{label:"UAN",value:r.uan.uanNumber,status:r.uan.verifiedStatus?.uanNumber,isVerifying:v==="verifying"}),r.esi.hasEsi&&i.jsx(Pc,{label:"ESI Number",value:r.esi.esiNumber,status:r.esi.verifiedStatus?.esiNumber,isVerifying:v==="verifying"})]})]}),r.uniforms.length>0&&i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Uniform Details"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.uniforms.map(O=>i.jsxs("div",{className:"bg-page p-3 rounded-md",children:[i.jsx("p",{className:"font-semibold text-sm",children:O.itemName}),i.jsxs("p",{className:"text-xs text-muted",children:["Size: ",O.sizeLabel," (",O.fit,")"]}),i.jsxs("p",{className:"text-xs text-muted",children:["Qty: ",O.quantity]})]},O.itemId))})]}),r.biometrics.signatureImage&&i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Biometrics"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-primary-text",children:"Signature"}),i.jsx("div",{className:"mt-2 p-2 border rounded-lg inline-block bg-page",children:i.jsx("img",{src:r.biometrics.signatureImage.preview,alt:"Signature",className:"h-24"})})]}),T.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-primary-text",children:"Fingerprints Uploaded"}),i.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-muted columns-2",children:T.map(O=>i.jsx("li",{children:O},O))})]})]})]})]}),c.enabled&&i.jsxs("div",{className:"mt-8 pt-6 border-t",children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Third-Party Verification"}),i.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:"Run a background check against official records."}),i.jsx("p",{className:"text-sm text-muted",children:"This step is required before you can submit the application."}),v==="failed"&&i.jsx("p",{className:"text-sm text-red-600 mt-2",children:_}),v==="success"&&i.jsx("p",{className:"text-sm text-green-600 mt-2",children:_})]}),i.jsxs(se,{onClick:P,isLoading:v==="verifying",disabled:v==="success",children:[v==="idle"&&i.jsxs(i.Fragment,{children:[i.jsx(oy,{className:"mr-2 h-4 w-4"})," Verify Details"]}),v==="verifying"&&"Verifying...",v==="failed"&&"Retry Verification",v==="success"&&i.jsxs(i.Fragment,{children:[i.jsx(Yi,{className:"mr-2 h-4 w-4"})," Verified"]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t",children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Generate Official Forms"}),i.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:"Generate and review the official PDF documents."}),i.jsx("p",{className:"text-sm text-muted",children:"This step is mandatory before final submission."})]}),r.formsGenerated?i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-green-600",children:[i.jsx(Yi,{className:"h-5 w-5"}),i.jsx("span",{children:"Forms Generated & Confirmed"})]}):i.jsxs(se,{onClick:D,children:[i.jsx(ls,{className:"mr-2 h-4 w-4"})," Generate & Review Forms"]})]})]}),i.jsx("div",{className:"mt-8 pt-6 border-t",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex items-center h-5",children:i.jsx("input",{id:"confirmation",name:"confirmation",type:"checkbox",required:!0,className:"focus:ring-accent h-4 w-4 text-accent border-gray-300 rounded",disabled:!M})}),i.jsxs("div",{className:"ml-3 text-sm",children:[i.jsx("label",{htmlFor:"confirmation",className:`font-medium ${M?"text-gray-700":"text-gray-400"}`,children:"Declaration"}),i.jsx("p",{className:`${M?"text-muted":"text-gray-400"}`,children:"I hereby declare that the information provided is true and correct to the best of my knowledge."})]})]})})]})},Wn=({requiredPermission:n,children:e})=>{const{user:t,isInitialized:r}=jt(),{permissions:s}=Ji();return r?t?(s[t.role]||[]).includes(n)?e?i.jsx(i.Fragment,{children:e}):i.jsx(vf,{}):i.jsx(vl,{to:"/forbidden",replace:!0}):i.jsx(vl,{to:"/auth/login",replace:!0}):null},rfe=({onIdle:n,idleTimeout:e,promptTimeout:t,disabled:r=!1})=>{const[s,a]=E.useState(!1),[o,l]=E.useState(t),c=E.useRef(null),d=E.useRef(null),h=E.useRef(null),p=["mousemove","keydown","mousedown","scroll","touchstart"],x=E.useCallback(()=>{r||(a(!1),l(t),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current),c.current=window.setTimeout(()=>{a(!0)},e))},[e,t,r]);return E.useEffect(()=>{if(!r)return s&&(d.current=window.setTimeout(n,t),h.current=window.setInterval(()=>{l(v=>Math.max(0,v-1e3))},1e3)),()=>{d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)}},[s,n,t,r]),E.useEffect(()=>{if(r)return;const v=()=>x();return p.forEach(w=>{window.addEventListener(w,v)}),x(),()=>{p.forEach(w=>{window.removeEventListener(w,v)}),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)}},[x,r]),{isIdle:s,countdown:o,reset:x}},sfe=1800*1e3,ife=120*1e3,afe=()=>{const{logout:n}=jt(),e=St(),t=()=>{n(),e("/auth/login",{replace:!0})},r=Ft("(max-width: 768px)"),{isIdle:s,countdown:a,reset:o}=rfe({onIdle:t,idleTimeout:sfe,promptTimeout:ife,disabled:r});return s?i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-70 backdrop-blur-sm","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 text-center animate-fade-in-scale",children:[i.jsx(f3,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Are you still there?"}),i.jsx("p",{className:"mt-2 text-muted",children:"For your security, you will be logged out due to inactivity."}),i.jsx("div",{className:"my-6 text-4xl font-bold text-accent",children:Math.ceil(a/1e3)}),i.jsx("p",{className:"text-sm text-muted mb-6",children:"Click the button below to stay logged in."}),i.jsx("div",{className:"flex justify-center gap-4",children:i.jsx(se,{onClick:o,variant:"primary",size:"lg",children:"Stay Logged In"})})]})}):null},ofe=()=>{const{pathname:n}=ds();return E.useEffect(()=>{window.scrollTo(0,0);const e=document.querySelector("main");e&&e.scrollTo(0,0);const t=document.getElementById("root");t&&t.scrollTo(0,0)},[n]),null},lfe=()=>{const{theme:n,isAutomatic:e,_setThemeInternal:t}=Jc(),r=Ft("(max-width: 767px)");return E.useEffect(()=>{const s=document.body;let a="light";e?a=r?"dark":"light":a=n,t(a),a==="dark"?s.classList.add("pro-dark-theme"):s.classList.remove("pro-dark-theme")},[n,e,r,t]),null},mx="app:lastPath",cfe=["/auth","/splash","/pending-approval","/forbidden"],tC=n=>n==="/"||n==="/#"||n==="/index.html"?!1:!cfe.some(e=>n.startsWith(e)),dfe=()=>{const{user:n,isInitialized:e}=jt(),t=ds();if(!e)return null;if(!n)return tC(t.pathname+t.search)&&localStorage.setItem(mx,t.pathname+t.search),i.jsx(vl,{to:"/auth/login",replace:!0});if(n.role==="unverified")return i.jsx(vl,{to:"/pending-approval",replace:!0});const r=Ft("(max-width: 767px)");return i.jsx(hQ,{children:r?i.jsx(YJ,{}):i.jsx($J,{})})},ufe=()=>{const{user:n,isInitialized:e,setUser:t,setInitialized:r,resetAttendance:s,setLoading:a,isLoginAnimationPending:o}=jt(),{init:l}=Qc(),{initRoles:c}=Ji(),{initSettings:d}=gi(),h=St(),p=ds();return E.useEffect(()=>{n&&tC(p.pathname+p.search)&&localStorage.setItem(mx,p.pathname+p.search)},[n,p.pathname,p.search]),E.useEffect(()=>{let x=!0;const v=setTimeout(()=>{x&&(console.warn("App initialization is taking too long. Proceeding without a session."),a(!1),r(!0))},3e4);(async()=>{a(!0);try{let{data:{session:j},error:T}=await Me.auth.getSession();if(T&&console.error("Error fetching initial session:",T.message),!j){const P=localStorage.getItem("supabase.auth.rememberMe");if(P){console.log("Attempting to restore session from long-term token...");try{const{data:D,error:M}=await Me.auth.setSession({refresh_token:P});M?(console.error("Failed to restore session from long-term token:",M.message),localStorage.removeItem("supabase.auth.rememberMe")):j=D.session}catch(D){console.error("Exception while restoring session from long-term token:",D)}}}if(j)try{const P=await ja.getAppUserProfile(j.user);x&&t(P)}catch(P){console.error("Failed to fetch user profile during initialization:",P),x&&(t(null),s())}else x&&(t(null),s())}catch(j){console.error("Error during app initialization:",j),x&&(t(null),s())}finally{clearTimeout(v),x&&(a(!1),r(!0))}})();const{data:{subscription:_}}=Me.auth.onAuthStateChange((j,T)=>{if(j==="PASSWORD_RECOVERY"){h("/auth/update-password",{replace:!0});return}T?.user?setTimeout(async()=>{try{const P=await ja.getAppUserProfile(T.user);if(x&&(t(P),P))try{const D=`greetingSent_${P.id}`;localStorage.getItem(D)||(await ue.createNotification({userId:P.id,message:`Good morning, ${P.name||"there"}! Welcome to Paradigm Services.`,type:"greeting"}),localStorage.setItem(D,"1"))}catch(D){console.error("Failed to send login greeting notification",D)}}catch(P){console.error("Failed to fetch user profile after auth change:",P),x&&(t(null),s(),$n.getState().reset())}},0):x&&(t(null),s(),$n.getState().reset())});return()=>{x=!1,_?.unsubscribe(),clearTimeout(v)}},[t,r,s,a]),E.useEffect(()=>{n&&e&&((async()=>{try{const{settings:v,roles:w,holidays:_}=await ue.getInitialAppData(),j=await ue.getRecurringHolidays();v.enrollmentRules&&l(v.enrollmentRules),w&&c(w),v.attendanceSettings&&_&&d({holidays:_,attendanceSettings:v.attendanceSettings,recurringHolidays:j||[]})}catch(v){console.error("Failed to load initial application data:",v)}})(),jt.getState().checkAttendanceStatus())},[n,e,l,c,d]),E.useEffect(()=>{if(e&&p.pathname!=="/auth/update-password"&&n&&!o&&(p.pathname.startsWith("/auth")&&p.pathname!=="/auth/logout"||p.pathname==="/"||p.pathname==="/splash")){const x=localStorage.getItem(mx);x&&tC(x)&&x!=="/"&&x!=="/#"?(localStorage.removeItem(mx),h(x,{replace:!0})):n.role==="unverified"?h("/pending-approval",{replace:!0}):h("/profile",{replace:!0})}},[e,n,p.pathname,h,o]),e?i.jsxs(i.Fragment,{children:[i.jsx(ofe,{}),i.jsx(lfe,{}),n&&i.jsx(afe,{}),i.jsxs(Iz,{children:[i.jsxs(He,{path:"/auth",element:i.jsx(ZJ,{}),children:[i.jsx(He,{index:!0,element:i.jsx(vl,{to:"login",replace:!0})}),i.jsx(He,{path:"login",element:i.jsx(bX,{})}),i.jsx(He,{path:"signup",element:i.jsx(_X,{})}),i.jsx(He,{path:"forgot-password",element:i.jsx(NX,{})}),i.jsx(He,{path:"update-password",element:i.jsx(TX,{})}),i.jsx(He,{path:"logout",element:i.jsx(kX,{})})]}),i.jsx(He,{path:"/pending-approval",element:n&&n.role==="unverified"?i.jsx(PX,{}):i.jsx(vl,{to:"/auth/login",replace:!0})}),i.jsx(He,{path:"/forbidden",element:i.jsx(MX,{})}),i.jsxs(He,{path:"/",element:i.jsx(QJ,{children:i.jsx(dfe,{})}),children:[i.jsx(He,{index:!0,element:i.jsx(vl,{to:"/profile",replace:!0})}),i.jsx(He,{path:"profile",element:i.jsx(wse,{})}),i.jsx(He,{path:"mobile-home",element:i.jsx(gQ,{})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"create_enrollment"}),children:[i.jsx(He,{path:"onboarding",element:i.jsx(EX,{})}),i.jsx(He,{path:"onboarding/select-organization",element:i.jsx(DX,{})}),i.jsx(He,{path:"onboarding/pre-upload",element:i.jsx(nue,{})}),i.jsx(He,{path:"onboarding/submissions",element:i.jsx(iue,{})}),i.jsx(He,{path:"onboarding/tasks",element:i.jsx(oue,{})}),i.jsx(He,{path:"onboarding/uniforms",element:i.jsx(due,{})}),i.jsxs(He,{path:"onboarding/add",element:i.jsx(OX,{}),children:[i.jsx(He,{path:"personal",element:i.jsx(Aue,{})}),i.jsx(He,{path:"address",element:i.jsx(Lue,{})}),i.jsx(He,{path:"organization",element:i.jsx(que,{})}),i.jsx(He,{path:"family",element:i.jsx(zue,{})}),i.jsx(He,{path:"education",element:i.jsx(Uue,{})}),i.jsx(He,{path:"bank",element:i.jsx(Wue,{})}),i.jsx(He,{path:"uan",element:i.jsx(Hue,{})}),i.jsx(He,{path:"esi",element:i.jsx(Gue,{})}),i.jsx(He,{path:"gmc",element:i.jsx(Kue,{})}),i.jsx(He,{path:"uniform",element:i.jsx(Jue,{})}),i.jsx(He,{path:"documents",element:i.jsx(Que,{})}),i.jsx(He,{path:"biometrics",element:i.jsx(tfe,{})}),i.jsx(He,{path:"review",element:i.jsx(nfe,{})})]}),i.jsx(He,{path:"onboarding/pdf/:id",element:i.jsx(Ide,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_all_submissions"}),children:i.jsx(He,{path:"verification/dashboard",element:i.jsx(LX,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_users"}),children:[i.jsx(He,{path:"admin/users",element:i.jsx(zX,{})}),i.jsx(He,{path:"admin/users/add",element:i.jsx(KL,{})}),i.jsx(He,{path:"admin/users/edit/:id",element:i.jsx(KL,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_sites"}),children:[i.jsx(He,{path:"admin/sites",element:i.jsx(ase,{})}),i.jsx(He,{path:"admin/sites/add",element:i.jsx(Eue,{})}),i.jsx(He,{path:"admin/sites/quick-add",element:i.jsx(Due,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_roles_and_permissions"}),children:[i.jsx(He,{path:"admin/roles",element:i.jsx(lse,{})}),i.jsx(He,{path:"admin/roles/add",element:i.jsx(JL,{})}),i.jsx(He,{path:"admin/roles/edit/:id",element:i.jsx(JL,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_modules"}),children:[i.jsx(He,{path:"admin/modules",element:i.jsx(fse,{})}),i.jsx(He,{path:"admin/modules/add",element:i.jsx(Pue,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_approval_workflow"}),children:[i.jsx(He,{path:"admin/approval-workflow",element:i.jsx(Dce,{})}),i.jsx(He,{path:"admin/approval-workflow/chart",element:i.jsx(Oce,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_developer_settings"}),children:i.jsx(He,{path:"developer/api",element:i.jsx(mse,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"view_operations_dashboard"}),children:[i.jsx(He,{path:"operations/dashboard",element:i.jsx(gse,{})}),i.jsx(He,{path:"operations/team-activity",element:i.jsx(xse,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_site_dashboard"}),children:i.jsx(He,{path:"site/dashboard",element:i.jsx(vse,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"view_own_attendance"}),children:[i.jsx(He,{path:"attendance/dashboard",element:i.jsx(mce,{})}),i.jsx(He,{path:"attendance/locations",element:i.jsx(xce,{})}),i.jsx(He,{path:"attendance/check-in",element:i.jsx(VL,{})}),i.jsx(He,{path:"attendance/check-out",element:i.jsx(VL,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"apply_for_leave"}),children:i.jsx(He,{path:"leaves/dashboard",element:i.jsx(Cce,{})})}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"manage_attendance_rules"}),children:i.jsx(He,{path:"hr/attendance-settings",element:i.jsx(yce,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_leave_requests"}),children:[i.jsx(He,{path:"hr/leave-management",element:i.jsx(Mce,{})}),i.jsx(He,{path:"hr/leave-management/grant-comp-off",element:i.jsx(kue,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"view_entity_management"}),children:[i.jsx(He,{path:"hr/entities",element:i.jsx(Cde,{})}),i.jsx(He,{path:"hr/entity-management/add-group",element:i.jsx(Tue,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_policies"}),children:[i.jsx(He,{path:"hr/policies-and-insurance",element:i.jsx(Dde,{})}),i.jsx(He,{path:"hr/policies/add",element:i.jsx(Nue,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"manage_enrollment_rules"}),children:i.jsx(He,{path:"hr/enrollment-rules",element:i.jsx(Ode,{})})}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_field_officer_tracking"}),children:i.jsx(He,{path:"hr/field-officer-tracking",element:i.jsx(Kde,{})})}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"manage_attendance_rules"}),children:i.jsx(He,{path:"hr/locations",element:i.jsx(Qde,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_uniforms"}),children:[i.jsx(He,{path:"uniforms",element:i.jsx(Lde,{})}),i.jsx(He,{path:"uniforms/request/new",element:i.jsx(XL,{})}),i.jsx(He,{path:"uniforms/request/edit/:id",element:i.jsx(XL,{})})]}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_verification_costing"}),children:i.jsx(He,{path:"billing/cost-analysis",element:i.jsx(zde,{})})}),i.jsx(He,{element:i.jsx(Wn,{requiredPermission:"view_invoice_summary"}),children:i.jsx(He,{path:"billing/summary",element:i.jsx(Bde,{})})}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"manage_tasks"}),children:[i.jsx(He,{path:"tasks",element:i.jsx(Lce,{})}),i.jsx(He,{path:"tasks/add",element:i.jsx(QL,{})}),i.jsx(He,{path:"tasks/edit/:id",element:i.jsx(QL,{})})]}),i.jsxs(He,{element:i.jsx(Wn,{requiredPermission:"access_support_desk"}),children:[i.jsx(He,{path:"support",element:i.jsx(mue,{})}),i.jsx(He,{path:"support/ticket/new",element:i.jsx(Cue,{})}),i.jsx(He,{path:"support/ticket/:id",element:i.jsx(wue,{})})]})]}),i.jsx(He,{path:"*",element:i.jsx(vl,{to:"/",replace:!0})})]})]}):i.jsx(pQ,{})},X6=document.getElementById("root");if(!X6)throw new Error("Could not find root element to mount to");const ffe=Bq.createRoot(X6);ffe.render(i.jsx(ot.StrictMode,{children:i.jsx(Bz,{children:i.jsx(ufe,{})})}));export{ZM as E,IC as W,cm as _,gu as a,aQ as b,hfe as c,n4 as g};
