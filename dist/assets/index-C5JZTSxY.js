function TL(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var Sue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function PL(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var Mv={exports:{}},lh={},kv={exports:{}},Yt={};var VT;function oq(){if(VT)return Yt;VT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.iterator;function x(W){return W===null||typeof W!="object"?null:(W=p&&W[p]||W["@@iterator"],typeof W=="function"?W:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function j(W,ee,K){this.props=W,this.context=ee,this.refs=w,this.updater=K||v}j.prototype.isReactComponent={},j.prototype.setState=function(W,ee){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,ee,"setState")},j.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function P(){}P.prototype=j.prototype;function k(W,ee,K){this.props=W,this.context=ee,this.refs=w,this.updater=K||v}var I=k.prototype=new P;I.constructor=k,_(I,j.prototype),I.isPureReactComponent=!0;var M=Array.isArray,D=Object.prototype.hasOwnProperty,O={current:null},q={key:!0,ref:!0,__self:!0,__source:!0};function F(W,ee,K){var oe,re={},me=null,_e=null;if(ee!=null)for(oe in ee.ref!==void 0&&(_e=ee.ref),ee.key!==void 0&&(me=""+ee.key),ee)D.call(ee,oe)&&!q.hasOwnProperty(oe)&&(re[oe]=ee[oe]);var le=arguments.length-2;if(le===1)re.children=K;else if(1<le){for(var fe=Array(le),ue=0;ue<le;ue++)fe[ue]=arguments[ue+2];re.children=fe}if(W&&W.defaultProps)for(oe in le=W.defaultProps,le)re[oe]===void 0&&(re[oe]=le[oe]);return{$$typeof:n,type:W,key:me,ref:_e,props:re,_owner:O.current}}function U(W,ee){return{$$typeof:n,type:W.type,key:ee,ref:W.ref,props:W.props,_owner:W._owner}}function B(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function G(W){var ee={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(K){return ee[K]})}var X=/\/+/g;function Q(W,ee){return typeof W=="object"&&W!==null&&W.key!=null?G(""+W.key):ee.toString(36)}function Y(W,ee,K,oe,re){var me=typeof W;(me==="undefined"||me==="boolean")&&(W=null);var _e=!1;if(W===null)_e=!0;else switch(me){case"string":case"number":_e=!0;break;case"object":switch(W.$$typeof){case n:case e:_e=!0}}if(_e)return _e=W,re=re(_e),W=oe===""?"."+Q(_e,0):oe,M(re)?(K="",W!=null&&(K=W.replace(X,"$&/")+"/"),Y(re,ee,K,"",function(ue){return ue})):re!=null&&(B(re)&&(re=U(re,K+(!re.key||_e&&_e.key===re.key?"":(""+re.key).replace(X,"$&/")+"/")+W)),ee.push(re)),1;if(_e=0,oe=oe===""?".":oe+":",M(W))for(var le=0;le<W.length;le++){me=W[le];var fe=oe+Q(me,le);_e+=Y(me,ee,K,fe,re)}else if(fe=x(W),typeof fe=="function")for(W=fe.call(W),le=0;!(me=W.next()).done;)me=me.value,fe=oe+Q(me,le++),_e+=Y(me,ee,K,fe,re);else if(me==="object")throw ee=String(W),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.");return _e}function ne(W,ee,K){if(W==null)return W;var oe=[],re=0;return Y(W,oe,"","",function(me){return ee.call(K,me,re++)}),oe}function te(W){if(W._status===-1){var ee=W._result;ee=ee(),ee.then(function(K){(W._status===0||W._status===-1)&&(W._status=1,W._result=K)},function(K){(W._status===0||W._status===-1)&&(W._status=2,W._result=K)}),W._status===-1&&(W._status=0,W._result=ee)}if(W._status===1)return W._result.default;throw W._result}var ie={current:null},$={transition:null},H={ReactCurrentDispatcher:ie,ReactCurrentBatchConfig:$,ReactCurrentOwner:O};function se(){throw Error("act(...) is not supported in production builds of React.")}return Yt.Children={map:ne,forEach:function(W,ee,K){ne(W,function(){ee.apply(this,arguments)},K)},count:function(W){var ee=0;return ne(W,function(){ee++}),ee},toArray:function(W){return ne(W,function(ee){return ee})||[]},only:function(W){if(!B(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Yt.Component=j,Yt.Fragment=t,Yt.Profiler=s,Yt.PureComponent=k,Yt.StrictMode=r,Yt.Suspense=c,Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,Yt.act=se,Yt.cloneElement=function(W,ee,K){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var oe=_({},W.props),re=W.key,me=W.ref,_e=W._owner;if(ee!=null){if(ee.ref!==void 0&&(me=ee.ref,_e=O.current),ee.key!==void 0&&(re=""+ee.key),W.type&&W.type.defaultProps)var le=W.type.defaultProps;for(fe in ee)D.call(ee,fe)&&!q.hasOwnProperty(fe)&&(oe[fe]=ee[fe]===void 0&&le!==void 0?le[fe]:ee[fe])}var fe=arguments.length-2;if(fe===1)oe.children=K;else if(1<fe){le=Array(fe);for(var ue=0;ue<fe;ue++)le[ue]=arguments[ue+2];oe.children=le}return{$$typeof:n,type:W.type,key:re,ref:me,props:oe,_owner:_e}},Yt.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:a,_context:W},W.Consumer=W},Yt.createElement=F,Yt.createFactory=function(W){var ee=F.bind(null,W);return ee.type=W,ee},Yt.createRef=function(){return{current:null}},Yt.forwardRef=function(W){return{$$typeof:l,render:W}},Yt.isValidElement=B,Yt.lazy=function(W){return{$$typeof:m,_payload:{_status:-1,_result:W},_init:te}},Yt.memo=function(W,ee){return{$$typeof:d,type:W,compare:ee===void 0?null:ee}},Yt.startTransition=function(W){var ee=$.transition;$.transition={};try{W()}finally{$.transition=ee}},Yt.unstable_act=se,Yt.useCallback=function(W,ee){return ie.current.useCallback(W,ee)},Yt.useContext=function(W){return ie.current.useContext(W)},Yt.useDebugValue=function(){},Yt.useDeferredValue=function(W){return ie.current.useDeferredValue(W)},Yt.useEffect=function(W,ee){return ie.current.useEffect(W,ee)},Yt.useId=function(){return ie.current.useId()},Yt.useImperativeHandle=function(W,ee,K){return ie.current.useImperativeHandle(W,ee,K)},Yt.useInsertionEffect=function(W,ee){return ie.current.useInsertionEffect(W,ee)},Yt.useLayoutEffect=function(W,ee){return ie.current.useLayoutEffect(W,ee)},Yt.useMemo=function(W,ee){return ie.current.useMemo(W,ee)},Yt.useReducer=function(W,ee,K){return ie.current.useReducer(W,ee,K)},Yt.useRef=function(W){return ie.current.useRef(W)},Yt.useState=function(W){return ie.current.useState(W)},Yt.useSyncExternalStore=function(W,ee,K){return ie.current.useSyncExternalStore(W,ee,K)},Yt.useTransition=function(){return ie.current.useTransition()},Yt.version="18.3.1",Yt}var BT;function Ws(){return BT||(BT=1,kv.exports=oq()),kv.exports}var WT;function lq(){if(WT)return lh;WT=1;var n=Ws(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(l,c,d){var m,p={},x=null,v=null;d!==void 0&&(x=""+d),c.key!==void 0&&(x=""+c.key),c.ref!==void 0&&(v=c.ref);for(m in c)r.call(c,m)&&!a.hasOwnProperty(m)&&(p[m]=c[m]);if(l&&l.defaultProps)for(m in c=l.defaultProps,c)p[m]===void 0&&(p[m]=c[m]);return{$$typeof:e,type:l,key:x,ref:v,props:p,_owner:s.current}}return lh.Fragment=t,lh.jsx=o,lh.jsxs=o,lh}var $T;function ML(){return $T||($T=1,Mv.exports=lq()),Mv.exports}var i=ML(),E=Ws();const at=hu(E),cq=TL({__proto__:null,default:at},[E]);var xp={},Ev={exports:{}},Is={},Dv={exports:{}},Ov={};var HT;function dq(){return HT||(HT=1,(function(n){function e($,H){var se=$.length;$.push(H);e:for(;0<se;){var W=se-1>>>1,ee=$[W];if(0<s(ee,H))$[W]=H,$[se]=ee,se=W;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var H=$[0],se=$.pop();if(se!==H){$[0]=se;e:for(var W=0,ee=$.length,K=ee>>>1;W<K;){var oe=2*(W+1)-1,re=$[oe],me=oe+1,_e=$[me];if(0>s(re,se))me<ee&&0>s(_e,re)?($[W]=_e,$[me]=se,W=me):($[W]=re,$[oe]=se,W=oe);else if(me<ee&&0>s(_e,se))$[W]=_e,$[me]=se,W=me;else break e}}return H}function s($,H){var se=$.sortIndex-H.sortIndex;return se!==0?se:$.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],d=[],m=1,p=null,x=3,v=!1,_=!1,w=!1,j=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I($){for(var H=t(d);H!==null;){if(H.callback===null)r(d);else if(H.startTime<=$)r(d),H.sortIndex=H.expirationTime,e(c,H);else break;H=t(d)}}function M($){if(w=!1,I($),!_)if(t(c)!==null)_=!0,te(D);else{var H=t(d);H!==null&&ie(M,H.startTime-$)}}function D($,H){_=!1,w&&(w=!1,P(F),F=-1),v=!0;var se=x;try{for(I(H),p=t(c);p!==null&&(!(p.expirationTime>H)||$&&!G());){var W=p.callback;if(typeof W=="function"){p.callback=null,x=p.priorityLevel;var ee=W(p.expirationTime<=H);H=n.unstable_now(),typeof ee=="function"?p.callback=ee:p===t(c)&&r(c),I(H)}else r(c);p=t(c)}if(p!==null)var K=!0;else{var oe=t(d);oe!==null&&ie(M,oe.startTime-H),K=!1}return K}finally{p=null,x=se,v=!1}}var O=!1,q=null,F=-1,U=5,B=-1;function G(){return!(n.unstable_now()-B<U)}function X(){if(q!==null){var $=n.unstable_now();B=$;var H=!0;try{H=q(!0,$)}finally{H?Q():(O=!1,q=null)}}else O=!1}var Q;if(typeof k=="function")Q=function(){k(X)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ne=Y.port2;Y.port1.onmessage=X,Q=function(){ne.postMessage(null)}}else Q=function(){j(X,0)};function te($){q=$,O||(O=!0,Q())}function ie($,H){F=j(function(){$(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){_||v||(_=!0,te(D))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function($){switch(x){case 1:case 2:case 3:var H=3;break;default:H=x}var se=x;x=H;try{return $()}finally{x=se}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,H){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var se=x;x=$;try{return H()}finally{x=se}},n.unstable_scheduleCallback=function($,H,se){var W=n.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?W+se:W):se=W,$){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=se+ee,$={id:m++,callback:H,priorityLevel:$,startTime:se,expirationTime:ee,sortIndex:-1},se>W?($.sortIndex=se,e(d,$),t(c)===null&&$===t(d)&&(w?(P(F),F=-1):w=!0,ie(M,se-W))):($.sortIndex=ee,e(c,$),_||v||(_=!0,te(D))),$},n.unstable_shouldYield=G,n.unstable_wrapCallback=function($){var H=x;return function(){var se=x;x=H;try{return $.apply(this,arguments)}finally{x=se}}}})(Ov)),Ov}var YT;function uq(){return YT||(YT=1,Dv.exports=dq()),Dv.exports}var GT;function fq(){if(GT)return Is;GT=1;var n=Ws(),e=uq();function t(u){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+u,b=1;b<arguments.length;b++)h+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(u,h){o(u,h),o(u+"Capture",h)}function o(u,h){for(s[u]=h,u=0;u<h.length;u++)r.add(h[u])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},p={};function x(u){return c.call(p,u)?!0:c.call(m,u)?!1:d.test(u)?p[u]=!0:(m[u]=!0,!1)}function v(u,h,b,T){if(b!==null&&b.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return T?!1:b!==null?!b.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function _(u,h,b,T){if(h===null||typeof h>"u"||v(u,h,b,T))return!0;if(T)return!1;if(b!==null)switch(b.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function w(u,h,b,T,R,z,Z){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=T,this.attributeNamespace=R,this.mustUseProperty=b,this.propertyName=u,this.type=h,this.sanitizeURL=z,this.removeEmptyString=Z}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){j[u]=new w(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var h=u[0];j[h]=new w(h,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){j[u]=new w(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){j[u]=new w(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){j[u]=new w(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){j[u]=new w(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){j[u]=new w(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){j[u]=new w(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){j[u]=new w(u,5,!1,u.toLowerCase(),null,!1,!1)});var P=/[\-:]([a-z])/g;function k(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var h=u.replace(P,k);j[h]=new w(h,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var h=u.replace(P,k);j[h]=new w(h,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var h=u.replace(P,k);j[h]=new w(h,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){j[u]=new w(u,1,!1,u.toLowerCase(),null,!1,!1)}),j.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){j[u]=new w(u,1,!1,u.toLowerCase(),null,!0,!0)});function I(u,h,b,T){var R=j.hasOwnProperty(h)?j[h]:null;(R!==null?R.type!==0:T||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(_(h,b,R,T)&&(b=null),T||R===null?x(h)&&(b===null?u.removeAttribute(h):u.setAttribute(h,""+b)):R.mustUseProperty?u[R.propertyName]=b===null?R.type===3?!1:"":b:(h=R.attributeName,T=R.attributeNamespace,b===null?u.removeAttribute(h):(R=R.type,b=R===3||R===4&&b===!0?"":""+b,T?u.setAttributeNS(T,h,b):u.setAttribute(h,b))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),O=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),G=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),ne=Symbol.for("react.memo"),te=Symbol.for("react.lazy"),ie=Symbol.for("react.offscreen"),$=Symbol.iterator;function H(u){return u===null||typeof u!="object"?null:(u=$&&u[$]||u["@@iterator"],typeof u=="function"?u:null)}var se=Object.assign,W;function ee(u){if(W===void 0)try{throw Error()}catch(b){var h=b.stack.trim().match(/\n( *(at )?)/);W=h&&h[1]||""}return`
`+W+u}var K=!1;function oe(u,h){if(!u||K)return"";K=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(Ie){var T=Ie}Reflect.construct(u,[],h)}else{try{h.call()}catch(Ie){T=Ie}u.call(h.prototype)}else{try{throw Error()}catch(Ie){T=Ie}u()}}catch(Ie){if(Ie&&T&&typeof Ie.stack=="string"){for(var R=Ie.stack.split(`
`),z=T.stack.split(`
`),Z=R.length-1,he=z.length-1;1<=Z&&0<=he&&R[Z]!==z[he];)he--;for(;1<=Z&&0<=he;Z--,he--)if(R[Z]!==z[he]){if(Z!==1||he!==1)do if(Z--,he--,0>he||R[Z]!==z[he]){var ve=`
`+R[Z].replace(" at new "," at ");return u.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",u.displayName)),ve}while(1<=Z&&0<=he);break}}}finally{K=!1,Error.prepareStackTrace=b}return(u=u?u.displayName||u.name:"")?ee(u):""}function re(u){switch(u.tag){case 5:return ee(u.type);case 16:return ee("Lazy");case 13:return ee("Suspense");case 19:return ee("SuspenseList");case 0:case 2:case 15:return u=oe(u.type,!1),u;case 11:return u=oe(u.type.render,!1),u;case 1:return u=oe(u.type,!0),u;default:return""}}function me(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case q:return"Fragment";case O:return"Portal";case U:return"Profiler";case F:return"StrictMode";case Q:return"Suspense";case Y:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case G:return(u.displayName||"Context")+".Consumer";case B:return(u._context.displayName||"Context")+".Provider";case X:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case ne:return h=u.displayName||null,h!==null?h:me(u.type)||"Memo";case te:h=u._payload,u=u._init;try{return me(u(h))}catch{}}return null}function _e(u){var h=u.type;switch(u.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=h.render,u=u.displayName||u.name||"",h.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(h);case 8:return h===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function le(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function fe(u){var h=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function ue(u){var h=fe(u)?"checked":"value",b=Object.getOwnPropertyDescriptor(u.constructor.prototype,h),T=""+u[h];if(!u.hasOwnProperty(h)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var R=b.get,z=b.set;return Object.defineProperty(u,h,{configurable:!0,get:function(){return R.call(this)},set:function(Z){T=""+Z,z.call(this,Z)}}),Object.defineProperty(u,h,{enumerable:b.enumerable}),{getValue:function(){return T},setValue:function(Z){T=""+Z},stopTracking:function(){u._valueTracker=null,delete u[h]}}}}function ce(u){u._valueTracker||(u._valueTracker=ue(u))}function Se(u){if(!u)return!1;var h=u._valueTracker;if(!h)return!0;var b=h.getValue(),T="";return u&&(T=fe(u)?u.checked?"true":"false":u.value),u=T,u!==b?(h.setValue(u),!0):!1}function ye(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Ne(u,h){var b=h.checked;return se({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??u._wrapperState.initialChecked})}function ke(u,h){var b=h.defaultValue==null?"":h.defaultValue,T=h.checked!=null?h.checked:h.defaultChecked;b=le(h.value!=null?h.value:b),u._wrapperState={initialChecked:T,initialValue:b,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function qe(u,h){h=h.checked,h!=null&&I(u,"checked",h,!1)}function ze(u,h){qe(u,h);var b=le(h.value),T=h.type;if(b!=null)T==="number"?(b===0&&u.value===""||u.value!=b)&&(u.value=""+b):u.value!==""+b&&(u.value=""+b);else if(T==="submit"||T==="reset"){u.removeAttribute("value");return}h.hasOwnProperty("value")?Be(u,h.type,b):h.hasOwnProperty("defaultValue")&&Be(u,h.type,le(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(u.defaultChecked=!!h.defaultChecked)}function He(u,h,b){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var T=h.type;if(!(T!=="submit"&&T!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+u._wrapperState.initialValue,b||h===u.value||(u.value=h),u.defaultValue=h}b=u.name,b!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,b!==""&&(u.name=b)}function Be(u,h,b){(h!=="number"||ye(u.ownerDocument)!==u)&&(b==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+b&&(u.defaultValue=""+b))}var de=Array.isArray;function xe(u,h,b,T){if(u=u.options,h){h={};for(var R=0;R<b.length;R++)h["$"+b[R]]=!0;for(b=0;b<u.length;b++)R=h.hasOwnProperty("$"+u[b].value),u[b].selected!==R&&(u[b].selected=R),R&&T&&(u[b].defaultSelected=!0)}else{for(b=""+le(b),h=null,R=0;R<u.length;R++){if(u[R].value===b){u[R].selected=!0,T&&(u[R].defaultSelected=!0);return}h!==null||u[R].disabled||(h=u[R])}h!==null&&(h.selected=!0)}}function Pe(u,h){if(h.dangerouslySetInnerHTML!=null)throw Error(t(91));return se({},h,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Ge(u,h){var b=h.value;if(b==null){if(b=h.children,h=h.defaultValue,b!=null){if(h!=null)throw Error(t(92));if(de(b)){if(1<b.length)throw Error(t(93));b=b[0]}h=b}h==null&&(h=""),b=h}u._wrapperState={initialValue:le(b)}}function Fe(u,h){var b=le(h.value),T=le(h.defaultValue);b!=null&&(b=""+b,b!==u.value&&(u.value=b),h.defaultValue==null&&u.defaultValue!==b&&(u.defaultValue=b)),T!=null&&(u.defaultValue=""+T)}function Le(u){var h=u.textContent;h===u._wrapperState.initialValue&&h!==""&&h!==null&&(u.value=h)}function Je(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nt(u,h){return u==null||u==="http://www.w3.org/1999/xhtml"?Je(h):u==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var ct,Vt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,b,T,R){MSApp.execUnsafeLocalFunction(function(){return u(h,b,T,R)})}:u})(function(u,h){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=h;else{for(ct=ct||document.createElement("div"),ct.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=ct.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;h.firstChild;)u.appendChild(h.firstChild)}});function At(u,h){if(h){var b=u.firstChild;if(b&&b===u.lastChild&&b.nodeType===3){b.nodeValue=h;return}}u.textContent=h}var vt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wn=["Webkit","ms","Moz","O"];Object.keys(vt).forEach(function(u){wn.forEach(function(h){h=h+u.charAt(0).toUpperCase()+u.substring(1),vt[h]=vt[u]})});function Pn(u,h,b){return h==null||typeof h=="boolean"||h===""?"":b||typeof h!="number"||h===0||vt.hasOwnProperty(u)&&vt[u]?(""+h).trim():h+"px"}function Ht(u,h){u=u.style;for(var b in h)if(h.hasOwnProperty(b)){var T=b.indexOf("--")===0,R=Pn(b,h[b],T);b==="float"&&(b="cssFloat"),T?u.setProperty(b,R):u[b]=R}}var Un=se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mn(u,h){if(h){if(Un[u]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(t(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(t(61))}if(h.style!=null&&typeof h.style!="object")throw Error(t(62))}}function An(u,h){if(u.indexOf("-")===-1)return typeof h.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pr=null;function $r(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var un=null,ot=null,kn=null;function Xn(u){if(u=Ko(u)){if(typeof un!="function")throw Error(t(280));var h=u.stateNode;h&&(h=Cu(h),un(u.stateNode,u.type,h))}}function Hs(u){ot?kn?kn.push(u):kn=[u]:ot=u}function wo(){if(ot){var u=ot,h=kn;if(kn=ot=null,Xn(u),h)for(u=0;u<h.length;u++)Xn(h[u])}}function Pl(u,h){return u(h)}function Ml(){}var So=!1;function Ea(u,h,b){if(So)return u(h,b);So=!0;try{return Pl(u,h,b)}finally{So=!1,(ot!==null||kn!==null)&&(Ml(),wo())}}function Gi(u,h){var b=u.stateNode;if(b===null)return null;var T=Cu(b);if(T===null)return null;b=T[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(T=!T.disabled)||(u=u.type,T=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!T;break e;default:u=!1}if(u)return null;if(b&&typeof b!="function")throw Error(t(231,h,typeof b));return b}var jo=!1;if(l)try{var Zi={};Object.defineProperty(Zi,"passive",{get:function(){jo=!0}}),window.addEventListener("test",Zi,Zi),window.removeEventListener("test",Zi,Zi)}catch{jo=!1}function id(u,h,b,T,R,z,Z,he,ve){var Ie=Array.prototype.slice.call(arguments,3);try{h.apply(b,Ie)}catch($e){this.onError($e)}}var lr=!1,dt=null,Ki=!1,Da=null,kl={onError:function(u){lr=!0,dt=u}};function El(u,h,b,T,R,z,Z,he,ve){lr=!1,dt=null,id.apply(kl,arguments)}function No(u,h,b,T,R,z,Z,he,ve){if(El.apply(this,arguments),lr){if(lr){var Ie=dt;lr=!1,dt=null}else throw Error(t(198));Ki||(Ki=!0,Da=Ie)}}function Ss(u){var h=u,b=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(b=h.return),u=h.return;while(u)}return h.tag===3?b:null}function Ys(u){if(u.tag===13){var h=u.memoizedState;if(h===null&&(u=u.alternate,u!==null&&(h=u.memoizedState)),h!==null)return h.dehydrated}return null}function Co(u){if(Ss(u)!==u)throw Error(t(188))}function ad(u){var h=u.alternate;if(!h){if(h=Ss(u),h===null)throw Error(t(188));return h!==u?null:u}for(var b=u,T=h;;){var R=b.return;if(R===null)break;var z=R.alternate;if(z===null){if(T=R.return,T!==null){b=T;continue}break}if(R.child===z.child){for(z=R.child;z;){if(z===b)return Co(R),u;if(z===T)return Co(R),h;z=z.sibling}throw Error(t(188))}if(b.return!==T.return)b=R,T=z;else{for(var Z=!1,he=R.child;he;){if(he===b){Z=!0,b=R,T=z;break}if(he===T){Z=!0,T=R,b=z;break}he=he.sibling}if(!Z){for(he=z.child;he;){if(he===b){Z=!0,b=z,T=R;break}if(he===T){Z=!0,T=z,b=R;break}he=he.sibling}if(!Z)throw Error(t(189))}}if(b.alternate!==T)throw Error(t(190))}if(b.tag!==3)throw Error(t(188));return b.stateNode.current===b?u:h}function Dl(u){return u=ad(u),u!==null?Ol(u):null}function Ol(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var h=Ol(u);if(h!==null)return h;u=u.sibling}return null}var Il=e.unstable_scheduleCallback,To=e.unstable_cancelCallback,od=e.unstable_shouldYield,Oa=e.unstable_requestPaint,Sn=e.unstable_now,ld=e.unstable_getCurrentPriorityLevel,Po=e.unstable_ImmediatePriority,Al=e.unstable_UserBlockingPriority,Ia=e.unstable_NormalPriority,Mo=e.unstable_LowPriority,gi=e.unstable_IdlePriority,Ji=null,Ir=null;function Qi(u){if(Ir&&typeof Ir.onCommitFiberRoot=="function")try{Ir.onCommitFiberRoot(Ji,u,void 0,(u.current.flags&128)===128)}catch{}}var Mt=Math.clz32?Math.clz32:xi,pn=Math.log,Aa=Math.LN2;function xi(u){return u>>>=0,u===0?32:31-(pn(u)/Aa|0)|0}var os=64,yi=4194304;function Pt(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function fn(u,h){var b=u.pendingLanes;if(b===0)return 0;var T=0,R=u.suspendedLanes,z=u.pingedLanes,Z=b&268435455;if(Z!==0){var he=Z&~R;he!==0?T=Pt(he):(z&=Z,z!==0&&(T=Pt(z)))}else Z=b&~R,Z!==0?T=Pt(Z):z!==0&&(T=Pt(z));if(T===0)return 0;if(h!==0&&h!==T&&(h&R)===0&&(R=T&-T,z=h&-h,R>=z||R===16&&(z&4194240)!==0))return h;if((T&4)!==0&&(T|=b&16),h=u.entangledLanes,h!==0)for(u=u.entanglements,h&=T;0<h;)b=31-Mt(h),R=1<<b,T|=u[b],h&=~R;return T}function ko(u,h){switch(u){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ra(u,h){for(var b=u.suspendedLanes,T=u.pingedLanes,R=u.expirationTimes,z=u.pendingLanes;0<z;){var Z=31-Mt(z),he=1<<Z,ve=R[Z];ve===-1?((he&b)===0||(he&T)!==0)&&(R[Z]=ko(he,h)):ve<=h&&(u.expiredLanes|=he),z&=~he}}function cr(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function Rl(){var u=os;return os<<=1,(os&4194240)===0&&(os=64),u}function vi(u){for(var h=[],b=0;31>b;b++)h.push(u);return h}function Ar(u,h,b){u.pendingLanes|=h,h!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,h=31-Mt(h),u[h]=b}function En(u,h){var b=u.pendingLanes&~h;u.pendingLanes=h,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=h,u.mutableReadLanes&=h,u.entangledLanes&=h,h=u.entanglements;var T=u.eventTimes;for(u=u.expirationTimes;0<b;){var R=31-Mt(b),z=1<<R;h[R]=0,T[R]=-1,u[R]=-1,b&=~z}}function ls(u,h){var b=u.entangledLanes|=h;for(u=u.entanglements;b;){var T=31-Mt(b),R=1<<T;R&h|u[T]&h&&(u[T]|=h),b&=~R}}var $t=0;function bi(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var La,Gs,Fa,qa,Xi,ea=!1,_i=[],Rr=null,cs=null,Hr=null,ta=new Map,jt=new Map,$n=[],nn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Eo(u,h){switch(u){case"focusin":case"focusout":Rr=null;break;case"dragenter":case"dragleave":cs=null;break;case"mouseover":case"mouseout":Hr=null;break;case"pointerover":case"pointerout":ta.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":jt.delete(h.pointerId)}}function Zs(u,h,b,T,R,z){return u===null||u.nativeEvent!==z?(u={blockedOn:h,domEventName:b,eventSystemFlags:T,nativeEvent:z,targetContainers:[R]},h!==null&&(h=Ko(h),h!==null&&Gs(h)),u):(u.eventSystemFlags|=T,h=u.targetContainers,R!==null&&h.indexOf(R)===-1&&h.push(R),u)}function Do(u,h,b,T,R){switch(h){case"focusin":return Rr=Zs(Rr,u,h,b,T,R),!0;case"dragenter":return cs=Zs(cs,u,h,b,T,R),!0;case"mouseover":return Hr=Zs(Hr,u,h,b,T,R),!0;case"pointerover":var z=R.pointerId;return ta.set(z,Zs(ta.get(z)||null,u,h,b,T,R)),!0;case"gotpointercapture":return z=R.pointerId,jt.set(z,Zs(jt.get(z)||null,u,h,b,T,R)),!0}return!1}function za(u){var h=Zo(u.target);if(h!==null){var b=Ss(h);if(b!==null){if(h=b.tag,h===13){if(h=Ys(b),h!==null){u.blockedOn=h,Xi(u.priority,function(){Fa(b)});return}}else if(h===3&&b.stateNode.current.memoizedState.isDehydrated){u.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Yr(u){if(u.blockedOn!==null)return!1;for(var h=u.targetContainers;0<h.length;){var b=Ba(u.domEventName,u.eventSystemFlags,h[0],u.nativeEvent);if(b===null){b=u.nativeEvent;var T=new b.constructor(b.type,b);Pr=T,b.target.dispatchEvent(T),Pr=null}else return h=Ko(b),h!==null&&Gs(h),u.blockedOn=b,!1;h.shift()}return!0}function Ua(u,h,b){Yr(u)&&b.delete(h)}function na(){ea=!1,Rr!==null&&Yr(Rr)&&(Rr=null),cs!==null&&Yr(cs)&&(cs=null),Hr!==null&&Yr(Hr)&&(Hr=null),ta.forEach(Ua),jt.forEach(Ua)}function jn(u,h){u.blockedOn===h&&(u.blockedOn=null,ea||(ea=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,na)))}function Lr(u){function h(R){return jn(R,u)}if(0<_i.length){jn(_i[0],u);for(var b=1;b<_i.length;b++){var T=_i[b];T.blockedOn===u&&(T.blockedOn=null)}}for(Rr!==null&&jn(Rr,u),cs!==null&&jn(cs,u),Hr!==null&&jn(Hr,u),ta.forEach(h),jt.forEach(h),b=0;b<$n.length;b++)T=$n[b],T.blockedOn===u&&(T.blockedOn=null);for(;0<$n.length&&(b=$n[0],b.blockedOn===null);)za(b),b.blockedOn===null&&$n.shift()}var Ks=M.ReactCurrentBatchConfig,ra=!0;function cd(u,h,b,T){var R=$t,z=Ks.transition;Ks.transition=null;try{$t=1,sa(u,h,b,T)}finally{$t=R,Ks.transition=z}}function Ll(u,h,b,T){var R=$t,z=Ks.transition;Ks.transition=null;try{$t=4,sa(u,h,b,T)}finally{$t=R,Ks.transition=z}}function sa(u,h,b,T){if(ra){var R=Ba(u,h,b,T);if(R===null)f(u,h,T,Va,b),Eo(u,T);else if(Do(R,u,h,b,T))T.stopPropagation();else if(Eo(u,T),h&4&&-1<nn.indexOf(u)){for(;R!==null;){var z=Ko(R);if(z!==null&&La(z),z=Ba(u,h,b,T),z===null&&f(u,h,T,Va,b),z===R)break;R=z}R!==null&&T.stopPropagation()}else f(u,h,T,null,b)}}var Va=null;function Ba(u,h,b,T){if(Va=null,u=$r(T),u=Zo(u),u!==null)if(h=Ss(u),h===null)u=null;else if(b=h.tag,b===13){if(u=Ys(h),u!==null)return u;u=null}else if(b===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;u=null}else h!==u&&(u=null);return Va=u,null}function Ut(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ld()){case Po:return 1;case Al:return 4;case Ia:case Mo:return 16;case gi:return 536870912;default:return 16}default:return 16}}var js=null,vr=null,Ns=null;function Oo(){if(Ns)return Ns;var u,h=vr,b=h.length,T,R="value"in js?js.value:js.textContent,z=R.length;for(u=0;u<b&&h[u]===R[u];u++);var Z=b-u;for(T=1;T<=Z&&h[b-T]===R[z-T];T++);return Ns=R.slice(u,1<T?1-T:void 0)}function Wa(u){var h=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&h===13&&(u=13)):u=h,u===10&&(u=13),32<=u||u===13?u:0}function wi(){return!0}function Fl(){return!1}function dr(u){function h(b,T,R,z,Z){this._reactName=b,this._targetInst=R,this.type=T,this.nativeEvent=z,this.target=Z,this.currentTarget=null;for(var he in u)u.hasOwnProperty(he)&&(b=u[he],this[he]=b?b(z):z[he]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?wi:Fl,this.isPropagationStopped=Fl,this}return se(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=wi)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=wi)},persist:function(){},isPersistent:wi}),h}var Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Io=dr(Si),Js=se({},Si,{view:0,detail:0}),dd=dr(Js),Mr,Ao,ji,Fr=se({},Js,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xs,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==ji&&(ji&&u.type==="mousemove"?(Mr=u.screenX-ji.screenX,Ao=u.screenY-ji.screenY):Ao=Mr=0,ji=u),Mr)},movementY:function(u){return"movementY"in u?u.movementY:Ao}}),Ro=dr(Fr),ql=se({},Fr,{dataTransfer:0}),Lo=dr(ql),ud=se({},Js,{relatedTarget:0}),$a=dr(ud),zl=se({},Si,{animationName:0,elapsedTime:0,pseudoElement:0}),fd=dr(zl),hd=se({},Si,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),Fo=dr(hd),md=se({},Si,{data:0}),qo=dr(md),Ul={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ha={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pd(u){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(u):(u=Qs[u])?!!h[u]:!1}function Xs(){return pd}var kr=se({},Js,{key:function(u){if(u.key){var h=Ul[u.key]||u.key;if(h!=="Unidentified")return h}return u.type==="keypress"?(u=Wa(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?Ha[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xs,charCode:function(u){return u.type==="keypress"?Wa(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Wa(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Vl=dr(kr),Bl=se({},Fr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wl=dr(Bl),zo=se({},Js,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xs}),Uo=dr(zo),gd=se({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0}),xd=dr(gd),$l=se({},Fr,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),yd=dr($l),qr=[9,13,27,32],Cs=l&&"CompositionEvent"in window,ia=null;l&&"documentMode"in document&&(ia=document.documentMode);var ds=l&&"TextEvent"in window&&!ia,Hl=l&&(!Cs||ia&&8<ia&&11>=ia),ei=" ",Yl=!1;function Ni(u,h){switch(u){case"keyup":return qr.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vo(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var us=!1;function vd(u,h){switch(u){case"compositionend":return Vo(h);case"keypress":return h.which!==32?null:(Yl=!0,ei);case"textInput":return u=h.data,u===ei&&Yl?null:u;default:return null}}function Ts(u,h){if(us)return u==="compositionend"||!Cs&&Ni(u,h)?(u=Oo(),Ns=vr=js=null,us=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Hl&&h.locale!=="ko"?null:h.data;default:return null}}var Ya={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gl(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h==="input"?!!Ya[u.type]:h==="textarea"}function Ga(u,h,b,T){Hs(T),h=C(h,"onChange"),0<h.length&&(b=new Io("onChange","change",null,b,T),u.push({event:b,listeners:h}))}var aa=null,br=null;function bd(u){$f(u,0)}function fs(u){var h=Jo(u);if(Se(h))return u}function _d(u,h){if(u==="change")return h}var Gr=!1;if(l){var Ci;if(l){var Za="oninput"in document;if(!Za){var Ka=document.createElement("div");Ka.setAttribute("oninput","return;"),Za=typeof Ka.oninput=="function"}Ci=Za}else Ci=!1;Gr=Ci&&(!document.documentMode||9<document.documentMode)}function oa(){aa&&(aa.detachEvent("onpropertychange",Ja),br=aa=null)}function Ja(u){if(u.propertyName==="value"&&fs(br)){var h=[];Ga(h,br,u,$r(u)),Ea(bd,h)}}function Qa(u,h,b){u==="focusin"?(oa(),aa=h,br=b,aa.attachEvent("onpropertychange",Ja)):u==="focusout"&&oa()}function Ti(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return fs(br)}function Xa(u,h){if(u==="click")return fs(h)}function Bo(u,h){if(u==="input"||u==="change")return fs(h)}function Zl(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var zr=typeof Object.is=="function"?Object.is:Zl;function Ps(u,h){if(zr(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var b=Object.keys(u),T=Object.keys(h);if(b.length!==T.length)return!1;for(T=0;T<b.length;T++){var R=b[T];if(!c.call(h,R)||!zr(u[R],h[R]))return!1}return!0}function Kl(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function Wo(u,h){var b=Kl(u);u=0;for(var T;b;){if(b.nodeType===3){if(T=u+b.textContent.length,u<=h&&T>=h)return{node:b,offset:h-u};u=T}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=Kl(b)}}function Jl(u,h){return u&&h?u===h?!0:u&&u.nodeType===3?!1:h&&h.nodeType===3?Jl(u,h.parentNode):"contains"in u?u.contains(h):u.compareDocumentPosition?!!(u.compareDocumentPosition(h)&16):!1:!1}function $o(){for(var u=window,h=ye();h instanceof u.HTMLIFrameElement;){try{var b=typeof h.contentWindow.location.href=="string"}catch{b=!1}if(b)u=h.contentWindow;else break;h=ye(u.document)}return h}function Ho(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h&&(h==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||h==="textarea"||u.contentEditable==="true")}function g(u){var h=$o(),b=u.focusedElem,T=u.selectionRange;if(h!==b&&b&&b.ownerDocument&&Jl(b.ownerDocument.documentElement,b)){if(T!==null&&Ho(b)){if(h=T.start,u=T.end,u===void 0&&(u=h),"selectionStart"in b)b.selectionStart=h,b.selectionEnd=Math.min(u,b.value.length);else if(u=(h=b.ownerDocument||document)&&h.defaultView||window,u.getSelection){u=u.getSelection();var R=b.textContent.length,z=Math.min(T.start,R);T=T.end===void 0?z:Math.min(T.end,R),!u.extend&&z>T&&(R=T,T=z,z=R),R=Wo(b,z);var Z=Wo(b,T);R&&Z&&(u.rangeCount!==1||u.anchorNode!==R.node||u.anchorOffset!==R.offset||u.focusNode!==Z.node||u.focusOffset!==Z.offset)&&(h=h.createRange(),h.setStart(R.node,R.offset),u.removeAllRanges(),z>T?(u.addRange(h),u.extend(Z.node,Z.offset)):(h.setEnd(Z.node,Z.offset),u.addRange(h)))}}for(h=[],u=b;u=u.parentNode;)u.nodeType===1&&h.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<h.length;b++)u=h[b],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var Su=l&&"documentMode"in document&&11>=document.documentMode,Ql=null,Xl=null,wd=null,ju=!1;function Cm(u,h,b){var T=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;ju||Ql==null||Ql!==ye(T)||(T=Ql,"selectionStart"in T&&Ho(T)?T={start:T.selectionStart,end:T.selectionEnd}:(T=(T.ownerDocument&&T.ownerDocument.defaultView||window).getSelection(),T={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset}),wd&&Ps(wd,T)||(wd=T,T=C(Xl,"onSelect"),0<T.length&&(h=new Io("onSelect","select",null,h,b),u.push({event:h,listeners:T}),h.target=Ql)))}function eo(u,h){var b={};return b[u.toLowerCase()]=h.toLowerCase(),b["Webkit"+u]="webkit"+h,b["Moz"+u]="moz"+h,b}var ec={animationend:eo("Animation","AnimationEnd"),animationiteration:eo("Animation","AnimationIteration"),animationstart:eo("Animation","AnimationStart"),transitionend:eo("Transition","TransitionEnd")},to={},Uf={};l&&(Uf=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Sd(u){if(to[u])return to[u];if(!ec[u])return u;var h=ec[u],b;for(b in h)if(h.hasOwnProperty(b)&&b in Uf)return to[u]=h[b];return u}var Tm=Sd("animationend"),Pi=Sd("animationiteration"),Vf=Sd("animationstart"),Bf=Sd("transitionend"),tc=new Map,Pm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ti(u,h){tc.set(u,h),a(h,[u])}for(var Yo=0;Yo<Pm.length;Yo++){var Nu=Pm[Yo],Mm=Nu.toLowerCase(),Sy=Nu[0].toUpperCase()+Nu.slice(1);ti(Mm,"on"+Sy)}ti(Tm,"onAnimationEnd"),ti(Pi,"onAnimationIteration"),ti(Vf,"onAnimationStart"),ti("dblclick","onDoubleClick"),ti("focusin","onFocus"),ti("focusout","onBlur"),ti(Bf,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),km=new Set("cancel close invalid load scroll toggle".split(" ").concat(nc));function Wf(u,h,b){var T=u.type||"unknown-event";u.currentTarget=b,No(T,h,void 0,u),u.currentTarget=null}function $f(u,h){h=(h&4)!==0;for(var b=0;b<u.length;b++){var T=u[b],R=T.event;T=T.listeners;e:{var z=void 0;if(h)for(var Z=T.length-1;0<=Z;Z--){var he=T[Z],ve=he.instance,Ie=he.currentTarget;if(he=he.listener,ve!==z&&R.isPropagationStopped())break e;Wf(R,he,Ie),z=ve}else for(Z=0;Z<T.length;Z++){if(he=T[Z],ve=he.instance,Ie=he.currentTarget,he=he.listener,ve!==z&&R.isPropagationStopped())break e;Wf(R,he,Ie),z=ve}}}if(Ki)throw u=Da,Ki=!1,Da=null,u}function bn(u,h){var b=h[ac];b===void 0&&(b=h[ac]=new Set);var T=u+"__bubble";b.has(T)||(Em(h,u,2,!1),b.add(T))}function Hf(u,h,b){var T=0;h&&(T|=4),Em(b,u,T,h)}var jd="_reactListening"+Math.random().toString(36).slice(2);function rc(u){if(!u[jd]){u[jd]=!0,r.forEach(function(b){b!=="selectionchange"&&(km.has(b)||Hf(b,!1,u),Hf(b,!0,u))});var h=u.nodeType===9?u:u.ownerDocument;h===null||h[jd]||(h[jd]=!0,Hf("selectionchange",!1,h))}}function Em(u,h,b,T){switch(Ut(h)){case 1:var R=cd;break;case 4:R=Ll;break;default:R=sa}b=R.bind(null,h,b,u),R=void 0,!jo||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(R=!0),T?R!==void 0?u.addEventListener(h,b,{capture:!0,passive:R}):u.addEventListener(h,b,!0):R!==void 0?u.addEventListener(h,b,{passive:R}):u.addEventListener(h,b,!1)}function f(u,h,b,T,R){var z=T;if((h&1)===0&&(h&2)===0&&T!==null)e:for(;;){if(T===null)return;var Z=T.tag;if(Z===3||Z===4){var he=T.stateNode.containerInfo;if(he===R||he.nodeType===8&&he.parentNode===R)break;if(Z===4)for(Z=T.return;Z!==null;){var ve=Z.tag;if((ve===3||ve===4)&&(ve=Z.stateNode.containerInfo,ve===R||ve.nodeType===8&&ve.parentNode===R))return;Z=Z.return}for(;he!==null;){if(Z=Zo(he),Z===null)return;if(ve=Z.tag,ve===5||ve===6){T=z=Z;continue e}he=he.parentNode}}T=T.return}Ea(function(){var Ie=z,$e=$r(b),Ye=[];e:{var We=tc.get(u);if(We!==void 0){var it=Io,ut=u;switch(u){case"keypress":if(Wa(b)===0)break e;case"keydown":case"keyup":it=Vl;break;case"focusin":ut="focus",it=$a;break;case"focusout":ut="blur",it=$a;break;case"beforeblur":case"afterblur":it=$a;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":it=Ro;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":it=Lo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":it=Uo;break;case Tm:case Pi:case Vf:it=fd;break;case Bf:it=xd;break;case"scroll":it=dd;break;case"wheel":it=yd;break;case"copy":case"cut":case"paste":it=Fo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":it=Wl}var ht=(h&4)!==0,rr=!ht&&u==="scroll",Te=ht?We!==null?We+"Capture":null:We;ht=[];for(var we=Ie,Ee;we!==null;){Ee=we;var Ze=Ee.stateNode;if(Ee.tag===5&&Ze!==null&&(Ee=Ze,Te!==null&&(Ze=Gi(we,Te),Ze!=null&&ht.push(y(we,Ze,Ee)))),rr)break;we=we.return}0<ht.length&&(We=new it(We,ut,null,b,$e),Ye.push({event:We,listeners:ht}))}}if((h&7)===0){e:{if(We=u==="mouseover"||u==="pointerover",it=u==="mouseout"||u==="pointerout",We&&b!==Pr&&(ut=b.relatedTarget||b.fromElement)&&(Zo(ut)||ut[hn]))break e;if((it||We)&&(We=$e.window===$e?$e:(We=$e.ownerDocument)?We.defaultView||We.parentWindow:window,it?(ut=b.relatedTarget||b.toElement,it=Ie,ut=ut?Zo(ut):null,ut!==null&&(rr=Ss(ut),ut!==rr||ut.tag!==5&&ut.tag!==6)&&(ut=null)):(it=null,ut=Ie),it!==ut)){if(ht=Ro,Ze="onMouseLeave",Te="onMouseEnter",we="mouse",(u==="pointerout"||u==="pointerover")&&(ht=Wl,Ze="onPointerLeave",Te="onPointerEnter",we="pointer"),rr=it==null?We:Jo(it),Ee=ut==null?We:Jo(ut),We=new ht(Ze,we+"leave",it,b,$e),We.target=rr,We.relatedTarget=Ee,Ze=null,Zo($e)===Ie&&(ht=new ht(Te,we+"enter",ut,b,$e),ht.target=Ee,ht.relatedTarget=rr,Ze=ht),rr=Ze,it&&ut)t:{for(ht=it,Te=ut,we=0,Ee=ht;Ee;Ee=A(Ee))we++;for(Ee=0,Ze=Te;Ze;Ze=A(Ze))Ee++;for(;0<we-Ee;)ht=A(ht),we--;for(;0<Ee-we;)Te=A(Te),Ee--;for(;we--;){if(ht===Te||Te!==null&&ht===Te.alternate)break t;ht=A(ht),Te=A(Te)}ht=null}else ht=null;it!==null&&V(Ye,We,it,ht,!1),ut!==null&&rr!==null&&V(Ye,rr,ut,ht,!0)}}e:{if(We=Ie?Jo(Ie):window,it=We.nodeName&&We.nodeName.toLowerCase(),it==="select"||it==="input"&&We.type==="file")var mt=_d;else if(Gl(We))if(Gr)mt=Bo;else{mt=Ti;var Nt=Qa}else(it=We.nodeName)&&it.toLowerCase()==="input"&&(We.type==="checkbox"||We.type==="radio")&&(mt=Xa);if(mt&&(mt=mt(u,Ie))){Ga(Ye,mt,b,$e);break e}Nt&&Nt(u,We,Ie),u==="focusout"&&(Nt=We._wrapperState)&&Nt.controlled&&We.type==="number"&&Be(We,"number",We.value)}switch(Nt=Ie?Jo(Ie):window,u){case"focusin":(Gl(Nt)||Nt.contentEditable==="true")&&(Ql=Nt,Xl=Ie,wd=null);break;case"focusout":wd=Xl=Ql=null;break;case"mousedown":ju=!0;break;case"contextmenu":case"mouseup":case"dragend":ju=!1,Cm(Ye,b,$e);break;case"selectionchange":if(Su)break;case"keydown":case"keyup":Cm(Ye,b,$e)}var Ct;if(Cs)e:{switch(u){case"compositionstart":var Dt="onCompositionStart";break e;case"compositionend":Dt="onCompositionEnd";break e;case"compositionupdate":Dt="onCompositionUpdate";break e}Dt=void 0}else us?Ni(u,b)&&(Dt="onCompositionEnd"):u==="keydown"&&b.keyCode===229&&(Dt="onCompositionStart");Dt&&(Hl&&b.locale!=="ko"&&(us||Dt!=="onCompositionStart"?Dt==="onCompositionEnd"&&us&&(Ct=Oo()):(js=$e,vr="value"in js?js.value:js.textContent,us=!0)),Nt=C(Ie,Dt),0<Nt.length&&(Dt=new qo(Dt,u,null,b,$e),Ye.push({event:Dt,listeners:Nt}),Ct?Dt.data=Ct:(Ct=Vo(b),Ct!==null&&(Dt.data=Ct)))),(Ct=ds?vd(u,b):Ts(u,b))&&(Ie=C(Ie,"onBeforeInput"),0<Ie.length&&($e=new qo("onBeforeInput","beforeinput",null,b,$e),Ye.push({event:$e,listeners:Ie}),$e.data=Ct))}$f(Ye,h)})}function y(u,h,b){return{instance:u,listener:h,currentTarget:b}}function C(u,h){for(var b=h+"Capture",T=[];u!==null;){var R=u,z=R.stateNode;R.tag===5&&z!==null&&(R=z,z=Gi(u,b),z!=null&&T.unshift(y(u,z,R)),z=Gi(u,h),z!=null&&T.push(y(u,z,R))),u=u.return}return T}function A(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function V(u,h,b,T,R){for(var z=h._reactName,Z=[];b!==null&&b!==T;){var he=b,ve=he.alternate,Ie=he.stateNode;if(ve!==null&&ve===T)break;he.tag===5&&Ie!==null&&(he=Ie,R?(ve=Gi(b,z),ve!=null&&Z.unshift(y(b,ve,he))):R||(ve=Gi(b,z),ve!=null&&Z.push(y(b,ve,he)))),b=b.return}Z.length!==0&&u.push({event:h,listeners:Z})}var J=/\r\n?/g,ge=/\u0000|\uFFFD/g;function Ce(u){return(typeof u=="string"?u:""+u).replace(J,`
`).replace(ge,"")}function Oe(u,h,b){if(h=Ce(h),Ce(u)!==h&&b)throw Error(t(425))}function Ve(){}var rt=null,_t=null;function zt(u,h){return u==="textarea"||u==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var _r=typeof setTimeout=="function"?setTimeout:void 0,ur=typeof clearTimeout=="function"?clearTimeout:void 0,hs=typeof Promise=="function"?Promise:void 0,Zr=typeof queueMicrotask=="function"?queueMicrotask:typeof hs<"u"?function(u){return hs.resolve(null).then(u).catch(sc)}:_r;function sc(u){setTimeout(function(){throw u})}function Yf(u,h){var b=h,T=0;do{var R=b.nextSibling;if(u.removeChild(b),R&&R.nodeType===8)if(b=R.data,b==="/$"){if(T===0){u.removeChild(R),Lr(h);return}T--}else b!=="$"&&b!=="$?"&&b!=="$!"||T++;b=R}while(b);Lr(h)}function no(u){for(;u!=null;u=u.nextSibling){var h=u.nodeType;if(h===1||h===3)break;if(h===8){if(h=u.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return u}function Dm(u){u=u.previousSibling;for(var h=0;u;){if(u.nodeType===8){var b=u.data;if(b==="$"||b==="$!"||b==="$?"){if(h===0)return u;h--}else b==="/$"&&h++}u=u.previousSibling}return null}var Go=Math.random().toString(36).slice(2),Mi="__reactFiber$"+Go,ic="__reactProps$"+Go,hn="__reactContainer$"+Go,ac="__reactEvents$"+Go,jy="__reactListeners$"+Go,Ny="__reactHandles$"+Go;function Zo(u){var h=u[Mi];if(h)return h;for(var b=u.parentNode;b;){if(h=b[hn]||b[Mi]){if(b=h.alternate,h.child!==null||b!==null&&b.child!==null)for(u=Dm(u);u!==null;){if(b=u[Mi])return b;u=Dm(u)}return h}u=b,b=u.parentNode}return null}function Ko(u){return u=u[Mi]||u[hn],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function Jo(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function Cu(u){return u[ic]||null}var Cy=[],Tu=-1;function oc(u){return{current:u}}function Rn(u){0>Tu||(u.current=Cy[Tu],Cy[Tu]=null,Tu--)}function Dn(u,h){Tu++,Cy[Tu]=u.current,u.current=h}var lc={},Kr=oc(lc),Ms=oc(!1),Nd=lc;function Pu(u,h){var b=u.type.contextTypes;if(!b)return lc;var T=u.stateNode;if(T&&T.__reactInternalMemoizedUnmaskedChildContext===h)return T.__reactInternalMemoizedMaskedChildContext;var R={},z;for(z in b)R[z]=h[z];return T&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=h,u.__reactInternalMemoizedMaskedChildContext=R),R}function ks(u){return u=u.childContextTypes,u!=null}function Om(){Rn(Ms),Rn(Kr)}function d1(u,h,b){if(Kr.current!==lc)throw Error(t(168));Dn(Kr,h),Dn(Ms,b)}function u1(u,h,b){var T=u.stateNode;if(h=h.childContextTypes,typeof T.getChildContext!="function")return b;T=T.getChildContext();for(var R in T)if(!(R in h))throw Error(t(108,_e(u)||"Unknown",R));return se({},b,T)}function Im(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||lc,Nd=Kr.current,Dn(Kr,u),Dn(Ms,Ms.current),!0}function f1(u,h,b){var T=u.stateNode;if(!T)throw Error(t(169));b?(u=u1(u,h,Nd),T.__reactInternalMemoizedMergedChildContext=u,Rn(Ms),Rn(Kr),Dn(Kr,u)):Rn(Ms),Dn(Ms,b)}var Qo=null,Am=!1,Ty=!1;function h1(u){Qo===null?Qo=[u]:Qo.push(u)}function C6(u){Am=!0,h1(u)}function cc(){if(!Ty&&Qo!==null){Ty=!0;var u=0,h=$t;try{var b=Qo;for($t=1;u<b.length;u++){var T=b[u];do T=T(!0);while(T!==null)}Qo=null,Am=!1}catch(R){throw Qo!==null&&(Qo=Qo.slice(u+1)),Il(Po,cc),R}finally{$t=h,Ty=!1}}return null}var Mu=[],ku=0,Rm=null,Lm=0,ki=[],Ei=0,Cd=null,Xo=1,el="";function Td(u,h){Mu[ku++]=Lm,Mu[ku++]=Rm,Rm=u,Lm=h}function m1(u,h,b){ki[Ei++]=Xo,ki[Ei++]=el,ki[Ei++]=Cd,Cd=u;var T=Xo;u=el;var R=32-Mt(T)-1;T&=~(1<<R),b+=1;var z=32-Mt(h)+R;if(30<z){var Z=R-R%5;z=(T&(1<<Z)-1).toString(32),T>>=Z,R-=Z,Xo=1<<32-Mt(h)+R|b<<R|T,el=z+u}else Xo=1<<z|b<<R|T,el=u}function Py(u){u.return!==null&&(Td(u,1),m1(u,1,0))}function My(u){for(;u===Rm;)Rm=Mu[--ku],Mu[ku]=null,Lm=Mu[--ku],Mu[ku]=null;for(;u===Cd;)Cd=ki[--Ei],ki[Ei]=null,el=ki[--Ei],ki[Ei]=null,Xo=ki[--Ei],ki[Ei]=null}var ni=null,ri=null,Vn=!1,la=null;function p1(u,h){var b=Ai(5,null,null,0);b.elementType="DELETED",b.stateNode=h,b.return=u,h=u.deletions,h===null?(u.deletions=[b],u.flags|=16):h.push(b)}function g1(u,h){switch(u.tag){case 5:var b=u.type;return h=h.nodeType!==1||b.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(u.stateNode=h,ni=u,ri=no(h.firstChild),!0):!1;case 6:return h=u.pendingProps===""||h.nodeType!==3?null:h,h!==null?(u.stateNode=h,ni=u,ri=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(b=Cd!==null?{id:Xo,overflow:el}:null,u.memoizedState={dehydrated:h,treeContext:b,retryLane:1073741824},b=Ai(18,null,null,0),b.stateNode=h,b.return=u,u.child=b,ni=u,ri=null,!0):!1;default:return!1}}function ky(u){return(u.mode&1)!==0&&(u.flags&128)===0}function Ey(u){if(Vn){var h=ri;if(h){var b=h;if(!g1(u,h)){if(ky(u))throw Error(t(418));h=no(b.nextSibling);var T=ni;h&&g1(u,h)?p1(T,b):(u.flags=u.flags&-4097|2,Vn=!1,ni=u)}}else{if(ky(u))throw Error(t(418));u.flags=u.flags&-4097|2,Vn=!1,ni=u}}}function x1(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;ni=u}function Fm(u){if(u!==ni)return!1;if(!Vn)return x1(u),Vn=!0,!1;var h;if((h=u.tag!==3)&&!(h=u.tag!==5)&&(h=u.type,h=h!=="head"&&h!=="body"&&!zt(u.type,u.memoizedProps)),h&&(h=ri)){if(ky(u))throw y1(),Error(t(418));for(;h;)p1(u,h),h=no(h.nextSibling)}if(x1(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,h=0;u;){if(u.nodeType===8){var b=u.data;if(b==="/$"){if(h===0){ri=no(u.nextSibling);break e}h--}else b!=="$"&&b!=="$!"&&b!=="$?"||h++}u=u.nextSibling}ri=null}}else ri=ni?no(u.stateNode.nextSibling):null;return!0}function y1(){for(var u=ri;u;)u=no(u.nextSibling)}function Eu(){ri=ni=null,Vn=!1}function Dy(u){la===null?la=[u]:la.push(u)}var T6=M.ReactCurrentBatchConfig;function Gf(u,h,b){if(u=b.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(t(309));var T=b.stateNode}if(!T)throw Error(t(147,u));var R=T,z=""+u;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===z?h.ref:(h=function(Z){var he=R.refs;Z===null?delete he[z]:he[z]=Z},h._stringRef=z,h)}if(typeof u!="string")throw Error(t(284));if(!b._owner)throw Error(t(290,u))}return u}function qm(u,h){throw u=Object.prototype.toString.call(h),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u))}function v1(u){var h=u._init;return h(u._payload)}function b1(u){function h(Te,we){if(u){var Ee=Te.deletions;Ee===null?(Te.deletions=[we],Te.flags|=16):Ee.push(we)}}function b(Te,we){if(!u)return null;for(;we!==null;)h(Te,we),we=we.sibling;return null}function T(Te,we){for(Te=new Map;we!==null;)we.key!==null?Te.set(we.key,we):Te.set(we.index,we),we=we.sibling;return Te}function R(Te,we){return Te=xc(Te,we),Te.index=0,Te.sibling=null,Te}function z(Te,we,Ee){return Te.index=Ee,u?(Ee=Te.alternate,Ee!==null?(Ee=Ee.index,Ee<we?(Te.flags|=2,we):Ee):(Te.flags|=2,we)):(Te.flags|=1048576,we)}function Z(Te){return u&&Te.alternate===null&&(Te.flags|=2),Te}function he(Te,we,Ee,Ze){return we===null||we.tag!==6?(we=Sv(Ee,Te.mode,Ze),we.return=Te,we):(we=R(we,Ee),we.return=Te,we)}function ve(Te,we,Ee,Ze){var mt=Ee.type;return mt===q?$e(Te,we,Ee.props.children,Ze,Ee.key):we!==null&&(we.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===te&&v1(mt)===we.type)?(Ze=R(we,Ee.props),Ze.ref=Gf(Te,we,Ee),Ze.return=Te,Ze):(Ze=cp(Ee.type,Ee.key,Ee.props,null,Te.mode,Ze),Ze.ref=Gf(Te,we,Ee),Ze.return=Te,Ze)}function Ie(Te,we,Ee,Ze){return we===null||we.tag!==4||we.stateNode.containerInfo!==Ee.containerInfo||we.stateNode.implementation!==Ee.implementation?(we=jv(Ee,Te.mode,Ze),we.return=Te,we):(we=R(we,Ee.children||[]),we.return=Te,we)}function $e(Te,we,Ee,Ze,mt){return we===null||we.tag!==7?(we=Ad(Ee,Te.mode,Ze,mt),we.return=Te,we):(we=R(we,Ee),we.return=Te,we)}function Ye(Te,we,Ee){if(typeof we=="string"&&we!==""||typeof we=="number")return we=Sv(""+we,Te.mode,Ee),we.return=Te,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case D:return Ee=cp(we.type,we.key,we.props,null,Te.mode,Ee),Ee.ref=Gf(Te,null,we),Ee.return=Te,Ee;case O:return we=jv(we,Te.mode,Ee),we.return=Te,we;case te:var Ze=we._init;return Ye(Te,Ze(we._payload),Ee)}if(de(we)||H(we))return we=Ad(we,Te.mode,Ee,null),we.return=Te,we;qm(Te,we)}return null}function We(Te,we,Ee,Ze){var mt=we!==null?we.key:null;if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return mt!==null?null:he(Te,we,""+Ee,Ze);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case D:return Ee.key===mt?ve(Te,we,Ee,Ze):null;case O:return Ee.key===mt?Ie(Te,we,Ee,Ze):null;case te:return mt=Ee._init,We(Te,we,mt(Ee._payload),Ze)}if(de(Ee)||H(Ee))return mt!==null?null:$e(Te,we,Ee,Ze,null);qm(Te,Ee)}return null}function it(Te,we,Ee,Ze,mt){if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number")return Te=Te.get(Ee)||null,he(we,Te,""+Ze,mt);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case D:return Te=Te.get(Ze.key===null?Ee:Ze.key)||null,ve(we,Te,Ze,mt);case O:return Te=Te.get(Ze.key===null?Ee:Ze.key)||null,Ie(we,Te,Ze,mt);case te:var Nt=Ze._init;return it(Te,we,Ee,Nt(Ze._payload),mt)}if(de(Ze)||H(Ze))return Te=Te.get(Ee)||null,$e(we,Te,Ze,mt,null);qm(we,Ze)}return null}function ut(Te,we,Ee,Ze){for(var mt=null,Nt=null,Ct=we,Dt=we=0,Or=null;Ct!==null&&Dt<Ee.length;Dt++){Ct.index>Dt?(Or=Ct,Ct=null):Or=Ct.sibling;var rn=We(Te,Ct,Ee[Dt],Ze);if(rn===null){Ct===null&&(Ct=Or);break}u&&Ct&&rn.alternate===null&&h(Te,Ct),we=z(rn,we,Dt),Nt===null?mt=rn:Nt.sibling=rn,Nt=rn,Ct=Or}if(Dt===Ee.length)return b(Te,Ct),Vn&&Td(Te,Dt),mt;if(Ct===null){for(;Dt<Ee.length;Dt++)Ct=Ye(Te,Ee[Dt],Ze),Ct!==null&&(we=z(Ct,we,Dt),Nt===null?mt=Ct:Nt.sibling=Ct,Nt=Ct);return Vn&&Td(Te,Dt),mt}for(Ct=T(Te,Ct);Dt<Ee.length;Dt++)Or=it(Ct,Te,Dt,Ee[Dt],Ze),Or!==null&&(u&&Or.alternate!==null&&Ct.delete(Or.key===null?Dt:Or.key),we=z(Or,we,Dt),Nt===null?mt=Or:Nt.sibling=Or,Nt=Or);return u&&Ct.forEach(function(yc){return h(Te,yc)}),Vn&&Td(Te,Dt),mt}function ht(Te,we,Ee,Ze){var mt=H(Ee);if(typeof mt!="function")throw Error(t(150));if(Ee=mt.call(Ee),Ee==null)throw Error(t(151));for(var Nt=mt=null,Ct=we,Dt=we=0,Or=null,rn=Ee.next();Ct!==null&&!rn.done;Dt++,rn=Ee.next()){Ct.index>Dt?(Or=Ct,Ct=null):Or=Ct.sibling;var yc=We(Te,Ct,rn.value,Ze);if(yc===null){Ct===null&&(Ct=Or);break}u&&Ct&&yc.alternate===null&&h(Te,Ct),we=z(yc,we,Dt),Nt===null?mt=yc:Nt.sibling=yc,Nt=yc,Ct=Or}if(rn.done)return b(Te,Ct),Vn&&Td(Te,Dt),mt;if(Ct===null){for(;!rn.done;Dt++,rn=Ee.next())rn=Ye(Te,rn.value,Ze),rn!==null&&(we=z(rn,we,Dt),Nt===null?mt=rn:Nt.sibling=rn,Nt=rn);return Vn&&Td(Te,Dt),mt}for(Ct=T(Te,Ct);!rn.done;Dt++,rn=Ee.next())rn=it(Ct,Te,Dt,rn.value,Ze),rn!==null&&(u&&rn.alternate!==null&&Ct.delete(rn.key===null?Dt:rn.key),we=z(rn,we,Dt),Nt===null?mt=rn:Nt.sibling=rn,Nt=rn);return u&&Ct.forEach(function(aq){return h(Te,aq)}),Vn&&Td(Te,Dt),mt}function rr(Te,we,Ee,Ze){if(typeof Ee=="object"&&Ee!==null&&Ee.type===q&&Ee.key===null&&(Ee=Ee.props.children),typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case D:e:{for(var mt=Ee.key,Nt=we;Nt!==null;){if(Nt.key===mt){if(mt=Ee.type,mt===q){if(Nt.tag===7){b(Te,Nt.sibling),we=R(Nt,Ee.props.children),we.return=Te,Te=we;break e}}else if(Nt.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===te&&v1(mt)===Nt.type){b(Te,Nt.sibling),we=R(Nt,Ee.props),we.ref=Gf(Te,Nt,Ee),we.return=Te,Te=we;break e}b(Te,Nt);break}else h(Te,Nt);Nt=Nt.sibling}Ee.type===q?(we=Ad(Ee.props.children,Te.mode,Ze,Ee.key),we.return=Te,Te=we):(Ze=cp(Ee.type,Ee.key,Ee.props,null,Te.mode,Ze),Ze.ref=Gf(Te,we,Ee),Ze.return=Te,Te=Ze)}return Z(Te);case O:e:{for(Nt=Ee.key;we!==null;){if(we.key===Nt)if(we.tag===4&&we.stateNode.containerInfo===Ee.containerInfo&&we.stateNode.implementation===Ee.implementation){b(Te,we.sibling),we=R(we,Ee.children||[]),we.return=Te,Te=we;break e}else{b(Te,we);break}else h(Te,we);we=we.sibling}we=jv(Ee,Te.mode,Ze),we.return=Te,Te=we}return Z(Te);case te:return Nt=Ee._init,rr(Te,we,Nt(Ee._payload),Ze)}if(de(Ee))return ut(Te,we,Ee,Ze);if(H(Ee))return ht(Te,we,Ee,Ze);qm(Te,Ee)}return typeof Ee=="string"&&Ee!==""||typeof Ee=="number"?(Ee=""+Ee,we!==null&&we.tag===6?(b(Te,we.sibling),we=R(we,Ee),we.return=Te,Te=we):(b(Te,we),we=Sv(Ee,Te.mode,Ze),we.return=Te,Te=we),Z(Te)):b(Te,we)}return rr}var Du=b1(!0),_1=b1(!1),zm=oc(null),Um=null,Ou=null,Oy=null;function Iy(){Oy=Ou=Um=null}function Ay(u){var h=zm.current;Rn(zm),u._currentValue=h}function Ry(u,h,b){for(;u!==null;){var T=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,T!==null&&(T.childLanes|=h)):T!==null&&(T.childLanes&h)!==h&&(T.childLanes|=h),u===b)break;u=u.return}}function Iu(u,h){Um=u,Oy=Ou=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&h)!==0&&(Es=!0),u.firstContext=null)}function Di(u){var h=u._currentValue;if(Oy!==u)if(u={context:u,memoizedValue:h,next:null},Ou===null){if(Um===null)throw Error(t(308));Ou=u,Um.dependencies={lanes:0,firstContext:u}}else Ou=Ou.next=u;return h}var Pd=null;function Ly(u){Pd===null?Pd=[u]:Pd.push(u)}function w1(u,h,b,T){var R=h.interleaved;return R===null?(b.next=b,Ly(h)):(b.next=R.next,R.next=b),h.interleaved=b,tl(u,T)}function tl(u,h){u.lanes|=h;var b=u.alternate;for(b!==null&&(b.lanes|=h),b=u,u=u.return;u!==null;)u.childLanes|=h,b=u.alternate,b!==null&&(b.childLanes|=h),b=u,u=u.return;return b.tag===3?b.stateNode:null}var dc=!1;function Fy(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function S1(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function nl(u,h){return{eventTime:u,lane:h,tag:0,payload:null,callback:null,next:null}}function uc(u,h,b){var T=u.updateQueue;if(T===null)return null;if(T=T.shared,(tn&2)!==0){var R=T.pending;return R===null?h.next=h:(h.next=R.next,R.next=h),T.pending=h,tl(u,b)}return R=T.interleaved,R===null?(h.next=h,Ly(T)):(h.next=R.next,R.next=h),T.interleaved=h,tl(u,b)}function Vm(u,h,b){if(h=h.updateQueue,h!==null&&(h=h.shared,(b&4194240)!==0)){var T=h.lanes;T&=u.pendingLanes,b|=T,h.lanes=b,ls(u,b)}}function j1(u,h){var b=u.updateQueue,T=u.alternate;if(T!==null&&(T=T.updateQueue,b===T)){var R=null,z=null;if(b=b.firstBaseUpdate,b!==null){do{var Z={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};z===null?R=z=Z:z=z.next=Z,b=b.next}while(b!==null);z===null?R=z=h:z=z.next=h}else R=z=h;b={baseState:T.baseState,firstBaseUpdate:R,lastBaseUpdate:z,shared:T.shared,effects:T.effects},u.updateQueue=b;return}u=b.lastBaseUpdate,u===null?b.firstBaseUpdate=h:u.next=h,b.lastBaseUpdate=h}function Bm(u,h,b,T){var R=u.updateQueue;dc=!1;var z=R.firstBaseUpdate,Z=R.lastBaseUpdate,he=R.shared.pending;if(he!==null){R.shared.pending=null;var ve=he,Ie=ve.next;ve.next=null,Z===null?z=Ie:Z.next=Ie,Z=ve;var $e=u.alternate;$e!==null&&($e=$e.updateQueue,he=$e.lastBaseUpdate,he!==Z&&(he===null?$e.firstBaseUpdate=Ie:he.next=Ie,$e.lastBaseUpdate=ve))}if(z!==null){var Ye=R.baseState;Z=0,$e=Ie=ve=null,he=z;do{var We=he.lane,it=he.eventTime;if((T&We)===We){$e!==null&&($e=$e.next={eventTime:it,lane:0,tag:he.tag,payload:he.payload,callback:he.callback,next:null});e:{var ut=u,ht=he;switch(We=h,it=b,ht.tag){case 1:if(ut=ht.payload,typeof ut=="function"){Ye=ut.call(it,Ye,We);break e}Ye=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=ht.payload,We=typeof ut=="function"?ut.call(it,Ye,We):ut,We==null)break e;Ye=se({},Ye,We);break e;case 2:dc=!0}}he.callback!==null&&he.lane!==0&&(u.flags|=64,We=R.effects,We===null?R.effects=[he]:We.push(he))}else it={eventTime:it,lane:We,tag:he.tag,payload:he.payload,callback:he.callback,next:null},$e===null?(Ie=$e=it,ve=Ye):$e=$e.next=it,Z|=We;if(he=he.next,he===null){if(he=R.shared.pending,he===null)break;We=he,he=We.next,We.next=null,R.lastBaseUpdate=We,R.shared.pending=null}}while(!0);if($e===null&&(ve=Ye),R.baseState=ve,R.firstBaseUpdate=Ie,R.lastBaseUpdate=$e,h=R.shared.interleaved,h!==null){R=h;do Z|=R.lane,R=R.next;while(R!==h)}else z===null&&(R.shared.lanes=0);Ed|=Z,u.lanes=Z,u.memoizedState=Ye}}function N1(u,h,b){if(u=h.effects,h.effects=null,u!==null)for(h=0;h<u.length;h++){var T=u[h],R=T.callback;if(R!==null){if(T.callback=null,T=b,typeof R!="function")throw Error(t(191,R));R.call(T)}}}var Zf={},ro=oc(Zf),Kf=oc(Zf),Jf=oc(Zf);function Md(u){if(u===Zf)throw Error(t(174));return u}function qy(u,h){switch(Dn(Jf,h),Dn(Kf,u),Dn(ro,Zf),u=h.nodeType,u){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:nt(null,"");break;default:u=u===8?h.parentNode:h,h=u.namespaceURI||null,u=u.tagName,h=nt(h,u)}Rn(ro),Dn(ro,h)}function Au(){Rn(ro),Rn(Kf),Rn(Jf)}function C1(u){Md(Jf.current);var h=Md(ro.current),b=nt(h,u.type);h!==b&&(Dn(Kf,u),Dn(ro,b))}function zy(u){Kf.current===u&&(Rn(ro),Rn(Kf))}var Hn=oc(0);function Wm(u){for(var h=u;h!==null;){if(h.tag===13){var b=h.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var Uy=[];function Vy(){for(var u=0;u<Uy.length;u++)Uy[u]._workInProgressVersionPrimary=null;Uy.length=0}var $m=M.ReactCurrentDispatcher,By=M.ReactCurrentBatchConfig,kd=0,Yn=null,wr=null,Er=null,Hm=!1,Qf=!1,Xf=0,P6=0;function Jr(){throw Error(t(321))}function Wy(u,h){if(h===null)return!1;for(var b=0;b<h.length&&b<u.length;b++)if(!zr(u[b],h[b]))return!1;return!0}function $y(u,h,b,T,R,z){if(kd=z,Yn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,$m.current=u===null||u.memoizedState===null?D6:O6,u=b(T,R),Qf){z=0;do{if(Qf=!1,Xf=0,25<=z)throw Error(t(301));z+=1,Er=wr=null,h.updateQueue=null,$m.current=I6,u=b(T,R)}while(Qf)}if($m.current=Zm,h=wr!==null&&wr.next!==null,kd=0,Er=wr=Yn=null,Hm=!1,h)throw Error(t(300));return u}function Hy(){var u=Xf!==0;return Xf=0,u}function so(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Er===null?Yn.memoizedState=Er=u:Er=Er.next=u,Er}function Oi(){if(wr===null){var u=Yn.alternate;u=u!==null?u.memoizedState:null}else u=wr.next;var h=Er===null?Yn.memoizedState:Er.next;if(h!==null)Er=h,wr=u;else{if(u===null)throw Error(t(310));wr=u,u={memoizedState:wr.memoizedState,baseState:wr.baseState,baseQueue:wr.baseQueue,queue:wr.queue,next:null},Er===null?Yn.memoizedState=Er=u:Er=Er.next=u}return Er}function eh(u,h){return typeof h=="function"?h(u):h}function Yy(u){var h=Oi(),b=h.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=u;var T=wr,R=T.baseQueue,z=b.pending;if(z!==null){if(R!==null){var Z=R.next;R.next=z.next,z.next=Z}T.baseQueue=R=z,b.pending=null}if(R!==null){z=R.next,T=T.baseState;var he=Z=null,ve=null,Ie=z;do{var $e=Ie.lane;if((kd&$e)===$e)ve!==null&&(ve=ve.next={lane:0,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null}),T=Ie.hasEagerState?Ie.eagerState:u(T,Ie.action);else{var Ye={lane:$e,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null};ve===null?(he=ve=Ye,Z=T):ve=ve.next=Ye,Yn.lanes|=$e,Ed|=$e}Ie=Ie.next}while(Ie!==null&&Ie!==z);ve===null?Z=T:ve.next=he,zr(T,h.memoizedState)||(Es=!0),h.memoizedState=T,h.baseState=Z,h.baseQueue=ve,b.lastRenderedState=T}if(u=b.interleaved,u!==null){R=u;do z=R.lane,Yn.lanes|=z,Ed|=z,R=R.next;while(R!==u)}else R===null&&(b.lanes=0);return[h.memoizedState,b.dispatch]}function Gy(u){var h=Oi(),b=h.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=u;var T=b.dispatch,R=b.pending,z=h.memoizedState;if(R!==null){b.pending=null;var Z=R=R.next;do z=u(z,Z.action),Z=Z.next;while(Z!==R);zr(z,h.memoizedState)||(Es=!0),h.memoizedState=z,h.baseQueue===null&&(h.baseState=z),b.lastRenderedState=z}return[z,T]}function T1(){}function P1(u,h){var b=Yn,T=Oi(),R=h(),z=!zr(T.memoizedState,R);if(z&&(T.memoizedState=R,Es=!0),T=T.queue,Zy(E1.bind(null,b,T,u),[u]),T.getSnapshot!==h||z||Er!==null&&Er.memoizedState.tag&1){if(b.flags|=2048,th(9,k1.bind(null,b,T,R,h),void 0,null),Dr===null)throw Error(t(349));(kd&30)!==0||M1(b,h,R)}return R}function M1(u,h,b){u.flags|=16384,u={getSnapshot:h,value:b},h=Yn.updateQueue,h===null?(h={lastEffect:null,stores:null},Yn.updateQueue=h,h.stores=[u]):(b=h.stores,b===null?h.stores=[u]:b.push(u))}function k1(u,h,b,T){h.value=b,h.getSnapshot=T,D1(h)&&O1(u)}function E1(u,h,b){return b(function(){D1(h)&&O1(u)})}function D1(u){var h=u.getSnapshot;u=u.value;try{var b=h();return!zr(u,b)}catch{return!0}}function O1(u){var h=tl(u,1);h!==null&&fa(h,u,1,-1)}function I1(u){var h=so();return typeof u=="function"&&(u=u()),h.memoizedState=h.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eh,lastRenderedState:u},h.queue=u,u=u.dispatch=E6.bind(null,Yn,u),[h.memoizedState,u]}function th(u,h,b,T){return u={tag:u,create:h,destroy:b,deps:T,next:null},h=Yn.updateQueue,h===null?(h={lastEffect:null,stores:null},Yn.updateQueue=h,h.lastEffect=u.next=u):(b=h.lastEffect,b===null?h.lastEffect=u.next=u:(T=b.next,b.next=u,u.next=T,h.lastEffect=u)),u}function A1(){return Oi().memoizedState}function Ym(u,h,b,T){var R=so();Yn.flags|=u,R.memoizedState=th(1|h,b,void 0,T===void 0?null:T)}function Gm(u,h,b,T){var R=Oi();T=T===void 0?null:T;var z=void 0;if(wr!==null){var Z=wr.memoizedState;if(z=Z.destroy,T!==null&&Wy(T,Z.deps)){R.memoizedState=th(h,b,z,T);return}}Yn.flags|=u,R.memoizedState=th(1|h,b,z,T)}function R1(u,h){return Ym(8390656,8,u,h)}function Zy(u,h){return Gm(2048,8,u,h)}function L1(u,h){return Gm(4,2,u,h)}function F1(u,h){return Gm(4,4,u,h)}function q1(u,h){if(typeof h=="function")return u=u(),h(u),function(){h(null)};if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function z1(u,h,b){return b=b!=null?b.concat([u]):null,Gm(4,4,q1.bind(null,h,u),b)}function Ky(){}function U1(u,h){var b=Oi();h=h===void 0?null:h;var T=b.memoizedState;return T!==null&&h!==null&&Wy(h,T[1])?T[0]:(b.memoizedState=[u,h],u)}function V1(u,h){var b=Oi();h=h===void 0?null:h;var T=b.memoizedState;return T!==null&&h!==null&&Wy(h,T[1])?T[0]:(u=u(),b.memoizedState=[u,h],u)}function B1(u,h,b){return(kd&21)===0?(u.baseState&&(u.baseState=!1,Es=!0),u.memoizedState=b):(zr(b,h)||(b=Rl(),Yn.lanes|=b,Ed|=b,u.baseState=!0),h)}function M6(u,h){var b=$t;$t=b!==0&&4>b?b:4,u(!0);var T=By.transition;By.transition={};try{u(!1),h()}finally{$t=b,By.transition=T}}function W1(){return Oi().memoizedState}function k6(u,h,b){var T=pc(u);if(b={lane:T,action:b,hasEagerState:!1,eagerState:null,next:null},$1(u))H1(h,b);else if(b=w1(u,h,b,T),b!==null){var R=ps();fa(b,u,T,R),Y1(b,h,T)}}function E6(u,h,b){var T=pc(u),R={lane:T,action:b,hasEagerState:!1,eagerState:null,next:null};if($1(u))H1(h,R);else{var z=u.alternate;if(u.lanes===0&&(z===null||z.lanes===0)&&(z=h.lastRenderedReducer,z!==null))try{var Z=h.lastRenderedState,he=z(Z,b);if(R.hasEagerState=!0,R.eagerState=he,zr(he,Z)){var ve=h.interleaved;ve===null?(R.next=R,Ly(h)):(R.next=ve.next,ve.next=R),h.interleaved=R;return}}catch{}finally{}b=w1(u,h,R,T),b!==null&&(R=ps(),fa(b,u,T,R),Y1(b,h,T))}}function $1(u){var h=u.alternate;return u===Yn||h!==null&&h===Yn}function H1(u,h){Qf=Hm=!0;var b=u.pending;b===null?h.next=h:(h.next=b.next,b.next=h),u.pending=h}function Y1(u,h,b){if((b&4194240)!==0){var T=h.lanes;T&=u.pendingLanes,b|=T,h.lanes=b,ls(u,b)}}var Zm={readContext:Di,useCallback:Jr,useContext:Jr,useEffect:Jr,useImperativeHandle:Jr,useInsertionEffect:Jr,useLayoutEffect:Jr,useMemo:Jr,useReducer:Jr,useRef:Jr,useState:Jr,useDebugValue:Jr,useDeferredValue:Jr,useTransition:Jr,useMutableSource:Jr,useSyncExternalStore:Jr,useId:Jr,unstable_isNewReconciler:!1},D6={readContext:Di,useCallback:function(u,h){return so().memoizedState=[u,h===void 0?null:h],u},useContext:Di,useEffect:R1,useImperativeHandle:function(u,h,b){return b=b!=null?b.concat([u]):null,Ym(4194308,4,q1.bind(null,h,u),b)},useLayoutEffect:function(u,h){return Ym(4194308,4,u,h)},useInsertionEffect:function(u,h){return Ym(4,2,u,h)},useMemo:function(u,h){var b=so();return h=h===void 0?null:h,u=u(),b.memoizedState=[u,h],u},useReducer:function(u,h,b){var T=so();return h=b!==void 0?b(h):h,T.memoizedState=T.baseState=h,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:h},T.queue=u,u=u.dispatch=k6.bind(null,Yn,u),[T.memoizedState,u]},useRef:function(u){var h=so();return u={current:u},h.memoizedState=u},useState:I1,useDebugValue:Ky,useDeferredValue:function(u){return so().memoizedState=u},useTransition:function(){var u=I1(!1),h=u[0];return u=M6.bind(null,u[1]),so().memoizedState=u,[h,u]},useMutableSource:function(){},useSyncExternalStore:function(u,h,b){var T=Yn,R=so();if(Vn){if(b===void 0)throw Error(t(407));b=b()}else{if(b=h(),Dr===null)throw Error(t(349));(kd&30)!==0||M1(T,h,b)}R.memoizedState=b;var z={value:b,getSnapshot:h};return R.queue=z,R1(E1.bind(null,T,z,u),[u]),T.flags|=2048,th(9,k1.bind(null,T,z,b,h),void 0,null),b},useId:function(){var u=so(),h=Dr.identifierPrefix;if(Vn){var b=el,T=Xo;b=(T&~(1<<32-Mt(T)-1)).toString(32)+b,h=":"+h+"R"+b,b=Xf++,0<b&&(h+="H"+b.toString(32)),h+=":"}else b=P6++,h=":"+h+"r"+b.toString(32)+":";return u.memoizedState=h},unstable_isNewReconciler:!1},O6={readContext:Di,useCallback:U1,useContext:Di,useEffect:Zy,useImperativeHandle:z1,useInsertionEffect:L1,useLayoutEffect:F1,useMemo:V1,useReducer:Yy,useRef:A1,useState:function(){return Yy(eh)},useDebugValue:Ky,useDeferredValue:function(u){var h=Oi();return B1(h,wr.memoizedState,u)},useTransition:function(){var u=Yy(eh)[0],h=Oi().memoizedState;return[u,h]},useMutableSource:T1,useSyncExternalStore:P1,useId:W1,unstable_isNewReconciler:!1},I6={readContext:Di,useCallback:U1,useContext:Di,useEffect:Zy,useImperativeHandle:z1,useInsertionEffect:L1,useLayoutEffect:F1,useMemo:V1,useReducer:Gy,useRef:A1,useState:function(){return Gy(eh)},useDebugValue:Ky,useDeferredValue:function(u){var h=Oi();return wr===null?h.memoizedState=u:B1(h,wr.memoizedState,u)},useTransition:function(){var u=Gy(eh)[0],h=Oi().memoizedState;return[u,h]},useMutableSource:T1,useSyncExternalStore:P1,useId:W1,unstable_isNewReconciler:!1};function ca(u,h){if(u&&u.defaultProps){h=se({},h),u=u.defaultProps;for(var b in u)h[b]===void 0&&(h[b]=u[b]);return h}return h}function Jy(u,h,b,T){h=u.memoizedState,b=b(T,h),b=b==null?h:se({},h,b),u.memoizedState=b,u.lanes===0&&(u.updateQueue.baseState=b)}var Km={isMounted:function(u){return(u=u._reactInternals)?Ss(u)===u:!1},enqueueSetState:function(u,h,b){u=u._reactInternals;var T=ps(),R=pc(u),z=nl(T,R);z.payload=h,b!=null&&(z.callback=b),h=uc(u,z,R),h!==null&&(fa(h,u,R,T),Vm(h,u,R))},enqueueReplaceState:function(u,h,b){u=u._reactInternals;var T=ps(),R=pc(u),z=nl(T,R);z.tag=1,z.payload=h,b!=null&&(z.callback=b),h=uc(u,z,R),h!==null&&(fa(h,u,R,T),Vm(h,u,R))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var b=ps(),T=pc(u),R=nl(b,T);R.tag=2,h!=null&&(R.callback=h),h=uc(u,R,T),h!==null&&(fa(h,u,T,b),Vm(h,u,T))}};function G1(u,h,b,T,R,z,Z){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(T,z,Z):h.prototype&&h.prototype.isPureReactComponent?!Ps(b,T)||!Ps(R,z):!0}function Z1(u,h,b){var T=!1,R=lc,z=h.contextType;return typeof z=="object"&&z!==null?z=Di(z):(R=ks(h)?Nd:Kr.current,T=h.contextTypes,z=(T=T!=null)?Pu(u,R):lc),h=new h(b,z),u.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Km,u.stateNode=h,h._reactInternals=u,T&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=R,u.__reactInternalMemoizedMaskedChildContext=z),h}function K1(u,h,b,T){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(b,T),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(b,T),h.state!==u&&Km.enqueueReplaceState(h,h.state,null)}function Qy(u,h,b,T){var R=u.stateNode;R.props=b,R.state=u.memoizedState,R.refs={},Fy(u);var z=h.contextType;typeof z=="object"&&z!==null?R.context=Di(z):(z=ks(h)?Nd:Kr.current,R.context=Pu(u,z)),R.state=u.memoizedState,z=h.getDerivedStateFromProps,typeof z=="function"&&(Jy(u,h,z,b),R.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(h=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),h!==R.state&&Km.enqueueReplaceState(R,R.state,null),Bm(u,b,R,T),R.state=u.memoizedState),typeof R.componentDidMount=="function"&&(u.flags|=4194308)}function Ru(u,h){try{var b="",T=h;do b+=re(T),T=T.return;while(T);var R=b}catch(z){R=`
Error generating stack: `+z.message+`
`+z.stack}return{value:u,source:h,stack:R,digest:null}}function Xy(u,h,b){return{value:u,source:null,stack:b??null,digest:h??null}}function ev(u,h){try{console.error(h.value)}catch(b){setTimeout(function(){throw b})}}var A6=typeof WeakMap=="function"?WeakMap:Map;function J1(u,h,b){b=nl(-1,b),b.tag=3,b.payload={element:null};var T=h.value;return b.callback=function(){rp||(rp=!0,pv=T),ev(u,h)},b}function Q1(u,h,b){b=nl(-1,b),b.tag=3;var T=u.type.getDerivedStateFromError;if(typeof T=="function"){var R=h.value;b.payload=function(){return T(R)},b.callback=function(){ev(u,h)}}var z=u.stateNode;return z!==null&&typeof z.componentDidCatch=="function"&&(b.callback=function(){ev(u,h),typeof T!="function"&&(hc===null?hc=new Set([this]):hc.add(this));var Z=h.stack;this.componentDidCatch(h.value,{componentStack:Z!==null?Z:""})}),b}function X1(u,h,b){var T=u.pingCache;if(T===null){T=u.pingCache=new A6;var R=new Set;T.set(h,R)}else R=T.get(h),R===void 0&&(R=new Set,T.set(h,R));R.has(b)||(R.add(b),u=Z6.bind(null,u,h,b),h.then(u,u))}function eT(u){do{var h;if((h=u.tag===13)&&(h=u.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return u;u=u.return}while(u!==null);return null}function tT(u,h,b,T,R){return(u.mode&1)===0?(u===h?u.flags|=65536:(u.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(h=nl(-1,1),h.tag=2,uc(b,h,1))),b.lanes|=1),u):(u.flags|=65536,u.lanes=R,u)}var R6=M.ReactCurrentOwner,Es=!1;function ms(u,h,b,T){h.child=u===null?_1(h,null,b,T):Du(h,u.child,b,T)}function nT(u,h,b,T,R){b=b.render;var z=h.ref;return Iu(h,R),T=$y(u,h,b,T,z,R),b=Hy(),u!==null&&!Es?(h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~R,rl(u,h,R)):(Vn&&b&&Py(h),h.flags|=1,ms(u,h,T,R),h.child)}function rT(u,h,b,T,R){if(u===null){var z=b.type;return typeof z=="function"&&!wv(z)&&z.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(h.tag=15,h.type=z,sT(u,h,z,T,R)):(u=cp(b.type,null,T,h,h.mode,R),u.ref=h.ref,u.return=h,h.child=u)}if(z=u.child,(u.lanes&R)===0){var Z=z.memoizedProps;if(b=b.compare,b=b!==null?b:Ps,b(Z,T)&&u.ref===h.ref)return rl(u,h,R)}return h.flags|=1,u=xc(z,T),u.ref=h.ref,u.return=h,h.child=u}function sT(u,h,b,T,R){if(u!==null){var z=u.memoizedProps;if(Ps(z,T)&&u.ref===h.ref)if(Es=!1,h.pendingProps=T=z,(u.lanes&R)!==0)(u.flags&131072)!==0&&(Es=!0);else return h.lanes=u.lanes,rl(u,h,R)}return tv(u,h,b,T,R)}function iT(u,h,b){var T=h.pendingProps,R=T.children,z=u!==null?u.memoizedState:null;if(T.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dn(Fu,si),si|=b;else{if((b&1073741824)===0)return u=z!==null?z.baseLanes|b:b,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:u,cachePool:null,transitions:null},h.updateQueue=null,Dn(Fu,si),si|=u,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},T=z!==null?z.baseLanes:b,Dn(Fu,si),si|=T}else z!==null?(T=z.baseLanes|b,h.memoizedState=null):T=b,Dn(Fu,si),si|=T;return ms(u,h,R,b),h.child}function aT(u,h){var b=h.ref;(u===null&&b!==null||u!==null&&u.ref!==b)&&(h.flags|=512,h.flags|=2097152)}function tv(u,h,b,T,R){var z=ks(b)?Nd:Kr.current;return z=Pu(h,z),Iu(h,R),b=$y(u,h,b,T,z,R),T=Hy(),u!==null&&!Es?(h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~R,rl(u,h,R)):(Vn&&T&&Py(h),h.flags|=1,ms(u,h,b,R),h.child)}function oT(u,h,b,T,R){if(ks(b)){var z=!0;Im(h)}else z=!1;if(Iu(h,R),h.stateNode===null)Qm(u,h),Z1(h,b,T),Qy(h,b,T,R),T=!0;else if(u===null){var Z=h.stateNode,he=h.memoizedProps;Z.props=he;var ve=Z.context,Ie=b.contextType;typeof Ie=="object"&&Ie!==null?Ie=Di(Ie):(Ie=ks(b)?Nd:Kr.current,Ie=Pu(h,Ie));var $e=b.getDerivedStateFromProps,Ye=typeof $e=="function"||typeof Z.getSnapshotBeforeUpdate=="function";Ye||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(he!==T||ve!==Ie)&&K1(h,Z,T,Ie),dc=!1;var We=h.memoizedState;Z.state=We,Bm(h,T,Z,R),ve=h.memoizedState,he!==T||We!==ve||Ms.current||dc?(typeof $e=="function"&&(Jy(h,b,$e,T),ve=h.memoizedState),(he=dc||G1(h,b,he,T,We,ve,Ie))?(Ye||typeof Z.UNSAFE_componentWillMount!="function"&&typeof Z.componentWillMount!="function"||(typeof Z.componentWillMount=="function"&&Z.componentWillMount(),typeof Z.UNSAFE_componentWillMount=="function"&&Z.UNSAFE_componentWillMount()),typeof Z.componentDidMount=="function"&&(h.flags|=4194308)):(typeof Z.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=T,h.memoizedState=ve),Z.props=T,Z.state=ve,Z.context=Ie,T=he):(typeof Z.componentDidMount=="function"&&(h.flags|=4194308),T=!1)}else{Z=h.stateNode,S1(u,h),he=h.memoizedProps,Ie=h.type===h.elementType?he:ca(h.type,he),Z.props=Ie,Ye=h.pendingProps,We=Z.context,ve=b.contextType,typeof ve=="object"&&ve!==null?ve=Di(ve):(ve=ks(b)?Nd:Kr.current,ve=Pu(h,ve));var it=b.getDerivedStateFromProps;($e=typeof it=="function"||typeof Z.getSnapshotBeforeUpdate=="function")||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(he!==Ye||We!==ve)&&K1(h,Z,T,ve),dc=!1,We=h.memoizedState,Z.state=We,Bm(h,T,Z,R);var ut=h.memoizedState;he!==Ye||We!==ut||Ms.current||dc?(typeof it=="function"&&(Jy(h,b,it,T),ut=h.memoizedState),(Ie=dc||G1(h,b,Ie,T,We,ut,ve)||!1)?($e||typeof Z.UNSAFE_componentWillUpdate!="function"&&typeof Z.componentWillUpdate!="function"||(typeof Z.componentWillUpdate=="function"&&Z.componentWillUpdate(T,ut,ve),typeof Z.UNSAFE_componentWillUpdate=="function"&&Z.UNSAFE_componentWillUpdate(T,ut,ve)),typeof Z.componentDidUpdate=="function"&&(h.flags|=4),typeof Z.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof Z.componentDidUpdate!="function"||he===u.memoizedProps&&We===u.memoizedState||(h.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||he===u.memoizedProps&&We===u.memoizedState||(h.flags|=1024),h.memoizedProps=T,h.memoizedState=ut),Z.props=T,Z.state=ut,Z.context=ve,T=Ie):(typeof Z.componentDidUpdate!="function"||he===u.memoizedProps&&We===u.memoizedState||(h.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||he===u.memoizedProps&&We===u.memoizedState||(h.flags|=1024),T=!1)}return nv(u,h,b,T,z,R)}function nv(u,h,b,T,R,z){aT(u,h);var Z=(h.flags&128)!==0;if(!T&&!Z)return R&&f1(h,b,!1),rl(u,h,z);T=h.stateNode,R6.current=h;var he=Z&&typeof b.getDerivedStateFromError!="function"?null:T.render();return h.flags|=1,u!==null&&Z?(h.child=Du(h,u.child,null,z),h.child=Du(h,null,he,z)):ms(u,h,he,z),h.memoizedState=T.state,R&&f1(h,b,!0),h.child}function lT(u){var h=u.stateNode;h.pendingContext?d1(u,h.pendingContext,h.pendingContext!==h.context):h.context&&d1(u,h.context,!1),qy(u,h.containerInfo)}function cT(u,h,b,T,R){return Eu(),Dy(R),h.flags|=256,ms(u,h,b,T),h.child}var rv={dehydrated:null,treeContext:null,retryLane:0};function sv(u){return{baseLanes:u,cachePool:null,transitions:null}}function dT(u,h,b){var T=h.pendingProps,R=Hn.current,z=!1,Z=(h.flags&128)!==0,he;if((he=Z)||(he=u!==null&&u.memoizedState===null?!1:(R&2)!==0),he?(z=!0,h.flags&=-129):(u===null||u.memoizedState!==null)&&(R|=1),Dn(Hn,R&1),u===null)return Ey(h),u=h.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((h.mode&1)===0?h.lanes=1:u.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(Z=T.children,u=T.fallback,z?(T=h.mode,z=h.child,Z={mode:"hidden",children:Z},(T&1)===0&&z!==null?(z.childLanes=0,z.pendingProps=Z):z=dp(Z,T,0,null),u=Ad(u,T,b,null),z.return=h,u.return=h,z.sibling=u,h.child=z,h.child.memoizedState=sv(b),h.memoizedState=rv,u):iv(h,Z));if(R=u.memoizedState,R!==null&&(he=R.dehydrated,he!==null))return L6(u,h,Z,T,he,R,b);if(z){z=T.fallback,Z=h.mode,R=u.child,he=R.sibling;var ve={mode:"hidden",children:T.children};return(Z&1)===0&&h.child!==R?(T=h.child,T.childLanes=0,T.pendingProps=ve,h.deletions=null):(T=xc(R,ve),T.subtreeFlags=R.subtreeFlags&14680064),he!==null?z=xc(he,z):(z=Ad(z,Z,b,null),z.flags|=2),z.return=h,T.return=h,T.sibling=z,h.child=T,T=z,z=h.child,Z=u.child.memoizedState,Z=Z===null?sv(b):{baseLanes:Z.baseLanes|b,cachePool:null,transitions:Z.transitions},z.memoizedState=Z,z.childLanes=u.childLanes&~b,h.memoizedState=rv,T}return z=u.child,u=z.sibling,T=xc(z,{mode:"visible",children:T.children}),(h.mode&1)===0&&(T.lanes=b),T.return=h,T.sibling=null,u!==null&&(b=h.deletions,b===null?(h.deletions=[u],h.flags|=16):b.push(u)),h.child=T,h.memoizedState=null,T}function iv(u,h){return h=dp({mode:"visible",children:h},u.mode,0,null),h.return=u,u.child=h}function Jm(u,h,b,T){return T!==null&&Dy(T),Du(h,u.child,null,b),u=iv(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function L6(u,h,b,T,R,z,Z){if(b)return h.flags&256?(h.flags&=-257,T=Xy(Error(t(422))),Jm(u,h,Z,T)):h.memoizedState!==null?(h.child=u.child,h.flags|=128,null):(z=T.fallback,R=h.mode,T=dp({mode:"visible",children:T.children},R,0,null),z=Ad(z,R,Z,null),z.flags|=2,T.return=h,z.return=h,T.sibling=z,h.child=T,(h.mode&1)!==0&&Du(h,u.child,null,Z),h.child.memoizedState=sv(Z),h.memoizedState=rv,z);if((h.mode&1)===0)return Jm(u,h,Z,null);if(R.data==="$!"){if(T=R.nextSibling&&R.nextSibling.dataset,T)var he=T.dgst;return T=he,z=Error(t(419)),T=Xy(z,T,void 0),Jm(u,h,Z,T)}if(he=(Z&u.childLanes)!==0,Es||he){if(T=Dr,T!==null){switch(Z&-Z){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(T.suspendedLanes|Z))!==0?0:R,R!==0&&R!==z.retryLane&&(z.retryLane=R,tl(u,R),fa(T,u,R,-1))}return _v(),T=Xy(Error(t(421))),Jm(u,h,Z,T)}return R.data==="$?"?(h.flags|=128,h.child=u.child,h=K6.bind(null,u),R._reactRetry=h,null):(u=z.treeContext,ri=no(R.nextSibling),ni=h,Vn=!0,la=null,u!==null&&(ki[Ei++]=Xo,ki[Ei++]=el,ki[Ei++]=Cd,Xo=u.id,el=u.overflow,Cd=h),h=iv(h,T.children),h.flags|=4096,h)}function uT(u,h,b){u.lanes|=h;var T=u.alternate;T!==null&&(T.lanes|=h),Ry(u.return,h,b)}function av(u,h,b,T,R){var z=u.memoizedState;z===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:T,tail:b,tailMode:R}:(z.isBackwards=h,z.rendering=null,z.renderingStartTime=0,z.last=T,z.tail=b,z.tailMode=R)}function fT(u,h,b){var T=h.pendingProps,R=T.revealOrder,z=T.tail;if(ms(u,h,T.children,b),T=Hn.current,(T&2)!==0)T=T&1|2,h.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&uT(u,b,h);else if(u.tag===19)uT(u,b,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break e;for(;u.sibling===null;){if(u.return===null||u.return===h)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}T&=1}if(Dn(Hn,T),(h.mode&1)===0)h.memoizedState=null;else switch(R){case"forwards":for(b=h.child,R=null;b!==null;)u=b.alternate,u!==null&&Wm(u)===null&&(R=b),b=b.sibling;b=R,b===null?(R=h.child,h.child=null):(R=b.sibling,b.sibling=null),av(h,!1,R,b,z);break;case"backwards":for(b=null,R=h.child,h.child=null;R!==null;){if(u=R.alternate,u!==null&&Wm(u)===null){h.child=R;break}u=R.sibling,R.sibling=b,b=R,R=u}av(h,!0,b,null,z);break;case"together":av(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Qm(u,h){(h.mode&1)===0&&u!==null&&(u.alternate=null,h.alternate=null,h.flags|=2)}function rl(u,h,b){if(u!==null&&(h.dependencies=u.dependencies),Ed|=h.lanes,(b&h.childLanes)===0)return null;if(u!==null&&h.child!==u.child)throw Error(t(153));if(h.child!==null){for(u=h.child,b=xc(u,u.pendingProps),h.child=b,b.return=h;u.sibling!==null;)u=u.sibling,b=b.sibling=xc(u,u.pendingProps),b.return=h;b.sibling=null}return h.child}function F6(u,h,b){switch(h.tag){case 3:lT(h),Eu();break;case 5:C1(h);break;case 1:ks(h.type)&&Im(h);break;case 4:qy(h,h.stateNode.containerInfo);break;case 10:var T=h.type._context,R=h.memoizedProps.value;Dn(zm,T._currentValue),T._currentValue=R;break;case 13:if(T=h.memoizedState,T!==null)return T.dehydrated!==null?(Dn(Hn,Hn.current&1),h.flags|=128,null):(b&h.child.childLanes)!==0?dT(u,h,b):(Dn(Hn,Hn.current&1),u=rl(u,h,b),u!==null?u.sibling:null);Dn(Hn,Hn.current&1);break;case 19:if(T=(b&h.childLanes)!==0,(u.flags&128)!==0){if(T)return fT(u,h,b);h.flags|=128}if(R=h.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),Dn(Hn,Hn.current),T)break;return null;case 22:case 23:return h.lanes=0,iT(u,h,b)}return rl(u,h,b)}var hT,ov,mT,pT;hT=function(u,h){for(var b=h.child;b!==null;){if(b.tag===5||b.tag===6)u.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===h)break;for(;b.sibling===null;){if(b.return===null||b.return===h)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},ov=function(){},mT=function(u,h,b,T){var R=u.memoizedProps;if(R!==T){u=h.stateNode,Md(ro.current);var z=null;switch(b){case"input":R=Ne(u,R),T=Ne(u,T),z=[];break;case"select":R=se({},R,{value:void 0}),T=se({},T,{value:void 0}),z=[];break;case"textarea":R=Pe(u,R),T=Pe(u,T),z=[];break;default:typeof R.onClick!="function"&&typeof T.onClick=="function"&&(u.onclick=Ve)}Mn(b,T);var Z;b=null;for(Ie in R)if(!T.hasOwnProperty(Ie)&&R.hasOwnProperty(Ie)&&R[Ie]!=null)if(Ie==="style"){var he=R[Ie];for(Z in he)he.hasOwnProperty(Z)&&(b||(b={}),b[Z]="")}else Ie!=="dangerouslySetInnerHTML"&&Ie!=="children"&&Ie!=="suppressContentEditableWarning"&&Ie!=="suppressHydrationWarning"&&Ie!=="autoFocus"&&(s.hasOwnProperty(Ie)?z||(z=[]):(z=z||[]).push(Ie,null));for(Ie in T){var ve=T[Ie];if(he=R?.[Ie],T.hasOwnProperty(Ie)&&ve!==he&&(ve!=null||he!=null))if(Ie==="style")if(he){for(Z in he)!he.hasOwnProperty(Z)||ve&&ve.hasOwnProperty(Z)||(b||(b={}),b[Z]="");for(Z in ve)ve.hasOwnProperty(Z)&&he[Z]!==ve[Z]&&(b||(b={}),b[Z]=ve[Z])}else b||(z||(z=[]),z.push(Ie,b)),b=ve;else Ie==="dangerouslySetInnerHTML"?(ve=ve?ve.__html:void 0,he=he?he.__html:void 0,ve!=null&&he!==ve&&(z=z||[]).push(Ie,ve)):Ie==="children"?typeof ve!="string"&&typeof ve!="number"||(z=z||[]).push(Ie,""+ve):Ie!=="suppressContentEditableWarning"&&Ie!=="suppressHydrationWarning"&&(s.hasOwnProperty(Ie)?(ve!=null&&Ie==="onScroll"&&bn("scroll",u),z||he===ve||(z=[])):(z=z||[]).push(Ie,ve))}b&&(z=z||[]).push("style",b);var Ie=z;(h.updateQueue=Ie)&&(h.flags|=4)}},pT=function(u,h,b,T){b!==T&&(h.flags|=4)};function nh(u,h){if(!Vn)switch(u.tailMode){case"hidden":h=u.tail;for(var b=null;h!==null;)h.alternate!==null&&(b=h),h=h.sibling;b===null?u.tail=null:b.sibling=null;break;case"collapsed":b=u.tail;for(var T=null;b!==null;)b.alternate!==null&&(T=b),b=b.sibling;T===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:T.sibling=null}}function Qr(u){var h=u.alternate!==null&&u.alternate.child===u.child,b=0,T=0;if(h)for(var R=u.child;R!==null;)b|=R.lanes|R.childLanes,T|=R.subtreeFlags&14680064,T|=R.flags&14680064,R.return=u,R=R.sibling;else for(R=u.child;R!==null;)b|=R.lanes|R.childLanes,T|=R.subtreeFlags,T|=R.flags,R.return=u,R=R.sibling;return u.subtreeFlags|=T,u.childLanes=b,h}function q6(u,h,b){var T=h.pendingProps;switch(My(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qr(h),null;case 1:return ks(h.type)&&Om(),Qr(h),null;case 3:return T=h.stateNode,Au(),Rn(Ms),Rn(Kr),Vy(),T.pendingContext&&(T.context=T.pendingContext,T.pendingContext=null),(u===null||u.child===null)&&(Fm(h)?h.flags|=4:u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,la!==null&&(yv(la),la=null))),ov(u,h),Qr(h),null;case 5:zy(h);var R=Md(Jf.current);if(b=h.type,u!==null&&h.stateNode!=null)mT(u,h,b,T,R),u.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!T){if(h.stateNode===null)throw Error(t(166));return Qr(h),null}if(u=Md(ro.current),Fm(h)){T=h.stateNode,b=h.type;var z=h.memoizedProps;switch(T[Mi]=h,T[ic]=z,u=(h.mode&1)!==0,b){case"dialog":bn("cancel",T),bn("close",T);break;case"iframe":case"object":case"embed":bn("load",T);break;case"video":case"audio":for(R=0;R<nc.length;R++)bn(nc[R],T);break;case"source":bn("error",T);break;case"img":case"image":case"link":bn("error",T),bn("load",T);break;case"details":bn("toggle",T);break;case"input":ke(T,z),bn("invalid",T);break;case"select":T._wrapperState={wasMultiple:!!z.multiple},bn("invalid",T);break;case"textarea":Ge(T,z),bn("invalid",T)}Mn(b,z),R=null;for(var Z in z)if(z.hasOwnProperty(Z)){var he=z[Z];Z==="children"?typeof he=="string"?T.textContent!==he&&(z.suppressHydrationWarning!==!0&&Oe(T.textContent,he,u),R=["children",he]):typeof he=="number"&&T.textContent!==""+he&&(z.suppressHydrationWarning!==!0&&Oe(T.textContent,he,u),R=["children",""+he]):s.hasOwnProperty(Z)&&he!=null&&Z==="onScroll"&&bn("scroll",T)}switch(b){case"input":ce(T),He(T,z,!0);break;case"textarea":ce(T),Le(T);break;case"select":case"option":break;default:typeof z.onClick=="function"&&(T.onclick=Ve)}T=R,h.updateQueue=T,T!==null&&(h.flags|=4)}else{Z=R.nodeType===9?R:R.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=Je(b)),u==="http://www.w3.org/1999/xhtml"?b==="script"?(u=Z.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof T.is=="string"?u=Z.createElement(b,{is:T.is}):(u=Z.createElement(b),b==="select"&&(Z=u,T.multiple?Z.multiple=!0:T.size&&(Z.size=T.size))):u=Z.createElementNS(u,b),u[Mi]=h,u[ic]=T,hT(u,h,!1,!1),h.stateNode=u;e:{switch(Z=An(b,T),b){case"dialog":bn("cancel",u),bn("close",u),R=T;break;case"iframe":case"object":case"embed":bn("load",u),R=T;break;case"video":case"audio":for(R=0;R<nc.length;R++)bn(nc[R],u);R=T;break;case"source":bn("error",u),R=T;break;case"img":case"image":case"link":bn("error",u),bn("load",u),R=T;break;case"details":bn("toggle",u),R=T;break;case"input":ke(u,T),R=Ne(u,T),bn("invalid",u);break;case"option":R=T;break;case"select":u._wrapperState={wasMultiple:!!T.multiple},R=se({},T,{value:void 0}),bn("invalid",u);break;case"textarea":Ge(u,T),R=Pe(u,T),bn("invalid",u);break;default:R=T}Mn(b,R),he=R;for(z in he)if(he.hasOwnProperty(z)){var ve=he[z];z==="style"?Ht(u,ve):z==="dangerouslySetInnerHTML"?(ve=ve?ve.__html:void 0,ve!=null&&Vt(u,ve)):z==="children"?typeof ve=="string"?(b!=="textarea"||ve!=="")&&At(u,ve):typeof ve=="number"&&At(u,""+ve):z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&z!=="autoFocus"&&(s.hasOwnProperty(z)?ve!=null&&z==="onScroll"&&bn("scroll",u):ve!=null&&I(u,z,ve,Z))}switch(b){case"input":ce(u),He(u,T,!1);break;case"textarea":ce(u),Le(u);break;case"option":T.value!=null&&u.setAttribute("value",""+le(T.value));break;case"select":u.multiple=!!T.multiple,z=T.value,z!=null?xe(u,!!T.multiple,z,!1):T.defaultValue!=null&&xe(u,!!T.multiple,T.defaultValue,!0);break;default:typeof R.onClick=="function"&&(u.onclick=Ve)}switch(b){case"button":case"input":case"select":case"textarea":T=!!T.autoFocus;break e;case"img":T=!0;break e;default:T=!1}}T&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Qr(h),null;case 6:if(u&&h.stateNode!=null)pT(u,h,u.memoizedProps,T);else{if(typeof T!="string"&&h.stateNode===null)throw Error(t(166));if(b=Md(Jf.current),Md(ro.current),Fm(h)){if(T=h.stateNode,b=h.memoizedProps,T[Mi]=h,(z=T.nodeValue!==b)&&(u=ni,u!==null))switch(u.tag){case 3:Oe(T.nodeValue,b,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&Oe(T.nodeValue,b,(u.mode&1)!==0)}z&&(h.flags|=4)}else T=(b.nodeType===9?b:b.ownerDocument).createTextNode(T),T[Mi]=h,h.stateNode=T}return Qr(h),null;case 13:if(Rn(Hn),T=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(Vn&&ri!==null&&(h.mode&1)!==0&&(h.flags&128)===0)y1(),Eu(),h.flags|=98560,z=!1;else if(z=Fm(h),T!==null&&T.dehydrated!==null){if(u===null){if(!z)throw Error(t(318));if(z=h.memoizedState,z=z!==null?z.dehydrated:null,!z)throw Error(t(317));z[Mi]=h}else Eu(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Qr(h),z=!1}else la!==null&&(yv(la),la=null),z=!0;if(!z)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=b,h):(T=T!==null,T!==(u!==null&&u.memoizedState!==null)&&T&&(h.child.flags|=8192,(h.mode&1)!==0&&(u===null||(Hn.current&1)!==0?Sr===0&&(Sr=3):_v())),h.updateQueue!==null&&(h.flags|=4),Qr(h),null);case 4:return Au(),ov(u,h),u===null&&rc(h.stateNode.containerInfo),Qr(h),null;case 10:return Ay(h.type._context),Qr(h),null;case 17:return ks(h.type)&&Om(),Qr(h),null;case 19:if(Rn(Hn),z=h.memoizedState,z===null)return Qr(h),null;if(T=(h.flags&128)!==0,Z=z.rendering,Z===null)if(T)nh(z,!1);else{if(Sr!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(Z=Wm(u),Z!==null){for(h.flags|=128,nh(z,!1),T=Z.updateQueue,T!==null&&(h.updateQueue=T,h.flags|=4),h.subtreeFlags=0,T=b,b=h.child;b!==null;)z=b,u=T,z.flags&=14680066,Z=z.alternate,Z===null?(z.childLanes=0,z.lanes=u,z.child=null,z.subtreeFlags=0,z.memoizedProps=null,z.memoizedState=null,z.updateQueue=null,z.dependencies=null,z.stateNode=null):(z.childLanes=Z.childLanes,z.lanes=Z.lanes,z.child=Z.child,z.subtreeFlags=0,z.deletions=null,z.memoizedProps=Z.memoizedProps,z.memoizedState=Z.memoizedState,z.updateQueue=Z.updateQueue,z.type=Z.type,u=Z.dependencies,z.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),b=b.sibling;return Dn(Hn,Hn.current&1|2),h.child}u=u.sibling}z.tail!==null&&Sn()>qu&&(h.flags|=128,T=!0,nh(z,!1),h.lanes=4194304)}else{if(!T)if(u=Wm(Z),u!==null){if(h.flags|=128,T=!0,b=u.updateQueue,b!==null&&(h.updateQueue=b,h.flags|=4),nh(z,!0),z.tail===null&&z.tailMode==="hidden"&&!Z.alternate&&!Vn)return Qr(h),null}else 2*Sn()-z.renderingStartTime>qu&&b!==1073741824&&(h.flags|=128,T=!0,nh(z,!1),h.lanes=4194304);z.isBackwards?(Z.sibling=h.child,h.child=Z):(b=z.last,b!==null?b.sibling=Z:h.child=Z,z.last=Z)}return z.tail!==null?(h=z.tail,z.rendering=h,z.tail=h.sibling,z.renderingStartTime=Sn(),h.sibling=null,b=Hn.current,Dn(Hn,T?b&1|2:b&1),h):(Qr(h),null);case 22:case 23:return bv(),T=h.memoizedState!==null,u!==null&&u.memoizedState!==null!==T&&(h.flags|=8192),T&&(h.mode&1)!==0?(si&1073741824)!==0&&(Qr(h),h.subtreeFlags&6&&(h.flags|=8192)):Qr(h),null;case 24:return null;case 25:return null}throw Error(t(156,h.tag))}function z6(u,h){switch(My(h),h.tag){case 1:return ks(h.type)&&Om(),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return Au(),Rn(Ms),Rn(Kr),Vy(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 5:return zy(h),null;case 13:if(Rn(Hn),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(t(340));Eu()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return Rn(Hn),null;case 4:return Au(),null;case 10:return Ay(h.type._context),null;case 22:case 23:return bv(),null;case 24:return null;default:return null}}var Xm=!1,Xr=!1,U6=typeof WeakSet=="function"?WeakSet:Set,lt=null;function Lu(u,h){var b=u.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(T){er(u,h,T)}else b.current=null}function lv(u,h,b){try{b()}catch(T){er(u,h,T)}}var gT=!1;function V6(u,h){if(rt=ra,u=$o(),Ho(u)){if("selectionStart"in u)var b={start:u.selectionStart,end:u.selectionEnd};else e:{b=(b=u.ownerDocument)&&b.defaultView||window;var T=b.getSelection&&b.getSelection();if(T&&T.rangeCount!==0){b=T.anchorNode;var R=T.anchorOffset,z=T.focusNode;T=T.focusOffset;try{b.nodeType,z.nodeType}catch{b=null;break e}var Z=0,he=-1,ve=-1,Ie=0,$e=0,Ye=u,We=null;t:for(;;){for(var it;Ye!==b||R!==0&&Ye.nodeType!==3||(he=Z+R),Ye!==z||T!==0&&Ye.nodeType!==3||(ve=Z+T),Ye.nodeType===3&&(Z+=Ye.nodeValue.length),(it=Ye.firstChild)!==null;)We=Ye,Ye=it;for(;;){if(Ye===u)break t;if(We===b&&++Ie===R&&(he=Z),We===z&&++$e===T&&(ve=Z),(it=Ye.nextSibling)!==null)break;Ye=We,We=Ye.parentNode}Ye=it}b=he===-1||ve===-1?null:{start:he,end:ve}}else b=null}b=b||{start:0,end:0}}else b=null;for(_t={focusedElem:u,selectionRange:b},ra=!1,lt=h;lt!==null;)if(h=lt,u=h.child,(h.subtreeFlags&1028)!==0&&u!==null)u.return=h,lt=u;else for(;lt!==null;){h=lt;try{var ut=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(ut!==null){var ht=ut.memoizedProps,rr=ut.memoizedState,Te=h.stateNode,we=Te.getSnapshotBeforeUpdate(h.elementType===h.type?ht:ca(h.type,ht),rr);Te.__reactInternalSnapshotBeforeUpdate=we}break;case 3:var Ee=h.stateNode.containerInfo;Ee.nodeType===1?Ee.textContent="":Ee.nodeType===9&&Ee.documentElement&&Ee.removeChild(Ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ze){er(h,h.return,Ze)}if(u=h.sibling,u!==null){u.return=h.return,lt=u;break}lt=h.return}return ut=gT,gT=!1,ut}function rh(u,h,b){var T=h.updateQueue;if(T=T!==null?T.lastEffect:null,T!==null){var R=T=T.next;do{if((R.tag&u)===u){var z=R.destroy;R.destroy=void 0,z!==void 0&&lv(h,b,z)}R=R.next}while(R!==T)}}function ep(u,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var b=h=h.next;do{if((b.tag&u)===u){var T=b.create;b.destroy=T()}b=b.next}while(b!==h)}}function cv(u){var h=u.ref;if(h!==null){var b=u.stateNode;switch(u.tag){case 5:u=b;break;default:u=b}typeof h=="function"?h(u):h.current=u}}function xT(u){var h=u.alternate;h!==null&&(u.alternate=null,xT(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&(delete h[Mi],delete h[ic],delete h[ac],delete h[jy],delete h[Ny])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function yT(u){return u.tag===5||u.tag===3||u.tag===4}function vT(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||yT(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function dv(u,h,b){var T=u.tag;if(T===5||T===6)u=u.stateNode,h?b.nodeType===8?b.parentNode.insertBefore(u,h):b.insertBefore(u,h):(b.nodeType===8?(h=b.parentNode,h.insertBefore(u,b)):(h=b,h.appendChild(u)),b=b._reactRootContainer,b!=null||h.onclick!==null||(h.onclick=Ve));else if(T!==4&&(u=u.child,u!==null))for(dv(u,h,b),u=u.sibling;u!==null;)dv(u,h,b),u=u.sibling}function uv(u,h,b){var T=u.tag;if(T===5||T===6)u=u.stateNode,h?b.insertBefore(u,h):b.appendChild(u);else if(T!==4&&(u=u.child,u!==null))for(uv(u,h,b),u=u.sibling;u!==null;)uv(u,h,b),u=u.sibling}var Ur=null,da=!1;function fc(u,h,b){for(b=b.child;b!==null;)bT(u,h,b),b=b.sibling}function bT(u,h,b){if(Ir&&typeof Ir.onCommitFiberUnmount=="function")try{Ir.onCommitFiberUnmount(Ji,b)}catch{}switch(b.tag){case 5:Xr||Lu(b,h);case 6:var T=Ur,R=da;Ur=null,fc(u,h,b),Ur=T,da=R,Ur!==null&&(da?(u=Ur,b=b.stateNode,u.nodeType===8?u.parentNode.removeChild(b):u.removeChild(b)):Ur.removeChild(b.stateNode));break;case 18:Ur!==null&&(da?(u=Ur,b=b.stateNode,u.nodeType===8?Yf(u.parentNode,b):u.nodeType===1&&Yf(u,b),Lr(u)):Yf(Ur,b.stateNode));break;case 4:T=Ur,R=da,Ur=b.stateNode.containerInfo,da=!0,fc(u,h,b),Ur=T,da=R;break;case 0:case 11:case 14:case 15:if(!Xr&&(T=b.updateQueue,T!==null&&(T=T.lastEffect,T!==null))){R=T=T.next;do{var z=R,Z=z.destroy;z=z.tag,Z!==void 0&&((z&2)!==0||(z&4)!==0)&&lv(b,h,Z),R=R.next}while(R!==T)}fc(u,h,b);break;case 1:if(!Xr&&(Lu(b,h),T=b.stateNode,typeof T.componentWillUnmount=="function"))try{T.props=b.memoizedProps,T.state=b.memoizedState,T.componentWillUnmount()}catch(he){er(b,h,he)}fc(u,h,b);break;case 21:fc(u,h,b);break;case 22:b.mode&1?(Xr=(T=Xr)||b.memoizedState!==null,fc(u,h,b),Xr=T):fc(u,h,b);break;default:fc(u,h,b)}}function _T(u){var h=u.updateQueue;if(h!==null){u.updateQueue=null;var b=u.stateNode;b===null&&(b=u.stateNode=new U6),h.forEach(function(T){var R=J6.bind(null,u,T);b.has(T)||(b.add(T),T.then(R,R))})}}function ua(u,h){var b=h.deletions;if(b!==null)for(var T=0;T<b.length;T++){var R=b[T];try{var z=u,Z=h,he=Z;e:for(;he!==null;){switch(he.tag){case 5:Ur=he.stateNode,da=!1;break e;case 3:Ur=he.stateNode.containerInfo,da=!0;break e;case 4:Ur=he.stateNode.containerInfo,da=!0;break e}he=he.return}if(Ur===null)throw Error(t(160));bT(z,Z,R),Ur=null,da=!1;var ve=R.alternate;ve!==null&&(ve.return=null),R.return=null}catch(Ie){er(R,h,Ie)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)wT(h,u),h=h.sibling}function wT(u,h){var b=u.alternate,T=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(ua(h,u),io(u),T&4){try{rh(3,u,u.return),ep(3,u)}catch(ht){er(u,u.return,ht)}try{rh(5,u,u.return)}catch(ht){er(u,u.return,ht)}}break;case 1:ua(h,u),io(u),T&512&&b!==null&&Lu(b,b.return);break;case 5:if(ua(h,u),io(u),T&512&&b!==null&&Lu(b,b.return),u.flags&32){var R=u.stateNode;try{At(R,"")}catch(ht){er(u,u.return,ht)}}if(T&4&&(R=u.stateNode,R!=null)){var z=u.memoizedProps,Z=b!==null?b.memoizedProps:z,he=u.type,ve=u.updateQueue;if(u.updateQueue=null,ve!==null)try{he==="input"&&z.type==="radio"&&z.name!=null&&qe(R,z),An(he,Z);var Ie=An(he,z);for(Z=0;Z<ve.length;Z+=2){var $e=ve[Z],Ye=ve[Z+1];$e==="style"?Ht(R,Ye):$e==="dangerouslySetInnerHTML"?Vt(R,Ye):$e==="children"?At(R,Ye):I(R,$e,Ye,Ie)}switch(he){case"input":ze(R,z);break;case"textarea":Fe(R,z);break;case"select":var We=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!z.multiple;var it=z.value;it!=null?xe(R,!!z.multiple,it,!1):We!==!!z.multiple&&(z.defaultValue!=null?xe(R,!!z.multiple,z.defaultValue,!0):xe(R,!!z.multiple,z.multiple?[]:"",!1))}R[ic]=z}catch(ht){er(u,u.return,ht)}}break;case 6:if(ua(h,u),io(u),T&4){if(u.stateNode===null)throw Error(t(162));R=u.stateNode,z=u.memoizedProps;try{R.nodeValue=z}catch(ht){er(u,u.return,ht)}}break;case 3:if(ua(h,u),io(u),T&4&&b!==null&&b.memoizedState.isDehydrated)try{Lr(h.containerInfo)}catch(ht){er(u,u.return,ht)}break;case 4:ua(h,u),io(u);break;case 13:ua(h,u),io(u),R=u.child,R.flags&8192&&(z=R.memoizedState!==null,R.stateNode.isHidden=z,!z||R.alternate!==null&&R.alternate.memoizedState!==null||(mv=Sn())),T&4&&_T(u);break;case 22:if($e=b!==null&&b.memoizedState!==null,u.mode&1?(Xr=(Ie=Xr)||$e,ua(h,u),Xr=Ie):ua(h,u),io(u),T&8192){if(Ie=u.memoizedState!==null,(u.stateNode.isHidden=Ie)&&!$e&&(u.mode&1)!==0)for(lt=u,$e=u.child;$e!==null;){for(Ye=lt=$e;lt!==null;){switch(We=lt,it=We.child,We.tag){case 0:case 11:case 14:case 15:rh(4,We,We.return);break;case 1:Lu(We,We.return);var ut=We.stateNode;if(typeof ut.componentWillUnmount=="function"){T=We,b=We.return;try{h=T,ut.props=h.memoizedProps,ut.state=h.memoizedState,ut.componentWillUnmount()}catch(ht){er(T,b,ht)}}break;case 5:Lu(We,We.return);break;case 22:if(We.memoizedState!==null){NT(Ye);continue}}it!==null?(it.return=We,lt=it):NT(Ye)}$e=$e.sibling}e:for($e=null,Ye=u;;){if(Ye.tag===5){if($e===null){$e=Ye;try{R=Ye.stateNode,Ie?(z=R.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none"):(he=Ye.stateNode,ve=Ye.memoizedProps.style,Z=ve!=null&&ve.hasOwnProperty("display")?ve.display:null,he.style.display=Pn("display",Z))}catch(ht){er(u,u.return,ht)}}}else if(Ye.tag===6){if($e===null)try{Ye.stateNode.nodeValue=Ie?"":Ye.memoizedProps}catch(ht){er(u,u.return,ht)}}else if((Ye.tag!==22&&Ye.tag!==23||Ye.memoizedState===null||Ye===u)&&Ye.child!==null){Ye.child.return=Ye,Ye=Ye.child;continue}if(Ye===u)break e;for(;Ye.sibling===null;){if(Ye.return===null||Ye.return===u)break e;$e===Ye&&($e=null),Ye=Ye.return}$e===Ye&&($e=null),Ye.sibling.return=Ye.return,Ye=Ye.sibling}}break;case 19:ua(h,u),io(u),T&4&&_T(u);break;case 21:break;default:ua(h,u),io(u)}}function io(u){var h=u.flags;if(h&2){try{e:{for(var b=u.return;b!==null;){if(yT(b)){var T=b;break e}b=b.return}throw Error(t(160))}switch(T.tag){case 5:var R=T.stateNode;T.flags&32&&(At(R,""),T.flags&=-33);var z=vT(u);uv(u,z,R);break;case 3:case 4:var Z=T.stateNode.containerInfo,he=vT(u);dv(u,he,Z);break;default:throw Error(t(161))}}catch(ve){er(u,u.return,ve)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function B6(u,h,b){lt=u,ST(u)}function ST(u,h,b){for(var T=(u.mode&1)!==0;lt!==null;){var R=lt,z=R.child;if(R.tag===22&&T){var Z=R.memoizedState!==null||Xm;if(!Z){var he=R.alternate,ve=he!==null&&he.memoizedState!==null||Xr;he=Xm;var Ie=Xr;if(Xm=Z,(Xr=ve)&&!Ie)for(lt=R;lt!==null;)Z=lt,ve=Z.child,Z.tag===22&&Z.memoizedState!==null?CT(R):ve!==null?(ve.return=Z,lt=ve):CT(R);for(;z!==null;)lt=z,ST(z),z=z.sibling;lt=R,Xm=he,Xr=Ie}jT(u)}else(R.subtreeFlags&8772)!==0&&z!==null?(z.return=R,lt=z):jT(u)}}function jT(u){for(;lt!==null;){var h=lt;if((h.flags&8772)!==0){var b=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:Xr||ep(5,h);break;case 1:var T=h.stateNode;if(h.flags&4&&!Xr)if(b===null)T.componentDidMount();else{var R=h.elementType===h.type?b.memoizedProps:ca(h.type,b.memoizedProps);T.componentDidUpdate(R,b.memoizedState,T.__reactInternalSnapshotBeforeUpdate)}var z=h.updateQueue;z!==null&&N1(h,z,T);break;case 3:var Z=h.updateQueue;if(Z!==null){if(b=null,h.child!==null)switch(h.child.tag){case 5:b=h.child.stateNode;break;case 1:b=h.child.stateNode}N1(h,Z,b)}break;case 5:var he=h.stateNode;if(b===null&&h.flags&4){b=he;var ve=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":ve.autoFocus&&b.focus();break;case"img":ve.src&&(b.src=ve.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var Ie=h.alternate;if(Ie!==null){var $e=Ie.memoizedState;if($e!==null){var Ye=$e.dehydrated;Ye!==null&&Lr(Ye)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Xr||h.flags&512&&cv(h)}catch(We){er(h,h.return,We)}}if(h===u){lt=null;break}if(b=h.sibling,b!==null){b.return=h.return,lt=b;break}lt=h.return}}function NT(u){for(;lt!==null;){var h=lt;if(h===u){lt=null;break}var b=h.sibling;if(b!==null){b.return=h.return,lt=b;break}lt=h.return}}function CT(u){for(;lt!==null;){var h=lt;try{switch(h.tag){case 0:case 11:case 15:var b=h.return;try{ep(4,h)}catch(ve){er(h,b,ve)}break;case 1:var T=h.stateNode;if(typeof T.componentDidMount=="function"){var R=h.return;try{T.componentDidMount()}catch(ve){er(h,R,ve)}}var z=h.return;try{cv(h)}catch(ve){er(h,z,ve)}break;case 5:var Z=h.return;try{cv(h)}catch(ve){er(h,Z,ve)}}}catch(ve){er(h,h.return,ve)}if(h===u){lt=null;break}var he=h.sibling;if(he!==null){he.return=h.return,lt=he;break}lt=h.return}}var W6=Math.ceil,tp=M.ReactCurrentDispatcher,fv=M.ReactCurrentOwner,Ii=M.ReactCurrentBatchConfig,tn=0,Dr=null,fr=null,Vr=0,si=0,Fu=oc(0),Sr=0,sh=null,Ed=0,np=0,hv=0,ih=null,Ds=null,mv=0,qu=1/0,sl=null,rp=!1,pv=null,hc=null,sp=!1,mc=null,ip=0,ah=0,gv=null,ap=-1,op=0;function ps(){return(tn&6)!==0?Sn():ap!==-1?ap:ap=Sn()}function pc(u){return(u.mode&1)===0?1:(tn&2)!==0&&Vr!==0?Vr&-Vr:T6.transition!==null?(op===0&&(op=Rl()),op):(u=$t,u!==0||(u=window.event,u=u===void 0?16:Ut(u.type)),u)}function fa(u,h,b,T){if(50<ah)throw ah=0,gv=null,Error(t(185));Ar(u,b,T),((tn&2)===0||u!==Dr)&&(u===Dr&&((tn&2)===0&&(np|=b),Sr===4&&gc(u,Vr)),Os(u,T),b===1&&tn===0&&(h.mode&1)===0&&(qu=Sn()+500,Am&&cc()))}function Os(u,h){var b=u.callbackNode;Ra(u,h);var T=fn(u,u===Dr?Vr:0);if(T===0)b!==null&&To(b),u.callbackNode=null,u.callbackPriority=0;else if(h=T&-T,u.callbackPriority!==h){if(b!=null&&To(b),h===1)u.tag===0?C6(PT.bind(null,u)):h1(PT.bind(null,u)),Zr(function(){(tn&6)===0&&cc()}),b=null;else{switch(bi(T)){case 1:b=Po;break;case 4:b=Al;break;case 16:b=Ia;break;case 536870912:b=gi;break;default:b=Ia}b=RT(b,TT.bind(null,u))}u.callbackPriority=h,u.callbackNode=b}}function TT(u,h){if(ap=-1,op=0,(tn&6)!==0)throw Error(t(327));var b=u.callbackNode;if(zu()&&u.callbackNode!==b)return null;var T=fn(u,u===Dr?Vr:0);if(T===0)return null;if((T&30)!==0||(T&u.expiredLanes)!==0||h)h=lp(u,T);else{h=T;var R=tn;tn|=2;var z=kT();(Dr!==u||Vr!==h)&&(sl=null,qu=Sn()+500,Od(u,h));do try{Y6();break}catch(he){MT(u,he)}while(!0);Iy(),tp.current=z,tn=R,fr!==null?h=0:(Dr=null,Vr=0,h=Sr)}if(h!==0){if(h===2&&(R=cr(u),R!==0&&(T=R,h=xv(u,R))),h===1)throw b=sh,Od(u,0),gc(u,T),Os(u,Sn()),b;if(h===6)gc(u,T);else{if(R=u.current.alternate,(T&30)===0&&!$6(R)&&(h=lp(u,T),h===2&&(z=cr(u),z!==0&&(T=z,h=xv(u,z))),h===1))throw b=sh,Od(u,0),gc(u,T),Os(u,Sn()),b;switch(u.finishedWork=R,u.finishedLanes=T,h){case 0:case 1:throw Error(t(345));case 2:Id(u,Ds,sl);break;case 3:if(gc(u,T),(T&130023424)===T&&(h=mv+500-Sn(),10<h)){if(fn(u,0)!==0)break;if(R=u.suspendedLanes,(R&T)!==T){ps(),u.pingedLanes|=u.suspendedLanes&R;break}u.timeoutHandle=_r(Id.bind(null,u,Ds,sl),h);break}Id(u,Ds,sl);break;case 4:if(gc(u,T),(T&4194240)===T)break;for(h=u.eventTimes,R=-1;0<T;){var Z=31-Mt(T);z=1<<Z,Z=h[Z],Z>R&&(R=Z),T&=~z}if(T=R,T=Sn()-T,T=(120>T?120:480>T?480:1080>T?1080:1920>T?1920:3e3>T?3e3:4320>T?4320:1960*W6(T/1960))-T,10<T){u.timeoutHandle=_r(Id.bind(null,u,Ds,sl),T);break}Id(u,Ds,sl);break;case 5:Id(u,Ds,sl);break;default:throw Error(t(329))}}}return Os(u,Sn()),u.callbackNode===b?TT.bind(null,u):null}function xv(u,h){var b=ih;return u.current.memoizedState.isDehydrated&&(Od(u,h).flags|=256),u=lp(u,h),u!==2&&(h=Ds,Ds=b,h!==null&&yv(h)),u}function yv(u){Ds===null?Ds=u:Ds.push.apply(Ds,u)}function $6(u){for(var h=u;;){if(h.flags&16384){var b=h.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var T=0;T<b.length;T++){var R=b[T],z=R.getSnapshot;R=R.value;try{if(!zr(z(),R))return!1}catch{return!1}}}if(b=h.child,h.subtreeFlags&16384&&b!==null)b.return=h,h=b;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function gc(u,h){for(h&=~hv,h&=~np,u.suspendedLanes|=h,u.pingedLanes&=~h,u=u.expirationTimes;0<h;){var b=31-Mt(h),T=1<<b;u[b]=-1,h&=~T}}function PT(u){if((tn&6)!==0)throw Error(t(327));zu();var h=fn(u,0);if((h&1)===0)return Os(u,Sn()),null;var b=lp(u,h);if(u.tag!==0&&b===2){var T=cr(u);T!==0&&(h=T,b=xv(u,T))}if(b===1)throw b=sh,Od(u,0),gc(u,h),Os(u,Sn()),b;if(b===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=h,Id(u,Ds,sl),Os(u,Sn()),null}function vv(u,h){var b=tn;tn|=1;try{return u(h)}finally{tn=b,tn===0&&(qu=Sn()+500,Am&&cc())}}function Dd(u){mc!==null&&mc.tag===0&&(tn&6)===0&&zu();var h=tn;tn|=1;var b=Ii.transition,T=$t;try{if(Ii.transition=null,$t=1,u)return u()}finally{$t=T,Ii.transition=b,tn=h,(tn&6)===0&&cc()}}function bv(){si=Fu.current,Rn(Fu)}function Od(u,h){u.finishedWork=null,u.finishedLanes=0;var b=u.timeoutHandle;if(b!==-1&&(u.timeoutHandle=-1,ur(b)),fr!==null)for(b=fr.return;b!==null;){var T=b;switch(My(T),T.tag){case 1:T=T.type.childContextTypes,T!=null&&Om();break;case 3:Au(),Rn(Ms),Rn(Kr),Vy();break;case 5:zy(T);break;case 4:Au();break;case 13:Rn(Hn);break;case 19:Rn(Hn);break;case 10:Ay(T.type._context);break;case 22:case 23:bv()}b=b.return}if(Dr=u,fr=u=xc(u.current,null),Vr=si=h,Sr=0,sh=null,hv=np=Ed=0,Ds=ih=null,Pd!==null){for(h=0;h<Pd.length;h++)if(b=Pd[h],T=b.interleaved,T!==null){b.interleaved=null;var R=T.next,z=b.pending;if(z!==null){var Z=z.next;z.next=R,T.next=Z}b.pending=T}Pd=null}return u}function MT(u,h){do{var b=fr;try{if(Iy(),$m.current=Zm,Hm){for(var T=Yn.memoizedState;T!==null;){var R=T.queue;R!==null&&(R.pending=null),T=T.next}Hm=!1}if(kd=0,Er=wr=Yn=null,Qf=!1,Xf=0,fv.current=null,b===null||b.return===null){Sr=1,sh=h,fr=null;break}e:{var z=u,Z=b.return,he=b,ve=h;if(h=Vr,he.flags|=32768,ve!==null&&typeof ve=="object"&&typeof ve.then=="function"){var Ie=ve,$e=he,Ye=$e.tag;if(($e.mode&1)===0&&(Ye===0||Ye===11||Ye===15)){var We=$e.alternate;We?($e.updateQueue=We.updateQueue,$e.memoizedState=We.memoizedState,$e.lanes=We.lanes):($e.updateQueue=null,$e.memoizedState=null)}var it=eT(Z);if(it!==null){it.flags&=-257,tT(it,Z,he,z,h),it.mode&1&&X1(z,Ie,h),h=it,ve=Ie;var ut=h.updateQueue;if(ut===null){var ht=new Set;ht.add(ve),h.updateQueue=ht}else ut.add(ve);break e}else{if((h&1)===0){X1(z,Ie,h),_v();break e}ve=Error(t(426))}}else if(Vn&&he.mode&1){var rr=eT(Z);if(rr!==null){(rr.flags&65536)===0&&(rr.flags|=256),tT(rr,Z,he,z,h),Dy(Ru(ve,he));break e}}z=ve=Ru(ve,he),Sr!==4&&(Sr=2),ih===null?ih=[z]:ih.push(z),z=Z;do{switch(z.tag){case 3:z.flags|=65536,h&=-h,z.lanes|=h;var Te=J1(z,ve,h);j1(z,Te);break e;case 1:he=ve;var we=z.type,Ee=z.stateNode;if((z.flags&128)===0&&(typeof we.getDerivedStateFromError=="function"||Ee!==null&&typeof Ee.componentDidCatch=="function"&&(hc===null||!hc.has(Ee)))){z.flags|=65536,h&=-h,z.lanes|=h;var Ze=Q1(z,he,h);j1(z,Ze);break e}}z=z.return}while(z!==null)}DT(b)}catch(mt){h=mt,fr===b&&b!==null&&(fr=b=b.return);continue}break}while(!0)}function kT(){var u=tp.current;return tp.current=Zm,u===null?Zm:u}function _v(){(Sr===0||Sr===3||Sr===2)&&(Sr=4),Dr===null||(Ed&268435455)===0&&(np&268435455)===0||gc(Dr,Vr)}function lp(u,h){var b=tn;tn|=2;var T=kT();(Dr!==u||Vr!==h)&&(sl=null,Od(u,h));do try{H6();break}catch(R){MT(u,R)}while(!0);if(Iy(),tn=b,tp.current=T,fr!==null)throw Error(t(261));return Dr=null,Vr=0,Sr}function H6(){for(;fr!==null;)ET(fr)}function Y6(){for(;fr!==null&&!od();)ET(fr)}function ET(u){var h=AT(u.alternate,u,si);u.memoizedProps=u.pendingProps,h===null?DT(u):fr=h,fv.current=null}function DT(u){var h=u;do{var b=h.alternate;if(u=h.return,(h.flags&32768)===0){if(b=q6(b,h,si),b!==null){fr=b;return}}else{if(b=z6(b,h),b!==null){b.flags&=32767,fr=b;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{Sr=6,fr=null;return}}if(h=h.sibling,h!==null){fr=h;return}fr=h=u}while(h!==null);Sr===0&&(Sr=5)}function Id(u,h,b){var T=$t,R=Ii.transition;try{Ii.transition=null,$t=1,G6(u,h,b,T)}finally{Ii.transition=R,$t=T}return null}function G6(u,h,b,T){do zu();while(mc!==null);if((tn&6)!==0)throw Error(t(327));b=u.finishedWork;var R=u.finishedLanes;if(b===null)return null;if(u.finishedWork=null,u.finishedLanes=0,b===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var z=b.lanes|b.childLanes;if(En(u,z),u===Dr&&(fr=Dr=null,Vr=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||sp||(sp=!0,RT(Ia,function(){return zu(),null})),z=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||z){z=Ii.transition,Ii.transition=null;var Z=$t;$t=1;var he=tn;tn|=4,fv.current=null,V6(u,b),wT(b,u),g(_t),ra=!!rt,_t=rt=null,u.current=b,B6(b),Oa(),tn=he,$t=Z,Ii.transition=z}else u.current=b;if(sp&&(sp=!1,mc=u,ip=R),z=u.pendingLanes,z===0&&(hc=null),Qi(b.stateNode),Os(u,Sn()),h!==null)for(T=u.onRecoverableError,b=0;b<h.length;b++)R=h[b],T(R.value,{componentStack:R.stack,digest:R.digest});if(rp)throw rp=!1,u=pv,pv=null,u;return(ip&1)!==0&&u.tag!==0&&zu(),z=u.pendingLanes,(z&1)!==0?u===gv?ah++:(ah=0,gv=u):ah=0,cc(),null}function zu(){if(mc!==null){var u=bi(ip),h=Ii.transition,b=$t;try{if(Ii.transition=null,$t=16>u?16:u,mc===null)var T=!1;else{if(u=mc,mc=null,ip=0,(tn&6)!==0)throw Error(t(331));var R=tn;for(tn|=4,lt=u.current;lt!==null;){var z=lt,Z=z.child;if((lt.flags&16)!==0){var he=z.deletions;if(he!==null){for(var ve=0;ve<he.length;ve++){var Ie=he[ve];for(lt=Ie;lt!==null;){var $e=lt;switch($e.tag){case 0:case 11:case 15:rh(8,$e,z)}var Ye=$e.child;if(Ye!==null)Ye.return=$e,lt=Ye;else for(;lt!==null;){$e=lt;var We=$e.sibling,it=$e.return;if(xT($e),$e===Ie){lt=null;break}if(We!==null){We.return=it,lt=We;break}lt=it}}}var ut=z.alternate;if(ut!==null){var ht=ut.child;if(ht!==null){ut.child=null;do{var rr=ht.sibling;ht.sibling=null,ht=rr}while(ht!==null)}}lt=z}}if((z.subtreeFlags&2064)!==0&&Z!==null)Z.return=z,lt=Z;else e:for(;lt!==null;){if(z=lt,(z.flags&2048)!==0)switch(z.tag){case 0:case 11:case 15:rh(9,z,z.return)}var Te=z.sibling;if(Te!==null){Te.return=z.return,lt=Te;break e}lt=z.return}}var we=u.current;for(lt=we;lt!==null;){Z=lt;var Ee=Z.child;if((Z.subtreeFlags&2064)!==0&&Ee!==null)Ee.return=Z,lt=Ee;else e:for(Z=we;lt!==null;){if(he=lt,(he.flags&2048)!==0)try{switch(he.tag){case 0:case 11:case 15:ep(9,he)}}catch(mt){er(he,he.return,mt)}if(he===Z){lt=null;break e}var Ze=he.sibling;if(Ze!==null){Ze.return=he.return,lt=Ze;break e}lt=he.return}}if(tn=R,cc(),Ir&&typeof Ir.onPostCommitFiberRoot=="function")try{Ir.onPostCommitFiberRoot(Ji,u)}catch{}T=!0}return T}finally{$t=b,Ii.transition=h}}return!1}function OT(u,h,b){h=Ru(b,h),h=J1(u,h,1),u=uc(u,h,1),h=ps(),u!==null&&(Ar(u,1,h),Os(u,h))}function er(u,h,b){if(u.tag===3)OT(u,u,b);else for(;h!==null;){if(h.tag===3){OT(h,u,b);break}else if(h.tag===1){var T=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(hc===null||!hc.has(T))){u=Ru(b,u),u=Q1(h,u,1),h=uc(h,u,1),u=ps(),h!==null&&(Ar(h,1,u),Os(h,u));break}}h=h.return}}function Z6(u,h,b){var T=u.pingCache;T!==null&&T.delete(h),h=ps(),u.pingedLanes|=u.suspendedLanes&b,Dr===u&&(Vr&b)===b&&(Sr===4||Sr===3&&(Vr&130023424)===Vr&&500>Sn()-mv?Od(u,0):hv|=b),Os(u,h)}function IT(u,h){h===0&&((u.mode&1)===0?h=1:(h=yi,yi<<=1,(yi&130023424)===0&&(yi=4194304)));var b=ps();u=tl(u,h),u!==null&&(Ar(u,h,b),Os(u,b))}function K6(u){var h=u.memoizedState,b=0;h!==null&&(b=h.retryLane),IT(u,b)}function J6(u,h){var b=0;switch(u.tag){case 13:var T=u.stateNode,R=u.memoizedState;R!==null&&(b=R.retryLane);break;case 19:T=u.stateNode;break;default:throw Error(t(314))}T!==null&&T.delete(h),IT(u,b)}var AT;AT=function(u,h,b){if(u!==null)if(u.memoizedProps!==h.pendingProps||Ms.current)Es=!0;else{if((u.lanes&b)===0&&(h.flags&128)===0)return Es=!1,F6(u,h,b);Es=(u.flags&131072)!==0}else Es=!1,Vn&&(h.flags&1048576)!==0&&m1(h,Lm,h.index);switch(h.lanes=0,h.tag){case 2:var T=h.type;Qm(u,h),u=h.pendingProps;var R=Pu(h,Kr.current);Iu(h,b),R=$y(null,h,T,u,R,b);var z=Hy();return h.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,ks(T)?(z=!0,Im(h)):z=!1,h.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,Fy(h),R.updater=Km,h.stateNode=R,R._reactInternals=h,Qy(h,T,u,b),h=nv(null,h,T,!0,z,b)):(h.tag=0,Vn&&z&&Py(h),ms(null,h,R,b),h=h.child),h;case 16:T=h.elementType;e:{switch(Qm(u,h),u=h.pendingProps,R=T._init,T=R(T._payload),h.type=T,R=h.tag=X6(T),u=ca(T,u),R){case 0:h=tv(null,h,T,u,b);break e;case 1:h=oT(null,h,T,u,b);break e;case 11:h=nT(null,h,T,u,b);break e;case 14:h=rT(null,h,T,ca(T.type,u),b);break e}throw Error(t(306,T,""))}return h;case 0:return T=h.type,R=h.pendingProps,R=h.elementType===T?R:ca(T,R),tv(u,h,T,R,b);case 1:return T=h.type,R=h.pendingProps,R=h.elementType===T?R:ca(T,R),oT(u,h,T,R,b);case 3:e:{if(lT(h),u===null)throw Error(t(387));T=h.pendingProps,z=h.memoizedState,R=z.element,S1(u,h),Bm(h,T,null,b);var Z=h.memoizedState;if(T=Z.element,z.isDehydrated)if(z={element:T,isDehydrated:!1,cache:Z.cache,pendingSuspenseBoundaries:Z.pendingSuspenseBoundaries,transitions:Z.transitions},h.updateQueue.baseState=z,h.memoizedState=z,h.flags&256){R=Ru(Error(t(423)),h),h=cT(u,h,T,b,R);break e}else if(T!==R){R=Ru(Error(t(424)),h),h=cT(u,h,T,b,R);break e}else for(ri=no(h.stateNode.containerInfo.firstChild),ni=h,Vn=!0,la=null,b=_1(h,null,T,b),h.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Eu(),T===R){h=rl(u,h,b);break e}ms(u,h,T,b)}h=h.child}return h;case 5:return C1(h),u===null&&Ey(h),T=h.type,R=h.pendingProps,z=u!==null?u.memoizedProps:null,Z=R.children,zt(T,R)?Z=null:z!==null&&zt(T,z)&&(h.flags|=32),aT(u,h),ms(u,h,Z,b),h.child;case 6:return u===null&&Ey(h),null;case 13:return dT(u,h,b);case 4:return qy(h,h.stateNode.containerInfo),T=h.pendingProps,u===null?h.child=Du(h,null,T,b):ms(u,h,T,b),h.child;case 11:return T=h.type,R=h.pendingProps,R=h.elementType===T?R:ca(T,R),nT(u,h,T,R,b);case 7:return ms(u,h,h.pendingProps,b),h.child;case 8:return ms(u,h,h.pendingProps.children,b),h.child;case 12:return ms(u,h,h.pendingProps.children,b),h.child;case 10:e:{if(T=h.type._context,R=h.pendingProps,z=h.memoizedProps,Z=R.value,Dn(zm,T._currentValue),T._currentValue=Z,z!==null)if(zr(z.value,Z)){if(z.children===R.children&&!Ms.current){h=rl(u,h,b);break e}}else for(z=h.child,z!==null&&(z.return=h);z!==null;){var he=z.dependencies;if(he!==null){Z=z.child;for(var ve=he.firstContext;ve!==null;){if(ve.context===T){if(z.tag===1){ve=nl(-1,b&-b),ve.tag=2;var Ie=z.updateQueue;if(Ie!==null){Ie=Ie.shared;var $e=Ie.pending;$e===null?ve.next=ve:(ve.next=$e.next,$e.next=ve),Ie.pending=ve}}z.lanes|=b,ve=z.alternate,ve!==null&&(ve.lanes|=b),Ry(z.return,b,h),he.lanes|=b;break}ve=ve.next}}else if(z.tag===10)Z=z.type===h.type?null:z.child;else if(z.tag===18){if(Z=z.return,Z===null)throw Error(t(341));Z.lanes|=b,he=Z.alternate,he!==null&&(he.lanes|=b),Ry(Z,b,h),Z=z.sibling}else Z=z.child;if(Z!==null)Z.return=z;else for(Z=z;Z!==null;){if(Z===h){Z=null;break}if(z=Z.sibling,z!==null){z.return=Z.return,Z=z;break}Z=Z.return}z=Z}ms(u,h,R.children,b),h=h.child}return h;case 9:return R=h.type,T=h.pendingProps.children,Iu(h,b),R=Di(R),T=T(R),h.flags|=1,ms(u,h,T,b),h.child;case 14:return T=h.type,R=ca(T,h.pendingProps),R=ca(T.type,R),rT(u,h,T,R,b);case 15:return sT(u,h,h.type,h.pendingProps,b);case 17:return T=h.type,R=h.pendingProps,R=h.elementType===T?R:ca(T,R),Qm(u,h),h.tag=1,ks(T)?(u=!0,Im(h)):u=!1,Iu(h,b),Z1(h,T,R),Qy(h,T,R,b),nv(null,h,T,!0,u,b);case 19:return fT(u,h,b);case 22:return iT(u,h,b)}throw Error(t(156,h.tag))};function RT(u,h){return Il(u,h)}function Q6(u,h,b,T){this.tag=u,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ai(u,h,b,T){return new Q6(u,h,b,T)}function wv(u){return u=u.prototype,!(!u||!u.isReactComponent)}function X6(u){if(typeof u=="function")return wv(u)?1:0;if(u!=null){if(u=u.$$typeof,u===X)return 11;if(u===ne)return 14}return 2}function xc(u,h){var b=u.alternate;return b===null?(b=Ai(u.tag,h,u.key,u.mode),b.elementType=u.elementType,b.type=u.type,b.stateNode=u.stateNode,b.alternate=u,u.alternate=b):(b.pendingProps=h,b.type=u.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=u.flags&14680064,b.childLanes=u.childLanes,b.lanes=u.lanes,b.child=u.child,b.memoizedProps=u.memoizedProps,b.memoizedState=u.memoizedState,b.updateQueue=u.updateQueue,h=u.dependencies,b.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},b.sibling=u.sibling,b.index=u.index,b.ref=u.ref,b}function cp(u,h,b,T,R,z){var Z=2;if(T=u,typeof u=="function")wv(u)&&(Z=1);else if(typeof u=="string")Z=5;else e:switch(u){case q:return Ad(b.children,R,z,h);case F:Z=8,R|=8;break;case U:return u=Ai(12,b,h,R|2),u.elementType=U,u.lanes=z,u;case Q:return u=Ai(13,b,h,R),u.elementType=Q,u.lanes=z,u;case Y:return u=Ai(19,b,h,R),u.elementType=Y,u.lanes=z,u;case ie:return dp(b,R,z,h);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case B:Z=10;break e;case G:Z=9;break e;case X:Z=11;break e;case ne:Z=14;break e;case te:Z=16,T=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return h=Ai(Z,b,h,R),h.elementType=u,h.type=T,h.lanes=z,h}function Ad(u,h,b,T){return u=Ai(7,u,T,h),u.lanes=b,u}function dp(u,h,b,T){return u=Ai(22,u,T,h),u.elementType=ie,u.lanes=b,u.stateNode={isHidden:!1},u}function Sv(u,h,b){return u=Ai(6,u,null,h),u.lanes=b,u}function jv(u,h,b){return h=Ai(4,u.children!==null?u.children:[],u.key,h),h.lanes=b,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}function eq(u,h,b,T,R){this.tag=h,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vi(0),this.expirationTimes=vi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vi(0),this.identifierPrefix=T,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function Nv(u,h,b,T,R,z,Z,he,ve){return u=new eq(u,h,b,he,ve),h===1?(h=1,z===!0&&(h|=8)):h=0,z=Ai(3,null,null,h),u.current=z,z.stateNode=u,z.memoizedState={element:T,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fy(z),u}function tq(u,h,b){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:O,key:T==null?null:""+T,children:u,containerInfo:h,implementation:b}}function LT(u){if(!u)return lc;u=u._reactInternals;e:{if(Ss(u)!==u||u.tag!==1)throw Error(t(170));var h=u;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(ks(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(t(171))}if(u.tag===1){var b=u.type;if(ks(b))return u1(u,b,h)}return h}function FT(u,h,b,T,R,z,Z,he,ve){return u=Nv(b,T,!0,u,R,z,Z,he,ve),u.context=LT(null),b=u.current,T=ps(),R=pc(b),z=nl(T,R),z.callback=h??null,uc(b,z,R),u.current.lanes=R,Ar(u,R,T),Os(u,T),u}function up(u,h,b,T){var R=h.current,z=ps(),Z=pc(R);return b=LT(b),h.context===null?h.context=b:h.pendingContext=b,h=nl(z,Z),h.payload={element:u},T=T===void 0?null:T,T!==null&&(h.callback=T),u=uc(R,h,Z),u!==null&&(fa(u,R,Z,z),Vm(u,R,Z)),Z}function fp(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function qT(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var b=u.retryLane;u.retryLane=b!==0&&b<h?b:h}}function Cv(u,h){qT(u,h),(u=u.alternate)&&qT(u,h)}function nq(){return null}var zT=typeof reportError=="function"?reportError:function(u){console.error(u)};function Tv(u){this._internalRoot=u}hp.prototype.render=Tv.prototype.render=function(u){var h=this._internalRoot;if(h===null)throw Error(t(409));up(u,h,null,null)},hp.prototype.unmount=Tv.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var h=u.containerInfo;Dd(function(){up(null,u,null,null)}),h[hn]=null}};function hp(u){this._internalRoot=u}hp.prototype.unstable_scheduleHydration=function(u){if(u){var h=qa();u={blockedOn:null,target:u,priority:h};for(var b=0;b<$n.length&&h!==0&&h<$n[b].priority;b++);$n.splice(b,0,u),b===0&&za(u)}};function Pv(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function mp(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function UT(){}function rq(u,h,b,T,R){if(R){if(typeof T=="function"){var z=T;T=function(){var Ie=fp(Z);z.call(Ie)}}var Z=FT(h,T,u,0,null,!1,!1,"",UT);return u._reactRootContainer=Z,u[hn]=Z.current,rc(u.nodeType===8?u.parentNode:u),Dd(),Z}for(;R=u.lastChild;)u.removeChild(R);if(typeof T=="function"){var he=T;T=function(){var Ie=fp(ve);he.call(Ie)}}var ve=Nv(u,0,!1,null,null,!1,!1,"",UT);return u._reactRootContainer=ve,u[hn]=ve.current,rc(u.nodeType===8?u.parentNode:u),Dd(function(){up(h,ve,b,T)}),ve}function pp(u,h,b,T,R){var z=b._reactRootContainer;if(z){var Z=z;if(typeof R=="function"){var he=R;R=function(){var ve=fp(Z);he.call(ve)}}up(h,Z,u,R)}else Z=rq(b,h,u,R,T);return fp(Z)}La=function(u){switch(u.tag){case 3:var h=u.stateNode;if(h.current.memoizedState.isDehydrated){var b=Pt(h.pendingLanes);b!==0&&(ls(h,b|1),Os(h,Sn()),(tn&6)===0&&(qu=Sn()+500,cc()))}break;case 13:Dd(function(){var T=tl(u,1);if(T!==null){var R=ps();fa(T,u,1,R)}}),Cv(u,1)}},Gs=function(u){if(u.tag===13){var h=tl(u,134217728);if(h!==null){var b=ps();fa(h,u,134217728,b)}Cv(u,134217728)}},Fa=function(u){if(u.tag===13){var h=pc(u),b=tl(u,h);if(b!==null){var T=ps();fa(b,u,h,T)}Cv(u,h)}},qa=function(){return $t},Xi=function(u,h){var b=$t;try{return $t=u,h()}finally{$t=b}},un=function(u,h,b){switch(h){case"input":if(ze(u,b),h=b.name,b.type==="radio"&&h!=null){for(b=u;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<b.length;h++){var T=b[h];if(T!==u&&T.form===u.form){var R=Cu(T);if(!R)throw Error(t(90));Se(T),ze(T,R)}}}break;case"textarea":Fe(u,b);break;case"select":h=b.value,h!=null&&xe(u,!!b.multiple,h,!1)}},Pl=vv,Ml=Dd;var sq={usingClientEntryPoint:!1,Events:[Ko,Jo,Cu,Hs,wo,vv]},oh={findFiberByHostInstance:Zo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iq={bundleType:oh.bundleType,version:oh.version,rendererPackageName:oh.rendererPackageName,rendererConfig:oh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Dl(u),u===null?null:u.stateNode},findFiberByHostInstance:oh.findFiberByHostInstance||nq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gp.isDisabled&&gp.supportsFiber)try{Ji=gp.inject(iq),Ir=gp}catch{}}return Is.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sq,Is.createPortal=function(u,h){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pv(h))throw Error(t(200));return tq(u,h,null,b)},Is.createRoot=function(u,h){if(!Pv(u))throw Error(t(299));var b=!1,T="",R=zT;return h!=null&&(h.unstable_strictMode===!0&&(b=!0),h.identifierPrefix!==void 0&&(T=h.identifierPrefix),h.onRecoverableError!==void 0&&(R=h.onRecoverableError)),h=Nv(u,1,!1,null,null,b,!1,T,R),u[hn]=h.current,rc(u.nodeType===8?u.parentNode:u),new Tv(h)},Is.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Dl(h),u=u===null?null:u.stateNode,u},Is.flushSync=function(u){return Dd(u)},Is.hydrate=function(u,h,b){if(!mp(h))throw Error(t(200));return pp(null,u,h,!0,b)},Is.hydrateRoot=function(u,h,b){if(!Pv(u))throw Error(t(405));var T=b!=null&&b.hydratedSources||null,R=!1,z="",Z=zT;if(b!=null&&(b.unstable_strictMode===!0&&(R=!0),b.identifierPrefix!==void 0&&(z=b.identifierPrefix),b.onRecoverableError!==void 0&&(Z=b.onRecoverableError)),h=FT(h,null,u,1,b??null,R,!1,z,Z),u[hn]=h.current,rc(u),T)for(u=0;u<T.length;u++)b=T[u],R=b._getVersion,R=R(b._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[b,R]:h.mutableSourceEagerHydrationData.push(b,R);return new hp(h)},Is.render=function(u,h,b){if(!mp(h))throw Error(t(200));return pp(null,u,h,!1,b)},Is.unmountComponentAtNode=function(u){if(!mp(u))throw Error(t(40));return u._reactRootContainer?(Dd(function(){pp(null,null,u,!1,function(){u._reactRootContainer=null,u[hn]=null})}),!0):!1},Is.unstable_batchedUpdates=vv,Is.unstable_renderSubtreeIntoContainer=function(u,h,b,T){if(!mp(b))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return pp(u,h,b,!1,T)},Is.version="18.3.1-next-f1338f8080-20240426",Is}var ZT;function kL(){if(ZT)return Ev.exports;ZT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ev.exports=fq(),Ev.exports}var KT;function hq(){if(KT)return xp;KT=1;var n=kL();return xp.createRoot=n.createRoot,xp.hydrateRoot=n.hydrateRoot,xp}var mq=hq();const pq=hu(mq);var EL=kL();function Kh(){return Kh=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Kh.apply(this,arguments)}var Mc;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Mc||(Mc={}));const JT="popstate";function gq(n){n===void 0&&(n={});function e(s,a){let{pathname:o="/",search:l="",hash:c=""}=mu(s.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Nj("",{pathname:o,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,d=c.indexOf("#");l=d===-1?c:c.slice(0,d)}return l+"#"+(typeof a=="string"?a:tx(a))}function r(s,a){Dx(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(a)+")")}return yq(e,t,r,n)}function Qn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Dx(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function xq(){return Math.random().toString(36).substr(2,8)}function QT(n,e){return{usr:n.state,key:n.key,idx:e}}function Nj(n,e,t,r){return t===void 0&&(t=null),Kh({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?mu(e):e,{state:t,key:e&&e.key||r||xq()})}function tx(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function mu(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function yq(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:a=!1}=r,o=s.history,l=Mc.Pop,c=null,d=m();d==null&&(d=0,o.replaceState(Kh({},o.state,{idx:d}),""));function m(){return(o.state||{idx:null}).idx}function p(){l=Mc.Pop;let j=m(),P=j==null?null:j-d;d=j,c&&c({action:l,location:w.location,delta:P})}function x(j,P){l=Mc.Push;let k=Nj(w.location,j,P);t&&t(k,j),d=m()+1;let I=QT(k,d),M=w.createHref(k);try{o.pushState(I,"",M)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(M)}a&&c&&c({action:l,location:w.location,delta:1})}function v(j,P){l=Mc.Replace;let k=Nj(w.location,j,P);t&&t(k,j),d=m();let I=QT(k,d),M=w.createHref(k);o.replaceState(I,"",M),a&&c&&c({action:l,location:w.location,delta:0})}function _(j){let P=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof j=="string"?j:tx(j);return k=k.replace(/ $/,"%20"),Qn(P,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,P)}let w={get action(){return l},get location(){return n(s,o)},listen(j){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(JT,p),c=j,()=>{s.removeEventListener(JT,p),c=null}},createHref(j){return e(s,j)},createURL:_,encodeLocation(j){let P=_(j);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:x,replace:v,go(j){return o.go(j)}};return w}var XT;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(XT||(XT={}));function vq(n,e,t){return t===void 0&&(t="/"),bq(n,e,t)}function bq(n,e,t,r){let s=typeof e=="string"?mu(e):e,a=pf(s.pathname||"/",t);if(a==null)return null;let o=DL(n);_q(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=Dq(a);l=kq(o[c],d)}return l}function DL(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(Qn(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=Rc([r,c.relativePath]),m=t.concat(c);a.children&&a.children.length>0&&(Qn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),DL(a.children,e,m,d)),!(a.path==null&&!a.index)&&e.push({path:d,score:Pq(d,a.index),routesMeta:m})};return n.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,o);else for(let c of OL(a.path))s(a,o,c)}),e}function OL(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let o=OL(r.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function _q(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Mq(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const wq=/^:[\w-]+$/,Sq=3,jq=2,Nq=1,Cq=10,Tq=-2,eP=n=>n==="*";function Pq(n,e){let t=n.split("/"),r=t.length;return t.some(eP)&&(r+=Tq),e&&(r+=jq),t.filter(s=>!eP(s)).reduce((s,a)=>s+(wq.test(a)?Sq:a===""?Nq:Cq),r)}function Mq(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function kq(n,e,t){let{routesMeta:r}=n,s={},a="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,m=a==="/"?e:e.slice(a.length)||"/",p=Cj({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},m),x=c.route;if(!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:Rc([a,p.pathname]),pathnameBase:Lq(Rc([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=Rc([a,p.pathnameBase]))}return o}function Cj(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Eq(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,m,p)=>{let{paramName:x,isOptional:v}=m;if(x==="*"){let w=l[p]||"";o=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const _=l[p];return v&&!_?d[x]=void 0:d[x]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function Eq(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Dx(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Dq(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Dx(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function pf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const Oq=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Iq=n=>Oq.test(n);function Aq(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?mu(n):n,a;if(t)if(Iq(t))a=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Dx(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+t))}t.startsWith("/")?a=tP(t.substring(1),"/"):a=tP(t,e)}else a=e;return{pathname:a,search:Fq(r),hash:qq(s)}}function tP(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Iv(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Rq(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function VN(n,e){let t=Rq(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function BN(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=mu(n):(s=Kh({},n),Qn(!s.pathname||!s.pathname.includes("?"),Iv("?","pathname","search",s)),Qn(!s.pathname||!s.pathname.includes("#"),Iv("#","pathname","hash",s)),Qn(!s.search||!s.search.includes("#"),Iv("#","search","hash",s)));let a=n===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),p-=1;s.pathname=x.join("/")}l=p>=0?e[p]:"/"}let c=Aq(s,l),d=o&&o!=="/"&&o.endsWith("/"),m=(a||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||m)&&(c.pathname+="/"),c}const Rc=n=>n.join("/").replace(/\/\/+/g,"/"),Lq=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Fq=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,qq=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function zq(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const IL=["post","put","patch","delete"];new Set(IL);const Uq=["get",...IL];new Set(Uq);function Jh(){return Jh=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Jh.apply(this,arguments)}const Ox=E.createContext(null),AL=E.createContext(null),jl=E.createContext(null),Ix=E.createContext(null),bo=E.createContext({outlet:null,matches:[],isDataRoute:!1}),RL=E.createContext(null);function Vq(n,e){let{relative:t}=e===void 0?{}:e;Df()||Qn(!1);let{basename:r,navigator:s}=E.useContext(jl),{hash:a,pathname:o,search:l}=Ax(n,{relative:t}),c=o;return r!=="/"&&(c=o==="/"?r:Rc([r,o])),s.createHref({pathname:c,search:l,hash:a})}function Df(){return E.useContext(Ix)!=null}function bs(){return Df()||Qn(!1),E.useContext(Ix).location}function LL(n){E.useContext(jl).static||E.useLayoutEffect(n)}function yn(){let{isDataRoute:n}=E.useContext(bo);return n?nz():Bq()}function Bq(){Df()||Qn(!1);let n=E.useContext(Ox),{basename:e,future:t,navigator:r}=E.useContext(jl),{matches:s}=E.useContext(bo),{pathname:a}=bs(),o=JSON.stringify(VN(s,t.v7_relativeSplatPath)),l=E.useRef(!1);return LL(()=>{l.current=!0}),E.useCallback(function(d,m){if(m===void 0&&(m={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let p=BN(d,JSON.parse(o),a,m.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Rc([e,p.pathname])),(m.replace?r.replace:r.push)(p,m.state,m)},[e,r,o,a,n])}const FL=E.createContext(null);function pi(){return E.useContext(FL)}function Wq(n){let e=E.useContext(bo).outlet;return e&&E.createElement(FL.Provider,{value:n},e)}function qL(){let{matches:n}=E.useContext(bo),e=n[n.length-1];return e?e.params:{}}function Ax(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=E.useContext(jl),{matches:s}=E.useContext(bo),{pathname:a}=bs(),o=JSON.stringify(VN(s,r.v7_relativeSplatPath));return E.useMemo(()=>BN(n,JSON.parse(o),a,t==="path"),[n,o,a,t])}function $q(n,e){return Hq(n,e)}function Hq(n,e,t,r){Df()||Qn(!1);let{navigator:s}=E.useContext(jl),{matches:a}=E.useContext(bo),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=bs(),m;if(e){var p;let j=typeof e=="string"?mu(e):e;c==="/"||(p=j.pathname)!=null&&p.startsWith(c)||Qn(!1),m=j}else m=d;let x=m.pathname||"/",v=x;if(c!=="/"){let j=c.replace(/^\//,"").split("/");v="/"+x.replace(/^\//,"").split("/").slice(j.length).join("/")}let _=vq(n,{pathname:v}),w=Jq(_&&_.map(j=>Object.assign({},j,{params:Object.assign({},l,j.params),pathname:Rc([c,s.encodeLocation?s.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?c:Rc([c,s.encodeLocation?s.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),a,t,r);return e&&w?E.createElement(Ix.Provider,{value:{location:Jh({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Mc.Pop}},w):w}function Yq(){let n=tz(),e=zq(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),t?E.createElement("pre",{style:s},t):null,null)}const Gq=E.createElement(Yq,null);class Zq extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?E.createElement(bo.Provider,{value:this.props.routeContext},E.createElement(RL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Kq(n){let{routeContext:e,match:t,children:r}=n,s=E.useContext(Ox);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),E.createElement(bo.Provider,{value:e},r)}function Jq(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var a;if(!t)return null;if(t.errors)n=t.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,l=(s=t)==null?void 0:s.errors;if(l!=null){let m=o.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);m>=0||Qn(!1),o=o.slice(0,Math.min(o.length,m+1))}let c=!1,d=-1;if(t&&r&&r.v7_partialHydration)for(let m=0;m<o.length;m++){let p=o[m];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=m),p.route.id){let{loaderData:x,errors:v}=t,_=p.route.loader&&x[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||_){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((m,p,x)=>{let v,_=!1,w=null,j=null;t&&(v=l&&p.route.id?l[p.route.id]:void 0,w=p.route.errorElement||Gq,c&&(d<0&&x===0?(rz("route-fallback"),_=!0,j=null):d===x&&(_=!0,j=p.route.hydrateFallbackElement||null)));let P=e.concat(o.slice(0,x+1)),k=()=>{let I;return v?I=w:_?I=j:p.route.Component?I=E.createElement(p.route.Component,null):p.route.element?I=p.route.element:I=m,E.createElement(Kq,{match:p,routeContext:{outlet:m,matches:P,isDataRoute:t!=null},children:I})};return t&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?E.createElement(Zq,{location:t.location,revalidation:t.revalidation,component:w,error:v,children:k(),routeContext:{outlet:null,matches:P,isDataRoute:!0}}):k()},null)}var zL=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(zL||{}),UL=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(UL||{});function Qq(n){let e=E.useContext(Ox);return e||Qn(!1),e}function Xq(n){let e=E.useContext(AL);return e||Qn(!1),e}function ez(n){let e=E.useContext(bo);return e||Qn(!1),e}function VL(n){let e=ez(),t=e.matches[e.matches.length-1];return t.route.id||Qn(!1),t.route.id}function tz(){var n;let e=E.useContext(RL),t=Xq(),r=VL();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function nz(){let{router:n}=Qq(zL.UseNavigateStable),e=VL(UL.UseNavigateStable),t=E.useRef(!1);return LL(()=>{t.current=!0}),E.useCallback(function(s,a){a===void 0&&(a={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,Jh({fromRouteId:e},a)))},[n,e])}const nP={};function rz(n,e,t){nP[n]||(nP[n]=!0)}function sz(n,e){n?.v7_startTransition,n?.v7_relativeSplatPath}function ml(n){let{to:e,replace:t,state:r,relative:s}=n;Df()||Qn(!1);let{future:a,static:o}=E.useContext(jl),{matches:l}=E.useContext(bo),{pathname:c}=bs(),d=yn(),m=BN(e,VN(l,a.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(m);return E.useEffect(()=>d(JSON.parse(p),{replace:t,state:r,relative:s}),[d,p,s,t,r]),null}function gf(n){return Wq(n.context)}function et(n){Qn(!1)}function iz(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Mc.Pop,navigator:a,static:o=!1,future:l}=n;Df()&&Qn(!1);let c=e.replace(/^\/*/,"/"),d=E.useMemo(()=>({basename:c,navigator:a,static:o,future:Jh({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof r=="string"&&(r=mu(r));let{pathname:m="/",search:p="",hash:x="",state:v=null,key:_="default"}=r,w=E.useMemo(()=>{let j=pf(m,c);return j==null?null:{location:{pathname:j,search:p,hash:x,state:v,key:_},navigationType:s}},[c,m,p,x,v,_,s]);return w==null?null:E.createElement(jl.Provider,{value:d},E.createElement(Ix.Provider,{children:t,value:w}))}function az(n){let{children:e,location:t}=n;return $q(Tj(e),t)}new Promise(()=>{});function Tj(n,e){e===void 0&&(e=[]);let t=[];return E.Children.forEach(n,(r,s)=>{if(!E.isValidElement(r))return;let a=[...e,s];if(r.type===E.Fragment){t.push.apply(t,Tj(r.props.children,a));return}r.type!==et&&Qn(!1),!r.props.index||!r.props.children||Qn(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Tj(r.props.children,a)),t.push(o)}),t}function nx(){return nx=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},nx.apply(this,arguments)}function BL(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,a;for(a=0;a<r.length;a++)s=r[a],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function oz(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function lz(n,e){return n.button===0&&(!e||e==="_self")&&!oz(n)}function Pj(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(s=>[t,s]):[[t,r]])},[]))}function cz(n,e){let t=Pj(n);return e&&e.forEach((r,s)=>{t.has(s)||e.getAll(s).forEach(a=>{t.append(s,a)})}),t}const dz=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],uz=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],fz="6";try{window.__reactRouterVersion=fz}catch{}const hz=E.createContext({isTransitioning:!1}),mz="startTransition",rP=cq[mz];function pz(n){let{basename:e,children:t,future:r,window:s}=n,a=E.useRef();a.current==null&&(a.current=gq({window:s,v5Compat:!0}));let o=a.current,[l,c]=E.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},m=E.useCallback(p=>{d&&rP?rP(()=>c(p)):c(p)},[c,d]);return E.useLayoutEffect(()=>o.listen(m),[o,m]),E.useEffect(()=>sz(r),[r]),E.createElement(iz,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:r})}const gz=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",xz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ja=E.forwardRef(function(e,t){let{onClick:r,relative:s,reloadDocument:a,replace:o,state:l,target:c,to:d,preventScrollReset:m,viewTransition:p}=e,x=BL(e,dz),{basename:v}=E.useContext(jl),_,w=!1;if(typeof d=="string"&&xz.test(d)&&(_=d,gz))try{let I=new URL(window.location.href),M=d.startsWith("//")?new URL(I.protocol+d):new URL(d),D=pf(M.pathname,v);M.origin===I.origin&&D!=null?d=D+M.search+M.hash:w=!0}catch{}let j=Vq(d,{relative:s}),P=vz(d,{replace:o,state:l,target:c,preventScrollReset:m,relative:s,viewTransition:p});function k(I){r&&r(I),I.defaultPrevented||P(I)}return E.createElement("a",nx({},x,{href:_||j,onClick:w||a?r:k,ref:t,target:c}))}),WL=E.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:s=!1,className:a="",end:o=!1,style:l,to:c,viewTransition:d,children:m}=e,p=BL(e,uz),x=Ax(c,{relative:p.relative}),v=bs(),_=E.useContext(AL),{navigator:w,basename:j}=E.useContext(jl),P=_!=null&&bz(x)&&d===!0,k=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,I=v.pathname,M=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;s||(I=I.toLowerCase(),M=M?M.toLowerCase():null,k=k.toLowerCase()),M&&j&&(M=pf(M,j)||M);const D=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let O=I===k||!o&&I.startsWith(k)&&I.charAt(D)==="/",q=M!=null&&(M===k||!o&&M.startsWith(k)&&M.charAt(k.length)==="/"),F={isActive:O,isPending:q,isTransitioning:P},U=O?r:void 0,B;typeof a=="function"?B=a(F):B=[a,O?"active":null,q?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let G=typeof l=="function"?l(F):l;return E.createElement(ja,nx({},p,{"aria-current":U,className:B,ref:t,style:G,to:c,viewTransition:d}),typeof m=="function"?m(F):m)});var Mj;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Mj||(Mj={}));var sP;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(sP||(sP={}));function yz(n){let e=E.useContext(Ox);return e||Qn(!1),e}function vz(n,e){let{target:t,replace:r,state:s,preventScrollReset:a,relative:o,viewTransition:l}=e===void 0?{}:e,c=yn(),d=bs(),m=Ax(n,{relative:o});return E.useCallback(p=>{if(lz(p,t)){p.preventDefault();let x=r!==void 0?r:tx(d)===tx(m);c(n,{replace:x,state:s,preventScrollReset:a,relative:o,viewTransition:l})}},[d,c,m,r,s,t,n,a,o,l])}function $L(n){let e=E.useRef(Pj(n)),t=E.useRef(!1),r=bs(),s=E.useMemo(()=>cz(r.search,t.current?null:e.current),[r.search]),a=yn(),o=E.useCallback((l,c)=>{const d=Pj(typeof l=="function"?l(s):l);t.current=!0,a("?"+d,c)},[a,s]);return[s,o]}function bz(n,e){e===void 0&&(e={});let t=E.useContext(hz);t==null&&Qn(!1);let{basename:r}=yz(Mj.useViewTransitionState),s=Ax(n,{relative:e.relative});if(!t.isTransitioning)return!1;let a=pf(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=pf(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Cj(s.pathname,o)!=null||Cj(s.pathname,a)!=null}const _z={},iP=n=>{let e;const t=new Set,r=(m,p)=>{const x=typeof m=="function"?m(e):m;if(!Object.is(x,e)){const v=e;e=p??(typeof x!="object"||x===null)?x:Object.assign({},e,x),t.forEach(_=>_(e,v))}},s=()=>e,c={setState:r,getState:s,getInitialState:()=>d,subscribe:m=>(t.add(m),()=>t.delete(m)),destroy:()=>{(_z?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=n(r,s,c);return c},wz=n=>n?iP(n):iP;var Av={exports:{}},Rv={},Lv={exports:{}},Fv={};var aP;function Sz(){if(aP)return Fv;aP=1;var n=Ws();function e(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,a=n.useLayoutEffect,o=n.useDebugValue;function l(p,x){var v=x(),_=r({inst:{value:v,getSnapshot:x}}),w=_[0].inst,j=_[1];return a(function(){w.value=v,w.getSnapshot=x,c(w)&&j({inst:w})},[p,v,x]),s(function(){return c(w)&&j({inst:w}),p(function(){c(w)&&j({inst:w})})},[p]),o(v),v}function c(p){var x=p.getSnapshot;p=p.value;try{var v=x();return!t(p,v)}catch{return!0}}function d(p,x){return x()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return Fv.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:m,Fv}var oP;function jz(){return oP||(oP=1,Lv.exports=Sz()),Lv.exports}var lP;function Nz(){if(lP)return Rv;lP=1;var n=Ws(),e=jz();function t(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,a=n.useRef,o=n.useEffect,l=n.useMemo,c=n.useDebugValue;return Rv.useSyncExternalStoreWithSelector=function(d,m,p,x,v){var _=a(null);if(_.current===null){var w={hasValue:!1,value:null};_.current=w}else w=_.current;_=l(function(){function P(O){if(!k){if(k=!0,I=O,O=x(O),v!==void 0&&w.hasValue){var q=w.value;if(v(q,O))return M=q}return M=O}if(q=M,r(I,O))return q;var F=x(O);return v!==void 0&&v(q,F)?(I=O,q):(I=O,M=F)}var k=!1,I,M,D=p===void 0?null:p;return[function(){return P(m())},D===null?void 0:function(){return P(D())}]},[m,p,x,v]);var j=s(d,_[0],_[1]);return o(function(){w.hasValue=!0,w.value=j},[j]),c(j),j},Rv}var cP;function Cz(){return cP||(cP=1,Av.exports=Nz()),Av.exports}var Tz=Cz();const Pz=hu(Tz),HL={},{useDebugValue:Mz}=at,{useSyncExternalStoreWithSelector:kz}=Pz;let dP=!1;const Ez=n=>n;function Dz(n,e=Ez,t){(HL?"production":void 0)!=="production"&&t&&!dP&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),dP=!0);const r=kz(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return Mz(r),r}const uP=n=>{(HL?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?wz(n):n,t=(r,s)=>Dz(e,r,s);return Object.assign(t,e),t},Ma=n=>n?uP(n):uP;var kj=function(n,e){return kj=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},kj(n,e)};function WN(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");kj(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var hr=function(){return hr=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},hr.apply(this,arguments)};function Of(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function YL(n,e,t,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var l=n.length-1;l>=0;l--)(o=n[l])&&(a=(s<3?o(a):s>3?o(e,t,a):o(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a}function GL(n,e){return function(t,r){e(t,r,n)}}function ZL(n,e,t,r,s,a){function o(P){if(P!==void 0&&typeof P!="function")throw new TypeError("Function expected");return P}for(var l=r.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&n?r.static?n:n.prototype:null,m=e||(d?Object.getOwnPropertyDescriptor(d,r.name):{}),p,x=!1,v=t.length-1;v>=0;v--){var _={};for(var w in r)_[w]=w==="access"?{}:r[w];for(var w in r.access)_.access[w]=r.access[w];_.addInitializer=function(P){if(x)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(P||null))};var j=(0,t[v])(l==="accessor"?{get:m.get,set:m.set}:m[c],_);if(l==="accessor"){if(j===void 0)continue;if(j===null||typeof j!="object")throw new TypeError("Object expected");(p=o(j.get))&&(m.get=p),(p=o(j.set))&&(m.set=p),(p=o(j.init))&&s.unshift(p)}else(p=o(j))&&(l==="field"?s.unshift(p):m[c]=p)}d&&Object.defineProperty(d,r.name,m),x=!0}function KL(n,e,t){for(var r=arguments.length>2,s=0;s<e.length;s++)t=r?e[s].call(n,t):e[s].call(n);return r?t:void 0}function JL(n){return typeof n=="symbol"?n:"".concat(n)}function QL(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function XL(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function yt(n,e,t,r){function s(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(m){try{d(r.next(m))}catch(p){o(p)}}function c(m){try{d(r.throw(m))}catch(p){o(p)}}function d(m){m.done?a(m.value):s(m.value).then(l,c)}d((r=r.apply(n,e||[])).next())})}function e4(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(m){return c([d,m])}}function c(d){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(t=0)),t;)try{if(r=1,s&&(a=d[0]&2?s.return:d[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,d[1])).done)return a;switch(s=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,s=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){t.label=d[1];break}if(d[0]===6&&t.label<a[1]){t.label=a[1],a=d;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(d);break}a[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(m){d=[6,m],s=0}finally{r=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Rx=Object.create?(function(n,e,t,r){r===void 0&&(r=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,s)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]});function t4(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Rx(e,n,t)}function rx(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function $N(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(l){o={error:l}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function n4(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat($N(arguments[e]));return n}function r4(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),s=0,e=0;e<t;e++)for(var a=arguments[e],o=0,l=a.length;o<l;o++,s++)r[s]=a[o];return r}function s4(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,a;r<s;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function xf(n){return this instanceof xf?(this.v=n,this):new xf(n)}function i4(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(v){return function(_){return Promise.resolve(_).then(v,p)}}function l(v,_){r[v]&&(s[v]=function(w){return new Promise(function(j,P){a.push([v,w,j,P])>1||c(v,w)})},_&&(s[v]=_(s[v])))}function c(v,_){try{d(r[v](_))}catch(w){x(a[0][3],w)}}function d(v){v.value instanceof xf?Promise.resolve(v.value.v).then(m,p):x(a[0][2],v)}function m(v){c("next",v)}function p(v){c("throw",v)}function x(v,_){v(_),a.shift(),a.length&&c(a[0][0],a[0][1])}}function a4(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,a){e[s]=n[s]?function(o){return(t=!t)?{value:xf(n[s](o)),done:!1}:a?a(o):o}:a}}function o4(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof rx=="function"?rx(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(l,c){o=n[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},o)}}function l4(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var Oz=Object.create?(function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}):function(n,e){n.default=e},Ej=function(n){return Ej=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},Ej(n)};function c4(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=Ej(n),r=0;r<t.length;r++)t[r]!=="default"&&Rx(e,n,t[r]);return Oz(e,n),e}function d4(n){return n&&n.__esModule?n:{default:n}}function u4(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function f4(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t}function h4(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function m4(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,s;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var Iz=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function p4(n){function e(a){n.error=n.hasError?new Iz(a,n.error,"An error was suppressed during disposal."):a,n.hasError=!0}var t,r=0;function s(){for(;t=n.stack.pop();)try{if(!t.async&&r===1)return r=0,n.stack.push(t),Promise.resolve().then(s);if(t.dispose){var a=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(a).then(s,function(o){return e(o),s()})}else r|=1}catch(o){e(o)}if(r===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return s()}function g4(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,s,a,o){return r?e?".jsx":".js":s&&(!a||!o)?t:s+a+"."+o.toLowerCase()+"js"}):n}const Az={__extends:WN,__assign:hr,__rest:Of,__decorate:YL,__param:GL,__esDecorate:ZL,__runInitializers:KL,__propKey:JL,__setFunctionName:QL,__metadata:XL,__awaiter:yt,__generator:e4,__createBinding:Rx,__exportStar:t4,__values:rx,__read:$N,__spread:n4,__spreadArrays:r4,__spreadArray:s4,__await:xf,__asyncGenerator:i4,__asyncDelegator:a4,__asyncValues:o4,__makeTemplateObject:l4,__importStar:c4,__importDefault:d4,__classPrivateFieldGet:u4,__classPrivateFieldSet:f4,__classPrivateFieldIn:h4,__addDisposableResource:m4,__disposeResources:p4,__rewriteRelativeImportExtension:g4},Rz=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:m4,get __assign(){return hr},__asyncDelegator:a4,__asyncGenerator:i4,__asyncValues:o4,__await:xf,__awaiter:yt,__classPrivateFieldGet:u4,__classPrivateFieldIn:h4,__classPrivateFieldSet:f4,__createBinding:Rx,__decorate:YL,__disposeResources:p4,__esDecorate:ZL,__exportStar:t4,__extends:WN,__generator:e4,__importDefault:d4,__importStar:c4,__makeTemplateObject:l4,__metadata:XL,__param:GL,__propKey:JL,__read:$N,__rest:Of,__rewriteRelativeImportExtension:g4,__runInitializers:KL,__setFunctionName:QL,__spread:n4,__spreadArray:s4,__spreadArrays:r4,__values:rx,default:Az},Symbol.toStringTag,{value:"Module"})),Lz=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class HN extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Fz extends HN{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class fP extends HN{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class hP extends HN{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Dj;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Dj||(Dj={}));class qz{constructor(e,{headers:t={},customFetch:r,region:s=Dj.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=Lz(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return yt(this,arguments,void 0,function*(t,r={}){var s;let a,o;try{const{headers:l,method:c,body:d,signal:m,timeout:p}=r;let x={},{region:v}=r;v||(v=this.region);const _=new URL(`${this.url}/${t}`);v&&v!=="any"&&(x["x-region"]=v,_.searchParams.set("forceFunctionRegion",v));let w;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",w=d):typeof d=="string"?(x["Content-Type"]="text/plain",w=d):typeof FormData<"u"&&d instanceof FormData?w=d:(x["Content-Type"]="application/json",w=JSON.stringify(d)):w=d;let j=m;p&&(o=new AbortController,a=setTimeout(()=>o.abort(),p),m?(j=o.signal,m.addEventListener("abort",()=>o.abort())):j=o.signal);const P=yield this.fetch(_.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),l),body:w,signal:j}).catch(D=>{throw new Fz(D)}),k=P.headers.get("x-relay-error");if(k&&k==="true")throw new fP(P);if(!P.ok)throw new hP(P);let I=((s=P.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),M;return I==="application/json"?M=yield P.json():I==="application/octet-stream"||I==="application/pdf"?M=yield P.blob():I==="text/event-stream"?M=P:I==="multipart/form-data"?M=yield P.formData():M=yield P.text(),{data:M,error:null,response:P}}catch(l){return{data:null,error:l,response:l instanceof hP||l instanceof fP?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var es={};const If=PL(Rz);var yp={},vp={},bp={},_p={},wp={},Sp={},mP;function x4(){if(mP)return Sp;mP=1,Object.defineProperty(Sp,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Sp.default=n,Sp}var pP;function y4(){if(pP)return wp;pP=1,Object.defineProperty(wp,"__esModule",{value:!0});const e=If.__importDefault(x4());class t{constructor(s){var a,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(a=s.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=s.signal,this.isMaybeSingle=(o=s.isMaybeSingle)!==null&&o!==void 0?o:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,a){return this.headers=new Headers(this.headers),this.headers.set(s,a),this}then(s,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,m,p,x;let v=null,_=null,w=null,j=c.status,P=c.statusText;if(c.ok){if(this.method!=="HEAD"){const D=await c.text();D===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?_=D:_=JSON.parse(D))}const I=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),M=(p=c.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");I&&M&&M.length>1&&(w=parseInt(M[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(v={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,w=null,j=406,P="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const I=await c.text();try{v=JSON.parse(I),Array.isArray(v)&&c.status===404&&(_=[],v=null,j=200,P="OK")}catch{c.status===404&&I===""?(j=204,P="No Content"):v={message:I}}if(v&&this.isMaybeSingle&&(!((x=v?.details)===null||x===void 0)&&x.includes("0 rows"))&&(v=null,j=200,P="OK"),v&&this.shouldThrowOnError)throw new e.default(v)}return{error:v,data:_,count:w,status:j,statusText:P}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,m,p;return{error:{message:`${(d=c?.name)!==null&&d!==void 0?d:"FetchError"}: ${c?.message}`,details:`${(m=c?.stack)!==null&&m!==void 0?m:""}`,hint:"",code:`${(p=c?.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,a)}returns(){return this}overrideTypes(){return this}}return wp.default=t,wp}var gP;function v4(){if(gP)return _p;gP=1,Object.defineProperty(_p,"__esModule",{value:!0});const e=If.__importDefault(y4());class t extends e.default{select(s){let a=!1;const o=(s??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:a=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",m=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${m?`${m},`:""}${s}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this}range(s,a,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(d,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:a=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var m;const p=[s?"analyze":null,a?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),x=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${x}"; options=${p};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return _p.default=t,_p}var xP;function YN(){if(xP)return bp;xP=1,Object.defineProperty(bp,"__esModule",{value:!0});const e=If.__importDefault(v4()),t=new RegExp("[,()]");class r extends e.default{eq(a,o){return this.url.searchParams.append(a,`eq.${o}`),this}neq(a,o){return this.url.searchParams.append(a,`neq.${o}`),this}gt(a,o){return this.url.searchParams.append(a,`gt.${o}`),this}gte(a,o){return this.url.searchParams.append(a,`gte.${o}`),this}lt(a,o){return this.url.searchParams.append(a,`lt.${o}`),this}lte(a,o){return this.url.searchParams.append(a,`lte.${o}`),this}like(a,o){return this.url.searchParams.append(a,`like.${o}`),this}likeAllOf(a,o){return this.url.searchParams.append(a,`like(all).{${o.join(",")}}`),this}likeAnyOf(a,o){return this.url.searchParams.append(a,`like(any).{${o.join(",")}}`),this}ilike(a,o){return this.url.searchParams.append(a,`ilike.${o}`),this}ilikeAllOf(a,o){return this.url.searchParams.append(a,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(a,o){return this.url.searchParams.append(a,`ilike(any).{${o.join(",")}}`),this}is(a,o){return this.url.searchParams.append(a,`is.${o}`),this}in(a,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&t.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cs.{${o.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(o)}`),this}containedBy(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cd.{${o.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(o)}`),this}rangeGt(a,o){return this.url.searchParams.append(a,`sr.${o}`),this}rangeGte(a,o){return this.url.searchParams.append(a,`nxl.${o}`),this}rangeLt(a,o){return this.url.searchParams.append(a,`sl.${o}`),this}rangeLte(a,o){return this.url.searchParams.append(a,`nxr.${o}`),this}rangeAdjacent(a,o){return this.url.searchParams.append(a,`adj.${o}`),this}overlaps(a,o){return typeof o=="string"?this.url.searchParams.append(a,`ov.${o}`):this.url.searchParams.append(a,`ov.{${o.join(",")}}`),this}textSearch(a,o,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const m=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${m}.${o}`),this}match(a){return Object.entries(a).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(a,o,l){return this.url.searchParams.append(a,`not.${o}.${l}`),this}or(a,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,o,l){return this.url.searchParams.append(a,`${o}.${l}`),this}}return bp.default=r,bp}var yP;function b4(){if(yP)return vp;yP=1,Object.defineProperty(vp,"__esModule",{value:!0});const e=If.__importDefault(YN());class t{constructor(s,{headers:a={},schema:o,fetch:l}){this.url=s,this.headers=new Headers(a),this.schema=o,this.fetch=l}select(s,a){const{head:o=!1,count:l}=a??{},c=o?"HEAD":"GET";let d=!1;const m=(s??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",m),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:a,defaultToNull:o=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((m,p)=>m.concat(Object.keys(p)),[]);if(d.length>0){const m=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(s,{onConflict:a,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var d;const m="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const p=s.reduce((x,v)=>x.concat(Object.keys(v)),[]);if(p.length>0){const x=[...new Set(p)].map(v=>`"${v}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(s,{count:a}={}){var o;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var a;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return vp.default=t,vp}var vP;function zz(){if(vP)return yp;vP=1,Object.defineProperty(yp,"__esModule",{value:!0});const n=If,e=n.__importDefault(b4()),t=n.__importDefault(YN());class r{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new r(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:d}={}){var m;let p;const x=new URL(`${this.url}/rpc/${a}`);let v;l||c?(p=l?"HEAD":"GET",Object.entries(o).filter(([w,j])=>j!==void 0).map(([w,j])=>[w,Array.isArray(j)?`{${j.join(",")}}`:`${j}`]).forEach(([w,j])=>{x.searchParams.append(w,j)})):(p="POST",v=o);const _=new Headers(this.headers);return d&&_.set("Prefer",`count=${d}`),new t.default({method:p,url:x,headers:_,schema:this.schemaName,body:v,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return yp.default=r,yp}var bP;function Uz(){if(bP)return es;bP=1,Object.defineProperty(es,"__esModule",{value:!0}),es.PostgrestError=es.PostgrestBuilder=es.PostgrestTransformBuilder=es.PostgrestFilterBuilder=es.PostgrestQueryBuilder=es.PostgrestClient=void 0;const n=If,e=n.__importDefault(zz());es.PostgrestClient=e.default;const t=n.__importDefault(b4());es.PostgrestQueryBuilder=t.default;const r=n.__importDefault(YN());es.PostgrestFilterBuilder=r.default;const s=n.__importDefault(v4());es.PostgrestTransformBuilder=s.default;const a=n.__importDefault(y4());es.PostgrestBuilder=a.default;const o=n.__importDefault(x4());return es.PostgrestError=o.default,es.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:a.default,PostgrestError:o.default},es}var _4=Uz();const w4=hu(_4),Vz=TL({__proto__:null,default:w4},[_4]),{PostgrestClient:Bz,PostgrestQueryBuilder:jue,PostgrestFilterBuilder:Nue,PostgrestTransformBuilder:Cue,PostgrestBuilder:Tue,PostgrestError:Pue}=w4||Vz;class Wz{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const $z="2.81.1",Hz=`realtime-js/${$z}`,S4="1.0.0",Yz="2.0.0",_P=S4,Oj=1e4,Gz=1e3,Zz=100;var Kd;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Kd||(Kd={}));var jr;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(jr||(jr={}));var qi;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(qi||(qi={}));var Ij;(function(n){n.websocket="websocket"})(Ij||(Ij={}));var Jd;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Jd||(Jd={}));class Kz{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(e,t){if(this._isArrayBuffer(e.payload))return t(this._binaryEncodePush(e));if(e.event===this.BROADCAST&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodePush(e){const{join_ref:t,ref:r,event:s,topic:a,payload:o}=e,l=this.META_LENGTH+t.length+r.length+a.length+s.length,c=new ArrayBuffer(this.HEADER_LENGTH+l);let d=new DataView(c),m=0;d.setUint8(m++,this.KINDS.push),d.setUint8(m++,t.length),d.setUint8(m++,r.length),d.setUint8(m++,a.length),d.setUint8(m++,s.length),Array.from(t,x=>d.setUint8(m++,x.charCodeAt(0))),Array.from(r,x=>d.setUint8(m++,x.charCodeAt(0))),Array.from(a,x=>d.setUint8(m++,x.charCodeAt(0))),Array.from(s,x=>d.setUint8(m++,x.charCodeAt(0)));var p=new Uint8Array(c.byteLength+o.byteLength);return p.set(new Uint8Array(c),0),p.set(new Uint8Array(o),c.byteLength),p.buffer}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const{join_ref:s,ref:a,topic:o}=e,l=e.payload.event,c=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:new ArrayBuffer(0),d=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+o.length+l.length,m=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(m),x=0;p.setUint8(x++,this.KINDS.userBroadcastPush),p.setUint8(x++,s.length),p.setUint8(x++,a.length),p.setUint8(x++,o.length),p.setUint8(x++,l.length),p.setUint8(x++,this.BINARY_ENCODING),Array.from(s,_=>p.setUint8(x++,_.charCodeAt(0))),Array.from(a,_=>p.setUint8(x++,_.charCodeAt(0))),Array.from(o,_=>p.setUint8(x++,_.charCodeAt(0))),Array.from(l,_=>p.setUint8(x++,_.charCodeAt(0)));var v=new Uint8Array(m.byteLength+c.byteLength);return v.set(new Uint8Array(m),0),v.set(new Uint8Array(c),m.byteLength),v.buffer}_encodeJsonUserBroadcastPush(e){var t,r;const{join_ref:s,ref:a,topic:o}=e,l=e.payload.event,c=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:{},m=new TextEncoder().encode(JSON.stringify(c)).buffer,p=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+o.length+l.length,x=new ArrayBuffer(this.HEADER_LENGTH+p);let v=new DataView(x),_=0;v.setUint8(_++,this.KINDS.userBroadcastPush),v.setUint8(_++,s.length),v.setUint8(_++,a.length),v.setUint8(_++,o.length),v.setUint8(_++,l.length),v.setUint8(_++,this.JSON_ENCODING),Array.from(s,j=>v.setUint8(_++,j.charCodeAt(0))),Array.from(a,j=>v.setUint8(_++,j.charCodeAt(0))),Array.from(o,j=>v.setUint8(_++,j.charCodeAt(0))),Array.from(l,j=>v.setUint8(_++,j.charCodeAt(0)));var w=new Uint8Array(x.byteLength+m.byteLength);return w.set(new Uint8Array(x),0),w.set(new Uint8Array(m),x.byteLength),w.buffer}decode(e,t){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return t(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,a,o,l,c]=r;return t({join_ref:s,ref:a,topic:o,event:l,payload:c})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.push:return this._decodePush(e,t,s);case this.KINDS.reply:return this._decodeReply(e,t,s);case this.KINDS.broadcast:return this._decodeBroadcast(e,t,s);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,s)}}_decodePush(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3);let l=this.HEADER_LENGTH+this.META_LENGTH-1;const c=r.decode(e.slice(l,l+s));l=l+s;const d=r.decode(e.slice(l,l+a));l=l+a;const m=r.decode(e.slice(l,l+o));l=l+o;const p=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{join_ref:c,ref:null,topic:d,event:m,payload:p}}_decodeReply(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+this.META_LENGTH;const d=r.decode(e.slice(c,c+s));c=c+s;const m=r.decode(e.slice(c,c+a));c=c+a;const p=r.decode(e.slice(c,c+o));c=c+o;const x=r.decode(e.slice(c,c+l));c=c+l;const v=JSON.parse(r.decode(e.slice(c,e.byteLength))),_={status:x,response:v};return{join_ref:d,ref:m,topic:p,event:qi.reply,payload:_}}_decodeBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+s));o=o+s;const c=r.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{join_ref:null,ref:null,topic:l,event:c,payload:d}}_decodeUserBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+4;const d=r.decode(e.slice(c,c+s));c=c+s;const m=r.decode(e.slice(c,c+a));c=c+a;const p=r.decode(e.slice(c,c+o));c=c+o;const x=e.slice(c,e.byteLength),v=l===this.JSON_ENCODING?JSON.parse(r.decode(x)):x,_={type:this.BROADCAST,event:m,payload:v};return o>0&&(_.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST,payload:_}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}}class j4{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var On;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(On||(On={}));const wP=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((a,o)=>(a[o]=Jz(o,n,e,s),a),{}):{}},Jz=(n,e,t,r)=>{const s=e.find(l=>l.name===n),a=s?.type,o=t[n];return a&&!r.includes(a)?N4(a,o):Aj(o)},N4=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return tU(e,t)}switch(n){case On.bool:return Qz(e);case On.float4:case On.float8:case On.int2:case On.int4:case On.int8:case On.numeric:case On.oid:return Xz(e);case On.json:case On.jsonb:return eU(e);case On.timestamp:return nU(e);case On.abstime:case On.date:case On.daterange:case On.int4range:case On.int8range:case On.money:case On.reltime:case On.text:case On.time:case On.timestamptz:case On.timetz:case On.tsrange:case On.tstzrange:return Aj(e);default:return Aj(e)}},Aj=n=>n,Qz=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Xz=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},eU=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},tU=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let a;const o=n.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>N4(e,l))}return n},nU=n=>typeof n=="string"?n.replace(" ","T"):n,C4=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class qv{constructor(e,t,r={},s=Oj){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var SP;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(SP||(SP={}));class Uh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Uh.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=Uh.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Uh.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const a=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(a,(d,m)=>{o[d]||(c[d]=m)}),this.map(o,(d,m)=>{const p=a[d];if(p){const x=m.map(j=>j.presence_ref),v=p.map(j=>j.presence_ref),_=m.filter(j=>v.indexOf(j.presence_ref)<0),w=p.filter(j=>x.indexOf(j.presence_ref)<0);_.length>0&&(l[d]=_),w.length>0&&(c[d]=w)}else l[d]=m}),this.syncDiff(a,{joins:l,leaves:c},r,s)}static syncDiff(e,t,r,s){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var d;const m=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),m.length>0){const p=e[l].map(v=>v.presence_ref),x=m.filter(v=>p.indexOf(v.presence_ref)<0);e[l].unshift(...x)}r(l,m,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const m=c.map(p=>p.presence_ref);d=d.filter(p=>m.indexOf(p.presence_ref)<0),e[l]=d,s(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var jP;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(jP||(jP={}));var Vh;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Vh||(Vh={}));var ul;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(ul||(ul={}));class GN{constructor(e,t={config:{}},r){var s,a;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=jr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new qv(this,qi.join,this.params,this.timeout),this.rejoinTimer=new j4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jr.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=jr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=jr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(qi.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Uh(this),this.broadcastEndpointURL=C4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==jr.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(v=>v.filter))!==null&&s!==void 0?s:[],m=!!this.bindings[Vh.PRESENCE]&&this.bindings[Vh.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,p={},x={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:m}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(ul.CHANNEL_ERROR,v)),this._onClose(()=>e?.(ul.CLOSED)),this.updateJoinPayload(Object.assign({config:x},p)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var _;if(this.socket.setAuth(),v===void 0){e?.(ul.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,j=(_=w?.length)!==null&&_!==void 0?_:0,P=[];for(let k=0;k<j;k++){const I=w[k],{filter:{event:M,schema:D,table:O,filter:q}}=I,F=v&&v[k];if(F&&F.event===M&&F.schema===D&&F.table===O&&F.filter===q)P.push(Object.assign(Object.assign({},I),{id:F.id}));else{this.unsubscribe(),this.state=jr.errored,e?.(ul.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=P,e&&e(ul.SUBSCRIBED);return}}).receive("error",v=>{this.state=jr.errored,e?.(ul.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(ul.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===jr.joined&&e===Vh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var s;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=jr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(qi.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new qv(this,qi.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=jr.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,a=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new qv(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Zz){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:m}=qi;if(r&&[l,c,d,m].indexOf(o)>=0&&r!==this._joinRef())return;let x=this._onMessage(o,t,r);if(t&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var _,w,j;return((_=v.filter)===null||_===void 0?void 0:_.event)==="*"||((j=(w=v.filter)===null||w===void 0?void 0:w.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===o}).map(v=>v.callback(x,r)):(a=this.bindings[o])===null||a===void 0||a.filter(v=>{var _,w,j,P,k,I;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const M=v.id,D=(_=v.filter)===null||_===void 0?void 0:_.event;return M&&((w=t.ids)===null||w===void 0?void 0:w.includes(M))&&(D==="*"||D?.toLocaleLowerCase()===((j=t.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const M=(k=(P=v?.filter)===null||P===void 0?void 0:P.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return M==="*"||M===((I=t?.event)===null||I===void 0?void 0:I.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof x=="object"&&"ids"in x){const _=x.data,{schema:w,table:j,commit_timestamp:P,type:k,errors:I}=_;x=Object.assign(Object.assign({},{schema:w,table:j,commit_timestamp:P,eventType:k,new:{},old:{},errors:I}),this._getPayloadRecords(_))}v.callback(x,r)})}_isClosed(){return this.state===jr.closed}_isJoined(){return this.state===jr.joined}_isJoining(){return this.state===jr.joining}_isLeaving(){return this.state===jr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&GN.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(qi.close,{},e)}_onError(e){this._on(qi.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=wP(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=wP(e.columns,e.old_record)),t}}const zv=()=>{},jp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},rU=[1e3,2e3,5e3,1e4],sU=1e4,iU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class aU{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Oj,this.transport=null,this.heartbeatIntervalMs=jp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=zv,this.ref=0,this.reconnectTimer=null,this.vsn=_P,this.logger=zv,this.conn=null,this.sendBuffer=[],this.serializer=new Kz,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Ij.websocket}`,this.httpEndpoint=C4(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Wz.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Kd.connecting:return Jd.Connecting;case Kd.open:return Jd.Open;case Kd.closing:return Jd.Closing;default:return Jd.Closed}}isConnected(){return this.connectionState()===Jd.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(a=>a.topic===r);if(s)return s;{const a=new GN(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:r,payload:s,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${r} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Gz,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},jp.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:a,ref:o}=t,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${r} ${s} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(s,a,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Kd.open||this.conn.readyState===Kd.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(qi.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([iU],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:Hz};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(qi.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new j4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},jp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,a,o,l,c,d,m,p,x,v;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:Oj,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:jp.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:zv,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:_P,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(_=>rU[_-1]||sU),this.vsn){case S4:this.encode=(m=e?.encode)!==null&&m!==void 0?m:((_,w)=>w(JSON.stringify(_))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:((_,w)=>w(JSON.parse(_)));break;case Yz:this.encode=(x=e?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(v=e?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class ZN extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Zn(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class oU extends ZN{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Rj extends ZN{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const KN=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),lU=()=>Response,Lj=n=>{if(Array.isArray(n))return n.map(t=>Lj(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[s]=Lj(r)}),e},cU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Uv=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},dU=(n,e,t)=>yt(void 0,void 0,void 0,function*(){const r=yield lU();n instanceof r&&!t?.noResolveJson?n.json().then(s=>{const a=n.status||500,o=s?.statusCode||a+"";e(new oU(Uv(s),a,o))}).catch(s=>{e(new Rj(Uv(s),s))}):e(new Rj(Uv(n),n))}),uU=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||!r?s:(cU(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,e?.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function gm(n,e,t,r,s,a){return yt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,uU(e,r,s,a)).then(c=>{if(!c.ok)throw c;return r?.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>dU(c,l,r))})})}function Qh(n,e,t,r){return yt(this,void 0,void 0,function*(){return gm(n,"GET",e,t,r)})}function ga(n,e,t,r,s){return yt(this,void 0,void 0,function*(){return gm(n,"POST",e,r,s,t)})}function Fj(n,e,t,r,s){return yt(this,void 0,void 0,function*(){return gm(n,"PUT",e,r,s,t)})}function fU(n,e,t,r){return yt(this,void 0,void 0,function*(){return gm(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function JN(n,e,t,r,s){return yt(this,void 0,void 0,function*(){return gm(n,"DELETE",e,r,s,t)})}class hU{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return yt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Zn(e))return{data:null,error:e};throw e}})}}var T4;class mU{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[T4]="BlobDownloadBuilder",this.promise=null}asStream(){return new hU(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return yt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Zn(e))return{data:null,error:e};throw e}})}}T4=Symbol.toStringTag;const pU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},NP={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class gU{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=KN(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return yt(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},NP),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),s?.headers&&(l=Object.assign(Object.assign({},l),s.headers));const d=this._removeEmptyFolders(t),m=this._getFinalPath(d),p=yield(e=="PUT"?Fj:ga)(this.fetch,`${this.url}/object/${m}`,a,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Zn(a))return{data:null,error:a};throw a}})}upload(e,t,r){return yt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return yt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:NP.upsert},s),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,m["cache-control"]=`max-age=${d.cacheControl}`,m["content-type"]=d.contentType);const p=yield Fj(this.fetch,l.toString(),c,{headers:m});return{data:{path:a,fullPath:p.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Zn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return yt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");const a=yield ga(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new ZN("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zn(r))return{data:null,error:r};throw r}})}update(e,t,r){return yt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return yt(this,void 0,void 0,function*(){try{return{data:yield ga(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Zn(s))return{data:null,error:s};throw s}})}copy(e,t,r){return yt(this,void 0,void 0,function*(){try{return{data:{path:(yield ga(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Zn(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return yt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),a=yield ga(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Zn(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return yt(this,void 0,void 0,function*(){try{const s=yield ga(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Zn(s))return{data:null,error:s};throw s}})}download(e,t){const s=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),o=a?`?${a}`:"",l=this._getFinalPath(e),c=()=>Qh(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new mU(c,this.shouldThrowOnError)}info(e){return yt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Qh(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Lj(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zn(r))return{data:null,error:r};throw r}})}exists(e){return yt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield fU(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zn(r)&&r instanceof Rj){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return yt(this,void 0,void 0,function*(){try{return{data:yield JN(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Zn(t))return{data:null,error:t};throw t}})}list(e,t,r){return yt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},pU),t),{prefix:e||""});return{data:yield ga(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Zn(s))return{data:null,error:s};throw s}})}listV2(e,t){return yt(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield ga(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zn(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const P4="2.81.1",M4={"X-Client-Info":`storage-js/${P4}`};class xU{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},M4),t),this.fetch=KN(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return yt(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield Qh(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Zn(t))return{data:null,error:t};throw t}})}getBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:yield Qh(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Zn(t))return{data:null,error:t};throw t}})}createBucket(e){return yt(this,arguments,void 0,function*(t,r={public:!1}){try{return{data:yield ga(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Zn(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return yt(this,void 0,void 0,function*(){try{return{data:yield Fj(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:yield ga(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Zn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:yield JN(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Zn(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}class yU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},M4),t),this.fetch=KN(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:yield ga(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Zn(t))return{data:null,error:t};throw t}})}listBuckets(e){return yt(this,void 0,void 0,function*(){try{const t=new URLSearchParams;e?.limit!==void 0&&t.set("limit",e.limit.toString()),e?.offset!==void 0&&t.set("offset",e.offset.toString()),e?.sortColumn&&t.set("sortColumn",e.sortColumn),e?.sortOrder&&t.set("sortOrder",e.sortOrder),e?.search&&t.set("search",e.search);const r=t.toString(),s=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield Qh(this.fetch,s,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Zn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:yield JN(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Zn(t))return{data:null,error:t};throw t}})}}const QN={"X-Client-Info":`storage-js/${P4}`,"Content-Type":"application/json"};class k4 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function li(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}class Vv extends k4{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class vU extends k4{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var CP;(function(n){n.InternalError="InternalError",n.S3VectorConflictException="S3VectorConflictException",n.S3VectorNotFoundException="S3VectorNotFoundException",n.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",n.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",n.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(CP||(CP={}));const XN=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),bU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},TP=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),_U=(n,e,t)=>yt(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!t?.noResolveJson){const s=n.status||500,a=n;if(typeof a.json=="function")a.json().then(o=>{const l=o?.statusCode||o?.code||s+"";e(new Vv(TP(o),s,l))}).catch(()=>{const o=s+"",l=a.statusText||`HTTP ${s} error`;e(new Vv(l,s,o))});else{const o=s+"",l=a.statusText||`HTTP ${s} error`;e(new Vv(l,s,o))}}else e(new vU(TP(n),n))}),wU=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return r?(bU(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,Object.assign(Object.assign({},s),t)):s};function SU(n,e,t,r,s,a){return yt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,wU(e,r,s,a)).then(c=>{if(!c.ok)throw c;if(r?.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>_U(c,l,r))})})}function ci(n,e,t,r,s){return yt(this,void 0,void 0,function*(){return SU(n,"POST",e,r,s,t)})}class jU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},QN),t),this.fetch=XN(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return yt(this,void 0,void 0,function*(){try{return{data:(yield ci(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}getIndex(e,t){return yt(this,void 0,void 0,function*(){try{return{data:yield ci(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(li(r))return{data:null,error:r};throw r}})}listIndexes(e){return yt(this,void 0,void 0,function*(){try{return{data:yield ci(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return yt(this,void 0,void 0,function*(){try{return{data:(yield ci(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(li(r))return{data:null,error:r};throw r}})}}class NU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},QN),t),this.fetch=XN(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return yt(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield ci(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}getVectors(e){return yt(this,void 0,void 0,function*(){try{return{data:yield ci(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}listVectors(e){return yt(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield ci(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}queryVectors(e){return yt(this,void 0,void 0,function*(){try{return{data:yield ci(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}deleteVectors(e){return yt(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield ci(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}}class CU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},QN),t),this.fetch=XN(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:(yield ci(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}getBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:yield ci(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}listBuckets(){return yt(this,arguments,void 0,function*(e={}){try{return{data:yield ci(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}deleteBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:(yield ci(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(li(t))return{data:null,error:t};throw t}})}}class TU extends CU{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new PU(this.url,this.headers,e,this.fetch)}}class PU extends jU{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return yt(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return yt(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return yt(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return yt(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new MU(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class MU extends NU{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return yt(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return yt(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return yt(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return yt(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return yt(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class kU extends xU{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new gU(this.url,this.headers,e,this.fetch)}get vectors(){return new TU(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new yU(this.url+"/iceberg",this.headers,this.fetch)}}const EU="2.81.1";let Oh="";typeof Deno<"u"?Oh="deno":typeof document<"u"?Oh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Oh="react-native":Oh="node";const DU={"X-Client-Info":`supabase-js-${Oh}/${EU}`},OU={headers:DU},IU={schema:"public"},AU={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},RU={},LU=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),FU=()=>Headers,qU=(n,e,t)=>{const r=LU(t),s=FU();return async(a,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:n;let d=new s(o?.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(a,Object.assign(Object.assign({},o),{headers:d}))}};function zU(n){return n.endsWith("/")?n:n+"/"}function UU(n,e){var t,r;const{db:s,auth:a,realtime:o,global:l}=n,{db:c,auth:d,realtime:m,global:p}=e,x={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},m),o),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(t=p?.headers)!==null&&t!==void 0?t:{}),(r=l?.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return n.accessToken?x.accessToken=n.accessToken:delete x.accessToken,x}function VU(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(zU(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const E4="2.81.1",ef=30*1e3,qj=3,Bv=qj*ef,BU="http://localhost:9999",WU="supabase.auth.token",$U={"X-Client-Info":`gotrue-js/${E4}`},zj="X-Supabase-Api-Version",D4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},HU=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,YU=600*1e3;class Xh extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function bt(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class GU extends Xh{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function ZU(n){return bt(n)&&n.name==="AuthApiError"}class Qd extends Xh{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class $c extends Xh{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class ma extends $c{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function KU(n){return bt(n)&&n.name==="AuthSessionMissingError"}class Uu extends $c{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Np extends $c{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Cp extends $c{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function JU(n){return bt(n)&&n.name==="AuthImplicitGrantRedirectError"}class PP extends $c{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Uj extends $c{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Wv(n){return bt(n)&&n.name==="AuthRetryableFetchError"}class MP extends $c{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Vj extends $c{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const sx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),kP=` 	
\r=`.split(""),QU=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<kP.length;e+=1)n[kP[e].charCodeAt(0)]=-2;for(let e=0;e<sx.length;e+=1)n[sx[e].charCodeAt(0)]=e;return n})();function EP(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(sx[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(sx[r]),e.queuedBits-=6}}function O4(n,e,t){const r=QU[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function DP(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{tV(o,r,t)};for(let o=0;o<n.length;o+=1)O4(n.charCodeAt(o),s,a);return e.join("")}function XU(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function eV(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}XU(r,e)}}function tV(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function lf(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)O4(n.charCodeAt(s),t,r);return new Uint8Array(e)}function nV(n){const e=[];return eV(n,t=>e.push(t)),new Uint8Array(e)}function Xd(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>EP(s,t,r)),EP(null,t,r),e.join("")}function rV(n){return Math.round(Date.now()/1e3)+n}function sV(){return Symbol("auth-callback")}const Br=()=>typeof window<"u"&&typeof document<"u",Rd={tested:!1,writable:!1},I4=()=>{if(!Br())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Rd.tested)return Rd.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Rd.tested=!0,Rd.writable=!0}catch{Rd.tested=!0,Rd.writable=!1}return Rd.writable};function iV(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,a)=>{e[a]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const A4=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),aV=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",tf=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Ld=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},vc=async(n,e)=>{await n.removeItem(e)};class Lx{constructor(){this.promise=new Lx.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Lx.promiseConstructor=Promise;function $v(n){const e=n.split(".");if(e.length!==3)throw new Vj("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!HU.test(e[r]))throw new Vj("JWT not in base64url format");return{header:JSON.parse(DP(e[0])),payload:JSON.parse(DP(e[1])),signature:lf(e[2]),raw:{header:e[0],payload:e[1]}}}async function oV(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function lV(n,e){return new Promise((r,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await n(a);if(!e(a,null,o)){r(o);return}}catch(o){if(!e(a,o)){s(o);return}}})()})}function cV(n){return("0"+n.toString(16)).substr(-2)}function dV(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let a=0;a<56;a++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,cV).join("")}async function uV(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function fV(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await uV(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Vu(n,e,t=!1){const r=dV();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await tf(n,`${e}-code-verifier`,s);const a=await fV(r);return[a,r===a?"plain":"s256"]}const hV=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function mV(n){const e=n.headers.get(zj);if(!e||!e.match(hV))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function pV(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function gV(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const xV=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Bu(n){if(!xV.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Hv(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function yV(n,e){return new Proxy(n,{get:(t,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,r,s)}})}function OP(n){return JSON.parse(JSON.stringify(n))}const Hd=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),vV=[502,503,504];async function IP(n){var e;if(!aV(n))throw new Uj(Hd(n),0);if(vV.includes(n.status))throw new Uj(Hd(n),n.status);let t;try{t=await n.json()}catch(a){throw new Qd(Hd(a),a)}let r;const s=mV(n);if(s&&s.getTime()>=D4["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new MP(Hd(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ma}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new MP(Hd(t),n.status,t.weak_password.reasons);throw new GU(Hd(t),n.status||500,r)}const bV=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function Et(n,e,t,r){var s;const a=Object.assign({},r?.headers);a[zj]||(a[zj]=D4["2024-01-01"].name),r?.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const o=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await _V(n,e,t+l,{headers:a,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(c):{data:Object.assign({},c),error:null}}async function _V(n,e,t,r,s,a){const o=bV(e,r,s,a);let l;try{l=await n(t,Object.assign({},o))}catch(c){throw console.error(c),new Uj(Hd(c),0)}if(l.ok||await IP(l),r?.noResolveJson)return l;try{return await l.json()}catch(c){await IP(c)}}function pa(n){var e;let t=null;jV(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=rV(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function AP(n){const e=pa(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Pc(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function wV(n){return{data:n,error:null}}function SV(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a}=n,o=Of(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function RP(n){return n}function jV(n){return n.access_token&&n.refresh_token&&n.expires_in}const Yv=["global","local","others"];class NV{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=A4(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Yv[0]){if(Yv.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Yv.join(", ")}`);try{return await Et(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(bt(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Et(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Pc})}catch(r){if(bt(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Of(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await Et(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:SV,redirectTo:t?.redirectTo})}catch(t){if(bt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Et(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Pc})}catch(t){if(bt(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},m=await Et(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:RP});if(m.error)throw m.error;const p=await m.json(),x=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(c=(l=m.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(_.split(";")[1].split("=")[1]);d[`${j}Page`]=w}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(bt(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Bu(e);try{return await Et(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Pc})}catch(t){if(bt(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Bu(e);try{return await Et(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Pc})}catch(r){if(bt(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Bu(e);try{return await Et(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Pc})}catch(r){if(bt(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Bu(e.userId);try{const{data:t,error:r}=await Et(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(bt(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Bu(e.userId),Bu(e.id);try{return{data:await Et(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(bt(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},m=await Et(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:RP});if(m.error)throw m.error;const p=await m.json(),x=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(c=(l=m.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(_.split(";")[1].split("=")[1]);d[`${j}Page`]=w}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(bt(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await Et(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(bt(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Et(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(bt(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Et(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(bt(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await Et(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(bt(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Et(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(bt(t))return{data:null,error:t};throw t}}}function LP(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Wu={debug:!!(globalThis&&I4()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class R4 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class CV extends R4{}async function TV(n,e,t){Wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Wu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new CV(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Wu.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function PV(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function L4(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function MV(n){return parseInt(n,16)}function kV(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function EV(n){var e;const{chainId:t,domain:r,expirationTime:s,issuedAt:a=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:m,uri:p,version:x}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const v=L4(n.address),_=m?`${m}://${r}`:r,w=n.statement?`${n.statement}
`:"",j=`${_} wants you to sign in with your Ethereum account:
${v}

${w}`;let P=`URI: ${p}
Version: ${x}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(s&&(P+=`
Expiration Time: ${s.toISOString()}`),l&&(P+=`
Not Before: ${l.toISOString()}`),c&&(P+=`
Request ID: ${c}`),d){let k=`
Resources:`;for(const I of d){if(!I||typeof I!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${I}`);k+=`
- ${I}`}P+=k}return`${j}
${P}`}class mr extends Error{constructor({message:e,code:t,cause:r,name:s}){var a;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(a=s??(r instanceof Error?r.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=t}}class ix extends mr{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function DV({error:n,options:e}){var t,r,s;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new mr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=a.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new mr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((r=a.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new mr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new mr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new mr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new mr({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new mr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new mr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(F4(o)){if(a.rp.id!==o)return new mr({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new mr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new mr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new mr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new mr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function OV({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new mr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new mr({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const r=window.location.hostname;if(F4(r)){if(t.rpId!==r)return new mr({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new mr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new mr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new mr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class IV{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const AV=new IV;function RV(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:r}=n,s=Of(n,["challenge","user","excludeCredentials"]),a=lf(e).buffer,o=Object.assign(Object.assign({},t),{id:lf(t.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:a,user:o});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const d=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:lf(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function LV(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,r=Of(n,["challenge","allowCredentials"]),s=lf(e).buffer,a=Object.assign(Object.assign({},r),{challenge:s});if(t&&t.length>0){a.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const l=t[o];a.allowCredentials[o]=Object.assign(Object.assign({},l),{id:lf(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function FV(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Xd(new Uint8Array(n.response.attestationObject)),clientDataJSON:Xd(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function qV(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,r=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Xd(new Uint8Array(s.authenticatorData)),clientDataJSON:Xd(new Uint8Array(s.clientDataJSON)),signature:Xd(new Uint8Array(s.signature)),userHandle:s.userHandle?Xd(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function F4(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function FP(){var n,e;return!!(Br()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function zV(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ix("Browser returned unexpected credential type",e)}:{data:null,error:new ix("Empty credential response",e)}}catch(e){return{data:null,error:DV({error:e,options:n})}}}async function UV(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ix("Browser returned unexpected credential type",e)}:{data:null,error:new ix("Empty credential response",e)}}catch(e){return{data:null,error:OV({error:e,options:n})}}}const VV={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},BV={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ax(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of n)if(s)for(const a in s){const o=s[a];if(o!==void 0)if(Array.isArray(o))r[a]=o;else if(t(o))r[a]=o;else if(e(o)){const l=r[a];e(l)?r[a]=ax(l,o):r[a]=ax(o)}else r[a]=o}return r}function WV(n,e){return ax(VV,n,e||{})}function $V(n,e){return ax(BV,n,e||{})}class HV{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},a){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:l};const c=s??AV.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=WV(o.webauthn.credential_options.publicKey,a?.create),{data:m,error:p}=await zV({publicKey:d,signal:c});return m?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:m}},error:null}:{data:null,error:p}}case"request":{const d=$V(o.webauthn.credential_options.publicKey,a?.request),{data:m,error:p}=await UV(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:c}));return m?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:m}},error:null}:{data:null,error:p}}}}catch(o){return bt(o)?{data:null,error:o}:{data:null,error:new Qd("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new Xh("rpId is required for WebAuthn authentication")};try{if(!FP())return{data:null,error:new Qd("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:a});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:r,credential_response:c.credential_response}})}catch(o){return bt(o)?{data:null,error:o}:{data:null,error:new Qd("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new Xh("rpId is required for WebAuthn registration")};try{if(!FP())return{data:null,error:new Qd("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(m=>{var p;return(p=m.data)===null||p===void 0?void 0:p.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:a});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return bt(o)?{data:null,error:o}:{data:null,error:new Qd("Unexpected error in register",o)}}}}PV();const YV={url:BU,storageKey:WU,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:$U,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function qP(n,e,t){return await t()}const $u={};class em{get jwks(){var e,t;return(t=(e=$u[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){$u[this.storageKey]=Object.assign(Object.assign({},$u[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=$u[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){$u[this.storageKey]=Object.assign(Object.assign({},$u[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},YV),e);if(this.storageKey=a.storageKey,this.instanceID=(t=em.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,em.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&Br()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new NV({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=A4(a.fetch),this.lock=a.lock||qP,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:Br()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=TV:this.lock=qP,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new HV(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:I4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=LP(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=LP(this.memoryStorage)),Br()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${E4}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},r="none";if(Br()&&(t=iV(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),Br()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),JU(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return bt(t)?this._returnResult({error:t}):this._returnResult({error:new Qd("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const a=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:pa}),{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(bt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,r,s;try{let a;if("email"in e){const{email:m,password:p,options:x}=e;let v=null,_=null;this.flowType==="pkce"&&([v,_]=await Vu(this.storage,this.storageKey)),a=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:m,password:p,data:(t=x?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:v,code_challenge_method:_},xform:pa})}else if("phone"in e){const{phone:m,password:p,options:x}=e;a=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:p,data:(r=x?.data)!==null&&r!==void 0?r:{},channel:(s=x?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:pa})}else throw new Np("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(bt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:l}=e;t=await Et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:AP})}else if("phone"in e){const{phone:a,password:o,options:l}=e;t=await Et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:AP})}else throw new Np("You must provide either an email or phone number and a password");const{data:r,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const a=new Uu;return this._returnResult({data:{user:null,session:null},error:a})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(bt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,a,o,l,c,d,m,p,x;let v,_;if("message"in e)v=e.message,_=e.signature;else{const{chain:w,wallet:j,statement:P,options:k}=e;let I;if(Br())if(typeof j=="object")I=j;else{const U=window;if("ethereum"in U&&typeof U.ethereum=="object"&&"request"in U.ethereum&&typeof U.ethereum.request=="function")I=U.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!k?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");I=j}const M=new URL((t=k?.url)!==null&&t!==void 0?t:window.location.href),D=await I.request({method:"eth_requestAccounts"}).then(U=>U).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!D||D.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const O=L4(D[0]);let q=(r=k?.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!q){const U=await I.request({method:"eth_chainId"});q=MV(U)}const F={domain:M.host,address:O,statement:P,uri:M.href,version:"1",chainId:q,nonce:(s=k?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(a=k?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=k?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=k?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=k?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(m=k?.signInWithEthereum)===null||m===void 0?void 0:m.resources};v=EV(F),_=await I.request({method:"personal_sign",params:[kV(v),O]})}try{const{data:w,error:j}=await Et(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:_},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:pa});if(j)throw j;if(!w||!w.session||!w.user){const P=new Uu;return this._returnResult({data:{user:null,session:null},error:P})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:j})}catch(w){if(bt(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var t,r,s,a,o,l,c,d,m,p,x,v;let _,w;if("message"in e)_=e.message,w=e.signature;else{const{chain:j,wallet:P,statement:k,options:I}=e;let M;if(Br())if(typeof P=="object")M=P;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))M=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof P!="object"||!I?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=P}const D=new URL((t=I?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in M&&M.signIn){const O=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},I?.signInWithSolana),{version:"1",domain:D.host,uri:D.href}),k?{statement:k}:null));let q;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")q=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)q=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in q&&"signature"in q&&(typeof q.signedMessage=="string"||q.signedMessage instanceof Uint8Array)&&q.signature instanceof Uint8Array)_=typeof q.signedMessage=="string"?q.signedMessage:new TextDecoder().decode(q.signedMessage),w=q.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${D.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${D.href}`,`Issued At: ${(s=(r=I?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=I?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${I.signInWithSolana.notBefore}`]:[],...!((o=I?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${I.signInWithSolana.expirationTime}`]:[],...!((l=I?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${I.signInWithSolana.chainId}`]:[],...!((c=I?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${I.signInWithSolana.nonce}`]:[],...!((d=I?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${I.signInWithSolana.requestId}`]:[],...!((p=(m=I?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||p===void 0)&&p.length?["Resources",...I.signInWithSolana.resources.map(q=>`- ${q}`)]:[]].join(`
`);const O=await M.signMessage(new TextEncoder().encode(_),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=O}}try{const{data:j,error:P}=await Et(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:Xd(w)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:pa});if(P)throw P;if(!j||!j.session||!j.user){const k=new Uu;return this._returnResult({data:{user:null,session:null},error:k})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:P})}catch(j){if(bt(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async _exchangeCodeForSession(e){const t=await Ld(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:a,error:o}=await Et(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:pa});if(await vc(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const l=new Uu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(bt(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:a,nonce:o}=e,l=await Et(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:pa}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const m=new Uu;return this._returnResult({data:{user:null,session:null},error:m})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(t){if(bt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,s,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,m=null;this.flowType==="pkce"&&([d,m]=await Vu(this.storage,this.storageKey));const{error:p}=await Et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c?.data)!==null&&t!==void 0?t:{},create_user:(r=c?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:m},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:m}=await Et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(a=c?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(o=c?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:m})}throw new Np("You must provide either an email or phone number.")}catch(l){if(bt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,r;try{let s,a;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await Et(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:pa});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(bt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,r,s,a,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Vu(this.storage,this.storageKey));const d=await Et(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:wV});return!((a=d.data)===null||a===void 0)&&a.url&&Br()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(bt(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ma;const{error:s}=await Et(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(bt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:a}=e,{error:o}=await Et(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:s,options:a}=e,{data:o,error:l}=await Et(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new Np("You must provide either an email or phone number and a type")}catch(t){if(bt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ld(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Bv:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Ld(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Hv()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=yV(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Pc}):await this._useSession(async t=>{var r,s,a;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ma}:await Et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Pc})})}catch(t){if(bt(t))return KU(t)&&(await this._removeSession(),await vc(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new ma;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Vu(this.storage,this.storageKey));const{data:d,error:m}=await Et(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Pc});if(m)throw m;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(bt(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ma;const t=Date.now()/1e3;let r=t,s=!0,a=null;const{payload:o}=$v(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(bt(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new ma;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(bt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Br())throw new Cp("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Cp(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new PP("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Cp("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new PP("No code detected.");const{data:k,error:I}=await this._exchangeCodeForSession(e.code);if(I)throw I;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new Cp("No session defined in URL");const m=Math.round(Date.now()/1e3),p=parseInt(l);let x=m+p;c&&(x=parseInt(c));const v=x-m;v*1e3<=ef&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${p}s`);const _=x-p;m-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,x,m):m-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,x,m);const{data:w,error:j}=await this._getUser(a);if(j)throw j;const P={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:p,expires_at:x,refresh_token:o,token_type:d,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:P,redirectType:e.type},error:null})}catch(r){if(bt(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ld(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({error:a});const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(ZU(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await vc(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=sV(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:a},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Vu(this.storage,this.storageKey,!0));try{return await Et(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(bt(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(bt(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:s}=await this._useSession(async a=>{var o,l,c,d,m;const{data:p,error:x}=a;if(x)throw x;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Et(this.fetch,"GET",v,{headers:this.headers,jwt:(m=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&m!==void 0?m:void 0})});if(s)throw s;return Br()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),this._returnResult({data:{provider:e.provider,url:r?.url},error:null})}catch(r){if(bt(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:s,data:{session:a}}=t;if(s)throw s;const{options:o,provider:l,token:c,access_token:d,nonce:m}=e,p=await Et(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=a?.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:d,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:pa}),{data:x,error:v}=p;return v?this._returnResult({data:{user:null,session:null},error:v}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Uu}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:v}))}catch(s){if(bt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:o}=t;if(o)throw o;return await Et(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(bt(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await lV(async s=>(s>0&&await oV(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Et(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:pa})),(s,a)=>{const o=200*Math.pow(2,s);return a&&Wv(a)&&Date.now()+o-r<ef})}catch(r){if(this._debug(t,"error",r),bt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Br()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Ld(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Ld(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await tf(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:Hv()}else if(s&&!s.user&&!s.user){const o=await Ld(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await vc(this.storage,this.storageKey+"-user"),await tf(this.storage,this.storageKey,s)):s.user=Hv()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const a=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Bv;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${Bv}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Wv(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ma;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Lx;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new ma;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),bt(a)){const o={data:null,error:a};return Wv(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await tf(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const a=OP(s);await tf(this.storage,this.storageKey,a)}else{const s=OP(t);await tf(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await vc(this.storage,this.storageKey),await vc(this.storage,this.storageKey+"-code-verifier"),await vc(this.storage,this.storageKey+"-user"),this.userStorage&&await vc(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Br()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ef);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/ef);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${ef}ms, refresh threshold is ${qj} ticks`),s<=qj&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof R4)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Br()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,o]=await Vu(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r?.queryParams){const a=new URLSearchParams(r.queryParams);s.push(a.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;return a?this._returnResult({data:null,error:a}):await Et(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(bt(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await Et(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=a?.session)===null||r===void 0?void 0:r.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(bt(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?FV(e.webauthn.credential_response):qV(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await Et(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(t){if(bt(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=await Et(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:RV(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:LV(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(bt(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=$v(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((t=(e=r.user.factors)===null||e===void 0?void 0:e.filter(m=>m.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await Et(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ma})})}catch(t){if(bt(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ma});const o=await Et(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Br()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(bt(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ma});const o=await Et(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Br()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(bt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(l=>l.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+YU>s)return r;const{data:a,error:o}=await Et(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,r=a.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:v,error:_}=await this.getSession();if(_||!v.session)return this._returnResult({data:null,error:_});r=v.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=$v(r);t?.allowExpired||pV(a.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:v}=await this.getUser(r);if(v)throw v;return{data:{claims:a,header:s,signature:o},error:null}}const m=gV(s.alg),p=await crypto.subtle.importKey("jwk",d,m,!0,["verify"]);if(!await crypto.subtle.verify(m,p,o,nV(`${l}.${c}`)))throw new Vj("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(r){if(bt(r))return this._returnResult({data:null,error:r});throw r}}}em.nextInstanceID={};const GV=em;class ZV extends GV{constructor(e){super(e)}}class KV{constructor(e,t,r){var s,a,o;this.supabaseUrl=e,this.supabaseKey=t;const l=VU(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:IU,realtime:RU,auth:Object.assign(Object.assign({},AU),{storageKey:c}),global:OU},m=UU(r??{},d);this.storageKey=(s=m.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=m.global.headers)!==null&&a!==void 0?a:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(p,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=m.auth)!==null&&o!==void 0?o:{},this.headers,m.global.fetch),this.fetch=qU(t,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.accessToken&&this.accessToken().then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new Bz(new URL("rest/v1",l).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new kU(this.storageUrl.href,this.headers,this.fetch,r?.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new qz(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:o,flowType:l,lock:c,debug:d,throwOnError:m},p,x){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ZV({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),p),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:l,lock:c,debug:d,throwOnError:m,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new aU(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const JV=(n,e,t)=>new KV(n,e,t);function QV(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}QV()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const XV="https://fmyafuhxlorbafbacywa.supabase.co",eB="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZteWFmdWh4bG9yYmFmYmFjeXdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMjg1NDYsImV4cCI6MjA3NzgwNDU0Nn0.RqsniEqzNec6ww35TXJtLJD3mafnGbMI82om4XRUdUU",tB=XV,nB=eB,De=JV(tB,nB,{auth:{persistSession:!0,storage:window.localStorage,autoRefreshToken:!0,detectSessionInUrl:!0},global:{multiTab:!1}}),rB=async n=>{try{let{data:e,error:t}=await De.from("users").select("*, role_id").eq("id",n.id).single();if(t&&t.code==="PGRST116"){const r={id:n.id,name:n.user_metadata.name||"New User",email:n.email,role_id:"unverified"},{data:s,error:a}=await De.from("users").insert(r).select("*, role_id").single();if(a)return console.error("Error creating user profile on-the-fly:",a.message,a),null;e=s,t=null}return t?(console.error("Error fetching app profile:",t.message,t),null):{id:e.id,name:e.name,email:n.email||"",phone:e.phone,role:e.role_id,organizationId:e.organization_id,organizationName:e.organization_name,reportingManagerId:e.reporting_manager_id,photoUrl:e.photo_url}}catch(e){return console.error("Exception fetching profile:",e),null}},sB=async(n,e)=>await De.auth.signInWithPassword({email:n,password:e}),iB=async n=>{const{email:e,password:t,options:r}=n;return await De.auth.signUp({email:e,password:t,options:{...r,emailRedirectTo:`${window.location.origin}/`}})},aB=async(n,e)=>await De.from("users").update({role_id:e}).eq("id",n),oB=async()=>await De.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}}),lB=async()=>{const{error:n}=await De.auth.signOut();n&&console.error("Error signing out:",n.message)},cB=async n=>{const e=window.location.origin;return await De.auth.resetPasswordForEmail(n,{redirectTo:e})},dB=async n=>await De.auth.updateUser({password:n}),xa={getAppUserProfile:rB,signInWithPassword:sB,signUpWithPassword:iB,signInWithGoogle:oB,signOut:lB,resetPasswordForEmail:cB,updateUserPassword:dB,approveUser:aB},uB="modulepreload",fB=function(n,e){return new URL(n,e).href},zP={},UP=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let d=function(m){return Promise.all(m.map(p=>Promise.resolve(p).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");s=d(t.map(m=>{if(m=fB(m,r),m in zP)return;zP[m]=!0;const p=m.endsWith(".css"),x=p?'[rel="stylesheet"]':"";if(r)for(let _=o.length-1;_>=0;_--){const w=o[_];if(w.href===m&&(!p||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":uB,p||(v.as="script"),v.crossOrigin="",v.href=m,c&&v.setAttribute("nonce",c),document.head.appendChild(v),p)return new Promise((_,w)=>{v.addEventListener("load",_),v.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${m}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function It(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function qn(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function fl(n,e){const t=It(n);return isNaN(e)?qn(n,NaN):(e&&t.setDate(t.getDate()+e),t)}function Fx(n,e){const t=It(n);if(isNaN(e))return qn(n,NaN);if(!e)return t;const r=t.getDate(),s=qn(n,t.getTime());s.setMonth(t.getMonth()+e+1,0);const a=s.getDate();return r>=a?s:(t.setFullYear(s.getFullYear(),s.getMonth(),r),t)}const q4=6048e5,hB=864e5,z4=6e4,mB=36e5,pB=1e3,Tp=43200,VP=1440;let gB={};function Hc(){return gB}function yo(n,e){const t=Hc(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=It(n),a=s.getDay(),o=(a<r?7:0)+a-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function yf(n){return yo(n,{weekStartsOn:1})}function U4(n){const e=It(n),t=e.getFullYear(),r=qn(n,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const s=yf(r),a=qn(n,0);a.setFullYear(t,0,4),a.setHours(0,0,0,0);const o=yf(a);return e.getTime()>=s.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function qc(n){const e=It(n);return e.setHours(0,0,0,0),e}function vf(n){const e=It(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function xm(n,e){const t=qc(n),r=qc(e),s=+t-vf(t),a=+r-vf(r);return Math.round((s-a)/hB)}function xB(n){const e=U4(n),t=qn(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),yf(t)}function Bg(n,e){const t=It(n),r=It(e),s=t.getTime()-r.getTime();return s<0?-1:s>0?1:s}function yB(n){return qn(n,Date.now())}function cf(n,e){const t=qc(n),r=qc(e);return+t==+r}function vB(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function bB(n){if(!vB(n)&&typeof n!="number")return!1;const e=It(n);return!isNaN(Number(e))}function _B(n,e){const t=It(n),r=It(e),s=t.getFullYear()-r.getFullYear(),a=t.getMonth()-r.getMonth();return s*12+a}function wB(n,e){const t=It(n),r=It(e),s=BP(t,r),a=Math.abs(xm(t,r));t.setDate(t.getDate()-s*a);const o=+(BP(t,r)===-s),l=s*(a-o);return l===0?0:l}function BP(n,e){const t=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function V4(n){return e=>{const r=(n?Math[n]:Math.trunc)(e);return r===0?0:r}}function B4(n,e){return+It(n)-+It(e)}function df(n,e,t){const r=B4(n,e)/z4;return V4(t?.roundingMethod)(r)}function eC(n){const e=It(n);return e.setHours(23,59,59,999),e}function _a(n){const e=It(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function SB(n){const e=It(n);return+eC(e)==+_a(e)}function jB(n,e){const t=It(n),r=It(e),s=Bg(t,r),a=Math.abs(_B(t,r));let o;if(a<1)o=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-s*a);let l=Bg(t,r)===-s;SB(It(n))&&a===1&&Bg(n,r)===1&&(l=!1),o=s*(a-Number(l))}return o===0?0:o}function NB(n,e,t){const r=B4(n,e)/1e3;return V4(t?.roundingMethod)(r)}function uo(n,e){const t=It(n.start),r=It(n.end);let s=+t>+r;const a=s?+t:+r,o=s?r:t;o.setHours(0,0,0,0);let l=1;const c=[];for(;+o<=a;)c.push(It(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return s?c.reverse():c}function ui(n){const e=It(n);return e.setDate(1),e.setHours(0,0,0,0),e}function CB(n){const e=It(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function W4(n){const e=It(n),t=qn(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function WP(n,e){const t=Hc(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=It(n),a=s.getDay(),o=(a<r?-7:0)+6-(a-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function Gv(){return eC(Date.now())}const TB={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},PB=(n,e,t)=>{let r;const s=TB[n];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function Zv(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const MB={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},kB={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},EB={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},DB={date:Zv({formats:MB,defaultWidth:"full"}),time:Zv({formats:kB,defaultWidth:"full"}),dateTime:Zv({formats:EB,defaultWidth:"full"})},OB={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},IB=(n,e,t,r)=>OB[n];function ch(n){return(e,t)=>{const r=t?.context?String(t.context):"standalone";let s;if(r==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,l=t?.width?String(t.width):o;s=n.formattingValues[l]||n.formattingValues[o]}else{const o=n.defaultWidth,l=t?.width?String(t.width):n.defaultWidth;s=n.values[l]||n.values[o]}const a=n.argumentCallback?n.argumentCallback(e):e;return s[a]}}const AB={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},RB={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},LB={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},FB={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},qB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},zB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},UB=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},VB={ordinalNumber:UB,era:ch({values:AB,defaultWidth:"wide"}),quarter:ch({values:RB,defaultWidth:"wide",argumentCallback:n=>n-1}),month:ch({values:LB,defaultWidth:"wide"}),day:ch({values:FB,defaultWidth:"wide"}),dayPeriod:ch({values:qB,defaultWidth:"wide",formattingValues:zB,defaultFormattingWidth:"wide"})};function dh(n){return(e,t={})=>{const r=t.width,s=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],a=e.match(s);if(!a)return null;const o=a[0],l=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(l)?WB(l,p=>p.test(o)):BB(l,p=>p.test(o));let d;d=n.valueCallback?n.valueCallback(c):c,d=t.valueCallback?t.valueCallback(d):d;const m=e.slice(o.length);return{value:d,rest:m}}}function BB(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function WB(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function $B(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const s=r[0],a=e.match(n.parsePattern);if(!a)return null;let o=n.valueCallback?n.valueCallback(a[0]):a[0];o=t.valueCallback?t.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const HB=/^(\d+)(th|st|nd|rd)?/i,YB=/\d+/i,GB={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ZB={any:[/^b/i,/^(a|c)/i]},KB={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},JB={any:[/1/i,/2/i,/3/i,/4/i]},QB={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},XB={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},eW={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},tW={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},nW={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},rW={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},sW={ordinalNumber:$B({matchPattern:HB,parsePattern:YB,valueCallback:n=>parseInt(n,10)}),era:dh({matchPatterns:GB,defaultMatchWidth:"wide",parsePatterns:ZB,defaultParseWidth:"any"}),quarter:dh({matchPatterns:KB,defaultMatchWidth:"wide",parsePatterns:JB,defaultParseWidth:"any",valueCallback:n=>n+1}),month:dh({matchPatterns:QB,defaultMatchWidth:"wide",parsePatterns:XB,defaultParseWidth:"any"}),day:dh({matchPatterns:eW,defaultMatchWidth:"wide",parsePatterns:tW,defaultParseWidth:"any"}),dayPeriod:dh({matchPatterns:nW,defaultMatchWidth:"any",parsePatterns:rW,defaultParseWidth:"any"})},tC={code:"en-US",formatDistance:PB,formatLong:DB,formatRelative:IB,localize:VB,match:sW,options:{weekStartsOn:0,firstWeekContainsDate:1}};function iW(n){const e=It(n);return xm(e,W4(e))+1}function $4(n){const e=It(n),t=+yf(e)-+xB(e);return Math.round(t/q4)+1}function nC(n,e){const t=It(n),r=t.getFullYear(),s=Hc(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=qn(n,0);o.setFullYear(r+1,0,a),o.setHours(0,0,0,0);const l=yo(o,e),c=qn(n,0);c.setFullYear(r,0,a),c.setHours(0,0,0,0);const d=yo(c,e);return t.getTime()>=l.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function aW(n,e){const t=Hc(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,s=nC(n,e),a=qn(n,0);return a.setFullYear(s,0,r),a.setHours(0,0,0,0),yo(a,e)}function H4(n,e){const t=It(n),r=+yo(t,e)-+aW(t,e);return Math.round(r/q4)+1}function gn(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const bc={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return gn(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):gn(t+1,2)},d(n,e){return gn(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return gn(n.getHours()%12||12,e.length)},H(n,e){return gn(n.getHours(),e.length)},m(n,e){return gn(n.getMinutes(),e.length)},s(n,e){return gn(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),s=Math.trunc(r*Math.pow(10,t-3));return gn(s,e.length)}},Hu={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},$P={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),s=r>0?r:1-r;return t.ordinalNumber(s,{unit:"year"})}return bc.y(n,e)},Y:function(n,e,t,r){const s=nC(n,r),a=s>0?s:1-s;if(e==="YY"){const o=a%100;return gn(o,2)}return e==="Yo"?t.ordinalNumber(a,{unit:"year"}):gn(a,e.length)},R:function(n,e){const t=U4(n);return gn(t,e.length)},u:function(n,e){const t=n.getFullYear();return gn(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return gn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return gn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return bc.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return gn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const s=H4(n,r);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):gn(s,e.length)},I:function(n,e,t){const r=$4(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):gn(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):bc.d(n,e)},D:function(n,e,t){const r=iW(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):gn(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const s=n.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return gn(a,2);case"eo":return t.ordinalNumber(a,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const s=n.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return gn(a,e.length);case"co":return t.ordinalNumber(a,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return gn(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const s=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let s;switch(r===12?s=Hu.noon:r===0?s=Hu.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let s;switch(r>=17?s=Hu.evening:r>=12?s=Hu.afternoon:r>=4?s=Hu.morning:s=Hu.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return bc.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):bc.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):gn(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):gn(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):bc.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):bc.s(n,e)},S:function(n,e){return bc.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return YP(r);case"XXXX":case"XX":return Yd(r);case"XXXXX":case"XXX":default:return Yd(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return YP(r);case"xxxx":case"xx":return Yd(r);case"xxxxx":case"xxx":default:return Yd(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+HP(r,":");case"OOOO":default:return"GMT"+Yd(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+HP(r,":");case"zzzz":default:return"GMT"+Yd(r,":")}},t:function(n,e,t){const r=Math.trunc(n.getTime()/1e3);return gn(r,e.length)},T:function(n,e,t){const r=n.getTime();return gn(r,e.length)}};function HP(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Math.trunc(r/60),a=r%60;return a===0?t+String(s):t+String(s)+e+gn(a,2)}function YP(n,e){return n%60===0?(n>0?"-":"+")+gn(Math.abs(n)/60,2):Yd(n,e)}function Yd(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=gn(Math.trunc(r/60),2),a=gn(r%60,2);return t+s+e+a}const GP=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Y4=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},oW=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],s=t[2];if(!s)return GP(n,e);let a;switch(r){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",GP(r,e)).replace("{{time}}",Y4(s,e))},Bj={p:Y4,P:oW},lW=/^D+$/,cW=/^Y+$/,dW=["D","DD","YY","YYYY"];function G4(n){return lW.test(n)}function Z4(n){return cW.test(n)}function Wj(n,e,t){const r=uW(n,e,t);if(console.warn(r),dW.includes(n))throw new RangeError(r)}function uW(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const fW=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,hW=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,mW=/^'([^]*?)'?$/,pW=/''/g,gW=/[a-zA-Z]/;function Ue(n,e,t){const r=Hc(),s=r.locale??tC,a=r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,l=It(n);if(!bB(l))throw new RangeError("Invalid time value");let c=e.match(hW).map(m=>{const p=m[0];if(p==="p"||p==="P"){const x=Bj[p];return x(m,s.formatLong)}return m}).join("").match(fW).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:xW(m)};if($P[p])return{isToken:!0,value:m};if(p.match(gW))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const d={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;(Z4(p)||G4(p))&&Wj(p,e,String(n));const x=$P[p[0]];return x(l,p,s.localize,d)}).join("")}function xW(n){const e=n.match(mW);return e?e[1].replace(pW,"'"):n}function yW(n,e,t){const r=Hc(),s=t?.locale??r.locale??tC,a=2520,o=Bg(n,e);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:o});let c,d;o>0?(c=It(e),d=It(n)):(c=It(n),d=It(e));const m=NB(d,c),p=(vf(d)-vf(c))/1e3,x=Math.round((m-p)/60);let v;if(x<2)return t?.includeSeconds?m<5?s.formatDistance("lessThanXSeconds",5,l):m<10?s.formatDistance("lessThanXSeconds",10,l):m<20?s.formatDistance("lessThanXSeconds",20,l):m<40?s.formatDistance("halfAMinute",0,l):m<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):x===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",x,l);if(x<45)return s.formatDistance("xMinutes",x,l);if(x<90)return s.formatDistance("aboutXHours",1,l);if(x<VP){const _=Math.round(x/60);return s.formatDistance("aboutXHours",_,l)}else{if(x<a)return s.formatDistance("xDays",1,l);if(x<Tp){const _=Math.round(x/VP);return s.formatDistance("xDays",_,l)}else if(x<Tp*2)return v=Math.round(x/Tp),s.formatDistance("aboutXMonths",v,l)}if(v=jB(d,c),v<12){const _=Math.round(x/Tp);return s.formatDistance("xMonths",_,l)}else{const _=v%12,w=Math.trunc(v/12);return _<3?s.formatDistance("aboutXYears",w,l):_<9?s.formatDistance("overXYears",w,l):s.formatDistance("almostXYears",w+1,l)}}function iu(n,e){return yW(n,yB(n),e)}function rC(n){return It(n).getDay()}function vW(){return Object.assign({},Hc())}function bW(n){let t=It(n).getDay();return t===0&&(t=7),t}function _W(n,e){const t=It(n),r=It(e);return t.getTime()>r.getTime()}function wW(n,e){const t=e instanceof Date?qn(e,0):new e(0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),t}const SW=10;let K4=class{subPriority=0;validate(e,t){return!0}};class jW extends K4{constructor(e,t,r,s,a){super(),this.value=e,this.validateValue=t,this.setValue=r,this.priority=s,a&&(this.subPriority=a)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,r){return this.setValue(e,t,this.value,r)}}class NW extends K4{priority=SW;subPriority=-1;set(e,t){return t.timestampIsSet?e:qn(e,wW(e,Date))}}let cn=class{run(e,t,r,s){const a=this.parse(e,t,r,s);return a?{setter:new jW(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(e,t,r){return!0}},CW=class extends cn{priority=140;parse(e,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"});case"GGGGG":return r.era(e,{width:"narrow"});case"GGGG":default:return r.era(e,{width:"wide"})||r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"})}}set(e,t,r){return t.era=r,e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]};const ir={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},fo={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function ar(n,e){return n&&{value:e(n.value),rest:n.rest}}function Kn(n,e){const t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function ho(n,e){const t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const r=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,a=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:r*(s*mB+a*z4+o*pB),rest:e.slice(t[0].length)}}function J4(n){return Kn(ir.anyDigitsSigned,n)}function nr(n,e){switch(n){case 1:return Kn(ir.singleDigit,e);case 2:return Kn(ir.twoDigits,e);case 3:return Kn(ir.threeDigits,e);case 4:return Kn(ir.fourDigits,e);default:return Kn(new RegExp("^\\d{1,"+n+"}"),e)}}function ox(n,e){switch(n){case 1:return Kn(ir.singleDigitSigned,e);case 2:return Kn(ir.twoDigitsSigned,e);case 3:return Kn(ir.threeDigitsSigned,e);case 4:return Kn(ir.fourDigitsSigned,e);default:return Kn(new RegExp("^-?\\d{1,"+n+"}"),e)}}function sC(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Q4(n,e){const t=e>0,r=t?e:1-e;let s;if(r<=50)s=n||100;else{const a=r+50,o=Math.trunc(a/100)*100,l=n>=a%100;s=n+o-(l?100:0)}return t?s:1-s}function X4(n){return n%400===0||n%4===0&&n%100!==0}let TW=class extends cn{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,t,r){const s=a=>({year:a,isTwoDigitYear:t==="yy"});switch(t){case"y":return ar(nr(4,e),s);case"yo":return ar(r.ordinalNumber(e,{unit:"year"}),s);default:return ar(nr(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r){const s=e.getFullYear();if(r.isTwoDigitYear){const o=Q4(r.year,s);return e.setFullYear(o,0,1),e.setHours(0,0,0,0),e}const a=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}},PW=class extends cn{priority=130;parse(e,t,r){const s=a=>({year:a,isTwoDigitYear:t==="YY"});switch(t){case"Y":return ar(nr(4,e),s);case"Yo":return ar(r.ordinalNumber(e,{unit:"year"}),s);default:return ar(nr(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r,s){const a=nC(e,s);if(r.isTwoDigitYear){const l=Q4(r.year,a);return e.setFullYear(l,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),yo(e,s)}const o=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(o,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),yo(e,s)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},MW=class extends cn{priority=130;parse(e,t){return ox(t==="R"?4:t.length,e)}set(e,t,r){const s=qn(e,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),yf(s)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},kW=class extends cn{priority=130;parse(e,t){return ox(t==="u"?4:t.length,e)}set(e,t,r){return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]},EW=class extends cn{priority=120;parse(e,t,r){switch(t){case"Q":case"QQ":return nr(t.length,e);case"Qo":return r.ordinalNumber(e,{unit:"quarter"});case"QQQ":return r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(e,{width:"wide",context:"formatting"})||r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},DW=class extends cn{priority=120;parse(e,t,r){switch(t){case"q":case"qq":return nr(t.length,e);case"qo":return r.ordinalNumber(e,{unit:"quarter"});case"qqq":return r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(e,{width:"wide",context:"standalone"})||r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},OW=class extends cn{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,t,r){const s=a=>a-1;switch(t){case"M":return ar(Kn(ir.month,e),s);case"MM":return ar(nr(2,e),s);case"Mo":return ar(r.ordinalNumber(e,{unit:"month"}),s);case"MMM":return r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(e,{width:"wide",context:"formatting"})||r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}},IW=class extends cn{priority=110;parse(e,t,r){const s=a=>a-1;switch(t){case"L":return ar(Kn(ir.month,e),s);case"LL":return ar(nr(2,e),s);case"Lo":return ar(r.ordinalNumber(e,{unit:"month"}),s);case"LLL":return r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(e,{width:"wide",context:"standalone"})||r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};function AW(n,e,t){const r=It(n),s=H4(r,t)-e;return r.setDate(r.getDate()-s*7),r}let RW=class extends cn{priority=100;parse(e,t,r){switch(t){case"w":return Kn(ir.week,e);case"wo":return r.ordinalNumber(e,{unit:"week"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r,s){return yo(AW(e,r,s),s)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};function LW(n,e){const t=It(n),r=$4(t)-e;return t.setDate(t.getDate()-r*7),t}let FW=class extends cn{priority=100;parse(e,t,r){switch(t){case"I":return Kn(ir.week,e);case"Io":return r.ordinalNumber(e,{unit:"week"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r){return yf(LW(e,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};const qW=[31,28,31,30,31,30,31,31,30,31,30,31],zW=[31,29,31,30,31,30,31,31,30,31,30,31];let UW=class extends cn{priority=90;subPriority=1;parse(e,t,r){switch(t){case"d":return Kn(ir.date,e);case"do":return r.ordinalNumber(e,{unit:"date"});default:return nr(t.length,e)}}validate(e,t){const r=e.getFullYear(),s=X4(r),a=e.getMonth();return s?t>=1&&t<=zW[a]:t>=1&&t<=qW[a]}set(e,t,r){return e.setDate(r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]},VW=class extends cn{priority=90;subpriority=1;parse(e,t,r){switch(t){case"D":case"DD":return Kn(ir.dayOfYear,e);case"Do":return r.ordinalNumber(e,{unit:"date"});default:return nr(t.length,e)}}validate(e,t){const r=e.getFullYear();return X4(r)?t>=1&&t<=366:t>=1&&t<=365}set(e,t,r){return e.setMonth(0,r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};function iC(n,e,t){const r=Hc(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=It(n),o=a.getDay(),c=(e%7+7)%7,d=7-s,m=e<0||e>6?e-(o+d)%7:(c+d)%7-(o+d)%7;return fl(a,m)}let BW=class extends cn{priority=90;parse(e,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=iC(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]},WW=class extends cn{priority=90;parse(e,t,r,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(t){case"e":case"ee":return ar(nr(t.length,e),a);case"eo":return ar(r.ordinalNumber(e,{unit:"day"}),a);case"eee":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeeee":return r.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=iC(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},$W=class extends cn{priority=90;parse(e,t,r,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(t){case"c":case"cc":return ar(nr(t.length,e),a);case"co":return ar(r.ordinalNumber(e,{unit:"day"}),a);case"ccc":return r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"ccccc":return r.day(e,{width:"narrow",context:"standalone"});case"cccccc":return r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(e,{width:"wide",context:"standalone"})||r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=iC(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};function HW(n,e){const t=It(n),r=bW(t),s=e-r;return fl(t,s)}let YW=class extends cn{priority=90;parse(e,t,r){const s=a=>a===0?7:a;switch(t){case"i":case"ii":return nr(t.length,e);case"io":return r.ordinalNumber(e,{unit:"day"});case"iii":return ar(r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s);case"iiiii":return ar(r.day(e,{width:"narrow",context:"formatting"}),s);case"iiiiii":return ar(r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s);case"iiii":default:return ar(r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s)}}validate(e,t){return t>=1&&t<=7}set(e,t,r){return e=HW(e,r),e.setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},GW=class extends cn{priority=80;parse(e,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(sC(r),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]},ZW=class extends cn{priority=80;parse(e,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(sC(r),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]},KW=class extends cn{priority=80;parse(e,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(sC(r),0,0,0),e}incompatibleTokens=["a","b","t","T"]},JW=class extends cn{priority=70;parse(e,t,r){switch(t){case"h":return Kn(ir.hour12h,e);case"ho":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,r){const s=e.getHours()>=12;return s&&r<12?e.setHours(r+12,0,0,0):!s&&r===12?e.setHours(0,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]},QW=class extends cn{priority=70;parse(e,t,r){switch(t){case"H":return Kn(ir.hour23h,e);case"Ho":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,r){return e.setHours(r,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]},XW=class extends cn{priority=70;parse(e,t,r){switch(t){case"K":return Kn(ir.hour11h,e);case"Ko":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.getHours()>=12&&r<12?e.setHours(r+12,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]},e$=class extends cn{priority=70;parse(e,t,r){switch(t){case"k":return Kn(ir.hour24h,e);case"ko":return r.ordinalNumber(e,{unit:"hour"});default:return nr(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,r){const s=r<=24?r%24:r;return e.setHours(s,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]},t$=class extends cn{priority=60;parse(e,t,r){switch(t){case"m":return Kn(ir.minute,e);case"mo":return r.ordinalNumber(e,{unit:"minute"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setMinutes(r,0,0),e}incompatibleTokens=["t","T"]},n$=class extends cn{priority=50;parse(e,t,r){switch(t){case"s":return Kn(ir.second,e);case"so":return r.ordinalNumber(e,{unit:"second"});default:return nr(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setSeconds(r,0),e}incompatibleTokens=["t","T"]},r$=class extends cn{priority=30;parse(e,t){const r=s=>Math.trunc(s*Math.pow(10,-t.length+3));return ar(nr(t.length,e),r)}set(e,t,r){return e.setMilliseconds(r),e}incompatibleTokens=["t","T"]},s$=class extends cn{priority=10;parse(e,t){switch(t){case"X":return ho(fo.basicOptionalMinutes,e);case"XX":return ho(fo.basic,e);case"XXXX":return ho(fo.basicOptionalSeconds,e);case"XXXXX":return ho(fo.extendedOptionalSeconds,e);case"XXX":default:return ho(fo.extended,e)}}set(e,t,r){return t.timestampIsSet?e:qn(e,e.getTime()-vf(e)-r)}incompatibleTokens=["t","T","x"]},i$=class extends cn{priority=10;parse(e,t){switch(t){case"x":return ho(fo.basicOptionalMinutes,e);case"xx":return ho(fo.basic,e);case"xxxx":return ho(fo.basicOptionalSeconds,e);case"xxxxx":return ho(fo.extendedOptionalSeconds,e);case"xxx":default:return ho(fo.extended,e)}}set(e,t,r){return t.timestampIsSet?e:qn(e,e.getTime()-vf(e)-r)}incompatibleTokens=["t","T","X"]},a$=class extends cn{priority=40;parse(e){return J4(e)}set(e,t,r){return[qn(e,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"},o$=class extends cn{priority=20;parse(e){return J4(e)}set(e,t,r){return[qn(e,r),{timestampIsSet:!0}]}incompatibleTokens="*"};const l$={G:new CW,y:new TW,Y:new PW,R:new MW,u:new kW,Q:new EW,q:new DW,M:new OW,L:new IW,w:new RW,I:new FW,d:new UW,D:new VW,E:new BW,e:new WW,c:new $W,i:new YW,a:new GW,b:new ZW,B:new KW,h:new JW,H:new QW,K:new XW,k:new e$,m:new t$,s:new n$,S:new r$,X:new s$,x:new i$,t:new a$,T:new o$},c$=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,d$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,u$=/^'([^]*?)'?$/,f$=/''/g,h$=/\S/,m$=/[a-zA-Z]/;function p$(n,e,t,r){const s=vW(),a=s.locale??tC,o=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,l=s.weekStartsOn??s.locale?.options?.weekStartsOn??0;if(e==="")return n===""?It(t):qn(t,NaN);const c={firstWeekContainsDate:o,weekStartsOn:l,locale:a},d=[new NW],m=e.match(d$).map(w=>{const j=w[0];if(j in Bj){const P=Bj[j];return P(w,a.formatLong)}return w}).join("").match(c$),p=[];for(let w of m){Z4(w)&&Wj(w,e,n),G4(w)&&Wj(w,e,n);const j=w[0],P=l$[j];if(P){const{incompatibleTokens:k}=P;if(Array.isArray(k)){const M=p.find(D=>k.includes(D.token)||D.token===j);if(M)throw new RangeError(`The format string mustn't contain \`${M.fullToken}\` and \`${w}\` at the same time`)}else if(P.incompatibleTokens==="*"&&p.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);p.push({token:j,fullToken:w});const I=P.run(n,w,a.match,c);if(!I)return qn(t,NaN);d.push(I.setter),n=I.rest}else{if(j.match(m$))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");if(w==="''"?w="'":j==="'"&&(w=g$(w)),n.indexOf(w)===0)n=n.slice(w.length);else return qn(t,NaN)}}if(n.length>0&&h$.test(n))return qn(t,NaN);const x=d.map(w=>w.priority).sort((w,j)=>j-w).filter((w,j,P)=>P.indexOf(w)===j).map(w=>d.filter(j=>j.priority===w).sort((j,P)=>P.subPriority-j.subPriority)).map(w=>w[0]);let v=It(t);if(isNaN(v.getTime()))return qn(t,NaN);const _={};for(const w of x){if(!w.validate(v,c))return qn(t,NaN);const j=w.set(v,_,c);Array.isArray(j)?(v=j[0],Object.assign(_,j[1])):v=j}return qn(t,v)}function g$(n){return n.match(u$)[1].replace(f$,"'")}function uf(n,e){return fl(n,-e)}function Wg(){return qc(Date.now())}function aC(n,e){return Fx(n,-1)}var sn;(function(n){n.assertEqual=s=>{};function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const a={};for(const o of s)a[o]=o;return a},n.getValidEnumValues=s=>{const a=n.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),o={};for(const l of a)o[l]=s[l];return n.objectValues(o)},n.objectValues=s=>n.objectKeys(s).map(function(a){return s[a]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&a.push(o);return a},n.find=(s,a)=>{for(const o of s)if(a(o))return o},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}n.joinValues=r,n.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(sn||(sn={}));var ZP;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(ZP||(ZP={}));const ft=sn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Tc=n=>{switch(typeof n){case"undefined":return ft.undefined;case"string":return ft.string;case"number":return Number.isNaN(n)?ft.nan:ft.number;case"boolean":return ft.boolean;case"function":return ft.function;case"bigint":return ft.bigint;case"symbol":return ft.symbol;case"object":return Array.isArray(n)?ft.array:n===null?ft.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?ft.promise:typeof Map<"u"&&n instanceof Map?ft.map:typeof Set<"u"&&n instanceof Set?ft.set:typeof Date<"u"&&n instanceof Date?ft.date:ft.object;default:return ft.unknown}},Ke=sn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class vl extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},r={_errors:[]},s=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let l=r,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(t(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return s(this),r}static assert(e){if(!(e instanceof vl))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,sn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];t[a]=t[a]||[],t[a].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}vl.create=n=>new vl(n);const $j=(n,e)=>{let t;switch(n.code){case Ke.invalid_type:n.received===ft.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case Ke.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,sn.jsonStringifyReplacer)}`;break;case Ke.unrecognized_keys:t=`Unrecognized key(s) in object: ${sn.joinValues(n.keys,", ")}`;break;case Ke.invalid_union:t="Invalid input";break;case Ke.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${sn.joinValues(n.options)}`;break;case Ke.invalid_enum_value:t=`Invalid enum value. Expected ${sn.joinValues(n.options)}, received '${n.received}'`;break;case Ke.invalid_arguments:t="Invalid function arguments";break;case Ke.invalid_return_type:t="Invalid function return type";break;case Ke.invalid_date:t="Invalid date";break;case Ke.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:sn.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case Ke.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case Ke.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case Ke.custom:t="Invalid input";break;case Ke.invalid_intersection_types:t="Intersection results could not be merged";break;case Ke.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case Ke.not_finite:t="Number must be finite";break;default:t=e.defaultError,sn.assertNever(n)}return{message:t}};let x$=$j;function y$(){return x$}const v$=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,a=[...t,...s.path||[]],o={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let l="";const c=r.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:e,defaultError:l}).message;return{...s,path:a,message:l}};function st(n,e){const t=y$(),r=v$({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===$j?void 0:$j].filter(s=>!!s)});n.common.issues.push(r)}class vs{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return Lt;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t){const a=await s.key,o=await s.value;r.push({key:a,value:o})}return vs.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:a,value:o}=s;if(a.status==="aborted"||o.status==="aborted")return Lt;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[a.value]=o.value)}return{status:e.value,value:r}}}const Lt=Object.freeze({status:"aborted"}),Ih=n=>({status:"dirty",value:n}),$i=n=>({status:"valid",value:n}),KP=n=>n.status==="aborted",JP=n=>n.status==="dirty",bf=n=>n.status==="valid",lx=n=>typeof Promise<"u"&&n instanceof Promise;var gt;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message})(gt||(gt={}));class vo{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const QP=(n,e)=>{if(bf(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new vl(n.common.issues);return this._error=t,this._error}}};function Wt(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,l)=>{const{message:c}=n;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??r??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??t??l.defaultError}},description:s}}class en{get description(){return this._def.description}_getType(e){return Tc(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Tc(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new vs,ctx:{common:e.parent.common,data:e.data,parsedType:Tc(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(lx(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Tc(e)},s=this._parseSync({data:e,path:r.path,parent:r});return QP(r,s)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Tc(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:t});return bf(r)?{value:r.value}:{issues:t.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>bf(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Tc(e)},s=this._parse({data:e,path:r.path,parent:r}),a=await(lx(s)?s:Promise.resolve(s));return QP(r,a)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,a)=>{const o=e(s),l=()=>a.addIssue({code:Ke.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new Sf({schema:this,typeName:Rt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Lc.create(this,this._def)}nullable(){return jf.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return go.create(this)}promise(){return hx.create(this,this._def)}or(e){return dx.create([this,e],this._def)}and(e){return ux.create(this,e,this._def)}transform(e){return new Sf({...Wt(this._def),schema:this,typeName:Rt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Zj({...Wt(this._def),innerType:this,defaultValue:t,typeName:Rt.ZodDefault})}brand(){return new V$({typeName:Rt.ZodBranded,type:this,...Wt(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Kj({...Wt(this._def),innerType:this,catchValue:t,typeName:Rt.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return oC.create(this,e)}readonly(){return Jj.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const b$=/^c[^\s-]{8,}$/i,_$=/^[0-9a-z]+$/,w$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,S$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,j$=/^[a-z0-9_-]{21}$/i,N$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,C$=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,T$=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,P$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Kv;const M$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,k$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,E$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,D$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,O$=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,I$=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,eF="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",A$=new RegExp(`^${eF}$`);function tF(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function R$(n){return new RegExp(`^${tF(n)}$`)}function L$(n){let e=`${eF}T${tF(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function F$(n,e){return!!((e==="v4"||!e)&&M$.test(n)||(e==="v6"||!e)&&E$.test(n))}function q$(n,e){if(!N$.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function z$(n,e){return!!((e==="v4"||!e)&&k$.test(n)||(e==="v6"||!e)&&D$.test(n))}class mo extends en{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ft.string){const a=this._getOrReturnCtx(e);return st(a,{code:Ke.invalid_type,expected:ft.string,received:a.parsedType}),Lt}const r=new vs;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),st(s,{code:Ke.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),st(s,{code:Ke.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const o=e.data.length>a.value,l=e.data.length<a.value;(o||l)&&(s=this._getOrReturnCtx(e,s),o?st(s,{code:Ke.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):l&&st(s,{code:Ke.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")T$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"email",code:Ke.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")Kv||(Kv=new RegExp(P$,"u")),Kv.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"emoji",code:Ke.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")S$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"uuid",code:Ke.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")j$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"nanoid",code:Ke.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")b$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"cuid",code:Ke.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")_$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"cuid2",code:Ke.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")w$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"ulid",code:Ke.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),st(s,{validation:"url",code:Ke.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"regex",code:Ke.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),st(s,{code:Ke.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),st(s,{code:Ke.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),st(s,{code:Ke.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?L$(a).test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{code:Ke.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?A$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{code:Ke.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?R$(a).test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{code:Ke.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?C$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"duration",code:Ke.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?F$(e.data,a.version)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"ip",code:Ke.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?q$(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"jwt",code:Ke.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?z$(e.data,a.version)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"cidr",code:Ke.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?O$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"base64",code:Ke.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?I$.test(e.data)||(s=this._getOrReturnCtx(e,s),st(s,{validation:"base64url",code:Ke.invalid_string,message:a.message}),r.dirty()):sn.assertNever(a);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(s=>e.test(s),{validation:t,code:Ke.invalid_string,...gt.errToObj(r)})}_addCheck(e){return new mo({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...gt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...gt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...gt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...gt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...gt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...gt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...gt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...gt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...gt.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...gt.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...gt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...gt.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...gt.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...gt.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...gt.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...gt.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...gt.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...gt.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...gt.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...gt.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...gt.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...gt.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...gt.errToObj(t)})}nonempty(e){return this.min(1,gt.errToObj(e))}trim(){return new mo({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new mo({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new mo({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}mo.create=n=>new mo({checks:[],typeName:Rt.ZodString,coerce:n?.coerce??!1,...Wt(n)});function U$(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,a=Number.parseInt(n.toFixed(s).replace(".","")),o=Number.parseInt(e.toFixed(s).replace(".",""));return a%o/10**s}class au extends en{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ft.number){const a=this._getOrReturnCtx(e);return st(a,{code:Ke.invalid_type,expected:ft.number,received:a.parsedType}),Lt}let r;const s=new vs;for(const a of this._def.checks)a.kind==="int"?sn.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),st(r,{code:Ke.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),st(r,{code:Ke.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),st(r,{code:Ke.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?U$(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),st(r,{code:Ke.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),st(r,{code:Ke.not_finite,message:a.message}),s.dirty()):sn.assertNever(a);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,gt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,gt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,gt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,gt.toString(t))}setLimit(e,t,r,s){return new au({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:gt.toString(s)}]})}_addCheck(e){return new au({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:gt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:gt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:gt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:gt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:gt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:gt.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:gt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:gt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:gt.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&sn.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}au.create=n=>new au({checks:[],typeName:Rt.ZodNumber,coerce:n?.coerce||!1,...Wt(n)});class ou extends en{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ft.bigint)return this._getInvalidInput(e);let r;const s=new vs;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),st(r,{code:Ke.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),st(r,{code:Ke.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),st(r,{code:Ke.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):sn.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return st(t,{code:Ke.invalid_type,expected:ft.bigint,received:t.parsedType}),Lt}gte(e,t){return this.setLimit("min",e,!0,gt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,gt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,gt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,gt.toString(t))}setLimit(e,t,r,s){return new ou({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:gt.toString(s)}]})}_addCheck(e){return new ou({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:gt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:gt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:gt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:gt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:gt.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ou.create=n=>new ou({checks:[],typeName:Rt.ZodBigInt,coerce:n?.coerce??!1,...Wt(n)});class cx extends en{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ft.boolean){const r=this._getOrReturnCtx(e);return st(r,{code:Ke.invalid_type,expected:ft.boolean,received:r.parsedType}),Lt}return $i(e.data)}}cx.create=n=>new cx({typeName:Rt.ZodBoolean,coerce:n?.coerce||!1,...Wt(n)});class _f extends en{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ft.date){const a=this._getOrReturnCtx(e);return st(a,{code:Ke.invalid_type,expected:ft.date,received:a.parsedType}),Lt}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return st(a,{code:Ke.invalid_date}),Lt}const r=new vs;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),st(s,{code:Ke.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),st(s,{code:Ke.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):sn.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new _f({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:gt.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:gt.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}_f.create=n=>new _f({checks:[],coerce:n?.coerce||!1,typeName:Rt.ZodDate,...Wt(n)});class XP extends en{_parse(e){if(this._getType(e)!==ft.symbol){const r=this._getOrReturnCtx(e);return st(r,{code:Ke.invalid_type,expected:ft.symbol,received:r.parsedType}),Lt}return $i(e.data)}}XP.create=n=>new XP({typeName:Rt.ZodSymbol,...Wt(n)});class eM extends en{_parse(e){if(this._getType(e)!==ft.undefined){const r=this._getOrReturnCtx(e);return st(r,{code:Ke.invalid_type,expected:ft.undefined,received:r.parsedType}),Lt}return $i(e.data)}}eM.create=n=>new eM({typeName:Rt.ZodUndefined,...Wt(n)});class tM extends en{_parse(e){if(this._getType(e)!==ft.null){const r=this._getOrReturnCtx(e);return st(r,{code:Ke.invalid_type,expected:ft.null,received:r.parsedType}),Lt}return $i(e.data)}}tM.create=n=>new tM({typeName:Rt.ZodNull,...Wt(n)});class nM extends en{constructor(){super(...arguments),this._any=!0}_parse(e){return $i(e.data)}}nM.create=n=>new nM({typeName:Rt.ZodAny,...Wt(n)});class Hj extends en{constructor(){super(...arguments),this._unknown=!0}_parse(e){return $i(e.data)}}Hj.create=n=>new Hj({typeName:Rt.ZodUnknown,...Wt(n)});class zc extends en{_parse(e){const t=this._getOrReturnCtx(e);return st(t,{code:Ke.invalid_type,expected:ft.never,received:t.parsedType}),Lt}}zc.create=n=>new zc({typeName:Rt.ZodNever,...Wt(n)});class rM extends en{_parse(e){if(this._getType(e)!==ft.undefined){const r=this._getOrReturnCtx(e);return st(r,{code:Ke.invalid_type,expected:ft.void,received:r.parsedType}),Lt}return $i(e.data)}}rM.create=n=>new rM({typeName:Rt.ZodVoid,...Wt(n)});class go extends en{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==ft.array)return st(t,{code:Ke.invalid_type,expected:ft.array,received:t.parsedType}),Lt;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,l=t.data.length<s.exactLength.value;(o||l)&&(st(t,{code:o?Ke.too_big:Ke.too_small,minimum:l?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(st(t,{code:Ke.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(st(t,{code:Ke.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,l)=>s.type._parseAsync(new vo(t,o,t.path,l)))).then(o=>vs.mergeArray(r,o));const a=[...t.data].map((o,l)=>s.type._parseSync(new vo(t,o,t.path,l)));return vs.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new go({...this._def,minLength:{value:e,message:gt.toString(t)}})}max(e,t){return new go({...this._def,maxLength:{value:e,message:gt.toString(t)}})}length(e,t){return new go({...this._def,exactLength:{value:e,message:gt.toString(t)}})}nonempty(e){return this.min(1,e)}}go.create=(n,e)=>new go({type:n,minLength:null,maxLength:null,exactLength:null,typeName:Rt.ZodArray,...Wt(e)});function nf(n){if(n instanceof pr){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=Lc.create(nf(r))}return new pr({...n._def,shape:()=>e})}else return n instanceof go?new go({...n._def,type:nf(n.element)}):n instanceof Lc?Lc.create(nf(n.unwrap())):n instanceof jf?jf.create(nf(n.unwrap())):n instanceof lu?lu.create(n.items.map(e=>nf(e))):n}class pr extends en{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=sn.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==ft.object){const d=this._getOrReturnCtx(e);return st(d,{code:Ke.invalid_type,expected:ft.object,received:d.parsedType}),Lt}const{status:r,ctx:s}=this._processInputParams(e),{shape:a,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof zc&&this._def.unknownKeys==="strip"))for(const d in s.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const m=a[d],p=s.data[d];c.push({key:{status:"valid",value:d},value:m._parse(new vo(s,p,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof zc){const d=this._def.unknownKeys;if(d==="passthrough")for(const m of l)c.push({key:{status:"valid",value:m},value:{status:"valid",value:s.data[m]}});else if(d==="strict")l.length>0&&(st(s,{code:Ke.unrecognized_keys,keys:l}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const m of l){const p=s.data[m];c.push({key:{status:"valid",value:m},value:d._parse(new vo(s,p,s.path,m)),alwaysSet:m in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const m of c){const p=await m.key,x=await m.value;d.push({key:p,value:x,alwaysSet:m.alwaysSet})}return d}).then(d=>vs.mergeObjectSync(r,d)):vs.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return gt.errToObj,new pr({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{const s=this._def.errorMap?.(t,r).message??r.defaultError;return t.code==="unrecognized_keys"?{message:gt.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new pr({...this._def,unknownKeys:"strip"})}passthrough(){return new pr({...this._def,unknownKeys:"passthrough"})}extend(e){return new pr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new pr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Rt.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new pr({...this._def,catchall:e})}pick(e){const t={};for(const r of sn.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new pr({...this._def,shape:()=>t})}omit(e){const t={};for(const r of sn.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new pr({...this._def,shape:()=>t})}deepPartial(){return nf(this)}partial(e){const t={};for(const r of sn.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}return new pr({...this._def,shape:()=>t})}required(e){const t={};for(const r of sn.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Lc;)a=a._def.innerType;t[r]=a}return new pr({...this._def,shape:()=>t})}keyof(){return nF(sn.objectKeys(this.shape))}}pr.create=(n,e)=>new pr({shape:()=>n,unknownKeys:"strip",catchall:zc.create(),typeName:Rt.ZodObject,...Wt(e)});pr.strictCreate=(n,e)=>new pr({shape:()=>n,unknownKeys:"strict",catchall:zc.create(),typeName:Rt.ZodObject,...Wt(e)});pr.lazycreate=(n,e)=>new pr({shape:n,unknownKeys:"strip",catchall:zc.create(),typeName:Rt.ZodObject,...Wt(e)});class dx extends en{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(a){for(const l of a)if(l.result.status==="valid")return l.result;for(const l of a)if(l.result.status==="dirty")return t.common.issues.push(...l.ctx.common.issues),l.result;const o=a.map(l=>new vl(l.ctx.common.issues));return st(t,{code:Ke.invalid_union,unionErrors:o}),Lt}if(t.common.async)return Promise.all(r.map(async a=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let a;const o=[];for(const c of r){const d={...t,common:{...t.common,issues:[]},parent:null},m=c._parseSync({data:t.data,path:t.path,parent:d});if(m.status==="valid")return m;m.status==="dirty"&&!a&&(a={result:m,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const l=o.map(c=>new vl(c));return st(t,{code:Ke.invalid_union,unionErrors:l}),Lt}}get options(){return this._def.options}}dx.create=(n,e)=>new dx({options:n,typeName:Rt.ZodUnion,...Wt(e)});function Yj(n,e){const t=Tc(n),r=Tc(e);if(n===e)return{valid:!0,data:n};if(t===ft.object&&r===ft.object){const s=sn.objectKeys(e),a=sn.objectKeys(n).filter(l=>s.indexOf(l)!==-1),o={...n,...e};for(const l of a){const c=Yj(n[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(t===ft.array&&r===ft.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<n.length;a++){const o=n[a],l=e[a],c=Yj(o,l);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===ft.date&&r===ft.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class ux extends en{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(a,o)=>{if(KP(a)||KP(o))return Lt;const l=Yj(a.value,o.value);return l.valid?((JP(a)||JP(o))&&t.dirty(),{status:t.value,value:l.data}):(st(r,{code:Ke.invalid_intersection_types}),Lt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,o])=>s(a,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ux.create=(n,e,t)=>new ux({left:n,right:e,typeName:Rt.ZodIntersection,...Wt(t)});class lu extends en{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.array)return st(r,{code:Ke.invalid_type,expected:ft.array,received:r.parsedType}),Lt;if(r.data.length<this._def.items.length)return st(r,{code:Ke.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Lt;!this._def.rest&&r.data.length>this._def.items.length&&(st(r,{code:Ke.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...r.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new vo(r,o,r.path,l)):null}).filter(o=>!!o);return r.common.async?Promise.all(a).then(o=>vs.mergeArray(t,o)):vs.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new lu({...this._def,rest:e})}}lu.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new lu({items:n,typeName:Rt.ZodTuple,rest:null,...Wt(e)})};class fx extends en{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.object)return st(r,{code:Ke.invalid_type,expected:ft.object,received:r.parsedType}),Lt;const s=[],a=this._def.keyType,o=this._def.valueType;for(const l in r.data)s.push({key:a._parse(new vo(r,l,r.path,l)),value:o._parse(new vo(r,r.data[l],r.path,l)),alwaysSet:l in r.data});return r.common.async?vs.mergeObjectAsync(t,s):vs.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof en?new fx({keyType:e,valueType:t,typeName:Rt.ZodRecord,...Wt(r)}):new fx({keyType:mo.create(),valueType:e,typeName:Rt.ZodRecord,...Wt(t)})}}class sM extends en{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.map)return st(r,{code:Ke.invalid_type,expected:ft.map,received:r.parsedType}),Lt;const s=this._def.keyType,a=this._def.valueType,o=[...r.data.entries()].map(([l,c],d)=>({key:s._parse(new vo(r,l,r.path,[d,"key"])),value:a._parse(new vo(r,c,r.path,[d,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,m=await c.value;if(d.status==="aborted"||m.status==="aborted")return Lt;(d.status==="dirty"||m.status==="dirty")&&t.dirty(),l.set(d.value,m.value)}return{status:t.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,m=c.value;if(d.status==="aborted"||m.status==="aborted")return Lt;(d.status==="dirty"||m.status==="dirty")&&t.dirty(),l.set(d.value,m.value)}return{status:t.value,value:l}}}}sM.create=(n,e,t)=>new sM({valueType:e,keyType:n,typeName:Rt.ZodMap,...Wt(t)});class tm extends en{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.set)return st(r,{code:Ke.invalid_type,expected:ft.set,received:r.parsedType}),Lt;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(st(r,{code:Ke.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(st(r,{code:Ke.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const a=this._def.valueType;function o(c){const d=new Set;for(const m of c){if(m.status==="aborted")return Lt;m.status==="dirty"&&t.dirty(),d.add(m.value)}return{status:t.value,value:d}}const l=[...r.data.values()].map((c,d)=>a._parse(new vo(r,c,r.path,d)));return r.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,t){return new tm({...this._def,minSize:{value:e,message:gt.toString(t)}})}max(e,t){return new tm({...this._def,maxSize:{value:e,message:gt.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}tm.create=(n,e)=>new tm({valueType:n,minSize:null,maxSize:null,typeName:Rt.ZodSet,...Wt(e)});class Gj extends en{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Gj.create=(n,e)=>new Gj({getter:n,typeName:Rt.ZodLazy,...Wt(e)});class iM extends en{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return st(t,{received:t.data,code:Ke.invalid_literal,expected:this._def.value}),Lt}return{status:"valid",value:e.data}}get value(){return this._def.value}}iM.create=(n,e)=>new iM({value:n,typeName:Rt.ZodLiteral,...Wt(e)});function nF(n,e){return new wf({values:n,typeName:Rt.ZodEnum,...Wt(e)})}class wf extends en{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return st(t,{expected:sn.joinValues(r),received:t.parsedType,code:Ke.invalid_type}),Lt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return st(t,{received:t.data,code:Ke.invalid_enum_value,options:r}),Lt}return $i(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return wf.create(e,{...this._def,...t})}exclude(e,t=this._def){return wf.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}wf.create=nF;class aM extends en{_parse(e){const t=sn.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ft.string&&r.parsedType!==ft.number){const s=sn.objectValues(t);return st(r,{expected:sn.joinValues(s),received:r.parsedType,code:Ke.invalid_type}),Lt}if(this._cache||(this._cache=new Set(sn.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=sn.objectValues(t);return st(r,{received:r.data,code:Ke.invalid_enum_value,options:s}),Lt}return $i(e.data)}get enum(){return this._def.values}}aM.create=(n,e)=>new aM({values:n,typeName:Rt.ZodNativeEnum,...Wt(e)});class hx extends en{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ft.promise&&t.common.async===!1)return st(t,{code:Ke.invalid_type,expected:ft.promise,received:t.parsedType}),Lt;const r=t.parsedType===ft.promise?t.data:Promise.resolve(t.data);return $i(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}hx.create=(n,e)=>new hx({type:n,typeName:Rt.ZodPromise,...Wt(e)});class Sf extends en{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Rt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:o=>{st(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const o=s.transform(r.data,a);if(r.common.async)return Promise.resolve(o).then(async l=>{if(t.value==="aborted")return Lt;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?Lt:c.status==="dirty"||t.value==="dirty"?Ih(c.value):c});{if(t.value==="aborted")return Lt;const l=this._def.schema._parseSync({data:o,path:r.path,parent:r});return l.status==="aborted"?Lt:l.status==="dirty"||t.value==="dirty"?Ih(l.value):l}}if(s.type==="refinement"){const o=l=>{const c=s.refinement(l,a);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?Lt:(l.status==="dirty"&&t.dirty(),o(l.value),{status:t.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?Lt:(l.status==="dirty"&&t.dirty(),o(l.value).then(()=>({status:t.value,value:l.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!bf(o))return Lt;const l=s.transform(o.value,a);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>bf(o)?Promise.resolve(s.transform(o.value,a)).then(l=>({status:t.value,value:l})):Lt);sn.assertNever(s)}}Sf.create=(n,e,t)=>new Sf({schema:n,typeName:Rt.ZodEffects,effect:e,...Wt(t)});Sf.createWithPreprocess=(n,e,t)=>new Sf({schema:e,effect:{type:"preprocess",transform:n},typeName:Rt.ZodEffects,...Wt(t)});class Lc extends en{_parse(e){return this._getType(e)===ft.undefined?$i(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Lc.create=(n,e)=>new Lc({innerType:n,typeName:Rt.ZodOptional,...Wt(e)});class jf extends en{_parse(e){return this._getType(e)===ft.null?$i(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}jf.create=(n,e)=>new jf({innerType:n,typeName:Rt.ZodNullable,...Wt(e)});class Zj extends en{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===ft.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Zj.create=(n,e)=>new Zj({innerType:n,typeName:Rt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Wt(e)});class Kj extends en{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return lx(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new vl(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new vl(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Kj.create=(n,e)=>new Kj({innerType:n,typeName:Rt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Wt(e)});class oM extends en{_parse(e){if(this._getType(e)!==ft.nan){const r=this._getOrReturnCtx(e);return st(r,{code:Ke.invalid_type,expected:ft.nan,received:r.parsedType}),Lt}return{status:"valid",value:e.data}}}oM.create=n=>new oM({typeName:Rt.ZodNaN,...Wt(n)});class V$ extends en{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class oC extends en{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Lt:a.status==="dirty"?(t.dirty(),Ih(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Lt:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new oC({in:e,out:t,typeName:Rt.ZodPipeline})}}class Jj extends en{_parse(e){const t=this._def.innerType._parse(e),r=s=>(bf(s)&&(s.value=Object.freeze(s.value)),s);return lx(t)?t.then(s=>r(s)):r(t)}unwrap(){return this._def.innerType}}Jj.create=(n,e)=>new Jj({innerType:n,typeName:Rt.ZodReadonly,...Wt(e)});var Rt;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(Rt||(Rt={}));const Fd=mo.create,lM=au.create;ou.create;const B$=cx.create;_f.create;const cM=Hj.create;zc.create;const Ah=go.create,W$=pr.create,$$=dx.create;ux.create;lu.create;const H$=fx.create,Y$=Gj.create,G$=wf.create;hx.create;Lc.create;jf.create;const Yu={string:(n=>mo.create({...n,coerce:!0})),number:(n=>au.create({...n,coerce:!0})),boolean:(n=>cx.create({...n,coerce:!0})),bigint:(n=>ou.create({...n,coerce:!0})),date:(n=>_f.create({...n,coerce:!0}))};let Z$,K$;function J$(){return{geminiUrl:Z$,vertexUrl:K$}}function Q$(n,e,t){var r,s,a;if(!(!((r=n.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=J$();return n.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(a=o.geminiUrl)!==null&&a!==void 0?a:t}return n.httpOptions.baseUrl}class ym{}function Ot(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const a=e[s];return a!=null?String(a):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function N(n,e,t){for(let a=0;a<e.length-1;a++){const o=e[a];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in n))if(Array.isArray(t))n[l]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[l])){const c=n[l];if(Array.isArray(t))for(let d=0;d<c.length;d++){const m=c[d];N(m,e.slice(a+1),t[d])}else for(const d of c)N(d,e.slice(a+1),t)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in n||(n[l]=[{}]);const c=n[l];N(c[0],e.slice(a+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const r=e[e.length-1],s=n[r];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else n[r]=t}function S(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const r=e[t];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in n){const a=n[s];return Array.isArray(a)?a.map(o=>S(o,e.slice(t+1))):void 0}else return}else n=n[r]}return n}catch(t){if(t instanceof TypeError)return;throw t}}var dM;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(dM||(dM={}));var uM;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(uM||(uM={}));var fM;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(fM||(fM={}));var hM;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(hM||(hM={}));var mM;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(mM||(mM={}));var Xe;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(Xe||(Xe={}));var pM;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(pM||(pM={}));var gM;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(gM||(gM={}));var xM;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(xM||(xM={}));var yM;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(yM||(yM={}));var vM;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(vM||(vM={}));var bM;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(bM||(bM={}));var _M;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(_M||(_M={}));var nm;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(nm||(nm={}));var wM;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(wM||(wM={}));var Qj;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Qj||(Qj={}));var SM;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(SM||(SM={}));var jM;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(jM||(jM={}));var NM;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(NM||(NM={}));var CM;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(CM||(CM={}));var TM;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(TM||(TM={}));var PM;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(PM||(PM={}));var MM;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(MM||(MM={}));var kM;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(kM||(kM={}));var EM;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})(EM||(EM={}));var DM;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(DM||(DM={}));var OM;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(OM||(OM={}));var IM;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(IM||(IM={}));var AM;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(AM||(AM={}));var RM;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(RM||(RM={}));var LM;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(LM||(LM={}));var FM;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(FM||(FM={}));var qM;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(qM||(qM={}));var zM;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(zM||(zM={}));var UM;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(UM||(UM={}));var VM;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(VM||(VM={}));var BM;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(BM||(BM={}));var WM;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(WM||(WM={}));var $M;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY"})($M||($M={}));var sf;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(sf||(sf={}));class uh{get text(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",m=!1;const p=[];for(const x of(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[v,_]of Object.entries(x))v!=="text"&&v!=="thought"&&(_!==null||_!==void 0)&&p.push(v);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;m=!0,d+=x.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?d:void 0}get data(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const m=[];for(const p of(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[x,v]of Object.entries(p))x!=="inlineData"&&(v!==null||v!==void 0)&&m.push(x);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if(d?.length!==0)return d}get executableCode(){var e,t,r,s,a,o,l,c,d;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if(m?.length!==0)return(d=m?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,r,s,a,o,l,c,d;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if(m?.length!==0)return(d=m?.[0])===null||d===void 0?void 0:d.output}}class HM{}class YM{}class X${}class eH{}class GM{}class ZM{}class KM{}class tH{}class JM{}class QM{}class XM{}class nH{}class Xj{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class rH{}class sH{}class iH{get text(){var e,t,r;let s="",a=!1;const o=[];for(const l of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(l))c!=="text"&&c!=="thought"&&d!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;a=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?s:void 0}get data(){var e,t,r;let s="";const a=[];for(const o of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&a.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class aH{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function zn(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function rF(n,e){const t=zn(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function sF(n,e){return Array.isArray(e)?e.map(t=>mx(n,t)):[mx(n,e)]}function mx(n,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function oH(n,e){const t=mx(n,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function lH(n,e){const t=mx(n,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function ek(n,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function iF(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>ek(n,t)):[ek(n,e)]}function eN(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function tk(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function nk(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function qs(n,e){if(e==null)throw new Error("ContentUnion is required");return eN(e)?e:{role:"user",parts:iF(n,e)}}function aF(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=qs(n,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=qs(n,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>qs(n,t)):[qs(n,e)]}function wa(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(tk(e)||nk(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[qs(n,e)]}const t=[],r=[],s=eN(e[0]);for(const a of e){const o=eN(a);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(a);else{if(tk(a)||nk(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(a)}}return s||t.push({role:"user",parts:iF(n,r)}),t}const rk=G$(["string","number","integer","object","array","boolean","null"]),cH=$$([rk,Ah(rk)]);function dH(n=!0){const e=Y$(()=>{const t=W$({type:cH.optional(),format:Fd().optional(),title:Fd().optional(),description:Fd().optional(),default:cM().optional(),items:e.optional(),minItems:Yu.string().optional(),maxItems:Yu.string().optional(),enum:Ah(cM()).optional(),properties:H$(Fd(),e).optional(),required:Ah(Fd()).optional(),minProperties:Yu.string().optional(),maxProperties:Yu.string().optional(),propertyOrdering:Ah(Fd()).optional(),minimum:lM().optional(),maximum:lM().optional(),minLength:Yu.string().optional(),maxLength:Yu.string().optional(),pattern:Fd().optional(),anyOf:Ah(e).optional(),additionalProperties:B$().optional()});return n?t.strict():t});return e}function uH(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.keys(Xe).includes(t[0].toUpperCase())?Xe[t[0].toUpperCase()]:Xe.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.keys(Xe).includes(r.toUpperCase())?Xe[r.toUpperCase()]:Xe.TYPE_UNSPECIFIED})}}function Bh(n){const e={},t=["items"],r=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&uH(n.type,e);for(const[o,l]of Object.entries(n))if(l!=null)if(o=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;e.type=Object.keys(Xe).includes(l.toUpperCase())?l.toUpperCase():Xe.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=Bh(l);else if(r.includes(o)){const c=[];for(const d of l){if(d.type=="null"){e.nullable=!0;continue}c.push(Bh(d))}e[o]=c}else if(s.includes(o)){const c={};for(const[d,m]of Object.entries(l))c[d]=Bh(m);e[o]=c}else{if(o==="additionalProperties")continue;e[o]=l}return e}function px(n,e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=dH().parse(e);return Bh(t)}else return Bh(e)}function oF(n,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function lF(n,e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function qx(n,e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=px(n,t.parameters)),t.response&&(t.response=px(n,t.response));return e}function zx(n,e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const r of e)t.push(r);return t}function fH(n,e,t,r=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Yc(n,e){if(typeof e!="string")throw new Error("name must be a string");return fH(n,e,"cachedContents")}function cF(n,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Gc(n,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function hH(n){return n!=null&&typeof n=="object"&&"name"in n}function mH(n){return n!=null&&typeof n=="object"&&"video"in n}function pH(n){return n!=null&&typeof n=="object"&&"uri"in n}function dF(n,e){var t;let r;if(hH(e)&&(r=e.name),!(pH(e)&&(r=e.uri,r===void 0))&&!(mH(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const a=r.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${r}`);r=a[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function uF(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function fF(n,e){for(const t of["models","tunedModels","publisherModels"])if(gH(e,t))return e[t];return[]}function gH(n,e){return n!==null&&typeof n=="object"&&e in n}function xH(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function yH(n,e){const t={};if(S(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function vH(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],xH(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],yH(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const m=S(e,["functionResponse"]);m!=null&&N(t,["functionResponse"],m);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function sk(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>vH(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function bH(n,e){const t={},r=S(e,["behavior"]);r!=null&&N(t,["behavior"],r);const s=S(e,["description"]);s!=null&&N(t,["description"],s);const a=S(e,["name"]);a!=null&&N(t,["name"],a);const o=S(e,["parameters"]);o!=null&&N(t,["parameters"],o);const l=S(e,["response"]);return l!=null&&N(t,["response"],l),t}function _H(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function wH(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],_H(n,r)),t}function SH(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function jH(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],SH(n,r)),t}function NH(){return{}}function CH(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>bH(n,d))),N(t,["functionDeclarations"],c)}if(S(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=S(e,["googleSearch"]);s!=null&&N(t,["googleSearch"],wH(n,s));const a=S(e,["googleSearchRetrieval"]);if(a!=null&&N(t,["googleSearchRetrieval"],jH(n,a)),S(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(S(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");S(e,["urlContext"])!=null&&N(t,["urlContext"],NH());const l=S(e,["codeExecution"]);return l!=null&&N(t,["codeExecution"],l),t}function TH(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["allowedFunctionNames"]);return s!=null&&N(t,["allowedFunctionNames"],s),t}function PH(n,e){const t={},r=S(e,["latitude"]);r!=null&&N(t,["latitude"],r);const s=S(e,["longitude"]);return s!=null&&N(t,["longitude"],s),t}function MH(n,e){const t={},r=S(e,["latLng"]);return r!=null&&N(t,["latLng"],PH(n,r)),t}function kH(n,e){const t={},r=S(e,["functionCallingConfig"]);r!=null&&N(t,["functionCallingConfig"],TH(n,r));const s=S(e,["retrievalConfig"]);return s!=null&&N(t,["retrievalConfig"],MH(n,s)),t}function EH(n,e,t){const r={},s=S(e,["ttl"]);t!==void 0&&s!=null&&N(t,["ttl"],s);const a=S(e,["expireTime"]);t!==void 0&&a!=null&&N(t,["expireTime"],a);const o=S(e,["displayName"]);t!==void 0&&o!=null&&N(t,["displayName"],o);const l=S(e,["contents"]);if(t!==void 0&&l!=null){let p=wa(n,l);Array.isArray(p)&&(p=p.map(x=>sk(n,x))),N(t,["contents"],p)}const c=S(e,["systemInstruction"]);t!==void 0&&c!=null&&N(t,["systemInstruction"],sk(n,qs(n,c)));const d=S(e,["tools"]);if(t!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(x=>CH(n,x))),N(t,["tools"],p)}const m=S(e,["toolConfig"]);if(t!==void 0&&m!=null&&N(t,["toolConfig"],kH(n,m)),S(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return r}function DH(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["model"],rF(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],EH(n,s,t)),t}function OH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Yc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function IH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Yc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function AH(n,e,t){const r={},s=S(e,["ttl"]);t!==void 0&&s!=null&&N(t,["ttl"],s);const a=S(e,["expireTime"]);return t!==void 0&&a!=null&&N(t,["expireTime"],a),r}function RH(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Yc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],AH(n,s,t)),t}function LH(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);return t!==void 0&&a!=null&&N(t,["_query","pageToken"],a),r}function FH(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],LH(n,r,t)),t}function qH(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function zH(n,e){const t={},r=S(e,["displayName"]);r!=null&&N(t,["displayName"],r);const s=S(e,["data"]);s!=null&&N(t,["data"],s);const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function UH(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],qH(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],zH(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const m=S(e,["functionResponse"]);m!=null&&N(t,["functionResponse"],m);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function ik(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>UH(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function VH(n,e){const t={};if(S(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=S(e,["description"]);r!=null&&N(t,["description"],r);const s=S(e,["name"]);s!=null&&N(t,["name"],s);const a=S(e,["parameters"]);a!=null&&N(t,["parameters"],a);const o=S(e,["response"]);return o!=null&&N(t,["response"],o),t}function BH(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function WH(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],BH(n,r)),t}function $H(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function HH(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],$H(n,r)),t}function YH(){return{}}function GH(n,e){const t={},r=S(e,["apiKeyString"]);return r!=null&&N(t,["apiKeyString"],r),t}function ZH(n,e){const t={},r=S(e,["apiKeyConfig"]);r!=null&&N(t,["apiKeyConfig"],GH(n,r));const s=S(e,["authType"]);s!=null&&N(t,["authType"],s);const a=S(e,["googleServiceAccountConfig"]);a!=null&&N(t,["googleServiceAccountConfig"],a);const o=S(e,["httpBasicAuthConfig"]);o!=null&&N(t,["httpBasicAuthConfig"],o);const l=S(e,["oauthConfig"]);l!=null&&N(t,["oauthConfig"],l);const c=S(e,["oidcConfig"]);return c!=null&&N(t,["oidcConfig"],c),t}function KH(n,e){const t={},r=S(e,["authConfig"]);return r!=null&&N(t,["authConfig"],ZH(n,r)),t}function JH(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(p=>VH(n,p))),N(t,["functionDeclarations"],m)}const s=S(e,["retrieval"]);s!=null&&N(t,["retrieval"],s);const a=S(e,["googleSearch"]);a!=null&&N(t,["googleSearch"],WH(n,a));const o=S(e,["googleSearchRetrieval"]);o!=null&&N(t,["googleSearchRetrieval"],HH(n,o)),S(e,["enterpriseWebSearch"])!=null&&N(t,["enterpriseWebSearch"],YH());const c=S(e,["googleMaps"]);if(c!=null&&N(t,["googleMaps"],KH(n,c)),S(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=S(e,["codeExecution"]);return d!=null&&N(t,["codeExecution"],d),t}function QH(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["allowedFunctionNames"]);return s!=null&&N(t,["allowedFunctionNames"],s),t}function XH(n,e){const t={},r=S(e,["latitude"]);r!=null&&N(t,["latitude"],r);const s=S(e,["longitude"]);return s!=null&&N(t,["longitude"],s),t}function e8(n,e){const t={},r=S(e,["latLng"]);return r!=null&&N(t,["latLng"],XH(n,r)),t}function t8(n,e){const t={},r=S(e,["functionCallingConfig"]);r!=null&&N(t,["functionCallingConfig"],QH(n,r));const s=S(e,["retrievalConfig"]);return s!=null&&N(t,["retrievalConfig"],e8(n,s)),t}function n8(n,e,t){const r={},s=S(e,["ttl"]);t!==void 0&&s!=null&&N(t,["ttl"],s);const a=S(e,["expireTime"]);t!==void 0&&a!=null&&N(t,["expireTime"],a);const o=S(e,["displayName"]);t!==void 0&&o!=null&&N(t,["displayName"],o);const l=S(e,["contents"]);if(t!==void 0&&l!=null){let x=wa(n,l);Array.isArray(x)&&(x=x.map(v=>ik(n,v))),N(t,["contents"],x)}const c=S(e,["systemInstruction"]);t!==void 0&&c!=null&&N(t,["systemInstruction"],ik(n,qs(n,c)));const d=S(e,["tools"]);if(t!==void 0&&d!=null){let x=d;Array.isArray(x)&&(x=x.map(v=>JH(n,v))),N(t,["tools"],x)}const m=S(e,["toolConfig"]);t!==void 0&&m!=null&&N(t,["toolConfig"],t8(n,m));const p=S(e,["kmsKeyName"]);return t!==void 0&&p!=null&&N(t,["encryption_spec","kmsKeyName"],p),r}function r8(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["model"],rF(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],n8(n,s,t)),t}function s8(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Yc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function i8(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Yc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function a8(n,e,t){const r={},s=S(e,["ttl"]);t!==void 0&&s!=null&&N(t,["ttl"],s);const a=S(e,["expireTime"]);return t!==void 0&&a!=null&&N(t,["expireTime"],a),r}function o8(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],Yc(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],a8(n,s,t)),t}function l8(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);return t!==void 0&&a!=null&&N(t,["_query","pageToken"],a),r}function c8(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],l8(n,r,t)),t}function $g(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["model"]);a!=null&&N(t,["model"],a);const o=S(e,["createTime"]);o!=null&&N(t,["createTime"],o);const l=S(e,["updateTime"]);l!=null&&N(t,["updateTime"],l);const c=S(e,["expireTime"]);c!=null&&N(t,["expireTime"],c);const d=S(e,["usageMetadata"]);return d!=null&&N(t,["usageMetadata"],d),t}function d8(){return{}}function u8(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>$g(n,o))),N(t,["cachedContents"],a)}return t}function Hg(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["model"]);a!=null&&N(t,["model"],a);const o=S(e,["createTime"]);o!=null&&N(t,["createTime"],o);const l=S(e,["updateTime"]);l!=null&&N(t,["updateTime"],l);const c=S(e,["expireTime"]);c!=null&&N(t,["expireTime"],c);const d=S(e,["usageMetadata"]);return d!=null&&N(t,["usageMetadata"],d),t}function f8(){return{}}function h8(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>Hg(n,o))),N(t,["cachedContents"],a)}return t}var Nf;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Nf||(Nf={}));class Ux{constructor(e,t,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,s)}init(e,t,r){var s,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(a=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class m8 extends ym{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ux(Nf.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=r8(this.apiClient,e);return l=Ot("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>Hg(this.apiClient,m))}else{const d=DH(this.apiClient,e);return l=Ot("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>$g(this.apiClient,m))}}async get(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=s8(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>Hg(this.apiClient,m))}else{const d=OH(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>$g(this.apiClient,m))}}async delete(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=i8(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(()=>{const m=f8(),p=new QM;return Object.assign(p,m),p})}else{const d=IH(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(()=>{const m=d8(),p=new QM;return Object.assign(p,m),p})}}async update(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=o8(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>Hg(this.apiClient,m))}else{const d=RH(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>$g(this.apiClient,m))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=c8(this.apiClient,e);return l=Ot("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=h8(this.apiClient,m),x=new XM;return Object.assign(x,p),x})}else{const d=FH(this.apiClient,e);return l=Ot("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>{const p=u8(this.apiClient,m),x=new XM;return Object.assign(x,p),x})}}}function ak(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Gn(n){return this instanceof Gn?(this.v=n,this):new Gn(n)}function Wh(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(v){return function(_){return Promise.resolve(_).then(v,p)}}function l(v,_){r[v]&&(s[v]=function(w){return new Promise(function(j,P){a.push([v,w,j,P])>1||c(v,w)})},_&&(s[v]=_(s[v])))}function c(v,_){try{d(r[v](_))}catch(w){x(a[0][3],w)}}function d(v){v.value instanceof Gn?Promise.resolve(v.value.v).then(m,p):x(a[0][2],v)}function m(v){c("next",v)}function p(v){c("throw",v)}function x(v,_){v(_),a.shift(),a.length&&c(a[0][0],a[0][1])}}function Yg(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ak=="function"?ak(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(l,c){o=n[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},o)}}function p8(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:hF(t)}function hF(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function g8(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function ok(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const s=[];let a=!0;for(;r<t&&n[r].role==="model";)s.push(n[r]),a&&!hF(n[r])&&(a=!1),r++;a?e.push(...s):e.pop()}return e}class x8{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new y8(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class y8{constructor(e,t,r,s={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=s,this.history=a,this.sendPromise=Promise.resolve(),g8(a)}async sendMessage(e){var t;await this.sendPromise;const r=qs(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,o,l;const c=await s,d=(o=(a=c.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content,m=c.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let x=[];m!=null&&(x=(l=m.slice(p))!==null&&l!==void 0?l:[]);const v=d?[d]:[];this.recordHistory(r,v,x)})(),await this.sendPromise,s}async sendMessageStream(e){var t;await this.sendPromise;const r=qs(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const a=await s;return this.processStreamResponse(a,r)}getHistory(e=!1){const t=e?ok(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var r,s;return Wh(this,arguments,function*(){var o,l,c,d;const m=[];try{for(var p=!0,x=Yg(e),v;v=yield Gn(x.next()),o=v.done,!o;p=!0){d=v.value,p=!1;const _=d;if(p8(_)){const w=(s=(r=_.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;w!==void 0&&m.push(w)}yield yield Gn(_)}}catch(_){l={error:_}}finally{try{!p&&!o&&(c=x.return)&&(yield Gn(c.call(x)))}finally{if(l)throw l.error}}this.recordHistory(t,m)})}recordHistory(e,t,r){let s=[];t.length>0&&t.every(a=>a.role!==void 0)?s=t:s.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...ok(r)):this.history.push(e),this.history.push(...s)}}function v8(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);return t!==void 0&&a!=null&&N(t,["_query","pageToken"],a),r}function b8(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],v8(n,r,t)),t}function _8(n,e){const t={},r=S(e,["details"]);r!=null&&N(t,["details"],r);const s=S(e,["message"]);s!=null&&N(t,["message"],s);const a=S(e,["code"]);return a!=null&&N(t,["code"],a),t}function w8(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["mimeType"]);a!=null&&N(t,["mimeType"],a);const o=S(e,["sizeBytes"]);o!=null&&N(t,["sizeBytes"],o);const l=S(e,["createTime"]);l!=null&&N(t,["createTime"],l);const c=S(e,["expirationTime"]);c!=null&&N(t,["expirationTime"],c);const d=S(e,["updateTime"]);d!=null&&N(t,["updateTime"],d);const m=S(e,["sha256Hash"]);m!=null&&N(t,["sha256Hash"],m);const p=S(e,["uri"]);p!=null&&N(t,["uri"],p);const x=S(e,["downloadUri"]);x!=null&&N(t,["downloadUri"],x);const v=S(e,["state"]);v!=null&&N(t,["state"],v);const _=S(e,["source"]);_!=null&&N(t,["source"],_);const w=S(e,["videoMetadata"]);w!=null&&N(t,["videoMetadata"],w);const j=S(e,["error"]);return j!=null&&N(t,["error"],_8(n,j)),t}function S8(n,e){const t={},r=S(e,["file"]);r!=null&&N(t,["file"],w8(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function j8(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","file"],dF(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function N8(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","file"],dF(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function C8(n,e){const t={},r=S(e,["details"]);r!=null&&N(t,["details"],r);const s=S(e,["message"]);s!=null&&N(t,["message"],s);const a=S(e,["code"]);return a!=null&&N(t,["code"],a),t}function tN(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["mimeType"]);a!=null&&N(t,["mimeType"],a);const o=S(e,["sizeBytes"]);o!=null&&N(t,["sizeBytes"],o);const l=S(e,["createTime"]);l!=null&&N(t,["createTime"],l);const c=S(e,["expirationTime"]);c!=null&&N(t,["expirationTime"],c);const d=S(e,["updateTime"]);d!=null&&N(t,["updateTime"],d);const m=S(e,["sha256Hash"]);m!=null&&N(t,["sha256Hash"],m);const p=S(e,["uri"]);p!=null&&N(t,["uri"],p);const x=S(e,["downloadUri"]);x!=null&&N(t,["downloadUri"],x);const v=S(e,["state"]);v!=null&&N(t,["state"],v);const _=S(e,["source"]);_!=null&&N(t,["source"],_);const w=S(e,["videoMetadata"]);w!=null&&N(t,["videoMetadata"],w);const j=S(e,["error"]);return j!=null&&N(t,["error"],C8(n,j)),t}function T8(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["files"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>tN(n,o))),N(t,["files"],a)}return t}function P8(){return{}}function M8(){return{}}let k8=class extends ym{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ux(Nf.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>tN(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=b8(this.apiClient,e);return a=Ot("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=T8(this.apiClient,c),m=new nH;return Object.assign(m,d),m})}}async createInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=S8(this.apiClient,e);return a=Ot("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=P8(),d=new rH;return Object.assign(d,c),d})}}async get(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=j8(this.apiClient,e);return a=Ot("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>tN(this.apiClient,c))}}async delete(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=N8(this.apiClient,e);return a=Ot("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=M8(),d=new sH;return Object.assign(d,c),d})}}};function E8(n,e){const t={},r=S(e,["voiceName"]);return r!=null&&N(t,["voiceName"],r),t}function D8(n,e){const t={},r=S(e,["voiceName"]);return r!=null&&N(t,["voiceName"],r),t}function mF(n,e){const t={},r=S(e,["prebuiltVoiceConfig"]);return r!=null&&N(t,["prebuiltVoiceConfig"],E8(n,r)),t}function O8(n,e){const t={},r=S(e,["prebuiltVoiceConfig"]);return r!=null&&N(t,["prebuiltVoiceConfig"],D8(n,r)),t}function I8(n,e){const t={},r=S(e,["speaker"]);r!=null&&N(t,["speaker"],r);const s=S(e,["voiceConfig"]);return s!=null&&N(t,["voiceConfig"],mF(n,s)),t}function A8(n,e){const t={},r=S(e,["speakerVoiceConfigs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>I8(n,a))),N(t,["speakerVoiceConfigs"],s)}return t}function R8(n,e){const t={},r=S(e,["voiceConfig"]);r!=null&&N(t,["voiceConfig"],mF(n,r));const s=S(e,["multiSpeakerVoiceConfig"]);s!=null&&N(t,["multiSpeakerVoiceConfig"],A8(n,s));const a=S(e,["languageCode"]);return a!=null&&N(t,["languageCode"],a),t}function L8(n,e){const t={},r=S(e,["voiceConfig"]);if(r!=null&&N(t,["voiceConfig"],O8(n,r)),S(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=S(e,["languageCode"]);return s!=null&&N(t,["languageCode"],s),t}function F8(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function q8(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function z8(n,e){const t={};if(S(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function U8(n,e){const t={},r=S(e,["displayName"]);r!=null&&N(t,["displayName"],r);const s=S(e,["data"]);s!=null&&N(t,["data"],s);const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function V8(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],F8(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],z8(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const m=S(e,["functionResponse"]);m!=null&&N(t,["functionResponse"],m);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function B8(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],q8(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],U8(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const m=S(e,["functionResponse"]);m!=null&&N(t,["functionResponse"],m);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function W8(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>V8(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function $8(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>B8(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function H8(n,e){const t={},r=S(e,["behavior"]);r!=null&&N(t,["behavior"],r);const s=S(e,["description"]);s!=null&&N(t,["description"],s);const a=S(e,["name"]);a!=null&&N(t,["name"],a);const o=S(e,["parameters"]);o!=null&&N(t,["parameters"],o);const l=S(e,["response"]);return l!=null&&N(t,["response"],l),t}function Y8(n,e){const t={};if(S(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=S(e,["description"]);r!=null&&N(t,["description"],r);const s=S(e,["name"]);s!=null&&N(t,["name"],s);const a=S(e,["parameters"]);a!=null&&N(t,["parameters"],a);const o=S(e,["response"]);return o!=null&&N(t,["response"],o),t}function G8(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function Z8(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function K8(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],G8(n,r)),t}function J8(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],Z8(n,r)),t}function Q8(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function X8(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function e9(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],Q8(n,r)),t}function t9(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],X8(n,r)),t}function n9(){return{}}function r9(n,e){const t={},r=S(e,["apiKeyString"]);return r!=null&&N(t,["apiKeyString"],r),t}function s9(n,e){const t={},r=S(e,["apiKeyConfig"]);r!=null&&N(t,["apiKeyConfig"],r9(n,r));const s=S(e,["authType"]);s!=null&&N(t,["authType"],s);const a=S(e,["googleServiceAccountConfig"]);a!=null&&N(t,["googleServiceAccountConfig"],a);const o=S(e,["httpBasicAuthConfig"]);o!=null&&N(t,["httpBasicAuthConfig"],o);const l=S(e,["oauthConfig"]);l!=null&&N(t,["oauthConfig"],l);const c=S(e,["oidcConfig"]);return c!=null&&N(t,["oidcConfig"],c),t}function i9(n,e){const t={},r=S(e,["authConfig"]);return r!=null&&N(t,["authConfig"],s9(n,r)),t}function a9(){return{}}function o9(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>H8(n,d))),N(t,["functionDeclarations"],c)}if(S(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=S(e,["googleSearch"]);s!=null&&N(t,["googleSearch"],K8(n,s));const a=S(e,["googleSearchRetrieval"]);if(a!=null&&N(t,["googleSearchRetrieval"],e9(n,a)),S(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(S(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");S(e,["urlContext"])!=null&&N(t,["urlContext"],a9());const l=S(e,["codeExecution"]);return l!=null&&N(t,["codeExecution"],l),t}function l9(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(p=>Y8(n,p))),N(t,["functionDeclarations"],m)}const s=S(e,["retrieval"]);s!=null&&N(t,["retrieval"],s);const a=S(e,["googleSearch"]);a!=null&&N(t,["googleSearch"],J8(n,a));const o=S(e,["googleSearchRetrieval"]);o!=null&&N(t,["googleSearchRetrieval"],t9(n,o)),S(e,["enterpriseWebSearch"])!=null&&N(t,["enterpriseWebSearch"],n9());const c=S(e,["googleMaps"]);if(c!=null&&N(t,["googleMaps"],i9(n,c)),S(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=S(e,["codeExecution"]);return d!=null&&N(t,["codeExecution"],d),t}function c9(n,e){const t={},r=S(e,["handle"]);if(r!=null&&N(t,["handle"],r),S(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function d9(n,e){const t={},r=S(e,["handle"]);r!=null&&N(t,["handle"],r);const s=S(e,["transparent"]);return s!=null&&N(t,["transparent"],s),t}function lk(){return{}}function ck(){return{}}function u9(n,e){const t={},r=S(e,["disabled"]);r!=null&&N(t,["disabled"],r);const s=S(e,["startOfSpeechSensitivity"]);s!=null&&N(t,["startOfSpeechSensitivity"],s);const a=S(e,["endOfSpeechSensitivity"]);a!=null&&N(t,["endOfSpeechSensitivity"],a);const o=S(e,["prefixPaddingMs"]);o!=null&&N(t,["prefixPaddingMs"],o);const l=S(e,["silenceDurationMs"]);return l!=null&&N(t,["silenceDurationMs"],l),t}function f9(n,e){const t={},r=S(e,["disabled"]);r!=null&&N(t,["disabled"],r);const s=S(e,["startOfSpeechSensitivity"]);s!=null&&N(t,["startOfSpeechSensitivity"],s);const a=S(e,["endOfSpeechSensitivity"]);a!=null&&N(t,["endOfSpeechSensitivity"],a);const o=S(e,["prefixPaddingMs"]);o!=null&&N(t,["prefixPaddingMs"],o);const l=S(e,["silenceDurationMs"]);return l!=null&&N(t,["silenceDurationMs"],l),t}function h9(n,e){const t={},r=S(e,["automaticActivityDetection"]);r!=null&&N(t,["automaticActivityDetection"],u9(n,r));const s=S(e,["activityHandling"]);s!=null&&N(t,["activityHandling"],s);const a=S(e,["turnCoverage"]);return a!=null&&N(t,["turnCoverage"],a),t}function m9(n,e){const t={},r=S(e,["automaticActivityDetection"]);r!=null&&N(t,["automaticActivityDetection"],f9(n,r));const s=S(e,["activityHandling"]);s!=null&&N(t,["activityHandling"],s);const a=S(e,["turnCoverage"]);return a!=null&&N(t,["turnCoverage"],a),t}function p9(n,e){const t={},r=S(e,["targetTokens"]);return r!=null&&N(t,["targetTokens"],r),t}function g9(n,e){const t={},r=S(e,["targetTokens"]);return r!=null&&N(t,["targetTokens"],r),t}function x9(n,e){const t={},r=S(e,["triggerTokens"]);r!=null&&N(t,["triggerTokens"],r);const s=S(e,["slidingWindow"]);return s!=null&&N(t,["slidingWindow"],p9(n,s)),t}function y9(n,e){const t={},r=S(e,["triggerTokens"]);r!=null&&N(t,["triggerTokens"],r);const s=S(e,["slidingWindow"]);return s!=null&&N(t,["slidingWindow"],g9(n,s)),t}function v9(n,e){const t={},r=S(e,["proactiveAudio"]);return r!=null&&N(t,["proactiveAudio"],r),t}function b9(n,e){const t={},r=S(e,["proactiveAudio"]);return r!=null&&N(t,["proactiveAudio"],r),t}function _9(n,e,t){const r={},s=S(e,["generationConfig"]);t!==void 0&&s!=null&&N(t,["setup","generationConfig"],s);const a=S(e,["responseModalities"]);t!==void 0&&a!=null&&N(t,["setup","generationConfig","responseModalities"],a);const o=S(e,["temperature"]);t!==void 0&&o!=null&&N(t,["setup","generationConfig","temperature"],o);const l=S(e,["topP"]);t!==void 0&&l!=null&&N(t,["setup","generationConfig","topP"],l);const c=S(e,["topK"]);t!==void 0&&c!=null&&N(t,["setup","generationConfig","topK"],c);const d=S(e,["maxOutputTokens"]);t!==void 0&&d!=null&&N(t,["setup","generationConfig","maxOutputTokens"],d);const m=S(e,["mediaResolution"]);t!==void 0&&m!=null&&N(t,["setup","generationConfig","mediaResolution"],m);const p=S(e,["seed"]);t!==void 0&&p!=null&&N(t,["setup","generationConfig","seed"],p);const x=S(e,["speechConfig"]);t!==void 0&&x!=null&&N(t,["setup","generationConfig","speechConfig"],R8(n,lF(n,x)));const v=S(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&N(t,["setup","generationConfig","enableAffectiveDialog"],v);const _=S(e,["systemInstruction"]);t!==void 0&&_!=null&&N(t,["setup","systemInstruction"],W8(n,qs(n,_)));const w=S(e,["tools"]);if(t!==void 0&&w!=null){let O=zx(n,w);Array.isArray(O)&&(O=O.map(q=>o9(n,qx(n,q)))),N(t,["setup","tools"],O)}const j=S(e,["sessionResumption"]);t!==void 0&&j!=null&&N(t,["setup","sessionResumption"],c9(n,j));const P=S(e,["inputAudioTranscription"]);t!==void 0&&P!=null&&N(t,["setup","inputAudioTranscription"],lk());const k=S(e,["outputAudioTranscription"]);t!==void 0&&k!=null&&N(t,["setup","outputAudioTranscription"],lk());const I=S(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&N(t,["setup","realtimeInputConfig"],h9(n,I));const M=S(e,["contextWindowCompression"]);t!==void 0&&M!=null&&N(t,["setup","contextWindowCompression"],x9(n,M));const D=S(e,["proactivity"]);return t!==void 0&&D!=null&&N(t,["setup","proactivity"],v9(n,D)),r}function w9(n,e,t){const r={},s=S(e,["generationConfig"]);t!==void 0&&s!=null&&N(t,["setup","generationConfig"],s);const a=S(e,["responseModalities"]);t!==void 0&&a!=null&&N(t,["setup","generationConfig","responseModalities"],a);const o=S(e,["temperature"]);t!==void 0&&o!=null&&N(t,["setup","generationConfig","temperature"],o);const l=S(e,["topP"]);t!==void 0&&l!=null&&N(t,["setup","generationConfig","topP"],l);const c=S(e,["topK"]);t!==void 0&&c!=null&&N(t,["setup","generationConfig","topK"],c);const d=S(e,["maxOutputTokens"]);t!==void 0&&d!=null&&N(t,["setup","generationConfig","maxOutputTokens"],d);const m=S(e,["mediaResolution"]);t!==void 0&&m!=null&&N(t,["setup","generationConfig","mediaResolution"],m);const p=S(e,["seed"]);t!==void 0&&p!=null&&N(t,["setup","generationConfig","seed"],p);const x=S(e,["speechConfig"]);t!==void 0&&x!=null&&N(t,["setup","generationConfig","speechConfig"],L8(n,lF(n,x)));const v=S(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&N(t,["setup","generationConfig","enableAffectiveDialog"],v);const _=S(e,["systemInstruction"]);t!==void 0&&_!=null&&N(t,["setup","systemInstruction"],$8(n,qs(n,_)));const w=S(e,["tools"]);if(t!==void 0&&w!=null){let O=zx(n,w);Array.isArray(O)&&(O=O.map(q=>l9(n,qx(n,q)))),N(t,["setup","tools"],O)}const j=S(e,["sessionResumption"]);t!==void 0&&j!=null&&N(t,["setup","sessionResumption"],d9(n,j));const P=S(e,["inputAudioTranscription"]);t!==void 0&&P!=null&&N(t,["setup","inputAudioTranscription"],ck());const k=S(e,["outputAudioTranscription"]);t!==void 0&&k!=null&&N(t,["setup","outputAudioTranscription"],ck());const I=S(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&N(t,["setup","realtimeInputConfig"],m9(n,I));const M=S(e,["contextWindowCompression"]);t!==void 0&&M!=null&&N(t,["setup","contextWindowCompression"],y9(n,M));const D=S(e,["proactivity"]);return t!==void 0&&D!=null&&N(t,["setup","proactivity"],b9(n,D)),r}function S9(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["setup","model"],zn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],_9(n,s,t)),t}function j9(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["setup","model"],zn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],w9(n,s,t)),t}function N9(){return{}}function C9(){return{}}function T9(){return{}}function P9(){return{}}function M9(n,e){const t={},r=S(e,["media"]);r!=null&&N(t,["mediaChunks"],sF(n,r));const s=S(e,["audio"]);s!=null&&N(t,["audio"],lH(n,s));const a=S(e,["audioStreamEnd"]);a!=null&&N(t,["audioStreamEnd"],a);const o=S(e,["video"]);o!=null&&N(t,["video"],oH(n,o));const l=S(e,["text"]);return l!=null&&N(t,["text"],l),S(e,["activityStart"])!=null&&N(t,["activityStart"],N9()),S(e,["activityEnd"])!=null&&N(t,["activityEnd"],T9()),t}function k9(n,e){const t={},r=S(e,["media"]);if(r!=null&&N(t,["mediaChunks"],sF(n,r)),S(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=S(e,["audioStreamEnd"]);if(s!=null&&N(t,["audioStreamEnd"],s),S(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(S(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return S(e,["activityStart"])!=null&&N(t,["activityStart"],C9()),S(e,["activityEnd"])!=null&&N(t,["activityEnd"],P9()),t}function pF(n,e){const t={},r=S(e,["text"]);r!=null&&N(t,["text"],r);const s=S(e,["weight"]);return s!=null&&N(t,["weight"],s),t}function E9(n,e){const t={},r=S(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>pF(n,a))),N(t,["weightedPrompts"],s)}return t}function gF(n,e){const t={},r=S(e,["temperature"]);r!=null&&N(t,["temperature"],r);const s=S(e,["topK"]);s!=null&&N(t,["topK"],s);const a=S(e,["seed"]);a!=null&&N(t,["seed"],a);const o=S(e,["guidance"]);o!=null&&N(t,["guidance"],o);const l=S(e,["bpm"]);l!=null&&N(t,["bpm"],l);const c=S(e,["density"]);c!=null&&N(t,["density"],c);const d=S(e,["brightness"]);d!=null&&N(t,["brightness"],d);const m=S(e,["scale"]);m!=null&&N(t,["scale"],m);const p=S(e,["muteBass"]);p!=null&&N(t,["muteBass"],p);const x=S(e,["muteDrums"]);x!=null&&N(t,["muteDrums"],x);const v=S(e,["onlyBassAndDrums"]);v!=null&&N(t,["onlyBassAndDrums"],v);const _=S(e,["musicGenerationMode"]);return _!=null&&N(t,["musicGenerationMode"],_),t}function D9(n,e){const t={},r=S(e,["musicGenerationConfig"]);return r!=null&&N(t,["musicGenerationConfig"],gF(n,r)),t}function xF(n,e){const t={},r=S(e,["model"]);return r!=null&&N(t,["model"],r),t}function yF(n,e){const t={},r=S(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>pF(n,a))),N(t,["weightedPrompts"],s)}return t}function nN(n,e){const t={},r=S(e,["setup"]);r!=null&&N(t,["setup"],xF(n,r));const s=S(e,["clientContent"]);s!=null&&N(t,["clientContent"],yF(n,s));const a=S(e,["musicGenerationConfig"]);a!=null&&N(t,["musicGenerationConfig"],gF(n,a));const o=S(e,["playbackControl"]);return o!=null&&N(t,["playbackControl"],o),t}function O9(){return{}}function I9(){return{}}function A9(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function R9(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function L9(n,e){const t={},r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function F9(n,e){const t={},r=S(e,["displayName"]);r!=null&&N(t,["displayName"],r);const s=S(e,["data"]);s!=null&&N(t,["data"],s);const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function q9(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],A9(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],L9(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const m=S(e,["functionResponse"]);m!=null&&N(t,["functionResponse"],m);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function z9(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],R9(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],F9(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const m=S(e,["functionResponse"]);m!=null&&N(t,["functionResponse"],m);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function U9(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>q9(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function V9(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>z9(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function dk(n,e){const t={},r=S(e,["text"]);r!=null&&N(t,["text"],r);const s=S(e,["finished"]);return s!=null&&N(t,["finished"],s),t}function uk(n,e){const t={},r=S(e,["text"]);r!=null&&N(t,["text"],r);const s=S(e,["finished"]);return s!=null&&N(t,["finished"],s),t}function B9(n,e){const t={},r=S(e,["retrievedUrl"]);r!=null&&N(t,["retrievedUrl"],r);const s=S(e,["urlRetrievalStatus"]);return s!=null&&N(t,["urlRetrievalStatus"],s),t}function W9(n,e){const t={},r=S(e,["urlMetadata"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>B9(n,a))),N(t,["urlMetadata"],s)}return t}function $9(n,e){const t={},r=S(e,["modelTurn"]);r!=null&&N(t,["modelTurn"],U9(n,r));const s=S(e,["turnComplete"]);s!=null&&N(t,["turnComplete"],s);const a=S(e,["interrupted"]);a!=null&&N(t,["interrupted"],a);const o=S(e,["groundingMetadata"]);o!=null&&N(t,["groundingMetadata"],o);const l=S(e,["generationComplete"]);l!=null&&N(t,["generationComplete"],l);const c=S(e,["inputTranscription"]);c!=null&&N(t,["inputTranscription"],dk(n,c));const d=S(e,["outputTranscription"]);d!=null&&N(t,["outputTranscription"],dk(n,d));const m=S(e,["urlContextMetadata"]);return m!=null&&N(t,["urlContextMetadata"],W9(n,m)),t}function H9(n,e){const t={},r=S(e,["modelTurn"]);r!=null&&N(t,["modelTurn"],V9(n,r));const s=S(e,["turnComplete"]);s!=null&&N(t,["turnComplete"],s);const a=S(e,["interrupted"]);a!=null&&N(t,["interrupted"],a);const o=S(e,["groundingMetadata"]);o!=null&&N(t,["groundingMetadata"],o);const l=S(e,["generationComplete"]);l!=null&&N(t,["generationComplete"],l);const c=S(e,["inputTranscription"]);c!=null&&N(t,["inputTranscription"],uk(n,c));const d=S(e,["outputTranscription"]);return d!=null&&N(t,["outputTranscription"],uk(n,d)),t}function Y9(n,e){const t={},r=S(e,["id"]);r!=null&&N(t,["id"],r);const s=S(e,["args"]);s!=null&&N(t,["args"],s);const a=S(e,["name"]);return a!=null&&N(t,["name"],a),t}function G9(n,e){const t={},r=S(e,["args"]);r!=null&&N(t,["args"],r);const s=S(e,["name"]);return s!=null&&N(t,["name"],s),t}function Z9(n,e){const t={},r=S(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>Y9(n,a))),N(t,["functionCalls"],s)}return t}function K9(n,e){const t={},r=S(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>G9(n,a))),N(t,["functionCalls"],s)}return t}function J9(n,e){const t={},r=S(e,["ids"]);return r!=null&&N(t,["ids"],r),t}function Q9(n,e){const t={},r=S(e,["ids"]);return r!=null&&N(t,["ids"],r),t}function Pp(n,e){const t={},r=S(e,["modality"]);r!=null&&N(t,["modality"],r);const s=S(e,["tokenCount"]);return s!=null&&N(t,["tokenCount"],s),t}function Mp(n,e){const t={},r=S(e,["modality"]);r!=null&&N(t,["modality"],r);const s=S(e,["tokenCount"]);return s!=null&&N(t,["tokenCount"],s),t}function X9(n,e){const t={},r=S(e,["promptTokenCount"]);r!=null&&N(t,["promptTokenCount"],r);const s=S(e,["cachedContentTokenCount"]);s!=null&&N(t,["cachedContentTokenCount"],s);const a=S(e,["responseTokenCount"]);a!=null&&N(t,["responseTokenCount"],a);const o=S(e,["toolUsePromptTokenCount"]);o!=null&&N(t,["toolUsePromptTokenCount"],o);const l=S(e,["thoughtsTokenCount"]);l!=null&&N(t,["thoughtsTokenCount"],l);const c=S(e,["totalTokenCount"]);c!=null&&N(t,["totalTokenCount"],c);const d=S(e,["promptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(_=>Pp(n,_))),N(t,["promptTokensDetails"],v)}const m=S(e,["cacheTokensDetails"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(_=>Pp(n,_))),N(t,["cacheTokensDetails"],v)}const p=S(e,["responseTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(_=>Pp(n,_))),N(t,["responseTokensDetails"],v)}const x=S(e,["toolUsePromptTokensDetails"]);if(x!=null){let v=x;Array.isArray(v)&&(v=v.map(_=>Pp(n,_))),N(t,["toolUsePromptTokensDetails"],v)}return t}function e7(n,e){const t={},r=S(e,["promptTokenCount"]);r!=null&&N(t,["promptTokenCount"],r);const s=S(e,["cachedContentTokenCount"]);s!=null&&N(t,["cachedContentTokenCount"],s);const a=S(e,["candidatesTokenCount"]);a!=null&&N(t,["responseTokenCount"],a);const o=S(e,["toolUsePromptTokenCount"]);o!=null&&N(t,["toolUsePromptTokenCount"],o);const l=S(e,["thoughtsTokenCount"]);l!=null&&N(t,["thoughtsTokenCount"],l);const c=S(e,["totalTokenCount"]);c!=null&&N(t,["totalTokenCount"],c);const d=S(e,["promptTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(w=>Mp(n,w))),N(t,["promptTokensDetails"],_)}const m=S(e,["cacheTokensDetails"]);if(m!=null){let _=m;Array.isArray(_)&&(_=_.map(w=>Mp(n,w))),N(t,["cacheTokensDetails"],_)}const p=S(e,["candidatesTokensDetails"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(w=>Mp(n,w))),N(t,["responseTokensDetails"],_)}const x=S(e,["toolUsePromptTokensDetails"]);if(x!=null){let _=x;Array.isArray(_)&&(_=_.map(w=>Mp(n,w))),N(t,["toolUsePromptTokensDetails"],_)}const v=S(e,["trafficType"]);return v!=null&&N(t,["trafficType"],v),t}function t7(n,e){const t={},r=S(e,["timeLeft"]);return r!=null&&N(t,["timeLeft"],r),t}function n7(n,e){const t={},r=S(e,["timeLeft"]);return r!=null&&N(t,["timeLeft"],r),t}function r7(n,e){const t={},r=S(e,["newHandle"]);r!=null&&N(t,["newHandle"],r);const s=S(e,["resumable"]);s!=null&&N(t,["resumable"],s);const a=S(e,["lastConsumedClientMessageIndex"]);return a!=null&&N(t,["lastConsumedClientMessageIndex"],a),t}function s7(n,e){const t={},r=S(e,["newHandle"]);r!=null&&N(t,["newHandle"],r);const s=S(e,["resumable"]);s!=null&&N(t,["resumable"],s);const a=S(e,["lastConsumedClientMessageIndex"]);return a!=null&&N(t,["lastConsumedClientMessageIndex"],a),t}function i7(n,e){const t={};S(e,["setupComplete"])!=null&&N(t,["setupComplete"],O9());const s=S(e,["serverContent"]);s!=null&&N(t,["serverContent"],$9(n,s));const a=S(e,["toolCall"]);a!=null&&N(t,["toolCall"],Z9(n,a));const o=S(e,["toolCallCancellation"]);o!=null&&N(t,["toolCallCancellation"],J9(n,o));const l=S(e,["usageMetadata"]);l!=null&&N(t,["usageMetadata"],X9(n,l));const c=S(e,["goAway"]);c!=null&&N(t,["goAway"],t7(n,c));const d=S(e,["sessionResumptionUpdate"]);return d!=null&&N(t,["sessionResumptionUpdate"],r7(n,d)),t}function a7(n,e){const t={};S(e,["setupComplete"])!=null&&N(t,["setupComplete"],I9());const s=S(e,["serverContent"]);s!=null&&N(t,["serverContent"],H9(n,s));const a=S(e,["toolCall"]);a!=null&&N(t,["toolCall"],K9(n,a));const o=S(e,["toolCallCancellation"]);o!=null&&N(t,["toolCallCancellation"],Q9(n,o));const l=S(e,["usageMetadata"]);l!=null&&N(t,["usageMetadata"],e7(n,l));const c=S(e,["goAway"]);c!=null&&N(t,["goAway"],n7(n,c));const d=S(e,["sessionResumptionUpdate"]);return d!=null&&N(t,["sessionResumptionUpdate"],s7(n,d)),t}function o7(){return{}}function l7(n,e){const t={},r=S(e,["text"]);r!=null&&N(t,["text"],r);const s=S(e,["weight"]);return s!=null&&N(t,["weight"],s),t}function c7(n,e){const t={},r=S(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>l7(n,a))),N(t,["weightedPrompts"],s)}return t}function d7(n,e){const t={},r=S(e,["temperature"]);r!=null&&N(t,["temperature"],r);const s=S(e,["topK"]);s!=null&&N(t,["topK"],s);const a=S(e,["seed"]);a!=null&&N(t,["seed"],a);const o=S(e,["guidance"]);o!=null&&N(t,["guidance"],o);const l=S(e,["bpm"]);l!=null&&N(t,["bpm"],l);const c=S(e,["density"]);c!=null&&N(t,["density"],c);const d=S(e,["brightness"]);d!=null&&N(t,["brightness"],d);const m=S(e,["scale"]);m!=null&&N(t,["scale"],m);const p=S(e,["muteBass"]);p!=null&&N(t,["muteBass"],p);const x=S(e,["muteDrums"]);x!=null&&N(t,["muteDrums"],x);const v=S(e,["onlyBassAndDrums"]);v!=null&&N(t,["onlyBassAndDrums"],v);const _=S(e,["musicGenerationMode"]);return _!=null&&N(t,["musicGenerationMode"],_),t}function u7(n,e){const t={},r=S(e,["clientContent"]);r!=null&&N(t,["clientContent"],c7(n,r));const s=S(e,["musicGenerationConfig"]);return s!=null&&N(t,["musicGenerationConfig"],d7(n,s)),t}function f7(n,e){const t={},r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);s!=null&&N(t,["mimeType"],s);const a=S(e,["sourceMetadata"]);return a!=null&&N(t,["sourceMetadata"],u7(n,a)),t}function h7(n,e){const t={},r=S(e,["audioChunks"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>f7(n,a))),N(t,["audioChunks"],s)}return t}function m7(n,e){const t={},r=S(e,["text"]);r!=null&&N(t,["text"],r);const s=S(e,["filteredReason"]);return s!=null&&N(t,["filteredReason"],s),t}function p7(n,e){const t={};S(e,["setupComplete"])!=null&&N(t,["setupComplete"],o7());const s=S(e,["serverContent"]);s!=null&&N(t,["serverContent"],h7(n,s));const a=S(e,["filteredPrompt"]);return a!=null&&N(t,["filteredPrompt"],m7(n,a)),t}function g7(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function x7(n,e){const t={};if(S(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function y7(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],g7(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],x7(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const m=S(e,["functionResponse"]);m!=null&&N(t,["functionResponse"],m);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function Vx(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>y7(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function v7(n,e){const t={};if(S(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=S(e,["category"]);r!=null&&N(t,["category"],r);const s=S(e,["threshold"]);return s!=null&&N(t,["threshold"],s),t}function b7(n,e){const t={},r=S(e,["behavior"]);r!=null&&N(t,["behavior"],r);const s=S(e,["description"]);s!=null&&N(t,["description"],s);const a=S(e,["name"]);a!=null&&N(t,["name"],a);const o=S(e,["parameters"]);o!=null&&N(t,["parameters"],o);const l=S(e,["response"]);return l!=null&&N(t,["response"],l),t}function _7(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function w7(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],_7(n,r)),t}function S7(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function j7(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],S7(n,r)),t}function N7(){return{}}function C7(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>b7(n,d))),N(t,["functionDeclarations"],c)}if(S(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=S(e,["googleSearch"]);s!=null&&N(t,["googleSearch"],w7(n,s));const a=S(e,["googleSearchRetrieval"]);if(a!=null&&N(t,["googleSearchRetrieval"],j7(n,a)),S(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(S(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");S(e,["urlContext"])!=null&&N(t,["urlContext"],N7());const l=S(e,["codeExecution"]);return l!=null&&N(t,["codeExecution"],l),t}function T7(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["allowedFunctionNames"]);return s!=null&&N(t,["allowedFunctionNames"],s),t}function P7(n,e){const t={},r=S(e,["latitude"]);r!=null&&N(t,["latitude"],r);const s=S(e,["longitude"]);return s!=null&&N(t,["longitude"],s),t}function M7(n,e){const t={},r=S(e,["latLng"]);return r!=null&&N(t,["latLng"],P7(n,r)),t}function k7(n,e){const t={},r=S(e,["functionCallingConfig"]);r!=null&&N(t,["functionCallingConfig"],T7(n,r));const s=S(e,["retrievalConfig"]);return s!=null&&N(t,["retrievalConfig"],M7(n,s)),t}function E7(n,e){const t={},r=S(e,["voiceName"]);return r!=null&&N(t,["voiceName"],r),t}function vF(n,e){const t={},r=S(e,["prebuiltVoiceConfig"]);return r!=null&&N(t,["prebuiltVoiceConfig"],E7(n,r)),t}function D7(n,e){const t={},r=S(e,["speaker"]);r!=null&&N(t,["speaker"],r);const s=S(e,["voiceConfig"]);return s!=null&&N(t,["voiceConfig"],vF(n,s)),t}function O7(n,e){const t={},r=S(e,["speakerVoiceConfigs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>D7(n,a))),N(t,["speakerVoiceConfigs"],s)}return t}function I7(n,e){const t={},r=S(e,["voiceConfig"]);r!=null&&N(t,["voiceConfig"],vF(n,r));const s=S(e,["multiSpeakerVoiceConfig"]);s!=null&&N(t,["multiSpeakerVoiceConfig"],O7(n,s));const a=S(e,["languageCode"]);return a!=null&&N(t,["languageCode"],a),t}function A7(n,e){const t={},r=S(e,["includeThoughts"]);r!=null&&N(t,["includeThoughts"],r);const s=S(e,["thinkingBudget"]);return s!=null&&N(t,["thinkingBudget"],s),t}function R7(n,e,t){const r={},s=S(e,["systemInstruction"]);t!==void 0&&s!=null&&N(t,["systemInstruction"],Vx(n,qs(n,s)));const a=S(e,["temperature"]);a!=null&&N(r,["temperature"],a);const o=S(e,["topP"]);o!=null&&N(r,["topP"],o);const l=S(e,["topK"]);l!=null&&N(r,["topK"],l);const c=S(e,["candidateCount"]);c!=null&&N(r,["candidateCount"],c);const d=S(e,["maxOutputTokens"]);d!=null&&N(r,["maxOutputTokens"],d);const m=S(e,["stopSequences"]);m!=null&&N(r,["stopSequences"],m);const p=S(e,["responseLogprobs"]);p!=null&&N(r,["responseLogprobs"],p);const x=S(e,["logprobs"]);x!=null&&N(r,["logprobs"],x);const v=S(e,["presencePenalty"]);v!=null&&N(r,["presencePenalty"],v);const _=S(e,["frequencyPenalty"]);_!=null&&N(r,["frequencyPenalty"],_);const w=S(e,["seed"]);w!=null&&N(r,["seed"],w);const j=S(e,["responseMimeType"]);j!=null&&N(r,["responseMimeType"],j);const P=S(e,["responseSchema"]);if(P!=null&&N(r,["responseSchema"],px(n,P)),S(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(S(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=S(e,["safetySettings"]);if(t!==void 0&&k!=null){let B=k;Array.isArray(B)&&(B=B.map(G=>v7(n,G))),N(t,["safetySettings"],B)}const I=S(e,["tools"]);if(t!==void 0&&I!=null){let B=zx(n,I);Array.isArray(B)&&(B=B.map(G=>C7(n,qx(n,G)))),N(t,["tools"],B)}const M=S(e,["toolConfig"]);if(t!==void 0&&M!=null&&N(t,["toolConfig"],k7(n,M)),S(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const D=S(e,["cachedContent"]);t!==void 0&&D!=null&&N(t,["cachedContent"],Yc(n,D));const O=S(e,["responseModalities"]);O!=null&&N(r,["responseModalities"],O);const q=S(e,["mediaResolution"]);q!=null&&N(r,["mediaResolution"],q);const F=S(e,["speechConfig"]);if(F!=null&&N(r,["speechConfig"],I7(n,oF(n,F))),S(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=S(e,["thinkingConfig"]);return U!=null&&N(r,["thinkingConfig"],A7(n,U)),r}function fk(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["contents"]);if(s!=null){let o=wa(n,s);Array.isArray(o)&&(o=o.map(l=>Vx(n,l))),N(t,["contents"],o)}const a=S(e,["config"]);return a!=null&&N(t,["generationConfig"],R7(n,a,t)),t}function L7(n,e,t){const r={},s=S(e,["taskType"]);t!==void 0&&s!=null&&N(t,["requests[]","taskType"],s);const a=S(e,["title"]);t!==void 0&&a!=null&&N(t,["requests[]","title"],a);const o=S(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&N(t,["requests[]","outputDimensionality"],o),S(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(S(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function F7(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["contents"]);s!=null&&N(t,["requests[]","content"],aF(n,s));const a=S(e,["config"]);a!=null&&N(t,["config"],L7(n,a,t));const o=S(e,["model"]);return o!==void 0&&N(t,["requests[]","model"],zn(n,o)),t}function q7(n,e,t){const r={};if(S(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(S(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=S(e,["numberOfImages"]);t!==void 0&&s!=null&&N(t,["parameters","sampleCount"],s);const a=S(e,["aspectRatio"]);t!==void 0&&a!=null&&N(t,["parameters","aspectRatio"],a);const o=S(e,["guidanceScale"]);if(t!==void 0&&o!=null&&N(t,["parameters","guidanceScale"],o),S(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=S(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&N(t,["parameters","safetySetting"],l);const c=S(e,["personGeneration"]);t!==void 0&&c!=null&&N(t,["parameters","personGeneration"],c);const d=S(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&N(t,["parameters","includeSafetyAttributes"],d);const m=S(e,["includeRaiReason"]);t!==void 0&&m!=null&&N(t,["parameters","includeRaiReason"],m);const p=S(e,["language"]);t!==void 0&&p!=null&&N(t,["parameters","language"],p);const x=S(e,["outputMimeType"]);t!==void 0&&x!=null&&N(t,["parameters","outputOptions","mimeType"],x);const v=S(e,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&N(t,["parameters","outputOptions","compressionQuality"],v),S(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(S(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function z7(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["prompt"]);s!=null&&N(t,["instances[0]","prompt"],s);const a=S(e,["config"]);return a!=null&&N(t,["config"],q7(n,a,t)),t}function U7(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","name"],zn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function V7(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);t!==void 0&&a!=null&&N(t,["_query","pageToken"],a);const o=S(e,["filter"]);t!==void 0&&o!=null&&N(t,["_query","filter"],o);const l=S(e,["queryBase"]);return t!==void 0&&l!=null&&N(t,["_url","models_url"],uF(n,l)),r}function B7(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],V7(n,r,t)),t}function W7(n,e,t){const r={},s=S(e,["displayName"]);t!==void 0&&s!=null&&N(t,["displayName"],s);const a=S(e,["description"]);t!==void 0&&a!=null&&N(t,["description"],a);const o=S(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&N(t,["defaultCheckpointId"],o),r}function $7(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","name"],zn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],W7(n,s,t)),t}function H7(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","name"],zn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function Y7(n,e){const t={};if(S(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(S(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(S(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function G7(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["contents"]);if(s!=null){let o=wa(n,s);Array.isArray(o)&&(o=o.map(l=>Vx(n,l))),N(t,["contents"],o)}const a=S(e,["config"]);return a!=null&&N(t,["config"],Y7(n,a)),t}function Z7(n,e){const t={};if(S(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=S(e,["imageBytes"]);r!=null&&N(t,["bytesBase64Encoded"],Gc(n,r));const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function K7(n,e,t){const r={},s=S(e,["numberOfVideos"]);if(t!==void 0&&s!=null&&N(t,["parameters","sampleCount"],s),S(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(S(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=S(e,["durationSeconds"]);if(t!==void 0&&a!=null&&N(t,["parameters","durationSeconds"],a),S(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=S(e,["aspectRatio"]);if(t!==void 0&&o!=null&&N(t,["parameters","aspectRatio"],o),S(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=S(e,["personGeneration"]);if(t!==void 0&&l!=null&&N(t,["parameters","personGeneration"],l),S(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=S(e,["negativePrompt"]);if(t!==void 0&&c!=null&&N(t,["parameters","negativePrompt"],c),S(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function J7(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["prompt"]);s!=null&&N(t,["instances[0]","prompt"],s);const a=S(e,["image"]);a!=null&&N(t,["instances[0]","image"],Z7(n,a));const o=S(e,["config"]);return o!=null&&N(t,["config"],K7(n,o,t)),t}function Q7(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function X7(n,e){const t={},r=S(e,["displayName"]);r!=null&&N(t,["displayName"],r);const s=S(e,["data"]);s!=null&&N(t,["data"],s);const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function eY(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],Q7(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],X7(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const m=S(e,["functionResponse"]);m!=null&&N(t,["functionResponse"],m);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function Af(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>eY(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function tY(n,e){const t={},r=S(e,["featureSelectionPreference"]);return r!=null&&N(t,["featureSelectionPreference"],r),t}function nY(n,e){const t={},r=S(e,["method"]);r!=null&&N(t,["method"],r);const s=S(e,["category"]);s!=null&&N(t,["category"],s);const a=S(e,["threshold"]);return a!=null&&N(t,["threshold"],a),t}function rY(n,e){const t={};if(S(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=S(e,["description"]);r!=null&&N(t,["description"],r);const s=S(e,["name"]);s!=null&&N(t,["name"],s);const a=S(e,["parameters"]);a!=null&&N(t,["parameters"],a);const o=S(e,["response"]);return o!=null&&N(t,["response"],o),t}function sY(n,e){const t={},r=S(e,["startTime"]);r!=null&&N(t,["startTime"],r);const s=S(e,["endTime"]);return s!=null&&N(t,["endTime"],s),t}function iY(n,e){const t={},r=S(e,["timeRangeFilter"]);return r!=null&&N(t,["timeRangeFilter"],sY(n,r)),t}function aY(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["dynamicThreshold"]);return s!=null&&N(t,["dynamicThreshold"],s),t}function oY(n,e){const t={},r=S(e,["dynamicRetrievalConfig"]);return r!=null&&N(t,["dynamicRetrievalConfig"],aY(n,r)),t}function lY(){return{}}function cY(n,e){const t={},r=S(e,["apiKeyString"]);return r!=null&&N(t,["apiKeyString"],r),t}function dY(n,e){const t={},r=S(e,["apiKeyConfig"]);r!=null&&N(t,["apiKeyConfig"],cY(n,r));const s=S(e,["authType"]);s!=null&&N(t,["authType"],s);const a=S(e,["googleServiceAccountConfig"]);a!=null&&N(t,["googleServiceAccountConfig"],a);const o=S(e,["httpBasicAuthConfig"]);o!=null&&N(t,["httpBasicAuthConfig"],o);const l=S(e,["oauthConfig"]);l!=null&&N(t,["oauthConfig"],l);const c=S(e,["oidcConfig"]);return c!=null&&N(t,["oidcConfig"],c),t}function uY(n,e){const t={},r=S(e,["authConfig"]);return r!=null&&N(t,["authConfig"],dY(n,r)),t}function bF(n,e){const t={},r=S(e,["functionDeclarations"]);if(r!=null){let m=r;Array.isArray(m)&&(m=m.map(p=>rY(n,p))),N(t,["functionDeclarations"],m)}const s=S(e,["retrieval"]);s!=null&&N(t,["retrieval"],s);const a=S(e,["googleSearch"]);a!=null&&N(t,["googleSearch"],iY(n,a));const o=S(e,["googleSearchRetrieval"]);o!=null&&N(t,["googleSearchRetrieval"],oY(n,o)),S(e,["enterpriseWebSearch"])!=null&&N(t,["enterpriseWebSearch"],lY());const c=S(e,["googleMaps"]);if(c!=null&&N(t,["googleMaps"],uY(n,c)),S(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=S(e,["codeExecution"]);return d!=null&&N(t,["codeExecution"],d),t}function fY(n,e){const t={},r=S(e,["mode"]);r!=null&&N(t,["mode"],r);const s=S(e,["allowedFunctionNames"]);return s!=null&&N(t,["allowedFunctionNames"],s),t}function hY(n,e){const t={},r=S(e,["latitude"]);r!=null&&N(t,["latitude"],r);const s=S(e,["longitude"]);return s!=null&&N(t,["longitude"],s),t}function mY(n,e){const t={},r=S(e,["latLng"]);return r!=null&&N(t,["latLng"],hY(n,r)),t}function pY(n,e){const t={},r=S(e,["functionCallingConfig"]);r!=null&&N(t,["functionCallingConfig"],fY(n,r));const s=S(e,["retrievalConfig"]);return s!=null&&N(t,["retrievalConfig"],mY(n,s)),t}function gY(n,e){const t={},r=S(e,["voiceName"]);return r!=null&&N(t,["voiceName"],r),t}function xY(n,e){const t={},r=S(e,["prebuiltVoiceConfig"]);return r!=null&&N(t,["prebuiltVoiceConfig"],gY(n,r)),t}function yY(n,e){const t={},r=S(e,["voiceConfig"]);if(r!=null&&N(t,["voiceConfig"],xY(n,r)),S(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=S(e,["languageCode"]);return s!=null&&N(t,["languageCode"],s),t}function vY(n,e){const t={},r=S(e,["includeThoughts"]);r!=null&&N(t,["includeThoughts"],r);const s=S(e,["thinkingBudget"]);return s!=null&&N(t,["thinkingBudget"],s),t}function bY(n,e,t){const r={},s=S(e,["systemInstruction"]);t!==void 0&&s!=null&&N(t,["systemInstruction"],Af(n,qs(n,s)));const a=S(e,["temperature"]);a!=null&&N(r,["temperature"],a);const o=S(e,["topP"]);o!=null&&N(r,["topP"],o);const l=S(e,["topK"]);l!=null&&N(r,["topK"],l);const c=S(e,["candidateCount"]);c!=null&&N(r,["candidateCount"],c);const d=S(e,["maxOutputTokens"]);d!=null&&N(r,["maxOutputTokens"],d);const m=S(e,["stopSequences"]);m!=null&&N(r,["stopSequences"],m);const p=S(e,["responseLogprobs"]);p!=null&&N(r,["responseLogprobs"],p);const x=S(e,["logprobs"]);x!=null&&N(r,["logprobs"],x);const v=S(e,["presencePenalty"]);v!=null&&N(r,["presencePenalty"],v);const _=S(e,["frequencyPenalty"]);_!=null&&N(r,["frequencyPenalty"],_);const w=S(e,["seed"]);w!=null&&N(r,["seed"],w);const j=S(e,["responseMimeType"]);j!=null&&N(r,["responseMimeType"],j);const P=S(e,["responseSchema"]);P!=null&&N(r,["responseSchema"],px(n,P));const k=S(e,["routingConfig"]);k!=null&&N(r,["routingConfig"],k);const I=S(e,["modelSelectionConfig"]);I!=null&&N(r,["modelConfig"],tY(n,I));const M=S(e,["safetySettings"]);if(t!==void 0&&M!=null){let Y=M;Array.isArray(Y)&&(Y=Y.map(ne=>nY(n,ne))),N(t,["safetySettings"],Y)}const D=S(e,["tools"]);if(t!==void 0&&D!=null){let Y=zx(n,D);Array.isArray(Y)&&(Y=Y.map(ne=>bF(n,qx(n,ne)))),N(t,["tools"],Y)}const O=S(e,["toolConfig"]);t!==void 0&&O!=null&&N(t,["toolConfig"],pY(n,O));const q=S(e,["labels"]);t!==void 0&&q!=null&&N(t,["labels"],q);const F=S(e,["cachedContent"]);t!==void 0&&F!=null&&N(t,["cachedContent"],Yc(n,F));const U=S(e,["responseModalities"]);U!=null&&N(r,["responseModalities"],U);const B=S(e,["mediaResolution"]);B!=null&&N(r,["mediaResolution"],B);const G=S(e,["speechConfig"]);G!=null&&N(r,["speechConfig"],yY(n,oF(n,G)));const X=S(e,["audioTimestamp"]);X!=null&&N(r,["audioTimestamp"],X);const Q=S(e,["thinkingConfig"]);return Q!=null&&N(r,["thinkingConfig"],vY(n,Q)),r}function hk(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["contents"]);if(s!=null){let o=wa(n,s);Array.isArray(o)&&(o=o.map(l=>Af(n,l))),N(t,["contents"],o)}const a=S(e,["config"]);return a!=null&&N(t,["generationConfig"],bY(n,a,t)),t}function _Y(n,e,t){const r={},s=S(e,["taskType"]);t!==void 0&&s!=null&&N(t,["instances[]","task_type"],s);const a=S(e,["title"]);t!==void 0&&a!=null&&N(t,["instances[]","title"],a);const o=S(e,["outputDimensionality"]);t!==void 0&&o!=null&&N(t,["parameters","outputDimensionality"],o);const l=S(e,["mimeType"]);t!==void 0&&l!=null&&N(t,["instances[]","mimeType"],l);const c=S(e,["autoTruncate"]);return t!==void 0&&c!=null&&N(t,["parameters","autoTruncate"],c),r}function wY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["contents"]);s!=null&&N(t,["instances[]","content"],aF(n,s));const a=S(e,["config"]);return a!=null&&N(t,["config"],_Y(n,a,t)),t}function SY(n,e,t){const r={},s=S(e,["outputGcsUri"]);t!==void 0&&s!=null&&N(t,["parameters","storageUri"],s);const a=S(e,["negativePrompt"]);t!==void 0&&a!=null&&N(t,["parameters","negativePrompt"],a);const o=S(e,["numberOfImages"]);t!==void 0&&o!=null&&N(t,["parameters","sampleCount"],o);const l=S(e,["aspectRatio"]);t!==void 0&&l!=null&&N(t,["parameters","aspectRatio"],l);const c=S(e,["guidanceScale"]);t!==void 0&&c!=null&&N(t,["parameters","guidanceScale"],c);const d=S(e,["seed"]);t!==void 0&&d!=null&&N(t,["parameters","seed"],d);const m=S(e,["safetyFilterLevel"]);t!==void 0&&m!=null&&N(t,["parameters","safetySetting"],m);const p=S(e,["personGeneration"]);t!==void 0&&p!=null&&N(t,["parameters","personGeneration"],p);const x=S(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&N(t,["parameters","includeSafetyAttributes"],x);const v=S(e,["includeRaiReason"]);t!==void 0&&v!=null&&N(t,["parameters","includeRaiReason"],v);const _=S(e,["language"]);t!==void 0&&_!=null&&N(t,["parameters","language"],_);const w=S(e,["outputMimeType"]);t!==void 0&&w!=null&&N(t,["parameters","outputOptions","mimeType"],w);const j=S(e,["outputCompressionQuality"]);t!==void 0&&j!=null&&N(t,["parameters","outputOptions","compressionQuality"],j);const P=S(e,["addWatermark"]);t!==void 0&&P!=null&&N(t,["parameters","addWatermark"],P);const k=S(e,["enhancePrompt"]);return t!==void 0&&k!=null&&N(t,["parameters","enhancePrompt"],k),r}function jY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["prompt"]);s!=null&&N(t,["instances[0]","prompt"],s);const a=S(e,["config"]);return a!=null&&N(t,["config"],SY(n,a,t)),t}function lC(n,e){const t={},r=S(e,["gcsUri"]);r!=null&&N(t,["gcsUri"],r);const s=S(e,["imageBytes"]);s!=null&&N(t,["bytesBase64Encoded"],Gc(n,s));const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function NY(n,e){const t={},r=S(e,["maskMode"]);r!=null&&N(t,["maskMode"],r);const s=S(e,["segmentationClasses"]);s!=null&&N(t,["maskClasses"],s);const a=S(e,["maskDilation"]);return a!=null&&N(t,["dilation"],a),t}function CY(n,e){const t={},r=S(e,["controlType"]);r!=null&&N(t,["controlType"],r);const s=S(e,["enableControlImageComputation"]);return s!=null&&N(t,["computeControl"],s),t}function TY(n,e){const t={},r=S(e,["styleDescription"]);return r!=null&&N(t,["styleDescription"],r),t}function PY(n,e){const t={},r=S(e,["subjectType"]);r!=null&&N(t,["subjectType"],r);const s=S(e,["subjectDescription"]);return s!=null&&N(t,["subjectDescription"],s),t}function MY(n,e){const t={},r=S(e,["referenceImage"]);r!=null&&N(t,["referenceImage"],lC(n,r));const s=S(e,["referenceId"]);s!=null&&N(t,["referenceId"],s);const a=S(e,["referenceType"]);a!=null&&N(t,["referenceType"],a);const o=S(e,["maskImageConfig"]);o!=null&&N(t,["maskImageConfig"],NY(n,o));const l=S(e,["controlImageConfig"]);l!=null&&N(t,["controlImageConfig"],CY(n,l));const c=S(e,["styleImageConfig"]);c!=null&&N(t,["styleImageConfig"],TY(n,c));const d=S(e,["subjectImageConfig"]);return d!=null&&N(t,["subjectImageConfig"],PY(n,d)),t}function kY(n,e,t){const r={},s=S(e,["outputGcsUri"]);t!==void 0&&s!=null&&N(t,["parameters","storageUri"],s);const a=S(e,["negativePrompt"]);t!==void 0&&a!=null&&N(t,["parameters","negativePrompt"],a);const o=S(e,["numberOfImages"]);t!==void 0&&o!=null&&N(t,["parameters","sampleCount"],o);const l=S(e,["aspectRatio"]);t!==void 0&&l!=null&&N(t,["parameters","aspectRatio"],l);const c=S(e,["guidanceScale"]);t!==void 0&&c!=null&&N(t,["parameters","guidanceScale"],c);const d=S(e,["seed"]);t!==void 0&&d!=null&&N(t,["parameters","seed"],d);const m=S(e,["safetyFilterLevel"]);t!==void 0&&m!=null&&N(t,["parameters","safetySetting"],m);const p=S(e,["personGeneration"]);t!==void 0&&p!=null&&N(t,["parameters","personGeneration"],p);const x=S(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&N(t,["parameters","includeSafetyAttributes"],x);const v=S(e,["includeRaiReason"]);t!==void 0&&v!=null&&N(t,["parameters","includeRaiReason"],v);const _=S(e,["language"]);t!==void 0&&_!=null&&N(t,["parameters","language"],_);const w=S(e,["outputMimeType"]);t!==void 0&&w!=null&&N(t,["parameters","outputOptions","mimeType"],w);const j=S(e,["outputCompressionQuality"]);t!==void 0&&j!=null&&N(t,["parameters","outputOptions","compressionQuality"],j);const P=S(e,["editMode"]);t!==void 0&&P!=null&&N(t,["parameters","editMode"],P);const k=S(e,["baseSteps"]);return t!==void 0&&k!=null&&N(t,["parameters","editConfig","baseSteps"],k),r}function EY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["prompt"]);s!=null&&N(t,["instances[0]","prompt"],s);const a=S(e,["referenceImages"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>MY(n,c))),N(t,["instances[0]","referenceImages"],l)}const o=S(e,["config"]);return o!=null&&N(t,["config"],kY(n,o,t)),t}function DY(n,e,t){const r={},s=S(e,["includeRaiReason"]);t!==void 0&&s!=null&&N(t,["parameters","includeRaiReason"],s);const a=S(e,["outputMimeType"]);t!==void 0&&a!=null&&N(t,["parameters","outputOptions","mimeType"],a);const o=S(e,["outputCompressionQuality"]);t!==void 0&&o!=null&&N(t,["parameters","outputOptions","compressionQuality"],o);const l=S(e,["numberOfImages"]);t!==void 0&&l!=null&&N(t,["parameters","sampleCount"],l);const c=S(e,["mode"]);return t!==void 0&&c!=null&&N(t,["parameters","mode"],c),r}function OY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["image"]);s!=null&&N(t,["instances[0]","image"],lC(n,s));const a=S(e,["upscaleFactor"]);a!=null&&N(t,["parameters","upscaleConfig","upscaleFactor"],a);const o=S(e,["config"]);return o!=null&&N(t,["config"],DY(n,o,t)),t}function IY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","name"],zn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function AY(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);t!==void 0&&a!=null&&N(t,["_query","pageToken"],a);const o=S(e,["filter"]);t!==void 0&&o!=null&&N(t,["_query","filter"],o);const l=S(e,["queryBase"]);return t!==void 0&&l!=null&&N(t,["_url","models_url"],uF(n,l)),r}function RY(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],AY(n,r,t)),t}function LY(n,e,t){const r={},s=S(e,["displayName"]);t!==void 0&&s!=null&&N(t,["displayName"],s);const a=S(e,["description"]);t!==void 0&&a!=null&&N(t,["description"],a);const o=S(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&N(t,["defaultCheckpointId"],o),r}function FY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],LY(n,s,t)),t}function qY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","name"],zn(n,r));const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function zY(n,e,t){const r={},s=S(e,["systemInstruction"]);t!==void 0&&s!=null&&N(t,["systemInstruction"],Af(n,qs(n,s)));const a=S(e,["tools"]);if(t!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>bF(n,c))),N(t,["tools"],l)}const o=S(e,["generationConfig"]);return t!==void 0&&o!=null&&N(t,["generationConfig"],o),r}function UY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["contents"]);if(s!=null){let o=wa(n,s);Array.isArray(o)&&(o=o.map(l=>Af(n,l))),N(t,["contents"],o)}const a=S(e,["config"]);return a!=null&&N(t,["config"],zY(n,a,t)),t}function VY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["contents"]);if(s!=null){let o=wa(n,s);Array.isArray(o)&&(o=o.map(l=>Af(n,l))),N(t,["contents"],o)}const a=S(e,["config"]);return a!=null&&N(t,["config"],a),t}function BY(n,e,t){const r={},s=S(e,["numberOfVideos"]);t!==void 0&&s!=null&&N(t,["parameters","sampleCount"],s);const a=S(e,["outputGcsUri"]);t!==void 0&&a!=null&&N(t,["parameters","storageUri"],a);const o=S(e,["fps"]);t!==void 0&&o!=null&&N(t,["parameters","fps"],o);const l=S(e,["durationSeconds"]);t!==void 0&&l!=null&&N(t,["parameters","durationSeconds"],l);const c=S(e,["seed"]);t!==void 0&&c!=null&&N(t,["parameters","seed"],c);const d=S(e,["aspectRatio"]);t!==void 0&&d!=null&&N(t,["parameters","aspectRatio"],d);const m=S(e,["resolution"]);t!==void 0&&m!=null&&N(t,["parameters","resolution"],m);const p=S(e,["personGeneration"]);t!==void 0&&p!=null&&N(t,["parameters","personGeneration"],p);const x=S(e,["pubsubTopic"]);t!==void 0&&x!=null&&N(t,["parameters","pubsubTopic"],x);const v=S(e,["negativePrompt"]);t!==void 0&&v!=null&&N(t,["parameters","negativePrompt"],v);const _=S(e,["enhancePrompt"]);return t!==void 0&&_!=null&&N(t,["parameters","enhancePrompt"],_),r}function WY(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["_url","model"],zn(n,r));const s=S(e,["prompt"]);s!=null&&N(t,["instances[0]","prompt"],s);const a=S(e,["image"]);a!=null&&N(t,["instances[0]","image"],lC(n,a));const o=S(e,["config"]);return o!=null&&N(t,["config"],BY(n,o,t)),t}function $Y(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function HY(n,e){const t={},r=S(e,["data"]);r!=null&&N(t,["data"],r);const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function YY(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],$Y(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],HY(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const m=S(e,["functionResponse"]);m!=null&&N(t,["functionResponse"],m);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function GY(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>YY(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function ZY(n,e){const t={},r=S(e,["citationSources"]);return r!=null&&N(t,["citations"],r),t}function KY(n,e){const t={},r=S(e,["retrievedUrl"]);r!=null&&N(t,["retrievedUrl"],r);const s=S(e,["urlRetrievalStatus"]);return s!=null&&N(t,["urlRetrievalStatus"],s),t}function JY(n,e){const t={},r=S(e,["urlMetadata"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>KY(n,a))),N(t,["urlMetadata"],s)}return t}function QY(n,e){const t={},r=S(e,["content"]);r!=null&&N(t,["content"],GY(n,r));const s=S(e,["citationMetadata"]);s!=null&&N(t,["citationMetadata"],ZY(n,s));const a=S(e,["tokenCount"]);a!=null&&N(t,["tokenCount"],a);const o=S(e,["finishReason"]);o!=null&&N(t,["finishReason"],o);const l=S(e,["urlContextMetadata"]);l!=null&&N(t,["urlContextMetadata"],JY(n,l));const c=S(e,["avgLogprobs"]);c!=null&&N(t,["avgLogprobs"],c);const d=S(e,["groundingMetadata"]);d!=null&&N(t,["groundingMetadata"],d);const m=S(e,["index"]);m!=null&&N(t,["index"],m);const p=S(e,["logprobsResult"]);p!=null&&N(t,["logprobsResult"],p);const x=S(e,["safetyRatings"]);return x!=null&&N(t,["safetyRatings"],x),t}function mk(n,e){const t={},r=S(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>QY(n,c))),N(t,["candidates"],l)}const s=S(e,["modelVersion"]);s!=null&&N(t,["modelVersion"],s);const a=S(e,["promptFeedback"]);a!=null&&N(t,["promptFeedback"],a);const o=S(e,["usageMetadata"]);return o!=null&&N(t,["usageMetadata"],o),t}function XY(n,e){const t={},r=S(e,["values"]);return r!=null&&N(t,["values"],r),t}function eG(){return{}}function tG(n,e){const t={},r=S(e,["embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>XY(n,o))),N(t,["embeddings"],a)}return S(e,["metadata"])!=null&&N(t,["metadata"],eG()),t}function nG(n,e){const t={},r=S(e,["bytesBase64Encoded"]);r!=null&&N(t,["imageBytes"],Gc(n,r));const s=S(e,["mimeType"]);return s!=null&&N(t,["mimeType"],s),t}function _F(n,e){const t={},r=S(e,["safetyAttributes","categories"]);r!=null&&N(t,["categories"],r);const s=S(e,["safetyAttributes","scores"]);s!=null&&N(t,["scores"],s);const a=S(e,["contentType"]);return a!=null&&N(t,["contentType"],a),t}function rG(n,e){const t={},r=S(e,["_self"]);r!=null&&N(t,["image"],nG(n,r));const s=S(e,["raiFilteredReason"]);s!=null&&N(t,["raiFilteredReason"],s);const a=S(e,["_self"]);return a!=null&&N(t,["safetyAttributes"],_F(n,a)),t}function sG(n,e){const t={},r=S(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>rG(n,o))),N(t,["generatedImages"],a)}const s=S(e,["positivePromptSafetyAttributes"]);return s!=null&&N(t,["positivePromptSafetyAttributes"],_F(n,s)),t}function iG(n,e){const t={},r=S(e,["baseModel"]);r!=null&&N(t,["baseModel"],r);const s=S(e,["createTime"]);s!=null&&N(t,["createTime"],s);const a=S(e,["updateTime"]);return a!=null&&N(t,["updateTime"],a),t}function rN(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["description"]);a!=null&&N(t,["description"],a);const o=S(e,["version"]);o!=null&&N(t,["version"],o);const l=S(e,["_self"]);l!=null&&N(t,["tunedModelInfo"],iG(n,l));const c=S(e,["inputTokenLimit"]);c!=null&&N(t,["inputTokenLimit"],c);const d=S(e,["outputTokenLimit"]);d!=null&&N(t,["outputTokenLimit"],d);const m=S(e,["supportedGenerationMethods"]);return m!=null&&N(t,["supportedActions"],m),t}function aG(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["_self"]);if(s!=null){let a=fF(n,s);Array.isArray(a)&&(a=a.map(o=>rN(n,o))),N(t,["models"],a)}return t}function oG(){return{}}function lG(n,e){const t={},r=S(e,["totalTokens"]);r!=null&&N(t,["totalTokens"],r);const s=S(e,["cachedContentTokenCount"]);return s!=null&&N(t,["cachedContentTokenCount"],s),t}function cG(n,e){const t={},r=S(e,["video","uri"]);r!=null&&N(t,["uri"],r);const s=S(e,["video","encodedVideo"]);s!=null&&N(t,["videoBytes"],Gc(n,s));const a=S(e,["encoding"]);return a!=null&&N(t,["mimeType"],a),t}function dG(n,e){const t={},r=S(e,["_self"]);return r!=null&&N(t,["video"],cG(n,r)),t}function uG(n,e){const t={},r=S(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>dG(n,l))),N(t,["generatedVideos"],o)}const s=S(e,["raiMediaFilteredCount"]);s!=null&&N(t,["raiMediaFilteredCount"],s);const a=S(e,["raiMediaFilteredReasons"]);return a!=null&&N(t,["raiMediaFilteredReasons"],a),t}function fG(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["metadata"]);s!=null&&N(t,["metadata"],s);const a=S(e,["done"]);a!=null&&N(t,["done"],a);const o=S(e,["error"]);o!=null&&N(t,["error"],o);const l=S(e,["response","generateVideoResponse"]);return l!=null&&N(t,["response"],uG(n,l)),t}function hG(n,e){const t={},r=S(e,["fps"]);r!=null&&N(t,["fps"],r);const s=S(e,["endOffset"]);s!=null&&N(t,["endOffset"],s);const a=S(e,["startOffset"]);return a!=null&&N(t,["startOffset"],a),t}function mG(n,e){const t={},r=S(e,["displayName"]);r!=null&&N(t,["displayName"],r);const s=S(e,["data"]);s!=null&&N(t,["data"],s);const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function pG(n,e){const t={},r=S(e,["videoMetadata"]);r!=null&&N(t,["videoMetadata"],hG(n,r));const s=S(e,["thought"]);s!=null&&N(t,["thought"],s);const a=S(e,["inlineData"]);a!=null&&N(t,["inlineData"],mG(n,a));const o=S(e,["codeExecutionResult"]);o!=null&&N(t,["codeExecutionResult"],o);const l=S(e,["executableCode"]);l!=null&&N(t,["executableCode"],l);const c=S(e,["fileData"]);c!=null&&N(t,["fileData"],c);const d=S(e,["functionCall"]);d!=null&&N(t,["functionCall"],d);const m=S(e,["functionResponse"]);m!=null&&N(t,["functionResponse"],m);const p=S(e,["text"]);return p!=null&&N(t,["text"],p),t}function gG(n,e){const t={},r=S(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>pG(n,o))),N(t,["parts"],a)}const s=S(e,["role"]);return s!=null&&N(t,["role"],s),t}function xG(n,e){const t={},r=S(e,["citations"]);return r!=null&&N(t,["citations"],r),t}function yG(n,e){const t={},r=S(e,["content"]);r!=null&&N(t,["content"],gG(n,r));const s=S(e,["citationMetadata"]);s!=null&&N(t,["citationMetadata"],xG(n,s));const a=S(e,["finishMessage"]);a!=null&&N(t,["finishMessage"],a);const o=S(e,["finishReason"]);o!=null&&N(t,["finishReason"],o);const l=S(e,["avgLogprobs"]);l!=null&&N(t,["avgLogprobs"],l);const c=S(e,["groundingMetadata"]);c!=null&&N(t,["groundingMetadata"],c);const d=S(e,["index"]);d!=null&&N(t,["index"],d);const m=S(e,["logprobsResult"]);m!=null&&N(t,["logprobsResult"],m);const p=S(e,["safetyRatings"]);return p!=null&&N(t,["safetyRatings"],p),t}function pk(n,e){const t={},r=S(e,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(m=>yG(n,m))),N(t,["candidates"],d)}const s=S(e,["createTime"]);s!=null&&N(t,["createTime"],s);const a=S(e,["responseId"]);a!=null&&N(t,["responseId"],a);const o=S(e,["modelVersion"]);o!=null&&N(t,["modelVersion"],o);const l=S(e,["promptFeedback"]);l!=null&&N(t,["promptFeedback"],l);const c=S(e,["usageMetadata"]);return c!=null&&N(t,["usageMetadata"],c),t}function vG(n,e){const t={},r=S(e,["truncated"]);r!=null&&N(t,["truncated"],r);const s=S(e,["token_count"]);return s!=null&&N(t,["tokenCount"],s),t}function bG(n,e){const t={},r=S(e,["values"]);r!=null&&N(t,["values"],r);const s=S(e,["statistics"]);return s!=null&&N(t,["statistics"],vG(n,s)),t}function _G(n,e){const t={},r=S(e,["billableCharacterCount"]);return r!=null&&N(t,["billableCharacterCount"],r),t}function wG(n,e){const t={},r=S(e,["predictions[]","embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>bG(n,o))),N(t,["embeddings"],a)}const s=S(e,["metadata"]);return s!=null&&N(t,["metadata"],_G(n,s)),t}function SG(n,e){const t={},r=S(e,["gcsUri"]);r!=null&&N(t,["gcsUri"],r);const s=S(e,["bytesBase64Encoded"]);s!=null&&N(t,["imageBytes"],Gc(n,s));const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function wF(n,e){const t={},r=S(e,["safetyAttributes","categories"]);r!=null&&N(t,["categories"],r);const s=S(e,["safetyAttributes","scores"]);s!=null&&N(t,["scores"],s);const a=S(e,["contentType"]);return a!=null&&N(t,["contentType"],a),t}function cC(n,e){const t={},r=S(e,["_self"]);r!=null&&N(t,["image"],SG(n,r));const s=S(e,["raiFilteredReason"]);s!=null&&N(t,["raiFilteredReason"],s);const a=S(e,["_self"]);a!=null&&N(t,["safetyAttributes"],wF(n,a));const o=S(e,["prompt"]);return o!=null&&N(t,["enhancedPrompt"],o),t}function jG(n,e){const t={},r=S(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>cC(n,o))),N(t,["generatedImages"],a)}const s=S(e,["positivePromptSafetyAttributes"]);return s!=null&&N(t,["positivePromptSafetyAttributes"],wF(n,s)),t}function NG(n,e){const t={},r=S(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>cC(n,a))),N(t,["generatedImages"],s)}return t}function CG(n,e){const t={},r=S(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>cC(n,a))),N(t,["generatedImages"],s)}return t}function TG(n,e){const t={},r=S(e,["endpoint"]);r!=null&&N(t,["name"],r);const s=S(e,["deployedModelId"]);return s!=null&&N(t,["deployedModelId"],s),t}function PG(n,e){const t={},r=S(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&N(t,["baseModel"],r);const s=S(e,["createTime"]);s!=null&&N(t,["createTime"],s);const a=S(e,["updateTime"]);return a!=null&&N(t,["updateTime"],a),t}function MG(n,e){const t={},r=S(e,["checkpointId"]);r!=null&&N(t,["checkpointId"],r);const s=S(e,["epoch"]);s!=null&&N(t,["epoch"],s);const a=S(e,["step"]);return a!=null&&N(t,["step"],a),t}function sN(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["displayName"]);s!=null&&N(t,["displayName"],s);const a=S(e,["description"]);a!=null&&N(t,["description"],a);const o=S(e,["versionId"]);o!=null&&N(t,["version"],o);const l=S(e,["deployedModels"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(v=>TG(n,v))),N(t,["endpoints"],x)}const c=S(e,["labels"]);c!=null&&N(t,["labels"],c);const d=S(e,["_self"]);d!=null&&N(t,["tunedModelInfo"],PG(n,d));const m=S(e,["defaultCheckpointId"]);m!=null&&N(t,["defaultCheckpointId"],m);const p=S(e,["checkpoints"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(v=>MG(n,v))),N(t,["checkpoints"],x)}return t}function kG(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["_self"]);if(s!=null){let a=fF(n,s);Array.isArray(a)&&(a=a.map(o=>sN(n,o))),N(t,["models"],a)}return t}function EG(){return{}}function DG(n,e){const t={},r=S(e,["totalTokens"]);return r!=null&&N(t,["totalTokens"],r),t}function OG(n,e){const t={},r=S(e,["tokensInfo"]);return r!=null&&N(t,["tokensInfo"],r),t}function IG(n,e){const t={},r=S(e,["gcsUri"]);r!=null&&N(t,["uri"],r);const s=S(e,["bytesBase64Encoded"]);s!=null&&N(t,["videoBytes"],Gc(n,s));const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function AG(n,e){const t={},r=S(e,["_self"]);return r!=null&&N(t,["video"],IG(n,r)),t}function RG(n,e){const t={},r=S(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>AG(n,l))),N(t,["generatedVideos"],o)}const s=S(e,["raiMediaFilteredCount"]);s!=null&&N(t,["raiMediaFilteredCount"],s);const a=S(e,["raiMediaFilteredReasons"]);return a!=null&&N(t,["raiMediaFilteredReasons"],a),t}function LG(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["metadata"]);s!=null&&N(t,["metadata"],s);const a=S(e,["done"]);a!=null&&N(t,["done"],a);const o=S(e,["error"]);o!=null&&N(t,["error"],o);const l=S(e,["response"]);return l!=null&&N(t,["response"],RG(n,l)),t}const FG="Content-Type",qG="X-Server-Timeout",zG="User-Agent",iN="x-goog-api-client",UG="0.15.0",VG=`google-genai-sdk/${UG}`,BG="v1beta1",WG="v1beta",gk=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class SF extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class aN extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class $G{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:BG,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:WG,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const s=[this.getRequestUrlInternal(t)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.unaryApiCall(s,a,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[s,a]of Object.entries(t))typeof a=="object"?r[s]=Object.assign(Object.assign({},r[s]),a):a!==void 0&&(r[s]=a);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.streamApiCall(s,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r){if(t&&t.timeout||r){const s=new AbortController,a=s.signal;t.timeout&&t?.timeout>0&&setTimeout(()=>s.abort(),t.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=a}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async s=>(await xk(s),new Xj(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async s=>(await xk(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return Wh(this,arguments,function*(){const s=(t=e?.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield Gn(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=a.decode(c);try{const p=JSON.parse(d);if("error"in p){const x=JSON.parse(JSON.stringify(p.error)),v=x.status,_=x.code,w=`got status: ${v}. ${JSON.stringify(p)}`;if(_>=400&&_<500)throw new SF(w);if(_>=500&&_<600)throw new aN(w)}}catch(p){const x=p;if(x.name==="ClientError"||x.name==="ServerError")throw p}o+=d;let m=o.match(gk);for(;m;){const p=m[1];try{const x=new Response(p,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Gn(new Xj(x)),o=o.slice(m[0].length),m=o.match(gk)}catch(x){throw new Error(`exception parsing stream chunk ${p}. ${x}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=VG+" "+this.clientOptions.userAgentExtra;return e[zG]=t,e[iN]=t,e[FG]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))t.append(r,s);e.timeout&&e.timeout>0&&t.append(qG,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var r;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const a=this.clientOptions.uploader,o=await a.stat(e);s.sizeBytes=String(o.size);const l=(r=t?.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,t);return a.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var r;let s={};t?.httpOptions?s=t.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const a={file:e},o=await this.request({path:Ot("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:s});if(!o||!o?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o?.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function xk(n){var e;if(n===void 0)throw new aN("response is undefined");if(!n.ok){const t=n.status,r=n.statusText;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const a=`got status: ${t} ${r}. ${JSON.stringify(s)}`;throw t>=400&&t<500?new SF(a):t>=500&&t<600?new aN(a):new Error(a)}}const HG="mcp_used/unknown";function oN(n){for(const e of n)if(dC(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function lN(n){var e;n[iN]=(((e=n[iN])!==null&&e!==void 0?e:"")+` ${HG}`).trimStart()}function YG(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>dC(s)))!==null&&r!==void 0?r:!1}function GG(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>!dC(s)))!==null&&r!==void 0?r:!1}function dC(n){return n!==null&&typeof n=="object"&&"tool"in n&&"callTool"in n}async function ZG(n,e,t){const r=new aH,s=JSON.parse(t.data),a=p7(n,s);Object.assign(r,a),e(r)}class KG{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),o=XG(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),c=`${s}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${l}`;let d=()=>{};const m=new Promise(I=>{d=I}),p=e.callbacks,x=function(){d({})},v=this.apiClient,_={onopen:x,onmessage:I=>{ZG(v,p.onmessage,I)},onerror:(t=p?.onerror)!==null&&t!==void 0?t:function(I){},onclose:(r=p?.onclose)!==null&&r!==void 0?r:function(I){}},w=this.webSocketFactory.create(c,QG(o),_);w.connect(),await m;const j=zn(this.apiClient,e.model),P=xF(this.apiClient,{model:j}),k=nN(this.apiClient,{setup:P});return w.send(JSON.stringify(k)),new JG(w,this.apiClient)}}class JG{constructor(e,t){this.conn=e,this.apiClient=t}async setClientContent(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=E9(this.apiClient,e),r=yF(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=D9(this.apiClient,e),r=nN(this.apiClient,t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const t=nN(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(sf.PLAY)}pause(){this.sendPlaybackControl(sf.PAUSE)}stop(){this.sendPlaybackControl(sf.STOP)}resetContext(){this.sendPlaybackControl(sf.RESET_CONTEXT)}close(){this.conn.close()}}function QG(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function XG(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const eZ="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function tZ(n,e,t){const r=new iH;let s;if(t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),n.isVertexAI()){const a=a7(n,s);Object.assign(r,a)}else{const a=i7(n,s);Object.assign(r,a)}e(r)}class nZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new KG(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,s,a,o,l;const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let m;const p=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&oN(e.config.tools)&&lN(p);const x=aZ(p);if(this.apiClient.isVertexAI())m=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x);else{const U=this.apiClient.getApiKey();m=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${U}`}let v=()=>{};const _=new Promise(U=>{v=U}),w=e.callbacks,j=function(){var U;(U=w?.onopen)===null||U===void 0||U.call(w),v({})},P=this.apiClient,k={onopen:j,onmessage:U=>{tZ(P,w.onmessage,U)},onerror:(t=w?.onerror)!==null&&t!==void 0?t:function(U){},onclose:(r=w?.onclose)!==null&&r!==void 0?r:function(U){}},I=this.webSocketFactory.create(m,iZ(x),k);I.connect(),await _;let M=zn(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&M.startsWith("publishers/")){const U=this.apiClient.getProject(),B=this.apiClient.getLocation();M=`projects/${U}/locations/${B}/`+M}let D={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[nm.AUDIO]}:e.config.responseModalities=[nm.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const O=(l=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[],q=[];for(const U of O)if(this.isCallableTool(U)){const B=U;q.push(await B.tool())}else q.push(U);q.length>0&&(e.config.tools=q);const F={model:M,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?D=j9(this.apiClient,F):D=S9(this.apiClient,F),delete D.config,I.send(JSON.stringify(D)),new sZ(I,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const rZ={turnComplete:!0};class sZ{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=wa(e,t.turns),e.isVertexAI()?r=r.map(s=>Af(e,s)):r=r.map(s=>Vx(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const a of r){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(eZ)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},rZ),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:k9(this.apiClient,e)}:t={realtimeInput:M9(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function iZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function aZ(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const yk=10;function vk(n){var e,t,r;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const o of(t=n?.tools)!==null&&t!==void 0?t:[])if(Gg(o)){s=!0;break}if(!s)return!0;const a=(r=n?.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function Gg(n){return"callTool"in n&&typeof n.callTool=="function"}function bk(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class oZ extends ym{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,s,a,o,l;if(t.config&&t.config.tools&&oN(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),lN(t.config.httpOptions.headers)),!YG(t)||vk(t.config))return await this.generateContentInternal(t);if(GG(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");const c=await this.transformCallableTools(t);let d,m;const p=wa(this.apiClient,c.contents),x=(a=(s=(r=c.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&a!==void 0?a:yk;let v=0;for(;v<x&&(d=await this.generateContentInternal(c),!(!d.functionCalls||d.functionCalls.length===0));){const _=d.candidates[0].content,w=[];for(const j of(l=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[])if(Gg(j)){const k=await j.callTool(d.functionCalls);w.push(...k)}v++,m={role:"user",parts:w},c.contents=wa(this.apiClient,c.contents),c.contents.push(_),c.contents.push(m),bk(c.config)&&(p.push(_),p.push(m))}return bk(c.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async t=>{if(t.config&&t.config.tools&&oN(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),lN(t.config.httpOptions.headers)),vk(t.config)){const r=await this.transformCallableTools(t);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var s;let a;const o=[];if(r?.generatedImages)for(const c of r.generatedImages)c&&c?.safetyAttributes&&((s=c?.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?a=c?.safetyAttributes:o.push(c);let l;return a?l={generatedImages:o,positivePromptSafetyAttributes:a}:l={generatedImages:o},l}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Ux(Nf.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async transformCallableTools(e){var t;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const s=await Promise.all(r.map(async o=>Gg(o)?await o.tool():o)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};return a.config.tools=s,a}async initAfcToolsMap(e){var t,r,s;const a=new Map;for(const o of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(Gg(o)){const l=o,c=await l.tool();for(const d of(s=c.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(a.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);a.set(d.name,l)}}return a}async processAfcStream(e){var t,r,s;const a=(s=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:yk;let o=!1,l=0;const c=await this.initAfcToolsMap(e);return(function(d,m,p){var x,v;return Wh(this,arguments,function*(){for(var _,w,j,P;l<a;){o&&(l++,o=!1);const D=yield Gn(d.transformCallableTools(p)),O=yield Gn(d.generateContentStreamInternal(D)),q=[],F=[];try{for(var k=!0,I=(w=void 0,Yg(O)),M;M=yield Gn(I.next()),_=M.done,!_;k=!0){P=M.value,k=!1;const U=P;if(yield yield Gn(U),U.candidates&&(!((x=U.candidates[0])===null||x===void 0)&&x.content)){F.push(U.candidates[0].content);for(const B of(v=U.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(l<a&&B.functionCall){if(!B.functionCall.name)throw new Error("Function call name was not returned by the model.");if(m.has(B.functionCall.name)){const G=yield Gn(m.get(B.functionCall.name).callTool([B.functionCall]));q.push(...G)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${m.keys()}, mising tool: ${B.functionCall.name}`)}}}}catch(U){w={error:U}}finally{try{!k&&!_&&(j=I.return)&&(yield Gn(j.call(I)))}finally{if(w)throw w.error}}if(q.length>0){o=!0;const U=new uh;U.candidates=[{content:{role:"user",parts:q}}],yield yield Gn(U);const B=[];B.push(...F),B.push({role:"user",parts:q});const G=wa(d.apiClient,p.contents).concat(B);p.contents=G}else break}})})(this,c,e)}async generateContentInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=hk(this.apiClient,e);return l=Ot("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=pk(this.apiClient,m),x=new uh;return Object.assign(x,p),x})}else{const d=fk(this.apiClient,e);return l=Ot("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>{const p=mk(this.apiClient,m),x=new uh;return Object.assign(x,p),x})}}async generateContentStreamInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=hk(this.apiClient,e);l=Ot("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const m=this.apiClient;return o=m.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return Wh(this,arguments,function*(){var x,v,_,w;try{for(var j=!0,P=Yg(p),k;k=yield Gn(P.next()),x=k.done,!x;j=!0){w=k.value,j=!1;const M=pk(m,yield Gn(w.json())),D=new uh;Object.assign(D,M),yield yield Gn(D)}}catch(I){v={error:I}}finally{try{!j&&!x&&(_=P.return)&&(yield Gn(_.call(P)))}finally{if(v)throw v.error}}})})}else{const d=fk(this.apiClient,e);l=Ot("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const m=this.apiClient;return o=m.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),o.then(function(p){return Wh(this,arguments,function*(){var x,v,_,w;try{for(var j=!0,P=Yg(p),k;k=yield Gn(P.next()),x=k.done,!x;j=!0){w=k.value,j=!1;const M=mk(m,yield Gn(w.json())),D=new uh;Object.assign(D,M),yield yield Gn(D)}}catch(I){v={error:I}}finally{try{!j&&!x&&(_=P.return)&&(yield Gn(_.call(P)))}finally{if(v)throw v.error}}})})}}async embedContent(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=wY(this.apiClient,e);return l=Ot("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=wG(this.apiClient,m),x=new HM;return Object.assign(x,p),x})}else{const d=F7(this.apiClient,e);return l=Ot("{model}:batchEmbedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>{const p=tG(this.apiClient,m),x=new HM;return Object.assign(x,p),x})}}async generateImagesInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=jY(this.apiClient,e);return l=Ot("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=jG(this.apiClient,m),x=new YM;return Object.assign(x,p),x})}else{const d=z7(this.apiClient,e);return l=Ot("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>{const p=sG(this.apiClient,m),x=new YM;return Object.assign(x,p),x})}}async editImageInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=EY(this.apiClient,e);return a=Ot("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=NG(this.apiClient,c),m=new X$;return Object.assign(m,d),m})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=OY(this.apiClient,e);return a=Ot("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=CG(this.apiClient,c),m=new eH;return Object.assign(m,d),m})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=IY(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>sN(this.apiClient,m))}else{const d=U7(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>rN(this.apiClient,m))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=RY(this.apiClient,e);return l=Ot("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=kG(this.apiClient,m),x=new GM;return Object.assign(x,p),x})}else{const d=B7(this.apiClient,e);return l=Ot("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>{const p=aG(this.apiClient,m),x=new GM;return Object.assign(x,p),x})}}async update(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=FY(this.apiClient,e);return l=Ot("{model}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>sN(this.apiClient,m))}else{const d=$7(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>rN(this.apiClient,m))}}async delete(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=qY(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(()=>{const m=EG(),p=new ZM;return Object.assign(p,m),p})}else{const d=H7(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(()=>{const m=oG(),p=new ZM;return Object.assign(p,m),p})}}async countTokens(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=UY(this.apiClient,e);return l=Ot("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=DG(this.apiClient,m),x=new KM;return Object.assign(x,p),x})}else{const d=G7(this.apiClient,e);return l=Ot("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>{const p=lG(this.apiClient,m),x=new KM;return Object.assign(x,p),x})}}async computeTokens(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=VY(this.apiClient,e);return a=Ot("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=OG(this.apiClient,c),m=new tH;return Object.assign(m,d),m})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=WY(this.apiClient,e);return l=Ot("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>LG(this.apiClient,m))}else{const d=J7(this.apiClient,e);return l=Ot("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>fG(this.apiClient,m))}}}function lZ(n,e){const t={},r=S(e,["operationName"]);r!=null&&N(t,["_url","operationName"],r);const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function cZ(n,e){const t={},r=S(e,["operationName"]);r!=null&&N(t,["_url","operationName"],r);const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function dZ(n,e){const t={},r=S(e,["operationName"]);r!=null&&N(t,["operationName"],r);const s=S(e,["resourceName"]);s!=null&&N(t,["_url","resourceName"],s);const a=S(e,["config"]);return a!=null&&N(t,["config"],a),t}function uZ(n,e){const t={},r=S(e,["video","uri"]);r!=null&&N(t,["uri"],r);const s=S(e,["video","encodedVideo"]);s!=null&&N(t,["videoBytes"],Gc(n,s));const a=S(e,["encoding"]);return a!=null&&N(t,["mimeType"],a),t}function fZ(n,e){const t={},r=S(e,["_self"]);return r!=null&&N(t,["video"],uZ(n,r)),t}function hZ(n,e){const t={},r=S(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>fZ(n,l))),N(t,["generatedVideos"],o)}const s=S(e,["raiMediaFilteredCount"]);s!=null&&N(t,["raiMediaFilteredCount"],s);const a=S(e,["raiMediaFilteredReasons"]);return a!=null&&N(t,["raiMediaFilteredReasons"],a),t}function mZ(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["metadata"]);s!=null&&N(t,["metadata"],s);const a=S(e,["done"]);a!=null&&N(t,["done"],a);const o=S(e,["error"]);o!=null&&N(t,["error"],o);const l=S(e,["response","generateVideoResponse"]);return l!=null&&N(t,["response"],hZ(n,l)),t}function pZ(n,e){const t={},r=S(e,["gcsUri"]);r!=null&&N(t,["uri"],r);const s=S(e,["bytesBase64Encoded"]);s!=null&&N(t,["videoBytes"],Gc(n,s));const a=S(e,["mimeType"]);return a!=null&&N(t,["mimeType"],a),t}function gZ(n,e){const t={},r=S(e,["_self"]);return r!=null&&N(t,["video"],pZ(n,r)),t}function xZ(n,e){const t={},r=S(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>gZ(n,l))),N(t,["generatedVideos"],o)}const s=S(e,["raiMediaFilteredCount"]);s!=null&&N(t,["raiMediaFilteredCount"],s);const a=S(e,["raiMediaFilteredReasons"]);return a!=null&&N(t,["raiMediaFilteredReasons"],a),t}function _k(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["metadata"]);s!=null&&N(t,["metadata"],s);const a=S(e,["done"]);a!=null&&N(t,["done"],a);const o=S(e,["error"]);o!=null&&N(t,["error"],o);const l=S(e,["response"]);return l!=null&&N(t,["response"],xZ(n,l)),t}class yZ extends ym{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;return r&&"httpOptions"in r&&(a=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=cZ(this.apiClient,e);return l=Ot("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>_k(this.apiClient,m))}else{const d=lZ(this.apiClient,e);return l=Ot("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>mZ(this.apiClient,m))}}async fetchPredictVideosOperationInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=dZ(this.apiClient,e);return a=Ot("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>_k(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}function vZ(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],r);const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function bZ(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);t!==void 0&&a!=null&&N(t,["_query","pageToken"],a);const o=S(e,["filter"]);return t!==void 0&&o!=null&&N(t,["_query","filter"],o),r}function _Z(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],bZ(n,r,t)),t}function wZ(n,e){const t={},r=S(e,["textInput"]);r!=null&&N(t,["textInput"],r);const s=S(e,["output"]);return s!=null&&N(t,["output"],s),t}function SZ(n,e){const t={};if(S(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=S(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>wZ(n,a))),N(t,["examples","examples"],s)}return t}function jZ(n,e,t){const r={};if(S(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=S(e,["tunedModelDisplayName"]);if(t!==void 0&&s!=null&&N(t,["displayName"],s),S(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=S(e,["epochCount"]);t!==void 0&&a!=null&&N(t,["tuningTask","hyperparameters","epochCount"],a);const o=S(e,["learningRateMultiplier"]);if(o!=null&&N(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),S(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(S(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=S(e,["batchSize"]);t!==void 0&&l!=null&&N(t,["tuningTask","hyperparameters","batchSize"],l);const c=S(e,["learningRate"]);return t!==void 0&&c!=null&&N(t,["tuningTask","hyperparameters","learningRate"],c),r}function NZ(n,e){const t={},r=S(e,["baseModel"]);r!=null&&N(t,["baseModel"],r);const s=S(e,["trainingDataset"]);s!=null&&N(t,["tuningTask","trainingData"],SZ(n,s));const a=S(e,["config"]);return a!=null&&N(t,["config"],jZ(n,a,t)),t}function CZ(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["_url","name"],r);const s=S(e,["config"]);return s!=null&&N(t,["config"],s),t}function TZ(n,e,t){const r={},s=S(e,["pageSize"]);t!==void 0&&s!=null&&N(t,["_query","pageSize"],s);const a=S(e,["pageToken"]);t!==void 0&&a!=null&&N(t,["_query","pageToken"],a);const o=S(e,["filter"]);return t!==void 0&&o!=null&&N(t,["_query","filter"],o),r}function PZ(n,e){const t={},r=S(e,["config"]);return r!=null&&N(t,["config"],TZ(n,r,t)),t}function MZ(n,e,t){const r={},s=S(e,["gcsUri"]);if(t!==void 0&&s!=null&&N(t,["supervisedTuningSpec","trainingDatasetUri"],s),S(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function kZ(n,e){const t={},r=S(e,["gcsUri"]);return r!=null&&N(t,["validationDatasetUri"],r),t}function EZ(n,e,t){const r={},s=S(e,["validationDataset"]);t!==void 0&&s!=null&&N(t,["supervisedTuningSpec"],kZ(n,s));const a=S(e,["tunedModelDisplayName"]);t!==void 0&&a!=null&&N(t,["tunedModelDisplayName"],a);const o=S(e,["description"]);t!==void 0&&o!=null&&N(t,["description"],o);const l=S(e,["epochCount"]);t!==void 0&&l!=null&&N(t,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=S(e,["learningRateMultiplier"]);t!==void 0&&c!=null&&N(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=S(e,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&N(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const m=S(e,["adapterSize"]);if(t!==void 0&&m!=null&&N(t,["supervisedTuningSpec","hyperParameters","adapterSize"],m),S(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(S(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function DZ(n,e){const t={},r=S(e,["baseModel"]);r!=null&&N(t,["baseModel"],r);const s=S(e,["trainingDataset"]);s!=null&&N(t,["supervisedTuningSpec","trainingDatasetUri"],MZ(n,s,t));const a=S(e,["config"]);return a!=null&&N(t,["config"],EZ(n,a,t)),t}function OZ(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["model"],r);const s=S(e,["name"]);return s!=null&&N(t,["endpoint"],s),t}function jF(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["state"]);s!=null&&N(t,["state"],cF(n,s));const a=S(e,["createTime"]);a!=null&&N(t,["createTime"],a);const o=S(e,["tuningTask","startTime"]);o!=null&&N(t,["startTime"],o);const l=S(e,["tuningTask","completeTime"]);l!=null&&N(t,["endTime"],l);const c=S(e,["updateTime"]);c!=null&&N(t,["updateTime"],c);const d=S(e,["description"]);d!=null&&N(t,["description"],d);const m=S(e,["baseModel"]);m!=null&&N(t,["baseModel"],m);const p=S(e,["_self"]);p!=null&&N(t,["tunedModel"],OZ(n,p));const x=S(e,["distillationSpec"]);x!=null&&N(t,["distillationSpec"],x);const v=S(e,["experiment"]);v!=null&&N(t,["experiment"],v);const _=S(e,["labels"]);_!=null&&N(t,["labels"],_);const w=S(e,["pipelineJob"]);w!=null&&N(t,["pipelineJob"],w);const j=S(e,["tunedModelDisplayName"]);return j!=null&&N(t,["tunedModelDisplayName"],j),t}function IZ(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["tunedModels"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>jF(n,o))),N(t,["tuningJobs"],a)}return t}function AZ(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["metadata"]);s!=null&&N(t,["metadata"],s);const a=S(e,["done"]);a!=null&&N(t,["done"],a);const o=S(e,["error"]);return o!=null&&N(t,["error"],o),t}function RZ(n,e){const t={},r=S(e,["checkpointId"]);r!=null&&N(t,["checkpointId"],r);const s=S(e,["epoch"]);s!=null&&N(t,["epoch"],s);const a=S(e,["step"]);a!=null&&N(t,["step"],a);const o=S(e,["endpoint"]);return o!=null&&N(t,["endpoint"],o),t}function LZ(n,e){const t={},r=S(e,["model"]);r!=null&&N(t,["model"],r);const s=S(e,["endpoint"]);s!=null&&N(t,["endpoint"],s);const a=S(e,["checkpoints"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>RZ(n,l))),N(t,["checkpoints"],o)}return t}function cN(n,e){const t={},r=S(e,["name"]);r!=null&&N(t,["name"],r);const s=S(e,["state"]);s!=null&&N(t,["state"],cF(n,s));const a=S(e,["createTime"]);a!=null&&N(t,["createTime"],a);const o=S(e,["startTime"]);o!=null&&N(t,["startTime"],o);const l=S(e,["endTime"]);l!=null&&N(t,["endTime"],l);const c=S(e,["updateTime"]);c!=null&&N(t,["updateTime"],c);const d=S(e,["error"]);d!=null&&N(t,["error"],d);const m=S(e,["description"]);m!=null&&N(t,["description"],m);const p=S(e,["baseModel"]);p!=null&&N(t,["baseModel"],p);const x=S(e,["tunedModel"]);x!=null&&N(t,["tunedModel"],LZ(n,x));const v=S(e,["supervisedTuningSpec"]);v!=null&&N(t,["supervisedTuningSpec"],v);const _=S(e,["tuningDataStats"]);_!=null&&N(t,["tuningDataStats"],_);const w=S(e,["encryptionSpec"]);w!=null&&N(t,["encryptionSpec"],w);const j=S(e,["partnerModelTuningSpec"]);j!=null&&N(t,["partnerModelTuningSpec"],j);const P=S(e,["distillationSpec"]);P!=null&&N(t,["distillationSpec"],P);const k=S(e,["experiment"]);k!=null&&N(t,["experiment"],k);const I=S(e,["labels"]);I!=null&&N(t,["labels"],I);const M=S(e,["pipelineJob"]);M!=null&&N(t,["pipelineJob"],M);const D=S(e,["tunedModelDisplayName"]);return D!=null&&N(t,["tunedModelDisplayName"],D),t}function FZ(n,e){const t={},r=S(e,["nextPageToken"]);r!=null&&N(t,["nextPageToken"],r);const s=S(e,["tuningJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>cN(n,o))),N(t,["tuningJobs"],a)}return t}class qZ extends ym{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Ux(Nf.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:Qj.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=CZ(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>cN(this.apiClient,m))}else{const d=vZ(this.apiClient,e);return l=Ot("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>jF(this.apiClient,m))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=PZ(this.apiClient,e);return l=Ot("tuningJobs",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const p=FZ(this.apiClient,m),x=new JM;return Object.assign(x,p),x})}else{const d=_Z(this.apiClient,e);return l=Ot("tunedModels",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),o.then(m=>{const p=IZ(this.apiClient,m),x=new JM;return Object.assign(x,p),x})}}async tuneInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=DZ(this.apiClient,e);return a=Ot("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>cN(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=NZ(this.apiClient,e);return a=Ot("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>AZ(this.apiClient,c))}}}class zZ{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const UZ=1024*1024*8,VZ=3,BZ=1e3,WZ=2,Jv="x-goog-upload-status";async function $Z(n,e,t){var r,s,a;let o=0,l=0,c=new Xj(new Response),d="upload";for(o=n.size;l<o;){const p=Math.min(UZ,o-l),x=n.slice(l,l+p);l+p>=o&&(d+=", finalize");let v=0,_=BZ;for(;v<VZ&&(c=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(p)}}}),!(!((r=c?.headers)===null||r===void 0)&&r[Jv]));)v++,await YZ(_),_=_*WZ;if(l+=p,((s=c?.headers)===null||s===void 0?void 0:s[Jv])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const m=await c?.json();if(((a=c?.headers)===null||a===void 0?void 0:a[Jv])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return m.file}async function HZ(n){return{size:n.size,type:n.type}}function YZ(n){return new Promise(e=>setTimeout(e,n))}class GZ{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await $Z(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await HZ(e)}}class ZZ{create(e,t,r){return new KZ(e,t,r)}}class KZ{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const wk="x-goog-api-key";class JZ{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(wk)===null&&e.append(wk,this.apiKey)}}const QZ="gl-node/";class XZ{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=Q$(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new JZ(this.apiKey);this.apiClient=new $G({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:QZ+"web",uploader:new GZ,downloader:new zZ}),this.models=new oZ(this.apiClient),this.live=new nZ(this.apiClient,s,new ZZ),this.chats=new x8(this.models,this.apiClient),this.caches=new m8(this.apiClient),this.files=new k8(this.apiClient),this.operations=new yZ(this.apiClient),this.tunings=new qZ(this.apiClient)}}const rm="onboarding-documents",dN="avatars",Sk="support-attachments",fh="logo",hh="background",eK="task-attachments",tK="your-google-genai-api-key";let ll=null;ll=new XZ({apiKey:tK});const uN=n=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(uN);const e={...n};if(typeof e.name=="string"&&typeof e.path=="string"){const t=e.path.startsWith("avatars/")?dN:rm,{data:{publicUrl:r}}=De.storage.from(t).getPublicUrl(e.path);e.preview=r,e.url=r}for(const t in e)e[t]=uN(e[t]);return e},fN=async(n,e,t)=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return Promise.all(n.map(s=>fN(s,e,t)));const r={...n};if(r.file instanceof File){const s=r.file,a=`${e}/documents/${Date.now()}_${s.name}`,{error:o}=await De.storage.from(rm).upload(a,s);if(o)throw o;try{await De.from("user_documents").insert({user_id:e,submission_id:t||null,name:r.name||s.name,bucket:rm,path:a,file_type:s.type,file_size:s.size})}catch(l){console.error("Failed to record uploaded document:",l)}return{name:r.name||s.name,type:s.type,size:s.size,path:a}}if(typeof r.name=="string"&&r.path)return{name:r.name,type:r.type,size:r.size,path:r.path};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(r[s]=await fN(r[s],e,t));return r},nK=async n=>await(await fetch(n)).blob(),on=n=>{if(Array.isArray(n))return n.map(e=>on(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)&&!(n instanceof File)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/[A-Z]/g,s=>`_${s.toLowerCase()}`);e[r]=on(n[t])}return e}return n},pt=n=>{if(Array.isArray(n))return n.map(e=>pt(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/_([a-z])/g,s=>s[1].toUpperCase());e[r]=pt(n[t])}return uN(e)}return n},pe={getInitialAppData:async()=>{const{data:n,error:e}=await De.from("settings").select("*").eq("id","singleton").single();if(e)throw new Error("Failed to fetch core application settings.");const{data:t,error:r}=await De.from("roles").select("*");if(r)throw new Error("Failed to fetch user roles.");const{data:s,error:a}=await De.from("holidays").select("*");if(a)throw new Error("Failed to fetch holidays.");return{settings:pt(n),roles:(t||[]).map(pt),holidays:(s||[]).map(pt)}},getVerificationSubmissions:async(n,e)=>{let t=De.from("onboarding_submissions").select("*");n&&(t=t.eq("status",n)),e&&(t=t.eq("organization_id",e));const{data:r,error:s}=await t.order("created_at",{ascending:!1});if(s)throw s;return(r||[]).map(pt)},getOnboardingDataById:async n=>{const{data:e,error:t}=await De.from("onboarding_submissions").select("*").eq("id",n).single();if(t&&t.code!=="PGRST116")throw t;return e?pt(e):null},_saveSubmission:async(n,e)=>{const{data:{session:t}}=await De.auth.getSession();if(!t?.user)throw new Error("User not authenticated");const r=n.id&&!n.id.startsWith("draft_")?n.id:crypto.randomUUID(),s=await fN(n,t.user.id,r),a={...on(s),id:r,user_id:t.user.id,status:e?"draft":n.status};delete a.file,delete a.confirm_account_number;const{data:o,error:l}=await De.from("onboarding_submissions").upsert(a,{onConflict:"id"}).select("id").single();if(l)throw l;return{draftId:o.id}},saveDraft:async n=>pe._saveSubmission(n,!0),submitOnboarding:async n=>{const{draftId:e}=await pe._saveSubmission(n,!1),t=await pe.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve submitted data.");return t},updateOnboarding:async n=>{const{draftId:e}=await pe._saveSubmission(n,n.status==="draft"),t=await pe.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve updated data.");return t},verifySubmission:async n=>{const{error:e}=await De.from("onboarding_submissions").update({status:"verified",portal_sync_status:"pending_sync"}).eq("id",n);if(e)throw e},requestChanges:async(n,e)=>{const{error:t}=await De.from("onboarding_submissions").update({status:"rejected"}).eq("id",n);if(t)throw t},syncPortals:async n=>{const{data:e,error:t}=await De.functions.invoke("sync-portals",{body:{submissionId:n}});if(t)throw t;return pt(e)},deleteFile:async n=>{const{error:e}=await De.storage.from(rm).remove([n]);if(e)throw e},uploadDocument:async(n,e=rm,t,r)=>{const{data:{session:s}}=await De.auth.getSession(),a=s?.user?.id||"anonymous_user",o=`${a}/documents/${Date.now()}_${n.name}`,{error:l}=await De.storage.from(e).upload(o,n);if(l)throw l;const{data:c}=De.storage.from(e).getPublicUrl(o);if(!c.publicUrl)throw new Error("Could not get public URL for uploaded file.");try{await De.from("user_documents").insert({user_id:a,submission_id:t||null,name:r||n.name,bucket:e,path:o,file_type:n.type,file_size:n.size})}catch(d){console.error("Failed to insert user_documents record:",d)}return{url:c.publicUrl,path:o}},getUsers:async()=>{const{data:n,error:e}=await De.from("users").select("*, role_id");if(e)throw e;return(n||[]).map(t=>pt({...t,role:t.role_id}))},getUsersWithManagers:async()=>{const{data:n,error:e}=await De.from("users").select("*, reporting_manager_id, role_id");if(e)throw e;const t=(n||[]).map(s=>pt({...s,role:s.role_id})),r=new Map(t.map(s=>[s.id,s.name]));return t.map(s=>({...s,managerName:s.reportingManagerId?r.get(s.reportingManagerId):void 0}))},getFieldOfficers:async()=>pe.getUsers().then(n=>n.filter(e=>e.role==="field_officer")),getNearbyUsers:async()=>{const n=await pe.getUsers();let e={};try{const t=new Date;t.setHours(0,0,0,0);const r=new Date,s=await pe.getAllAttendanceEvents(t.toISOString(),r.toISOString()),a={};s.forEach(o=>{const{userId:l,type:c,timestamp:d}=o;l&&(!a[l]||new Date(d)>new Date(a[l].timestamp))&&(a[l]={type:c.toLowerCase(),timestamp:d})}),e=Object.fromEntries(Object.entries(a).map(([o,l])=>{const c=l.type.toLowerCase().replace(/[-_\s]/g,""),d=c==="checkin";return console.log(`User ${o}: latest event type = "${l.type}", normalized = "${c}", isCheckIn = ${d}`),[o,d]}))}catch(t){console.warn("Failed to compute user availability:",t)}return n.map(t=>({...t,isAvailable:e[t.id]??!1}))},updateUser:async(n,e)=>{const{role:t,...r}=e,s=on(r);if(t&&(s.role_id=t),"photo_url"in s){const{data:{session:l}}=await De.auth.getSession();if(!l?.user)throw new Error("User not authenticated for photo upload");const c=l.user.id,{data:d}=await De.from("users").select("photo_url").eq("id",n).single(),m=d?.photo_url,p=async x=>{if(x)try{const _=new URL(x).pathname.split("/public/")[1];if(_){const[w,...j]=_.split("/"),P=j.join("/");P&&await De.storage.from(w).remove([P])}}catch(v){console.error("Failed to process old avatar URL for deletion:",v)}};if(s.photo_url&&s.photo_url.startsWith("data:")){await p(m);const x=await nK(s.photo_url),v=s.photo_url.split(";")[0].split("/")[1]||"jpg",_=`${c}/${Date.now()}.${v}`,{error:w}=await De.storage.from(dN).upload(_,x,{upsert:!0});if(w)throw w;const{data:{publicUrl:j}}=De.storage.from(dN).getPublicUrl(_);s.photo_url=j}else s.photo_url===null&&await p(m)}const{data:a,error:o}=await De.from("users").update(s).eq("id",n).select().single();if(o)throw o;return pt({...a,role:a.role_id})},createUser:async n=>{const{role:e,...t}=n,r=on(t);e&&(r.role_id=e);const{data:s,error:a}=await De.from("users").insert(r).select().single();if(a)throw a;return pt({...s,role:s.role_id})},deleteUser:async n=>{const{error:e}=await De.from("users").delete().eq("id",n);if(e)throw e},updateUserReportingManager:async(n,e)=>{const{error:t}=await De.from("users").update({reporting_manager_id:e}).eq("id",n);if(t)throw t},getOrganizations:async()=>{const{data:n,error:e}=await De.from("organizations").select("*").order("short_name");if(e)throw e;return(n||[]).map(pt)},createOrganization:async n=>{const{data:e,error:t}=await De.from("organizations").insert(on(n)).select().single();if(t)throw t;return pt(e)},getOrganizationStructure:async()=>{const{data:n,error:e}=await De.from("organization_groups").select("*");if(e)throw e;const{data:t,error:r}=await De.from("companies").select("*");if(r)throw r;const{data:s,error:a}=await De.from("entities").select("*");if(a)throw a;const o=(n||[]).map(pt),l=(t||[]).map(pt),c=(s||[]).map(pt),d=new Map;return l.forEach(m=>{const p={...m,entities:c.filter(x=>x.companyId===m.id)};d.has(m.groupId)||d.set(m.groupId,[]),d.get(m.groupId).push(p)}),o.map(m=>({...m,companies:d.get(m.id)||[],locations:[]}))},getSiteConfigurations:async()=>{const{data:n,error:e}=await De.from("site_configurations").select("*");if(e)throw e;return(n||[]).map(pt)},bulkUploadOrganizations:async n=>{const{count:e,error:t}=await De.from("organizations").upsert(on(n),{onConflict:"id"});if(t)throw t;return{count:e||0}},getModules:async()=>{const{data:n,error:e}=await De.from("app_modules").select("*");if(e)throw e;return(n||[]).map(pt)},saveModules:async n=>{const{error:e}=await De.from("app_modules").upsert(on(n));if(e)throw e},getRoles:async()=>{const{data:n,error:e}=await De.from("roles").select("*");if(e)throw e;return(n||[]).map(pt)},saveRoles:async n=>{const{error:e}=await De.from("roles").upsert(on(n));if(e)throw e},getHolidays:async()=>{const{data:n,error:e}=await De.from("holidays").select("*");if(e)throw e;return(n||[]).map(pt)},addHoliday:async n=>{const{data:e,error:t}=await De.from("holidays").insert(on(n)).select().single();if(t)throw t;return pt(e)},removeHoliday:async n=>{const{error:e}=await De.from("holidays").delete().eq("id",n);if(e)throw e},getAttendanceEvents:async(n,e,t)=>{const{data:r,error:s}=await De.from("attendance_events").select("*").eq("user_id",n).gte("timestamp",e).lte("timestamp",t);if(s)throw s;return(r||[]).map(pt)},getAllAttendanceEvents:async(n,e)=>{const{data:t,error:r}=await De.from("attendance_events").select("*").gte("timestamp",n).lte("timestamp",e);if(r)throw r;return(t||[]).map(pt)},getAttendanceDashboardData:async(n,e,t,r="UTC")=>{const{data:s,error:a}=await De.rpc("get_attendance_dashboard_data",{start_date_iso:Ue(n,"yyyy-MM-dd"),end_date_iso:Ue(e,"yyyy-MM-dd"),current_date_iso:Ue(t,"yyyy-MM-dd"),p_timezone:r});if(a)throw new Error("Could not load attendance dashboard data from the database function.");return s},addAttendanceEvent:async n=>{const{error:e}=await De.from("attendance_events").insert(on(n));if(e)throw e},getLocations:async()=>{const{data:n,error:e}=await De.from("locations").select("*, created_by_user:created_by (id, name)");if(e)throw e;return(n||[]).map(t=>{const r=pt(t),a=r.createdByUser?.name||void 0,{createdByUser:o,...l}=r;return{...l,createdByName:a}})},getUserLocations:async n=>{const{data:e,error:t}=await De.from("user_locations").select("location_id:location_id (*), id").eq("user_id",n);if(t)throw t;return(e||[]).map(r=>{const s=r.location_id||{};return pt(s)})},createLocation:async n=>{const e=on(n),{data:t,error:r}=await De.from("locations").insert(e).select("*").single();if(r)throw r;return pt(t)},assignLocationToUser:async(n,e)=>{const{error:t}=await De.from("user_locations").insert({user_id:n,location_id:e});if(t)throw t},updateLocation:async(n,e)=>{const t=on(e),{data:r,error:s}=await De.from("locations").update(t).eq("id",n).select("*").single();if(s)throw s;return pt(r)},deleteLocation:async n=>{const{error:e}=await De.from("locations").delete().eq("id",n);if(e)throw e},unassignLocationFromUser:async(n,e)=>{const{error:t}=await De.from("user_locations").delete().match({user_id:n,location_id:e});if(t)throw t},uploadLogo:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await De.storage.from(fh).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:s}}=De.storage.from(fh).getPublicUrl(t);return s},getLogos:async()=>{const{data:n,error:e}=await De.storage.from(fh).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=De.storage.from(fh).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteLogo:async n=>{const{error:e}=await De.storage.from(fh).remove([n]);if(e)throw e},uploadBackground:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await De.storage.from(hh).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:s}}=De.storage.from(hh).getPublicUrl(t);return s},getBackgroundImages:async()=>{const{data:n,error:e}=await De.storage.from(hh).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=De.storage.from(hh).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteBackground:async n=>{const{error:e}=await De.storage.from(hh).remove([n]);if(e)throw e},getAttendanceSettings:async()=>{const{data:n,error:e}=await De.from("settings").select("attendance_settings").eq("id","singleton").single();if(e)throw e;if(!n?.attendance_settings)throw new Error("Attendance settings are not configured.");return pt(n.attendance_settings)},saveAttendanceSettings:async n=>{const{error:e}=await De.from("settings").upsert({id:"singleton",attendance_settings:on(n),updated_at:new Date().toISOString()},{onConflict:"id"});if(e)throw console.error("Error saving attendance settings:",e),e},getRecurringHolidays:async()=>{const{data:n,error:e}=await De.from("recurring_holidays").select("*");if(e)throw e;return(n||[]).map(t=>({id:t.id,type:t.role_type,day:t.day,n:t.occurrence}))},addRecurringHoliday:async n=>{const e={role_type:n.type||"office",day:n.day,occurrence:n.n},{data:t,error:r}=await De.from("recurring_holidays").insert(e).select().single();if(r)throw r;return{id:t.id,type:t.role_type,day:t.day,n:t.occurrence}},deleteRecurringHoliday:async n=>{const{error:e}=await De.from("recurring_holidays").delete().eq("id",n);if(e)throw e},createAssignment:async(n,e,t)=>{const r=(await pe.getOrganizations()).find(s=>s.id===e);await pe.createTask({name:`Visit ${r?.shortName||"site"} for verification`,description:`Perform on-site duties and verification tasks for ${r?.shortName}.`,dueDate:t,priority:"Medium",assignedToId:n})},getLeaveBalancesForUser:async n=>{const e=w=>["hr","admin","finance"].includes(w)?"office":"field",{data:t,error:r}=await De.from("settings").select("attendance_settings").eq("id","singleton").single();if(r||!t?.attendance_settings)throw new Error("Could not load attendance rules.");const{data:s,error:a}=await De.from("users").select("role_id").eq("id",n).single();if(a)throw a;const o=e(s.role_id),l=pt(t.attendance_settings)[o],[{data:c,error:d},{data:m,error:p},{data:x,error:v}]=await Promise.all([De.from("leave_requests").select("leave_type, start_date, end_date, day_option").eq("user_id",n).eq("status","approved"),De.from("comp_off_logs").select("*").eq("user_id",n),De.from("extra_work_logs").select("hours_worked").eq("user_id",n).eq("claim_type","OT").eq("status","Approved").gte("work_date",Ue(ui(new Date),"yyyy-MM-dd")).lte("work_date",Ue(_a(new Date),"yyyy-MM-dd"))]);if(d||p||v)throw new Error("Failed to fetch all leave balance data.");const _={userId:n,earnedTotal:l.annualEarnedLeaves||0,earnedUsed:0,sickTotal:l.annualSickLeaves||0,sickUsed:0,floatingTotal:(l.monthlyFloatingLeaves||0)*12,floatingUsed:0,compOffTotal:(m||[]).length,compOffUsed:(m||[]).filter(w=>w.status==="used").length,otHoursThisMonth:(x||[]).reduce((w,j)=>w+(j.hours_worked||0),0)};return(c||[]).forEach(w=>{const j=w.day_option==="half"?.5:xm(new Date(w.end_date),new Date(w.start_date))+1;w.leave_type==="Earned"&&(_.earnedUsed+=j),w.leave_type==="Sick"&&(_.sickUsed+=j),w.leave_type==="Floating"&&(_.floatingUsed+=j)}),_},submitLeaveRequest:async n=>{const{data:e,error:t}=await De.from("users").select("reporting_manager_id").eq("id",n.userId).single();if(t)throw t;const{data:r,error:s}=await De.from("leave_requests").insert({...on(n),status:"pending_manager_approval",current_approver_id:e.reporting_manager_id||null,approval_history:[]}).select("*").single();if(s)throw s;return pt(r)},getLeaveRequests:async n=>{let e=De.from("leave_requests").select("*");n?.userId&&(e=e.eq("user_id",n.userId)),n?.userIds&&(e=e.in("user_id",n.userIds)),n?.status&&(e=e.eq("status",n.status)),n?.forApproverId&&(e=e.eq("current_approver_id",n.forApproverId)),n?.startDate&&n?.endDate&&(e=e.lte("start_date",n.endDate).gte("end_date",n.startDate));const{data:t,error:r}=await e.order("start_date",{ascending:!1});if(r)throw r;return(t||[]).map(pt)},getTasks:async()=>{const{data:n,error:e}=await De.from("tasks").select("*").order("created_at",{ascending:!1});if(e)throw e;return(n||[]).map(pt)},createTask:async n=>{const{data:e,error:t}=await De.from("tasks").insert(on({...n,status:"To Do",escalationStatus:"None"})).select().single();if(t)throw t;return pt(e)},updateTask:async(n,e)=>{if(e?.completionPhoto&&e.completionPhoto.file){const s=e.completionPhoto,a=s.file;try{const{path:o}=await pe.uploadDocument(a,eK);e.completionPhoto={name:s.name,type:s.type,size:s.size,path:o}}catch(o){console.error("Failed to upload task completion photo:",o),delete e.completionPhoto}}const{data:t,error:r}=await De.from("tasks").update(on(e)).eq("id",n).select().single();if(r)throw r;return pt(t)},deleteTask:async n=>{const{error:e}=await De.from("tasks").delete().eq("id",n);if(e)throw e},runAutomaticEscalations:async()=>{const{data:n,error:e}=await De.functions.invoke("run-escalations");if(e)throw e;return pt(n)},getNotifications:async n=>{const{data:e,error:t}=await De.from("notifications").select("*").eq("user_id",n).order("created_at",{ascending:!1});if(t)throw t;return(e||[]).map(pt)},createNotification:async n=>{const{data:e,error:t}=await De.from("notifications").insert(on(n)).select().single();if(t)throw t;return pt(e)},markNotificationAsRead:async n=>{await De.from("notifications").update({is_read:!0}).eq("id",n)},markAllNotificationsAsRead:async n=>{await De.from("notifications").update({is_read:!0}).eq("user_id",n).eq("is_read",!1)},createAuthUser:async n=>{const{name:e,email:t,password:r,role:s}=n;try{const{error:a}=await De.functions.invoke("admin-create-user",{body:{name:e,email:t,password:r,role:s}});if(a)throw a;const l=(await pe.getUsers()).find(c=>c.email===t);if(l)return l;console.warn("admin-create-user completed but user not found; falling back to client side signup")}catch(a){const o=typeof a?.message=="string"?a.message:String(a);if(!o.toLowerCase().includes("failed to send a request")&&!o.toLowerCase().includes("edge function"))throw a;console.warn("Edge function not reachable, falling back to client side signup");const{data:l,error:c}=await De.auth.signUp({email:t,password:r,options:{data:{name:e}}});if(c||!l?.user)throw c||new Error("Failed to sign up user");const d=l.user;try{await De.from("users").upsert({id:d.id,name:e,email:t,role_id:s},{onConflict:"id"})}catch(m){console.warn("Failed to upsert user profile after fallback signup:",m)}return{id:d.id,name:e,email:t,role:s,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}}return{id:"",name:e,email:t,role:s,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}},getPolicies:async()=>{const{data:n,error:e}=await De.from("policies").select("*");if(e)throw e;return(n||[]).map(pt)},createPolicy:async n=>{const{data:e,error:t}=await De.from("policies").insert(on(n)).select().single();if(t)throw t;return pt(e)},getInsurances:async()=>{const{data:n,error:e}=await De.from("insurances").select("*");if(e)throw e;return(n||[]).map(pt)},createInsurance:async n=>{const{data:e,error:t}=await De.from("insurances").insert(on(n)).select().single();if(t)throw t;return pt(e)},getApprovalWorkflowSettings:async()=>{const{data:n,error:e}=await De.from("settings").select("approval_workflow_settings").eq("id","singleton").single();if(e)throw e;if(!n?.approval_workflow_settings)throw new Error("Approval workflow settings are not configured.");return pt(n.approval_workflow_settings)},updateApprovalWorkflowSettings:async n=>{const{error:e}=await De.from("settings").update({approval_workflow_settings:on({finalConfirmationRole:n})}).eq("id","singleton");if(e)throw e},approveLeaveRequest:async(n,e)=>{const{data:t,error:r}=await De.from("leave_requests").select("approval_history").eq("id",n).single();if(r)throw r;const{finalConfirmationRole:s}=await pe.getApprovalWorkflowSettings(),{data:a}=await De.from("users").select("id").eq("role_id",s).limit(1).single(),{data:o,error:l}=await De.from("users").select("name").eq("id",e).single();if(l)throw l;const c={approver_id:e,approver_name:o.name,status:"approved",timestamp:new Date().toISOString()},d=[...t.approval_history||[],c],{error:m}=await De.from("leave_requests").update({status:"pending_hr_confirmation",current_approver_id:a?.id,approval_history:d}).eq("id",n);if(m)throw m},rejectLeaveRequest:async(n,e,t="")=>{const{data:r,error:s}=await De.from("leave_requests").select("approval_history").eq("id",n).single();if(s)throw s;const{data:a,error:o}=await De.from("users").select("name").eq("id",e).single();if(o)throw o;const l={approver_id:e,approver_name:a.name,status:"rejected",timestamp:new Date().toISOString(),comments:t},c=[...r.approval_history||[],l],{error:d}=await De.from("leave_requests").update({status:"rejected",current_approver_id:null,approval_history:c}).eq("id",n);if(d)throw d},confirmLeaveByHR:async(n,e)=>{const{data:t,error:r}=await De.from("leave_requests").select("leave_type, user_id, approval_history").eq("id",n).single();if(r)throw r;const{data:s,error:a}=await De.from("users").select("name").eq("id",e).single();if(a)throw a;const o={approver_id:e,approver_name:s.name,status:"approved",timestamp:new Date().toISOString(),comments:"Final approval."},l=[...t.approval_history||[],o],{error:c}=await De.from("leave_requests").update({status:"approved",current_approver_id:null,approval_history:l}).eq("id",n);if(c)throw c;if(t.leave_type==="Comp Off"){const{data:d,error:m}=await De.from("comp_off_logs").select("id").eq("user_id",t.user_id).eq("status","earned").limit(1).single();if(m&&m.code!=="PGRST116")throw m;d&&await De.from("comp_off_logs").update({status:"used",leave_request_id:n}).eq("id",d.id)}},submitExtraWorkClaim:async n=>{const{error:e}=await De.from("extra_work_logs").insert(on({...n,status:"Pending"}));if(e)throw e},getExtraWorkLogs:async n=>{let e=De.from("extra_work_logs").select("*");n?e=e.eq("user_id",n):e=e.eq("status","Pending");const{data:t,error:r}=await e.order("work_date",{ascending:!1});if(r)throw r;return(t||[]).map(pt)},approveExtraWorkClaim:async(n,e)=>{const{data:t,error:r}=await De.from("users").select("name").eq("id",e).single();if(r)throw r;const{data:s,error:a}=await De.from("extra_work_logs").select("*").eq("id",n).single();if(a)throw a;if(!s)throw new Error("Claim not found.");const{error:o}=await De.from("extra_work_logs").update({status:"Approved",approver_id:e,approver_name:t.name,approved_at:new Date().toISOString()}).eq("id",n);if(o)throw o;s.claim_type==="Comp Off"&&await pe.addCompOffLog({userId:s.user_id,userName:s.user_name,dateEarned:s.work_date,reason:`Claim approved: ${s.reason}`,status:"earned",grantedById:e,grantedByName:t.name})},rejectExtraWorkClaim:async(n,e,t)=>{const{data:r,error:s}=await De.from("users").select("name").eq("id",e).single();if(s)throw s;const{error:a}=await De.from("extra_work_logs").update({status:"Rejected",approver_id:e,approver_name:r.name,rejection_reason:t}).eq("id",n);if(a)throw a},getManpowerDetails:async n=>{const{data:e,error:t}=await De.rpc("get_manpower_details",{site_id_param:n});if(t)throw t;return pt(e)},addCompOffLog:async n=>{const{data:e,error:t}=await De.from("comp_off_logs").insert(on(n)).select().single();if(t)throw t;return pt(e)},exportAllData:async()=>{const n=["users","organizations","onboarding_submissions","settings"],e={};for(const t of n){const{data:r,error:s}=await De.from(t).select("*");if(s)throw new Error(`Failed to export ${t}`);e[t]=r}return pt(e)},getPincodeDetails:async n=>new Promise(e=>setTimeout(()=>e({city:"Bengaluru",state:"Karnataka"}),500)),suggestDepartmentForDesignation:async n=>{const e={"Security Guard":"Security","Housekeeping Staff":"Housekeeping","Site Manager":"Management"},t=Object.keys(e).find(r=>n.toLowerCase().includes(r.toLowerCase()));return Promise.resolve(t?e[t]:null)},verifyBankAccountWithPerfios:async n=>{console.log("Mock verifying bank account:",n),await new Promise(t=>setTimeout(t,1500));const e=Math.random()>.1;return{success:e,message:e?"Bank account verified successfully.":"Account holder name did not match.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:e,uan:null,esi:null,accountHolderName:e,accountNumber:e,ifscCode:!0}}},verifyAadhaar:async n=>{console.log("Mock verifying Aadhaar:",n),await new Promise(t=>setTimeout(t,1e3));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"Aadhaar details verified.":"Invalid Aadhaar number.",verifiedFields:{name:null,dob:null,aadhaar:e,bank:null,uan:null,esi:null}}},lookupUan:async n=>{console.log("Mock looking up UAN:",n),await new Promise(t=>setTimeout(t,1200));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"UAN found and linked.":"UAN not found in EPFO database.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:null,uan:e,esi:null}}},extractDataFromImage:async(n,e,t,r)=>{if(!ll)return console.warn("AI feature disabled: cannot extract data from image. Returning empty result."),{};const a=(await ll.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:`Extract the structured data from this document image. It is a ${r||"document"}.`},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:t}})).text.trim();return JSON.parse(a)},crossVerifyNames:async(n,e)=>{if(!ll){const s=n.trim().toLowerCase()===e.trim().toLowerCase();return{isMatch:s,reason:s?"Names are identical (case-insensitive match) without AI.":"AI disabled; simple case-insensitive comparison used."}}const r=(await ll.models.generateContent({model:"gemini-2.5-flash",contents:`Are these two names referring to the same person? Name 1: "${n}", Name 2: "${e}". Respond in JSON format with two keys: "isMatch" (boolean) and "reason" (a brief string explanation).`,config:{responseMimeType:"application/json",responseSchema:{type:Xe.OBJECT,properties:{isMatch:{type:Xe.BOOLEAN},reason:{type:Xe.STRING}}}}})).text.trim();return JSON.parse(r)},verifyFingerprintImage:async(n,e)=>{if(!ll)return{containsFingerprints:!1,reason:"AI disabled; cannot detect fingerprints."};const r=(await ll.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:'Does this image contain one or more human fingerprints? The image might be a scan from paper. Respond in JSON with "containsFingerprints" (boolean) and "reason" (string).'},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:{type:Xe.OBJECT,properties:{containsFingerprints:{type:Xe.BOOLEAN},reason:{type:Xe.STRING}}}}})).text.trim();return JSON.parse(r)},enhanceDocumentPhoto:async(n,e)=>{if(!ll)return console.warn("AI disabled; returning original document photo without enhancement."),n;const t=await ll.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{text:"Enhance this document photo. Improve contrast, correct perspective to be flat, and make text as clear as possible. Return only the enhanced image."},{inlineData:{data:n,mimeType:e}}]},config:{responseModalities:[nm.IMAGE]}});for(const r of t.candidates[0].content.parts)if(r.inlineData)return r.inlineData.data;throw new Error("AI did not return an enhanced image.")},getSiteStaffDesignations:async()=>{const{data:n,error:e}=await De.from("site_staff_designations").select("*");if(e)throw e;return(n||[]).map(pt)},updateManpowerDetails:async(n,e)=>{console.log("Mock updating manpower for",n,e),await new Promise(t=>setTimeout(t,500))},getCompOffLogs:async n=>{const{data:e,error:t}=await De.from("comp_off_logs").select("*").eq("user_id",n).order("date_earned",{ascending:!1});if(t)throw t;return(e||[]).map(pt)},checkCompOffTableExists:async()=>{const{error:n}=await De.from("comp_off_logs").select("id").limit(1);if(n)throw n},getAllSiteAssets:async()=>Promise.resolve({}),updateSiteAssets:async(n,e)=>(console.log("Mock updating assets for site",n,e),Promise.resolve()),getBackOfficeIdSeries:async()=>{const{data:n,error:e}=await De.from("back_office_id_series").select("*");if(e)throw e;return(n||[]).map(pt)},updateBackOfficeIdSeries:async n=>{const{error:e}=await De.from("back_office_id_series").upsert(on(n),{onConflict:"id"});if(e)throw e},updateSiteStaffDesignations:async n=>{const{error:e}=await De.from("site_staff_designations").upsert(on(n),{onConflict:"id"});if(e)throw e},getAllSiteIssuedTools:async()=>Promise.resolve({}),getToolsList:async()=>Promise.resolve({}),updateSiteIssuedTools:async(n,e)=>{console.log("Mock updating tools for site",n,e)},getAllSiteGentsUniforms:async()=>Promise.resolve({}),getMasterGentsUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteGentsUniforms:async(n,e)=>{console.log("Mock updating gents uniforms for",n,e)},getAllSiteUniformDetails:async()=>Promise.resolve({}),updateSiteUniformDetails:async(n,e)=>{console.log("Mock updating uniform details for",n,e)},getAllSiteLadiesUniforms:async()=>Promise.resolve({}),getMasterLadiesUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteLadiesUniforms:async(n,e)=>{console.log("Mock updating ladies uniforms for",n,e)},getUniformRequests:async()=>{const{data:n,error:e}=await De.from("uniform_requests").select("*");if(e)throw e;return(n||[]).map(pt)},submitUniformRequest:async n=>{const{data:e,error:t}=await De.from("uniform_requests").insert(on(n)).select().single();if(t)throw t;return pt(e)},updateUniformRequest:async n=>{const{data:e,error:t}=await De.from("uniform_requests").update(on(n)).eq("id",n.id).select().single();if(t)throw t;return pt(e)},deleteUniformRequest:async n=>{const{error:e}=await De.from("uniform_requests").delete().eq("id",n);if(e)throw e},getInvoiceStatuses:async n=>(console.log("Mock fetching invoice statuses for",n),Promise.resolve({})),getInvoiceSummaryData:async(n,e)=>(console.log("Mock fetching invoice data for",n,e),Promise.resolve({siteName:"Mock Site",siteAddress:"Mock Address",invoiceNumber:"INV-001",invoiceDate:"2023-01-31",statementMonth:"January-2023",lineItems:[]})),getSupportTickets:async()=>{const{data:n,error:e}=await De.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))");if(e)throw e;return(n||[]).map(pt)},getSupportTicketById:async n=>{const{data:e,error:t}=await De.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))").eq("id",n).single();if(t)throw t;return pt(e)},createSupportTicket:async n=>{const e=n.attachment;if(e&&e.file instanceof File)try{const{path:s}=await pe.uploadDocument(e.file,Sk);n.attachment={name:e.name,type:e.type,size:e.size,path:s}}catch(s){console.error("Failed to upload support ticket attachment:",s),delete n.attachment}const{data:t,error:r}=await De.from("support_tickets").insert(on(n)).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(r)throw r;return pt(t)},updateSupportTicket:async(n,e)=>{const t=e.attachment;if(t&&t.file instanceof File)try{const{path:a}=await pe.uploadDocument(t.file,Sk);e.attachment={name:t.name,type:t.type,size:t.size,path:a}}catch(a){console.error("Failed to upload updated support ticket attachment:",a),delete e.attachment}const{data:r,error:s}=await De.from("support_tickets").update(on(e)).eq("id",n).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(s)throw s;return pt(r)},addTicketPost:async(n,e)=>{const{data:t,error:r}=await De.from("ticket_posts").insert(on(e)).select("*, comments:ticket_comments(*)").single();if(r)throw r;return pt(t)},togglePostLike:async(n,e)=>{const{data:t,error:r}=await De.from("ticket_posts").select("likes").eq("id",n).single();if(r)throw r;const s=t.likes||[],a=s.includes(e)?s.filter(l=>l!==e):[...s,e],{error:o}=await De.from("ticket_posts").update({likes:a}).eq("id",n);if(o)throw o},addPostComment:async(n,e)=>{const{data:t,error:r}=await De.from("ticket_comments").insert(on(e)).select().single();if(r)throw r;return pt(t)},getVerificationCostBreakdown:async(n,e)=>{const{data:t,error:r}=await De.from("onboarding_submissions").select("id, employee_id, personal, enrollment_date, verification_usage").gte("enrollment_date",n).lte("enrollment_date",e);if(r)throw r;return(t||[]).map(s=>{const a=pt(s);return{id:a.id,employeeId:a.personal.employeeId,employeeName:`${a.personal.firstName} ${a.personal.lastName}`,enrollmentDate:a.enrollmentDate,totalCost:0,breakdown:a.verificationUsage||[]}})},generatePdf:async(n,e)=>{try{const t=(await UP(async()=>{const{default:r}=await import("./html2pdf-DGSApt0O.js").then(s=>s.h);return{default:r}},[],import.meta.url)).default;await t().set(e).from(n).save()}catch(t){throw console.error("PDF generation failed:",t),t}},batchResolveAddresses:async n=>{if(n.length===0)return{};const e=c=>parseFloat(c.toFixed(6)),t=Array.from(new Set(n.map(c=>`${e(c.lat)},${e(c.lon)}`))).map(c=>{const[d,m]=c.split(",").map(Number);return{lat:d,lon:m}}),r={},s=[],a=t.map(c=>c.lat),{data:o,error:l}=await De.from("location_cache").select("*").in("latitude",a);!l&&o&&o.forEach(c=>{const d=e(parseFloat(c.latitude)),m=e(parseFloat(c.longitude)),p=`${d},${m}`;t.some(x=>e(x.lat)===d&&e(x.lon)===m)&&(r[p]=c.address)}),t.forEach(c=>{const d=`${e(c.lat)},${e(c.lon)}`;r[d]||s.push(c)}),console.log("Geocoding API: Found",Object.keys(r).length,"cached,",s.length,"missing");for(const c of s)try{const d=await UP(()=>Promise.resolve().then(()=>sK),void 0,import.meta.url).then(p=>p.reverseGeocode(c.lat,c.lon)),m=`${e(c.lat)},${e(c.lon)}`;r[m]=d,await De.from("location_cache").insert({latitude:e(c.lat),longitude:e(c.lon),address:d}),console.log("Geocoding API: Fetched and cached",m,"->",d),await new Promise(p=>setTimeout(p,1e3))}catch(d){console.error(`Failed to resolve address for ${c.lat},${c.lon}`,d);const m=`${e(c.lat)},${e(c.lon)}`;r[m]=`${c.lat.toFixed(4)}, ${c.lon.toFixed(4)}`}return r},sendSecurityAlert:async(n,e,t,r)=>{const{data:s,error:a}=await De.from("users").select("reporting_manager_id").eq("id",n).single();if(a||!s?.reporting_manager_id){console.warn("Could not find reporting manager for security alert");return}const o=t==="developer_mode"?"attempted to access the application with Developer Mode enabled":"attempted to access the application with Location Spoofing detected",l=r?` using device: ${r}`:"";await pe.createNotification({userId:s.reporting_manager_id,title:" Security Alert",message:`${e} ${o}${l}. Access was blocked for security reasons.`,type:"security",link:"/user-management"})},sendDeviceChangeAlert:async(n,e,t,r)=>{const{data:s,error:a}=await De.from("users").select("reporting_manager_id").eq("id",n).single();if(a||!s?.reporting_manager_id){console.warn("Could not find reporting manager for device change alert");return}await pe.createNotification({userId:s.reporting_manager_id,title:" Device Change Detected",message:`${e} logged in from a new device. Previous device: ${t}, New device: ${r}`,type:"info",link:"/user-management"})}},rK=(n,e,t="Operation timed out")=>{const r=new Promise((s,a)=>{setTimeout(()=>a(new Error(t)),e)});return Promise.race([n,r])};function hN(n,e,t,r){const s=m=>m*Math.PI/180,o=s(t-n),l=s(r-e),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(s(n))*Math.cos(s(t))*Math.sin(l/2)*Math.sin(l/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}async function sm(n,e){const t=`${n.toFixed(4)}, ${e.toFixed(4)}`;try{const r=`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${n}&lon=${e}&zoom=16&addressdetails=1`,s=await fetch(r);if(!s.ok)return t;const a=await s.json();if(a.display_name)return a.display_name;if(a.address){const{road:o,suburb:l,city:c,village:d,town:m,state:p,country:x}=a.address;return[o,l,c||d||m,p,x].filter(Boolean).join(", ")}return t}catch(r){return console.warn("Reverse geocode failed:",r),t}}function Bx(n=50,e=1e4){return new Promise((t,r)=>{if(!("geolocation"in navigator))return r(new Error("Geolocation is not supported by this browser."));let s=null;const a=setTimeout(()=>{s?(navigator.geolocation.clearWatch(o),t(s)):(navigator.geolocation.clearWatch(o),r(new Error("Unable to acquire a precise position within the timeout period")))},e),o=navigator.geolocation.watchPosition(l=>{(!s||l.coords.accuracy<s.coords.accuracy)&&(s=l),l.coords.accuracy<=n&&(clearTimeout(a),navigator.geolocation.clearWatch(o),t(l))},l=>{clearTimeout(a),navigator.geolocation.clearWatch(o),r(l)},{enableHighAccuracy:!0,maximumAge:0})})}const sK=Object.freeze(Object.defineProperty({__proto__:null,calculateDistanceMeters:hN,getPrecisePosition:Bx,reverseGeocode:sm},Symbol.toStringTag,{value:"Module"})),kp=n=>{const e=n.toLowerCase();return e.includes("timed out")?"The request took too long. Please check your internet connection and try again.":e.includes("invalid api key")||e.includes("configuration")?"System configuration error. Please contact support.":e.includes("failed to fetch")||e.includes("network")?"Unable to connect. Please check your internet connection.":e.includes("invalid login credentials")?'Incorrect email or password. If you use Google Sign-In, please click "Sign in with Google".':e.includes("user already registered")||e.includes("already exists")?"This email is already registered. Please sign in.":e.includes("email not confirmed")?"Please verify your email address. Check your inbox for the confirmation link.":e.includes("too many requests")||e.includes("rate limit")?"Too many attempts. Please wait a few minutes before trying again.":e.includes("weak password")?"Password is too weak. Please use a stronger password.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again or contact support.")},Qv=()=>{const n=new Date().getHours();return n<12?"Good Morning":n<17?"Good Afternoon":"Good Evening"},St=Ma()((n,e)=>({user:null,isInitialized:!1,isCheckedIn:!1,isAttendanceLoading:!0,lastCheckInTime:null,lastCheckOutTime:null,error:null,loading:!1,isLoginAnimationPending:!1,setLoginAnimationPending:t=>n({isLoginAnimationPending:t}),setUser:t=>n({user:t,error:null,loading:!1}),setInitialized:t=>n({isInitialized:t}),setLoading:t=>n({loading:t}),resetAttendance:()=>n({isCheckedIn:!1,isAttendanceLoading:!1,lastCheckInTime:null,lastCheckOutTime:null,isLoginAnimationPending:!1}),setError:t=>n({error:t}),loginWithEmail:async(t,r,s)=>{n({error:null,loading:!0});try{await xa.signOut()}catch{}try{const{data:a,error:o}=await rK(xa.signInWithPassword(t,r),2e4,"Login attempt timed out. Please check your network connection.").catch(c=>({data:{user:null,session:null},error:{message:c.message}}));if(o||!a.user||!a.session){const c=kp(o?.message||"Invalid login credentials");return n({error:c,loading:!1}),{error:{message:c}}}s?(localStorage.setItem("rememberedEmail",t),localStorage.setItem("supabase.auth.rememberMe",a.session.refresh_token)):(localStorage.removeItem("rememberedEmail"),localStorage.removeItem("supabase.auth.rememberMe"));const l=await xa.getAppUserProfile(a.user);if(l){n({user:l,error:null,loading:!1});try{const c=`greetingSent_${l.id}`,d=Qv();await pe.createNotification({userId:l.id,message:`${d}, ${l.name||"there"}! Welcome back to Paradigm Services.`,type:"greeting"})}catch(c){console.error("Failed to send login greeting notification",c)}return{error:null}}else{await xa.signOut();const c="Login successful, but failed to retrieve user profile. Please try again.";return n({user:null,error:c,loading:!1}),{error:{message:c}}}}catch(a){console.error("Unexpected error during login flow:",a);const o=kp("Unexpected error during login flow");return n({user:null,error:o,loading:!1}),{error:{message:o}}}},signUp:async(t,r,s)=>{n({error:null,loading:!0});const{error:a}=await xa.signUpWithPassword({email:r,password:s,options:{data:{name:t}}});if(a){const o=kp(a.message);return n({error:o,loading:!1}),{error:{message:o}}}return n({loading:!1}),{error:null}},loginWithGoogle:async()=>{n({error:null,loading:!0});const{error:t}=await xa.signInWithGoogle();if(t){const r=kp(t.message);return n({error:r,loading:!1}),{error:{message:r}}}return n({loading:!1}),{error:null}},sendPasswordReset:async t=>{const{error:r}=await xa.resetPasswordForEmail(t);return r?{error:{message:r.message}}:{error:null}},logout:async()=>{const t=e().user;if(t)try{const r=Qv(),s=new Date().getHours()>=20?"Good Night":r;await pe.createNotification({userId:t.id,message:`${s}, ${t.name||"there"}! Thanks for your hard work today.`,type:"greeting"})}catch(r){console.error("Failed to send logout farewell notification",r)}localStorage.removeItem("supabase.auth.rememberMe"),await xa.signOut()},updateUserProfile:t=>n(r=>({user:r.user?{...r.user,...t}:null})),checkAttendanceStatus:async()=>{const{user:t}=e();if(!t){n({isAttendanceLoading:!1});return}n({isAttendanceLoading:!0});try{const r=new Date,s=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0).toISOString(),a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999).toISOString(),o=await pe.getAttendanceEvents(t.id,s,a);if(o.length===0){n({isCheckedIn:!1,lastCheckInTime:null,lastCheckOutTime:null,isAttendanceLoading:!1});return}o.sort((m,p)=>new Date(m.timestamp).getTime()-new Date(p.timestamp).getTime());const l=o.find(m=>m.type==="check-in"),c=[...o].reverse().find(m=>m.type==="check-out"),d=o[o.length-1];n({isCheckedIn:d?.type==="check-in",lastCheckInTime:l?l.timestamp:null,lastCheckOutTime:c?c.timestamp:null,isAttendanceLoading:!1})}catch(r){console.error("Failed to check attendance status:",r),n({isAttendanceLoading:!1})}},toggleCheckInStatus:async()=>{const{user:t,isCheckedIn:r}=e();if(!t)return{success:!1,message:"User not found"};const s=r?"check-out":"check-in";try{let a=null;try{a=await Bx()}catch{}(!a||!a.coords)&&(a=await new Promise(p=>{navigator.geolocation.getCurrentPosition(x=>p(x),()=>p(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}));const o=async(p,x,v)=>{await pe.addAttendanceEvent({userId:t.id,timestamp:new Date().toISOString(),type:s,latitude:p,longitude:x,locationId:v}),await e().checkAttendanceStatus();try{const _=Qv(),w=s==="check-in"?"checking in":"checking out";await pe.createNotification({userId:t.id,message:`${_}, ${t.name||"there"}! Thanks for ${w}.`,type:"greeting"})}catch(_){console.warn("Failed to send user attendance notification",_)}try{const _=await pe.getAttendanceSettings();if((["admin","hr","finance","developer"].includes(t.role)?_?.office:_?.field)?.enableAttendanceNotifications){const P=[];t.reportingManagerId&&P.push({id:t.reportingManagerId});const k=await pe.getNearbyUsers();for(const O of k)P.find(q=>q.id===O.id)||P.push({id:O.id});const I=t.name||"An employee",M=v?"":p&&x?` at ${p.toFixed(4)}, ${x.toFixed(4)}`:"",D=`${I} ${s.replace("-"," ")}${M}`;await Promise.all(P.map(O=>pe.createNotification({userId:O.id,message:D,type:"greeting"})))}}catch(_){console.warn("Failed to create manager notifications:",_)}return{success:!0,message:`Successfully ${s.replace("-"," ")}!`}};if(!a||!a.coords)return await o(void 0,void 0,null);const{latitude:l,longitude:c,accuracy:d}=a.coords;if(typeof d=="number"&&d>1e3)return await o(l,c,null);let m=null;try{const p=await pe.getUserLocations(t.id);for(const x of p)if(hN(l,c,x.latitude,x.longitude)<=x.radius){m=x.id;break}if(!m){const x=await pe.getLocations();for(const v of x)if(hN(l,c,v.latitude,v.longitude)<=v.radius){m=v.id;try{await pe.assignLocationToUser(t.id,v.id)}catch(w){console.warn("Failed to autoassign location to user:",w)}break}}}catch(p){console.warn("Geofencing check failed:",p)}if(!m)try{let p=null;try{p=await sm(l,c)}catch(_){console.warn("Reverse geocode failed for new location:",_)}const v=await pe.createLocation({name:p||null,latitude:l,longitude:c,radius:100,address:p||null,createdBy:t.id});try{await pe.assignLocationToUser(t.id,v.id)}catch(_){console.warn("Failed to autoassign new location to user:",_)}m=v.id}catch(p){console.warn("Failed to create a new geofence location:",p),m=null}return await o(l,c,m)}catch(a){return console.error("Error during attendance update:",a),{success:!1,message:"Failed to update attendance."}}}})),iK={};function pu(n,e){let t;try{t=n()}catch{return}return{getItem:s=>{var a;const o=c=>c===null?null:JSON.parse(c,void 0),l=(a=t.getItem(s))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(s,a)=>t.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>t.removeItem(s)}}const im=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return im(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return im(r)(t)}}}},aK=(n,e)=>(t,r,s)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:j=>j,version:0,merge:(j,P)=>({...P,...j}),...e},o=!1;const l=new Set,c=new Set;let d;try{d=a.getStorage()}catch{}if(!d)return n((...j)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...j)},r,s);const m=im(a.serialize),p=()=>{const j=a.partialize({...r()});let P;const k=m({state:j,version:a.version}).then(I=>d.setItem(a.name,I)).catch(I=>{P=I});if(P)throw P;return k},x=s.setState;s.setState=(j,P)=>{x(j,P),p()};const v=n((...j)=>{t(...j),p()},r,s);let _;const w=()=>{var j;if(!d)return;o=!1,l.forEach(k=>k(r()));const P=((j=a.onRehydrateStorage)==null?void 0:j.call(a,r()))||void 0;return im(d.getItem.bind(d))(a.name).then(k=>{if(k)return a.deserialize(k)}).then(k=>{if(k)if(typeof k.version=="number"&&k.version!==a.version){if(a.migrate)return a.migrate(k.state,k.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return k.state}).then(k=>{var I;return _=a.merge(k,(I=r())!=null?I:v),t(_,!0),p()}).then(()=>{P?.(_,void 0),o=!0,c.forEach(k=>k(_))}).catch(k=>{P?.(void 0,k)})};return s.persist={setOptions:j=>{a={...a,...j},j.getStorage&&(d=j.getStorage())},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:j=>(l.add(j),()=>{l.delete(j)}),onFinishHydration:j=>(c.add(j),()=>{c.delete(j)})},w(),_||v},oK=(n,e)=>(t,r,s)=>{let a={storage:pu(()=>localStorage),partialize:w=>w,version:0,merge:(w,j)=>({...j,...w}),...e},o=!1;const l=new Set,c=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,s);const m=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=s.setState;s.setState=(w,j)=>{p(w,j),m()};const x=n((...w)=>{t(...w),m()},r,s);s.getInitialState=()=>x;let v;const _=()=>{var w,j;if(!d)return;o=!1,l.forEach(k=>{var I;return k((I=r())!=null?I:x)});const P=((j=a.onRehydrateStorage)==null?void 0:j.call(a,(w=r())!=null?w:x))||void 0;return im(d.getItem.bind(d))(a.name).then(k=>{if(k)if(typeof k.version=="number"&&k.version!==a.version){if(a.migrate)return[!0,a.migrate(k.state,k.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,k.state];return[!1,void 0]}).then(k=>{var I;const[M,D]=k;if(v=a.merge(D,(I=r())!=null?I:x),t(v,!0),M)return m()}).then(()=>{P?.(v,void 0),v=r(),o=!0,c.forEach(k=>k(v))}).catch(k=>{P?.(void 0,k)})};return s.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(c.add(w),()=>{c.delete(w)})},a.skipHydration||_(),v||x},lK=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((iK?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),aK(n,e)):oK(n,e),Rf=lK,gu=Ma(Rf(n=>({theme:"light",isAutomatic:!0,setTheme:e=>n({theme:e,isAutomatic:!1}),setAutomatic:e=>n({isAutomatic:e}),_setThemeInternal:e=>n({theme:e})}),{name:"paradigm-app-theme",storage:pu(()=>localStorage)})),cK={esiCtcThreshold:21e3,enforceManpowerLimit:!1,manpowerLimitRule:"warn",allowSalaryEdit:!1,salaryThreshold:21e3,defaultPolicySingle:"1L",defaultPolicyMarried:"2L",enableEsiRule:!1,enableGmcRule:!1,enforceFamilyValidation:!0,rulesByDesignation:{}},Zc=Ma()(n=>({...cK,init:e=>{e&&n(e)},updateRules:e=>n(t=>({...t,...e}))})),dK={admin:["view_all_submissions","manage_users","manage_sites","view_entity_management","view_developer_settings","view_operations_dashboard","view_site_dashboard","create_enrollment","manage_roles_and_permissions","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_approval_workflow","download_attendance_report","manage_tasks","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","view_field_officer_tracking","manage_modules","access_support_desk"],hr:["view_all_submissions","manage_users","manage_sites","view_entity_management","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","download_attendance_report","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","access_support_desk"],finance:["view_invoice_summary","view_verification_costing","view_own_attendance","apply_for_leave"],developer:["view_developer_settings"],operation_manager:["view_operations_dashboard","view_all_attendance","apply_for_leave","manage_leave_requests","manage_tasks","access_support_desk"],site_manager:["view_site_dashboard","create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"],field_officer:["create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"]},ka=Ma(Rf((n,e)=>({permissions:dK,initRoles:t=>{if(!t)return;const s={...e().permissions};let a=!1;t.forEach(o=>{s[o.id]||(s[o.id]=[],a=!0)}),a&&n({permissions:s})},addRolePermissionEntry:t=>{n(r=>({permissions:{...r.permissions,[t.id]:[]}}))},removeRolePermissionEntry:t=>{n(r=>{const s={...r.permissions};return delete s[t],{permissions:s}})},renameRolePermissionEntry:(t,r)=>{n(s=>{const a={...s.permissions};return a[t]&&(a[r]=a[t],delete a[t]),{permissions:a}})},setRolePermissions:(t,r)=>{n(s=>({permissions:{...s.permissions,[t]:r}}))}}),{name:"paradigm_app_permissions",storage:pu(()=>localStorage)})),uK={enablePincodeVerification:!0},fK={office:{minimumHoursFullDay:8,minimumHoursHalfDay:4,annualEarnedLeaves:5,annualSickLeaves:12,monthlyFloatingLeaves:1,annualCompOffLeaves:5,enableAttendanceNotifications:!1,sickLeaveCertificateThreshold:2},field:{minimumHoursFullDay:9,minimumHoursHalfDay:5,annualEarnedLeaves:10,annualSickLeaves:10,monthlyFloatingLeaves:0,annualCompOffLeaves:10,enableAttendanceNotifications:!0,sickLeaveCertificateThreshold:3}},hK={applicability:"Optional - Opt-in Default",optInDisclaimer:"Please note that currently the GMC facility covers only spouse and two children. If you would like to continue, please select below relationships and submit.",coverageDetails:"Spouse and two children",optOutDisclaimer:"Please note that you are opting out of the GMC Facility. You will have to submit a declaration to the company towards the same along with proof of your existing insurance.",requireAlternateInsurance:!0,collectProvider:!0,collectStartDate:!0,collectEndDate:!0,collectExtentOfCover:!0},mK={enabled:!0,clientId:"",clientSecret:""},pK={enabled:!0},gK={enabled:!0},xK={email:{enabled:!1}},yK=[{id:"cost_1",name:"Profile Picture",cost:0},{id:"cost_2",name:"Mobile to Form Prefill",cost:7},{id:"cost_3",name:"KYC OCR (Plus)",cost:1.5},{id:"cost_4",name:"Aadhaar Mobile Link",cost:2.5},{id:"cost_5",name:"EPF UAN Lookup",cost:2.5},{id:"cost_6",name:"Cheque OCR",cost:3},{id:"cost_7",name:"Bank AC Verification Advanced",cost:2.25},{id:"cost_8",name:"PAN Profile Detailed",cost:5},{id:"cost_9",name:"Aadhaar Verification",cost:1.75},{id:"cost_10",name:"Voter ID OCR",cost:1.5},{id:"cost_11",name:"Driving License OCR",cost:1.5},{id:"cost_12",name:"Education Certificate OCR",cost:2},{id:"cost_13",name:"Experience/Salary Slip OCR",cost:2},{id:"cost_14",name:"ESI Card OCR",cost:1.5}],vK={enableProvisionalSites:!1},fi=Ma()(Rf(n=>({address:uK,attendance:fK,officeHolidays:[],fieldHolidays:[],recurringHolidays:[],gmcPolicy:hK,perfiosApi:mK,geminiApi:pK,otp:gK,notifications:xK,verificationCosts:yK,siteManagement:vK,initSettings:e=>{if(e){const{holidays:t,attendanceSettings:r,recurringHolidays:s}=e,a=t.filter(l=>l.type==="office"),o=t.filter(l=>l.type==="field");n({officeHolidays:a,fieldHolidays:o,attendance:r,recurringHolidays:s||[]})}},updateAddressSettings:e=>n(t=>({address:{...t.address,...e}})),updateAttendanceSettings:e=>n({attendance:e}),updateGmcPolicySettings:e=>n(t=>({gmcPolicy:{...t.gmcPolicy,...e}})),updatePerfiosApiSettings:e=>n(t=>({perfiosApi:{...t.perfiosApi,...e}})),updateGeminiApiSettings:e=>n(t=>({geminiApi:{...t.geminiApi,...e}})),updateOtpSettings:e=>n(t=>({otp:{...t.otp,...e}})),updateNotificationSettings:e=>n(t=>({notifications:{...t.notifications,...e,email:{...t.notifications.email,...e.email}}})),updateVerificationCosts:e=>n({verificationCosts:e}),updateSiteManagementSettings:e=>n(t=>({siteManagement:{...t.siteManagement,...e}})),addHoliday:async(e,t)=>{const r=await pe.addHoliday({...t,type:e});n(s=>{const a=e==="office"?"officeHolidays":"fieldHolidays",o=[...s[a],r].sort((l,c)=>new Date(l.date).getTime()-new Date(c.date).getTime());return{[a]:o}})},removeHoliday:async(e,t)=>{await pe.removeHoliday(t),n(r=>{const s=e==="office"?"officeHolidays":"fieldHolidays";return{[s]:r[s].filter(a=>a.id!==t)}})},addRecurringHoliday:async e=>{const t=await pe.addRecurringHoliday(e);n(r=>({recurringHolidays:[...r.recurringHolidays,t]}))},removeRecurringHoliday:async e=>{await pe.deleteRecurringHoliday(e),n(t=>({recurringHolidays:t.recurringHolidays.filter(r=>r.id!==e)}))}}),{name:"paradigm_app_settings",storage:pu(()=>localStorage)})),Jt=n=>{const[e,t]=E.useState(window.matchMedia(n).matches);return E.useEffect(()=>{const r=window.matchMedia(n),s=()=>t(r.matches);try{r.addEventListener("change",s)}catch{r.addListener(s)}return()=>{try{r.removeEventListener("change",s)}catch{r.removeListener(s)}}},[n]),e},jk=()=>({id:`draft_${Date.now()}`,status:"draft",enrollmentDate:new Date().toISOString().split("T")[0],personal:{employeeId:`PARA-${Math.floor(1e3+Math.random()*9e3)}`,firstName:"",lastName:"",dob:"",gender:"",maritalStatus:"",bloodGroup:"",mobile:"",alternateMobile:"",email:"",emergencyContactName:"",emergencyContactNumber:"",relationship:"",salary:null,verifiedStatus:{}},address:{present:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},permanent:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},sameAsPresent:!0},family:[],education:[],bank:{accountHolderName:"",accountNumber:"",confirmAccountNumber:"",ifscCode:"",bankName:"",branchName:"",verifiedStatus:{}},uan:{hasPreviousPf:!1,verifiedStatus:{},salarySlip:null},esi:{hasEsi:!1,verifiedStatus:{}},gmc:{isOptedIn:null,policyAmount:"",nomineeName:"",nomineeRelation:"",selectedSpouseId:"",selectedChildIds:[],gmcPolicyCopy:null,declarationAccepted:!1},organization:{designation:"",department:"",reportingManager:"",organizationId:"",organizationName:"",joiningDate:Ue(new Date,"yyyy-MM-dd"),workType:"Full-time",defaultSalary:null},uniforms:[],biometrics:{signatureImage:null,fingerprints:{leftThumb:null,leftIndex:null,leftMiddle:null,leftRing:null,leftLittle:null,rightThumb:null,rightIndex:null,rightMiddle:null,rightRing:null,rightLittle:null}},salaryChangeRequest:null,requiresManualVerification:!1,formsGenerated:!1,verificationUsage:[]}),Wn=Ma(n=>({data:jk(),setData:e=>n({data:e}),updatePersonal:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,...e}}})),setPersonalVerifiedStatus:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,verifiedStatus:{...t.data.personal.verifiedStatus,...e}}}})),updateAddress:e=>n(t=>({data:{...t.data,address:{...t.data.address,...e}}})),setAddressVerifiedStatus:(e,t)=>n(r=>({data:{...r.data,address:{...r.data.address,[e]:{...r.data.address[e],verifiedStatus:{...r.data.address[e].verifiedStatus,...t}}}}})),updateFamily:e=>n(t=>({data:{...t.data,family:e}})),updateEducation:e=>n(t=>({data:{...t.data,education:e}})),updateBank:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,...e}}})),setBankVerifiedStatus:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,verifiedStatus:{...t.data.bank.verifiedStatus,...e}}}})),updateUan:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,...e}}})),setUanVerifiedStatus:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,verifiedStatus:{...t.data.uan.verifiedStatus,...e}}}})),updateEsi:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,...e}}})),setEsiVerifiedStatus:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,verifiedStatus:{...t.data.esi.verifiedStatus,...e}}}})),updateGmc:e=>n(t=>({data:{...t.data,gmc:{...t.data.gmc,...e}}})),updateOrganization:e=>n(t=>({data:{...t.data,organization:{...t.data.organization,...e}}})),updateUniforms:e=>n(t=>({data:{...t.data,uniforms:e}})),updateBiometrics:e=>n(t=>({data:{...t.data,biometrics:{...t.data.biometrics,...e}}})),setSalaryChangeRequest:e=>n(t=>({data:{...t.data,salaryChangeRequest:e}})),setRequiresManualVerification:e=>n(t=>({data:{...t.data,requiresManualVerification:e}})),setFormsGenerated:e=>n(t=>({data:{...t.data,formsGenerated:e}})),logVerificationUsage:e=>n(t=>{const r=JSON.parse(JSON.stringify(t.data.verificationUsage||[])),s=r.find(a=>a.name===e);return s?s.count+=1:r.push({name:e,count:1}),{data:{...t.data,verificationUsage:r}}}),reset:()=>n({data:jk()}),addFamilyMember:()=>n(e=>({data:{...e.data,family:[...e.data.family,{id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""}]}})),updateFamilyMember:(e,t)=>n(r=>({data:{...r.data,family:r.data.family.map(s=>s.id===e?{...s,...t}:s)}})),removeFamilyMember:e=>n(t=>({data:{...t.data,family:t.data.family.filter(r=>r.id!==e)}})),addEducationRecord:()=>n(e=>({data:{...e.data,education:[...e.data.education,{id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""}]}})),updateEducationRecord:(e,t)=>n(r=>({data:{...r.data,education:r.data.education.map(s=>s.id===e?{...s,...t}:s)}})),removeEducationRecord:e=>n(t=>({data:{...t.data,education:t.data.education.filter(r=>r.id!==e)}})),addOrUpdateEmergencyContactAsFamilyMember:()=>n(e=>{const{personal:t,family:r}=e.data,{emergencyContactName:s,emergencyContactNumber:a,relationship:o}=t;if(s&&["Spouse","Child","Father","Mother"].includes(o)){const c=r.find(d=>d.name.toLowerCase()===s.toLowerCase()&&d.relation===o);if(c){if(c.phone!==a){const d=r.map(m=>m.id===c.id?{...m,phone:a}:m);return{data:{...e.data,family:d}}}}else{const d={id:`fam_emergency_${Date.now()}`,name:s,relation:o,phone:a,dob:"",gender:"",dependent:!1,idProof:null,occupation:""};return{data:{...e.data,family:[...r,d]}}}}return e})}));const bK=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),NF=(...n)=>n.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");var _K={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const wK=E.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:a,iconNode:o,...l},c)=>E.createElement("svg",{ref:c,..._K,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:NF("lucide",s),...l},[...o.map(([d,m])=>E.createElement(d,m)),...Array.isArray(a)?a:[a]]));const Re=(n,e)=>{const t=E.forwardRef(({className:r,...s},a)=>E.createElement(wK,{ref:a,iconNode:e,className:NF(`lucide-${bK(n)}`,r),...s}));return t.displayName=`${n}`,t};const Rh=Re("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const SK=Re("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);const Hi=Re("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const jK=Re("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const NK=Re("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const CK=Re("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);const TK=Re("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const PK=Re("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);const Cf=Re("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);const MK=Re("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);const kK=Re("BriefcaseBusiness",[["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2",key:"1ksdt3"}],["path",{d:"M22 13a18.15 18.15 0 0 1-20 0",key:"12hx5q"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const CF=Re("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const Uc=Re("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const EK=Re("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);const DK=Re("CalendarCheck2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]]);const OK=Re("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);const IK=Re("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);const AK=Re("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);const Sa=Re("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const uC=Re("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);const RK=Re("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);const xl=Re("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const xu=Re("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const Wx=Re("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Tf=Re("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const LK=Re("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const FK=Re("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);const qK=Re("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);const TF=Re("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const Bi=Re("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const Nk=Re("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const Ck=Re("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const zK=Re("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const am=Re("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const PF=Re("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);const MF=Re("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);const Vc=Re("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const UK=Re("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);const kF=Re("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);const VK=Re("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);const mN=Re("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);const hi=Re("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);const BK=Re("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);const bl=Re("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const WK=Re("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);const $K=Re("FileDigit",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["rect",{width:"4",height:"6",x:"2",y:"12",rx:"2",key:"jm304g"}],["path",{d:"M10 12h2v6",key:"12zw74"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);const EF=Re("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);const pN=Re("FilePenLine",[["path",{d:"m18 5-3-3H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"h0fsxq"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.4 9.6a2 2 0 1 1 3 3L17 17l-4 1 1-4Z",key:"dyo8mm"}]]);const Vs=Re("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const HK=Re("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);const YK=Re("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);const GK=Re("Files",[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]]);const DF=Re("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);const ZK=Re("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);const KK=Re("GitPullRequest",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]]);const OF=Re("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const JK=Re("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6h0",key:"1uc279"}],["path",{d:"M14 6h0a6 6 0 0 1 6 6v3",key:"1j9mnm"}]]);const fC=Re("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);const hC=Re("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);const QK=Re("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);const IF=Re("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const _l=Re("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);const $h=Re("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const XK=Re("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);const AF=Re("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);const gx=Re("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);const mC=Re("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);const eJ=Re("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);const Tt=Re("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const gN=Re("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const xN=Re("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);const kc=Re("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const RF=Re("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);const yu=Re("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const wl=Re("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const LF=Re("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);const FF=Re("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const om=Re("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);const tJ=Re("MousePointerClick",[["path",{d:"m9 9 5 12 1.8-5.2L21 14Z",key:"1b76lo"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}]]);const nJ=Re("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);const rJ=Re("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);const sJ=Re("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);const pC=Re("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);const iJ=Re("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);const cu=Re("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const qF=Re("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);const aJ=Re("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);const qt=Re("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const yN=Re("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const oJ=Re("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);const is=Re("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const Na=Re("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const gC=Re("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);const vm=Re("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const zF=Re("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);const $x=Re("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const UF=Re("ShieldHalf",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 22V2",key:"zs6s6o"}]]);const lJ=Re("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);const vN=Re("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const Hx=Re("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);const cJ=Re("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);const xC=Re("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);const xr=Re("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);const VF=Re("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const BF=Re("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);const WF=Re("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);const $F=Re("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const dJ=Re("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);const uJ=Re("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);const Xt=Re("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const Tk=Re("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const Ca=Re("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const Bc=Re("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const du=Re("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);const Pf=Re("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const xx=Re("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);const Sl=Re("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const mi=Re("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const HF=Re("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);const YF=Re("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);const Ui=Re("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const fJ=Re("ZapOff",[["path",{d:"M10.513 4.856 13.12 2.17a.5.5 0 0 1 .86.46l-1.377 4.317",key:"193nxd"}],["path",{d:"M15.656 10H20a1 1 0 0 1 .78 1.63l-1.72 1.773",key:"27a7lr"}],["path",{d:"M16.273 16.273 10.88 21.83a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4a1 1 0 0 1-.78-1.63l4.507-4.643",key:"1e0qe9"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const hJ=Re("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);const yC=Re("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);const vC=Re("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Ep="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",bC="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",_C=Ma(Rf(n=>({currentLogo:Ep,defaultLogo:Ep,setCurrentLogo:e=>n({currentLogo:e}),setDefaultLogo:()=>n(e=>({defaultLogo:e.currentLogo})),resetToDefault:()=>n(e=>({currentLogo:e.defaultLogo})),resetToOriginal:()=>n({currentLogo:Ep,defaultLogo:Ep})}),{name:"paradigm-app-logo",storage:pu(()=>localStorage)})),Wi=({className:n="",localPath:e})=>{const t=_C(s=>s.currentLogo),r=e||t;return i.jsx("img",{src:r,alt:"Paradigm Logo",className:`w-auto object-contain ${!n.includes("h-")&&"h-10"} ${n}`})},ae=({children:n,className:e="",variant:t="primary",size:r="md",isLoading:s=!1,...a})=>{const l=`btn-${t}`,c=`btn-${r}`;return i.jsx("button",{className:`btn ${l} ${c} ${e}`,disabled:s||a.disabled,...a,children:s?i.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):n})},GF=Ma(Rf(n=>({autoClickOnHover:!0,autoScrollOnHover:!0,setAutoClickOnHover:e=>n({autoClickOnHover:e}),setAutoScrollOnHover:e=>n({autoScrollOnHover:e})}),{name:"paradigm-ui-settings",storage:pu(()=>localStorage)})),Yx=Ma((n,e)=>({notifications:[],unreadCount:0,isLoading:!1,error:null,fetchNotifications:async()=>{const t=St.getState().user;if(t){n({isLoading:!0,error:null});try{const r=await pe.getNotifications(t.id),s=r.filter(a=>!a.isRead).length;n({notifications:r,unreadCount:s,isLoading:!1})}catch{n({error:"Failed to fetch notifications.",isLoading:!1})}}},markAsRead:async t=>{const r=e().notifications.find(s=>s.id===t);if(!(r&&r.isRead))try{await pe.markNotificationAsRead(t),n(s=>({notifications:s.notifications.map(a=>a.id===t?{...a,isRead:!0}:a),unreadCount:Math.max(0,s.unreadCount-1)}))}catch(s){console.error("Failed to mark notification as read",s)}},markAllAsRead:async()=>{const t=St.getState().user;if(t&&e().unreadCount!==0)try{await pe.markAllNotificationsAsRead(t.id),n(r=>({notifications:r.notifications.map(s=>({...s,isRead:!0})),unreadCount:0}))}catch(r){console.error("Failed to mark all notifications as read",r)}}})),mJ=({type:n})=>{const e={task_assigned:Pf,task_escalated:Ca,provisional_site_reminder:PF,security:vN,info:$h,greeting:$F},t={task_assigned:"text-blue-500 dark:text-blue-400",task_escalated:"text-orange-500 dark:text-orange-400",provisional_site_reminder:"text-purple-500 dark:text-purple-400",security:"text-red-500 dark:text-red-400",info:"text-blue-400 dark:text-blue-300",greeting:"text-yellow-500 dark:text-yellow-400"},r=e[n]||Cf;return i.jsx(r,{className:`h-5 w-5 ${t[n]}`})},pJ=({className:n=""})=>{const{notifications:e,unreadCount:t,markAsRead:r,markAllAsRead:s}=Yx(),[a,o]=E.useState(!1),l=E.useRef(null),c=E.useRef(null),d=yn();E.useEffect(()=>{const x=v=>{l.current&&!l.current.contains(v.target)&&c.current&&!c.current.contains(v.target)&&o(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const m=x=>{r(x.id),x.linkTo&&d(x.linkTo),o(!1)},p=()=>{s()};return i.jsxs("div",{className:`relative notification-bell ${n}`,children:[i.jsxs("button",{ref:c,onClick:()=>o(!a),className:"btn-icon relative p-2 rounded-full hover:bg-page text-muted","aria-label":`Notifications (${t} unread)`,children:[i.jsx(Cf,{className:"h-5 w-5"}),t>0&&i.jsx("span",{className:"notification-dot absolute top-0 right-0 block h-2.5 w-2.5 rounded-full bg-red-500"})]}),a&&EL.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[90] md:hidden",onClick:()=>o(!1)}),i.jsxs("div",{ref:l,className:"fixed inset-x-4 top-20 bottom-20 z-[100] flex flex-col bg-white dark:!bg-[#0d1f12] rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-800 md:absolute md:inset-auto md:top-16 md:right-4 md:mt-2 md:w-[400px] md:h-auto md:max-h-[600px] md:bottom-auto animate-in fade-in zoom-in-95 duration-200 overflow-hidden",style:{position:window.innerWidth>=768?"absolute":"fixed"},children:[i.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 dark:border-white/10 bg-gray-50 dark:!bg-[#0d1f12]",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-lg text-gray-900 dark:text-white",children:"Notifications"}),i.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:["You have ",t," unread messages"]})]}),i.jsx("div",{className:"flex items-center gap-2",children:t>0&&i.jsx("span",{onClick:p,className:"relative isolate overflow-hidden before:!content-none after:!content-none text-xs h-8 px-4 flex items-center justify-center rounded-3xl !bg-[#32CD32] hover:!bg-[#28a428] !text-[#0D1A0D] !font-bold cursor-pointer transition-colors",style:{backgroundImage:"none"},children:i.jsx("span",{className:"relative z-10",children:"Mark all read"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-white dark:!bg-[#0d1f12] dark:[color-scheme:dark]",children:e.slice(0,10).length>0?i.jsx("div",{className:"divide-y divide-gray-100 dark:divide-white/20",children:e.slice(0,10).map(x=>i.jsxs("div",{onClick:()=>m(x),className:`group flex items-start gap-4 p-5 cursor-pointer transition-all duration-200 ${x.isRead?"bg-white dark:!bg-[#0d1f12] hover:bg-gray-50 dark:hover:!bg-[#152b1b]":"bg-emerald-50 dark:!bg-[#0d1f12] hover:bg-emerald-100 dark:hover:!bg-[#152b1b]"}`,children:[i.jsx("div",{className:`flex-shrink-0 p-2.5 rounded-full ${x.isRead?"bg-gray-100 dark:bg-[#1a2e1a]":"bg-white dark:bg-[#1a2e1a] shadow-sm"}`,children:i.jsx(mJ,{type:x.type})}),i.jsxs("div",{className:"flex-1 min-w-0 pt-1",children:[i.jsx("p",{className:`text-sm font-medium leading-snug mb-1.5 ${x.isRead?"text-gray-600 dark:text-gray-300":"text-gray-900 dark:text-white"}`,children:x.message}),i.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 flex items-center gap-1",children:iu(new Date(x.createdAt),{addSuffix:!0})})]}),!x.isRead&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 mt-2.5 flex-shrink-0 shadow-[0_0_8px_rgba(16,185,129,0.5)]"})]},x.id))}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center p-8",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-[#1a2e1a] rounded-full flex items-center justify-center mb-4",children:i.jsx(Cf,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),i.jsx("h5",{className:"text-gray-900 dark:text-white font-medium mb-1",children:"No notifications"}),i.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"You're all caught up! Check back later."})]})})]})]}),document.body)]})},tr=({isOpen:n,onClose:e,onConfirm:t,title:r,children:s,confirmButtonVariant:a="danger",confirmButtonText:o="Confirm",isConfirming:l=!1,isLoading:c})=>{if(!n)return null;const d=c!==void 0?c:l;return i.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black bg-opacity-50","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card shadow-card flex flex-col animate-fade-in-scale overflow-hidden w-full h-full sm:w-full sm:h-full sm:max-w-full sm:rounded-none md:w-auto md:h-auto md:max-w-md md:max-h-[90vh] md:rounded-xl",children:[i.jsx("div",{className:"flex-shrink-0 p-6 border-b border-border",children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:r})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsx("div",{className:"text-sm text-muted",children:s})}),i.jsx("div",{className:"flex-shrink-0 p-6 border-t border-border bg-card",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx(ae,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),i.jsx(ae,{onClick:t,variant:a,isLoading:d,children:o})]})})]})})},gJ=({className:n})=>i.jsxs("svg",{viewBox:"0 0 144 144",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:n,children:[i.jsx("circle",{cx:"72",cy:"72",r:"72",fill:"#F0EBE3"}),i.jsx("path",{d:"M109.5 144H34.5C34.5 119.464 51.18 99 72 99C92.82 99 109.5 119.464 109.5 144Z",fill:"white"}),i.jsx("path",{d:"M84 99C84 105.627 78.6274 111 72 111C65.3726 111 60 105.627 60 99H84Z",fill:"#E1C699"}),i.jsx("path",{d:"M96 87C96 70.4315 85.3726 57 72 57C58.6274 57 48 70.4315 48 87H96Z",fill:"#4A4A4A"}),i.jsx("rect",{x:"62",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"}),i.jsx("rect",{x:"77",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"})]}),Xv=[gJ],Vi=({className:n,photoUrl:e,seed:t})=>{const{user:r}=St();if(e)return i.jsx("img",{src:e,alt:"Profile",className:`object-cover ${n||""}`});const s=t||r?.id;if(!s){const l=Xv[0];return i.jsx(l,{className:`text-muted/60 ${n||""}`})}const a=s.charCodeAt(s.length-1)%Xv.length,o=Xv[a];return i.jsx(o,{className:n||""})},ZF=({setIsMobileMenuOpen:n})=>{const{user:e,logout:t}=St(),{permissions:r}=ka(),s=yn(),[a,o]=E.useState(!1),[l,c]=E.useState(!1),d=E.useRef(null),m=Jt("(max-width: 767px)");bs(),E.useEffect(()=>{const _=w=>{d.current&&!d.current.contains(w.target)&&o(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]);const p=_=>_.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase()),x=()=>{n?.(!1),o(!1),c(!0)},v=async()=>{c(!1),await t(),s("/auth/login",{replace:!0})};return i.jsxs(i.Fragment,{children:[i.jsx(tr,{isOpen:l,onClose:()=>c(!1),onConfirm:v,title:"Confirm Log Out",children:"Are you sure you want to log out?"}),i.jsx("header",{className:"sticky top-0 z-40 bg-[#0d2818] md:bg-gray-50/50 backdrop-blur-md border-b border-[#1f3d2b] md:border-gray-200/50 transition-all duration-200",style:{paddingTop:"env(safe-area-inset-top)"},children:i.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center h-16",children:[i.jsx("div",{className:"flex-1 flex justify-center md:justify-start min-w-0 px-2",children:m&&i.jsx("div",{className:"flex items-center justify-center bg-transparent p-2 border-0",children:i.jsx(Wi,{className:"border-0 h-[52px]"})})}),i.jsx("div",{className:"flex-none flex justify-end w-auto min-w-10",children:i.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[i.jsx(pJ,{}),!m&&e&&i.jsxs("div",{className:"relative",ref:d,children:[i.jsxs("button",{onClick:()=>o(!a),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-page transition-colors","aria-expanded":a,"aria-haspopup":"true",children:[i.jsx(Vi,{photoUrl:e.photoUrl,seed:e.id,className:"h-8 w-8 rounded-lg"}),i.jsxs("div",{className:"text-left hidden sm:block",children:[i.jsx("span",{className:"text-sm font-semibold",children:e.name}),i.jsx("span",{className:"text-xs text-muted block",children:p(e.role)})]}),i.jsx(xu,{className:"h-4 w-4 text-muted"})]}),a&&i.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-card rounded-xl shadow-card border border-border py-1 z-40 animate-fade-in-down",role:"menu",children:[i.jsxs(ja,{to:"/profile",onClick:()=>o(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(Sl,{className:"mr-2 h-4 w-4"}),"Profile"]}),e&&r[e.role]?.includes("apply_for_leave")&&i.jsxs(ja,{to:"/leaves/dashboard",onClick:()=>o(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(mN,{className:"mr-2 h-4 w-4"}),"Tracker"]}),i.jsxs("button",{onClick:x,className:"flex items-center w-full text-left px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(kc,{className:"mr-2 h-4 w-4"}),"Log Out"]})]})]})]})})]})})})]})},KF=[{to:"/verification/dashboard",label:"All Submissions",icon:AF,permission:"view_all_submissions"},{to:"/developer/api",label:"API Settings",icon:vm,permission:"view_developer_settings"},{to:"/attendance/dashboard",label:"Attendance",icon:Sa,permission:"view_own_attendance"},{to:"/hr/attendance-settings",label:"Attendance Rules",icon:DK,permission:"manage_attendance_rules"},{to:"/support",label:"Backend Support",icon:gx,permission:"access_support_desk"},{to:"/hr/entities",label:"Client Management",icon:CF,permission:"view_entity_management"},{to:"/hr/enrollment-rules",label:"Enrollment Rules",icon:PF,permission:"manage_enrollment_rules"},{to:"/hr/policies-and-insurance",label:"Insurance Management",icon:UF,permission:"manage_insurance"},{to:"/billing/summary",label:"Invoice Summary",icon:$K,permission:"view_invoice_summary"},{to:"/billing/cost-analysis",label:"Verification Costing",icon:_l,permission:"view_verification_costing"},{to:"/admin/approval-workflow",label:"Leave Approval Settings",icon:ZK,permission:"manage_approval_workflow"},{to:"/hr/leave-management",label:"Leave Management",icon:KK,permission:"manage_leave_requests"},{to:"/admin/modules",label:"Module Management",icon:sJ,permission:"manage_modules"},{to:"/onboarding",label:"New Enrollment",icon:Pf,permission:"create_enrollment"},{to:"/operations/dashboard",label:"Operations",icon:kK,permission:"view_operations_dashboard"},{to:"/profile",label:"Profile",icon:Sl,permission:"view_own_attendance"},{to:"/admin/roles",label:"Role Management",icon:$x,permission:"manage_roles_and_permissions"},{to:"/site/dashboard",label:"Site Dashboard",icon:hC,permission:"view_site_dashboard"},{to:"/admin/sites",label:"Site Management",icon:Uc,permission:"manage_sites"},{to:"/tasks",label:"Task Management",icon:mC,permission:"manage_tasks"},{to:"/uniforms",label:"Uniform Management",icon:Hx,permission:"manage_uniforms"},{to:"/admin/users",label:"User Management",icon:mi,permission:"manage_users"},{to:"/hr/field-officer-tracking",label:"User Activity Tracking",icon:LF,permission:"view_field_officer_tracking"},{to:"/hr/locations",label:"Geo Locations",icon:wl,permission:"manage_attendance_rules"},{to:"/attendance/locations",label:"My Locations",icon:nJ,permission:"view_own_attendance"}],xJ=({isCollapsed:n,onLinkClick:e,onExpand:t,hideHeader:r=!1,mode:s="light",isMobile:a=!1})=>{const{user:o}=St(),{permissions:l}=ka(),c=o?KF.filter(m=>l[o.role]?.includes(m.permission)).sort((m,p)=>m.label.localeCompare(p.label)):[],d=m=>{if(a&&n&&t){m.preventDefault(),t();return}e&&e()};return i.jsxs("div",{className:"flex flex-col",children:[r&&n&&i.jsx("div",{className:"p-4 border-b border-[#1f3d2b] bg-[#041b0f] flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",children:i.jsxs("button",{onClick:()=>window.location.href="/#/profile",className:"btn-icon inline-flex items-center justify-center p-2 rounded-md text-white hover:bg-white/10 focus:outline-none","aria-label":"Go to profile page",children:[i.jsx("span",{className:"sr-only",children:"Go to profile"}),i.jsx(Hi,{className:"block h-6 w-6"})]})}),r&&!n&&i.jsx("div",{className:"p-4 border-b border-[#1f3d2b] bg-[#041b0f] flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0"}),!r&&i.jsx("div",{className:"p-4 border-b border-gray-200 bg-white flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",children:n?i.jsx("div",{className:"h-8 w-8 overflow-hidden",children:i.jsx(Wi,{className:"h-8 max-w-none object-left object-cover"})}):i.jsx(Wi,{})}),i.jsx("nav",{className:"px-3 py-4 space-y-1.5",children:c.map(m=>i.jsx(WL,{to:m.to,onClick:d,className:({isActive:p})=>`group flex items-center px-3 py-3 rounded-xl text-sm font-medium transition-all duration-200 ease-in-out ${n?"justify-center":""} ${s==="light"?p?"text-white shadow-sm border":"text-gray-500 hover:bg-gray-50 hover:text-gray-900":p?"bg-[#1c3a23] text-white shadow-sm border border-white/5":"text-white hover:bg-white/5 hover:text-white/90"}`,style:({isActive:p})=>p?s==="light"?{backgroundColor:"#006B3F",borderColor:"#005632"}:{}:{},title:m.label,children:({isActive:p})=>i.jsxs(i.Fragment,{children:[i.jsx(m.icon,{className:`h-5 w-5 flex-shrink-0 transition-colors duration-200 ${s==="light"?p?"text-white":"text-gray-400 group-hover:text-gray-600":p?"text-white":"text-white group-hover:text-white"} ${n?"":"mr-3"}`}),!n&&i.jsx("span",{children:m.label})]})},m.to))})]})},yJ=()=>{const{user:n}=St(),{fetchNotifications:e}=Yx(),{permissions:t}=ka(),{autoScrollOnHover:r}=GF();bs();const s=Jt("(max-width: 767px)"),a=E.useRef(null),o=E.useRef(null),[l,c]=E.useState(!0),[d,m]=E.useState(0),[p,x]=E.useState(!1);E.useEffect(()=>{c(s)},[s]);const v=E.useCallback(()=>{o.current!==null&&(clearInterval(o.current),o.current=null)},[]),_=E.useCallback(w=>{v();const j=a.current;if(!j)return;const P=()=>{j.scrollBy({top:w==="up"?-window.innerHeight*.8:window.innerHeight*.8,behavior:"smooth"})};P(),o.current=window.setInterval(P,300)},[v]);return E.useEffect(()=>{const w=()=>{const P=a.current;P&&(x(P.scrollHeight>P.clientHeight),m(P.scrollTop))},j=a.current;return j?.addEventListener("scroll",w,{passive:!0}),window.addEventListener("resize",w),w(),()=>{j?.removeEventListener("scroll",w),window.removeEventListener("resize",w),v()}},[v]),E.useEffect(()=>{n&&e()},[n,e]),n?i.jsxs("div",{className:`flex min-h-screen bg-page ${s?"":"p-4 md:p-6 lg:p-8 gap-4 md:gap-6 lg:gap-8"}`,children:[s&&!l&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 transition-opacity duration-300",onClick:()=>c(!0)}),i.jsxs("aside",{className:`flex flex-col flex-shrink-0 transition-all duration-300 ease-in-out ${s?l?"w-16":"w-64":l?"w-20":"w-72"} ${s?"bg-[#041b0f] border-r border-[#1f3d2b]":"bg-white border-r border-gray-200/60"} ${s?"fixed left-0 top-0 bottom-0 z-50":""}`,children:[i.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:i.jsx(xJ,{isCollapsed:l,mode:s?"dark":"light",onLinkClick:s?()=>c(!0):void 0,onExpand:()=>c(!1),hideHeader:s,isMobile:s})}),i.jsx("div",{className:`flex-shrink-0 px-2 pt-2 mt-auto flex items-center ${s?"border-t border-[#1f3d2b]":"border-t border-border"}`,children:i.jsx("button",{onClick:()=>c(!l),className:`flex-1 flex items-center justify-center p-2 rounded-lg transition-colors ${s?"text-white/70 hover:bg-white/10":"text-muted hover:bg-page"}`,title:l?"Expand sidebar":"Collapse sidebar",children:l?i.jsx(qK,{className:"h-5 w-5"}):i.jsx(FK,{className:"h-5 w-5"})})})]}),i.jsxs("div",{className:`flex-1 flex flex-col ${s?"bg-[#041b0f]":"bg-gray-50/50"} ${s&&l?"ml-16":""}`,children:[i.jsx(ZF,{}),i.jsx("main",{ref:a,className:`flex-1 overflow-y-auto ${s?"bg-[#041b0f]":"bg-page"}`,children:i.jsx("div",{className:"p-4",children:i.jsx(gf,{})})})]}),p&&!s&&i.jsxs("div",{className:"fixed bottom-8 right-8 z-50 flex flex-col gap-2 no-print",children:[i.jsx(ae,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:r?()=>_("up"):void 0,onMouseLeave:v,onMouseDown:()=>_("up"),onMouseUp:v,onTouchStart:()=>_("up"),onTouchEnd:v,disabled:d<=0,"aria-label":"Scroll Up",children:i.jsx(LK,{className:"h-5 w-5"})}),i.jsx(ae,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:r?()=>_("down"):void 0,onMouseLeave:v,onMouseDown:()=>_("down"),onMouseUp:v,onTouchStart:()=>_("down"),onTouchEnd:v,disabled:a.current?Math.ceil(a.current.clientHeight+d)>=a.current.scrollHeight:!1,"aria-label":"Scroll Down",children:i.jsx(xu,{className:"h-5 w-5"})})]})]}):i.jsx(ml,{to:"/auth/login",replace:!0})},vJ=()=>{const{user:n}=St(),{permissions:e}=ka();if(!n)return null;const t=e[n.role]||[],r=[{to:"/mobile-home",label:"Home",icon:hC,show:!0},{to:"/attendance/dashboard",label:"Attendance",icon:OK,show:t.includes("view_own_attendance")},{to:"/tasks",label:"Tasks",icon:mC,show:t.includes("manage_tasks")},{to:"/profile",label:"Profile",icon:Sl,show:!0}];return i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-[#0d2818] border-t border-[#1f3d2b] z-40",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:i.jsx("div",{className:"flex justify-around items-center h-16",children:r.filter(s=>s.show).map(s=>i.jsxs(WL,{to:s.to,className:({isActive:a})=>`flex flex-col items-center justify-center flex-1 h-full transition-colors ${a?"text-[#22c55e]":"text-gray-400"}`,children:[i.jsx(s.icon,{className:"w-6 h-6"}),i.jsx("span",{className:"text-xs mt-1",children:s.label})]},s.to))})})},bJ=()=>{const[n,e]=E.useState(!0),t=E.useRef(0),r=E.useRef(!1);return E.useEffect(()=>{const s=()=>{r.current||(window.requestAnimationFrame(()=>{const a=window.scrollY;a<t.current||a<10?e(!0):a>t.current&&a>10&&e(!1),t.current=a,r.current=!1}),r.current=!0)};return window.addEventListener("scroll",s,{passive:!0}),()=>window.removeEventListener("scroll",s)},[]),i.jsxs("div",{className:"flex flex-col min-h-screen bg-[#0f1f0f]",children:[i.jsx("div",{className:`sticky top-0 z-50 transition-transform duration-200 ${n?"translate-y-0":"-translate-y-full"}`,children:i.jsx(ZF,{})}),i.jsx("main",{className:"flex-1 overflow-y-auto px-4 pt-2",style:{paddingBottom:"calc(9.1rem + env(safe-area-inset-bottom))"},children:i.jsx(gf,{})}),i.jsx(vJ,{})]})},_J=["https://picsum.photos/seed/corporate_campus/1200/900","https://picsum.photos/seed/luxury_complex/1200/900","https://picsum.photos/seed/office_interior/1200/900","https://picsum.photos/seed/landscaping/1200/900","https://picsum.photos/seed/lobby_design/1200/900"],JF=Ma(Rf((n,e)=>({backgroundImages:_J,addBackgroundImage:t=>{const r=e();return r.backgroundImages.includes(t)?!1:(n({backgroundImages:[...r.backgroundImages,t]}),!0)},removeBackgroundImage:t=>n(r=>({backgroundImages:r.backgroundImages.filter((s,a)=>a!==t)}))}),{name:"paradigm-auth-layout-settings",storage:pu(()=>localStorage)})),wJ=()=>{const{backgroundImages:n}=JF(),[e,t]=E.useState(0),r=bs();E.useEffect(()=>{if(n.length>1){const o=setInterval(()=>{t(l=>(l+1)%n.length)},5e3);return()=>clearInterval(o)}},[n.length]);const s=E.useMemo(()=>n&&n.length>0?n:["https://picsum.photos/seed/default_fallback_1/1200/900"],[n]),a=E.useMemo(()=>r.pathname.includes("signup")?{title:"Create an Account",subtitle:"Join our platform to get started."}:r.pathname.includes("forgot-password")?{title:"Forgot Password?",subtitle:"No worries, we'll send you reset instructions."}:r.pathname.includes("update-password")?{title:"Set a New Password",subtitle:"Please enter your new password."}:{title:"Sign In",subtitle:"Enter your credentials to access your account."},[r.pathname]);return i.jsxs("div",{className:"min-h-screen font-sans flex items-center justify-center bg-page relative overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[s.map((o,l)=>i.jsx("div",{className:`absolute inset-0 w-full h-full bg-cover bg-center transition-opacity duration-1000 ease-in-out ${l===e?"opacity-100":"opacity-0"}`,style:{backgroundImage:`url(${o})`}},l)),i.jsx("div",{className:"absolute inset-0 bg-black/30"})," "]}),i.jsx("div",{className:"relative w-full max-w-3xl lg:max-w-4xl xl:max-w-5xl p-4",children:i.jsxs("div",{className:"auth-card-container w-full grid md:grid-cols-2 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-md bg-black/40 border border-[#041b0f] md:border-white/10",children:[i.jsxs("div",{className:"hidden md:flex flex-col justify-between p-6 lg:p-10 xl:p-16 bg-gradient-to-br from-black/40 to-black/70",children:[i.jsxs("div",{children:[i.jsx(Wi,{className:"h-8 lg:h-12 xl:h-14"}),i.jsx("h1",{className:"text-xl lg:text-2xl xl:text-4xl font-bold text-white mt-6 lg:mt-8 leading-tight drop-shadow-lg",children:"Welcome to the Future of Onboarding."}),i.jsx("p",{className:"text-white/80 mt-4 max-w-md drop-shadow-lg text-xs lg:text-sm xl:text-base",children:"Streamlining the journey for every new member of the Paradigm family."})]}),i.jsx("div",{children:i.jsxs("p",{className:"text-white/50 text-[10px] lg:text-xs mt-4",children:[" ",new Date().getFullYear()," Paradigm Services. All rights reserved."]})})]}),i.jsx("div",{className:"p-6 lg:p-10 xl:p-16 flex flex-col justify-center bg-[#050505]/85 backdrop-blur-xl border-l border-white/10",children:i.jsxs("div",{className:"w-full max-w-md mx-auto",children:[i.jsx("div",{className:"md:hidden flex justify-center mb-8",children:i.jsx(Wi,{className:"h-12"})}),i.jsx("h2",{className:"text-xl lg:text-2xl xl:text-3xl font-bold text-white mb-2",children:a.title}),i.jsx("p",{className:"text-gray-300 mb-4 lg:mb-6 xl:mb-8 text-xs lg:text-sm xl:text-base",children:a.subtitle}),i.jsx(gf,{})]})})]})})]})};function SJ(){const[n,e]=E.useState({isSecure:!0,issues:[],developerModeEnabled:!1,locationSpoofingDetected:!1});return E.useEffect(()=>{const t=()=>{const s=[];let a=!1,o=!1;("geolocation"in navigator,!1)&&(o=!0,s.push("Location spoofing detected. Please disable location mocking apps to continue."));const c=s.length===0;e({isSecure:c,issues:s,developerModeEnabled:a,locationSpoofingDetected:o})};t();const r=setInterval(t,2e3);return window.addEventListener("resize",t),()=>{clearInterval(r),window.removeEventListener("resize",t)}},[]),n}const jJ=({issues:n,onDismiss:e})=>{const[t,r]=E.useState(!1);return E.useEffect(()=>{const s=()=>{r(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),t?i.jsx("div",{className:"fixed inset-0 z-50 bg-white overflow-y-auto",children:i.jsxs("div",{className:"min-h-screen p-4 flex flex-col",children:[i.jsx("div",{className:"flex justify-center mt-8 mb-6",children:i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(vN,{className:"w-8 h-8 text-red-600"})})}),i.jsx("h2",{className:"text-xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),i.jsxs("div",{className:"space-y-3 mb-4",children:[i.jsx("p",{className:"text-gray-700 text-center text-sm",children:"Access to this application has been temporarily blocked for security reasons:"}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:i.jsx("ul",{className:"space-y-2",children:n.map((s,a)=>i.jsxs("li",{className:"flex items-start gap-2 text-xs text-red-800",children:[i.jsx(Ca,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:s})]},a))})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2 text-sm",children:"To continue:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs text-blue-800",children:[i.jsx("li",{children:"Close browser developer tools (F12)"}),i.jsx("li",{children:"Disable any location spoofing apps or extensions"}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:i.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&i.jsx(ae,{onClick:e,variant:"outline",className:"w-full mt-auto",size:"sm",children:"I Understand"})]})}):i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 animate-in fade-in zoom-in duration-300",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(vN,{className:"w-10 h-10 text-red-600"})})}),i.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),i.jsxs("div",{className:"space-y-3 mb-6",children:[i.jsx("p",{className:"text-gray-700 text-center",children:"Access to this application has been temporarily blocked for security reasons:"}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsx("ul",{className:"space-y-2",children:n.map((s,a)=>i.jsxs("li",{className:"flex items-start gap-2 text-sm text-red-800",children:[i.jsx(Ca,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:s})]},a))})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"To continue:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[i.jsx("li",{children:"Close browser developer tools (F12)"}),i.jsx("li",{children:"Disable any location spoofing apps or extensions"}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6",children:i.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&i.jsx(ae,{onClick:e,variant:"outline",className:"w-full",children:"I Understand"})]})})},NJ=({children:n})=>{const{user:e}=St(),t=SJ(),[r,s]=E.useState(!1),a=e&&(e.role==="admin"||e.role==="developer");return E.useEffect(()=>{if(e&&!a&&!t.isSecure&&!r){const o=t.developerModeEnabled?"developer_mode":"location_spoofing";pe.sendSecurityAlert(e.id,e.name,o,void 0).catch(l=>console.error("Failed to send security alert:",l)),s(!0)}},[e,t,r,a]),e&&!a&&!t.isSecure?i.jsx(jJ,{issues:t.issues}):i.jsx(i.Fragment,{children:n})},CJ=({onComplete:n})=>{const e=Jt("(max-width: 767px)"),[t,r]=E.useState("prompt"),[s,a]=E.useState("prompt"),[o,l]=E.useState(!1),[c,d]=E.useState(null),m=t==="granted"&&s==="granted";E.useEffect(()=>{(!e||m)&&n()},[e,m,n]);const p=async()=>{l(!0),d(null);try{try{const x=await navigator.mediaDevices.getUserMedia({video:!0});a("granted"),x.getTracks().forEach(v=>v.stop())}catch{throw a("denied"),new Error("Camera permission was denied.")}try{await new Promise((x,v)=>{navigator.geolocation.getCurrentPosition(()=>{r("granted"),x(!0)},()=>{r("denied"),v(new Error("Location permission was denied."))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})}catch{throw new Error("Location permission was denied.")}n()}catch(x){d(x.message||"Permissions are required to use this app.")}finally{l(!1)}};return e?i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4 text-center",children:[i.jsx("div",{className:"splash-logo",children:i.jsx(Wi,{className:"h-16 mb-8"})}),i.jsxs("div",{className:"max-w-md",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Permissions Required"}),i.jsx("p",{className:"text-gray-600 mb-8",children:"To ensure the best experience and enable features like location-based check-ins and photo uploads, we need access to your device's Camera and Location."}),i.jsxs("div",{className:"space-y-4 mb-8",children:[i.jsxs("div",{className:`p-4 rounded-lg border ${t==="granted"?"bg-green-100 border-green-300":"bg-gray-100 border-gray-300"}`,children:[i.jsx("p",{className:"font-semibold",children:"Location Access"}),i.jsx("p",{className:"text-sm",children:t==="granted"?"Permission Granted":"Needed for check-in/out"})]}),i.jsxs("div",{className:`p-4 rounded-lg border ${s==="granted"?"bg-green-100 border-green-300":"bg-gray-100 border-gray-300"}`,children:[i.jsx("p",{className:"font-semibold",children:"Camera Access"}),i.jsx("p",{className:"text-sm",children:s==="granted"?"Permission Granted":"Needed for identity verification"})]})]}),i.jsx(ae,{onClick:p,disabled:o,children:o?"Requesting...":"Grant Permissions"}),c&&i.jsx("p",{className:"text-red-500 mt-4",children:c}),i.jsx("p",{className:"text-xs text-gray-500 mt-8",children:"You can manage these permissions in your device settings at any time."})]})]}):null},TJ=()=>{const[n,e]=E.useState(!1),t=()=>{e(!0)};return n?i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4",children:[i.jsx("div",{className:"splash-logo",children:i.jsx(Wi,{className:"h-16 mb-8"})}),i.jsx("p",{className:"text-gray-600",children:"Loading Application..."})]}):i.jsx(CJ,{onComplete:t})},PJ=()=>{const{user:n,logout:e}=St(),{permissions:t}=ka(),r=yn();if(!n)return null;const s=KF.filter(o=>t[n.role]?.includes(o.permission)).sort((o,l)=>o.label.localeCompare(l.label)),a=async()=>{await e(),r("/auth/login")};return i.jsxs("div",{className:"min-h-[calc(100vh-180px)] flex flex-col pb-4",children:[i.jsx("div",{className:"bg-[#0d2818] p-6 rounded-3xl shadow-lg -mx-4 mb-6",children:i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Vi,{photoUrl:n.photoUrl,seed:n.id,className:"h-14 w-14 rounded-full border-2 border-[#22c55e]"}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold text-white",children:["Hi, ",n.name.split(" ")[0]]}),i.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:n.role.replace(/_/g," ")})]})]})})}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsx("h2",{className:"text-lg font-semibold text-white mb-4 px-2",children:"Apps & Features"}),i.jsx("div",{className:"grid grid-cols-3 gap-3 px-2 flex-1 content-start",children:s.map(o=>i.jsxs("div",{onClick:()=>r(o.to),className:"flex flex-col items-center justify-center p-4 bg-[#041b0f] border border-[#1f3d2b] rounded-2xl active:scale-95 transition-transform duration-150 shadow-md min-h-[110px]",children:[i.jsx("div",{className:"p-3 bg-[#0d2818] rounded-full mb-2 text-[#22c55e]",children:i.jsx(o.icon,{className:"w-7 h-7"})}),i.jsx("span",{className:"text-xs text-center text-gray-300 font-medium leading-tight",children:o.label})]},o.to))})]}),i.jsx("div",{className:"px-2 mt-6",children:i.jsxs("button",{onClick:a,className:"w-full flex items-center justify-center space-x-2 p-4 bg-[#1f2937] text-white rounded-xl font-semibold active:bg-[#374151] transition-colors",children:[i.jsx(kc,{className:"w-5 h-5"}),i.jsx("span",{children:"Log Out"})]})})]})};var bm=n=>n.type==="checkbox",eu=n=>n instanceof Date,Ls=n=>n==null;const QF=n=>typeof n=="object";var yr=n=>!Ls(n)&&!Array.isArray(n)&&QF(n)&&!eu(n),XF=n=>yr(n)&&n.target?bm(n.target)?n.target.checked:n.target.value:n,MJ=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,e3=(n,e)=>n.has(MJ(e)),kJ=n=>{const e=n.constructor&&n.constructor.prototype;return yr(e)&&e.hasOwnProperty("isPrototypeOf")},wC=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ln(n){let e;const t=Array.isArray(n),r=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(wC&&(n instanceof Blob||r))&&(t||yr(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!kJ(n))e=n;else for(const s in n)n.hasOwnProperty(s)&&(e[s]=Ln(n[s]));else return n;return e}var Gx=n=>/^\w*$/.test(n),In=n=>n===void 0,Zx=n=>Array.isArray(n)?n.filter(Boolean):[],SC=n=>Zx(n.replace(/["|']|\]/g,"").split(/\.|\[/)),tt=(n,e,t)=>{if(!e||!yr(n))return t;const r=(Gx(e)?[e]:SC(e)).reduce((s,a)=>Ls(s)?s:s[a],n);return In(r)||r===n?In(n[e])?t:n[e]:r},ai=n=>typeof n=="boolean",ln=(n,e,t)=>{let r=-1;const s=Gx(e)?[e]:SC(e),a=s.length,o=a-1;for(;++r<a;){const l=s[r];let c=t;if(r!==o){const d=n[l];c=yr(d)||Array.isArray(d)?d:isNaN(+s[r+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=c,n=n[l]}};const yx={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},zi={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},il={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},t3=at.createContext(null);t3.displayName="HookFormContext";const Kx=()=>at.useContext(t3);var n3=(n,e,t,r=!0)=>{const s={defaultValues:e._defaultValues};for(const a in n)Object.defineProperty(s,a,{get:()=>{const o=a;return e._proxyFormState[o]!==zi.all&&(e._proxyFormState[o]=!r||zi.all),t&&(t[o]=!0),n[o]}});return s};const Jx=typeof window<"u"?at.useLayoutEffect:at.useEffect;function EJ(n){const e=Kx(),{control:t=e.control,disabled:r,name:s,exact:a}=n||{},[o,l]=at.useState(t._formState),c=at.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return Jx(()=>t._subscribe({name:s,formState:c.current,exact:a,callback:d=>{!r&&l({...t._formState,...d})}}),[s,r,a]),at.useEffect(()=>{c.current.isValid&&t._setValid(!0)},[t]),at.useMemo(()=>n3(o,t,c.current,!1),[o,t])}var di=n=>typeof n=="string",bN=(n,e,t,r,s)=>di(n)?(r&&e.watch.add(n),tt(t,n,s)):Array.isArray(n)?n.map(a=>(r&&e.watch.add(a),tt(t,a))):(r&&(e.watchAll=!0),t),_N=n=>Ls(n)||!QF(n);function ya(n,e,t=new WeakSet){if(_N(n)||_N(e))return n===e;if(eu(n)&&eu(e))return n.getTime()===e.getTime();const r=Object.keys(n),s=Object.keys(e);if(r.length!==s.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const a of r){const o=n[a];if(!s.includes(a))return!1;if(a!=="ref"){const l=e[a];if(eu(o)&&eu(l)||yr(o)&&yr(l)||Array.isArray(o)&&Array.isArray(l)?!ya(o,l,t):o!==l)return!1}}return!0}function nu(n){const e=Kx(),{control:t=e.control,name:r,defaultValue:s,disabled:a,exact:o,compute:l}=n||{},c=at.useRef(s),d=at.useRef(l),m=at.useRef(void 0),p=at.useRef(t),x=at.useRef(r);d.current=l;const[v,_]=at.useState(()=>{const M=t._getWatch(r,c.current);return d.current?d.current(M):M}),w=at.useCallback(M=>{const D=bN(r,t._names,M||t._formValues,!1,c.current);return d.current?d.current(D):D},[t._formValues,t._names,r]),j=at.useCallback(M=>{if(!a){const D=bN(r,t._names,M||t._formValues,!1,c.current);if(d.current){const O=d.current(D);ya(O,m.current)||(_(O),m.current=O)}else _(D)}},[t._formValues,t._names,a,r]);Jx(()=>((p.current!==t||!ya(x.current,r))&&(p.current=t,x.current=r,j()),t._subscribe({name:r,formState:{values:!0},exact:o,callback:M=>{j(M.values)}})),[t,o,r,j]),at.useEffect(()=>t._removeUnmounted());const P=p.current!==t,k=x.current,I=at.useMemo(()=>{if(a)return null;const M=!P&&!ya(k,r);return P||M?w():null},[a,P,r,k,w]);return I!==null?I:v}function DJ(n){const e=Kx(),{name:t,disabled:r,control:s=e.control,shouldUnregister:a,defaultValue:o}=n,l=e3(s._names.array,t),c=at.useMemo(()=>tt(s._formValues,t,tt(s._defaultValues,t,o)),[s,t,o]),d=nu({control:s,name:t,defaultValue:c,exact:!0}),m=EJ({control:s,name:t,exact:!0}),p=at.useRef(n),x=at.useRef(void 0),v=at.useRef(s.register(t,{...n.rules,value:d,...ai(n.disabled)?{disabled:n.disabled}:{}}));p.current=n;const _=at.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!tt(m.errors,t)},isDirty:{enumerable:!0,get:()=>!!tt(m.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!tt(m.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!tt(m.validatingFields,t)},error:{enumerable:!0,get:()=>tt(m.errors,t)}}),[m,t]),w=at.useCallback(I=>v.current.onChange({target:{value:XF(I),name:t},type:yx.CHANGE}),[t]),j=at.useCallback(()=>v.current.onBlur({target:{value:tt(s._formValues,t),name:t},type:yx.BLUR}),[t,s._formValues]),P=at.useCallback(I=>{const M=tt(s._fields,t);M&&I&&(M._f.ref={focus:()=>I.focus&&I.focus(),select:()=>I.select&&I.select(),setCustomValidity:D=>I.setCustomValidity(D),reportValidity:()=>I.reportValidity()})},[s._fields,t]),k=at.useMemo(()=>({name:t,value:d,...ai(r)||m.disabled?{disabled:m.disabled||r}:{},onChange:w,onBlur:j,ref:P}),[t,r,m.disabled,w,j,P,d]);return at.useEffect(()=>{const I=s._options.shouldUnregister||a,M=x.current;M&&M!==t&&!l&&s.unregister(M),s.register(t,{...p.current.rules,...ai(p.current.disabled)?{disabled:p.current.disabled}:{}});const D=(O,q)=>{const F=tt(s._fields,O);F&&F._f&&(F._f.mount=q)};if(D(t,!0),I){const O=Ln(tt(s._options.defaultValues,t,p.current.defaultValue));ln(s._defaultValues,t,O),In(tt(s._formValues,t))&&ln(s._formValues,t,O)}return!l&&s.register(t),x.current=t,()=>{(l?I&&!s._state.action:I)?s.unregister(t):D(t,!1)}},[t,s,l,a]),at.useEffect(()=>{s._setDisabledField({disabled:r,name:t})},[r,t,s]),at.useMemo(()=>({field:k,formState:m,fieldState:_}),[k,m,_])}const je=n=>n.render(DJ(n));var r3=(n,e,t,r,s)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[r]:s||!0}}:{},zs=n=>Array.isArray(n)?n:[n],Pk=()=>{let n=[];return{get observers(){return n},next:s=>{for(const a of n)a.next&&a.next(s)},subscribe:s=>(n.push(s),{unsubscribe:()=>{n=n.filter(a=>a!==s)}}),unsubscribe:()=>{n=[]}}};function s3(n,e){const t={};for(const r in n)if(n.hasOwnProperty(r)){const s=n[r],a=e[r];if(s&&yr(s)&&a){const o=s3(s,a);yr(o)&&(t[r]=o)}else n[r]&&(t[r]=a)}return t}var ts=n=>yr(n)&&!Object.keys(n).length,jC=n=>n.type==="file",va=n=>typeof n=="function",vx=n=>{if(!wC)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},i3=n=>n.type==="select-multiple",NC=n=>n.type==="radio",OJ=n=>NC(n)||bm(n),e0=n=>vx(n)&&n.isConnected;function IJ(n,e){const t=e.slice(0,-1).length;let r=0;for(;r<t;)n=In(n)?r++:n[e[r++]];return n}function AJ(n){for(const e in n)if(n.hasOwnProperty(e)&&!In(n[e]))return!1;return!0}function sr(n,e){const t=Array.isArray(e)?e:Gx(e)?[e]:SC(e),r=t.length===1?n:IJ(n,t),s=t.length-1,a=t[s];return r&&delete r[a],s!==0&&(yr(r)&&ts(r)||Array.isArray(r)&&AJ(r))&&sr(n,t.slice(0,-1)),n}var RJ=n=>{for(const e in n)if(va(n[e]))return!0;return!1};function a3(n){return Array.isArray(n)||yr(n)&&!RJ(n)}function wN(n,e={}){for(const t in n)a3(n[t])?(e[t]=Array.isArray(n[t])?[]:{},wN(n[t],e[t])):In(n[t])||(e[t]=!0);return e}function rf(n,e,t){t||(t=wN(e));for(const r in n)a3(n[r])?In(e)||_N(t[r])?t[r]=wN(n[r],Array.isArray(n[r])?[]:{}):rf(n[r],Ls(e)?{}:e[r],t[r]):t[r]=!ya(n[r],e[r]);return t}const Mk={value:!1,isValid:!1},kk={value:!0,isValid:!0};var o3=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!In(n[0].attributes.value)?In(n[0].value)||n[0].value===""?kk:{value:n[0].value,isValid:!0}:kk:Mk}return Mk},l3=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:r})=>In(n)?n:e?n===""?NaN:n&&+n:t&&di(n)?new Date(n):r?r(n):n;const Ek={isValid:!1,value:null};var c3=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Ek):Ek;function Dk(n){const e=n.ref;return jC(e)?e.files:NC(e)?c3(n.refs).value:i3(e)?[...e.selectedOptions].map(({value:t})=>t):bm(e)?o3(n.refs).value:l3(In(e.value)?n.ref.value:e.value,n)}var LJ=(n,e,t,r)=>{const s={};for(const a of n){const o=tt(e,a);o&&ln(s,a,o._f)}return{criteriaMode:t,names:[...n],fields:s,shouldUseNativeValidation:r}},bx=n=>n instanceof RegExp,mh=n=>In(n)?n:bx(n)?n.source:yr(n)?bx(n.value)?n.value.source:n.value:n,af=n=>({isOnSubmit:!n||n===zi.onSubmit,isOnBlur:n===zi.onBlur,isOnChange:n===zi.onChange,isOnAll:n===zi.all,isOnTouch:n===zi.onTouched});const Ok="AsyncFunction";var FJ=n=>!!n&&!!n.validate&&!!(va(n.validate)&&n.validate.constructor.name===Ok||yr(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===Ok)),qJ=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),SN=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(r=>n.startsWith(r)&&/^\.\w+/.test(n.slice(r.length))));const ff=(n,e,t,r)=>{for(const s of t||Object.keys(n)){const a=tt(n,s);if(a){const{_f:o,...l}=a;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],s)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(ff(l,e))break}else if(yr(l)&&ff(l,e))break}}};function Ik(n,e,t){const r=tt(n,t);if(r||Gx(t))return{error:r,name:t};const s=t.split(".");for(;s.length;){const a=s.join("."),o=tt(e,a),l=tt(n,a);if(o&&!Array.isArray(o)&&t!==a)return{name:t};if(l&&l.type)return{name:a,error:l};if(l&&l.root&&l.root.type)return{name:`${a}.root`,error:l.root};s.pop()}return{name:t}}var zJ=(n,e,t,r)=>{t(n);const{name:s,...a}=n;return ts(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(o=>e[o]===(!r||zi.all))},UJ=(n,e,t)=>!n||!e||n===e||zs(n).some(r=>r&&(t?r===e:r.startsWith(e)||e.startsWith(r))),VJ=(n,e,t,r,s)=>s.isOnAll?!1:!t&&s.isOnTouch?!(e||n):(t?r.isOnBlur:s.isOnBlur)?!n:(t?r.isOnChange:s.isOnChange)?n:!0,BJ=(n,e)=>!Zx(tt(n,e)).length&&sr(n,e),d3=(n,e,t)=>{const r=zs(tt(n,t));return ln(r,"root",e[t]),ln(n,t,r),n};function Ak(n,e,t="validate"){if(di(n)||Array.isArray(n)&&n.every(di)||ai(n)&&!n)return{type:t,message:di(n)?n:"",ref:e}}var Gu=n=>yr(n)&&!bx(n)?n:{value:n,message:""},jN=async(n,e,t,r,s,a)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:m,min:p,max:x,pattern:v,validate:_,name:w,valueAsNumber:j,mount:P}=n._f,k=tt(t,w);if(!P||e.has(w))return{};const I=l?l[0]:o,M=X=>{s&&I.reportValidity&&(I.setCustomValidity(ai(X)?"":X||""),I.reportValidity())},D={},O=NC(o),q=bm(o),F=O||q,U=(j||jC(o))&&In(o.value)&&In(k)||vx(o)&&o.value===""||k===""||Array.isArray(k)&&!k.length,B=r3.bind(null,w,r,D),G=(X,Q,Y,ne=il.maxLength,te=il.minLength)=>{const ie=X?Q:Y;D[w]={type:X?ne:te,message:ie,ref:o,...B(X?ne:te,ie)}};if(a?!Array.isArray(k)||!k.length:c&&(!F&&(U||Ls(k))||ai(k)&&!k||q&&!o3(l).isValid||O&&!c3(l).isValid)){const{value:X,message:Q}=di(c)?{value:!!c,message:c}:Gu(c);if(X&&(D[w]={type:il.required,message:Q,ref:I,...B(il.required,Q)},!r))return M(Q),D}if(!U&&(!Ls(p)||!Ls(x))){let X,Q;const Y=Gu(x),ne=Gu(p);if(!Ls(k)&&!isNaN(k)){const te=o.valueAsNumber||k&&+k;Ls(Y.value)||(X=te>Y.value),Ls(ne.value)||(Q=te<ne.value)}else{const te=o.valueAsDate||new Date(k),ie=se=>new Date(new Date().toDateString()+" "+se),$=o.type=="time",H=o.type=="week";di(Y.value)&&k&&(X=$?ie(k)>ie(Y.value):H?k>Y.value:te>new Date(Y.value)),di(ne.value)&&k&&(Q=$?ie(k)<ie(ne.value):H?k<ne.value:te<new Date(ne.value))}if((X||Q)&&(G(!!X,Y.message,ne.message,il.max,il.min),!r))return M(D[w].message),D}if((d||m)&&!U&&(di(k)||a&&Array.isArray(k))){const X=Gu(d),Q=Gu(m),Y=!Ls(X.value)&&k.length>+X.value,ne=!Ls(Q.value)&&k.length<+Q.value;if((Y||ne)&&(G(Y,X.message,Q.message),!r))return M(D[w].message),D}if(v&&!U&&di(k)){const{value:X,message:Q}=Gu(v);if(bx(X)&&!k.match(X)&&(D[w]={type:il.pattern,message:Q,ref:o,...B(il.pattern,Q)},!r))return M(Q),D}if(_){if(va(_)){const X=await _(k,t),Q=Ak(X,I);if(Q&&(D[w]={...Q,...B(il.validate,Q.message)},!r))return M(Q.message),D}else if(yr(_)){let X={};for(const Q in _){if(!ts(X)&&!r)break;const Y=Ak(await _[Q](k,t),I,Q);Y&&(X={...Y,...B(Q,Y.message)},M(Y.message),r&&(D[w]=X))}if(!ts(X)&&(D[w]={ref:I,...X},!r))return D}}return M(!0),D};const WJ={mode:zi.onSubmit,reValidateMode:zi.onChange,shouldFocusError:!0};function $J(n={}){let e={...WJ,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:va(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},s=yr(e.defaultValues)||yr(e.values)?Ln(e.defaultValues||e.values)||{}:{},a=e.shouldUnregister?{}:Ln(s),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const m={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...m};const x={array:Pk(),state:Pk()},v=e.criteriaMode===zi.all,_=de=>xe=>{clearTimeout(d),d=setTimeout(de,xe)},w=async de=>{if(!e.disabled&&(m.isValid||p.isValid||de)){const xe=e.resolver?ts((await q()).errors):await U(r,!0);xe!==t.isValid&&x.state.next({isValid:xe})}},j=(de,xe)=>{!e.disabled&&(m.isValidating||m.validatingFields||p.isValidating||p.validatingFields)&&((de||Array.from(l.mount)).forEach(Pe=>{Pe&&(xe?ln(t.validatingFields,Pe,xe):sr(t.validatingFields,Pe))}),x.state.next({validatingFields:t.validatingFields,isValidating:!ts(t.validatingFields)}))},P=(de,xe=[],Pe,Ge,Fe=!0,Le=!0)=>{if(Ge&&Pe&&!e.disabled){if(o.action=!0,Le&&Array.isArray(tt(r,de))){const Je=Pe(tt(r,de),Ge.argA,Ge.argB);Fe&&ln(r,de,Je)}if(Le&&Array.isArray(tt(t.errors,de))){const Je=Pe(tt(t.errors,de),Ge.argA,Ge.argB);Fe&&ln(t.errors,de,Je),BJ(t.errors,de)}if((m.touchedFields||p.touchedFields)&&Le&&Array.isArray(tt(t.touchedFields,de))){const Je=Pe(tt(t.touchedFields,de),Ge.argA,Ge.argB);Fe&&ln(t.touchedFields,de,Je)}(m.dirtyFields||p.dirtyFields)&&(t.dirtyFields=rf(s,a)),x.state.next({name:de,isDirty:G(de,xe),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else ln(a,de,xe)},k=(de,xe)=>{ln(t.errors,de,xe),x.state.next({errors:t.errors})},I=de=>{t.errors=de,x.state.next({errors:t.errors,isValid:!1})},M=(de,xe,Pe,Ge)=>{const Fe=tt(r,de);if(Fe){const Le=tt(a,de,In(Pe)?tt(s,de):Pe);In(Le)||Ge&&Ge.defaultChecked||xe?ln(a,de,xe?Le:Dk(Fe._f)):Y(de,Le),o.mount&&w()}},D=(de,xe,Pe,Ge,Fe)=>{let Le=!1,Je=!1;const nt={name:de};if(!e.disabled){if(!Pe||Ge){(m.isDirty||p.isDirty)&&(Je=t.isDirty,t.isDirty=nt.isDirty=G(),Le=Je!==nt.isDirty);const ct=ya(tt(s,de),xe);Je=!!tt(t.dirtyFields,de),ct?sr(t.dirtyFields,de):ln(t.dirtyFields,de,!0),nt.dirtyFields=t.dirtyFields,Le=Le||(m.dirtyFields||p.dirtyFields)&&Je!==!ct}if(Pe){const ct=tt(t.touchedFields,de);ct||(ln(t.touchedFields,de,Pe),nt.touchedFields=t.touchedFields,Le=Le||(m.touchedFields||p.touchedFields)&&ct!==Pe)}Le&&Fe&&x.state.next(nt)}return Le?nt:{}},O=(de,xe,Pe,Ge)=>{const Fe=tt(t.errors,de),Le=(m.isValid||p.isValid)&&ai(xe)&&t.isValid!==xe;if(e.delayError&&Pe?(c=_(()=>k(de,Pe)),c(e.delayError)):(clearTimeout(d),c=null,Pe?ln(t.errors,de,Pe):sr(t.errors,de)),(Pe?!ya(Fe,Pe):Fe)||!ts(Ge)||Le){const Je={...Ge,...Le&&ai(xe)?{isValid:xe}:{},errors:t.errors,name:de};t={...t,...Je},x.state.next(Je)}},q=async de=>{j(de,!0);const xe=await e.resolver(a,e.context,LJ(de||l.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return j(de),xe},F=async de=>{const{errors:xe}=await q(de);if(de)for(const Pe of de){const Ge=tt(xe,Pe);Ge?ln(t.errors,Pe,Ge):sr(t.errors,Pe)}else t.errors=xe;return xe},U=async(de,xe,Pe={valid:!0})=>{for(const Ge in de){const Fe=de[Ge];if(Fe){const{_f:Le,...Je}=Fe;if(Le){const nt=l.array.has(Le.name),ct=Fe._f&&FJ(Fe._f);ct&&m.validatingFields&&j([Le.name],!0);const Vt=await jN(Fe,l.disabled,a,v,e.shouldUseNativeValidation&&!xe,nt);if(ct&&m.validatingFields&&j([Le.name]),Vt[Le.name]&&(Pe.valid=!1,xe))break;!xe&&(tt(Vt,Le.name)?nt?d3(t.errors,Vt,Le.name):ln(t.errors,Le.name,Vt[Le.name]):sr(t.errors,Le.name))}!ts(Je)&&await U(Je,xe,Pe)}}return Pe.valid},B=()=>{for(const de of l.unMount){const xe=tt(r,de);xe&&(xe._f.refs?xe._f.refs.every(Pe=>!e0(Pe)):!e0(xe._f.ref))&&_e(de)}l.unMount=new Set},G=(de,xe)=>!e.disabled&&(de&&xe&&ln(a,de,xe),!ya(se(),s)),X=(de,xe,Pe)=>bN(de,l,{...o.mount?a:In(xe)?s:di(de)?{[de]:xe}:xe},Pe,xe),Q=de=>Zx(tt(o.mount?a:s,de,e.shouldUnregister?tt(s,de,[]):[])),Y=(de,xe,Pe={})=>{const Ge=tt(r,de);let Fe=xe;if(Ge){const Le=Ge._f;Le&&(!Le.disabled&&ln(a,de,l3(xe,Le)),Fe=vx(Le.ref)&&Ls(xe)?"":xe,i3(Le.ref)?[...Le.ref.options].forEach(Je=>Je.selected=Fe.includes(Je.value)):Le.refs?bm(Le.ref)?Le.refs.forEach(Je=>{(!Je.defaultChecked||!Je.disabled)&&(Array.isArray(Fe)?Je.checked=!!Fe.find(nt=>nt===Je.value):Je.checked=Fe===Je.value||!!Fe)}):Le.refs.forEach(Je=>Je.checked=Je.value===Fe):jC(Le.ref)?Le.ref.value="":(Le.ref.value=Fe,Le.ref.type||x.state.next({name:de,values:Ln(a)})))}(Pe.shouldDirty||Pe.shouldTouch)&&D(de,Fe,Pe.shouldTouch,Pe.shouldDirty,!0),Pe.shouldValidate&&H(de)},ne=(de,xe,Pe)=>{for(const Ge in xe){if(!xe.hasOwnProperty(Ge))return;const Fe=xe[Ge],Le=de+"."+Ge,Je=tt(r,Le);(l.array.has(de)||yr(Fe)||Je&&!Je._f)&&!eu(Fe)?ne(Le,Fe,Pe):Y(Le,Fe,Pe)}},te=(de,xe,Pe={})=>{const Ge=tt(r,de),Fe=l.array.has(de),Le=Ln(xe);ln(a,de,Le),Fe?(x.array.next({name:de,values:Ln(a)}),(m.isDirty||m.dirtyFields||p.isDirty||p.dirtyFields)&&Pe.shouldDirty&&x.state.next({name:de,dirtyFields:rf(s,a),isDirty:G(de,Le)})):Ge&&!Ge._f&&!Ls(Le)?ne(de,Le,Pe):Y(de,Le,Pe),SN(de,l)&&x.state.next({...t,name:de}),x.state.next({name:o.mount?de:void 0,values:Ln(a)})},ie=async de=>{o.mount=!0;const xe=de.target;let Pe=xe.name,Ge=!0;const Fe=tt(r,Pe),Le=ct=>{Ge=Number.isNaN(ct)||eu(ct)&&isNaN(ct.getTime())||ya(ct,tt(a,Pe,ct))},Je=af(e.mode),nt=af(e.reValidateMode);if(Fe){let ct,Vt;const At=xe.type?Dk(Fe._f):XF(de),vt=de.type===yx.BLUR||de.type===yx.FOCUS_OUT,wn=!qJ(Fe._f)&&!e.resolver&&!tt(t.errors,Pe)&&!Fe._f.deps||VJ(vt,tt(t.touchedFields,Pe),t.isSubmitted,nt,Je),Pn=SN(Pe,l,vt);ln(a,Pe,At),vt?(!xe||!xe.readOnly)&&(Fe._f.onBlur&&Fe._f.onBlur(de),c&&c(0)):Fe._f.onChange&&Fe._f.onChange(de);const Ht=D(Pe,At,vt),Un=!ts(Ht)||Pn;if(!vt&&x.state.next({name:Pe,type:de.type,values:Ln(a)}),wn)return(m.isValid||p.isValid)&&(e.mode==="onBlur"?vt&&w():vt||w()),Un&&x.state.next({name:Pe,...Pn?{}:Ht});if(!vt&&Pn&&x.state.next({...t}),e.resolver){const{errors:Mn}=await q([Pe]);if(Le(At),Ge){const An=Ik(t.errors,r,Pe),Pr=Ik(Mn,r,An.name||Pe);ct=Pr.error,Pe=Pr.name,Vt=ts(Mn)}}else j([Pe],!0),ct=(await jN(Fe,l.disabled,a,v,e.shouldUseNativeValidation))[Pe],j([Pe]),Le(At),Ge&&(ct?Vt=!1:(m.isValid||p.isValid)&&(Vt=await U(r,!0)));Ge&&(Fe._f.deps&&(!Array.isArray(Fe._f.deps)||Fe._f.deps.length>0)&&H(Fe._f.deps),O(Pe,Vt,ct,Ht))}},$=(de,xe)=>{if(tt(t.errors,xe)&&de.focus)return de.focus(),1},H=async(de,xe={})=>{let Pe,Ge;const Fe=zs(de);if(e.resolver){const Le=await F(In(de)?de:Fe);Pe=ts(Le),Ge=de?!Fe.some(Je=>tt(Le,Je)):Pe}else de?(Ge=(await Promise.all(Fe.map(async Le=>{const Je=tt(r,Le);return await U(Je&&Je._f?{[Le]:Je}:Je)}))).every(Boolean),!(!Ge&&!t.isValid)&&w()):Ge=Pe=await U(r);return x.state.next({...!di(de)||(m.isValid||p.isValid)&&Pe!==t.isValid?{}:{name:de},...e.resolver||!de?{isValid:Pe}:{},errors:t.errors}),xe.shouldFocus&&!Ge&&ff(r,$,de?Fe:l.mount),Ge},se=(de,xe)=>{let Pe={...o.mount?a:s};return xe&&(Pe=s3(xe.dirtyFields?t.dirtyFields:t.touchedFields,Pe)),In(de)?Pe:di(de)?tt(Pe,de):de.map(Ge=>tt(Pe,Ge))},W=(de,xe)=>({invalid:!!tt((xe||t).errors,de),isDirty:!!tt((xe||t).dirtyFields,de),error:tt((xe||t).errors,de),isValidating:!!tt(t.validatingFields,de),isTouched:!!tt((xe||t).touchedFields,de)}),ee=de=>{de&&zs(de).forEach(xe=>sr(t.errors,xe)),x.state.next({errors:de?t.errors:{}})},K=(de,xe,Pe)=>{const Ge=(tt(r,de,{_f:{}})._f||{}).ref,Fe=tt(t.errors,de)||{},{ref:Le,message:Je,type:nt,...ct}=Fe;ln(t.errors,de,{...ct,...xe,ref:Ge}),x.state.next({name:de,errors:t.errors,isValid:!1}),Pe&&Pe.shouldFocus&&Ge&&Ge.focus&&Ge.focus()},oe=(de,xe)=>va(de)?x.state.subscribe({next:Pe=>"values"in Pe&&de(X(void 0,xe),Pe)}):X(de,xe,!0),re=de=>x.state.subscribe({next:xe=>{UJ(de.name,xe.name,de.exact)&&zJ(xe,de.formState||m,ze,de.reRenderRoot)&&de.callback({values:{...a},...t,...xe,defaultValues:s})}}).unsubscribe,me=de=>(o.mount=!0,p={...p,...de.formState},re({...de,formState:p})),_e=(de,xe={})=>{for(const Pe of de?zs(de):l.mount)l.mount.delete(Pe),l.array.delete(Pe),xe.keepValue||(sr(r,Pe),sr(a,Pe)),!xe.keepError&&sr(t.errors,Pe),!xe.keepDirty&&sr(t.dirtyFields,Pe),!xe.keepTouched&&sr(t.touchedFields,Pe),!xe.keepIsValidating&&sr(t.validatingFields,Pe),!e.shouldUnregister&&!xe.keepDefaultValue&&sr(s,Pe);x.state.next({values:Ln(a)}),x.state.next({...t,...xe.keepDirty?{isDirty:G()}:{}}),!xe.keepIsValid&&w()},le=({disabled:de,name:xe})=>{(ai(de)&&o.mount||de||l.disabled.has(xe))&&(de?l.disabled.add(xe):l.disabled.delete(xe))},fe=(de,xe={})=>{let Pe=tt(r,de);const Ge=ai(xe.disabled)||ai(e.disabled);return ln(r,de,{...Pe||{},_f:{...Pe&&Pe._f?Pe._f:{ref:{name:de}},name:de,mount:!0,...xe}}),l.mount.add(de),Pe?le({disabled:ai(xe.disabled)?xe.disabled:e.disabled,name:de}):M(de,!0,xe.value),{...Ge?{disabled:xe.disabled||e.disabled}:{},...e.progressive?{required:!!xe.required,min:mh(xe.min),max:mh(xe.max),minLength:mh(xe.minLength),maxLength:mh(xe.maxLength),pattern:mh(xe.pattern)}:{},name:de,onChange:ie,onBlur:ie,ref:Fe=>{if(Fe){fe(de,xe),Pe=tt(r,de);const Le=In(Fe.value)&&Fe.querySelectorAll&&Fe.querySelectorAll("input,select,textarea")[0]||Fe,Je=OJ(Le),nt=Pe._f.refs||[];if(Je?nt.find(ct=>ct===Le):Le===Pe._f.ref)return;ln(r,de,{_f:{...Pe._f,...Je?{refs:[...nt.filter(e0),Le,...Array.isArray(tt(s,de))?[{}]:[]],ref:{type:Le.type,name:de}}:{ref:Le}}}),M(de,!1,void 0,Le)}else Pe=tt(r,de,{}),Pe._f&&(Pe._f.mount=!1),(e.shouldUnregister||xe.shouldUnregister)&&!(e3(l.array,de)&&o.action)&&l.unMount.add(de)}}},ue=()=>e.shouldFocusError&&ff(r,$,l.mount),ce=de=>{ai(de)&&(x.state.next({disabled:de}),ff(r,(xe,Pe)=>{const Ge=tt(r,Pe);Ge&&(xe.disabled=Ge._f.disabled||de,Array.isArray(Ge._f.refs)&&Ge._f.refs.forEach(Fe=>{Fe.disabled=Ge._f.disabled||de}))},0,!1))},Se=(de,xe)=>async Pe=>{let Ge;Pe&&(Pe.preventDefault&&Pe.preventDefault(),Pe.persist&&Pe.persist());let Fe=Ln(a);if(x.state.next({isSubmitting:!0}),e.resolver){const{errors:Le,values:Je}=await q();t.errors=Le,Fe=Ln(Je)}else await U(r);if(l.disabled.size)for(const Le of l.disabled)sr(Fe,Le);if(sr(t.errors,"root"),ts(t.errors)){x.state.next({errors:{}});try{await de(Fe,Pe)}catch(Le){Ge=Le}}else xe&&await xe({...t.errors},Pe),ue(),setTimeout(ue);if(x.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ts(t.errors)&&!Ge,submitCount:t.submitCount+1,errors:t.errors}),Ge)throw Ge},ye=(de,xe={})=>{tt(r,de)&&(In(xe.defaultValue)?te(de,Ln(tt(s,de))):(te(de,xe.defaultValue),ln(s,de,Ln(xe.defaultValue))),xe.keepTouched||sr(t.touchedFields,de),xe.keepDirty||(sr(t.dirtyFields,de),t.isDirty=xe.defaultValue?G(de,Ln(tt(s,de))):G()),xe.keepError||(sr(t.errors,de),m.isValid&&w()),x.state.next({...t}))},Ne=(de,xe={})=>{const Pe=de?Ln(de):s,Ge=Ln(Pe),Fe=ts(de),Le=Fe?s:Ge;if(xe.keepDefaultValues||(s=Pe),!xe.keepValues){if(xe.keepDirtyValues){const Je=new Set([...l.mount,...Object.keys(rf(s,a))]);for(const nt of Array.from(Je))tt(t.dirtyFields,nt)?ln(Le,nt,tt(a,nt)):te(nt,tt(Le,nt))}else{if(wC&&In(de))for(const Je of l.mount){const nt=tt(r,Je);if(nt&&nt._f){const ct=Array.isArray(nt._f.refs)?nt._f.refs[0]:nt._f.ref;if(vx(ct)){const Vt=ct.closest("form");if(Vt){Vt.reset();break}}}}if(xe.keepFieldsRef)for(const Je of l.mount)te(Je,tt(Le,Je));else r={}}a=e.shouldUnregister?xe.keepDefaultValues?Ln(s):{}:Ln(Le),x.array.next({values:{...Le}}),x.state.next({values:{...Le}})}l={mount:xe.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!m.isValid||!!xe.keepIsValid||!!xe.keepDirtyValues||!e.shouldUnregister&&!ts(Le),o.watch=!!e.shouldUnregister,x.state.next({submitCount:xe.keepSubmitCount?t.submitCount:0,isDirty:Fe?!1:xe.keepDirty?t.isDirty:!!(xe.keepDefaultValues&&!ya(de,s)),isSubmitted:xe.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:Fe?{}:xe.keepDirtyValues?xe.keepDefaultValues&&a?rf(s,a):t.dirtyFields:xe.keepDefaultValues&&de?rf(s,de):xe.keepDirty?t.dirtyFields:{},touchedFields:xe.keepTouched?t.touchedFields:{},errors:xe.keepErrors?t.errors:{},isSubmitSuccessful:xe.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},ke=(de,xe)=>Ne(va(de)?de(a):de,xe),qe=(de,xe={})=>{const Pe=tt(r,de),Ge=Pe&&Pe._f;if(Ge){const Fe=Ge.refs?Ge.refs[0]:Ge.ref;Fe.focus&&(Fe.focus(),xe.shouldSelect&&va(Fe.select)&&Fe.select())}},ze=de=>{t={...t,...de}},Be={control:{register:fe,unregister:_e,getFieldState:W,handleSubmit:Se,setError:K,_subscribe:re,_runSchema:q,_focusError:ue,_getWatch:X,_getDirty:G,_setValid:w,_setFieldArray:P,_setDisabledField:le,_setErrors:I,_getFieldArray:Q,_reset:Ne,_resetDefaultValues:()=>va(e.defaultValues)&&e.defaultValues().then(de=>{ke(de,e.resetOptions),x.state.next({isLoading:!1})}),_removeUnmounted:B,_disableForm:ce,_subjects:x,_proxyFormState:m,get _fields(){return r},get _formValues(){return a},get _state(){return o},set _state(de){o=de},get _defaultValues(){return s},get _names(){return l},set _names(de){l=de},get _formState(){return t},get _options(){return e},set _options(de){e={...e,...de}}},subscribe:me,trigger:H,register:fe,handleSubmit:Se,watch:oe,setValue:te,getValues:se,reset:ke,resetField:ye,clearErrors:ee,unregister:_e,setError:K,setFocus:qe,getFieldState:W};return{...Be,formControl:Be}}var _c=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const n=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=(Math.random()*16+n)%16|0;return(e=="x"?t:t&3|8).toString(16)})},t0=(n,e,t={})=>t.shouldFocus||In(t.shouldFocus)?t.focusName||`${n}.${In(t.focusIndex)?e:t.focusIndex}.`:"",n0=(n,e)=>[...n,...zs(e)],r0=n=>Array.isArray(n)?n.map(()=>{}):void 0;function s0(n,e,t){return[...n.slice(0,e),...zs(t),...n.slice(e)]}var i0=(n,e,t)=>Array.isArray(n)?(In(n[t])&&(n[t]=void 0),n.splice(t,0,n.splice(e,1)[0]),n):[],a0=(n,e)=>[...zs(e),...zs(n)];function HJ(n,e){let t=0;const r=[...n];for(const s of e)r.splice(s-t,1),t++;return Zx(r).length?r:[]}var o0=(n,e)=>In(e)?[]:HJ(n,zs(e).sort((t,r)=>t-r)),l0=(n,e,t)=>{[n[e],n[t]]=[n[t],n[e]]},Rk=(n,e,t)=>(n[e]=t,n);function ys(n){const e=Kx(),{control:t=e.control,name:r,keyName:s="id",shouldUnregister:a,rules:o}=n,[l,c]=at.useState(t._getFieldArray(r)),d=at.useRef(t._getFieldArray(r).map(_c)),m=at.useRef(!1);t._names.array.add(r),at.useMemo(()=>o&&l.length>=0&&t.register(r,o),[t,r,l.length,o]),Jx(()=>t._subjects.array.subscribe({next:({values:M,name:D})=>{if(D===r||!D){const O=tt(M,r);Array.isArray(O)&&(c(O),d.current=O.map(_c))}}}).unsubscribe,[t,r]);const p=at.useCallback(M=>{m.current=!0,t._setFieldArray(r,M)},[t,r]),x=(M,D)=>{const O=zs(Ln(M)),q=n0(t._getFieldArray(r),O);t._names.focus=t0(r,q.length-1,D),d.current=n0(d.current,O.map(_c)),p(q),c(q),t._setFieldArray(r,q,n0,{argA:r0(M)})},v=(M,D)=>{const O=zs(Ln(M)),q=a0(t._getFieldArray(r),O);t._names.focus=t0(r,0,D),d.current=a0(d.current,O.map(_c)),p(q),c(q),t._setFieldArray(r,q,a0,{argA:r0(M)})},_=M=>{const D=o0(t._getFieldArray(r),M);d.current=o0(d.current,M),p(D),c(D),!Array.isArray(tt(t._fields,r))&&ln(t._fields,r,void 0),t._setFieldArray(r,D,o0,{argA:M})},w=(M,D,O)=>{const q=zs(Ln(D)),F=s0(t._getFieldArray(r),M,q);t._names.focus=t0(r,M,O),d.current=s0(d.current,M,q.map(_c)),p(F),c(F),t._setFieldArray(r,F,s0,{argA:M,argB:r0(D)})},j=(M,D)=>{const O=t._getFieldArray(r);l0(O,M,D),l0(d.current,M,D),p(O),c(O),t._setFieldArray(r,O,l0,{argA:M,argB:D},!1)},P=(M,D)=>{const O=t._getFieldArray(r);i0(O,M,D),i0(d.current,M,D),p(O),c(O),t._setFieldArray(r,O,i0,{argA:M,argB:D},!1)},k=(M,D)=>{const O=Ln(D),q=Rk(t._getFieldArray(r),M,O);d.current=[...q].map((F,U)=>!F||U===M?_c():d.current[U]),p(q),c([...q]),t._setFieldArray(r,q,Rk,{argA:M,argB:O},!0,!1)},I=M=>{const D=zs(Ln(M));d.current=D.map(_c),p([...D]),c([...D]),t._setFieldArray(r,[...D],O=>O,{},!0,!1)};return at.useEffect(()=>{if(t._state.action=!1,SN(r,t._names)&&t._subjects.state.next({...t._formState}),m.current&&(!af(t._options.mode).isOnSubmit||t._formState.isSubmitted)&&!af(t._options.reValidateMode).isOnSubmit)if(t._options.resolver)t._runSchema([r]).then(M=>{const D=tt(M.errors,r),O=tt(t._formState.errors,r);(O?!D&&O.type||D&&(O.type!==D.type||O.message!==D.message):D&&D.type)&&(D?ln(t._formState.errors,r,D):sr(t._formState.errors,r),t._subjects.state.next({errors:t._formState.errors}))});else{const M=tt(t._fields,r);M&&M._f&&!(af(t._options.reValidateMode).isOnSubmit&&af(t._options.mode).isOnSubmit)&&jN(M,t._names.disabled,t._formValues,t._options.criteriaMode===zi.all,t._options.shouldUseNativeValidation,!0).then(D=>!ts(D)&&t._subjects.state.next({errors:d3(t._formState.errors,D,r)}))}t._subjects.state.next({name:r,values:Ln(t._formValues)}),t._names.focus&&ff(t._fields,(M,D)=>{if(t._names.focus&&D.startsWith(t._names.focus)&&M.focus)return M.focus(),1}),t._names.focus="",t._setValid(),m.current=!1},[l,r,t]),at.useEffect(()=>(!tt(t._formValues,r)&&t._setFieldArray(r),()=>{const M=(D,O)=>{const q=tt(t._fields,D);q&&q._f&&(q._f.mount=O)};t._options.shouldUnregister||a?t.unregister(r):M(r,!1)}),[r,t,s,a]),{swap:at.useCallback(j,[p,r,t]),move:at.useCallback(P,[p,r,t]),prepend:at.useCallback(v,[p,r,t]),append:at.useCallback(x,[p,r,t]),remove:at.useCallback(_,[p,r,t]),insert:at.useCallback(w,[p,r,t]),update:at.useCallback(k,[p,r,t]),replace:at.useCallback(I,[p,r,t]),fields:at.useMemo(()=>l.map((M,D)=>({...M,[s]:d.current[D]||_c()})),[l,s])}}function Zt(n={}){const e=at.useRef(void 0),t=at.useRef(void 0),[r,s]=at.useState({isDirty:!1,isValidating:!1,isLoading:va(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:va(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:r},n.defaultValues&&!va(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=$J(n);e.current={...l,formState:r}}const a=e.current.control;return a._options=n,Jx(()=>{const o=a._subscribe({formState:a._proxyFormState,callback:()=>s({...a._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),a._formState.isReady=!0,o},[a]),at.useEffect(()=>a._disableForm(n.disabled),[a,n.disabled]),at.useEffect(()=>{n.mode&&(a._options.mode=n.mode),n.reValidateMode&&(a._options.reValidateMode=n.reValidateMode)},[a,n.mode,n.reValidateMode]),at.useEffect(()=>{n.errors&&(a._setErrors(n.errors),a._focusError())},[a,n.errors]),at.useEffect(()=>{n.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,n.shouldUnregister]),at.useEffect(()=>{if(a._proxyFormState.isDirty){const o=a._getDirty();o!==r.isDirty&&a._subjects.state.next({isDirty:o})}},[a,r.isDirty]),at.useEffect(()=>{n.values&&!ya(n.values,t.current)?(a._reset(n.values,{keepFieldsRef:!0,...a._options.resetOptions}),t.current=n.values,s(o=>({...o}))):a._resetDefaultValues()},[a,n.values]),at.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),e.current.formState=n3(r,a),e.current}const Lk=(n,e,t)=>{if(n&&"reportValidity"in n){const r=tt(t,e);n.setCustomValidity(r&&r.message||""),n.reportValidity()}},u3=(n,e)=>{for(const t in e.fields){const r=e.fields[t];r&&r.ref&&"reportValidity"in r.ref?Lk(r.ref,t,n):r.refs&&r.refs.forEach(s=>Lk(s,t,n))}},YJ=(n,e)=>{e.shouldUseNativeValidation&&u3(n,e);const t={};for(const r in n){const s=tt(e.fields,r),a=Object.assign(n[r]||{},{ref:s&&s.ref});if(GJ(e.names||Object.keys(n),r)){const o=Object.assign({},tt(t,r));ln(o,"root",a),ln(t,r,o)}else ln(t,r,a)}return t},GJ=(n,e)=>n.some(t=>t.startsWith(e+"."));function _n(n,e,t){return e===void 0&&(e={}),t===void 0&&(t={}),function(r,s,a){try{return Promise.resolve((function(o,l){try{var c=(e.context,Promise.resolve(n[t.mode==="sync"?"validateSync":"validate"](r,Object.assign({abortEarly:!1},e,{context:s}))).then(function(d){return a.shouldUseNativeValidation&&u3({},a),{values:t.raw?r:d,errors:{}}}))}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c})(0,function(o){if(!o.inner)throw o;return{values:{},errors:YJ((l=o,c=!a.shouldUseNativeValidation&&a.criteriaMode==="all",(l.inner||[]).reduce(function(d,m){if(d[m.path]||(d[m.path]={message:m.message,type:m.type}),c){var p=d[m.path].types,x=p&&p[m.type];d[m.path]=r3(m.path,c,d,m.type,x?[].concat(x,m.message):m.message)}return d},{})),a)};var l,c}))}catch(o){return Promise.reject(o)}}}var c0,Fk;function ZJ(){if(Fk)return c0;Fk=1;function n(P){this._maxSize=P,this.clear()}n.prototype.clear=function(){this._size=0,this._values=Object.create(null)},n.prototype.get=function(P){return this._values[P]},n.prototype.set=function(P,k){return this._size>=this._maxSize&&this.clear(),P in this._values||this._size++,this._values[P]=k};var e=/[^.^\]^[]+|(?=\[\]|\.\.)/g,t=/^\d+$/,r=/^\d/,s=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,a=/^\s*(['"]?)(.*?)(\1)\s*$/,o=512,l=new n(o),c=new n(o),d=new n(o);c0={Cache:n,split:p,normalizePath:m,setter:function(P){var k=m(P);return c.get(P)||c.set(P,function(M,D){for(var O=0,q=k.length,F=M;O<q-1;){var U=k[O];if(U==="__proto__"||U==="constructor"||U==="prototype")return M;F=F[k[O++]]}F[k[O]]=D})},getter:function(P,k){var I=m(P);return d.get(P)||d.set(P,function(D){for(var O=0,q=I.length;O<q;)if(D!=null||!k)D=D[I[O++]];else return;return D})},join:function(P){return P.reduce(function(k,I){return k+(v(I)||t.test(I)?"["+I+"]":(k?".":"")+I)},"")},forEach:function(P,k,I){x(Array.isArray(P)?P:p(P),k,I)}};function m(P){return l.get(P)||l.set(P,p(P).map(function(k){return k.replace(a,"$2")}))}function p(P){return P.match(e)||[""]}function x(P,k,I){var M=P.length,D,O,q,F;for(O=0;O<M;O++)D=P[O],D&&(j(D)&&(D='"'+D+'"'),F=v(D),q=!F&&/^\d+$/.test(D),k.call(I,D,F,q,O,P))}function v(P){return typeof P=="string"&&P&&["'",'"'].indexOf(P.charAt(0))!==-1}function _(P){return P.match(r)&&!P.match(t)}function w(P){return s.test(P)}function j(P){return!v(P)&&(_(P)||w(P))}return c0}var ru=ZJ(),d0,qk;function KJ(){if(qk)return d0;qk=1;const n=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,e=m=>m.match(n)||[],t=m=>m[0].toUpperCase()+m.slice(1),r=(m,p)=>e(m).join(p).toLowerCase(),s=m=>e(m).reduce((p,x)=>`${p}${p?x[0].toUpperCase()+x.slice(1).toLowerCase():x.toLowerCase()}`,"");return d0={words:e,upperFirst:t,camelCase:s,pascalCase:m=>t(s(m)),snakeCase:m=>r(m,"_"),kebabCase:m=>r(m,"-"),sentenceCase:m=>t(r(m," ")),titleCase:m=>e(m).map(t).join(" ")},d0}var u0=KJ(),Dp={exports:{}},zk;function JJ(){if(zk)return Dp.exports;zk=1,Dp.exports=function(s){return n(e(s),s)},Dp.exports.array=n;function n(s,a){var o=s.length,l=new Array(o),c={},d=o,m=t(a),p=r(s);for(a.forEach(function(v){if(!p.has(v[0])||!p.has(v[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});d--;)c[d]||x(s[d],d,new Set);return l;function x(v,_,w){if(w.has(v)){var j;try{j=", node was:"+JSON.stringify(v)}catch{j=""}throw new Error("Cyclic dependency"+j)}if(!p.has(v))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(v));if(!c[_]){c[_]=!0;var P=m.get(v)||new Set;if(P=Array.from(P),_=P.length){w.add(v);do{var k=P[--_];x(k,p.get(k),w)}while(_);w.delete(v)}l[--o]=v}}}function e(s){for(var a=new Set,o=0,l=s.length;o<l;o++){var c=s[o];a.add(c[0]),a.add(c[1])}return Array.from(a)}function t(s){for(var a=new Map,o=0,l=s.length;o<l;o++){var c=s[o];a.has(c[0])||a.set(c[0],new Set),a.has(c[1])||a.set(c[1],new Set),a.get(c[0]).add(c[1])}return a}function r(s){for(var a=new Map,o=0,l=s.length;o<l;o++)a.set(s[o],o);return a}return Dp.exports}var QJ=JJ();const XJ=hu(QJ),eQ=Object.prototype.toString,tQ=Error.prototype.toString,nQ=RegExp.prototype.toString,rQ=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",sQ=/^Symbol\((.*)\)(.*)$/;function iQ(n){return n!=+n?"NaN":n===0&&1/n<0?"-0":""+n}function Uk(n,e=!1){if(n==null||n===!0||n===!1)return""+n;const t=typeof n;if(t==="number")return iQ(n);if(t==="string")return e?`"${n}"`:n;if(t==="function")return"[Function "+(n.name||"anonymous")+"]";if(t==="symbol")return rQ.call(n).replace(sQ,"Symbol($1)");const r=eQ.call(n).slice(8,-1);return r==="Date"?isNaN(n.getTime())?""+n:n.toISOString(n):r==="Error"||n instanceof Error?"["+tQ.call(n)+"]":r==="RegExp"?nQ.call(n):null}function yl(n,e){let t=Uk(n,e);return t!==null?t:JSON.stringify(n,function(r,s){let a=Uk(this[r],e);return a!==null?a:s},2)}function f3(n){return n==null?[]:[].concat(n)}let h3,m3,p3,aQ=/\$\{\s*(\w+)\s*\}/g;h3=Symbol.toStringTag;class Vk{constructor(e,t,r,s){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[h3]="Error",this.name="ValidationError",this.value=t,this.path=r,this.type=s,this.errors=[],this.inner=[],f3(e).forEach(a=>{if(gs.isError(a)){this.errors.push(...a.errors);const o=a.inner.length?a.inner:[a];this.inner.push(...o)}else this.errors.push(a)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}m3=Symbol.hasInstance;p3=Symbol.toStringTag;class gs extends Error{static formatError(e,t){const r=t.label||t.path||"this";return t=Object.assign({},t,{path:r,originalPath:t.path}),typeof e=="string"?e.replace(aQ,(s,a)=>yl(t[a])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,r,s,a){const o=new Vk(e,t,r,s);if(a)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[p3]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,gs)}static[m3](e){return Vk[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let co={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:n,type:e,value:t,originalValue:r})=>{const s=r!=null&&r!==t?` (cast from the value \`${yl(r,!0)}\`).`:".";return e!=="mixed"?`${n} must be a \`${e}\` type, but the final value was: \`${yl(t,!0)}\``+s:`${n} must match the configured type. The validated value was: \`${yl(t,!0)}\``+s}},Rs={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},Cc={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},NN={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},CN={isValue:"${path} field must be ${value}"},Zg={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},Kg={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},oQ={notType:n=>{const{path:e,value:t,spec:r}=n,s=r.types.length;if(Array.isArray(t)){if(t.length<s)return`${e} tuple value has too few items, expected a length of ${s} but got ${t.length} for value: \`${yl(t,!0)}\``;if(t.length>s)return`${e} tuple value has too many items, expected a length of ${s} but got ${t.length} for value: \`${yl(t,!0)}\``}return gs.formatError(co.notType,n)}};Object.assign(Object.create(null),{mixed:co,string:Rs,number:Cc,date:NN,object:Zg,array:Kg,boolean:CN,tuple:oQ});const Qx=n=>n&&n.__isYupSchema__;class _x{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:r,then:s,otherwise:a}=t,o=typeof r=="function"?r:(...l)=>l.every(c=>c===r);return new _x(e,(l,c)=>{var d;let m=o(...l)?s:a;return(d=m?.(c))!=null?d:c})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let r=this.refs.map(a=>a.getValue(t?.value,t?.parent,t?.context)),s=this.fn(r,e,t);if(s===void 0||s===e)return e;if(!Qx(s))throw new TypeError("conditions must return a schema object");return s.resolve(t)}}const Op={context:"$",value:"."};function CC(n,e){return new Kc(n,e)}class Kc{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===Op.context,this.isValue=this.key[0]===Op.value,this.isSibling=!this.isContext&&!this.isValue;let r=this.isContext?Op.context:this.isValue?Op.value:"";this.path=this.key.slice(r.length),this.getter=this.path&&ru.getter(this.path,!0),this.map=t.map}getValue(e,t,r){let s=this.isContext?r:this.isValue?e:t;return this.getter&&(s=this.getter(s||{})),this.map&&(s=this.map(s)),s}cast(e,t){return this.getValue(e,t?.parent,t?.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}Kc.prototype.__isYupRef=!0;const ba=n=>n==null;function Zu(n){function e({value:t,path:r="",options:s,originalValue:a,schema:o},l,c){const{name:d,test:m,params:p,message:x,skipAbsent:v}=n;let{parent:_,context:w,abortEarly:j=o.spec.abortEarly,disableStackTrace:P=o.spec.disableStackTrace}=s;const k={value:t,parent:_,context:w};function I(G={}){const X=g3(Object.assign({value:t,originalValue:a,label:o.spec.label,path:G.path||r,spec:o.spec,disableStackTrace:G.disableStackTrace||P},p,G.params),k),Q=new gs(gs.formatError(G.message||x,X),t,X.path,G.type||d,X.disableStackTrace);return Q.params=X,Q}const M=j?l:c;let D={path:r,parent:_,type:d,from:s.from,createError:I,resolve(G){return x3(G,k)},options:s,originalValue:a,schema:o};const O=G=>{gs.isError(G)?M(G):G?c(null):M(I())},q=G=>{gs.isError(G)?M(G):l(G)};if(v&&ba(t))return O(!0);let U;try{var B;if(U=m.call(D,t,D),typeof((B=U)==null?void 0:B.then)=="function"){if(s.sync)throw new Error(`Validation test of type: "${D.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(U).then(O,q)}}catch(G){q(G);return}O(U)}return e.OPTIONS=n,e}function g3(n,e){if(!n)return n;for(const t of Object.keys(n))n[t]=x3(n[t],e);return n}function x3(n,e){return Kc.isRef(n)?n.getValue(e.value,e.parent,e.context):n}function lQ(n,e,t,r=t){let s,a,o;return e?(ru.forEach(e,(l,c,d)=>{let m=c?l.slice(1,l.length-1):l;n=n.resolve({context:r,parent:s,value:t});let p=n.type==="tuple",x=d?parseInt(m,10):0;if(n.innerType||p){if(p&&!d)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&x>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${l}, in the path: ${e}. because there is no value at that index. `);s=t,t=t&&t[x],n=p?n.spec.types[x]:n.innerType}if(!d){if(!n.fields||!n.fields[m])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${n.type}")`);s=t,t=t&&t[m],n=n.fields[m]}a=m,o=c?"["+l+"]":"."+l}),{schema:n,parent:s,parentPath:a}):{parent:s,parentPath:e,schema:n}}class wx extends Set{describe(){const e=[];for(const t of this.values())e.push(Kc.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const r of this.values())t.push(e(r));return t}clone(){return new wx(this.values())}merge(e,t){const r=this.clone();return e.forEach(s=>r.add(s)),t.forEach(s=>r.delete(s)),r}}function of(n,e=new Map){if(Qx(n)||!n||typeof n!="object")return n;if(e.has(n))return e.get(n);let t;if(n instanceof Date)t=new Date(n.getTime()),e.set(n,t);else if(n instanceof RegExp)t=new RegExp(n),e.set(n,t);else if(Array.isArray(n)){t=new Array(n.length),e.set(n,t);for(let r=0;r<n.length;r++)t[r]=of(n[r],e)}else if(n instanceof Map){t=new Map,e.set(n,t);for(const[r,s]of n.entries())t.set(r,of(s,e))}else if(n instanceof Set){t=new Set,e.set(n,t);for(const r of n)t.add(of(r,e))}else if(n instanceof Object){t={},e.set(n,t);for(const[r,s]of Object.entries(n))t[r]=of(s,e)}else throw Error(`Unable to clone ${n}`);return t}function cQ(n){if(!(n!=null&&n.length))return;const e=[];let t="",r=!1,s=!1;for(let a=0;a<n.length;a++){const o=n[a];if(o==="["&&!s){t&&(e.push(...t.split(".").filter(Boolean)),t=""),r=!0;continue}if(o==="]"&&!s){t&&(/^\d+$/.test(t)?e.push(t):e.push(t.replace(/^"|"$/g,"")),t=""),r=!1;continue}if(o==='"'){s=!s;continue}if(o==="."&&!r&&!s){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(...t.split(".").filter(Boolean)),e}function dQ(n,e){const t=e?`${e}.${n.path}`:n.path;return n.errors.map(r=>({message:r,path:cQ(t)}))}function y3(n,e){var t;if(!((t=n.inner)!=null&&t.length)&&n.errors.length)return dQ(n,e);const r=e?`${e}.${n.path}`:n.path;return n.inner.flatMap(s=>y3(s,r))}class Bs{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new wx,this._blacklist=new wx,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(co.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e?.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=of(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let r=e(this);return this._mutate=t,r}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,r=e.clone();const s=Object.assign({},t.spec,r.spec);return r.spec=s,r.internalTests=Object.assign({},t.internalTests,r.internalTests),r._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),r._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),r.tests=t.tests,r.exclusiveTests=t.exclusiveTests,r.withMutation(a=>{e.tests.forEach(o=>{a.test(o.OPTIONS)})}),r.transforms=[...t.transforms,...r.transforms],r}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let r=t.conditions;t=t.clone(),t.conditions=[],t=r.reduce((s,a)=>a.resolve(s,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,r,s,a;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(r=e.abortEarly)!=null?r:this.spec.abortEarly,recursive:(s=e.recursive)!=null?s:this.spec.recursive,disableStackTrace:(a=e.disableStackTrace)!=null?a:this.spec.disableStackTrace})}cast(e,t={}){let r=this.resolve(Object.assign({},t,{value:e})),s=t.assert==="ignore-optionality",a=r._cast(e,t);if(t.assert!==!1&&!r.isType(a)){if(s&&ba(a))return a;let o=yl(e),l=yl(a);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${r.type}". 

attempted value: ${o} 
`+(l!==o?`result of cast: ${l}`:""))}return a}_cast(e,t){let r=e===void 0?e:this.transforms.reduce((s,a)=>a.call(this,s,e,this,t),e);return r===void 0&&(r=this.getDefault(t)),r}_validate(e,t={},r,s){let{path:a,originalValue:o=e,strict:l=this.spec.strict}=t,c=e;l||(c=this._cast(c,Object.assign({assert:!1},t)));let d=[];for(let m of Object.values(this.internalTests))m&&d.push(m);this.runTests({path:a,value:c,originalValue:o,options:t,tests:d},r,m=>{if(m.length)return s(m,c);this.runTests({path:a,value:c,originalValue:o,options:t,tests:this.tests},r,s)})}runTests(e,t,r){let s=!1,{tests:a,value:o,originalValue:l,path:c,options:d}=e,m=w=>{s||(s=!0,t(w,o))},p=w=>{s||(s=!0,r(w,o))},x=a.length,v=[];if(!x)return p([]);let _={value:o,originalValue:l,path:c,options:d,schema:this};for(let w=0;w<a.length;w++){const j=a[w];j(_,m,function(k){k&&(Array.isArray(k)?v.push(...k):v.push(k)),--x<=0&&p(v)})}}asNestedTest({key:e,index:t,parent:r,parentPath:s,originalParent:a,options:o}){const l=e??t;if(l==null)throw TypeError("Must include `key` or `index` for nested validations");const c=typeof l=="number";let d=r[l];const m=Object.assign({},o,{strict:!0,parent:r,value:d,originalValue:a[l],key:void 0,[c?"index":"key"]:l,path:c||l.includes(".")?`${s||""}[${c?l:`"${l}"`}]`:(s?`${s}.`:"")+e});return(p,x,v)=>this.resolve(m)._validate(d,m,x,v)}validate(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),a=(r=t?.disableStackTrace)!=null?r:s.spec.disableStackTrace;return new Promise((o,l)=>s._validate(e,t,(c,d)=>{gs.isError(c)&&(c.value=d),l(c)},(c,d)=>{c.length?l(new gs(c,d,void 0,void 0,a)):o(d)}))}validateSync(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),a,o=(r=t?.disableStackTrace)!=null?r:s.spec.disableStackTrace;return s._validate(e,Object.assign({},t,{sync:!0}),(l,c)=>{throw gs.isError(l)&&(l.value=c),l},(l,c)=>{if(l.length)throw new gs(l,e,void 0,void 0,o);a=c}),a}isValid(e,t){return this.validate(e,t).then(()=>!0,r=>{if(gs.isError(r))return!1;throw r})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(r){if(gs.isError(r))return!1;throw r}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):of(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const r=this.clone({nullable:e});return r.internalTests.nullable=Zu({message:t,name:"nullable",test(s){return s===null?this.schema.spec.nullable:!0}}),r}optionality(e,t){const r=this.clone({optional:e});return r.internalTests.optionality=Zu({message:t,name:"optionality",test(s){return s===void 0?this.schema.spec.optional:!0}}),r}optional(){return this.optionality(!0)}defined(e=co.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=co.notNull){return this.nullability(!1,e)}required(e=co.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=co.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let r=this.clone(),s=Zu(t),a=t.exclusive||t.name&&r.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(r.exclusiveTests[t.name]=!!t.exclusive),r.tests=r.tests.filter(o=>!(o.OPTIONS.name===t.name&&(a||o.OPTIONS.test===s.OPTIONS.test))),r.tests.push(s),r}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let r=this.clone(),s=f3(e).map(a=>new Kc(a));return s.forEach(a=>{a.isSibling&&r.deps.push(a.key)}),r.conditions.push(typeof t=="function"?new _x(s,t):_x.fromOptions(s,t)),r}typeError(e){let t=this.clone();return t.internalTests.typeError=Zu({message:e,name:"typeError",skipAbsent:!0,test(r){return this.schema._typeCheck(r)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=co.oneOf){let r=this.clone();return e.forEach(s=>{r._whitelist.add(s),r._blacklist.delete(s)}),r.internalTests.whiteList=Zu({message:t,name:"oneOf",skipAbsent:!0,test(s){let a=this.schema._whitelist,o=a.resolveAll(this.resolve);return o.includes(s)?!0:this.createError({params:{values:Array.from(a).join(", "),resolved:o}})}}),r}notOneOf(e,t=co.notOneOf){let r=this.clone();return e.forEach(s=>{r._blacklist.add(s),r._whitelist.delete(s)}),r.internalTests.blacklist=Zu({message:t,name:"notOneOf",test(s){let a=this.schema._blacklist,o=a.resolveAll(this.resolve);return o.includes(s)?this.createError({params:{values:Array.from(a).join(", "),resolved:o}}):!0}}),r}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:r,meta:s,optional:a,nullable:o}=t.spec;return{meta:s,label:r,optional:a,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.filter((c,d,m)=>m.findIndex(p=>p.OPTIONS.name===c.OPTIONS.name)===d).map(c=>{const d=c.OPTIONS.params&&e?g3(Object.assign({},c.OPTIONS.params),e):c.OPTIONS.params;return{name:c.OPTIONS.name,params:d}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(r){try{return{value:await e.validate(r,{abortEarly:!1})}}catch(s){if(s instanceof gs)return{issues:y3(s)};throw s}}}}}Bs.prototype.__isYupSchema__=!0;for(const n of["validate","validateSync"])Bs.prototype[`${n}At`]=function(e,t,r={}){const{parent:s,parentPath:a,schema:o}=lQ(this,e,t,r.context);return o[n](s&&s[a],Object.assign({},r,{parent:s,path:e}))};for(const n of["equals","is"])Bs.prototype[n]=Bs.prototype.oneOf;for(const n of["not","nope"])Bs.prototype[n]=Bs.prototype.notOneOf;const uQ=()=>!0;function Ft(n){return new v3(n)}class v3 extends Bs{constructor(e){super(typeof e=="function"?{type:"mixed",check:e}:Object.assign({type:"mixed",check:uQ},e))}}Ft.prototype=v3.prototype;function ns(){return new b3}class b3 extends Bs{constructor(){super({type:"boolean",check(e){return e instanceof Boolean&&(e=e.valueOf()),typeof e=="boolean"}}),this.withMutation(()=>{this.transform((e,t)=>{if(this.spec.coerce&&!this.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e})})}isTrue(e=CN.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test(t){return ba(t)||t===!0}})}isFalse(e=CN.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test(t){return ba(t)||t===!1}})}default(e){return super.default(e)}defined(e){return super.defined(e)}optional(){return super.optional()}required(e){return super.required(e)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(e){return super.nonNullable(e)}strip(e){return super.strip(e)}}ns.prototype=b3.prototype;const fQ=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function hQ(n){const e=TN(n);if(!e)return Date.parse?Date.parse(n):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function TN(n){var e,t;const r=fQ.exec(n);return r?{year:al(r[1]),month:al(r[2],1)-1,day:al(r[3],1),hour:al(r[4]),minute:al(r[5]),second:al(r[6]),millisecond:r[7]?al(r[7].substring(0,3)):0,precision:(e=(t=r[7])==null?void 0:t.length)!=null?e:void 0,z:r[8]||void 0,plusMinus:r[9]||void 0,hourOffset:al(r[10]),minuteOffset:al(r[11])}:null}function al(n,e=0){return Number(n)||e}let mQ=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,pQ=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,gQ=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,xQ="^\\d{4}-\\d{2}-\\d{2}",yQ="\\d{2}:\\d{2}:\\d{2}",vQ="(([+-]\\d{2}(:?\\d{2})?)|Z)",bQ=new RegExp(`${xQ}T${yQ}(\\.\\d+)?${vQ}$`),_Q=n=>ba(n)||n===n.trim(),wQ={}.toString();function be(){return new _3}class _3 extends Bs{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce||this.isType(e)||Array.isArray(e))return e;const r=e!=null&&e.toString?e.toString():e;return r===wQ?e:r})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||co.required,name:"required",skipAbsent:!0,test:r=>!!r.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=Rs.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t=Rs.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t=Rs.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}matches(e,t){let r=!1,s,a;return t&&(typeof t=="object"?{excludeEmptyString:r=!1,message:s,name:a}=t:s=t),this.test({name:a||"matches",message:s||Rs.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&r||o.search(e)!==-1})}email(e=Rs.email){return this.matches(mQ,{name:"email",message:e,excludeEmptyString:!0})}url(e=Rs.url){return this.matches(pQ,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=Rs.uuid){return this.matches(gQ,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",r,s;return e&&(typeof e=="object"?{message:t="",allowOffset:r=!1,precision:s=void 0}=e:t=e),this.matches(bQ,{name:"datetime",message:t||Rs.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||Rs.datetime_offset,params:{allowOffset:r},skipAbsent:!0,test:a=>{if(!a||r)return!0;const o=TN(a);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||Rs.datetime_precision,params:{precision:s},skipAbsent:!0,test:a=>{if(!a||s==null)return!0;const o=TN(a);return o?o.precision===s:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=Rs.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:_Q})}lowercase(e=Rs.lowercase){return this.transform(t=>ba(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>ba(t)||t===t.toLowerCase()})}uppercase(e=Rs.uppercase){return this.transform(t=>ba(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>ba(t)||t===t.toUpperCase()})}}be.prototype=_3.prototype;let SQ=n=>n!=+n;function rs(){return new w3}class w3 extends Bs{constructor(){super({type:"number",check(e){return e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&!SQ(e)}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce)return e;let r=e;if(typeof r=="string"){if(r=r.replace(/\s/g,""),r==="")return NaN;r=+r}return this.isType(r)||r===null?r:parseFloat(r)})})}min(e,t=Cc.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r>=this.resolve(e)}})}max(e,t=Cc.max){return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r<=this.resolve(e)}})}lessThan(e,t=Cc.lessThan){return this.test({message:t,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test(r){return r<this.resolve(e)}})}moreThan(e,t=Cc.moreThan){return this.test({message:t,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test(r){return r>this.resolve(e)}})}positive(e=Cc.positive){return this.moreThan(0,e)}negative(e=Cc.negative){return this.lessThan(0,e)}integer(e=Cc.integer){return this.test({name:"integer",message:e,skipAbsent:!0,test:t=>Number.isInteger(t)})}truncate(){return this.transform(e=>ba(e)?e:e|0)}round(e){var t;let r=["ceil","floor","round","trunc"];if(e=((t=e)==null?void 0:t.toLowerCase())||"round",e==="trunc")return this.truncate();if(r.indexOf(e.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+r.join(", "));return this.transform(s=>ba(s)?s:Math[e](s))}}rs.prototype=w3.prototype;let jQ=new Date(""),NQ=n=>Object.prototype.toString.call(n)==="[object Date]";class TC extends Bs{constructor(){super({type:"date",check(e){return NQ(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t)=>!this.spec.coerce||this.isType(e)||e===null?e:(e=hQ(e),isNaN(e)?TC.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let r;if(Kc.isRef(e))r=e;else{let s=this.cast(e);if(!this._typeCheck(s))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);r=s}return r}min(e,t=NN.min){let r=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s>=this.resolve(r)}})}max(e,t=NN.max){let r=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(s){return s<=this.resolve(r)}})}}TC.INVALID_DATE=jQ;function CQ(n,e=[]){let t=[],r=new Set,s=new Set(e.map(([o,l])=>`${o}-${l}`));function a(o,l){let c=ru.split(o)[0];r.add(c),s.has(`${l}-${c}`)||t.push([l,c])}for(const o of Object.keys(n)){let l=n[o];r.add(o),Kc.isRef(l)&&l.isSibling?a(l.path,o):Qx(l)&&"deps"in l&&l.deps.forEach(c=>a(c,o))}return XJ.array(Array.from(r),t).reverse()}function Bk(n,e){let t=1/0;return n.some((r,s)=>{var a;if((a=e.path)!=null&&a.includes(r))return t=s,!0}),t}function S3(n){return(e,t)=>Bk(n,e)-Bk(n,t)}const j3=(n,e,t)=>{if(typeof n!="string")return n;let r=n;try{r=JSON.parse(n)}catch{}return t.isType(r)?r:n};function Jg(n){if("fields"in n){const e={};for(const[t,r]of Object.entries(n.fields))e[t]=Jg(r);return n.setFields(e)}if(n.type==="array"){const e=n.optional();return e.innerType&&(e.innerType=Jg(e.innerType)),e}return n.type==="tuple"?n.optional().clone({types:n.spec.types.map(Jg)}):"optional"in n?n.optional():n}const TQ=(n,e)=>{const t=[...ru.normalizePath(e)];if(t.length===1)return t[0]in n;let r=t.pop(),s=ru.getter(ru.join(t),!0)(n);return!!(s&&r in s)};let Wk=n=>Object.prototype.toString.call(n)==="[object Object]";function $k(n,e){let t=Object.keys(n.fields);return Object.keys(e).filter(r=>t.indexOf(r)===-1)}const PQ=S3([]);function wt(n){return new N3(n)}class N3 extends Bs{constructor(e){super({type:"object",check(t){return Wk(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=PQ,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var r;let s=super._cast(e,t);if(s===void 0)return this.getDefault(t);if(!this._typeCheck(s))return s;let a=this.fields,o=(r=t.stripUnknown)!=null?r:this.spec.noUnknown,l=[].concat(this._nodes,Object.keys(s).filter(p=>!this._nodes.includes(p))),c={},d=Object.assign({},t,{parent:c,__validating:t.__validating||!1}),m=!1;for(const p of l){let x=a[p],v=p in s,_=s[p];if(x){let w;d.path=(t.path?`${t.path}.`:"")+p,x=x.resolve({value:_,context:t.context,parent:c});let j=x instanceof Bs?x.spec:void 0,P=j?.strict;if(j!=null&&j.strip){m=m||p in s;continue}w=!t.__validating||!P?x.cast(_,d):_,w!==void 0&&(c[p]=w)}else v&&!o&&(c[p]=_);(v!==p in c||c[p]!==_)&&(m=!0)}return m?c:s}_validate(e,t={},r,s){let{from:a=[],originalValue:o=e,recursive:l=this.spec.recursive}=t;t.from=[{schema:this,value:o},...a],t.__validating=!0,t.originalValue=o,super._validate(e,t,r,(c,d)=>{if(!l||!Wk(d)){s(c,d);return}o=o||d;let m=[];for(let p of this._nodes){let x=this.fields[p];!x||Kc.isRef(x)||m.push(x.asNestedTest({options:t,key:p,parent:d,parentPath:t.path,originalParent:o}))}this.runTests({tests:m,value:d,originalValue:o,options:t},r,p=>{s(p.sort(this._sortErrors).concat(c),d)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),r=t.fields;for(let[s,a]of Object.entries(this.fields)){const o=r[s];r[s]=o===void 0?a:o}return t.withMutation(s=>s.setFields(r,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(r=>{var s;const a=this.fields[r];let o=e;(s=o)!=null&&s.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[r]})),t[r]=a&&"getDefault"in a?a.getDefault(o):void 0}),t}setFields(e,t){let r=this.clone();return r.fields=e,r._nodes=CQ(e,t),r._sortErrors=S3(Object.keys(e)),t&&(r._excludedEdges=t),r}shape(e,t=[]){return this.clone().withMutation(r=>{let s=r._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),s=[...r._excludedEdges,...t]),r.setFields(Object.assign(r.fields,e),s)})}partial(){const e={};for(const[t,r]of Object.entries(this.fields))e[t]="optional"in r&&r.optional instanceof Function?r.optional():r;return this.setFields(e)}deepPartial(){return Jg(this)}pick(e){const t={};for(const r of e)this.fields[r]&&(t[r]=this.fields[r]);return this.setFields(t,this._excludedEdges.filter(([r,s])=>e.includes(r)&&e.includes(s)))}omit(e){const t=[];for(const r of Object.keys(this.fields))e.includes(r)||t.push(r);return this.pick(t)}from(e,t,r){let s=ru.getter(e,!0);return this.transform(a=>{if(!a)return a;let o=a;return TQ(a,e)&&(o=Object.assign({},a),r||delete o[e],o[t]=s(a)),o})}json(){return this.transform(j3)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||Zg.exact,test(t){if(t==null)return!0;const r=$k(this.schema,t);return r.length===0||this.createError({params:{properties:r.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=Zg.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let r=this.test({name:"noUnknown",exclusive:!0,message:t,test(s){if(s==null)return!0;const a=$k(this.schema,s);return!e||a.length===0||this.createError({params:{unknown:a.join(", ")}})}});return r.spec.noUnknown=e,r}unknown(e=!0,t=Zg.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const r={};for(const s of Object.keys(t))r[e(s)]=t[s];return r})}camelCase(){return this.transformKeys(u0.camelCase)}snakeCase(){return this.transformKeys(u0.snakeCase)}constantCase(){return this.transformKeys(e=>u0.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);r.fields={};for(const[a,o]of Object.entries(t.fields)){var s;let l=e;(s=l)!=null&&s.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[a]})),r.fields[a]=o.describe(l)}return r}}wt.prototype=N3.prototype;function xs(n){return new C3(n)}class C3 extends Bs{constructor(e){super({type:"array",spec:{types:e},check(t){return Array.isArray(t)}}),this.innerType=void 0,this.innerType=e}_cast(e,t){const r=super._cast(e,t);if(!this._typeCheck(r)||!this.innerType)return r;let s=!1;const a=r.map((o,l)=>{const c=this.innerType.cast(o,Object.assign({},t,{path:`${t.path||""}[${l}]`,parent:r,originalValue:o,value:o,index:l}));return c!==o&&(s=!0),c});return s?a:r}_validate(e,t={},r,s){var a;let o=this.innerType,l=(a=t.recursive)!=null?a:this.spec.recursive;t.originalValue!=null&&t.originalValue,super._validate(e,t,r,(c,d)=>{var m;if(!l||!o||!this._typeCheck(d)){s(c,d);return}let p=new Array(d.length);for(let v=0;v<d.length;v++){var x;p[v]=o.asNestedTest({options:t,index:v,parent:d,parentPath:t.path,originalParent:(x=t.originalValue)!=null?x:e})}this.runTests({value:d,tests:p,originalValue:(m=t.originalValue)!=null?m:e,options:t},r,v=>s(v.concat(c),d))})}clone(e){const t=super.clone(e);return t.innerType=this.innerType,t}json(){return this.transform(j3)}concat(e){let t=super.concat(e);return t.innerType=this.innerType,e.innerType&&(t.innerType=t.innerType?t.innerType.concat(e.innerType):e.innerType),t}of(e){let t=this.clone();if(!Qx(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+yl(e));return t.innerType=e,t.spec=Object.assign({},t.spec,{types:e}),t}length(e,t=Kg.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t){return t=t||Kg.min,this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t){return t=t||Kg.max,this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}ensure(){return this.default(()=>[]).transform((e,t)=>this._typeCheck(e)?e:t==null?[]:[].concat(t))}compact(e){let t=e?(r,s,a)=>!e(r,s,a):r=>!!r;return this.transform(r=>r!=null?r.filter(t):r)}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);if(t.innerType){var s;let a=e;(s=a)!=null&&s.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[0]})),r.innerType=t.innerType.describe(a)}return r}}xs.prototype=C3.prototype;const Me=({label:n,id:e,error:t,registration:r,...s})=>{const{className:a,...o}=s,d=`form-input ${t?"form-input--error":""} ${a||""}`,m=i.jsx("input",{id:e,className:d,"aria-invalid":!!t,...r,...o});return i.jsxs("div",{children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsx("div",{className:n?"mt-1":"",children:m}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},Cn=E.forwardRef(({id:n,label:e,description:t,className:r,labelClassName:s,inputClassName:a,...o},l)=>{const c=n||o.name;return i.jsxs("div",{className:`relative flex items-start ${r}`,children:[i.jsx("div",{className:"flex h-6 items-center",children:i.jsx("input",{id:c,"aria-describedby":t?`${c}-description`:void 0,type:"checkbox",ref:l,className:`h-4 w-4 rounded border-gray-300 text-accent focus:ring-accent cursor-pointer ${a||""}`,...o})}),i.jsxs("div",{className:"ml-3 text-sm leading-6",children:[i.jsx("label",{htmlFor:c,className:`font-medium text-primary-text cursor-pointer ${s}`,children:e}),t&&i.jsx("p",{id:`${c}-description`,className:"text-muted",children:t})]})]})});Cn.displayName="Checkbox";function MQ(){const[n,e]=E.useState(null),[t,r]=E.useState(!1),[s,a]=E.useState(null);return E.useEffect(()=>{const l=(()=>{const p=navigator.userAgent,x=`${window.screen.width}x${window.screen.height}`,v=Intl.DateTimeFormat().resolvedOptions().timeZone,_=navigator.language,w=navigator.platform,j=navigator.hardwareConcurrency||0,P=`${p}|${x}|${v}|${_}|${w}|${j}`;let k=0;for(let O=0;O<P.length;O++){const q=P.charCodeAt(O);k=(k<<5)-k+q,k=k&k}const I="dev_"+Math.abs(k).toString(36),M=()=>p.indexOf("Chrome")>-1?"Chrome":p.indexOf("Firefox")>-1?"Firefox":p.indexOf("Safari")>-1?"Safari":p.indexOf("Edge")>-1?"Edge":"Unknown",D=()=>p.indexOf("Win")>-1?"Windows":p.indexOf("Mac")>-1?"MacOS":p.indexOf("Linux")>-1?"Linux":p.indexOf("Android")>-1?"Android":p.indexOf("iOS")>-1?"iOS":"Unknown";return{deviceId:I,deviceName:`${D()} - ${M()}`,browser:M(),os:D(),timestamp:new Date().toISOString()}})();e(l);const c=localStorage.getItem("device_id"),d=localStorage.getItem("device_name"),m=localStorage.getItem("device_timestamp");c&&c!==l.deviceId&&(r(!0),a({deviceId:c,deviceName:d||"Unknown Device",browser:"",os:"",timestamp:m||new Date().toISOString()})),localStorage.setItem("device_id",l.deviceId),localStorage.setItem("device_name",l.deviceName),localStorage.setItem("device_timestamp",l.timestamp)},[]),{deviceInfo:n,isNewDevice:t,previousDevice:s}}const kQ=wt({email:be().email("Must be a valid email").required("Email is required"),password:be().required("Password is required"),rememberMe:ns().optional()}).defined(),EQ=n=>n.role==="unverified"?"/pending-approval":"/profile",DQ=()=>{const{user:n,loginWithEmail:e,loginWithGoogle:t,error:r,setError:s,loading:a,setLoginAnimationPending:o,isLoginAnimationPending:l}=St(),c=yn(),d=bs(),{deviceInfo:m,isNewDevice:p,previousDevice:x}=MQ(),[v,_]=E.useState(!1),[w,j]=E.useState(!1);E.useEffect(()=>{s(null);const F=new URLSearchParams(d.hash.substring(1)),U=F.get("error_code"),B=F.get("error_description");U==="otp_expired"&&B&&(s("Email confirmation link has expired or is invalid. Please try signing up again or request a new confirmation email."),c("/auth/login",{replace:!0}))},[s,d,c]),E.useEffect(()=>{n&&p&&x&&!v&&(pe.sendDeviceChangeAlert(n.id,n.name,x.deviceName,m?.deviceName||"Unknown Device").catch(F=>console.error("Failed to send device change alert:",F)),_(!0))},[n,p,x,v,m]),E.useEffect(()=>{n&&!l&&c(EQ(n),{replace:!0})},[n,c,l]);const{register:P,handleSubmit:k,setValue:I,formState:{errors:M}}=Zt({resolver:_n(kQ)});E.useEffect(()=>{const F=localStorage.getItem("rememberedEmail");F&&(I("email",F),I("rememberMe",!0)),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&I("rememberMe",!0)},[I]);const D=async F=>{o(!0);const B=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:F.rememberMe||!1;(await e(F.email,F.password,B)).error?o(!1):(j(!0),setTimeout(()=>{o(!1)},1500))},O=async()=>{await t()},q=a||w;return i.jsxs(i.Fragment,{children:[i.jsxs("form",{onSubmit:k(D),className:"space-y-3",children:[i.jsxs("fieldset",{disabled:q,className:"space-y-3",children:[i.jsxs("div",{className:"relative group",children:[i.jsx(yu,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),i.jsx(Me,{id:"email",type:"email",autoComplete:"email",placeholder:"Email",registration:P("email"),error:M.email?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),i.jsxs("div",{className:"relative group",children:[i.jsx(gN,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),i.jsx(Me,{id:"password",type:"password",autoComplete:"current-password",placeholder:"Password",registration:P("password"),error:M.password?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-center justify-between gap-3",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(Cn,{id:"rememberMe",label:"Remember me",labelClassName:"text-white font-medium",...P("rememberMe"),inputClassName:"text-[#22c55e] border-white/20 rounded bg-black/40 focus:ring-[#22c55e]"})}),i.jsx(ja,{to:"/auth/forgot-password",className:`text-sm font-medium !text-white hover:text-gray-200 transition-colors auth-link ${q?"pointer-events-none opacity-50":""}`,"aria-disabled":q,onClick:F=>{q&&F.preventDefault()},children:"Forgot your password?"})]})]}),i.jsx("div",{className:"min-h-[24px] flex items-center justify-center",children:r&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-400 text-center p-2 bg-red-500/10 rounded-lg border border-red-500/20",children:[i.jsx(Ca,{className:"h-4 w-4 flex-shrink-0"}),i.jsx("span",{children:r})]})}),i.jsx(ae,{type:"submit",className:`w-full !font-bold !py-3 !rounded-full shadow-lg transition-all transform hover:scale-[1.02] signin-btn ${w?"!bg-[#22c55e] !border-[#22c55e] !text-white hover:!bg-[#22c55e]":"!bg-transparent border border-[#22c55e] !text-[#22c55e] hover:!bg-[#22c55e] hover:!text-white shadow-green-500/20"}`,isLoading:a&&!w,size:"lg",disabled:q&&!w,children:w?i.jsx(xl,{className:"w-6 h-6 animate-bounce"}):"Sign In"})]}),i.jsxs("div",{className:"flex items-center my-6",children:[i.jsx("div",{className:"flex-1 border-t border-white/10"}),i.jsx("span",{className:"px-4 text-sm text-gray-400 font-medium",children:"OR"}),i.jsx("div",{className:"flex-1 border-t border-white/10"})]}),i.jsxs("button",{type:"button",onClick:O,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 hover:bg-gray-100 font-bold py-3 rounded-full transition-all transform hover:scale-[1.02] shadow-lg google-btn",disabled:q,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 48 48",children:[i.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),i.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),i.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.519-3.487-11.181-8.264l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),i.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C39.99,35.508,44,30.021,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),"Sign in with Google"]}),i.jsx("div",{className:"text-center mt-4",children:i.jsxs("p",{className:"text-sm text-gray-300",children:["Don't have an account?"," ",i.jsx(ja,{to:"/auth/signup",className:"font-medium !text-white hover:text-gray-200 auth-link",children:"Sign Up"})]})})]})},OQ=wt({name:be().required("Your name is required"),email:be().email("Must be a valid email").required("Email is required"),password:be().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:be().oneOf([CC("password")],"Passwords must match").required("Please confirm your password")}).defined(),IQ=()=>{const{signUp:n}=St(),[e,t]=E.useState(""),[r,s]=E.useState(!1),{register:a,handleSubmit:o,formState:{errors:l,isSubmitting:c}}=Zt({resolver:_n(OQ)}),d=async m=>{t("");const{error:p}=await n(m.name,m.email,m.password);p?t(p.message):s(!0)};return r?i.jsxs("div",{className:"text-center",children:[i.jsx(RF,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Confirm your email"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"We've sent a confirmation link to your email address. Please click the link to activate your account."}),i.jsx("div",{className:"mt-6",children:i.jsx(ja,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",children:" Back to Login"})})]}):i.jsxs("form",{onSubmit:o(d),className:"space-y-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Sl,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(Me,{id:"name",type:"text",placeholder:"Full Name",registration:a("name"),error:l.name?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(yu,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(Me,{id:"email",type:"email",placeholder:"Email Address",registration:a("email"),error:l.email?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(gN,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(Me,{id:"password",type:"password",placeholder:"Password",registration:a("password"),error:l.password?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(gN,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(Me,{id:"confirmPassword",type:"password",placeholder:"Confirm Password",registration:a("confirmPassword"),error:l.confirmPassword?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),e&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),i.jsx("div",{className:"pt-2",children:i.jsx(ae,{type:"submit",className:"w-full",isLoading:c,size:"lg",children:"Sign Up"})}),i.jsx("div",{className:"text-center pt-2",children:i.jsx(ja,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",children:"Already have an account? Sign In"})})]})},AQ=wt({email:be().email("Must be a valid email").required("Email is required")}).defined(),RQ=()=>{const{sendPasswordReset:n}=St(),[e,t]=E.useState(""),[r,s]=E.useState(!1),a=yn();E.useEffect(()=>{if(r){const p=setTimeout(()=>{a("/auth/login",{replace:!0})},3e3);return()=>clearTimeout(p)}},[r,a]);const{register:o,handleSubmit:l,formState:{errors:c,isSubmitting:d}}=Zt({resolver:_n(AQ)}),m=async p=>{t("");const{error:x}=await n(p.email);x&&x.message.includes("rate limit")?t("Too many attempts. Please wait a few minutes before trying again."):s(!0)};return r?i.jsxs("div",{className:"text-center",children:[i.jsx(RF,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Check your email"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"If an account exists for the email you provided, we've sent password reset instructions. Redirecting to login..."})]}):i.jsx(i.Fragment,{children:i.jsxs("form",{onSubmit:l(m),className:"space-y-6",children:[i.jsxs("div",{className:"relative group",children:[i.jsx(yu,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none z-10"}),i.jsx(Me,{id:"email",type:"email",autoComplete:"email",placeholder:"Email Address",registration:o("email"),error:c.email?.message,className:"!pl-12 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-400 focus:!border-[#22c55e] !py-3 !rounded-xl transition-all"})]}),e&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),i.jsx("div",{children:i.jsx(ae,{type:"submit",className:"w-full",isLoading:d,size:"lg",children:"Send Reset Link"})}),i.jsx("div",{className:"text-center",children:i.jsx(ja,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",children:" Back to Login"})})]})})},LQ=wt({password:be().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:be().oneOf([CC("password")],"Passwords must match").required("Please confirm your password")}).defined(),FQ=n=>{const e=n.toLowerCase();return e.includes("weak password")?"Password is too weak. Please use at least 6 characters.":e.includes("requires a recent login")?"For your security, please sign in again to continue.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again.")},qQ=()=>{const[n,e]=E.useState(""),[t,r]=E.useState(!1),s=yn(),{user:a,logout:o}=St();E.useEffect(()=>{a||e("Invalid or expired password reset session. Please request a new password reset link.")},[a]);const{register:l,handleSubmit:c,formState:{errors:d,isSubmitting:m}}=Zt({resolver:_n(LQ)}),p=async x=>{e("");const{error:v}=await xa.updateUserPassword(x.password);v?e(FQ(v.message)):(r(!0),await o(),setTimeout(()=>s("/auth/login",{replace:!0}),2e3))};return t?i.jsxs("div",{className:"text-center",children:[i.jsx(Bi,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Password Updated!"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"Your password has been changed successfully. You will be redirected to the login page shortly."}),i.jsx("div",{className:"mt-6",children:i.jsx(ja,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",children:" Back to Login Now"})})]}):n&&!a?i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-3xl font-bold text-white",children:"Link Expired"}),i.jsx("p",{className:"text-sm text-gray-300 mt-1",children:"This password reset link is no longer valid."}),i.jsxs("div",{className:"mt-6 flex flex-col gap-4",children:[i.jsx(ja,{to:"/auth/forgot-password",className:"font-medium text-white/80 hover:text-white",children:"Request a new link"}),i.jsx("div",{className:"auth-separator",children:"OR"}),i.jsx(ae,{onClick:()=>s("/auth/login"),className:"w-full",size:"lg",children:"Back to Sign In"})]})]}):i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm text-center text-gray-300 -mt-6 mb-6",children:["for ",i.jsx("span",{className:"font-semibold text-white",children:a?.email}),"."]}),i.jsxs("form",{onSubmit:c(p),className:"space-y-6",children:[i.jsx(Me,{id:"password",type:"password",placeholder:"New Password",autoComplete:"new-password",registration:l("password"),error:d.password?.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),i.jsx(Me,{id:"confirmPassword",type:"password",placeholder:"Confirm New Password",autoComplete:"new-password",registration:l("confirmPassword"),error:d.confirmPassword?.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),n&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:n}),i.jsx("div",{children:i.jsx(ae,{type:"submit",className:"w-full",isLoading:m,size:"lg",disabled:!a,children:"Update Password"})})]})]})},zQ=()=>{const{logout:n,user:e}=St(),t=yn(),r=async()=>{await n(),t("/auth/login",{replace:!0})};return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:i.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[i.jsx(Wi,{className:"h-10 mx-auto mb-6"}),i.jsx(QK,{className:"h-16 w-16 text-accent mx-auto mb-4"}),i.jsx("h2",{className:"text-2xl font-bold text-primary-text mb-2",children:"Account Pending Approval"}),i.jsxs("p",{className:"text-muted mb-6",children:["Welcome, ",e?.name||"user","! Your account has been created successfully and is pending approval. An administrator will review your details and perform a security check before activating your account."]}),i.jsx("div",{className:"flex justify-center",children:i.jsxs(ae,{onClick:r,variant:"secondary",children:[i.jsx(kc,{className:"mr-2 h-4 w-4"}),"Log Out"]})})]})})},UQ=()=>{const n=yn();return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:i.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx(zF,{className:"h-16 w-16 text-red-500"})}),i.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Access Denied"}),i.jsx("p",{className:"text-muted mb-6",children:"You do not have the necessary permissions to view this page. If you believe this is an error, please contact your administrator."}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx(ae,{onClick:()=>n(-1),variant:"secondary",children:"Go Back"}),i.jsx(ae,{onClick:async()=>{await St.getState().logout(),n("/auth/login")},children:"Login"})]})]})})},VQ=()=>{const n=yn(),{data:e,reset:t}=Wn(),{user:r}=St(),s=e.personal.firstName||e.personal.lastName,a=Jt("(max-width: 767px)"),o=()=>{t(),n("/onboarding/select-organization")},l=()=>{n("/onboarding/add/personal")};return a?i.jsx("div",{className:"flex flex-col items-center justify-center text-center relative min-h-[70vh]",children:i.jsxs("div",{className:"p-8 max-w-sm w-full bg-transparent",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"p-4 rounded-full bg-black/20",children:i.jsx(pN,{className:"h-10 w-10 text-emerald-400"})})}),i.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to Employee Onboarding"}),i.jsx("p",{className:"text-gray-400 text-sm mb-8",children:"We need to collect some information to get you set up. This should only take a few minutes."}),i.jsxs("div",{className:"flex flex-col gap-3",children:[s&&i.jsx(ae,{onClick:l,variant:"secondary",className:"w-full !py-3",children:"Continue Previous Application"}),i.jsx(ae,{onClick:o,variant:"primary",className:"w-full !py-3 !text-lg",children:"Start New Application"})]})]})}):i.jsx("div",{className:"h-full flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-card p-8 sm:p-12 rounded-2xl shadow-card text-center w-full",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"bg-accent-light p-4 rounded-full",children:i.jsx(pN,{className:"h-12 w-12 text-accent-dark"})})}),i.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Welcome to Employee Onboarding"}),i.jsx("p",{className:"text-muted mb-8 max-w-md mx-auto",children:"We need to collect some information to get you set up. This should only take a few minutes."}),i.jsxs("div",{className:"mt-10 flex justify-center items-center gap-4 flex-wrap",children:[s&&i.jsx(ae,{onClick:l,variant:"secondary",children:"Continue Draft"}),i.jsx(ae,{onClick:o,variant:"primary",children:s?"Start Fresh":"Start New Application"})]})]})})},Qe=({label:n,id:e,error:t,registration:r,children:s,...a})=>{const{className:o,...l}=a,m=`form-input ${t?"form-input--error":""} ${o||""}`,p=i.jsx("select",{id:e,className:m,"aria-invalid":!!t,...r,...l,children:s});return i.jsxs("div",{children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsx("div",{className:n?"mt-1":"",children:p}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},BQ=()=>{const n=yn(),{updateOrganization:e,updatePersonal:t}=Wn(),{enforceManpowerLimit:r,manpowerLimitRule:s}=Zc(),{user:a}=St(),[o,l]=E.useState(!0),[c,d]=E.useState([]),[m,p]=E.useState([]),[x,v]=E.useState([]),[_,w]=E.useState(""),[j,P]=E.useState(""),[k,I]=E.useState(""),[M,D]=E.useState(""),[O,q]=E.useState([]),[F,U]=E.useState(window.innerWidth<768);E.useEffect(()=>{const H=()=>U(window.innerWidth<768);return window.addEventListener("resize",H),()=>window.removeEventListener("resize",H)},[]);const[B,G]=E.useState({isOverLimit:!1,message:""}),X=a?.role==="field_officer"&&F;E.useEffect(()=>{(async()=>{l(!0);try{const[se,W,ee]=await Promise.all([pe.getOrganizationStructure(),pe.getOrganizations(),pe.getSiteStaffDesignations()]);d(se),p(W),v(ee)}catch(se){console.error("Failed to fetch organization structure",se)}finally{l(!1)}})()},[]);const Q=E.useMemo(()=>c.find(H=>H.id===_),[c,_]),Y=E.useMemo(()=>Q?.companies||[],[Q]),ne=E.useMemo(()=>Y.find(H=>H.id===j),[Y,j]),te=E.useMemo(()=>ne?.entities||[],[ne]);E.useEffect(()=>{D("");const H=te.find(se=>se.id===k);q(H?x:[])},[k,te,x]),E.useEffect(()=>{(async()=>{if(G({isOverLimit:!1,message:""}),!k||!r)return;const W=te.find(oe=>oe.id===k)?.organizationId;if(!W)return;const K=m.find(oe=>oe.id===W)?.manpowerApprovedCount;if(K==null){G({isOverLimit:!1,message:"Manpower limit not set for this site."});return}try{const re=(await pe.getVerificationSubmissions()).filter(me=>me.organizationId===W&&(me.status==="verified"||me.status==="pending")).length;if(re>=K){const me=`Manpower limit of ${K} reached (${re} deployed).`;G({isOverLimit:!0,message:me})}else{const me=`Manpower: ${re} / ${K} deployed.`;G({isOverLimit:!1,message:me})}}catch{G({isOverLimit:!1,message:"Could not verify manpower count."})}})()},[k,m,te,r]);const ie=()=>{const H=te.find(se=>se.id===k);if(H?.organizationId){const se=m.find(ee=>ee.id===H.organizationId),W=x.find(ee=>ee.designation===M);se&&W?(e({organizationId:se.id,organizationName:se.shortName,joiningDate:Ue(new Date,"yyyy-MM-dd"),workType:"Full-time",designation:M,department:W.department,defaultSalary:W.monthlySalary||null}),t({salary:W.monthlySalary||null}),n("/onboarding/pre-upload")):console.error("Organization or Designation details not found.")}};if(o)return i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})});const $=!k||!M||B.isOverLimit&&s==="block";return X?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header",children:[i.jsx("button",{onClick:()=>n("/onboarding"),"aria-label":"Go back",children:i.jsx(Hi,{className:"h-6 w-6"})}),i.jsx("h1",{children:"New Enrollment"})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Uc,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Select Site"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Choose the client and site for the new employee."})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("select",{value:_,onChange:H=>{w(H.target.value),P(""),I("")},className:"fo-select fo-select-arrow",children:[i.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]}),i.jsxs("select",{value:j,onChange:H=>{P(H.target.value),I("")},disabled:!_,className:"fo-select fo-select-arrow",children:[i.jsx("option",{value:"",children:"-- Select a Company --"}),Y.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]}),i.jsxs("select",{value:k,onChange:H=>I(H.target.value),disabled:!j,className:"fo-select fo-select-arrow",children:[i.jsx("option",{value:"",children:"-- Select a Client/Site --"}),te.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]}),i.jsxs("select",{value:M,onChange:H=>D(H.target.value),disabled:!k,className:"fo-select fo-select-arrow",children:[i.jsx("option",{value:"",children:"-- Select a Designation --"}),O.map(H=>i.jsx("option",{value:H.designation,children:H.designation},H.id))]}),B.message&&i.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${B.isOverLimit?"bg-red-900/50 text-red-300 border border-red-500/50":"bg-green-900/50 text-green-300 border border-green-500/50"}`,children:B.message})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center justify-between gap-4",children:[i.jsx("button",{onClick:()=>n("/onboarding"),className:"fo-btn-secondary px-6",children:"Back"}),i.jsx("button",{onClick:ie,disabled:$,className:"fo-btn-primary flex-1",children:"Continue"})]})]}):i.jsx("div",{className:"p-4 md:p-0",children:i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Uc,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Select Site"}),i.jsx("p",{className:"text-muted",children:"Choose the client and site for the new employee."})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs(Qe,{label:"Company Group",id:"group",value:_,onChange:H=>{w(H.target.value),P(""),I("")},children:[i.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]}),i.jsxs(Qe,{label:"Company",id:"company",value:j,onChange:H=>{P(H.target.value),I("")},disabled:!_,children:[i.jsx("option",{value:"",children:"-- Select a Company --"}),Y.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]}),i.jsxs(Qe,{label:"Client / Site",id:"entity",value:k,onChange:H=>I(H.target.value),disabled:!j,children:[i.jsx("option",{value:"",children:"-- Select a Client/Site --"}),te.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]}),i.jsxs(Qe,{label:"Designation",id:"designation",value:M,onChange:H=>D(H.target.value),disabled:!k,children:[i.jsx("option",{value:"",children:"-- Select a Designation --"}),O.map(H=>i.jsx("option",{value:H.designation,children:H.designation},H.id))]})]}),B.message&&i.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${B.isOverLimit?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:B.message}),i.jsx("div",{className:"mt-8 pt-6 border-t flex justify-end",children:i.jsxs(ae,{onClick:ie,disabled:$,children:["Continue ",i.jsx(jK,{className:"ml-2 h-4 w-4"})]})})]})})},Hk=({steps:n,currentStepIndex:e,onStepClick:t,highestStepReached:r,isMobileOptimized:s=!1})=>{const[a,o]=E.useState(0),l=4,c=Math.ceil(n.length/l);E.useEffect(()=>{if(s){const x=Math.floor(e/l);o(x)}},[e,s,l]);const d=()=>{o(x=>Math.min(x+1,c-1))},m=()=>{o(x=>Math.max(x-1,0))},p=E.useMemo(()=>{if(!s)return[];const x=a*l,v=x+l;return Array.from({length:n.length},(_,w)=>w).slice(x,v)},[a,l,n.length,s]);if(!s){const x=e>0?e/(n.length-1)*100:0,_=100/n.length/2;return i.jsx("nav",{"aria-label":"Onboarding Progress",className:"py-4",children:i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"absolute top-4 h-1",style:{left:`${_}%`,right:`${_}%`},children:[i.jsx("div",{className:"w-full h-full bg-border rounded-full"}),i.jsx("div",{className:"absolute top-0 left-0 h-full bg-accent rounded-full transition-all duration-500 ease-in-out",style:{width:`${x}%`}})]}),i.jsx("ol",{role:"list",className:"relative flex items-center",children:n.map((w,j)=>{const P=j<e,k=j===e,I=j<=r;return i.jsx("li",{className:"flex-1",children:i.jsxs("div",{className:"relative flex flex-col items-center group",children:[i.jsx("button",{type:"button",onClick:()=>I&&t(j),disabled:!I,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-accent-dark rounded-full disabled:cursor-not-allowed","aria-current":k?"step":void 0,title:w.label,children:i.jsx("div",{className:`relative flex items-center justify-center w-9 h-9 rounded-full transition-all duration-300 border-2 z-10 ${P?"bg-accent border-accent text-white":""} ${k?"bg-card border-accent text-accent scale-110":""} ${!P&&!k?"bg-card border-border text-muted":""} ${I?"group-hover:border-accent-dark":""}`,children:P?i.jsx(xl,{className:"w-5 h-5"}):at.createElement(w.icon,{className:"w-5 h-5"})})}),i.jsx("span",{className:`hidden sm:block absolute top-12 w-24 text-center text-xs transition-colors duration-300 ${k?"text-accent font-bold":"text-muted"} ${I?"group-hover:text-primary-text":""}`,children:w.label})]})},w.key)})})]})})}return i.jsxs("nav",{"aria-label":"Onboarding Progress",className:"bg-card rounded-2xl mx-4 my-2 p-2 flex items-center gap-1",children:[i.jsx("button",{type:"button",onClick:m,disabled:a===0,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Previous steps",children:i.jsx(Wx,{className:"h-6 w-6"})}),i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx("ol",{role:"list",className:"flex items-center justify-around",children:p.map(x=>{const v=n[x],_=x<e,w=x===e,j=x<=r;return i.jsx("li",{className:"flex-shrink-0",children:i.jsx("div",{className:"relative flex flex-col items-center group",children:i.jsx("button",{type:"button",onClick:()=>j&&t(x),disabled:!j,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#0f1f0f] focus-visible:ring-emerald-400 rounded-full disabled:cursor-not-allowed","aria-current":w?"step":void 0,title:v.label,children:i.jsx("div",{className:`relative flex items-center justify-center w-10 h-10 rounded-full transition-all duration-300 border-2 z-10
                      ${_?"bg-green-600 border-green-600 text-white":""}
                      ${w?"bg-transparent border-green-500 text-white scale-110":""}
                      ${!_&&!w?`bg-transparent ${j?"border-gray-500 text-gray-400 group-hover:border-emerald-400":"border-gray-700 text-gray-600 opacity-50"}`:""}`,children:_?i.jsx(xl,{className:"w-6 h-6 text-white"}):at.createElement(v.icon,{className:"w-6 h-6"})})})})},v.key)})})}),i.jsx("button",{type:"button",onClick:d,disabled:a>=c-1,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Next steps",children:i.jsx(Tf,{className:"h-6 w-6"})})]})},Gt=({message:n,type:e,onDismiss:t})=>{E.useEffect(()=>{const a=setTimeout(()=>{t()},5e3);return()=>{clearTimeout(a)}},[t]);const r=e==="success"?"bg-green-500":"bg-red-500",s=e==="success"?Bi:am;return i.jsxs("div",{className:`fixed top-5 right-5 z-50 flex items-center p-4 rounded-lg text-white shadow-lg ${r}`,children:[i.jsx(s,{className:"h-6 w-6 mr-3"}),i.jsx("span",{className:"text-sm font-medium",children:n}),i.jsx("button",{onClick:t,className:"ml-4 -mr-2 p-1.5 rounded-md hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white",children:i.jsx(Ui,{className:"h-5 w-5"})})]})},T3=[{key:"personal",label:"Personal",icon:Sl},{key:"address",label:"Address",icon:wl},{key:"organization",label:"Organization",icon:Uc},{key:"family",label:"Family",icon:mi},{key:"education",label:"Education",icon:OF},{key:"bank",label:"Bank",icon:_l},{key:"uan",label:"UAN/PF",icon:NK},{key:"esi",label:"ESI",icon:lJ},{key:"gmc",label:"GMC",icon:fC},{key:"uniform",label:"Uniform",icon:Hx},{key:"documents",label:"Documents",icon:GK},{key:"biometrics",label:"Biometrics",icon:DF},{key:"review",label:"Review",icon:WK}],Ri=T3.map(n=>n.key),WQ=()=>{const n=yn(),e=bs(),{data:t,reset:r,setData:s}=Wn(),{user:a}=St(),{salaryThreshold:o}=Zc(),[l,c]=E.useState(!1),[d,m]=E.useState(!0),[p,x]=E.useState(null),[v]=$L(),[_,w]=E.useState(!1),[j,P]=E.useState("idle"),k=E.useRef(null),I=Jt("(max-width: 767px)"),M=E.useRef(null),D=e.pathname.split("/").pop(),O=E.useMemo(()=>Ri.indexOf(D),[D]),[q,F]=E.useState(0);E.useEffect(()=>{const $=t.personal.firstName==="Ravi"&&t.status==="draft";if(t.status!=="draft"||$){F(Ri.length-1);return}const H=sessionStorage.getItem(`onboarding_progress_${t.id}`),se=H?parseInt(H,10):0,W=Math.max(se,O);F(W),O>se&&sessionStorage.setItem(`onboarding_progress_${t.id}`,String(O))},[t,O]);const U=E.useMemo(()=>T3.map(($,H)=>({...$,status:H<O?"complete":H===O?"current":"upcoming"})),[O]);E.useEffect(()=>{const $=v.get("id");$?(async se=>{m(!0);try{const W=await pe.getOnboardingDataById(se);W?(s(W),P("saved")):(x({message:"Could not find submission data.",type:"error"}),r())}catch(W){console.error("Failed to fetch submission data",W),x({message:"Failed to load submission data.",type:"error"}),r()}finally{m(!1)}})($):m(!1)},[v,s,r]);const B=E.useCallback(async()=>{P("saving");try{const{draftId:$}=await pe.saveDraft(t);$!==t.id&&s({...t,id:$}),P("saved")}catch{x({message:"Auto-save failed. Check your connection.",type:"error"}),P("dirty")}},[t,s]);E.useEffect(()=>((!t.id||t.id.startsWith("draft_")||t.status==="draft")&&!d&&(j!=="saving"&&P("dirty"),k.current&&clearTimeout(k.current),k.current=window.setTimeout(()=>{B()},2e3)),()=>{k.current&&clearTimeout(k.current)}),[t,d,B,j]);const G=async()=>{k.current&&clearTimeout(k.current),await B();const $=M.current;if(M.current=null,$)n(`/onboarding/add/${$}`);else if(O<Ri.length-1){let H=O+1;D==="esi"&&Ri[H]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||H++),H<Ri.length&&n(`/onboarding/add/${Ri[H]}`)}},X=$=>{$<=q&&n(`/onboarding/add/${Ri[$]}`)},Q=()=>{if(O>0){let $=O-1;D==="uniform"&&Ri[$]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||$--),$>=0?n(`/onboarding/add/${Ri[$]}`):n("/onboarding/select-organization")}else n("/onboarding/select-organization")},Y=async()=>{c(!0);const $={...t,status:"pending"};try{!!t.id&&!t.id.startsWith("draft_")?(await pe.updateOnboarding($),x({message:"Application updated successfully!",type:"success"})):(await pe.submitOnboarding($),x({message:"Application submitted successfully!",type:"success"})),setTimeout(()=>{r(),a?.role==="site_manager"?n("/site/dashboard"):n("/onboarding")},2e3)}catch{x({message:"Failed to submit application.",type:"error"}),c(!1)}},ne=()=>{sessionStorage.removeItem(`onboarding_progress_${t.id}`),r(),w(!1),n("/onboarding/add/personal",{replace:!0}),x({message:"Form has been cleared.",type:"success"})},te=$=>{if($.key!=="ArrowUp"&&$.key!=="ArrowDown"&&$.key!=="Enter")return;const H=$.target;if($.key==="Enter"&&H.tagName!=="TEXTAREA"&&H.tagName!=="BUTTON"&&$.preventDefault(),$.key==="Enter"&&H.tagName==="BUTTON"||($.key==="ArrowUp"||$.key==="ArrowDown")&&(H.tagName==="TEXTAREA"||H.type==="number"))return;const se=$.currentTarget,W=Array.from(se.querySelectorAll('input:not([type="hidden"]):not([readonly]), select, textarea, button')).filter(oe=>!oe.hasAttribute("disabled")&&oe.offsetParent!==null),ee=W.indexOf(document.activeElement);if(ee===-1)return;($.key==="ArrowUp"||$.key==="ArrowDown")&&$.preventDefault();let K=ee;if($.key==="ArrowUp"?K=ee-1:K=ee+1,K>=0&&K<W.length)W[K].focus();else if($.key==="Enter"&&K>=W.length){const oe=document.getElementById("save-and-next-button");oe&&oe.click()}};if(d)return i.jsxs("div",{className:"flex justify-center items-center h-full text-muted",children:[i.jsx(Tt,{className:"h-8 w-8 animate-spin mr-4"}),i.jsx("p",{children:"Loading application data..."})]});const ie=Ri[O]==="review";return I?i.jsxs("div",{className:"h-full flex flex-col",children:[p&&i.jsx(Gt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Hk,{steps:U,currentStepIndex:O,onStepClick:X,highestStepReached:q,isMobileOptimized:!0}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4 pb-28",onKeyDown:te,children:i.jsx("div",{className:"bg-card p-6 rounded-2xl",children:i.jsx(gf,{context:{onValidated:G,onSubmit:Y,isSubmitting:l,setToast:x}})})}),i.jsxs("footer",{className:"fixed bottom-0 left-0 right-0 p-4 flex items-center justify-between gap-2 bg-card border-t border-[#123820] z-10",children:[i.jsx(ae,{type:"button",onClick:Q,variant:"secondary",children:"Back"}),i.jsx(ae,{type:"button",onClick:()=>n("/onboarding"),variant:"secondary",className:"!p-3 !rounded-full","aria-label":"Go to Home",children:i.jsx(hC,{className:"h-5 w-5"})}),i.jsx(ae,{id:"save-and-next-button",type:"submit",form:`${Ri[O]}-form`,children:ie?"Submit":"Next"})]})]}):i.jsx("div",{className:"p-4 md:p-0",children:i.jsxs("div",{className:`transition-opacity duration-300 ${l?"opacity-50 pointer-events-none":""}`,children:[p&&i.jsx(Gt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(tr,{isOpen:_,onClose:()=>w(!1),onConfirm:ne,title:"Confirm Clear Form",children:"Are you sure you want to clear all data entered in this form? This action cannot be undone."}),i.jsx(Hk,{steps:U,currentStepIndex:O,onStepClick:X,highestStepReached:q,isMobileOptimized:I}),i.jsx("div",{className:"mt-8 bg-card p-6 sm:p-8 rounded-xl shadow-card",onKeyDown:te,children:i.jsx(gf,{context:{onValidated:G,onSubmit:Y,isSubmitting:l,setToast:x}})}),i.jsxs("div",{className:"mt-8 flex justify-between items-center",children:[i.jsx(ae,{onClick:Q,disabled:O===0,variant:"secondary",children:"Back"}),i.jsxs("div",{className:"flex flex-wrap gap-4 justify-end items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted italic transition-opacity duration-300 min-h-[20px]",children:[j==="saving"&&i.jsxs(i.Fragment,{children:[i.jsx(Tt,{className:"h-4 w-4 animate-spin"}),i.jsx("span",{children:"Saving..."})]}),j==="saved"&&i.jsxs(i.Fragment,{children:[i.jsx(Bi,{className:"h-4 w-4 text-accent"}),i.jsx("span",{children:"Draft saved"})]}),j==="dirty"&&i.jsx("span",{className:"text-gray-500",children:"Unsaved changes"})]}),!ie&&i.jsx(ae,{id:"save-and-next-button",type:"submit",form:`${Ri[O]}-form`,children:"Save & Next"})]})]})]})})},PC=({status:n})=>{const t={pending:"status-chip--pending",verified:"status-chip--verified",rejected:"status-chip--rejected",draft:"status-chip--draft"}[n]||"status-chip--draft";return i.jsx("span",{className:`status-chip ${t}`,children:n})},Wr=({className:n=""})=>i.jsx("div",{className:`skeleton-pulse rounded-md ${n}`}),$Q=({rows:n,cols:e})=>i.jsx("div",{className:"space-y-4",children:Array.from({length:n}).map((t,r)=>i.jsx("div",{className:"bg-card rounded-2xl border border-border p-4 space-y-3",children:Array.from({length:e}).map((s,a)=>i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx(Wr,{className:"h-4 w-1/4"}),i.jsx(Wr,{className:"h-4 w-1/2"})]},a))},r))}),HQ=({rows:n,cols:e})=>i.jsx(i.Fragment,{children:Array.from({length:n}).map((t,r)=>i.jsx("tr",{children:Array.from({length:e}).map((s,a)=>i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"space-y-2",children:[i.jsx(Wr,{className:`h-4 ${a===0?"w-3/4":"w-full"}`}),a===0&&i.jsx(Wr,{className:"h-3 w-1/2"})]})},a))},r))}),Ta=({rows:n=5,cols:e=4,isMobile:t=!1,mobileCols:r})=>t?i.jsx($Q,{rows:n,cols:r||e}):i.jsx(HQ,{rows:n,cols:e}),YQ=({submission:n,isSyncing:e})=>{if(n.status!=="verified"||!n.portalSyncStatus)return i.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});if(e)return i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[i.jsx(Tt,{className:"h-4 w-4 animate-spin"})," Syncing..."]});const t=n.uan?.hasPreviousPf,r=[{label:"Aadhaar",verified:n.personal?.verifiedStatus?.idProofNumber},{label:"Bank",verified:n.bank?.verifiedStatus?.accountNumber},...t?[{label:"UAN",verified:n.uan?.verifiedStatus?.uanNumber}]:[]],s=n.portalSyncStatus==="synced"||n.portalSyncStatus==="failed",a=({label:o,status:l})=>{const c=s&&l===!0,d=s&&l===!1,m=c?xC:d?VF:BF,p=c?"text-green-600":d?"text-red-600":"text-muted",x=c?"Verified":d?"Failed":"Pending Verification";return i.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-medium ${p}`,title:x,children:[i.jsx(m,{className:"h-4 w-4"}),i.jsx("span",{children:o})]})};return i.jsx("div",{className:"flex flex-row gap-3 items-center",children:r.map(o=>i.jsx(a,{label:o.label,status:o.verified},o.label))})},GQ=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState("all"),[o,l]=E.useState(""),[c,d]=E.useState(null),[m,p]=E.useState(null),x=yn(),v=Jt("(max-width: 767px)"),_=E.useCallback(async()=>{r(!0);try{const M=await pe.getVerificationSubmissions(s==="all"?void 0:s);e(M)}catch(M){console.error("Failed to fetch submissions",M)}finally{r(!1)}},[s]);E.useEffect(()=>{_();const M=De.channel("submissions-feed").on("postgres_changes",{event:"*",schema:"public",table:"onboarding_submissions"},D=>{console.log("Real-time change received!",D),_()}).subscribe();return()=>{De.removeChannel(M)}},[_]);const w=E.useMemo(()=>n?n.filter(M=>M.personal.firstName?.toLowerCase().includes(o.toLowerCase())||M.personal.lastName?.toLowerCase().includes(o.toLowerCase())||M.personal.employeeId?.toLowerCase().includes(o.toLowerCase())||M.organizationName?.toLowerCase().includes(o.toLowerCase())):[],[n,o]),j=async(M,D)=>{e(O=>O.map(q=>q.id===D?{...q,status:M==="approve"?"verified":"rejected",portalSyncStatus:M==="approve"?"pending_sync":void 0}:q));try{M==="approve"?await pe.verifySubmission(D):await pe.requestChanges(D,"Changes requested by admin.")}catch(O){console.error(`Failed to ${M} submission`,O)}},P=async M=>{d(M);try{const D=await pe.syncPortals(M);e(O=>O.map(q=>q.id===M?D:q)),D.portalSyncStatus==="synced"?p({message:"Portals synced successfully!",type:"success"}):p({message:"Portal sync failed. Check details.",type:"error"})}catch{p({message:"An error occurred during sync.",type:"error"})}finally{d(null)}},k=["all","pending","verified","rejected"],I=s==="verified"?4:5;return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[m&&i.jsx(Gt,{message:m.message,type:m.type,onDismiss:()=>p(null)}),i.jsx("h2",{className:"text-2xl font-semibold text-primary-text mb-6",children:"Onboarding Forms"}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[i.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:i.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:k.map(M=>i.jsx("button",{onClick:()=>a(M),className:`${s===M?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize`,children:M},M))})}),i.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Na,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name, ID, site...",value:o,onChange:M=>l(M.target.value),className:"form-input block w-full pl-10 pr-3 py-2 border-border rounded-lg leading-5 placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site"}),s!=="verified"&&i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Verification"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-card md:divide-y-0",children:t?v?i.jsx("tr",{children:i.jsx("td",{colSpan:I,children:i.jsx(Ta,{rows:3,cols:4,isMobile:!0})})}):i.jsx(Ta,{rows:5,cols:I}):w.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:I,className:"text-center py-10 text-muted",children:"No submissions found."})}):w.map(M=>i.jsxs("tr",{className:M.requiresManualVerification?"bg-orange-50":"",children:[i.jsx("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[M.requiresManualVerification&&i.jsx("span",{title:"Manual verification required due to data mismatch.",children:i.jsx(Ca,{className:"h-4 w-4 text-orange-500 mr-2 flex-shrink-0"})}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[M.personal.firstName," ",M.personal.lastName]}),i.jsx("div",{className:"text-sm text-muted",children:M.personal.employeeId})]})]})}),i.jsx("td",{"data-label":"Site",className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-primary-text",children:M.organizationName}),s!=="verified"&&i.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(PC,{status:M.status})}),i.jsx("td",{"data-label":"Portal Verification",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(YQ,{submission:M,isSyncing:c===M.id})}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>x(`/onboarding/add/personal?id=${M.id}`),title:"View Details","aria-label":`View details for ${M.personal.firstName}`,children:i.jsx(bl,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>x(`/onboarding/pdf/${M.id}`),title:"Download Forms","aria-label":`Download forms for ${M.personal.firstName}`,children:i.jsx(Vs,{className:"h-4 w-4"})}),M.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>j("approve",M.id),title:"Verify","aria-label":`Verify submission for ${M.personal.firstName}`,children:i.jsx(xC,{className:"h-4 w-4 text-green-600"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>j("reject",M.id),title:"Request Changes","aria-label":`Request changes for ${M.personal.firstName}`,children:i.jsx(VF,{className:"h-4 w-4 text-red-600"})})]}),M.status==="verified"&&(M.portalSyncStatus==="pending_sync"||M.portalSyncStatus==="failed")&&i.jsxs(ae,{variant:"outline",size:"sm",onClick:()=>P(M.id),isLoading:c===M.id,title:"Push data to government portals",children:[c!==M.id&&i.jsx(gC,{className:"h-4 w-4 mr-1"}),"Sync Portals"]})]})})]},M.id))})]})})]})},ZQ=wt({id:be().optional(),name:be().required("Name is required"),email:be().email("Invalid email").required("Email is required"),role:be().required("Role is required"),password:be().min(6,"Password must be at least 6 characters").required("Password is required for new users"),phone:be().optional(),organizationId:be().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:be().optional(),reportingManagerId:be().optional(),photoUrl:be().optional().nullable()}).defined(),KQ=wt({id:be().optional(),name:be().required("Name is required"),email:be().email("Invalid email").required("Email is required"),role:be().required("Role is required"),phone:be().optional(),organizationId:be().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:be().optional(),reportingManagerId:be().optional(),photoUrl:be().optional().nullable()}).defined(),JQ=({isOpen:n,onClose:e,onSave:t,initialData:r,isSaving:s})=>{const a=r?KQ:ZQ,{register:o,handleSubmit:l,formState:{errors:c},reset:d,watch:m,setValue:p}=Zt({resolver:_n(a)}),[x,v]=E.useState([]),[_,w]=E.useState([]),j=!!r,P=m("role");E.useEffect(()=>{n&&(Promise.all([pe.getOrganizations(),pe.getRoles()]).then(([M,D])=>{if(v(M),r?.role==="unverified"&&!D.some(O=>O.id==="unverified")){const O=[{id:"unverified",displayName:"Unverified"},...D];w(O)}else w(D)}),d(r||{name:"",email:"",role:"field_officer"}))},[r,d,n]);const k=M=>{const D=M.target.value,O=x.find(q=>q.id===D);p("organizationId",D),p("organizationName",O?.shortName||"")},I=M=>{t(M)};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",children:i.jsxs("form",{onSubmit:l(I),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text mb-4",children:[j?"Edit":"Add"," User"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(Me,{label:"Full Name",id:"name",registration:o("name"),error:c.name?.message}),i.jsx(Me,{label:"Email",id:"email",type:"email",registration:o("email"),error:c.email?.message}),i.jsx(Qe,{label:"Role",id:"role",registration:o("role"),error:c.role?.message,children:_.map(M=>i.jsx("option",{value:M.id,children:M.displayName},M.id))}),!j&&i.jsx(Me,{label:"Password",id:"password",type:"password",registration:o("password"),error:c.password?.message}),P==="site_manager"&&i.jsxs(Qe,{label:"Assigned Site",id:"organizationId",...o("organizationId"),error:c.organizationId?.message,onChange:k,children:[i.jsx("option",{value:"",children:"Select a Site"}),x.map(M=>i.jsx("option",{value:M.id,children:M.shortName},M.id))]})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ae,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ae,{type:"submit",isLoading:s,children:j?"Save Changes":"Create User"})]})]})})}):null},Yi=({title:n,children:e})=>i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:n}),e&&i.jsx("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:e})]}),QQ=({isOpen:n,onClose:e,onApprove:t,user:r,isConfirming:s})=>{const[a,o]=E.useState([]),[l,c]=E.useState(""),[d,m]=E.useState(!0);E.useEffect(()=>{n&&(m(!0),pe.getRoles().then(x=>{const v=x.filter(_=>_.id!=="unverified"&&_.id!=="admin");o(v),v.length>0&&c(v[0].id),m(!1)}))},[n]);const p=()=>{r&&l&&t(r.id,l)};return!n||!r?null:i.jsx(tr,{isOpen:n,onClose:e,onConfirm:p,title:"Approve User Account",confirmButtonText:"Confirm Approval",confirmButtonVariant:"primary",isConfirming:s,children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{children:["You are approving the account for ",i.jsx("strong",{className:"text-primary-text",children:r.name})," (",r.email,")."]}),i.jsx("p",{children:"Please assign a role to activate their account."}),d?i.jsx("p",{children:"Loading roles..."}):i.jsx(Qe,{label:"Assign Role",id:"approval-role",value:l,onChange:x=>c(x.target.value),children:a.map(x=>i.jsx("option",{value:x.id,children:x.displayName},x.id))})]})})},XQ=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState(!1),[c,d]=E.useState(!1),[m,p]=E.useState(!1),[x,v]=E.useState(null),[_,w]=E.useState(null),j=Jt("(max-width: 767px)"),P=E.useCallback(async()=>{r(!0);try{const B=await pe.getUsers();e(B)}catch{w({message:"Failed to fetch users.",type:"error"})}finally{r(!1)}},[]);E.useEffect(()=>{P()},[P]);const k=()=>{v(null),l(!0)},I=B=>{v(B),l(!0)},M=B=>{v(B),p(!0)},D=B=>{v(B),d(!0)},O=async B=>{a(!0);try{if(x){const{password:G,...X}=B;await pe.updateUser(x.id,X),w({message:"User updated successfully!",type:"success"})}else{const{name:G,email:X,password:Q,role:Y,...ne}=B;if(!Q)throw new Error("Password is required when creating a new user");const te=await pe.createAuthUser({name:G,email:X,password:Q,role:Y});ne&&Object.keys(ne).length>0&&await pe.updateUser(te.id,ne),await pe.createNotification({userId:te.id,message:`Welcome ${te.name}! Your account has been created.`,type:"greeting"}),w({message:"User created successfully!",type:"success"})}l(!1),P()}catch(G){w({message:G.message||"Failed to save user.",type:"error"})}finally{a(!1)}},q=async(B,G)=>{a(!0);try{await pe.updateUser(B,{role:G}),w({message:"User approved successfully!",type:"success"}),p(!1),P()}catch{w({message:"Failed to approve user.",type:"error"})}finally{a(!1)}},F=async()=>{if(x){a(!0);try{await pe.deleteUser(x.id),w({message:"User deleted. Remember to also remove them from Supabase Auth.",type:"success"}),d(!1),P()}catch{w({message:"Failed to delete user.",type:"error"})}finally{a(!1)}}},U=B=>B?B.replace(/_/g," ").replace(/\b\w/g,G=>G.toUpperCase()):"N/A";return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[_&&i.jsx(Gt,{message:_.message,type:_.type,onDismiss:()=>w(null)}),i.jsx(JQ,{isOpen:o,onClose:()=>l(!1),onSave:O,initialData:x,isSaving:s}),i.jsx(QQ,{isOpen:m,onClose:()=>p(!1),onApprove:q,user:x,isConfirming:s}),i.jsxs(tr,{isOpen:c,onClose:()=>d(!1),onConfirm:F,title:"Confirm Deletion",isConfirming:s,children:['Are you sure you want to delete the user "',x?.name,'"? This action cannot be undone.']}),i.jsx(Yi,{title:"User Management",children:i.jsxs(ae,{onClick:k,children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add User"]})}),i.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 text-blue-800 p-4 rounded-lg text-sm",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx($h,{className:"h-5 w-5 mr-3 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold",children:"Adding New Users"}),i.jsxs("p",{className:"mt-1",children:["Use the ",i.jsx("strong",{children:"Add User"})," button below to create a new user. Provide their name, email, role and a temporary password. The system will automatically provision their login, send them a verification email and create their profile."]}),i.jsx("p",{className:"mt-2",children:"Once they confirm their email they can sign in using the password you set. You can edit or delete users at any time from this page."})]})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Email"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:t?j?i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsx(Ta,{rows:3,cols:4,isMobile:!0})})}):i.jsx(Ta,{rows:5,cols:4}):n.map(B=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Name",className:"px-6 py-4 font-medium",children:B.name}),i.jsx("td",{"data-label":"Email",className:"px-6 py-4 text-sm text-muted",children:B.email}),i.jsxs("td",{"data-label":"Role",className:"px-6 py-4 text-sm text-muted",children:[i.jsxs("div",{className:"flex items-center md:justify-start justify-end",children:[i.jsx($x,{className:"h-4 w-4 mr-2 text-accent"}),U(B.role)]}),B.role==="unverified"&&i.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800 ml-2",children:"Pending Approval"})]}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[B.role==="unverified"&&i.jsxs(ae,{variant:"outline",size:"sm",onClick:()=>M(B),"aria-label":`Approve user ${B.name}`,title:`Approve user ${B.name}`,children:[i.jsx(du,{className:"h-4 w-4 mr-2"}),"Approve"]}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>I(B),"aria-label":`Edit user ${B.name}`,title:`Edit user ${B.name}`,children:i.jsx(xr,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>D(B),"aria-label":`Delete user ${B.name}`,title:`Delete user ${B.name}`,children:i.jsx(Xt,{className:"h-4 w-4 text-red-600"})})]})})]},B.id))})]})})]})},eX=wt({groupId:be().required("Please select a group"),companyId:be().required("Please select a company"),clientId:be().required("Please select a client"),manpowerCount:rs().typeError("Must be a number").min(0,"Cannot be negative").required("Manpower count is required")}).defined(),tX=({isOpen:n,onClose:e,onSave:t})=>{const[r,s]=E.useState([]),[a,o]=E.useState(!0),[l,c]=E.useState(""),[d,m]=E.useState(!1),p=E.useRef(null),{register:x,handleSubmit:v,watch:_,formState:{errors:w},reset:j,setValue:P}=Zt({resolver:_n(eX)}),k=_("groupId"),I=_("companyId");E.useEffect(()=>{n&&(o(!0),pe.getOrganizationStructure().then(s).finally(()=>o(!1)),j(),c(""))},[n,j]),E.useEffect(()=>{P("companyId",""),P("clientId",""),c("")},[k,P]),E.useEffect(()=>{P("clientId",""),c("")},[I,P]),E.useEffect(()=>{const U=B=>{p.current&&!p.current.contains(B.target)&&m(!1)};return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[]);const M=E.useMemo(()=>r.find(U=>U.id===k)?.companies||[],[r,k]),D=E.useMemo(()=>M.find(U=>U.id===I)?.entities||[],[M,I]),O=E.useMemo(()=>l?D.filter(U=>U.name.toLowerCase().includes(l.toLowerCase())):D,[D,l]),q=U=>{const B=D.find(G=>G.id===U.clientId);B&&t(B,U.manpowerCount)},F=U=>{P("clientId",U.id,{shouldValidate:!0}),c(U.name),m(!1)};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:U=>U.stopPropagation(),children:i.jsxs("form",{onSubmit:v(q),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-4",children:"Add Site from Existing Client"}),a?i.jsx("div",{className:"flex justify-center items-center h-48",children:i.jsx(Tt,{className:"h-6 w-6 animate-spin text-muted"})}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs(Qe,{label:"Group",id:"groupId",registration:x("groupId"),error:w.groupId?.message,children:[i.jsx("option",{value:"",children:"Select a Group"}),r.map(U=>i.jsx("option",{value:U.id,children:U.name},U.id))]}),i.jsxs(Qe,{label:"Company",id:"companyId",registration:x("companyId"),error:w.companyId?.message,disabled:!k,children:[i.jsx("option",{value:"",children:"Select a Company"}),M.map(U=>i.jsx("option",{value:U.id,children:U.name},U.id))]}),i.jsxs("div",{className:"relative",ref:p,children:[i.jsx(Me,{label:"Client",id:"clientSearch",value:l,onChange:U=>{c(U.target.value),m(!0),P("clientId","")},onFocus:()=>m(!0),disabled:!I,error:w.clientId?.message,autoComplete:"off"}),d&&O.length>0&&i.jsx("ul",{className:"absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto shadow-lg",children:O.map(U=>i.jsx("li",{onClick:()=>F(U),className:"px-3 py-2 text-sm cursor-pointer hover:bg-page",children:U.name},U.id))})]}),i.jsx(Me,{label:"Approved Manpower Count",id:"manpowerCount",type:"number",registration:x("manpowerCount"),error:w.manpowerCount?.message})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ae,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ae,{type:"submit",disabled:a,children:"Add Site"})]})]})})}):null};var f0,Yk;function nX(){if(Yk)return f0;Yk=1;var n=!1,e,t,r,s,a,o,l,c,d,m,p,x,v,_,w;function j(){if(!n){n=!0;var k=navigator.userAgent,I=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(k),M=/(Mac OS X)|(Windows)|(Linux)/.exec(k);if(x=/\b(iPhone|iP[ao]d)/.exec(k),v=/\b(iP[ao]d)/.exec(k),m=/Android/i.exec(k),_=/FBAN\/\w+;/i.exec(k),w=/Mobile/i.exec(k),p=!!/Win64/.exec(k),I){e=I[1]?parseFloat(I[1]):I[5]?parseFloat(I[5]):NaN,e&&document&&document.documentMode&&(e=document.documentMode);var D=/(?:Trident\/(\d+.\d+))/.exec(k);o=D?parseFloat(D[1])+4:e,t=I[2]?parseFloat(I[2]):NaN,r=I[3]?parseFloat(I[3]):NaN,s=I[4]?parseFloat(I[4]):NaN,s?(I=/(?:Chrome\/(\d+\.\d+))/.exec(k),a=I&&I[1]?parseFloat(I[1]):NaN):a=NaN}else e=t=r=a=s=NaN;if(M){if(M[1]){var O=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(k);l=O?parseFloat(O[1].replace("_",".")):!0}else l=!1;c=!!M[2],d=!!M[3]}else l=c=d=!1}}var P={ie:function(){return j()||e},ieCompatibilityMode:function(){return j()||o>e},ie64:function(){return P.ie()&&p},firefox:function(){return j()||t},opera:function(){return j()||r},webkit:function(){return j()||s},safari:function(){return P.webkit()},chrome:function(){return j()||a},windows:function(){return j()||c},osx:function(){return j()||l},linux:function(){return j()||d},iphone:function(){return j()||x},mobile:function(){return j()||x||v||m||w},nativeApp:function(){return j()||_},android:function(){return j()||m},ipad:function(){return j()||v}};return f0=P,f0}var h0,Gk;function rX(){if(Gk)return h0;Gk=1;var n=!!(typeof window<"u"&&window.document&&window.document.createElement),e={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};return h0=e,h0}var m0,Zk;function sX(){if(Zk)return m0;Zk=1;var n=rX(),e;n.canUseDOM&&(e=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function t(r,s){if(!n.canUseDOM||s&&!("addEventListener"in document))return!1;var a="on"+r,o=a in document;if(!o){var l=document.createElement("div");l.setAttribute(a,"return;"),o=typeof l[a]=="function"}return!o&&e&&r==="wheel"&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o}return m0=t,m0}var p0,Kk;function iX(){if(Kk)return p0;Kk=1;var n=nX(),e=sX(),t=10,r=40,s=800;function a(o){var l=0,c=0,d=0,m=0;return"detail"in o&&(c=o.detail),"wheelDelta"in o&&(c=-o.wheelDelta/120),"wheelDeltaY"in o&&(c=-o.wheelDeltaY/120),"wheelDeltaX"in o&&(l=-o.wheelDeltaX/120),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(l=c,c=0),d=l*t,m=c*t,"deltaY"in o&&(m=o.deltaY),"deltaX"in o&&(d=o.deltaX),(d||m)&&o.deltaMode&&(o.deltaMode==1?(d*=r,m*=r):(d*=s,m*=s)),d&&!l&&(l=d<1?-1:1),m&&!c&&(c=m<1?-1:1),{spinX:l,spinY:c,pixelX:d,pixelY:m}}return a.getEventType=function(){return n.firefox()?"DOMMouseScroll":e("wheel")?"wheel":"mousewheel"},p0=a,p0}var g0,Jk;function aX(){return Jk||(Jk=1,g0=iX()),g0}var oX=aX();const lX=hu(oX);function cX(n,e,t,r,s,a){a===void 0&&(a=0);var o=Mf(n,e,a),l=o.width,c=o.height,d=Math.min(l,t),m=Math.min(c,r);return d>m*s?{width:m*s,height:m}:{width:d,height:d/s}}function dX(n){return n.width>n.height?n.width/n.naturalWidth:n.height/n.naturalHeight}function ph(n,e,t,r,s){s===void 0&&(s=0);var a=Mf(e.width,e.height,s),o=a.width,l=a.height;return{x:Qk(n.x,o,t.width,r),y:Qk(n.y,l,t.height,r)}}function Qk(n,e,t,r){var s=e*r/2-t/2;return Xx(n,-s,s)}function Xk(n,e){return Math.sqrt(Math.pow(n.y-e.y,2)+Math.pow(n.x-e.x,2))}function eE(n,e){return Math.atan2(e.y-n.y,e.x-n.x)*180/Math.PI}function uX(n,e,t,r,s,a,o){a===void 0&&(a=0),o===void 0&&(o=!0);var l=o?fX:hX,c=Mf(e.width,e.height,a),d=Mf(e.naturalWidth,e.naturalHeight,a),m={x:l(100,((c.width-t.width/s)/2-n.x/s)/c.width*100),y:l(100,((c.height-t.height/s)/2-n.y/s)/c.height*100),width:l(100,t.width/c.width*100/s),height:l(100,t.height/c.height*100/s)},p=Math.round(l(d.width,m.width*d.width/100)),x=Math.round(l(d.height,m.height*d.height/100)),v=d.width>=d.height*r,_=v?{width:Math.round(x*r),height:x}:{width:p,height:Math.round(p/r)},w=hr(hr({},_),{x:Math.round(l(d.width-_.width,m.x*d.width/100)),y:Math.round(l(d.height-_.height,m.y*d.height/100))});return{croppedAreaPercentages:m,croppedAreaPixels:w}}function fX(n,e){return Math.min(n,Math.max(0,e))}function hX(n,e){return e}function mX(n,e,t,r,s,a){var o=Mf(e.width,e.height,t),l=Xx(r.width/o.width*(100/n.width),s,a),c={x:l*o.width/2-r.width/2-o.width*l*(n.x/100),y:l*o.height/2-r.height/2-o.height*l*(n.y/100)};return{crop:c,zoom:l}}function pX(n,e,t){var r=dX(e);return t.height>t.width?t.height/(n.height*r):t.width/(n.width*r)}function gX(n,e,t,r,s,a){t===void 0&&(t=0);var o=Mf(e.naturalWidth,e.naturalHeight,t),l=Xx(pX(n,e,r),s,a),c=r.height>r.width?r.height/n.height:r.width/n.width,d={x:((o.width-n.width)/2-n.x)*c,y:((o.height-n.height)/2-n.y)*c};return{crop:d,zoom:l}}function tE(n,e){return{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}function xX(n){return n*Math.PI/180}function Mf(n,e,t){var r=xX(t);return{width:Math.abs(Math.cos(r)*n)+Math.abs(Math.sin(r)*e),height:Math.abs(Math.sin(r)*n)+Math.abs(Math.cos(r)*e)}}function Xx(n,e,t){return Math.min(Math.max(n,e),t)}function Ip(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.filter(function(t){return typeof t=="string"&&t.length>0}).join(" ").trim()}var yX=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,vX=1,bX=3,_X=1,wX=(function(n){WN(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.cropperRef=E.createRef(),t.imageRef=E.createRef(),t.videoRef=E.createRef(),t.containerPosition={x:0,y:0},t.containerRef=null,t.styleRef=null,t.containerRect=null,t.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},t.dragStartPosition={x:0,y:0},t.dragStartCrop={x:0,y:0},t.gestureZoomStart=0,t.gestureRotationStart=0,t.isTouching=!1,t.lastPinchDistance=0,t.lastPinchRotation=0,t.rafDragTimeout=null,t.rafPinchTimeout=null,t.wheelTimer=null,t.currentDoc=typeof document<"u"?document:null,t.currentWindow=typeof window<"u"?window:null,t.resizeObserver=null,t.previousCropSize=null,t.isInitialized=!1,t.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},t.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!t.containerRef)){var r=!0;t.resizeObserver=new window.ResizeObserver(function(s){if(r){r=!1;return}t.computeSizes()}),t.resizeObserver.observe(t.containerRef)}},t.preventZoomSafari=function(r){return r.preventDefault()},t.cleanEvents=function(){t.currentDoc&&(t.currentDoc.removeEventListener("mousemove",t.onMouseMove),t.currentDoc.removeEventListener("mouseup",t.onDragStopped),t.currentDoc.removeEventListener("touchmove",t.onTouchMove),t.currentDoc.removeEventListener("touchend",t.onDragStopped),t.currentDoc.removeEventListener("gesturechange",t.onGestureChange),t.currentDoc.removeEventListener("gestureend",t.onGestureEnd),t.currentDoc.removeEventListener("scroll",t.onScroll))},t.clearScrollEvent=function(){t.containerRef&&t.containerRef.removeEventListener("wheel",t.onWheel),t.wheelTimer&&clearTimeout(t.wheelTimer)},t.onMediaLoad=function(){var r=t.computeSizes();r&&(t.previousCropSize=r,t.emitCropData(),t.setInitialCrop(r),t.isInitialized=!0),t.props.onMediaLoaded&&t.props.onMediaLoaded(t.mediaSize)},t.setInitialCrop=function(r){if(t.props.initialCroppedAreaPercentages){var s=mX(t.props.initialCroppedAreaPercentages,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),a=s.crop,o=s.zoom;t.props.onCropChange(a),t.props.onZoomChange&&t.props.onZoomChange(o)}else if(t.props.initialCroppedAreaPixels){var l=gX(t.props.initialCroppedAreaPixels,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),a=l.crop,o=l.zoom;t.props.onCropChange(a),t.props.onZoomChange&&t.props.onZoomChange(o)}},t.computeSizes=function(){var r,s,a,o,l,c,d=t.imageRef.current||t.videoRef.current;if(d&&t.containerRef){t.containerRect=t.containerRef.getBoundingClientRect(),t.saveContainerPosition();var m=t.containerRect.width/t.containerRect.height,p=((r=t.imageRef.current)===null||r===void 0?void 0:r.naturalWidth)||((s=t.videoRef.current)===null||s===void 0?void 0:s.videoWidth)||0,x=((a=t.imageRef.current)===null||a===void 0?void 0:a.naturalHeight)||((o=t.videoRef.current)===null||o===void 0?void 0:o.videoHeight)||0,v=d.offsetWidth<p||d.offsetHeight<x,_=p/x,w=void 0;if(v)switch(t.state.mediaObjectFit){default:case"contain":w=m>_?{width:t.containerRect.height*_,height:t.containerRect.height}:{width:t.containerRect.width,height:t.containerRect.width/_};break;case"horizontal-cover":w={width:t.containerRect.width,height:t.containerRect.width/_};break;case"vertical-cover":w={width:t.containerRect.height*_,height:t.containerRect.height};break}else w={width:d.offsetWidth,height:d.offsetHeight};t.mediaSize=hr(hr({},w),{naturalWidth:p,naturalHeight:x}),t.props.setMediaSize&&t.props.setMediaSize(t.mediaSize);var j=t.props.cropSize?t.props.cropSize:cX(t.mediaSize.width,t.mediaSize.height,t.containerRect.width,t.containerRect.height,t.props.aspect,t.props.rotation);return(((l=t.state.cropSize)===null||l===void 0?void 0:l.height)!==j.height||((c=t.state.cropSize)===null||c===void 0?void 0:c.width)!==j.width)&&t.props.onCropSizeChange&&t.props.onCropSizeChange(j),t.setState({cropSize:j},t.recomputeCropPosition),t.props.setCropSize&&t.props.setCropSize(j),j}},t.saveContainerPosition=function(){if(t.containerRef){var r=t.containerRef.getBoundingClientRect();t.containerPosition={x:r.left,y:r.top}}},t.onMouseDown=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("mousemove",t.onMouseMove),t.currentDoc.addEventListener("mouseup",t.onDragStopped),t.saveContainerPosition(),t.onDragStart(e.getMousePoint(r)))},t.onMouseMove=function(r){return t.onDrag(e.getMousePoint(r))},t.onScroll=function(r){t.currentDoc&&(r.preventDefault(),t.saveContainerPosition())},t.onTouchStart=function(r){t.currentDoc&&(t.isTouching=!0,!(t.props.onTouchRequest&&!t.props.onTouchRequest(r))&&(t.currentDoc.addEventListener("touchmove",t.onTouchMove,{passive:!1}),t.currentDoc.addEventListener("touchend",t.onDragStopped),t.saveContainerPosition(),r.touches.length===2?t.onPinchStart(r):r.touches.length===1&&t.onDragStart(e.getTouchPoint(r.touches[0]))))},t.onTouchMove=function(r){r.preventDefault(),r.touches.length===2?t.onPinchMove(r):r.touches.length===1&&t.onDrag(e.getTouchPoint(r.touches[0]))},t.onGestureStart=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("gesturechange",t.onGestureChange),t.currentDoc.addEventListener("gestureend",t.onGestureEnd),t.gestureZoomStart=t.props.zoom,t.gestureRotationStart=t.props.rotation)},t.onGestureChange=function(r){if(r.preventDefault(),!t.isTouching){var s=e.getMousePoint(r),a=t.gestureZoomStart-1+r.scale;if(t.setNewZoom(a,s,{shouldUpdatePosition:!0}),t.props.onRotationChange){var o=t.gestureRotationStart+r.rotation;t.props.onRotationChange(o)}}},t.onGestureEnd=function(r){t.cleanEvents()},t.onDragStart=function(r){var s,a,o=r.x,l=r.y;t.dragStartPosition={x:o,y:l},t.dragStartCrop=hr({},t.props.crop),(a=(s=t.props).onInteractionStart)===null||a===void 0||a.call(s)},t.onDrag=function(r){var s=r.x,a=r.y;t.currentWindow&&(t.rafDragTimeout&&t.currentWindow.cancelAnimationFrame(t.rafDragTimeout),t.rafDragTimeout=t.currentWindow.requestAnimationFrame(function(){if(t.state.cropSize&&!(s===void 0||a===void 0)){var o=s-t.dragStartPosition.x,l=a-t.dragStartPosition.y,c={x:t.dragStartCrop.x+o,y:t.dragStartCrop.y+l},d=t.props.restrictPosition?ph(c,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):c;t.props.onCropChange(d)}}))},t.onDragStopped=function(){var r,s;t.isTouching=!1,t.cleanEvents(),t.emitCropData(),(s=(r=t.props).onInteractionEnd)===null||s===void 0||s.call(r)},t.onWheel=function(r){if(t.currentWindow&&!(t.props.onWheelRequest&&!t.props.onWheelRequest(r))){r.preventDefault();var s=e.getMousePoint(r),a=lX(r).pixelY,o=t.props.zoom-a*t.props.zoomSpeed/200;t.setNewZoom(o,s,{shouldUpdatePosition:!0}),t.state.hasWheelJustStarted||t.setState({hasWheelJustStarted:!0},function(){var l,c;return(c=(l=t.props).onInteractionStart)===null||c===void 0?void 0:c.call(l)}),t.wheelTimer&&clearTimeout(t.wheelTimer),t.wheelTimer=t.currentWindow.setTimeout(function(){return t.setState({hasWheelJustStarted:!1},function(){var l,c;return(c=(l=t.props).onInteractionEnd)===null||c===void 0?void 0:c.call(l)})},250)}},t.getPointOnContainer=function(r,s){var a=r.x,o=r.y;if(!t.containerRect)throw new Error("The Cropper is not mounted");return{x:t.containerRect.width/2-(a-s.x),y:t.containerRect.height/2-(o-s.y)}},t.getPointOnMedia=function(r){var s=r.x,a=r.y,o=t.props,l=o.crop,c=o.zoom;return{x:(s+l.x)/c,y:(a+l.y)/c}},t.setNewZoom=function(r,s,a){var o=a===void 0?{}:a,l=o.shouldUpdatePosition,c=l===void 0?!0:l;if(!(!t.state.cropSize||!t.props.onZoomChange)){var d=Xx(r,t.props.minZoom,t.props.maxZoom);if(c){var m=t.getPointOnContainer(s,t.containerPosition),p=t.getPointOnMedia(m),x={x:p.x*d-m.x,y:p.y*d-m.y},v=t.props.restrictPosition?ph(x,t.mediaSize,t.state.cropSize,d,t.props.rotation):x;t.props.onCropChange(v)}t.props.onZoomChange(d)}},t.getCropData=function(){if(!t.state.cropSize)return null;var r=t.props.restrictPosition?ph(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;return uX(r,t.mediaSize,t.state.cropSize,t.getAspect(),t.props.zoom,t.props.rotation,t.props.restrictPosition)},t.emitCropData=function(){var r=t.getCropData();if(r){var s=r.croppedAreaPercentages,a=r.croppedAreaPixels;t.props.onCropComplete&&t.props.onCropComplete(s,a),t.props.onCropAreaChange&&t.props.onCropAreaChange(s,a)}},t.emitCropAreaChange=function(){var r=t.getCropData();if(r){var s=r.croppedAreaPercentages,a=r.croppedAreaPixels;t.props.onCropAreaChange&&t.props.onCropAreaChange(s,a)}},t.recomputeCropPosition=function(){if(t.state.cropSize){var r=t.props.crop;if(t.isInitialized&&t.previousCropSize){var s=Math.abs(t.previousCropSize.width-t.state.cropSize.width)>1e-6||Math.abs(t.previousCropSize.height-t.state.cropSize.height)>1e-6;if(s){var a=t.state.cropSize.width/t.previousCropSize.width,o=t.state.cropSize.height/t.previousCropSize.height;r={x:t.props.crop.x*a,y:t.props.crop.y*o}}}var l=t.props.restrictPosition?ph(r,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):r;t.previousCropSize=t.state.cropSize,t.props.onCropChange(l),t.emitCropData()}},t.onKeyDown=function(r){var s,a,o=t.props,l=o.crop,c=o.onCropChange,d=o.keyboardStep,m=o.zoom,p=o.rotation,x=d;if(t.state.cropSize){r.shiftKey&&(x*=.2);var v=hr({},l);switch(r.key){case"ArrowUp":v.y-=x,r.preventDefault();break;case"ArrowDown":v.y+=x,r.preventDefault();break;case"ArrowLeft":v.x-=x,r.preventDefault();break;case"ArrowRight":v.x+=x,r.preventDefault();break;default:return}t.props.restrictPosition&&(v=ph(v,t.mediaSize,t.state.cropSize,m,p)),r.repeat||(a=(s=t.props).onInteractionStart)===null||a===void 0||a.call(s),c(v)}},t.onKeyUp=function(r){var s,a;switch(r.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":r.preventDefault();break;default:return}t.emitCropData(),(a=(s=t.props).onInteractionEnd)===null||a===void 0||a.call(s)},t}return e.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=yX,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},e.prototype.componentWillUnmount=function(){var t,r;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((r=this.styleRef.parentNode)===null||r===void 0||r.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},e.prototype.componentDidUpdate=function(t){var r,s,a,o,l,c,d,m,p;t.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):t.aspect!==this.props.aspect?this.computeSizes():t.objectFit!==this.props.objectFit?this.computeSizes():t.zoom!==this.props.zoom?this.recomputeCropPosition():((r=t.cropSize)===null||r===void 0?void 0:r.height)!==((s=this.props.cropSize)===null||s===void 0?void 0:s.height)||((a=t.cropSize)===null||a===void 0?void 0:a.width)!==((o=this.props.cropSize)===null||o===void 0?void 0:o.width)?this.computeSizes():(((l=t.crop)===null||l===void 0?void 0:l.x)!==((c=this.props.crop)===null||c===void 0?void 0:c.x)||((d=t.crop)===null||d===void 0?void 0:d.y)!==((m=this.props.crop)===null||m===void 0?void 0:m.y))&&this.emitCropAreaChange(),t.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),t.video!==this.props.video&&((p=this.videoRef.current)===null||p===void 0||p.load());var x=this.getObjectFit();x!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:x},this.computeSizes)},e.prototype.getAspect=function(){var t=this.props,r=t.cropSize,s=t.aspect;return r?r.width/r.height:s},e.prototype.getObjectFit=function(){var t,r,s,a;if(this.props.objectFit==="cover"){var o=this.imageRef.current||this.videoRef.current;if(o&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var l=this.containerRect.width/this.containerRect.height,c=((t=this.imageRef.current)===null||t===void 0?void 0:t.naturalWidth)||((r=this.videoRef.current)===null||r===void 0?void 0:r.videoWidth)||0,d=((s=this.imageRef.current)===null||s===void 0?void 0:s.naturalHeight)||((a=this.videoRef.current)===null||a===void 0?void 0:a.videoHeight)||0,m=c/d;return m<l?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},e.prototype.onPinchStart=function(t){var r=e.getTouchPoint(t.touches[0]),s=e.getTouchPoint(t.touches[1]);this.lastPinchDistance=Xk(r,s),this.lastPinchRotation=eE(r,s),this.onDragStart(tE(r,s))},e.prototype.onPinchMove=function(t){var r=this;if(!(!this.currentDoc||!this.currentWindow)){var s=e.getTouchPoint(t.touches[0]),a=e.getTouchPoint(t.touches[1]),o=tE(s,a);this.onDrag(o),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var l=Xk(s,a),c=r.props.zoom*(l/r.lastPinchDistance);r.setNewZoom(c,o,{shouldUpdatePosition:!1}),r.lastPinchDistance=l;var d=eE(s,a),m=r.props.rotation+(d-r.lastPinchRotation);r.props.onRotationChange&&r.props.onRotationChange(m),r.lastPinchRotation=d})}},e.prototype.render=function(){var t=this,r,s=this.props,a=s.image,o=s.video,l=s.mediaProps,c=s.cropperProps,d=s.transform,m=s.crop,p=m.x,x=m.y,v=s.rotation,_=s.zoom,w=s.cropShape,j=s.showGrid,P=s.roundCropAreaPixels,k=s.style,I=k.containerStyle,M=k.cropAreaStyle,D=k.mediaStyle,O=s.classes,q=O.containerClassName,F=O.cropAreaClassName,U=O.mediaClassName,B=(r=this.state.mediaObjectFit)!==null&&r!==void 0?r:this.getObjectFit();return E.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(X){return t.containerRef=X},"data-testid":"container",style:I,className:Ip("reactEasyCrop_Container",q)},a?E.createElement("img",hr({alt:"",className:Ip("reactEasyCrop_Image",B==="contain"&&"reactEasyCrop_Contain",B==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",B==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",U)},l,{src:a,ref:this.imageRef,style:hr(hr({},D),{transform:d||"translate(".concat(p,"px, ").concat(x,"px) rotate(").concat(v,"deg) scale(").concat(_,")")}),onLoad:this.onMediaLoad})):o&&E.createElement("video",hr({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:Ip("reactEasyCrop_Video",B==="contain"&&"reactEasyCrop_Contain",B==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",B==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",U)},l,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:hr(hr({},D),{transform:d||"translate(".concat(p,"px, ").concat(x,"px) rotate(").concat(v,"deg) scale(").concat(_,")")}),controls:!1}),(Array.isArray(o)?o:[{src:o}]).map(function(G){return E.createElement("source",hr({key:G.src},G))})),this.state.cropSize&&E.createElement("div",hr({ref:this.cropperRef,style:hr(hr({},M),{width:P?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:P?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:Ip("reactEasyCrop_CropArea",w==="round"&&"reactEasyCrop_CropAreaRound",j&&"reactEasyCrop_CropAreaGrid",F)},c)))},e.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:bX,minZoom:vX,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:_X},e.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e})(E.Component);const SX=n=>new Promise((e,t)=>{const r=new Image;r.addEventListener("load",()=>e(r)),r.addEventListener("error",s=>t(s)),r.src=n});async function jX(n,e){const t=await SX(n),r=document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("No 2d context");return r.width=e.width,r.height=e.height,s.drawImage(t,e.x,e.y,e.width,e.height,0,0,e.width,e.height),r.toDataURL("image/jpeg",.9)}const P3=({isOpen:n,onClose:e,onCapture:t,captureGuidance:r="none"})=>{const s=E.useRef(null),a=E.useRef(null),o=E.useRef(null),[l,c]=E.useState(null),[d,m]=E.useState(null),[p,x]=E.useState(!1),[v,_]=E.useState(""),[w,j]=E.useState(!1),[P,k]=E.useState({x:0,y:0}),[I,M]=E.useState(1),[D,O]=E.useState(null),[q,F]=E.useState(null),[U,B]=E.useState([]),[G,X]=E.useState(0),[Q,Y]=E.useState(!1),[ne,te]=E.useState(!1),[ie,$]=E.useState(!1),[H,se]=E.useState(!1),[W,ee]=E.useState(),K=E.useCallback(()=>{o.current&&(o.current.getTracks().forEach(qe=>qe.stop()),o.current=null)},[]),oe=E.useCallback(async qe=>{K(),c(null),j(!1),Y(!1);try{const ze={video:qe?{deviceId:{exact:qe}}:{facingMode:"environment"}},He=await navigator.mediaDevices.getUserMedia(ze);o.current=He,s.current&&(s.current.srcObject=He),m(null);const Be=He.getVideoTracks()[0];if(Be){const de=Be.getCapabilities();te(!!de.torch),ee(Be.getSettings().facingMode)}else te(!1)}catch(ze){console.error("Error accessing camera:",ze),m("Could not access camera. Please check permissions.")}},[K]);E.useEffect(()=>{if(!n){K();return}let qe=!1;return(async()=>{try{const He=await navigator.mediaDevices.getUserMedia({video:!0});if(qe){He.getTracks().forEach(xe=>xe.stop());return}const de=(await navigator.mediaDevices.enumerateDevices()).filter(xe=>xe.kind==="videoinput");if(He.getTracks().forEach(xe=>xe.stop()),qe)return;if(B(de),de.length>0){let xe=G;xe>=de.length&&(xe=0),await oe(de[xe].deviceId)}else m("No camera found.")}catch(He){console.error(He),m("Could not access camera.")}})(),()=>{qe=!0,K()}},[n,G,oe,K]);const re=()=>{if(s.current&&a.current){const qe=s.current,ze=a.current;ze.width=qe.videoWidth,ze.height=qe.videoHeight,ze.getContext("2d")?.drawImage(qe,0,0,qe.videoWidth,qe.videoHeight),c(ze.toDataURL("image/jpeg",.9)),K()}},me=()=>{W==="user"&&ie?(se(!0),setTimeout(()=>{re(),se(!1)},100)):re()},_e=()=>{m(null),c(null),F(null),j(!1),M(1)},le=async()=>{if(!o.current||!ne)return;const qe=o.current.getVideoTracks()[0];try{await qe.applyConstraints({advanced:[{torch:!Q}]}),Y(!Q)}catch(ze){console.error("Failed to toggle flash",ze)}},fe=E.useCallback((qe,ze)=>{O(ze)},[]),ue=()=>{j(!0),M(1)},ce=async()=>{try{if(l&&D){const qe=await jX(l,D);F(qe),j(!1)}}catch(qe){console.error(qe),m("Failed to crop image")}},Se=()=>{j(!1),M(1),F(null)},ye=async()=>{const qe=q||l;if(qe){x(!0);try{const ze=qe.split(",")[1];_("Enhancing photo...");const Be=(r==="document"?await pe.enhanceDocumentPhoto(ze,"image/jpeg"):null)||ze;t(Be,"image/jpeg"),e()}catch(ze){m(ze.message||"Processing failed.")}finally{x(!1)}}},Ne=()=>{K(),e()};if(!n)return null;const ke=q||l;return i.jsxs("div",{className:"fixed inset-0 z-[200] flex flex-col bg-black text-white",children:[H&&i.jsx("div",{className:"absolute inset-0 bg-white z-50"}),p&&i.jsxs("div",{className:"absolute inset-0 z-40 flex flex-col items-center justify-center bg-black/80",children:[i.jsx(Tt,{className:"h-12 w-12 animate-spin text-white"}),i.jsx("p",{className:"mt-4 text-lg font-semibold",children:v})]}),i.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 bg-gradient-to-b from-black/70 to-transparent z-30 flex justify-between items-center",children:[i.jsx(ae,{variant:"icon",className:"!text-white hover:!bg-white/20 !p-2",onClick:Ne,children:i.jsx(Hi,{className:"h-6 w-6"})}),i.jsx("h3",{className:"text-lg font-bold flex-1 text-center",children:w?"Crop Photo":l?"Preview":"Capture Photo"}),i.jsx("div",{className:"w-10"})]}),i.jsxs("div",{className:"flex-grow relative flex items-center justify-center overflow-hidden bg-black",children:[d&&!l&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white p-4 text-center bg-black/50 z-10",children:d}),w&&l?i.jsx("div",{className:"absolute inset-0",children:i.jsx(wX,{image:l,crop:P,zoom:I,aspect:r==="profile"?1:4/3,onCropChange:k,onCropComplete:fe,onZoomChange:M,cropShape:r==="profile"?"round":"rect",style:{containerStyle:{backgroundColor:"transparent"},mediaStyle:{objectFit:"contain"}},classes:{containerClassName:"bg-black/30"}})}):i.jsxs(i.Fragment,{children:[i.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,muted:!0,className:`w-full h-full object-cover ${l?"hidden":""}`}),ke&&i.jsx("img",{src:ke,alt:"Preview",className:"w-full h-full object-contain"})]}),i.jsx("canvas",{ref:a,className:"hidden"})]}),i.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent z-30",children:[d&&!l&&i.jsx("div",{className:"mb-2 p-3 bg-red-500/30 text-white text-sm rounded-lg text-center",children:d}),w&&i.jsx("div",{className:"mb-4 px-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(vC,{className:"h-5 w-5 text-white/70"}),i.jsx("input",{type:"range",min:1,max:3,step:.1,value:I,onChange:qe=>M(Number(qe.target.value)),className:"flex-1 h-1 bg-white/20 rounded-lg"}),i.jsx(yC,{className:"h-5 w-5 text-white/70"})]})}),i.jsx("div",{className:"flex justify-around items-center",children:w?i.jsxs(i.Fragment,{children:[i.jsx(ae,{onClick:Se,variant:"secondary",size:"lg",className:"!rounded-full !px-6",children:"Cancel"}),i.jsxs(ae,{onClick:ce,size:"lg",className:"!rounded-full !px-6",children:[i.jsx(xl,{className:"h-5 w-5 mr-2"})," Apply"]})]}):l?i.jsxs(i.Fragment,{children:[i.jsx(ae,{onClick:_e,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:i.jsx(yN,{className:"h-6 w-6"})}),i.jsx(ae,{onClick:ue,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:i.jsx(VK,{className:"h-6 w-6"})}),i.jsx(ae,{onClick:ye,size:"lg",className:"!rounded-full !p-4",children:i.jsx(xl,{className:"h-6 w-6"})})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"w-16 h-16 flex items-center justify-center",children:[W==="environment"&&ne&&i.jsx(ae,{onClick:le,variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3",children:Q?i.jsx(fJ,{className:"h-6 w-6"}):i.jsx(hJ,{className:"h-6 w-6"})}),W==="user"&&i.jsx(ae,{onClick:()=>$(!ie),variant:"icon",className:`!rounded-full !p-3 ${ie?"!text-yellow-400":"!text-white"} hover:!bg-white/20`,children:i.jsx($F,{className:"h-6 w-6"})})]}),i.jsx(ae,{onClick:me,disabled:!!d||!o.current,size:"lg",className:"!rounded-full !w-20 !h-20",children:i.jsx(uC,{className:"h-8 w-8"})}),i.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:U.length>1&&i.jsx(ae,{onClick:()=>X(qe=>(qe+1)%U.length),variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3",children:i.jsx(yN,{className:"h-6 w-6"})})})]})})]})]})},NX=({isOpen:n,onClose:e,imageUrl:t})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 p-4",onClick:e,role:"dialog","aria-modal":"true",children:i.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",onClick:r=>r.stopPropagation(),children:[i.jsx("img",{src:t,alt:"Document Preview",className:"max-w-full max-h-full object-contain rounded-lg"}),i.jsx("button",{onClick:e,className:"absolute top-0 right-0 m-2 p-2 bg-black/50 rounded-full text-white hover:bg-black/80 transition-colors","aria-label":"Close image preview",children:i.jsx(Ui,{className:"h-6 w-6"})})]})}):null,xt=({label:n,file:e,onFileChange:t,allowedTypes:r=["image/jpeg","image/png","application/pdf"],error:s,allowCapture:a=!1,costingItemName:o,verificationStatus:l,onOcrComplete:c,ocrSchema:d,setToast:m,docType:p,onVerification:x})=>{const[v,_]=E.useState(!1),[w,j]=E.useState(""),[P,k]=E.useState(!1),[I,M]=E.useState(!1),{logVerificationUsage:D}=Wn.getState(),O=E.useMemo(()=>{const Y=n.toLowerCase();return Y.includes("photo")?"profile":["proof","document","card","slip","passbook","cheque","certificate"].some(ne=>Y.includes(ne))?"document":"none"},[n]),q=E.useCallback(async Y=>{if(!r.includes(Y.type)){j(`Invalid file type. Allowed: ${r.join(", ")}.`);return}if(Y.size>5*1024*1024){j("File size must be less than 5MB.");return}j(""),_(!0);const ne=URL.createObjectURL(Y);let te={name:Y.name,type:Y.type,size:Y.size,preview:ne,file:Y};t(te),o&&D(o);try{const ie=new FileReader;ie.readAsDataURL(Y),ie.onloadend=async()=>{try{const $=ie.result.split(",")[1];if(x){const H=await x($,Y.type);if(!H.success){j(H.reason),_(!1);return}}if(c&&d&&m)try{const H=await pe.extractDataFromImage($,Y.type,d,p);c(H)}catch(H){console.error("OCR failed:",H),m({message:"AI extraction failed. Please check the document.",type:"error"})}}catch($){j($.message||"Processing failed.")}finally{_(!1)}},ie.onerror=()=>{throw new Error("Could not read file for processing.")}}catch(ie){j(ie.message||"Processing failed."),_(!1)}},[r,t,o,D,c,d,m,p,x]),F=E.useCallback(async(Y,ne)=>{const te=await(await fetch(`data:${ne};base64,${Y}`)).blob(),ie=new File([te],`capture-${Date.now()}.jpg`,{type:ne});q(ie)},[q]),U=()=>{e&&URL.revokeObjectURL(e.preview),t(null),j("")},B=`file-upload-${n.replace(/\s+/g,"-")}`,G=s||w,Q=(Y=>{const ne=Y.toLowerCase();return ne.includes("profile photo")?Sl:ne.includes("id proof")||ne.includes("aadhaar")||ne.includes("pan")||ne.includes("voter")?kF:ne.includes("bank proof")?_l:ne.includes("signature")?pN:ne.includes("fingerprint")?DF:ne.includes("certificate")?OF:Vs})(n);return i.jsxs("div",{className:"w-full",children:[i.jsx(NX,{isOpen:I,onClose:()=>M(!1),imageUrl:e?.preview||""}),P&&i.jsx(P3,{isOpen:P,onClose:()=>k(!1),onCapture:F,captureGuidance:O}),i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("label",{className:"block text-sm font-medium text-muted",htmlFor:B,children:n}),l===!0&&i.jsx("span",{title:"Verified",children:i.jsx(Bi,{className:"h-4 w-4 text-green-400"})}),l===!1&&i.jsx("span",{title:"Verification Failed",children:i.jsx(am,{className:"h-4 w-4 text-red-400"})})]}),i.jsx("div",{className:"w-full text-center transition-all duration-300",children:e?i.jsxs("div",{className:"w-full flex flex-col h-full bg-page p-2 border border-border rounded-lg relative pro-dark-theme:bg-[#0d2c18] pro-dark-theme:border-[#123820]",children:[i.jsxs("div",{className:"flex-grow w-full rounded-md overflow-hidden group relative bg-black/10 flex items-center justify-center min-h-[100px]",children:[v?i.jsxs("div",{className:"flex flex-col items-center text-muted",children:[i.jsx(Tt,{className:"h-8 w-8 animate-spin"}),i.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):e.type.startsWith("image/")?i.jsx("img",{src:e.preview,alt:"preview",className:"max-w-full max-h-28 object-contain"}):i.jsxs("div",{className:"text-muted p-2",children:[i.jsx(YK,{className:"h-10 w-10 mx-auto"}),i.jsx("span",{className:"text-xs mt-1 block break-all",children:e.name})]}),i.jsx("label",{htmlFor:B,className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-md cursor-pointer",children:i.jsx(yN,{className:"h-6 w-6 text-white"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 flex-shrink-0",children:[e.type.startsWith("image/")&&i.jsxs("button",{type:"button",onClick:()=>M(!0),className:"text-xs font-medium text-accent hover:underline flex items-center gap-1 p-1",children:[i.jsx(bl,{className:"h-3 w-3"})," View"]}),i.jsxs("button",{type:"button",onClick:U,className:"text-xs font-medium text-red-500 hover:underline flex items-center gap-1 p-1",children:[i.jsx(Xt,{className:"h-3 w-3"})," Remove"]})]})]}):i.jsxs("label",{htmlFor:B,className:`
                        cursor-pointer flex flex-col items-center justify-center
                        p-6 border-2 border-dashed rounded-lg transition-colors
                        border-border hover:border-accent hover:bg-accent-light
                        pro-dark-theme:border-gray-600 pro-dark-theme:hover:border-accent pro-dark-theme:hover:bg-accent-light
                        ${G?"!border-red-500":""}
                    `,children:[i.jsx("div",{className:"p-3 bg-accent-light rounded-full text-accent-dark pro-dark-theme:bg-accent/20 pro-dark-theme:text-accent",children:i.jsx(Q,{className:"h-8 w-8"})}),i.jsx("p",{className:"font-semibold text-primary-text mt-2",children:"Click to upload"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:"or drag & drop"}),a&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-xs text-muted my-2",children:"OR"}),i.jsxs(ae,{type:"button",onClick:Y=>{Y.preventDefault(),k(!0)},variant:"secondary",size:"sm",children:[i.jsx(uC,{className:"h-4 w-4 mr-2"}),"Capture with Camera"]})]})]})}),i.jsx("input",{id:B,type:"file",className:"sr-only",onChange:Y=>Y.target.files?.[0]&&q(Y.target.files[0]),accept:r.join(",")}),i.jsx("div",{className:"text-center mt-1 min-h-[16px]",children:G&&i.jsx("p",{className:"text-xs text-red-500",children:G})})]})};var x0={},gh={},y0={exports:{}},v0,nE;function CX(){if(nE)return v0;nE=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return v0=n,v0}var b0,rE;function TX(){if(rE)return b0;rE=1;var n=CX();function e(){}function t(){}return t.resetWarningCache=e,b0=function(){function r(o,l,c,d,m,p){if(p!==n){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}r.isRequired=r;function s(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:t,resetWarningCache:e};return a.PropTypes=a,a},b0}var sE;function Nl(){return sE||(sE=1,y0.exports=TX()()),y0.exports}var xh={},qd={},_0={exports:{}};var iE;function vu(){return iE||(iE=1,(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var a="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(a=s(a,r(l)))}return a}function r(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return t.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var o="";for(var l in a)e.call(a,l)&&a[l]&&(o=s(o,l));return o}function s(a,o){return o?a?a+" "+o:a+o:a}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(_0)),_0.exports}var w0={},S0={},j0={},N0={},aE;function Ae(){if(aE)return N0;aE=1,N0.toDate=n;function n(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}return N0}var C0={},oE;function an(){if(oE)return C0;oE=1,C0.constructFrom=n;function n(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}return C0}var lE;function Cl(){if(lE)return j0;lE=1,j0.addDays=t;var n=Ae(),e=an();function t(r,s){const a=(0,n.toDate)(r);return isNaN(s)?(0,e.constructFrom)(r,NaN):(s&&a.setDate(a.getDate()+s),a)}return j0}var T0={},cE;function _m(){if(cE)return T0;cE=1,T0.addMonths=t;var n=Ae(),e=an();function t(r,s){const a=(0,n.toDate)(r);if(isNaN(s))return(0,e.constructFrom)(r,NaN);if(!s)return a;const o=a.getDate(),l=(0,e.constructFrom)(r,a.getTime());l.setMonth(a.getMonth()+s+1,0);const c=l.getDate();return o>=c?l:(a.setFullYear(l.getFullYear(),l.getMonth(),o),a)}return T0}var dE;function M3(){if(dE)return S0;dE=1,S0.add=s;var n=Cl(),e=_m(),t=an(),r=Ae();function s(a,o){const{years:l=0,months:c=0,weeks:d=0,days:m=0,hours:p=0,minutes:x=0,seconds:v=0}=o,_=(0,r.toDate)(a),w=c||l?(0,e.addMonths)(_,c+l*12):_,j=m||d?(0,n.addDays)(w,m+d*7):w,P=x+p*60,I=(v+P*60)*1e3;return(0,t.constructFrom)(a,j.getTime()+I)}return S0}var P0={},M0={},uE;function k3(){if(uE)return M0;uE=1,M0.isSaturday=e;var n=Ae();function e(t){return(0,n.toDate)(t).getDay()===6}return M0}var k0={},fE;function E3(){if(fE)return k0;fE=1,k0.isSunday=e;var n=Ae();function e(t){return(0,n.toDate)(t).getDay()===0}return k0}var E0={},hE;function ey(){if(hE)return E0;hE=1,E0.isWeekend=e;var n=Ae();function e(t){const r=(0,n.toDate)(t).getDay();return r===0||r===6}return E0}var mE;function D3(){if(mE)return P0;mE=1,P0.addBusinessDays=a;var n=an(),e=k3(),t=E3(),r=ey(),s=Ae();function a(o,l){const c=(0,s.toDate)(o),d=(0,r.isWeekend)(c);if(isNaN(l))return(0,n.constructFrom)(o,NaN);const m=c.getHours(),p=l<0?-1:1,x=Math.trunc(l/5);c.setDate(c.getDate()+x*7);let v=Math.abs(l%5);for(;v>0;)c.setDate(c.getDate()+p),(0,r.isWeekend)(c)||(v-=1);return d&&(0,r.isWeekend)(c)&&l!==0&&((0,e.isSaturday)(c)&&c.setDate(c.getDate()+(p<0?2:-1)),(0,t.isSunday)(c)&&c.setDate(c.getDate()+(p<0?1:-2))),c.setHours(m),c}return P0}var D0={},O0={},pE;function wm(){if(pE)return O0;pE=1,O0.addMilliseconds=t;var n=Ae(),e=an();function t(r,s){const a=+(0,n.toDate)(r);return(0,e.constructFrom)(r,a+s)}return O0}var kt={},gE;function Kt(){if(gE)return kt;gE=1,kt.secondsInYear=kt.secondsInWeek=kt.secondsInQuarter=kt.secondsInMonth=kt.secondsInMinute=kt.secondsInHour=kt.secondsInDay=kt.quartersInYear=kt.monthsInYear=kt.monthsInQuarter=kt.minutesInYear=kt.minutesInMonth=kt.minutesInHour=kt.minutesInDay=kt.minTime=kt.millisecondsInWeek=kt.millisecondsInSecond=kt.millisecondsInMinute=kt.millisecondsInHour=kt.millisecondsInDay=kt.maxTime=kt.daysInYear=kt.daysInWeek=void 0,kt.daysInWeek=7;const n=kt.daysInYear=365.2425,e=kt.maxTime=Math.pow(10,8)*24*60*60*1e3;kt.minTime=-e,kt.millisecondsInWeek=6048e5,kt.millisecondsInDay=864e5,kt.millisecondsInMinute=6e4,kt.millisecondsInHour=36e5,kt.millisecondsInSecond=1e3,kt.minutesInYear=525600,kt.minutesInMonth=43200,kt.minutesInDay=1440,kt.minutesInHour=60,kt.monthsInQuarter=3,kt.monthsInYear=12,kt.quartersInYear=4;const t=kt.secondsInHour=3600;kt.secondsInMinute=60;const r=kt.secondsInDay=t*24;kt.secondsInWeek=r*7;const s=kt.secondsInYear=r*n,a=kt.secondsInMonth=s/12;return kt.secondsInQuarter=a*3,kt}var xE;function MC(){if(xE)return D0;xE=1,D0.addHours=t;var n=wm(),e=Kt();function t(r,s){return(0,n.addMilliseconds)(r,s*e.millisecondsInHour)}return D0}var I0={},A0={},R0={},L0={},Ap={},yE;function _s(){if(yE)return Ap;yE=1,Ap.getDefaultOptions=e,Ap.setDefaultOptions=t;let n={};function e(){return n}function t(r){n=r}return Ap}var vE;function _o(){if(vE)return L0;vE=1,L0.startOfWeek=t;var n=Ae(),e=_s();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?7:0)+c-o;return l.setDate(l.getDate()-d),l.setHours(0,0,0,0),l}return L0}var bE;function Tl(){if(bE)return R0;bE=1,R0.startOfISOWeek=e;var n=_o();function e(t){return(0,n.startOfWeek)(t,{weekStartsOn:1})}return R0}var _E;function bu(){if(_E)return A0;_E=1,A0.getISOWeekYear=r;var n=an(),e=Tl(),t=Ae();function r(s){const a=(0,t.toDate)(s),o=a.getFullYear(),l=(0,n.constructFrom)(s,0);l.setFullYear(o+1,0,4),l.setHours(0,0,0,0);const c=(0,e.startOfISOWeek)(l),d=(0,n.constructFrom)(s,0);d.setFullYear(o,0,4),d.setHours(0,0,0,0);const m=(0,e.startOfISOWeek)(d);return a.getTime()>=c.getTime()?o+1:a.getTime()>=m.getTime()?o:o-1}return A0}var F0={},q0={},z0={},wE;function ty(){if(wE)return z0;wE=1,z0.startOfDay=e;var n=Ae();function e(t){const r=(0,n.toDate)(t);return r.setHours(0,0,0,0),r}return z0}var U0={},SE;function Jc(){if(SE)return U0;SE=1,U0.getTimezoneOffsetInMilliseconds=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+t-+s}return U0}var jE;function Qc(){if(jE)return q0;jE=1,q0.differenceInCalendarDays=r;var n=Kt(),e=ty(),t=Jc();function r(s,a){const o=(0,e.startOfDay)(s),l=(0,e.startOfDay)(a),c=+o-(0,t.getTimezoneOffsetInMilliseconds)(o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l);return Math.round((c-d)/n.millisecondsInDay)}return q0}var V0={},NE;function Sm(){if(NE)return V0;NE=1,V0.startOfISOWeekYear=r;var n=bu(),e=Tl(),t=an();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);return o.setFullYear(a,0,4),o.setHours(0,0,0,0),(0,e.startOfISOWeek)(o)}return V0}var CE;function O3(){if(CE)return F0;CE=1,F0.setISOWeekYear=s;var n=an(),e=Qc(),t=Sm(),r=Ae();function s(a,o){let l=(0,r.toDate)(a);const c=(0,e.differenceInCalendarDays)(l,(0,t.startOfISOWeekYear)(l)),d=(0,n.constructFrom)(a,0);return d.setFullYear(o,0,4),d.setHours(0,0,0,0),l=(0,t.startOfISOWeekYear)(d),l.setDate(l.getDate()+c),l}return F0}var TE;function I3(){if(TE)return I0;TE=1,I0.addISOWeekYears=t;var n=bu(),e=O3();function t(r,s){return(0,e.setISOWeekYear)(r,(0,n.getISOWeekYear)(r)+s)}return I0}var B0={},PE;function kC(){if(PE)return B0;PE=1,B0.addMinutes=t;var n=wm(),e=Kt();function t(r,s){return(0,n.addMilliseconds)(r,s*e.millisecondsInMinute)}return B0}var W0={},ME;function EC(){if(ME)return W0;ME=1,W0.addQuarters=e;var n=_m();function e(t,r){const s=r*3;return(0,n.addMonths)(t,s)}return W0}var $0={},kE;function A3(){if(kE)return $0;kE=1,$0.addSeconds=e;var n=wm();function e(t,r){return(0,n.addMilliseconds)(t,r*1e3)}return $0}var H0={},EE;function ny(){if(EE)return H0;EE=1,H0.addWeeks=e;var n=Cl();function e(t,r){const s=r*7;return(0,n.addDays)(t,s)}return H0}var Y0={},DE;function R3(){if(DE)return Y0;DE=1,Y0.addYears=e;var n=_m();function e(t,r){return(0,n.addMonths)(t,r*12)}return Y0}var G0={},OE;function PX(){if(OE)return G0;OE=1,G0.areIntervalsOverlapping=e;var n=Ae();function e(t,r,s){const[a,o]=[+(0,n.toDate)(t.start),+(0,n.toDate)(t.end)].sort((d,m)=>d-m),[l,c]=[+(0,n.toDate)(r.start),+(0,n.toDate)(r.end)].sort((d,m)=>d-m);return s?.inclusive?a<=c&&l<=o:a<c&&l<o}return G0}var Z0={},K0={},IE;function L3(){if(IE)return K0;IE=1,K0.max=e;var n=Ae();function e(t){let r;return t.forEach(function(s){const a=(0,n.toDate)(s);(r===void 0||r<a||isNaN(Number(a)))&&(r=a)}),r||new Date(NaN)}return K0}var J0={},AE;function F3(){if(AE)return J0;AE=1,J0.min=e;var n=Ae();function e(t){let r;return t.forEach(s=>{const a=(0,n.toDate)(s);(!r||r>a||isNaN(+a))&&(r=a)}),r||new Date(NaN)}return J0}var RE;function MX(){if(RE)return Z0;RE=1,Z0.clamp=t;var n=L3(),e=F3();function t(r,s){return(0,e.min)([(0,n.max)([r,s.start]),s.end])}return Z0}var Q0={},LE;function kX(){if(LE)return Q0;LE=1,Q0.closestIndexTo=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t);if(isNaN(Number(s)))return NaN;const a=s.getTime();let o,l;return r.forEach(function(c,d){const m=(0,n.toDate)(c);if(isNaN(Number(m))){o=NaN,l=NaN;return}const p=Math.abs(a-m.getTime());(o==null||p<l)&&(o=d,l=p)}),o}return Q0}var X0={},FE;function EX(){if(FE)return X0;FE=1,X0.closestTo=t;var n=an(),e=Ae();function t(r,s){const a=(0,e.toDate)(r);if(isNaN(Number(a)))return(0,n.constructFrom)(r,NaN);const o=a.getTime();let l,c;return s.forEach(d=>{const m=(0,e.toDate)(d);if(isNaN(Number(m))){l=(0,n.constructFrom)(r,NaN),c=NaN;return}const p=Math.abs(o-m.getTime());(l==null||p<c)&&(l=m,c=p)}),l}return X0}var eb={},qE;function Lf(){if(qE)return eb;qE=1,eb.compareAsc=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getTime()-a.getTime();return o<0?-1:o>0?1:o}return eb}var tb={},zE;function DX(){if(zE)return tb;zE=1,tb.compareDesc=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getTime()-a.getTime();return o>0?-1:o<0?1:o}return tb}var nb={},UE;function $s(){if(UE)return nb;UE=1,nb.constructNow=e;var n=an();function e(t){return(0,n.constructFrom)(t,Date.now())}return nb}var rb={},VE;function OX(){if(VE)return rb;VE=1,rb.daysToWeeks=e;var n=Kt();function e(t){const r=t/n.daysInWeek,s=Math.trunc(r);return s===0?0:s}return rb}var sb={},ib={},BE;function jm(){if(BE)return ib;BE=1,ib.isSameDay=e;var n=ty();function e(t,r){const s=(0,n.startOfDay)(t),a=(0,n.startOfDay)(r);return+s==+a}return ib}var ab={},ob={},WE;function q3(){if(WE)return ob;WE=1,ob.isDate=n;function n(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}return ob}var $E;function Xc(){if($E)return ab;$E=1,ab.isValid=t;var n=q3(),e=Ae();function t(r){if(!(0,n.isDate)(r)&&typeof r!="number")return!1;const s=(0,e.toDate)(r);return!isNaN(Number(s))}return ab}var HE;function IX(){if(HE)return sb;HE=1,sb.differenceInBusinessDays=o;var n=Cl(),e=Qc(),t=jm(),r=Xc(),s=ey(),a=Ae();function o(l,c){const d=(0,a.toDate)(l);let m=(0,a.toDate)(c);if(!(0,r.isValid)(d)||!(0,r.isValid)(m))return NaN;const p=(0,e.differenceInCalendarDays)(d,m),x=p<0?-1:1,v=Math.trunc(p/7);let _=v*5;for(m=(0,n.addDays)(m,v*7);!(0,t.isSameDay)(d,m);)_+=(0,s.isWeekend)(m)?0:x,m=(0,n.addDays)(m,x);return _===0?0:_}return sb}var lb={},YE;function z3(){if(YE)return lb;YE=1,lb.differenceInCalendarISOWeekYears=e;var n=bu();function e(t,r){return(0,n.getISOWeekYear)(t)-(0,n.getISOWeekYear)(r)}return lb}var cb={},GE;function AX(){if(GE)return cb;GE=1,cb.differenceInCalendarISOWeeks=r;var n=Kt(),e=Tl(),t=Jc();function r(s,a){const o=(0,e.startOfISOWeek)(s),l=(0,e.startOfISOWeek)(a),c=+o-(0,t.getTimezoneOffsetInMilliseconds)(o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l);return Math.round((c-d)/n.millisecondsInWeek)}return cb}var db={},ZE;function DC(){if(ZE)return db;ZE=1,db.differenceInCalendarMonths=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getFullYear()-a.getFullYear(),l=s.getMonth()-a.getMonth();return o*12+l}return db}var ub={},fb={},KE;function U3(){if(KE)return fb;KE=1,fb.getQuarter=e;var n=Ae();function e(t){const r=(0,n.toDate)(t);return Math.trunc(r.getMonth()/3)+1}return fb}var JE;function V3(){if(JE)return ub;JE=1,ub.differenceInCalendarQuarters=t;var n=U3(),e=Ae();function t(r,s){const a=(0,e.toDate)(r),o=(0,e.toDate)(s),l=a.getFullYear()-o.getFullYear(),c=(0,n.getQuarter)(a)-(0,n.getQuarter)(o);return l*4+c}return ub}var hb={},QE;function OC(){if(QE)return hb;QE=1,hb.differenceInCalendarWeeks=r;var n=Kt(),e=_o(),t=Jc();function r(s,a,o){const l=(0,e.startOfWeek)(s,o),c=(0,e.startOfWeek)(a,o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l),m=+c-(0,t.getTimezoneOffsetInMilliseconds)(c);return Math.round((d-m)/n.millisecondsInWeek)}return hb}var mb={},XE;function IC(){if(XE)return mb;XE=1,mb.differenceInCalendarYears=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()-a.getFullYear()}return mb}var pb={},eD;function AC(){if(eD)return pb;eD=1,pb.differenceInDays=t;var n=Qc(),e=Ae();function t(s,a){const o=(0,e.toDate)(s),l=(0,e.toDate)(a),c=r(o,l),d=Math.abs((0,n.differenceInCalendarDays)(o,l));o.setDate(o.getDate()-c*d);const m=+(r(o,l)===-c),p=c*(d-m);return p===0?0:p}function r(s,a){const o=s.getFullYear()-a.getFullYear()||s.getMonth()-a.getMonth()||s.getDate()-a.getDate()||s.getHours()-a.getHours()||s.getMinutes()-a.getMinutes()||s.getSeconds()-a.getSeconds()||s.getMilliseconds()-a.getMilliseconds();return o<0?-1:o>0?1:o}return pb}var gb={},xb={},tD;function ed(){if(tD)return xb;tD=1,xb.getRoundingMethod=n;function n(e){return t=>{const s=(e?Math[e]:Math.trunc)(t);return s===0?0:s}}return xb}var yb={},nD;function ry(){if(nD)return yb;nD=1,yb.differenceInMilliseconds=e;var n=Ae();function e(t,r){return+(0,n.toDate)(t)-+(0,n.toDate)(r)}return yb}var rD;function RC(){if(rD)return gb;rD=1,gb.differenceInHours=r;var n=ed(),e=Kt(),t=ry();function r(s,a,o){const l=(0,t.differenceInMilliseconds)(s,a)/e.millisecondsInHour;return(0,n.getRoundingMethod)(o?.roundingMethod)(l)}return gb}var vb={},bb={},sD;function B3(){if(sD)return bb;sD=1,bb.subISOWeekYears=e;var n=I3();function e(t,r){return(0,n.addISOWeekYears)(t,-r)}return bb}var iD;function RX(){if(iD)return vb;iD=1,vb.differenceInISOWeekYears=s;var n=Lf(),e=z3(),t=B3(),r=Ae();function s(a,o){let l=(0,r.toDate)(a);const c=(0,r.toDate)(o),d=(0,n.compareAsc)(l,c),m=Math.abs((0,e.differenceInCalendarISOWeekYears)(l,c));l=(0,t.subISOWeekYears)(l,d*m);const p=+((0,n.compareAsc)(l,c)===-d),x=d*(m-p);return x===0?0:x}return vb}var _b={},aD;function LC(){if(aD)return _b;aD=1,_b.differenceInMinutes=r;var n=ed(),e=Kt(),t=ry();function r(s,a,o){const l=(0,t.differenceInMilliseconds)(s,a)/e.millisecondsInMinute;return(0,n.getRoundingMethod)(o?.roundingMethod)(l)}return _b}var wb={},Sb={},jb={},oD;function FC(){if(oD)return jb;oD=1,jb.endOfDay=e;var n=Ae();function e(t){const r=(0,n.toDate)(t);return r.setHours(23,59,59,999),r}return jb}var Nb={},lD;function qC(){if(lD)return Nb;lD=1,Nb.endOfMonth=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(23,59,59,999),r}return Nb}var cD;function W3(){if(cD)return Sb;cD=1,Sb.isLastDayOfMonth=r;var n=FC(),e=qC(),t=Ae();function r(s){const a=(0,t.toDate)(s);return+(0,n.endOfDay)(a)==+(0,e.endOfMonth)(a)}return Sb}var dD;function sy(){if(dD)return wb;dD=1,wb.differenceInMonths=s;var n=Lf(),e=DC(),t=W3(),r=Ae();function s(a,o){const l=(0,r.toDate)(a),c=(0,r.toDate)(o),d=(0,n.compareAsc)(l,c),m=Math.abs((0,e.differenceInCalendarMonths)(l,c));let p;if(m<1)p=0;else{l.getMonth()===1&&l.getDate()>27&&l.setDate(30),l.setMonth(l.getMonth()-d*m);let x=(0,n.compareAsc)(l,c)===-d;(0,t.isLastDayOfMonth)((0,r.toDate)(a))&&m===1&&(0,n.compareAsc)(a,c)===1&&(x=!1),p=d*(m-Number(x))}return p===0?0:p}return wb}var Cb={},uD;function LX(){if(uD)return Cb;uD=1,Cb.differenceInQuarters=t;var n=ed(),e=sy();function t(r,s,a){const o=(0,e.differenceInMonths)(r,s)/3;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return Cb}var Tb={},fD;function iy(){if(fD)return Tb;fD=1,Tb.differenceInSeconds=t;var n=ed(),e=ry();function t(r,s,a){const o=(0,e.differenceInMilliseconds)(r,s)/1e3;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return Tb}var Pb={},hD;function FX(){if(hD)return Pb;hD=1,Pb.differenceInWeeks=t;var n=ed(),e=AC();function t(r,s,a){const o=(0,e.differenceInDays)(r,s)/7;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return Pb}var Mb={},mD;function $3(){if(mD)return Mb;mD=1,Mb.differenceInYears=r;var n=Lf(),e=IC(),t=Ae();function r(s,a){const o=(0,t.toDate)(s),l=(0,t.toDate)(a),c=(0,n.compareAsc)(o,l),d=Math.abs((0,e.differenceInCalendarYears)(o,l));o.setFullYear(1584),l.setFullYear(1584);const m=(0,n.compareAsc)(o,l)===-c,p=c*(d-+m);return p===0?0:p}return Mb}var kb={},pD;function H3(){if(pD)return kb;pD=1,kb.eachDayOfInterval=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const m=[];for(;+c<=l;)m.push((0,n.toDate)(c)),c.setDate(c.getDate()+d),c.setHours(0,0,0,0);return o?m.reverse():m}return kb}var Eb={},gD;function qX(){if(gD)return Eb;gD=1,Eb.eachHourOfInterval=t;var n=MC(),e=Ae();function t(r,s){const a=(0,e.toDate)(r.start),o=(0,e.toDate)(r.end);let l=+a>+o;const c=l?+a:+o;let d=l?o:a;d.setMinutes(0,0,0);let m=s?.step??1;if(!m)return[];m<0&&(m=-m,l=!l);const p=[];for(;+d<=c;)p.push((0,e.toDate)(d)),d=(0,n.addHours)(d,m);return l?p.reverse():p}return Eb}var Db={},Ob={},xD;function zC(){if(xD)return Ob;xD=1,Ob.startOfMinute=e;var n=Ae();function e(t){const r=(0,n.toDate)(t);return r.setSeconds(0,0),r}return Ob}var yD;function zX(){if(yD)return Db;yD=1,Db.eachMinuteOfInterval=r;var n=kC(),e=zC(),t=Ae();function r(s,a){const o=(0,e.startOfMinute)((0,t.toDate)(s.start)),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?+o:+l;let m=c?l:o,p=a?.step??1;if(!p)return[];p<0&&(p=-p,c=!c);const x=[];for(;+m<=d;)x.push((0,t.toDate)(m)),m=(0,n.addMinutes)(m,p);return c?x.reverse():x}return Db}var Ib={},vD;function UX(){if(vD)return Ib;vD=1,Ib.eachMonthOfInterval=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0),c.setDate(1);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const m=[];for(;+c<=l;)m.push((0,n.toDate)(c)),c.setMonth(c.getMonth()+d);return o?m.reverse():m}return Ib}var Ab={},Rb={},bD;function UC(){if(bD)return Rb;bD=1,Rb.startOfQuarter=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3;return r.setMonth(a,1),r.setHours(0,0,0,0),r}return Rb}var _D;function VX(){if(_D)return Ab;_D=1,Ab.eachQuarterOfInterval=r;var n=EC(),e=UC(),t=Ae();function r(s,a){const o=(0,t.toDate)(s.start),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?+(0,e.startOfQuarter)(o):+(0,e.startOfQuarter)(l);let m=c?(0,e.startOfQuarter)(l):(0,e.startOfQuarter)(o),p=a?.step??1;if(!p)return[];p<0&&(p=-p,c=!c);const x=[];for(;+m<=d;)x.push((0,t.toDate)(m)),m=(0,n.addQuarters)(m,p);return c?x.reverse():x}return Ab}var Lb={},wD;function BX(){if(wD)return Lb;wD=1,Lb.eachWeekOfInterval=r;var n=ny(),e=_o(),t=Ae();function r(s,a){const o=(0,t.toDate)(s.start),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?(0,e.startOfWeek)(l,a):(0,e.startOfWeek)(o,a),m=c?(0,e.startOfWeek)(o,a):(0,e.startOfWeek)(l,a);d.setHours(15),m.setHours(15);const p=+m.getTime();let x=d,v=a?.step??1;if(!v)return[];v<0&&(v=-v,c=!c);const _=[];for(;+x<=p;)x.setHours(0),_.push((0,t.toDate)(x)),x=(0,n.addWeeks)(x,v),x.setHours(15);return c?_.reverse():_}return Lb}var Fb={},SD;function VC(){if(SD)return Fb;SD=1,Fb.eachWeekendOfInterval=t;var n=H3(),e=ey();function t(r){const s=(0,n.eachDayOfInterval)(r),a=[];let o=0;for(;o<s.length;){const l=s[o++];(0,e.isWeekend)(l)&&a.push(l)}return a}return Fb}var qb={},zb={},jD;function ay(){if(jD)return zb;jD=1,zb.startOfMonth=e;var n=Ae();function e(t){const r=(0,n.toDate)(t);return r.setDate(1),r.setHours(0,0,0,0),r}return zb}var ND;function WX(){if(ND)return qb;ND=1,qb.eachWeekendOfMonth=r;var n=VC(),e=qC(),t=ay();function r(s){const a=(0,t.startOfMonth)(s),o=(0,e.endOfMonth)(s);return(0,n.eachWeekendOfInterval)({start:a,end:o})}return qb}var Ub={},Vb={},CD;function Y3(){if(CD)return Vb;CD=1,Vb.endOfYear=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(23,59,59,999),r}return Vb}var Bb={},TD;function BC(){if(TD)return Bb;TD=1,Bb.startOfYear=t;var n=Ae(),e=an();function t(r){const s=(0,n.toDate)(r),a=(0,e.constructFrom)(r,0);return a.setFullYear(s.getFullYear(),0,1),a.setHours(0,0,0,0),a}return Bb}var PD;function $X(){if(PD)return Ub;PD=1,Ub.eachWeekendOfYear=r;var n=VC(),e=Y3(),t=BC();function r(s){const a=(0,t.startOfYear)(s),o=(0,e.endOfYear)(s);return(0,n.eachWeekendOfInterval)({start:a,end:o})}return Ub}var Wb={},MD;function HX(){if(MD)return Wb;MD=1,Wb.eachYearOfInterval=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0),c.setMonth(0,1);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const m=[];for(;+c<=l;)m.push((0,n.toDate)(c)),c.setFullYear(c.getFullYear()+d);return o?m.reverse():m}return Wb}var $b={},kD;function YX(){if(kD)return $b;kD=1,$b.endOfDecade=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=9+Math.floor(s/10)*10;return r.setFullYear(a,11,31),r.setHours(23,59,59,999),r}return $b}var Hb={},ED;function GX(){if(ED)return Hb;ED=1,Hb.endOfHour=e;var n=Ae();function e(t){const r=(0,n.toDate)(t);return r.setMinutes(59,59,999),r}return Hb}var Yb={},Gb={},DD;function G3(){if(DD)return Gb;DD=1,Gb.endOfWeek=t;var n=Ae(),e=_s();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?-7:0)+6-(c-o);return l.setDate(l.getDate()+d),l.setHours(23,59,59,999),l}return Gb}var OD;function ZX(){if(OD)return Yb;OD=1,Yb.endOfISOWeek=e;var n=G3();function e(t){return(0,n.endOfWeek)(t,{weekStartsOn:1})}return Yb}var Zb={},ID;function KX(){if(ID)return Zb;ID=1,Zb.endOfISOWeekYear=r;var n=bu(),e=Tl(),t=an();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const l=(0,e.startOfISOWeek)(o);return l.setMilliseconds(l.getMilliseconds()-1),l}return Zb}var Kb={},AD;function JX(){if(AD)return Kb;AD=1,Kb.endOfMinute=e;var n=Ae();function e(t){const r=(0,n.toDate)(t);return r.setSeconds(59,999),r}return Kb}var Jb={},RD;function QX(){if(RD)return Jb;RD=1,Jb.endOfQuarter=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3+3;return r.setMonth(a,0),r.setHours(23,59,59,999),r}return Jb}var Qb={},LD;function XX(){if(LD)return Qb;LD=1,Qb.endOfSecond=e;var n=Ae();function e(t){const r=(0,n.toDate)(t);return r.setMilliseconds(999),r}return Qb}var Xb={},FD;function eee(){if(FD)return Xb;FD=1,Xb.endOfToday=e;var n=FC();function e(){return(0,n.endOfDay)(Date.now())}return Xb}var e_={},qD;function tee(){if(qD)return e_;qD=1,e_.endOfTomorrow=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s+1),a.setHours(23,59,59,999),a}return e_}var t_={},zD;function nee(){if(zD)return t_;zD=1,t_.endOfYesterday=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s-1),a.setHours(23,59,59,999),a}return t_}var n_={},r_={},Rp={},Lp={},UD;function ree(){if(UD)return Lp;UD=1,Lp.formatDistance=void 0;const n={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},e=(t,r,s)=>{let a;const o=n[t];return typeof o=="string"?a=o:r===1?a=o.one:a=o.other.replace("{{count}}",r.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};return Lp.formatDistance=e,Lp}var Fp={},s_={},VD;function see(){if(VD)return s_;VD=1,s_.buildFormatLongFn=n;function n(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}return s_}var BD;function iee(){if(BD)return Fp;BD=1,Fp.formatLong=void 0;var n=see();const e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},t={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},r={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"};return Fp.formatLong={date:(0,n.buildFormatLongFn)({formats:e,defaultWidth:"full"}),time:(0,n.buildFormatLongFn)({formats:t,defaultWidth:"full"}),dateTime:(0,n.buildFormatLongFn)({formats:r,defaultWidth:"full"})},Fp}var qp={},WD;function aee(){if(WD)return qp;WD=1,qp.formatRelative=void 0;const n={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},e=(t,r,s,a)=>n[t];return qp.formatRelative=e,qp}var zp={},i_={},$D;function oee(){if($D)return i_;$D=1,i_.buildLocalizeFn=n;function n(e){return(t,r)=>{const s=r?.context?String(r.context):"standalone";let a;if(s==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=r?.width?String(r.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=r?.width?String(r.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(t):t;return a[o]}}return i_}var HD;function lee(){if(HD)return zp;HD=1,zp.localize=void 0;var n=oee();const e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},t={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},r={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},s={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},a={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},o={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},l=(c,d)=>{const m=Number(c),p=m%100;if(p>20||p<10)switch(p%10){case 1:return m+"st";case 2:return m+"nd";case 3:return m+"rd"}return m+"th"};return zp.localize={ordinalNumber:l,era:(0,n.buildLocalizeFn)({values:e,defaultWidth:"wide"}),quarter:(0,n.buildLocalizeFn)({values:t,defaultWidth:"wide",argumentCallback:c=>c-1}),month:(0,n.buildLocalizeFn)({values:r,defaultWidth:"wide"}),day:(0,n.buildLocalizeFn)({values:s,defaultWidth:"wide"}),dayPeriod:(0,n.buildLocalizeFn)({values:a,defaultWidth:"wide",formattingValues:o,defaultFormattingWidth:"wide"})},zp}var Up={},a_={},YD;function cee(){if(YD)return a_;YD=1,a_.buildMatchFn=n;function n(r){return(s,a={})=>{const o=a.width,l=o&&r.matchPatterns[o]||r.matchPatterns[r.defaultMatchWidth],c=s.match(l);if(!c)return null;const d=c[0],m=o&&r.parsePatterns[o]||r.parsePatterns[r.defaultParseWidth],p=Array.isArray(m)?t(m,_=>_.test(d)):e(m,_=>_.test(d));let x;x=r.valueCallback?r.valueCallback(p):p,x=a.valueCallback?a.valueCallback(x):x;const v=s.slice(d.length);return{value:x,rest:v}}}function e(r,s){for(const a in r)if(Object.prototype.hasOwnProperty.call(r,a)&&s(r[a]))return a}function t(r,s){for(let a=0;a<r.length;a++)if(s(r[a]))return a}return a_}var o_={},GD;function dee(){if(GD)return o_;GD=1,o_.buildMatchPatternFn=n;function n(e){return(t,r={})=>{const s=t.match(e.matchPattern);if(!s)return null;const a=s[0],o=t.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=r.valueCallback?r.valueCallback(l):l;const c=t.slice(a.length);return{value:l,rest:c}}}return o_}var ZD;function uee(){if(ZD)return Up;ZD=1,Up.match=void 0;var n=cee(),e=dee();const t=/^(\d+)(th|st|nd|rd)?/i,r=/\d+/i,s={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},a={any:[/^b/i,/^(a|c)/i]},o={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},l={any:[/1/i,/2/i,/3/i,/4/i]},c={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},d={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},m={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},p={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},x={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},v={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}};return Up.match={ordinalNumber:(0,e.buildMatchPatternFn)({matchPattern:t,parsePattern:r,valueCallback:_=>parseInt(_,10)}),era:(0,n.buildMatchFn)({matchPatterns:s,defaultMatchWidth:"wide",parsePatterns:a,defaultParseWidth:"any"}),quarter:(0,n.buildMatchFn)({matchPatterns:o,defaultMatchWidth:"wide",parsePatterns:l,defaultParseWidth:"any",valueCallback:_=>_+1}),month:(0,n.buildMatchFn)({matchPatterns:c,defaultMatchWidth:"wide",parsePatterns:d,defaultParseWidth:"any"}),day:(0,n.buildMatchFn)({matchPatterns:m,defaultMatchWidth:"wide",parsePatterns:p,defaultParseWidth:"any"}),dayPeriod:(0,n.buildMatchFn)({matchPatterns:x,defaultMatchWidth:"any",parsePatterns:v,defaultParseWidth:"any"})},Up}var KD;function Z3(){if(KD)return Rp;KD=1,Rp.enUS=void 0;var n=ree(),e=iee(),t=aee(),r=lee(),s=uee();return Rp.enUS={code:"en-US",formatDistance:n.formatDistance,formatLong:e.formatLong,formatRelative:t.formatRelative,localize:r.localize,match:s.match,options:{weekStartsOn:0,firstWeekContainsDate:1}},Rp}var JD;function Ff(){return JD||(JD=1,(function(n){Object.defineProperty(n,"defaultLocale",{enumerable:!0,get:function(){return e.enUS}});var e=Z3()})(r_)),r_}var Vp={},l_={},QD;function K3(){if(QD)return l_;QD=1,l_.getDayOfYear=r;var n=Qc(),e=BC(),t=Ae();function r(s){const a=(0,t.toDate)(s);return(0,n.differenceInCalendarDays)(a,(0,e.startOfYear)(a))+1}return l_}var c_={},XD;function WC(){if(XD)return c_;XD=1,c_.getISOWeek=s;var n=Kt(),e=Tl(),t=Sm(),r=Ae();function s(a){const o=(0,r.toDate)(a),l=+(0,e.startOfISOWeek)(o)-+(0,t.startOfISOWeekYear)(o);return Math.round(l/n.millisecondsInWeek)+1}return c_}var d_={},u_={},f_={},e2;function oy(){if(e2)return f_;e2=1,f_.getWeekYear=s;var n=an(),e=_o(),t=Ae(),r=_s();function s(a,o){const l=(0,t.toDate)(a),c=l.getFullYear(),d=(0,r.getDefaultOptions)(),m=o?.firstWeekContainsDate??o?.locale?.options?.firstWeekContainsDate??d.firstWeekContainsDate??d.locale?.options?.firstWeekContainsDate??1,p=(0,n.constructFrom)(a,0);p.setFullYear(c+1,0,m),p.setHours(0,0,0,0);const x=(0,e.startOfWeek)(p,o),v=(0,n.constructFrom)(a,0);v.setFullYear(c,0,m),v.setHours(0,0,0,0);const _=(0,e.startOfWeek)(v,o);return l.getTime()>=x.getTime()?c+1:l.getTime()>=_.getTime()?c:c-1}return f_}var t2;function $C(){if(t2)return u_;t2=1,u_.startOfWeekYear=s;var n=an(),e=oy(),t=_o(),r=_s();function s(a,o){const l=(0,r.getDefaultOptions)(),c=o?.firstWeekContainsDate??o?.locale?.options?.firstWeekContainsDate??l.firstWeekContainsDate??l.locale?.options?.firstWeekContainsDate??1,d=(0,e.getWeekYear)(a,o),m=(0,n.constructFrom)(a,0);return m.setFullYear(d,0,c),m.setHours(0,0,0,0),(0,t.startOfWeek)(m,o)}return u_}var n2;function HC(){if(n2)return d_;n2=1,d_.getWeek=s;var n=Kt(),e=_o(),t=$C(),r=Ae();function s(a,o){const l=(0,r.toDate)(a),c=+(0,e.startOfWeek)(l,o)-+(0,t.startOfWeekYear)(l,o);return Math.round(c/n.millisecondsInWeek)+1}return d_}var h_={},r2;function qf(){if(r2)return h_;r2=1,h_.addLeadingZeros=n;function n(e,t){const r=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return r+s}return h_}var Bp={},s2;function J3(){if(s2)return Bp;s2=1,Bp.lightFormatters=void 0;var n=qf();return Bp.lightFormatters={y(e,t){const r=e.getFullYear(),s=r>0?r:1-r;return(0,n.addLeadingZeros)(t==="yy"?s%100:s,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):(0,n.addLeadingZeros)(r+1,2)},d(e,t){return(0,n.addLeadingZeros)(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return(0,n.addLeadingZeros)(e.getHours()%12||12,t.length)},H(e,t){return(0,n.addLeadingZeros)(e.getHours(),t.length)},m(e,t){return(0,n.addLeadingZeros)(e.getMinutes(),t.length)},s(e,t){return(0,n.addLeadingZeros)(e.getSeconds(),t.length)},S(e,t){const r=t.length,s=e.getMilliseconds(),a=Math.trunc(s*Math.pow(10,r-3));return(0,n.addLeadingZeros)(a,t.length)}},Bp}var i2;function fee(){if(i2)return Vp;i2=1,Vp.formatters=void 0;var n=K3(),e=WC(),t=bu(),r=HC(),s=oy(),a=qf(),o=J3();const l={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"};Vp.formatters={G:function(p,x,v){const _=p.getFullYear()>0?1:0;switch(x){case"G":case"GG":case"GGG":return v.era(_,{width:"abbreviated"});case"GGGGG":return v.era(_,{width:"narrow"});case"GGGG":default:return v.era(_,{width:"wide"})}},y:function(p,x,v){if(x==="yo"){const _=p.getFullYear(),w=_>0?_:1-_;return v.ordinalNumber(w,{unit:"year"})}return o.lightFormatters.y(p,x)},Y:function(p,x,v,_){const w=(0,s.getWeekYear)(p,_),j=w>0?w:1-w;if(x==="YY"){const P=j%100;return(0,a.addLeadingZeros)(P,2)}return x==="Yo"?v.ordinalNumber(j,{unit:"year"}):(0,a.addLeadingZeros)(j,x.length)},R:function(p,x){const v=(0,t.getISOWeekYear)(p);return(0,a.addLeadingZeros)(v,x.length)},u:function(p,x){const v=p.getFullYear();return(0,a.addLeadingZeros)(v,x.length)},Q:function(p,x,v){const _=Math.ceil((p.getMonth()+1)/3);switch(x){case"Q":return String(_);case"QQ":return(0,a.addLeadingZeros)(_,2);case"Qo":return v.ordinalNumber(_,{unit:"quarter"});case"QQQ":return v.quarter(_,{width:"abbreviated",context:"formatting"});case"QQQQQ":return v.quarter(_,{width:"narrow",context:"formatting"});case"QQQQ":default:return v.quarter(_,{width:"wide",context:"formatting"})}},q:function(p,x,v){const _=Math.ceil((p.getMonth()+1)/3);switch(x){case"q":return String(_);case"qq":return(0,a.addLeadingZeros)(_,2);case"qo":return v.ordinalNumber(_,{unit:"quarter"});case"qqq":return v.quarter(_,{width:"abbreviated",context:"standalone"});case"qqqqq":return v.quarter(_,{width:"narrow",context:"standalone"});case"qqqq":default:return v.quarter(_,{width:"wide",context:"standalone"})}},M:function(p,x,v){const _=p.getMonth();switch(x){case"M":case"MM":return o.lightFormatters.M(p,x);case"Mo":return v.ordinalNumber(_+1,{unit:"month"});case"MMM":return v.month(_,{width:"abbreviated",context:"formatting"});case"MMMMM":return v.month(_,{width:"narrow",context:"formatting"});case"MMMM":default:return v.month(_,{width:"wide",context:"formatting"})}},L:function(p,x,v){const _=p.getMonth();switch(x){case"L":return String(_+1);case"LL":return(0,a.addLeadingZeros)(_+1,2);case"Lo":return v.ordinalNumber(_+1,{unit:"month"});case"LLL":return v.month(_,{width:"abbreviated",context:"standalone"});case"LLLLL":return v.month(_,{width:"narrow",context:"standalone"});case"LLLL":default:return v.month(_,{width:"wide",context:"standalone"})}},w:function(p,x,v,_){const w=(0,r.getWeek)(p,_);return x==="wo"?v.ordinalNumber(w,{unit:"week"}):(0,a.addLeadingZeros)(w,x.length)},I:function(p,x,v){const _=(0,e.getISOWeek)(p);return x==="Io"?v.ordinalNumber(_,{unit:"week"}):(0,a.addLeadingZeros)(_,x.length)},d:function(p,x,v){return x==="do"?v.ordinalNumber(p.getDate(),{unit:"date"}):o.lightFormatters.d(p,x)},D:function(p,x,v){const _=(0,n.getDayOfYear)(p);return x==="Do"?v.ordinalNumber(_,{unit:"dayOfYear"}):(0,a.addLeadingZeros)(_,x.length)},E:function(p,x,v){const _=p.getDay();switch(x){case"E":case"EE":case"EEE":return v.day(_,{width:"abbreviated",context:"formatting"});case"EEEEE":return v.day(_,{width:"narrow",context:"formatting"});case"EEEEEE":return v.day(_,{width:"short",context:"formatting"});case"EEEE":default:return v.day(_,{width:"wide",context:"formatting"})}},e:function(p,x,v,_){const w=p.getDay(),j=(w-_.weekStartsOn+8)%7||7;switch(x){case"e":return String(j);case"ee":return(0,a.addLeadingZeros)(j,2);case"eo":return v.ordinalNumber(j,{unit:"day"});case"eee":return v.day(w,{width:"abbreviated",context:"formatting"});case"eeeee":return v.day(w,{width:"narrow",context:"formatting"});case"eeeeee":return v.day(w,{width:"short",context:"formatting"});case"eeee":default:return v.day(w,{width:"wide",context:"formatting"})}},c:function(p,x,v,_){const w=p.getDay(),j=(w-_.weekStartsOn+8)%7||7;switch(x){case"c":return String(j);case"cc":return(0,a.addLeadingZeros)(j,x.length);case"co":return v.ordinalNumber(j,{unit:"day"});case"ccc":return v.day(w,{width:"abbreviated",context:"standalone"});case"ccccc":return v.day(w,{width:"narrow",context:"standalone"});case"cccccc":return v.day(w,{width:"short",context:"standalone"});case"cccc":default:return v.day(w,{width:"wide",context:"standalone"})}},i:function(p,x,v){const _=p.getDay(),w=_===0?7:_;switch(x){case"i":return String(w);case"ii":return(0,a.addLeadingZeros)(w,x.length);case"io":return v.ordinalNumber(w,{unit:"day"});case"iii":return v.day(_,{width:"abbreviated",context:"formatting"});case"iiiii":return v.day(_,{width:"narrow",context:"formatting"});case"iiiiii":return v.day(_,{width:"short",context:"formatting"});case"iiii":default:return v.day(_,{width:"wide",context:"formatting"})}},a:function(p,x,v){const w=p.getHours()/12>=1?"pm":"am";switch(x){case"a":case"aa":return v.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"aaa":return v.dayPeriod(w,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return v.dayPeriod(w,{width:"narrow",context:"formatting"});case"aaaa":default:return v.dayPeriod(w,{width:"wide",context:"formatting"})}},b:function(p,x,v){const _=p.getHours();let w;switch(_===12?w=l.noon:_===0?w=l.midnight:w=_/12>=1?"pm":"am",x){case"b":case"bb":return v.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"bbb":return v.dayPeriod(w,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return v.dayPeriod(w,{width:"narrow",context:"formatting"});case"bbbb":default:return v.dayPeriod(w,{width:"wide",context:"formatting"})}},B:function(p,x,v){const _=p.getHours();let w;switch(_>=17?w=l.evening:_>=12?w=l.afternoon:_>=4?w=l.morning:w=l.night,x){case"B":case"BB":case"BBB":return v.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"BBBBB":return v.dayPeriod(w,{width:"narrow",context:"formatting"});case"BBBB":default:return v.dayPeriod(w,{width:"wide",context:"formatting"})}},h:function(p,x,v){if(x==="ho"){let _=p.getHours()%12;return _===0&&(_=12),v.ordinalNumber(_,{unit:"hour"})}return o.lightFormatters.h(p,x)},H:function(p,x,v){return x==="Ho"?v.ordinalNumber(p.getHours(),{unit:"hour"}):o.lightFormatters.H(p,x)},K:function(p,x,v){const _=p.getHours()%12;return x==="Ko"?v.ordinalNumber(_,{unit:"hour"}):(0,a.addLeadingZeros)(_,x.length)},k:function(p,x,v){let _=p.getHours();return _===0&&(_=24),x==="ko"?v.ordinalNumber(_,{unit:"hour"}):(0,a.addLeadingZeros)(_,x.length)},m:function(p,x,v){return x==="mo"?v.ordinalNumber(p.getMinutes(),{unit:"minute"}):o.lightFormatters.m(p,x)},s:function(p,x,v){return x==="so"?v.ordinalNumber(p.getSeconds(),{unit:"second"}):o.lightFormatters.s(p,x)},S:function(p,x){return o.lightFormatters.S(p,x)},X:function(p,x,v){const _=p.getTimezoneOffset();if(_===0)return"Z";switch(x){case"X":return d(_);case"XXXX":case"XX":return m(_);case"XXXXX":case"XXX":default:return m(_,":")}},x:function(p,x,v){const _=p.getTimezoneOffset();switch(x){case"x":return d(_);case"xxxx":case"xx":return m(_);case"xxxxx":case"xxx":default:return m(_,":")}},O:function(p,x,v){const _=p.getTimezoneOffset();switch(x){case"O":case"OO":case"OOO":return"GMT"+c(_,":");case"OOOO":default:return"GMT"+m(_,":")}},z:function(p,x,v){const _=p.getTimezoneOffset();switch(x){case"z":case"zz":case"zzz":return"GMT"+c(_,":");case"zzzz":default:return"GMT"+m(_,":")}},t:function(p,x,v){const _=Math.trunc(p.getTime()/1e3);return(0,a.addLeadingZeros)(_,x.length)},T:function(p,x,v){const _=p.getTime();return(0,a.addLeadingZeros)(_,x.length)}};function c(p,x=""){const v=p>0?"-":"+",_=Math.abs(p),w=Math.trunc(_/60),j=_%60;return j===0?v+String(w):v+String(w)+x+(0,a.addLeadingZeros)(j,2)}function d(p,x){return p%60===0?(p>0?"-":"+")+(0,a.addLeadingZeros)(Math.abs(p)/60,2):m(p,x)}function m(p,x=""){const v=p>0?"-":"+",_=Math.abs(p),w=(0,a.addLeadingZeros)(Math.trunc(_/60),2),j=(0,a.addLeadingZeros)(_%60,2);return v+w+x+j}return Vp}var Wp={},a2;function Q3(){if(a2)return Wp;a2=1,Wp.longFormatters=void 0;const n=(r,s)=>{switch(r){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},e=(r,s)=>{switch(r){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},t=(r,s)=>{const a=r.match(/(P+)(p+)?/)||[],o=a[1],l=a[2];if(!l)return n(r,s);let c;switch(o){case"P":c=s.dateTime({width:"short"});break;case"PP":c=s.dateTime({width:"medium"});break;case"PPP":c=s.dateTime({width:"long"});break;case"PPPP":default:c=s.dateTime({width:"full"});break}return c.replace("{{date}}",n(o,s)).replace("{{time}}",e(l,s))};return Wp.longFormatters={p:e,P:t},Wp}var yh={},o2;function X3(){if(o2)return yh;o2=1,yh.isProtectedDayOfYearToken=r,yh.isProtectedWeekYearToken=s,yh.warnOrThrowProtectedError=a;const n=/^D+$/,e=/^Y+$/,t=["D","DD","YY","YYYY"];function r(l){return n.test(l)}function s(l){return e.test(l)}function a(l,c,d){const m=o(l,c,d);if(console.warn(m),t.includes(l))throw new RangeError(m)}function o(l,c,d){const m=l[0]==="Y"?"years":"days of the month";return`Use \`${l.toLowerCase()}\` instead of \`${l}\` (in \`${c}\`) for formatting ${m} to the input \`${d}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}return yh}var l2;function e5(){return l2||(l2=1,(function(n){n.format=n.formatDate=v,Object.defineProperty(n,"formatters",{enumerable:!0,get:function(){return r.formatters}}),Object.defineProperty(n,"longFormatters",{enumerable:!0,get:function(){return s.longFormatters}});var e=Ff(),t=_s(),r=fee(),s=Q3(),a=X3(),o=Xc(),l=Ae();const c=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,d=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,m=/^'([^]*?)'?$/,p=/''/g,x=/[a-zA-Z]/;function v(w,j,P){const k=(0,t.getDefaultOptions)(),I=P?.locale??k.locale??e.defaultLocale,M=P?.firstWeekContainsDate??P?.locale?.options?.firstWeekContainsDate??k.firstWeekContainsDate??k.locale?.options?.firstWeekContainsDate??1,D=P?.weekStartsOn??P?.locale?.options?.weekStartsOn??k.weekStartsOn??k.locale?.options?.weekStartsOn??0,O=(0,l.toDate)(w);if(!(0,o.isValid)(O))throw new RangeError("Invalid time value");let q=j.match(d).map(U=>{const B=U[0];if(B==="p"||B==="P"){const G=s.longFormatters[B];return G(U,I.formatLong)}return U}).join("").match(c).map(U=>{if(U==="''")return{isToken:!1,value:"'"};const B=U[0];if(B==="'")return{isToken:!1,value:_(U)};if(r.formatters[B])return{isToken:!0,value:U};if(B.match(x))throw new RangeError("Format string contains an unescaped latin alphabet character `"+B+"`");return{isToken:!1,value:U}});I.localize.preprocessor&&(q=I.localize.preprocessor(O,q));const F={firstWeekContainsDate:M,weekStartsOn:D,locale:I};return q.map(U=>{if(!U.isToken)return U.value;const B=U.value;(!P?.useAdditionalWeekYearTokens&&(0,a.isProtectedWeekYearToken)(B)||!P?.useAdditionalDayOfYearTokens&&(0,a.isProtectedDayOfYearToken)(B))&&(0,a.warnOrThrowProtectedError)(B,j,String(w));const G=r.formatters[B[0]];return G(O,B,I.localize,F)}).join("")}function _(w){const j=w.match(m);return j?j[1].replace(p,"'"):w}})(n_)),n_}var m_={},c2;function t5(){if(c2)return m_;c2=1,m_.formatDistance=c;var n=Lf(),e=Kt(),t=sy(),r=iy(),s=Ae(),a=Ff(),o=_s(),l=Jc();function c(d,m,p){const x=(0,o.getDefaultOptions)(),v=p?.locale??x.locale??a.defaultLocale,_=2520,w=(0,n.compareAsc)(d,m);if(isNaN(w))throw new RangeError("Invalid time value");const j=Object.assign({},p,{addSuffix:p?.addSuffix,comparison:w});let P,k;w>0?(P=(0,s.toDate)(m),k=(0,s.toDate)(d)):(P=(0,s.toDate)(d),k=(0,s.toDate)(m));const I=(0,r.differenceInSeconds)(k,P),M=((0,l.getTimezoneOffsetInMilliseconds)(k)-(0,l.getTimezoneOffsetInMilliseconds)(P))/1e3,D=Math.round((I-M)/60);let O;if(D<2)return p?.includeSeconds?I<5?v.formatDistance("lessThanXSeconds",5,j):I<10?v.formatDistance("lessThanXSeconds",10,j):I<20?v.formatDistance("lessThanXSeconds",20,j):I<40?v.formatDistance("halfAMinute",0,j):I<60?v.formatDistance("lessThanXMinutes",1,j):v.formatDistance("xMinutes",1,j):D===0?v.formatDistance("lessThanXMinutes",1,j):v.formatDistance("xMinutes",D,j);if(D<45)return v.formatDistance("xMinutes",D,j);if(D<90)return v.formatDistance("aboutXHours",1,j);if(D<e.minutesInDay){const q=Math.round(D/60);return v.formatDistance("aboutXHours",q,j)}else{if(D<_)return v.formatDistance("xDays",1,j);if(D<e.minutesInMonth){const q=Math.round(D/e.minutesInDay);return v.formatDistance("xDays",q,j)}else if(D<e.minutesInMonth*2)return O=Math.round(D/e.minutesInMonth),v.formatDistance("aboutXMonths",O,j)}if(O=(0,t.differenceInMonths)(k,P),O<12){const q=Math.round(D/e.minutesInMonth);return v.formatDistance("xMonths",q,j)}else{const q=O%12,F=Math.trunc(O/12);return q<3?v.formatDistance("aboutXYears",F,j):q<9?v.formatDistance("overXYears",F,j):v.formatDistance("almostXYears",F+1,j)}}return m_}var p_={},d2;function n5(){if(d2)return p_;d2=1,p_.formatDistanceStrict=l;var n=Ff(),e=_s(),t=ed(),r=Jc(),s=Lf(),a=Kt(),o=Ae();function l(c,d,m){const p=(0,e.getDefaultOptions)(),x=m?.locale??p.locale??n.defaultLocale,v=(0,s.compareAsc)(c,d);if(isNaN(v))throw new RangeError("Invalid time value");const _=Object.assign({},m,{addSuffix:m?.addSuffix,comparison:v});let w,j;v>0?(w=(0,o.toDate)(d),j=(0,o.toDate)(c)):(w=(0,o.toDate)(c),j=(0,o.toDate)(d));const P=(0,t.getRoundingMethod)(m?.roundingMethod??"round"),k=j.getTime()-w.getTime(),I=k/a.millisecondsInMinute,M=(0,r.getTimezoneOffsetInMilliseconds)(j)-(0,r.getTimezoneOffsetInMilliseconds)(w),D=(k-M)/a.millisecondsInMinute,O=m?.unit;let q;if(O?q=O:I<1?q="second":I<60?q="minute":I<a.minutesInDay?q="hour":D<a.minutesInMonth?q="day":D<a.minutesInYear?q="month":q="year",q==="second"){const F=P(k/1e3);return x.formatDistance("xSeconds",F,_)}else if(q==="minute"){const F=P(I);return x.formatDistance("xMinutes",F,_)}else if(q==="hour"){const F=P(I/60);return x.formatDistance("xHours",F,_)}else if(q==="day"){const F=P(D/a.minutesInDay);return x.formatDistance("xDays",F,_)}else if(q==="month"){const F=P(D/a.minutesInMonth);return F===12&&O!=="month"?x.formatDistance("xYears",1,_):x.formatDistance("xMonths",F,_)}else{const F=P(D/a.minutesInYear);return x.formatDistance("xYears",F,_)}}return p_}var g_={},u2;function hee(){if(u2)return g_;u2=1,g_.formatDistanceToNow=t;var n=$s(),e=t5();function t(r,s){return(0,e.formatDistance)(r,(0,n.constructNow)(r),s)}return g_}var x_={},f2;function mee(){if(f2)return x_;f2=1,x_.formatDistanceToNowStrict=t;var n=n5(),e=$s();function t(r,s){return(0,n.formatDistanceStrict)(r,(0,e.constructNow)(r),s)}return x_}var y_={},h2;function pee(){if(h2)return y_;h2=1,y_.formatDuration=r;var n=Ff(),e=_s();const t=["years","months","weeks","days","hours","minutes","seconds"];function r(s,a){const o=(0,e.getDefaultOptions)(),l=a?.locale??o.locale??n.defaultLocale,c=a?.format??t,d=a?.zero??!1,m=a?.delimiter??" ";return l.formatDistance?c.reduce((x,v)=>{const _=`x${v.replace(/(^.)/,j=>j.toUpperCase())}`,w=s[v];return w!==void 0&&(d||s[v])?x.concat(l.formatDistance(_,w)):x},[]).join(m):""}return y_}var v_={},m2;function gee(){if(m2)return v_;m2=1,v_.formatISO=t;var n=Ae(),e=qf();function t(r,s){const a=(0,n.toDate)(r);if(isNaN(a.getTime()))throw new RangeError("Invalid time value");const o=s?.format??"extended",l=s?.representation??"complete";let c="",d="";const m=o==="extended"?"-":"",p=o==="extended"?":":"";if(l!=="time"){const x=(0,e.addLeadingZeros)(a.getDate(),2),v=(0,e.addLeadingZeros)(a.getMonth()+1,2);c=`${(0,e.addLeadingZeros)(a.getFullYear(),4)}${m}${v}${m}${x}`}if(l!=="date"){const x=a.getTimezoneOffset();if(x!==0){const k=Math.abs(x),I=(0,e.addLeadingZeros)(Math.trunc(k/60),2),M=(0,e.addLeadingZeros)(k%60,2);d=`${x<0?"+":"-"}${I}:${M}`}else d="Z";const v=(0,e.addLeadingZeros)(a.getHours(),2),_=(0,e.addLeadingZeros)(a.getMinutes(),2),w=(0,e.addLeadingZeros)(a.getSeconds(),2),j=c===""?"":"T",P=[v,_,w].join(p);c=`${c}${j}${P}${d}`}return c}return v_}var b_={},p2;function xee(){if(p2)return b_;p2=1,b_.formatISO9075=r;var n=Xc(),e=Ae(),t=qf();function r(s,a){const o=(0,e.toDate)(s);if(!(0,n.isValid)(o))throw new RangeError("Invalid time value");const l=a?.format??"extended",c=a?.representation??"complete";let d="";const m=l==="extended"?"-":"",p=l==="extended"?":":"";if(c!=="time"){const x=(0,t.addLeadingZeros)(o.getDate(),2),v=(0,t.addLeadingZeros)(o.getMonth()+1,2);d=`${(0,t.addLeadingZeros)(o.getFullYear(),4)}${m}${v}${m}${x}`}if(c!=="date"){const x=(0,t.addLeadingZeros)(o.getHours(),2),v=(0,t.addLeadingZeros)(o.getMinutes(),2),_=(0,t.addLeadingZeros)(o.getSeconds(),2);d=`${d}${d===""?"":" "}${x}${p}${v}${p}${_}`}return d}return b_}var __={},g2;function yee(){if(g2)return __;g2=1,__.formatISODuration=n;function n(e){const{years:t=0,months:r=0,days:s=0,hours:a=0,minutes:o=0,seconds:l=0}=e;return`P${t}Y${r}M${s}DT${a}H${o}M${l}S`}return __}var w_={},x2;function vee(){if(x2)return w_;x2=1,w_.formatRFC3339=r;var n=Xc(),e=Ae(),t=qf();function r(s,a){const o=(0,e.toDate)(s);if(!(0,n.isValid)(o))throw new RangeError("Invalid time value");const l=a?.fractionDigits??0,c=(0,t.addLeadingZeros)(o.getDate(),2),d=(0,t.addLeadingZeros)(o.getMonth()+1,2),m=o.getFullYear(),p=(0,t.addLeadingZeros)(o.getHours(),2),x=(0,t.addLeadingZeros)(o.getMinutes(),2),v=(0,t.addLeadingZeros)(o.getSeconds(),2);let _="";if(l>0){const P=o.getMilliseconds(),k=Math.trunc(P*Math.pow(10,l-3));_="."+(0,t.addLeadingZeros)(k,l)}let w="";const j=o.getTimezoneOffset();if(j!==0){const P=Math.abs(j),k=(0,t.addLeadingZeros)(Math.trunc(P/60),2),I=(0,t.addLeadingZeros)(P%60,2);w=`${j<0?"+":"-"}${k}:${I}`}else w="Z";return`${m}-${d}-${c}T${p}:${x}:${v}${_}${w}`}return w_}var S_={},y2;function bee(){if(y2)return S_;y2=1,S_.formatRFC7231=a;var n=Xc(),e=Ae(),t=qf();const r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function a(o){const l=(0,e.toDate)(o);if(!(0,n.isValid)(l))throw new RangeError("Invalid time value");const c=r[l.getUTCDay()],d=(0,t.addLeadingZeros)(l.getUTCDate(),2),m=s[l.getUTCMonth()],p=l.getUTCFullYear(),x=(0,t.addLeadingZeros)(l.getUTCHours(),2),v=(0,t.addLeadingZeros)(l.getUTCMinutes(),2),_=(0,t.addLeadingZeros)(l.getUTCSeconds(),2);return`${c}, ${d} ${m} ${p} ${x}:${v}:${_} GMT`}return S_}var j_={},v2;function _ee(){if(v2)return j_;v2=1,j_.formatRelative=a;var n=Qc(),e=e5(),t=Ae(),r=Ff(),s=_s();function a(o,l,c){const d=(0,t.toDate)(o),m=(0,t.toDate)(l),p=(0,s.getDefaultOptions)(),x=c?.locale??p.locale??r.defaultLocale,v=c?.weekStartsOn??c?.locale?.options?.weekStartsOn??p.weekStartsOn??p.locale?.options?.weekStartsOn??0,_=(0,n.differenceInCalendarDays)(d,m);if(isNaN(_))throw new RangeError("Invalid time value");let w;_<-6?w="other":_<-1?w="lastWeek":_<0?w="yesterday":_<1?w="today":_<2?w="tomorrow":_<7?w="nextWeek":w="other";const j=x.formatRelative(w,d,m,{locale:x,weekStartsOn:v});return(0,e.format)(d,j,{locale:x,weekStartsOn:v})}return j_}var N_={},b2;function wee(){if(b2)return N_;b2=1,N_.fromUnixTime=e;var n=Ae();function e(t){return(0,n.toDate)(t*1e3)}return N_}var C_={},_2;function r5(){if(_2)return C_;_2=1,C_.getDate=e;var n=Ae();function e(t){return(0,n.toDate)(t).getDate()}return C_}var T_={},w2;function ly(){if(w2)return T_;w2=1,T_.getDay=e;var n=Ae();function e(t){return(0,n.toDate)(t).getDay()}return T_}var P_={},S2;function s5(){if(S2)return P_;S2=1,P_.getDaysInMonth=t;var n=Ae(),e=an();function t(r){const s=(0,n.toDate)(r),a=s.getFullYear(),o=s.getMonth(),l=(0,e.constructFrom)(r,0);return l.setFullYear(a,o+1,0),l.setHours(0,0,0,0),l.getDate()}return P_}var M_={},k_={},j2;function i5(){if(j2)return k_;j2=1,k_.isLeapYear=e;var n=Ae();function e(t){const s=(0,n.toDate)(t).getFullYear();return s%400===0||s%4===0&&s%100!==0}return k_}var N2;function See(){if(N2)return M_;N2=1,M_.getDaysInYear=t;var n=i5(),e=Ae();function t(r){const s=(0,e.toDate)(r);return String(new Date(s))==="Invalid Date"?NaN:(0,n.isLeapYear)(s)?366:365}return M_}var E_={},C2;function jee(){if(C2)return E_;C2=1,E_.getDecade=e;var n=Ae();function e(t){const s=(0,n.toDate)(t).getFullYear();return Math.floor(s/10)*10}return E_}var D_={},T2;function a5(){if(T2)return D_;T2=1,D_.getDefaultOptions=e;var n=_s();function e(){return Object.assign({},(0,n.getDefaultOptions)())}return D_}var O_={},P2;function Nee(){if(P2)return O_;P2=1,O_.getHours=e;var n=Ae();function e(t){return(0,n.toDate)(t).getHours()}return O_}var I_={},M2;function o5(){if(M2)return I_;M2=1,I_.getISODay=e;var n=Ae();function e(t){let s=(0,n.toDate)(t).getDay();return s===0&&(s=7),s}return I_}var A_={},k2;function Cee(){if(k2)return A_;k2=1,A_.getISOWeeksInYear=r;var n=ny(),e=Kt(),t=Sm();function r(s){const a=(0,t.startOfISOWeekYear)(s),l=+(0,t.startOfISOWeekYear)((0,n.addWeeks)(a,60))-+a;return Math.round(l/e.millisecondsInWeek)}return A_}var R_={},E2;function Tee(){if(E2)return R_;E2=1,R_.getMilliseconds=e;var n=Ae();function e(t){return(0,n.toDate)(t).getMilliseconds()}return R_}var L_={},D2;function Pee(){if(D2)return L_;D2=1,L_.getMinutes=e;var n=Ae();function e(t){return(0,n.toDate)(t).getMinutes()}return L_}var F_={},O2;function Mee(){if(O2)return F_;O2=1,F_.getMonth=e;var n=Ae();function e(t){return(0,n.toDate)(t).getMonth()}return F_}var q_={},I2;function kee(){if(I2)return q_;I2=1,q_.getOverlappingDaysInIntervals=r;var n=Jc(),e=Kt(),t=Ae();function r(s,a){const[o,l]=[+(0,t.toDate)(s.start),+(0,t.toDate)(s.end)].sort((w,j)=>w-j),[c,d]=[+(0,t.toDate)(a.start),+(0,t.toDate)(a.end)].sort((w,j)=>w-j);if(!(o<d&&c<l))return 0;const p=c<o?o:c,x=p-(0,n.getTimezoneOffsetInMilliseconds)(p),v=d>l?l:d,_=v-(0,n.getTimezoneOffsetInMilliseconds)(v);return Math.ceil((_-x)/e.millisecondsInDay)}return q_}var z_={},A2;function Eee(){if(A2)return z_;A2=1,z_.getSeconds=e;var n=Ae();function e(t){return(0,n.toDate)(t).getSeconds()}return z_}var U_={},R2;function Dee(){if(R2)return U_;R2=1,U_.getTime=e;var n=Ae();function e(t){return(0,n.toDate)(t).getTime()}return U_}var V_={},L2;function Oee(){if(L2)return V_;L2=1,V_.getUnixTime=e;var n=Ae();function e(t){return Math.trunc(+(0,n.toDate)(t)/1e3)}return V_}var B_={},F2;function Iee(){if(F2)return B_;F2=1,B_.getWeekOfMonth=s;var n=r5(),e=ly(),t=ay(),r=_s();function s(a,o){const l=(0,r.getDefaultOptions)(),c=o?.weekStartsOn??o?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,d=(0,n.getDate)(a);if(isNaN(d))return NaN;const m=(0,e.getDay)((0,t.startOfMonth)(a));let p=c-m;p<=0&&(p+=7);const x=d-p;return Math.ceil(x/7)+1}return B_}var W_={},$_={},q2;function l5(){if(q2)return $_;q2=1,$_.lastDayOfMonth=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(0,0,0,0),r}return $_}var z2;function Aee(){if(z2)return W_;z2=1,W_.getWeeksInMonth=r;var n=OC(),e=l5(),t=ay();function r(s,a){return(0,n.differenceInCalendarWeeks)((0,e.lastDayOfMonth)(s),(0,t.startOfMonth)(s),a)+1}return W_}var H_={},U2;function Ree(){if(U2)return H_;U2=1,H_.getYear=e;var n=Ae();function e(t){return(0,n.toDate)(t).getFullYear()}return H_}var Y_={},V2;function Lee(){if(V2)return Y_;V2=1,Y_.hoursToMilliseconds=e;var n=Kt();function e(t){return Math.trunc(t*n.millisecondsInHour)}return Y_}var G_={},B2;function Fee(){if(B2)return G_;B2=1,G_.hoursToMinutes=e;var n=Kt();function e(t){return Math.trunc(t*n.minutesInHour)}return G_}var Z_={},W2;function qee(){if(W2)return Z_;W2=1,Z_.hoursToSeconds=e;var n=Kt();function e(t){return Math.trunc(t*n.secondsInHour)}return Z_}var K_={},$2;function zee(){if($2)return K_;$2=1,K_.interval=e;var n=Ae();function e(t,r,s){const a=(0,n.toDate)(t);if(isNaN(+a))throw new TypeError("Start date is invalid");const o=(0,n.toDate)(r);if(isNaN(+o))throw new TypeError("End date is invalid");if(s?.assertPositive&&+a>+o)throw new TypeError("End date must be after start date");return{start:a,end:o}}return K_}var J_={},H2;function Uee(){if(H2)return J_;H2=1,J_.intervalToDuration=c;var n=M3(),e=AC(),t=RC(),r=LC(),s=sy(),a=iy(),o=$3(),l=Ae();function c(d){const m=(0,l.toDate)(d.start),p=(0,l.toDate)(d.end),x={},v=(0,o.differenceInYears)(p,m);v&&(x.years=v);const _=(0,n.add)(m,{years:x.years}),w=(0,s.differenceInMonths)(p,_);w&&(x.months=w);const j=(0,n.add)(_,{months:x.months}),P=(0,e.differenceInDays)(p,j);P&&(x.days=P);const k=(0,n.add)(j,{days:x.days}),I=(0,t.differenceInHours)(p,k);I&&(x.hours=I);const M=(0,n.add)(k,{hours:x.hours}),D=(0,r.differenceInMinutes)(p,M);D&&(x.minutes=D);const O=(0,n.add)(M,{minutes:x.minutes}),q=(0,a.differenceInSeconds)(p,O);return q&&(x.seconds=q),x}return J_}var Q_={},Y2;function Vee(){if(Y2)return Q_;Y2=1,Q_.intlFormat=e;var n=Ae();function e(r,s,a){let o;return t(s)?o=s:a=s,new Intl.DateTimeFormat(a?.locale,o).format((0,n.toDate)(r))}function t(r){return r!==void 0&&!("locale"in r)}return Q_}var X_={},G2;function Bee(){if(G2)return X_;G2=1,X_.intlFormatDistance=m;var n=Kt(),e=Qc(),t=DC(),r=V3(),s=OC(),a=IC(),o=RC(),l=LC(),c=iy(),d=Ae();function m(p,x,v){let _=0,w;const j=(0,d.toDate)(p),P=(0,d.toDate)(x);if(v?.unit)w=v?.unit,w==="second"?_=(0,c.differenceInSeconds)(j,P):w==="minute"?_=(0,l.differenceInMinutes)(j,P):w==="hour"?_=(0,o.differenceInHours)(j,P):w==="day"?_=(0,e.differenceInCalendarDays)(j,P):w==="week"?_=(0,s.differenceInCalendarWeeks)(j,P):w==="month"?_=(0,t.differenceInCalendarMonths)(j,P):w==="quarter"?_=(0,r.differenceInCalendarQuarters)(j,P):w==="year"&&(_=(0,a.differenceInCalendarYears)(j,P));else{const I=(0,c.differenceInSeconds)(j,P);Math.abs(I)<n.secondsInMinute?(_=(0,c.differenceInSeconds)(j,P),w="second"):Math.abs(I)<n.secondsInHour?(_=(0,l.differenceInMinutes)(j,P),w="minute"):Math.abs(I)<n.secondsInDay&&Math.abs((0,e.differenceInCalendarDays)(j,P))<1?(_=(0,o.differenceInHours)(j,P),w="hour"):Math.abs(I)<n.secondsInWeek&&(_=(0,e.differenceInCalendarDays)(j,P))&&Math.abs(_)<7?w="day":Math.abs(I)<n.secondsInMonth?(_=(0,s.differenceInCalendarWeeks)(j,P),w="week"):Math.abs(I)<n.secondsInQuarter?(_=(0,t.differenceInCalendarMonths)(j,P),w="month"):Math.abs(I)<n.secondsInYear&&(0,r.differenceInCalendarQuarters)(j,P)<4?(_=(0,r.differenceInCalendarQuarters)(j,P),w="quarter"):(_=(0,a.differenceInCalendarYears)(j,P),w="year")}return new Intl.RelativeTimeFormat(v?.locale,{localeMatcher:v?.localeMatcher,numeric:v?.numeric||"auto",style:v?.style}).format(_,w)}return X_}var ew={},Z2;function Wee(){if(Z2)return ew;Z2=1,ew.isAfter=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getTime()>a.getTime()}return ew}var tw={},K2;function $ee(){if(K2)return tw;K2=1,tw.isBefore=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return+s<+a}return tw}var nw={},J2;function Hee(){if(J2)return nw;J2=1,nw.isEqual=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return+s==+a}return nw}var rw={},Q2;function Yee(){if(Q2)return rw;Q2=1,rw.isExists=n;function n(e,t,r){const s=new Date(e,t,r);return s.getFullYear()===e&&s.getMonth()===t&&s.getDate()===r}return rw}var sw={},X2;function Gee(){if(X2)return sw;X2=1,sw.isFirstDayOfMonth=e;var n=Ae();function e(t){return(0,n.toDate)(t).getDate()===1}return sw}var iw={},eO;function Zee(){if(eO)return iw;eO=1,iw.isFriday=e;var n=Ae();function e(t){return(0,n.toDate)(t).getDay()===5}return iw}var aw={},tO;function Kee(){if(tO)return aw;tO=1,aw.isFuture=e;var n=Ae();function e(t){return+(0,n.toDate)(t)>Date.now()}return aw}var ow={},lw={},$p={},Hp={},Yp={},wc={},cw={},nO;function c5(){if(nO)return cw;nO=1,cw.transpose=e;var n=an();function e(t,r){const s=r instanceof Date?(0,n.constructFrom)(r,0):new r(0);return s.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),s.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),s}return cw}var rO;function d5(){if(rO)return wc;rO=1,wc.ValueSetter=wc.Setter=wc.DateToSystemTimezoneSetter=void 0;var n=c5(),e=an();const t=10;let r=class{subPriority=0;validate(l,c){return!0}};wc.Setter=r;class s extends r{constructor(l,c,d,m,p){super(),this.value=l,this.validateValue=c,this.setValue=d,this.priority=m,p&&(this.subPriority=p)}validate(l,c){return this.validateValue(l,this.value,c)}set(l,c,d){return this.setValue(l,c,this.value,d)}}wc.ValueSetter=s;class a extends r{priority=t;subPriority=-1;set(l,c){return c.timestampIsSet?l:(0,e.constructFrom)(l,(0,n.transpose)(l,Date))}}return wc.DateToSystemTimezoneSetter=a,wc}var sO;function dn(){if(sO)return Yp;sO=1,Yp.Parser=void 0;var n=d5();let e=class{run(r,s,a,o){const l=this.parse(r,s,a,o);return l?{setter:new n.ValueSetter(l.value,this.validate,this.set,this.priority,this.subPriority),rest:l.rest}:null}validate(r,s,a){return!0}};return Yp.Parser=e,Yp}var iO;function Jee(){if(iO)return Hp;iO=1,Hp.EraParser=void 0;var n=dn();let e=class extends n.Parser{priority=140;parse(r,s,a){switch(s){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,s,a){return s.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}incompatibleTokens=["R","u","t","T"]};return Hp.EraParser=e,Hp}var Gp={},ha={},Ku={},aO;function ws(){return aO||(aO=1,Ku.timezonePatterns=Ku.numericPatterns=void 0,Ku.numericPatterns={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Ku.timezonePatterns={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/}),Ku}var oO;function vn(){if(oO)return ha;oO=1,ha.dayPeriodEnumToHours=c,ha.isLeapYearIndex=m,ha.mapValue=t,ha.normalizeTwoDigitYear=d,ha.parseAnyDigitsSigned=a,ha.parseNDigits=o,ha.parseNDigitsSigned=l,ha.parseNumericPattern=r,ha.parseTimezonePattern=s;var n=Kt(),e=ws();function t(p,x){return p&&{value:x(p.value),rest:p.rest}}function r(p,x){const v=x.match(p);return v?{value:parseInt(v[0],10),rest:x.slice(v[0].length)}:null}function s(p,x){const v=x.match(p);if(!v)return null;if(v[0]==="Z")return{value:0,rest:x.slice(1)};const _=v[1]==="+"?1:-1,w=v[2]?parseInt(v[2],10):0,j=v[3]?parseInt(v[3],10):0,P=v[5]?parseInt(v[5],10):0;return{value:_*(w*n.millisecondsInHour+j*n.millisecondsInMinute+P*n.millisecondsInSecond),rest:x.slice(v[0].length)}}function a(p){return r(e.numericPatterns.anyDigitsSigned,p)}function o(p,x){switch(p){case 1:return r(e.numericPatterns.singleDigit,x);case 2:return r(e.numericPatterns.twoDigits,x);case 3:return r(e.numericPatterns.threeDigits,x);case 4:return r(e.numericPatterns.fourDigits,x);default:return r(new RegExp("^\\d{1,"+p+"}"),x)}}function l(p,x){switch(p){case 1:return r(e.numericPatterns.singleDigitSigned,x);case 2:return r(e.numericPatterns.twoDigitsSigned,x);case 3:return r(e.numericPatterns.threeDigitsSigned,x);case 4:return r(e.numericPatterns.fourDigitsSigned,x);default:return r(new RegExp("^-?\\d{1,"+p+"}"),x)}}function c(p){switch(p){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function d(p,x){const v=x>0,_=v?x:1-x;let w;if(_<=50)w=p||100;else{const j=_+50,P=Math.trunc(j/100)*100,k=p>=j%100;w=p+P-(k?100:0)}return v?w:1-w}function m(p){return p%400===0||p%4===0&&p%100!==0}return ha}var lO;function Qee(){if(lO)return Gp;lO=1,Gp.YearParser=void 0;var n=dn(),e=vn();let t=class extends n.Parser{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(s,a,o){const l=c=>({year:c,isTwoDigitYear:a==="yy"});switch(a){case"y":return(0,e.mapValue)((0,e.parseNDigits)(4,s),l);case"yo":return(0,e.mapValue)(o.ordinalNumber(s,{unit:"year"}),l);default:return(0,e.mapValue)((0,e.parseNDigits)(a.length,s),l)}}validate(s,a){return a.isTwoDigitYear||a.year>0}set(s,a,o){const l=s.getFullYear();if(o.isTwoDigitYear){const d=(0,e.normalizeTwoDigitYear)(o.year,l);return s.setFullYear(d,0,1),s.setHours(0,0,0,0),s}const c=!("era"in a)||a.era===1?o.year:1-o.year;return s.setFullYear(c,0,1),s.setHours(0,0,0,0),s}};return Gp.YearParser=t,Gp}var Zp={},cO;function Xee(){if(cO)return Zp;cO=1,Zp.LocalWeekYearParser=void 0;var n=oy(),e=_o(),t=dn(),r=vn();let s=class extends t.Parser{priority=130;parse(o,l,c){const d=m=>({year:m,isTwoDigitYear:l==="YY"});switch(l){case"Y":return(0,r.mapValue)((0,r.parseNDigits)(4,o),d);case"Yo":return(0,r.mapValue)(c.ordinalNumber(o,{unit:"year"}),d);default:return(0,r.mapValue)((0,r.parseNDigits)(l.length,o),d)}}validate(o,l){return l.isTwoDigitYear||l.year>0}set(o,l,c,d){const m=(0,n.getWeekYear)(o,d);if(c.isTwoDigitYear){const x=(0,r.normalizeTwoDigitYear)(c.year,m);return o.setFullYear(x,0,d.firstWeekContainsDate),o.setHours(0,0,0,0),(0,e.startOfWeek)(o,d)}const p=!("era"in l)||l.era===1?c.year:1-c.year;return o.setFullYear(p,0,d.firstWeekContainsDate),o.setHours(0,0,0,0),(0,e.startOfWeek)(o,d)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]};return Zp.LocalWeekYearParser=s,Zp}var Kp={},dO;function ete(){if(dO)return Kp;dO=1,Kp.ISOWeekYearParser=void 0;var n=Tl(),e=an(),t=dn(),r=vn();let s=class extends t.Parser{priority=130;parse(o,l){return l==="R"?(0,r.parseNDigitsSigned)(4,o):(0,r.parseNDigitsSigned)(l.length,o)}set(o,l,c){const d=(0,e.constructFrom)(o,0);return d.setFullYear(c,0,4),d.setHours(0,0,0,0),(0,n.startOfISOWeek)(d)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]};return Kp.ISOWeekYearParser=s,Kp}var Jp={},uO;function tte(){if(uO)return Jp;uO=1,Jp.ExtendedYearParser=void 0;var n=dn(),e=vn();let t=class extends n.Parser{priority=130;parse(s,a){return a==="u"?(0,e.parseNDigitsSigned)(4,s):(0,e.parseNDigitsSigned)(a.length,s)}set(s,a,o){return s.setFullYear(o,0,1),s.setHours(0,0,0,0),s}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]};return Jp.ExtendedYearParser=t,Jp}var Qp={},fO;function nte(){if(fO)return Qp;fO=1,Qp.QuarterParser=void 0;var n=dn(),e=vn();let t=class extends n.Parser{priority=120;parse(s,a,o){switch(a){case"Q":case"QQ":return(0,e.parseNDigits)(a.length,s);case"Qo":return o.ordinalNumber(s,{unit:"quarter"});case"QQQ":return o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(s,{width:"wide",context:"formatting"})||o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"})}}validate(s,a){return a>=1&&a<=4}set(s,a,o){return s.setMonth((o-1)*3,1),s.setHours(0,0,0,0),s}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]};return Qp.QuarterParser=t,Qp}var Xp={},hO;function rte(){if(hO)return Xp;hO=1,Xp.StandAloneQuarterParser=void 0;var n=dn(),e=vn();let t=class extends n.Parser{priority=120;parse(s,a,o){switch(a){case"q":case"qq":return(0,e.parseNDigits)(a.length,s);case"qo":return o.ordinalNumber(s,{unit:"quarter"});case"qqq":return o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(s,{width:"wide",context:"standalone"})||o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"})}}validate(s,a){return a>=1&&a<=4}set(s,a,o){return s.setMonth((o-1)*3,1),s.setHours(0,0,0,0),s}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]};return Xp.StandAloneQuarterParser=t,Xp}var eg={},mO;function ste(){if(mO)return eg;mO=1,eg.MonthParser=void 0;var n=ws(),e=dn(),t=vn();let r=class extends e.Parser{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(a,o,l){const c=d=>d-1;switch(o){case"M":return(0,t.mapValue)((0,t.parseNumericPattern)(n.numericPatterns.month,a),c);case"MM":return(0,t.mapValue)((0,t.parseNDigits)(2,a),c);case"Mo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"month"}),c);case"MMM":return l.month(a,{width:"abbreviated",context:"formatting"})||l.month(a,{width:"narrow",context:"formatting"});case"MMMMM":return l.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return l.month(a,{width:"wide",context:"formatting"})||l.month(a,{width:"abbreviated",context:"formatting"})||l.month(a,{width:"narrow",context:"formatting"})}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.setMonth(l,1),a.setHours(0,0,0,0),a}};return eg.MonthParser=r,eg}var tg={},pO;function ite(){if(pO)return tg;pO=1,tg.StandAloneMonthParser=void 0;var n=ws(),e=dn(),t=vn();let r=class extends e.Parser{priority=110;parse(a,o,l){const c=d=>d-1;switch(o){case"L":return(0,t.mapValue)((0,t.parseNumericPattern)(n.numericPatterns.month,a),c);case"LL":return(0,t.mapValue)((0,t.parseNDigits)(2,a),c);case"Lo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"month"}),c);case"LLL":return l.month(a,{width:"abbreviated",context:"standalone"})||l.month(a,{width:"narrow",context:"standalone"});case"LLLLL":return l.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return l.month(a,{width:"wide",context:"standalone"})||l.month(a,{width:"abbreviated",context:"standalone"})||l.month(a,{width:"narrow",context:"standalone"})}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.setMonth(l,1),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};return tg.StandAloneMonthParser=r,tg}var ng={},dw={},gO;function u5(){if(gO)return dw;gO=1,dw.setWeek=t;var n=HC(),e=Ae();function t(r,s,a){const o=(0,e.toDate)(r),l=(0,n.getWeek)(o,a)-s;return o.setDate(o.getDate()-l*7),o}return dw}var xO;function ate(){if(xO)return ng;xO=1,ng.LocalWeekParser=void 0;var n=u5(),e=_o(),t=ws(),r=dn(),s=vn();let a=class extends r.Parser{priority=100;parse(l,c,d){switch(c){case"w":return(0,s.parseNumericPattern)(t.numericPatterns.week,l);case"wo":return d.ordinalNumber(l,{unit:"week"});default:return(0,s.parseNDigits)(c.length,l)}}validate(l,c){return c>=1&&c<=53}set(l,c,d,m){return(0,e.startOfWeek)((0,n.setWeek)(l,d,m),m)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};return ng.LocalWeekParser=a,ng}var rg={},uw={},yO;function f5(){if(yO)return uw;yO=1,uw.setISOWeek=t;var n=WC(),e=Ae();function t(r,s){const a=(0,e.toDate)(r),o=(0,n.getISOWeek)(a)-s;return a.setDate(a.getDate()-o*7),a}return uw}var vO;function ote(){if(vO)return rg;vO=1,rg.ISOWeekParser=void 0;var n=f5(),e=Tl(),t=ws(),r=dn(),s=vn();let a=class extends r.Parser{priority=100;parse(l,c,d){switch(c){case"I":return(0,s.parseNumericPattern)(t.numericPatterns.week,l);case"Io":return d.ordinalNumber(l,{unit:"week"});default:return(0,s.parseNDigits)(c.length,l)}}validate(l,c){return c>=1&&c<=53}set(l,c,d){return(0,e.startOfISOWeek)((0,n.setISOWeek)(l,d))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};return rg.ISOWeekParser=a,rg}var sg={},bO;function lte(){if(bO)return sg;bO=1,sg.DateParser=void 0;var n=ws(),e=dn(),t=vn();const r=[31,28,31,30,31,30,31,31,30,31,30,31],s=[31,29,31,30,31,30,31,31,30,31,30,31];let a=class extends e.Parser{priority=90;subPriority=1;parse(l,c,d){switch(c){case"d":return(0,t.parseNumericPattern)(n.numericPatterns.date,l);case"do":return d.ordinalNumber(l,{unit:"date"});default:return(0,t.parseNDigits)(c.length,l)}}validate(l,c){const d=l.getFullYear(),m=(0,t.isLeapYearIndex)(d),p=l.getMonth();return m?c>=1&&c<=s[p]:c>=1&&c<=r[p]}set(l,c,d){return l.setDate(d),l.setHours(0,0,0,0),l}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]};return sg.DateParser=a,sg}var ig={},_O;function cte(){if(_O)return ig;_O=1,ig.DayOfYearParser=void 0;var n=ws(),e=dn(),t=vn();let r=class extends e.Parser{priority=90;subpriority=1;parse(a,o,l){switch(o){case"D":case"DD":return(0,t.parseNumericPattern)(n.numericPatterns.dayOfYear,a);case"Do":return l.ordinalNumber(a,{unit:"date"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){const l=a.getFullYear();return(0,t.isLeapYearIndex)(l)?o>=1&&o<=366:o>=1&&o<=365}set(a,o,l){return a.setMonth(0,l),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};return ig.DayOfYearParser=r,ig}var ag={},fw={},wO;function cy(){if(wO)return fw;wO=1,fw.setDay=r;var n=Cl(),e=Ae(),t=_s();function r(s,a,o){const l=(0,t.getDefaultOptions)(),c=o?.weekStartsOn??o?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,d=(0,e.toDate)(s),m=d.getDay(),x=(a%7+7)%7,v=7-c,_=a<0||a>6?a-(m+v)%7:(x+v)%7-(m+v)%7;return(0,n.addDays)(d,_)}return fw}var SO;function dte(){if(SO)return ag;SO=1,ag.DayParser=void 0;var n=cy(),e=dn();let t=class extends e.Parser{priority=90;parse(s,a,o){switch(a){case"E":case"EE":case"EEE":return o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(s,{width:"wide",context:"formatting"})||o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"})}}validate(s,a){return a>=0&&a<=6}set(s,a,o,l){return s=(0,n.setDay)(s,o,l),s.setHours(0,0,0,0),s}incompatibleTokens=["D","i","e","c","t","T"]};return ag.DayParser=t,ag}var og={},jO;function ute(){if(jO)return og;jO=1,og.LocalDayParser=void 0;var n=cy(),e=dn(),t=vn();let r=class extends e.Parser{priority=90;parse(a,o,l,c){const d=m=>{const p=Math.floor((m-1)/7)*7;return(m+c.weekStartsOn+6)%7+p};switch(o){case"e":case"ee":return(0,t.mapValue)((0,t.parseNDigits)(o.length,a),d);case"eo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"day"}),d);case"eee":return l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"});case"eeeee":return l.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"});case"eeee":default:return l.day(a,{width:"wide",context:"formatting"})||l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"})}}validate(a,o){return o>=0&&o<=6}set(a,o,l,c){return a=(0,n.setDay)(a,l,c),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]};return og.LocalDayParser=r,og}var lg={},NO;function fte(){if(NO)return lg;NO=1,lg.StandAloneLocalDayParser=void 0;var n=cy(),e=dn(),t=vn();let r=class extends e.Parser{priority=90;parse(a,o,l,c){const d=m=>{const p=Math.floor((m-1)/7)*7;return(m+c.weekStartsOn+6)%7+p};switch(o){case"c":case"cc":return(0,t.mapValue)((0,t.parseNDigits)(o.length,a),d);case"co":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"day"}),d);case"ccc":return l.day(a,{width:"abbreviated",context:"standalone"})||l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"});case"ccccc":return l.day(a,{width:"narrow",context:"standalone"});case"cccccc":return l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"});case"cccc":default:return l.day(a,{width:"wide",context:"standalone"})||l.day(a,{width:"abbreviated",context:"standalone"})||l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"})}}validate(a,o){return o>=0&&o<=6}set(a,o,l,c){return a=(0,n.setDay)(a,l,c),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};return lg.StandAloneLocalDayParser=r,lg}var cg={},hw={},CO;function h5(){if(CO)return hw;CO=1,hw.setISODay=r;var n=Cl(),e=o5(),t=Ae();function r(s,a){const o=(0,t.toDate)(s),l=(0,e.getISODay)(o),c=a-l;return(0,n.addDays)(o,c)}return hw}var TO;function hte(){if(TO)return cg;TO=1,cg.ISODayParser=void 0;var n=h5(),e=dn(),t=vn();let r=class extends e.Parser{priority=90;parse(a,o,l){const c=d=>d===0?7:d;switch(o){case"i":case"ii":return(0,t.parseNDigits)(o.length,a);case"io":return l.ordinalNumber(a,{unit:"day"});case"iii":return(0,t.mapValue)(l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c);case"iiiii":return(0,t.mapValue)(l.day(a,{width:"narrow",context:"formatting"}),c);case"iiiiii":return(0,t.mapValue)(l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c);case"iiii":default:return(0,t.mapValue)(l.day(a,{width:"wide",context:"formatting"})||l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c)}}validate(a,o){return o>=1&&o<=7}set(a,o,l){return a=(0,n.setISODay)(a,l),a.setHours(0,0,0,0),a}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]};return cg.ISODayParser=r,cg}var dg={},PO;function mte(){if(PO)return dg;PO=1,dg.AMPMParser=void 0;var n=dn(),e=vn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"a":case"aa":case"aaa":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["b","B","H","k","t","T"]};return dg.AMPMParser=t,dg}var ug={},MO;function pte(){if(MO)return ug;MO=1,ug.AMPMMidnightParser=void 0;var n=dn(),e=vn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"b":case"bb":case"bbb":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["a","B","H","k","t","T"]};return ug.AMPMMidnightParser=t,ug}var fg={},kO;function gte(){if(kO)return fg;kO=1,fg.DayPeriodParser=void 0;var n=dn(),e=vn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"B":case"BB":case"BBB":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["a","b","t","T"]};return fg.DayPeriodParser=t,fg}var hg={},EO;function xte(){if(EO)return hg;EO=1,hg.Hour1to12Parser=void 0;var n=ws(),e=dn(),t=vn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"h":return(0,t.parseNumericPattern)(n.numericPatterns.hour12h,a);case"ho":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=1&&o<=12}set(a,o,l){const c=a.getHours()>=12;return c&&l<12?a.setHours(l+12,0,0,0):!c&&l===12?a.setHours(0,0,0,0):a.setHours(l,0,0,0),a}incompatibleTokens=["H","K","k","t","T"]};return hg.Hour1to12Parser=r,hg}var mg={},DO;function yte(){if(DO)return mg;DO=1,mg.Hour0to23Parser=void 0;var n=ws(),e=dn(),t=vn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"H":return(0,t.parseNumericPattern)(n.numericPatterns.hour23h,a);case"Ho":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=23}set(a,o,l){return a.setHours(l,0,0,0),a}incompatibleTokens=["a","b","h","K","k","t","T"]};return mg.Hour0to23Parser=r,mg}var pg={},OO;function vte(){if(OO)return pg;OO=1,pg.Hour0To11Parser=void 0;var n=ws(),e=dn(),t=vn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"K":return(0,t.parseNumericPattern)(n.numericPatterns.hour11h,a);case"Ko":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.getHours()>=12&&l<12?a.setHours(l+12,0,0,0):a.setHours(l,0,0,0),a}incompatibleTokens=["h","H","k","t","T"]};return pg.Hour0To11Parser=r,pg}var gg={},IO;function bte(){if(IO)return gg;IO=1,gg.Hour1To24Parser=void 0;var n=ws(),e=dn(),t=vn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"k":return(0,t.parseNumericPattern)(n.numericPatterns.hour24h,a);case"ko":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=1&&o<=24}set(a,o,l){const c=l<=24?l%24:l;return a.setHours(c,0,0,0),a}incompatibleTokens=["a","b","h","H","K","t","T"]};return gg.Hour1To24Parser=r,gg}var xg={},AO;function _te(){if(AO)return xg;AO=1,xg.MinuteParser=void 0;var n=ws(),e=dn(),t=vn();let r=class extends e.Parser{priority=60;parse(a,o,l){switch(o){case"m":return(0,t.parseNumericPattern)(n.numericPatterns.minute,a);case"mo":return l.ordinalNumber(a,{unit:"minute"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=59}set(a,o,l){return a.setMinutes(l,0,0),a}incompatibleTokens=["t","T"]};return xg.MinuteParser=r,xg}var yg={},RO;function wte(){if(RO)return yg;RO=1,yg.SecondParser=void 0;var n=ws(),e=dn(),t=vn();let r=class extends e.Parser{priority=50;parse(a,o,l){switch(o){case"s":return(0,t.parseNumericPattern)(n.numericPatterns.second,a);case"so":return l.ordinalNumber(a,{unit:"second"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=59}set(a,o,l){return a.setSeconds(l,0),a}incompatibleTokens=["t","T"]};return yg.SecondParser=r,yg}var vg={},LO;function Ste(){if(LO)return vg;LO=1,vg.FractionOfSecondParser=void 0;var n=dn(),e=vn();let t=class extends n.Parser{priority=30;parse(s,a){const o=l=>Math.trunc(l*Math.pow(10,-a.length+3));return(0,e.mapValue)((0,e.parseNDigits)(a.length,s),o)}set(s,a,o){return s.setMilliseconds(o),s}incompatibleTokens=["t","T"]};return vg.FractionOfSecondParser=t,vg}var bg={},FO;function jte(){if(FO)return bg;FO=1,bg.ISOTimezoneWithZParser=void 0;var n=an(),e=Jc(),t=ws(),r=dn(),s=vn();let a=class extends r.Parser{priority=10;parse(l,c){switch(c){case"X":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalMinutes,l);case"XX":return(0,s.parseTimezonePattern)(t.timezonePatterns.basic,l);case"XXXX":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalSeconds,l);case"XXXXX":return(0,s.parseTimezonePattern)(t.timezonePatterns.extendedOptionalSeconds,l);case"XXX":default:return(0,s.parseTimezonePattern)(t.timezonePatterns.extended,l)}}set(l,c,d){return c.timestampIsSet?l:(0,n.constructFrom)(l,l.getTime()-(0,e.getTimezoneOffsetInMilliseconds)(l)-d)}incompatibleTokens=["t","T","x"]};return bg.ISOTimezoneWithZParser=a,bg}var _g={},qO;function Nte(){if(qO)return _g;qO=1,_g.ISOTimezoneParser=void 0;var n=an(),e=Jc(),t=ws(),r=dn(),s=vn();let a=class extends r.Parser{priority=10;parse(l,c){switch(c){case"x":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalMinutes,l);case"xx":return(0,s.parseTimezonePattern)(t.timezonePatterns.basic,l);case"xxxx":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalSeconds,l);case"xxxxx":return(0,s.parseTimezonePattern)(t.timezonePatterns.extendedOptionalSeconds,l);case"xxx":default:return(0,s.parseTimezonePattern)(t.timezonePatterns.extended,l)}}set(l,c,d){return c.timestampIsSet?l:(0,n.constructFrom)(l,l.getTime()-(0,e.getTimezoneOffsetInMilliseconds)(l)-d)}incompatibleTokens=["t","T","X"]};return _g.ISOTimezoneParser=a,_g}var wg={},zO;function Cte(){if(zO)return wg;zO=1,wg.TimestampSecondsParser=void 0;var n=an(),e=dn(),t=vn();let r=class extends e.Parser{priority=40;parse(a){return(0,t.parseAnyDigitsSigned)(a)}set(a,o,l){return[(0,n.constructFrom)(a,l*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"};return wg.TimestampSecondsParser=r,wg}var Sg={},UO;function Tte(){if(UO)return Sg;UO=1,Sg.TimestampMillisecondsParser=void 0;var n=an(),e=dn(),t=vn();let r=class extends e.Parser{priority=20;parse(a){return(0,t.parseAnyDigitsSigned)(a)}set(a,o,l){return[(0,n.constructFrom)(a,l),{timestampIsSet:!0}]}incompatibleTokens="*"};return Sg.TimestampMillisecondsParser=r,Sg}var VO;function Pte(){if(VO)return $p;VO=1,$p.parsers=void 0;var n=Jee(),e=Qee(),t=Xee(),r=ete(),s=tte(),a=nte(),o=rte(),l=ste(),c=ite(),d=ate(),m=ote(),p=lte(),x=cte(),v=dte(),_=ute(),w=fte(),j=hte(),P=mte(),k=pte(),I=gte(),M=xte(),D=yte(),O=vte(),q=bte(),F=_te(),U=wte(),B=Ste(),G=jte(),X=Nte(),Q=Cte(),Y=Tte();return $p.parsers={G:new n.EraParser,y:new e.YearParser,Y:new t.LocalWeekYearParser,R:new r.ISOWeekYearParser,u:new s.ExtendedYearParser,Q:new a.QuarterParser,q:new o.StandAloneQuarterParser,M:new l.MonthParser,L:new c.StandAloneMonthParser,w:new d.LocalWeekParser,I:new m.ISOWeekParser,d:new p.DateParser,D:new x.DayOfYearParser,E:new v.DayParser,e:new _.LocalDayParser,c:new w.StandAloneLocalDayParser,i:new j.ISODayParser,a:new P.AMPMParser,b:new k.AMPMMidnightParser,B:new I.DayPeriodParser,h:new M.Hour1to12Parser,H:new D.Hour0to23Parser,K:new O.Hour0To11Parser,k:new q.Hour1To24Parser,m:new F.MinuteParser,s:new U.SecondParser,S:new B.FractionOfSecondParser,X:new G.ISOTimezoneWithZParser,x:new X.ISOTimezoneParser,t:new Q.TimestampSecondsParser,T:new Y.TimestampMillisecondsParser},$p}var BO;function m5(){return BO||(BO=1,(function(n){Object.defineProperty(n,"longFormatters",{enumerable:!0,get:function(){return a.longFormatters}}),n.parse=w,Object.defineProperty(n,"parsers",{enumerable:!0,get:function(){return l.parsers}});var e=an(),t=a5(),r=Ff(),s=Ae(),a=Q3(),o=X3(),l=Pte(),c=d5();const d=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,m=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,p=/^'([^]*?)'?$/,x=/''/g,v=/\S/,_=/[a-zA-Z]/;function w(P,k,I,M){const D=(0,t.getDefaultOptions)(),O=M?.locale??D.locale??r.defaultLocale,q=M?.firstWeekContainsDate??M?.locale?.options?.firstWeekContainsDate??D.firstWeekContainsDate??D.locale?.options?.firstWeekContainsDate??1,F=M?.weekStartsOn??M?.locale?.options?.weekStartsOn??D.weekStartsOn??D.locale?.options?.weekStartsOn??0;if(k==="")return P===""?(0,s.toDate)(I):(0,e.constructFrom)(I,NaN);const U={firstWeekContainsDate:q,weekStartsOn:F,locale:O},B=[new c.DateToSystemTimezoneSetter],G=k.match(m).map(te=>{const ie=te[0];if(ie in a.longFormatters){const $=a.longFormatters[ie];return $(te,O.formatLong)}return te}).join("").match(d),X=[];for(let te of G){!M?.useAdditionalWeekYearTokens&&(0,o.isProtectedWeekYearToken)(te)&&(0,o.warnOrThrowProtectedError)(te,k,P),!M?.useAdditionalDayOfYearTokens&&(0,o.isProtectedDayOfYearToken)(te)&&(0,o.warnOrThrowProtectedError)(te,k,P);const ie=te[0],$=l.parsers[ie];if($){const{incompatibleTokens:H}=$;if(Array.isArray(H)){const W=X.find(ee=>H.includes(ee.token)||ee.token===ie);if(W)throw new RangeError(`The format string mustn't contain \`${W.fullToken}\` and \`${te}\` at the same time`)}else if($.incompatibleTokens==="*"&&X.length>0)throw new RangeError(`The format string mustn't contain \`${te}\` and any other token at the same time`);X.push({token:ie,fullToken:te});const se=$.run(P,te,O.match,U);if(!se)return(0,e.constructFrom)(I,NaN);B.push(se.setter),P=se.rest}else{if(ie.match(_))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ie+"`");if(te==="''"?te="'":ie==="'"&&(te=j(te)),P.indexOf(te)===0)P=P.slice(te.length);else return(0,e.constructFrom)(I,NaN)}}if(P.length>0&&v.test(P))return(0,e.constructFrom)(I,NaN);const Q=B.map(te=>te.priority).sort((te,ie)=>ie-te).filter((te,ie,$)=>$.indexOf(te)===ie).map(te=>B.filter(ie=>ie.priority===te).sort((ie,$)=>$.subPriority-ie.subPriority)).map(te=>te[0]);let Y=(0,s.toDate)(I);if(isNaN(Y.getTime()))return(0,e.constructFrom)(I,NaN);const ne={};for(const te of Q){if(!te.validate(Y,U))return(0,e.constructFrom)(I,NaN);const ie=te.set(Y,ne,U);Array.isArray(ie)?(Y=ie[0],Object.assign(ne,ie[1])):Y=ie}return(0,e.constructFrom)(I,Y)}function j(P){return P.match(p)[1].replace(x,"'")}})(lw)),lw}var WO;function Mte(){if(WO)return ow;WO=1,ow.isMatch=t;var n=Xc(),e=m5();function t(r,s,a){return(0,n.isValid)((0,e.parse)(r,s,new Date,a))}return ow}var mw={},$O;function kte(){if($O)return mw;$O=1,mw.isMonday=e;var n=Ae();function e(t){return(0,n.toDate)(t).getDay()===1}return mw}var pw={},HO;function Ete(){if(HO)return pw;HO=1,pw.isPast=e;var n=Ae();function e(t){return+(0,n.toDate)(t)<Date.now()}return pw}var gw={},xw={},YO;function p5(){if(YO)return xw;YO=1,xw.startOfHour=e;var n=Ae();function e(t){const r=(0,n.toDate)(t);return r.setMinutes(0,0,0),r}return xw}var GO;function g5(){if(GO)return gw;GO=1,gw.isSameHour=e;var n=p5();function e(t,r){const s=(0,n.startOfHour)(t),a=(0,n.startOfHour)(r);return+s==+a}return gw}var yw={},vw={},ZO;function YC(){if(ZO)return vw;ZO=1,vw.isSameWeek=e;var n=_o();function e(t,r,s){const a=(0,n.startOfWeek)(t,s),o=(0,n.startOfWeek)(r,s);return+a==+o}return vw}var KO;function x5(){if(KO)return yw;KO=1,yw.isSameISOWeek=e;var n=YC();function e(t,r){return(0,n.isSameWeek)(t,r,{weekStartsOn:1})}return yw}var bw={},JO;function Dte(){if(JO)return bw;JO=1,bw.isSameISOWeekYear=e;var n=Sm();function e(t,r){const s=(0,n.startOfISOWeekYear)(t),a=(0,n.startOfISOWeekYear)(r);return+s==+a}return bw}var _w={},QO;function y5(){if(QO)return _w;QO=1,_w.isSameMinute=e;var n=zC();function e(t,r){const s=(0,n.startOfMinute)(t),a=(0,n.startOfMinute)(r);return+s==+a}return _w}var ww={},XO;function v5(){if(XO)return ww;XO=1,ww.isSameMonth=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()}return ww}var Sw={},eI;function b5(){if(eI)return Sw;eI=1,Sw.isSameQuarter=e;var n=UC();function e(t,r){const s=(0,n.startOfQuarter)(t),a=(0,n.startOfQuarter)(r);return+s==+a}return Sw}var jw={},Nw={},tI;function _5(){if(tI)return Nw;tI=1,Nw.startOfSecond=e;var n=Ae();function e(t){const r=(0,n.toDate)(t);return r.setMilliseconds(0),r}return Nw}var nI;function w5(){if(nI)return jw;nI=1,jw.isSameSecond=e;var n=_5();function e(t,r){const s=(0,n.startOfSecond)(t),a=(0,n.startOfSecond)(r);return+s==+a}return jw}var Cw={},rI;function S5(){if(rI)return Cw;rI=1,Cw.isSameYear=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()===a.getFullYear()}return Cw}var Tw={},sI;function Ote(){if(sI)return Tw;sI=1,Tw.isThisHour=t;var n=$s(),e=g5();function t(r){return(0,e.isSameHour)(r,(0,n.constructNow)(r))}return Tw}var Pw={},iI;function Ite(){if(iI)return Pw;iI=1,Pw.isThisISOWeek=t;var n=$s(),e=x5();function t(r){return(0,e.isSameISOWeek)(r,(0,n.constructNow)(r))}return Pw}var Mw={},aI;function Ate(){if(aI)return Mw;aI=1,Mw.isThisMinute=t;var n=$s(),e=y5();function t(r){return(0,e.isSameMinute)(r,(0,n.constructNow)(r))}return Mw}var kw={},oI;function Rte(){if(oI)return kw;oI=1,kw.isThisMonth=t;var n=$s(),e=v5();function t(r){return(0,e.isSameMonth)(r,(0,n.constructNow)(r))}return kw}var Ew={},lI;function Lte(){if(lI)return Ew;lI=1,Ew.isThisQuarter=t;var n=$s(),e=b5();function t(r){return(0,e.isSameQuarter)(r,(0,n.constructNow)(r))}return Ew}var Dw={},cI;function Fte(){if(cI)return Dw;cI=1,Dw.isThisSecond=t;var n=$s(),e=w5();function t(r){return(0,e.isSameSecond)(r,(0,n.constructNow)(r))}return Dw}var Ow={},dI;function qte(){if(dI)return Ow;dI=1,Ow.isThisWeek=t;var n=$s(),e=YC();function t(r,s){return(0,e.isSameWeek)(r,(0,n.constructNow)(r),s)}return Ow}var Iw={},uI;function zte(){if(uI)return Iw;uI=1,Iw.isThisYear=t;var n=$s(),e=S5();function t(r){return(0,e.isSameYear)(r,(0,n.constructNow)(r))}return Iw}var Aw={},fI;function Ute(){if(fI)return Aw;fI=1,Aw.isThursday=e;var n=Ae();function e(t){return(0,n.toDate)(t).getDay()===4}return Aw}var Rw={},hI;function Vte(){if(hI)return Rw;hI=1,Rw.isToday=t;var n=$s(),e=jm();function t(r){return(0,e.isSameDay)(r,(0,n.constructNow)(r))}return Rw}var Lw={},mI;function Bte(){if(mI)return Lw;mI=1,Lw.isTomorrow=r;var n=Cl(),e=$s(),t=jm();function r(s){return(0,t.isSameDay)(s,(0,n.addDays)((0,e.constructNow)(s),1))}return Lw}var Fw={},pI;function Wte(){if(pI)return Fw;pI=1,Fw.isTuesday=e;var n=Ae();function e(t){return(0,n.toDate)(t).getDay()===2}return Fw}var qw={},gI;function $te(){if(gI)return qw;gI=1,qw.isWednesday=e;var n=Ae();function e(t){return(0,n.toDate)(t).getDay()===3}return qw}var zw={},xI;function Hte(){if(xI)return zw;xI=1,zw.isWithinInterval=e;var n=Ae();function e(t,r){const s=+(0,n.toDate)(t),[a,o]=[+(0,n.toDate)(r.start),+(0,n.toDate)(r.end)].sort((l,c)=>l-c);return s>=a&&s<=o}return zw}var Uw={},Vw={},yI;function dy(){if(yI)return Vw;yI=1,Vw.subDays=e;var n=Cl();function e(t,r){return(0,n.addDays)(t,-r)}return Vw}var vI;function Yte(){if(vI)return Uw;vI=1,Uw.isYesterday=r;var n=$s(),e=jm(),t=dy();function r(s){return(0,e.isSameDay)(s,(0,t.subDays)((0,n.constructNow)(s),1))}return Uw}var Bw={},bI;function Gte(){if(bI)return Bw;bI=1,Bw.lastDayOfDecade=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=9+Math.floor(s/10)*10;return r.setFullYear(a+1,0,0),r.setHours(0,0,0,0),r}return Bw}var Ww={},$w={},_I;function j5(){if(_I)return $w;_I=1,$w.lastDayOfWeek=t;var n=Ae(),e=_s();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?-7:0)+6-(c-o);return l.setHours(0,0,0,0),l.setDate(l.getDate()+d),l}return $w}var wI;function Zte(){if(wI)return Ww;wI=1,Ww.lastDayOfISOWeek=e;var n=j5();function e(t){return(0,n.lastDayOfWeek)(t,{weekStartsOn:1})}return Ww}var Hw={},SI;function Kte(){if(SI)return Hw;SI=1,Hw.lastDayOfISOWeekYear=r;var n=bu(),e=Tl(),t=an();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const l=(0,e.startOfISOWeek)(o);return l.setDate(l.getDate()-1),l}return Hw}var Yw={},jI;function Jte(){if(jI)return Yw;jI=1,Yw.lastDayOfQuarter=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3+3;return r.setMonth(a,0),r.setHours(0,0,0,0),r}return Yw}var Gw={},NI;function Qte(){if(NI)return Gw;NI=1,Gw.lastDayOfYear=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(0,0,0,0),r}return Gw}var Zw={},CI;function Xte(){return CI||(CI=1,(function(n){n.lightFormat=c,Object.defineProperty(n,"lightFormatters",{enumerable:!0,get:function(){return r.lightFormatters}});var e=Xc(),t=Ae(),r=J3();const s=/(\w)\1*|''|'(''|[^'])+('|$)|./g,a=/^'([^]*?)'?$/,o=/''/g,l=/[a-zA-Z]/;function c(m,p){const x=(0,t.toDate)(m);if(!(0,e.isValid)(x))throw new RangeError("Invalid time value");const v=p.match(s);return v?v.map(w=>{if(w==="''")return"'";const j=w[0];if(j==="'")return d(w);const P=r.lightFormatters[j];if(P)return P(x,w);if(j.match(l))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");return w}).join(""):""}function d(m){const p=m.match(a);return p?p[1].replace(o,"'"):m}})(Zw)),Zw}var Kw={},TI;function ene(){if(TI)return Kw;TI=1,Kw.milliseconds=e;var n=Kt();function e({years:t,months:r,weeks:s,days:a,hours:o,minutes:l,seconds:c}){let d=0;t&&(d+=t*n.daysInYear),r&&(d+=r*(n.daysInYear/12)),s&&(d+=s*7),a&&(d+=a);let m=d*24*60*60;return o&&(m+=o*60*60),l&&(m+=l*60),c&&(m+=c),Math.trunc(m*1e3)}return Kw}var Jw={},PI;function tne(){if(PI)return Jw;PI=1,Jw.millisecondsToHours=e;var n=Kt();function e(t){const r=t/n.millisecondsInHour;return Math.trunc(r)}return Jw}var Qw={},MI;function nne(){if(MI)return Qw;MI=1,Qw.millisecondsToMinutes=e;var n=Kt();function e(t){const r=t/n.millisecondsInMinute;return Math.trunc(r)}return Qw}var Xw={},kI;function rne(){if(kI)return Xw;kI=1,Xw.millisecondsToSeconds=e;var n=Kt();function e(t){const r=t/n.millisecondsInSecond;return Math.trunc(r)}return Xw}var eS={},EI;function sne(){if(EI)return eS;EI=1,eS.minutesToHours=e;var n=Kt();function e(t){const r=t/n.minutesInHour;return Math.trunc(r)}return eS}var tS={},DI;function ine(){if(DI)return tS;DI=1,tS.minutesToMilliseconds=e;var n=Kt();function e(t){return Math.trunc(t*n.millisecondsInMinute)}return tS}var nS={},OI;function ane(){if(OI)return nS;OI=1,nS.minutesToSeconds=e;var n=Kt();function e(t){return Math.trunc(t*n.secondsInMinute)}return nS}var rS={},II;function one(){if(II)return rS;II=1,rS.monthsToQuarters=e;var n=Kt();function e(t){const r=t/n.monthsInQuarter;return Math.trunc(r)}return rS}var sS={},AI;function lne(){if(AI)return sS;AI=1,sS.monthsToYears=e;var n=Kt();function e(t){const r=t/n.monthsInYear;return Math.trunc(r)}return sS}var iS={},RI;function td(){if(RI)return iS;RI=1,iS.nextDay=t;var n=Cl(),e=ly();function t(r,s){let a=s-(0,e.getDay)(r);return a<=0&&(a+=7),(0,n.addDays)(r,a)}return iS}var aS={},LI;function cne(){if(LI)return aS;LI=1,aS.nextFriday=e;var n=td();function e(t){return(0,n.nextDay)(t,5)}return aS}var oS={},FI;function dne(){if(FI)return oS;FI=1,oS.nextMonday=e;var n=td();function e(t){return(0,n.nextDay)(t,1)}return oS}var lS={},qI;function une(){if(qI)return lS;qI=1,lS.nextSaturday=e;var n=td();function e(t){return(0,n.nextDay)(t,6)}return lS}var cS={},zI;function fne(){if(zI)return cS;zI=1,cS.nextSunday=e;var n=td();function e(t){return(0,n.nextDay)(t,0)}return cS}var dS={},UI;function hne(){if(UI)return dS;UI=1,dS.nextThursday=e;var n=td();function e(t){return(0,n.nextDay)(t,4)}return dS}var uS={},VI;function mne(){if(VI)return uS;VI=1,uS.nextTuesday=e;var n=td();function e(t){return(0,n.nextDay)(t,2)}return uS}var fS={},BI;function pne(){if(BI)return fS;BI=1,fS.nextWednesday=e;var n=td();function e(t){return(0,n.nextDay)(t,3)}return fS}var hS={},WI;function gne(){if(WI)return hS;WI=1,hS.parseISO=e;var n=Kt();function e(D,O){const q=O?.additionalDigits??2,F=o(D);let U;if(F.date){const Q=l(F.date,q);U=c(Q.restDateString,Q.year)}if(!U||isNaN(U.getTime()))return new Date(NaN);const B=U.getTime();let G=0,X;if(F.time&&(G=m(F.time),isNaN(G)))return new Date(NaN);if(F.timezone){if(X=x(F.timezone),isNaN(X))return new Date(NaN)}else{const Q=new Date(B+G),Y=new Date(0);return Y.setFullYear(Q.getUTCFullYear(),Q.getUTCMonth(),Q.getUTCDate()),Y.setHours(Q.getUTCHours(),Q.getUTCMinutes(),Q.getUTCSeconds(),Q.getUTCMilliseconds()),Y}return new Date(B+G+X)}const t={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},r=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,s=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,a=/^([+-])(\d{2})(?::?(\d{2}))?$/;function o(D){const O={},q=D.split(t.dateTimeDelimiter);let F;if(q.length>2)return O;if(/:/.test(q[0])?F=q[0]:(O.date=q[0],F=q[1],t.timeZoneDelimiter.test(O.date)&&(O.date=D.split(t.timeZoneDelimiter)[0],F=D.substr(O.date.length,D.length))),F){const U=t.timezone.exec(F);U?(O.time=F.replace(U[1],""),O.timezone=U[1]):O.time=F}return O}function l(D,O){const q=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+O)+"})|(\\d{2}|[+-]\\d{"+(2+O)+"})$)"),F=D.match(q);if(!F)return{year:NaN,restDateString:""};const U=F[1]?parseInt(F[1]):null,B=F[2]?parseInt(F[2]):null;return{year:B===null?U:B*100,restDateString:D.slice((F[1]||F[2]).length)}}function c(D,O){if(O===null)return new Date(NaN);const q=D.match(r);if(!q)return new Date(NaN);const F=!!q[4],U=d(q[1]),B=d(q[2])-1,G=d(q[3]),X=d(q[4]),Q=d(q[5])-1;if(F)return k(O,X,Q)?v(O,X,Q):new Date(NaN);{const Y=new Date(0);return!j(O,B,G)||!P(O,U)?new Date(NaN):(Y.setUTCFullYear(O,B,Math.max(U,G)),Y)}}function d(D){return D?parseInt(D):1}function m(D){const O=D.match(s);if(!O)return NaN;const q=p(O[1]),F=p(O[2]),U=p(O[3]);return I(q,F,U)?q*n.millisecondsInHour+F*n.millisecondsInMinute+U*1e3:NaN}function p(D){return D&&parseFloat(D.replace(",","."))||0}function x(D){if(D==="Z")return 0;const O=D.match(a);if(!O)return 0;const q=O[1]==="+"?-1:1,F=parseInt(O[2]),U=O[3]&&parseInt(O[3])||0;return M(F,U)?q*(F*n.millisecondsInHour+U*n.millisecondsInMinute):NaN}function v(D,O,q){const F=new Date(0);F.setUTCFullYear(D,0,4);const U=F.getUTCDay()||7,B=(O-1)*7+q+1-U;return F.setUTCDate(F.getUTCDate()+B),F}const _=[31,null,31,30,31,30,31,31,30,31,30,31];function w(D){return D%400===0||D%4===0&&D%100!==0}function j(D,O,q){return O>=0&&O<=11&&q>=1&&q<=(_[O]||(w(D)?29:28))}function P(D,O){return O>=1&&O<=(w(D)?366:365)}function k(D,O,q){return O>=1&&O<=53&&q>=0&&q<=6}function I(D,O,q){return D===24?O===0&&q===0:q>=0&&q<60&&O>=0&&O<60&&D>=0&&D<25}function M(D,O){return O>=0&&O<=59}return hS}var mS={},$I;function xne(){if($I)return mS;$I=1,mS.parseJSON=n;function n(e){const t=e.match(/(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})(?:\.(\d{0,7}))?(?:Z|(.)(\d{2}):?(\d{2})?)?/);return t?new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4]-(+t[9]||0)*(t[8]=="-"?-1:1),+t[5]-(+t[10]||0)*(t[8]=="-"?-1:1),+t[6],+((t[7]||"0")+"00").substring(0,3))):new Date(NaN)}return mS}var pS={},HI;function nd(){if(HI)return pS;HI=1,pS.previousDay=t;var n=ly(),e=dy();function t(r,s){let a=(0,n.getDay)(r)-s;return a<=0&&(a+=7),(0,e.subDays)(r,a)}return pS}var gS={},YI;function yne(){if(YI)return gS;YI=1,gS.previousFriday=e;var n=nd();function e(t){return(0,n.previousDay)(t,5)}return gS}var xS={},GI;function vne(){if(GI)return xS;GI=1,xS.previousMonday=e;var n=nd();function e(t){return(0,n.previousDay)(t,1)}return xS}var yS={},ZI;function bne(){if(ZI)return yS;ZI=1,yS.previousSaturday=e;var n=nd();function e(t){return(0,n.previousDay)(t,6)}return yS}var vS={},KI;function _ne(){if(KI)return vS;KI=1,vS.previousSunday=e;var n=nd();function e(t){return(0,n.previousDay)(t,0)}return vS}var bS={},JI;function wne(){if(JI)return bS;JI=1,bS.previousThursday=e;var n=nd();function e(t){return(0,n.previousDay)(t,4)}return bS}var _S={},QI;function Sne(){if(QI)return _S;QI=1,_S.previousTuesday=e;var n=nd();function e(t){return(0,n.previousDay)(t,2)}return _S}var wS={},XI;function jne(){if(XI)return wS;XI=1,wS.previousWednesday=e;var n=nd();function e(t){return(0,n.previousDay)(t,3)}return wS}var SS={},eA;function Nne(){if(eA)return SS;eA=1,SS.quartersToMonths=e;var n=Kt();function e(t){return Math.trunc(t*n.monthsInQuarter)}return SS}var jS={},tA;function Cne(){if(tA)return jS;tA=1,jS.quartersToYears=e;var n=Kt();function e(t){const r=t/n.quartersInYear;return Math.trunc(r)}return jS}var NS={},nA;function Tne(){if(nA)return NS;nA=1,NS.roundToNearestHours=r;var n=ed(),e=an(),t=Ae();function r(s,a){const o=a?.nearestTo??1;if(o<1||o>12)return(0,e.constructFrom)(s,NaN);const l=(0,t.toDate)(s),c=l.getMinutes()/60,d=l.getSeconds()/60/60,m=l.getMilliseconds()/1e3/60/60,p=l.getHours()+c+d+m,x=a?.roundingMethod??"round",_=(0,n.getRoundingMethod)(x)(p/o)*o,w=(0,e.constructFrom)(s,l);return w.setHours(_,0,0,0),w}return NS}var CS={},rA;function Pne(){if(rA)return CS;rA=1,CS.roundToNearestMinutes=r;var n=ed(),e=an(),t=Ae();function r(s,a){const o=a?.nearestTo??1;if(o<1||o>30)return(0,e.constructFrom)(s,NaN);const l=(0,t.toDate)(s),c=l.getSeconds()/60,d=l.getMilliseconds()/1e3/60,m=l.getMinutes()+c+d,p=a?.roundingMethod??"round",v=(0,n.getRoundingMethod)(p)(m/o)*o,_=(0,e.constructFrom)(s,l);return _.setMinutes(v,0,0),_}return CS}var TS={},sA;function Mne(){if(sA)return TS;sA=1,TS.secondsToHours=e;var n=Kt();function e(t){const r=t/n.secondsInHour;return Math.trunc(r)}return TS}var PS={},iA;function kne(){if(iA)return PS;iA=1,PS.secondsToMilliseconds=e;var n=Kt();function e(t){return t*n.millisecondsInSecond}return PS}var MS={},aA;function Ene(){if(aA)return MS;aA=1,MS.secondsToMinutes=e;var n=Kt();function e(t){const r=t/n.secondsInMinute;return Math.trunc(r)}return MS}var kS={},ES={},oA;function GC(){if(oA)return ES;oA=1,ES.setMonth=r;var n=an(),e=s5(),t=Ae();function r(s,a){const o=(0,t.toDate)(s),l=o.getFullYear(),c=o.getDate(),d=(0,n.constructFrom)(s,0);d.setFullYear(l,a,15),d.setHours(0,0,0,0);const m=(0,e.getDaysInMonth)(d);return o.setMonth(a,Math.min(c,m)),o}return ES}var lA;function Dne(){if(lA)return kS;lA=1,kS.set=r;var n=an(),e=GC(),t=Ae();function r(s,a){let o=(0,t.toDate)(s);return isNaN(+o)?(0,n.constructFrom)(s,NaN):(a.year!=null&&o.setFullYear(a.year),a.month!=null&&(o=(0,e.setMonth)(o,a.month)),a.date!=null&&o.setDate(a.date),a.hours!=null&&o.setHours(a.hours),a.minutes!=null&&o.setMinutes(a.minutes),a.seconds!=null&&o.setSeconds(a.seconds),a.milliseconds!=null&&o.setMilliseconds(a.milliseconds),o)}return kS}var DS={},cA;function One(){if(cA)return DS;cA=1,DS.setDate=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t);return s.setDate(r),s}return DS}var OS={},dA;function Ine(){if(dA)return OS;dA=1,OS.setDayOfYear=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t);return s.setMonth(0),s.setDate(r),s}return OS}var IS={},uA;function Ane(){if(uA)return IS;uA=1,IS.setDefaultOptions=e;var n=_s();function e(t){const r={},s=(0,n.getDefaultOptions)();for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&(r[a]=s[a]);for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(t[a]===void 0?delete r[a]:r[a]=t[a]);(0,n.setDefaultOptions)(r)}return IS}var AS={},fA;function Rne(){if(fA)return AS;fA=1,AS.setHours=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t);return s.setHours(r),s}return AS}var RS={},hA;function Lne(){if(hA)return RS;hA=1,RS.setMilliseconds=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t);return s.setMilliseconds(r),s}return RS}var LS={},mA;function Fne(){if(mA)return LS;mA=1,LS.setMinutes=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t);return s.setMinutes(r),s}return LS}var FS={},pA;function qne(){if(pA)return FS;pA=1,FS.setQuarter=t;var n=GC(),e=Ae();function t(r,s){const a=(0,e.toDate)(r),o=Math.trunc(a.getMonth()/3)+1,l=s-o;return(0,n.setMonth)(a,a.getMonth()+l*3)}return FS}var qS={},gA;function zne(){if(gA)return qS;gA=1,qS.setSeconds=e;var n=Ae();function e(t,r){const s=(0,n.toDate)(t);return s.setSeconds(r),s}return qS}var zS={},xA;function Une(){if(xA)return zS;xA=1,zS.setWeekYear=a;var n=an(),e=Qc(),t=$C(),r=Ae(),s=_s();function a(o,l,c){const d=(0,s.getDefaultOptions)(),m=c?.firstWeekContainsDate??c?.locale?.options?.firstWeekContainsDate??d.firstWeekContainsDate??d.locale?.options?.firstWeekContainsDate??1;let p=(0,r.toDate)(o);const x=(0,e.differenceInCalendarDays)(p,(0,t.startOfWeekYear)(p,c)),v=(0,n.constructFrom)(o,0);return v.setFullYear(l,0,m),v.setHours(0,0,0,0),p=(0,t.startOfWeekYear)(v,c),p.setDate(p.getDate()+x),p}return zS}var US={},yA;function Vne(){if(yA)return US;yA=1,US.setYear=t;var n=an(),e=Ae();function t(r,s){const a=(0,e.toDate)(r);return isNaN(+a)?(0,n.constructFrom)(r,NaN):(a.setFullYear(s),a)}return US}var VS={},vA;function Bne(){if(vA)return VS;vA=1,VS.startOfDecade=e;var n=Ae();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=Math.floor(s/10)*10;return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}return VS}var BS={},bA;function Wne(){if(bA)return BS;bA=1,BS.startOfToday=e;var n=ty();function e(){return(0,n.startOfDay)(Date.now())}return BS}var WS={},_A;function $ne(){if(_A)return WS;_A=1,WS.startOfTomorrow=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s+1),a.setHours(0,0,0,0),a}return WS}var $S={},wA;function Hne(){if(wA)return $S;wA=1,$S.startOfYesterday=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s-1),a.setHours(0,0,0,0),a}return $S}var HS={},YS={},SA;function N5(){if(SA)return YS;SA=1,YS.subMonths=e;var n=_m();function e(t,r){return(0,n.addMonths)(t,-r)}return YS}var jA;function Yne(){if(jA)return HS;jA=1,HS.sub=r;var n=dy(),e=N5(),t=an();function r(s,a){const{years:o=0,months:l=0,weeks:c=0,days:d=0,hours:m=0,minutes:p=0,seconds:x=0}=a,v=(0,e.subMonths)(s,l+o*12),_=(0,n.subDays)(v,d+c*7),w=p+m*60,P=(x+w*60)*1e3;return(0,t.constructFrom)(s,_.getTime()-P)}return HS}var GS={},NA;function Gne(){if(NA)return GS;NA=1,GS.subBusinessDays=e;var n=D3();function e(t,r){return(0,n.addBusinessDays)(t,-r)}return GS}var ZS={},CA;function Zne(){if(CA)return ZS;CA=1,ZS.subHours=e;var n=MC();function e(t,r){return(0,n.addHours)(t,-r)}return ZS}var KS={},TA;function Kne(){if(TA)return KS;TA=1,KS.subMilliseconds=e;var n=wm();function e(t,r){return(0,n.addMilliseconds)(t,-r)}return KS}var JS={},PA;function Jne(){if(PA)return JS;PA=1,JS.subMinutes=e;var n=kC();function e(t,r){return(0,n.addMinutes)(t,-r)}return JS}var QS={},MA;function Qne(){if(MA)return QS;MA=1,QS.subQuarters=e;var n=EC();function e(t,r){return(0,n.addQuarters)(t,-r)}return QS}var XS={},kA;function Xne(){if(kA)return XS;kA=1,XS.subSeconds=e;var n=A3();function e(t,r){return(0,n.addSeconds)(t,-r)}return XS}var ej={},EA;function ere(){if(EA)return ej;EA=1,ej.subWeeks=e;var n=ny();function e(t,r){return(0,n.addWeeks)(t,-r)}return ej}var tj={},DA;function tre(){if(DA)return tj;DA=1,tj.subYears=e;var n=R3();function e(t,r){return(0,n.addYears)(t,-r)}return tj}var nj={},OA;function nre(){if(OA)return nj;OA=1,nj.weeksToDays=e;var n=Kt();function e(t){return Math.trunc(t*n.daysInWeek)}return nj}var rj={},IA;function rre(){if(IA)return rj;IA=1,rj.yearsToDays=e;var n=Kt();function e(t){return Math.trunc(t*n.daysInYear)}return rj}var sj={},AA;function sre(){if(AA)return sj;AA=1,sj.yearsToMonths=e;var n=Kt();function e(t){return Math.trunc(t*n.monthsInYear)}return sj}var ij={},RA;function ire(){if(RA)return ij;RA=1,ij.yearsToQuarters=e;var n=Kt();function e(t){return Math.trunc(t*n.quartersInYear)}return ij}var LA;function _u(){return LA||(LA=1,(function(n){var e=M3();Object.keys(e).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===e[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return e[g]}})});var t=D3();Object.keys(t).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===t[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return t[g]}})});var r=Cl();Object.keys(r).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===r[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return r[g]}})});var s=MC();Object.keys(s).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===s[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return s[g]}})});var a=I3();Object.keys(a).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===a[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return a[g]}})});var o=wm();Object.keys(o).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===o[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return o[g]}})});var l=kC();Object.keys(l).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===l[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return l[g]}})});var c=_m();Object.keys(c).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===c[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return c[g]}})});var d=EC();Object.keys(d).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===d[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return d[g]}})});var m=A3();Object.keys(m).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===m[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return m[g]}})});var p=ny();Object.keys(p).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===p[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return p[g]}})});var x=R3();Object.keys(x).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===x[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return x[g]}})});var v=PX();Object.keys(v).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===v[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return v[g]}})});var _=MX();Object.keys(_).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _[g]}})});var w=kX();Object.keys(w).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===w[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return w[g]}})});var j=EX();Object.keys(j).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===j[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return j[g]}})});var P=Lf();Object.keys(P).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===P[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return P[g]}})});var k=DX();Object.keys(k).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===k[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return k[g]}})});var I=an();Object.keys(I).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===I[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return I[g]}})});var M=$s();Object.keys(M).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===M[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return M[g]}})});var D=OX();Object.keys(D).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===D[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return D[g]}})});var O=IX();Object.keys(O).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===O[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return O[g]}})});var q=Qc();Object.keys(q).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===q[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return q[g]}})});var F=z3();Object.keys(F).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===F[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return F[g]}})});var U=AX();Object.keys(U).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===U[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return U[g]}})});var B=DC();Object.keys(B).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===B[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return B[g]}})});var G=V3();Object.keys(G).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===G[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return G[g]}})});var X=OC();Object.keys(X).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===X[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return X[g]}})});var Q=IC();Object.keys(Q).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Q[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Q[g]}})});var Y=AC();Object.keys(Y).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Y[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Y[g]}})});var ne=RC();Object.keys(ne).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ne[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ne[g]}})});var te=RX();Object.keys(te).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===te[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return te[g]}})});var ie=ry();Object.keys(ie).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ie[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ie[g]}})});var $=LC();Object.keys($).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $[g]}})});var H=sy();Object.keys(H).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===H[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return H[g]}})});var se=LX();Object.keys(se).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===se[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return se[g]}})});var W=iy();Object.keys(W).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===W[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return W[g]}})});var ee=FX();Object.keys(ee).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ee[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ee[g]}})});var K=$3();Object.keys(K).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===K[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return K[g]}})});var oe=H3();Object.keys(oe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oe[g]}})});var re=qX();Object.keys(re).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===re[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return re[g]}})});var me=zX();Object.keys(me).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===me[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return me[g]}})});var _e=UX();Object.keys(_e).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_e[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _e[g]}})});var le=VX();Object.keys(le).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===le[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return le[g]}})});var fe=BX();Object.keys(fe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fe[g]}})});var ue=VC();Object.keys(ue).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ue[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ue[g]}})});var ce=WX();Object.keys(ce).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ce[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ce[g]}})});var Se=$X();Object.keys(Se).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Se[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Se[g]}})});var ye=HX();Object.keys(ye).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ye[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ye[g]}})});var Ne=FC();Object.keys(Ne).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ne[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ne[g]}})});var ke=YX();Object.keys(ke).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ke[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ke[g]}})});var qe=GX();Object.keys(qe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qe[g]}})});var ze=ZX();Object.keys(ze).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ze[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ze[g]}})});var He=KX();Object.keys(He).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===He[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return He[g]}})});var Be=JX();Object.keys(Be).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Be[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Be[g]}})});var de=qC();Object.keys(de).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===de[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return de[g]}})});var xe=QX();Object.keys(xe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xe[g]}})});var Pe=XX();Object.keys(Pe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pe[g]}})});var Ge=eee();Object.keys(Ge).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ge[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ge[g]}})});var Fe=tee();Object.keys(Fe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fe[g]}})});var Le=G3();Object.keys(Le).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Le[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Le[g]}})});var Je=Y3();Object.keys(Je).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Je[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Je[g]}})});var nt=nee();Object.keys(nt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===nt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return nt[g]}})});var ct=e5();Object.keys(ct).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ct[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ct[g]}})});var Vt=t5();Object.keys(Vt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vt[g]}})});var At=n5();Object.keys(At).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===At[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return At[g]}})});var vt=hee();Object.keys(vt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vt[g]}})});var wn=mee();Object.keys(wn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wn[g]}})});var Pn=pee();Object.keys(Pn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pn[g]}})});var Ht=gee();Object.keys(Ht).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ht[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ht[g]}})});var Un=xee();Object.keys(Un).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Un[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Un[g]}})});var Mn=yee();Object.keys(Mn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mn[g]}})});var An=vee();Object.keys(An).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===An[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return An[g]}})});var Pr=bee();Object.keys(Pr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pr[g]}})});var $r=_ee();Object.keys($r).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$r[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $r[g]}})});var un=wee();Object.keys(un).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===un[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return un[g]}})});var ot=r5();Object.keys(ot).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ot[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ot[g]}})});var kn=ly();Object.keys(kn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===kn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return kn[g]}})});var Xn=K3();Object.keys(Xn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xn[g]}})});var Hs=s5();Object.keys(Hs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Hs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Hs[g]}})});var wo=See();Object.keys(wo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wo[g]}})});var Pl=jee();Object.keys(Pl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pl[g]}})});var Ml=a5();Object.keys(Ml).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ml[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ml[g]}})});var So=Nee();Object.keys(So).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===So[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return So[g]}})});var Ea=o5();Object.keys(Ea).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ea[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ea[g]}})});var Gi=WC();Object.keys(Gi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gi[g]}})});var jo=bu();Object.keys(jo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===jo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return jo[g]}})});var Zi=Cee();Object.keys(Zi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zi[g]}})});var id=Tee();Object.keys(id).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===id[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return id[g]}})});var lr=Pee();Object.keys(lr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===lr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return lr[g]}})});var dt=Mee();Object.keys(dt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dt[g]}})});var Ki=kee();Object.keys(Ki).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ki[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ki[g]}})});var Da=U3();Object.keys(Da).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Da[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Da[g]}})});var kl=Eee();Object.keys(kl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===kl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return kl[g]}})});var El=Dee();Object.keys(El).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===El[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return El[g]}})});var No=Oee();Object.keys(No).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===No[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return No[g]}})});var Ss=HC();Object.keys(Ss).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ss[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ss[g]}})});var Ys=Iee();Object.keys(Ys).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ys[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ys[g]}})});var Co=oy();Object.keys(Co).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Co[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Co[g]}})});var ad=Aee();Object.keys(ad).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ad[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ad[g]}})});var Dl=Ree();Object.keys(Dl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Dl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Dl[g]}})});var Ol=Lee();Object.keys(Ol).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ol[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ol[g]}})});var Il=Fee();Object.keys(Il).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Il[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Il[g]}})});var To=qee();Object.keys(To).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===To[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return To[g]}})});var od=zee();Object.keys(od).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===od[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return od[g]}})});var Oa=Uee();Object.keys(Oa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oa[g]}})});var Sn=Vee();Object.keys(Sn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Sn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Sn[g]}})});var ld=Bee();Object.keys(ld).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ld[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ld[g]}})});var Po=Wee();Object.keys(Po).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Po[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Po[g]}})});var Al=$ee();Object.keys(Al).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Al[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Al[g]}})});var Ia=q3();Object.keys(Ia).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ia[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ia[g]}})});var Mo=Hee();Object.keys(Mo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mo[g]}})});var gi=Yee();Object.keys(gi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gi[g]}})});var Ji=Gee();Object.keys(Ji).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ji[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ji[g]}})});var Ir=Zee();Object.keys(Ir).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ir[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ir[g]}})});var Qi=Kee();Object.keys(Qi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qi[g]}})});var Mt=W3();Object.keys(Mt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mt[g]}})});var pn=i5();Object.keys(pn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pn[g]}})});var Aa=Mte();Object.keys(Aa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Aa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Aa[g]}})});var xi=kte();Object.keys(xi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xi[g]}})});var os=Ete();Object.keys(os).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===os[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return os[g]}})});var yi=jm();Object.keys(yi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===yi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return yi[g]}})});var Pt=g5();Object.keys(Pt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pt[g]}})});var fn=x5();Object.keys(fn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fn[g]}})});var ko=Dte();Object.keys(ko).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ko[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ko[g]}})});var Ra=y5();Object.keys(Ra).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ra[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ra[g]}})});var cr=v5();Object.keys(cr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===cr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return cr[g]}})});var Rl=b5();Object.keys(Rl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rl[g]}})});var vi=w5();Object.keys(vi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vi[g]}})});var Ar=YC();Object.keys(Ar).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ar[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ar[g]}})});var En=S5();Object.keys(En).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===En[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return En[g]}})});var ls=k3();Object.keys(ls).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ls[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ls[g]}})});var $t=E3();Object.keys($t).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$t[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $t[g]}})});var bi=Ote();Object.keys(bi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bi[g]}})});var La=Ite();Object.keys(La).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===La[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return La[g]}})});var Gs=Ate();Object.keys(Gs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gs[g]}})});var Fa=Rte();Object.keys(Fa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fa[g]}})});var qa=Lte();Object.keys(qa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qa[g]}})});var Xi=Fte();Object.keys(Xi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xi[g]}})});var ea=qte();Object.keys(ea).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ea[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ea[g]}})});var _i=zte();Object.keys(_i).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_i[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _i[g]}})});var Rr=Ute();Object.keys(Rr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rr[g]}})});var cs=Vte();Object.keys(cs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===cs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return cs[g]}})});var Hr=Bte();Object.keys(Hr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Hr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Hr[g]}})});var ta=Wte();Object.keys(ta).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ta[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ta[g]}})});var jt=Xc();Object.keys(jt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===jt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return jt[g]}})});var $n=$te();Object.keys($n).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$n[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $n[g]}})});var nn=ey();Object.keys(nn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===nn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return nn[g]}})});var Eo=Hte();Object.keys(Eo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Eo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Eo[g]}})});var Zs=Yte();Object.keys(Zs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zs[g]}})});var Do=Gte();Object.keys(Do).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Do[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Do[g]}})});var za=Zte();Object.keys(za).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===za[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return za[g]}})});var Yr=Kte();Object.keys(Yr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yr[g]}})});var Ua=l5();Object.keys(Ua).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ua[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ua[g]}})});var na=Jte();Object.keys(na).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===na[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return na[g]}})});var jn=j5();Object.keys(jn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===jn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return jn[g]}})});var Lr=Qte();Object.keys(Lr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Lr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Lr[g]}})});var Ks=Xte();Object.keys(Ks).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ks[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ks[g]}})});var ra=L3();Object.keys(ra).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ra[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ra[g]}})});var cd=ene();Object.keys(cd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===cd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return cd[g]}})});var Ll=tne();Object.keys(Ll).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ll[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ll[g]}})});var sa=nne();Object.keys(sa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===sa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return sa[g]}})});var Va=rne();Object.keys(Va).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Va[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Va[g]}})});var Ba=F3();Object.keys(Ba).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ba[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ba[g]}})});var Ut=sne();Object.keys(Ut).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ut[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ut[g]}})});var js=ine();Object.keys(js).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===js[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return js[g]}})});var vr=ane();Object.keys(vr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vr[g]}})});var Ns=one();Object.keys(Ns).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ns[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ns[g]}})});var Oo=lne();Object.keys(Oo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oo[g]}})});var Wa=td();Object.keys(Wa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wa[g]}})});var wi=cne();Object.keys(wi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wi[g]}})});var Fl=dne();Object.keys(Fl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fl[g]}})});var dr=une();Object.keys(dr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dr[g]}})});var Si=fne();Object.keys(Si).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Si[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Si[g]}})});var Io=hne();Object.keys(Io).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Io[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Io[g]}})});var Js=mne();Object.keys(Js).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Js[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Js[g]}})});var dd=pne();Object.keys(dd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dd[g]}})});var Mr=m5();Object.keys(Mr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mr[g]}})});var Ao=gne();Object.keys(Ao).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ao[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ao[g]}})});var ji=xne();Object.keys(ji).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ji[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ji[g]}})});var Fr=nd();Object.keys(Fr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fr[g]}})});var Ro=yne();Object.keys(Ro).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ro[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ro[g]}})});var ql=vne();Object.keys(ql).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ql[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ql[g]}})});var Lo=bne();Object.keys(Lo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Lo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Lo[g]}})});var ud=_ne();Object.keys(ud).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ud[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ud[g]}})});var $a=wne();Object.keys($a).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$a[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $a[g]}})});var zl=Sne();Object.keys(zl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zl[g]}})});var fd=jne();Object.keys(fd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fd[g]}})});var hd=Nne();Object.keys(hd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hd[g]}})});var Fo=Cne();Object.keys(Fo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fo[g]}})});var md=Tne();Object.keys(md).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===md[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return md[g]}})});var qo=Pne();Object.keys(qo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qo[g]}})});var Ul=Mne();Object.keys(Ul).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ul[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ul[g]}})});var Ha=kne();Object.keys(Ha).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ha[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ha[g]}})});var Qs=Ene();Object.keys(Qs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qs[g]}})});var pd=Dne();Object.keys(pd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pd[g]}})});var Xs=One();Object.keys(Xs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xs[g]}})});var kr=cy();Object.keys(kr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===kr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return kr[g]}})});var Vl=Ine();Object.keys(Vl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vl[g]}})});var Bl=Ane();Object.keys(Bl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bl[g]}})});var Wl=Rne();Object.keys(Wl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wl[g]}})});var zo=h5();Object.keys(zo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zo[g]}})});var Uo=f5();Object.keys(Uo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Uo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Uo[g]}})});var gd=O3();Object.keys(gd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gd[g]}})});var xd=Lne();Object.keys(xd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xd[g]}})});var $l=Fne();Object.keys($l).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$l[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $l[g]}})});var yd=GC();Object.keys(yd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===yd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return yd[g]}})});var qr=qne();Object.keys(qr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qr[g]}})});var Cs=zne();Object.keys(Cs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Cs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Cs[g]}})});var ia=u5();Object.keys(ia).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ia[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ia[g]}})});var ds=Une();Object.keys(ds).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ds[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ds[g]}})});var Hl=Vne();Object.keys(Hl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Hl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Hl[g]}})});var ei=ty();Object.keys(ei).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ei[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ei[g]}})});var Yl=Bne();Object.keys(Yl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yl[g]}})});var Ni=p5();Object.keys(Ni).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ni[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ni[g]}})});var Vo=Tl();Object.keys(Vo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vo[g]}})});var us=Sm();Object.keys(us).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===us[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return us[g]}})});var vd=zC();Object.keys(vd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vd[g]}})});var Ts=ay();Object.keys(Ts).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ts[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ts[g]}})});var Ya=UC();Object.keys(Ya).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ya[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ya[g]}})});var Gl=_5();Object.keys(Gl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gl[g]}})});var Ga=Wne();Object.keys(Ga).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ga[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ga[g]}})});var aa=$ne();Object.keys(aa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===aa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return aa[g]}})});var br=_o();Object.keys(br).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===br[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return br[g]}})});var bd=$C();Object.keys(bd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bd[g]}})});var fs=BC();Object.keys(fs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fs[g]}})});var _d=Hne();Object.keys(_d).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_d[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _d[g]}})});var Gr=Yne();Object.keys(Gr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gr[g]}})});var Ci=Gne();Object.keys(Ci).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ci[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ci[g]}})});var Za=dy();Object.keys(Za).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Za[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Za[g]}})});var Ka=Zne();Object.keys(Ka).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ka[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ka[g]}})});var oa=B3();Object.keys(oa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oa[g]}})});var Ja=Kne();Object.keys(Ja).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ja[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ja[g]}})});var Qa=Jne();Object.keys(Qa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qa[g]}})});var Ti=N5();Object.keys(Ti).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ti[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ti[g]}})});var Xa=Qne();Object.keys(Xa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xa[g]}})});var Bo=Xne();Object.keys(Bo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bo[g]}})});var Zl=ere();Object.keys(Zl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zl[g]}})});var zr=tre();Object.keys(zr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zr[g]}})});var Ps=Ae();Object.keys(Ps).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ps[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ps[g]}})});var Kl=c5();Object.keys(Kl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Kl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Kl[g]}})});var Wo=nre();Object.keys(Wo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wo[g]}})});var Jl=rre();Object.keys(Jl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jl[g]}})});var $o=sre();Object.keys($o).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$o[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $o[g]}})});var Ho=ire();Object.keys(Ho).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ho[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ho[g]}})})})(w0)),w0}var FA;function uy(){if(FA)return qd;FA=1,Object.defineProperty(qd,"__esModule",{value:!0}),qd.rangeShape=qd.default=void 0;var n=o(Ws()),e=s(Nl()),t=s(vu()),r=_u();function s(v){return v&&v.__esModule?v:{default:v}}function a(v){if(typeof WeakMap!="function")return null;var _=new WeakMap,w=new WeakMap;return(a=function(j){return j?w:_})(v)}function o(v,_){if(v&&v.__esModule)return v;if(v===null||typeof v!="object"&&typeof v!="function")return{default:v};var w=a(_);if(w&&w.has(v))return w.get(v);var j={__proto__:null},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var k in v)if(k!=="default"&&Object.prototype.hasOwnProperty.call(v,k)){var I=P?Object.getOwnPropertyDescriptor(v,k):null;I&&(I.get||I.set)?Object.defineProperty(j,k,I):j[k]=v[k]}return j.default=v,w&&w.set(v,j),j}function l(){return l=Object.assign?Object.assign.bind():function(v){for(var _=1;_<arguments.length;_++){var w=arguments[_];for(var j in w)Object.prototype.hasOwnProperty.call(w,j)&&(v[j]=w[j])}return v},l.apply(this,arguments)}function c(v,_,w){return _=d(_),_ in v?Object.defineProperty(v,_,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[_]=w,v}function d(v){var _=m(v,"string");return typeof _=="symbol"?_:String(_)}function m(v,_){if(typeof v!="object"||!v)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var j=w.call(v,_);if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(v)}let p=class extends n.Component{constructor(_,w){super(_,w),c(this,"handleKeyEvent",j=>{const{day:P,onMouseDown:k,onMouseUp:I}=this.props;[13,32].includes(j.keyCode)&&(j.type==="keydown"?k(P):I(P))}),c(this,"handleMouseEvent",j=>{const{day:P,disabled:k,onPreviewChange:I,onMouseEnter:M,onMouseDown:D,onMouseUp:O}=this.props,q={};if(k){I();return}switch(j.type){case"mouseenter":M(P),I(P),q.hover=!0;break;case"blur":case"mouseleave":q.hover=!1;break;case"mousedown":q.active=!0,D(P);break;case"mouseup":j.stopPropagation(),q.active=!1,O(P);break;case"focus":I(P);break}Object.keys(q).length&&this.setState(q)}),c(this,"getClassNames",()=>{const{isPassive:j,isToday:P,isWeekend:k,isStartOfWeek:I,isEndOfWeek:M,isStartOfMonth:D,isEndOfMonth:O,disabled:q,styles:F}=this.props;return(0,t.default)(F.day,{[F.dayPassive]:j,[F.dayDisabled]:q,[F.dayToday]:P,[F.dayWeekend]:k,[F.dayStartOfWeek]:I,[F.dayEndOfWeek]:M,[F.dayStartOfMonth]:D,[F.dayEndOfMonth]:O,[F.dayHovered]:this.state.hover,[F.dayActive]:this.state.active})}),c(this,"renderPreviewPlaceholder",()=>{const{preview:j,day:P,styles:k}=this.props;if(!j)return null;const I=j.startDate?(0,r.endOfDay)(j.startDate):null,M=j.endDate?(0,r.startOfDay)(j.endDate):null,D=(!I||(0,r.isAfter)(P,I))&&(!M||(0,r.isBefore)(P,M)),O=!D&&(0,r.isSameDay)(P,I),q=!D&&(0,r.isSameDay)(P,M);return n.default.createElement("span",{className:(0,t.default)({[k.dayStartPreview]:O,[k.dayInPreview]:D,[k.dayEndPreview]:q}),style:{color:j.color}})}),c(this,"renderSelectionPlaceholders",()=>{const{styles:j,ranges:P,day:k}=this.props;return this.props.displayMode==="date"?(0,r.isSameDay)(this.props.day,this.props.date)?n.default.createElement("span",{className:j.selected,style:{color:this.props.color}}):null:P.reduce((M,D)=>{let O=D.startDate,q=D.endDate;O&&q&&(0,r.isBefore)(q,O)&&([O,q]=[q,O]),O=O?(0,r.endOfDay)(O):null,q=q?(0,r.startOfDay)(q):null;const F=(!O||(0,r.isAfter)(k,O))&&(!q||(0,r.isBefore)(k,q)),U=!F&&(0,r.isSameDay)(k,O),B=!F&&(0,r.isSameDay)(k,q);return F||U||B?[...M,{isStartEdge:U,isEndEdge:B,isInRange:F,...D}]:M},[]).map((M,D)=>n.default.createElement("span",{key:D,className:(0,t.default)({[j.startEdge]:M.isStartEdge,[j.endEdge]:M.isEndEdge,[j.inRange]:M.isInRange}),style:{color:M.color||this.props.color}}))}),this.state={hover:!1,active:!1}}render(){const{dayContentRenderer:_}=this.props;return n.default.createElement("button",l({type:"button",onMouseEnter:this.handleMouseEvent,onMouseLeave:this.handleMouseEvent,onFocus:this.handleMouseEvent,onMouseDown:this.handleMouseEvent,onMouseUp:this.handleMouseEvent,onBlur:this.handleMouseEvent,onPauseCapture:this.handleMouseEvent,onKeyDown:this.handleKeyEvent,onKeyUp:this.handleKeyEvent,className:this.getClassNames(this.props.styles)},this.props.disabled||this.props.isPassive?{tabIndex:-1}:{},{style:{color:this.props.color}}),this.renderSelectionPlaceholders(),this.renderPreviewPlaceholder(),n.default.createElement("span",{className:this.props.styles.dayNumber},_?.(this.props.day)||n.default.createElement("span",null,(0,r.format)(this.props.day,this.props.dayDisplayFormat))))}};p.defaultProps={};const x=qd.rangeShape=e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string,key:e.default.string,autoFocus:e.default.bool,disabled:e.default.bool,showDateDisplay:e.default.bool});return p.propTypes={day:e.default.object.isRequired,dayDisplayFormat:e.default.string,date:e.default.object,ranges:e.default.arrayOf(x),preview:e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string}),onPreviewChange:e.default.func,previewColor:e.default.string,disabled:e.default.bool,isPassive:e.default.bool,isToday:e.default.bool,isWeekend:e.default.bool,isStartOfWeek:e.default.bool,isEndOfWeek:e.default.bool,isStartOfMonth:e.default.bool,isEndOfMonth:e.default.bool,color:e.default.string,displayMode:e.default.oneOf(["dateRange","date"]),styles:e.default.object,onMouseDown:e.default.func,onMouseUp:e.default.func,onMouseEnter:e.default.func,dayContentRenderer:e.default.func},qd.default=p,qd}var vh={},zd={},qA;function fy(){if(qA)return zd;qA=1,Object.defineProperty(zd,"__esModule",{value:!0}),zd.calcFocusDate=r,zd.findNextRangeIndex=s,zd.generateStyles=o,zd.getMonthDisplayRange=a;var n=t(vu()),e=_u();function t(l){return l&&l.__esModule?l:{default:l}}function r(l,c){const{shownDate:d,date:m,months:p,ranges:x,focusedRange:v,displayMode:_}=c;let w;if(_==="dateRange"){const P=x[v[0]]||{};w={start:P.startDate,end:P.endDate}}else w={start:m,end:m};w.start=(0,e.startOfMonth)(w.start||new Date),w.end=(0,e.endOfMonth)(w.end||w.start);const j=w.start||w.end||d||new Date;return l?(0,e.differenceInCalendarMonths)(w.start,w.end)>p?l:j:d||j}function s(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const d=l.findIndex((m,p)=>p>c&&m.autoFocus!==!1&&!m.disabled);return d!==-1?d:l.findIndex(m=>m.autoFocus!==!1&&!m.disabled)}function a(l,c,d){const m=(0,e.startOfMonth)(l,c),p=(0,e.endOfMonth)(l,c),x=(0,e.startOfWeek)(m,c);let v=(0,e.endOfWeek)(p,c);return d&&(0,e.differenceInCalendarDays)(v,x)<=34&&(v=(0,e.addDays)(v,7)),{start:x,end:v,startDateOfMonth:m,endDateOfMonth:p}}function o(l){return l.length?l.filter(d=>!!d).reduce((d,m)=>(Object.keys(m).forEach(p=>{d[p]=(0,n.default)(d[p],m[p])}),d),{}):{}}return zd}var zA;function are(){if(zA)return vh;zA=1,Object.defineProperty(vh,"__esModule",{value:!0}),vh.default=void 0;var n=l(Ws()),e=a(Nl()),t=l(uy()),r=_u(),s=fy();function a(p){return p&&p.__esModule?p:{default:p}}function o(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(o=function(_){return _?v:x})(p)}function l(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=o(x);if(v&&v.has(p))return v.get(p);var _={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var P=w?Object.getOwnPropertyDescriptor(p,j):null;P&&(P.get||P.set)?Object.defineProperty(_,j,P):_[j]=p[j]}return _.default=p,v&&v.set(p,_),_}function c(){return c=Object.assign?Object.assign.bind():function(p){for(var x=1;x<arguments.length;x++){var v=arguments[x];for(var _ in v)Object.prototype.hasOwnProperty.call(v,_)&&(p[_]=v[_])}return p},c.apply(this,arguments)}function d(p,x,v){const _=new Date;return n.default.createElement("div",{className:p.weekDays},(0,r.eachDayOfInterval)({start:(0,r.startOfWeek)(_,x),end:(0,r.endOfWeek)(_,x)}).map((w,j)=>n.default.createElement("span",{className:p.weekDay,key:j},(0,r.format)(w,v,x))))}let m=class extends n.PureComponent{render(){const x=new Date,{displayMode:v,focusedRange:_,drag:w,styles:j,disabledDates:P,disabledDay:k}=this.props,I=this.props.minDate&&(0,r.startOfDay)(this.props.minDate),M=this.props.maxDate&&(0,r.endOfDay)(this.props.maxDate),D=(0,s.getMonthDisplayRange)(this.props.month,this.props.dateOptions,this.props.fixedHeight);let O=this.props.ranges;if(v==="dateRange"&&w.status){let{startDate:F,endDate:U}=w.range;O=O.map((B,G)=>G!==_[0]?B:{...B,startDate:F,endDate:U})}const q=this.props.showPreview&&!w.disablePreview;return n.default.createElement("div",{className:j.month,style:this.props.style},this.props.showMonthName?n.default.createElement("div",{className:j.monthName},(0,r.format)(this.props.month,this.props.monthDisplayFormat,this.props.dateOptions)):null,this.props.showWeekDays&&d(j,this.props.dateOptions,this.props.weekdayDisplayFormat),n.default.createElement("div",{className:j.days,onMouseLeave:this.props.onMouseLeave},(0,r.eachDayOfInterval)({start:D.start,end:D.end}).map((F,U)=>{const B=(0,r.isSameDay)(F,D.startDateOfMonth),G=(0,r.isSameDay)(F,D.endDateOfMonth),X=I&&(0,r.isBefore)(F,I)||M&&(0,r.isAfter)(F,M),Q=P.some(ne=>(0,r.isSameDay)(ne,F)),Y=k(F);return n.default.createElement(t.default,c({},this.props,{ranges:O,day:F,preview:q?this.props.preview:null,isWeekend:(0,r.isWeekend)(F,this.props.dateOptions),isToday:(0,r.isSameDay)(F,x),isStartOfWeek:(0,r.isSameDay)(F,(0,r.startOfWeek)(F,this.props.dateOptions)),isEndOfWeek:(0,r.isSameDay)(F,(0,r.endOfWeek)(F,this.props.dateOptions)),isStartOfMonth:B,isEndOfMonth:G,key:U,disabled:X||Q||Y,isPassive:!(0,r.isWithinInterval)(F,{start:D.startDateOfMonth,end:D.endDateOfMonth}),styles:j,onMouseDown:this.props.onDragSelectionStart,onMouseUp:this.props.onDragSelectionEnd,onMouseEnter:this.props.onDragSelectionMove,dragRange:w.range,drag:w.status}))})))}};return m.defaultProps={},m.propTypes={style:e.default.object,styles:e.default.object,month:e.default.object,drag:e.default.object,dateOptions:e.default.object,disabledDates:e.default.array,disabledDay:e.default.func,preview:e.default.shape({startDate:e.default.object,endDate:e.default.object}),showPreview:e.default.bool,displayMode:e.default.oneOf(["dateRange","date"]),minDate:e.default.object,maxDate:e.default.object,ranges:e.default.arrayOf(t.rangeShape),focusedRange:e.default.arrayOf(e.default.number),onDragSelectionStart:e.default.func,onDragSelectionEnd:e.default.func,onDragSelectionMove:e.default.func,onMouseLeave:e.default.func,monthDisplayFormat:e.default.string,weekdayDisplayFormat:e.default.string,dayDisplayFormat:e.default.string,showWeekDays:e.default.bool,showMonthName:e.default.bool,fixedHeight:e.default.bool},vh.default=m,vh}var bh={},UA;function ore(){if(UA)return bh;UA=1,Object.defineProperty(bh,"__esModule",{value:!0}),bh.default=void 0;var n=o(Ws()),e=s(Nl()),t=s(vu()),r=_u();function s(p){return p&&p.__esModule?p:{default:p}}function a(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(a=function(_){return _?v:x})(p)}function o(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=a(x);if(v&&v.has(p))return v.get(p);var _={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var P=w?Object.getOwnPropertyDescriptor(p,j):null;P&&(P.get||P.set)?Object.defineProperty(_,j,P):_[j]=p[j]}return _.default=p,v&&v.set(p,_),_}function l(p,x,v){return x=c(x),x in p?Object.defineProperty(p,x,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[x]=v,p}function c(p){var x=d(p,"string");return typeof x=="symbol"?x:String(x)}function d(p,x){if(typeof p!="object"||!p)return p;var v=p[Symbol.toPrimitive];if(v!==void 0){var _=v.call(p,x);if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(p)}let m=class extends n.PureComponent{constructor(x,v){super(x,v),l(this,"onKeyDown",_=>{const{value:w}=this.state;_.key==="Enter"&&this.update(w)}),l(this,"onChange",_=>{this.setState({value:_.target.value,changed:!0,invalid:!1})}),l(this,"onBlur",()=>{const{value:_}=this.state;this.update(_)}),this.state={invalid:!1,changed:!1,value:this.formatDate(x)}}componentDidUpdate(x){const{value:v}=x;(0,r.isEqual)(v,this.props.value)||this.setState({value:this.formatDate(this.props)})}formatDate(x){let{value:v,dateDisplayFormat:_,dateOptions:w}=x;return v&&(0,r.isValid)(v)?(0,r.format)(v,_,w):""}update(x){const{invalid:v,changed:_}=this.state;if(v||!_||!x)return;const{onChange:w,dateDisplayFormat:j,dateOptions:P}=this.props,k=(0,r.parse)(x,j,new Date,P);(0,r.isValid)(k)?this.setState({changed:!1},()=>w(k)):this.setState({invalid:!0})}render(){const{className:x,readOnly:v,placeholder:_,ariaLabel:w,disabled:j,onFocus:P}=this.props,{value:k,invalid:I}=this.state;return n.default.createElement("span",{className:(0,t.default)("rdrDateInput",x)},n.default.createElement("input",{readOnly:v,disabled:j,value:k,placeholder:_,"aria-label":w,onKeyDown:this.onKeyDown,onChange:this.onChange,onBlur:this.onBlur,onFocus:P}),I&&n.default.createElement("span",{className:"rdrWarning"},""))}};return m.propTypes={value:e.default.object,placeholder:e.default.string,disabled:e.default.bool,readOnly:e.default.bool,dateOptions:e.default.object,dateDisplayFormat:e.default.string,ariaLabel:e.default.string,className:e.default.string,onFocus:e.default.func.isRequired,onChange:e.default.func.isRequired},m.defaultProps={readOnly:!0,disabled:!1,dateDisplayFormat:"MMM D, YYYY"},bh.default=m,bh}var jg={},VA;function lre(){return VA||(VA=1,(function(n){(function(e,t){t(n,Ws(),ML())})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:jg,function(e,t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function s(ee){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},s(ee)}function a(ee,K){if(!(ee instanceof K))throw new TypeError("Cannot call a class as a function")}function o(ee,K){for(var oe=0;oe<K.length;oe++){var re=K[oe];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(ee,k(re.key),re)}}function l(ee,K,oe){return K&&o(ee.prototype,K),oe&&o(ee,oe),Object.defineProperty(ee,"prototype",{writable:!1}),ee}function c(ee,K,oe){return K=x(K),d(ee,p()?Reflect.construct(K,oe||[],x(ee).constructor):K.apply(ee,oe))}function d(ee,K){if(K&&(s(K)=="object"||typeof K=="function"))return K;if(K!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return m(ee)}function m(ee){if(ee===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ee}function p(){try{var ee=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(p=function(){return!!ee})()}function x(ee){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(K){return K.__proto__||Object.getPrototypeOf(K)},x(ee)}function v(ee,K){if(typeof K!="function"&&K!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(K&&K.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),Object.defineProperty(ee,"prototype",{writable:!1}),K&&_(ee,K)}function _(ee,K){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(oe,re){return oe.__proto__=re,oe},_(ee,K)}function w(ee,K){var oe=Object.keys(ee);if(Object.getOwnPropertySymbols){var re=Object.getOwnPropertySymbols(ee);K&&(re=re.filter(function(me){return Object.getOwnPropertyDescriptor(ee,me).enumerable})),oe.push.apply(oe,re)}return oe}function j(ee){for(var K=1;K<arguments.length;K++){var oe=arguments[K]!=null?arguments[K]:{};K%2?w(Object(oe),!0).forEach(function(re){P(ee,re,oe[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(oe)):w(Object(oe)).forEach(function(re){Object.defineProperty(ee,re,Object.getOwnPropertyDescriptor(oe,re))})}return ee}function P(ee,K,oe){return(K=k(K))in ee?Object.defineProperty(ee,K,{value:oe,enumerable:!0,configurable:!0,writable:!0}):ee[K]=oe,ee}function k(ee){var K=I(ee,"string");return s(K)=="symbol"?K:K+""}function I(ee,K){if(s(ee)!="object"||!ee)return ee;var oe=ee[Symbol.toPrimitive];if(oe!==void 0){var re=oe.call(ee,K);if(s(re)!="object")return re;throw new TypeError("@@toPrimitive must return a primitive value.")}return(K==="string"?String:Number)(ee)}var M={x:"clientWidth",y:"clientHeight"},D={x:"clientTop",y:"clientLeft"},O={x:"innerWidth",y:"innerHeight"},q={x:"offsetWidth",y:"offsetHeight"},F={x:"offsetLeft",y:"offsetTop"},U={x:"overflowX",y:"overflowY"},B={x:"scrollWidth",y:"scrollHeight"},G={x:"scrollLeft",y:"scrollTop"},X={x:"width",y:"height"},Q=function(){},Y=(function(){if(typeof window>"u")return!1;var ee=!1;try{document.createElement("div").addEventListener("test",Q,{get passive(){return ee=!0,!1}})}catch{}return ee})()?{passive:!0}:!1,ne="ReactList failed to reach a stable state.",te=40,ie=function(K,oe){for(var re in oe)if(K[re]!==oe[re])return!1;return!0},$=function(K){for(var oe=K.props.axis,re=K.getEl(),me=U[oe];re=re.parentElement;)switch(window.getComputedStyle(re)[me]){case"auto":case"scroll":case"overlay":return re}return window},H=function(K){var oe=K.props.axis,re=K.scrollParent;return re===window?window[O[oe]]:re[M[oe]]},se=function(K,oe){var re=K.length,me=K.minSize,_e=K.type,le=oe.from,fe=oe.size,ue=oe.itemsPerRow;fe=Math.max(fe,me);var ce=fe%ue;return ce&&(fe+=ue-ce),fe>re&&(fe=re),le=_e==="simple"||!le?0:Math.max(Math.min(le,re-fe),0),(ce=le%ue)&&(le-=ce,fe+=ce),le===oe.from&&fe===oe.size?oe:j(j({},oe),{},{from:le,size:fe})},W=e.default=(function(ee){function K(oe){var re;return a(this,K),re=c(this,K,[oe]),re.state=se(oe,{itemsPerRow:1,from:oe.initialIndex,size:0}),re.cache={},re.cachedScrollPosition=null,re.prevPrevState={},re.unstable=!1,re.updateCounter=0,re}return v(K,ee),l(K,[{key:"componentDidMount",value:function(){this.updateFrameAndClearCache=this.updateFrameAndClearCache.bind(this),window.addEventListener("resize",this.updateFrameAndClearCache),this.updateFrame(this.scrollTo.bind(this,this.props.initialIndex))}},{key:"componentDidUpdate",value:function(re){var me=this;if(this.props.axis!==re.axis&&this.clearSizeCache(),!this.unstable){if(++this.updateCounter>te)return this.unstable=!0,console.error(ne);this.updateCounterTimeoutId||(this.updateCounterTimeoutId=setTimeout(function(){me.updateCounter=0,delete me.updateCounterTimeoutId},0)),this.updateFrame()}}},{key:"maybeSetState",value:function(re,me){if(ie(this.state,re))return me();this.setState(re,me)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateFrameAndClearCache),this.scrollParent.removeEventListener("scroll",this.updateFrameAndClearCache,Y),this.scrollParent.removeEventListener("mousewheel",Q,Y)}},{key:"getOffset",value:function(re){var me=this.props.axis,_e=re[D[me]]||0,le=F[me];do _e+=re[le]||0;while(re=re.offsetParent);return _e}},{key:"getEl",value:function(){return this.el||this.items}},{key:"getScrollPosition",value:function(){if(typeof this.cachedScrollPosition=="number")return this.cachedScrollPosition;var re=this.scrollParent,me=this.props.axis,_e=G[me],le=re===window?document.body[_e]||document.documentElement[_e]:re[_e],fe=this.getScrollSize()-this.props.scrollParentViewportSizeGetter(this),ue=Math.max(0,Math.min(le,fe)),ce=this.getEl();return this.cachedScrollPosition=this.getOffset(re)+ue-this.getOffset(ce),this.cachedScrollPosition}},{key:"setScroll",value:function(re){var me=this.scrollParent,_e=this.props.axis;if(re+=this.getOffset(this.getEl()),me===window)return window.scrollTo(0,re);re-=this.getOffset(this.scrollParent),me[G[_e]]=re}},{key:"getScrollSize",value:function(){var re=this.scrollParent,me=document,_e=me.body,le=me.documentElement,fe=B[this.props.axis];return re===window?Math.max(_e[fe],le[fe]):re[fe]}},{key:"hasDeterminateSize",value:function(){var re=this.props,me=re.itemSizeGetter,_e=re.type;return _e==="uniform"||me}},{key:"getStartAndEnd",value:function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.threshold,me=this.getScrollPosition(),_e=Math.max(0,me-re),le=me+this.props.scrollParentViewportSizeGetter(this)+re;return this.hasDeterminateSize()&&(le=Math.min(le,this.getSpaceBefore(this.props.length))),{start:_e,end:le}}},{key:"getItemSizeAndItemsPerRow",value:function(){var re=this.props,me=re.axis,_e=re.useStaticSize,le=this.state,fe=le.itemSize,ue=le.itemsPerRow;if(_e&&fe&&ue)return{itemSize:fe,itemsPerRow:ue};var ce=this.items.children;if(!ce.length)return{};var Se=ce[0],ye=Se[q[me]],Ne=Math.abs(ye-fe);if((isNaN(Ne)||Ne>=1)&&(fe=ye),!fe)return{};var ke=F[me],qe=Se[ke];ue=1;for(var ze=ce[ue];ze&&ze[ke]===qe;ze=ce[ue])++ue;return{itemSize:fe,itemsPerRow:ue}}},{key:"clearSizeCache",value:function(){this.cachedScrollPosition=null}},{key:"updateFrameAndClearCache",value:function(re){return this.clearSizeCache(),this.updateFrame(re)}},{key:"updateFrame",value:function(re){switch(this.updateScrollParent(),typeof re!="function"&&(re=Q),this.props.type){case"simple":return this.updateSimpleFrame(re);case"variable":return this.updateVariableFrame(re);case"uniform":return this.updateUniformFrame(re)}}},{key:"updateScrollParent",value:function(){var re=this.scrollParent;this.scrollParent=this.props.scrollParentGetter(this),re!==this.scrollParent&&(re&&(re.removeEventListener("scroll",this.updateFrameAndClearCache),re.removeEventListener("mousewheel",Q)),this.clearSizeCache(),this.scrollParent.addEventListener("scroll",this.updateFrameAndClearCache,Y),this.scrollParent.addEventListener("mousewheel",Q,Y))}},{key:"updateSimpleFrame",value:function(re){var me=this.getStartAndEnd(),_e=me.end,le=this.items.children,fe=0;if(le.length){var ue=this.props.axis,ce=le[0],Se=le[le.length-1];fe=this.getOffset(Se)+Se[q[ue]]-this.getOffset(ce)}if(fe>_e)return re();var ye=this.props,Ne=ye.pageSize,ke=ye.length,qe=Math.min(this.state.size+Ne,ke);this.maybeSetState({size:qe},re)}},{key:"updateVariableFrame",value:function(re){this.props.itemSizeGetter||this.cacheSizes();for(var me=this.getStartAndEnd(),_e=me.start,le=me.end,fe=this.props,ue=fe.length,ce=fe.pageSize,Se=0,ye=0,Ne=0,ke=ue-1;ye<ke;){var qe=this.getSizeOfItem(ye);if(qe==null||Se+qe>_e)break;Se+=qe,++ye}for(var ze=ue-ye;Ne<ze&&Se<le;){var He=this.getSizeOfItem(ye+Ne);if(He==null){Ne=Math.min(Ne+ce,ze);break}Se+=He,++Ne}this.maybeSetState(se(this.props,{from:ye,itemsPerRow:1,size:Ne}),re)}},{key:"updateUniformFrame",value:function(re){var me=this.getItemSizeAndItemsPerRow(),_e=me.itemSize,le=me.itemsPerRow;if(!_e||!le)return re();var fe=this.getStartAndEnd(),ue=fe.start,ce=fe.end,Se=se(this.props,{from:Math.floor(ue/_e)*le,size:(Math.ceil((ce-ue)/_e)+1)*le,itemsPerRow:le}),ye=Se.from,Ne=Se.size;return this.maybeSetState({itemsPerRow:le,from:ye,itemSize:_e,size:Ne},re)}},{key:"getSpaceBefore",value:function(re){var me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(me[re]!=null)return me[re];var _e=this.state,le=_e.itemSize,fe=_e.itemsPerRow;if(le)return me[re]=Math.floor(re/fe)*le;for(var ue=re;ue>0&&me[--ue]==null;);for(var ce=me[ue]||0,Se=ue;Se<re;++Se){me[Se]=ce;var ye=this.getSizeOfItem(Se);if(ye==null)break;ce+=ye}return me[re]=ce}},{key:"cacheSizes",value:function(){for(var re=this.cache,me=this.state.from,_e=this.items.children,le=q[this.props.axis],fe=0,ue=_e.length;fe<ue;++fe)re[me+fe]=_e[fe][le]}},{key:"getSizeOfItem",value:function(re){var me=this.cache,_e=this.items,le=this.props,fe=le.axis,ue=le.itemSizeGetter,ce=le.itemSizeEstimator,Se=le.type,ye=this.state,Ne=ye.from,ke=ye.itemSize,qe=ye.size;if(ke)return ke;if(ue)return ue(re);if(re in me)return me[re];if(Se==="simple"&&re>=Ne&&re<Ne+qe&&_e){var ze=_e.children[re-Ne];if(ze)return ze[q[fe]]}if(ce)return ce(re,me)}},{key:"scrollTo",value:function(re){re!=null&&this.setScroll(this.getSpaceBefore(re))}},{key:"scrollAround",value:function(re){var me=this.getScrollPosition(),_e=this.getSpaceBefore(re),le=_e-this.props.scrollParentViewportSizeGetter(this)+this.getSizeOfItem(re),fe=Math.min(le,_e),ue=Math.max(le,_e);if(me<=fe)return this.setScroll(fe);if(me>ue)return this.setScroll(ue)}},{key:"getVisibleRange",value:function(){for(var re=this.state,me=re.from,_e=re.size,le=this.getStartAndEnd(0),fe=le.start,ue=le.end,ce={},Se,ye,Ne=me;Ne<me+_e;++Ne){var ke=this.getSpaceBefore(Ne,ce),qe=ke+this.getSizeOfItem(Ne);Se==null&&qe>fe&&(Se=Ne),Se!=null&&ke<ue&&(ye=Ne)}return[Se,ye]}},{key:"renderItems",value:function(){for(var re=this,me=this.props,_e=me.itemRenderer,le=me.itemsRenderer,fe=this.state,ue=fe.from,ce=fe.size,Se=[],ye=0;ye<ce;++ye)Se.push(_e(ue+ye,ye));return le(Se,function(Ne){return re.items=Ne})}},{key:"render",value:function(){var re=this,me=this.props,_e=me.axis,le=me.length,fe=me.type,ue=me.useTranslate3d,ce=this.state,Se=ce.from,ye=ce.itemsPerRow,Ne=this.renderItems();if(fe==="simple")return Ne;var ke={position:"relative"},qe={},ze=Math.ceil(le/ye)*ye,He=this.getSpaceBefore(ze,qe);He&&(ke[X[_e]]=He,_e==="x"&&(ke.overflowX="hidden"));var Be=this.getSpaceBefore(Se,qe),de=_e==="x"?Be:0,xe=_e==="y"?Be:0,Pe=ue?"translate3d(".concat(de,"px, ").concat(xe,"px, 0)"):"translate(".concat(de,"px, ").concat(xe,"px)"),Ge={msTransform:Pe,WebkitTransform:Pe,transform:Pe};return(0,r.jsx)("div",{style:ke,ref:function(Le){return re.el=Le},children:(0,r.jsx)("div",{style:Ge,children:Ne})})}}],[{key:"getDerivedStateFromProps",value:function(re,me){var _e=se(re,me);return _e===me?null:_e}}])})(t.Component);P(W,"displayName","ReactList"),P(W,"defaultProps",{axis:"y",itemRenderer:function(K,oe){return(0,r.jsx)("div",{children:K},oe)},itemsRenderer:function(K,oe){return(0,r.jsx)("div",{ref:oe,children:K})},length:0,minSize:1,pageSize:10,scrollParentGetter:$,scrollParentViewportSizeGetter:H,threshold:100,type:"simple",useStaticSize:!1,useTranslate3d:!1})})})(jg)),jg}function cre(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=Object.keys(n),r=Object.keys(e),s=t.length;if(r.length!==s)return!1;for(var a=0;a<s;a++){var o=t[a];if(n[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}function dre(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=n.length;if(e.length!==t)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}const ure=Object.freeze(Object.defineProperty({__proto__:null,shallowEqualArrays:dre,shallowEqualObjects:cre},Symbol.toStringTag,{value:"Module"})),fre=PL(ure);var _h={},BA;function hy(){return BA||(BA=1,Object.defineProperty(_h,"__esModule",{value:!0}),_h.default=void 0,_h.default={dateRangeWrapper:"rdrDateRangeWrapper",calendarWrapper:"rdrCalendarWrapper",dateDisplay:"rdrDateDisplay",dateDisplayItem:"rdrDateDisplayItem",dateDisplayItemActive:"rdrDateDisplayItemActive",monthAndYearWrapper:"rdrMonthAndYearWrapper",monthAndYearPickers:"rdrMonthAndYearPickers",nextPrevButton:"rdrNextPrevButton",month:"rdrMonth",weekDays:"rdrWeekDays",weekDay:"rdrWeekDay",days:"rdrDays",day:"rdrDay",dayNumber:"rdrDayNumber",dayPassive:"rdrDayPassive",dayToday:"rdrDayToday",dayStartOfWeek:"rdrDayStartOfWeek",dayEndOfWeek:"rdrDayEndOfWeek",daySelected:"rdrDaySelected",dayDisabled:"rdrDayDisabled",dayStartOfMonth:"rdrDayStartOfMonth",dayEndOfMonth:"rdrDayEndOfMonth",dayWeekend:"rdrDayWeekend",dayStartPreview:"rdrDayStartPreview",dayInPreview:"rdrDayInPreview",dayEndPreview:"rdrDayEndPreview",dayHovered:"rdrDayHovered",dayActive:"rdrDayActive",inRange:"rdrInRange",endEdge:"rdrEndEdge",startEdge:"rdrStartEdge",prevButton:"rdrPprevButton",nextButton:"rdrNextButton",selected:"rdrSelected",months:"rdrMonths",monthPicker:"rdrMonthPicker",yearPicker:"rdrYearPicker",dateDisplayWrapper:"rdrDateDisplayWrapper",definedRangesWrapper:"rdrDefinedRangesWrapper",staticRanges:"rdrStaticRanges",staticRange:"rdrStaticRange",inputRanges:"rdrInputRanges",inputRange:"rdrInputRange",inputRangeInput:"rdrInputRangeInput",dateRangePickerWrapper:"rdrDateRangePickerWrapper",staticRangeLabel:"rdrStaticRangeLabel",staticRangeSelected:"rdrStaticRangeSelected",monthName:"rdrMonthName",infiniteMonths:"rdrInfiniteMonths",monthsVertical:"rdrMonthsVertical",monthsHorizontal:"rdrMonthsHorizontal"}),_h}var wh={},WA;function hre(){if(WA)return wh;WA=1,Object.defineProperty(wh,"__esModule",{value:!0}),wh.ariaLabelsShape=void 0;var n=e(Nl());function e(t){return t&&t.__esModule?t:{default:t}}return wh.ariaLabelsShape=n.default.shape({dateInput:n.default.objectOf(n.default.shape({startDate:n.default.string,endDate:n.default.string})),monthPicker:n.default.string,yearPicker:n.default.string,prevButton:n.default.string,nextButton:n.default.string}),wh}var $A;function C5(){if($A)return xh;$A=1,Object.defineProperty(xh,"__esModule",{value:!0}),xh.default=void 0;var n=w(Ws()),e=v(Nl()),t=uy(),r=v(are()),s=v(ore()),a=fy(),o=v(vu()),l=v(lre()),c=fre,d=_u(),m=Z3(),p=v(hy()),x=hre();function v(D){return D&&D.__esModule?D:{default:D}}function _(D){if(typeof WeakMap!="function")return null;var O=new WeakMap,q=new WeakMap;return(_=function(F){return F?q:O})(D)}function w(D,O){if(D&&D.__esModule)return D;if(D===null||typeof D!="object"&&typeof D!="function")return{default:D};var q=_(O);if(q&&q.has(D))return q.get(D);var F={__proto__:null},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in D)if(B!=="default"&&Object.prototype.hasOwnProperty.call(D,B)){var G=U?Object.getOwnPropertyDescriptor(D,B):null;G&&(G.get||G.set)?Object.defineProperty(F,B,G):F[B]=D[B]}return F.default=D,q&&q.set(D,F),F}function j(){return j=Object.assign?Object.assign.bind():function(D){for(var O=1;O<arguments.length;O++){var q=arguments[O];for(var F in q)Object.prototype.hasOwnProperty.call(q,F)&&(D[F]=q[F])}return D},j.apply(this,arguments)}function P(D,O,q){return O=k(O),O in D?Object.defineProperty(D,O,{value:q,enumerable:!0,configurable:!0,writable:!0}):D[O]=q,D}function k(D){var O=I(D,"string");return typeof O=="symbol"?O:String(O)}function I(D,O){if(typeof D!="object"||!D)return D;var q=D[Symbol.toPrimitive];if(q!==void 0){var F=q.call(D,O);if(typeof F!="object")return F;throw new TypeError("@@toPrimitive must return a primitive value.")}return(O==="string"?String:Number)(D)}let M=class PN extends n.PureComponent{constructor(O,q){var F;super(O,q),F=this,P(this,"focusToDate",function(U){let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:F.props,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!B.scroll.enabled){if(G&&B.preventSnapRefocus){const Y=(0,d.differenceInCalendarMonths)(U,F.state.focusedDate),ne=B.calendarFocus==="forwards"&&Y>=0,te=B.calendarFocus==="backwards"&&Y<=0;if((ne||te)&&Math.abs(Y)<B.months)return}F.setState({focusedDate:U});return}const X=(0,d.differenceInCalendarMonths)(U,B.minDate,F.dateOptions),Q=F.list.getVisibleRange();G&&Q.includes(X)||(F.isFirstRender=!0,F.list.scrollTo(X),F.setState({focusedDate:U}))}),P(this,"updateShownDate",function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:F.props;const B=U.scroll.enabled?{...U,months:F.list.getVisibleRange().length}:U,G=(0,a.calcFocusDate)(F.state.focusedDate,B);F.focusToDate(G,B)}),P(this,"updatePreview",U=>{if(!U){this.setState({preview:null});return}const B={startDate:U,endDate:U,color:this.props.color};this.setState({preview:B})}),P(this,"changeShownDate",function(U){let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"set";const{focusedDate:G}=F.state,{onShownDateChange:X,minDate:Q,maxDate:Y}=F.props,ne={monthOffset:()=>(0,d.addMonths)(G,U),setMonth:()=>(0,d.setMonth)(G,U),setYear:()=>(0,d.setYear)(G,U),set:()=>U},te=(0,d.min)([(0,d.max)([ne[B](),Q]),Y]);F.focusToDate(te,F.props,!1),X&&X(te)}),P(this,"handleRangeFocusChange",(U,B)=>{this.props.onRangeFocusChange&&this.props.onRangeFocusChange([U,B])}),P(this,"handleScroll",()=>{const{onShownDateChange:U,minDate:B}=this.props,{focusedDate:G}=this.state,{isFirstRender:X}=this,Q=this.list.getVisibleRange();if(Q[0]===void 0)return;const Y=(0,d.addMonths)(B,Q[0]||0);!(0,d.isSameMonth)(Y,G)&&!X&&(this.setState({focusedDate:Y}),U&&U(Y)),this.isFirstRender=!1}),P(this,"renderMonthAndYear",(U,B,G)=>{const{showMonthArrow:X,minDate:Q,maxDate:Y,showMonthAndYearPickers:ne,ariaLabels:te}=G,ie=(Y||PN.defaultProps.maxDate).getFullYear(),$=(Q||PN.defaultProps.minDate).getFullYear(),H=this.styles;return n.default.createElement("div",{onMouseUp:se=>se.stopPropagation(),className:H.monthAndYearWrapper},X?n.default.createElement("button",{type:"button",className:(0,o.default)(H.nextPrevButton,H.prevButton),onClick:()=>B(-1,"monthOffset"),"aria-label":te.prevButton},n.default.createElement("i",null)):null,ne?n.default.createElement("span",{className:H.monthAndYearPickers},n.default.createElement("span",{className:H.monthPicker},n.default.createElement("select",{value:U.getMonth(),onChange:se=>B(se.target.value,"setMonth"),"aria-label":te.monthPicker},this.state.monthNames.map((se,W)=>n.default.createElement("option",{key:W,value:W},se)))),n.default.createElement("span",{className:H.monthAndYearDivider}),n.default.createElement("span",{className:H.yearPicker},n.default.createElement("select",{value:U.getFullYear(),onChange:se=>B(se.target.value,"setYear"),"aria-label":te.yearPicker},new Array(ie-$+1).fill(ie).map((se,W)=>{const ee=se-W;return n.default.createElement("option",{key:ee,value:ee},ee)})))):n.default.createElement("span",{className:H.monthAndYearPickers},this.state.monthNames[U.getMonth()]," ",U.getFullYear()),X?n.default.createElement("button",{type:"button",className:(0,o.default)(H.nextPrevButton,H.nextButton),onClick:()=>B(1,"monthOffset"),"aria-label":te.nextButton},n.default.createElement("i",null)):null)}),P(this,"renderDateDisplay",()=>{const{focusedRange:U,color:B,ranges:G,rangeColors:X,dateDisplayFormat:Q,editableDateInputs:Y,startDatePlaceholder:ne,endDatePlaceholder:te,ariaLabels:ie}=this.props,$=X[U[0]]||B,H=this.styles;return n.default.createElement("div",{className:H.dateDisplayWrapper},G.map((se,W)=>se.showDateDisplay===!1||se.disabled&&!se.showDateDisplay?null:n.default.createElement("div",{className:H.dateDisplay,key:W,style:{color:se.color||$}},n.default.createElement(s.default,{className:(0,o.default)(H.dateDisplayItem,{[H.dateDisplayItemActive]:U[0]===W&&U[1]===0}),readOnly:!Y,disabled:se.disabled,value:se.startDate,placeholder:ne,dateOptions:this.dateOptions,dateDisplayFormat:Q,ariaLabel:ie.dateInput&&ie.dateInput[se.key]&&ie.dateInput[se.key].startDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(W,0)}),n.default.createElement(s.default,{className:(0,o.default)(H.dateDisplayItem,{[H.dateDisplayItemActive]:U[0]===W&&U[1]===1}),readOnly:!Y,disabled:se.disabled,value:se.endDate,placeholder:te,dateOptions:this.dateOptions,dateDisplayFormat:Q,ariaLabel:ie.dateInput&&ie.dateInput[se.key]&&ie.dateInput[se.key].endDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(W,1)}))))}),P(this,"onDragSelectionStart",U=>{const{onChange:B,dragSelectionEnabled:G}=this.props;G?this.setState({drag:{status:!0,range:{startDate:U,endDate:U},disablePreview:!0}}):B&&B(U)}),P(this,"onDragSelectionEnd",U=>{const{updateRange:B,displayMode:G,onChange:X,dragSelectionEnabled:Q}=this.props;if(!Q)return;if(G==="date"||!this.state.drag.status){X&&X(U);return}const Y={startDate:this.state.drag.range.startDate,endDate:U};G!=="dateRange"||(0,d.isSameDay)(Y.startDate,U)?this.setState({drag:{status:!1,range:{}}},()=>X&&X(U)):this.setState({drag:{status:!1,range:{}}},()=>{B&&B(Y)})}),P(this,"onDragSelectionMove",U=>{const{drag:B}=this.state;!B.status||!this.props.dragSelectionEnabled||this.setState({drag:{status:B.status,range:{startDate:B.range.startDate,endDate:U},disablePreview:!0}})}),P(this,"estimateMonthSize",(U,B)=>{const{direction:G,minDate:X}=this.props,{scrollArea:Q}=this.state;if(B&&(this.listSizeCache=B,B[U]))return B[U];if(G==="horizontal")return Q.monthWidth;const Y=(0,d.addMonths)(X,U),{start:ne,end:te}=(0,a.getMonthDisplayRange)(Y,this.dateOptions);return(0,d.differenceInDays)(te,ne,this.dateOptions)+1>35?Q.longMonthHeight:Q.monthHeight}),this.dateOptions={locale:O.locale},O.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=O.weekStartsOn),this.styles=(0,a.generateStyles)([p.default,O.classNames]),this.listSizeCache={},this.isFirstRender=!0,this.state={monthNames:this.getMonthNames(),focusedDate:(0,a.calcFocusDate)(null,O),drag:{status:!1,range:{startDate:null,endDate:null},disablePreview:!1},scrollArea:this.calcScrollArea(O)}}getMonthNames(){return[...Array(12).keys()].map(O=>this.props.locale.localize.month(O))}calcScrollArea(O){const{direction:q,months:F,scroll:U}=O;if(!U.enabled)return{enabled:!1};const B=U.longMonthHeight||U.monthHeight;return q==="vertical"?{enabled:!0,monthHeight:U.monthHeight||220,longMonthHeight:B||260,calendarWidth:"auto",calendarHeight:(U.calendarHeight||B||240)*F}:{enabled:!0,monthWidth:U.monthWidth||332,calendarWidth:(U.calendarWidth||U.monthWidth||332)*F,monthHeight:B||300,calendarHeight:B||300}}componentDidMount(){this.props.scroll.enabled&&setTimeout(()=>this.focusToDate(this.state.focusedDate))}componentDidUpdate(O){const F={dateRange:"ranges",date:"date"}[this.props.displayMode];this.props[F]!==O[F]&&this.updateShownDate(this.props),(O.locale!==this.props.locale||O.weekStartsOn!==this.props.weekStartsOn)&&(this.dateOptions={locale:this.props.locale},this.props.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=this.props.weekStartsOn),this.setState({monthNames:this.getMonthNames()})),(0,c.shallowEqualObjects)(O.scroll,this.props.scroll)||this.setState({scrollArea:this.calcScrollArea(this.props)})}renderWeekdays(){const O=new Date;return n.default.createElement("div",{className:this.styles.weekDays},(0,d.eachDayOfInterval)({start:(0,d.startOfWeek)(O,this.dateOptions),end:(0,d.endOfWeek)(O,this.dateOptions)}).map((q,F)=>n.default.createElement("span",{className:this.styles.weekDay,key:F},(0,d.format)(q,this.props.weekdayDisplayFormat,this.dateOptions))))}render(){const{showDateDisplay:O,onPreviewChange:q,scroll:F,direction:U,disabledDates:B,disabledDay:G,maxDate:X,minDate:Q,rangeColors:Y,color:ne,navigatorRenderer:te,className:ie,preview:$}=this.props,{scrollArea:H,focusedDate:se}=this.state,W=U==="vertical",ee=te||this.renderMonthAndYear,K=this.props.ranges.map((oe,re)=>({...oe,color:oe.color||Y[re]||ne}));return n.default.createElement("div",{className:(0,o.default)(this.styles.calendarWrapper,ie),onMouseUp:()=>this.setState({drag:{status:!1,range:{}}}),onMouseLeave:()=>{this.setState({drag:{status:!1,range:{}}})}},O&&this.renderDateDisplay(),ee(se,this.changeShownDate,this.props),F.enabled?n.default.createElement("div",null,W&&this.renderWeekdays(this.dateOptions),n.default.createElement("div",{className:(0,o.default)(this.styles.infiniteMonths,W?this.styles.monthsVertical:this.styles.monthsHorizontal),onMouseLeave:()=>q&&q(),style:{width:H.calendarWidth+11,height:H.calendarHeight+11},onScroll:this.handleScroll},n.default.createElement(l.default,{length:(0,d.differenceInCalendarMonths)((0,d.endOfMonth)(X),(0,d.addDays)((0,d.startOfMonth)(Q),-1),this.dateOptions),treshold:500,type:"variable",ref:oe=>this.list=oe,itemSizeEstimator:this.estimateMonthSize,axis:W?"y":"x",itemRenderer:(oe,re)=>{const me=(0,d.addMonths)(Q,oe);return n.default.createElement(r.default,j({},this.props,{onPreviewChange:q||this.updatePreview,preview:$||this.state.preview,ranges:K,key:re,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:B,disabledDay:G,month:me,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>q&&q(),styles:this.styles,style:W?{height:this.estimateMonthSize(oe)}:{height:H.monthHeight,width:this.estimateMonthSize(oe)},showMonthName:!0,showWeekDays:!W}))}}))):n.default.createElement("div",{className:(0,o.default)(this.styles.months,W?this.styles.monthsVertical:this.styles.monthsHorizontal)},new Array(this.props.months).fill(null).map((oe,re)=>{let me=(0,d.addMonths)(this.state.focusedDate,re);return this.props.calendarFocus==="backwards"&&(me=(0,d.subMonths)(this.state.focusedDate,this.props.months-1-re)),n.default.createElement(r.default,j({},this.props,{onPreviewChange:q||this.updatePreview,preview:$||this.state.preview,ranges:K,key:re,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:B,disabledDay:G,month:me,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>q&&q(),styles:this.styles,showWeekDays:!W||re===0,showMonthName:!W||re>0}))})))}};return M.defaultProps={showMonthArrow:!0,showMonthAndYearPickers:!0,disabledDates:[],disabledDay:()=>{},classNames:{},locale:m.enUS,ranges:[],focusedRange:[0,0],dateDisplayFormat:"MMM d, yyyy",monthDisplayFormat:"MMM yyyy",weekdayDisplayFormat:"E",dayDisplayFormat:"d",showDateDisplay:!0,showPreview:!0,displayMode:"date",months:1,color:"#3d91ff",scroll:{enabled:!1},direction:"vertical",maxDate:(0,d.addYears)(new Date,20),minDate:(0,d.addYears)(new Date,-100),rangeColors:["#3d91ff","#3ecf8e","#fed14c"],startDatePlaceholder:"Early",endDatePlaceholder:"Continuous",editableDateInputs:!1,dragSelectionEnabled:!0,fixedHeight:!1,calendarFocus:"forwards",preventSnapRefocus:!1,ariaLabels:{}},M.propTypes={showMonthArrow:e.default.bool,showMonthAndYearPickers:e.default.bool,disabledDates:e.default.array,disabledDay:e.default.func,minDate:e.default.object,maxDate:e.default.object,date:e.default.object,onChange:e.default.func,onPreviewChange:e.default.func,onRangeFocusChange:e.default.func,classNames:e.default.object,locale:e.default.object,shownDate:e.default.object,onShownDateChange:e.default.func,ranges:e.default.arrayOf(t.rangeShape),preview:e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string}),dateDisplayFormat:e.default.string,monthDisplayFormat:e.default.string,weekdayDisplayFormat:e.default.string,weekStartsOn:e.default.number,dayDisplayFormat:e.default.string,focusedRange:e.default.arrayOf(e.default.number),initialFocusedRange:e.default.arrayOf(e.default.number),months:e.default.number,className:e.default.string,showDateDisplay:e.default.bool,showPreview:e.default.bool,displayMode:e.default.oneOf(["dateRange","date"]),color:e.default.string,updateRange:e.default.func,scroll:e.default.shape({enabled:e.default.bool,monthHeight:e.default.number,longMonthHeight:e.default.number,monthWidth:e.default.number,calendarWidth:e.default.number,calendarHeight:e.default.number}),direction:e.default.oneOf(["vertical","horizontal"]),startDatePlaceholder:e.default.string,endDatePlaceholder:e.default.string,navigatorRenderer:e.default.func,rangeColors:e.default.arrayOf(e.default.string),editableDateInputs:e.default.bool,dragSelectionEnabled:e.default.bool,fixedHeight:e.default.bool,calendarFocus:e.default.string,preventSnapRefocus:e.default.bool,ariaLabels:x.ariaLabelsShape},xh.default=M,xh}var HA;function T5(){if(HA)return gh;HA=1,Object.defineProperty(gh,"__esModule",{value:!0}),gh.default=void 0;var n=m(Ws()),e=c(Nl()),t=c(C5()),r=uy(),s=fy(),a=_u(),o=c(vu()),l=c(hy());function c(j){return j&&j.__esModule?j:{default:j}}function d(j){if(typeof WeakMap!="function")return null;var P=new WeakMap,k=new WeakMap;return(d=function(I){return I?k:P})(j)}function m(j,P){if(j&&j.__esModule)return j;if(j===null||typeof j!="object"&&typeof j!="function")return{default:j};var k=d(P);if(k&&k.has(j))return k.get(j);var I={__proto__:null},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in j)if(D!=="default"&&Object.prototype.hasOwnProperty.call(j,D)){var O=M?Object.getOwnPropertyDescriptor(j,D):null;O&&(O.get||O.set)?Object.defineProperty(I,D,O):I[D]=j[D]}return I.default=j,k&&k.set(j,I),I}function p(){return p=Object.assign?Object.assign.bind():function(j){for(var P=1;P<arguments.length;P++){var k=arguments[P];for(var I in k)Object.prototype.hasOwnProperty.call(k,I)&&(j[I]=k[I])}return j},p.apply(this,arguments)}function x(j,P,k){return P=v(P),P in j?Object.defineProperty(j,P,{value:k,enumerable:!0,configurable:!0,writable:!0}):j[P]=k,j}function v(j){var P=_(j,"string");return typeof P=="symbol"?P:String(P)}function _(j,P){if(typeof j!="object"||!j)return j;var k=j[Symbol.toPrimitive];if(k!==void 0){var I=k.call(j,P);if(typeof I!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(P==="string"?String:Number)(j)}let w=class extends n.Component{constructor(P,k){var I;super(P,k),I=this,x(this,"calcNewSelection",function(M){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const O=I.props.focusedRange||I.state.focusedRange,{ranges:q,onChange:F,maxDate:U,moveRangeOnFirstSelection:B,retainEndDateOnFirstSelection:G,disabledDates:X}=I.props,Q=O[0],Y=q[Q];if(!Y||!F)return{};let{startDate:ne,endDate:te}=Y;const ie=new Date;let $;if(!D)ne=M.startDate,te=M.endDate;else if(O[1]===0){const W=(0,a.differenceInCalendarDays)(te||ie,ne),ee=()=>B?(0,a.addDays)(M,W):G?!te||(0,a.isBefore)(M,te)?te:M:M||ie;ne=M,te=ee(),U&&(te=(0,a.min)([te,U])),$=[O[0],1]}else te=M;let H=O[1]===0;(0,a.isBefore)(te,ne)&&(H=!H,[ne,te]=[te,ne]);const se=X.filter(W=>(0,a.isWithinInterval)(W,{start:ne,end:te}));return se.length>0&&(H?ne=(0,a.addDays)((0,a.max)(se),1):te=(0,a.addDays)((0,a.min)(se),-1)),$||($=[(0,s.findNextRangeIndex)(I.props.ranges,O[0]),0]),{wasValid:!(se.length>0),range:{startDate:ne,endDate:te},nextFocusRange:$}}),x(this,"setSelection",(M,D)=>{const{onChange:O,ranges:q,onRangeFocusChange:F}=this.props,B=(this.props.focusedRange||this.state.focusedRange)[0],G=q[B];if(!G)return;const X=this.calcNewSelection(M,D);O({[G.key||`range${B+1}`]:{...G,...X.range}}),this.setState({focusedRange:X.nextFocusRange,preview:null}),F&&F(X.nextFocusRange)}),x(this,"handleRangeFocusChange",M=>{this.setState({focusedRange:M}),this.props.onRangeFocusChange&&this.props.onRangeFocusChange(M)}),x(this,"updatePreview",M=>{if(!M){this.setState({preview:null});return}const{rangeColors:D,ranges:O}=this.props,q=this.props.focusedRange||this.state.focusedRange,F=O[q[0]]?.color||D[q[0]]||F;this.setState({preview:{...M.range,color:F}})}),this.state={focusedRange:P.initialFocusedRange||[(0,s.findNextRangeIndex)(P.ranges),0],preview:null},this.styles=(0,s.generateStyles)([l.default,P.classNames])}render(){return n.default.createElement(t.default,p({focusedRange:this.state.focusedRange,onRangeFocusChange:this.handleRangeFocusChange,preview:this.state.preview,onPreviewChange:P=>{this.updatePreview(P?this.calcNewSelection(P):null)}},this.props,{displayMode:"dateRange",className:(0,o.default)(this.styles.dateRangeWrapper,this.props.className),onChange:this.setSelection,updateRange:P=>this.setSelection(P,!1),ref:P=>{this.calendar=P}}))}};return w.defaultProps={classNames:{},ranges:[],moveRangeOnFirstSelection:!1,retainEndDateOnFirstSelection:!1,rangeColors:["#3d91ff","#3ecf8e","#fed14c"],disabledDates:[]},w.propTypes={...t.default.propTypes,onChange:e.default.func,onRangeFocusChange:e.default.func,className:e.default.string,ranges:e.default.arrayOf(r.rangeShape),moveRangeOnFirstSelection:e.default.bool,retainEndDateOnFirstSelection:e.default.bool},gh.default=w,gh}var Sh={},jh={},Sc={},YA;function P5(){if(YA)return Sc;YA=1,Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.createStaticRanges=r,Sc.defaultStaticRanges=Sc.defaultInputRanges=void 0;var n=_u();const e={startOfWeek:(0,n.startOfWeek)(new Date),endOfWeek:(0,n.endOfWeek)(new Date),startOfLastWeek:(0,n.startOfWeek)((0,n.addDays)(new Date,-7)),endOfLastWeek:(0,n.endOfWeek)((0,n.addDays)(new Date,-7)),startOfToday:(0,n.startOfDay)(new Date),endOfToday:(0,n.endOfDay)(new Date),startOfYesterday:(0,n.startOfDay)((0,n.addDays)(new Date,-1)),endOfYesterday:(0,n.endOfDay)((0,n.addDays)(new Date,-1)),startOfMonth:(0,n.startOfMonth)(new Date),endOfMonth:(0,n.endOfMonth)(new Date),startOfLastMonth:(0,n.startOfMonth)((0,n.addMonths)(new Date,-1)),endOfLastMonth:(0,n.endOfMonth)((0,n.addMonths)(new Date,-1))},t={range:{},isSelected(s){const a=this.range();return(0,n.isSameDay)(s.startDate,a.startDate)&&(0,n.isSameDay)(s.endDate,a.endDate)}};function r(s){return s.map(a=>({...t,...a}))}return Sc.defaultStaticRanges=r([{label:"Today",range:()=>({startDate:e.startOfToday,endDate:e.endOfToday})},{label:"Yesterday",range:()=>({startDate:e.startOfYesterday,endDate:e.endOfYesterday})},{label:"This Week",range:()=>({startDate:e.startOfWeek,endDate:e.endOfWeek})},{label:"Last Week",range:()=>({startDate:e.startOfLastWeek,endDate:e.endOfLastWeek})},{label:"This Month",range:()=>({startDate:e.startOfMonth,endDate:e.endOfMonth})},{label:"Last Month",range:()=>({startDate:e.startOfLastMonth,endDate:e.endOfLastMonth})}]),Sc.defaultInputRanges=[{label:"days up to today",range(s){return{startDate:(0,n.addDays)(e.startOfToday,(Math.max(Number(s),1)-1)*-1),endDate:e.endOfToday}},getCurrentValue(s){return(0,n.isSameDay)(s.endDate,e.endOfToday)?s.startDate?(0,n.differenceInCalendarDays)(e.endOfToday,s.startDate)+1:"":"-"}},{label:"days starting today",range(s){const a=new Date;return{startDate:a,endDate:(0,n.addDays)(a,Math.max(Number(s),1)-1)}},getCurrentValue(s){return(0,n.isSameDay)(s.startDate,e.startOfToday)?s.endDate?(0,n.differenceInCalendarDays)(s.endDate,e.startOfToday)+1:"":"-"}}],Sc}var Nh={},GA;function mre(){if(GA)return Nh;GA=1,Object.defineProperty(Nh,"__esModule",{value:!0}),Nh.default=void 0;var n=s(Ws()),e=t(Nl());function t(p){return p&&p.__esModule?p:{default:p}}function r(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,v=new WeakMap;return(r=function(_){return _?v:x})(p)}function s(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var v=r(x);if(v&&v.has(p))return v.get(p);var _={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var P=w?Object.getOwnPropertyDescriptor(p,j):null;P&&(P.get||P.set)?Object.defineProperty(_,j,P):_[j]=p[j]}return _.default=p,v&&v.set(p,_),_}function a(p,x,v){return x=o(x),x in p?Object.defineProperty(p,x,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[x]=v,p}function o(p){var x=l(p,"string");return typeof x=="symbol"?x:String(x)}function l(p,x){if(typeof p!="object"||!p)return p;var v=p[Symbol.toPrimitive];if(v!==void 0){var _=v.call(p,x);if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(p)}const c=0,d=99999;let m=class extends n.Component{constructor(x,v){super(x,v),a(this,"onChange",_=>{const{onChange:w}=this.props;let j=parseInt(_.target.value,10);j=isNaN(j)?0:Math.max(Math.min(d,j),c),w(j)})}shouldComponentUpdate(x){const{value:v,label:_,placeholder:w}=this.props;return v!==x.value||_!==x.label||w!==x.placeholder}render(){const{label:x,placeholder:v,value:_,styles:w,onBlur:j,onFocus:P}=this.props;return n.default.createElement("div",{className:w.inputRange},n.default.createElement("input",{className:w.inputRangeInput,placeholder:v,value:_,min:c,max:d,onChange:this.onChange,onFocus:P,onBlur:j}),n.default.createElement("span",{className:w.inputRangeLabel},x))}};return m.propTypes={value:e.default.oneOfType([e.default.string,e.default.number]),label:e.default.oneOfType([e.default.element,e.default.node]).isRequired,placeholder:e.default.string,styles:e.default.shape({inputRange:e.default.string,inputRangeInput:e.default.string,inputRangeLabel:e.default.string}).isRequired,onBlur:e.default.func.isRequired,onFocus:e.default.func.isRequired,onChange:e.default.func.isRequired},m.defaultProps={value:"",placeholder:"-"},Nh.default=m,Nh}var ZA;function M5(){if(ZA)return jh;ZA=1,Object.defineProperty(jh,"__esModule",{value:!0}),jh.default=void 0;var n=d(Ws()),e=l(Nl()),t=l(hy()),r=P5(),s=uy(),a=l(mre()),o=l(vu());function l(_){return _&&_.__esModule?_:{default:_}}function c(_){if(typeof WeakMap!="function")return null;var w=new WeakMap,j=new WeakMap;return(c=function(P){return P?j:w})(_)}function d(_,w){if(_&&_.__esModule)return _;if(_===null||typeof _!="object"&&typeof _!="function")return{default:_};var j=c(w);if(j&&j.has(_))return j.get(_);var P={__proto__:null},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var I in _)if(I!=="default"&&Object.prototype.hasOwnProperty.call(_,I)){var M=k?Object.getOwnPropertyDescriptor(_,I):null;M&&(M.get||M.set)?Object.defineProperty(P,I,M):P[I]=_[I]}return P.default=_,j&&j.set(_,P),P}function m(_,w,j){return w=p(w),w in _?Object.defineProperty(_,w,{value:j,enumerable:!0,configurable:!0,writable:!0}):_[w]=j,_}function p(_){var w=x(_,"string");return typeof w=="symbol"?w:String(w)}function x(_,w){if(typeof _!="object"||!_)return _;var j=_[Symbol.toPrimitive];if(j!==void 0){var P=j.call(_,w);if(typeof P!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(w==="string"?String:Number)(_)}let v=class extends n.Component{constructor(w){super(w),m(this,"handleRangeChange",j=>{const{onChange:P,ranges:k,focusedRange:I}=this.props,M=k[I[0]];!P||!M||P({[M.key||`range${I[0]+1}`]:{...M,...j}})}),this.state={rangeOffset:0,focusedInput:-1}}getRangeOptionValue(w){const{ranges:j=[],focusedRange:P=[]}=this.props;if(typeof w.getCurrentValue!="function")return"";const k=j[P[0]]||{};return w.getCurrentValue(k)||""}getSelectedRange(w,j){const P=w.findIndex(I=>!I.startDate||!I.endDate||I.disabled?!1:j.isSelected(I));return{selectedRange:w[P],focusedRangeIndex:P}}render(){const{headerContent:w,footerContent:j,onPreviewChange:P,inputRanges:k,staticRanges:I,ranges:M,renderStaticRangeLabel:D,rangeColors:O,className:q}=this.props;return n.default.createElement("div",{className:(0,o.default)(t.default.definedRangesWrapper,q)},w,n.default.createElement("div",{className:t.default.staticRanges},I.map((F,U)=>{const{selectedRange:B,focusedRangeIndex:G}=this.getSelectedRange(M,F);let X;return F.hasCustomRendering?X=D(F):X=F.label,n.default.createElement("button",{type:"button",className:(0,o.default)(t.default.staticRange,{[t.default.staticRangeSelected]:!!B}),style:{color:B?B.color||O[G]:null},key:U,onClick:()=>this.handleRangeChange(F.range(this.props)),onFocus:()=>P&&P(F.range(this.props)),onMouseOver:()=>P&&P(F.range(this.props)),onMouseLeave:()=>{P&&P()}},n.default.createElement("span",{tabIndex:-1,className:t.default.staticRangeLabel},X))})),n.default.createElement("div",{className:t.default.inputRanges},k.map((F,U)=>n.default.createElement(a.default,{key:U,styles:t.default,label:F.label,onFocus:()=>this.setState({focusedInput:U,rangeOffset:0}),onBlur:()=>this.setState({rangeOffset:0}),onChange:B=>this.handleRangeChange(F.range(B,this.props)),value:this.getRangeOptionValue(F)}))),j)}};return v.propTypes={inputRanges:e.default.array,staticRanges:e.default.array,ranges:e.default.arrayOf(s.rangeShape),focusedRange:e.default.arrayOf(e.default.number),onPreviewChange:e.default.func,onChange:e.default.func,footerContent:e.default.any,headerContent:e.default.any,rangeColors:e.default.arrayOf(e.default.string),className:e.default.string,renderStaticRangeLabel:e.default.func},v.defaultProps={inputRanges:r.defaultInputRanges,staticRanges:r.defaultStaticRanges,ranges:[],rangeColors:["#3d91ff","#3ecf8e","#fed14c"],focusedRange:[0,0]},jh.default=v,jh}var KA;function pre(){if(KA)return Sh;KA=1,Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.default=void 0;var n=d(Ws()),e=l(Nl()),t=l(T5()),r=l(M5()),s=fy(),a=l(vu()),o=l(hy());function l(x){return x&&x.__esModule?x:{default:x}}function c(x){if(typeof WeakMap!="function")return null;var v=new WeakMap,_=new WeakMap;return(c=function(w){return w?_:v})(x)}function d(x,v){if(x&&x.__esModule)return x;if(x===null||typeof x!="object"&&typeof x!="function")return{default:x};var _=c(v);if(_&&_.has(x))return _.get(x);var w={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in x)if(P!=="default"&&Object.prototype.hasOwnProperty.call(x,P)){var k=j?Object.getOwnPropertyDescriptor(x,P):null;k&&(k.get||k.set)?Object.defineProperty(w,P,k):w[P]=x[P]}return w.default=x,_&&_.set(x,w),w}function m(){return m=Object.assign?Object.assign.bind():function(x){for(var v=1;v<arguments.length;v++){var _=arguments[v];for(var w in _)Object.prototype.hasOwnProperty.call(_,w)&&(x[w]=_[w])}return x},m.apply(this,arguments)}let p=class extends n.Component{constructor(v){super(v),this.state={focusedRange:[(0,s.findNextRangeIndex)(v.ranges),0]},this.styles=(0,s.generateStyles)([o.default,v.classNames])}render(){const{focusedRange:v}=this.state;return n.default.createElement("div",{className:(0,a.default)(this.styles.dateRangePickerWrapper,this.props.className)},n.default.createElement(r.default,m({focusedRange:v,onPreviewChange:_=>this.dateRange.updatePreview(_?this.dateRange.calcNewSelection(_,typeof _=="string"):null)},this.props,{range:this.props.ranges[v[0]],className:void 0})),n.default.createElement(t.default,m({onRangeFocusChange:_=>this.setState({focusedRange:_}),focusedRange:v},this.props,{ref:_=>this.dateRange=_,className:void 0})))}};return p.defaultProps={},p.propTypes={...t.default.propTypes,...r.default.propTypes,className:e.default.string},Sh.default=p,Sh}var JA;function gre(){return JA||(JA=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Calendar",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"DateRange",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"DateRangePicker",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"DefinedRange",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"createStaticRanges",{enumerable:!0,get:function(){return a.createStaticRanges}}),Object.defineProperty(n,"defaultInputRanges",{enumerable:!0,get:function(){return a.defaultInputRanges}}),Object.defineProperty(n,"defaultStaticRanges",{enumerable:!0,get:function(){return a.defaultStaticRanges}});var e=o(T5()),t=o(C5()),r=o(pre()),s=o(M5()),a=P5();function o(l){return l&&l.__esModule?l:{default:l}}})(x0)),x0}var lm=gre();const Nn=({label:n,id:e,error:t,value:r,onChange:s,maxDate:a,minDate:o,...l})=>{const[c,d]=E.useState(!1),[m,p]=E.useState(!1),x=E.useRef(null),{theme:v}=gu(),_=v==="dark";E.useEffect(()=>{p(document.body.classList.contains("field-officer-dark-theme"))},[]);const w=O=>{s&&s(Ue(O,"yyyy-MM-dd")),d(!1)};E.useEffect(()=>{const O=q=>{x.current&&!x.current.contains(q.target)&&d(!1)};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[]);const{className:j,...P}=l,M=`${m?"fo-input":"form-input"} ${t?m?"fo-input--error":"form-input--error":""} flex justify-between items-center cursor-pointer ${j||""}`,D=r?new Date(r+"T12:00:00"):new Date;return i.jsxs("div",{ref:x,children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsxs("div",{className:n?"mt-1 relative":"relative",children:[i.jsxs("div",{id:e,className:M,onClick:()=>d(!c),role:"button","aria-haspopup":"dialog","aria-expanded":c,"aria-label":`Date picker for ${n}`,children:[i.jsx("span",{className:r?"":"text-muted",children:r?Ue(D,"dd MMM, yyyy"):"Select date"}),i.jsx(Sa,{className:"h-4 w-4 text-muted"})]}),c&&i.jsx("div",{className:`absolute z-50 mt-1 rounded-lg shadow-lg overflow-hidden ${_?"dark-calendar bg-[#0d2818] border border-[#1f3d2b]":"bg-white border border-gray-200"}`,children:i.jsx(lm.Calendar,{date:D,onChange:w,maxDate:a,minDate:o,color:_?"#10B981":"#005D22"})})]}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},k5=["Apartment","Villa","Vilament","Rowhouse","Combined","Commercial Office","Commercial Retail","Commercial","Public",""],xre=wt({organizationId:be().required(),location:be().optional().nullable(),entityId:be().optional(),billingName:be().optional().nullable(),registeredAddress:be().optional().nullable(),gstNumber:be().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,{message:"Invalid GST Number format",excludeEmptyString:!0}),panNumber:be().optional().nullable().transform(n=>n?.toUpperCase()||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,{message:"Invalid PAN format",excludeEmptyString:!0}),email1:be().email("Invalid email format").optional().nullable(),email2:be().email("Invalid email format").optional().nullable(),email3:be().email("Invalid email format").optional().nullable(),eShramNumber:be().optional().nullable(),shopAndEstablishmentCode:be().optional().nullable(),keyAccountManager:be().optional(),siteAreaSqFt:rs().typeError("Must be a number").nullable().optional(),projectType:be().oneOf(k5).optional(),apartmentCount:rs().typeError("Must be a number").nullable().optional(),agreementDetails:wt({fromDate:be().optional().nullable(),toDate:be().optional().nullable().test("is-after-from","To Date must be after From Date",function(n){const{fromDate:e}=this.parent;return!e||!n?!0:new Date(n.replace(/-/g,"/"))>=new Date(e.replace(/-/g,"/"))}),renewalIntervalDays:rs().typeError("Must be a number").nullable().optional().min(0,"Cannot be negative"),softCopy:Ft().nullable().optional(),scannedCopy:Ft().nullable().optional(),agreementDate:be().optional().nullable(),addendum1Date:be().optional().nullable(),addendum2Date:be().optional().nullable()}).optional(),siteOperations:wt({form6Applicable:ns().default(!1),form6RenewalTaskCreation:ns().optional(),form6ValidityFrom:be().nullable().when("form6Applicable",{is:!0,then:n=>n.required("From Date is required")}),form6ValidityTo:be().nullable().when("form6Applicable",{is:!0,then:n=>n.required("To Date is required")}),form6Document:Ft().nullable().when("form6Applicable",{is:!0,then:n=>n.required("Document is required")}),minWageRevisionApplicable:ns().default(!1),minWageRevisionTaskCreation:ns().optional(),minWageRevisionValidityFrom:be().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("From Date is required")}),minWageRevisionValidityTo:be().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("To Date is required")}),minWageRevisionDocument:Ft().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("Document is required")}),holidays:wt({numberOfDays:rs().nullable().min(0),list:xs().of(wt({id:be(),date:be().required(),description:be().required()})),salaryPayment:be().oneOf(["Full Payment","Duty Payment","Nil Payment",""]),billing:be().oneOf(["Full Payment","Duty Payment","Nil Payment",""])}).optional(),costingSheetLink:be().url("Must be a valid URL").nullable().optional(),tools:wt({dcCopy1:Ft().nullable().optional(),dcCopy2:Ft().nullable().optional(),list:xs().of(wt({id:be(),name:be().required(),brand:be().optional(),size:be().optional(),quantity:rs().nullable().min(0),issueDate:be().required(),picture:Ft().nullable().optional()}))}).optional(),sims:wt({issuedCount:rs().nullable().min(0),details:xs().of(wt({id:be(),mobileNumber:be().required().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),allocatedTo:be().optional(),plan:be().optional(),ownerName:be().optional()}))}).optional(),equipment:wt({issued:xs().of(wt({id:be(),name:be().required(),brand:be().optional(),modelNumber:be().optional(),serialNumber:be().optional(),accessories:be().optional(),condition:be().oneOf(["New","Old",""]),issueDate:be().required(),picture:Ft().nullable().optional()})),intermittent:wt({billing:be().oneOf(["To Be Billed","Not to be Billed",""]),frequency:be().oneOf(["Monthly","Bi-Monthly","Quarterly","Half Yearly","Yearly",""]),taskCreation:ns().default(!1),durationDays:rs().nullable().min(0)}).optional()}).optional(),billingCycleFrom:be().nullable().optional(),uniformDeductions:ns().default(!1)}).optional(),insuranceStatus:wt({isCompliant:ns().required()}).optional().nullable(),assets:xs().optional(),issuedTools:xs().optional()}).defined(),QA=({title:n,children:e})=>{const[t,r]=E.useState(!1);return i.jsxs("div",{className:"border border-border rounded-lg bg-page",children:[i.jsxs("button",{type:"button",onClick:()=>r(!t),className:"w-full flex justify-between items-center p-3 font-medium text-left text-primary-text",children:[i.jsx("span",{children:n}),i.jsx(xu,{className:`h-5 w-5 transform transition-transform ${t?"rotate-180":""}`})]}),t&&i.jsx("div",{className:"p-4 border-t border-border bg-card",children:e})]})},E5=({isOpen:n,onClose:e,onSave:t,organization:r,allClients:s,initialData:a})=>{const[o,l]=E.useState("General"),c=Jt("(max-width: 767px)"),{register:d,handleSubmit:m,control:p,watch:x,setValue:v,formState:{errors:_},reset:w}=Zt({resolver:_n(xre),defaultValues:{siteOperations:{form6Applicable:!1,minWageRevisionApplicable:!1,uniformDeductions:!1}}}),{fields:j,append:P,remove:k}=ys({control:p,name:"siteOperations.holidays.list"});ys({control:p,name:"siteOperations.tools.list"}),ys({control:p,name:"siteOperations.sims.details"}),ys({control:p,name:"siteOperations.equipment.issued"}),E.useEffect(()=>{n&&w(a||{organizationId:r.id})},[n,a,r.id,w]);const I=x("entityId"),M=x("siteOperations.form6Applicable"),D=x("siteOperations.minWageRevisionApplicable");E.useEffect(()=>{if(I){const F=s.find(U=>U.id===I);F&&(v("registeredAddress",F.registeredAddress||""),v("gstNumber",F.gstNumber||""),v("panNumber",F.panNumber||""),v("email1",F.email||""),v("eShramNumber",F.eShramNumber||""),v("shopAndEstablishmentCode",F.shopAndEstablishmentCode||""))}},[I,s,v]);const O=F=>{t(r.id,F)},q=({tabName:F})=>i.jsx("button",{type:"button",onClick:()=>l(F),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${o===F?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:F});return n?i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4 flex items-center justify-center",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale",onClick:F=>F.stopPropagation(),children:i.jsxs("form",{onSubmit:m(O),className:"p-6",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Site Configuration"}),i.jsxs("p",{className:"text-sm text-muted mb-4",children:["For: ",r.shortName]}),i.jsx("div",{className:"mb-6",children:c?i.jsxs(Qe,{label:"Configuration Section",id:"site-config-tabs",value:o,onChange:F=>l(F.target.value),className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"General",children:"General"}),i.jsx("option",{value:"Compliance",children:"Compliance"}),i.jsx("option",{value:"Agreement",children:"Agreement"}),i.jsx("option",{value:"Site Operations",children:"Site Operations"})]}):i.jsx("div",{className:"border-b border-border",children:i.jsxs("nav",{className:"-mb-px flex space-x-4",children:[i.jsx(q,{tabName:"General"}),i.jsx(q,{tabName:"Compliance"}),i.jsx(q,{tabName:"Agreement"}),i.jsx(q,{tabName:"Site Operations"})]})})}),i.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2 space-y-4",children:[o==="General"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(Me,{label:"Location",id:"location",registration:d("location"),error:_.location?.message}),i.jsx(Me,{label:"Billing Name",id:"billingName",registration:d("billingName"),error:_.billingName?.message}),i.jsx(Me,{label:"Key Account Manager",id:"keyAccountManager",registration:d("keyAccountManager"),error:_.keyAccountManager?.message}),i.jsx(Me,{label:"Site Area (Sq.ft)",id:"siteAreaSqFt",type:"number",registration:d("siteAreaSqFt"),error:_.siteAreaSqFt?.message}),i.jsxs(Qe,{label:"Type of Project",id:"projectType",registration:d("projectType"),error:_.projectType?.message,children:[i.jsx("option",{value:"",children:"-- Select Type --"}),k5.filter(Boolean).map(F=>i.jsx("option",{value:F,children:F},F))]}),i.jsx(Me,{label:"No of Apartments/Villas",id:"apartmentCount",type:"number",registration:d("apartmentCount"),error:_.apartmentCount?.message})]}),o==="Compliance"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx("div",{className:"md:col-span-2",children:i.jsx(je,{name:"entityId",control:p,render:({field:F})=>i.jsxs(Qe,{label:"Link to Client (Prefills data)",id:"entityId",...F,error:_.entityId?.message,children:[i.jsx("option",{value:"",children:"-- Select Client --"}),s.map(U=>i.jsxs("option",{value:U.id,children:[U.name," (",U.companyName,")"]},U.id))]})})}),i.jsx(Me,{label:"GST Number",id:"gstNumber",registration:d("gstNumber"),error:_.gstNumber?.message}),i.jsx(Me,{label:"PAN Number",id:"panNumber",registration:d("panNumber"),error:_.panNumber?.message}),i.jsx(Me,{label:"Email Address 1",id:"email1",registration:d("email1"),error:_.email1?.message}),i.jsx(Me,{label:"Email Address 2",id:"email2",registration:d("email2"),error:_.email2?.message}),i.jsx(Me,{label:"Email Address 3",id:"email3",registration:d("email3"),error:_.email3?.message}),i.jsx(Me,{label:"E-Shram Number",id:"eShramNumber",registration:d("eShramNumber"),error:_.eShramNumber?.message}),i.jsx(Me,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:d("shopAndEstablishmentCode"),error:_.shopAndEstablishmentCode?.message})]}),o==="Agreement"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(je,{name:"agreementDetails.fromDate",control:p,render:({field:F})=>i.jsx(Nn,{label:"From Date",id:"agreementDetails.fromDate",value:F.value,onChange:F.onChange,error:_.agreementDetails?.fromDate?.message})}),i.jsx(je,{name:"agreementDetails.toDate",control:p,render:({field:F})=>i.jsx(Nn,{label:"To Date",id:"agreementDetails.toDate",value:F.value,onChange:F.onChange,error:_.agreementDetails?.toDate?.message})}),i.jsx(Me,{label:"Renewal Interval (Days)",id:"agreementDetails.renewalIntervalDays",type:"number",registration:d("agreementDetails.renewalIntervalDays"),error:_.agreementDetails?.renewalIntervalDays?.message}),i.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(je,{name:"agreementDetails.softCopy",control:p,render:({field:F})=>i.jsx(xt,{label:"Soft Copy",file:F.value,onFileChange:F.onChange})}),i.jsx(je,{name:"agreementDetails.scannedCopy",control:p,render:({field:F})=>i.jsx(xt,{label:"Scanned Copy",file:F.value,onFileChange:F.onChange})})]}),i.jsx(je,{name:"agreementDetails.agreementDate",control:p,render:({field:F})=>i.jsx(Nn,{label:"Agreement Dated",id:"agreementDetails.agreementDate",value:F.value,onChange:F.onChange,error:_.agreementDetails?.agreementDate?.message})}),i.jsx(je,{name:"agreementDetails.addendum1Date",control:p,render:({field:F})=>i.jsx(Nn,{label:"Addendum 1 Dated",id:"agreementDetails.addendum1Date",value:F.value,onChange:F.onChange,error:_.agreementDetails?.addendum1Date?.message})}),i.jsx(je,{name:"agreementDetails.addendum2Date",control:p,render:({field:F})=>i.jsx(Nn,{label:"Addendum 2 Dated",id:"agreementDetails.addendum2Date",value:F.value,onChange:F.onChange,error:_.agreementDetails?.addendum2Date?.message})})]}),o==="Site Operations"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(QA,{title:"Compliance Forms",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(je,{name:"siteOperations.form6Applicable",control:p,render:({field:F})=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:F.value,onChange:F.onChange})," Form 6 Applicable"]})}),M&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[i.jsx(je,{name:"siteOperations.form6ValidityFrom",control:p,render:({field:F})=>i.jsx(Nn,{label:"Valid From",id:"form6from",value:F.value,onChange:F.onChange,error:_.siteOperations?.form6ValidityFrom?.message})}),i.jsx(je,{name:"siteOperations.form6ValidityTo",control:p,render:({field:F})=>i.jsx(Nn,{label:"Valid To",id:"form6to",value:F.value,onChange:F.onChange,error:_.siteOperations?.form6ValidityTo?.message})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(je,{name:"siteOperations.form6Document",control:p,render:({field:F})=>i.jsx(xt,{label:"Form 6 Document",file:F.value,onFileChange:F.onChange,error:_.siteOperations?.form6Document?.message})})})]})]}),i.jsxs("div",{children:[i.jsx(je,{name:"siteOperations.minWageRevisionApplicable",control:p,render:({field:F})=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:F.value,onChange:F.onChange})," Min. Wage Revision Applicable"]})}),D&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[i.jsx(je,{name:"siteOperations.minWageRevisionValidityFrom",control:p,render:({field:F})=>i.jsx(Nn,{label:"Valid From",id:"minwagefrom",value:F.value,onChange:F.onChange,error:_.siteOperations?.minWageRevisionValidityFrom?.message})}),i.jsx(je,{name:"siteOperations.minWageRevisionValidityTo",control:p,render:({field:F})=>i.jsx(Nn,{label:"Valid To",id:"minwageto",value:F.value,onChange:F.onChange,error:_.siteOperations?.minWageRevisionValidityTo?.message})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(je,{name:"siteOperations.minWageRevisionDocument",control:p,render:({field:F})=>i.jsx(xt,{label:"Min. Wage Document",file:F.value,onFileChange:F.onChange,error:_.siteOperations?.minWageRevisionDocument?.message})})})]})]})]})}),i.jsx(QA,{title:"Holidays",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx(Me,{label:"Number of National & Festival Holidays",id:"holiday-count",type:"number",registration:d("siteOperations.holidays.numberOfDays")}),i.jsxs(Qe,{label:"Salary Payment for Holiday",id:"holiday-salary",registration:d("siteOperations.holidays.salaryPayment"),children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Full Payment"}),i.jsx("option",{children:"Duty Payment"}),i.jsx("option",{children:"Nil Payment"})]}),i.jsxs(Qe,{label:"Billing for Holiday",id:"holiday-billing",registration:d("siteOperations.holidays.billing"),children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Full Payment"}),i.jsx("option",{children:"Duty Payment"}),i.jsx("option",{children:"Nil Payment"})]}),i.jsx("h5",{className:"font-semibold pt-2 border-t",children:"Holiday List"}),j.map((F,U)=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[i.jsx("div",{className:"col-span-6",children:i.jsx(Me,{label:"Description",id:`holiday-desc-${U}`,...d(`siteOperations.holidays.list.${U}.description`)})}),i.jsx("div",{className:"col-span-5",children:i.jsx(je,{name:`siteOperations.holidays.list.${U}.date`,control:p,render:({field:B})=>i.jsx(Nn,{label:"Date",id:`holiday-date-${U}`,value:B.value,onChange:B.onChange})})}),i.jsx("div",{className:"col-span-1",children:i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>k(U),children:i.jsx(Xt,{className:"h-4 text-red-500"})})})]},F.id)),i.jsxs(ae,{type:"button",variant:"outline",size:"sm",onClick:()=>P({id:`hol_${Date.now()}`,date:"",description:""}),children:[i.jsx(qt,{className:"h-4 mr-1"})," Add Holiday"]})]})})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[i.jsx(ae,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ae,{type:"submit",children:"Save Configuration"})]})]})})}):null},yre=({isOpen:n,onClose:e,siteName:t,details:r,isLoading:s,onSave:a,designations:o})=>{const[l,c]=E.useState([]),[d,m]=E.useState(!1),p=E.useRef(null),[x,v]=E.useState(!1),_=E.useMemo(()=>{const O=new Set;return o.filter(q=>O.has(q.designation)?!1:(O.add(q.designation),!0)).sort((q,F)=>q.designation.localeCompare(F.designation))},[o]),w=()=>{const O=p.current;if(O){const q=O.scrollHeight>O.clientHeight,F=O.scrollHeight-O.scrollTop<=O.clientHeight+1;v(q&&!F)}else v(!1)};E.useEffect(()=>{if(n){c(JSON.parse(JSON.stringify(r)));const O=setTimeout(w,150);return()=>clearTimeout(O)}},[r,n,s]);const j=(O,q,F)=>{const U=[...l],B=U[O];if(q==="count"){const G=Number(F);B.count=isNaN(G)?0:G}else B.designation=String(F);c(U)},P=()=>{c([...l,{designation:"",count:0,tempId:`new_${Date.now()}`}]),setTimeout(w,50)},k=O=>{const q=l.filter((F,U)=>U!==O);c(q),setTimeout(w,50)},I=async()=>{m(!0);const O=l.filter(q=>q.designation.trim()!=="").map(({tempId:q,...F})=>F);await a(O),m(!1)},M=at.useMemo(()=>l.reduce((O,q)=>O+(Number(q.count)||0),0),[l]),D=O=>{if(O.key!=="ArrowUp"&&O.key!=="ArrowDown")return;const q=O.target;if(q.tagName!=="INPUT"&&q.tagName!=="SELECT")return;const F=q.getAttribute("data-row-index"),U=q.getAttribute("data-col-index");if(!F||!U||q.type==="number")return;O.preventDefault();const B=O.currentTarget,G=parseInt(F,10),X=parseInt(U,10),Q=O.key==="ArrowUp"?G-1:G+1,Y=B.querySelector(`[data-row-index="${Q}"][data-col-index="${X}"]`);Y&&Y.focus()};return n?EL.createPortal(i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm sm:max-w-lg md:max-w-2xl m-4 animate-fade-in-scale flex flex-col",onClick:O=>O.stopPropagation(),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Allocate Manpower"}),i.jsxs("p",{className:"text-sm text-muted mb-4",children:["For site: ",t]}),i.jsxs("div",{className:"flex-grow relative overflow-hidden",children:[i.jsx("div",{ref:p,onScroll:w,onKeyDown:D,className:"overflow-y-auto pr-2 min-h-[300px] max-h-[60vh] h-full",children:s?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-12 gap-4 sticky top-0 bg-page p-2 rounded-t-lg z-10",children:[i.jsx("div",{className:"col-span-6 font-medium text-sm text-muted",children:"Designation"}),i.jsx("div",{className:"col-span-4 font-medium text-sm text-muted",children:"Count"}),i.jsx("div",{className:"col-span-2"})]}),l.length>0?l.map((O,q)=>i.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[i.jsx("div",{className:"col-span-6",children:i.jsxs(Qe,{id:`designation-${q}`,value:O.designation,onChange:F=>j(q,"designation",F.target.value),className:"py-1.5","data-row-index":q,"data-col-index":0,"aria-label":`Designation for row ${q+1}`,children:[i.jsx("option",{value:"",children:"Select Designation"}),_.map(F=>i.jsx("option",{value:F.designation,children:F.designation},F.id))]})}),i.jsx("div",{className:"col-span-4",children:i.jsx(Me,{id:`count-${q}`,type:"number",value:O.count,onChange:F=>j(q,"count",F.target.value),min:"0",step:"0.01",className:"py-1.5","data-row-index":q,"data-col-index":1,"aria-label":`Count for row ${q+1}`})}),i.jsx("div",{className:"col-span-2 text-right",children:i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>k(q),title:"Remove row","aria-label":`Remove row ${q+1}`,children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})})]},O.tempId||q)):i.jsx("p",{className:"text-center text-muted py-10",children:"No designations added yet. Click below to start."}),i.jsxs(ae,{variant:"outline",size:"sm",onClick:P,className:"mt-4",children:[i.jsx(qt,{className:"h-4 w-4 mr-2"})," Add Designation"]})]})}),x&&i.jsx("div",{className:"absolute bottom-0 left-0 right-2 h-16 bg-gradient-to-t from-card to-transparent pointer-events-none"})]}),i.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-between items-center",children:[i.jsxs("div",{className:"font-semibold",children:["Total Manpower: ",i.jsx("span",{className:"text-accent",children:M.toFixed(2)})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx(ae,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),i.jsx(ae,{onClick:I,isLoading:d,disabled:s,children:"Save Changes"})]})]})]})}),document.getElementById("modal-root")):null},aj=["id","shortName","fullName","address","manpowerApprovedCount","reportingManagerName","managerName","fieldOfficerNames","backendFieldOfficerNames"],vre=(n,e)=>{const t=e.join(","),r=n.map(s=>e.map(a=>{let o=s[a];return Array.isArray(o)&&(o=o.join(";")),o=o==null?"":String(o),o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...r].join(`
`)},bre=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,"")),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),a[l]=d}),r.push(a)}return r},_re=({isOpen:n,onClose:e,onSave:t})=>{const[r,s]=E.useState(""),[a,o]=E.useState(""),l=()=>{if(!r.trim()){o("Site name cannot be empty.");return}t(r),s(""),e()};return n?i.jsxs(tr,{isOpen:n,onClose:e,onConfirm:l,title:"Quick Add Provisional Site",confirmButtonText:"Add Site",confirmButtonVariant:"primary",children:[i.jsx("p",{className:"mb-4 text-sm",children:"This will create a new site with a 90-day grace period to complete the full configuration."}),i.jsx(Me,{label:"New Site Name",id:"quick-add-site-name",value:r,onChange:c=>{s(c.target.value),o("")},error:a,autoFocus:!0})]}):null},wre=()=>{const[n,e]=E.useState([]),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState([]),[c,d]=E.useState(!0),[m,p]=E.useState(!1),[x,v]=E.useState(!1),[_,w]=E.useState(!1),[j,P]=E.useState(!1),[k,I]=E.useState(!1),[M,D]=E.useState(null),[O,q]=E.useState(null),[F,U]=E.useState(null),[B,G]=E.useState([]),[X,Q]=E.useState(!1),Y=E.useRef(null),ne=Jt("(max-width: 767px)"),{siteManagement:te}=fi(),ie=E.useCallback(async()=>{d(!0);try{const[le,fe,ue,ce]=await Promise.all([pe.getOrganizations().catch(ye=>(console.error("Failed to fetch organizations:",ye),[])),pe.getOrganizationStructure().catch(ye=>(console.error("Failed to fetch organization structure:",ye),[])),pe.getSiteConfigurations().catch(ye=>(console.error("Failed to fetch site configurations:",ye),[])),pe.getSiteStaffDesignations().catch(ye=>(console.error("Failed to fetch site staff designations:",ye),U({message:"Could not load designation list. Manpower editing may be affected.",type:"error"}),[]))]);e(le),r(ue),l(ce);const Se=fe.flatMap(ye=>ye.companies.flatMap(Ne=>Ne.entities.map(ke=>({...ke,companyName:Ne.name}))));a(Se)}catch{U({message:"An unexpected error occurred while fetching data.",type:"error"})}finally{d(!1)}},[]);E.useEffect(()=>{ie()},[ie]);const $=le=>{D(le),w(!0)},H=le=>{q(le),P(!0)},se=async le=>{const fe={id:`SITE-${le.toUpperCase().replace(/\s/g,"").substring(0,4)}-${Date.now()%1e3}`,shortName:le,fullName:le,address:"To be configured",provisionalCreationDate:new Date().toISOString()};try{await pe.createOrganization(fe),U({message:`Provisional site '${le}' created.`,type:"success"}),ie()}catch(ue){console.error("Error creating site:",ue);const ce=ue?.message||ue?.error?.message||"Failed to create site.";U({message:`Failed to create site: ${ce}`,type:"error"})}},W=(le,fe)=>{if(n.some(ce=>ce.id===le.organizationId)){U({message:"A site for this client already exists.",type:"error"});return}const ue={id:le.organizationId||`site_${Date.now()}`,shortName:le.name,fullName:le.name,address:le.location||le.registeredAddress||"",manpowerApprovedCount:fe};e(ce=>[ue,...ce].sort((Se,ye)=>Se.shortName.localeCompare(ye.shortName))),p(!1),U({message:"Site added successfully. You can now configure it.",type:"success"})},ee=(le,fe)=>{r(ue=>{const ce=[...ue],Se=ce.findIndex(ye=>ye.organizationId===le);return Se>-1?ce[Se]=fe:ce.push(fe),ce}),U({message:"Site configuration saved.",type:"success"}),w(!1)},K=async()=>{O&&(e(le=>le.filter(fe=>fe.id!==O.id)),r(le=>le.filter(fe=>fe.organizationId!==O.id)),U({message:"Site deleted.",type:"success"}),P(!1))},oe=async le=>{q(le),Q(!0),I(!0);try{const fe=await pe.getManpowerDetails(le.id);G(fe)}catch{U({message:"Could not load manpower details.",type:"error"})}finally{Q(!1)}},re=async le=>{if(O)try{await pe.updateManpowerDetails(O.id,le);const fe=le.reduce((ue,ce)=>ue+(Number(ce.count)||0),0);e(ue=>ue.map(ce=>ce.id===O.id?{...ce,manpowerApprovedCount:fe}:ce)),I(!1),U({message:"Manpower details updated successfully.",type:"success"})}catch{U({message:"Failed to save manpower details.",type:"error"})}},me=()=>{const le=vre(n,aj),fe=new Blob([le],{type:"text/csv;charset=utf-8;"}),ue=document.createElement("a");ue.href=URL.createObjectURL(fe),ue.setAttribute("download","sites_export.csv"),document.body.appendChild(ue),ue.click(),document.body.removeChild(ue),U({message:"Sites exported successfully.",type:"success"})},_e=le=>{const fe=le.target.files?.[0];if(!fe)return;const ue=new FileReader;ue.onload=async ce=>{try{const Se=ce.target?.result;if(!Se)throw new Error("File is empty or could not be read.");const ye=bre(Se);if(ye.length===0)throw new Error("No data rows found in the CSV file.");const Ne=Object.keys(ye[0]);if(!aj.every(He=>Ne.includes(He)))throw new Error(`CSV is missing headers. Required: ${aj.join(", ")}`);const qe=ye.map(He=>({id:He.id,shortName:He.shortName,fullName:He.fullName,address:He.address,manpowerApprovedCount:parseFloat(He.manpowerApprovedCount)||0,reportingManagerName:He.reportingManagerName||void 0,managerName:He.managerName||void 0,fieldOfficerNames:He.fieldOfficerNames?He.fieldOfficerNames.split(";").map(Be=>Be.trim()).filter(Be=>Be):void 0,backendFieldOfficerNames:He.backendFieldOfficerNames?He.backendFieldOfficerNames.split(";").map(Be=>Be.trim()).filter(Be=>Be):void 0})),{count:ze}=await pe.bulkUploadOrganizations(qe);U({message:`${ze} sites imported/updated successfully.`,type:"success"}),ie()}catch(Se){U({message:Se.message||"Failed to import CSV.",type:"error"})}finally{le.target&&(le.target.value="")}},ue.readAsText(fe)};return i.jsxs("div",{className:"p-4 md:p-8",children:[F&&i.jsx(Gt,{message:F.message,type:F.type,onDismiss:()=>U(null)}),i.jsx("input",{type:"file",ref:Y,className:"hidden",accept:".csv",onChange:_e}),i.jsx(tX,{isOpen:m,onClose:()=>p(!1),onSave:W}),i.jsx(_re,{isOpen:x,onClose:()=>v(!1),onSave:se}),_&&M&&i.jsx(E5,{isOpen:_,onClose:()=>w(!1),onSave:ee,organization:M,allClients:s,initialData:t.find(le=>le.organizationId===M.id)}),O&&i.jsx(yre,{isOpen:k,onClose:()=>I(!1),siteName:O.shortName,details:B,isLoading:X,onSave:re,designations:o}),i.jsxs(tr,{isOpen:j,onClose:()=>P(!1),onConfirm:K,title:"Confirm Deletion",children:['Are you sure you want to delete the site "',O?.shortName,'"? This action cannot be undone.']}),i.jsxs("div",{className:"bg-card p-4 rounded-2xl mb-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Site Management"}),!ne&&i.jsxs("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:[i.jsxs(ae,{variant:"outline",onClick:()=>v(!0),className:"mr-2 hover:bg-gray-100",children:[i.jsx(qt,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),i.jsxs(ae,{onClick:()=>p(!0),className:"mr-2 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[i.jsx(qt,{className:"w-5 h-5 mr-2"}),"Add Site"]}),i.jsxs(ae,{variant:"outline",onClick:()=>Y.current?.click(),className:"mr-2 hover:bg-gray-100",children:[i.jsx(Bc,{className:"w-5 h-5 mr-2"}),"Import"]}),i.jsxs(ae,{variant:"outline",onClick:me,className:"hover:bg-gray-100",children:[i.jsx(hi,{className:"w-5 h-5 mr-2"}),"Export"]})]})]}),ne&&i.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[i.jsxs(ae,{onClick:()=>p(!0),className:"w-full justify-center bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[i.jsx(qt,{className:"w-5 h-5 mr-2"}),"Add Site"]}),i.jsxs(ae,{variant:"outline",onClick:()=>v(!0),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(qt,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs(ae,{variant:"outline",onClick:()=>Y.current?.click(),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(Bc,{className:"w-5 h-5 mr-2"}),"Import"]}),i.jsxs(ae,{variant:"outline",onClick:me,className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(hi,{className:"w-5 h-5 mr-2"}),"Export"]})]})]})]}),i.jsx("div",{className:"bg-card rounded-2xl shadow-sm border border-border overflow-hidden",children:c?i.jsx("div",{className:"overflow-x-auto",children:i.jsx("table",{className:"w-full",children:i.jsx("tbody",{className:"divide-y divide-border",children:i.jsx(Ta,{cols:5,rows:5})})})}):n.length===0?i.jsxs("div",{className:"p-8 text-center text-muted",children:[i.jsx(Uc,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),i.jsx("p",{children:"No sites found. Add a new site to get started."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-muted/50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Location"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-muted uppercase tracking-wider",children:"Manpower"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Key Staff"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(le=>{t.find(ce=>ce.organizationId===le.id);const fe=!!le.provisionalCreationDate,ue=fe&&le.provisionalCreationDate?90-wB(new Date,new Date(le.provisionalCreationDate)):0;return i.jsxs("tr",{className:"hover:bg-muted/5 transition-colors",children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center",children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-primary-text",children:le.shortName}),i.jsx("div",{className:"text-xs text-muted",children:le.fullName}),fe&&i.jsxs("div",{className:`mt-1 text-xs px-2 py-0.5 rounded-full inline-flex items-center gap-1 ${ue>30?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[i.jsx(TF,{className:"w-3 h-3"}),ue>0?`${ue} days left`:"Expired"]})]})})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"text-sm text-primary-text max-w-xs truncate",title:le.address,children:le.address})}),i.jsx("td",{className:"px-6 py-4 text-center",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:le.manpowerApprovedCount||0})}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"text-xs space-y-1",children:[le.reportingManagerName&&i.jsxs("div",{className:"flex items-center gap-1",title:"Reporting Manager",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:"RM:"})," ",le.reportingManagerName]}),le.managerName&&i.jsxs("div",{className:"flex items-center gap-1",title:"Site Manager",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:"SM:"})," ",le.managerName]}),le.fieldOfficerNames&&le.fieldOfficerNames.length>0&&i.jsxs("div",{className:"flex items-start gap-1",title:"Field Officers",children:[i.jsx("span",{className:"font-semibold text-primary-text whitespace-nowrap",children:"FO:"}),i.jsx("span",{className:"truncate max-w-[150px]",children:le.fieldOfficerNames.join(", ")})]}),le.backendFieldOfficerNames&&le.backendFieldOfficerNames.length>0&&i.jsxs("div",{className:"flex items-start gap-1",title:"Backend Field Officers",children:[i.jsx("span",{className:"font-semibold text-primary-text whitespace-nowrap",children:"BFO:"}),i.jsx("span",{className:"truncate max-w-[150px]",children:le.backendFieldOfficerNames.join(", ")})]})]})}),i.jsx("td",{className:"px-6 py-4 text-right whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>oe(le),title:"Manpower Details",children:i.jsx(mi,{className:"w-4 h-4 text-blue-600"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>$(le),title:"Configure Site",children:i.jsx(vm,{className:"w-4 h-4 text-gray-600"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>H(le),title:"Delete Site",children:i.jsx(Xt,{className:"w-4 h-4 text-red-600"})})]})})]},le.id)})})]})})})]})},Sre=({isOpen:n,onClose:e,onSave:t,title:r,initialName:s=""})=>{const[a,o]=E.useState(s),[l,c]=E.useState("");E.useEffect(()=>{n&&(o(s),c(""))},[n,s]);const d=()=>{if(!a.trim()){c("Role name cannot be empty.");return}t(a.trim()),e()};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm m-4 animate-fade-in-scale",onClick:m=>m.stopPropagation(),children:i.jsxs("form",{onSubmit:m=>{m.preventDefault(),d()},children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-4",children:r}),i.jsx(Me,{label:"Role Display Name",id:"role-name",value:a,onChange:m=>o(m.target.value),error:l,autoFocus:!0}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ae,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ae,{type:"submit",children:"Save"})]})]})})}):null},MN=[{key:"apply_for_leave",name:"Apply for Leave",description:"Allows users to request time off."},{key:"create_enrollment",name:"Create Enrollment",description:"Access the multi-step form to onboard new employees."},{key:"view_developer_settings",name:"Developer Settings",description:"Access API settings and other developer tools."},{key:"download_attendance_report",name:"Download Attendance Report",description:"Generate and download attendance reports in CSV format."},{key:"manage_approval_workflow",name:"Manage Approval Workflow",description:"Set up reporting managers for leave approvals."},{key:"manage_attendance_rules",name:"Manage Attendance Rules",description:"Set work hours, holidays, and leave allocations."},{key:"manage_enrollment_rules",name:"Manage Enrollment Rules",description:"Set rules for ESI/GMC, manpower limits, and documents."},{key:"manage_insurance",name:"Manage Insurance",description:"Create and manage company insurance plans."},{key:"manage_leave_requests",name:"Manage Leave Requests",description:"Approve or reject leave requests for employees."},{key:"manage_modules",name:"Manage Modules",description:"Create, edit, and group permissions into modules."},{key:"manage_policies",name:"Manage Policies",description:"Create and manage company policies."},{key:"manage_roles_and_permissions",name:"Manage Roles & Permissions",description:"Access this page to edit role permissions."},{key:"manage_sites",name:"Manage Sites",description:"Create, edit, and delete organizations/sites."},{key:"manage_tasks",name:"Manage Tasks",description:"Create, assign, and manage all organizational tasks, including escalations."},{key:"manage_uniforms",name:"Manage Uniforms",description:"Manage uniform requests and site configurations."},{key:"manage_users",name:"Manage Users",description:"Create, edit, and delete user accounts."},{key:"view_operations_dashboard",name:"Operations Dashboard",description:"View the operations management dashboard."},{key:"view_site_dashboard",name:"Site Dashboard",description:"View the dashboard for a specific site/organization."},{key:"view_all_attendance",name:"View All Attendance",description:"Allows users to see attendance records for all employees."},{key:"view_all_submissions",name:"View All Submissions",description:"Access the main dashboard to view all employee submissions."},{key:"view_entity_management",name:"View Entity Management",description:"Access the HR dashboard for managing company entities."},{key:"view_field_officer_tracking",name:"View Field Officer Tracking",description:"Track user check-in/out locations and activity on a map."},{key:"view_invoice_summary",name:"View Invoice Summary",description:"View and generate monthly invoices for sites."},{key:"view_own_attendance",name:"View Own Attendance",description:"Allows users to see their own attendance records."},{key:"view_verification_costing",name:"View Verification Costing",description:"Analyze costs associated with third-party document verifications."}].sort((n,e)=>n.name.localeCompare(e.name)),jre=()=>{const{permissions:n,setRolePermissions:e,addRolePermissionEntry:t,removeRolePermissionEntry:r,renameRolePermissionEntry:s}=ka(),[a,o]=E.useState([]),[l,c]=E.useState([]),[d,m]=E.useState(!0),[p,x]=E.useState(null),[v,_]=E.useState(!1),[w,j]=E.useState(!1),[P,k]=E.useState(null),[I,M]=E.useState(!1),[D,O]=E.useState(null),q=E.useRef(null),F=Jt("(max-width: 767px)");E.useEffect(()=>{(async()=>{m(!0);try{const[te,ie]=await Promise.all([pe.getRoles(),pe.getModules()]);o(te),c(ie.sort(($,H)=>$.name.localeCompare(H.name)))}catch(te){console.error("Failed to load data",te),x({message:"Failed to load page data.",type:"error"})}finally{m(!1)}})()},[]),E.useEffect(()=>{const ne=te=>{q.current&&!q.current.contains(te.target)&&O(null)};return document.addEventListener("mousedown",ne),()=>document.removeEventListener("mousedown",ne)},[]);const U=(ne,te,ie)=>{const $=n[ne]||[],H=ie?[...$,te]:$.filter(se=>se!==te);e(ne,H)},B=async ne=>{const te=ne.toLowerCase().replace(/\s+/g,"_");if(I&&P){if(P.id==="admin"){x({message:"The Admin role cannot be renamed.",type:"error"});return}if(a.some($=>$.id===te&&$.id!==P.id)){x({message:`A role with ID '${te}' already exists.`,type:"error"});return}const ie=a.map($=>$.id===P.id?{...$,displayName:ne,id:te}:$);await pe.saveRoles(ie),o(ie),s(P.id,te),x({message:"Role renamed.",type:"success"})}else{if(a.some(H=>H.id===te)){x({message:`A role with ID '${te}' already exists.`,type:"error"});return}const ie={id:te,displayName:ne},$=[...a,ie];await pe.saveRoles($),o($),t(ie),x({message:"Role added successfully.",type:"success"})}},G=async()=>{if(!P||P.id==="admin"){x({message:"This role cannot be deleted.",type:"error"}),j(!1);return}const ne=a.filter(te=>te.id!==P.id);await pe.saveRoles(ne),o(ne),r(P.id),x({message:`Role '${P.displayName}' deleted.`,type:"success"}),j(!1)},X=E.useMemo(()=>new Map(MN.map(ne=>[ne.key,ne])),[]),Q=E.useMemo(()=>{const ne=new Set(l.flatMap(te=>te.permissions));return MN.filter(te=>!ne.has(te.key))},[l]),Y=ne=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Permission",className:"px-4 py-4",children:i.jsxs("div",{className:"flex flex-col items-end text-right md:items-start md:text-left",children:[i.jsx("div",{className:"font-semibold text-primary-text",children:ne.name}),i.jsx("div",{className:"text-xs text-muted",children:ne.description})]})}),a.map(te=>{const ie=n[te.id]?.includes(ne.key),$=te.id==="admin",H=$?"Admin role has all permissions by default and cannot be changed.":"";return i.jsx("td",{"data-label":te.displayName,className:"px-4 py-4 text-center align-middle",children:i.jsx("div",{className:"flex justify-center",children:i.jsxs("label",{className:`relative flex items-center justify-center w-5 h-5 ${$?"cursor-not-allowed":"cursor-pointer"}`,children:[i.jsx("input",{type:"checkbox",className:"sr-only peer",checked:ie,onChange:se=>U(te.id,ne.key,se.target.checked),disabled:$,title:H}),i.jsx("span",{className:`w-5 h-5 bg-white border border-gray-300 rounded flex items-center justify-center peer-focus-visible:ring-2 peer-focus-visible:ring-offset-2 peer-focus-visible:ring-accent-dark peer-checked:border-accent ${$?"opacity-50":""}`,children:ie?i.jsx(xl,{className:"w-4 h-4 text-accent"}):i.jsx(Ui,{className:"w-4 h-4 text-red-500"})})]})})},te.id)})]},ne.key);return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[p&&i.jsx(Gt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Sre,{isOpen:v,onClose:()=>_(!1),onSave:B,title:I?"Rename Role":"Add New Role",initialName:I?P?.displayName:""}),i.jsxs(tr,{isOpen:w,onClose:()=>j(!1),onConfirm:G,title:"Confirm Deletion",children:['Are you sure you want to delete the role "',P?.displayName,'"? This action cannot be undone.']}),i.jsx(Yi,{title:"Role & Permission Management",children:i.jsxs("button",{onClick:()=>{M(!1),k(null),_(!0)},className:"btn btn-primary btn-md",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Role"]})}),i.jsx("p",{className:"text-muted text-sm -mt-4 mb-6",children:"Assign permissions to user roles. Changes are saved automatically."}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-4 py-3 text-left font-bold text-primary-text",children:"Permission"}),a.map(ne=>i.jsx("th",{scope:"col",className:"px-4 py-3 text-center font-bold text-primary-text w-40",children:i.jsxs("div",{className:"flex items-center justify-center gap-1",children:[i.jsx("span",{children:ne.displayName}),ne.id!=="admin"&&i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>O(ne.id===D?null:ne.id),children:i.jsx(BK,{className:"h-4 w-4 text-muted"})}),D===ne.id&&i.jsxs("div",{ref:q,className:"absolute right-0 mt-2 w-32 bg-card border rounded-md shadow-lg z-10",children:[i.jsxs("button",{onClick:()=>{M(!0),k(ne),_(!0),O(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center",children:[i.jsx(xr,{className:"mr-2 h-4 w-4"}),"Rename"]}),i.jsxs("button",{onClick:()=>{k(ne),j(!0),O(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center text-red-600",children:[i.jsx(Xt,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})},ne.id))]})}),d?i.jsx("tbody",{children:F?i.jsx("tr",{children:i.jsx("td",{colSpan:a.length+1||2,children:i.jsx(Ta,{rows:3,cols:2,isMobile:!0})})}):i.jsx(Ta,{rows:10,cols:a.length+1||5})}):i.jsxs(i.Fragment,{children:[l.map(ne=>i.jsxs("tbody",{className:"divide-y divide-border",children:[i.jsx("tr",{className:"bg-page/50",children:i.jsx("td",{colSpan:a.length+1,className:"p-2 font-bold text-primary-text",children:ne.name})}),ne.permissions.map(te=>{const ie=X.get(te);return ie?Y(ie):null})]},ne.id)),Q.length>0&&i.jsxs("tbody",{className:"divide-y divide-border",children:[i.jsx("tr",{className:"bg-page/50",children:i.jsx("td",{colSpan:a.length+1,className:"p-2 font-bold text-primary-text",children:"Uncategorized"})}),Q.map(Y)]})]})]})})]})},Nre=wt({id:be().required(),name:be().required("Module name is required"),description:be().required("Description is required"),permissions:xs().of(be().required()).min(1,"At least one permission must be selected")}).defined(),Cre=({isOpen:n,onClose:e,onSave:t,initialData:r})=>{const{register:s,handleSubmit:a,control:o,reset:l,formState:{errors:c}}=Zt({resolver:_n(Nre)});return E.useEffect(()=>{n&&l(r||{id:`mod_${Date.now()}`,name:"",description:"",permissions:[]})},[n,r,l]),n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-2xl my-8 animate-fade-in-scale flex flex-col",onClick:d=>d.stopPropagation(),children:i.jsxs("form",{onSubmit:a(t),children:[i.jsx("div",{className:"p-4 border-b",children:i.jsxs("h3",{className:"text-xl font-bold",children:[r?"Edit":"Add"," Module"]})}),i.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[i.jsx(Me,{label:"Module Name",...s("name"),error:c.name?.message}),i.jsx(Me,{label:"Description",...s("description"),error:c.description?.message}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Permissions"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 p-4 border rounded-lg h-64 overflow-y-auto bg-page",children:i.jsx(je,{name:"permissions",control:o,render:({field:d})=>i.jsx(i.Fragment,{children:MN.map(m=>i.jsx(Cn,{id:`perm-${m.key}`,label:m.name,checked:d.value?.includes(m.key)||!1,onChange:p=>{const x=p?[...d.value||[],m.key]:(d.value||[]).filter(v=>v!==m.key);d.onChange(x)}},m.key))})})}),c.permissions&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:Array.isArray(c.permissions)?c.permissions[0]?.message:c.permissions.message})]})]}),i.jsxs("div",{className:"p-4 border-t flex justify-end gap-3",children:[i.jsx(ae,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(ae,{type:"submit",children:"Save Module"})]})]})})}):null},Tre=({count:n=6})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:n}).map((e,t)=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Wr,{className:"h-5 w-5 rounded-full"}),i.jsx(Wr,{className:"h-5 w-1/2"})]}),i.jsx(Wr,{className:"h-4 w-full"}),i.jsx(Wr,{className:"h-4 w-3/4"}),i.jsx(Wr,{className:"h-3 w-1/4"})]},t))}),Pre=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(null),[o,l]=E.useState(!1),[c,d]=E.useState(!1),[m,p]=E.useState(null);E.useEffect(()=>{(async()=>{r(!0);try{const w=await pe.getModules();e(w)}catch{a({message:"Failed to load modules.",type:"error"})}finally{r(!1)}})()},[]);const x=async _=>{const w=[...n],j=w.findIndex(P=>P.id===_.id);j>-1?w[j]=_:w.push(_);try{await pe.saveModules(w),e(w.sort((P,k)=>P.name.localeCompare(k.name))),a({message:`Module '${_.name}' saved.`,type:"success"}),l(!1)}catch{a({message:"Failed to save module.",type:"error"})}},v=async()=>{if(!m)return;const _=n.filter(w=>w.id!==m.id);try{await pe.saveModules(_),e(_),a({message:`Module '${m.name}' deleted.`,type:"success"}),d(!1)}catch{a({message:"Failed to delete module.",type:"error"})}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[s&&i.jsx(Gt,{...s,onDismiss:()=>a(null)}),i.jsx(Cre,{isOpen:o,onClose:()=>l(!1),onSave:x,initialData:m}),i.jsxs(tr,{isOpen:c,onClose:()=>d(!1),onConfirm:v,title:"Confirm Deletion",children:['Are you sure you want to delete the module "',m?.name,'"?']}),i.jsx(Yi,{title:"Module Management",children:i.jsxs(ae,{onClick:()=>{p(null),l(!0)},children:[i.jsx(qt,{className:"mr-2 h-4"})," Add Module"]})}),t?i.jsx(Tre,{count:6}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(_=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col",children:[i.jsxs("div",{className:"flex-grow",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx(pC,{className:"h-5 w-5 text-accent"}),i.jsx("h4",{className:"font-bold text-primary-text",children:_.name})]}),i.jsx("p",{className:"text-sm text-muted mb-3",children:_.description}),i.jsxs("p",{className:"text-xs font-semibold text-muted",children:[_.permissions.length," permissions"]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border flex justify-end gap-2",children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>{p(_),l(!0)},title:`Edit ${_.name}`,children:i.jsx(xr,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>{p(_),d(!0)},title:`Delete ${_.name}`,children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})]})]},_.id))})]})},oj=({title:n,icon:e,children:t})=>i.jsxs("div",{className:"bg-page p-4 rounded-lg",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(e,{className:"h-5 w-5 text-accent-dark mr-3"}),i.jsx("h4",{className:"font-semibold text-primary-text",children:n})]}),i.jsx("div",{className:"space-y-4",children:t})]}),Mre=({isOpen:n,onClose:e})=>{const{currentLogo:t,defaultLogo:r,setCurrentLogo:s,setDefaultLogo:a,resetToDefault:o,resetToOriginal:l}=_C(),{backgroundImages:c,addBackgroundImage:d,removeBackgroundImage:m}=JF(),p=GF(),[x,v]=E.useState(null),_=I=>{if(I){const M=new FileReader;M.readAsDataURL(I.file),M.onloadend=()=>{const D=M.result;s(D),v({message:"Active logo updated!",type:"success"})},M.onerror=()=>{v({message:"Failed to read logo file.",type:"error"})}}},w=()=>{a(),v({message:"Active logo has been set as the new default.",type:"success"})},j=()=>{o(),v({message:"Logo has been reset to your default.",type:"success"})},P=()=>{l(),v({message:"Logo has been reset to the system original.",type:"success"})},k=I=>{if(I&&!I.url){const M=new FileReader;M.readAsDataURL(I.file),M.onloadend=()=>{const D=M.result,O=d(D);v(O?{message:"Background image added.",type:"success"}:{message:"This image has already been added.",type:"error"})},M.onerror=()=>{v({message:"Failed to read image file.",type:"error"})}}};return n?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:[x&&i.jsx(Gt,{message:x.message,type:x.type,onDismiss:()=>v(null)}),i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale flex flex-col",onClick:I=>I.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Page Interface Settings"}),i.jsx(ae,{variant:"icon",onClick:e,children:i.jsx(Ui,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[75vh]",children:[i.jsxs(oj,{title:"Branding & Logo",icon:IF,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the active and default logos for your application."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pt-4 items-start",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Active Logo"}),i.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:i.jsx("img",{src:t,alt:"Current Active Logo",className:"max-h-24 w-auto"})}),i.jsx(xt,{label:"Change Active Logo",file:null,onFileChange:_,allowedTypes:["image/jpeg","image/png"]})]}),i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Default Logo"}),i.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:i.jsx("img",{src:r,alt:"Default Logo",className:"max-h-24 w-auto"})})]}),i.jsx("div",{className:"flex-grow"}),i.jsxs("div",{className:"space-y-2 mt-4",children:[i.jsx(ae,{type:"button",className:"w-full",onClick:w,children:"Set Active Logo as Default"}),i.jsx(ae,{type:"button",className:"w-full",variant:"outline",onClick:j,children:"Use Default Logo"}),i.jsx("div",{className:"text-center pt-2",children:i.jsx("button",{type:"button",onClick:P,className:"text-xs text-muted hover:text-primary-text underline",children:"Reset to System Original"})})]})]})]})]}),i.jsxs(oj,{title:"Login Screen Background",icon:AF,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the background images for the login screen carousel."}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:c.map((I,M)=>i.jsxs("div",{className:"relative group aspect-video bg-page rounded-md overflow-hidden",children:[i.jsx("img",{src:I,className:"w-full h-full object-cover",alt:`Background ${M+1}`}),i.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:i.jsx(ae,{variant:"icon",onClick:()=>m(M),className:"!rounded-full !bg-white/20 hover:!bg-white/40",children:i.jsx(Xt,{className:"h-5 w-5 text-white"})})})]},`${I.substring(0,30)}-${M}`))}),i.jsx("div",{className:"mt-4",children:i.jsx(xt,{label:"Add new background image",file:null,onFileChange:k,allowedTypes:["image/jpeg","image/png","image/webp"]})})]}),i.jsxs(oj,{title:"Interaction Settings",icon:tJ,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize hover and auto-scroll behaviors for easier navigation."}),i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsx(Cn,{id:"auto-click-hover-modal",label:"Enable Auto-Click on Hover",description:"Automatically switch tabs or pages by hovering over them.",checked:p.autoClickOnHover,onChange:p.setAutoClickOnHover}),i.jsx(Cn,{id:"auto-scroll-hover-modal",label:"Enable Auto-Scroll on Hover",description:"Automatically scroll the page by hovering over the up/down arrows.",checked:p.autoScrollOnHover,onChange:p.setAutoScrollOnHover})]})]})]}),i.jsx("div",{className:"p-4 border-t flex justify-end",children:i.jsx(ae,{variant:"primary",onClick:e,children:"Done"})})]})]}):null},Ju=({title:n,icon:e,children:t,className:r})=>i.jsxs("div",{className:`border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card ${r||""}`,children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(e,{className:"h-6 w-6 text-accent-dark"})}),i.jsx("div",{children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:n})})]}),i.jsx("div",{className:"space-y-4",children:t})]}),kre=()=>{const n=fi(),[e,t]=E.useState(!1),[r,s]=E.useState(null),[a,o]=E.useState(!1),l=async()=>{t(!0),s(null);try{const c=await pe.exportAllData(),d=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(c,null,2))}`,m=document.createElement("a");m.href=d,m.download=`paradigm_backup_${new Date().toISOString()}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),s({message:"Data exported successfully!",type:"success"})}catch{s({message:"Failed to export data.",type:"error"})}finally{t(!1)}};return i.jsxs("div",{className:"space-y-8 p-4 md:p-0",children:[r&&i.jsx(Gt,{message:r.message,type:r.type,onDismiss:()=>s(null)}),i.jsx(Mre,{isOpen:a,onClose:()=>o(!1)}),i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"System Settings"})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[i.jsxs("div",{className:"space-y-8",children:[i.jsxs(Ju,{title:"Page Interface",icon:IF,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize the application's branding, login screen, and user interaction settings."}),i.jsx("div",{className:"pt-4",children:i.jsx(ae,{type:"button",onClick:()=>o(!0),children:"Open Interface Settings"})})]}),i.jsxs(Ju,{title:"Verification APIs",icon:$x,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure third-party services for employee verification."}),i.jsxs("div",{className:"space-y-6 pt-4",children:[i.jsx("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:i.jsx(Cn,{id:"gemini-enabled",label:"Enable Gemini API OCR Verification",description:"Use Google's Gemini API for document data extraction. This is a powerful fallback or primary OCR. API key must be configured on the backend.",checked:n.geminiApi.enabled,onChange:c=>n.updateGeminiApiSettings({enabled:c})})}),i.jsxs("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:[i.jsx(Cn,{id:"perfios-enabled",label:"Enable Perfios API Verification",description:"Use Perfios for Bank, Aadhaar, and UAN verification.",checked:n.perfiosApi.enabled,onChange:c=>n.updatePerfiosApiSettings({enabled:c})}),i.jsxs("div",{className:`mt-4 space-y-4 transition-opacity ${n.perfiosApi.enabled?"opacity-100":"opacity-50 pointer-events-none"}`,children:[i.jsx(Me,{label:"Perfios Client ID",value:n.perfiosApi.clientId,onChange:c=>n.updatePerfiosApiSettings({clientId:c.target.value})}),i.jsx(Me,{label:"Perfios Client Secret",type:"password",value:n.perfiosApi.clientSecret,onChange:c=>n.updatePerfiosApiSettings({clientSecret:c.target.value})})]})]})]})]}),i.jsxs(Ju,{title:"Authentication Settings",icon:cu,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage how users sign in to the application."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Cn,{id:"otp-enabled",label:"Enable OTP Phone Sign-In",description:"Allow users to sign in using a one-time password sent via SMS.",checked:n.otp.enabled,onChange:c=>n.updateOtpSettings({enabled:c})})})]})]}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs(Ju,{title:"Client & Site Management",icon:Uc,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Control workflows for site creation and management."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Cn,{id:"enable-provisional-sites",label:"Enable Provisional Site Creation",description:"Allows HR/Admins to create a site with just a name, providing a 90-day grace period to complete the full configuration for easier onboarding.",checked:n.siteManagement.enableProvisionalSites,onChange:c=>n.updateSiteManagementSettings({enableProvisionalSites:c})})})]}),i.jsxs(Ju,{title:"System & Data",icon:vm,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage core system settings and data operations."}),i.jsxs("div",{className:"space-y-6 pt-4",children:[i.jsx(Cn,{id:"pincode-verification",label:"Enable Pincode API Verification",description:"Auto-fill City/State from pincode during onboarding.",checked:n.address.enablePincodeVerification,onChange:c=>n.updateAddressSettings({enablePincodeVerification:c})}),i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:"Backup & Export"}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Download all data from the active data source (Mock Data)."}),i.jsxs(ae,{type:"button",variant:"outline",onClick:l,isLoading:e,children:[i.jsx(hi,{className:"mr-2 h-4 w-4"})," Export All Data"]})]})]})]}),i.jsxs(Ju,{title:"Notification Settings",icon:yu,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure how the system sends notifications."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Cn,{id:"email-notif-enabled",label:"Enable Email Notifications",description:"Send emails for important events like task assignments. SMTP must be configured on the backend.",checked:n.notifications.email.enabled,onChange:c=>n.updateNotificationSettings({email:{enabled:c}})})})]})]})]})]})},Tr=({title:n,subtitle:e})=>i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text form-header-title",children:n}),i.jsx("p",{className:"mt-2 text-sm text-muted",children:e})]}),Ere=({title:n,value:e,icon:t})=>i.jsxs("div",{className:"bg-card p-4 rounded-2xl flex flex-col md:flex-row items-start md:items-center col-span-1 gap-3 md:gap-0",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light md:mr-4",children:i.jsx(t,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-muted font-medium",children:n}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:e})]})]}),po=at.memo(Ere),Dre=()=>{const n=yn(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,m]=E.useState(null),[p,x]=E.useState([{startDate:new Date(new Date().setMonth(new Date().getMonth()-1)),endDate:new Date,key:"selection"}]),[v,_]=E.useState(!1),[w,j]=E.useState(""),[P,k]=E.useState(""),[I,M]=E.useState(Ue(new Date,"yyyy-MM-dd"));E.useEffect(()=>{(async()=>{c(!0);try{const[B,G,X]=await Promise.all([pe.getVerificationSubmissions(),pe.getFieldOfficers(),pe.getOrganizations()]);t(B),s(G),o(X)}catch{m({message:"Failed to load dashboard data.",type:"error"})}finally{c(!1)}})()},[]);const D=E.useMemo(()=>{const U=p[0].startDate,B=p[0].endDate;if(!U||!B)return e;const G=new Date(B);return G.setHours(23,59,59,999),e.filter(X=>{const Q=new Date(X.enrollmentDate.replace(/-/g,"/"));return Q>=U&&Q<=G})},[e,p]),O=E.useMemo(()=>({total:D.length,verified:D.filter(U=>U.status==="verified").length,rejected:D.filter(U=>U.status==="rejected").length}),[D]),q=async U=>{if(U.preventDefault(),!w||!P||!I){m({message:"Please fill all fields for assignment.",type:"error"});return}try{await pe.createAssignment(w,P,I),m({message:"Assignment created successfully (mocked).",type:"success"})}catch{m({message:"Failed to create assignment.",type:"error"})}},F=p[0].startDate&&p[0].endDate?`${Ue(p[0].startDate,"MMM d, yyyy")} - ${Ue(p[0].endDate,"MMM d, yyyy")}`:"Select Date";return i.jsxs("div",{className:"p-4 space-y-8",children:[d&&i.jsx(Gt,{message:d.message,type:d.type,onDismiss:()=>m(null)}),i.jsx("div",{className:"bg-card p-4 rounded-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Operations Dashboard"}),i.jsxs("div",{className:"relative",children:[i.jsxs(ae,{variant:"outline",onClick:()=>_(!v),children:[i.jsx(Sa,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:F})]}),v&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:i.jsx(lm.DateRangePicker,{onChange:U=>{x([U.selection]),_(!1)},months:1,ranges:p,direction:"horizontal"})})]})]})}),i.jsx("div",{className:"bg-gradient-to-br from-accent/10 to-accent/5 border-2 border-accent/30 rounded-2xl p-6 cursor-pointer hover:border-accent hover:shadow-lg transition-all group",onClick:()=>n("/operations/team-activity"),children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"bg-accent rounded-xl p-3 group-hover:scale-110 transition-transform",children:i.jsx(Rh,{className:"h-6 w-6 text-white"})}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Team Activity Monitor"})]}),i.jsx("p",{className:"text-muted mb-4",children:"Track your field team in real-time. Monitor check-ins, working hours, locations, and communicate instantly with your team members."}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("span",{className:"px-3 py-1 bg-green-500/10 text-green-600 rounded-full text-xs font-medium",children:"Real-time tracking"}),i.jsx("span",{className:"px-3 py-1 bg-blue-500/10 text-blue-600 rounded-full text-xs font-medium",children:"Location monitoring"}),i.jsx("span",{className:"px-3 py-1 bg-purple-500/10 text-purple-600 rounded-full text-xs font-medium",children:"Quick communication"})]})]}),i.jsx("div",{className:"flex-shrink-0 ml-4",children:i.jsx(ae,{onClick:U=>{U.stopPropagation(),n("/operations/team-activity")},style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:"View Team Activity "})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsx(po,{title:"Total Submissions",value:O.total,icon:Vs}),i.jsx(po,{title:"Verified Employees",value:O.verified,icon:du}),i.jsx(po,{title:"Rejected Applications",value:O.rejected,icon:xx})]}),i.jsxs("div",{className:"bg-card p-6 rounded-2xl",children:[i.jsx(Tr,{title:"Assign Field Officer",subtitle:"Assign a field officer to an organization for a specific date."}),i.jsxs("form",{onSubmit:q,className:"grid grid-cols-1 md:grid-cols-4 gap-6 items-end",children:[i.jsx("div",{className:"md:col-span-1",children:i.jsxs(Qe,{label:"Field Officer",id:"officer",value:w,onChange:U=>j(U.target.value),children:[i.jsx("option",{value:"",children:"Select Officer"}),r.map(U=>i.jsx("option",{value:U.id,children:U.name},U.id))]})}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs(Qe,{label:"Organization/Site",id:"site",value:P,onChange:U=>k(U.target.value),children:[i.jsx("option",{value:"",children:"Select Site"}),a.map(U=>i.jsx("option",{value:U.id,children:U.shortName},U.id))]})}),i.jsx("div",{className:"md:col-span-1",children:i.jsx(Nn,{label:"Assignment Date",id:"assignmentDate",value:I,onChange:M})}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs(ae,{type:"submit",className:"w-full",children:[i.jsx(gC,{className:"mr-2 h-4 w-4"}),"Assign"]})})]})]})]})},Ore=()=>{const{user:n}=St(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(null),l=Jt("(max-width: 767px)");E.useEffect(()=>{c();const _=setInterval(c,3e4);return()=>clearInterval(_)},[n]);const c=async()=>{if(n)try{s(!0);const _=await pe.getUsers();let w=[];n.role==="admin"||n.role==="developer"?w=_.filter(I=>I.role==="operation_manager"||I.role==="field_officer"):n.role==="operation_manager"&&(w=_.filter(I=>I.role==="field_officer"&&I.reportingManagerId===n.id));const j=new Date;j.setHours(0,0,0,0);const P=new Date;P.setHours(23,59,59,999);const k=await Promise.all(w.map(async I=>{try{const D=(await pe.getAttendanceEvents(I.id,j.toISOString(),P.toISOString())).sort((X,Q)=>new Date(Q.timestamp).getTime()-new Date(X.timestamp).getTime()),O=D.filter(X=>X.type.toLowerCase().replace(/[-_\s]/g,"")==="checkin"),q=D.filter(X=>X.type.toLowerCase().replace(/[-_\s]/g,"")==="checkout"),F=O[0],U=q[0];let B=0;for(let X=0;X<q.length;X++){const Q=q[X],Y=O.find(ne=>new Date(ne.timestamp)<new Date(Q.timestamp));if(Y){const ne=new Date(Q.timestamp).getTime()-new Date(Y.timestamp).getTime();B+=ne/(1e3*60*60)}}const G=F&&(!U||new Date(F.timestamp)>new Date(U.timestamp));if(G&&F){const X=Date.now()-new Date(F.timestamp).getTime();B+=X/(1e3*60*60)}return{...I,lastCheckIn:F?.timestamp,lastCheckOut:U?.timestamp,currentLocation:F?{latitude:F.latitude||0,longitude:F.longitude||0,address:F.address||void 0}:void 0,todayWorkingHours:B,todayTravelDistance:0,isCurrentlyWorking:G,isPresent:O.length>0}}catch(M){return console.error(`Error fetching data for ${I.name}:`,M),{...I,isPresent:!1,isCurrentlyWorking:!1}}}));t(k)}catch(_){console.error("Error fetching team members:",_)}finally{s(!1)}},d=_=>{if(!_)return;const w=_.replace(/\D/g,"").slice(-10);window.location.href=`tel:+91${w}`},m=_=>{if(!_)return;const w=_.replace(/\D/g,"").slice(-10);window.location.href=`sms:+91${w}`},p=_=>{if(!_)return"0h 0m";const w=Math.floor(_),j=Math.floor((_-w)*60);return`${w}h ${j}m`};if(r)return i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})});const x=({member:_})=>i.jsx("div",{className:"bg-card border border-border rounded-xl p-4 hover:border-accent transition-all cursor-pointer",onClick:()=>o(_),children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Vi,{photoUrl:_.photoUrl,seed:_.id,className:"w-12 h-12 rounded-full"}),i.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ring-2 ring-white ${_.isCurrentlyWorking?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":_.isPresent?"bg-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.8)]":"bg-gray-400"}`})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-primary-text truncate",children:_.name}),i.jsx("p",{className:"text-xs text-muted",children:_.role.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())}),i.jsxs("div",{className:"mt-2 space-y-1",children:[i.jsx("div",{className:"flex items-center gap-2 text-xs",children:_.isCurrentlyWorking?i.jsxs(i.Fragment,{children:[i.jsx(Rh,{className:"h-3 w-3 text-green-500"}),i.jsx("span",{className:"text-green-500 font-medium",children:"Working"})]}):_.isPresent?i.jsxs(i.Fragment,{children:[i.jsx(Nk,{className:"h-3 w-3 text-yellow-500"}),i.jsx("span",{className:"text-yellow-500",children:"Checked Out"})]}):i.jsxs(i.Fragment,{children:[i.jsx(am,{className:"h-3 w-3 text-gray-400"}),i.jsx("span",{className:"text-gray-400",children:"Absent"})]})}),_.todayWorkingHours>0&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted",children:[i.jsx(Vc,{className:"h-3 w-3"}),i.jsx("span",{children:p(_.todayWorkingHours)})]})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:w=>{w.stopPropagation(),d(_.phone)},className:"hover:bg-accent/10",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:i.jsx(cu,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:w=>{w.stopPropagation(),m(_.phone)},className:"hover:bg-accent/10",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:i.jsx(om,{className:"h-4 w-4"})})]})]})}),v=({member:_})=>i.jsxs("div",{className:"bg-card border border-border rounded-xl p-6",children:[i.jsxs("div",{className:"flex items-start justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Vi,{photoUrl:_.photoUrl,seed:_.id,className:"w-16 h-16 rounded-full"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:_.name}),i.jsx("p",{className:"text-sm text-muted",children:_.role.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())})]})]}),l&&i.jsx(ae,{variant:"secondary",size:"sm",onClick:()=>o(null),children:"Close"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(xN,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Last Check In"})]}),i.jsx("p",{className:"text-sm font-bold text-primary-text",children:_.lastCheckIn?Ue(new Date(_.lastCheckIn),"hh:mm a"):"Not checked in"}),_.lastCheckIn&&i.jsx("p",{className:"text-xs text-muted mt-1",children:iu(new Date(_.lastCheckIn),{addSuffix:!0})})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(kc,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Last Check Out"})]}),i.jsx("p",{className:"text-sm font-bold text-primary-text",children:_.lastCheckOut?Ue(new Date(_.lastCheckOut),"hh:mm a"):"Not checked out"}),_.lastCheckOut&&i.jsx("p",{className:"text-xs text-muted mt-1",children:iu(new Date(_.lastCheckOut),{addSuffix:!0})})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Vc,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Working Hours Today"})]}),i.jsx("p",{className:"text-lg font-bold text-primary-text",children:p(_.todayWorkingHours)})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Rh,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Status"})]}),i.jsx("p",{className:`text-lg font-bold ${_.isCurrentlyWorking?"text-green-500":_.isPresent?"text-yellow-500":"text-gray-400"}`,children:_.isCurrentlyWorking?"Working":_.isPresent?"Checked Out":"Absent"})]})]}),_.currentLocation&&i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(wl,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Current Location"})]}),i.jsx("p",{className:"text-sm text-primary-text",children:_.currentLocation.address||"Location not available"}),_.currentLocation.latitude!==0&&i.jsx("a",{href:`https://www.google.com/maps?q=${_.currentLocation.latitude},${_.currentLocation.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-accent hover:underline mt-2 inline-block",children:"View on map "})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(ae,{onClick:()=>d(_.phone),className:"flex-1",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:[i.jsx(cu,{className:"h-4 w-4 mr-2"}),"Call"]}),i.jsxs(ae,{onClick:()=>m(_.phone),className:"flex-1",style:{backgroundColor:"#006B3F",color:"#FFFFFF"},children:[i.jsx(om,{className:"h-4 w-4 mr-2"}),"Message"]})]})]});return i.jsxs("div",{className:"p-4 lg:p-8 space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-primary-text",children:"Team Activity"}),i.jsx("p",{className:"text-sm text-muted mt-1",children:n?.role==="operation_manager"?"Monitor your field team in real-time":"Monitor all operation managers and field officers"})]}),i.jsxs(ae,{onClick:c,variant:"secondary",size:"sm",children:[i.jsx(Rh,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Sl,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Total Team"})]}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:e.length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Rh,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Working Now"})]}),i.jsx("p",{className:"text-2xl font-bold text-green-500",children:e.filter(_=>_.isCurrentlyWorking).length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Nk,{className:"h-4 w-4 text-yellow-500"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Present"})]}),i.jsx("p",{className:"text-2xl font-bold text-yellow-500",children:e.filter(_=>_.isPresent).length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(am,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Absent"})]}),i.jsx("p",{className:"text-2xl font-bold text-gray-400",children:e.filter(_=>!_.isPresent).length})]})]}),l&&a?i.jsx(v,{member:a}):i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-2 space-y-3",children:e.length===0?i.jsxs("div",{className:"bg-card border border-border rounded-xl p-12 text-center",children:[i.jsx(Sl,{className:"h-12 w-12 mx-auto text-muted mb-4 opacity-50"}),i.jsx("p",{className:"text-muted",children:"No team members found"})]}):e.map(_=>i.jsx(x,{member:_},_.id))}),!l&&a&&i.jsx("div",{className:"lg:col-span-1 sticky top-6 self-start",children:i.jsx(v,{member:a})})]})]})},Ire=({status:n})=>{if(!n)return i.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});const e={pending_sync:"sync-chip--pending_sync",synced:"sync-chip--synced",failed:"sync-chip--failed"},t={pending_sync:"Pending Sync",synced:"Synced",failed:"Failed"},r=e[n];return i.jsx("span",{className:`sync-chip ${r}`,children:t[n]})},Are=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState("all"),[o,l]=E.useState(""),[c,d]=E.useState(null),m=yn(),{user:p}=St(),x=Jt("(max-width: 767px)"),[v,_]=E.useState([]),[w,j]=E.useState(p?.organizationId),P=p&&p.role==="admin";E.useEffect(()=>{P&&pe.getOrganizations().then(O=>{_(O),O.length>0&&!w&&j(O[0].id)})},[P,w]);const k=E.useCallback(async()=>{if(!w){p?.organizationId&&r(!1);return}r(!0);try{const O=await pe.getVerificationSubmissions(s==="all"?void 0:s,w);e(O)}catch(O){console.error("Failed to fetch submissions",O)}finally{r(!1)}},[s,w,p?.organizationId]);E.useEffect(()=>{k()},[k]);const I=E.useMemo(()=>n.filter(O=>O.personal.firstName.toLowerCase().includes(o.toLowerCase())||O.personal.lastName.toLowerCase().includes(o.toLowerCase())||O.personal.employeeId.toLowerCase().includes(o.toLowerCase())),[n,o]),M=v.find(O=>O.id===w)?.shortName||p?.organizationName,D=["all","pending","verified","rejected"];return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[c&&i.jsx(Gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Site Dashboard"}),i.jsxs("p",{className:"text-muted",children:["Viewing submissions for site: ",i.jsx("span",{className:"font-semibold text-accent-dark",children:M||"N/A"})]})]}),!x&&i.jsxs("div",{className:"flex items-center gap-4",children:[P&&i.jsx("div",{className:"w-full sm:w-56",children:i.jsxs(Qe,{label:"",id:"org-selector",value:w,onChange:O=>j(O.target.value),children:[i.jsx("option",{value:"",children:"Select a Site"}),v.map(O=>i.jsx("option",{value:O.id,children:O.shortName},O.id))]})}),i.jsxs(ae,{onClick:()=>m("/onboarding/select-organization"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Pf,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]})]}),x&&i.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[P&&i.jsxs(Qe,{label:"Select Site",id:"org-selector-mobile",value:w,onChange:O=>j(O.target.value),children:[i.jsx("option",{value:"",children:"Select a Site"}),v.map(O=>i.jsx("option",{value:O.id,children:O.shortName},O.id))]}),i.jsxs(ae,{onClick:()=>m("/onboarding/select-organization"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Pf,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center my-6 gap-4",children:[i.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:i.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:D.map(O=>i.jsx("button",{onClick:()=>a(O),className:`${s===O?"border-emerald-500 text-emerald-700":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize transition-colors duration-200`,children:O},O))})}),i.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Na,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name or ID...",value:o,onChange:O=>l(O.target.value),className:"block w-full pl-10 pr-3 py-2 border border-border rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Sync"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading submissions..."})}):w?I.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No submissions found for this site."})}):I.map(O=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:[i.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[O.personal.firstName," ",O.personal.lastName]}),i.jsx("div",{className:"text-sm text-muted",children:O.personal.employeeId})]}),i.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(PC,{status:O.status})}),i.jsx("td",{"data-label":"Portal Sync",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(Ire,{status:O.portalSyncStatus})}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>m(`/onboarding/add/personal?id=${O.id}`),title:"View/Edit Details",children:i.jsx(bl,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>m(`/onboarding/pdf/${O.id}`),title:"Download Forms",children:i.jsx(Vs,{className:"h-4 w-4"})})]})})]},O.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Please select a site to view submissions."})})})]})})]})},kN=({file:n,onFileChange:e})=>{const[t,r]=E.useState(!1),[s,a]=E.useState(""),[o,l]=E.useState(!1),c=E.useCallback(async v=>{if(v&&v.type.startsWith("image/")){a("");const _={name:v.name,type:v.type,size:v.size,preview:URL.createObjectURL(v),file:v};e(_)}},[e]),d=async v=>{const _=v.target.files?.[0];_&&c(_)},m=E.useCallback(async(v,_)=>{const w=await(await fetch(`data:${_};base64,${v}`)).blob(),j=new File([w],`capture-${Date.now()}.jpg`,{type:_});c(j)},[c]),p=()=>{n&&URL.revokeObjectURL(n.preview),e(null),a("")},x="avatar-upload";return i.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[o&&i.jsx(P3,{isOpen:o,onClose:()=>l(!1),onCapture:m,captureGuidance:"profile"}),i.jsxs("div",{className:"relative w-40 h-40",children:[i.jsx("div",{className:`w-full h-full rounded-full bg-page flex items-center justify-center overflow-hidden border-2 transition-colors ${s?"border-red-500":"border-border"}`,children:t?i.jsxs("div",{className:"flex flex-col items-center text-muted",children:[i.jsx(Tt,{className:"h-8 w-8 animate-spin"}),i.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):n?.preview?i.jsx("img",{src:n.preview,alt:"Profile preview",className:"w-full h-full object-cover"}):i.jsx(Vi,{})}),n&&!t&&i.jsx("button",{type:"button",onClick:p,id:"avatar-delete-button",className:"avatar-delete-btn btn-icon absolute top-2 right-2 p-1.5 rounded-full transition-colors !bg-white/90 !text-red-600 hover:!bg-red-100","aria-label":"Remove photo",children:i.jsx(Xt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("label",{htmlFor:x,className:`cursor-pointer inline-flex items-center justify-center font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200 rounded-full bg-accent text-white hover:bg-accent-dark focus:ring-accent px-4 py-2 text-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[i.jsx(xr,{className:"w-4 h-4 mr-2"}),n?"Change":"Upload"]}),i.jsx("input",{id:x,name:x,type:"file",className:"sr-only",onChange:d,accept:"image/*",disabled:t}),i.jsxs("button",{type:"button",onClick:()=>l(!0),disabled:t,className:`avatar-capture-btn inline-flex items-center justify-center px-4 py-2 font-semibold rounded-full transition-colors duration-200 text-sm border border-red-200 !text-red-600 hover:!bg-red-50 !bg-card/70 backdrop-blur-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[i.jsx(uC,{className:"w-4 h-4 mr-2"}),"Capture"]})]}),s&&i.jsxs("p",{className:"text-xs text-red-600 text-center max-w-[160px] flex items-center gap-1",children:[i.jsx(Ca,{className:"h-3 w-3 flex-shrink-0"})," ",s]})]})},Rre=wt({name:be().required("Name is required"),email:be().email("Must be a valid email").required("Email is required"),phone:be().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number").optional().nullable()}).defined(),Lre=()=>{const{user:n,updateUserProfile:e,isCheckedIn:t,isAttendanceLoading:r,toggleCheckInStatus:s,logout:a,lastCheckInTime:o,lastCheckOutTime:l,checkAttendanceStatus:c}=St(),{permissions:d}=ka(),m=yn(),{theme:p,setTheme:x,isAutomatic:v,setAutomatic:_}=gu(),[w,j]=E.useState(!1),[P,k]=E.useState(!1),[I,M]=E.useState(null),[D,O]=E.useState("prompt"),F=Jt("(max-width: 767px)"),[U,B]=E.useState(!1),[G,X]=E.useState(!1),[Q,Y]=E.useState(null);E.useEffect(()=>{const ye=async()=>{if(!navigator.permissions?.query){O("prompt");return}try{const Ne=await navigator.permissions.query({name:"camera"}),ke=await navigator.permissions.query({name:"geolocation"});Ne.state==="granted"&&ke.state==="granted"?O("granted"):Ne.state==="denied"||ke.state==="denied"?O("denied"):O("prompt");const qe=()=>ye();Ne.onchange=qe,ke.onchange=qe}catch(Ne){console.warn("Permissions API not fully supported. Defaulting to 'prompt'.",Ne),O("prompt")}};ye()},[]);const{register:ne,handleSubmit:te,formState:{errors:ie,isDirty:$},getValues:H,trigger:se,reset:W}=Zt({resolver:_n(Rre),defaultValues:{name:n?.name||"",email:n?.email||"",phone:n?.phone||""}});E.useEffect(()=>{n&&W({name:n.name||"",email:n.email||"",phone:n.phone||""})},[n,W]);const ee=async ye=>{if(!n)return;const Ne=n.photoUrl;e({photoUrl:ye?.preview});try{let ke=null;ye&&ye.file&&(ke=await new Promise((ze,He)=>{const Be=new FileReader;Be.onloadend=()=>ze(Be.result),Be.onerror=He,Be.readAsDataURL(ye.file)}));const qe=await pe.updateUser(n.id,{photoUrl:ke});e(qe),M({message:`Profile photo ${ke?"updated":"removed"}.`,type:"success"})}catch(ke){console.error(ke),M({message:"Failed to save photo.",type:"error"}),e({photoUrl:Ne})}},K=async ye=>{if(n){j(!0);try{const Ne=await pe.updateUser(n.id,ye);e(Ne),W(ye),M({message:"Profile updated successfully!",type:"success"})}catch{M({message:"Failed to update profile.",type:"error"})}finally{j(!1)}}},oe=async()=>{k(!0);const{success:ye,message:Ne}=await s();M({message:Ne,type:ye?"success":"error"}),k(!1)},re=async()=>{X(!1),await oe(),Y(null)},me=()=>{X(!1),Y(null)},_e=P||G,le=()=>{B(!0)},fe=async()=>{if(B(!1),$){j(!0),M({message:"Saving profile changes...",type:"success"});try{if(!await se()){M({message:"Profile data is invalid. Please fix errors before logging out.",type:"error"}),j(!1);return}const Ne=H(),ke=await pe.updateUser(n.id,Ne);e(ke),W(Ne)}catch{M({message:"Failed to save profile. Logout aborted.",type:"error"}),j(!1);return}j(!1)}await a(),m("/auth/login",{replace:!0})},ue=ye=>ye?Ue(new Date(ye),"hh:mm a"):"--:--";n&&d[n.role]?.includes("manage_tasks");const ce=ye=>ye.replace(/_/g," ").replace(/\b\w/g,Ne=>Ne.toUpperCase());if(!n)return i.jsx("div",{children:"Loading user profile..."});const Se=n.photoUrl?{preview:n.photoUrl,name:"Profile Photo",type:"image/jpeg",size:0}:null;return F?i.jsxs("div",{className:"p-4 space-y-8",children:[I&&i.jsx(Gt,{message:I.message,type:I.type,onDismiss:()=>M(null)}),i.jsx(tr,{isOpen:U,onClose:()=>B(!1),onConfirm:fe,title:"Confirm Log Out",children:"Are you sure you want to log out?"}),i.jsx(tr,{isOpen:G,onClose:me,onConfirm:re,title:`Confirm ${Q==="check-in"?"Check In":"Check Out"}`,confirmButtonVariant:"primary",confirmButtonText:"Yes, Proceed",children:i.jsxs("p",{className:"text-center",children:["Are you sure you want to ",Q?.replace("-"," "),"?"]})}),i.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[i.jsx(kN,{file:Se,onFileChange:ee}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold",children:n.name}),i.jsx("p",{className:"text-muted",children:n.role.replace(/_/g," ").replace(/\b\w/g,ye=>ye.toUpperCase())})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Profile Details"}),i.jsxs("form",{onSubmit:te(K),className:"space-y-4",children:[i.jsx(Me,{label:"Full Name",id:"name",error:ie.name?.message,registration:ne("name")}),i.jsx(Me,{label:"Email Address",id:"email",type:"email",error:ie.email?.message,registration:ne("email"),readOnly:!0,className:"!bg-gray-700/50"}),i.jsx(Me,{label:"Phone Number",id:"phone",type:"tel",error:ie.phone?.message,registration:ne("phone")}),i.jsx("div",{className:"flex justify-end pt-2",children:i.jsx(ae,{type:"submit",isLoading:w,disabled:!$,children:"Save Changes"})})]})]}),i.jsxs("section",{className:"hidden md:block",children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Appearance"}),i.jsxs("div",{className:"p-4 rounded-lg bg-[#243524] border border-[#374151] space-y-4",children:[i.jsx(Cn,{id:"theme-automatic-mobile",label:"Automatic",description:"Switch themes based on screen size.",checked:v,onChange:ye=>_(ye.target.checked)}),i.jsx(Cn,{id:"theme-dark-mode-mobile",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:p==="dark",onChange:ye=>x(ye.target.checked?"dark":"light"),disabled:v})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Work Hours Tracking"}),i.jsxs("div",{className:"fo-attendance-card space-y-4",children:[i.jsxs("div",{className:"flex justify-around",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"fo-attendance-time",children:"Last Check In"}),i.jsx("p",{className:"fo-attendance-time",children:i.jsx("strong",{children:ue(o)})})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"fo-attendance-time",children:"Last Check Out"}),i.jsx("p",{className:"fo-attendance-time",children:i.jsx("strong",{children:ue(l)})})]})]}),r?i.jsx("div",{className:"flex items-center justify-center text-muted h-[56px]",children:i.jsx(Tt,{className:"h-6 w-6 animate-spin"})}):i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(ae,{onClick:()=>{Y("check-in"),X(!0)},variant:"primary",className:"flex-1 !py-4 text-lg font-bold shadow-lg transition-all rounded-2xl",disabled:t||_e,children:[i.jsx(xN,{className:"mr-3 h-6 w-6"})," Check In"]}),i.jsxs(ae,{onClick:()=>{Y("check-out"),X(!0)},variant:"danger",className:"flex-1 !py-4 text-lg font-bold shadow-lg transition-all rounded-2xl",disabled:!t||_e,children:[i.jsx(kc,{className:"mr-3 h-6 w-6"})," Check Out"]})]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"fo-section-title mb-4",children:"Account Actions"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(ae,{onClick:()=>m("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center !py-3",title:"View your leave history and balances",children:[i.jsx(mN,{className:"mr-2 h-5 w-5"})," Leave Tracker"]}),i.jsxs(ae,{onClick:le,variant:"danger",className:"w-full justify-center !py-3",children:[i.jsx(kc,{className:"mr-2 h-5 w-5"})," Log Out"]})]})]})]})]}):i.jsxs("div",{className:"w-full space-y-8",children:[I&&i.jsx(Gt,{message:I.message,type:I.type,onDismiss:()=>M(null)}),i.jsx(tr,{isOpen:U,onClose:()=>B(!1),onConfirm:fe,title:"Confirm Log Out",isConfirming:w,children:"Are you sure you want to log out? Any unsaved changes on this page will be automatically saved."}),i.jsx(tr,{isOpen:G,onClose:me,onConfirm:re,title:`Confirm ${Q==="check-in"?"Check In":"Check Out"}`,confirmButtonVariant:"primary",confirmButtonText:"Yes, Proceed",children:i.jsxs("p",{className:"text-center",children:["Are you sure you want to ",Q?.replace("-"," "),"?"]})}),i.jsxs("div",{className:"relative overflow-hidden md:bg-white md:p-6 md:rounded-2xl md:shadow-lg flex flex-col md:flex-row items-center gap-6 border border-gray-100",children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-[#006b3f] border-b-4 border-[#005632] shadow-lg"}),i.jsx("div",{className:"relative z-10",children:i.jsx(kN,{file:Se,onFileChange:ee})}),i.jsxs("div",{className:"text-center md:text-left relative z-10 flex-1 mt-16 md:mt-0",children:[i.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-primary-text tracking-tight",children:n.name}),i.jsx("div",{className:"flex items-center justify-center md:justify-start gap-2 mt-1.5",children:i.jsx("span",{className:"px-2.5 py-0.5 rounded-full bg-emerald-100 text-emerald-800 border border-emerald-200 text-xs md:text-sm font-medium",children:ce(n.role)})}),i.jsx("p",{className:"text-gray-500 mt-1.5 font-medium text-sm md:text-base",children:n.email})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[i.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-blue-50 rounded-lg",children:i.jsx(Sl,{className:"h-5 w-5 text-blue-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Profile Details"})]}),i.jsxs("form",{onSubmit:te(K),className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[i.jsx(Me,{label:"Full Name",id:"name",error:ie.name?.message,registration:ne("name"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),i.jsx(Me,{label:"Phone Number",id:"phone",type:"tel",error:ie.phone?.message,registration:ne("phone"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(Me,{label:"Email Address",id:"email",type:"email",error:ie.email?.message,registration:ne("email"),readOnly:!0,className:"bg-gray-100/50 text-gray-500 cursor-not-allowed border-gray-200"})})]}),i.jsx("div",{className:"flex justify-end pt-3 border-t border-gray-100",children:i.jsx(ae,{type:"submit",isLoading:w,disabled:!$,className:"px-6",children:"Save Changes"})})]})]}),i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-purple-50 rounded-lg",children:i.jsx(MF,{className:"h-5 w-5 text-purple-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Work Hours Tracking"})]}),i.jsxs("div",{className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[i.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[i.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check In"}),i.jsx("p",{className:"text-2xl md:text-3xl font-bold text-emerald-600",children:ue(o)})]}),i.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[i.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check Out"}),i.jsx("p",{className:"text-2xl md:text-3xl font-bold text-rose-600",children:ue(l)})]})]}),r?i.jsx("div",{className:"flex items-center justify-center h-[56px] bg-gray-50 rounded-xl",children:i.jsx(Tt,{className:"h-6 w-6 animate-spin text-gray-400"})}):i.jsxs("div",{className:"flex gap-4",children:[i.jsxs(ae,{onClick:()=>{Y("check-in"),X(!0)},variant:"primary",className:"flex-1 !py-3 text-base md:text-lg shadow-lg shadow-emerald-100 hover:shadow-emerald-200 transition-all",disabled:t||_e,children:[i.jsx(xN,{className:"mr-2 h-5 w-5"})," Check In"]}),i.jsxs(ae,{onClick:()=>{Y("check-out"),X(!0)},variant:"danger",className:"flex-1 !py-3 text-base md:text-lg shadow-lg shadow-red-100 hover:shadow-red-200 transition-all",disabled:!t||_e,children:[i.jsx(kc,{className:"mr-2 h-5 w-5"})," Check Out"]})]})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Appearance"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:i.jsx(Cn,{id:"theme-automatic-desktop",label:"Automatic",description:"Switch themes based on screen size.",checked:v,onChange:ye=>_(ye.target.checked)})}),i.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:i.jsx(Cn,{id:"theme-dark-mode-desktop",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:p==="dark",onChange:ye=>x(ye.target.checked?"dark":"light"),disabled:v})})]})]}),i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Account Actions"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs(ae,{onClick:()=>m("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center py-3 bg-gray-50 hover:bg-gray-100 border-gray-200",title:"View your leave history and balances",children:[i.jsx(mN,{className:"mr-2 h-4 w-4"})," Leave Tracker"]}),i.jsxs(ae,{onClick:le,variant:"danger",className:"w-full justify-center py-3",isLoading:w,children:[i.jsx(kc,{className:"mr-2 h-4 w-4"})," Log Out"]})]})]})]})]})]})};function Nm(n){return n+.5|0}const Ec=(n,e,t)=>Math.max(Math.min(n,t),e);function Lh(n){return Ec(Nm(n*2.55),0,255)}function Fc(n){return Ec(Nm(n*255),0,255)}function hl(n){return Ec(Nm(n/2.55)/100,0,1)}function XA(n){return Ec(Nm(n*100),0,100)}const Li={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},EN=[..."0123456789ABCDEF"],Fre=n=>EN[n&15],qre=n=>EN[(n&240)>>4]+EN[n&15],Ng=n=>(n&240)>>4===(n&15),zre=n=>Ng(n.r)&&Ng(n.g)&&Ng(n.b)&&Ng(n.a);function Ure(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&Li[n[1]]*17,g:255&Li[n[2]]*17,b:255&Li[n[3]]*17,a:e===5?Li[n[4]]*17:255}:(e===7||e===9)&&(t={r:Li[n[1]]<<4|Li[n[2]],g:Li[n[3]]<<4|Li[n[4]],b:Li[n[5]]<<4|Li[n[6]],a:e===9?Li[n[7]]<<4|Li[n[8]]:255})),t}const Vre=(n,e)=>n<255?e(n):"";function Bre(n){var e=zre(n)?Fre:qre;return n?"#"+e(n.r)+e(n.g)+e(n.b)+Vre(n.a,e):void 0}const Wre=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function D5(n,e,t){const r=e*Math.min(t,1-t),s=(a,o=(a+n/30)%12)=>t-r*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function $re(n,e,t){const r=(s,a=(s+n/60)%6)=>t-t*e*Math.max(Math.min(a,4-a,1),0);return[r(5),r(3),r(1)]}function Hre(n,e,t){const r=D5(n,1,.5);let s;for(e+t>1&&(s=1/(e+t),e*=s,t*=s),s=0;s<3;s++)r[s]*=1-e-t,r[s]+=e;return r}function Yre(n,e,t,r,s){return n===s?(e-t)/r+(e<t?6:0):e===s?(t-n)/r+2:(n-e)/r+4}function ZC(n){const t=n.r/255,r=n.g/255,s=n.b/255,a=Math.max(t,r,s),o=Math.min(t,r,s),l=(a+o)/2;let c,d,m;return a!==o&&(m=a-o,d=l>.5?m/(2-a-o):m/(a+o),c=Yre(t,r,s,m,a),c=c*60+.5),[c|0,d||0,l]}function KC(n,e,t,r){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,r)).map(Fc)}function JC(n,e,t){return KC(D5,n,e,t)}function Gre(n,e,t){return KC(Hre,n,e,t)}function Zre(n,e,t){return KC($re,n,e,t)}function O5(n){return(n%360+360)%360}function Kre(n){const e=Wre.exec(n);let t=255,r;if(!e)return;e[5]!==r&&(t=e[6]?Lh(+e[5]):Fc(+e[5]));const s=O5(+e[2]),a=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=Gre(s,a,o):e[1]==="hsv"?r=Zre(s,a,o):r=JC(s,a,o),{r:r[0],g:r[1],b:r[2],a:t}}function Jre(n,e){var t=ZC(n);t[0]=O5(t[0]+e),t=JC(t),n.r=t[0],n.g=t[1],n.b=t[2]}function Qre(n){if(!n)return;const e=ZC(n),t=e[0],r=XA(e[1]),s=XA(e[2]);return n.a<255?`hsla(${t}, ${r}%, ${s}%, ${hl(n.a)})`:`hsl(${t}, ${r}%, ${s}%)`}const eR={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},tR={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Xre(){const n={},e=Object.keys(tR),t=Object.keys(eR);let r,s,a,o,l;for(r=0;r<e.length;r++){for(o=l=e[r],s=0;s<t.length;s++)a=t[s],l=l.replace(a,eR[a]);a=parseInt(tR[o],16),n[l]=[a>>16&255,a>>8&255,a&255]}return n}let Cg;function ese(n){Cg||(Cg=Xre(),Cg.transparent=[0,0,0,0]);const e=Cg[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const tse=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function nse(n){const e=tse.exec(n);let t=255,r,s,a;if(e){if(e[7]!==r){const o=+e[7];t=e[8]?Lh(o):Ec(o*255,0,255)}return r=+e[1],s=+e[3],a=+e[5],r=255&(e[2]?Lh(r):Ec(r,0,255)),s=255&(e[4]?Lh(s):Ec(s,0,255)),a=255&(e[6]?Lh(a):Ec(a,0,255)),{r,g:s,b:a,a:t}}}function rse(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${hl(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const lj=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Qu=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function sse(n,e,t){const r=Qu(hl(n.r)),s=Qu(hl(n.g)),a=Qu(hl(n.b));return{r:Fc(lj(r+t*(Qu(hl(e.r))-r))),g:Fc(lj(s+t*(Qu(hl(e.g))-s))),b:Fc(lj(a+t*(Qu(hl(e.b))-a))),a:n.a+t*(e.a-n.a)}}function Tg(n,e,t){if(n){let r=ZC(n);r[e]=Math.max(0,Math.min(r[e]+r[e]*t,e===0?360:1)),r=JC(r),n.r=r[0],n.g=r[1],n.b=r[2]}}function I5(n,e){return n&&Object.assign(e||{},n)}function nR(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Fc(n[3]))):(e=I5(n,{r:0,g:0,b:0,a:1}),e.a=Fc(e.a)),e}function ise(n){return n.charAt(0)==="r"?nse(n):Kre(n)}class cm{constructor(e){if(e instanceof cm)return e;const t=typeof e;let r;t==="object"?r=nR(e):t==="string"&&(r=Ure(e)||ese(e)||ise(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=I5(this._rgb);return e&&(e.a=hl(e.a)),e}set rgb(e){this._rgb=nR(e)}rgbString(){return this._valid?rse(this._rgb):void 0}hexString(){return this._valid?Bre(this._rgb):void 0}hslString(){return this._valid?Qre(this._rgb):void 0}mix(e,t){if(e){const r=this.rgb,s=e.rgb;let a;const o=t===a?.5:t,l=2*o-1,c=r.a-s.a,d=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;a=1-d,r.r=255&d*r.r+a*s.r+.5,r.g=255&d*r.g+a*s.g+.5,r.b=255&d*r.b+a*s.b+.5,r.a=o*r.a+(1-o)*s.a,this.rgb=r}return this}interpolate(e,t){return e&&(this._rgb=sse(this._rgb,e._rgb,t)),this}clone(){return new cm(this.rgb)}alpha(e){return this._rgb.a=Fc(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Nm(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Tg(this._rgb,2,e),this}darken(e){return Tg(this._rgb,2,-e),this}saturate(e){return Tg(this._rgb,1,e),this}desaturate(e){return Tg(this._rgb,1,-e),this}rotate(e){return Jre(this._rgb,e),this}}function ol(){}const ase=(()=>{let n=0;return()=>n++})();function mn(n){return n==null}function Nr(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Qt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function as(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function ao(n,e){return as(n)?n:e}function Bt(n,e){return typeof n>"u"?e:n}const ose=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,A5=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Fn(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function xn(n,e,t,r){let s,a,o;if(Nr(n))for(a=n.length,s=0;s<a;s++)e.call(t,n[s],s);else if(Qt(n))for(o=Object.keys(n),a=o.length,s=0;s<a;s++)e.call(t,n[o[s]],o[s])}function Sx(n,e){let t,r,s,a;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(s=n[t],a=e[t],s.datasetIndex!==a.datasetIndex||s.index!==a.index)return!1;return!0}function jx(n){if(Nr(n))return n.map(jx);if(Qt(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let s=0;for(;s<r;++s)e[t[s]]=jx(n[t[s]]);return e}return n}function R5(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function lse(n,e,t,r){if(!R5(n))return;const s=e[n],a=t[n];Qt(s)&&Qt(a)?dm(s,a,r):e[n]=jx(a)}function dm(n,e,t){const r=Nr(e)?e:[e],s=r.length;if(!Qt(n))return n;t=t||{};const a=t.merger||lse;let o;for(let l=0;l<s;++l){if(o=r[l],!Qt(o))continue;const c=Object.keys(o);for(let d=0,m=c.length;d<m;++d)a(c[d],n,o,t)}return n}function Hh(n,e){return dm(n,e,{merger:cse})}function cse(n,e,t){if(!R5(n))return;const r=e[n],s=t[n];Qt(r)&&Qt(s)?Hh(r,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=jx(s))}const rR={"":n=>n,x:n=>n.x,y:n=>n.y};function dse(n){const e=n.split("."),t=[];let r="";for(const s of e)r+=s,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}function use(n){const e=dse(n);return t=>{for(const r of e){if(r==="")break;t=t&&t[r]}return t}}function uu(n,e){return(rR[e]||(rR[e]=use(e)))(n)}function QC(n){return n.charAt(0).toUpperCase()+n.slice(1)}const um=n=>typeof n<"u",Wc=n=>typeof n=="function",sR=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function fse(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Tn=Math.PI,Jn=2*Tn,hse=Jn+Tn,Nx=Number.POSITIVE_INFINITY,mse=Tn/180,Cr=Tn/2,Ud=Tn/4,iR=Tn*2/3,L5=Math.log10,xo=Math.sign;function Yh(n,e,t){return Math.abs(n-e)<t}function aR(n){const e=Math.round(n);n=Yh(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(L5(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function pse(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r===0&&(e.push(r),e.push(n/r));return t===(t|0)&&e.push(t),e.sort((s,a)=>s-a).pop(),e}function gse(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function fm(n){return!gse(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function xse(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function yse(n,e,t){let r,s,a;for(r=0,s=n.length;r<s;r++)a=n[r][t],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function pl(n){return n*(Tn/180)}function vse(n){return n*(180/Tn)}function oR(n){if(!as(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function F5(n,e){const t=e.x-n.x,r=e.y-n.y,s=Math.sqrt(t*t+r*r);let a=Math.atan2(r,t);return a<-.5*Tn&&(a+=Jn),{angle:a,distance:s}}function DN(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function bse(n,e){return(n-e+hse)%Jn-Tn}function oi(n){return(n%Jn+Jn)%Jn}function hm(n,e,t,r){const s=oi(n),a=oi(e),o=oi(t),l=oi(a-s),c=oi(o-s),d=oi(s-a),m=oi(s-o);return s===a||s===o||r&&a===o||l>c&&d<m}function ss(n,e,t){return Math.max(e,Math.min(t,n))}function _se(n){return ss(n,-32768,32767)}function gl(n,e,t,r=1e-6){return n>=Math.min(e,t)-r&&n<=Math.max(e,t)+r}function XC(n,e,t){t=t||(o=>n[o]<e);let r=n.length-1,s=0,a;for(;r-s>1;)a=s+r>>1,t(a)?s=a:r=a;return{lo:s,hi:r}}const tu=(n,e,t,r)=>XC(n,t,r?s=>{const a=n[s][e];return a<t||a===t&&n[s+1][e]===t}:s=>n[s][e]<t),wse=(n,e,t)=>XC(n,t,r=>n[r][e]>=t);function Sse(n,e,t){let r=0,s=n.length;for(;r<s&&n[r]<e;)r++;for(;s>r&&n[s-1]>t;)s--;return r>0||s<n.length?n.slice(r,s):n}const q5=["push","pop","shift","splice","unshift"];function jse(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),q5.forEach(t=>{const r="_onData"+QC(t),s=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...a){const o=s.apply(this,a);return n._chartjs.listeners.forEach(l=>{typeof l[r]=="function"&&l[r](...a)}),o}})})}function lR(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,s=r.indexOf(e);s!==-1&&r.splice(s,1),!(r.length>0)&&(q5.forEach(a=>{delete n[a]}),delete n._chartjs)}function z5(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const U5=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function V5(n,e){let t=[],r=!1;return function(...s){t=s,r||(r=!0,U5.call(window,()=>{r=!1,n.apply(e,t)}))}}function Nse(n,e){let t;return function(...r){return e?(clearTimeout(t),t=setTimeout(n,e,r)):n.apply(this,r),e}}const B5=n=>n==="start"?"left":n==="end"?"right":"center",ii=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,Cse=(n,e,t,r)=>n===(r?"left":"right")?t:n==="center"?(e+t)/2:e;function Tse(n,e,t){const r=e.length;let s=0,a=r;if(n._sorted){const{iScale:o,vScale:l,_parsed:c}=n,d=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,m=o.axis,{min:p,max:x,minDefined:v,maxDefined:_}=o.getUserBounds();if(v){if(s=Math.min(tu(c,m,p).lo,t?r:tu(e,m,o.getPixelForValue(p)).lo),d){const w=c.slice(0,s+1).reverse().findIndex(j=>!mn(j[l.axis]));s-=Math.max(0,w)}s=ss(s,0,r-1)}if(_){let w=Math.max(tu(c,o.axis,x,!0).hi+1,t?0:tu(e,m,o.getPixelForValue(x),!0).hi+1);if(d){const j=c.slice(w-1).findIndex(P=>!mn(P[l.axis]));w+=Math.max(0,j)}a=ss(w,s,r)-s}else a=r-s}return{start:s,count:a}}function Pse(n){const{xScale:e,yScale:t,_scaleRanges:r}=n,s={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!r)return n._scaleRanges=s,!0;const a=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,s),a}const Pg=n=>n===0||n===1,cR=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Jn/t)),dR=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Jn/t)+1,Gh={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Cr)+1,easeOutSine:n=>Math.sin(n*Cr),easeInOutSine:n=>-.5*(Math.cos(Tn*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Pg(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Pg(n)?n:cR(n,.075,.3),easeOutElastic:n=>Pg(n)?n:dR(n,.075,.3),easeInOutElastic(n){return Pg(n)?n:n<.5?.5*cR(n*2,.1125,.45):.5+.5*dR(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Gh.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Gh.easeInBounce(n*2)*.5:Gh.easeOutBounce(n*2-1)*.5+.5};function e1(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function uR(n){return e1(n)?n:new cm(n)}function cj(n){return e1(n)?n:new cm(n).saturate(.5).darken(.1).hexString()}const Mse=["x","y","borderWidth","radius","tension"],kse=["color","borderColor","backgroundColor"];function Ese(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:kse},numbers:{type:"number",properties:Mse}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Dse(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const fR=new Map;function Ose(n,e){e=e||{};const t=n+JSON.stringify(e);let r=fR.get(t);return r||(r=new Intl.NumberFormat(n,e),fR.set(t,r)),r}function t1(n,e,t){return Ose(e,t).format(n)}const Ise={values(n){return Nr(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const r=this.chart.options.locale;let s,a=n;if(t.length>1){const d=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(d<1e-4||d>1e15)&&(s="scientific"),a=Ase(n,t)}const o=L5(Math.abs(a)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:s,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),t1(n,r,c)}};function Ase(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var W5={formatters:Ise};function Rse(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:W5.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const fu=Object.create(null),ON=Object.create(null);function Zh(n,e){if(!e)return n;const t=e.split(".");for(let r=0,s=t.length;r<s;++r){const a=t[r];n=n[a]||(n[a]=Object.create(null))}return n}function dj(n,e,t){return typeof e=="string"?dm(Zh(n,e),t):dm(Zh(n,""),e)}class Lse{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,s)=>cj(s.backgroundColor),this.hoverBorderColor=(r,s)=>cj(s.borderColor),this.hoverColor=(r,s)=>cj(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return dj(this,e,t)}get(e){return Zh(this,e)}describe(e,t){return dj(ON,e,t)}override(e,t){return dj(fu,e,t)}route(e,t,r,s){const a=Zh(this,e),o=Zh(this,r),l="_"+t;Object.defineProperties(a,{[l]:{value:a[t],writable:!0},[t]:{enumerable:!0,get(){const c=this[l],d=o[s];return Qt(c)?Object.assign({},d,c):Bt(c,d)},set(c){this[l]=c}}})}apply(e){e.forEach(t=>t(this))}}var or=new Lse({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Ese,Dse,Rse]);function Fse(n){return!n||mn(n.size)||mn(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function hR(n,e,t,r,s){let a=e[s];return a||(a=e[s]=n.measureText(s).width,t.push(s)),a>r&&(r=a),r}function Vd(n,e,t){const r=n.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*r)/r+s}function mR(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function IN(n,e,t,r){$5(n,e,t,r,null)}function $5(n,e,t,r,s){let a,o,l,c,d,m,p,x;const v=e.pointStyle,_=e.rotation,w=e.radius;let j=(_||0)*mse;if(v&&typeof v=="object"&&(a=v.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){n.save(),n.translate(t,r),n.rotate(j),n.drawImage(v,-v.width/2,-v.height/2,v.width,v.height),n.restore();return}if(!(isNaN(w)||w<=0)){switch(n.beginPath(),v){default:s?n.ellipse(t,r,s/2,w,0,0,Jn):n.arc(t,r,w,0,Jn),n.closePath();break;case"triangle":m=s?s/2:w,n.moveTo(t+Math.sin(j)*m,r-Math.cos(j)*w),j+=iR,n.lineTo(t+Math.sin(j)*m,r-Math.cos(j)*w),j+=iR,n.lineTo(t+Math.sin(j)*m,r-Math.cos(j)*w),n.closePath();break;case"rectRounded":d=w*.516,c=w-d,o=Math.cos(j+Ud)*c,p=Math.cos(j+Ud)*(s?s/2-d:c),l=Math.sin(j+Ud)*c,x=Math.sin(j+Ud)*(s?s/2-d:c),n.arc(t-p,r-l,d,j-Tn,j-Cr),n.arc(t+x,r-o,d,j-Cr,j),n.arc(t+p,r+l,d,j,j+Cr),n.arc(t-x,r+o,d,j+Cr,j+Tn),n.closePath();break;case"rect":if(!_){c=Math.SQRT1_2*w,m=s?s/2:c,n.rect(t-m,r-c,2*m,2*c);break}j+=Ud;case"rectRot":p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+x,r-o),n.lineTo(t+p,r+l),n.lineTo(t-x,r+o),n.closePath();break;case"crossRot":j+=Ud;case"cross":p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o);break;case"star":p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o),j+=Ud,p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o);break;case"line":o=s?s/2:Math.cos(j)*w,l=Math.sin(j)*w,n.moveTo(t-o,r-l),n.lineTo(t+o,r+l);break;case"dash":n.moveTo(t,r),n.lineTo(t+Math.cos(j)*(s?s/2:w),r+Math.sin(j)*w);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function mm(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function my(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function py(n){n.restore()}function qse(n,e,t,r,s){if(!e)return n.lineTo(t.x,t.y);if(s==="middle"){const a=(e.x+t.x)/2;n.lineTo(a,e.y),n.lineTo(a,t.y)}else s==="after"!=!!r?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function zse(n,e,t,r){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function Use(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),mn(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function Vse(n,e,t,r,s){if(s.strikethrough||s.underline){const a=n.measureText(r),o=e-a.actualBoundingBoxLeft,l=e+a.actualBoundingBoxRight,c=t-a.actualBoundingBoxAscent,d=t+a.actualBoundingBoxDescent,m=s.strikethrough?(c+d)/2:d;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(o,m),n.lineTo(l,m),n.stroke()}}function Bse(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Cx(n,e,t,r,s,a={}){const o=Nr(e)?e:[e],l=a.strokeWidth>0&&a.strokeColor!=="";let c,d;for(n.save(),n.font=s.string,Use(n,a),c=0;c<o.length;++c)d=o[c],a.backdrop&&Bse(n,a.backdrop),l&&(a.strokeColor&&(n.strokeStyle=a.strokeColor),mn(a.strokeWidth)||(n.lineWidth=a.strokeWidth),n.strokeText(d,t,r,a.maxWidth)),n.fillText(d,t,r,a.maxWidth),Vse(n,t,r,d,a),r+=Number(s.lineHeight);n.restore()}function Tx(n,e){const{x:t,y:r,w:s,h:a,radius:o}=e;n.arc(t+o.topLeft,r+o.topLeft,o.topLeft,1.5*Tn,Tn,!0),n.lineTo(t,r+a-o.bottomLeft),n.arc(t+o.bottomLeft,r+a-o.bottomLeft,o.bottomLeft,Tn,Cr,!0),n.lineTo(t+s-o.bottomRight,r+a),n.arc(t+s-o.bottomRight,r+a-o.bottomRight,o.bottomRight,Cr,0,!0),n.lineTo(t+s,r+o.topRight),n.arc(t+s-o.topRight,r+o.topRight,o.topRight,0,-Cr,!0),n.lineTo(t+o.topLeft,r)}const Wse=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,$se=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Hse(n,e){const t=(""+n).match(Wse);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const Yse=n=>+n||0;function n1(n,e){const t={},r=Qt(e),s=r?Object.keys(e):e,a=Qt(n)?r?o=>Bt(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of s)t[o]=Yse(a(o));return t}function H5(n){return n1(n,{top:"y",right:"x",bottom:"y",left:"x"})}function hf(n){return n1(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Pa(n){const e=H5(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Us(n,e){n=n||{},e=e||or.font;let t=Bt(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let r=Bt(n.style,e.style);r&&!(""+r).match($se)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const s={family:Bt(n.family,e.family),lineHeight:Hse(Bt(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:Bt(n.weight,e.weight),string:""};return s.string=Fse(s),s}function Mg(n,e,t,r){let s,a,o;for(s=0,a=n.length;s<a;++s)if(o=n[s],o!==void 0&&o!==void 0)return o}function Gse(n,e,t){const{min:r,max:s}=n,a=A5(e,(s-r)/2),o=(l,c)=>t&&l===0?0:l+c;return{min:o(r,-Math.abs(a)),max:o(s,a)}}function wu(n,e){return Object.assign(Object.create(n),e)}function r1(n,e=[""],t,r,s=()=>n[0]){const a=t||n;typeof r>"u"&&(r=K5("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:a,_fallback:r,_getTarget:s,override:l=>r1([l,...n],e,a,r)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete n[0][c],!0},get(l,c){return G5(l,c,()=>nie(c,e,n,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(l,c){return gR(l).includes(c)},ownKeys(l){return gR(l)},set(l,c,d){const m=l._storage||(l._storage=s());return l[c]=m[c]=d,delete l._keys,!0}})}function kf(n,e,t,r){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:Y5(n,r),setContext:a=>kf(n,a,t,r),override:a=>kf(n.override(a),e,t,r)};return new Proxy(s,{deleteProperty(a,o){return delete a[o],delete n[o],!0},get(a,o,l){return G5(a,o,()=>Kse(a,o,l))},getOwnPropertyDescriptor(a,o){return a._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(a,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(a,o,l){return n[o]=l,delete a[o],!0}})}function Y5(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:t,indexable:r,isScriptable:Wc(t)?t:()=>t,isIndexable:Wc(r)?r:()=>r}}const Zse=(n,e)=>n?n+QC(e):e,s1=(n,e)=>Qt(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function G5(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const r=t();return n[e]=r,r}function Kse(n,e,t){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=n;let l=r[e];return Wc(l)&&o.isScriptable(e)&&(l=Jse(e,l,n,t)),Nr(l)&&l.length&&(l=Qse(e,l,n,o.isIndexable)),s1(e,l)&&(l=kf(l,s,a&&a[e],o)),l}function Jse(n,e,t,r){const{_proxy:s,_context:a,_subProxy:o,_stack:l}=t;if(l.has(n))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+n);l.add(n);let c=e(a,o||r);return l.delete(n),s1(n,c)&&(c=i1(s._scopes,s,n,c)),c}function Qse(n,e,t,r){const{_proxy:s,_context:a,_subProxy:o,_descriptors:l}=t;if(typeof a.index<"u"&&r(n))return e[a.index%e.length];if(Qt(e[0])){const c=e,d=s._scopes.filter(m=>m!==c);e=[];for(const m of c){const p=i1(d,s,n,m);e.push(kf(p,a,o&&o[n],l))}}return e}function Z5(n,e,t){return Wc(n)?n(e,t):n}const Xse=(n,e)=>n===!0?e:typeof n=="string"?uu(e,n):void 0;function eie(n,e,t,r,s){for(const a of e){const o=Xse(t,a);if(o){n.add(o);const l=Z5(o._fallback,t,s);if(typeof l<"u"&&l!==t&&l!==r)return l}else if(o===!1&&typeof r<"u"&&t!==r)return null}return!1}function i1(n,e,t,r){const s=e._rootScopes,a=Z5(e._fallback,t,r),o=[...n,...s],l=new Set;l.add(r);let c=pR(l,o,t,a||t,r);return c===null||typeof a<"u"&&a!==t&&(c=pR(l,o,a,c,r),c===null)?!1:r1(Array.from(l),[""],s,a,()=>tie(e,t,r))}function pR(n,e,t,r,s){for(;t;)t=eie(n,e,t,r,s);return t}function tie(n,e,t){const r=n._getTarget();e in r||(r[e]={});const s=r[e];return Nr(s)&&Qt(t)?t:s||{}}function nie(n,e,t,r){let s;for(const a of e)if(s=K5(Zse(a,n),t),typeof s<"u")return s1(n,s)?i1(t,r,n,s):s}function K5(n,e){for(const t of e){if(!t)continue;const r=t[n];if(typeof r<"u")return r}}function gR(n){let e=n._keys;return e||(e=n._keys=rie(n._scopes)),e}function rie(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(r);return Array.from(e)}const sie=Number.EPSILON||1e-14,Ef=(n,e)=>e<n.length&&!n[e].skip&&n[e],J5=n=>n==="x"?"y":"x";function iie(n,e,t,r){const s=n.skip?e:n,a=e,o=t.skip?e:t,l=DN(a,s),c=DN(o,a);let d=l/(l+c),m=c/(l+c);d=isNaN(d)?0:d,m=isNaN(m)?0:m;const p=r*d,x=r*m;return{previous:{x:a.x-p*(o.x-s.x),y:a.y-p*(o.y-s.y)},next:{x:a.x+x*(o.x-s.x),y:a.y+x*(o.y-s.y)}}}function aie(n,e,t){const r=n.length;let s,a,o,l,c,d=Ef(n,0);for(let m=0;m<r-1;++m)if(c=d,d=Ef(n,m+1),!(!c||!d)){if(Yh(e[m],0,sie)){t[m]=t[m+1]=0;continue}s=t[m]/e[m],a=t[m+1]/e[m],l=Math.pow(s,2)+Math.pow(a,2),!(l<=9)&&(o=3/Math.sqrt(l),t[m]=s*o*e[m],t[m+1]=a*o*e[m])}}function oie(n,e,t="x"){const r=J5(t),s=n.length;let a,o,l,c=Ef(n,0);for(let d=0;d<s;++d){if(o=l,l=c,c=Ef(n,d+1),!l)continue;const m=l[t],p=l[r];o&&(a=(m-o[t])/3,l[`cp1${t}`]=m-a,l[`cp1${r}`]=p-a*e[d]),c&&(a=(c[t]-m)/3,l[`cp2${t}`]=m+a,l[`cp2${r}`]=p+a*e[d])}}function lie(n,e="x"){const t=J5(e),r=n.length,s=Array(r).fill(0),a=Array(r);let o,l,c,d=Ef(n,0);for(o=0;o<r;++o)if(l=c,c=d,d=Ef(n,o+1),!!c){if(d){const m=d[e]-c[e];s[o]=m!==0?(d[t]-c[t])/m:0}a[o]=l?d?xo(s[o-1])!==xo(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}aie(n,s,a),oie(n,a,e)}function kg(n,e,t){return Math.max(Math.min(n,t),e)}function cie(n,e){let t,r,s,a,o,l=mm(n[0],e);for(t=0,r=n.length;t<r;++t)o=a,a=l,l=t<r-1&&mm(n[t+1],e),a&&(s=n[t],o&&(s.cp1x=kg(s.cp1x,e.left,e.right),s.cp1y=kg(s.cp1y,e.top,e.bottom)),l&&(s.cp2x=kg(s.cp2x,e.left,e.right),s.cp2y=kg(s.cp2y,e.top,e.bottom)))}function die(n,e,t,r,s){let a,o,l,c;if(e.spanGaps&&(n=n.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")lie(n,s);else{let d=r?n[n.length-1]:n[0];for(a=0,o=n.length;a<o;++a)l=n[a],c=iie(d,l,n[Math.min(a+1,o-(r?0:1))%o],e.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,d=l}e.capBezierPoints&&cie(n,t)}function a1(){return typeof window<"u"&&typeof document<"u"}function o1(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Px(n,e,t){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*e.parentNode[t])):r=n,r}const gy=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function uie(n,e){return gy(n).getPropertyValue(e)}const fie=["top","right","bottom","left"];function su(n,e,t){const r={};t=t?"-"+t:"";for(let s=0;s<4;s++){const a=fie[s];r[a]=parseFloat(n[e+"-"+a+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const hie=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function mie(n,e){const t=n.touches,r=t&&t.length?t[0]:n,{offsetX:s,offsetY:a}=r;let o=!1,l,c;if(hie(s,a,n.target))l=s,c=a;else{const d=e.getBoundingClientRect();l=r.clientX-d.left,c=r.clientY-d.top,o=!0}return{x:l,y:c,box:o}}function Gd(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:r}=e,s=gy(t),a=s.boxSizing==="border-box",o=su(s,"padding"),l=su(s,"border","width"),{x:c,y:d,box:m}=mie(n,t),p=o.left+(m&&l.left),x=o.top+(m&&l.top);let{width:v,height:_}=e;return a&&(v-=o.width+l.width,_-=o.height+l.height),{x:Math.round((c-p)/v*t.width/r),y:Math.round((d-x)/_*t.height/r)}}function pie(n,e,t){let r,s;if(e===void 0||t===void 0){const a=n&&o1(n);if(!a)e=n.clientWidth,t=n.clientHeight;else{const o=a.getBoundingClientRect(),l=gy(a),c=su(l,"border","width"),d=su(l,"padding");e=o.width-d.width-c.width,t=o.height-d.height-c.height,r=Px(l.maxWidth,a,"clientWidth"),s=Px(l.maxHeight,a,"clientHeight")}}return{width:e,height:t,maxWidth:r||Nx,maxHeight:s||Nx}}const Dc=n=>Math.round(n*10)/10;function gie(n,e,t,r){const s=gy(n),a=su(s,"margin"),o=Px(s.maxWidth,n,"clientWidth")||Nx,l=Px(s.maxHeight,n,"clientHeight")||Nx,c=pie(n,e,t);let{width:d,height:m}=c;if(s.boxSizing==="content-box"){const x=su(s,"border","width"),v=su(s,"padding");d-=v.width+x.width,m-=v.height+x.height}return d=Math.max(0,d-a.width),m=Math.max(0,r?d/r:m-a.height),d=Dc(Math.min(d,o,c.maxWidth)),m=Dc(Math.min(m,l,c.maxHeight)),d&&!m&&(m=Dc(d/2)),(e!==void 0||t!==void 0)&&r&&c.height&&m>c.height&&(m=c.height,d=Dc(Math.floor(m*r))),{width:d,height:m}}function xR(n,e,t){const r=e||1,s=Dc(n.height*r),a=Dc(n.width*r);n.height=Dc(n.height),n.width=Dc(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==r||o.height!==s||o.width!==a?(n.currentDevicePixelRatio=r,o.height=s,o.width=a,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const xie=(function(){let n=!1;try{const e={get passive(){return n=!0,!1}};a1()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n})();function yR(n,e){const t=uie(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Zd(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function yie(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:r==="middle"?t<.5?n.y:e.y:r==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function vie(n,e,t,r){const s={x:n.cp2x,y:n.cp2y},a={x:e.cp1x,y:e.cp1y},o=Zd(n,s,t),l=Zd(s,a,t),c=Zd(a,e,t),d=Zd(o,l,t),m=Zd(l,c,t);return Zd(d,m,t)}const bie=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,r){return t-r},leftForLtr(t,r){return t-r}}},_ie=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function mf(n,e,t){return n?bie(e,t):_ie()}function Q5(n,e){let t,r;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=r)}function X5(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function e6(n){return n==="angle"?{between:hm,compare:bse,normalize:oi}:{between:gl,compare:(e,t)=>e-t,normalize:e=>e}}function vR({start:n,end:e,count:t,loop:r,style:s}){return{start:n%t,end:e%t,loop:r&&(e-n+1)%t===0,style:s}}function wie(n,e,t){const{property:r,start:s,end:a}=t,{between:o,normalize:l}=e6(r),c=e.length;let{start:d,end:m,loop:p}=n,x,v;if(p){for(d+=c,m+=c,x=0,v=c;x<v&&o(l(e[d%c][r]),s,a);++x)d--,m--;d%=c,m%=c}return m<d&&(m+=c),{start:d,end:m,loop:p,style:n.style}}function t6(n,e,t){if(!t)return[n];const{property:r,start:s,end:a}=t,o=e.length,{compare:l,between:c,normalize:d}=e6(r),{start:m,end:p,loop:x,style:v}=wie(n,e,t),_=[];let w=!1,j=null,P,k,I;const M=()=>c(s,I,P)&&l(s,I)!==0,D=()=>l(a,P)===0||c(a,I,P),O=()=>w||M(),q=()=>!w||D();for(let F=m,U=m;F<=p;++F)k=e[F%o],!k.skip&&(P=d(k[r]),P!==I&&(w=c(P,s,a),j===null&&O()&&(j=l(P,s)===0?F:U),j!==null&&q()&&(_.push(vR({start:j,end:F,loop:x,count:o,style:v})),j=null),U=F,I=P));return j!==null&&_.push(vR({start:j,end:p,loop:x,count:o,style:v})),_}function n6(n,e){const t=[],r=n.segments;for(let s=0;s<r.length;s++){const a=t6(r[s],n.points,e);a.length&&t.push(...a)}return t}function Sie(n,e,t,r){let s=0,a=e-1;if(t&&!r)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,t&&(a+=s);a>s&&n[a%e].skip;)a--;return a%=e,{start:s,end:a}}function jie(n,e,t,r){const s=n.length,a=[];let o=e,l=n[e],c;for(c=e+1;c<=t;++c){const d=n[c%s];d.skip||d.stop?l.skip||(r=!1,a.push({start:e%s,end:(c-1)%s,loop:r}),e=o=d.stop?c:null):(o=c,l.skip&&(e=c)),l=d}return o!==null&&a.push({start:e%s,end:o%s,loop:r}),a}function Nie(n,e){const t=n.points,r=n.options.spanGaps,s=t.length;if(!s)return[];const a=!!n._loop,{start:o,end:l}=Sie(t,s,a,r);if(r===!0)return bR(n,[{start:o,end:l,loop:a}],t,e);const c=l<o?l+s:l,d=!!n._fullLoop&&o===0&&l===s-1;return bR(n,jie(t,o,c,d),t,e)}function bR(n,e,t,r){return!r||!r.setContext||!t?e:Cie(n,e,t,r)}function Cie(n,e,t,r){const s=n._chart.getContext(),a=_R(n.options),{_datasetIndex:o,options:{spanGaps:l}}=n,c=t.length,d=[];let m=a,p=e[0].start,x=p;function v(_,w,j,P){const k=l?-1:1;if(_!==w){for(_+=c;t[_%c].skip;)_-=k;for(;t[w%c].skip;)w+=k;_%c!==w%c&&(d.push({start:_%c,end:w%c,loop:j,style:P}),m=P,p=w%c)}}for(const _ of e){p=l?p:_.start;let w=t[p%c],j;for(x=p+1;x<=_.end;x++){const P=t[x%c];j=_R(r.setContext(wu(s,{type:"segment",p0:w,p1:P,p0DataIndex:(x-1)%c,p1DataIndex:x%c,datasetIndex:o}))),Tie(j,m)&&v(p,x-1,_.loop,m),w=P,m=j}p<x-1&&v(p,x-1,_.loop,m)}return d}function _R(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function Tie(n,e){if(!e)return!1;const t=[],r=function(s,a){return e1(a)?(t.includes(a)||t.push(a),t.indexOf(a)):a};return JSON.stringify(n,r)!==JSON.stringify(e,r)}function Eg(n,e,t){return n.options.clip?n[t]:e[t]}function Pie(n,e){const{xScale:t,yScale:r}=n;return t&&r?{left:Eg(t,e,"left"),right:Eg(t,e,"right"),top:Eg(r,e,"top"),bottom:Eg(r,e,"bottom")}:e}function r6(n,e){const t=e._clip;if(t.disabled)return!1;const r=Pie(e,n.chartArea);return{left:t.left===!1?0:r.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:r.right+(t.right===!0?0:t.right),top:t.top===!1?0:r.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:r.bottom+(t.bottom===!0?0:t.bottom)}}class Mie{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,s){const a=t.listeners[s],o=t.duration;a.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(r-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=U5.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,s)=>{if(!r.running||!r.items.length)return;const a=r.items;let o=a.length-1,l=!1,c;for(;o>=0;--o)c=a[o],c._active?(c._total>r.duration&&(r.duration=c._total),c.tick(e),l=!0):(a[o]=a[a.length-1],a.pop());l&&(s.draw(),this._notify(s,r,e,"progress")),a.length||(r.running=!1,this._notify(s,r,e,"complete"),r.initial=!1),t+=a.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,s)=>Math.max(r,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let s=r.length-1;for(;s>=0;--s)r[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var cl=new Mie;const wR="transparent",kie={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const r=uR(n||wR),s=r.valid&&uR(e||wR);return s&&s.valid?s.mix(r,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class Eie{constructor(e,t,r,s){const a=t[r];s=Mg([e.to,s,a,e.from]);const o=Mg([e.from,a,s]);this._active=!0,this._fn=e.fn||kie[e.type||typeof o],this._easing=Gh[e.easing]||Gh.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const s=this._target[this._prop],a=r-this._start,o=this._duration-a;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=Mg([e.to,t,s,e.from]),this._from=Mg([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,s=this._prop,a=this._from,o=this._loop,l=this._to;let c;if(this._active=a!==l&&(o||t<r),!this._active){this._target[s]=l,this._notify(!0);return}if(t<0){this._target[s]=a;return}c=t/r%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[s]=this._fn(a,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let s=0;s<r.length;s++)r[s][t]()}}class s6{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Qt(e))return;const t=Object.keys(or.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const a=e[s];if(!Qt(a))return;const o={};for(const l of t)o[l]=a[l];(Nr(a.properties)&&a.properties||[s]).forEach(l=>{(l===s||!r.has(l))&&r.set(l,o)})})}_animateOptions(e,t){const r=t.options,s=Oie(e,r);if(!s)return[];const a=this._createAnimations(s,r);return r.$shared&&Die(e.options.$animations,r).then(()=>{e.options=r},()=>{}),a}_createAnimations(e,t){const r=this._properties,s=[],a=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const d=o[c];if(d.charAt(0)==="$")continue;if(d==="options"){s.push(...this._animateOptions(e,t));continue}const m=t[d];let p=a[d];const x=r.get(d);if(p)if(x&&p.active()){p.update(x,m,l);continue}else p.cancel();if(!x||!x.duration){e[d]=m;continue}a[d]=p=new Eie(x,e,d,m),s.push(p)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return cl.add(this._chart,r),!0}}function Die(n,e){const t=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const a=n[r[s]];a&&a.active()&&t.push(a.wait())}return Promise.all(t)}function Oie(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function SR(n,e){const t=n&&n.options||{},r=t.reverse,s=t.min===void 0?e:0,a=t.max===void 0?e:0;return{start:r?a:s,end:r?s:a}}function Iie(n,e,t){if(t===!1)return!1;const r=SR(n,t),s=SR(e,t);return{top:s.end,right:r.end,bottom:s.start,left:r.start}}function Aie(n){let e,t,r,s;return Qt(n)?(e=n.top,t=n.right,r=n.bottom,s=n.left):e=t=r=s=n,{top:e,right:t,bottom:r,left:s,disabled:n===!1}}function i6(n,e){const t=[],r=n._getSortedDatasetMetas(e);let s,a;for(s=0,a=r.length;s<a;++s)t.push(r[s].index);return t}function jR(n,e,t,r={}){const s=n.keys,a=r.mode==="single";let o,l,c,d;if(e===null)return;let m=!1;for(o=0,l=s.length;o<l;++o){if(c=+s[o],c===t){if(m=!0,r.all)continue;break}d=n.values[c],as(d)&&(a||e===0||xo(e)===xo(d))&&(e+=d)}return!m&&!r.all?0:e}function Rie(n,e){const{iScale:t,vScale:r}=e,s=t.axis==="x"?"x":"y",a=r.axis==="x"?"x":"y",o=Object.keys(n),l=new Array(o.length);let c,d,m;for(c=0,d=o.length;c<d;++c)m=o[c],l[c]={[s]:m,[a]:n[m]};return l}function uj(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function Lie(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function Fie(n){const{min:e,max:t,minDefined:r,maxDefined:s}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function qie(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function NR(n,e,t,r){for(const s of e.getMatchingVisibleMetas(r).reverse()){const a=n[s.index];if(t&&a>0||!t&&a<0)return s.index}return null}function CR(n,e){const{chart:t,_cachedMeta:r}=n,s=t._stacks||(t._stacks={}),{iScale:a,vScale:o,index:l}=r,c=a.axis,d=o.axis,m=Lie(a,o,r),p=e.length;let x;for(let v=0;v<p;++v){const _=e[v],{[c]:w,[d]:j}=_,P=_._stacks||(_._stacks={});x=P[d]=qie(s,m,w),x[l]=j,x._top=NR(x,o,!0,r.type),x._bottom=NR(x,o,!1,r.type);const k=x._visualValues||(x._visualValues={});k[l]=j}}function fj(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function zie(n,e){return wu(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Uie(n,e,t){return wu(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Ch(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const s of e){const a=s._stacks;if(!a||a[r]===void 0||a[r][t]===void 0)return;delete a[r][t],a[r]._visualValues!==void 0&&a[r]._visualValues[t]!==void 0&&delete a[r]._visualValues[t]}}}const hj=n=>n==="reset"||n==="none",TR=(n,e)=>e?n:Object.assign({},n),Vie=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:i6(t,!0),values:null};class xy{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=uj(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Ch(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),s=(p,x,v,_)=>p==="x"?x:p==="r"?_:v,a=t.xAxisID=Bt(r.xAxisID,fj(e,"x")),o=t.yAxisID=Bt(r.yAxisID,fj(e,"y")),l=t.rAxisID=Bt(r.rAxisID,fj(e,"r")),c=t.indexAxis,d=t.iAxisID=s(c,a,o,l),m=t.vAxisID=s(c,o,a,l);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(d),t.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&lR(this._data,this),e._stacked&&Ch(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(Qt(t)){const s=this._cachedMeta;this._data=Rie(t,s)}else if(r!==t){if(r){lR(r,this);const s=this._cachedMeta;Ch(s),s._parsed=[]}t&&Object.isExtensible(t)&&jse(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let s=!1;this._dataCheck();const a=t._stacked;t._stacked=uj(t.vScale,t),t.stack!==r.stack&&(s=!0,Ch(t),t.stack=r.stack),this._resyncElements(e),(s||a!==t._stacked)&&(CR(this,t._parsed),t._stacked=uj(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:s}=this,{iScale:a,_stacked:o}=r,l=a.axis;let c=e===0&&t===s.length?!0:r._sorted,d=e>0&&r._parsed[e-1],m,p,x;if(this._parsing===!1)r._parsed=s,r._sorted=!0,x=s;else{Nr(s[e])?x=this.parseArrayData(r,s,e,t):Qt(s[e])?x=this.parseObjectData(r,s,e,t):x=this.parsePrimitiveData(r,s,e,t);const v=()=>p[l]===null||d&&p[l]<d[l];for(m=0;m<t;++m)r._parsed[m+e]=p=x[m],c&&(v()&&(c=!1),d=p);r._sorted=c}o&&CR(this,x)}parsePrimitiveData(e,t,r,s){const{iScale:a,vScale:o}=e,l=a.axis,c=o.axis,d=a.getLabels(),m=a===o,p=new Array(s);let x,v,_;for(x=0,v=s;x<v;++x)_=x+r,p[x]={[l]:m||a.parse(d[_],_),[c]:o.parse(t[_],_)};return p}parseArrayData(e,t,r,s){const{xScale:a,yScale:o}=e,l=new Array(s);let c,d,m,p;for(c=0,d=s;c<d;++c)m=c+r,p=t[m],l[c]={x:a.parse(p[0],m),y:o.parse(p[1],m)};return l}parseObjectData(e,t,r,s){const{xScale:a,yScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=new Array(s);let m,p,x,v;for(m=0,p=s;m<p;++m)x=m+r,v=t[x],d[m]={x:a.parse(uu(v,l),x),y:o.parse(uu(v,c),x)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const s=this.chart,a=this._cachedMeta,o=t[e.axis],l={keys:i6(s,!0),values:t._stacks[e.axis]._visualValues};return jR(l,o,a.index,{mode:r})}updateRangeFromParsed(e,t,r,s){const a=r[t.axis];let o=a===null?NaN:a;const l=s&&r._stacks[t.axis];s&&l&&(s.values=l,o=jR(s,a,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const r=this._cachedMeta,s=r._parsed,a=r._sorted&&e===r.iScale,o=s.length,l=this._getOtherScale(e),c=Vie(t,r,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:p}=Fie(l);let x,v;function _(){v=s[x];const w=v[l.axis];return!as(v[e.axis])||m>w||p<w}for(x=0;x<o&&!(!_()&&(this.updateRangeFromParsed(d,e,v,c),a));++x);if(a){for(x=o-1;x>=0;--x)if(!_()){this.updateRangeFromParsed(d,e,v,c);break}}return d}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let s,a,o;for(s=0,a=t.length;s<a;++s)o=t[s][e.axis],as(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,s=t.vScale,a=this.getParsed(e);return{label:r?""+r.getLabelForValue(a[r.axis]):"",value:s?""+s.getLabelForValue(a[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=Aie(Bt(this.options.clip,Iie(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,s=r.data||[],a=t.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||s.length-l,d=this.options.drawActiveElementsOnTop;let m;for(r.dataset&&r.dataset.draw(e,a,l,c),m=l;m<l+c;++m){const p=s[m];p.hidden||(p.active&&d?o.push(p):p.draw(e,a))}for(m=0;m<o.length;++m)o[m].draw(e,a)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const s=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];a=o.$context||(o.$context=Uie(this.getContext(),e,o)),a.parsed=this.getParsed(e),a.raw=s.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=zie(this.chart.getContext(),this.index)),a.dataset=s,a.index=a.datasetIndex=this.index;return a.active=!!t,a.mode=r,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const s=t==="active",a=this._cachedDataOpts,o=e+"-"+t,l=a[o],c=this.enableOptionSharing&&um(r);if(l)return TR(l,c);const d=this.chart.config,m=d.datasetElementScopeKeys(this._type,e),p=s?[`${e}Hover`,"hover",e,""]:[e,""],x=d.getOptionScopes(this.getDataset(),m),v=Object.keys(or.elements[e]),_=()=>this.getContext(r,s,t),w=d.resolveNamedOptions(x,v,_,p);return w.$shared&&(w.$shared=c,a[o]=Object.freeze(TR(w,c))),w}_resolveAnimations(e,t,r){const s=this.chart,a=this._cachedDataOpts,o=`animation-${t}`,l=a[o];if(l)return l;let c;if(s.options.animation!==!1){const m=this.chart.config,p=m.datasetAnimationScopeKeys(this._type,t),x=m.getOptionScopes(this.getDataset(),p);c=m.createResolver(x,this.getContext(e,r,t))}const d=new s6(s,c&&c.animations);return c&&c._cacheable&&(a[o]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||hj(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),s=this._sharedOptions,a=this.getSharedOptions(r),o=this.includeOptions(t,a)||a!==s;return this.updateSharedOptions(a,t,r),{sharedOptions:a,includeOptions:o}}updateElement(e,t,r,s){hj(s)?Object.assign(e,r):this._resolveAnimations(t,s).update(e,r)}updateSharedOptions(e,t,r){e&&!hj(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,s){e.active=s;const a=this.getStyle(t,s);this._resolveAnimations(t,r,s).update(e,{options:!s&&this.getSharedOptions(a)||a})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[l,c,d]of this._syncList)this[l](c,d);this._syncList=[];const s=r.length,a=t.length,o=Math.min(a,s);o&&this.parse(0,o),a>s?this._insertElements(s,a-s,e):a<s&&this._removeElements(a,s-a)}_insertElements(e,t,r=!0){const s=this._cachedMeta,a=s.data,o=e+t;let l;const c=d=>{for(d.length+=t,l=d.length-1;l>=o;l--)d[l]=d[l-t]};for(c(a),l=e;l<o;++l)a[l]=new this.dataElementType;this._parsing&&c(s._parsed),this.parse(e,t),r&&this.updateElements(a,e,t,"reset")}updateElements(e,t,r,s){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const s=r._parsed.splice(e,t);r._stacked&&Ch(r,s)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,s]=e;this[t](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Bie(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let r=[];for(let s=0,a=t.length;s<a;s++)r=r.concat(t[s].controller.getAllParsedValues(n));n._cache.$bar=z5(r.sort((s,a)=>s-a))}return n._cache.$bar}function Wie(n){const e=n.iScale,t=Bie(e,n.type);let r=e._length,s,a,o,l;const c=()=>{o===32767||o===-32768||(um(l)&&(r=Math.min(r,Math.abs(o-l)||r)),l=o)};for(s=0,a=t.length;s<a;++s)o=e.getPixelForValue(t[s]),c();for(l=void 0,s=0,a=e.ticks.length;s<a;++s)o=e.getPixelForTick(s),c();return r}function $ie(n,e,t,r){const s=t.barThickness;let a,o;return mn(s)?(a=e.min*t.categoryPercentage,o=t.barPercentage):(a=s*r,o=1),{chunk:a/r,ratio:o,start:e.pixels[n]-a/2}}function Hie(n,e,t,r){const s=e.pixels,a=s[n];let o=n>0?s[n-1]:null,l=n<s.length-1?s[n+1]:null;const c=t.categoryPercentage;o===null&&(o=a-(l===null?e.end-e.start:l-a)),l===null&&(l=a+a-o);const d=a-(a-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/r,ratio:t.barPercentage,start:d}}function Yie(n,e,t,r){const s=t.parse(n[0],r),a=t.parse(n[1],r),o=Math.min(s,a),l=Math.max(s,a);let c=o,d=l;Math.abs(o)>Math.abs(l)&&(c=l,d=o),e[t.axis]=d,e._custom={barStart:c,barEnd:d,start:s,end:a,min:o,max:l}}function a6(n,e,t,r){return Nr(n)?Yie(n,e,t,r):e[t.axis]=t.parse(n,r),e}function PR(n,e,t,r){const s=n.iScale,a=n.vScale,o=s.getLabels(),l=s===a,c=[];let d,m,p,x;for(d=t,m=t+r;d<m;++d)x=e[d],p={},p[s.axis]=l||s.parse(o[d],d),c.push(a6(x,p,a,d));return c}function mj(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function Gie(n,e,t){return n!==0?xo(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function Zie(n){let e,t,r,s,a;return n.horizontal?(e=n.base>n.x,t="left",r="right"):(e=n.base<n.y,t="bottom",r="top"),e?(s="end",a="start"):(s="start",a="end"),{start:t,end:r,reverse:e,top:s,bottom:a}}function Kie(n,e,t,r){let s=e.borderSkipped;const a={};if(!s){n.borderSkipped=a;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:d,bottom:m}=Zie(n);s==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===r?s=d:(t._bottom||0)===r?s=m:(a[MR(m,o,l,c)]=!0,s=d)),a[MR(s,o,l,c)]=!0,n.borderSkipped=a}function MR(n,e,t,r){return r?(n=Jie(n,e,t),n=kR(n,t,e)):n=kR(n,e,t),n}function Jie(n,e,t){return n===e?t:n===t?e:n}function kR(n,e,t){return n==="start"?e:n==="end"?t:n}function Qie(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class Xie extends xy{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,r,s){return PR(e,t,r,s)}parseArrayData(e,t,r,s){return PR(e,t,r,s)}parseObjectData(e,t,r,s){const{iScale:a,vScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=a.axis==="x"?l:c,m=o.axis==="x"?l:c,p=[];let x,v,_,w;for(x=r,v=r+s;x<v;++x)w=t[x],_={},_[a.axis]=a.parse(uu(w,d),x),p.push(a6(uu(w,m),_,o,x));return p}updateRangeFromParsed(e,t,r,s){super.updateRangeFromParsed(e,t,r,s);const a=r._custom;a&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:s}=t,a=this.getParsed(e),o=a._custom,l=mj(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(a[s.axis]);return{label:""+r.getLabelForValue(a[r.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,s){const a=s==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),d=l.isHorizontal(),m=this._getRuler(),{sharedOptions:p,includeOptions:x}=this._getSharedOptions(t,s);for(let v=t;v<t+r;v++){const _=this.getParsed(v),w=a||mn(_[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(v),j=this._calculateBarIndexPixels(v,m),P=(_._stacks||{})[l.axis],k={horizontal:d,base:w.base,enableBorderRadius:!P||mj(_._custom)||o===P._top||o===P._bottom,x:d?w.head:j.center,y:d?j.center:w.head,height:d?j.size:Math.abs(w.size),width:d?Math.abs(w.size):j.size};x&&(k.options=p||this.resolveDataElementOptions(v,e[v].active?"active":s));const I=k.options||e[v].options;Kie(k,I,P,o),Qie(k,I,m.ratio),this.updateElement(e[v],v,k,s)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),a=r.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),c=l&&l[r.axis],d=m=>{const p=m._parsed.find(v=>v[r.axis]===c),x=p&&p[m.vScale.axis];if(mn(x)||isNaN(x))return!0};for(const m of s)if(!(t!==void 0&&d(m))&&((a===!1||o.indexOf(m.stack)===-1||a===void 0&&m.stack===void 0)&&o.push(m.stack),m.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[Bt(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,r){const s=this._getStacks(e,r),a=t!==void 0?s.indexOf(t):-1;return a===-1?s.length-1:a}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,s=[];let a,o;for(a=0,o=t.data.length;a<o;++a)s.push(r.getPixelForValue(this.getParsed(a)[r.axis],a));const l=e.barThickness;return{min:l||Wie(t),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:s},options:{base:a,minBarLength:o}}=this,l=a||0,c=this.getParsed(e),d=c._custom,m=mj(d);let p=c[t.axis],x=0,v=r?this.applyStack(t,c,r):p,_,w;v!==p&&(x=v-p,v=p),m&&(p=d.barStart,v=d.barEnd-d.barStart,p!==0&&xo(p)!==xo(d.barEnd)&&(x=0),x+=p);const j=!mn(a)&&!m?a:x;let P=t.getPixelForValue(j);if(this.chart.getDataVisibility(e)?_=t.getPixelForValue(x+v):_=P,w=_-P,Math.abs(w)<o){w=Gie(w,t,l)*o,p===l&&(P-=w/2);const k=t.getPixelForDecimal(0),I=t.getPixelForDecimal(1),M=Math.min(k,I),D=Math.max(k,I);P=Math.max(Math.min(P,D),M),_=P+w,r&&!m&&(c._stacks[t.axis]._visualValues[s]=t.getValueForPixel(_)-t.getValueForPixel(P))}if(P===t.getPixelForValue(l)){const k=xo(w)*t.getLineWidthForValue(l)/2;P+=k,w-=k}return{size:w,base:P,head:_,center:_+w/2}}_calculateBarIndexPixels(e,t){const r=t.scale,s=this.options,a=s.skipNull,o=Bt(s.maxBarThickness,1/0);let l,c;const d=this._getAxisCount();if(t.grouped){const m=a?this._getStackCount(e):t.stackCount,p=s.barThickness==="flex"?Hie(e,t,s,m*d):$ie(e,t,s,m*d),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,v=this._getAxis().indexOf(Bt(x,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+v;l=p.start+p.chunk*_+p.chunk/2,c=Math.min(o,p.chunk*p.ratio)}else l=r.getPixelForValue(this.getParsed(e)[r.axis],e),c=Math.min(o,t.min*t.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,s=r.length;let a=0;for(;a<s;++a)this.getParsed(a)[t.axis]!==null&&!r[a].hidden&&r[a].draw(this._ctx)}}function eae(n,e,t){let r=1,s=1,a=0,o=0;if(e<Jn){const l=n,c=l+e,d=Math.cos(l),m=Math.sin(l),p=Math.cos(c),x=Math.sin(c),v=(I,M,D)=>hm(I,l,c,!0)?1:Math.max(M,M*t,D,D*t),_=(I,M,D)=>hm(I,l,c,!0)?-1:Math.min(M,M*t,D,D*t),w=v(0,d,p),j=v(Cr,m,x),P=_(Tn,d,p),k=_(Tn+Cr,m,x);r=(w-P)/2,s=(j-k)/2,a=-(w+P)/2,o=-(j+k)/2}return{ratioX:r,ratioY:s,offsetX:a,offsetY:o}}class tae extends xy{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:r,textAlign:s,color:a,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((c,d)=>{const p=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:p.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(d),lineDash:p.borderDash,lineDashOffset:p.borderDashOffset,lineJoin:p.borderJoinStyle,lineWidth:p.borderWidth,strokeStyle:p.borderColor,textAlign:s,pointStyle:r,borderRadius:o&&(l||p.borderRadius),index:d}}):[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=r;else{let a=c=>+r[c];if(Qt(r[e])){const{key:c="value"}=this._parsing;a=d=>+uu(r[d],c)}let o,l;for(o=e,l=e+t;o<l;++o)s._parsed[o]=a(o)}}_getRotation(){return pl(this.options.rotation-90)}_getCircumference(){return pl(this.options.circumference)}_getRotationExtents(){let e=Jn,t=-Jn;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const s=this.chart.getDatasetMeta(r).controller,a=s._getRotation(),o=s._getCircumference();e=Math.min(e,a),t=Math.max(t,a+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,s=this._cachedMeta,a=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,l=Math.max((Math.min(r.width,r.height)-o)/2,0),c=Math.min(ose(this.options.cutout,l),1),d=this._getRingWeight(this.index),{circumference:m,rotation:p}=this._getRotationExtents(),{ratioX:x,ratioY:v,offsetX:_,offsetY:w}=eae(p,m,c),j=(r.width-o)/x,P=(r.height-o)/v,k=Math.max(Math.min(j,P)/2,0),I=A5(this.options.radius,k),M=Math.max(I*c,0),D=(I-M)/this._getVisibleDatasetWeightTotal();this.offsetX=_*I,this.offsetY=w*I,s.total=this.calculateTotal(),this.outerRadius=I-D*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-D*d,0),this.updateElements(a,0,a.length,e)}_circumference(e,t){const r=this.options,s=this._cachedMeta,a=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*a/Jn)}updateElements(e,t,r,s){const a=s==="reset",o=this.chart,l=o.chartArea,d=o.options.animation,m=(l.left+l.right)/2,p=(l.top+l.bottom)/2,x=a&&d.animateScale,v=x?0:this.innerRadius,_=x?0:this.outerRadius,{sharedOptions:w,includeOptions:j}=this._getSharedOptions(t,s);let P=this._getRotation(),k;for(k=0;k<t;++k)P+=this._circumference(k,a);for(k=t;k<t+r;++k){const I=this._circumference(k,a),M=e[k],D={x:m+this.offsetX,y:p+this.offsetY,startAngle:P,endAngle:P+I,circumference:I,outerRadius:_,innerRadius:v};j&&(D.options=w||this.resolveDataElementOptions(k,M.active?"active":s)),P+=I,this.updateElement(M,k,D,s)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r=0,s;for(s=0;s<t.length;s++){const a=e._parsed[s];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(s)&&!t[s].hidden&&(r+=Math.abs(a))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Jn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,s=r.data.labels||[],a=t1(t._parsed[e],r.options.locale);return{label:s[e]||"",value:a}}getMaxBorderWidth(e){let t=0;const r=this.chart;let s,a,o,l,c;if(!e){for(s=0,a=r.data.datasets.length;s<a;++s)if(r.isDatasetVisible(s)){o=r.getDatasetMeta(s),e=o.data,l=o.controller;break}}if(!e)return 0;for(s=0,a=e.length;s<a;++s)c=l.resolveDataElementOptions(s),c.borderAlign!=="inner"&&(t=Math.max(t,c.borderWidth||0,c.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,s=e.length;r<s;++r){const a=this.resolveDataElementOptions(r);t=Math.max(t,a.offset||0,a.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(Bt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class nae extends xy{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:s=[],_dataset:a}=t,o=this.chart._animationsDisabled;let{start:l,count:c}=Tse(t,s,o);this._drawStart=l,this._drawCount=c,Pse(t)&&(l=0,c=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!a._decimated,r.points=s;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:d},e),this.updateElements(s,l,c,e)}updateElements(e,t,r,s){const a=s==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:d}=this._cachedMeta,{sharedOptions:m,includeOptions:p}=this._getSharedOptions(t,s),x=o.axis,v=l.axis,{spanGaps:_,segment:w}=this.options,j=fm(_)?_:Number.POSITIVE_INFINITY,P=this.chart._animationsDisabled||a||s==="none",k=t+r,I=e.length;let M=t>0&&this.getParsed(t-1);for(let D=0;D<I;++D){const O=e[D],q=P?O:{};if(D<t||D>=k){q.skip=!0;continue}const F=this.getParsed(D),U=mn(F[v]),B=q[x]=o.getPixelForValue(F[x],D),G=q[v]=a||U?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,F,c):F[v],D);q.skip=isNaN(B)||isNaN(G)||U,q.stop=D>0&&Math.abs(F[x]-M[x])>j,w&&(q.parsed=F,q.raw=d.data[D]),p&&(q.options=m||this.resolveDataElementOptions(D,O.active?"active":s)),P||this.updateElement(O,D,q,s),M=F}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,s=e.data||[];if(!s.length)return r;const a=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,a,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}function Bd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class l1{static override(e){Object.assign(l1.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Bd()}parse(){return Bd()}format(){return Bd()}add(){return Bd()}diff(){return Bd()}startOf(){return Bd()}endOf(){return Bd()}}var rae={_date:l1};function sae(n,e,t,r){const{controller:s,data:a,_sorted:o}=n,l=s._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&a.length){const d=l._reversePixels?wse:tu;if(r){if(s._sharedOptions){const m=a[0],p=typeof m.getRange=="function"&&m.getRange(e);if(p){const x=d(a,e,t-p),v=d(a,e,t+p);return{lo:x.lo,hi:v.hi}}}}else{const m=d(a,e,t);if(c){const{vScale:p}=s._cachedMeta,{_parsed:x}=n,v=x.slice(0,m.lo+1).reverse().findIndex(w=>!mn(w[p.axis]));m.lo-=Math.max(0,v);const _=x.slice(m.hi).findIndex(w=>!mn(w[p.axis]));m.hi+=Math.max(0,_)}return m}}return{lo:0,hi:a.length-1}}function yy(n,e,t,r,s){const a=n.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,c=a.length;l<c;++l){const{index:d,data:m}=a[l],{lo:p,hi:x}=sae(a[l],e,o,s);for(let v=p;v<=x;++v){const _=m[v];_.skip||r(_,d,v)}}}function iae(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(r,s){const a=e?Math.abs(r.x-s.x):0,o=t?Math.abs(r.y-s.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}function pj(n,e,t,r,s){const a=[];return!s&&!n.isPointInArea(e)||yy(n,t,e,function(l,c,d){!s&&!mm(l,n.chartArea,0)||l.inRange(e.x,e.y,r)&&a.push({element:l,datasetIndex:c,index:d})},!0),a}function aae(n,e,t,r){let s=[];function a(o,l,c){const{startAngle:d,endAngle:m}=o.getProps(["startAngle","endAngle"],r),{angle:p}=F5(o,{x:e.x,y:e.y});hm(p,d,m)&&s.push({element:o,datasetIndex:l,index:c})}return yy(n,t,e,a),s}function oae(n,e,t,r,s,a){let o=[];const l=iae(t);let c=Number.POSITIVE_INFINITY;function d(m,p,x){const v=m.inRange(e.x,e.y,s);if(r&&!v)return;const _=m.getCenterPoint(s);if(!(!!a||n.isPointInArea(_))&&!v)return;const j=l(e,_);j<c?(o=[{element:m,datasetIndex:p,index:x}],c=j):j===c&&o.push({element:m,datasetIndex:p,index:x})}return yy(n,t,e,d),o}function gj(n,e,t,r,s,a){return!a&&!n.isPointInArea(e)?[]:t==="r"&&!r?aae(n,e,t,s):oae(n,e,t,r,s,a)}function ER(n,e,t,r,s){const a=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return yy(n,t,e,(c,d,m)=>{c[o]&&c[o](e[t],s)&&(a.push({element:c,datasetIndex:d,index:m}),l=l||c.inRange(e.x,e.y,s))}),r&&!l?[]:a}var lae={modes:{index(n,e,t,r){const s=Gd(e,n),a=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?pj(n,s,a,r,o):gj(n,s,a,!1,r,o),c=[];return l.length?(n.getSortedVisibleDatasetMetas().forEach(d=>{const m=l[0].index,p=d.data[m];p&&!p.skip&&c.push({element:p,datasetIndex:d.index,index:m})}),c):[]},dataset(n,e,t,r){const s=Gd(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?pj(n,s,a,r,o):gj(n,s,a,!1,r,o);if(l.length>0){const c=l[0].datasetIndex,d=n.getDatasetMeta(c).data;l=[];for(let m=0;m<d.length;++m)l.push({element:d[m],datasetIndex:c,index:m})}return l},point(n,e,t,r){const s=Gd(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return pj(n,s,a,r,o)},nearest(n,e,t,r){const s=Gd(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return gj(n,s,a,t.intersect,r,o)},x(n,e,t,r){const s=Gd(e,n);return ER(n,s,"x",t.intersect,r)},y(n,e,t,r){const s=Gd(e,n);return ER(n,s,"y",t.intersect,r)}}};const o6=["left","top","right","bottom"];function Th(n,e){return n.filter(t=>t.pos===e)}function DR(n,e){return n.filter(t=>o6.indexOf(t.pos)===-1&&t.box.axis===e)}function Ph(n,e){return n.sort((t,r)=>{const s=e?r:t,a=e?t:r;return s.weight===a.weight?s.index-a.index:s.weight-a.weight})}function cae(n){const e=[];let t,r,s,a,o,l;for(t=0,r=(n||[]).length;t<r;++t)s=n[t],{position:a,options:{stack:o,stackWeight:l=1}}=s,e.push({index:t,box:s,pos:a,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&a+o,stackWeight:l});return e}function dae(n){const e={};for(const t of n){const{stack:r,pos:s,stackWeight:a}=t;if(!r||!o6.includes(s))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=a}return e}function uae(n,e){const t=dae(n),{vBoxMaxWidth:r,hBoxMaxHeight:s}=e;let a,o,l;for(a=0,o=n.length;a<o;++a){l=n[a];const{fullSize:c}=l.box,d=t[l.stack],m=d&&l.stackWeight/d.weight;l.horizontal?(l.width=m?m*r:c&&e.availableWidth,l.height=s):(l.width=r,l.height=m?m*s:c&&e.availableHeight)}return t}function fae(n){const e=cae(n),t=Ph(e.filter(d=>d.box.fullSize),!0),r=Ph(Th(e,"left"),!0),s=Ph(Th(e,"right")),a=Ph(Th(e,"top"),!0),o=Ph(Th(e,"bottom")),l=DR(e,"x"),c=DR(e,"y");return{fullSize:t,leftAndTop:r.concat(a),rightAndBottom:s.concat(c).concat(o).concat(l),chartArea:Th(e,"chartArea"),vertical:r.concat(s).concat(c),horizontal:a.concat(o).concat(l)}}function OR(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function l6(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function hae(n,e,t,r){const{pos:s,box:a}=t,o=n.maxPadding;if(!Qt(s)){t.size&&(n[s]-=t.size);const p=r[t.stack]||{size:0,count:1};p.size=Math.max(p.size,t.horizontal?a.height:a.width),t.size=p.size/p.count,n[s]+=t.size}a.getPadding&&l6(o,a.getPadding());const l=Math.max(0,e.outerWidth-OR(o,n,"left","right")),c=Math.max(0,e.outerHeight-OR(o,n,"top","bottom")),d=l!==n.w,m=c!==n.h;return n.w=l,n.h=c,t.horizontal?{same:d,other:m}:{same:m,other:d}}function mae(n){const e=n.maxPadding;function t(r){const s=Math.max(e[r]-n[r],0);return n[r]+=s,s}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function pae(n,e){const t=e.maxPadding;function r(s){const a={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{a[o]=Math.max(e[o],t[o])}),a}return r(n?["left","right"]:["top","bottom"])}function Fh(n,e,t,r){const s=[];let a,o,l,c,d,m;for(a=0,o=n.length,d=0;a<o;++a){l=n[a],c=l.box,c.update(l.width||e.w,l.height||e.h,pae(l.horizontal,e));const{same:p,other:x}=hae(e,t,l,r);d|=p&&s.length,m=m||x,c.fullSize||s.push(l)}return d&&Fh(s,e,t,r)||m}function Dg(n,e,t,r,s){n.top=t,n.left=e,n.right=e+r,n.bottom=t+s,n.width=r,n.height=s}function IR(n,e,t,r){const s=t.padding;let{x:a,y:o}=e;for(const l of n){const c=l.box,d=r[l.stack]||{placed:0,weight:1},m=l.stackWeight/d.weight||1;if(l.horizontal){const p=e.w*m,x=d.size||c.height;um(d.start)&&(o=d.start),c.fullSize?Dg(c,s.left,o,t.outerWidth-s.right-s.left,x):Dg(c,e.left+d.placed,o,p,x),d.start=o,d.placed+=p,o=c.bottom}else{const p=e.h*m,x=d.size||c.width;um(d.start)&&(a=d.start),c.fullSize?Dg(c,a,s.top,x,t.outerHeight-s.bottom-s.top):Dg(c,a,e.top+d.placed,x,p),d.start=a,d.placed+=p,a=c.right}}e.x=a,e.y=o}var Oc={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const s=Pa(n.options.layout.padding),a=Math.max(e-s.width,0),o=Math.max(t-s.height,0),l=fae(n.boxes),c=l.vertical,d=l.horizontal;xn(n.boxes,w=>{typeof w.beforeLayout=="function"&&w.beforeLayout()});const m=c.reduce((w,j)=>j.box.options&&j.box.options.display===!1?w:w+1,0)||1,p=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:a,availableHeight:o,vBoxMaxWidth:a/2/m,hBoxMaxHeight:o/2}),x=Object.assign({},s);l6(x,Pa(r));const v=Object.assign({maxPadding:x,w:a,h:o,x:s.left,y:s.top},s),_=uae(c.concat(d),p);Fh(l.fullSize,v,p,_),Fh(c,v,p,_),Fh(d,v,p,_)&&Fh(c,v,p,_),mae(v),IR(l.leftAndTop,v,p,_),v.x+=v.w,v.y+=v.h,IR(l.rightAndBottom,v,p,_),n.chartArea={left:v.left,top:v.top,right:v.left+v.w,bottom:v.top+v.h,height:v.h,width:v.w},xn(l.chartArea,w=>{const j=w.box;Object.assign(j,n.chartArea),j.update(v.w,v.h,{left:0,top:0,right:0,bottom:0})})}};class c6{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,s){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):r)}}isAttached(e){return!0}updateConfig(e){}}class gae extends c6{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Qg="$chartjs",xae={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},AR=n=>n===null||n==="";function yae(n,e){const t=n.style,r=n.getAttribute("height"),s=n.getAttribute("width");if(n[Qg]={initial:{height:r,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",AR(s)){const a=yR(n,"width");a!==void 0&&(n.width=a)}if(AR(r))if(n.style.height==="")n.height=n.width/(e||2);else{const a=yR(n,"height");a!==void 0&&(n.height=a)}return n}const d6=xie?{passive:!0}:!1;function vae(n,e,t){n&&n.addEventListener(e,t,d6)}function bae(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,d6)}function _ae(n,e){const t=xae[n.type]||n.type,{x:r,y:s}=Gd(n,e);return{type:t,chart:e,native:n,x:r!==void 0?r:null,y:s!==void 0?s:null}}function Mx(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function wae(n,e,t){const r=n.canvas,s=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||Mx(l.addedNodes,r),o=o&&!Mx(l.removedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function Sae(n,e,t){const r=n.canvas,s=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||Mx(l.removedNodes,r),o=o&&!Mx(l.addedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const pm=new Map;let RR=0;function u6(){const n=window.devicePixelRatio;n!==RR&&(RR=n,pm.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function jae(n,e){pm.size||window.addEventListener("resize",u6),pm.set(n,e)}function Nae(n){pm.delete(n),pm.size||window.removeEventListener("resize",u6)}function Cae(n,e,t){const r=n.canvas,s=r&&o1(r);if(!s)return;const a=V5((l,c)=>{const d=s.clientWidth;t(l,c),d<s.clientWidth&&t()},window),o=new ResizeObserver(l=>{const c=l[0],d=c.contentRect.width,m=c.contentRect.height;d===0&&m===0||a(d,m)});return o.observe(s),jae(n,a),o}function xj(n,e,t){t&&t.disconnect(),e==="resize"&&Nae(n)}function Tae(n,e,t){const r=n.canvas,s=V5(a=>{n.ctx!==null&&t(_ae(a,n))},n);return vae(r,e,s),s}class Pae extends c6{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(yae(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[Qg])return!1;const r=t[Qg].initial;["height","width"].forEach(a=>{const o=r[a];mn(o)?t.removeAttribute(a):t.setAttribute(a,o)});const s=r.style||{};return Object.keys(s).forEach(a=>{t.style[a]=s[a]}),t.width=t.width,delete t[Qg],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),o={attach:wae,detach:Sae,resize:Cae}[t]||Tae;s[t]=o(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),s=r[t];if(!s)return;({attach:xj,detach:xj,resize:xj}[t]||bae)(e,t,s),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,s){return gie(e,t,r,s)}isAttached(e){const t=e&&o1(e);return!!(t&&t.isConnected)}}function Mae(n){return!a1()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?gae:Pae}let rd=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return fm(this.x)&&fm(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const s={};return e.forEach(a=>{s[a]=r[a]&&r[a].active()?r[a]._to:this[a]}),s}};function kae(n,e){const t=n.options.ticks,r=Eae(n),s=Math.min(t.maxTicksLimit||r,r),a=t.major.enabled?Oae(e):[],o=a.length,l=a[0],c=a[o-1],d=[];if(o>s)return Iae(e,d,a,o/s),d;const m=Dae(a,e,s);if(o>0){let p,x;const v=o>1?Math.round((c-l)/(o-1)):null;for(Og(e,d,m,mn(v)?0:l-v,l),p=0,x=o-1;p<x;p++)Og(e,d,m,a[p],a[p+1]);return Og(e,d,m,c,mn(v)?e.length:c+v),d}return Og(e,d,m),d}function Eae(n){const e=n.options.offset,t=n._tickSize(),r=n._length/t+(e?0:1),s=n._maxLength/t;return Math.floor(Math.min(r,s))}function Dae(n,e,t){const r=Aae(n),s=e.length/t;if(!r)return Math.max(s,1);const a=pse(r);for(let o=0,l=a.length-1;o<l;o++){const c=a[o];if(c>s)return c}return Math.max(s,1)}function Oae(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}function Iae(n,e,t,r){let s=0,a=t[0],o;for(r=Math.ceil(r),o=0;o<n.length;o++)o===a&&(e.push(n[o]),s++,a=t[s*r])}function Og(n,e,t,r,s){const a=Bt(r,0),o=Math.min(Bt(s,n.length),n.length);let l=0,c,d,m;for(t=Math.ceil(t),s&&(c=s-r,t=c/Math.floor(c/t)),m=a;m<0;)l++,m=Math.round(a+l*t);for(d=Math.max(a,0);d<o;d++)d===m&&(e.push(n[d]),l++,m=Math.round(a+l*t))}function Aae(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}const Rae=n=>n==="left"?"right":n==="right"?"left":n,LR=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,FR=(n,e)=>Math.min(e||n,n);function qR(n,e){const t=[],r=n.length/e,s=n.length;let a=0;for(;a<s;a+=r)t.push(n[Math.floor(a)]);return t}function Lae(n,e,t){const r=n.ticks.length,s=Math.min(e,r-1),a=n._startPixel,o=n._endPixel,l=1e-6;let c=n.getPixelForTick(s),d;if(!(t&&(r===1?d=Math.max(c-a,o-c):e===0?d=(n.getPixelForTick(1)-c)/2:d=(c-n.getPixelForTick(s-1))/2,c+=s<e?d:-d,c<a-l||c>o+l)))return c}function Fae(n,e){xn(n,t=>{const r=t.gc,s=r.length/2;let a;if(s>e){for(a=0;a<s;++a)delete t.data[r[a]];r.splice(0,s)}})}function Mh(n){return n.drawTicks?n.tickLength:0}function zR(n,e){if(!n.display)return 0;const t=Us(n.font,e),r=Pa(n.padding);return(Nr(n.text)?n.text.length:1)*t.lineHeight+r.height}function qae(n,e){return wu(n,{scale:e,type:"scale"})}function zae(n,e,t){return wu(n,{tick:t,index:e,type:"tick"})}function Uae(n,e,t){let r=B5(n);return(t&&e!=="right"||!t&&e==="right")&&(r=Rae(r)),r}function Vae(n,e,t,r){const{top:s,left:a,bottom:o,right:l,chart:c}=n,{chartArea:d,scales:m}=c;let p=0,x,v,_;const w=o-s,j=l-a;if(n.isHorizontal()){if(v=ii(r,a,l),Qt(t)){const P=Object.keys(t)[0],k=t[P];_=m[P].getPixelForValue(k)+w-e}else t==="center"?_=(d.bottom+d.top)/2+w-e:_=LR(n,t,e);x=l-a}else{if(Qt(t)){const P=Object.keys(t)[0],k=t[P];v=m[P].getPixelForValue(k)-j+e}else t==="center"?v=(d.left+d.right)/2-j+e:v=LR(n,t,e);_=ii(r,o,s),p=t==="left"?-Cr:Cr}return{titleX:v,titleY:_,maxWidth:x,rotation:p}}class zf extends rd{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:s}=this;return e=ao(e,Number.POSITIVE_INFINITY),t=ao(t,Number.NEGATIVE_INFINITY),r=ao(r,Number.POSITIVE_INFINITY),s=ao(s,Number.NEGATIVE_INFINITY),{min:ao(e,r),max:ao(t,s),minDefined:as(e),maxDefined:as(t)}}getMinMax(e){let{min:t,max:r,minDefined:s,maxDefined:a}=this.getUserBounds(),o;if(s&&a)return{min:t,max:r};const l=this.getMatchingVisibleMetas();for(let c=0,d=l.length;c<d;++c)o=l[c].controller.getMinMax(this,e),s||(t=Math.min(t,o.min)),a||(r=Math.max(r,o.max));return t=a&&t>r?r:t,r=s&&t>r?t:r,{min:ao(t,ao(r,t)),max:ao(r,ao(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Fn(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:s,grace:a,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Gse(this,a,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?qR(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=kae(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,r;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,e=!e),this._startPixel=t,this._endPixel=r,this._reversePixels=e,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Fn(this.options.afterUpdate,[this])}beforeSetDimensions(){Fn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Fn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Fn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Fn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,s,a;for(r=0,s=e.length;r<s;r++)a=e[r],a.label=Fn(t.callback,[a.value,r,e],this)}afterTickToLabelConversion(){Fn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Fn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=FR(this.ticks.length,e.ticks.maxTicksLimit),s=t.minRotation||0,a=t.maxRotation;let o=s,l,c,d;if(!this._isVisible()||!t.display||s>=a||r<=1||!this.isHorizontal()){this.labelRotation=s;return}const m=this._getLabelSizes(),p=m.widest.width,x=m.highest.height,v=ss(this.chart.width-p,0,this.maxWidth);l=e.offset?this.maxWidth/r:v/(r-1),p+6>l&&(l=v/(r-(e.offset?.5:1)),c=this.maxHeight-Mh(e.grid)-t.padding-zR(e.title,this.chart.options.font),d=Math.sqrt(p*p+x*x),o=vse(Math.min(Math.asin(ss((m.highest.height+6)/l,-1,1)),Math.asin(ss(c/d,-1,1))-Math.asin(ss(x/d,-1,1)))),o=Math.max(s,Math.min(a,o))),this.labelRotation=o}afterCalculateLabelRotation(){Fn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Fn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:s,grid:a}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=zR(s,t.options.font);if(l?(e.width=this.maxWidth,e.height=Mh(a)+c):(e.height=this.maxHeight,e.width=Mh(a)+c),r.display&&this.ticks.length){const{first:d,last:m,widest:p,highest:x}=this._getLabelSizes(),v=r.padding*2,_=pl(this.labelRotation),w=Math.cos(_),j=Math.sin(_);if(l){const P=r.mirror?0:j*p.width+w*x.height;e.height=Math.min(this.maxHeight,e.height+P+v)}else{const P=r.mirror?0:w*p.width+j*x.height;e.width=Math.min(this.maxWidth,e.width+P+v)}this._calculatePadding(d,m,j,w)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,s){const{ticks:{align:a,padding:o},position:l}=this.options,c=this.labelRotation!==0,d=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,p=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,v=0;c?d?(x=s*e.width,v=r*t.height):(x=r*e.height,v=s*t.width):a==="start"?v=t.width:a==="end"?x=e.width:a!=="inner"&&(x=e.width/2,v=t.width/2),this.paddingLeft=Math.max((x-m+o)*this.width/(this.width-m),0),this.paddingRight=Math.max((v-p+o)*this.width/(this.width-p),0)}else{let m=t.height/2,p=e.height/2;a==="start"?(m=0,p=e.height):a==="end"&&(m=t.height,p=0),this.paddingTop=m+o,this.paddingBottom=p+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Fn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,r;for(t=0,r=e.length;t<r;t++)mn(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=qR(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:s,_longestTextCache:a}=this,o=[],l=[],c=Math.floor(t/FR(t,r));let d=0,m=0,p,x,v,_,w,j,P,k,I,M,D;for(p=0;p<t;p+=c){if(_=e[p].label,w=this._resolveTickFontOptions(p),s.font=j=w.string,P=a[j]=a[j]||{data:{},gc:[]},k=w.lineHeight,I=M=0,!mn(_)&&!Nr(_))I=hR(s,P.data,P.gc,I,_),M=k;else if(Nr(_))for(x=0,v=_.length;x<v;++x)D=_[x],!mn(D)&&!Nr(D)&&(I=hR(s,P.data,P.gc,I,D),M+=k);o.push(I),l.push(M),d=Math.max(I,d),m=Math.max(M,m)}Fae(a,t);const O=o.indexOf(d),q=l.indexOf(m),F=U=>({width:o[U]||0,height:l[U]||0});return{first:F(0),last:F(t-1),widest:F(O),highest:F(q),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return _se(this._alignToPixels?Vd(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=zae(this.getContext(),e,r))}return this.$context||(this.$context=qae(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=pl(this.labelRotation),r=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),a=this._getLabelSizes(),o=e.autoSkipPadding||0,l=a?a.widest.width+o:0,c=a?a.highest.height+o:0;return this.isHorizontal()?c*r>l*s?l/r:c/s:c*s<l*r?c/r:l/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,s=this.options,{grid:a,position:o,border:l}=s,c=a.offset,d=this.isHorizontal(),p=this.ticks.length+(c?1:0),x=Mh(a),v=[],_=l.setContext(this.getContext()),w=_.display?_.width:0,j=w/2,P=function(te){return Vd(r,te,w)};let k,I,M,D,O,q,F,U,B,G,X,Q;if(o==="top")k=P(this.bottom),q=this.bottom-x,U=k-j,G=P(e.top)+j,Q=e.bottom;else if(o==="bottom")k=P(this.top),G=e.top,Q=P(e.bottom)-j,q=k+j,U=this.top+x;else if(o==="left")k=P(this.right),O=this.right-x,F=k-j,B=P(e.left)+j,X=e.right;else if(o==="right")k=P(this.left),B=e.left,X=P(e.right)-j,O=k+j,F=this.left+x;else if(t==="x"){if(o==="center")k=P((e.top+e.bottom)/2+.5);else if(Qt(o)){const te=Object.keys(o)[0],ie=o[te];k=P(this.chart.scales[te].getPixelForValue(ie))}G=e.top,Q=e.bottom,q=k+j,U=q+x}else if(t==="y"){if(o==="center")k=P((e.left+e.right)/2);else if(Qt(o)){const te=Object.keys(o)[0],ie=o[te];k=P(this.chart.scales[te].getPixelForValue(ie))}O=k-j,F=O-x,B=e.left,X=e.right}const Y=Bt(s.ticks.maxTicksLimit,p),ne=Math.max(1,Math.ceil(p/Y));for(I=0;I<p;I+=ne){const te=this.getContext(I),ie=a.setContext(te),$=l.setContext(te),H=ie.lineWidth,se=ie.color,W=$.dash||[],ee=$.dashOffset,K=ie.tickWidth,oe=ie.tickColor,re=ie.tickBorderDash||[],me=ie.tickBorderDashOffset;M=Lae(this,I,c),M!==void 0&&(D=Vd(r,M,H),d?O=F=B=X=D:q=U=G=Q=D,v.push({tx1:O,ty1:q,tx2:F,ty2:U,x1:B,y1:G,x2:X,y2:Q,width:H,color:se,borderDash:W,borderDashOffset:ee,tickWidth:K,tickColor:oe,tickBorderDash:re,tickBorderDashOffset:me}))}return this._ticksLength=p,this._borderValue=k,v}_computeLabelItems(e){const t=this.axis,r=this.options,{position:s,ticks:a}=r,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:m,mirror:p}=a,x=Mh(r.grid),v=x+m,_=p?-m:v,w=-pl(this.labelRotation),j=[];let P,k,I,M,D,O,q,F,U,B,G,X,Q="middle";if(s==="top")O=this.bottom-_,q=this._getXAxisLabelAlignment();else if(s==="bottom")O=this.top+_,q=this._getXAxisLabelAlignment();else if(s==="left"){const ne=this._getYAxisLabelAlignment(x);q=ne.textAlign,D=ne.x}else if(s==="right"){const ne=this._getYAxisLabelAlignment(x);q=ne.textAlign,D=ne.x}else if(t==="x"){if(s==="center")O=(e.top+e.bottom)/2+v;else if(Qt(s)){const ne=Object.keys(s)[0],te=s[ne];O=this.chart.scales[ne].getPixelForValue(te)+v}q=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")D=(e.left+e.right)/2-v;else if(Qt(s)){const ne=Object.keys(s)[0],te=s[ne];D=this.chart.scales[ne].getPixelForValue(te)}q=this._getYAxisLabelAlignment(x).textAlign}t==="y"&&(c==="start"?Q="top":c==="end"&&(Q="bottom"));const Y=this._getLabelSizes();for(P=0,k=l.length;P<k;++P){I=l[P],M=I.label;const ne=a.setContext(this.getContext(P));F=this.getPixelForTick(P)+a.labelOffset,U=this._resolveTickFontOptions(P),B=U.lineHeight,G=Nr(M)?M.length:1;const te=G/2,ie=ne.color,$=ne.textStrokeColor,H=ne.textStrokeWidth;let se=q;o?(D=F,q==="inner"&&(P===k-1?se=this.options.reverse?"left":"right":P===0?se=this.options.reverse?"right":"left":se="center"),s==="top"?d==="near"||w!==0?X=-G*B+B/2:d==="center"?X=-Y.highest.height/2-te*B+B:X=-Y.highest.height+B/2:d==="near"||w!==0?X=B/2:d==="center"?X=Y.highest.height/2-te*B:X=Y.highest.height-G*B,p&&(X*=-1),w!==0&&!ne.showLabelBackdrop&&(D+=B/2*Math.sin(w))):(O=F,X=(1-G)*B/2);let W;if(ne.showLabelBackdrop){const ee=Pa(ne.backdropPadding),K=Y.heights[P],oe=Y.widths[P];let re=X-ee.top,me=0-ee.left;switch(Q){case"middle":re-=K/2;break;case"bottom":re-=K;break}switch(q){case"center":me-=oe/2;break;case"right":me-=oe;break;case"inner":P===k-1?me-=oe:P>0&&(me-=oe/2);break}W={left:me,top:re,width:oe+ee.width,height:K+ee.height,color:ne.backdropColor}}j.push({label:M,font:U,textOffset:X,options:{rotation:w,color:ie,strokeColor:$,strokeWidth:H,textAlign:se,textBaseline:Q,translation:[D,O],backdrop:W}})}return j}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-pl(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:s,padding:a}}=this.options,o=this._getLabelSizes(),l=e+a,c=o.widest.width;let d,m;return t==="left"?s?(m=this.right+a,r==="near"?d="left":r==="center"?(d="center",m+=c/2):(d="right",m+=c)):(m=this.right-l,r==="near"?d="right":r==="center"?(d="center",m-=c/2):(d="left",m=this.left)):t==="right"?s?(m=this.left+a,r==="near"?d="right":r==="center"?(d="center",m-=c/2):(d="left",m-=c)):(m=this.left+l,r==="near"?d="left":r==="center"?(d="center",m+=c/2):(d="right",m=this.right)):d="right",{textAlign:d,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:s,width:a,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,s,a,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(a=>a.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,r=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,o;const l=(c,d,m)=>{!m.width||!m.color||(r.save(),r.lineWidth=m.width,r.strokeStyle=m.color,r.setLineDash(m.borderDash||[]),r.lineDashOffset=m.borderDashOffset,r.beginPath(),r.moveTo(c.x,c.y),r.lineTo(d.x,d.y),r.stroke(),r.restore())};if(t.display)for(a=0,o=s.length;a<o;++a){const c=s[a];t.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),t.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:s}}=this,a=r.setContext(this.getContext()),o=r.display?a.width:0;if(!o)return;const l=s.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,m,p,x;this.isHorizontal()?(d=Vd(e,this.left,o)-o/2,m=Vd(e,this.right,l)+l/2,p=x=c):(p=Vd(e,this.top,o)-o/2,x=Vd(e,this.bottom,l)+l/2,d=m=c),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(d,p),t.lineTo(m,x),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,s=this._computeLabelArea();s&&my(r,s);const a=this.getLabelItems(e);for(const o of a){const l=o.options,c=o.font,d=o.label,m=o.textOffset;Cx(r,d,0,m,c,l)}s&&py(r)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:s}}=this;if(!r.display)return;const a=Us(r.font),o=Pa(r.padding),l=r.align;let c=a.lineHeight/2;t==="bottom"||t==="center"||Qt(t)?(c+=o.bottom,Nr(r.text)&&(c+=a.lineHeight*(r.text.length-1))):c+=o.top;const{titleX:d,titleY:m,maxWidth:p,rotation:x}=Vae(this,c,t,l);Cx(e,r.text,0,0,a,{color:r.color,maxWidth:p,rotation:x,textAlign:Uae(l,t,s),textBaseline:"middle",translation:[d,m]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=Bt(e.grid&&e.grid.z,-1),s=Bt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==zf.prototype.draw?[{z:t,draw:a=>{this.draw(a)}}]:[{z:r,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:t,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",s=[];let a,o;for(a=0,o=t.length;a<o;++a){const l=t[a];l[r]===this.id&&(!e||l.type===e)&&s.push(l)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Us(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Ig{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;$ae(t)&&(r=this.register(t));const s=this.items,a=e.id,o=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in s||(s[a]=e,Bae(e,o,r),this.override&&or.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,s=this.scope;r in t&&delete t[r],s&&r in or[s]&&(delete or[s][r],this.override&&delete fu[r])}}function Bae(n,e,t){const r=dm(Object.create(null),[t?or.get(t):{},or.get(e),n.defaults]);or.set(e,r),n.defaultRoutes&&Wae(e,n.defaultRoutes),n.descriptors&&or.describe(e,n.descriptors)}function Wae(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),s=r.pop(),a=[n].concat(r).join("."),o=e[t].split("."),l=o.pop(),c=o.join(".");or.route(a,s,c,l)})}function $ae(n){return"id"in n&&"defaults"in n}class Hae{constructor(){this.controllers=new Ig(xy,"datasets",!0),this.elements=new Ig(rd,"elements"),this.plugins=new Ig(Object,"plugins"),this.scales=new Ig(zf,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(s=>{const a=r||this._getRegistryForType(s);r||a.isForType(s)||a===this.plugins&&s.id?this._exec(e,a,s):xn(s,o=>{const l=r||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,r){const s=QC(e);Fn(r["before"+s],[],r),t[e](r),Fn(r["after"+s],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return s}}var lo=new Hae;class Yae{constructor(){this._init=void 0}notify(e,t,r,s){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=s?this._descriptors(e).filter(s):this._descriptors(e),o=this._notify(a,e,t,r);return t==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,r,s){s=s||{};for(const a of e){const o=a.plugin,l=o[r],c=[t,s,a.options];if(Fn(l,c,o)===!1&&s.cancelable)return!1}return!0}invalidate(){mn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,s=Bt(r.options&&r.options.plugins,{}),a=Gae(r);return s===!1&&!t?[]:Kae(e,a,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,s=(a,o)=>a.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(s(t,r),e,"stop"),this._notify(s(r,t),e,"start")}}function Gae(n){const e={},t=[],r=Object.keys(lo.plugins.items);for(let a=0;a<r.length;a++)t.push(lo.getPlugin(r[a]));const s=n.plugins||[];for(let a=0;a<s.length;a++){const o=s[a];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function Zae(n,e){return!e&&n===!1?null:n===!0?{}:n}function Kae(n,{plugins:e,localIds:t},r,s){const a=[],o=n.getContext();for(const l of e){const c=l.id,d=Zae(r[c],s);d!==null&&a.push({plugin:l,options:Jae(n.config,{plugin:l,local:t[c]},d,o)})}return a}function Jae(n,{plugin:e,local:t},r,s){const a=n.pluginScopeKeys(e),o=n.getOptionScopes(r,a);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function AN(n,e){const t=or.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function Qae(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function Xae(n,e){return n===e?"_index_":"_value_"}function UR(n){if(n==="x"||n==="y"||n==="r")return n}function eoe(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function RN(n,...e){if(UR(n))return n;for(const t of e){const r=t.axis||eoe(t.position)||n.length>1&&UR(n[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function VR(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function toe(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(r=>r.xAxisID===n||r.yAxisID===n);if(t.length)return VR(n,"x",t[0])||VR(n,"y",t[0])}return{}}function noe(n,e){const t=fu[n.type]||{scales:{}},r=e.scales||{},s=AN(n.type,e),a=Object.create(null);return Object.keys(r).forEach(o=>{const l=r[o];if(!Qt(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=RN(o,l,toe(o,n),or.scales[l.type]),d=Xae(c,s),m=t.scales||{};a[o]=Hh(Object.create(null),[{axis:c},l,m[c],m[d]])}),n.data.datasets.forEach(o=>{const l=o.type||n.type,c=o.indexAxis||AN(l,e),m=(fu[l]||{}).scales||{};Object.keys(m).forEach(p=>{const x=Qae(p,c),v=o[x+"AxisID"]||x;a[v]=a[v]||Object.create(null),Hh(a[v],[{axis:x},r[v],m[p]])})}),Object.keys(a).forEach(o=>{const l=a[o];Hh(l,[or.scales[l.type],or.scale])}),a}function f6(n){const e=n.options||(n.options={});e.plugins=Bt(e.plugins,{}),e.scales=noe(n,e)}function h6(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function roe(n){return n=n||{},n.data=h6(n.data),f6(n),n}const BR=new Map,m6=new Set;function Ag(n,e){let t=BR.get(n);return t||(t=e(),BR.set(n,t),m6.add(t)),t}const kh=(n,e,t)=>{const r=uu(e,t);r!==void 0&&n.add(r)};class soe{constructor(e){this._config=roe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=h6(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),f6(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Ag(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Ag(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Ag(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return Ag(`${r}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let s=r.get(e);return(!s||t)&&(s=new Map,r.set(e,s)),s}getOptionScopes(e,t,r){const{options:s,type:a}=this,o=this._cachedScopes(e,r),l=o.get(t);if(l)return l;const c=new Set;t.forEach(m=>{e&&(c.add(e),m.forEach(p=>kh(c,e,p))),m.forEach(p=>kh(c,s,p)),m.forEach(p=>kh(c,fu[a]||{},p)),m.forEach(p=>kh(c,or,p)),m.forEach(p=>kh(c,ON,p))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),m6.has(t)&&o.set(t,d),d}chartOptionScopes(){const{options:e,type:t}=this;return[e,fu[t]||{},or.datasets[t]||{},{type:t},or,ON]}resolveNamedOptions(e,t,r,s=[""]){const a={$shared:!0},{resolver:o,subPrefixes:l}=WR(this._resolverCache,e,s);let c=o;if(aoe(o,t)){a.$shared=!1,r=Wc(r)?r():r;const d=this.createResolver(e,r,l);c=kf(o,r,d)}for(const d of t)a[d]=c[d];return a}createResolver(e,t,r=[""],s){const{resolver:a}=WR(this._resolverCache,e,r);return Qt(t)?kf(a,t,void 0,s):a}}function WR(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const s=t.join();let a=r.get(s);return a||(a={resolver:r1(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},r.set(s,a)),a}const ioe=n=>Qt(n)&&Object.getOwnPropertyNames(n).some(e=>Wc(n[e]));function aoe(n,e){const{isScriptable:t,isIndexable:r}=Y5(n);for(const s of e){const a=t(s),o=r(s),l=(o||a)&&n[s];if(a&&(Wc(l)||ioe(l))||o&&Nr(l))return!0}return!1}var ooe="4.5.1";const loe=["top","bottom","left","right","chartArea"];function $R(n,e){return n==="top"||n==="bottom"||loe.indexOf(n)===-1&&e==="x"}function HR(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function YR(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Fn(t&&t.onComplete,[n],e)}function coe(n){const e=n.chart,t=e.options.animation;Fn(t&&t.onProgress,[n],e)}function p6(n){return a1()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Xg={},GR=n=>{const e=p6(n);return Object.values(Xg).filter(t=>t.canvas===e).pop()};function doe(n,e,t){const r=Object.keys(n);for(const s of r){const a=+s;if(a>=e){const o=n[s];delete n[s],(t>0||a>e)&&(n[a+t]=o)}}}function uoe(n,e,t,r){return!t||n.type==="mouseout"?null:r?e:n}class vy{static defaults=or;static instances=Xg;static overrides=fu;static registry=lo;static version=ooe;static getChart=GR;static register(...e){lo.add(...e),ZR()}static unregister(...e){lo.remove(...e),ZR()}constructor(e,t){const r=this.config=new soe(t),s=p6(e),a=GR(s);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||Mae(s)),this.platform.updateConfig(r);const l=this.platform.acquireContext(s,o.aspectRatio),c=l&&l.canvas,d=c&&c.height,m=c&&c.width;if(this.id=ase(),this.ctx=l,this.canvas=c,this.width=m,this.height=d,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Yae,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Nse(p=>this.update(p),o.resizeDelay||0),this._dataChanges=[],Xg[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}cl.listen(this,"complete",YR),cl.listen(this,"progress",coe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:s,_aspectRatio:a}=this;return mn(e)?t&&a?a:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return lo}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():xR(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return mR(this.canvas,this.ctx),this}stop(){return cl.stop(this),this}resize(e,t){cl.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,s=this.canvas,a=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,e,t,a),l=r.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,xR(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Fn(r.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};xn(t,(r,s)=>{r.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,s=Object.keys(r).reduce((o,l)=>(o[l]=!1,o),{});let a=[];t&&(a=a.concat(Object.keys(t).map(o=>{const l=t[o],c=RN(o,l),d=c==="r",m=c==="x";return{options:l,dposition:d?"chartArea":m?"bottom":"left",dtype:d?"radialLinear":m?"category":"linear"}}))),xn(a,o=>{const l=o.options,c=l.id,d=RN(c,l),m=Bt(l.type,o.dtype);(l.position===void 0||$R(l.position,d)!==$R(o.dposition))&&(l.position=o.dposition),s[c]=!0;let p=null;if(c in r&&r[c].type===m)p=r[c];else{const x=lo.getScale(m);p=new x({id:c,type:m,ctx:this.ctx,chart:this}),r[p.id]=p}p.init(l,e)}),xn(s,(o,l)=>{o||delete r[l]}),xn(r,o=>{Oc.configure(this,o,o.options),Oc.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((s,a)=>s.index-a.index),r>t){for(let s=t;s<r;++s)this._destroyDatasetMeta(s);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(HR("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,s)=>{t.filter(a=>a===r._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,s;for(this._removeUnreferencedMetasets(),r=0,s=t.length;r<s;r++){const a=t[r];let o=this.getDatasetMeta(r);const l=a.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=l,o.indexAxis=a.indexAxis||AN(l,this.options),o.order=a.order||0,o.index=r,o.label=""+a.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const c=lo.getController(l),{datasetElementType:d,dataElementType:m}=or.datasets[l];Object.assign(c,{dataElementType:lo.getElement(m),datasetElementType:d&&lo.getElement(d)}),o.controller=new c(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){xn(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let d=0,m=this.data.datasets.length;d<m;d++){const{controller:p}=this.getDatasetMeta(d),x=!s&&a.indexOf(p)===-1;p.buildOrUpdateElements(x),o=Math.max(+p.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),s||xn(a,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(HR("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){xn(this.scales,e=>{Oc.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!sR(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:s,count:a}of t){const o=r==="_removeElements"?-a:a;doe(e,s,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=a=>new Set(e.filter(o=>o[0]===a).map((o,l)=>l+","+o.splice(1).join(","))),s=r(0);for(let a=1;a<t;a++)if(!sR(s,r(a)))return;return Array.from(s).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Oc.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],xn(this.boxes,s=>{r&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,a)=>{s._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,Wc(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),s={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(r.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(cl.has(this)?this.attached&&!cl.running(this)&&cl.start(this):(this.draw(),YR({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let s,a;for(s=0,a=t.length;s<a;++s){const o=t[s];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r={meta:e,index:e.index,cancelable:!0},s=r6(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(s&&my(t,s),e.controller.draw(),s&&py(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return mm(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,s){const a=lae.modes[t];return typeof a=="function"?a(this,e,r,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let s=r.filter(a=>a&&a._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=wu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const s=r?"show":"hide",a=this.getDatasetMeta(e),o=a.controller._resolveAnimations(void 0,s);um(t)?(a.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(a,{visible:r}),this.update(l=>l.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),cl.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),mR(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Xg[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(a,o)=>{t.addEventListener(this,a,o),e[a]=o},s=(a,o,l)=>{a.offsetX=o,a.offsetY=l,this._eventHandler(a)};xn(this.options.events,a=>r(a,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(c,d)=>{t.addEventListener(this,c,d),e[c]=d},s=(c,d)=>{e[c]&&(t.removeEventListener(this,c,d),delete e[c])},a=(c,d)=>{this.canvas&&this.resize(c,d)};let o;const l=()=>{s("attach",l),this.attached=!0,this.resize(),r("resize",a),r("detach",o)};o=()=>{this.attached=!1,s("resize",a),this._stop(),this._resize(0,0),r("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){xn(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},xn(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const s=r?"set":"remove";let a,o,l,c;for(t==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+s+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){o=e[l];const d=o&&this.getDatasetMeta(o.datasetIndex).controller;d&&d[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:a,index:o})=>{const l=this.getDatasetMeta(a);if(!l)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:l.data[o],index:o}});!Sx(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const s=this.options.hover,a=(c,d)=>c.filter(m=>!d.some(p=>m.datasetIndex===p.datasetIndex&&m.index===p.index)),o=a(t,e),l=r?e:a(e,t);o.length&&this.updateHoverStyle(o,s.mode,!1),l.length&&s.mode&&this.updateHoverStyle(l,s.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,s)===!1)return;const a=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(a||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:s=[],options:a}=this,o=t,l=this._getActiveElements(e,s,r,o),c=fse(e),d=uoe(e,this._lastEvent,r,c);r&&(this._lastEvent=null,Fn(a.onHover,[e,l,this],this),c&&Fn(a.onClick,[e,l,this],this));const m=!Sx(l,s);return(m||t)&&(this._active=l,this._updateHoverStyles(l,s,t)),this._lastEvent=d,m}_getActiveElements(e,t,r,s){if(e.type==="mouseout")return[];if(!r)return t;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,s)}}function ZR(){return xn(vy.instances,n=>n._plugins.invalidate())}function foe(n,e,t){const{startAngle:r,x:s,y:a,outerRadius:o,innerRadius:l,options:c}=e,{borderWidth:d,borderJoinStyle:m}=c,p=Math.min(d/o,oi(r-t));if(n.beginPath(),n.arc(s,a,o-d/2,r+p/2,t-p/2),l>0){const x=Math.min(d/l,oi(r-t));n.arc(s,a,l+d/2,t-x/2,r+x/2,!0)}else{const x=Math.min(d/2,o*oi(r-t));if(m==="round")n.arc(s,a,x,t-Tn/2,r+Tn/2,!0);else if(m==="bevel"){const v=2*x*x,_=-v*Math.cos(t+Tn/2)+s,w=-v*Math.sin(t+Tn/2)+a,j=v*Math.cos(r+Tn/2)+s,P=v*Math.sin(r+Tn/2)+a;n.lineTo(_,w),n.lineTo(j,P)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function hoe(n,e,t){const{startAngle:r,pixelMargin:s,x:a,y:o,outerRadius:l,innerRadius:c}=e;let d=s/l;n.beginPath(),n.arc(a,o,l,r-d,t+d),c>s?(d=s/c,n.arc(a,o,c,t+d,r-d,!0)):n.arc(a,o,s,t+Cr,r-Cr),n.closePath(),n.clip()}function moe(n){return n1(n,["outerStart","outerEnd","innerStart","innerEnd"])}function poe(n,e,t,r){const s=moe(n.options.borderRadius),a=(t-e)/2,o=Math.min(a,r*e/2),l=c=>{const d=(t-Math.min(a,c))*r/2;return ss(c,0,Math.min(a,d))};return{outerStart:l(s.outerStart),outerEnd:l(s.outerEnd),innerStart:ss(s.innerStart,0,o),innerEnd:ss(s.innerEnd,0,o)}}function Xu(n,e,t,r){return{x:t+n*Math.cos(e),y:r+n*Math.sin(e)}}function kx(n,e,t,r,s,a){const{x:o,y:l,startAngle:c,pixelMargin:d,innerRadius:m}=e,p=Math.max(e.outerRadius+r+t-d,0),x=m>0?m+r+t+d:0;let v=0;const _=s-c;if(r){const ne=m>0?m-r:0,te=p>0?p-r:0,ie=(ne+te)/2,$=ie!==0?_*ie/(ie+r):_;v=(_-$)/2}const w=Math.max(.001,_*p-t/Tn)/p,j=(_-w)/2,P=c+j+v,k=s-j-v,{outerStart:I,outerEnd:M,innerStart:D,innerEnd:O}=poe(e,x,p,k-P),q=p-I,F=p-M,U=P+I/q,B=k-M/F,G=x+D,X=x+O,Q=P+D/G,Y=k-O/X;if(n.beginPath(),a){const ne=(U+B)/2;if(n.arc(o,l,p,U,ne),n.arc(o,l,p,ne,B),M>0){const H=Xu(F,B,o,l);n.arc(H.x,H.y,M,B,k+Cr)}const te=Xu(X,k,o,l);if(n.lineTo(te.x,te.y),O>0){const H=Xu(X,Y,o,l);n.arc(H.x,H.y,O,k+Cr,Y+Math.PI)}const ie=(k-O/x+(P+D/x))/2;if(n.arc(o,l,x,k-O/x,ie,!0),n.arc(o,l,x,ie,P+D/x,!0),D>0){const H=Xu(G,Q,o,l);n.arc(H.x,H.y,D,Q+Math.PI,P-Cr)}const $=Xu(q,P,o,l);if(n.lineTo($.x,$.y),I>0){const H=Xu(q,U,o,l);n.arc(H.x,H.y,I,P-Cr,U)}}else{n.moveTo(o,l);const ne=Math.cos(U)*p+o,te=Math.sin(U)*p+l;n.lineTo(ne,te);const ie=Math.cos(B)*p+o,$=Math.sin(B)*p+l;n.lineTo(ie,$)}n.closePath()}function goe(n,e,t,r,s){const{fullCircles:a,startAngle:o,circumference:l}=e;let c=e.endAngle;if(a){kx(n,e,t,r,c,s);for(let d=0;d<a;++d)n.fill();isNaN(l)||(c=o+(l%Jn||Jn))}return kx(n,e,t,r,c,s),n.fill(),c}function xoe(n,e,t,r,s){const{fullCircles:a,startAngle:o,circumference:l,options:c}=e,{borderWidth:d,borderJoinStyle:m,borderDash:p,borderDashOffset:x,borderRadius:v}=c,_=c.borderAlign==="inner";if(!d)return;n.setLineDash(p||[]),n.lineDashOffset=x,_?(n.lineWidth=d*2,n.lineJoin=m||"round"):(n.lineWidth=d,n.lineJoin=m||"bevel");let w=e.endAngle;if(a){kx(n,e,t,r,w,s);for(let j=0;j<a;++j)n.stroke();isNaN(l)||(w=o+(l%Jn||Jn))}_&&hoe(n,e,w),c.selfJoin&&w-o>=Tn&&v===0&&m!=="miter"&&foe(n,e,w),a||(kx(n,e,t,r,w,s),n.stroke())}class yoe extends rd{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,r){const s=this.getProps(["x","y"],r),{angle:a,distance:o}=F5(s,{x:e,y:t}),{startAngle:l,endAngle:c,innerRadius:d,outerRadius:m,circumference:p}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),x=(this.options.spacing+this.options.borderWidth)/2,v=Bt(p,c-l),_=hm(a,l,c)&&l!==c,w=v>=Jn||_,j=gl(o,d+x,m+x);return w&&j}getCenterPoint(e){const{x:t,y:r,startAngle:s,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:d}=this.options,m=(s+a)/2,p=(o+l+d+c)/2;return{x:t+Math.cos(m)*p,y:r+Math.sin(m)*p}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:r}=this,s=(t.offset||0)/4,a=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=r>Jn?Math.floor(r/Jn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*s,Math.sin(l)*s);const c=1-Math.sin(Math.min(Tn,r||0)),d=s*c;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,goe(e,this,d,a,o),xoe(e,this,d,a,o),e.restore()}}function g6(n,e,t=e){n.lineCap=Bt(t.borderCapStyle,e.borderCapStyle),n.setLineDash(Bt(t.borderDash,e.borderDash)),n.lineDashOffset=Bt(t.borderDashOffset,e.borderDashOffset),n.lineJoin=Bt(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Bt(t.borderWidth,e.borderWidth),n.strokeStyle=Bt(t.borderColor,e.borderColor)}function voe(n,e,t){n.lineTo(t.x,t.y)}function boe(n){return n.stepped?qse:n.tension||n.cubicInterpolationMode==="monotone"?zse:voe}function x6(n,e,t={}){const r=n.length,{start:s=0,end:a=r-1}=t,{start:o,end:l}=e,c=Math.max(s,o),d=Math.min(a,l),m=s<o&&a<o||s>l&&a>l;return{count:r,start:c,loop:e.loop,ilen:d<c&&!m?r+d-c:d-c}}function _oe(n,e,t,r){const{points:s,options:a}=e,{count:o,start:l,loop:c,ilen:d}=x6(s,t,r),m=boe(a);let{move:p=!0,reverse:x}=r||{},v,_,w;for(v=0;v<=d;++v)_=s[(l+(x?d-v:v))%o],!_.skip&&(p?(n.moveTo(_.x,_.y),p=!1):m(n,w,_,x,a.stepped),w=_);return c&&(_=s[(l+(x?d:0))%o],m(n,w,_,x,a.stepped)),!!c}function woe(n,e,t,r){const s=e.points,{count:a,start:o,ilen:l}=x6(s,t,r),{move:c=!0,reverse:d}=r||{};let m=0,p=0,x,v,_,w,j,P;const k=M=>(o+(d?l-M:M))%a,I=()=>{w!==j&&(n.lineTo(m,j),n.lineTo(m,w),n.lineTo(m,P))};for(c&&(v=s[k(0)],n.moveTo(v.x,v.y)),x=0;x<=l;++x){if(v=s[k(x)],v.skip)continue;const M=v.x,D=v.y,O=M|0;O===_?(D<w?w=D:D>j&&(j=D),m=(p*m+M)/++p):(I(),n.lineTo(M,D),_=O,p=0,w=j=D),P=D}I()}function LN(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?woe:_oe}function Soe(n){return n.stepped?yie:n.tension||n.cubicInterpolationMode==="monotone"?vie:Zd}function joe(n,e,t,r){let s=e._path;s||(s=e._path=new Path2D,e.path(s,t,r)&&s.closePath()),g6(n,e.options),n.stroke(s)}function Noe(n,e,t,r){const{segments:s,options:a}=e,o=LN(e);for(const l of s)g6(n,a,l.style),n.beginPath(),o(n,e,l,{start:t,end:t+r-1})&&n.closePath(),n.stroke()}const Coe=typeof Path2D=="function";function Toe(n,e,t,r){Coe&&!e.options.segment?joe(n,e,t,r):Noe(n,e,t,r)}class by extends rd{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const s=r.spanGaps?this._loop:this._fullLoop;die(this._points,r,e,s,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Nie(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,s=e[t],a=this.points,o=n6(this,{property:t,start:s,end:s});if(!o.length)return;const l=[],c=Soe(r);let d,m;for(d=0,m=o.length;d<m;++d){const{start:p,end:x}=o[d],v=a[p],_=a[x];if(v===_){l.push(v);continue}const w=Math.abs((s-v[t])/(_[t]-v[t])),j=c(v,_,w,r.stepped);j[t]=e[t],l.push(j)}return l.length===1?l[0]:l}pathSegment(e,t,r){return LN(this)(e,this,t,r)}path(e,t,r){const s=this.segments,a=LN(this);let o=this._loop;t=t||0,r=r||this.points.length-t;for(const l of s)o&=a(e,this,l,{start:t,end:t+r-1});return!!o}draw(e,t,r,s){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),Toe(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function KR(n,e,t,r){const s=n.options,{[t]:a}=n.getProps([t],r);return Math.abs(e-a)<s.radius+s.hitRadius}class Poe extends rd{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,r){const s=this.options,{x:a,y:o}=this.getProps(["x","y"],r);return Math.pow(e-a,2)+Math.pow(t-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,t){return KR(this,e,"x",t)}inYRange(e,t){return KR(this,e,"y",t)}getCenterPoint(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const r=t&&e.borderWidth||0;return(t+r)*2}draw(e,t){const r=this.options;this.skip||r.radius<.1||!mm(this,t,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,IN(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function y6(n,e){const{x:t,y:r,base:s,width:a,height:o}=n.getProps(["x","y","base","width","height"],e);let l,c,d,m,p;return n.horizontal?(p=o/2,l=Math.min(t,s),c=Math.max(t,s),d=r-p,m=r+p):(p=a/2,l=t-p,c=t+p,d=Math.min(r,s),m=Math.max(r,s)),{left:l,top:d,right:c,bottom:m}}function Ic(n,e,t,r){return n?0:ss(e,t,r)}function Moe(n,e,t){const r=n.options.borderWidth,s=n.borderSkipped,a=H5(r);return{t:Ic(s.top,a.top,0,t),r:Ic(s.right,a.right,0,e),b:Ic(s.bottom,a.bottom,0,t),l:Ic(s.left,a.left,0,e)}}function koe(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,a=hf(s),o=Math.min(e,t),l=n.borderSkipped,c=r||Qt(s);return{topLeft:Ic(!c||l.top||l.left,a.topLeft,0,o),topRight:Ic(!c||l.top||l.right,a.topRight,0,o),bottomLeft:Ic(!c||l.bottom||l.left,a.bottomLeft,0,o),bottomRight:Ic(!c||l.bottom||l.right,a.bottomRight,0,o)}}function Eoe(n){const e=y6(n),t=e.right-e.left,r=e.bottom-e.top,s=Moe(n,t/2,r/2),a=koe(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:a},inner:{x:e.left+s.l,y:e.top+s.t,w:t-s.l-s.r,h:r-s.t-s.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,a.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(s.b,s.r))}}}}function yj(n,e,t,r){const s=e===null,a=t===null,l=n&&!(s&&a)&&y6(n,r);return l&&(s||gl(e,l.left,l.right))&&(a||gl(t,l.top,l.bottom))}function Doe(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Ooe(n,e){n.rect(e.x,e.y,e.w,e.h)}function vj(n,e,t={}){const r=n.x!==t.x?-e:0,s=n.y!==t.y?-e:0,a=(n.x+n.w!==t.x+t.w?e:0)-r,o=(n.y+n.h!==t.y+t.h?e:0)-s;return{x:n.x+r,y:n.y+s,w:n.w+a,h:n.h+o,radius:n.radius}}class Ioe extends rd{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:s}}=this,{inner:a,outer:o}=Eoe(this),l=Doe(o.radius)?Tx:Ooe;e.save(),(o.w!==a.w||o.h!==a.h)&&(e.beginPath(),l(e,vj(o,t,a)),e.clip(),l(e,vj(a,-t,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),l(e,vj(a,t)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,t,r){return yj(this,e,t,r)}inXRange(e,t){return yj(this,e,null,t)}inYRange(e,t){return yj(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:s,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(t+s)/2:t,y:a?r:(r+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}function Aoe(n,e,t){const r=n.segments,s=n.points,a=e.points,o=[];for(const l of r){let{start:c,end:d}=l;d=_y(c,d,s);const m=FN(t,s[c],s[d],l.loop);if(!e.segments){o.push({source:l,target:m,start:s[c],end:s[d]});continue}const p=n6(e,m);for(const x of p){const v=FN(t,a[x.start],a[x.end],x.loop),_=t6(l,s,v);for(const w of _)o.push({source:w,target:x,start:{[t]:JR(m,v,"start",Math.max)},end:{[t]:JR(m,v,"end",Math.min)}})}}return o}function FN(n,e,t,r){if(r)return;let s=e[n],a=t[n];return n==="angle"&&(s=oi(s),a=oi(a)),{property:n,start:s,end:a}}function Roe(n,e){const{x:t=null,y:r=null}=n||{},s=e.points,a=[];return e.segments.forEach(({start:o,end:l})=>{l=_y(o,l,s);const c=s[o],d=s[l];r!==null?(a.push({x:c.x,y:r}),a.push({x:d.x,y:r})):t!==null&&(a.push({x:t,y:c.y}),a.push({x:t,y:d.y}))}),a}function _y(n,e,t){for(;e>n;e--){const r=t[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function JR(n,e,t,r){return n&&e?r(n[t],e[t]):n?n[t]:e?e[t]:0}function v6(n,e){let t=[],r=!1;return Nr(n)?(r=!0,t=n):t=Roe(n,e),t.length?new by({points:t,options:{tension:0},_loop:r,_fullLoop:r}):null}function QR(n){return n&&n.fill!==!1}function Loe(n,e,t){let s=n[e].fill;const a=[e];let o;if(!t)return s;for(;s!==!1&&a.indexOf(s)===-1;){if(!as(s))return s;if(o=n[s],!o)return!1;if(o.visible)return s;a.push(s),s=o.fill}return!1}function Foe(n,e,t){const r=Voe(n);if(Qt(r))return isNaN(r.value)?!1:r;let s=parseFloat(r);return as(s)&&Math.floor(s)===s?qoe(r[0],e,s,t):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function qoe(n,e,t,r){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=r?!1:t}function zoe(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:Qt(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function Uoe(n,e,t){let r;return n==="start"?r=t:n==="end"?r=e.options.reverse?e.min:e.max:Qt(n)?r=n.value:r=e.getBaseValue(),r}function Voe(n){const e=n.options,t=e.fill;let r=Bt(t&&t.target,t);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function Boe(n){const{scale:e,index:t,line:r}=n,s=[],a=r.segments,o=r.points,l=Woe(e,t);l.push(v6({x:null,y:e.bottom},r));for(let c=0;c<a.length;c++){const d=a[c];for(let m=d.start;m<=d.end;m++)$oe(s,o[m],l)}return new by({points:s,options:{}})}function Woe(n,e){const t=[],r=n.getMatchingVisibleMetas("line");for(let s=0;s<r.length;s++){const a=r[s];if(a.index===e)break;a.hidden||t.unshift(a.dataset)}return t}function $oe(n,e,t){const r=[];for(let s=0;s<t.length;s++){const a=t[s],{first:o,last:l,point:c}=Hoe(a,e,"x");if(!(!c||o&&l)){if(o)r.unshift(c);else if(n.push(c),!l)break}}n.push(...r)}function Hoe(n,e,t){const r=n.interpolate(e,t);if(!r)return{};const s=r[t],a=n.segments,o=n.points;let l=!1,c=!1;for(let d=0;d<a.length;d++){const m=a[d],p=o[m.start][t],x=o[m.end][t];if(gl(s,p,x)){l=s===p,c=s===x;break}}return{first:l,last:c,point:r}}class b6{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,r){const{x:s,y:a,radius:o}=this;return t=t||{start:0,end:Jn},e.arc(s,a,o,t.end,t.start,!0),!r.bounds}interpolate(e){const{x:t,y:r,radius:s}=this,a=e.angle;return{x:t+Math.cos(a)*s,y:r+Math.sin(a)*s,angle:a}}}function Yoe(n){const{chart:e,fill:t,line:r}=n;if(as(t))return Goe(e,t);if(t==="stack")return Boe(n);if(t==="shape")return!0;const s=Zoe(n);return s instanceof b6?s:v6(s,r)}function Goe(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function Zoe(n){return(n.scale||{}).getPointPositionForValue?Joe(n):Koe(n)}function Koe(n){const{scale:e={},fill:t}=n,r=zoe(t,e);if(as(r)){const s=e.isHorizontal();return{x:s?r:null,y:s?null:r}}return null}function Joe(n){const{scale:e,fill:t}=n,r=e.options,s=e.getLabels().length,a=r.reverse?e.max:e.min,o=Uoe(t,e,a),l=[];if(r.grid.circular){const c=e.getPointPositionForValue(0,a);return new b6({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(o)})}for(let c=0;c<s;++c)l.push(e.getPointPositionForValue(c,o));return l}function bj(n,e,t){const r=Yoe(e),{chart:s,index:a,line:o,scale:l,axis:c}=e,d=o.options,m=d.fill,p=d.backgroundColor,{above:x=p,below:v=p}=m||{},_=s.getDatasetMeta(a),w=r6(s,_);r&&o.points.length&&(my(n,t),Qoe(n,{line:o,target:r,above:x,below:v,area:t,scale:l,axis:c,clip:w}),py(n))}function Qoe(n,e){const{line:t,target:r,above:s,below:a,area:o,scale:l,clip:c}=e,d=t._loop?"angle":e.axis;n.save();let m=a;a!==s&&(d==="x"?(XR(n,r,o.top),_j(n,{line:t,target:r,color:s,scale:l,property:d,clip:c}),n.restore(),n.save(),XR(n,r,o.bottom)):d==="y"&&(eL(n,r,o.left),_j(n,{line:t,target:r,color:a,scale:l,property:d,clip:c}),n.restore(),n.save(),eL(n,r,o.right),m=s)),_j(n,{line:t,target:r,color:m,scale:l,property:d,clip:c}),n.restore()}function XR(n,e,t){const{segments:r,points:s}=e;let a=!0,o=!1;n.beginPath();for(const l of r){const{start:c,end:d}=l,m=s[c],p=s[_y(c,d,s)];a?(n.moveTo(m.x,m.y),a=!1):(n.lineTo(m.x,t),n.lineTo(m.x,m.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(p.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function eL(n,e,t){const{segments:r,points:s}=e;let a=!0,o=!1;n.beginPath();for(const l of r){const{start:c,end:d}=l,m=s[c],p=s[_y(c,d,s)];a?(n.moveTo(m.x,m.y),a=!1):(n.lineTo(t,m.y),n.lineTo(m.x,m.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(t,p.y)}n.lineTo(t,e.first().y),n.closePath(),n.clip()}function _j(n,e){const{line:t,target:r,property:s,color:a,scale:o,clip:l}=e,c=Aoe(t,r,s);for(const{source:d,target:m,start:p,end:x}of c){const{style:{backgroundColor:v=a}={}}=d,_=r!==!0;n.save(),n.fillStyle=v,Xoe(n,o,l,_&&FN(s,p,x)),n.beginPath();const w=!!t.pathSegment(n,d);let j;if(_){w?n.closePath():tL(n,r,x,s);const P=!!r.pathSegment(n,m,{move:w,reverse:!0});j=w&&P,j||tL(n,r,p,s)}n.closePath(),n.fill(j?"evenodd":"nonzero"),n.restore()}}function Xoe(n,e,t,r){const s=e.chart.chartArea,{property:a,start:o,end:l}=r||{};if(a==="x"||a==="y"){let c,d,m,p;a==="x"?(c=o,d=s.top,m=l,p=s.bottom):(c=s.left,d=o,m=s.right,p=l),n.beginPath(),t&&(c=Math.max(c,t.left),m=Math.min(m,t.right),d=Math.max(d,t.top),p=Math.min(p,t.bottom)),n.rect(c,d,m-c,p-d),n.clip()}}function tL(n,e,t,r){const s=e.interpolate(t,r);s&&n.lineTo(s.x,s.y)}var ele={id:"filler",afterDatasetsUpdate(n,e,t){const r=(n.data.datasets||[]).length,s=[];let a,o,l,c;for(o=0;o<r;++o)a=n.getDatasetMeta(o),l=a.dataset,c=null,l&&l.options&&l instanceof by&&(c={visible:n.isDatasetVisible(o),index:o,fill:Foe(l,o,r),chart:n,axis:a.controller.options.indexAxis,scale:a.vScale,line:l}),a.$filler=c,s.push(c);for(o=0;o<r;++o)c=s[o],!(!c||c.fill===!1)&&(c.fill=Loe(s,o,t.propagate))},beforeDraw(n,e,t){const r=t.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),a=n.chartArea;for(let o=s.length-1;o>=0;--o){const l=s[o].$filler;l&&(l.line.updateControlPoints(a,l.axis),r&&l.fill&&bj(n.ctx,l,a))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const r=n.getSortedVisibleDatasetMetas();for(let s=r.length-1;s>=0;--s){const a=r[s].$filler;QR(a)&&bj(n.ctx,a,n.chartArea)}},beforeDatasetDraw(n,e,t){const r=e.meta.$filler;!QR(r)||t.drawTime!=="beforeDatasetDraw"||bj(n.ctx,r,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const nL=(n,e)=>{let{boxHeight:t=e,boxWidth:r=e}=n;return n.usePointStyle&&(t=Math.min(t,e),r=n.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(e,t)}},tle=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class rL extends rd{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Fn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(r=>e.filter(r,this.chart.data))),e.sort&&(t=t.sort((r,s)=>e.sort(r,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,s=Us(r.font),a=s.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=nL(r,a);let d,m;t.font=s.string,this.isHorizontal()?(d=this.maxWidth,m=this._fitRows(o,a,l,c)+10):(m=this.maxHeight,d=this._fitCols(o,s,l,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(m,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,s){const{ctx:a,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],m=s+l;let p=e;a.textAlign="left",a.textBaseline="middle";let x=-1,v=-m;return this.legendItems.forEach((_,w)=>{const j=r+t/2+a.measureText(_.text).width;(w===0||d[d.length-1]+j+2*l>o)&&(p+=m,d[d.length-(w>0?0:1)]=0,v+=m,x++),c[w]={left:0,top:v,row:x,width:j,height:s},d[d.length-1]+=j+l}),p}_fitCols(e,t,r,s){const{ctx:a,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],m=o-e;let p=l,x=0,v=0,_=0,w=0;return this.legendItems.forEach((j,P)=>{const{itemWidth:k,itemHeight:I}=nle(r,t,a,j,s);P>0&&v+I+2*l>m&&(p+=x+l,d.push({width:x,height:v}),_+=x+l,w++,x=v=0),c[P]={left:_,top:v,col:w,width:k,height:I},x=Math.max(x,k),v+=I+l}),p+=x,d.push({width:x,height:v}),p}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:s},rtl:a}}=this,o=mf(a,this.left,this.width);if(this.isHorizontal()){let l=0,c=ii(r,this.left+s,this.right-this.lineWidths[l]);for(const d of t)l!==d.row&&(l=d.row,c=ii(r,this.left+s,this.right-this.lineWidths[l])),d.top+=this.top+e+s,d.left=o.leftForLtr(o.x(c),d.width),c+=d.width+s}else{let l=0,c=ii(r,this.top+e+s,this.bottom-this.columnSizes[l].height);for(const d of t)d.col!==l&&(l=d.col,c=ii(r,this.top+e+s,this.bottom-this.columnSizes[l].height)),d.top=c,d.left+=this.left+s,d.left=o.leftForLtr(o.x(d.left),d.width),c+=d.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;my(e,this),this._draw(),py(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:s}=this,{align:a,labels:o}=e,l=or.color,c=mf(e.rtl,this.left,this.width),d=Us(o.font),{padding:m}=o,p=d.size,x=p/2;let v;this.drawTitle(),s.textAlign=c.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=d.string;const{boxWidth:_,boxHeight:w,itemHeight:j}=nL(o,p),P=function(O,q,F){if(isNaN(_)||_<=0||isNaN(w)||w<0)return;s.save();const U=Bt(F.lineWidth,1);if(s.fillStyle=Bt(F.fillStyle,l),s.lineCap=Bt(F.lineCap,"butt"),s.lineDashOffset=Bt(F.lineDashOffset,0),s.lineJoin=Bt(F.lineJoin,"miter"),s.lineWidth=U,s.strokeStyle=Bt(F.strokeStyle,l),s.setLineDash(Bt(F.lineDash,[])),o.usePointStyle){const B={radius:w*Math.SQRT2/2,pointStyle:F.pointStyle,rotation:F.rotation,borderWidth:U},G=c.xPlus(O,_/2),X=q+x;$5(s,B,G,X,o.pointStyleWidth&&_)}else{const B=q+Math.max((p-w)/2,0),G=c.leftForLtr(O,_),X=hf(F.borderRadius);s.beginPath(),Object.values(X).some(Q=>Q!==0)?Tx(s,{x:G,y:B,w:_,h:w,radius:X}):s.rect(G,B,_,w),s.fill(),U!==0&&s.stroke()}s.restore()},k=function(O,q,F){Cx(s,F.text,O,q+j/2,d,{strikethrough:F.hidden,textAlign:c.textAlign(F.textAlign)})},I=this.isHorizontal(),M=this._computeTitleHeight();I?v={x:ii(a,this.left+m,this.right-r[0]),y:this.top+m+M,line:0}:v={x:this.left+m,y:ii(a,this.top+M+m,this.bottom-t[0].height),line:0},Q5(this.ctx,e.textDirection);const D=j+m;this.legendItems.forEach((O,q)=>{s.strokeStyle=O.fontColor,s.fillStyle=O.fontColor;const F=s.measureText(O.text).width,U=c.textAlign(O.textAlign||(O.textAlign=o.textAlign)),B=_+x+F;let G=v.x,X=v.y;c.setWidth(this.width),I?q>0&&G+B+m>this.right&&(X=v.y+=D,v.line++,G=v.x=ii(a,this.left+m,this.right-r[v.line])):q>0&&X+D>this.bottom&&(G=v.x=G+t[v.line].width+m,v.line++,X=v.y=ii(a,this.top+M+m,this.bottom-t[v.line].height));const Q=c.x(G);if(P(Q,X,O),G=Cse(U,G+_+x,I?G+B:this.right,e.rtl),k(c.x(G),X,O),I)v.x+=B+m;else if(typeof O.text!="string"){const Y=d.lineHeight;v.y+=_6(O,Y)+m}else v.y+=D}),X5(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=Us(t.font),s=Pa(t.padding);if(!t.display)return;const a=mf(e.rtl,this.left,this.width),o=this.ctx,l=t.position,c=r.size/2,d=s.top+c;let m,p=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),m=this.top+d,p=ii(e.align,p,this.right-x);else{const _=this.columnSizes.reduce((w,j)=>Math.max(w,j.height),0);m=d+ii(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const v=ii(l,p,p+x);o.textAlign=a.textAlign(B5(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=r.string,Cx(o,t.text,v,m,r)}_computeTitleHeight(){const e=this.options.title,t=Us(e.font),r=Pa(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,s,a;if(gl(e,this.left,this.right)&&gl(t,this.top,this.bottom)){for(a=this.legendHitBoxes,r=0;r<a.length;++r)if(s=a[r],gl(e,s.left,s.left+s.width)&&gl(t,s.top,s.top+s.height))return this.legendItems[r]}return null}handleEvent(e){const t=this.options;if(!ile(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,a=tle(s,r);s&&!a&&Fn(t.onLeave,[e,s,this],this),this._hoveredItem=r,r&&!a&&Fn(t.onHover,[e,r,this],this)}else r&&Fn(t.onClick,[e,r,this],this)}}function nle(n,e,t,r,s){const a=rle(r,n,e,t),o=sle(s,r,e.lineHeight);return{itemWidth:a,itemHeight:o}}function rle(n,e,t,r){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((a,o)=>a.length>o.length?a:o)),e+t.size/2+r.measureText(s).width}function sle(n,e,t){let r=n;return typeof e.text!="string"&&(r=_6(e,t)),r}function _6(n,e){const t=n.text?n.text.length:0;return e*t}function ile(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var ale={id:"legend",_element:rL,start(n,e,t){const r=n.legend=new rL({ctx:n.ctx,options:t,chart:n});Oc.configure(n,r,t),Oc.addBox(n,r)},stop(n){Oc.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const r=n.legend;Oc.configure(n,r,t),r.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const r=e.datasetIndex,s=t.chart;s.isDatasetVisible(r)?(s.hide(r),e.hidden=!0):(s.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:s,color:a,useBorderRadius:o,borderRadius:l}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(t?0:void 0),m=Pa(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:a,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:d.borderColor,pointStyle:r||d.pointStyle,rotation:d.rotation,textAlign:s||d.textAlign,borderRadius:o&&(l||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};const qh={average(n){if(!n.length)return!1;let e,t,r=new Set,s=0,a=0;for(e=0,t=n.length;e<t;++e){const l=n[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();r.add(c.x),s+=c.y,++a}}return a===0||r.size===0?!1:{x:[...r].reduce((l,c)=>l+c)/r.size,y:s/a}},nearest(n,e){if(!n.length)return!1;let t=e.x,r=e.y,s=Number.POSITIVE_INFINITY,a,o,l;for(a=0,o=n.length;a<o;++a){const c=n[a].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),m=DN(e,d);m<s&&(s=m,l=c)}}if(l){const c=l.tooltipPosition();t=c.x,r=c.y}return{x:t,y:r}}};function oo(n,e){return e&&(Nr(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function dl(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function ole(n,e){const{element:t,datasetIndex:r,index:s}=e,a=n.getDatasetMeta(r).controller,{label:o,value:l}=a.getLabelAndValue(s);return{chart:n,label:o,parsed:a.getParsed(s),raw:n.data.datasets[r].data[s],formattedValue:l,dataset:a.getDataset(),dataIndex:s,datasetIndex:r,element:t}}function sL(n,e){const t=n.chart.ctx,{body:r,footer:s,title:a}=n,{boxWidth:o,boxHeight:l}=e,c=Us(e.bodyFont),d=Us(e.titleFont),m=Us(e.footerFont),p=a.length,x=s.length,v=r.length,_=Pa(e.padding);let w=_.height,j=0,P=r.reduce((M,D)=>M+D.before.length+D.lines.length+D.after.length,0);if(P+=n.beforeBody.length+n.afterBody.length,p&&(w+=p*d.lineHeight+(p-1)*e.titleSpacing+e.titleMarginBottom),P){const M=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;w+=v*M+(P-v)*c.lineHeight+(P-1)*e.bodySpacing}x&&(w+=e.footerMarginTop+x*m.lineHeight+(x-1)*e.footerSpacing);let k=0;const I=function(M){j=Math.max(j,t.measureText(M).width+k)};return t.save(),t.font=d.string,xn(n.title,I),t.font=c.string,xn(n.beforeBody.concat(n.afterBody),I),k=e.displayColors?o+2+e.boxPadding:0,xn(r,M=>{xn(M.before,I),xn(M.lines,I),xn(M.after,I)}),k=0,t.font=m.string,xn(n.footer,I),t.restore(),j+=_.width,{width:j,height:w}}function lle(n,e){const{y:t,height:r}=e;return t<r/2?"top":t>n.height-r/2?"bottom":"center"}function cle(n,e,t,r){const{x:s,width:a}=r,o=t.caretSize+t.caretPadding;if(n==="left"&&s+a+o>e.width||n==="right"&&s-a-o<0)return!0}function dle(n,e,t,r){const{x:s,width:a}=t,{width:o,chartArea:{left:l,right:c}}=n;let d="center";return r==="center"?d=s<=(l+c)/2?"left":"right":s<=a/2?d="left":s>=o-a/2&&(d="right"),cle(d,n,e,t)&&(d="center"),d}function iL(n,e,t){const r=t.yAlign||e.yAlign||lle(n,t);return{xAlign:t.xAlign||e.xAlign||dle(n,e,t,r),yAlign:r}}function ule(n,e){let{x:t,width:r}=n;return e==="right"?t-=r:e==="center"&&(t-=r/2),t}function fle(n,e,t){let{y:r,height:s}=n;return e==="top"?r+=t:e==="bottom"?r-=s+t:r-=s/2,r}function aL(n,e,t,r){const{caretSize:s,caretPadding:a,cornerRadius:o}=n,{xAlign:l,yAlign:c}=t,d=s+a,{topLeft:m,topRight:p,bottomLeft:x,bottomRight:v}=hf(o);let _=ule(e,l);const w=fle(e,c,d);return c==="center"?l==="left"?_+=d:l==="right"&&(_-=d):l==="left"?_-=Math.max(m,x)+s:l==="right"&&(_+=Math.max(p,v)+s),{x:ss(_,0,r.width-e.width),y:ss(w,0,r.height-e.height)}}function Rg(n,e,t){const r=Pa(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-r.right:n.x+r.left}function oL(n){return oo([],dl(n))}function hle(n,e,t){return wu(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function lL(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const w6={beforeTitle:ol,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:ol,beforeBody:ol,beforeLabel:ol,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return mn(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ol,afterBody:ol,beforeFooter:ol,footer:ol,afterFooter:ol};function As(n,e,t,r){const s=n[e].call(t,r);return typeof s>"u"?w6[e].call(t,r):s}class cL extends rd{static positioners=qh;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&t.options.animation&&r.animations,a=new s6(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=hle(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:r}=t,s=As(r,"beforeTitle",this,e),a=As(r,"title",this,e),o=As(r,"afterTitle",this,e);let l=[];return l=oo(l,dl(s)),l=oo(l,dl(a)),l=oo(l,dl(o)),l}getBeforeBody(e,t){return oL(As(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,s=[];return xn(e,a=>{const o={before:[],lines:[],after:[]},l=lL(r,a);oo(o.before,dl(As(l,"beforeLabel",this,a))),oo(o.lines,As(l,"label",this,a)),oo(o.after,dl(As(l,"afterLabel",this,a))),s.push(o)}),s}getAfterBody(e,t){return oL(As(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,s=As(r,"beforeFooter",this,e),a=As(r,"footer",this,e),o=As(r,"afterFooter",this,e);let l=[];return l=oo(l,dl(s)),l=oo(l,dl(a)),l=oo(l,dl(o)),l}_createItems(e){const t=this._active,r=this.chart.data,s=[],a=[],o=[];let l=[],c,d;for(c=0,d=t.length;c<d;++c)l.push(ole(this.chart,t[c]));return e.filter&&(l=l.filter((m,p,x)=>e.filter(m,p,x,r))),e.itemSort&&(l=l.sort((m,p)=>e.itemSort(m,p,r))),xn(l,m=>{const p=lL(e.callbacks,m);s.push(As(p,"labelColor",this,m)),a.push(As(p,"labelPointStyle",this,m)),o.push(As(p,"labelTextColor",this,m))}),this.labelColors=s,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const r=this.options.setContext(this.getContext()),s=this._active;let a,o=[];if(!s.length)this.opacity!==0&&(a={opacity:0});else{const l=qh[r.position].call(this,s,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const c=this._size=sL(this,r),d=Object.assign({},l,c),m=iL(this.chart,r,d),p=aL(r,d,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,a={opacity:1,x:p.x,y:p.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,s){const a=this.getCaretPosition(e,r,s);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}getCaretPosition(e,t,r){const{xAlign:s,yAlign:a}=this,{caretSize:o,cornerRadius:l}=r,{topLeft:c,topRight:d,bottomLeft:m,bottomRight:p}=hf(l),{x,y:v}=e,{width:_,height:w}=t;let j,P,k,I,M,D;return a==="center"?(M=v+w/2,s==="left"?(j=x,P=j-o,I=M+o,D=M-o):(j=x+_,P=j+o,I=M-o,D=M+o),k=j):(s==="left"?P=x+Math.max(c,m)+o:s==="right"?P=x+_-Math.max(d,p)-o:P=this.caretX,a==="top"?(I=v,M=I-o,j=P-o,k=P+o):(I=v+w,M=I+o,j=P+o,k=P-o),D=I),{x1:j,x2:P,x3:k,y1:I,y2:M,y3:D}}drawTitle(e,t,r){const s=this.title,a=s.length;let o,l,c;if(a){const d=mf(r.rtl,this.x,this.width);for(e.x=Rg(this,r.titleAlign,r),t.textAlign=d.textAlign(r.titleAlign),t.textBaseline="middle",o=Us(r.titleFont),l=r.titleSpacing,t.fillStyle=r.titleColor,t.font=o.string,c=0;c<a;++c)t.fillText(s[c],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,c+1===a&&(e.y+=r.titleMarginBottom-l)}}_drawColorBox(e,t,r,s,a){const o=this.labelColors[r],l=this.labelPointStyles[r],{boxHeight:c,boxWidth:d}=a,m=Us(a.bodyFont),p=Rg(this,"left",a),x=s.x(p),v=c<m.lineHeight?(m.lineHeight-c)/2:0,_=t.y+v;if(a.usePointStyle){const w={radius:Math.min(d,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},j=s.leftForLtr(x,d)+d/2,P=_+c/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,IN(e,w,j,P),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,IN(e,w,j,P)}else{e.lineWidth=Qt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const w=s.leftForLtr(x,d),j=s.leftForLtr(s.xPlus(x,1),d-2),P=hf(o.borderRadius);Object.values(P).some(k=>k!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,Tx(e,{x:w,y:_,w:d,h:c,radius:P}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Tx(e,{x:j,y:_+1,w:d-2,h:c-2,radius:P}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(w,_,d,c),e.strokeRect(w,_,d,c),e.fillStyle=o.backgroundColor,e.fillRect(j,_+1,d-2,c-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:s}=this,{bodySpacing:a,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:d,boxPadding:m}=r,p=Us(r.bodyFont);let x=p.lineHeight,v=0;const _=mf(r.rtl,this.x,this.width),w=function(F){t.fillText(F,_.x(e.x+v),e.y+x/2),e.y+=x+a},j=_.textAlign(o);let P,k,I,M,D,O,q;for(t.textAlign=o,t.textBaseline="middle",t.font=p.string,e.x=Rg(this,j,r),t.fillStyle=r.bodyColor,xn(this.beforeBody,w),v=l&&j!=="right"?o==="center"?d/2+m:d+2+m:0,M=0,O=s.length;M<O;++M){for(P=s[M],k=this.labelTextColors[M],t.fillStyle=k,xn(P.before,w),I=P.lines,l&&I.length&&(this._drawColorBox(t,e,M,_,r),x=Math.max(p.lineHeight,c)),D=0,q=I.length;D<q;++D)w(I[D]),x=p.lineHeight;xn(P.after,w)}v=0,x=p.lineHeight,xn(this.afterBody,w),e.y-=a}drawFooter(e,t,r){const s=this.footer,a=s.length;let o,l;if(a){const c=mf(r.rtl,this.x,this.width);for(e.x=Rg(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=c.textAlign(r.footerAlign),t.textBaseline="middle",o=Us(r.footerFont),t.fillStyle=r.footerColor,t.font=o.string,l=0;l<a;++l)t.fillText(s[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,t,r,s){const{xAlign:a,yAlign:o}=this,{x:l,y:c}=e,{width:d,height:m}=r,{topLeft:p,topRight:x,bottomLeft:v,bottomRight:_}=hf(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(l+p,c),o==="top"&&this.drawCaret(e,t,r,s),t.lineTo(l+d-x,c),t.quadraticCurveTo(l+d,c,l+d,c+x),o==="center"&&a==="right"&&this.drawCaret(e,t,r,s),t.lineTo(l+d,c+m-_),t.quadraticCurveTo(l+d,c+m,l+d-_,c+m),o==="bottom"&&this.drawCaret(e,t,r,s),t.lineTo(l+v,c+m),t.quadraticCurveTo(l,c+m,l,c+m-v),o==="center"&&a==="left"&&this.drawCaret(e,t,r,s),t.lineTo(l,c+p),t.quadraticCurveTo(l,c,l+p,c),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,s=r&&r.x,a=r&&r.y;if(s||a){const o=qh[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=sL(this,e),c=Object.assign({},o,this._size),d=iL(t,e,c),m=aL(e,c,d,t);(s._to!==m.x||a._to!==m.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},a={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=Pa(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=r,this.drawBackground(a,e,s,t),Q5(e,t.textDirection),a.y+=o.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),X5(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,s=e.map(({datasetIndex:l,index:c})=>{const d=this.chart.getDatasetMeta(l);if(!d)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:d.data[c],index:c}}),a=!Sx(r,s),o=this._positionChanged(s,t);(a||o)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,a=this._active||[],o=this._getActiveElements(e,a,t,r),l=this._positionChanged(o,e),c=t||!Sx(o,a)||l;return c&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),c}_getActiveElements(e,t,r,s){const a=this.options;if(e.type==="mouseout")return[];if(!s)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,a.mode,a,r);return a.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:r,caretY:s,options:a}=this,o=qh[a.position].call(this,e,t);return o!==!1&&(r!==o.x||s!==o.y)}}var mle={id:"tooltip",_element:cL,positioners:qh,afterInit(n,e,t){t&&(n.tooltip=new cL({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:w6},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const ple=(n,e,t,r)=>(typeof e=="string"?(t=n.push(e)-1,r.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function gle(n,e,t,r){const s=n.indexOf(e);if(s===-1)return ple(n,e,t,r);const a=n.lastIndexOf(e);return s!==a?t:s}const xle=(n,e)=>n===null?null:ss(Math.round(n),0,e);function dL(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class yle extends zf{static id="category";static defaults={ticks:{callback:dL}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const r=this.getLabels();for(const{index:s,label:a}of t)r[s]===a&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(mn(e))return null;const r=this.getLabels();return t=isFinite(t)&&r[t]===e?t:gle(r,e,Bt(t,e),this._addedLabels),xle(t,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),t||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,s=[];let a=this.getLabels();a=e===0&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=t;o++)s.push({value:o});return s}getLabelForValue(e){return dL.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function vle(n,e){const t=[],{bounds:s,step:a,min:o,max:l,precision:c,count:d,maxTicks:m,maxDigits:p,includeBounds:x}=n,v=a||1,_=m-1,{min:w,max:j}=e,P=!mn(o),k=!mn(l),I=!mn(d),M=(j-w)/(p+1);let D=aR((j-w)/_/v)*v,O,q,F,U;if(D<1e-14&&!P&&!k)return[{value:w},{value:j}];U=Math.ceil(j/D)-Math.floor(w/D),U>_&&(D=aR(U*D/_/v)*v),mn(c)||(O=Math.pow(10,c),D=Math.ceil(D*O)/O),s==="ticks"?(q=Math.floor(w/D)*D,F=Math.ceil(j/D)*D):(q=w,F=j),P&&k&&a&&xse((l-o)/a,D/1e3)?(U=Math.round(Math.min((l-o)/D,m)),D=(l-o)/U,q=o,F=l):I?(q=P?o:q,F=k?l:F,U=d-1,D=(F-q)/U):(U=(F-q)/D,Yh(U,Math.round(U),D/1e3)?U=Math.round(U):U=Math.ceil(U));const B=Math.max(oR(D),oR(q));O=Math.pow(10,mn(c)?B:c),q=Math.round(q*O)/O,F=Math.round(F*O)/O;let G=0;for(P&&(x&&q!==o?(t.push({value:o}),q<o&&G++,Yh(Math.round((q+G*D)*O)/O,o,uL(o,M,n))&&G++):q<o&&G++);G<U;++G){const X=Math.round((q+G*D)*O)/O;if(k&&X>l)break;t.push({value:X})}return k&&x&&F!==l?t.length&&Yh(t[t.length-1].value,l,uL(l,M,n))?t[t.length-1].value=l:t.push({value:l}):(!k||F===l)&&t.push({value:F}),t}function uL(n,e,{horizontal:t,minRotation:r}){const s=pl(r),a=(t?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+n).length;return Math.min(e/a,o)}class ble extends zf{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return mn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:s,max:a}=this;const o=c=>s=t?s:c,l=c=>a=r?a:c;if(e){const c=xo(s),d=xo(a);c<0&&d<0?l(0):c>0&&d>0&&o(0)}if(s===a){let c=a===0?1:Math.abs(a*.05);l(a+c),e||o(s-c)}this.min=s,this.max=a}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,s;return r?(s=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),t=t||11),t&&(s=Math.min(t,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const s={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},a=this._range||this,o=vle(s,a);return e.bounds==="ticks"&&yse(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const s=(r-t)/Math.max(e.length-1,1)/2;t-=s,r+=s}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return t1(e,this.chart.options.locale,this.options.ticks.format)}}class _le extends ble{static id="linear";static defaults={ticks:{callback:W5.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=as(e)?e:0,this.max=as(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=pl(this.options.ticks.minRotation),s=(e?Math.sin(r):Math.cos(r))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const wy={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Fs=Object.keys(wy);function fL(n,e){return n-e}function hL(n,e){if(mn(e))return null;const t=n._adapter,{parser:r,round:s,isoWeekday:a}=n._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),as(o)||(o=typeof r=="string"?t.parse(o,r):t.parse(o)),o===null?null:(s&&(o=s==="week"&&(fm(a)||a===!0)?t.startOf(o,"isoWeek",a):t.startOf(o,s)),+o)}function mL(n,e,t,r){const s=Fs.length;for(let a=Fs.indexOf(n);a<s-1;++a){const o=wy[Fs[a]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=r)return Fs[a]}return Fs[s-1]}function wle(n,e,t,r,s){for(let a=Fs.length-1;a>=Fs.indexOf(t);a--){const o=Fs[a];if(wy[o].common&&n._adapter.diff(s,r,o)>=e-1)return o}return Fs[t?Fs.indexOf(t):0]}function Sle(n){for(let e=Fs.indexOf(n)+1,t=Fs.length;e<t;++e)if(wy[Fs[e]].common)return Fs[e]}function pL(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:r,hi:s}=XC(t,e),a=t[r]>=e?t[r]:t[s];n[a]=!0}}function jle(n,e,t,r){const s=n._adapter,a=+s.startOf(e[0].value,r),o=e[e.length-1].value;let l,c;for(l=a;l<=o;l=+s.add(l,1,r))c=t[l],c>=0&&(e[c].major=!0);return e}function gL(n,e,t){const r=[],s={},a=e.length;let o,l;for(o=0;o<a;++o)l=e[o],s[l]=o,r.push({value:l,major:!1});return a===0||!t?r:jle(n,r,s,t)}class xL extends zf{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),s=this._adapter=new rae._date(e.adapters.date);s.init(t),Hh(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:hL(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:s,max:a,minDefined:o,maxDefined:l}=this.getUserBounds();function c(d){!o&&!isNaN(d.min)&&(s=Math.min(s,d.min)),!l&&!isNaN(d.max)&&(a=Math.max(a,d.max))}(!o||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),s=as(s)&&!isNaN(s)?s:+t.startOf(Date.now(),r),a=as(a)&&!isNaN(a)?a:+t.endOf(Date.now(),r)+1,this.min=Math.min(s,a-1),this.max=Math.max(s+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,s=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const a=this.min,o=this.max,l=Sse(s,a,o);return this._unit=t.unit||(r.autoSkip?mL(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):wle(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:Sle(this._unit),this.initOffsets(s),e.reverse&&l.reverse(),gL(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,s,a;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?r=a:r=(a-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=ss(t,0,o),r=ss(r,0,o),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,s=this.options,a=s.time,o=a.unit||mL(a.minUnit,t,r,this._getLabelCapacity(t)),l=Bt(s.ticks.stepSize,1),c=o==="week"?a.isoWeekday:!1,d=fm(c)||c===!0,m={};let p=t,x,v;if(d&&(p=+e.startOf(p,"isoWeek",c)),p=+e.startOf(p,d?"day":o),e.diff(r,t,o)>1e5*l)throw new Error(t+" and "+r+" are too far apart with stepSize of "+l+" "+o);const _=s.ticks.source==="data"&&this.getDataTimestamps();for(x=p,v=0;x<r;x=+e.add(x,l,o),v++)pL(m,x,_);return(x===r||s.bounds==="ticks"||v===1)&&pL(m,x,_),Object.keys(m).sort(fL).map(w=>+w)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,a=this._unit,o=t||s[a];return this._adapter.format(e,o)}_tickFormatFunction(e,t,r,s){const a=this.options,o=a.ticks.callback;if(o)return Fn(o,[e,t,r],this);const l=a.time.displayFormats,c=this._unit,d=this._majorUnit,m=c&&l[c],p=d&&l[d],x=r[t],v=d&&p&&x&&x.major;return this._adapter.format(e,s||(v?p:m))}generateTickLabels(e){let t,r,s;for(t=0,r=e.length;t<r;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,s=pl(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(s),o=Math.sin(s),l=this._resolveTickFontOptions(0).size;return{w:r*a+l*o,h:r*o+l*a}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,s=r[t.unit]||r.millisecond,a=this._tickFormatFunction(e,0,gL(this,[e],this._majorUnit),s),o=this._getLabelSize(a),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,r=s.length;t<r;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const s=this.getLabels();for(t=0,r=s.length;t<r;++t)e.push(hL(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return z5(e.sort(fL))}}function Lg(n,e,t){let r=0,s=n.length-1,a,o,l,c;t?(e>=n[r].pos&&e<=n[s].pos&&({lo:r,hi:s}=tu(n,"pos",e)),{pos:a,time:l}=n[r],{pos:o,time:c}=n[s]):(e>=n[r].time&&e<=n[s].time&&({lo:r,hi:s}=tu(n,"time",e)),{time:a,pos:l}=n[r],{time:o,pos:c}=n[s]);const d=o-a;return d?l+(c-l)*(e-a)/d:l}class Kfe extends xL{static id="timeseries";static defaults=xL.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Lg(t,this.min),this._tableRange=Lg(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,s=[],a=[];let o,l,c,d,m;for(o=0,l=e.length;o<l;++o)d=e[o],d>=t&&d<=r&&s.push(d);if(s.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(o=0,l=s.length;o<l;++o)m=s[o+1],c=s[o-1],d=s[o],Math.round((m+c)/2)!==d&&a.push({time:d,pos:o/(l-1)});return a}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(t)||r.length===1)&&r.push(t),r.sort((s,a)=>s-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Lg(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return Lg(this._table,r*this._tableRange+this._minPos,!0)}}vy.register(Xie,Ioe,yle,_le,nae,by,Poe,tae,yoe,mle,ale,ele);const yL=({title:n,icon:e,children:t})=>i.jsxs("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card col-span-1",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(e,{className:"h-5 w-5 mr-3 text-muted"}),i.jsx("h3",{className:"font-semibold text-primary-text",children:n})]}),i.jsx("div",{className:"h-64 md:h-80 relative",children:t})]}),Nle=({data:n})=>{const e=E.useRef(null),t=E.useRef(null);return E.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const r=e.current.getContext("2d");r&&(t.current=new vy(r,{type:"bar",data:{labels:n.labels,datasets:[{label:"Present",data:n.present,backgroundColor:"#005D22",borderColor:"#004218",borderWidth:1,borderRadius:4},{label:"Absent",data:n.absent,backgroundColor:"#EF4444",borderColor:"#DC2626",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}}))}return()=>{t.current&&t.current.destroy()}},[n]),i.jsx("div",{className:"h-full w-full flex flex-col",children:i.jsx("div",{className:"flex-grow relative",children:i.jsx("canvas",{ref:e})})})},Cle=({data:n})=>{const e=E.useRef(null),t=E.useRef(null);return E.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const r=e.current.getContext("2d");if(r){const s=r.createLinearGradient(0,0,0,200);s.addColorStop(0,"rgba(0, 93, 34, 0.4)"),s.addColorStop(1,"rgba(0, 93, 34, 0)"),t.current=new vy(r,{type:"line",data:{labels:n.labels,datasets:[{label:"Average Hours Worked",data:n.hours,borderColor:"#005D22",backgroundColor:s,fill:!0,tension:.4,pointBackgroundColor:"#005D22",pointRadius:0,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"},ticks:{stepSize:1,precision:0,callback:a=>{const o=typeof a=="string"?parseFloat(a):a;return Math.round(o)}}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}})}}return()=>{t.current&&t.current.destroy()}},[n]),i.jsx("div",{className:"h-full w-full flex flex-col",children:i.jsx("div",{className:"flex-grow relative",children:i.jsx("canvas",{ref:e})})})},Tle=({data:n,dateRange:e})=>i.jsxs("div",{className:"p-8 font-sans text-sm text-black bg-white",children:[i.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-6",children:[i.jsx(Wi,{className:"h-10",localPath:bC}),i.jsxs("div",{className:"text-right",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Attendance Log"}),i.jsxs("p",{className:"text-gray-600",children:[Ue(e.startDate,"dd MMM yyyy")," to ",Ue(e.endDate,"dd MMM yyyy")]})]})]}),i.jsxs("table",{className:"w-full mt-6 text-left border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"p-2 border border-gray-300",children:"User"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Date"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Time"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Event"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Location"})]})}),i.jsx("tbody",{children:n.map((t,r)=>i.jsxs("tr",{className:"border-b",children:[i.jsx("td",{className:"p-2 border border-gray-300",children:t.userName}),i.jsx("td",{className:"p-2 border border-gray-300",children:t.date}),i.jsx("td",{className:"p-2 border border-gray-300",children:t.time}),i.jsx("td",{className:"p-2 border border-gray-300 capitalize",children:t.type.replace("-"," ")}),i.jsx("td",{className:"p-2 border border-gray-300",children:t.locationName||(t.latitude?`${t.latitude?.toFixed(4)}, ${t.longitude?.toFixed(4)}`:"N/A")})]},`${t.userName}-${t.date}-${t.time}-${r}`))})]})]}),Ple=({data:n,dateRange:e})=>{const r=[];for(let s=0;s<n.length;s+=15)r.push(n.slice(s,s+15));return r.length===0?null:i.jsx("div",{children:r.map((s,a)=>{const o=15-s.length,l=a===r.length-1;return i.jsxs("div",{style:{padding:a===0?"40px":"0px 40px 40px 40px",paddingTop:a===0?"40px":"0px",marginTop:a===0?"0px":"-40px",fontFamily:'"Courier New", Courier, monospace',fontSize:"14px",color:"#000",backgroundColor:"#fff",width:"1123px",height:"794px",boxSizing:"border-box",letterSpacing:"0.5px",pageBreakAfter:l?"auto":"always",position:"relative",display:"flex",flexDirection:"column"},children:[i.jsx("table",{style:{width:"100%",borderBottom:"2px solid #000",marginBottom:"16px",paddingBottom:"8px"},children:i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{style:{width:"50%",verticalAlign:"top",textAlign:"left"},children:i.jsx(Wi,{className:"h-14",localPath:bC})}),i.jsxs("td",{style:{width:"50%",verticalAlign:"top",textAlign:"right"},children:[i.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"1px"},children:"Basic Attendance Report"}),i.jsxs("div",{style:{fontSize:"12px",color:"#333",marginBottom:"4px"},children:[Ue(e.startDate,"dd MMM yyyy")," -"," ",Ue(e.endDate,"dd MMM yyyy")]}),i.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["Generated: ",Ue(new Date,"dd MMM yyyy HH:mm")]})]})]})})}),i.jsx("div",{style:{flexGrow:1},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #000",tableLayout:"fixed"},children:[i.jsx("thead",{style:{display:"table-header-group"},children:i.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"28%",fontSize:"11px",fontWeight:"bold"},children:"Employee Name"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Date"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Status"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check In"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check Out"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"15%",fontSize:"11px",fontWeight:"bold"},children:"Hours"})]})}),i.jsxs("tbody",{children:[s.map((c,d)=>i.jsxs("tr",{style:{backgroundColor:d%2===0?"#fff":"#fafafa"},children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle",wordWrap:"break-word",whiteSpace:"normal",lineHeight:"1.4"},children:c.userName}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:Ue(new Date(String(c.date).replace(/-/g,"/")),"dd MMM yyyy")}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.status}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.checkIn||"-"}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.checkOut||"-"}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.duration||"-"})]},`${c.userName}-${c.date}-${d}`)),Array.from({length:o}).map((c,d)=>i.jsxs("tr",{style:{backgroundColor:"#fff"},children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",height:"33px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""})]},`empty-${d}`))]})]})}),i.jsxs("div",{style:{marginTop:"10px",borderTop:"1px solid #ccc",paddingTop:"8px",textAlign:"center",fontSize:"10px",color:"#888"},children:["Paradigm Services - Confidential Report - Page ",a+1," of ",r.length]})]},a)})})},Mle=({data:n,dateRange:e})=>{const t=uo({start:e.startDate,end:e.endDate});return i.jsxs("div",{className:"p-8 font-sans text-[9px] text-black bg-white",children:[i.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-4",children:[i.jsx(Wi,{className:"h-8",localPath:bC}),i.jsxs("div",{className:"text-right",children:[i.jsx("h1",{className:"text-lg font-bold",children:"Monthly Attendance Report"}),i.jsxs("p",{className:"text-gray-600",children:[Ue(e.startDate,"dd MMM yyyy")," to ",Ue(e.endDate,"dd MMM yyyy")]})]})]}),i.jsxs("table",{className:"w-full border-collapse border border-gray-400 text-center",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-200 font-bold",children:[i.jsx("td",{className:"border p-1 border-gray-400 text-left",children:"Employee Name"}),t.map((r,s)=>i.jsx("td",{className:"border p-1 border-gray-400",children:Ue(r,"d")},s)),i.jsx("td",{className:"border p-1 border-gray-400",children:"P"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"1/2P"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"A"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"WO"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"H"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"WOP"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"HP"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"Total"})]})}),i.jsx("tbody",{children:n.map((r,s)=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1 border-gray-400 text-left",children:r.userName}),r.statuses.map((a,o)=>i.jsx("td",{className:"border p-1 border-gray-400",children:a},o)),i.jsx("td",{className:"border p-1 border-gray-400",children:r.presentDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.halfDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.absentDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.weekOffs}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.holidays}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.weekendPresents}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.holidayPresents}),i.jsx("td",{className:"border p-1 border-gray-400",children:r.totalPayableDays})]},s))})]})]})},kle=()=>{const n=Jt("(max-width: 639px)"),{user:e}=St(),{permissions:t}=ka(),{recurringHolidays:r}=fi(),[s,a]=E.useState([]),[o,l]=E.useState([]),[c,d]=E.useState(null),[m,p]=E.useState(!0),[x,v]=E.useState({startDate:Wg(),endDate:Gv(),key:"selection"}),_=E.useMemo(()=>[x],[x]),[w,j]=E.useState("Today"),[P,k]=E.useState(!1),I=E.useRef(null),[M,D]=E.useState("all"),[O,q]=E.useState("basic"),[F,U]=E.useState(!1),[B,G]=E.useState(null),[X,Q]=E.useState({}),Y=E.useRef(null),ne=e&&t[e.role]?.includes("download_attendance_report"),ie=!(e&&t[e.role]?.includes("view_all_attendance")),[$,H]=E.useState({present:0,absent:0,ot:0,compOff:0}),[se,W]=E.useState([]);E.useEffect(()=>{const ce=Se=>{I.current&&!I.current.contains(Se.target)&&k(!1)};return document.addEventListener("mousedown",ce),()=>document.removeEventListener("mousedown",ce)},[]),E.useEffect(()=>{ne&&pe.getUsers().then(a)},[ne]),E.useEffect(()=>{(async()=>{if(!(!ie||!e||!x.startDate||!x.endDate)){p(!0);try{const Se=uf(x.startDate,7),ye=Se.toISOString(),Ne=x.endDate.toISOString(),[ke,qe]=await Promise.all([pe.getAttendanceEvents(e.id,ye,Ne),pe.getCompOffLogs(e.id)]);let He=uo({start:Se,end:x.endDate}).map(Fe=>{const Le=Ue(Fe,"yyyy-MM-dd"),Je=ke.filter(Ht=>Ue(new Date(Ht.timestamp),"yyyy-MM-dd")===Le);let nt="Absent",ct="-",Vt="-",At=0;const vt=Ue(Fe,"EEEE"),wn=vt==="Sunday";if(r.some(Ht=>{if(Ht.day.toLowerCase()!==vt.toLowerCase())return!1;const Un=Math.ceil(Fe.getDate()/7),Mn=e.role==="field_officer"?"field":"office";return Ht.n===Un&&(Ht.type||"office")===Mn})?nt="Holiday":wn&&(nt="Weekend"),Je.length>0){nt="Present",Je.sort((Mn,An)=>new Date(Mn.timestamp).getTime()-new Date(An.timestamp).getTime());const Ht=Je.find(Mn=>Mn.type==="check-in"),Un=[...Je].reverse().find(Mn=>Mn.type==="check-out");if(Ht&&(ct=Ue(new Date(Ht.timestamp),"hh:mm a")),Un&&(Vt=Ue(new Date(Un.timestamp),"hh:mm a"),Ht)){const An=df(new Date(Un.timestamp),new Date(Ht.timestamp))/60;An>8&&(At=Math.round((An-8)*10)/10)}}return{rawDate:Fe,date:Ue(Fe,"dd MMM, yyyy"),day:vt,checkIn:ct,checkOut:Vt,status:nt,ot:At}});He.forEach((Fe,Le)=>{if(Fe.status==="Weekend"&&Fe.day==="Sunday"){let Je=0;const nt=Math.max(0,Le-6);for(let ct=Le-1;ct>=nt;ct--)He[ct].status==="Absent"&&Je++;Je>=4&&(Fe.status="Absent")}});const Be=He.filter(Fe=>Fe.rawDate>=x.startDate),de=Be.filter(Fe=>Fe.status==="Present").length,xe=Be.filter(Fe=>Fe.status==="Absent"&&Fe.rawDate<=new Date).length,Pe=Be.reduce((Fe,Le)=>Fe+Le.ot,0),Ge=qe.filter(Fe=>{const Le=new Date(Fe.dateEarned);return Le>=x.startDate&&Le<=x.endDate&&Fe.status==="earned"}).length;H({present:de,absent:xe,ot:Math.round(Pe*10)/10,compOff:Ge}),W(Be.reverse())}catch(Se){console.error("Failed to fetch employee attendance",Se)}finally{p(!1)}}})()},[ie,e,x,r]);const ee=E.useCallback(async(ce,Se)=>{p(!0);try{let ye=s;ye.length===0&&(ye=await pe.getUsers(),a(ye));const Ne=new Date,ke=ce<Ne?ce:Wg(),qe=Se>Ne?Se:Gv(),[ze,He]=await Promise.all([pe.getAllAttendanceEvents(ke.toISOString(),qe.toISOString()),pe.getLeaveRequests({startDate:ke.toISOString(),endDate:qe.toISOString(),status:"approved"})]);l(ze);const Be=Ue(Ne,"yyyy-MM-dd"),de=ze.filter(vt=>Ue(new Date(vt.timestamp),"yyyy-MM-dd")===Be),xe=new Set(de.map(vt=>vt.userId)).size,Pe=He.filter(vt=>{const wn=new Date(vt.startDate),Pn=new Date(vt.endDate);return Ne>=wn&&Ne<=Pn}),Ge=new Set(Pe.map(vt=>vt.userId)).size,Fe=ye.length,Le=Math.max(0,Fe-xe-Ge),Je=uo({start:ce,end:Se}),nt=Je.map(vt=>Ue(vt,"dd MMM")),ct=[],Vt=[],At=[];Je.forEach(vt=>{const wn=Ue(vt,"yyyy-MM-dd"),Pn=ze.filter(un=>Ue(new Date(un.timestamp),"yyyy-MM-dd")===wn),Ht=new Set(Pn.map(un=>un.userId)).size,Un=He.filter(un=>{const ot=new Date(un.startDate),kn=new Date(un.endDate);return vt>=ot&&vt<=kn}),Mn=new Set(Un.map(un=>un.userId)).size,An=Math.max(0,Fe-Ht-Mn);ct.push(Ht),Vt.push(An);let Pr=0;const $r={};Pn.forEach(un=>{$r[un.userId]||($r[un.userId]=[]),$r[un.userId].push(un)}),Object.values($r).forEach(un=>{un.sort((Xn,Hs)=>new Date(Xn.timestamp).getTime()-new Date(Hs.timestamp).getTime());const ot=un.find(Xn=>Xn.type==="check-in"),kn=[...un].reverse().find(Xn=>Xn.type==="check-out");if(ot&&kn){const Xn=df(new Date(kn.timestamp),new Date(ot.timestamp));Pr+=Xn/60}}),At.push(Ht>0?parseFloat((Pr/Ht).toFixed(1)):0)}),d({totalEmployees:Fe,presentToday:xe,absentToday:Le,onLeaveToday:Ge,attendanceTrend:{labels:nt,present:ct,absent:Vt},productivityTrend:{labels:nt,hours:At}})}catch(ye){console.error("Failed to load dashboard data",ye)}finally{p(!1)}},[s]);E.useEffect(()=>{x.startDate&&x.endDate&&ee(x.startDate,x.endDate)},[x,ee]),E.useEffect(()=>{if(O!=="log"||!x.startDate||!x.endDate)return;const ce=ye=>parseFloat(ye.toFixed(6));(async()=>{const ye=M==="all"?s:s.filter(ze=>ze.id===M),Ne=new Set(ye.map(ze=>ze.id)),ke=o.filter(ze=>{if(!Ne.has(ze.userId)||new Date(ze.timestamp)<x.startDate||new Date(ze.timestamp)>x.endDate||ze.locationName||!ze.latitude||!ze.longitude)return!1;const He=`${ce(ze.latitude)},${ce(ze.longitude)}`;return!X[He]});if(console.log("Geocoding: Events to process:",ke.length),ke.length===0)return;const qe=ke.map(ze=>({lat:ze.latitude,lon:ze.longitude}));console.log("Geocoding: Fetching addresses for",qe.length,"unique coordinates");try{const ze=await pe.batchResolveAddresses(qe);console.log("Geocoding: Resolved addresses:",Object.keys(ze).length),Q(He=>({...He,...ze}))}catch(ze){console.error("Batch geocoding failed:",ze)}})()},[o,x,M,O,s]);const K=ce=>{j(ce);const Se=new Date;let ye=Wg(),Ne=Gv();ce==="This Month"?(ye=ui(Se),Ne=_a(Se)):ce==="This Year"?(ye=W4(Se),Ne=CB(Se)):ce==="Last 7 Days"?ye=uf(Se,6):ce==="Last 30 Days"&&(ye=uf(Se,29)),Ne>Se&&(Ne=Se),v({startDate:ye,endDate:Ne,key:"selection"})},oe=ce=>{v(ce.selection),j("Custom"),k(!1)},re=E.useMemo(()=>{const ce=x.endDate,Se=new Date;return Ue(ce,"yyyy-MM-dd")===Ue(Se,"yyyy-MM-dd")?"Today":`on ${Ue(ce,"MMM d")}`},[x]),me=E.useMemo(()=>{if(!x.startDate||!x.endDate)return[];const ce=[],Se=uo({start:x.startDate,end:x.endDate});return(M==="all"?s:s.filter(Ne=>Ne.id===M)).forEach(Ne=>{Se.forEach(ke=>{const qe=Ue(ke,"yyyy-MM-dd"),ze=o.filter(Le=>Le.userId===Ne.id&&Ue(new Date(Le.timestamp),"yyyy-MM-dd")===qe);let He="Absent",Be="",de="",xe="";const Pe=Ue(ke,"EEEE"),Ge=Pe==="Sunday";if(r.some(Le=>{if(Le.day.toLowerCase()!==Pe.toLowerCase())return!1;const Je=ke.getDate(),nt=Math.ceil(Je/7),ct=Ne.role==="field_staff"?"field":"office",Vt=Le.type||"office";return Le.n===nt&&Vt===ct})?He="Holiday":Ge&&(He="Weekend"),ze.length>0){const Le=[...ze].sort((ct,Vt)=>new Date(ct.timestamp).getTime()-new Date(Vt.timestamp).getTime()),Je=Le.find(ct=>ct.type==="check-in"),nt=[...Le].reverse().find(ct=>ct.type==="check-out");if(Je&&(He="Present",Be=Ue(new Date(Je.timestamp),"HH:mm")),nt&&(de=Ue(new Date(nt.timestamp),"HH:mm")),Je&&nt){const ct=new Date(Je.timestamp),Vt=new Date(nt.timestamp),At=df(Vt,ct),vt=Math.floor(At/60),wn=At%60;xe=`${vt}h ${wn}m`}}ce.push({userName:Ne.name,date:qe,status:He,checkIn:Be,checkOut:de,duration:xe})})}),ce},[s,o,x,M,r]),_e=E.useMemo(()=>{if(!x.startDate||!x.endDate)return[];const ce=Ne=>parseFloat(Ne.toFixed(6)),Se=M==="all"?s:s.filter(Ne=>Ne.id===M),ye=new Set(Se.map(Ne=>Ne.id));return o.filter(Ne=>ye.has(Ne.userId)).map(Ne=>{const ke=s.find(He=>He.id===Ne.userId),qe=Ne.latitude&&Ne.longitude?`${ce(Ne.latitude)},${ce(Ne.longitude)}`:"",ze=X[qe];return{userName:ke?.name||"Unknown",date:Ue(new Date(Ne.timestamp),"yyyy-MM-dd"),time:Ue(new Date(Ne.timestamp),"HH:mm:ss"),type:Ne.type,locationName:Ne.locationName||ze||(Ne.latitude?`${Ne.latitude.toFixed(4)}, ${Ne.longitude.toFixed(4)}`:"N/A"),latitude:Ne.latitude,longitude:Ne.longitude}}).sort((Ne,ke)=>Ne.date!==ke.date?Ne.date.localeCompare(ke.date):Ne.time.localeCompare(ke.time))},[s,o,x,M,X]),le=E.useMemo(()=>{if(!x.startDate||!x.endDate)return[];const ce=uo({start:x.startDate,end:x.endDate});return(M==="all"?s:s.filter(ye=>ye.id===M)).map(ye=>{const Ne=[];let ke=0,qe=0,ze=0,He=0,Be=0,de=0,xe=0;ce.forEach(Ge=>{const Fe=Ue(Ge,"yyyy-MM-dd"),Je=o.filter(vt=>vt.userId===ye.id&&Ue(new Date(vt.timestamp),"yyyy-MM-dd")===Fe).some(vt=>vt.type==="check-in"),nt=Ue(Ge,"EEEE"),ct=nt==="Sunday",Vt=r.some(vt=>{if(vt.day.toLowerCase()!==nt.toLowerCase())return!1;const wn=Ge.getDate(),Pn=Math.ceil(wn/7),Ht=ye.role==="field_staff"?"field":"office",Un=vt.type||"office";return vt.n===Pn&&Un===Ht});let At="";Je?Vt?(At="HP",xe++):ct?(At="WOP",de++):(At="P",ke++):Vt?(At="H",Be++):ct?(At="WO",He++):(At="A",qe++),Ne.push(At)});const Pe=ke+He+Be+de+xe+ze*.5;return{userName:ye.name,statuses:Ne,presentDays:ke,absentDays:qe,halfDays:ze,weekOffs:He,holidays:Be,weekendPresents:de,holidayPresents:xe,totalPayableDays:Pe}})},[s,o,x,M,r]),fe=E.useMemo(()=>O==="basic"?i.jsx(Ple,{data:me,dateRange:x}):O==="log"?i.jsx(Tle,{data:_e,dateRange:x}):O==="monthly"?i.jsx(Mle,{data:le,dateRange:x}):null,[O,me,_e,le,x]),ue=()=>{U(!0);try{let ce="data:text/csv;charset=utf-8,",Se=`Attendance_Report_${Ue(new Date,"yyyy-MM-dd")}.csv`;if(O==="basic")ce+=`Employee Name,Date,Status,Check In,Check Out,Hours
`,me.forEach(ke=>{ce+=`"${ke.userName}","${ke.date}","${ke.status}","${ke.checkIn}","${ke.checkOut}","${ke.duration}"
`});else if(O==="log")ce+=`User,Date,Time,Event,Location,Latitude,Longitude
`,_e.forEach(ke=>{ce+=`"${ke.userName}","${ke.date}","${ke.time}","${ke.type}","${ke.locationName||""}","${ke.latitude||""}","${ke.longitude||""}"
`});else if(O==="monthly"){const qe=uo({start:x.startDate,end:x.endDate}).map(ze=>Ue(ze,"dd MMM")).join(",");ce+=`Employee Name,${qe},Present,Absent,Half Days,Week Offs,Holidays,Weekend Presents,Holiday Presents,Total Payable Days
`,le.forEach(ze=>{const He=ze.statuses.join(",");ce+=`"${ze.userName}",${He},"${ze.presentDays}","${ze.absentDays}","${ze.halfDays}","${ze.weekOffs}","${ze.holidays}","${ze.weekendPresents}","${ze.holidayPresents}","${ze.totalPayableDays}"
`})}const ye=encodeURI(ce),Ne=document.createElement("a");Ne.setAttribute("href",ye),Ne.setAttribute("download",Se),document.body.appendChild(Ne),Ne.click(),document.body.removeChild(Ne),G({message:"CSV downloaded successfully.",type:"success"})}catch(ce){console.error("CSV generation failed:",ce),G({message:"Failed to generate CSV.",type:"error"})}finally{U(!1)}};return m&&!c&&!ie?i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):ie?i.jsxs("div",{className:"p-4 space-y-6 pb-24",children:[i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Attendance"}),i.jsxs("div",{className:"bg-card p-3 rounded-xl shadow-sm border border-border flex flex-wrap items-center gap-2",children:[["Today","This Month","Last 30 Days"].map(ce=>i.jsx(ae,{type:"button",variant:w===ce?"primary":"outline",onClick:()=>K(ce),className:w===ce?"text-white shadow-md border":"bg-card text-primary-text border border-border hover:bg-accent-light",style:w===ce?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},children:ce},ce)),i.jsxs("div",{className:"relative",ref:I,children:[i.jsxs(ae,{type:"button",variant:w==="Custom"?"primary":"outline",onClick:()=>k(!P),className:w==="Custom"?"text-white shadow-md border":"bg-card text-primary-text border border-border hover:bg-accent-light",style:w==="Custom"?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},children:[i.jsx(Sa,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:w==="Custom"?`${Ue(x.startDate,"dd MMM")} - ${Ue(x.endDate,"dd MMM")}`:"Custom"})]}),P&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-50 bg-white dark:bg-gray-950 border border-border rounded-lg shadow-xl w-[300px] sm:w-auto overflow-hidden",children:i.jsx("div",{className:"text-gray-900",children:i.jsx(lm.DateRangePicker,{onChange:oe,months:1,ranges:_,direction:"horizontal",maxDate:new Date})})})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-emerald-600 text-white rounded-full mb-3 shadow-lg shadow-emerald-200 dark:shadow-none",children:i.jsx(du,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Present"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:$.present})]}),i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-rose-600 text-white rounded-full mb-3 shadow-lg shadow-rose-200 dark:shadow-none",children:i.jsx(xx,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Absent"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:$.absent})]}),i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-blue-600 text-white rounded-full mb-3 shadow-lg shadow-blue-200 dark:shadow-none",children:i.jsx(Vc,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Overtime"}),i.jsxs("p",{className:"text-2xl font-bold text-primary-text",children:[$.ot,"h"]})]}),i.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"p-4 bg-purple-600 text-white rounded-full mb-3 shadow-lg shadow-purple-200 dark:shadow-none",children:i.jsx(Tk,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm text-muted font-medium mb-1",children:"Comp Offs"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:$.compOff})]})]}),i.jsxs("div",{className:"bg-card rounded-xl shadow-sm border border-border overflow-hidden",children:[i.jsx("div",{className:"p-4 border-b border-border font-semibold text-primary-text",children:"Attendance Logs"}),i.jsx("div",{className:"divide-y divide-border",children:m?i.jsx("div",{className:"p-8 text-center text-muted",children:i.jsx(Tt,{className:"h-6 w-6 animate-spin mx-auto"})}):se.length===0?i.jsx("div",{className:"p-8 text-center text-muted",children:"No records found for this period."}):se.map((ce,Se)=>i.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-900/50 transition-colors",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-primary-text",children:ce.date}),i.jsx("p",{className:"text-xs text-muted",children:ce.day})]}),i.jsxs("div",{className:"flex flex-col items-end gap-1.5",children:[i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider shadow-sm
                                            ${ce.status==="Present"?"bg-emerald-500 text-white dark:bg-emerald-600":ce.status==="Absent"?"bg-rose-500 text-white dark:bg-rose-600":ce.status==="Holiday"?"bg-amber-500 text-white dark:bg-amber-600":ce.status==="Weekend"?"bg-indigo-500 text-white dark:bg-indigo-600":"bg-gray-500 text-white dark:bg-gray-600"}`,children:ce.status}),(ce.checkIn!=="-"||ce.checkOut!=="-")&&i.jsxs("div",{className:"text-xs text-muted font-medium",children:[ce.checkIn," - ",ce.checkOut]}),ce.ot>0&&i.jsxs("span",{className:"text-[10px] text-blue-600 dark:text-blue-400 font-bold",children:["+",ce.ot,"h OT"]})]})]},Se))})]})]}):i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Attendance Dashboard"})}),i.jsxs("div",{className:"hidden md:flex bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex-wrap items-end gap-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Today","Last 7 Days","This Month"].map(ce=>i.jsx(ae,{type:"button",onClick:()=>K(ce),className:w===ce?"text-white shadow-md border":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50",style:w===ce?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},children:ce},ce)),i.jsxs("div",{className:"relative",ref:I,children:[i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>k(!P),className:"hover:bg-gray-100",children:[i.jsx(Sa,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:w==="Custom"?`${Ue(x.startDate,"dd MMM, yyyy")} - ${Ue(x.endDate,"dd MMM, yyyy")}`:"Custom Range"})]}),P&&i.jsxs("div",{className:"absolute top-full left-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 p-3",children:[i.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:Ue(x.startDate,"yyyy-MM-dd"),max:Ue(new Date,"yyyy-MM-dd"),onChange:ce=>{const Se=new Date(ce.target.value);let ye=x.endDate;Se>ye&&(ye=Se),v({startDate:Se,endDate:ye,key:"selection"}),j("Custom")}}),i.jsx("span",{className:"text-sm",children:"to"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:Ue(x.endDate,"yyyy-MM-dd"),max:Ue(new Date,"yyyy-MM-dd"),onChange:ce=>{const Se=new Date(ce.target.value);let ye=x.startDate;Se<ye&&(ye=Se),v({startDate:ye,endDate:Se,key:"selection"}),j("Custom")}})]}),i.jsx(lm.DateRangePicker,{onChange:oe,months:n?1:2,ranges:_,direction:"horizontal",maxDate:new Date})]})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Report Type"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none",value:O,onChange:ce=>q(ce.target.value),children:[i.jsx("option",{value:"basic",children:"Basic Report"}),i.jsx("option",{value:"log",children:"Attendance Log"}),i.jsx("option",{value:"monthly",children:"Monthly Report"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Employee"}),i.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none max-w-[200px]",value:M,onChange:ce=>D(ce.target.value),children:[i.jsx("option",{value:"all",children:"All Employees"}),s.map(ce=>i.jsx("option",{value:ce.id,children:ce.name},ce.id))]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(po,{title:"Total Employees",value:c?.totalEmployees||0,icon:mi}),i.jsx(po,{title:`Present ${re}`,value:c?.presentToday||0,icon:du}),i.jsx(po,{title:`Absent ${re}`,value:c?.absentToday||0,icon:xx}),i.jsx(po,{title:`On Leave ${re}`,value:c?.onLeaveToday||0,icon:Vc})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx(yL,{title:"Attendance Trend",icon:TK,children:c?i.jsx(Nle,{data:c.attendanceTrend}):i.jsx(Tt,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})}),i.jsx(yL,{title:"Productivity Trend (Avg. Hours)",icon:Tk,children:c?i.jsx(Cle,{data:c.productivityTrend}):i.jsx(Tt,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})})]}),i.jsx("div",{style:{position:"fixed",top:"0",left:"0",width:"1123px",zIndex:-1e3,opacity:0,pointerEvents:"none"},children:i.jsx("div",{ref:Y,className:"w-full bg-white",children:fe})}),i.jsxs("div",{className:"hidden md:block bg-white p-6 rounded-xl shadow-sm border border-gray-100 overflow-auto max-h-[600px]",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold",children:"Report Preview"}),ne&&i.jsxs(ae,{type:"button",onClick:ue,disabled:F,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[F?i.jsx(Tt,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(EF,{className:"mr-2 h-4 w-4"}),F?"Generating...":"Download CSV"]})]}),i.jsx("div",{className:"border p-4 rounded bg-gray-50",children:fe})]}),B&&i.jsx(Gt,{message:B.message,type:B.type,onDismiss:()=>G(null)})]})},Ele=n=>n.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),Dle=(n,e,t,r)=>{const a=n*Math.PI/180,o=t*Math.PI/180,l=(t-n)*Math.PI/180,c=(r-e)*Math.PI/180,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},Ole=()=>{const{user:n}=St(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState(!0),[l,c]=E.useState(!1),[d,m]=E.useState(null),[p,x]=E.useState(""),[v,_]=E.useState(""),[w,j]=E.useState(""),[P,k]=E.useState(""),[I,M]=E.useState(null),D=n&&["admin","hr"].includes(n.role);E.useEffect(()=>{(async()=>{if(n)try{const[Q,Y]=await Promise.all([pe.getUserLocations(n.id),pe.getLocations()]);t(Q),s(Y)}catch(Q){console.error(Q),m({message:"Failed to load locations.",type:"error"})}finally{o(!1)}})()},[n]);const O=X=>{const Q=X.target.value,Y=Ele(Q);x(Y)},q=async()=>{c(!0);try{const X=await Bx().catch(()=>null);let Q,Y;if(X&&X.coords&&(Q=X.coords.latitude,Y=X.coords.longitude),Q===void 0||Y===void 0){const ne=await new Promise(te=>{navigator.geolocation.getCurrentPosition(ie=>te(ie),()=>te(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})});ne&&ne.coords&&(Q=ne.coords.latitude,Y=ne.coords.longitude)}if(Q===void 0||Y===void 0)throw new Error("Unable to retrieve current location.");_(Q.toString()),j(Y.toString());try{const ne=await sm(Q,Y);k(ne)}catch(ne){console.warn("Reverse geocode failed:",ne)}m({message:"Coordinates and address filled. Please enter a location name.",type:"success"})}catch(X){console.error(X),m({message:X.message||"Failed to get current location.",type:"error"})}finally{c(!1)}},F=async()=>{if(!n||!D){m({message:"You do not have permission to add locations.",type:"error"});return}if(!p.trim()){m({message:"Please enter a location name.",type:"error"});return}const X=parseFloat(v),Q=parseFloat(w);if(isNaN(X)||isNaN(Q)){m({message:"Please provide valid coordinates.",type:"error"});return}if(r.find(ne=>ne.id!==I&&ne.name?.toLowerCase()===p.toLowerCase())){m({message:`Location "${p}" already exists. Please use a different name.`,type:"error"});return}if(!I&&r.find(te=>Dle(X,Q,te.latitude,te.longitude)<10)){m({message:"A location already exists at these coordinates.",type:"error"});return}c(!0);try{if(I)await pe.updateLocation(I,{name:p,latitude:X,longitude:Q,radius:100,address:P||null}),m({message:"Location updated successfully.",type:"success"});else{const $=await pe.createLocation({name:p,latitude:X,longitude:Q,radius:100,address:P||null,createdBy:n.id});await pe.assignLocationToUser(n.id,$.id),m({message:"Location added successfully.",type:"success"})}const[te,ie]=await Promise.all([pe.getUserLocations(n.id),pe.getLocations()]);t(te),s(ie),G()}catch(ne){console.error(ne),m({message:ne.message||"Failed to save location.",type:"error"})}finally{c(!1)}},U=X=>{M(X.id),x(X.name||""),_(X.latitude.toString()),j(X.longitude.toString()),k(X.address||""),window.scrollTo({top:0,behavior:"smooth"})},B=async X=>{if(!n||!D){m({message:"You do not have permission to delete locations.",type:"error"});return}if(window.confirm("Are you sure you want to delete this location? It will be removed from all users."))try{await pe.deleteLocation(X),m({message:"Location deleted successfully.",type:"success"});const[Q,Y]=await Promise.all([pe.getUserLocations(n.id),pe.getLocations()]);t(Q),s(Y)}catch(Q){console.error(Q),m({message:Q.message||"Failed to delete location.",type:"error"})}},G=()=>{x(""),_(""),j(""),k(""),M(null)};return i.jsxs("div",{className:"p-4 md:p-6 w-full",children:[d&&i.jsx(Gt,{message:d.message,type:d.type,onDismiss:()=>m(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center",children:[i.jsx(wl,{className:"h-6 w-6 mr-2"})," My Locations"]}),i.jsxs("p",{className:"text-muted mb-6",children:["These are the geofenced locations assigned to you. You may check in/out only when within one of these locations. ",D?"Use the form below to add a new location.":"You can edit location names by clicking the edit button."]}),(D||I)&&i.jsxs("div",{className:"bg-gray-50 border border-border rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:I?"Edit Location":"Add New Location"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(Me,{label:"Location Name (required) *",id:"locationName",value:p,onChange:O,placeholder:"e.g. Office HQ",required:!0}),i.jsx(Me,{label:"Latitude",id:"latitude",type:"number",value:v,onChange:X=>_(X.target.value),placeholder:"12.9716",step:"any",disabled:I&&!D}),i.jsx(Me,{label:"Longitude",id:"longitude",type:"number",value:w,onChange:X=>j(X.target.value),placeholder:"77.5946",step:"any",disabled:I&&!D}),i.jsx(Me,{label:"Address (optional)",id:"address",value:P,onChange:X=>k(X.target.value),placeholder:"Street, City, State",disabled:I&&!D})]}),i.jsxs("div",{className:"flex gap-4 flex-wrap",children:[D&&i.jsxs(ae,{onClick:q,variant:"secondary",isLoading:l,disabled:l,children:[i.jsx(qF,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),i.jsx(ae,{onClick:F,isLoading:l,disabled:l||!p.trim(),children:I?"Save Changes":"Add Location"}),I&&i.jsx(ae,{onClick:G,variant:"secondary",children:"Cancel"})]})]})]}),i.jsx("div",{className:"mt-6",children:a?i.jsx("p",{children:"Loading locations..."}):e.length===0?i.jsx("p",{className:"text-muted text-center md:text-left",children:D?"No locations assigned. Use the form above to add one.":"You have no locations assigned. Contact your administrator."}):i.jsxs("div",{className:"space-y-4 md:space-y-0 md:grid md:grid-cols-1 md:gap-4",children:[i.jsx("div",{className:"md:hidden space-y-4",children:e.map(X=>i.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-primary-text",children:X.name||X.address||"Unnamed Location"}),i.jsx("p",{className:"text-sm text-muted",children:X.address})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-500 hover:text-blue-700 p-1",title:D?"Edit Location":"Edit Name",onClick:()=>U(X),children:i.jsx(xr,{className:"h-5 w-5"})}),D&&i.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 p-1",title:"Delete Location",onClick:()=>B(X.id),children:i.jsx(Xt,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Radius"}),i.jsxs("p",{children:[X.radius,"m"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Coordinates"}),i.jsxs("p",{children:[X.latitude?.toFixed(4),", ",X.longitude?.toFixed(4)]})]})]})]},X.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[i.jsx("thead",{className:"bg-page text-primary-text",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),i.jsx("tbody",{children:e.map(X=>i.jsxs("tr",{className:"border-b border-border",children:[i.jsx("td",{className:"p-3",children:X.name||"-"}),i.jsx("td",{className:"p-3",children:X.radius}),i.jsxs("td",{className:"p-3",children:[X.latitude?.toFixed(4),", ",X.longitude?.toFixed(4)]}),i.jsx("td",{className:"p-3",children:X.address||"-"}),i.jsxs("td",{className:"p-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-800",title:D?"Edit Location":"Edit Name",onClick:()=>U(X),children:i.jsx(xr,{className:"h-4 w-4"})}),D&&i.jsx("button",{type:"button",className:"text-red-600 hover:text-red-800",title:"Delete Location",onClick:()=>B(X.id),children:i.jsx(Xt,{className:"h-4 w-4"})})]})]},X.id))})]})})]})})]})},Ile=()=>{const{attendance:n,officeHolidays:e,fieldHolidays:t,recurringHolidays:r,addHoliday:s,removeHoliday:a,addRecurringHoliday:o,removeRecurringHoliday:l,updateAttendanceSettings:c}=fi(),[d,m]=E.useState(n),[p,x]=E.useState(!1),[v,_]=E.useState(!1),[w,j]=E.useState("office"),[P,k]=E.useState(""),[I,M]=E.useState(""),[D,O]=E.useState(3),[q,F]=E.useState("Saturday"),[U,B]=E.useState(null);E.useEffect(()=>{m(n)},[n]),E.useEffect(()=>{x(JSON.stringify(d)!==JSON.stringify(n))},[d,n]);const G=d[w],X=w==="office"?e:t,Q=async te=>{if(te.preventDefault(),P&&I){if(X.some(ie=>ie.date===I)){B({message:"A holiday for this date already exists.",type:"error"});return}try{await s(w,{name:P,date:I}),k(""),M(""),B({message:"Holiday added successfully.",type:"success"})}catch{B({message:"Failed to add holiday.",type:"error"})}}else B({message:"Please provide both a name and a date.",type:"error"})},Y=(te,ie)=>{m($=>({...$,[w]:{...$[w],[te]:ie}}))},ne=async()=>{_(!0);try{await pe.saveAttendanceSettings(d),c(d),B({message:"Attendance rules saved successfully!",type:"success"})}catch{B({message:"Failed to save attendance rules.",type:"error"})}finally{_(!1)}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full pb-40",children:[U&&i.jsx(Gt,{message:U.message,type:U.type,onDismiss:()=>B(null)}),i.jsx(Yi,{title:"Attendance & Leave Rules",children:i.jsxs(ae,{onClick:ne,isLoading:v,disabled:!p,children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),i.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Set company-wide rules for attendance and leave calculation."}),i.jsx("div",{className:"mb-6 border-b border-border",children:i.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[i.jsx("button",{onClick:()=>j("office"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${w==="office"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Office Staff"}),i.jsx("button",{onClick:()=>j("field"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${w==="field"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Field Staff"})]})}),w==="office"&&i.jsx("p",{className:"text-sm text-muted -mt-4 mb-4",children:"These rules apply to Admin, HR, and Finance roles."}),w==="field"&&i.jsx("p",{className:"text-sm text-muted -mt-4 mb-4",children:"These rules apply to all other roles (e.g., Field Officers, Managers)."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Vc,{className:"mr-2 h-5 w-5 text-muted"}),"Work Hours"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx(Me,{label:"Minimum Hours for Full Day",id:"minHoursFull",type:"number",value:G.minimumHoursFullDay,onChange:te=>Y("minimumHoursFullDay",parseFloat(te.target.value)||0)}),i.jsx(Me,{label:"Minimum Hours for Half Day",id:"minHoursHalf",type:"number",value:G.minimumHoursHalfDay,onChange:te=>Y("minimumHoursHalfDay",parseFloat(te.target.value)||0)})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(gx,{className:"mr-2 h-5 w-5 text-muted"}),"Leave Allocation"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx(Me,{label:"Annual Earned Leaves",id:"annualEarnedLeaves",type:"number",value:G.annualEarnedLeaves,onChange:te=>Y("annualEarnedLeaves",parseInt(te.target.value,10)||0)}),i.jsx(Me,{label:"Annual Sick Leaves",id:"annualSickLeaves",type:"number",value:G.annualSickLeaves,onChange:te=>Y("annualSickLeaves",parseInt(te.target.value,10)||0)}),i.jsx(Me,{label:"Monthly Floating Holidays",id:"monthlyFloatingLeaves",type:"number",value:G.monthlyFloatingLeaves,onChange:te=>Y("monthlyFloatingLeaves",parseInt(te.target.value,10)||0)}),i.jsx(Me,{label:"Annual Compensatory Off",id:"annualCompOffLeaves",type:"number",value:G.annualCompOffLeaves,onChange:te=>Y("annualCompOffLeaves",parseInt(te.target.value,10)||0)}),i.jsx(Me,{label:"Sick Leave Cert. After (Days)",id:"sickLeaveCertThreshold",type:"number",value:G.sickLeaveCertificateThreshold,onChange:te=>Y("sickLeaveCertificateThreshold",parseInt(te.target.value,10)||0),title:"Require a doctor's certificate if total sick leave taken exceeds this number of days."})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Cf,{className:"mr-2 h-5 w-5 text-muted"}),"Notifications"]}),i.jsx(Cn,{id:"attendance-notifications",label:"Enable Check-in/Check-out Notifications",description:"Send a notification to Site Managers, Ops Managers, and HR when a Field Officer checks in or out.",checked:G.enableAttendanceNotifications,onChange:te=>Y("enableAttendanceNotifications",te.target.checked)})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Sa,{className:"mr-2 h-5 w-5 text-muted"}),"Recurring Holidays"]}),i.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Add Recurring Holiday"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[i.jsxs(Qe,{label:"Occurrence",value:D,onChange:te=>O(parseInt(te.target.value)),children:[i.jsx("option",{value:1,children:"1st"}),i.jsx("option",{value:2,children:"2nd"}),i.jsx("option",{value:3,children:"3rd"}),i.jsx("option",{value:4,children:"4th"}),i.jsx("option",{value:5,children:"5th"})]}),i.jsxs(Qe,{label:"Day",value:q,onChange:te=>F(te.target.value),children:[i.jsx("option",{value:"Monday",children:"Monday"}),i.jsx("option",{value:"Tuesday",children:"Tuesday"}),i.jsx("option",{value:"Wednesday",children:"Wednesday"}),i.jsx("option",{value:"Thursday",children:"Thursday"}),i.jsx("option",{value:"Friday",children:"Friday"}),i.jsx("option",{value:"Saturday",children:"Saturday"}),i.jsx("option",{value:"Sunday",children:"Sunday"})]}),i.jsxs(ae,{type:"button",onClick:async()=>{try{await o({day:q,n:D,type:w}),B({message:"Recurring holiday added successfully.",type:"success"})}catch{B({message:"Failed to add recurring holiday.",type:"error"})}},size:"sm",className:"w-full sm:w-auto",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Rule"]})]})]}),i.jsxs("div",{className:"mt-4 space-y-2",children:[r.filter(te=>(te.type||"office")===w).map((te,ie)=>i.jsxs("div",{className:"flex justify-between items-center p-4 border border-white/10 rounded-lg bg-white/5 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("p",{className:"font-medium text-primary-text truncate",children:[te.n===1?"1st":te.n===2?"2nd":te.n===3?"3rd":te.n+"th"," ",te.day]}),i.jsx("p",{className:"text-sm text-muted",children:"Repeats every month"})]}),i.jsx("div",{className:"ml-4 shrink-0",children:i.jsx(ae,{variant:"icon",onClick:async()=>{if(te.id)try{await l(te.id),B({message:"Recurring holiday removed successfully.",type:"success"})}catch{B({message:"Failed to remove recurring holiday.",type:"error"})}},className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(Xt,{className:"h-5 w-5 text-red-500"})})})]},te.id||ie)),r.filter(te=>(te.type||"office")===w).length===0&&i.jsx("p",{className:"text-center text-muted py-4",children:"No recurring holidays configured."})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Sa,{className:"mr-2 h-5 w-5 text-muted"}),"Holiday List"]}),i.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Add New Holiday"}),i.jsxs("form",{onSubmit:Q,className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[i.jsx(Me,{label:"Holiday Name",id:"holidayName",value:P,onChange:te=>k(te.target.value)}),i.jsx(Nn,{label:"Date",id:"holidayDate",value:I,onChange:M}),i.jsxs(ae,{type:"submit",size:"sm",className:"w-full sm:w-auto",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add"]})]})]}),i.jsx("div",{className:"mt-4 space-y-2",children:X.length>0?X.map(te=>i.jsxs("div",{className:"flex justify-between items-center p-4 border border-white/10 rounded-lg bg-white/5 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium text-primary-text truncate",children:te.name}),i.jsx("p",{className:"text-sm text-muted",children:new Date(te.date.replace(/-/g,"/")).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})})]}),i.jsx("div",{className:"ml-4 shrink-0",children:i.jsx(ae,{variant:"icon",onClick:()=>a(w,te.id),"aria-label":`Remove ${te.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(Xt,{className:"h-5 w-5 text-red-500"})})})]},te.id)):i.jsxs("p",{className:"text-center text-muted py-4",children:["No holidays added yet for ",w," staff."]})})]})]})]})},Ale=()=>{const{user:n}=St(),{officeHolidays:e,fieldHolidays:t,attendance:r,recurringHolidays:s}=fi(),[a,o]=E.useState(new Date),[l,c]=E.useState([]),[d,m]=E.useState(!1),p=E.useMemo(()=>n?.role==="field_officer"?t:e,[n,t,e]),x=E.useMemo(()=>{const I=n?.role==="field_officer"?"field":"office";return s.filter(M=>(M.type||"office")===I)},[n,s]);E.useEffect(()=>{console.log("Active Recurring Rules:",x)},[x]);const v=E.useMemo(()=>{const I=[],M=ui(a),D=_a(a),O=uo({start:M,end:D}),q=(n?.role==="field_officer"?r?.field?.monthlyFloatingLeaves:r?.office?.monthlyFloatingLeaves)??0;let F=0;return x.forEach(U=>{if(F>=q)return;let B=0;for(const G of O)if(Ue(G,"EEEE").toLowerCase()===U.day.toLowerCase()&&(B++,B===U.n)){I.push(G),F++;break}}),I},[a,x,r,n]);E.useEffect(()=>{console.log("Calculated Recurring Holiday Dates:",v)},[v]),E.useEffect(()=>{const I=async()=>{if(n){m(!0);try{const O=ui(a).toISOString(),q=_a(a).toISOString(),F=await pe.getAttendanceEvents(n.id,O,q);c(F)}catch(O){console.error("Failed to fetch attendance events",O)}finally{m(!1)}}},M=async()=>{try{console.log("Fetching attendance settings...");const O=await pe.getAttendanceSettings();console.log("Fetched settings:",O),fi.getState().updateAttendanceSettings(O)}catch(O){console.error("Failed to fetch attendance settings",O)}},D=async()=>{try{console.log("Fetching recurring holidays...");const O=await pe.getRecurringHolidays();console.log("Fetched recurring holidays:",O),fi.setState({recurringHolidays:O})}catch(O){console.error("Failed to fetch recurring holidays",O)}};I(),M(),D()},[n,a]);const _=E.useMemo(()=>uo({start:ui(a),end:_a(a)}),[a]),w=I=>{const M=l.some(F=>cf(new Date(F.timestamp),I)&&(F.type.toLowerCase().includes("check")||F.type.toLowerCase().includes("in"))),D=v.some(F=>cf(F,I)),O=p.some(F=>cf(new Date(F.date),I));return(D||O)&&M?"holiday-present":D?"floating-holiday":O?"holiday":M?"present":_W(qc(new Date),qc(I))?"absent":"neutral"},j=I=>{switch(I){case"present":return"bg-emerald-500 text-white border-emerald-600 shadow-sm";case"absent":return"bg-rose-500 text-white border-rose-600 shadow-sm";case"holiday":return"bg-red-600 text-white border-red-700 shadow-sm";case"floating-holiday":return"bg-amber-500 text-white border-amber-600 shadow-sm";case"holiday-present":return"bg-violet-600 text-white border-violet-700 shadow-sm";default:return"bg-gray-50 text-gray-400 border-gray-100"}},P=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],k=rC(ui(a));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-none bg-transparent p-3 rounded-xl shadow-none w-full md:w-full md:max-w-[320px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Attendance Calendar"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ae,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>o(aC(a)),children:i.jsx(Wx,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-sm",children:Ue(a,"MMMM yyyy")}),i.jsx(ae,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>o(Fx(a,1)),children:i.jsx(Tf,{className:"h-3 w-3"})})]})]}),d?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(Tt,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[P.map(I=>i.jsx("div",{className:"text-center text-xs font-medium text-muted py-1",children:I},I)),Array.from({length:k}).map((I,M)=>i.jsx("div",{className:"aspect-square"},`empty-${M}`)),_.map(I=>{const M=w(I),D=j(M);return i.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${D} transition-colors`,children:i.jsx("span",{className:"text-sm font-semibold",children:Ue(I,"d")})},I.toISOString())})]}),i.jsxs("div",{className:"mt-3 flex gap-3 text-xs text-muted justify-center flex-wrap",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-emerald-500 border border-emerald-600 rounded-sm"})," Present"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-rose-500 border border-rose-600 rounded-sm"})," Absent"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-red-600 border border-red-700 rounded-sm"})," Holiday"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-amber-500 border border-amber-600 rounded-sm"})," Floating Holiday"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-violet-600 border border-violet-700 rounded-sm"})," Holiday Present"]})]})]})},Rle=({logs:n,isLoading:e=!1})=>{const[t,r]=E.useState(new Date),s=E.useMemo(()=>uo({start:ui(t),end:_a(t)}),[t]),a=d=>n.some(p=>{const x=new Date(p.dateEarned.replace(/-/g,"/"));return cf(x,d)})?"earned":"neutral",o=d=>{switch(d){case"earned":return"bg-blue-600 text-white border-blue-700 shadow-sm";default:return"bg-gray-50 text-gray-400 border-gray-100"}},l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],c=rC(ui(t));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-none bg-transparent p-3 rounded-xl shadow-none w-full md:w-full md:max-w-[320px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Comp Off Tracker"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ae,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>r(aC(t)),children:i.jsx(Wx,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-sm",children:Ue(t,"MMMM yyyy")}),i.jsx(ae,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>r(Fx(t,1)),children:i.jsx(Tf,{className:"h-3 w-3"})})]})]}),e?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(Tt,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[l.map(d=>i.jsx("div",{className:"text-center text-xs font-medium text-muted py-1",children:d},d)),Array.from({length:c}).map((d,m)=>i.jsx("div",{className:"aspect-square"},`empty-${m}`)),s.map(d=>{const m=a(d),p=o(m);return i.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${p} transition-colors`,children:i.jsx("span",{className:"text-sm font-semibold",children:Ue(d,"d")})},d.toISOString())})]}),i.jsx("div",{className:"mt-3 flex gap-3 text-xs text-muted justify-center",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-600 border border-blue-700 rounded-sm"})," Comp Off Earned"]})})]})},Lle=()=>{const{user:n}=St(),[e,t]=E.useState(new Date),[r,s]=E.useState([]),[a,o]=E.useState(!1);E.useEffect(()=>{(async()=>{if(n){o(!0);try{const x=ui(e).toISOString(),v=_a(e).toISOString(),_=await pe.getAttendanceEvents(n.id,x,v);s(_)}catch(x){console.error("Failed to fetch attendance events",x)}finally{o(!1)}}})()},[n,e]);const l=E.useMemo(()=>uo({start:ui(e),end:_a(e)}),[e]),c=p=>{const x=r.filter(k=>cf(new Date(k.timestamp),p));if(x.length===0)return 0;const v=[...x].sort((k,I)=>new Date(k.timestamp).getTime()-new Date(I.timestamp).getTime());let _=0,w=null;v.forEach(k=>{const I=new Date(k.timestamp);k.type==="check-in"?w=I:k.type==="check-out"&&w&&(_+=df(I,w),w=null)});const j=_/60,P=Math.max(0,j-8);return parseFloat(P.toFixed(1))},d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],m=rC(ui(e));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-0 bg-transparent p-3 rounded-xl shadow-none w-full",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"OT Calendar"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ae,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>t(aC(e)),children:i.jsx(Wx,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-xs",children:Ue(e,"MMMM yyyy")}),i.jsx(ae,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>t(Fx(e,1)),children:i.jsx(Tf,{className:"h-3 w-3"})})]})]}),a?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(Tt,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[d.map(p=>i.jsx("div",{className:"text-center text-[10px] font-medium text-muted py-1",children:p},p)),Array.from({length:m}).map((p,x)=>i.jsx("div",{className:"aspect-square"},`empty-${x}`)),l.map(p=>{const x=c(p),v=x>0;return i.jsxs("div",{className:`aspect-square rounded border flex flex-col items-center justify-center transition-colors ${v?"bg-blue-600 text-white border-blue-700 shadow-sm":"bg-gray-50 text-gray-400 border-gray-100"}`,children:[i.jsx("span",{className:"text-xs font-semibold",children:Ue(p,"d")}),v&&i.jsxs("span",{className:"text-[8px] font-bold",children:["+",x,"h"]})]},p.toISOString())})]}),i.jsx("div",{className:"mt-3 flex gap-3 text-[10px] text-muted justify-center flex-wrap",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-600 border border-blue-700 rounded-sm"})," Overtime (>8h)"]})})]})},Fle=()=>{const{user:n}=St(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState("day"),[l,c]=E.useState(new Date),[d,m]=E.useState({});Jt("(max-width: 767px)");const p=async()=>{if(n){s(!0);try{let P,k;switch(a){case"day":P=qc(l),k=eC(l);break;case"week":P=yo(l,{weekStartsOn:1}),k=WP(l,{weekStartsOn:1});break;case"month":P=ui(l),k=_a(l);break}const I=await pe.getAttendanceEvents(n.id,P.toISOString(),k.toISOString());t(I);const M=I.filter(D=>D.latitude&&D.longitude).map(D=>({lat:D.latitude,lon:D.longitude}));if(M.length>0)try{const D=await pe.batchResolveAddresses(M);m(D)}catch(D){console.error("Failed to fetch location addresses:",D)}}catch(P){console.error("Failed to fetch attendance events:",P)}finally{s(!1)}}};E.useEffect(()=>{p()},[n,a,l]);const x=E.useMemo(()=>{const P={};return e.forEach(k=>{const I=Ue(new Date(k.timestamp),"yyyy-MM-dd");P[I]||(P[I]={date:I,events:[],checkIns:[],checkOuts:[],totalMinutes:0}),P[I].events.push(k),k.type==="check-in"?P[I].checkIns.push(k):k.type==="check-out"&&P[I].checkOuts.push(k)}),Object.values(P).forEach(k=>{const I=[...k.events].sort((O,q)=>new Date(O.timestamp).getTime()-new Date(q.timestamp).getTime());let M=0,D=null;I.forEach(O=>{const q=new Date(O.timestamp);O.type==="check-in"?D=q:O.type==="check-out"&&D&&(M+=df(q,D),D=null)}),k.totalMinutes=M}),Object.values(P).sort((k,I)=>I.date.localeCompare(k.date))},[e]),v=P=>{const k=Math.floor(P/60),I=P%60;return`${k}h ${I}m`},_=P=>{o(P)},w=P=>{const k=new Date(l);switch(a){case"day":k.setDate(k.getDate()+(P==="next"?1:-1));break;case"week":k.setDate(k.getDate()+(P==="next"?7:-7));break;case"month":k.setMonth(k.getMonth()+(P==="next"?1:-1));break}c(k)},j=()=>{switch(a){case"day":return Ue(l,"dd MMM, yyyy");case"week":const P=yo(l,{weekStartsOn:1}),k=WP(l,{weekStartsOn:1});return`${Ue(P,"dd MMM")} - ${Ue(k,"dd MMM, yyyy")}`;case"month":return Ue(l,"MMMM yyyy")}};return n?i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-indigo-50 rounded-lg",children:i.jsx(Vc,{className:"h-5 w-5 text-indigo-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Employee Log"})]}),i.jsxs("div",{className:"mb-6 space-y-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>_("day"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="day"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Day"}),i.jsx("button",{onClick:()=>_("week"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="week"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Week"}),i.jsx("button",{onClick:()=>_("month"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="month"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Month"})]}),i.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[i.jsx("button",{onClick:()=>w("prev"),className:"px-3 py-1 bg-white rounded-md shadow-sm hover:bg-gray-100 transition-colors",children:""}),i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-gray-900",children:[i.jsx(Sa,{className:"h-4 w-4"}),i.jsx("span",{children:j()})]}),i.jsx("button",{onClick:()=>w("next"),className:"px-3 py-1 bg-white rounded-md shadow-sm hover:bg-gray-100 transition-colors",children:""})]})]}),i.jsx("div",{className:"space-y-4",children:r?i.jsx("div",{className:"flex items-center justify-center py-10",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-indigo-600"})}):x.length===0?i.jsxs("div",{className:"text-center py-10 text-gray-500",children:[i.jsx(Sa,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{className:"font-medium",children:"No attendance records found"}),i.jsx("p",{className:"text-sm mt-1",children:"Check-in to start tracking your attendance"})]}):x.map(P=>i.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl border border-gray-200 overflow-hidden",children:[i.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-500 px-4 py-3 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 text-white",children:[i.jsx(Sa,{className:"h-4 w-4"}),i.jsx("span",{className:"font-semibold",children:Ue(new Date(P.date),"EEEE, dd MMMM yyyy")})]}),i.jsx("div",{className:"text-white text-sm font-medium bg-white/20 px-3 py-1 rounded-full",children:v(P.totalMinutes)})]}),i.jsx("div",{className:"p-4 space-y-3",children:P.events.sort((k,I)=>new Date(k.timestamp).getTime()-new Date(I.timestamp).getTime()).map((k,I)=>i.jsx("div",{className:`p-3 rounded-lg border-l-4 ${k.type==="check-in"?"bg-emerald-50 border-emerald-500":"bg-rose-50 border-rose-500"}`,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`p-2 rounded-lg ${k.type==="check-in"?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:i.jsx(Vc,{className:"h-4 w-4"})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900 capitalize",children:k.type.replace("-"," ")}),i.jsx("div",{className:"text-sm text-gray-600",children:Ue(new Date(k.timestamp),"hh:mm a")})]})]}),k.latitude&&k.longitude&&i.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-600 bg-white px-3 py-1.5 rounded-lg border border-gray-200 max-w-md",children:[i.jsx(wl,{className:"h-4 w-4 text-indigo-600 flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-xs break-words",children:d[`${k.latitude.toFixed(6)},${k.longitude.toFixed(6)}`]||`${k.latitude.toFixed(4)}, ${k.longitude.toFixed(4)}`})]})]})},`${k.timestamp}-${I}`))}),i.jsx("div",{className:"bg-gray-50 px-4 py-3 border-t border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Check-ins:"}),i.jsx("span",{className:"ml-2 font-semibold text-emerald-600",children:P.checkIns.length})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Check-outs:"}),i.jsx("span",{className:"ml-2 font-semibold text-rose-600",children:P.checkOuts.length})]})]})})]},P.date))})]}):null},vL=({title:n,value:e,icon:t})=>i.jsxs("div",{className:"bg-card p-3 md:p-4 rounded-xl flex flex-col md:flex-row items-center md:items-center gap-2 md:gap-4 border border-border text-center md:text-left w-full",children:[i.jsx("div",{className:"bg-accent-light p-2 md:p-3 rounded-full flex-shrink-0",children:i.jsx(t,{className:"h-5 w-5 md:h-6 md:w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-xs md:text-sm text-muted font-medium",children:n}),i.jsx("p",{className:"text-lg md:text-2xl font-bold text-primary-text",children:e})]})]}),qle=({status:n})=>{const e={pending_manager_approval:"leave-status-chip--pending_manager_approval",pending_hr_confirmation:"leave-status-chip--pending_hr_confirmation",approved:"leave-status-chip--approved",rejected:"leave-status-chip--rejected"},t=n.replace(/_/g," ");return i.jsx("span",{className:`leave-status-chip ${e[n]}`,children:t})},zle=n=>wt({leaveType:be().oneOf(["Earned","Sick","Floating","Comp Off"]).required("Leave type is required"),startDate:be().required("Start date is required"),endDate:be().required("End date is required").test("is-after-start","End date must be on or after start date",function(e){const{startDate:t}=this.parent;return!t||!e?!0:new Date(e.replace(/-/g,"/"))>=new Date(t.replace(/-/g,"/"))}),reason:be().required("A reason for the leave is required").min(10,"Please provide a more detailed reason."),dayOption:be().oneOf(["full","half"]).optional(),doctorCertificate:Ft().when(["leaveType","startDate","endDate"],{is:(e,t,r)=>e!=="Sick"||!t||!r?!1:xm(new Date(r.replace(/-/g,"/")),new Date(t.replace(/-/g,"/")))+1>n,then:e=>e.required(`A doctor's certificate is required for sick leave longer than ${n} days.`),otherwise:e=>e.nullable().optional()})}),Ule=({isOpen:n,onClose:e,onSuccess:t,user:r,isMobile:s,setToast:a})=>{const{attendance:{office:{sickLeaveCertificateThreshold:o}}}=fi(),l=E.useMemo(()=>zle(o),[o]),{register:c,control:d,handleSubmit:m,watch:p,formState:{errors:x},reset:v}=Zt({resolver:_n(l),defaultValues:{leaveType:"Earned",startDate:Ue(new Date,"yyyy-MM-dd"),endDate:Ue(new Date,"yyyy-MM-dd"),dayOption:"full"}}),_=p("startDate"),w=p("endDate"),j=p("leaveType"),k=E.useMemo(()=>!_||!w?!1:cf(new Date(_.replace(/-/g,"/")),new Date(w.replace(/-/g,"/"))),[_,w])&&j==="Earned",I=E.useMemo(()=>j!=="Sick"||!_||!w?!1:xm(new Date(w.replace(/-/g,"/")),new Date(_.replace(/-/g,"/")))+1>o,[j,_,w,o]),M=async D=>{try{await pe.submitLeaveRequest({...D,userId:r.id,userName:r.name}),t()}catch{a({message:"Failed to submit leave request.",type:"error"})}};return n?i.jsx("div",{className:`fixed inset-0 z-40 bg-card ${s?"flex flex-col":"flex items-center justify-center bg-black/50 p-4"}`,children:i.jsxs("div",{className:`w-full ${s?"flex flex-col h-full":"max-w-2xl bg-card rounded-xl shadow-lg"}`,children:[i.jsxs("header",{className:`p-4 flex-shrink-0 flex items-center gap-4 ${s?"fo-mobile-header":"border-b"}`,children:[i.jsx(ae,{variant:"icon",onClick:e,"aria-label":"Go back",children:i.jsx(Hi,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-lg font-semibold",children:s?"New Leave Request":"Submit a New Leave Request"})]}),i.jsxs("form",{id:"leave-form",onSubmit:m(M),className:"flex-grow overflow-y-auto p-4 space-y-4",children:[i.jsx(je,{name:"leaveType",control:d,render:({field:D})=>i.jsxs(Qe,{label:"Leave Type",...D,error:x.leaveType?.message,className:s?"pro-select pro-select-arrow":"",children:[i.jsx("option",{children:"Earned"}),i.jsx("option",{children:"Sick"}),i.jsx("option",{children:"Floating"}),i.jsx("option",{children:"Comp Off"})]})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(je,{name:"startDate",control:d,render:({field:D})=>i.jsx(Nn,{label:"Start Date",id:"startDate",value:D.value,onChange:D.onChange,error:x.startDate?.message})}),i.jsx(je,{name:"endDate",control:d,render:({field:D})=>i.jsx(Nn,{label:"End Date",id:"endDate",value:D.value,onChange:D.onChange,error:x.endDate?.message})})]}),k&&i.jsx(je,{name:"dayOption",control:d,render:({field:D})=>i.jsxs(Qe,{label:"Day Option",...D,className:s?"pro-select pro-select-arrow":"",children:[i.jsx("option",{value:"full",children:"Full Day"}),i.jsx("option",{value:"half",children:"Half Day"})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Reason"}),i.jsx("textarea",{...c("reason"),rows:4,className:`mt-1 form-input ${x.reason?"form-input--error":""}`}),x.reason&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.reason.message})]}),I&&i.jsx(je,{name:"doctorCertificate",control:d,render:({field:D,fieldState:O})=>i.jsx(xt,{label:"Doctor's Certificate (Required)",file:D.value,onFileChange:D.onChange,error:O.error?.message,allowCapture:!0})})]}),i.jsxs("footer",{className:`p-4 flex-shrink-0 flex items-center justify-end gap-2 ${s?"":"border-t"}`,children:[i.jsx(ae,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(ae,{type:"submit",form:"leave-form",children:"Submit Request"})]})]})}):null},Vle=()=>{const{user:n}=St(),[e,t]=E.useState(null),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,m]=E.useState(!1),[p,x]=E.useState("all"),[v,_]=E.useState(null),w=Jt("(max-width: 767px)"),[j,P]=E.useState(!1),[k,I]=E.useState(0),M=E.useCallback(async()=>{if(n){c(!0),m(!1);try{const[U,B,G]=await Promise.all([pe.getLeaveBalancesForUser(n.id),pe.getLeaveRequests({userId:n.id,status:p==="all"?void 0:p}),pe.getCompOffLogs(n.id).catch(X=>{if(X&&X.message&&(X.message.includes("comp_off_logs")||X.message.includes('relation "public.comp_off_logs" does not exist')))return m(!0),[];throw X})]);if(t(U),s(B),o(G),n.role==="field_officer"){const X=new Date,Q=ui(X).toISOString(),Y=_a(X).toISOString(),ne=await pe.getAttendanceEvents(n.id,Q,Y),te={};ne.forEach($=>{const H=Ue(new Date($.timestamp),"yyyy-MM-dd");te[H]||(te[H]=[]),te[H].push($)});let ie=0;Object.values(te).forEach($=>{const H=[...$].sort((K,oe)=>new Date(K.timestamp).getTime()-new Date(oe.timestamp).getTime());let se=0,W=null;H.forEach(K=>{const oe=new Date(K.timestamp);K.type==="check-in"?W=oe:K.type==="check-out"&&W&&(se+=df(oe,W),W=null)});const ee=se/60;ee>8&&(ie+=ee-8)}),I(parseFloat(ie.toFixed(1)))}}catch(U){let B="Failed to load leave data.";U&&typeof U.message=="string"&&U.message.includes('relation "leave_requests" does not exist')&&(B='Database setup error: The "leave_requests" table is missing.'),console.error("Failed to load leave data",U),d||_({message:B,type:"error"})}finally{c(!1)}}},[n,p]);E.useEffect(()=>{M()},[M]);const D=()=>{_({message:"Leave request submitted successfully!",type:"success"}),P(!1),M()},O=U=>U.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase()),q=["all","pending_manager_approval","pending_hr_confirmation","approved","rejected"],F=e?[{title:"Earned Leave",value:`${e.earnedTotal-e.earnedUsed} / ${e.earnedTotal}`,icon:CF},{title:"Sick Leave",value:`${e.sickTotal-e.sickUsed} / ${e.sickTotal}`,icon:fC},{title:"Floating Holiday",value:`${e.floatingTotal-e.floatingUsed} / ${e.floatingTotal}`,icon:aJ},{title:"Compensatory Off",value:`${e.compOffTotal-e.compOffUsed} / ${e.compOffTotal}`,icon:IK}]:[];return i.jsxs("div",{className:"p-4 space-y-6",children:[v&&i.jsx(Gt,{message:v.message,type:v.type,onDismiss:()=>_(null)}),n&&i.jsx(Ule,{isOpen:j,onClose:()=>P(!1),onSuccess:D,user:n,isMobile:w,setToast:_}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Leave Requests"}),!w&&i.jsxs(ae,{onClick:()=>P(!0),children:[i.jsx(qt,{className:"mr-2 h-4"})," New Request"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6 justify-items-center md:justify-items-start",children:[F.map(U=>i.jsx(vL,{...U},U.title)),n?.role==="field_officer"&&i.jsx(vL,{title:"Overtime Hours",value:`${k} hrs`,icon:Vc})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[i.jsx(Ale,{}),i.jsx(Rle,{logs:a,isLoading:l}),n?.role==="field_officer"&&i.jsx(Lle,{})]}),w&&i.jsx("div",{className:"my-4 w-full",children:i.jsxs(ae,{onClick:()=>P(!0),size:"lg",className:"w-full justify-center text-lg",children:[i.jsx(qt,{className:"mr-2 h-5"})," New Request"]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full md:w-full",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:i.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 space-y-2 md:space-y-0","aria-label":"Tabs",children:q.map(U=>i.jsx("button",{onClick:()=>x(U),className:`whitespace-nowrap font-medium text-base rounded-lg md:rounded-none w-full md:w-auto text-left px-4 py-2 md:px-1 md:py-3 md:bg-transparent md:border-b-2
                                    ${p===U?"bg-accent-light text-accent-dark md:border-accent":"text-muted hover:bg-accent-light hover:text-accent-dark md:border-transparent md:hover:border-accent"}`,children:O(U)},U))})})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Dates"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted text-lg",children:"No requests found."})}):r.map(U=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Type",className:"px-4 py-3 font-medium text-base",children:[U.leaveType," ",U.dayOption&&`(${U.dayOption})`]}),i.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted text-base",children:[Ue(new Date(U.startDate.replace(/-/g,"/")),"dd MMM")," - ",Ue(new Date(U.endDate.replace(/-/g,"/")),"dd MMM")]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate text-base",children:U.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3 text-base",children:i.jsx(qle,{status:U.status})})]},U.id))})]})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full md:w-full",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Compensatory Off Tracker"}),d?i.jsxs("div",{className:"text-center py-10 text-muted bg-page rounded-lg",children:[i.jsx(Ca,{className:"h-8 w-8 mx-auto mb-2 text-yellow-500"}),i.jsx("p",{className:"font-semibold",children:"Feature Unavailable"}),i.jsx("p",{className:"text-sm",children:"The Compensatory Off feature is disabled because the required 'comp_off_logs' table is missing in the database."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date Earned"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason for Comp-Off"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Granted By"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted text-lg",children:"No comp-off history found."})}):a.map(U=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Date Earned",className:"px-4 py-3 font-medium",children:Ue(new Date(U.dateEarned.replace(/-/g,"/")),"dd MMM, yyyy")}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted",children:U.reason}),i.jsx("td",{"data-label":"Granted By",className:"px-4 py-3 text-muted",children:U.grantedByName||"-"}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full capitalize ${U.status==="earned"?"bg-blue-100 text-blue-800":"bg-gray-200 text-gray-800"}`,children:U.status})})]},U.id))})]})})]}),i.jsx(Fle,{})]})},Ble=wt({userId:be().required("Please select an employee."),dateEarned:be().required("Please select the date the comp-off was earned."),reason:be().required("A reason is required (e.g., Worked on Sunday, Holiday duty).").min(5,"Reason is too short.")}).defined(),Wle=({isOpen:n,onClose:e,onSuccess:t})=>{const{user:r}=St(),[s,a]=E.useState([]),[o,l]=E.useState(!1),{register:c,handleSubmit:d,control:m,formState:{errors:p},reset:x}=Zt({resolver:_n(Ble),defaultValues:{dateEarned:Ue(new Date,"yyyy-MM-dd")}});E.useEffect(()=>{n?pe.getUsers().then(a):x({userId:"",dateEarned:Ue(new Date,"yyyy-MM-dd"),reason:""})},[n,x]);const v=async _=>{if(r){l(!0);try{const w=s.find(j=>j.id===_.userId);await pe.addCompOffLog({..._,userName:w?.name||"",status:"earned",grantedById:r.id,grantedByName:r.name}),t()}catch(w){console.error("Failed to grant comp-off",w)}finally{l(!1)}}};return i.jsx(tr,{isOpen:n,onClose:e,onConfirm:d(v),title:"Grant Compensatory Off",confirmButtonText:"Grant",confirmButtonVariant:"primary",isConfirming:o,children:i.jsxs("div",{className:"space-y-4",children:[i.jsx(je,{name:"userId",control:m,render:({field:_})=>i.jsxs(Qe,{label:"Select Employee",..._,error:p.userId?.message,children:[i.jsx("option",{value:"",children:"-- Select an Employee --"}),s.map(w=>i.jsx("option",{value:w.id,children:w.name},w.id))]})}),i.jsx(je,{name:"dateEarned",control:m,render:({field:_})=>i.jsx(Nn,{label:"Date Worked / Earned",id:"dateEarned",value:_.value,onChange:_.onChange,error:p.dateEarned?.message,maxDate:new Date})}),i.jsx(Me,{label:"Reason for Comp-Off",id:"reason",...c("reason"),error:p.reason?.message,placeholder:"e.g., Worked on Sunday"})]})})},$le=({isOpen:n,onClose:e,onConfirm:t,isConfirming:r})=>{const[s,a]=E.useState(""),[o,l]=E.useState(""),c=()=>{if(!s.trim()){l("A reason for rejection is required.");return}t(s)},d=()=>{a(""),l(""),e()};return n?i.jsx(tr,{isOpen:n,onClose:d,onConfirm:c,title:"Reject Claim",confirmButtonText:"Confirm Rejection",isConfirming:r,children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{children:"Please provide a reason for rejecting this claim. This will be visible to the employee."}),i.jsxs("div",{children:[i.jsx("textarea",{value:s,onChange:m=>{a(m.target.value),o&&l("")},rows:3,className:`mt-1 form-input ${o?"form-input--error":""}`,placeholder:"e.g., Overtime was not pre-approved."}),o&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:o})]})]})}):null},Hle=({status:n})=>{const e={pending_manager_approval:"bg-yellow-100 text-yellow-800",pending_hr_confirmation:"bg-blue-100 text-blue-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},t=n.replace(/_/g," ");return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:t})},Yle=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},Gle=()=>{const{user:n}=St(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState(!0),[l,c]=E.useState("pending_manager_approval"),[d,m]=E.useState(null),[p,x]=E.useState(null),v=Jt("(max-width: 767px)"),[_,w]=E.useState(!1),[j,P]=E.useState(!0),[k,I]=E.useState(!1),[M,D]=E.useState(null);E.useEffect(()=>{(async()=>{try{await pe.checkCompOffTableExists(),P(!0)}catch{P(!1)}})()},[]);const O=E.useCallback(async()=>{if(n){o(!0);try{const Q=["admin","hr","operation_manager","site_manager"].includes(n.role),[Y,ne]=await Promise.all([pe.getLeaveRequests({forApproverId:n.id,status:l!=="all"&&l!=="claims"?l:void 0}),Q?pe.getExtraWorkLogs():Promise.resolve([])]);t(Y),s(ne)}catch{m({message:"Failed to load approval data.",type:"error"})}finally{o(!1)}}},[n,l]);E.useEffect(()=>{O()},[O]);const q=async(Q,Y)=>{if(n){x(Q);try{switch(Y){case"approve":await pe.approveLeaveRequest(Q,n.id);break;case"reject":await pe.rejectLeaveRequest(Q,n.id);break;case"confirm":await pe.confirmLeaveByHR(Q,n.id);break}m({message:"Request actioned successfully.",type:"success"}),O()}catch{m({message:"Failed to update request.",type:"error"})}finally{x(null)}}},F=async Q=>{if(n){x(Q);try{await pe.approveExtraWorkClaim(Q,n.id),m({message:"Claim approved successfully.",type:"success"}),O()}catch{m({message:"Failed to approve claim.",type:"error"})}finally{x(null)}}},U=async Q=>{if(!(!n||!M)){x(M.id);try{await pe.rejectExtraWorkClaim(M.id,n.id,Q),m({message:"Claim rejected successfully.",type:"success"}),O()}catch{m({message:"Failed to reject claim.",type:"error"})}finally{x(null),I(!1),D(null)}}},B=["pending_manager_approval","claims","pending_hr_confirmation","approved","rejected","all"],G=({request:Q})=>{if(!n||Q.status==="approved"||Q.status==="rejected")return null;if(Q.currentApproverId===n.id){if(Q.status==="pending_manager_approval")return i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ae,{size:"sm",variant:"icon",onClick:()=>q(Q.id,"approve"),disabled:p===Q.id,title:"Approve","aria-label":"Approve request",children:i.jsx(xl,{className:"h-4 w-4 text-green-600"})}),i.jsx(ae,{size:"sm",variant:"icon",onClick:()=>q(Q.id,"reject"),disabled:p===Q.id,title:"Reject","aria-label":"Reject request",children:i.jsx(Ui,{className:"h-4 w-4 text-red-600"})})]});if(Q.status==="pending_hr_confirmation"&&(n.role==="hr"||n.role==="admin"))return i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ae,{size:"sm",variant:"icon",onClick:()=>q(Q.id,"confirm"),disabled:p===Q.id,title:"Confirm & Finalize","aria-label":"Confirm and finalize request",children:i.jsx(xl,{className:"h-4 w-4 text-blue-600"})}),i.jsx(ae,{size:"sm",variant:"icon",onClick:()=>q(Q.id,"reject"),disabled:p===Q.id,title:"Reject","aria-label":"Reject request",children:i.jsx(Ui,{className:"h-4 w-4 text-red-600"})})]})}return null},X=Q=>Q.replace(/_/g," ").replace(/\b\w/g,Y=>Y.toUpperCase());return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[d&&i.jsx(Gt,{message:d.message,type:d.type,onDismiss:()=>m(null)}),i.jsx(Wle,{isOpen:_,onClose:()=>w(!1),onSuccess:()=>{m({message:"Compensatory off granted successfully.",type:"success"}),w(!1)}}),i.jsx($le,{isOpen:k,onClose:()=>{I(!1),D(null)},onConfirm:U,isConfirming:!!p}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Leave Approval Inbox"}),!v&&i.jsxs(ae,{onClick:()=>w(!0),disabled:!j,title:j?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})]}),v&&i.jsx("div",{className:"mb-6",children:i.jsxs(ae,{onClick:()=>w(!0),disabled:!j,title:j?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})}),i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:i.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 md:overflow-x-auto space-y-1 md:space-y-0","aria-label":"Tabs",children:B.map(Q=>i.jsx("button",{onClick:()=>c(Q),className:`whitespace-nowrap font-medium text-sm rounded-lg md:rounded-none w-full md:w-auto text-left md:text-center px-4 py-3 md:px-1 md:py-3 md:bg-transparent md:border-b-2 transition-colors duration-200
                                ${l===Q?"bg-emerald-50 text-emerald-700 md:border-emerald-500 md:bg-transparent":"text-muted hover:bg-emerald-50 hover:text-emerald-700 md:border-transparent md:hover:border-emerald-500"}`,children:X(Q)},Q))})})}),l==="claims"?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date & Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Claim"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10",children:i.jsx(Tt,{className:"h-6 w-6 animate-spin mx-auto"})})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No pending claims found."})}):r.map(Q=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:Q.userName}),i.jsxs("td",{"data-label":"Date & Type",className:"px-4 py-3 text-muted",children:[Ue(new Date(Q.workDate),"dd MMM, yyyy")," (",Q.workType,")"]}),i.jsxs("td",{"data-label":"Claim",className:"px-4 py-3 text-muted",children:[Q.claimType,Q.claimType==="OT"?` (${Q.hoursWorked} hrs)`:""]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:Q.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(Yle,{status:Q.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex md:justify-start justify-end gap-2",children:[i.jsx(ae,{size:"sm",variant:"icon",onClick:()=>F(Q.id),disabled:p===Q.id,title:"Approve Claim",children:i.jsx(xl,{className:"h-4 w-4 text-green-600"})}),i.jsx(ae,{size:"sm",variant:"icon",onClick:()=>{D(Q),I(!0)},disabled:p===Q.id,title:"Reject Claim",children:i.jsx(Ui,{className:"h-4 w-4 text-red-600"})})]})})]},Q.id))})]})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Dates"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:a?v?i.jsx("tr",{children:i.jsx("td",{colSpan:6,children:i.jsx(Ta,{rows:3,cols:6,isMobile:!0})})}):i.jsx(Ta,{rows:5,cols:6}):e.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No requests found for this filter."})}):e.map(Q=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:Q.userName}),i.jsxs("td",{"data-label":"Type",className:"px-4 py-3 text-muted",children:[Q.leaveType," ",Q.dayOption&&`(${Q.dayOption})`]}),i.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted",children:[Ue(new Date(Q.startDate.replace(/-/g,"/")),"dd MMM")," - ",Ue(new Date(Q.endDate.replace(/-/g,"/")),"dd MMM")]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:Q.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(Hle,{status:Q.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsx("div",{className:"flex md:justify-start justify-end",children:p===Q.id?i.jsx(Tt,{className:"h-4 w-4 animate-spin"}):i.jsx(G,{request:Q})})})]},Q.id))})]})})]})},Zle=({users:n})=>{const e=E.useRef(null),t=E.useRef(null),[r,s]=E.useState(null),[a,o]=E.useState(null),[l,c]=E.useState({x:0,y:0}),[d,m]=E.useState(""),[p,x]=E.useState(.6),[v,_]=E.useState({x:0,y:0}),w=E.useRef(null),j=E.useRef(!1),P=E.useRef({x:0,y:0}),k=E.useRef(0),I=E.useRef(new Map),M=E.useRef(window.devicePixelRatio||1);E.useEffect(()=>{n.forEach($=>{if($.photoUrl&&!I.current.has($.id)){const H=new Image;H.crossOrigin="anonymous",H.src=$.photoUrl,H.onload=()=>{I.current.set($.id,H)}}})},[n]);const D=()=>{const $=new Map;n.forEach(se=>{$.set(se.id,{...se,children:[]})});const H=[];return n.forEach(se=>{const W=$.get(se.id);if(se.reportingManagerId){const ee=$.get(se.reportingManagerId);ee?ee.children.push(W):H.push(W)}else H.push(W)}),H},O=($,H=0,se=150,W=0)=>{let re=H;const me=[];let _e=1/0,le=-1/0,fe=1/0,ue=-1/0;$.forEach(Se=>{if(Se.level=W,Se.children&&Se.children.length>0){const ye=O(Se.children,re,se+200,W+1),Ne=ye.width,ke=re+Ne/2-180/2;Se.x=ke,Se.y=se,me.push(Se),me.push(...ye.nodes),_e=Math.min(_e,ke,ye.bounds.minX),le=Math.max(le,ke+180,ye.bounds.maxX),fe=Math.min(fe,se,ye.bounds.minY),ue=Math.max(ue,se+120,ye.bounds.maxY),re+=Ne+250}else Se.x=re,Se.y=se,me.push(Se),_e=Math.min(_e,re),le=Math.max(le,re+180),fe=Math.min(fe,se),ue=Math.max(ue,se+120),re+=430});const ce=Math.max(0,re-H-250);return{width:Math.max(ce,180),nodes:me,bounds:{minX:isFinite(_e)?_e:0,maxX:isFinite(le)?le:180,minY:isFinite(fe)?fe:0,maxY:isFinite(ue)?ue:300}}},q=($,H,se,W)=>{if(H.x===void 0||H.y===void 0||se.x===void 0||se.y===void 0)return;const ee=(H.x+90)*p+v.x,K=(H.y+60)*p+v.y,oe=(se.x+90)*p+v.x,re=(se.y-10)*p+v.y,me=$.createLinearGradient(ee,K,oe,re),_e=W*5e-4%1;me.addColorStop(0,"#E0E7FF"),me.addColorStop(_e,"#818CF8"),me.addColorStop(1,"#E0E7FF"),$.save(),$.strokeStyle=me,$.lineWidth=2*p,$.lineCap="round",$.shadowColor="rgba(99, 102, 241, 0.2)",$.shadowBlur=4,$.beginPath(),$.moveTo(ee,K);const le=(K+re)/2;$.bezierCurveTo(ee,le,oe,le,oe,re),$.stroke(),$.restore();const ue=(W*5e-4+H.id.charCodeAt(0)*.1)%1,ce={x:ee,y:K},Se={x:ee,y:le},ye={x:oe,y:le},Ne={x:oe,y:re},ke=3*(Se.x-ce.x),qe=3*(ye.x-Se.x)-ke,ze=Ne.x-ce.x-ke-qe,He=3*(Se.y-ce.y),Be=3*(ye.y-Se.y)-He,de=Ne.y-ce.y-He-Be,xe=ze*ue*ue*ue+qe*ue*ue+ke*ue+ce.x,Pe=de*ue*ue*ue+Be*ue*ue+He*ue+ce.y;$.save(),$.fillStyle="#6366F1",$.shadowColor="#6366F1",$.shadowBlur=8,$.beginPath(),$.arc(xe,Pe,3*p,0,Math.PI*2),$.fill(),$.restore()},F=($,H,se,W,ee)=>{if(H.x===void 0||H.y===void 0)return null;const K=H.x*p+v.x,oe=H.y*p+v.y,re=180*p,me=120*p,_e=48*p,le=!!d&&H.name.toLowerCase().includes(d.toLowerCase());$.save(),$.shadowColor=W?"rgba(99, 102, 241, 0.4)":"rgba(0, 0, 0, 0.08)",$.shadowBlur=(W?24:12)*p,$.shadowOffsetY=(W?8:4)*p;const fe=$.createLinearGradient(K,oe,K,oe+me);fe.addColorStop(0,"#FFFFFF"),fe.addColorStop(1,"#FAFAFA"),$.fillStyle=fe;const ue=16*p;$.beginPath(),$.roundRect?$.roundRect(K,oe,re,me,ue):($.moveTo(K+ue,oe),$.lineTo(K+re-ue,oe),$.quadraticCurveTo(K+re,oe,K+re,oe+ue),$.lineTo(K+re,oe+me-ue),$.quadraticCurveTo(K+re,oe+me,K+re-ue,oe+me),$.lineTo(K+ue,oe+me),$.quadraticCurveTo(K,oe+me,K,oe+me-ue),$.lineTo(K,oe+ue),$.quadraticCurveTo(K,oe,K+ue,oe)),$.fill(),$.lineWidth=(W?2:1)*p,$.strokeStyle=W?"#6366F1":se?"#A5B4FC":le?"#22C55E":"#E5E7EB",$.stroke(),$.restore(),(W||le)&&($.save(),$.globalAlpha=.05,$.fillStyle=W?"#6366F1":"#22C55E",$.beginPath(),$.roundRect&&$.roundRect(K,oe,re,me,ue),$.fill(),$.restore());const ce=K+(re-_e)/2,Se=oe+16*p;$.save(),$.beginPath(),$.arc(ce+_e/2,Se+_e/2,_e/2,0,Math.PI*2),$.clip();const ye=I.current.get(H.id);if(ye&&ye.complete)$.drawImage(ye,ce,Se,_e,_e);else{const Be=$.createLinearGradient(ce,Se,ce+_e,Se+_e);Be.addColorStop(0,"#818CF8"),Be.addColorStop(1,"#4F46E5"),$.fillStyle=Be,$.fillRect(ce,Se,_e,_e),$.fillStyle="#FFF",$.font=`600 ${Math.max(12,16*p)}px "Inter", sans-serif`,$.textAlign="center",$.textBaseline="middle";const de=H.name.split(" ").map(xe=>xe[0]).join("").substring(0,2).toUpperCase();$.fillText(de,ce+_e/2,Se+_e/2+1*p)}if($.restore(),$.save(),$.strokeStyle=W?"#6366F1":"#FFF",$.lineWidth=2*p,$.beginPath(),$.arc(ce+_e/2,Se+_e/2,_e/2,0,Math.PI*2),$.stroke(),$.restore(),H.level!==void 0&&H.level>0){const Be=18*p,de=ce+_e-Be/2,xe=Se+_e-Be/2;$.save(),$.fillStyle="#10B981",$.shadowColor="rgba(16, 185, 129, 0.4)",$.shadowBlur=4*p,$.beginPath(),$.arc(de,xe,Be/2,0,Math.PI*2),$.fill(),$.fillStyle="#FFF",$.font=`700 ${Math.max(8,9*p)}px "Inter", sans-serif`,$.textAlign="center",$.textBaseline="middle",$.fillText(`L${H.level}`,de,xe+1*p),$.restore()}$.save(),$.fillStyle="#111827",$.font=`600 ${Math.max(11,13*p)}px "Inter", sans-serif`,$.textAlign="center",$.textBaseline="top";const Ne=Se+_e+12*p;let ke=H.name;const qe=re-24*p;if($.measureText(ke).width>qe){for(;$.measureText(ke+"...").width>qe&&ke.length>0;)ke=ke.substring(0,ke.length-1);ke+="..."}$.fillText(ke,K+re/2,Ne),$.fillStyle="#6B7280",$.font=`500 ${Math.max(9,11*p)}px "Inter", sans-serif`;const ze=Ne+18*p;let He=(H.role||"").replace(/_/g," ");if(He=He?He.charAt(0).toUpperCase()+He.slice(1).toLowerCase():"",$.measureText(He).width>qe){for(;$.measureText(He+"...").width>qe&&He.length>0;)He=He.substring(0,He.length-1);He+="..."}return $.fillText(He,K+re/2,ze),$.restore(),{x:K,y:oe,width:re,height:me}},U=($,H)=>{const se=D(),W=O(se),ee=new Map;return W.nodes.forEach(K=>{K.children&&K.children.forEach(oe=>{q($,K,oe,H)})}),W.nodes.forEach(K=>{const oe=r?.id===K.id,re=a?.id===K.id,me=F($,K,oe,re);me&&ee.set(K.id,me)}),{nodePositions:ee,layout:W}},B=$=>{const H=$??e.current;if(!H)return;const se=H.getBoundingClientRect(),W=D(),K=O(W).bounds,oe=Math.max(1,K.maxX-K.minX),re=Math.max(1,K.maxY-K.minY),me=(K.minX+K.maxX)/2,_e=(K.minY+K.maxY)/2,le=.85,fe=se.width*le/oe,ue=se.height*le/re;let ce=Math.min(fe,ue);ce=Math.max(.4,Math.min(ce,1));const Se=se.width/2-me*ce,ye=se.height/2-_e*ce;x(ce),_({x:Se,y:ye})};E.useEffect(()=>{const $=()=>{const H=e.current,se=t.current;if(!H||!se)return;const W=window.devicePixelRatio||1;M.current=W;const ee=se.getBoundingClientRect(),K=Math.max(1,ee.width),oe=Math.max(1,ee.height);H.width=Math.round(K*W),H.height=Math.round(oe*W),H.style.width=`${K}px`,H.style.height=`${oe}px`;const re=H.getContext("2d");re&&(re.setTransform(W,0,0,W,0,0),B(H))};return $(),window.addEventListener("resize",$),()=>window.removeEventListener("resize",$)},[n]),E.useEffect(()=>{const $=e.current,H=$?.getContext("2d");if(!$||!H)return;const se=M.current;let W=0;const ee=()=>{k.current+=16,H.clearRect(0,0,$.width/se,$.height/se);const K=$.width/se,oe=$.height/se,re=H.createLinearGradient(0,0,K,oe);re.addColorStop(0,"#FAFAFA"),re.addColorStop(1,"#F3F4F6"),H.fillStyle=re,H.fillRect(0,0,K,oe);const{nodePositions:me}=U(H,k.current);let _e=!1;for(const[le,fe]of me.entries())if(l.x>=fe.x&&l.x<=fe.x+fe.width&&l.y>=fe.y&&l.y<=fe.y+fe.height){const ue=n.find(ce=>ce.id===le);if(ue){s(ue),_e=!0;break}}!_e&&r&&s(null),W=requestAnimationFrame(ee),w.current=W};return w.current=requestAnimationFrame(ee),()=>{w.current&&cancelAnimationFrame(w.current)}},[n,r,a,l,p,v,d]);const G=$=>{r||(j.current=!0,P.current={x:$.nativeEvent.offsetX,y:$.nativeEvent.offsetY})},X=$=>{const H=$.nativeEvent.offsetX,se=$.nativeEvent.offsetY;if(c({x:H,y:se}),j.current){const W=H-P.current.x,ee=se-P.current.y;_(K=>({x:K.x+W,y:K.y+ee})),P.current={x:H,y:se}}},Q=()=>{j.current=!1},Y=()=>{r&&!j.current&&o(a?.id===r.id?null:r)},ne=()=>x($=>Math.min($+.2,2.5)),te=()=>x($=>Math.max($-.2,.4)),ie=()=>{B(),o(null),m("")};return i.jsxs("div",{className:"relative w-full h-full bg-gradient-to-br from-slate-50 to-slate-100",ref:t,children:[i.jsxs("div",{className:"absolute top-4 left-4 z-20 flex flex-col gap-3",children:[i.jsxs("div",{className:"bg-white/90 backdrop-blur-md border border-slate-200 rounded-xl shadow-xl p-3 min-w-[280px]",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),i.jsx("input",{type:"text",placeholder:"Search employees...",value:d,onChange:$=>m($.target.value),className:"w-full pl-10 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),d&&i.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:[n.filter($=>$.name.toLowerCase().includes(d.toLowerCase())).length," results"]})]}),i.jsxs("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 rounded-2xl shadow-lg p-1.5 flex gap-1 items-center",children:[i.jsx("button",{onClick:te,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Zoom Out",children:i.jsx(vC,{className:"w-5 h-5"})}),i.jsxs("div",{className:"px-2 min-w-[48px] text-center font-semibold text-slate-700 text-sm tabular-nums",children:[Math.round(p*100),"%"]}),i.jsx("button",{onClick:ne,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Zoom In",children:i.jsx(yC,{className:"w-5 h-5"})}),i.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),i.jsx("button",{onClick:ie,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Reset View",children:i.jsx(FF,{className:"w-5 h-5"})})]})]}),i.jsx("canvas",{ref:e,className:"w-full h-full cursor-grab active:cursor-grabbing",onMouseDown:G,onMouseMove:X,onMouseUp:Q,onMouseLeave:Q,onClick:Y}),r&&r.x!==void 0&&r.y!==void 0&&i.jsx("div",{className:"absolute pointer-events-none z-10 transform -translate-x-1/2 transition-all duration-200",style:{left:`${r.x*p+v.x+180*p/2}px`,top:`${r.y*p+v.y-20}px`},children:i.jsx("div",{className:"bg-white/95 backdrop-blur-xl border border-indigo-200 rounded-2xl shadow-2xl p-5 min-w-[320px] animate-fade-in-scale",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsxs("div",{className:"flex-shrink-0 relative",children:[r.photoUrl?i.jsx("img",{src:r.photoUrl,alt:r.name,className:"w-20 h-20 rounded-2xl object-cover border-3 border-indigo-500 shadow-lg"}):i.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-indigo-600 flex items-center justify-center text-white font-bold text-2xl border-3 border-white shadow-lg",children:r.name.split(" ").map($=>$[0]).join("").substring(0,2).toUpperCase()}),r.level!==void 0&&r.level>0&&i.jsxs("div",{className:"absolute -bottom-2 -right-2 bg-emerald-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg",children:["L",r.level]})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-slate-900 text-xl mb-1 truncate",children:r.name}),i.jsx("p",{className:"text-sm text-indigo-600 font-medium capitalize mb-3 truncate",children:r.role.replace(/_/g," ")}),i.jsxs("div",{className:"space-y-2",children:[r.email&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(yu,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{className:"truncate",children:r.email})]}),r.phone&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(cu,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{children:r.phone})]}),r.managerName&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(mi,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsxs("span",{className:"truncate",children:["Reports to: ",i.jsx("strong",{children:r.managerName})]})]})]}),i.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200",children:i.jsxs("p",{className:"text-xs text-slate-500 italic",children:["Click to ",a?.id===r.id?"deselect":"select and focus"]})})]})]})})}),i.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-white/90 backdrop-blur-md px-6 py-3 rounded-full border border-slate-200 shadow-xl",children:i.jsxs("p",{className:"text-sm text-slate-700 font-medium flex items-center gap-3",children:[i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),"Drag to pan"]}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Hover for details"}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Click to select"})]})}),i.jsxs("div",{className:"absolute top-4 right-4 bg-white/90 backdrop-blur-md border border-slate-200 rounded-2xl shadow-xl p-4 max-w-[200px]",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-900 mb-3 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),"Org Hierarchy"]}),i.jsxs("div",{className:"space-y-2.5",children:[i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded bg-gradient-to-br from-purple-500 to-indigo-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Team Member"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded bg-gradient-to-br from-emerald-400 to-emerald-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Search Match"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-8 h-0.5 bg-gradient-to-r from-indigo-400 to-purple-500 flex-shrink-0 shadow-sm"}),i.jsx("span",{children:"Reports To"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-emerald-500 text-white text-[8px] font-bold flex items-center justify-center flex-shrink-0",children:"L2"}),i.jsx("span",{children:"Level Badge"})]})]}),a&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[i.jsx("p",{className:"text-xs font-semibold text-indigo-600 mb-1",children:"Selected:"}),i.jsx("p",{className:"text-xs text-slate-700 font-medium truncate",children:a.name})]})]}),i.jsxs("div",{className:"absolute bottom-6 right-6 bg-slate-900/80 backdrop-blur-sm text-white text-xs px-3 py-2 rounded-full font-mono",children:[n.length," employees"]})]})},Kle=({users:n})=>{const e=E.useRef(null),t=E.useRef(null),[r,s]=E.useState(null),[a,o]=E.useState(null),[l,c]=E.useState({x:0,y:0}),[d,m]=E.useState(""),[p,x]=E.useState(1);E.useRef();const v=E.useRef({x:.2,y:0}),_=E.useRef({x:.2,y:0}),w=E.useRef(!1),j=E.useRef({x:0,y:0}),P=E.useRef(!0),k=E.useRef(0),I=E.useRef([]),M=E.useRef(new Map);E.useEffect(()=>{n.forEach(W=>{if(W.photoUrl&&!M.current.has(W.id)){const ee=new Image;ee.crossOrigin="anonymous",ee.src=W.photoUrl,ee.onload=()=>{M.current.set(W.id,ee)}}})},[n]);const D=()=>{const W=new Map;n.forEach(K=>{W.set(K.id,{...K,children:[],pulsePhase:Math.random()*Math.PI*2})});const ee=[];return n.forEach(K=>{const oe=W.get(K.id);if(K.reportingManagerId){const re=W.get(K.reportingManagerId);re?re.children.push(oe):ee.push(oe)}else ee.push(oe)}),ee},O=(W,ee=0,K=0,oe=360,re=0,me=0)=>{const _e=ee===0?0:200+ee*180,le=W.length>1?oe/W.length:0,fe=180;W.forEach((ue,ce)=>{if(ue.level=ee,ee===0)ue.x=0,ue.y=0,ue.z=0;else{const Se=(K+le*ce)*Math.PI/180;ue.x=re+Math.cos(Se)*_e,ue.y=-ee*fe,ue.z=me+Math.sin(Se)*_e}if(ue.children&&ue.children.length>0){const Se=K+le*ce-le*.6,ye=Math.min(le*1.2,120);O(ue.children,ee+1,Se,ye,ue.x,ue.z)}})},q=(W,ee)=>{const K=Math.random(),oe=W.x+(ee.x-W.x)*K,re=W.y+(ee.y-W.y)*K,me=W.z+(ee.z-W.z)*K;I.current.push({x:oe,y:re,z:me,vx:(Math.random()-.5)*2,vy:(Math.random()-.5)*2,vz:(Math.random()-.5)*2,life:0,maxLife:100+Math.random()*100,color:`hsla(${250+Math.random()*30}, 80%, ${60+Math.random()*20}%, ${.6+Math.random()*.4})`})},F=()=>{if(I.current=I.current.filter(W=>(W.life++,W.x+=W.vx*.5,W.y+=W.vy*.5,W.z+=W.vz*.5,W.vx*=.98,W.vy*=.98,W.vz*=.98,W.life<W.maxLife)),Math.random()<.05&&I.current.length<200){const W=D(),ee=[],K=oe=>{oe.children&&oe.children.forEach(re=>{ee.push([oe,re]),K(re)})};if(W.forEach(K),ee.length>0){const[oe,re]=ee[Math.floor(Math.random()*ee.length)];q(oe,re)}}},U=(W,ee,K,oe,re)=>{const me=e.current;if(!me)return{x:0,y:0,scale:1};W*=p,ee*=p,K*=p;let _e=W*Math.cos(re)-K*Math.sin(re),le=W*Math.sin(re)+K*Math.cos(re),fe=ee*Math.cos(oe)-le*Math.sin(oe),ue=ee*Math.sin(oe)+le*Math.cos(oe);const ce=1200,Se=ce/(ce+ue);return{x:me.width/2+_e*Se,y:me.height/2+fe*Se,scale:Se,z:ue}},B=(W,ee,K,oe)=>{const re=U(ee.x,ee.y,ee.z,K,oe);if(re.scale<.2)return;const me=1-ee.life/ee.maxLife,_e=2*re.scale*me;W.save(),W.globalAlpha=me*.8,W.fillStyle=ee.color,W.shadowColor=ee.color,W.shadowBlur=8*re.scale,W.beginPath(),W.arc(re.x,re.y,_e,0,Math.PI*2),W.fill(),W.restore()},G=(W,ee,K,oe,re,me,_e)=>{const le=U(ee.x,ee.y,ee.z,K,oe);if(le.scale<.2)return;const fe=50,ue=Math.sin(_e*.002+(ee.pulsePhase||0))*.1+1,ce=fe*le.scale*(me?1.3:re?1.2:ue),Se=d&&ee.name.toLowerCase().includes(d.toLowerCase());if(me||re||Se){W.save();const ke=W.createRadialGradient(le.x,le.y,ce*.5,le.x,le.y,ce*2);ke.addColorStop(0,me?"rgba(99, 102, 241, 0.4)":Se?"rgba(34, 197, 94, 0.4)":"rgba(99, 102, 241, 0.2)"),ke.addColorStop(1,"rgba(99, 102, 241, 0)"),W.fillStyle=ke,W.beginPath(),W.arc(le.x,le.y,ce*2,0,Math.PI*2),W.fill(),W.restore()}W.save(),W.shadowColor=me?"rgba(99, 102, 241, 0.6)":"rgba(0, 0, 0, 0.3)",W.shadowBlur=(me?40:25)*le.scale,W.shadowOffsetX=5*le.scale,W.shadowOffsetY=8*le.scale;const ye=W.createRadialGradient(le.x-ce*.3,le.y-ce*.3,0,le.x,le.y,ce);me?(ye.addColorStop(0,"#818CF8"),ye.addColorStop(.5,"#6366F1"),ye.addColorStop(1,"#4F46E5")):Se?(ye.addColorStop(0,"#4ADE80"),ye.addColorStop(.5,"#22C55E"),ye.addColorStop(1,"#16A34A")):(ye.addColorStop(0,"#7C3AED"),ye.addColorStop(.5,"#6366F1"),ye.addColorStop(1,"#4F46E5")),W.fillStyle=ye,W.beginPath(),W.arc(le.x,le.y,ce,0,Math.PI*2),W.fill(),W.restore(),W.save(),W.strokeStyle="rgba(255, 255, 255, 0.3)",W.lineWidth=3*le.scale,W.beginPath(),W.arc(le.x,le.y,ce-2*le.scale,0,Math.PI*2),W.stroke(),W.restore(),W.save(),W.strokeStyle=me?"#FFF":re?"rgba(255, 255, 255, 0.9)":"rgba(255, 255, 255, 0.5)",W.lineWidth=(me?4:re?3:2)*le.scale,(me||re)&&(W.shadowColor="#FFF",W.shadowBlur=10*le.scale),W.beginPath(),W.arc(le.x,le.y,ce,0,Math.PI*2),W.stroke(),W.restore();const Ne=M.current.get(ee.id);if(Ne&&Ne.complete)W.save(),W.beginPath(),W.arc(le.x,le.y,ce-4*le.scale,0,Math.PI*2),W.clip(),W.drawImage(Ne,le.x-ce+4*le.scale,le.y-ce+4*le.scale,(ce-4*le.scale)*2,(ce-4*le.scale)*2),W.restore();else{const ke=["#FFF","#FDE68A","#A7F3D0","#BFDBFE","#DDD6FE"];W.fillStyle=ke[Math.min(ee.level||0,ke.length-1)],W.font=`bold ${Math.max(14,20*le.scale)}px Inter, sans-serif`,W.textAlign="center",W.textBaseline="middle";const qe=ee.name.split(" ").map(ze=>ze[0]).join("").substring(0,2).toUpperCase();W.fillText(qe,le.x,le.y)}if(ee.level!==void 0&&ee.level>0){const ke=le.x+ce*.7,qe=le.y-ce*.7,ze=12*le.scale;W.save(),W.fillStyle="#10B981",W.shadowColor="rgba(16, 185, 129, 0.5)",W.shadowBlur=8*le.scale,W.beginPath(),W.arc(ke,qe,ze,0,Math.PI*2),W.fill(),W.fillStyle="#FFF",W.font=`bold ${Math.max(8,10*le.scale)}px Inter, sans-serif`,W.textAlign="center",W.textBaseline="middle",W.fillText(`L${ee.level}`,ke,qe),W.restore()}return{...le,radius:ce}},X=(W,ee,K,oe,re,me)=>{const _e=U(ee.x,ee.y,ee.z,oe,re),le=U(K.x,K.y,K.z,oe,re);if(_e.scale<.2||le.scale<.2)return;const fe=(_e.scale+le.scale)/2;(_e.z+le.z)/2;const ue=W.createLinearGradient(_e.x,_e.y,le.x,le.y),ce=me*.001%1;ue.addColorStop(0,`rgba(99, 102, 241, ${.15*fe})`),ue.addColorStop(ce,`rgba(139, 92, 246, ${.4*fe})`),ue.addColorStop(1,`rgba(99, 102, 241, ${.15*fe})`),W.save(),W.strokeStyle=ue,W.lineWidth=3*fe,W.shadowColor="rgba(99, 102, 241, 0.3)",W.shadowBlur=8*fe,W.beginPath(),W.moveTo(_e.x,_e.y);const Se=(_e.x+le.x)/2,ye=(_e.y+le.y)/2+50*fe;W.quadraticCurveTo(Se,ye,le.x,le.y),W.stroke(),W.restore();const Ne=(me*5e-4+ee.id.charCodeAt(0)*.1)%1,ke=_e.x+(le.x-_e.x)*Ne,qe=_e.y+(le.y-_e.y)*Ne+50*fe*Math.sin(Ne*Math.PI);W.save(),W.fillStyle="#818CF8",W.shadowColor="#818CF8",W.shadowBlur=12*fe,W.beginPath(),W.arc(ke,qe,4*fe,0,Math.PI*2),W.fill(),W.restore()},Q=(W,ee,K,oe,re,me)=>{const _e=[],le=[],fe=ue=>{const ce=U(ue.x,ue.y,ue.z,K,oe);_e.push({node:ue,depth:ce.z}),ue.children&&ue.children.forEach(Se=>{const ye=U(Se.x,Se.y,Se.z,K,oe);le.push([ue,Se,(ce.z+ye.z)/2]),fe(Se)})};ee.forEach(fe),le.sort((ue,ce)=>ue[2]-ce[2]),_e.sort((ue,ce)=>ue.depth-ce.depth),le.forEach(([ue,ce])=>{X(W,ue,ce,K,oe,re)}),I.current.forEach(ue=>{B(W,ue,K,oe)}),_e.forEach(({node:ue})=>{const ce=r?.id===ue.id,Se=a?.id===ue.id,ye=G(W,ue,K,oe,ce,Se,re);ye&&me.set(ue.id,ye)})};E.useEffect(()=>{const W=()=>{const ee=e.current,K=t.current;ee&&K&&(ee.width=K.clientWidth,ee.height=K.clientHeight)};return W(),window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[]),E.useEffect(()=>{const W=e.current,ee=W?.getContext("2d");if(!W||!ee)return;let K;const oe=()=>{k.current+=16;const re=ee.createLinearGradient(0,0,W.width,W.height);re.addColorStop(0,"#FAFAFA"),re.addColorStop(1,"#F3F4F6"),ee.fillStyle=re,ee.fillRect(0,0,W.width,W.height),v.current.x+=(_.current.x-v.current.x)*.1,v.current.y+=(_.current.y-v.current.y)*.1,P.current&&!w.current&&(_.current.y+=.003),F();const me=D();O(me);const _e=new Map;Q(ee,me,v.current.x,v.current.y,k.current,_e);let le=!1;const fe=Array.from(_e.entries()).sort((ue,ce)=>ce[1].z-ue[1].z);for(const[ue,ce]of fe){const Se=l.x-ce.x,ye=l.y-ce.y;if(Math.sqrt(Se*Se+ye*ye)<ce.radius){const Ne=n.find(ke=>ke.id===ue);Ne&&(s(Ne),le=!0);break}}!le&&r&&s(null),K=requestAnimationFrame(oe)};return K=requestAnimationFrame(oe),()=>{K&&cancelAnimationFrame(K)}},[n,r,a,l,p,d]);const Y=W=>{w.current=!0,P.current=!1,j.current={x:W.clientX,y:W.clientY}},ne=W=>{const ee=e.current?.getBoundingClientRect();if(ee&&c({x:W.clientX-ee.left,y:W.clientY-ee.top}),w.current){const K=W.clientX-j.current.x,oe=W.clientY-j.current.y;_.current.y+=K*.01,_.current.x+=oe*.01,_.current.x=Math.max(-Math.PI/3,Math.min(Math.PI/3,_.current.x)),j.current={x:W.clientX,y:W.clientY}}},te=()=>{w.current=!1,setTimeout(()=>{P.current=!0},2e3)},ie=W=>{r&&o(a?.id===r.id?null:r)},$=()=>x(W=>Math.min(W+.2,2.5)),H=()=>x(W=>Math.max(W-.2,.5)),se=()=>{x(1),_.current={x:.2,y:0},o(null),m("")};return i.jsxs("div",{className:"relative w-full h-full bg-gradient-to-br from-slate-50 to-slate-100",ref:t,children:[i.jsxs("div",{className:"absolute top-4 left-4 z-20 flex flex-col gap-3",children:[i.jsxs("div",{className:"bg-white/90 backdrop-blur-md border border-slate-200 rounded-xl shadow-xl p-3 min-w-[280px]",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Na,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),i.jsx("input",{type:"text",placeholder:"Search employees...",value:d,onChange:W=>m(W.target.value),className:"w-full pl-10 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),d&&i.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:[n.filter(W=>W.name.toLowerCase().includes(d.toLowerCase())).length," results"]})]}),i.jsxs("div",{className:"bg-white/90 backdrop-blur-md border border-slate-200 rounded-xl shadow-xl p-2 flex gap-2",children:[i.jsx("button",{onClick:H,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",title:"Zoom Out",children:i.jsx(vC,{className:"w-5 h-5 text-slate-600"})}),i.jsxs("div",{className:"px-3 py-2 text-sm font-medium text-slate-700 min-w-[60px] text-center",children:[Math.round(p*100),"%"]}),i.jsx("button",{onClick:$,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",title:"Zoom In",children:i.jsx(yC,{className:"w-5 h-5 text-slate-600"})}),i.jsx("button",{onClick:se,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",title:"Reset View",children:i.jsx(FF,{className:"w-5 h-5 text-slate-600"})})]})]}),i.jsx("canvas",{ref:e,className:"w-full h-full cursor-grab active:cursor-grabbing",onMouseDown:Y,onMouseMove:ne,onMouseUp:te,onMouseLeave:te,onClick:ie}),r&&i.jsx("div",{className:"absolute pointer-events-none z-10 transform -translate-x-1/2 transition-all duration-200",style:{left:`${l.x}px`,top:`${l.y-140}px`},children:i.jsx("div",{className:"bg-white/95 backdrop-blur-xl border border-indigo-200 rounded-2xl shadow-2xl p-5 min-w-[320px] animate-fade-in-scale",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsxs("div",{className:"flex-shrink-0 relative",children:[r.photoUrl?i.jsx("img",{src:r.photoUrl,alt:r.name,className:"w-20 h-20 rounded-2xl object-cover border-3 border-indigo-500 shadow-lg"}):i.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-indigo-600 flex items-center justify-center text-white font-bold text-2xl border-3 border-white shadow-lg",children:r.name.split(" ").map(W=>W[0]).join("").substring(0,2).toUpperCase()}),r.level!==void 0&&r.level>0&&i.jsxs("div",{className:"absolute -bottom-2 -right-2 bg-emerald-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg",children:["L",r.level]})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-slate-900 text-xl mb-1 truncate",children:r.name}),i.jsx("p",{className:"text-sm text-indigo-600 font-medium capitalize mb-3 truncate",children:r.role.replace(/_/g," ")}),i.jsxs("div",{className:"space-y-2",children:[r.email&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(yu,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{className:"truncate",children:r.email})]}),r.phone&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(cu,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{children:r.phone})]}),r.managerName&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(mi,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsxs("span",{className:"truncate",children:["Reports to: ",i.jsx("strong",{children:r.managerName})]})]})]}),i.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200",children:i.jsxs("p",{className:"text-xs text-slate-500 italic",children:["Click to ",a?.id===r.id?"deselect":"select and focus"]})})]})]})})}),i.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-white/90 backdrop-blur-md px-6 py-3 rounded-full border border-slate-200 shadow-xl",children:i.jsxs("p",{className:"text-sm text-slate-700 font-medium flex items-center gap-3",children:[i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),"Drag to rotate"]}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Hover for details"}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Click to select"})]})}),i.jsxs("div",{className:"absolute top-4 right-4 bg-white/90 backdrop-blur-md border border-slate-200 rounded-2xl shadow-xl p-4 max-w-[200px]",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-900 mb-3 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),"Org Hierarchy"]}),i.jsxs("div",{className:"space-y-2.5",children:[i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Team Member"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-gradient-to-br from-emerald-400 to-emerald-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Search Match"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-8 h-0.5 bg-gradient-to-r from-indigo-400 to-purple-500 flex-shrink-0 shadow-sm"}),i.jsx("span",{children:"Reports To"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-emerald-500 text-white text-[8px] font-bold flex items-center justify-center flex-shrink-0",children:"L2"}),i.jsx("span",{children:"Level Badge"})]})]}),a&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[i.jsx("p",{className:"text-xs font-semibold text-indigo-600 mb-1",children:"Selected:"}),i.jsx("p",{className:"text-xs text-slate-700 font-medium truncate",children:a.name})]})]}),i.jsxs("div",{className:"absolute bottom-6 right-6 bg-slate-900/80 backdrop-blur-sm text-white text-xs px-3 py-2 rounded-full font-mono",children:[n.length," nodes  ",I.current.length," particles"]})]})},Jle=()=>{const[n,e]=E.useState([]),[t,r]=E.useState([]),[s,a]=E.useState("hr"),[o,l]=E.useState(!0),[c,d]=E.useState(!1),[m,p]=E.useState(null),[x,v]=E.useState("table"),_=E.useCallback(async()=>{l(!0);try{const[P,k,I]=await Promise.all([pe.getUsersWithManagers(),pe.getApprovalWorkflowSettings(),pe.getRoles()]);e(P),a(k.finalConfirmationRole),r(I.filter(M=>["admin","hr","operation_manager"].includes(M.id)))}catch{p({message:"Failed to load workflow data.",type:"error"})}finally{l(!1)}},[]);E.useEffect(()=>{_()},[_]);const w=(P,k)=>{e(I=>I.map(M=>M.id===P?{...M,reportingManagerId:k||void 0}:M))},j=async()=>{d(!0);try{await Promise.all(n.map(P=>pe.updateUserReportingManager(P.id,P.reportingManagerId||null))),await pe.updateApprovalWorkflowSettings(s),p({message:"Workflow saved successfully!",type:"success"}),_()}catch{p({message:"Failed to save workflow.",type:"error"})}finally{d(!1)}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[m&&i.jsx(Gt,{message:m.message,type:m.type,onDismiss:()=>p(null)}),i.jsx(Yi,{title:"Leave Approval Settings",children:i.jsxs(ae,{onClick:j,isLoading:c,children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save Workflow"]})}),i.jsxs("section",{className:"mb-8",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text mb-2",children:"Final Confirmation Step"}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Select the role responsible for the final confirmation of a leave request after it has been approved by the reporting manager chain."}),i.jsx("div",{className:"max-w-xs",children:i.jsx(Qe,{label:"Final Confirmation Role",id:"final-approver",value:s,onChange:P=>a(P.target.value),children:t.map(P=>i.jsx("option",{value:P.id,children:P.displayName},P.id))})})]}),i.jsxs("section",{children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-1",children:"Reporting Structure"}),i.jsx("p",{className:"text-sm text-muted",children:"View and manage organizational hierarchy"})]})}),i.jsx("div",{className:"border-b border-border mb-6",children:i.jsxs("div",{className:"flex gap-1 overflow-x-auto",children:[i.jsxs("button",{onClick:()=>v("table"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="table"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(dJ,{className:"w-4 h-4"}),"Table View"]}),i.jsxs("button",{onClick:()=>v("2d"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="2d"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(rJ,{className:"w-4 h-4"}),"2D Workflow Chart"]}),i.jsxs("button",{onClick:()=>v("3d"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="3d"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(MK,{className:"w-4 h-4"}),"3D Workflow Chart"]})]})}),o?i.jsx("div",{className:"flex justify-center items-center py-10",children:i.jsx(Tt,{className:"h-6 w-6 animate-spin text-muted"})}):i.jsxs(i.Fragment,{children:[x==="table"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-muted mb-4",children:"For each employee, assign a reporting manager. Leave requests will be sent to this manager for first-level approval."}),i.jsx("div",{className:"overflow-x-auto hidden md:block border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase w-1/2",children:"Reporting Manager"})]})}),i.jsx("tbody",{className:"bg-card divide-y divide-border",children:n.map(P=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 font-medium text-primary-text",children:P.name}),i.jsx("td",{className:"px-6 py-4 text-sm text-muted capitalize",children:t.find(k=>k.id===P.role)?.displayName||P.role.replace(/_/g," ")}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs(Qe,{label:"",id:`manager-for-desktop-${P.id}`,value:P.reportingManagerId||"",onChange:k=>w(P.id,k.target.value),className:"w-full",children:[i.jsx("option",{value:"",children:"None (Reports to Final Approver)"}),n.filter(k=>k.id!==P.id).map(k=>i.jsx("option",{value:k.id,children:k.name},k.id))]})})]},P.id))})]})}),i.jsx("div",{className:"space-y-3 md:hidden",children:n.map(P=>i.jsxs("div",{className:"bg-card rounded-lg border border-border overflow-hidden",children:[i.jsxs("div",{className:"p-3",children:[i.jsx("p",{className:"font-semibold text-primary-text",children:P.name}),i.jsx("p",{className:"text-sm text-muted capitalize",children:t.find(k=>k.id===P.role)?.displayName||P.role.replace(/_/g," ")})]}),i.jsxs("div",{className:"p-3 border-t border-border",children:[i.jsx("label",{className:"text-sm text-muted block mb-1",children:"Manager"}),i.jsxs(Qe,{id:`manager-for-mobile-${P.id}`,value:P.reportingManagerId||"",onChange:k=>w(P.id,k.target.value),children:[i.jsx("option",{value:"",children:"None"}),n.filter(k=>k.id!==P.id).map(k=>i.jsx("option",{value:k.id,children:k.name},k.id))]})]})]},P.id))})]}),x==="2d"&&i.jsx("div",{className:"border border-border rounded-lg overflow-auto bg-white h-[618px] w-full relative",children:i.jsx(Zle,{users:n})}),x==="3d"&&i.jsx("div",{className:"border border-border rounded-lg overflow-auto bg-white h-[618px] w-full relative",children:i.jsx(Kle,{users:n})})]})]})]})},c1=Ma(n=>({tasks:[],isLoading:!1,error:null,fetchTasks:async()=>{n({isLoading:!0,error:null});try{const e=await pe.getTasks();n({tasks:e,isLoading:!1})}catch{n({error:"Failed to fetch tasks.",isLoading:!1})}},createTask:async e=>{try{const t=await pe.createTask(e);n(r=>({tasks:[t,...r.tasks]}))}catch(t){throw console.error("Failed to create task",t),new Error("Failed to create task.")}},updateTask:async(e,t)=>{try{const r=await pe.updateTask(e,t);n(s=>({tasks:s.tasks.map(a=>a.id===e?r:a)}))}catch(r){throw console.error("Failed to update task",r),new Error("Failed to update task.")}},deleteTask:async e=>{try{await pe.deleteTask(e),n(t=>({tasks:t.tasks.filter(r=>r.id!==e)}))}catch(t){throw console.error("Failed to delete task",t),new Error("Failed to delete task.")}},runAutomaticEscalations:async()=>{try{const{updatedTasks:e,newNotifications:t}=await pe.runAutomaticEscalations();if(e.length>0&&n(r=>({tasks:r.tasks.map(s=>e.find(a=>a.id===s.id)||s)})),t.length>0){const r=t.map(s=>pe.createNotification(s));await Promise.all(r),Yx.getState().fetchNotifications()}}catch(e){console.error("Failed to run automatic escalations",e)}}})),Qle=wt({name:be().required("Task name is required"),description:be().required("Description is required"),dueDate:be().required("A due date is required").nullable(),priority:be().oneOf(["Low","Medium","High"]).required("Priority is required"),assignedToId:be().required("An assignee is required"),escalationLevel1UserId:be().optional(),escalationLevel1DurationDays:rs().when("escalationLevel1UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationLevel2UserId:be().optional(),escalationLevel2DurationDays:rs().when("escalationLevel2UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationEmail:be().email("Must be a valid email address").optional(),escalationEmailDurationDays:rs().when("escalationEmail",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()})}).defined(),Xle=({isOpen:n,onClose:e,initialData:t,setToast:r})=>{const{createTask:s,updateTask:a}=c1(),[o,l]=E.useState(!1),[c,d]=E.useState([]),{permissions:m}=ka(),{fetchNotifications:p}=Yx(),{theme:x}=gu(),{register:v,handleSubmit:_,formState:{errors:w},reset:j,control:P,watch:k}=Zt({resolver:_n(Qle)}),I=!!t,M=k("escalationLevel1UserId"),D=k("escalationLevel2UserId"),O=k("escalationEmail");E.useEffect(()=>{n&&(pe.getUsers().then(d),j(t||{name:"",description:"",dueDate:null,priority:"Medium",assignedToId:""}))},[t,j,n]);const q=async ne=>{l(!0);try{const te=c.find($=>$.id===ne.assignedToId),ie={...ne,assignedToName:te?.name};if(I?(await a(t.id,ie),r({message:"Task updated successfully!",type:"success"})):(await s(ie),r({message:"Task created successfully.",type:"success"})),te&&te.id!==t?.assignedToId){const se=(m[te.role]||[]).includes("manage_tasks")?"/tasks":"/onboarding/tasks";await pe.createNotification({userId:te.id,type:"task_assigned",message:`You have been assigned a new task: "${ne.name}"`,linkTo:se}),p()}e()}catch{r({message:"Failed to save task.",type:"error"})}finally{l(!1)}};if(!n)return null;const F=x==="dark",U="!bg-[#041b0f] !border-white/10 !text-white !placeholder-gray-500 !rounded-xl focus:!ring-emerald-500 focus:!border-emerald-500",B="text-gray-300 font-medium mb-1.5 block",G="",X="block text-sm font-medium text-muted mb-1",Q=F?U:G,Y=F?B:X;return i.jsx("div",{className:`fixed inset-0 z-50 ${F?"bg-[#041b0f]":"flex items-center justify-center"}`,onClick:e,children:i.jsx("div",{className:`${F?"w-full h-full bg-[#041b0f] p-6 overflow-y-auto scrollbar-hide":"bg-card rounded-xl shadow-card p-6 w-full max-w-2xl m-4 animate-fade-in-scale overflow-y-auto max-h-[90vh] scrollbar-hide"}`,style:F?{backgroundColor:"#041b0f"}:{},onClick:ne=>ne.stopPropagation(),children:i.jsxs("form",{onSubmit:_(q),className:F?"space-y-5":"",children:[i.jsxs("div",{className:`flex items-center justify-between ${F?"mb-2":"mb-4"}`,children:[i.jsxs("h3",{className:`text-xl font-bold ${F?"text-white":"text-primary-text"}`,children:[I?"Edit":"Add"," Task"]}),F&&i.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-white",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"name",className:Y,children:"Task Name"}),i.jsx(Me,{id:"name",registration:v("name"),error:w.name?.message,className:Q,placeholder:F?"Enter task name":""})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:Y,children:"Description"}),i.jsx("textarea",{id:"description",rows:F?4:3,...v("description"),className:F?`w-full ${Q} px-3 py-3 outline-none`:`mt-1 bg-card border ${w.description?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`,placeholder:F?"Enter task description":""}),w.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:w.description.message})]}),i.jsxs("div",{className:F?"":"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{className:F?"mb-4":"",children:[F?i.jsx("label",{className:Y,children:"Due Date"}):null,i.jsx(je,{name:"dueDate",control:P,render:({field:ne})=>i.jsx(Nn,{label:F?"":"Due Date",id:"dueDate",value:ne.value,onChange:ne.onChange,error:w.dueDate?.message,minDate:new Date,className:Q})})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"priority",className:F?Y:"hidden",children:"Priority"}),i.jsxs(Qe,{label:F?void 0:"Priority",id:"priority",registration:v("priority"),error:w.priority?.message,className:Q,children:[i.jsx("option",{value:"Low",className:F?"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:F?"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:F?"bg-[#041b0f]":"",children:"High"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"assignedToId",className:F?Y:"hidden",children:"Assign To"}),i.jsxs(Qe,{label:F?void 0:"Assign To",id:"assignedToId",registration:v("assignedToId"),error:w.assignedToId?.message,className:Q,children:[i.jsx("option",{value:"",className:F?"bg-[#041b0f]":"",children:"Select User"}),c.map(ne=>i.jsxs("option",{value:ne.id,className:F?"bg-[#041b0f]":"",children:[ne.name," (",ne.role.replace(/_/g," "),")"]},ne.id))]})]}),i.jsxs("div",{className:`pt-4 border-t ${F?"border-white/10":""}`,children:[i.jsx("h4",{className:`text-lg font-semibold ${F?"text-white":"text-primary-text"} mb-1`,children:"Escalation Matrix (Optional)"}),i.jsx("p",{className:`text-xs ${F?"text-gray-400":"text-muted"} mb-4 leading-relaxed`,children:"Define who gets notified if this task becomes overdue and set the time gaps for each escalation."}),i.jsxs("div",{className:F?"space-y-4":"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel1UserId",className:F?Y:"hidden",children:"Escalation Level 1"}),i.jsxs(Qe,{label:F?void 0:"Escalation Level 1",id:"escalationLevel1UserId",registration:v("escalationLevel1UserId"),error:w.escalationLevel1UserId?.message,className:Q,children:[i.jsx("option",{value:"",className:F?"bg-[#041b0f]":"",children:"Select User"}),c.map(ne=>i.jsx("option",{value:ne.id,className:F?"bg-[#041b0f]":"",children:ne.name},ne.id))]})]}),M&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel1DurationDays",className:F?Y:"hidden",children:"Days until L1 Escalation"}),i.jsx(Me,{label:F?void 0:"Days until L1 Escalation",id:"escalationLevel1DurationDays",type:"number",registration:v("escalationLevel1DurationDays"),error:w.escalationLevel1DurationDays?.message,className:Q})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel2UserId",className:F?Y:"hidden",children:"Escalation Level 2"}),i.jsxs(Qe,{label:F?void 0:"Escalation Level 2",id:"escalationLevel2UserId",registration:v("escalationLevel2UserId"),error:w.escalationLevel2UserId?.message,className:Q,children:[i.jsx("option",{value:"",className:F?"bg-[#041b0f]":"",children:"Select User"}),c.map(ne=>i.jsx("option",{value:ne.id,className:F?"bg-[#041b0f]":"",children:ne.name},ne.id))]})]}),D&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel2DurationDays",className:F?Y:"hidden",children:"Days until L2 Escalation"}),i.jsx(Me,{label:F?void 0:"Days until L2 Escalation",id:"escalationLevel2DurationDays",type:"number",registration:v("escalationLevel2DurationDays"),error:w.escalationLevel2DurationDays?.message,className:Q})]}),i.jsxs("div",{className:F?"":"mt-4",children:[i.jsx("label",{htmlFor:"escalationEmail",className:F?Y:"hidden",children:"Final Escalation Email"}),i.jsx(Me,{label:F?void 0:"Final Escalation Email",id:"escalationEmail",type:"email",registration:v("escalationEmail"),error:w.escalationEmail?.message,className:Q,placeholder:F?"Enter email address":""})]}),O&&i.jsxs("div",{className:F?"":"mt-4",children:[i.jsx("label",{htmlFor:"escalationEmailDurationDays",className:F?Y:"hidden",children:"Days until Final Escalation"}),i.jsx(Me,{label:F?void 0:"Days until Final Escalation",id:"escalationEmailDurationDays",type:"number",registration:v("escalationEmailDurationDays"),error:w.escalationEmailDurationDays?.message,className:Q})]})]})]})]}),i.jsxs("div",{className:F?"pt-2":"mt-6 flex justify-end space-x-3",children:[!F&&i.jsx(ae,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ae,{type:"submit",isLoading:o,className:F?"w-full !bg-[#32CD32] hover:!bg-[#28a428] !text-[#0D1A0D] !font-bold !rounded-xl py-3 shadow-lg shadow-green-900/20 transition-all transform active:scale-[0.98]":"",children:I?"Save Changes":"Create Task"})]})]})})})},ece=wt({completionNotes:be().required("Completion notes are required").min(10,"Please provide more detail."),completionPhoto:Ft().required("A photo proof of completion is required.").nullable()}).defined(),tce=({isOpen:n,onClose:e,task:t,setToast:r})=>{const{updateTask:s}=c1(),[a,o]=at.useState(!1),{handleSubmit:l,formState:{errors:c},reset:d,control:m}=Zt({resolver:_n(ece),defaultValues:{completionNotes:"",completionPhoto:null}}),p=async x=>{o(!0);try{await s(t.id,{...x,status:"Done"}),r({message:"Task completed successfully!",type:"success"}),e()}catch{r({message:"Failed to complete task.",type:"error"})}finally{o(!1)}};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:x=>x.stopPropagation(),children:i.jsxs("form",{onSubmit:l(p),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Complete Task: ",t.name]}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Provide a summary and photo proof of your work."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"completionNotes",className:"block text-sm font-medium text-muted",children:"Completion Notes"}),i.jsx("textarea",{id:"completionNotes",rows:4,...m.register("completionNotes"),className:`mt-1 bg-card border ${c.completionNotes?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`}),c.completionNotes&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionNotes.message})]}),i.jsx(je,{name:"completionPhoto",control:m,render:({field:x})=>i.jsx(xt,{label:"Upload Photo Proof",file:x.value,onFileChange:x.onChange,allowedTypes:["image/jpeg","image/png"]})}),c.completionPhoto&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionPhoto.message})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ae,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ae,{type:"submit",isLoading:a,children:"Mark as Done"})]})]})})}):null},nce=n=>{const e=new Date;e.setHours(0,0,0,0);const t=o=>o?new Date(o):null;if(n.status==="Done"||!n.dueDate)return{date:n.dueDate?Ue(t(n.dueDate),"dd MMM, yyyy"):"-",isOverdue:!1};let r=null;const s=t(n.dueDate);switch(n.escalationStatus){case"None":r=n.escalationLevel1DurationDays?fl(s,n.escalationLevel1DurationDays):s;break;case"Level 1":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays){const o=fl(s,n.escalationLevel1DurationDays);r=fl(o,n.escalationLevel2DurationDays)}break;case"Level 2":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays&&n.escalationEmailDurationDays){const o=fl(s,n.escalationLevel1DurationDays),l=fl(o,n.escalationLevel2DurationDays);r=fl(l,n.escalationEmailDurationDays)}break}r||(r=s);const a=r?r<e:!1;return{date:Ue(r,"dd MMM, yyyy"),isOverdue:a}},rce=()=>{const{user:n}=St(),{tasks:e,isLoading:t,error:r,fetchTasks:s,deleteTask:a,runAutomaticEscalations:o}=c1(),{theme:l}=gu(),c=l==="dark",[d,m]=E.useState(!1),[p,x]=E.useState(!1),[v,_]=E.useState(!1),[w,j]=E.useState(null),[P,k]=E.useState(null),[I,M]=E.useState([]),[D,O]=E.useState("all"),[q,F]=E.useState("all"),[U,B]=E.useState("all"),G=Jt("(max-width: 767px)");E.useEffect(()=>{(async()=>{pe.getUsers().then(M),await s(),await o()})()},[s,o]);const X=()=>{j(null),m(!0)},Q=K=>{j(K),m(!0)},Y=K=>{j(K),x(!0)},ne=K=>{j(K),_(!0)},te=async()=>{if(w)try{await a(w.id),k({message:"Task deleted.",type:"success"}),_(!1)}catch{k({message:"Failed to delete task.",type:"error"})}},ie=E.useMemo(()=>e.filter(K=>{if(D!=="all"&&K.status!==D||q!=="all"&&K.priority!==q)return!1;if(U==="unassigned"){if(K.assignedToId)return!1}else if(U!=="all"&&K.assignedToId!==U)return!1;return!0}),[e,D,q,U]),$=()=>{O("all"),F("all"),B("all")},H=D!=="all"||q!=="all"||U!=="all",se=K=>{const oe={High:c?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800",Medium:c?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800",Low:c?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${oe[K]}`,children:K})},W=K=>{const oe={"To Do":c?"bg-gray-500/20 text-gray-300":"bg-gray-100 text-gray-800","In Progress":c?"bg-indigo-500/20 text-indigo-300":"bg-indigo-100 text-indigo-800",Done:c?"bg-green-500/20 text-green-300":"bg-green-100 text-green-800"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${oe[K]}`,children:K})},ee=K=>{if(K==="None")return null;const oe={None:"","Level 1":c?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-800","Level 2":c?"bg-amber-500/20 text-amber-400":"bg-amber-100 text-amber-800","Email Sent":c?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${oe[K]}`,children:K})};return i.jsxs("div",{className:`min-h-screen ${G?"bg-[#041b0f] text-white p-4 pb-24":`p-4 ${c?"bg-[#041b0f] border border-white/10":"md:bg-card"} md:p-6 md:rounded-xl md:shadow-card`}`,children:[P&&i.jsx(Gt,{message:P.message,type:P.type,onDismiss:()=>k(null)}),d?i.jsx(Xle,{isOpen:d,onClose:()=>m(!1),initialData:w,setToast:k}):i.jsxs(i.Fragment,{children:[p&&w&&i.jsx(tce,{isOpen:p,onClose:()=>x(!1),task:w,setToast:k}),i.jsxs(tr,{isOpen:v,onClose:()=>_(!1),onConfirm:te,title:"Confirm Deletion",children:['Are you sure you want to delete the task "',w?.name,'"?']}),i.jsx("div",{className:"mb-6",children:i.jsx("h1",{className:`text-2xl font-bold ${G||c?"text-white":"text-gray-900"}`,children:"Task Management"})}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 md:items-end justify-between",children:[i.jsxs("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${G||c?"text-gray-300":"text-gray-700"}`,children:"Filter by Status"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${G||c?"bg-[#152b1b] border-white/10 text-white":"bg-white border-gray-300 text-gray-900"}`,value:D,onChange:K=>O(K.target.value),children:[i.jsx("option",{value:"all",className:G||c?"bg-[#041b0f]":"",children:"All Statuses"}),i.jsx("option",{value:"To Do",className:G||c?"bg-[#041b0f]":"",children:"To Do"}),i.jsx("option",{value:"In Progress",className:G||c?"bg-[#041b0f]":"",children:"In Progress"}),i.jsx("option",{value:"Done",className:G||c?"bg-[#041b0f]":"",children:"Done"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${G||c?"text-gray-300":"text-gray-700"}`,children:"Filter by Priority"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${G||c?"bg-[#152b1b] border-white/10 text-white":"bg-white border-gray-300 text-gray-900"}`,value:q,onChange:K=>F(K.target.value),children:[i.jsx("option",{value:"all",className:G||c?"bg-[#041b0f]":"",children:"All Priorities"}),i.jsx("option",{value:"Low",className:G||c?"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:G||c?"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:G||c?"bg-[#041b0f]":"",children:"High"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${G||c?"text-gray-300":"text-gray-700"}`,children:"Filter by Assignee"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${G||c?"bg-[#152b1b] border-white/10 text-white":"bg-white border-gray-300 text-gray-900"}`,value:U,onChange:K=>B(K.target.value),children:[i.jsx("option",{value:"all",className:G||c?"bg-[#041b0f]":"",children:"All Users"}),i.jsx("option",{value:"unassigned",className:G||c?"bg-[#041b0f]":"",children:"Unassigned"}),I.map(K=>i.jsx("option",{value:K.id,className:G||c?"bg-[#041b0f]":"",children:K.name},K.id))]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 mt-4 md:mt-0",children:[H&&i.jsxs(ae,{variant:"secondary",onClick:$,className:G||c?"!bg-[#152b1b] !text-white !border-white/10":"",children:[i.jsx(Ui,{className:"mr-2 h-4 w-4"})," Clear Filters"]}),i.jsxs("button",{onClick:X,className:`flex items-center justify-center transition-colors ${G?"!bg-[#32CD32] hover:!bg-[#28a428] !text-[#0D1A0D] !font-bold !border-none shadow-none text-sm py-3 px-6 rounded-xl":"bg-emerald-600 text-white hover:bg-emerald-700 rounded-lg px-6 py-2.5 font-medium"}`,children:[i.jsx(qt,{className:"mr-2 h-5 w-5"})," Add Task"]})]})]}),r&&i.jsx("p",{className:"text-red-500 mb-4",children:r}),i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:G?"hidden":c?"bg-white/5 text-white":"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Task Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Priority"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Next Due Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Assigned To"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Escalation"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:`divide-y md:divide-y-0 ${G?"divide-white/10 space-y-4 block":c?"divide-white/10 bg-[#041b0f]":"divide-border md:bg-card"}`,children:t?G?i.jsx("tr",{children:i.jsx("td",{colSpan:7,children:i.jsx(Ta,{rows:3,cols:7,isMobile:!0})})}):i.jsx(Ta,{rows:5,cols:7}):ie.map(K=>{const{date:oe,isOverdue:re}=nce(K);return G?i.jsxs("div",{className:"bg-[#152b1b] p-4 rounded-xl border border-white/5 mb-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-white text-lg",children:K.name}),i.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Due: ",i.jsx("span",{className:re?"text-red-400 font-bold":"",children:oe||"-"})]})]}),se(K.priority)]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500 block text-xs",children:"Assigned To"}),i.jsx("span",{className:"text-gray-300",children:K.assignedToName||"-"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500 block text-xs",children:"Status"}),i.jsx("span",{className:"text-gray-300",children:K.status})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 border-t border-white/10 pt-3",children:[i.jsx("button",{onClick:()=>Q(K),className:"p-2 text-gray-400 hover:text-white bg-white/5 rounded-lg",children:i.jsx(xr,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>ne(K),className:"p-2 text-red-400 hover:text-red-300 bg-red-500/10 rounded-lg",children:i.jsx(Xt,{className:"h-4 w-4"})}),K.assignedToId===n?.id&&K.status!=="Done"&&i.jsxs("button",{onClick:()=>Y(K),className:"flex items-center px-3 py-2 bg-emerald-500/10 text-emerald-400 rounded-lg text-sm font-medium",children:[i.jsx(Bi,{className:"h-4 w-4 mr-1.5"})," Complete"]})]})]},K.id):i.jsxs("tr",{className:re?"bg-red-50":c?"text-gray-300 hover:bg-white/5":"",children:[i.jsx("td",{"data-label":"Task Name",className:"px-6 py-4 font-medium",children:K.name}),i.jsx("td",{"data-label":"Priority",className:"px-6 py-4",children:se(K.priority)}),i.jsx("td",{"data-label":"Next Due Date",className:`px-6 py-4 text-sm ${re?"font-bold text-red-600":"text-muted"}`,children:oe||"-"}),i.jsx("td",{"data-label":"Assigned To",className:"px-6 py-4 text-sm text-muted",children:K.assignedToName||"-"}),i.jsx("td",{"data-label":"Status",className:"px-6 py-4 text-sm text-muted",children:W(K.status)}),i.jsx("td",{"data-label":"Escalation",className:"px-6 py-4 text-sm text-muted",children:ee(K.escalationStatus)}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>Q(K),title:"Edit Task",children:i.jsx(xr,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>ne(K),title:"Delete Task",children:i.jsx(Xt,{className:"h-4 w-4 text-red-600"})}),K.assignedToId===n?.id&&K.status!=="Done"&&i.jsxs(ae,{variant:"outline",size:"sm",onClick:()=>Y(K),children:[i.jsx(Bi,{className:"h-4 w-4 mr-2"})," Complete"]})]})})]},K.id)})})]}),!t&&ie.length===0&&i.jsxs("div",{className:"text-center py-10 text-muted",children:[i.jsx("p",{className:G||c?"text-gray-400":"",children:"No tasks found matching your criteria."}),H&&i.jsx(ae,{variant:"secondary",size:"sm",className:"mt-2",onClick:$,children:"Clear filters"})]})]})]})]})},sce=wt({id:be().required(),name:be().required("Client name is required"),organizationId:be().optional(),location:be().optional(),registeredAddress:be().optional(),registrationType:be().oneOf(["CIN","ROC","ROF","Society","Trust",""]).optional(),registrationNumber:be().optional(),gstNumber:be().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,"Invalid GST Number format").optional(),panNumber:be().transform(n=>n?.toUpperCase()||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,"Invalid PAN format").optional(),email:be().email("Invalid email format").optional(),eShramNumber:be().optional(),shopAndEstablishmentCode:be().optional(),epfoCode:be().optional(),esicCode:be().optional(),psaraLicenseNumber:be().optional(),psaraValidTill:be().optional().nullable(),insuranceIds:xs().of(be().required()).optional(),policyIds:xs().of(be().required()).optional()}).defined(),ice=({isOpen:n,onClose:e,onSave:t,initialData:r,companyName:s})=>{const[a,o]=E.useState("General"),[l,c]=E.useState([]),[d,m]=E.useState([]),[p,x]=E.useState(!0),{register:v,handleSubmit:_,formState:{errors:w},reset:j,control:P}=Zt({resolver:_n(sce)}),k=!!r;E.useEffect(()=>{n&&(x(!0),Promise.all([pe.getPolicies(),pe.getInsurances()]).then(([D,O])=>{c(D),m(O),x(!1)}),j(r||{id:`new_${Date.now()}`,name:"",location:"",registeredAddress:"",registrationType:"",registrationNumber:"",gstNumber:"",panNumber:"",email:"",eShramNumber:"",shopAndEstablishmentCode:"",epfoCode:"",esicCode:"",psaraLicenseNumber:"",psaraValidTill:"",insuranceIds:[],policyIds:[]}))},[r,j,n]);const I=D=>{t(D)};if(!n)return null;const M=({tabName:D})=>i.jsx("button",{type:"button",onClick:()=>o(D),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${a===D?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:D});return i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-3xl my-8 mx-auto animate-fade-in-scale",onClick:D=>D.stopPropagation(),children:i.jsxs("form",{onSubmit:_(I),children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:k?"Edit Client":"Add New Client"}),i.jsxs("p",{className:"text-sm text-muted",children:["for ",s]})]}),i.jsx("div",{className:"border-b border-border mb-6",children:i.jsxs("nav",{className:"-mb-px flex space-x-4",children:[i.jsx(M,{tabName:"General"}),i.jsx(M,{tabName:"Registration"}),i.jsx(M,{tabName:"Compliance"}),i.jsx(M,{tabName:"Policies & Insurance"})]})}),i.jsxs("div",{className:"space-y-6 min-h-[300px]",children:[a==="General"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(Me,{label:"Client Name (as per document)",id:"name",registration:v("name"),error:w.name?.message}),i.jsx(Me,{label:"Location / City",id:"location",registration:v("location"),error:w.location?.message}),i.jsx(Me,{label:"Registered Address",id:"registeredAddress",registration:v("registeredAddress"),error:w.registeredAddress?.message})]}),a==="Registration"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsxs(Qe,{label:"Registration Type",id:"registrationType",registration:v("registrationType"),error:w.registrationType?.message,children:[i.jsx("option",{value:"",children:"Select Type"}),i.jsx("option",{value:"CIN",children:"CIN"}),i.jsx("option",{value:"ROC",children:"ROC"}),i.jsx("option",{value:"ROF",children:"ROF"}),i.jsx("option",{value:"Society",children:"Society"}),i.jsx("option",{value:"Trust",children:"Trust"})]}),i.jsx(Me,{label:"Registration Number",id:"registrationNumber",registration:v("registrationNumber"),error:w.registrationNumber?.message}),i.jsx(Me,{label:"GST Number",id:"gstNumber",registration:v("gstNumber"),error:w.gstNumber?.message}),i.jsx(Me,{label:"PAN Number",id:"panNumber",registration:v("panNumber"),error:w.panNumber?.message}),i.jsx(Me,{label:"Email Address",id:"email",type:"email",registration:v("email"),error:w.email?.message})]}),a==="Compliance"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(Me,{label:"E-Shram Number",id:"eShramNumber",registration:v("eShramNumber"),error:w.eShramNumber?.message}),i.jsx(Me,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:v("shopAndEstablishmentCode"),error:w.shopAndEstablishmentCode?.message}),i.jsx(Me,{label:"EPFO Code",id:"epfoCode",registration:v("epfoCode"),error:w.epfoCode?.message}),i.jsx(Me,{label:"ESIC Code",id:"esicCode",registration:v("esicCode"),error:w.esicCode?.message}),i.jsx(Me,{label:"PSARA License Number",id:"psaraLicenseNumber",registration:v("psaraLicenseNumber"),error:w.psaraLicenseNumber?.message}),i.jsx(je,{name:"psaraValidTill",control:P,render:({field:D})=>i.jsx(Nn,{label:"PSARA Valid Till",id:"psaraValidTill",value:D.value,onChange:D.onChange,error:w.psaraValidTill?.message})})]}),a==="Policies & Insurance"&&(p?i.jsx(Tt,{className:"mx-auto h-6 w-6 animate-spin text-muted"}):i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsx(je,{name:"policyIds",control:P,render:({field:D})=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Policies"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:l.map(O=>i.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:D.value?.includes(O.id),onChange:q=>{const F=q.target.checked?[...D.value||[],O.id]:(D.value||[]).filter(U=>U!==O.id);D.onChange(F)}}),i.jsx("span",{className:"ml-3 text-sm",children:O.name})]},O.id))})]})}),i.jsx(je,{name:"insuranceIds",control:P,render:({field:D})=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Insurance"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:d.map(O=>i.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:D.value?.includes(O.id),onChange:q=>{const F=q.target.checked?[...D.value||[],O.id]:(D.value||[]).filter(U=>U!==O.id);D.onChange(F)}}),i.jsxs("span",{className:"ml-3 text-sm",children:[O.type," - ",O.provider]})]},O.id))})]})})]}))]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[i.jsx(ae,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ae,{type:"submit",children:k?"Save Changes":"Add Client"})]})]})})})},Fg=({number:n,title:e,children:t})=>i.jsxs("div",{children:[i.jsxs("h4",{className:"font-bold text-lg text-primary-text mb-2",children:["Step ",n,": ",e]}),i.jsx("div",{className:"text-sm text-muted space-y-2",children:t})]}),ace=({isOpen:n,onClose:e})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-3xl my-8 animate-fade-in-scale flex flex-col",onClick:t=>t.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex items-center gap-3",children:[i.jsx(Vs,{className:"h-6 w-6 text-accent"}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"How to Use Import Templates"})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[70vh]",children:[i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(Ca,{className:"h-5 w-5 text-red-500 mr-3 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-red-800",children:"The Golden Rule: Do Not Modify the Template Structure"}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:"You must **NEVER** add, delete, rename, or reorder columns. Any changes to the header row will cause the import to fail. This rule ensures data integrity."})]})]})}),i.jsxs(Fg,{number:1,title:"Get the Template",children:[i.jsx("p",{children:"You have two options for getting a file to work with:"}),i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(Vs,{className:"h-4 w-4"})," Download Template:"]}),i.jsx("span",{children:"Provides a blank CSV file with only the correct header row. Use this for adding **new** records in bulk."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(EF,{className:"h-4 w-4"})," Export Data:"]}),i.jsx("span",{children:"Provides a CSV file filled with all the current data from the system. Use this for **updating existing** records in bulk."})]})]})]}),i.jsx(Fg,{number:2,title:"Edit Your Data",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(xr,{className:"h-4 w-4"})," To Update Existing Data:"]}),i.jsx("span",{children:"Use the file from **Export Data**. Find the row you want to change and edit its values. Do **NOT** edit the ID columns (e.g., `GroupId`, `EntityId`). These are used by the system to identify records."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(qt,{className:"h-4 w-4"})," To Add New Data:"]}),i.jsx("span",{children:"Add a new row at the bottom of the file. Leave the ID columns blank; the system will generate them automatically. Fill in all other required information."})]}),i.jsxs("li",{children:[i.jsx("strong",{className:"text-primary-text",children:"Complex Data (JSON):"}),i.jsx("span",{children:"For Site Configuration, some columns like `agreementDetails` contain complex data. This is exported as a JSON text string. Only edit this text if you are familiar with JSON, as incorrect formatting will cause the import to fail."})]})]})}),i.jsx(Fg,{number:3,title:"Save and Import",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsx("strong",{className:"text-primary-text",children:"Save as CSV:"}),i.jsx("span",{children:"After making your changes, save your file. If you are using Excel or Google Sheets, make sure to **Save As** or **Download As** a **CSV (Comma-Separated Values)** file."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(HK,{className:"h-4 w-4"})," Import:"]}),i.jsx("span",{children:"Go back to the application, click **Import**, and select the CSV file you just saved."})]})]})}),i.jsx(Fg,{number:4,title:"Review Feedback",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-green-600 flex items-center gap-2",children:[i.jsx(Bi,{className:"h-4 w-4"})," Success:"]}),i.jsx("span",{children:"You will see a success message indicating how many records were imported."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-red-600 flex items-center gap-2",children:[i.jsx(Ca,{className:"h-4 w-4"})," Error:"]}),i.jsx("span",{children:'If the import fails, a specific error message will appear. The most common error is a "Header mismatch," which means you have violated the Golden Rule. If this happens, download a fresh template and carefully copy your data into it.'})]})]})})]}),i.jsx("div",{className:"p-4 border-t flex justify-end",children:i.jsx(ae,{onClick:e,children:"Close"})})]})}):null,sd=({title:n})=>i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8 bg-page rounded-lg min-h-[400px]",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text mb-2",children:n}),i.jsx("p",{className:"text-muted max-w-sm",children:"Configuration for this section will be available here. The form details will be provided in a future update."})]}),bL=["Site Name","Designation","Quantity","Billing Rate","Billing Model","Holiday Billing Policy","Holiday Payment Policy","Uniform Deduction"],oce=n=>{if(n.length===0)return"";const e=Object.keys(n[0]);return[e.join(","),...n.map(r=>e.map(s=>{const a=String(r[s]??"");return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(","))].join(`
`)},lce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim()),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'""')),a[l]=d}),r.push(a)}return r},cce=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState({}),[c,d]=E.useState(null),m=E.useRef(null),{register:p,control:x,handleSubmit:v,watch:_,setValue:w}=Zt({defaultValues:{resources:[],serviceChargePercentage:10}}),{fields:j,append:P,remove:k,replace:I}=ys({control:x,name:"resources"});E.useEffect(()=>{pe.getOrganizations().then(e).finally(()=>r(!1))},[]);const M=async ne=>{if(!ne){I([]);return}a(!0);try{const te=await pe.getManpowerDetails(ne),ie=te.filter($=>$.count>0).map($=>({id:`res_${$.designation.replace(/\s/g,"_")}_${Date.now()}`,siteId:ne,designation:$.designation,quantity:$.count,billingRate:null,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"}));if(!o[ne]){const $=te.map(H=>H.designation);l(H=>({...H,[ne]:$}))}I(ie)}catch(te){console.error("Failed to load manpower",te),d({message:"Failed to load manpower details.",type:"error"})}finally{a(!1)}},D=async(ne,te)=>{if(w(`resources.${te}.designation`,""),ne&&!o[ne])try{const $=(await pe.getManpowerDetails(ne)).map(H=>H.designation);l(H=>({...H,[ne]:$}))}catch(ie){console.error(`Failed to load designations for site ${ne}`,ie)}},O=_("resources"),q=_("serviceChargePercentage"),F=()=>{P({id:`res_${Date.now()}`,siteId:"",designation:"",quantity:1,billingRate:0,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"})},{subTotal:U,serviceCharge:B,grandTotal:G}=at.useMemo(()=>{const te=(Array.isArray(O)?O:[]).reduce((se,W)=>{const ee=Number(W.quantity)||0,K=Number(W.billingRate)||0;return se+ee*K},0),ie=Number(q)||0,$=te*(ie/100),H=te+$;return{subTotal:te,serviceCharge:$,grandTotal:H}},[O,q]),X=()=>{const ne=[Object.fromEntries(bL.map(H=>[H,""]))],te=oce(ne),ie=new Blob([te],{type:"text/csv;charset=utf-8;"}),$=document.createElement("a");$.href=URL.createObjectURL(ie),$.setAttribute("download","costing_resource_template.csv"),document.body.appendChild($),$.click(),document.body.removeChild($)},Q=ne=>{const te=ne.target.files?.[0];if(!te)return;const ie=new FileReader;ie.onload=async $=>{try{const H=$.target?.result;if(!H)throw new Error("File is empty.");const se=lce(H);if(se.length===0)throw new Error("No data rows found in CSV.");const W=Object.keys(se[0]);if(!bL.every(_e=>W.includes(_e)))throw new Error("CSV file is missing required headers.");const K=new Map(n.map(_e=>[_e.shortName.toLowerCase(),_e.id])),oe=new Set;for(const _e of se){const le=_e["Site Name"]?.trim().toLowerCase();if(le){const fe=K.get(le);typeof fe=="string"&&oe.add(fe)}}const re=[...oe].filter(_e=>!o[_e]);if(re.length>0){const _e=re.map(fe=>pe.getManpowerDetails(fe).then(ue=>({siteId:fe,designations:ue.map(ce=>ce.designation)}))),le=await Promise.all(_e);l(fe=>{const ue={...fe};return le.forEach(ce=>{ue[ce.siteId]=ce.designations}),ue})}const me=se.map(_e=>{const le=_e["Site Name"]?.trim().toLowerCase(),fe=le?K.get(le):void 0;return fe?{id:`res_imported_${Date.now()}_${Math.random()}`,siteId:fe,designation:_e.Designation||"",quantity:parseFloat(_e.Quantity)||0,billingRate:parseFloat(_e["Billing Rate"])||0,billingModel:_e["Billing Model"]||"Per Month",holidayBillingPolicy:_e["Holiday Billing Policy"]||"",holidayPaymentPolicy:_e["Holiday Payment Policy"]||"",uniformDeduction:_e["Uniform Deduction"]||"Yes"}:null}).filter(_e=>_e!==null);I(me),d({message:`Successfully imported ${me.length} resources.`,type:"success"})}catch(H){d({message:H.message||"Failed to import CSV.",type:"error"})}finally{ne.target&&(ne.target.value="")}},ie.readAsText(te)},Y=ne=>{console.log("Saving Costing & Resource Data:",ne),d({message:"Configuration saved successfully (mocked).",type:"success"})};return i.jsxs("form",{onSubmit:v(Y),className:"space-y-6",children:[c&&i.jsx(Gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsx("input",{type:"file",ref:m,className:"hidden",accept:".csv",onChange:Q}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Costing & Resource Configuration"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsxs(Qe,{label:"Load Manpower from Site",id:"site-selector",onChange:ne=>M(ne.target.value),disabled:t||s,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),n.map(ne=>i.jsx("option",{value:ne.id,children:ne.shortName},ne.id))]}),s&&i.jsx(Tt,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 md:flex md:flex-wrap md:justify-end md:gap-2",children:[i.jsxs(ae,{type:"button",variant:"outline",onClick:X,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Download Template",children:[i.jsx(hi,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Template"})]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>m.current?.click(),className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Import",children:[i.jsx(Bc,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Import"})]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:F,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Add Resource",children:[i.jsx(qt,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Add Resource"})]}),i.jsxs(ae,{type:"submit",className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Save",children:[i.jsx(is,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Save"})]})]}),i.jsx("div",{className:"space-y-4",children:j.map((ne,te)=>{const ie=_(`resources.${te}.siteId`);return i.jsxs("div",{className:"p-4 border border-border rounded-xl relative bg-page/50",children:[i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>k(te),className:"absolute top-2 right-2","aria-label":"Remove Resource",children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsx(je,{control:x,name:`resources.${te}.siteId`,render:({field:$})=>i.jsxs(Qe,{label:"Site",id:`res-site-${te}`,...$,onChange:H=>{$.onChange(H),D(H.target.value,te)},children:[i.jsx("option",{value:"",children:"Select Site"}),n.map(H=>i.jsx("option",{value:H.id,children:H.shortName},H.id))]})}),i.jsxs(Qe,{label:"Designation",id:`res-desig-${te}`,...p(`resources.${te}.designation`),disabled:!ie,children:[i.jsx("option",{value:"",children:"Select Designation"}),(o[ie]||[]).map($=>i.jsx("option",{value:$,children:$},$))]}),i.jsx(Me,{label:"Quantity",id:`res-qty-${te}`,type:"number",step:"0.01",...p(`resources.${te}.quantity`)}),i.jsx(Me,{label:"Billing Rate",id:`res-rate-${te}`,type:"number",step:"0.01",...p(`resources.${te}.billingRate`)}),i.jsxs(Qe,{label:"Billing Model",id:`res-billing-${te}`,...p(`resources.${te}.billingModel`),children:[i.jsx("option",{children:"Per Month"}),i.jsx("option",{children:"Per Day"}),i.jsx("option",{children:"Per Hour"}),i.jsx("option",{children:"Lumpsum"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:`res-hol-bill-${te}`,className:"block text-sm font-medium text-muted",children:"Holiday Billing Policy"}),i.jsx("textarea",{id:`res-hol-bill-${te}`,...p(`resources.${te}.holidayBillingPolicy`),rows:3,className:"mt-1 form-input"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`res-hol-pay-${te}`,className:"block text-sm font-medium text-muted",children:"Holiday Payment Policy"}),i.jsx("textarea",{id:`res-hol-pay-${te}`,...p(`resources.${te}.holidayPaymentPolicy`),rows:3,className:"mt-1 form-input"})]}),i.jsxs(Qe,{label:"Uniform Deduction",id:`res-uniform-${te}`,...p(`resources.${te}.uniformDeduction`),children:[i.jsx("option",{children:"Yes"}),i.jsx("option",{children:"No"})]})]})]},ne.id)})}),j.length>0&&i.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:i.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsx("span",{className:"text-muted font-medium",children:"Sub Total"}),i.jsx("span",{className:"font-semibold text-primary-text",children:U.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-muted font-medium",children:"Service Charges"}),i.jsx("div",{className:"w-20",children:i.jsx(Me,{"aria-label":"Service charge percentage",id:"service-charge-perc",type:"number",...p("serviceChargePercentage")})}),i.jsx("span",{className:"text-muted font-medium",children:"%"})]}),i.jsx("span",{className:"font-semibold text-primary-text",children:B.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),i.jsxs("div",{className:"flex justify-between items-center pt-2 mt-2 border-t-2 border-primary-text",children:[i.jsx("span",{className:"font-bold text-lg",children:"Grand Total"}),i.jsx("span",{className:"font-bold text-lg",children:G.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]})]})}),j.length===0&&i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:t?i.jsx(Tt,{className:"h-5 w-5 animate-spin mx-auto"}):'Select a site to load manpower or click "Add Resource" to begin.'})]})},S6=["Department","Designation","PermanentId","TemporaryId"],dce=n=>{const e=S6.join(","),t=n.map(r=>[r.department,r.designation,r.permanentId,r.temporaryId].map(s=>{const a=String(s??"");return a.includes(",")?`"${a}"`:a}).join(","));return[e,...t].join(`
`)},uce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim());if(!["Department","Designation","PermanentId","TemporaryId"].every(s=>t.includes(s)))throw new Error("CSV is missing required headers.");return e.slice(1).map(s=>{const a=s.split(","),o={};return t.forEach((l,c)=>{l==="Department"&&(o.department=a[c]),l==="Designation"&&(o.designation=a[c]),l==="PermanentId"&&(o.permanentId=a[c]),l==="TemporaryId"&&(o.temporaryId=a[c])}),o})},fce=()=>{const[n,e]=E.useState(!0),[t,r]=E.useState(null),s=E.useRef(null),{register:a,control:o,handleSubmit:l,reset:c,watch:d}=Zt({defaultValues:{series:[]}}),{append:m,remove:p,replace:x}=ys({control:o,name:"series"});E.useEffect(()=>{e(!0),pe.getBackOfficeIdSeries().then(M=>c({series:M})).catch(()=>r({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const v=d("series"),_=E.useMemo(()=>Array.isArray(v)?v.reduce((M,D,O)=>{const q=D.department||"Uncategorized";return M[q]||(M[q]=[]),M[q].push({...D,originalIndex:O}),M},{}):{},[v]),w=()=>{m({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:""})},j=async M=>{try{await pe.updateBackOfficeIdSeries(M.series),r({message:"Configuration saved successfully.",type:"success"})}catch{r({message:"Failed to save configuration.",type:"error"})}},P=()=>{if(!Array.isArray(v)||v.length===0){r({message:"No data to export.",type:"error"});return}const M=dce(v),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a");O.href=URL.createObjectURL(D),O.setAttribute("download","back_office_id_series.csv"),document.body.appendChild(O),O.click(),document.body.removeChild(O)},k=()=>{const M=S6.join(","),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a");O.href=URL.createObjectURL(D),O.setAttribute("download","id_series_template.csv"),document.body.appendChild(O),O.click(),document.body.removeChild(O)},I=M=>{const D=M.target.files?.[0];if(!D)return;const O=new FileReader;O.onload=q=>{try{const F=q.target?.result,B=uce(F).map(G=>({id:`imported_${Date.now()}_${Math.random()}`,department:G.department||"",designation:G.designation||"",permanentId:G.permanentId||"",temporaryId:G.temporaryId||""}));x(B),r({message:`Imported ${B.length} records.`,type:"success"})}catch(F){r({message:F.message||"Failed to import CSV.",type:"error"})}finally{M.target&&(M.target.value="")}},O.readAsText(D)};return i.jsxs("form",{onSubmit:l(j),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(Gt,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:I}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Back Office Department & Emp ID Series"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ae,{type:"button",variant:"outline",onClick:k,children:[i.jsx(Vs,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Bc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:P,children:[i.jsx(hi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(ae,{type:"submit",children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsx("div",{className:"space-y-6",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(_).length===0?i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No ID series defined. Click "Add Designation" to begin.'}):Object.entries(_).map(([M,D])=>i.jsxs("div",{className:"border border-border rounded-xl",children:[i.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:i.jsx(Me,{"aria-label":`Department for ${M}`,id:`series.${D[0].originalIndex}.department`,...a(`series.${D[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),i.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(D)&&D.map(O=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-10 gap-2 items-center",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(Me,{placeholder:"Designation","aria-label":`Designation for ${M}`,id:`series.${O.originalIndex}.designation`,...a(`series.${O.originalIndex}.designation`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(Me,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${O.designation}`,id:`series.${O.originalIndex}.permanentId`,...a(`series.${O.originalIndex}.permanentId`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(Me,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${O.designation}`,id:`series.${O.originalIndex}.temporaryId`,...a(`series.${O.originalIndex}.temporaryId`)})}),i.jsx("div",{className:"md:col-span-1 text-right",children:i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>p(O.originalIndex),"aria-label":`Remove ${O.designation}`,title:`Remove ${O.designation}`,children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})})]},O.id))})]},M))}),i.jsxs(ae,{type:"button",onClick:w,variant:"outline",className:"mt-6",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},Ex=["Department","Designation","PermanentId","TemporaryId","MonthlySalary"],hce=n=>{const e=Ex.join(","),t=n.map(r=>[r.department,r.designation,r.permanentId,r.temporaryId,r.monthlySalary].map(s=>{const a=String(s??"");return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(","));return[e,...t].join(`
`)},mce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,""));if(!Ex.every(s=>t.includes(s)))throw new Error(`CSV is missing required headers: ${Ex.join(", ")}`);const r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((c,d)=>{let m=(o[d]||"").trim();m.startsWith('"')&&m.endsWith('"')&&(m=m.substring(1,m.length-1).replace(/""/g,'""')),a[c]=m});const l=parseFloat(a.MonthlySalary);r.push({department:a.Department,designation:a.Designation,permanentId:a.PermanentId,temporaryId:a.TemporaryId,monthlySalary:isNaN(l)?null:l})}return r},pce=()=>{const[n,e]=E.useState(!0),[t,r]=E.useState(null),s=E.useRef(null),{register:a,control:o,handleSubmit:l,reset:c,watch:d}=Zt({defaultValues:{designations:[]}}),{append:m,remove:p,replace:x}=ys({control:o,name:"designations"});E.useEffect(()=>{e(!0),pe.getSiteStaffDesignations().then(M=>c({designations:M})).catch(()=>r({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const v=d("designations"),_=E.useMemo(()=>Array.isArray(v)?v.reduce((M,D,O)=>{const q=D.department||"Uncategorized";return M[q]||(M[q]=[]),M[q].push({...D,originalIndex:O}),M},{}):{},[v]),w=()=>{m({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:"",monthlySalary:null})},j=async M=>{try{await pe.updateSiteStaffDesignations(M.designations),r({message:"Configuration saved successfully.",type:"success"})}catch{r({message:"Failed to save configuration.",type:"error"})}},P=()=>{if(!Array.isArray(v)||v.length===0){r({message:"No data to export.",type:"error"});return}const M=hce(v),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a");O.href=URL.createObjectURL(D),O.setAttribute("download","site_staff_designations.csv"),document.body.appendChild(O),O.click(),document.body.removeChild(O)},k=()=>{const M=Ex.join(","),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a");O.href=URL.createObjectURL(D),O.setAttribute("download","site_staff_template.csv"),document.body.appendChild(O),O.click(),document.body.removeChild(O)},I=M=>{const D=M.target.files?.[0];if(!D)return;const O=new FileReader;O.onload=q=>{try{const F=q.target?.result,B=mce(F).map(G=>({id:`imported_${Date.now()}_${Math.random()}`,department:G.department||"",designation:G.designation||"",permanentId:G.permanentId||"",temporaryId:G.temporaryId||"",monthlySalary:G.monthlySalary||null}));x(B),r({message:`Imported ${B.length} records.`,type:"success"})}catch(F){r({message:F.message||"Failed to import CSV.",type:"error"})}finally{M.target&&(M.target.value="")}},O.readAsText(D)};return i.jsxs("form",{onSubmit:l(j),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(Gt,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:I}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Staff Designation & ID Series"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ae,{type:"button",variant:"outline",onClick:k,children:[i.jsx(Vs,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Bc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:P,children:[i.jsx(hi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(ae,{type:"submit",children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsx("div",{className:"space-y-6",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(_).length===0?i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No designations defined. Click "Add Designation" to begin.'}):Object.entries(_).map(([M,D])=>i.jsxs("div",{className:"border border-border rounded-xl",children:[i.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:i.jsx(Me,{"aria-label":`Department for ${M}`,id:`designations.${D[0].originalIndex}.department`,...a(`designations.${D[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),i.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(D)&&D.map(O=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-center",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(Me,{placeholder:"Designation","aria-label":`Designation for ${M}`,id:`designations.${O.originalIndex}.designation`,...a(`designations.${O.originalIndex}.designation`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(Me,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${O.designation}`,id:`designations.${O.originalIndex}.permanentId`,...a(`designations.${O.originalIndex}.permanentId`)})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(Me,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${O.designation}`,id:`designations.${O.originalIndex}.temporaryId`,...a(`designations.${O.originalIndex}.temporaryId`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(Me,{placeholder:"Monthly Salary (Gross)","aria-label":`Salary for ${O.designation}`,id:`designations.${O.originalIndex}.monthlySalary`,type:"number",...a(`designations.${O.originalIndex}.monthlySalary`,{valueAsNumber:!0})})}),i.jsx("div",{className:"md:col-span-1 text-right",children:i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>p(O.originalIndex),"aria-label":`Remove ${O.designation}`,title:`Remove ${O.designation}`,children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})})]},O.id))})]},M))}),i.jsxs(ae,{type:"button",onClick:w,variant:"outline",className:"mt-4",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},gce=({id:n,label:e,checked:t,onChange:r,description:s,disabled:a})=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{className:"flex-grow flex flex-col",children:[i.jsx("span",{className:"text-sm font-medium text-primary-text",children:e}),s&&i.jsx("span",{className:"text-sm text-muted",children:s})]}),i.jsxs("div",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",id:n,className:"sr-only peer",checked:t,onChange:o=>r(o.target.checked),disabled:a}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-accent-dark peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent"})]})]}),qN=["Applicability","OptInDisclaimer","CoverageDetails","OptOutDisclaimer","RequireAlternateInsurance","CollectProvider","CollectStartDate","CollectEndDate","CollectExtentOfCover"],xce={applicability:"Optional - Opt-in Default",optInDisclaimer:"",coverageDetails:"",optOutDisclaimer:"",requireAlternateInsurance:!1,collectProvider:!1,collectStartDate:!1,collectEndDate:!1,collectExtentOfCover:!1},yce=n=>{const e=qN.join(","),t=qN.map(r=>{const s=r.charAt(0).toLowerCase()+r.slice(1);let a=n[s];return typeof a=="string"&&(a.includes(",")||a.includes(`
`)||a.includes('"'))?`"${a.replace(/"/g,'""')}"`:a});return[e,t.join(",")].join(`
`)},vce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)throw new Error("CSV file must have a header and at least one data row.");const t=e[0].split(",").map(a=>a.trim()),r=e[1].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[],s={};return t.forEach((a,o)=>{const l=a.charAt(0).toLowerCase()+a.slice(1);let c=(r[o]||"").trim();c.startsWith('"')&&c.endsWith('"')&&(c=c.substring(1,c.length-1).replace(/""/g,'""')),l==="applicability"?s[l]=c:typeof xce[l]=="boolean"?s[l]=c.toLowerCase()==="true":s[l]=c}),s},qg=({label:n,...e})=>i.jsxs("label",{className:"flex items-center gap-2 text-sm text-muted",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",...e}),n]}),bce=()=>{const{gmcPolicy:n,updateGmcPolicySettings:e}=fi(),[t,r]=E.useState(null),s=E.useRef(null),{register:a,handleSubmit:o,control:l,watch:c,reset:d,formState:{isDirty:m}}=Zt({defaultValues:n});E.useEffect(()=>{d(n)},[n,d]);const p=c("requireAlternateInsurance"),x=c("applicability")==="Mandatory",v=P=>{e(P),r({message:"GMC policy settings saved.",type:"success"})},_=()=>{const P=yce(n),k=new Blob([P],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(k),I.setAttribute("download","gmc_policy_settings.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},w=()=>{const P=qN.join(","),k=new Blob([P],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(k),I.setAttribute("download","gmc_policy_template.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},j=P=>{const k=P.target.files?.[0];if(!k)return;const I=new FileReader;I.onload=M=>{try{const D=M.target?.result,O=vce(D);d(O),r({message:"Settings imported from CSV. Review and save.",type:"success"})}catch(D){r({message:D.message||"Failed to import CSV.",type:"error"})}finally{P.target&&(P.target.value="")}},I.readAsText(k)};return i.jsxs("form",{onSubmit:o(v),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(Gt,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:j}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"GMC Policy Configuration"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ae,{type:"button",variant:"outline",onClick:w,children:[i.jsx(Vs,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Bc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:_,children:[i.jsx(hi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(ae,{type:"submit",disabled:!m,children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{children:i.jsx(je,{name:"applicability",control:l,render:({field:P})=>i.jsxs(Qe,{label:"Applicability",...P,children:[i.jsx("option",{children:"Mandatory"}),i.jsx("option",{children:"Optional - Opt-in Default"}),i.jsx("option",{children:"Optional - Opt-out Default"})]})})}),i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-In Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-In Disclaimer"}),i.jsx("textarea",{...a("optInDisclaimer"),rows:3,className:"form-input mt-1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Coverage Details"}),i.jsx("textarea",{...a("coverageDetails"),rows:2,className:"form-input mt-1"})]})]}),!x&&i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-Out Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-Out Disclaimer"}),i.jsx("textarea",{...a("optOutDisclaimer"),rows:3,className:"form-input mt-1"})]}),i.jsx(je,{name:"requireAlternateInsurance",control:l,render:({field:P})=>i.jsx(gce,{id:"require-alt-ins",label:"Require proof of alternate insurance on opt-out",checked:P.value,onChange:P.onChange})}),p&&i.jsxs("div",{className:"p-4 bg-page rounded-lg space-y-3",children:[i.jsx("p",{className:"text-sm text-muted",children:"Collect the following from employees who opt out:"}),i.jsx(je,{name:"collectProvider",control:l,render:({field:P})=>i.jsx(qg,{label:"Provider Name",checked:P.value,onChange:P.onChange})}),i.jsx(je,{name:"collectStartDate",control:l,render:({field:P})=>i.jsx(qg,{label:"Policy Start Date",checked:P.value,onChange:P.onChange})}),i.jsx(je,{name:"collectEndDate",control:l,render:({field:P})=>i.jsx(qg,{label:"Policy End Date",checked:P.value,onChange:P.onChange})}),i.jsx(je,{name:"collectExtentOfCover",control:l,render:({field:P})=>i.jsx(qg,{label:"Extent of Cover (Sum Assured)",checked:P.value,onChange:P.onChange})})]})]})]})]})},j6=[{key:"Phone",label:"Phone",icon:cJ},{key:"Computer",label:"Computer / Laptop",icon:XK},{key:"Vehicle",label:"Vehicle",icon:RK},{key:"Sim",label:"SIM Card",icon:UK},{key:"IdCard",label:"Identity Card",icon:zK},{key:"Petrocard",label:"Petrocard",icon:kF},{key:"Tools",label:"Tools",icon:JK},{key:"Other",label:"Other Asset",icon:pC}],_ce=({assetType:n,...e})=>{switch(n){case"Phone":return i.jsx(wce,{...e});case"Computer":return i.jsx(jce,{...e});case"Vehicle":return i.jsx(Tce,{...e});case"Sim":return i.jsx(Sce,{...e});case"IdCard":return i.jsx(Nce,{...e});case"Petrocard":return i.jsx(Cce,{...e});case"Tools":return i.jsx(Pce,{...e});case"Other":return i.jsx(Mce,{...e});default:return null}},wce=({index:n,control:e})=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4",children:[i.jsx(je,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(Me,{label:"Brand",...t})}),i.jsx(je,{name:`assets.${n}.imei`,control:e,render:({field:t})=>i.jsx(Me,{label:"IMEI Number",...t})}),i.jsx(je,{name:`assets.${n}.color`,control:e,render:({field:t})=>i.jsx(Me,{label:"Colour",...t})}),i.jsx(je,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(je,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Charger",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Charger"}),i.jsx("option",{children:"Without Charger"})]})}),i.jsx(je,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Display Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(je,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Body Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(je,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(xt,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),Sce=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(je,{name:`assets.${n}.number`,control:e,render:({field:t})=>i.jsx(Me,{label:"SIM Number",...t})})}),jce=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(je,{name:`assets.${n}.computerType`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Type",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Laptop"}),i.jsx("option",{children:"Desktop"}),i.jsx("option",{children:"Tab"})]})}),i.jsx(je,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(Me,{label:"Brand",...t})}),i.jsx(je,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>i.jsx(Me,{label:"Serial Number",...t})}),i.jsx(je,{name:`assets.${n}.windowsKey`,control:e,render:({field:t})=>i.jsx(Me,{label:"Windows Key",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(je,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(je,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Charger",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Charger"}),i.jsx("option",{children:"Without Charger"})]})}),i.jsx(je,{name:`assets.${n}.bagStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Bag",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Bag"}),i.jsx("option",{children:"Without Bag"})]})}),i.jsx(je,{name:`assets.${n}.mouseStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Mouse",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Mouse"}),i.jsx("option",{children:"Without Mouse"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(je,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Display Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(je,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Body Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(je,{name:`assets.${n}.officeStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"MS Office",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Office"}),i.jsx("option",{children:"Without Office"})]})}),i.jsx(je,{name:`assets.${n}.antivirusStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Antivirus",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Antivirus"}),i.jsx("option",{children:"Without Antivirus"})]})})]}),i.jsx(je,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(xt,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),Nce=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(je,{name:`assets.${n}.issueDate`,control:e,render:({field:t})=>i.jsx(Nn,{label:"Date Issued",id:t.name,value:t.value,onChange:t.onChange})})}),Cce=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(je,{name:`assets.${n}.number`,control:e,render:({field:t})=>i.jsx(Me,{label:"Petrocard Number",...t})})}),Tce=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(je,{name:`assets.${n}.vehicleType`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Vehicle Type",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Bicycle"}),i.jsx("option",{children:"Two Wheeler"}),i.jsx("option",{children:"Three Wheeler"}),i.jsx("option",{children:"Four Wheeler"})]})}),i.jsx(je,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(Me,{label:"Brand",...t})}),i.jsx(je,{name:`assets.${n}.vehicleNumber`,control:e,render:({field:t})=>i.jsx(Me,{label:"Vehicle Number",...t})}),i.jsx(je,{name:`assets.${n}.chassisNumber`,control:e,render:({field:t})=>i.jsx(Me,{label:"Chassis Number",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(je,{name:`assets.${n}.dlNumber`,control:e,render:({field:t})=>i.jsx(Me,{label:"DL Number of User",...t})}),i.jsx(je,{name:`assets.${n}.kmsAtIssue`,control:e,render:({field:t})=>i.jsx(Me,{label:"Kms at issue",type:"number",...t})}),i.jsx(je,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(je,{name:`assets.${n}.finesStatus`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"Violations / Fines",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Existing"}),i.jsx("option",{children:"Nil"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(je,{name:`assets.${n}.insuranceValidity`,control:e,render:({field:t})=>i.jsx(Nn,{label:"Insurance Validity",id:t.name,value:t.value,onChange:t.onChange})}),i.jsx(je,{name:`assets.${n}.pollutionCertValidity`,control:e,render:({field:t})=>i.jsx(Nn,{label:"Pollution Cert. Validity",id:t.name,value:t.value,onChange:t.onChange})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(je,{name:`assets.${n}.dlFrontPic`,control:e,render:({field:t})=>i.jsx(xt,{label:"Picture of DL (Front)",file:t.value,onFileChange:t.onChange})}),i.jsx(je,{name:`assets.${n}.dlBackPic`,control:e,render:({field:t})=>i.jsx(xt,{label:"Picture of DL (Back)",file:t.value,onFileChange:t.onChange})}),i.jsx(je,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(xt,{label:"Picture of Vehicle",file:t.value,onFileChange:t.onChange})})]})]}),Pce=({index:n,control:e})=>{const{fields:t,append:r,remove:s}=ys({control:e,name:`assets.${n}.toolList`});return i.jsxs("div",{className:"space-y-4 pt-4",children:[t.map((a,o)=>i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("div",{className:"flex-1",children:i.jsx(je,{name:`assets.${n}.toolList.${o}.name`,control:e,render:({field:l})=>i.jsx(Me,{label:"Tool Name",...l})})}),i.jsx("div",{className:"flex-1",children:i.jsx(je,{name:`assets.${n}.toolList.${o}.description`,control:e,render:({field:l})=>i.jsx(Me,{label:"Description",...l})})}),i.jsx("div",{children:i.jsx(je,{name:`assets.${n}.toolList.${o}.quantity`,control:e,render:({field:l})=>i.jsx(Me,{label:"Quantity",type:"number",...l})})}),i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>s(o),children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})]},a.id)),i.jsxs(ae,{type:"button",variant:"outline",size:"sm",onClick:()=>r({id:`tool_${Date.now()}`,name:"",description:"",quantity:1}),children:[i.jsx(qt,{className:"mr-1 h-4 w-4"})," Add Tool"]}),i.jsx(je,{name:`assets.${n}.picture`,control:e,render:({field:a})=>i.jsx(xt,{label:"Picture of Tools",file:a.value,onFileChange:a.onChange})})]})},Mce=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(je,{name:`assets.${n}.name`,control:e,render:({field:t})=>i.jsx(Me,{label:"Asset Name",placeholder:"e.g. Printer",...t})}),i.jsx(je,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(Me,{label:"Brand",...t})}),i.jsx(je,{name:`assets.${n}.model`,control:e,render:({field:t})=>i.jsx(Me,{label:"Model No.",...t})}),i.jsx(je,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>i.jsx(Me,{label:"Serial Number",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(je,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Qe,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(je,{name:`assets.${n}.issueCondition`,control:e,render:({field:t})=>i.jsx(Me,{label:"Condition at time of issue",...t})})]}),i.jsx("div",{children:i.jsx(je,{name:`assets.${n}.accessories`,control:e,render:({field:t})=>i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Accessories List"}),i.jsx("textarea",{...t,rows:3,className:"form-input mt-1"})]})})}),i.jsx(je,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(xt,{label:"Picture of Asset",file:t.value,onFileChange:t.onChange})})]}),kce=({item:n,index:e,control:t,errors:r,remove:s})=>{const[a,o]=E.useState(()=>n.id.startsWith("new_")),l=j6.find(p=>p.key===n.type),c=l?.icon||pC,m=(p=>"brand"in p&&p.brand?`${p.brand} ${p.type}`:"number"in p&&p.number?`${p.type} - ${p.number}`:"name"in p&&p.name?p.name:"vehicleNumber"in p&&p.vehicleNumber?p.vehicleNumber:l?.label||"Asset")(n);return i.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[i.jsxs("div",{className:"flex items-center p-3",children:[i.jsxs("button",{type:"button",onClick:()=>o(!a),className:"flex items-center gap-3 flex-grow text-left",children:[i.jsx(c,{className:"h-5 w-5 text-muted flex-shrink-0"}),i.jsx("span",{className:"font-semibold text-primary-text",children:m})]}),i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>s(e),children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})}),i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>o(!a),children:i.jsx(xu,{className:`h-5 w-5 transform transition-transform ${a?"rotate-180":""}`})})]}),a&&i.jsx("div",{className:"p-4 border-t border-border",children:i.jsx(_ce,{assetType:n.type,index:e,control:t,errors:r})})]})},Ece=({site:n,initialAssets:e,onSave:t,onBack:r,setToast:s})=>{const[a,o]=E.useState(!1),[l,c]=E.useState(!1),d=E.useRef(null),{control:m,handleSubmit:p,reset:x,formState:{errors:v}}=Zt(),{fields:_,append:w,remove:j}=ys({control:m,name:"assets"});E.useEffect(()=>{x({assets:e})},[e,x]),E.useEffect(()=>{const I=M=>{d.current&&!d.current.contains(M.target)&&c(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]);const P=I=>{const M={id:`new_${I}_${Date.now()}`,type:I};let D;switch(I){case"Phone":D={...M,type:"Phone",brand:"",condition:"",chargerStatus:"",displayStatus:"",bodyStatus:"",imei:"",color:""};break;case"Sim":D={...M,type:"Sim",number:""};break;case"Computer":D={...M,type:"Computer",computerType:"",brand:"",condition:"",bagStatus:"",mouseStatus:"",chargerStatus:"",displayStatus:"",bodyStatus:"",serialNumber:"",windowsKey:"",officeStatus:"",antivirusStatus:""};break;case"IdCard":D={...M,type:"IdCard",issueDate:""};break;case"Petrocard":D={...M,type:"Petrocard",number:""};break;case"Vehicle":D={...M,type:"Vehicle",vehicleType:"",brand:"",dlNumber:"",condition:"",kmsAtIssue:null,vehicleNumber:"",chassisNumber:"",insuranceValidity:"",pollutionCertValidity:"",finesStatus:""};break;case"Tools":D={...M,type:"Tools",toolList:[]};break;case"Other":D={...M,type:"Other",name:"",brand:"",model:"",serialNumber:"",condition:"",issueCondition:"",accessories:""};break;default:return}w(D),c(!1)},k=async I=>{o(!0);try{await t(n.id,I.assets)}catch{}finally{o(!1)}};return i.jsxs("form",{onSubmit:p(k),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsxs(ae,{type:"button",onClick:r,variant:"outline",size:"sm",className:"mb-2",children:[i.jsx(Hi,{className:"mr-2 h-4 w-4"})," Back to List"]}),i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Assets for: ",n.shortName]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"relative",ref:d,children:[i.jsxs(ae,{type:"button",onClick:()=>c(!l),children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Asset"]}),l&&i.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-card border rounded-lg shadow-lg z-10",children:j6.map(I=>i.jsxs("button",{type:"button",className:"w-full text-left px-4 py-2 text-sm hover:bg-page flex items-center gap-3",onClick:()=>P(I.key),children:[i.jsx(I.icon,{className:"h-4 w-4 text-muted"}),i.jsx("span",{children:I.label})]},I.key))})]}),i.jsxs(ae,{type:"submit",isLoading:a,children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),i.jsx("div",{className:"space-y-4",children:_.length>0?_.map((I,M)=>i.jsx(kce,{item:I,index:M,control:m,errors:v,remove:j},I.id)):i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No assets found for this site. Click "Add Asset" to begin.'})})]})},Dce=({sites:n,allAssets:e,searchTerm:t,setSearchTerm:r,onViewDetails:s})=>{const a=(o=[])=>{if(!o||o.length===0)return"No assets assigned.";const l=o.reduce((c,d)=>(c[d.type]=(c[d.type]||0)+1,c),{});return Object.entries(l).map(([c,d])=>`${d} ${c}(s)`).join(", ")};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Asset Overview"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx(Me,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>r(o.target.value)})]})]}),i.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Asset Summary"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),i.jsx("td",{className:"px-4 py-3 text-muted",children:a(e[o.id])}),i.jsx("td",{className:"px-4 py-3",children:i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>s(o.id),title:"View Details",children:i.jsx(bl,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},Oce=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState(null),[s,a]=E.useState([]),[o,l]=E.useState({}),[c,d]=E.useState(!0),[m,p]=E.useState(""),[x,v]=E.useState(null);E.useEffect(()=>{d(!0),Promise.all([pe.getOrganizations(),pe.getAllSiteAssets()]).then(([P,k])=>{a(P.sort((I,M)=>I.shortName.localeCompare(M.shortName))),l(k)}).catch(()=>v({message:"Failed to load asset configuration.",type:"error"})).finally(()=>d(!1))},[]);const _=async(P,k)=>{try{await pe.updateSiteAssets(P,k),l(I=>({...I,[P]:k})),v({message:"Assets saved successfully.",type:"success"})}catch(I){throw v({message:"Failed to save assets.",type:"error"}),I}},w=P=>{r(P),e("detail")},j=E.useMemo(()=>m?s.filter(P=>P.shortName.toLowerCase().includes(m.toLowerCase())):s,[s,m]);return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{children:[x&&i.jsx(Gt,{message:x.message,type:x.type,onDismiss:()=>v(null)}),n==="detail"&&t?i.jsx(Ece,{site:s.find(P=>P.id===t),initialAssets:o[t]||[],onSave:_,onBack:()=>e("list"),setToast:v}):i.jsx(Dce,{sites:j,allAssets:o,searchTerm:m,setSearchTerm:p,onViewDetails:w})]})},Ice=({control:n,index:e,remove:t,masterTools:r})=>{const[s,a]=E.useState(!0),o=nu({control:n,name:`tools.${e}.department`}),l=nu({control:n,name:`tools.${e}.name`}),c=o?r[o]||[]:[],d=l||"New Tool",m=o||"Select a department";return i.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[i.jsxs("div",{className:"flex items-center p-3",children:[i.jsxs("button",{type:"button",onClick:()=>a(!s),className:"flex items-center gap-3 flex-grow text-left",children:[i.jsx(YF,{className:"h-5 w-5 text-muted flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold text-primary-text",children:d}),i.jsx("p",{className:"text-sm text-muted",children:m})]})]}),i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>t(e),children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})}),i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>a(!s),children:i.jsx(xu,{className:`h-5 w-5 transform transition-transform ${s?"rotate-180":""}`})})]}),s&&i.jsxs("div",{className:"p-4 border-t border-border space-y-4 animate-fade-in-down",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(je,{name:`tools.${e}.department`,control:n,render:({field:p})=>i.jsxs(Qe,{label:"Department",...p,children:[i.jsx("option",{value:"",children:"Select Department"}),Object.keys(r).map(x=>i.jsx("option",{value:x,children:x},x))]})}),i.jsx(je,{name:`tools.${e}.name`,control:n,render:({field:p})=>i.jsxs(Qe,{label:"Tool Name",...p,disabled:!o,children:[i.jsx("option",{value:"",children:"Select Tool"}),c.map(x=>i.jsx("option",{value:x.name,children:x.name},x.id))]})}),i.jsx(je,{name:`tools.${e}.quantity`,control:n,render:({field:p})=>i.jsx(Me,{label:"Quantity",type:"number",...p})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(je,{name:`tools.${e}.picture`,control:n,render:({field:p})=>i.jsx(xt,{label:"Picture of Tool",file:p.value,onFileChange:p.onChange})}),i.jsx(je,{name:`tools.${e}.inwardDcCopy`,control:n,render:({field:p})=>i.jsx(xt,{label:"Inward DC Copy",file:p.value,onFileChange:p.onChange})}),i.jsx(je,{name:`tools.${e}.deliveryCopy`,control:n,render:({field:p})=>i.jsx(xt,{label:"Delivery Copy",file:p.value,onFileChange:p.onChange})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end",children:[i.jsx(je,{name:`tools.${e}.invoiceCopy`,control:n,render:({field:p})=>i.jsx(xt,{label:"Invoice",file:p.value,onFileChange:p.onChange})}),i.jsx(je,{name:`tools.${e}.signedReceipt`,control:n,render:({field:p})=>i.jsx(xt,{label:"Signed Receipt",file:p.value,onFileChange:p.onChange})}),i.jsx(je,{name:`tools.${e}.receiverName`,control:n,render:({field:p})=>i.jsx(Me,{label:"Receiver's Name",...p})})]})]})]})},Ace=({site:n,initialTools:e,masterTools:t,onSave:r,onBack:s})=>{const[a,o]=E.useState(!1),{control:l,handleSubmit:c,reset:d}=Zt(),{fields:m,append:p,remove:x}=ys({control:l,name:"tools"});E.useEffect(()=>{d({tools:e})},[e,d]);const v=()=>{p({id:`new_tool_${Date.now()}`,department:"",name:"",quantity:1})},_=async w=>{o(!0);try{await r(n.id,w.tools)}finally{o(!1)}};return i.jsxs("form",{onSubmit:c(_),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsxs(ae,{type:"button",onClick:s,variant:"outline",size:"sm",className:"mb-2",children:[i.jsx(Hi,{className:"mr-2 h-4 w-4"})," Back to List"]}),i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Tools for: ",n.shortName]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(ae,{type:"button",onClick:v,children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Tool"]}),i.jsxs(ae,{type:"submit",isLoading:a,children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),i.jsx("div",{className:"space-y-4",children:m.length>0?m.map((w,j)=>i.jsx(Ice,{control:l,index:j,remove:x,masterTools:t},w.id)):i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No tools found for this site. Click "Add Tool" to begin.'})})]})},Rce=({sites:n,allIssuedTools:e,searchTerm:t,setSearchTerm:r,onViewDetails:s})=>{const a=(o=[])=>{if(!o||o.length===0)return"No tools issued.";const l=o.reduce((d,m)=>d+(m.quantity||0),0),c=new Set(o.map(d=>d.department)).size;return`${l} tools issued across ${c} department${c>1?"s":""}.`};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Site Tools Overview"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx(Me,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>r(o.target.value)})]})]}),i.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Tools Summary"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),i.jsx("td",{className:"px-4 py-3 text-muted",children:a(e[o.id])}),i.jsx("td",{className:"px-4 py-3",children:i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>s(o.id),title:"View Details",children:i.jsx(bl,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},Lce=()=>{const[n,e]=E.useState(null),[t,r]=E.useState([]),[s,a]=E.useState({}),[o,l]=E.useState({}),[c,d]=E.useState(!0),[m,p]=E.useState(""),[x,v]=E.useState(null);E.useEffect(()=>{d(!0),Promise.all([pe.getOrganizations(),pe.getAllSiteIssuedTools(),pe.getToolsList()]).then(([j,P,k])=>{r(j.sort((I,M)=>I.shortName.localeCompare(M.shortName))),a(P),l(k)}).catch(()=>v({message:"Failed to load initial configuration.",type:"error"})).finally(()=>d(!1))},[]);const _=async(j,P)=>{try{await pe.updateSiteIssuedTools(j,P),a(k=>({...k,[j]:P})),v({message:"Tools list saved successfully.",type:"success"})}catch(k){throw v({message:"Failed to save tools list.",type:"error"}),k}},w=E.useMemo(()=>m?t.filter(j=>j.shortName.toLowerCase().includes(m.toLowerCase())):t,[t,m]);return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{children:[x&&i.jsx(Gt,{message:x.message,type:x.type,onDismiss:()=>v(null)}),n?i.jsx(Ace,{site:t.find(j=>j.id===n),initialTools:s[n]||[],masterTools:o,onSave:_,onBack:()=>e(null)}):i.jsx(Rce,{sites:w,allIssuedTools:s,searchTerm:m,setSearchTerm:p,onViewDetails:e})]})},Fce=()=>i.jsx(sd,{title:"Attendance Format"}),qce=()=>i.jsx(sd,{title:"Attendance Overview"}),zce=()=>i.jsx(sd,{title:"Daily Attendance Summary"}),Uce=()=>i.jsx(sd,{title:"Notification & Mail Configuration"}),Vce=()=>i.jsx(sd,{title:"Onboarding Rejection Reasons"}),Bce=()=>i.jsx(sd,{title:"Salary Breakup"}),Wce=()=>i.jsx(sd,{title:"Salary Line Item"}),_L=(n,e)=>{const t=e.join(","),r=n.map(s=>e.map(a=>{const o=s[a]===null||s[a]===void 0?"":String(s[a]);return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...r].join(`
`)},wL=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,"")),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),a[l]=d}),r.push(a)}return r},wj=["GroupId","GroupName","CompanyId","CompanyName","EntityId","EntityName","organizationId","Location","RegisteredAddress","RegistrationType","RegistrationNumber","GSTNumber","PANNumber","Email","EShramNumber","ShopAndEstablishmentCode","EPFOCode","ESICCode","PSARALicenseNumber","PSARAValidTill"],Sj=["organizationId","organizationName","location","entityId","billingName","registeredAddress","gstNumber","panNumber","email1","email2","email3","eShramNumber","shopAndEstablishmentCode","keyAccountManager","siteAreaSqFt","projectType","apartmentCount","agreementDetails","siteOperations"],SL=(n,e)=>{const t=new Blob([n],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(t),r.setAttribute("download",e),document.body.appendChild(r),r.click(),document.body.removeChild(r)},$ce=({isOpen:n,onClose:e,onSave:t,title:r,label:s,initialName:a=""})=>{const[o,l]=E.useState(a),[c,d]=E.useState("");E.useEffect(()=>{n&&l(a)},[n,a]);const m=()=>{if(!o.trim()){d("Name cannot be empty.");return}t(o),e()};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4",onClick:p=>p.stopPropagation(),children:[i.jsx("h3",{className:"text-lg font-bold",children:r}),i.jsx("div",{className:"mt-4",children:i.jsx(Me,{label:s,id:"name-input",value:o,onChange:p=>{l(p.target.value),d("")},error:c})}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ae,{onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ae,{onClick:m,children:"Save"})]})]})}):null},jj=[{key:"client_structure",label:"Client Structure",icon:MF},{key:"site_configuration",label:"Site Configuration",icon:vm},{key:"costing_resource",label:"Costing & Resource",icon:EK},{key:"backoffice_heads",label:"Back Office & ID Series",icon:mi},{key:"staff_designation",label:"Staff Designation",icon:CK},{key:"gmc_policy",label:"GMC Policy",icon:fC},{key:"asset",label:"Asset Management",icon:SK},{key:"tools_list",label:"Tools List",icon:YF},{key:"attendance_format",label:"Attendance Format",icon:AK},{key:"attendance_overview",label:"Attendance Overview",icon:PK},{key:"notification_template",label:"Notification & Mail",icon:yu},{key:"onboard_reject_reason",label:"Onboarding Rejection Reasons",icon:xx},{key:"salary_template",label:"Salary Breakup",icon:_l},{key:"salary_line_item",label:"Salary Line Item",icon:_l}],Hce=()=>{const[n,e]=E.useState([]),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(!0),[c,d]=E.useState(null),[m,p]=E.useState({}),[x,v]=E.useState("client_structure"),_=E.useRef(null),[w,j]=E.useState(""),[P,k]=E.useState(null),[I,M]=E.useState(!1),D=Jt("(max-width: 767px)"),[O,q]=E.useState({isOpen:!1,initialData:null,companyName:""}),[F,U]=E.useState({isOpen:!1,mode:"add",type:"group",title:"",label:""}),[B,G]=E.useState({isOpen:!1,type:"group",id:"",name:""}),[X,Q]=E.useState({isOpen:!1,org:null}),Y=E.useMemo(()=>n.flatMap(fe=>fe.companies.flatMap(ue=>ue.entities.map(ce=>({...ce,companyName:ue.name})))),[n]);E.useEffect(()=>{(async()=>{l(!0);try{const[ue,ce,Se]=await Promise.all([pe.getOrganizationStructure(),pe.getOrganizations(),pe.getSiteConfigurations()]);e(ue),r(ce),a(Se)}catch{d({message:"Failed to load data.",type:"error"})}finally{l(!1)}})()},[]);const ne=E.useMemo(()=>{if(!w.trim())return n;const fe=w.toLowerCase();return n.map(ue=>{if(ue.name.toLowerCase().includes(fe))return ue;const ce=ue.companies.map(Se=>{if(Se.name.toLowerCase().includes(fe))return Se;const ye=Se.entities.filter(Ne=>Ne.name.toLowerCase().includes(fe));return ye.length>0?{...Se,entities:ye}:null}).filter(Boolean);return ce.length>0?{...ue,companies:ce}:null}).filter(Boolean)},[n,w]),te=E.useMemo(()=>{if(!w.trim())return t;const fe=w.toLowerCase();return t.filter(ue=>ue.shortName.toLowerCase().includes(fe))},[t,w]),ie=fe=>p(ue=>({...ue,[fe]:!ue[fe]})),$=()=>{d({message:"All changes saved successfully (mocked).",type:"success"})},H=fe=>q({isOpen:!0,initialData:null,companyName:fe}),se=(fe,ue)=>q({isOpen:!0,initialData:fe,companyName:ue}),W=fe=>{d({message:fe.id.startsWith("new_")?"Client added.":"Client updated.",type:"success"}),q({isOpen:!1,initialData:null,companyName:""})},ee=(fe,ue,ce)=>G({isOpen:!0,type:fe,id:ue,name:ce}),K=()=>{const{type:fe,id:ue,name:ce}=B;fe==="group"?e(Se=>Se.filter(ye=>ye.id!==ue)):fe==="company"?e(Se=>Se.map(ye=>({...ye,companies:ye.companies.filter(Ne=>Ne.id!==ue)}))):fe==="client"&&e(Se=>Se.map(ye=>({...ye,companies:ye.companies.map(Ne=>({...Ne,entities:Ne.entities.filter(ke=>ke.id!==ue)}))}))),d({message:`${fe.charAt(0).toUpperCase()+fe.slice(1)} '${ce}' deleted.`,type:"success"}),G({isOpen:!1,type:"group",id:"",name:""})},oe=fe=>{const{mode:ue,type:ce,id:Se,groupId:ye}=F;if(ue==="add"){if(ce==="group"){const Ne={id:`group_${Date.now()}`,name:fe,locations:[],companies:[]};e(ke=>[...ke,Ne]),d({message:`Group '${fe}' added.`,type:"success"})}else if(ce==="company"&&ye){const Ne={id:`comp_${Date.now()}`,name:fe,entities:[]};e(ke=>ke.map(qe=>qe.id===ye?{...qe,companies:[...qe.companies,Ne]}:qe)),d({message:`Company '${fe}' added.`,type:"success"})}}else ce==="group"&&Se?(e(Ne=>Ne.map(ke=>ke.id===Se?{...ke,name:fe}:ke)),d({message:"Group updated.",type:"success"})):ce==="company"&&Se&&ye&&(e(Ne=>Ne.map(ke=>ke.id===ye?{...ke,companies:ke.companies.map(qe=>qe.id===Se?{...qe,name:fe}:qe)}:ke)),d({message:"Company updated.",type:"success"}));U({isOpen:!1,mode:"add",type:"group",title:"",label:""})},re=()=>{let fe,ue,ce;if(x==="client_structure"){ce=wj;const Se=n.flatMap(ye=>ye.companies.flatMap(Ne=>Ne.entities.map(ke=>({GroupId:ye.id,GroupName:ye.name,CompanyId:Ne.id,CompanyName:Ne.name,EntityId:ke.id,EntityName:ke.name,organizationId:ke.organizationId||"",Location:ke.location||"",RegisteredAddress:ke.registeredAddress||"",RegistrationType:ke.registrationType||"",RegistrationNumber:ke.registrationNumber||"",GSTNumber:ke.gstNumber||"",PANNumber:ke.panNumber||"",Email:ke.email||"",EShramNumber:ke.eShramNumber||"",ShopAndEstablishmentCode:ke.shopAndEstablishmentCode||"",EPFOCode:ke.epfoCode||"",ESICCode:ke.esicCode||"",PSARALicenseNumber:ke.psaraLicenseNumber||"",PSARAValidTill:ke.psaraValidTill||""}))));fe=_L(Se,ce),ue="client_structure_export.csv"}else if(x==="site_configuration"){ce=Sj;const Se=t.map(ye=>{const Ne=s.find(ke=>ke.organizationId===ye.id);return{organizationId:ye.id,organizationName:ye.shortName,...Ne||{},agreementDetails:JSON.stringify(Ne?.agreementDetails||{}),siteOperations:JSON.stringify(Ne?.siteOperations||{})}});fe=_L(Se,ce),ue="site_configuration_export.csv"}else{d({message:"Export not implemented for this view.",type:"error"});return}SL(fe,ue),d({message:"Data exported successfully.",type:"success"})},me=()=>{let fe,ue;if(x==="client_structure")fe=wj,ue="client_structure_template.csv";else if(x==="site_configuration")fe=Sj,ue="site_configuration_template.csv";else{d({message:"Template not available for this view.",type:"error"});return}SL(fe.join(","),ue)},_e=fe=>{const ue=fe.target.files?.[0];if(!ue)return;const ce=new FileReader;ce.onload=Se=>{try{const ye=Se.target?.result;if(!ye)throw new Error("File is empty.");const Ne=ye.trim().replace(/\r/g,"").split(`
`);if(Ne.length<1)throw new Error("CSV file is empty.");const ke=Ne[0].split(",").map(qe=>qe.trim().replace(/"/g,""));if(x==="client_structure"){if(ke.join(",")!==wj.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const qe=wL(ye);if(qe.length===0)throw new Error("No data rows found.");const ze=new Map;for(const Be of qe){ze.has(Be.GroupId)||ze.set(Be.GroupId,{group:{id:Be.GroupId,name:Be.GroupName,locations:[],companies:[]},companiesMap:new Map});const de=ze.get(Be.GroupId);de.companiesMap.has(Be.CompanyId)||de.companiesMap.set(Be.CompanyId,{id:Be.CompanyId,name:Be.CompanyName,entities:[]});const xe=de.companiesMap.get(Be.CompanyId),Pe={id:Be.EntityId,name:Be.EntityName,organizationId:Be.organizationId,location:Be.Location,registeredAddress:Be.RegisteredAddress,registrationType:Be.RegistrationType||"",registrationNumber:Be.RegistrationNumber,gstNumber:Be.GSTNumber,panNumber:Be.PANNumber,email:Be.Email,eShramNumber:Be.EShramNumber,shopAndEstablishmentCode:Be.ShopAndEstablishmentCode,epfoCode:Be.EPFOCode,esicCode:Be.ESICCode,psaraLicenseNumber:Be.PSARALicenseNumber,psaraValidTill:Be.PSARAValidTill};xe.entities.push(Pe)}const He=Array.from(ze.values()).map(Be=>(Be.group.companies=Array.from(Be.companiesMap.values()),Be.group));e(He),d({message:`Successfully imported ${qe.length} client records.`,type:"success"})}else if(x==="site_configuration"){if(ke.join(",")!==Sj.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const qe=wL(ye);if(qe.length===0)throw new Error("No data rows found.");const ze=qe.map(He=>{const Be={};for(const de of Object.keys(He))if(de==="agreementDetails"||de==="siteOperations")try{Be[de]=JSON.parse(He[de])}catch{console.warn(`Could not parse JSON for ${de} in row for site ${He.organizationId}`),Be[de]={}}else Be[de]=He[de];return Be});a(He=>{const Be=[...He];return ze.forEach(de=>{const xe=Be.findIndex(Pe=>Pe.organizationId===de.organizationId);xe>-1?Be[xe]=de:Be.push(de)}),Be}),d({message:`Successfully imported ${ze.length} site configurations.`,type:"success"})}else d({message:"Import not implemented for this view.",type:"error"})}catch(ye){d({message:ye.message||"Failed to import CSV.",type:"error"})}finally{fe.target&&(fe.target.value="")}},ce.readAsText(ue)},le=()=>{switch(x){case"client_structure":return i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsxs(ae,{onClick:()=>U({isOpen:!0,mode:"add",type:"group",title:"Add New Group",label:"Group Name"}),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(qt,{className:"mr-2 h-4"}),"Add Group"]}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ae,{type:"button",variant:"outline",onClick:me,className:"hover:bg-gray-100",children:[i.jsx(Vs,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>_.current?.click(),className:"hover:bg-gray-100",children:[i.jsx(Bc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:re,className:"hover:bg-gray-100",children:[i.jsx(hi,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),i.jsx("div",{className:"space-y-2",children:ne.map(ue=>i.jsxs("div",{className:"border-b border-border",children:[i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>ie(ue.id),children:i.jsx(Tf,{className:`h-5 w-5 transition-transform ${m[ue.id]?"rotate-90":""}`})}),i.jsx(Uc,{className:"h-5 w-5 text-muted"}),i.jsx("span",{className:"font-semibold",children:ue.name})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ae,{size:"sm",className:"!p-1.5",onClick:()=>U({isOpen:!0,mode:"add",type:"company",groupId:ue.id,title:`Add Company to ${ue.name}`,label:"Company Name"}),title:"Add Company",children:i.jsx(qt,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>U({isOpen:!0,mode:"edit",type:"group",id:ue.id,initialName:ue.name,title:"Edit Group Name",label:"Group Name"}),title:"Edit group name",children:i.jsx(xr,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>ee("group",ue.id,ue.name),title:"Delete group",children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})]})]}),m[ue.id]&&i.jsx("div",{className:"pl-6 pr-3 pb-3 space-y-2",children:ue.companies.map(ce=>i.jsxs("div",{className:"border border-border rounded-lg",children:[i.jsxs("div",{className:"p-2 flex items-center justify-between bg-card",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>ie(ce.id),children:i.jsx(Tf,{className:`h-5 w-5 transition-transform ${m[ce.id]?"rotate-90":""}`})}),i.jsxs("span",{children:[ce.name," (",ce.entities.length," clients)"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ae,{variant:"icon",size:"sm",title:`View ${ce.entities.length} clients`,onClick:()=>k({companyName:ce.name,clients:ce.entities}),children:i.jsx(bl,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>H(ce.name),title:"Add client",children:i.jsx(qt,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>U({isOpen:!0,mode:"edit",type:"company",id:ce.id,groupId:ue.id,initialName:ce.name,title:"Edit Company Name",label:"Company Name"}),title:"Edit company name",children:i.jsx(xr,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>ee("company",ce.id,ce.name),title:"Delete company",children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})]})]}),m[ce.id]&&i.jsx("div",{className:"p-2",children:ce.entities.map(Se=>i.jsxs("div",{className:"p-2 flex items-center justify-between hover:bg-page rounded",children:[i.jsx("span",{children:Se.name}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>se(Se,ce.name),children:i.jsx(xr,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>ee("client",Se.id,Se.name),children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})]})]},Se.id))})]},ce.id))})]},ue.id))})]});case"site_configuration":return i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Sites Configuration"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ae,{type:"button",variant:"outline",onClick:me,children:[i.jsx(Vs,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>_.current?.click(),children:[i.jsx(Bc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ae,{type:"button",variant:"outline",onClick:re,children:[i.jsx(hi,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Configuration Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:te.map(ue=>{const ce=s.find(ye=>ye.organizationId===ue.id),Se=!!ce&&(!!ce.billingName||!!ce.keyAccountManager);return i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Uc,{className:"h-5 w-5 text-muted"}),i.jsx("span",{children:ue.shortName})]})}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:Se?i.jsxs("span",{className:"flex items-center text-green-600",children:[i.jsx(Bi,{className:"h-4 w-4 mr-1"})," Complete"]}):i.jsxs("span",{className:"flex items-center text-yellow-600",children:[i.jsx(TF,{className:"h-4 w-4 mr-1"})," Incomplete"]})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs(ae,{size:"sm",variant:"outline",onClick:()=>Q({isOpen:!0,org:ue}),children:[i.jsx(bl,{className:"mr-2 h-4 w-4"})," View / Edit"]})})]},ue.id)})})]})})]});case"costing_resource":return i.jsx(cce,{});case"backoffice_heads":return i.jsx(fce,{});case"staff_designation":return i.jsx(pce,{});case"gmc_policy":return i.jsx(bce,{});case"asset":return i.jsx(Oce,{});case"tools_list":return i.jsx(Lce,{});case"attendance_format":return i.jsx(Fce,{});case"attendance_overview":return i.jsx(qce,{});case"daily_attendance":return i.jsx(zce,{});case"notification_template":return i.jsx(Uce,{});case"onboard_reject_reason":return i.jsx(Vce,{});case"salary_template":return i.jsx(Bce,{});case"salary_line_item":return i.jsx(Wce,{});default:const fe=jj.find(ue=>ue.key===x);return i.jsx(sd,{title:fe?.label||"Configuration"})}};return i.jsxs("div",{className:"p-4 space-y-6",children:[c&&i.jsx(Gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsx(ace,{isOpen:I,onClose:()=>M(!1)}),O.isOpen&&i.jsx(ice,{...O,onClose:()=>q(fe=>({...fe,isOpen:!1})),onSave:W}),i.jsx($ce,{isOpen:F.isOpen,onClose:()=>U({isOpen:!1,mode:"add",type:"group",title:"",label:""}),onSave:oe,title:F.title,label:F.label,initialName:F.initialName}),i.jsxs(tr,{isOpen:B.isOpen,onClose:()=>G(fe=>({...fe,isOpen:!1})),onConfirm:K,title:"Confirm Deletion",children:["Are you sure you want to delete the ",B.type,' "',B.name,'"? This action cannot be undone.']}),X.isOpen&&X.org&&i.jsx(E5,{isOpen:X.isOpen,onClose:()=>Q({isOpen:!1,org:null}),onSave:()=>{},organization:X.org,allClients:Y,initialData:s.find(fe=>fe.organizationId===X.org?.id)}),P&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",onClick:()=>k(null),children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 animate-fade-in-scale",onClick:fe=>fe.stopPropagation(),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text mb-4",children:["Clients in ",P.companyName]}),P.clients.length>0?i.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:P.clients.map(fe=>i.jsx("li",{className:"text-sm p-2 bg-page rounded-md",children:fe.name},fe.id))}):i.jsx("p",{className:"text-muted text-center py-4",children:"No clients found for this company."}),i.jsx("div",{className:"mt-6 text-right",children:i.jsx(ae,{onClick:()=>k(null),variant:"secondary",children:"Close"})})]})}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Client Management"}),!D&&i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ae,{variant:"outline",onClick:()=>M(!0),className:"hover:bg-gray-100",children:[i.jsx(Ck,{className:"mr-2 h-4 w-4"})," Help"]}),i.jsx("input",{type:"file",ref:_,className:"hidden",accept:".csv",onChange:_e}),i.jsxs(ae,{onClick:$,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save All Changes"]})]})]}),D&&i.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[i.jsxs(ae,{onClick:$,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save All Changes"]}),i.jsxs(ae,{variant:"outline",onClick:()=>M(!0),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(Ck,{className:"mr-2 h-4 w-4"})," Help"]}),i.jsx("input",{type:"file",ref:_,className:"hidden",accept:".csv",onChange:_e})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx("input",{type:"text",placeholder:"Search across all clients and sites...",value:w,onChange:fe=>j(fe.target.value),className:"form-input pl-10 w-full"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx("nav",{className:"md:col-span-1",children:D?i.jsx(Qe,{label:"Configuration Section",id:"hr-config-select",value:x,onChange:fe=>v(fe.target.value),children:jj.map(fe=>i.jsx("option",{value:fe.key,children:fe.label},fe.key))}):i.jsx("div",{className:"space-y-1",children:jj.map(fe=>i.jsxs("button",{onClick:()=>v(fe.key),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg text-left transition-colors ${x===fe.key?"text-white":"text-muted hover:bg-accent-light hover:text-accent-dark"}`,style:x===fe.key?{backgroundColor:"#006B3F"}:{},children:[i.jsx(fe.icon,{className:"h-5 w-5"}),i.jsx("span",{children:fe.label})]},fe.key))})}),i.jsx("main",{className:"md:col-span-3",children:o?i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent mx-auto mt-16"}):le()})]})]})},Yce=({isOpen:n,onSave:e,onClose:t,initialData:r})=>{const[s,a]=E.useState(r?.name||""),[o,l]=E.useState(r?.description||""),[c,d]=E.useState(!1);E.useEffect(()=>{n&&(a(r?.name||""),l(r?.description||""),d(!1))},[n,r]);const m=async p=>{if(p&&p.preventDefault(),!!s.trim()){d(!0);try{await e({name:s.trim(),description:o.trim()})}catch(x){console.error("Error saving policy:",x),d(!1)}}};return i.jsx(tr,{isOpen:n,onClose:t,onConfirm:m,title:`${r?"Edit":"Add"} Policy`,confirmButtonText:"Save Policy",isLoading:c,children:i.jsxs("form",{onSubmit:m,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"policy-name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"policy-name",value:s,onChange:p=>a(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"policy-description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"policy-description",value:o,onChange:p=>l(p.target.value),placeholder:"Description",className:"form-input",rows:3,disabled:c})]})]})})},Gce=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState(null),[c,d]=E.useState(null),m=E.useRef(!0);E.useEffect(()=>(m.current=!0,()=>{m.current=!1}),[]);const p=E.useCallback(async()=>{r(!0);try{const w=await pe.getPolicies();m.current&&e(w)}catch(w){console.error("Error fetching policies:",w),m.current&&d({message:"Failed to fetch policies.",type:"error"})}finally{m.current&&r(!1)}},[]);E.useEffect(()=>{p()},[p]);const x=async w=>{try{o?d({message:"Policy updated.",type:"success"}):(await pe.createPolicy(w),m.current&&d({message:"Policy created successfully!",type:"success"})),m.current&&(a(!1),l(null),p())}catch(j){throw console.error("Error saving policy:",j),m.current&&d({message:"Failed to save policy. Please try again.",type:"error"}),j}},v=()=>{l(null),a(!0)},_=w=>{l(w),a(!0)};return i.jsxs("div",{children:[c&&i.jsx(Gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsx(Yce,{isOpen:s,onSave:x,onClose:()=>{a(!1),l(null)},initialData:o}),i.jsx(Yi,{title:"Policy Management",children:i.jsxs(ae,{onClick:v,children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Policy"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Description"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):n.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:'No policies found. Click "Add Policy" to create one.'})}):n.map(w=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Policy Name",className:"px-6 py-4 font-medium",children:w.name}),i.jsx("td",{"data-label":"Description",className:"px-6 py-4 text-sm text-muted",children:w.description||""}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>_(w),children:i.jsx(xr,{className:"h-4 w-4"})})})})]},w.id))})]})})]})},Zce=wt({type:be().oneOf(["GMC","GPA","WCA","Other"]).required("Type is required"),provider:be().required("Provider is required"),policyNumber:be().required("Policy number is required"),validTill:be().required("Valid till date is required")}).defined(),Kce=({onSave:n,onClose:e,initialData:t})=>{const{register:r,handleSubmit:s,control:a,formState:{errors:o},reset:l}=Zt({resolver:_n(Zce)});E.useEffect(()=>{l(t||{type:"GMC",provider:"",policyNumber:"",validTill:""})},[t,l]);const c=d=>{n(d)};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4",onClick:d=>d.stopPropagation(),children:i.jsxs("form",{onSubmit:s(c),children:[i.jsxs("h3",{className:"text-lg font-bold mb-4",children:[t?"Edit":"Add"," Insurance"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(Qe,{label:"Insurance Type",id:"type",registration:r("type"),error:o.type?.message,children:[i.jsx("option",{children:"GMC"}),i.jsx("option",{children:"GPA"}),i.jsx("option",{children:"WCA"}),i.jsx("option",{children:"Other"})]}),i.jsx(Me,{label:"Provider",id:"provider",registration:r("provider"),error:o.provider?.message}),i.jsx(Me,{label:"Policy Number",id:"policyNumber",registration:r("policyNumber"),error:o.policyNumber?.message}),i.jsx(je,{name:"validTill",control:a,render:({field:d})=>i.jsx(Nn,{label:"Valid Till",id:"validTill",value:d.value,onChange:d.onChange,error:o.validTill?.message})})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[i.jsx(ae,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(ae,{type:"submit",children:"Save Insurance"})]})]})})})},Jce=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState(null),[c,d]=E.useState(null),m=E.useCallback(async()=>{r(!0);try{const x=await pe.getInsurances();e(x)}catch{d({message:"Failed to fetch insurance policies.",type:"error"})}finally{r(!1)}},[]);E.useEffect(()=>{m()},[m]);const p=async x=>{try{o||(await pe.createInsurance(x),d({message:"Insurance created.",type:"success"})),a(!1),m()}catch{d({message:"Failed to save insurance.",type:"error"})}};return i.jsxs("div",{children:[c&&i.jsx(Gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),s&&i.jsx(Kce,{onSave:p,onClose:()=>a(!1),initialData:o}),i.jsx(Yi,{title:"Insurance Management",children:i.jsxs(ae,{onClick:()=>{l(null),a(!0)},children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Insurance"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Provider"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Number"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Valid Till"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:5,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):n.map(x=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Type",className:"px-6 py-4 font-medium",children:x.type}),i.jsx("td",{"data-label":"Provider",className:"px-6 py-4 text-sm text-muted",children:x.provider}),i.jsx("td",{"data-label":"Policy Number",className:"px-6 py-4 text-sm text-muted",children:x.policyNumber}),i.jsx("td",{"data-label":"Valid Till",className:"px-6 py-4 text-sm text-muted",children:x.validTill}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>{l(x),a(!0)},children:i.jsx(xr,{className:"h-4 w-4"})})})})]},x.id))})]})})]})},Qce=()=>{const[n,e]=E.useState("policies");return i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Policies & Insurance"})}),i.jsx("div",{children:i.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[i.jsxs("button",{onClick:()=>e("policies"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="policies"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[i.jsx(Vs,{className:"h-5 w-5"}),i.jsx("span",{children:"Company Policies"})]}),i.jsxs("button",{onClick:()=>e("insurance"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="insurance"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[i.jsx(UF,{className:"h-5 w-5"}),i.jsx("span",{children:"Insurance Plans"})]})]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[n==="policies"&&i.jsx(Gce,{}),n==="insurance"&&i.jsx(Jce,{})]})]})},zg={documents:{aadhaar:!1,pan:!1,bankProof:!1,educationCertificate:!1,salarySlip:!1,uanProof:!1,familyAadhaar:!1},verifications:{requireBengaluruAddress:!1,requireDobVerification:!1}},Xce=()=>{const n=Zc(),[e,t]=E.useState(null),[r,s]=E.useState([]),[a,o]=E.useState("Administrator");E.useEffect(()=>{pe.getSiteStaffDesignations().then(k=>{const I=[...new Set(k.map(M=>M.designation))];I.includes("Administrator")||I.unshift("Administrator"),s(I.map((M,D)=>({id:`${D}`,designation:M,department:"",permanentId:"",temporaryId:""})))})},[]);const{register:l,handleSubmit:c,control:d,formState:{isDirty:m},watch:p,reset:x,setValue:v}=Zt({defaultValues:n});E.useEffect(()=>{x(n)},[n,x]),E.useEffect(()=>{n.rulesByDesignation?.[a]||(Object.keys(zg.documents).forEach(I=>{v(`rulesByDesignation.${a}.documents.${I}`,!0,{shouldDirty:!0})}),Object.keys(zg.verifications).forEach(I=>{v(`rulesByDesignation.${a}.verifications.${I}`,!0,{shouldDirty:!0})}))},[a,n.rulesByDesignation,v]);const _=p("enforceManpowerLimit"),w=p("enableEsiRule"),j=p("enableGmcRule"),P=k=>{n.updateRules(k),t({message:"Enrollment rules saved successfully!",type:"success"}),x(k)};return i.jsxs("form",{onSubmit:c(P),className:"p-4 space-y-8 w-full",children:[e&&i.jsx(Gt,{message:e.message,type:e.type,onDismiss:()=>t(null)}),i.jsx(Yi,{title:"Enrollment Rules",children:i.jsxs(ae,{type:"submit",disabled:!m,children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Vs,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"Designation-Specific Rules"}),i.jsx("p",{className:"text-muted",children:"Set mandatory documents and verifications for specific roles."})]})]}),i.jsx("div",{className:"mb-4",children:i.jsx(Qe,{label:"Configure rules for designation",value:a,onChange:k=>o(k.target.value),children:r.map(k=>i.jsx("option",{value:k.designation,children:k.designation},k.id))})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Mandatory Documents"}),i.jsx("div",{className:"space-y-3",children:Object.keys(zg.documents).map(k=>i.jsx(je,{name:`rulesByDesignation.${a}.documents.${k}`,control:d,defaultValue:!0,render:({field:I})=>i.jsx(Cn,{id:`${a}-${k}`,label:k.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()),checked:I.value,onChange:I.onChange})},k))})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Data Verifications"}),i.jsx("div",{className:"space-y-3",children:Object.keys(zg.verifications).map(k=>i.jsx(je,{name:`rulesByDesignation.${a}.verifications.${k}`,control:d,defaultValue:!0,render:({field:I})=>i.jsx(Cn,{id:`${a}-${k}`,label:k.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()),checked:I.value,onChange:I.onChange})},k))})]})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(_l,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"ESI Eligibility"}),i.jsx("p",{className:"text-muted",children:"Define salary threshold for statutory insurance."})]}),i.jsx(je,{name:"enableEsiRule",control:d,render:({field:k})=>i.jsx(Cn,{id:"enableEsiRule",label:"Enable Rule",checked:k.value,onChange:k.onChange})})]}),i.jsx("div",{className:`transition-opacity ${w?"opacity-100":"opacity-50 pointer-events-none"}`,children:i.jsxs("div",{className:"max-w-sm",children:[i.jsx(Me,{label:"ESI Eligibility Gross Salary Threshold",id:"esiCtcThreshold",type:"number",registration:l("esiCtcThreshold",{valueAsNumber:!0}),disabled:!w}),i.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees at or below this amount are eligible for ESI. Those above are eligible for GMC."})]})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(_l,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"GMC/Insurance Policy Rules"}),i.jsx("p",{className:"text-muted",children:"Set default GMC policies."})]}),i.jsx(je,{name:"enableGmcRule",control:d,render:({field:k})=>i.jsx(Cn,{id:"enableGmcRule",label:"Enable Rule",checked:k.value,onChange:k.onChange})})]}),i.jsxs("div",{className:`transition-opacity ${j?"opacity-100":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[i.jsx(Me,{label:"GMC Salary Threshold",id:"salaryThreshold",type:"number",registration:l("salaryThreshold",{valueAsNumber:!0}),disabled:!j}),i.jsx(je,{name:"defaultPolicySingle",control:d,render:({field:k})=>i.jsxs(Qe,{label:"Policy (Single)",...k,disabled:!j,children:[i.jsx("option",{value:"1L",children:"1 Lakh"}),i.jsx("option",{value:"2L",children:"2 Lakh"})]})}),i.jsx(je,{name:"defaultPolicyMarried",control:d,render:({field:k})=>i.jsxs(Qe,{label:"Policy (Married)",...k,disabled:!j,children:[i.jsx("option",{value:"1L",children:"1 Lakh"}),i.jsx("option",{value:"2L",children:"2 Lakh"})]})})]}),i.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees with a salary *above* this threshold will be eligible for GMC."})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(mi,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Manpower Allocation"}),i.jsx("p",{className:"text-muted",children:"Set rules for enrolling based on approved manpower."})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(je,{name:"enforceManpowerLimit",control:d,render:({field:k})=>i.jsx(Cn,{id:"enforceManpowerLimit",label:"Enforce Manpower Allocation Limits",description:"Check new enrollments against the approved manpower count for the site.",checked:k.value,onChange:k.onChange})}),i.jsx("div",{className:`max-w-sm transition-opacity ${_?"opacity-100":"opacity-50 pointer-events-none"}`,children:i.jsxs(Qe,{label:"Action When Limit is Reached",id:"manpowerLimitRule",registration:l("manpowerLimitRule"),disabled:!_,children:[i.jsx("option",{value:"warn",children:"Warn field officer but allow enrollment"}),i.jsx("option",{value:"block",children:"Block enrollment and require approval"})]})})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(xr,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Field Officer Permissions"}),i.jsx("p",{className:"text-muted",children:"Control what field officers can do during enrollment."})]})]}),i.jsx("div",{className:"space-y-4",children:i.jsx(je,{name:"allowSalaryEdit",control:d,render:({field:k})=>i.jsx(Cn,{id:"allowSalaryEdit",label:"Allow Salary Editing",description:"Permit field officers to edit default salary, triggering an approval workflow.",checked:k.value??!1,onChange:k.onChange})})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(du,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Family Details Validation"}),i.jsx("p",{className:"text-muted",children:"Set rules for validating family member details."})]})]}),i.jsx("div",{className:"space-y-4",children:i.jsx(je,{name:"enforceFamilyValidation",control:d,render:({field:k})=>i.jsx(Cn,{id:"enforceFamilyValidation",label:"Enforce Strict Family Validation",description:"Enable checks for duplicates, age, and gender based on relationship.",checked:k.value??!1,onChange:k.onChange})})})]})]})},ede=()=>{const{id:n}=qL(),e=yn(),[t,r]=E.useState(null),[s,a]=E.useState(!0),[o,l]=E.useState(!1),c=E.useRef(null),{data:d,setFormsGenerated:m}=Wn(),p=_C(D=>D.currentLogo),[x,v]=E.useState(!1);E.useEffect(()=>{(async()=>{if(n&&!n.startsWith("draft_")){a(!0);const O=await pe.getOnboardingDataById(n);r(O||null),a(!1)}else r(d),a(!1)})()},[n,d]);const _=async()=>{const D=c.current;if(D&&t){v(!0);try{const O=D.outerHTML,q={margin:0,filename:`Onboarding_Forms_${t?.personal.employeeId}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await pe.generatePdf(O,q)}catch(O){console.error("PDF generation failed:",O)}finally{v(!1)}}},w=()=>{m(!0),e(`/onboarding/add/review?id=${n}`)};if(s||x)return i.jsx("div",{className:"text-center p-10",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin mx-auto"})});if(!t)return i.jsx("div",{className:"text-center p-10 text-red-500",children:"Could not find employee data."});const j=t,P=`${j.personal.firstName} ${j.personal.middleName||""} ${j.personal.lastName}`.replace(/\s+/g," ").trim(),k=j.family.find(D=>D.relation==="Father")?.name||"",I=j.family.find(D=>D.relation==="Spouse")?.name||"",M=j.family.find(D=>D.relation==="Mother")?.name||"";return i.jsx("div",{className:"bg-page",children:i.jsxs("div",{className:"max-w-4xl p-4 sm:p-6 lg:p-8",children:[i.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card no-print mb-8 sticky top-4 z-10",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsxs(ae,{type:"button",onClick:()=>e(-1),variant:"secondary",children:[i.jsx(Hi,{className:"mr-2 h-4 w-4"})," Go Back"]}),i.jsxs("div",{className:"text-center",children:[i.jsx("h2",{className:"font-bold text-lg",children:"Review Official Forms"}),i.jsx("p",{className:"text-sm text-muted",children:"Please confirm these details before submitting."})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(ae,{type:"button",onClick:_,variant:"outline",disabled:x,children:[x?i.jsx(Tt,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(hi,{className:"mr-2 h-4 w-4"}),x?"Generating...":"Download"]}),i.jsx(ae,{type:"button",onClick:w,children:"Confirm & Continue"})]})]})}),i.jsxs("div",{ref:c,className:"bg-white rounded-xl border border-border shadow-lg",children:[i.jsx("div",{className:"pdf-page p-8 font-serif text-sm text-black",children:i.jsxs("div",{className:"border-4 border-black p-6 h-full flex flex-col",children:[i.jsx("h1",{className:"text-center text-xl font-bold tracking-widest mb-8",children:"EMPLOYEE PERSONAL DATA"}),i.jsx("div",{className:"w-64 mx-auto border-2 border-black p-2 my-8",children:i.jsx("img",{src:p,alt:"Paradigm Logo",className:"w-full"})}),i.jsxs("div",{className:"mt-auto space-y-8 text-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S NAME"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:P})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"SITE"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.organization.organizationName})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"DESIGNATION"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.organization.designation})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S ID NO."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.personal.employeeId})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"PF No."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.uan.pfNumber||j.uan.uanNumber})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"ESI NO."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.esi.esiNumber})]})]})]})}),i.jsx("div",{className:"page-break"}),i.jsx("div",{className:"pdf-page p-8 font-serif text-xs text-black",children:i.jsxs("div",{className:"border-2 border-black p-4 h-full relative",children:[i.jsx("div",{className:"absolute top-4 right-4 w-48",children:i.jsx("img",{src:p,alt:"Paradigm Logo",className:"w-full"})}),i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h2",{className:"font-bold",children:["EMPLOYEE ID No. : ",i.jsx("span",{className:"font-normal underline",children:j.personal.employeeId})]}),i.jsx("h1",{className:"text-center font-bold text-base tracking-wider",children:"PERSONAL DATA"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("p",{children:["1. Name: ",i.jsx("span",{className:"underline",children:P})]}),i.jsxs("p",{children:["2. Father's Name: ",i.jsx("span",{className:"underline",children:k})]}),i.jsxs("p",{children:["3. Mother's Name: ",i.jsx("span",{className:"underline",children:M})]}),i.jsxs("p",{children:["4. Reference by: ",i.jsx("span",{className:"underline"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["5. Date of Birth: ",i.jsx("span",{className:"underline",children:j.personal.dob})]}),i.jsxs("p",{children:["6. Age: ",i.jsx("span",{className:"underline",children:j.personal.dob?new Date().getFullYear()-new Date(j.personal.dob).getFullYear():""})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["7. Qualification: ",i.jsx("span",{className:"underline",children:j.education[0]?.degree||""})]}),i.jsxs("p",{children:["8. Experience: ",i.jsx("span",{className:"underline"})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["9. Designation: ",i.jsx("span",{className:"underline",children:j.organization.designation})]}),i.jsxs("p",{children:["10. Net Salary Offered: ",i.jsx("span",{className:"underline",children:j.personal.salary?.toLocaleString("en-IN")})]})]}),i.jsxs("p",{children:["11. Present Address: ",i.jsx("span",{className:"underline",children:`${j.address.present.line1}, ${j.address.present.city}, ${j.address.present.state} - ${j.address.present.pincode}`})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["12. Permanent Address: ",i.jsx("span",{className:"underline",children:j.address.sameAsPresent?"Same as Present":`${j.address.permanent.line1}, ${j.address.permanent.city}`})]}),i.jsxs("p",{children:["Ph. No.: ",i.jsx("span",{className:"underline",children:j.personal.mobile})," Alternate Ph. No.: ",i.jsx("span",{className:"underline",children:j.personal.alternateMobile||""})]})]}),i.jsx("p",{children:"13. Left hand thumb impression"}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{})]}),i.jsx("p",{children:"14. Right hand thumb impression"}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["15. Marital Status: ",i.jsx("span",{className:"underline",children:j.personal.maritalStatus})]}),i.jsxs("p",{children:["16. Name of the Spouse: ",i.jsx("span",{className:"underline",children:I})," Contact No.: ",i.jsx("span",{className:"underline"})]})]}),i.jsxs("p",{children:["17. Languages Known: to Speak ",i.jsx("span",{className:"underline"})," to Write ",i.jsx("span",{className:"underline"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["18. Date of Joining: ",i.jsx("span",{className:"underline",children:j.organization.joiningDate})]}),i.jsx("p",{children:"19. ID Card:"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["20. ESI Number: ",i.jsx("span",{className:"underline",children:j.esi.esiNumber})]}),i.jsxs("p",{children:["21. PF Number: ",i.jsx("span",{className:"underline",children:j.uan.pfNumber||j.uan.uanNumber})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"22. Uniform Details: "}),i.jsx("p",{children:"23. Shoe Details: "})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["24. Name of the Site: ",i.jsx("span",{className:"underline",children:j.organization.organizationName})]}),i.jsx("p",{children:"25. Site / Estate Manager: "})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"26. Record enclosed: "}),i.jsx("p",{children:"28. Reference Name:"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"27. Hirer: "}),i.jsx("p",{className:"ml-24",children:"Reference Ph.:"})]}),i.jsxs("p",{children:["29. Emergency Contact Name: ",i.jsx("span",{className:"underline",children:j.personal.emergencyContactName})," Ph.: ",i.jsx("span",{className:"underline",children:j.personal.emergencyContactNumber})," Blood Group: ",i.jsx("span",{className:"underline",children:j.personal.bloodGroup})]})]}),i.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between",children:[i.jsx("p",{children:"Employee Signature:"}),i.jsx("p",{children:"Documented by:"})]})]})})]})]})})},tde=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-blue-100 text-blue-800",Issued:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},Ac=({title:n,sizes:e,headers:t,control:r,quantityType:s,quantities:a,readOnly:o=!1})=>{const l=Array.from(new Set(e.map(d=>d.fit))),c=Array.from(new Set(e.map(d=>d.size))).sort((d,m)=>{const p=parseInt(String(d)),x=parseInt(String(m));return!isNaN(p)&&!isNaN(x)?p-x:String(d).localeCompare(String(m))});return i.jsxs("div",{className:"border rounded-lg flex flex-col overflow-hidden",children:[i.jsx("h4",{className:"p-3 font-semibold bg-page border-b flex-shrink-0",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:"Size"}),t.map(d=>i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:d.label},String(d.key))),i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted w-20",children:"Qty"})]})}),i.jsx("tbody",{className:"divide-y",children:c.map(d=>i.jsx(at.Fragment,{children:l.map((m,p)=>{const x=e.find(v=>v.size===d&&v.fit===m);return x?i.jsxs("tr",{children:[p===0&&i.jsx("td",{rowSpan:l.filter(v=>e.some(_=>_.size===d&&_.fit===v)).length,className:"px-2 py-2 align-middle font-semibold border-r",children:d}),t.map(v=>i.jsx("td",{className:"px-2 py-2",children:x[v.key]},String(v.key))),i.jsx("td",{className:"px-2 py-2",children:o?i.jsx("span",{className:"font-semibold block text-center pr-4",children:a?.[x.id]||0}):i.jsx(je,{name:`${s}.${x.id}`,control:r,render:({field:v})=>i.jsx(Me,{"aria-label":`Quantity for ${n} size ${d} ${m}`,type:"number",...v,value:v.value||"",onChange:_=>v.onChange(parseInt(_.target.value)||null),className:"!py-1.5"})})})]},x.id):null})},d))})]})})]})},nde=({onSave:n,onCancel:e,sites:t,masterUniforms:r,initialData:s})=>{const{register:a,control:o,handleSubmit:l,watch:c,reset:d}=Zt({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),m=c("gender");E.useEffect(()=>{if(s){const x={},v={};s.items.forEach(_=>{_.category==="Pants"?x[_.sizeId]=_.quantity:v[_.sizeId]=_.quantity}),d({siteId:s.siteId,gender:s.gender,pantsQuantities:x,shirtsQuantities:v})}else d({siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}})},[s,d]);const p=x=>{const v=t.find(P=>P.id===x.siteId);if(!v)return;const _=m==="Gents"?[...r.gents.pants,...r.gents.shirts]:[...r.ladies.pants,...r.ladies.shirts],w=[];for(const[P,k]of Object.entries(x.pantsQuantities))if(k&&k>0){const I=_.find(M=>M.id===P);I&&w.push({sizeId:P,quantity:k,category:"Pants",sizeLabel:I.size,fit:I.fit})}for(const[P,k]of Object.entries(x.shirtsQuantities))if(k&&k>0){const I=_.find(M=>M.id===P);I&&w.push({sizeId:P,quantity:k,category:"Shirts",sizeLabel:I.size,fit:I.fit})}const j={id:s?.id||`new_${Date.now()}`,siteId:x.siteId,siteName:v.shortName,gender:x.gender,requestedDate:s?.requestedDate||new Date().toISOString(),status:s?.status||"Pending",items:w};n(j)};return i.jsxs("form",{onSubmit:l(p),className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card my-6 animate-fade-in-down",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:[s?"Edit":"New"," Uniform Request"]}),i.jsx(ae,{type:"button",variant:"icon",onClick:e,"aria-label":"Close form",children:i.jsx(Ui,{})})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(Qe,{label:"Select Site",...a("siteId"),required:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),t.map(x=>i.jsx("option",{value:x.id,children:x.shortName},x.id))]}),i.jsxs(Qe,{label:"Select Uniform Type",...a("gender"),children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]})]}),i.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:m==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Ac,{title:"Gents' Pants",sizes:r.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(Ac,{title:"Gents' Shirts",sizes:r.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Ac,{title:"Ladies' Pants",sizes:r.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(Ac,{title:"Ladies' Shirts",sizes:r.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]})}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx(ae,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsxs(ae,{type:"submit",children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save Request"]})]})]})]})},rde=({request:n,onClose:e,masterUniforms:t})=>{if(!n)return null;const{pantsQuantities:r,shirtsQuantities:s}=E.useMemo(()=>{const o={},l={};return n.items.forEach(c=>{c.category==="Pants"?o[c.sizeId]=c.quantity:l[c.sizeId]=c.quantity}),{pantsQuantities:o,shirtsQuantities:l}},[n.items]),a=n.gender==="Gents"?t.gents:t.ladies;return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-6xl my-4 animate-fade-in-scale flex flex-col max-h-[90vh]",onClick:o=>o.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-start flex-shrink-0",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Uniform Request Details"}),i.jsxs("p",{className:"text-sm text-muted",children:[n.siteName," - ",Ue(new Date(n.requestedDate),"dd MMM, yyyy")]})]}),i.jsx(ae,{variant:"icon",onClick:e,children:i.jsx(Ui,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-6",children:i.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:n.gender==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Ac,{readOnly:!0,title:"Gents' Pants",sizes:a.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],quantities:r}),i.jsx(Ac,{readOnly:!0,title:"Gents' Shirts",sizes:a.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],quantities:s})]}):i.jsxs(i.Fragment,{children:[i.jsx(Ac,{readOnly:!0,title:"Ladies' Pants",sizes:a.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],quantities:r}),i.jsx(Ac,{readOnly:!0,title:"Ladies' Shirts",sizes:a.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],quantities:s})]})})}),i.jsx("div",{className:"p-4 border-t flex justify-end flex-shrink-0",children:i.jsx(ae,{variant:"secondary",onClick:e,children:"Close"})})]})})},sde=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(null),[c,d]=E.useState(!0),[m,p]=E.useState(null),[x,v]=E.useState(null),[_,w]=E.useState(null),[j,P]=E.useState(null),k=async()=>{d(!0);try{const[q,F,U,B]=await Promise.all([pe.getUniformRequests(),pe.getOrganizations(),pe.getMasterGentsUniforms(),pe.getMasterLadiesUniforms()]);r(q),a(F),l({gents:U,ladies:B})}catch{p({message:"Failed to load uniform data.",type:"error"})}finally{d(!1)}};E.useEffect(()=>{k()},[]);const I=()=>{v(null),e("form")},M=q=>{v(q),e("form")},D=async q=>{try{q.id.startsWith("new_")?(await pe.submitUniformRequest(q),p({message:"New request submitted.",type:"success"})):(await pe.updateUniformRequest(q),p({message:"Request updated.",type:"success"})),e("list"),k()}catch{p({message:"Failed to save request.",type:"error"})}},O=async()=>{if(_)try{await pe.deleteUniformRequest(_.id),p({message:"Request deleted.",type:"success"}),w(null),k()}catch{p({message:"Failed to delete request.",type:"error"})}};return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"p-4 space-y-6",children:[m&&i.jsx(Gt,{message:m.message,type:m.type,onDismiss:()=>p(null)}),i.jsx(tr,{isOpen:!!_,onClose:()=>w(null),onConfirm:O,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),o&&i.jsx(rde,{request:j,onClose:()=>P(null),masterUniforms:o}),i.jsx("div",{className:"bg-card p-4 rounded-2xl",children:i.jsx(Yi,{title:"Uniform Management",children:n==="list"&&i.jsxs(ae,{onClick:I,children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," New Uniform Request"]})})}),n==="form"&&o&&i.jsx(nde,{onSave:D,onCancel:()=>e("list"),sites:s,masterUniforms:o,initialData:x}),n==="list"&&i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site / Employee"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Gender"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Requested By"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Source"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{children:t.map(q=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Site",className:"px-4 py-3 font-medium",children:[i.jsx("p",{children:q.siteName}),q.source==="Individual"&&q.employeeDetails?.[0]?.employeeName&&i.jsxs("p",{className:"text-xs text-muted",children:["For: ",q.employeeDetails[0].employeeName]}),q.source==="Enrollment"&&i.jsxs("p",{className:"text-xs text-muted",children:["(",q.employeeDetails?.length||0," employees)"]})]}),i.jsx("td",{"data-label":"Gender",className:"px-4 py-3 text-muted",children:q.gender}),i.jsx("td",{"data-label":"Requested By",className:"px-4 py-3 text-muted",children:q.requestedByName||"System"}),i.jsx("td",{"data-label":"Source",className:"px-4 py-3 text-muted",children:q.source||"Bulk"}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(tde,{status:q.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>P(q),title:"View Request",children:i.jsx(bl,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>M(q),title:"Edit Request",disabled:q.source==="Enrollment",children:i.jsx(xr,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>w(q),title:"Delete Request",disabled:q.source==="Enrollment",children:i.jsx(Xt,{className:"h-4 w-4 text-red-600"})})]})})]},q.id))})]}),t.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No uniform requests found."})]})]})},ide=({item:n})=>{const[e,t]=E.useState(!1);return i.jsxs("div",{className:"bg-card rounded-xl border border-border p-4",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-primary-text",children:n.employeeName}),i.jsx("p",{className:"text-sm text-muted",children:n.employeeId}),i.jsx("p",{className:"text-xs text-muted mt-1",children:Ue(new Date(n.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")})]}),i.jsx("div",{className:"text-right",children:i.jsxs("p",{className:"text-lg font-bold text-accent",children:["",n.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),n.breakdown.length>0&&i.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[i.jsxs("button",{onClick:()=>t(!e),className:"flex justify-between items-center w-full text-sm text-muted",children:[i.jsx("span",{children:"Details"}),i.jsx(xu,{className:`h-4 w-4 transition-transform ${e?"rotate-180":""}`})]}),e&&i.jsx("ul",{className:"list-disc list-inside space-y-1 mt-2 text-sm text-muted animate-fade-in-down",children:n.breakdown.map((r,s)=>i.jsxs("li",{children:[r.name,": ",(r.cost||0).toFixed(2)]},s))})]})]})},ade=()=>i.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,e)=>i.jsxs("div",{className:"bg-card rounded-xl border border-border p-4 space-y-3 skeleton-pulse",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-5 w-32 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-24 bg-gray-300 rounded"})]}),i.jsx("div",{className:"h-6 w-20 bg-gray-300 rounded"})]}),i.jsx("div",{className:"h-4 w-1/4 bg-gray-300 rounded mt-2"})]},e))}),ode=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),{verificationCosts:s,updateVerificationCosts:a}=fi(),[o,l]=E.useState(s),[c,d]=E.useState(!1),[m,p]=E.useState([{startDate:uf(new Date,29),endDate:new Date,key:"selection"}]),[x,v]=E.useState("Last 30 Days"),[_,w]=E.useState(!1),j=E.useRef(null),[P,k]=E.useState(null),I=E.useRef(null),M=Jt("(max-width: 767px)"),D=E.useCallback(async()=>{const H=m[0]?.startDate,se=m[0]?.endDate;if(!(!H||!se)){r(!0);try{const W=await pe.getVerificationCostBreakdown(Ue(H,"yyyy-MM-dd"),Ue(se,"yyyy-MM-dd"));e(W)}catch(W){console.error("Failed to fetch cost breakdown",W),k({message:"Failed to load verification data.",type:"error"})}finally{r(!1)}}},[m]);E.useEffect(()=>{D()},[D]),E.useEffect(()=>{const H=se=>{j.current&&!j.current.contains(se.target)&&w(!1)};return document.addEventListener("mousedown",H),()=>document.removeEventListener("mousedown",H)},[]),E.useEffect(()=>{l(s)},[s]),E.useEffect(()=>{d(JSON.stringify(o)!==JSON.stringify(s))},[o,s]);const O=(H,se,W)=>{l(ee=>ee.map(K=>K.id===H?se==="cost"?{...K,cost:parseFloat(W)||0}:{...K,name:W}:K))},q=()=>{l(H=>[...H,{id:`new_${Date.now()}`,name:"New Verification Type",cost:0}])},F=H=>{l(se=>se.filter(W=>W.id!==H))},U=()=>{a(o),k({message:"Costs updated successfully!",type:"success"})},B=E.useMemo(()=>{const H=new Map(s.map(se=>[se.name,se.cost]));return n.map(se=>{const W=se.breakdown.map(K=>({...K,cost:Number(H.get(K.name))||0})),ee=W.reduce((K,oe)=>K+(oe.cost||0)*oe.count,0);return{...se,breakdown:W,totalCost:ee}})},[n,s]),G=E.useMemo(()=>{const H=B.length,se=B.reduce((ee,K)=>ee+K.totalCost,0),W=H>0?se/H:0;return{totalEmployees:H,totalCost:se,averageCost:W}},[B]),X=E.useMemo(()=>{const H={};return B.forEach(se=>{se.breakdown.forEach(W=>{H[W.name]||(H[W.name]={count:0,total:0}),H[W.name].count+=W.count,H[W.name].total+=(W.cost||0)*W.count})}),Object.entries(H).map(([se,W])=>({name:se,...W}))},[B]),[Q,Y]=E.useState(!1),ne=async H=>{{const se=I.current;if(!se){k({message:"Could not find report to export.",type:"error"});return}Y(!0);try{const W=se.outerHTML,ee={margin:.5,filename:`Cost_Analysis_Report_${Ue(m[0].startDate,"yyyy-MM-dd")}_to_${Ue(m[0].endDate,"yyyy-MM-dd")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await pe.generatePdf(W,ee)}catch(W){console.error("PDF generation failed:",W),k({message:"Failed to generate PDF.",type:"error"})}finally{Y(!1)}}},te=[{label:"Today",value:"Today"},{label:"Last 7 Days",value:"Last 7 Days"},{label:"Last 30 Days",value:"Last 30 Days"}],ie=H=>{const se=new Date;let W=new Date;H==="Today"?W=Wg():H==="Last 7 Days"?W=uf(se,6):H==="Last 30 Days"&&(W=uf(se,29)),v(H),p([{startDate:W,endDate:se,key:"selection"}]),w(!1)},$=H=>{p([H.selection])};return i.jsxs("div",{className:"p-4 space-y-6",children:[P&&i.jsx(Gt,{message:P.message,type:P.type,onDismiss:()=>k(null)}),i.jsx(Yi,{title:"Verification Costing",children:i.jsx("div",{className:"w-full sm:w-auto",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:flex sm:items-center sm:flex-wrap",children:[i.jsxs(ae,{onClick:()=>ne(),variant:"outline",size:"sm",disabled:Q||t||B.length===0,children:[Q?i.jsx(Tt,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(hi,{className:"mr-2 h-4 w-4"}),Q?"Generating PDF...":"Download PDF"]}),te.map(H=>i.jsx(ae,{variant:x===H.value?"outline":"secondary",size:"sm",onClick:()=>ie(H.value),className:"justify-center",children:H.label},H.value)),i.jsxs("div",{className:"relative",ref:j,children:[i.jsxs(ae,{variant:x==="Custom"?"outline":"secondary",size:"sm",onClick:()=>{w(H=>!H),v("Custom")},className:"w-full justify-center",children:[i.jsx(Sa,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Custom Range"})]}),_&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:i.jsx(lm.DateRangePicker,{onChange:$,ranges:m,maxDate:new Date,direction:"horizontal"})})]})]})})}),i.jsx("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"cursor-pointer flex justify-between items-center list-none",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2 text-primary-text",children:[i.jsx(vm,{className:"h-5 w-5 text-muted"})," Cost Configuration"]}),i.jsx(xu,{className:"transition-transform group-open:rotate-180"})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t",children:[i.jsx("div",{className:"space-y-2",children:o.map(H=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[i.jsx("div",{className:"col-span-12 sm:col-span-6",children:i.jsx(Me,{"aria-label":"Cost Item Name",value:H.name,onChange:se=>O(H.id,"name",se.target.value),className:"!py-2"})}),i.jsx("div",{className:"col-span-8 sm:col-span-4",children:i.jsx(Me,{"aria-label":"Cost Value",type:"number",step:"0.01",value:H.cost||0,onChange:se=>O(H.id,"cost",se.target.value),className:"!py-2"})}),i.jsx("div",{className:"col-span-4 sm:col-span-2 text-right",children:i.jsx(ae,{variant:"icon",onClick:()=>F(H.id),"aria-label":`Remove ${H.name}`,children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})})]},H.id))}),i.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[i.jsxs(ae,{type:"button",variant:"outline",size:"sm",onClick:q,children:[i.jsx(qt,{className:"mr-2 h-4"})," Add Cost Item"]}),i.jsxs(ae,{onClick:U,disabled:!c,children:[i.jsx(is,{className:"mr-2 h-4"})," Save Costs"]})]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx(po,{title:"Total Verification Cost",value:`${G.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:_l}),i.jsx(po,{title:"Total Verified Employees",value:G.totalEmployees,icon:mi}),i.jsx(po,{title:"Avg. Cost Per Employee",value:`${G.averageCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:_l})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Verification Usage Breakdown"}),t?i.jsx("div",{className:"flex justify-center items-center h-24",children:i.jsx(Tt,{className:"h-6 w-6 animate-spin text-muted"})}):X.length>0?i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:X.map(H=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border",children:[i.jsx("p",{className:"text-sm font-medium text-muted",children:H.name}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:H.count}),i.jsxs("p",{className:"text-sm font-semibold text-accent-dark",children:["Total: ",H.total.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},H.name))}):i.jsx("p",{className:"text-center text-muted py-8",children:"No verification data for this period."})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx("div",{className:"flex justify-between items-center",children:i.jsx("h3",{className:"text-lg font-semibold text-primary-text",children:"Detailed Report"})}),i.jsx("div",{ref:I,className:"mt-4 pt-4 border-t border-border",children:M?t?i.jsx(ade,{}):B.length===0?i.jsx("p",{className:"text-center text-muted py-8",children:"No report data for this period."}):i.jsx("div",{className:"space-y-4",children:B.map(H=>i.jsx(ide,{item:H},H.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Enrollment Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Cost Breakdown"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase",children:"Total Cost"})]})}),i.jsx("tbody",{children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10",children:i.jsx(Tt,{className:"h-6 w-6 animate-spin text-muted mx-auto"})})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No report data for this period."})}):B.map(H=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Employee",className:"px-6 py-4",children:[i.jsx("div",{className:"font-medium text-primary-text",children:H.employeeName}),i.jsx("div",{className:"text-sm text-muted",children:H.employeeId})]}),i.jsx("td",{"data-label":"Enrollment Date",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:Ue(new Date(H.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")}),i.jsx("td",{"data-label":"Cost Breakdown",className:"px-6 py-4 text-sm text-muted",children:i.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[H.breakdown.map((se,W)=>i.jsxs("li",{children:[se.name,": ",(se.cost||0).toFixed(2)]},W)),H.breakdown.length===0&&i.jsx("li",{children:"No verifications performed"})]})}),i.jsxs("td",{"data-label":"Total Cost",className:"px-6 py-4 whitespace-nowrap text-right font-semibold text-primary-text",children:["",H.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},H.id))})]})})})]})]})},lde=({status:n})=>{if(!n)return i.jsx("span",{className:"text-xs text-muted",children:"-"});const e={"Not Generated":"bg-slate-700 text-white dark:bg-slate-600 dark:text-slate-200",Generated:"bg-sky-100 text-sky-800 dark:bg-sky-500/20 dark:text-sky-300",Sent:"bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-300",Paid:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${e[n]}`,children:n})},cde=({invoiceData:n,discount:e,setDiscount:t,roundOff:r,setRoundOff:s})=>{const a=l=>new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l),o=E.useMemo(()=>{if(!n)return null;const l=n.lineItems.reduce((x,v)=>{const _=v.deployment*v.ratePerMonth;return v.description.toLowerCase().includes("deduction")?x-_:x+_},0),c=l*.1,d=l+c-e,m=d*.09,p=d+m+m+r;return{subTotal:l,serviceCharge:c,grandTotal:d,gst:m,finalTotal:p}},[n,e,r]);return o?i.jsxs("div",{className:"p-4 bg-white text-black text-[10px] printable-area",children:[i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("div",{children:[i.jsxs("p",{children:["Name : ",n.siteName]}),i.jsxs("p",{children:["Address : ",n.siteAddress]}),i.jsxs("p",{children:["City : ",n.siteAddress.split(",").pop()?.trim()]})]}),i.jsxs("div",{className:"border border-black",children:[i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Invoice No"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceNumber})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Date"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceDate})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Month"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.statementMonth.split("-")[0]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-black",children:"Due Date"}),i.jsx("div",{className:"p-1",children:"January 15, 2023"})]})]})]}),i.jsx("div",{className:"my-4 flex justify-center",children:i.jsx(Wi,{className:"h-10"})}),i.jsxs("h2",{className:"text-center font-bold text-sm underline mb-2",children:[n.siteName," Summary Statement for the month of ",n.statementMonth]}),i.jsxs("table",{className:"w-full border-collapse border border-black",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"font-bold bg-gray-200",children:[i.jsx("td",{className:"border p-1 border-black",children:"Sl.No"}),i.jsx("td",{className:"border p-1 border-black",children:"Description"}),i.jsx("td",{className:"border p-1 border-black",children:"Deployment"}),i.jsx("td",{className:"border p-1 border-black",children:"No of Days"}),i.jsx("td",{className:"border p-1 border-black",children:"Rate/Day"}),i.jsx("td",{className:"border p-1 border-black",children:"Rate/Month"}),i.jsx("td",{className:"border p-1 border-black",children:"Amount(Rs)"})]})}),i.jsxs("tbody",{children:[i.jsx("tr",{children:i.jsxs("td",{className:"border p-1 border-black font-bold",colSpan:7,children:["SERVICES (01/",Ue(new Date(n.statementMonth),"MM/yyyy")," to ",Ue(new Date(n.invoiceDate),"dd/MM/yyyy"),")"]})}),n.lineItems.map((l,c)=>{const d=l.deployment*l.ratePerMonth,m=l.description.toLowerCase().includes("deduction"),p=l.deployment===0;return i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1 border-black text-center",children:c+1}),i.jsx("td",{className:`border p-1 border-black ${m?"text-red-600":""}`,children:l.description}),i.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":l.deployment}),i.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":l.noOfDays}),i.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":a(l.ratePerDay)}),i.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":a(l.ratePerMonth)}),i.jsx("td",{className:`border p-1 border-black text-right ${m?"text-red-600":""}`,children:a(d)})]},l.id)}),Array.from({length:Math.max(0,10-n.lineItems.length)}).map((l,c)=>i.jsx("tr",{children:i.jsx("td",{className:"border p-1 border-black h-6",colSpan:7})},`spacer-${c}`))]}),i.jsxs("tfoot",{children:[i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Sub Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:a(o.subTotal)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Admin,Overheads and Service Charges 10% on Sub Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.serviceCharge)})]}),i.jsxs("tr",{className:"no-print",children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold text-red-600",children:"Discount"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:i.jsx(Me,{type:"number",value:e,onChange:l=>t(parseFloat(l.target.value)||0),className:"text-right !p-1"})})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Grand Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:a(o.grandTotal)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"Central GST"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.gst)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"State GST"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.gst)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Round off"}),i.jsxs("td",{colSpan:2,className:"border p-1 border-black text-right",children:[i.jsx("span",{className:"print-only",children:a(r)}),i.jsx("span",{className:"no-print",children:i.jsx(Me,{type:"number",step:"0.01",value:r,onChange:l=>s(parseFloat(l.target.value)||0),className:"text-right !p-1"})})]})]}),i.jsxs("tr",{className:"bg-gray-200 font-bold text-base",children:[i.jsx("td",{colSpan:5,className:"border p-2 border-black",children:"Payable for Services rendered"}),i.jsx("td",{colSpan:2,className:"border p-2 border-black text-right",children:a(o.finalTotal)})]})]})]})]}):null},dde=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState(Ue(new Date,"yyyy-MM")),[c,d]=E.useState({}),[m,p]=E.useState({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),[x,v]=E.useState(0),[_,w]=E.useState(.2),[j,P]=E.useState(null),k=E.useRef(null),[I,M]=E.useState(!1);E.useEffect(()=>{pe.getOrganizations().then(U=>e(U.sort((B,G)=>B.shortName.localeCompare(G.shortName)))).catch(()=>P({message:"Failed to load sites.",type:"error"})).finally(()=>r(!1))},[]);const D=E.useCallback(async U=>{a(!0);try{const B=new Date(U+"-02"),G=await pe.getInvoiceStatuses(B);d(G)}catch{P({message:"Failed to fetch invoice statuses.",type:"error"})}finally{a(!1)}},[]);E.useEffect(()=>{o&&D(o)},[o,D]);const O=async U=>{p({isOpen:!0,site:U,invoiceData:null,isLoading:!0});try{const B=new Date(o+"-02"),G=await pe.getInvoiceSummaryData(U.id,B);p({isOpen:!0,site:U,invoiceData:G,isLoading:!1})}catch{P({message:"Failed to fetch invoice data.",type:"error"}),p({isOpen:!1,site:null,invoiceData:null,isLoading:!1})}},q=async()=>{const U=k.current;if(!U||!m.invoiceData){P({message:"Could not find invoice to export.",type:"error"});return}M(!0);try{const B=U.outerHTML,G={margin:.25,filename:`Invoice_${m.invoiceData.siteName.replace(" ","_")}_${m.invoiceData.statementMonth}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await pe.generatePdf(B,G)}catch(B){console.error("PDF generation failed:",B),P({message:"Failed to generate PDF.",type:"error"})}finally{M(!1)}},F=()=>{p({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),v(0),w(.2)};return t?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"p-4 md:p-0",children:[j&&i.jsx(Gt,{message:j.message,type:j.type,onDismiss:()=>P(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx(Yi,{title:"Invoice Summary"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Monthly Invoice Status"}),i.jsx("div",{className:"md:w-56",children:i.jsx(Me,{label:"",id:"month-select",type:"month",value:o,onChange:U=>l(U.target.value)})})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Invoice Status"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:n.map(U=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:U.shortName}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:s?i.jsx(Tt,{className:"h-4 w-4 animate-spin"}):i.jsx(lde,{status:c[U.id]})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>O(U),disabled:c[U.id]==="Not Generated"||s,title:"View Invoice",children:i.jsx(bl,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>O(U),disabled:c[U.id]==="Not Generated"||s,title:"Download Invoice",children:i.jsx(hi,{className:"h-4 w-4"})})]})})]},U.id))})]})})]})]}),m.isOpen&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:F,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl m-4 animate-fade-in-scale flex flex-col",onClick:U=>U.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center no-print",children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Invoice for ",m.site?.shortName]}),i.jsx(ae,{variant:"icon",onClick:F,children:i.jsx(Ui,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-4 max-h-[70vh]",children:m.isLoading?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):m.invoiceData?i.jsx("div",{ref:k,children:i.jsx(cde,{invoiceData:m.invoiceData,discount:x,setDiscount:v,roundOff:_,setRoundOff:w})}):i.jsx("p",{className:"text-center text-muted",children:"No data to display."})}),i.jsx("div",{className:"p-4 border-t flex justify-end no-print",children:i.jsxs(ae,{onClick:q,disabled:!m.invoiceData||I,children:[I?i.jsx(Tt,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(hi,{className:"mr-2 h-4 w-4"}),I?"Generating...":"Download PDF"]})})]})})]})};var zh={exports:{}};var ude=zh.exports,jL;function fde(){return jL||(jL=1,(function(n,e){(function(t,r){r(e)})(ude,(function(t){var r="1.9.4";function s(f){var y,C,A,V;for(C=1,A=arguments.length;C<A;C++){V=arguments[C];for(y in V)f[y]=V[y]}return f}var a=Object.create||(function(){function f(){}return function(y){return f.prototype=y,new f}})();function o(f,y){var C=Array.prototype.slice;if(f.bind)return f.bind.apply(f,C.call(arguments,1));var A=C.call(arguments,2);return function(){return f.apply(y,A.length?A.concat(C.call(arguments)):arguments)}}var l=0;function c(f){return"_leaflet_id"in f||(f._leaflet_id=++l),f._leaflet_id}function d(f,y,C){var A,V,J,ge;return ge=function(){A=!1,V&&(J.apply(C,V),V=!1)},J=function(){A?V=arguments:(f.apply(C,arguments),setTimeout(ge,y),A=!0)},J}function m(f,y,C){var A=y[1],V=y[0],J=A-V;return f===A&&C?f:((f-V)%J+J)%J+V}function p(){return!1}function x(f,y){if(y===!1)return f;var C=Math.pow(10,y===void 0?6:y);return Math.round(f*C)/C}function v(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function _(f){return v(f).split(/\s+/)}function w(f,y){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?a(f.options):{});for(var C in y)f.options[C]=y[C];return f.options}function j(f,y,C){var A=[];for(var V in f)A.push(encodeURIComponent(C?V.toUpperCase():V)+"="+encodeURIComponent(f[V]));return(!y||y.indexOf("?")===-1?"?":"&")+A.join("&")}var P=/\{ *([\w_ -]+) *\}/g;function k(f,y){return f.replace(P,function(C,A){var V=y[A];if(V===void 0)throw new Error("No value provided for variable "+C);return typeof V=="function"&&(V=V(y)),V})}var I=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function M(f,y){for(var C=0;C<f.length;C++)if(f[C]===y)return C;return-1}var D="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function O(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var q=0;function F(f){var y=+new Date,C=Math.max(0,16-(y-q));return q=y+C,window.setTimeout(f,C)}var U=window.requestAnimationFrame||O("RequestAnimationFrame")||F,B=window.cancelAnimationFrame||O("CancelAnimationFrame")||O("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function G(f,y,C){if(C&&U===F)f.call(y);else return U.call(window,o(f,y))}function X(f){f&&B.call(window,f)}var Q={__proto__:null,extend:s,create:a,bind:o,get lastId(){return l},stamp:c,throttle:d,wrapNum:m,falseFn:p,formatNum:x,trim:v,splitWords:_,setOptions:w,getParamString:j,template:k,isArray:I,indexOf:M,emptyImageUrl:D,requestFn:U,cancelFn:B,requestAnimFrame:G,cancelAnimFrame:X};function Y(){}Y.extend=function(f){var y=function(){w(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},C=y.__super__=this.prototype,A=a(C);A.constructor=y,y.prototype=A;for(var V in this)Object.prototype.hasOwnProperty.call(this,V)&&V!=="prototype"&&V!=="__super__"&&(y[V]=this[V]);return f.statics&&s(y,f.statics),f.includes&&(ne(f.includes),s.apply(null,[A].concat(f.includes))),s(A,f),delete A.statics,delete A.includes,A.options&&(A.options=C.options?a(C.options):{},s(A.options,f.options)),A._initHooks=[],A.callInitHooks=function(){if(!this._initHooksCalled){C.callInitHooks&&C.callInitHooks.call(this),this._initHooksCalled=!0;for(var J=0,ge=A._initHooks.length;J<ge;J++)A._initHooks[J].call(this)}},y},Y.include=function(f){var y=this.prototype.options;return s(this.prototype,f),f.options&&(this.prototype.options=y,this.mergeOptions(f.options)),this},Y.mergeOptions=function(f){return s(this.prototype.options,f),this},Y.addInitHook=function(f){var y=Array.prototype.slice.call(arguments,1),C=typeof f=="function"?f:function(){this[f].apply(this,y)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(C),this};function ne(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=I(f)?f:[f];for(var y=0;y<f.length;y++)f[y]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var te={on:function(f,y,C){if(typeof f=="object")for(var A in f)this._on(A,f[A],y);else{f=_(f);for(var V=0,J=f.length;V<J;V++)this._on(f[V],y,C)}return this},off:function(f,y,C){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var A in f)this._off(A,f[A],y);else{f=_(f);for(var V=arguments.length===1,J=0,ge=f.length;J<ge;J++)V?this._off(f[J]):this._off(f[J],y,C)}return this},_on:function(f,y,C,A){if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}if(this._listens(f,y,C)===!1){C===this&&(C=void 0);var V={fn:y,ctx:C};A&&(V.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(V)}},_off:function(f,y,C){var A,V,J;if(this._events&&(A=this._events[f],!!A)){if(arguments.length===1){if(this._firingCount)for(V=0,J=A.length;V<J;V++)A[V].fn=p;delete this._events[f];return}if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}var ge=this._listens(f,y,C);if(ge!==!1){var Ce=A[ge];this._firingCount&&(Ce.fn=p,this._events[f]=A=A.slice()),A.splice(ge,1)}}},fire:function(f,y,C){if(!this.listens(f,C))return this;var A=s({},y,{type:f,target:this,sourceTarget:y&&y.sourceTarget||this});if(this._events){var V=this._events[f];if(V){this._firingCount=this._firingCount+1||1;for(var J=0,ge=V.length;J<ge;J++){var Ce=V[J],Oe=Ce.fn;Ce.once&&this.off(f,Oe,Ce.ctx),Oe.call(Ce.ctx||this,A)}this._firingCount--}}return C&&this._propagateEvent(A),this},listens:function(f,y,C,A){typeof f!="string"&&console.warn('"string" type argument expected');var V=y;typeof y!="function"&&(A=!!y,V=void 0,C=void 0);var J=this._events&&this._events[f];if(J&&J.length&&this._listens(f,V,C)!==!1)return!0;if(A){for(var ge in this._eventParents)if(this._eventParents[ge].listens(f,y,C,A))return!0}return!1},_listens:function(f,y,C){if(!this._events)return!1;var A=this._events[f]||[];if(!y)return!!A.length;C===this&&(C=void 0);for(var V=0,J=A.length;V<J;V++)if(A[V].fn===y&&A[V].ctx===C)return V;return!1},once:function(f,y,C){if(typeof f=="object")for(var A in f)this._on(A,f[A],y,!0);else{f=_(f);for(var V=0,J=f.length;V<J;V++)this._on(f[V],y,C,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[c(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[c(f)],this},_propagateEvent:function(f){for(var y in this._eventParents)this._eventParents[y].fire(f.type,s({layer:f.target,propagatedFrom:f.target},f),!0)}};te.addEventListener=te.on,te.removeEventListener=te.clearAllEventListeners=te.off,te.addOneTimeEventListener=te.once,te.fireEvent=te.fire,te.hasEventListeners=te.listens;var ie=Y.extend(te);function $(f,y,C){this.x=C?Math.round(f):f,this.y=C?Math.round(y):y}var H=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};$.prototype={clone:function(){return new $(this.x,this.y)},add:function(f){return this.clone()._add(se(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(se(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new $(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new $(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=H(this.x),this.y=H(this.y),this},distanceTo:function(f){f=se(f);var y=f.x-this.x,C=f.y-this.y;return Math.sqrt(y*y+C*C)},equals:function(f){return f=se(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=se(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function se(f,y,C){return f instanceof $?f:I(f)?new $(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new $(f.x,f.y):new $(f,y,C)}function W(f,y){if(f)for(var C=y?[f,y]:f,A=0,V=C.length;A<V;A++)this.extend(C[A])}W.prototype={extend:function(f){var y,C;if(!f)return this;if(f instanceof $||typeof f[0]=="number"||"x"in f)y=C=se(f);else if(f=ee(f),y=f.min,C=f.max,!y||!C)return this;return!this.min&&!this.max?(this.min=y.clone(),this.max=C.clone()):(this.min.x=Math.min(y.x,this.min.x),this.max.x=Math.max(C.x,this.max.x),this.min.y=Math.min(y.y,this.min.y),this.max.y=Math.max(C.y,this.max.y)),this},getCenter:function(f){return se((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return se(this.min.x,this.max.y)},getTopRight:function(){return se(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var y,C;return typeof f[0]=="number"||f instanceof $?f=se(f):f=ee(f),f instanceof W?(y=f.min,C=f.max):y=C=f,y.x>=this.min.x&&C.x<=this.max.x&&y.y>=this.min.y&&C.y<=this.max.y},intersects:function(f){f=ee(f);var y=this.min,C=this.max,A=f.min,V=f.max,J=V.x>=y.x&&A.x<=C.x,ge=V.y>=y.y&&A.y<=C.y;return J&&ge},overlaps:function(f){f=ee(f);var y=this.min,C=this.max,A=f.min,V=f.max,J=V.x>y.x&&A.x<C.x,ge=V.y>y.y&&A.y<C.y;return J&&ge},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var y=this.min,C=this.max,A=Math.abs(y.x-C.x)*f,V=Math.abs(y.y-C.y)*f;return ee(se(y.x-A,y.y-V),se(C.x+A,C.y+V))},equals:function(f){return f?(f=ee(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function ee(f,y){return!f||f instanceof W?f:new W(f,y)}function K(f,y){if(f)for(var C=y?[f,y]:f,A=0,V=C.length;A<V;A++)this.extend(C[A])}K.prototype={extend:function(f){var y=this._southWest,C=this._northEast,A,V;if(f instanceof re)A=f,V=f;else if(f instanceof K){if(A=f._southWest,V=f._northEast,!A||!V)return this}else return f?this.extend(me(f)||oe(f)):this;return!y&&!C?(this._southWest=new re(A.lat,A.lng),this._northEast=new re(V.lat,V.lng)):(y.lat=Math.min(A.lat,y.lat),y.lng=Math.min(A.lng,y.lng),C.lat=Math.max(V.lat,C.lat),C.lng=Math.max(V.lng,C.lng)),this},pad:function(f){var y=this._southWest,C=this._northEast,A=Math.abs(y.lat-C.lat)*f,V=Math.abs(y.lng-C.lng)*f;return new K(new re(y.lat-A,y.lng-V),new re(C.lat+A,C.lng+V))},getCenter:function(){return new re((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new re(this.getNorth(),this.getWest())},getSouthEast:function(){return new re(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof re||"lat"in f?f=me(f):f=oe(f);var y=this._southWest,C=this._northEast,A,V;return f instanceof K?(A=f.getSouthWest(),V=f.getNorthEast()):A=V=f,A.lat>=y.lat&&V.lat<=C.lat&&A.lng>=y.lng&&V.lng<=C.lng},intersects:function(f){f=oe(f);var y=this._southWest,C=this._northEast,A=f.getSouthWest(),V=f.getNorthEast(),J=V.lat>=y.lat&&A.lat<=C.lat,ge=V.lng>=y.lng&&A.lng<=C.lng;return J&&ge},overlaps:function(f){f=oe(f);var y=this._southWest,C=this._northEast,A=f.getSouthWest(),V=f.getNorthEast(),J=V.lat>y.lat&&A.lat<C.lat,ge=V.lng>y.lng&&A.lng<C.lng;return J&&ge},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,y){return f?(f=oe(f),this._southWest.equals(f.getSouthWest(),y)&&this._northEast.equals(f.getNorthEast(),y)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function oe(f,y){return f instanceof K?f:new K(f,y)}function re(f,y,C){if(isNaN(f)||isNaN(y))throw new Error("Invalid LatLng object: ("+f+", "+y+")");this.lat=+f,this.lng=+y,C!==void 0&&(this.alt=+C)}re.prototype={equals:function(f,y){if(!f)return!1;f=me(f);var C=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return C<=(y===void 0?1e-9:y)},toString:function(f){return"LatLng("+x(this.lat,f)+", "+x(this.lng,f)+")"},distanceTo:function(f){return le.distance(this,me(f))},wrap:function(){return le.wrapLatLng(this)},toBounds:function(f){var y=180*f/40075017,C=y/Math.cos(Math.PI/180*this.lat);return oe([this.lat-y,this.lng-C],[this.lat+y,this.lng+C])},clone:function(){return new re(this.lat,this.lng,this.alt)}};function me(f,y,C){return f instanceof re?f:I(f)&&typeof f[0]!="object"?f.length===3?new re(f[0],f[1],f[2]):f.length===2?new re(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new re(f.lat,"lng"in f?f.lng:f.lon,f.alt):y===void 0?null:new re(f,y,C)}var _e={latLngToPoint:function(f,y){var C=this.projection.project(f),A=this.scale(y);return this.transformation._transform(C,A)},pointToLatLng:function(f,y){var C=this.scale(y),A=this.transformation.untransform(f,C);return this.projection.unproject(A)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var y=this.projection.bounds,C=this.scale(f),A=this.transformation.transform(y.min,C),V=this.transformation.transform(y.max,C);return new W(A,V)},infinite:!1,wrapLatLng:function(f){var y=this.wrapLng?m(f.lng,this.wrapLng,!0):f.lng,C=this.wrapLat?m(f.lat,this.wrapLat,!0):f.lat,A=f.alt;return new re(C,y,A)},wrapLatLngBounds:function(f){var y=f.getCenter(),C=this.wrapLatLng(y),A=y.lat-C.lat,V=y.lng-C.lng;if(A===0&&V===0)return f;var J=f.getSouthWest(),ge=f.getNorthEast(),Ce=new re(J.lat-A,J.lng-V),Oe=new re(ge.lat-A,ge.lng-V);return new K(Ce,Oe)}},le=s({},_e,{wrapLng:[-180,180],R:6371e3,distance:function(f,y){var C=Math.PI/180,A=f.lat*C,V=y.lat*C,J=Math.sin((y.lat-f.lat)*C/2),ge=Math.sin((y.lng-f.lng)*C/2),Ce=J*J+Math.cos(A)*Math.cos(V)*ge*ge,Oe=2*Math.atan2(Math.sqrt(Ce),Math.sqrt(1-Ce));return this.R*Oe}}),fe=6378137,ue={R:fe,MAX_LATITUDE:85.0511287798,project:function(f){var y=Math.PI/180,C=this.MAX_LATITUDE,A=Math.max(Math.min(C,f.lat),-C),V=Math.sin(A*y);return new $(this.R*f.lng*y,this.R*Math.log((1+V)/(1-V))/2)},unproject:function(f){var y=180/Math.PI;return new re((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*y,f.x*y/this.R)},bounds:(function(){var f=fe*Math.PI;return new W([-f,-f],[f,f])})()};function ce(f,y,C,A){if(I(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=y,this._c=C,this._d=A}ce.prototype={transform:function(f,y){return this._transform(f.clone(),y)},_transform:function(f,y){return y=y||1,f.x=y*(this._a*f.x+this._b),f.y=y*(this._c*f.y+this._d),f},untransform:function(f,y){return y=y||1,new $((f.x/y-this._b)/this._a,(f.y/y-this._d)/this._c)}};function Se(f,y,C,A){return new ce(f,y,C,A)}var ye=s({},le,{code:"EPSG:3857",projection:ue,transformation:(function(){var f=.5/(Math.PI*ue.R);return Se(f,.5,-f,.5)})()}),Ne=s({},ye,{code:"EPSG:900913"});function ke(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function qe(f,y){var C="",A,V,J,ge,Ce,Oe;for(A=0,J=f.length;A<J;A++){for(Ce=f[A],V=0,ge=Ce.length;V<ge;V++)Oe=Ce[V],C+=(V?"L":"M")+Oe.x+" "+Oe.y;C+=y?dt.svg?"z":"x":""}return C||"M0 0"}var ze=document.documentElement.style,He="ActiveXObject"in window,Be=He&&!document.addEventListener,de="msLaunchUri"in navigator&&!("documentMode"in document),xe=lr("webkit"),Pe=lr("android"),Ge=lr("android 2")||lr("android 3"),Fe=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Le=Pe&&lr("Google")&&Fe<537&&!("AudioNode"in window),Je=!!window.opera,nt=!de&&lr("chrome"),ct=lr("gecko")&&!xe&&!Je&&!He,Vt=!nt&&lr("safari"),At=lr("phantom"),vt="OTransition"in ze,wn=navigator.platform.indexOf("Win")===0,Pn=He&&"transition"in ze,Ht="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ge,Un="MozPerspective"in ze,Mn=!window.L_DISABLE_3D&&(Pn||Ht||Un)&&!vt&&!At,An=typeof orientation<"u"||lr("mobile"),Pr=An&&xe,$r=An&&Ht,un=!window.PointerEvent&&window.MSPointerEvent,ot=!!(window.PointerEvent||un),kn="ontouchstart"in window||!!window.TouchEvent,Xn=!window.L_NO_TOUCH&&(kn||ot),Hs=An&&Je,wo=An&&ct,Pl=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ml=(function(){var f=!1;try{var y=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",p,y),window.removeEventListener("testPassiveEventSupport",p,y)}catch{}return f})(),So=(function(){return!!document.createElement("canvas").getContext})(),Ea=!!(document.createElementNS&&ke("svg").createSVGRect),Gi=!!Ea&&(function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),jo=!Ea&&(function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var y=f.firstChild;return y.style.behavior="url(#default#VML)",y&&typeof y.adj=="object"}catch{return!1}})(),Zi=navigator.platform.indexOf("Mac")===0,id=navigator.platform.indexOf("Linux")===0;function lr(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var dt={ie:He,ielt9:Be,edge:de,webkit:xe,android:Pe,android23:Ge,androidStock:Le,opera:Je,chrome:nt,gecko:ct,safari:Vt,phantom:At,opera12:vt,win:wn,ie3d:Pn,webkit3d:Ht,gecko3d:Un,any3d:Mn,mobile:An,mobileWebkit:Pr,mobileWebkit3d:$r,msPointer:un,pointer:ot,touch:Xn,touchNative:kn,mobileOpera:Hs,mobileGecko:wo,retina:Pl,passiveEvents:Ml,canvas:So,svg:Ea,vml:jo,inlineSvg:Gi,mac:Zi,linux:id},Ki=dt.msPointer?"MSPointerDown":"pointerdown",Da=dt.msPointer?"MSPointerMove":"pointermove",kl=dt.msPointer?"MSPointerUp":"pointerup",El=dt.msPointer?"MSPointerCancel":"pointercancel",No={touchstart:Ki,touchmove:Da,touchend:kl,touchcancel:El},Ss={touchstart:Sn,touchmove:Oa,touchend:Oa,touchcancel:Oa},Ys={},Co=!1;function ad(f,y,C){return y==="touchstart"&&od(),Ss[y]?(C=Ss[y].bind(this,C),f.addEventListener(No[y],C,!1),C):(console.warn("wrong event specified:",y),p)}function Dl(f,y,C){if(!No[y]){console.warn("wrong event specified:",y);return}f.removeEventListener(No[y],C,!1)}function Ol(f){Ys[f.pointerId]=f}function Il(f){Ys[f.pointerId]&&(Ys[f.pointerId]=f)}function To(f){delete Ys[f.pointerId]}function od(){Co||(document.addEventListener(Ki,Ol,!0),document.addEventListener(Da,Il,!0),document.addEventListener(kl,To,!0),document.addEventListener(El,To,!0),Co=!0)}function Oa(f,y){if(y.pointerType!==(y.MSPOINTER_TYPE_MOUSE||"mouse")){y.touches=[];for(var C in Ys)y.touches.push(Ys[C]);y.changedTouches=[y],f(y)}}function Sn(f,y){y.MSPOINTER_TYPE_TOUCH&&y.pointerType===y.MSPOINTER_TYPE_TOUCH&&jn(y),Oa(f,y)}function ld(f){var y={},C,A;for(A in f)C=f[A],y[A]=C&&C.bind?C.bind(f):C;return f=y,y.type="dblclick",y.detail=2,y.isTrusted=!1,y._simulated=!0,y}var Po=200;function Al(f,y){f.addEventListener("dblclick",y);var C=0,A;function V(J){if(J.detail!==1){A=J.detail;return}if(!(J.pointerType==="mouse"||J.sourceCapabilities&&!J.sourceCapabilities.firesTouchEvents)){var ge=Ks(J);if(!(ge.some(function(Oe){return Oe instanceof HTMLLabelElement&&Oe.attributes.for})&&!ge.some(function(Oe){return Oe instanceof HTMLInputElement||Oe instanceof HTMLSelectElement}))){var Ce=Date.now();Ce-C<=Po?(A++,A===2&&y(ld(J))):A=1,C=Ce}}}return f.addEventListener("click",V),{dblclick:y,simDblclick:V}}function Ia(f,y){f.removeEventListener("dblclick",y.dblclick),f.removeEventListener("click",y.simDblclick)}var Mo=vi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),gi=vi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Ji=gi==="webkitTransition"||gi==="OTransition"?gi+"End":"transitionend";function Ir(f){return typeof f=="string"?document.getElementById(f):f}function Qi(f,y){var C=f.style[y]||f.currentStyle&&f.currentStyle[y];if((!C||C==="auto")&&document.defaultView){var A=document.defaultView.getComputedStyle(f,null);C=A?A[y]:null}return C==="auto"?null:C}function Mt(f,y,C){var A=document.createElement(f);return A.className=y||"",C&&C.appendChild(A),A}function pn(f){var y=f.parentNode;y&&y.removeChild(f)}function Aa(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function xi(f){var y=f.parentNode;y&&y.lastChild!==f&&y.appendChild(f)}function os(f){var y=f.parentNode;y&&y.firstChild!==f&&y.insertBefore(f,y.firstChild)}function yi(f,y){if(f.classList!==void 0)return f.classList.contains(y);var C=Ra(f);return C.length>0&&new RegExp("(^|\\s)"+y+"(\\s|$)").test(C)}function Pt(f,y){if(f.classList!==void 0)for(var C=_(y),A=0,V=C.length;A<V;A++)f.classList.add(C[A]);else if(!yi(f,y)){var J=Ra(f);ko(f,(J?J+" ":"")+y)}}function fn(f,y){f.classList!==void 0?f.classList.remove(y):ko(f,v((" "+Ra(f)+" ").replace(" "+y+" "," ")))}function ko(f,y){f.className.baseVal===void 0?f.className=y:f.className.baseVal=y}function Ra(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function cr(f,y){"opacity"in f.style?f.style.opacity=y:"filter"in f.style&&Rl(f,y)}function Rl(f,y){var C=!1,A="DXImageTransform.Microsoft.Alpha";try{C=f.filters.item(A)}catch{if(y===1)return}y=Math.round(y*100),C?(C.Enabled=y!==100,C.Opacity=y):f.style.filter+=" progid:"+A+"(opacity="+y+")"}function vi(f){for(var y=document.documentElement.style,C=0;C<f.length;C++)if(f[C]in y)return f[C];return!1}function Ar(f,y,C){var A=y||new $(0,0);f.style[Mo]=(dt.ie3d?"translate("+A.x+"px,"+A.y+"px)":"translate3d("+A.x+"px,"+A.y+"px,0)")+(C?" scale("+C+")":"")}function En(f,y){f._leaflet_pos=y,dt.any3d?Ar(f,y):(f.style.left=y.x+"px",f.style.top=y.y+"px")}function ls(f){return f._leaflet_pos||new $(0,0)}var $t,bi,La;if("onselectstart"in document)$t=function(){jt(window,"selectstart",jn)},bi=function(){nn(window,"selectstart",jn)};else{var Gs=vi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);$t=function(){if(Gs){var f=document.documentElement.style;La=f[Gs],f[Gs]="none"}},bi=function(){Gs&&(document.documentElement.style[Gs]=La,La=void 0)}}function Fa(){jt(window,"dragstart",jn)}function qa(){nn(window,"dragstart",jn)}var Xi,ea;function _i(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(Rr(),Xi=f,ea=f.style.outlineStyle,f.style.outlineStyle="none",jt(window,"keydown",Rr))}function Rr(){Xi&&(Xi.style.outlineStyle=ea,Xi=void 0,ea=void 0,nn(window,"keydown",Rr))}function cs(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function Hr(f){var y=f.getBoundingClientRect();return{x:y.width/f.offsetWidth||1,y:y.height/f.offsetHeight||1,boundingClientRect:y}}var ta={__proto__:null,TRANSFORM:Mo,TRANSITION:gi,TRANSITION_END:Ji,get:Ir,getStyle:Qi,create:Mt,remove:pn,empty:Aa,toFront:xi,toBack:os,hasClass:yi,addClass:Pt,removeClass:fn,setClass:ko,getClass:Ra,setOpacity:cr,testProp:vi,setTransform:Ar,setPosition:En,getPosition:ls,get disableTextSelection(){return $t},get enableTextSelection(){return bi},disableImageDrag:Fa,enableImageDrag:qa,preventOutline:_i,restoreOutline:Rr,getSizedParentNode:cs,getScale:Hr};function jt(f,y,C,A){if(y&&typeof y=="object")for(var V in y)Do(f,V,y[V],C);else{y=_(y);for(var J=0,ge=y.length;J<ge;J++)Do(f,y[J],C,A)}return this}var $n="_leaflet_events";function nn(f,y,C,A){if(arguments.length===1)Eo(f),delete f[$n];else if(y&&typeof y=="object")for(var V in y)za(f,V,y[V],C);else if(y=_(y),arguments.length===2)Eo(f,function(Ce){return M(y,Ce)!==-1});else for(var J=0,ge=y.length;J<ge;J++)za(f,y[J],C,A);return this}function Eo(f,y){for(var C in f[$n]){var A=C.split(/\d/)[0];(!y||y(A))&&za(f,A,null,null,C)}}var Zs={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Do(f,y,C,A){var V=y+c(C)+(A?"_"+c(A):"");if(f[$n]&&f[$n][V])return this;var J=function(Ce){return C.call(A||f,Ce||window.event)},ge=J;!dt.touchNative&&dt.pointer&&y.indexOf("touch")===0?J=ad(f,y,J):dt.touch&&y==="dblclick"?J=Al(f,J):"addEventListener"in f?y==="touchstart"||y==="touchmove"||y==="wheel"||y==="mousewheel"?f.addEventListener(Zs[y]||y,J,dt.passiveEvents?{passive:!1}:!1):y==="mouseenter"||y==="mouseleave"?(J=function(Ce){Ce=Ce||window.event,sa(f,Ce)&&ge(Ce)},f.addEventListener(Zs[y],J,!1)):f.addEventListener(y,ge,!1):f.attachEvent("on"+y,J),f[$n]=f[$n]||{},f[$n][V]=J}function za(f,y,C,A,V){V=V||y+c(C)+(A?"_"+c(A):"");var J=f[$n]&&f[$n][V];if(!J)return this;!dt.touchNative&&dt.pointer&&y.indexOf("touch")===0?Dl(f,y,J):dt.touch&&y==="dblclick"?Ia(f,J):"removeEventListener"in f?f.removeEventListener(Zs[y]||y,J,!1):f.detachEvent("on"+y,J),f[$n][V]=null}function Yr(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function Ua(f){return Do(f,"wheel",Yr),this}function na(f){return jt(f,"mousedown touchstart dblclick contextmenu",Yr),f._leaflet_disable_click=!0,this}function jn(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function Lr(f){return jn(f),Yr(f),this}function Ks(f){if(f.composedPath)return f.composedPath();for(var y=[],C=f.target;C;)y.push(C),C=C.parentNode;return y}function ra(f,y){if(!y)return new $(f.clientX,f.clientY);var C=Hr(y),A=C.boundingClientRect;return new $((f.clientX-A.left)/C.x-y.clientLeft,(f.clientY-A.top)/C.y-y.clientTop)}var cd=dt.linux&&dt.chrome?window.devicePixelRatio:dt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ll(f){return dt.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/cd:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function sa(f,y){var C=y.relatedTarget;if(!C)return!0;try{for(;C&&C!==f;)C=C.parentNode}catch{return!1}return C!==f}var Va={__proto__:null,on:jt,off:nn,stopPropagation:Yr,disableScrollPropagation:Ua,disableClickPropagation:na,preventDefault:jn,stop:Lr,getPropagationPath:Ks,getMousePosition:ra,getWheelDelta:Ll,isExternalTarget:sa,addListener:jt,removeListener:nn},Ba=ie.extend({run:function(f,y,C,A){this.stop(),this._el=f,this._inProgress=!0,this._duration=C||.25,this._easeOutPower=1/Math.max(A||.5,.2),this._startPos=ls(f),this._offset=y.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=G(this._animate,this),this._step()},_step:function(f){var y=+new Date-this._startTime,C=this._duration*1e3;y<C?this._runFrame(this._easeOut(y/C),f):(this._runFrame(1),this._complete())},_runFrame:function(f,y){var C=this._startPos.add(this._offset.multiplyBy(f));y&&C._round(),En(this._el,C),this.fire("step")},_complete:function(){X(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),Ut=ie.extend({options:{crs:ye,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,y){y=w(this,y),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),y.maxBounds&&this.setMaxBounds(y.maxBounds),y.zoom!==void 0&&(this._zoom=this._limitZoom(y.zoom)),y.center&&y.zoom!==void 0&&this.setView(me(y.center),y.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=gi&&dt.any3d&&!dt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),jt(this._proxy,Ji,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,y,C){if(y=y===void 0?this._zoom:this._limitZoom(y),f=this._limitCenter(me(f),y,this.options.maxBounds),C=C||{},this._stop(),this._loaded&&!C.reset&&C!==!0){C.animate!==void 0&&(C.zoom=s({animate:C.animate},C.zoom),C.pan=s({animate:C.animate,duration:C.duration},C.pan));var A=this._zoom!==y?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,y,C.zoom):this._tryAnimatedPan(f,C.pan);if(A)return clearTimeout(this._sizeTimer),this}return this._resetView(f,y,C.pan&&C.pan.noMoveStart),this},setZoom:function(f,y){return this._loaded?this.setView(this.getCenter(),f,{zoom:y}):(this._zoom=f,this)},zoomIn:function(f,y){return f=f||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,y)},zoomOut:function(f,y){return f=f||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,y)},setZoomAround:function(f,y,C){var A=this.getZoomScale(y),V=this.getSize().divideBy(2),J=f instanceof $?f:this.latLngToContainerPoint(f),ge=J.subtract(V).multiplyBy(1-1/A),Ce=this.containerPointToLatLng(V.add(ge));return this.setView(Ce,y,{zoom:C})},_getBoundsCenterZoom:function(f,y){y=y||{},f=f.getBounds?f.getBounds():oe(f);var C=se(y.paddingTopLeft||y.padding||[0,0]),A=se(y.paddingBottomRight||y.padding||[0,0]),V=this.getBoundsZoom(f,!1,C.add(A));if(V=typeof y.maxZoom=="number"?Math.min(y.maxZoom,V):V,V===1/0)return{center:f.getCenter(),zoom:V};var J=A.subtract(C).divideBy(2),ge=this.project(f.getSouthWest(),V),Ce=this.project(f.getNorthEast(),V),Oe=this.unproject(ge.add(Ce).divideBy(2).add(J),V);return{center:Oe,zoom:V}},fitBounds:function(f,y){if(f=oe(f),!f.isValid())throw new Error("Bounds are not valid.");var C=this._getBoundsCenterZoom(f,y);return this.setView(C.center,C.zoom,y)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,y){return this.setView(f,this._zoom,{pan:y})},panBy:function(f,y){if(f=se(f).round(),y=y||{},!f.x&&!f.y)return this.fire("moveend");if(y.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ba,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),y.noMoveStart||this.fire("movestart"),y.animate!==!1){Pt(this._mapPane,"leaflet-pan-anim");var C=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,C,y.duration||.25,y.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,y,C){if(C=C||{},C.animate===!1||!dt.any3d)return this.setView(f,y,C);this._stop();var A=this.project(this.getCenter()),V=this.project(f),J=this.getSize(),ge=this._zoom;f=me(f),y=y===void 0?ge:y;var Ce=Math.max(J.x,J.y),Oe=Ce*this.getZoomScale(ge,y),Ve=V.distanceTo(A)||1,rt=1.42,_t=rt*rt;function zt(hn){var ac=hn?-1:1,jy=hn?Oe:Ce,Ny=Oe*Oe-Ce*Ce+ac*_t*_t*Ve*Ve,Zo=2*jy*_t*Ve,Ko=Ny/Zo,Jo=Math.sqrt(Ko*Ko+1)-Ko,Cu=Jo<1e-9?-18:Math.log(Jo);return Cu}function _r(hn){return(Math.exp(hn)-Math.exp(-hn))/2}function ur(hn){return(Math.exp(hn)+Math.exp(-hn))/2}function hs(hn){return _r(hn)/ur(hn)}var Zr=zt(0);function sc(hn){return Ce*(ur(Zr)/ur(Zr+rt*hn))}function Yf(hn){return Ce*(ur(Zr)*hs(Zr+rt*hn)-_r(Zr))/_t}function no(hn){return 1-Math.pow(1-hn,1.5)}var Dm=Date.now(),Go=(zt(1)-Zr)/rt,Mi=C.duration?1e3*C.duration:1e3*Go*.8;function ic(){var hn=(Date.now()-Dm)/Mi,ac=no(hn)*Go;hn<=1?(this._flyToFrame=G(ic,this),this._move(this.unproject(A.add(V.subtract(A).multiplyBy(Yf(ac)/Ve)),ge),this.getScaleZoom(Ce/sc(ac),ge),{flyTo:!0})):this._move(f,y)._moveEnd(!0)}return this._moveStart(!0,C.noMoveStart),ic.call(this),this},flyToBounds:function(f,y){var C=this._getBoundsCenterZoom(f,y);return this.flyTo(C.center,C.zoom,y)},setMaxBounds:function(f){return f=oe(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var y=this.options.minZoom;return this.options.minZoom=f,this._loaded&&y!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var y=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&y!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,y){this._enforcingBounds=!0;var C=this.getCenter(),A=this._limitCenter(C,this._zoom,oe(f));return C.equals(A)||this.panTo(A,y),this._enforcingBounds=!1,this},panInside:function(f,y){y=y||{};var C=se(y.paddingTopLeft||y.padding||[0,0]),A=se(y.paddingBottomRight||y.padding||[0,0]),V=this.project(this.getCenter()),J=this.project(f),ge=this.getPixelBounds(),Ce=ee([ge.min.add(C),ge.max.subtract(A)]),Oe=Ce.getSize();if(!Ce.contains(J)){this._enforcingBounds=!0;var Ve=J.subtract(Ce.getCenter()),rt=Ce.extend(J).getSize().subtract(Oe);V.x+=Ve.x<0?-rt.x:rt.x,V.y+=Ve.y<0?-rt.y:rt.y,this.panTo(this.unproject(V),y),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=s({animate:!1,pan:!0},f===!0?{animate:!0}:f);var y=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var C=this.getSize(),A=y.divideBy(2).round(),V=C.divideBy(2).round(),J=A.subtract(V);return!J.x&&!J.y?this:(f.animate&&f.pan?this.panBy(J):(f.pan&&this._rawPanBy(J),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:y,newSize:C}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=s({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var y=o(this._handleGeolocationResponse,this),C=o(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(y,C,f):navigator.geolocation.getCurrentPosition(y,C,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var y=f.code,C=f.message||(y===1?"permission denied":y===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:y,message:"Geolocation error: "+C+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var y=f.coords.latitude,C=f.coords.longitude,A=new re(y,C),V=A.toBounds(f.coords.accuracy*2),J=this._locateOptions;if(J.setView){var ge=this.getBoundsZoom(V);this.setView(A,J.maxZoom?Math.min(ge,J.maxZoom):ge)}var Ce={latlng:A,bounds:V,timestamp:f.timestamp};for(var Oe in f.coords)typeof f.coords[Oe]=="number"&&(Ce[Oe]=f.coords[Oe]);this.fire("locationfound",Ce)}},addHandler:function(f,y){if(!y)return this;var C=this[f]=new y(this);return this._handlers.push(C),this.options[f]&&C.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),pn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(X(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)pn(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,y){var C="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),A=Mt("div",C,y||this._mapPane);return f&&(this._panes[f]=A),A},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),y=this.unproject(f.getBottomLeft()),C=this.unproject(f.getTopRight());return new K(y,C)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,y,C){f=oe(f),C=se(C||[0,0]);var A=this.getZoom()||0,V=this.getMinZoom(),J=this.getMaxZoom(),ge=f.getNorthWest(),Ce=f.getSouthEast(),Oe=this.getSize().subtract(C),Ve=ee(this.project(Ce,A),this.project(ge,A)).getSize(),rt=dt.any3d?this.options.zoomSnap:1,_t=Oe.x/Ve.x,zt=Oe.y/Ve.y,_r=y?Math.max(_t,zt):Math.min(_t,zt);return A=this.getScaleZoom(_r,A),rt&&(A=Math.round(A/(rt/100))*(rt/100),A=y?Math.ceil(A/rt)*rt:Math.floor(A/rt)*rt),Math.max(V,Math.min(J,A))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new $(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,y){var C=this._getTopLeftPoint(f,y);return new W(C,C.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,y){var C=this.options.crs;return y=y===void 0?this._zoom:y,C.scale(f)/C.scale(y)},getScaleZoom:function(f,y){var C=this.options.crs;y=y===void 0?this._zoom:y;var A=C.zoom(f*C.scale(y));return isNaN(A)?1/0:A},project:function(f,y){return y=y===void 0?this._zoom:y,this.options.crs.latLngToPoint(me(f),y)},unproject:function(f,y){return y=y===void 0?this._zoom:y,this.options.crs.pointToLatLng(se(f),y)},layerPointToLatLng:function(f){var y=se(f).add(this.getPixelOrigin());return this.unproject(y)},latLngToLayerPoint:function(f){var y=this.project(me(f))._round();return y._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(me(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(oe(f))},distance:function(f,y){return this.options.crs.distance(me(f),me(y))},containerPointToLayerPoint:function(f){return se(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return se(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var y=this.containerPointToLayerPoint(se(f));return this.layerPointToLatLng(y)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(me(f)))},mouseEventToContainerPoint:function(f){return ra(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var y=this._container=Ir(f);if(y){if(y._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");jt(y,"scroll",this._onScroll,this),this._containerId=c(y)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&dt.any3d,Pt(f,"leaflet-container"+(dt.touch?" leaflet-touch":"")+(dt.retina?" leaflet-retina":"")+(dt.ielt9?" leaflet-oldie":"")+(dt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var y=Qi(f,"position");y!=="absolute"&&y!=="relative"&&y!=="fixed"&&y!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),En(this._mapPane,new $(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Pt(f.markerPane,"leaflet-zoom-hide"),Pt(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,y,C){En(this._mapPane,new $(0,0));var A=!this._loaded;this._loaded=!0,y=this._limitZoom(y),this.fire("viewprereset");var V=this._zoom!==y;this._moveStart(V,C)._move(f,y)._moveEnd(V),this.fire("viewreset"),A&&this.fire("load")},_moveStart:function(f,y){return f&&this.fire("zoomstart"),y||this.fire("movestart"),this},_move:function(f,y,C,A){y===void 0&&(y=this._zoom);var V=this._zoom!==y;return this._zoom=y,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),A?C&&C.pinch&&this.fire("zoom",C):((V||C&&C.pinch)&&this.fire("zoom",C),this.fire("move",C)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return X(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){En(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[c(this._container)]=this;var y=f?nn:jt;y(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&y(window,"resize",this._onResize,this),dt.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){X(this._resizeRequest),this._resizeRequest=G(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,y){for(var C=[],A,V=y==="mouseout"||y==="mouseover",J=f.target||f.srcElement,ge=!1;J;){if(A=this._targets[c(J)],A&&(y==="click"||y==="preclick")&&this._draggableMoved(A)){ge=!0;break}if(A&&A.listens(y,!0)&&(V&&!sa(J,f)||(C.push(A),V))||J===this._container)break;J=J.parentNode}return!C.length&&!ge&&!V&&this.listens(y,!0)&&(C=[this]),C},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var y=f.target||f.srcElement;if(!(!this._loaded||y._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(y))){var C=f.type;C==="mousedown"&&_i(y),this._fireDOMEvent(f,C)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,y,C){if(f.type==="click"){var A=s({},f);A.type="preclick",this._fireDOMEvent(A,A.type,C)}var V=this._findEventTargets(f,y);if(C){for(var J=[],ge=0;ge<C.length;ge++)C[ge].listens(y,!0)&&J.push(C[ge]);V=J.concat(V)}if(V.length){y==="contextmenu"&&jn(f);var Ce=V[0],Oe={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var Ve=Ce.getLatLng&&(!Ce._radius||Ce._radius<=10);Oe.containerPoint=Ve?this.latLngToContainerPoint(Ce.getLatLng()):this.mouseEventToContainerPoint(f),Oe.layerPoint=this.containerPointToLayerPoint(Oe.containerPoint),Oe.latlng=Ve?Ce.getLatLng():this.layerPointToLatLng(Oe.layerPoint)}for(ge=0;ge<V.length;ge++)if(V[ge].fire(y,Oe,!0),Oe.originalEvent._stopped||V[ge].options.bubblingMouseEvents===!1&&M(this._mouseEvents,y)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,y=this._handlers.length;f<y;f++)this._handlers[f].disable()},whenReady:function(f,y){return this._loaded?f.call(y||this,{target:this}):this.on("load",f,y),this},_getMapPanePos:function(){return ls(this._mapPane)||new $(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,y){var C=f&&y!==void 0?this._getNewPixelOrigin(f,y):this.getPixelOrigin();return C.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,y){var C=this.getSize()._divideBy(2);return this.project(f,y)._subtract(C)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,y,C){var A=this._getNewPixelOrigin(C,y);return this.project(f,y)._subtract(A)},_latLngBoundsToNewLayerBounds:function(f,y,C){var A=this._getNewPixelOrigin(C,y);return ee([this.project(f.getSouthWest(),y)._subtract(A),this.project(f.getNorthWest(),y)._subtract(A),this.project(f.getSouthEast(),y)._subtract(A),this.project(f.getNorthEast(),y)._subtract(A)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,y,C){if(!C)return f;var A=this.project(f,y),V=this.getSize().divideBy(2),J=new W(A.subtract(V),A.add(V)),ge=this._getBoundsOffset(J,C,y);return Math.abs(ge.x)<=1&&Math.abs(ge.y)<=1?f:this.unproject(A.add(ge),y)},_limitOffset:function(f,y){if(!y)return f;var C=this.getPixelBounds(),A=new W(C.min.add(f),C.max.add(f));return f.add(this._getBoundsOffset(A,y))},_getBoundsOffset:function(f,y,C){var A=ee(this.project(y.getNorthEast(),C),this.project(y.getSouthWest(),C)),V=A.min.subtract(f.min),J=A.max.subtract(f.max),ge=this._rebound(V.x,-J.x),Ce=this._rebound(V.y,-J.y);return new $(ge,Ce)},_rebound:function(f,y){return f+y>0?Math.round(f-y)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(y))},_limitZoom:function(f){var y=this.getMinZoom(),C=this.getMaxZoom(),A=dt.any3d?this.options.zoomSnap:1;return A&&(f=Math.round(f/A)*A),Math.max(y,Math.min(C,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){fn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,y){var C=this._getCenterOffset(f)._trunc();return(y&&y.animate)!==!0&&!this.getSize().contains(C)?!1:(this.panBy(C,y),!0)},_createAnimProxy:function(){var f=this._proxy=Mt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(y){var C=Mo,A=this._proxy.style[C];Ar(this._proxy,this.project(y.center,y.zoom),this.getZoomScale(y.zoom,1)),A===this._proxy.style[C]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){pn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),y=this.getZoom();Ar(this._proxy,this.project(f,y),this.getZoomScale(y,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,y,C){if(this._animatingZoom)return!0;if(C=C||{},!this._zoomAnimated||C.animate===!1||this._nothingToAnimate()||Math.abs(y-this._zoom)>this.options.zoomAnimationThreshold)return!1;var A=this.getZoomScale(y),V=this._getCenterOffset(f)._divideBy(1-1/A);return C.animate!==!0&&!this.getSize().contains(V)?!1:(G(function(){this._moveStart(!0,C.noMoveStart||!1)._animateZoom(f,y,!0)},this),!0)},_animateZoom:function(f,y,C,A){this._mapPane&&(C&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=y,Pt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:y,noUpdate:A}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&fn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function js(f,y){return new Ut(f,y)}var vr=Y.extend({options:{position:"topright"},initialize:function(f){w(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var y=this._map;return y&&y.removeControl(this),this.options.position=f,y&&y.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var y=this._container=this.onAdd(f),C=this.getPosition(),A=f._controlCorners[C];return Pt(y,"leaflet-control"),C.indexOf("bottom")!==-1?A.insertBefore(y,A.firstChild):A.appendChild(y),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(pn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),Ns=function(f){return new vr(f)};Ut.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},y="leaflet-",C=this._controlContainer=Mt("div",y+"control-container",this._container);function A(V,J){var ge=y+V+" "+y+J;f[V+J]=Mt("div",ge,C)}A("top","left"),A("top","right"),A("bottom","left"),A("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)pn(this._controlCorners[f]);pn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Oo=vr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,y,C,A){return C<A?-1:A<C?1:0}},initialize:function(f,y,C){w(this,C),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var A in f)this._addLayer(f[A],A);for(A in y)this._addLayer(y[A],A,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var y=0;y<this._layers.length;y++)this._layers[y].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return vr.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,y){return this._addLayer(f,y),this._map?this._update():this},addOverlay:function(f,y){return this._addLayer(f,y,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var y=this._getLayer(c(f));return y&&this._layers.splice(this._layers.indexOf(y),1),this._map?this._update():this},expand:function(){Pt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(Pt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):fn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return fn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",y=this._container=Mt("div",f),C=this.options.collapsed;y.setAttribute("aria-haspopup",!0),na(y),Ua(y);var A=this._section=Mt("section",f+"-list");C&&(this._map.on("click",this.collapse,this),jt(y,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var V=this._layersLink=Mt("a",f+"-toggle",y);V.href="#",V.title="Layers",V.setAttribute("role","button"),jt(V,{keydown:function(J){J.keyCode===13&&this._expandSafely()},click:function(J){jn(J),this._expandSafely()}},this),C||this.expand(),this._baseLayersList=Mt("div",f+"-base",A),this._separator=Mt("div",f+"-separator",A),this._overlaysList=Mt("div",f+"-overlays",A),y.appendChild(A)},_getLayer:function(f){for(var y=0;y<this._layers.length;y++)if(this._layers[y]&&c(this._layers[y].layer)===f)return this._layers[y]},_addLayer:function(f,y,C){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:y,overlay:C}),this.options.sortLayers&&this._layers.sort(o(function(A,V){return this.options.sortFunction(A.layer,V.layer,A.name,V.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Aa(this._baseLayersList),Aa(this._overlaysList),this._layerControlInputs=[];var f,y,C,A,V=0;for(C=0;C<this._layers.length;C++)A=this._layers[C],this._addItem(A),y=y||A.overlay,f=f||!A.overlay,V+=A.overlay?0:1;return this.options.hideSingleBase&&(f=f&&V>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=y&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var y=this._getLayer(c(f.target)),C=y.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;C&&this._map.fire(C,y)},_createRadioElement:function(f,y){var C='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(y?' checked="checked"':"")+"/>",A=document.createElement("div");return A.innerHTML=C,A.firstChild},_addItem:function(f){var y=document.createElement("label"),C=this._map.hasLayer(f.layer),A;f.overlay?(A=document.createElement("input"),A.type="checkbox",A.className="leaflet-control-layers-selector",A.defaultChecked=C):A=this._createRadioElement("leaflet-base-layers_"+c(this),C),this._layerControlInputs.push(A),A.layerId=c(f.layer),jt(A,"click",this._onInputClick,this);var V=document.createElement("span");V.innerHTML=" "+f.name;var J=document.createElement("span");y.appendChild(J),J.appendChild(A),J.appendChild(V);var ge=f.overlay?this._overlaysList:this._baseLayersList;return ge.appendChild(y),this._checkDisabledLayers(),y},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,y,C,A=[],V=[];this._handlingClick=!0;for(var J=f.length-1;J>=0;J--)y=f[J],C=this._getLayer(y.layerId).layer,y.checked?A.push(C):y.checked||V.push(C);for(J=0;J<V.length;J++)this._map.hasLayer(V[J])&&this._map.removeLayer(V[J]);for(J=0;J<A.length;J++)this._map.hasLayer(A[J])||this._map.addLayer(A[J]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,y,C,A=this._map.getZoom(),V=f.length-1;V>=0;V--)y=f[V],C=this._getLayer(y.layerId).layer,y.disabled=C.options.minZoom!==void 0&&A<C.options.minZoom||C.options.maxZoom!==void 0&&A>C.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,jt(f,"click",jn),this.expand();var y=this;setTimeout(function(){nn(f,"click",jn),y._preventClick=!1})}}),Wa=function(f,y,C){return new Oo(f,y,C)},wi=vr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var y="leaflet-control-zoom",C=Mt("div",y+" leaflet-bar"),A=this.options;return this._zoomInButton=this._createButton(A.zoomInText,A.zoomInTitle,y+"-in",C,this._zoomIn),this._zoomOutButton=this._createButton(A.zoomOutText,A.zoomOutTitle,y+"-out",C,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),C},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,y,C,A,V){var J=Mt("a",C,A);return J.innerHTML=f,J.href="#",J.title=y,J.setAttribute("role","button"),J.setAttribute("aria-label",y),na(J),jt(J,"click",Lr),jt(J,"click",V,this),jt(J,"click",this._refocusOnMap,this),J},_updateDisabled:function(){var f=this._map,y="leaflet-disabled";fn(this._zoomInButton,y),fn(this._zoomOutButton,y),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(Pt(this._zoomOutButton,y),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(Pt(this._zoomInButton,y),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ut.mergeOptions({zoomControl:!0}),Ut.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new wi,this.addControl(this.zoomControl))});var Fl=function(f){return new wi(f)},dr=vr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var y="leaflet-control-scale",C=Mt("div",y),A=this.options;return this._addScales(A,y+"-line",C),f.on(A.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),C},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,y,C){f.metric&&(this._mScale=Mt("div",y,C)),f.imperial&&(this._iScale=Mt("div",y,C))},_update:function(){var f=this._map,y=f.getSize().y/2,C=f.distance(f.containerPointToLatLng([0,y]),f.containerPointToLatLng([this.options.maxWidth,y]));this._updateScales(C)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var y=this._getRoundNum(f),C=y<1e3?y+" m":y/1e3+" km";this._updateScale(this._mScale,C,y/f)},_updateImperial:function(f){var y=f*3.2808399,C,A,V;y>5280?(C=y/5280,A=this._getRoundNum(C),this._updateScale(this._iScale,A+" mi",A/C)):(V=this._getRoundNum(y),this._updateScale(this._iScale,V+" ft",V/y))},_updateScale:function(f,y,C){f.style.width=Math.round(this.options.maxWidth*C)+"px",f.innerHTML=y},_getRoundNum:function(f){var y=Math.pow(10,(Math.floor(f)+"").length-1),C=f/y;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:1,y*C}}),Si=function(f){return new dr(f)},Io='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Js=vr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(dt.inlineSvg?Io+" ":"")+"Leaflet</a>"},initialize:function(f){w(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=Mt("div","leaflet-control-attribution"),na(this._container);for(var y in f._layers)f._layers[y].getAttribution&&this.addAttribution(f._layers[y].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var y in this._attributions)this._attributions[y]&&f.push(y);var C=[];this.options.prefix&&C.push(this.options.prefix),f.length&&C.push(f.join(", ")),this._container.innerHTML=C.join(' <span aria-hidden="true">|</span> ')}}});Ut.mergeOptions({attributionControl:!0}),Ut.addInitHook(function(){this.options.attributionControl&&new Js().addTo(this)});var dd=function(f){return new Js(f)};vr.Layers=Oo,vr.Zoom=wi,vr.Scale=dr,vr.Attribution=Js,Ns.layers=Wa,Ns.zoom=Fl,Ns.scale=Si,Ns.attribution=dd;var Mr=Y.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Mr.addTo=function(f,y){return f.addHandler(y,this),this};var Ao={Events:te},ji=dt.touch?"touchstart mousedown":"mousedown",Fr=ie.extend({options:{clickTolerance:3},initialize:function(f,y,C,A){w(this,A),this._element=f,this._dragStartTarget=y||f,this._preventOutline=C},enable:function(){this._enabled||(jt(this._dragStartTarget,ji,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Fr._dragging===this&&this.finishDrag(!0),nn(this._dragStartTarget,ji,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!yi(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){Fr._dragging===this&&this.finishDrag();return}if(!(Fr._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(Fr._dragging=this,this._preventOutline&&_i(this._element),Fa(),$t(),!this._moving)){this.fire("down");var y=f.touches?f.touches[0]:f,C=cs(this._element);this._startPoint=new $(y.clientX,y.clientY),this._startPos=ls(this._element),this._parentScale=Hr(C);var A=f.type==="mousedown";jt(document,A?"mousemove":"touchmove",this._onMove,this),jt(document,A?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var y=f.touches&&f.touches.length===1?f.touches[0]:f,C=new $(y.clientX,y.clientY)._subtract(this._startPoint);!C.x&&!C.y||Math.abs(C.x)+Math.abs(C.y)<this.options.clickTolerance||(C.x/=this._parentScale.x,C.y/=this._parentScale.y,jn(f),this._moved||(this.fire("dragstart"),this._moved=!0,Pt(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Pt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(C),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),En(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){fn(document.body,"leaflet-dragging"),this._lastTarget&&(fn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),nn(document,"mousemove touchmove",this._onMove,this),nn(document,"mouseup touchend touchcancel",this._onUp,this),qa(),bi();var y=this._moved&&this._moving;this._moving=!1,Fr._dragging=!1,y&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function Ro(f,y,C){var A,V=[1,4,2,8],J,ge,Ce,Oe,Ve,rt,_t,zt;for(J=0,rt=f.length;J<rt;J++)f[J]._code=Qs(f[J],y);for(Ce=0;Ce<4;Ce++){for(_t=V[Ce],A=[],J=0,rt=f.length,ge=rt-1;J<rt;ge=J++)Oe=f[J],Ve=f[ge],Oe._code&_t?Ve._code&_t||(zt=Ha(Ve,Oe,_t,y,C),zt._code=Qs(zt,y),A.push(zt)):(Ve._code&_t&&(zt=Ha(Ve,Oe,_t,y,C),zt._code=Qs(zt,y),A.push(zt)),A.push(Oe));f=A}return f}function ql(f,y){var C,A,V,J,ge,Ce,Oe,Ve,rt;if(!f||f.length===0)throw new Error("latlngs not passed");kr(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var _t=me([0,0]),zt=oe(f),_r=zt.getNorthWest().distanceTo(zt.getSouthWest())*zt.getNorthEast().distanceTo(zt.getNorthWest());_r<1700&&(_t=Lo(f));var ur=f.length,hs=[];for(C=0;C<ur;C++){var Zr=me(f[C]);hs.push(y.project(me([Zr.lat-_t.lat,Zr.lng-_t.lng])))}for(Ce=Oe=Ve=0,C=0,A=ur-1;C<ur;A=C++)V=hs[C],J=hs[A],ge=V.y*J.x-J.y*V.x,Oe+=(V.x+J.x)*ge,Ve+=(V.y+J.y)*ge,Ce+=ge*3;Ce===0?rt=hs[0]:rt=[Oe/Ce,Ve/Ce];var sc=y.unproject(se(rt));return me([sc.lat+_t.lat,sc.lng+_t.lng])}function Lo(f){for(var y=0,C=0,A=0,V=0;V<f.length;V++){var J=me(f[V]);y+=J.lat,C+=J.lng,A++}return me([y/A,C/A])}var ud={__proto__:null,clipPolygon:Ro,polygonCenter:ql,centroid:Lo};function $a(f,y){if(!y||!f.length)return f.slice();var C=y*y;return f=md(f,C),f=hd(f,C),f}function zl(f,y,C){return Math.sqrt(Xs(f,y,C,!0))}function fd(f,y,C){return Xs(f,y,C)}function hd(f,y){var C=f.length,A=typeof Uint8Array<"u"?Uint8Array:Array,V=new A(C);V[0]=V[C-1]=1,Fo(f,V,y,0,C-1);var J,ge=[];for(J=0;J<C;J++)V[J]&&ge.push(f[J]);return ge}function Fo(f,y,C,A,V){var J=0,ge,Ce,Oe;for(Ce=A+1;Ce<=V-1;Ce++)Oe=Xs(f[Ce],f[A],f[V],!0),Oe>J&&(ge=Ce,J=Oe);J>C&&(y[ge]=1,Fo(f,y,C,A,ge),Fo(f,y,C,ge,V))}function md(f,y){for(var C=[f[0]],A=1,V=0,J=f.length;A<J;A++)pd(f[A],f[V])>y&&(C.push(f[A]),V=A);return V<J-1&&C.push(f[J-1]),C}var qo;function Ul(f,y,C,A,V){var J=A?qo:Qs(f,C),ge=Qs(y,C),Ce,Oe,Ve;for(qo=ge;;){if(!(J|ge))return[f,y];if(J&ge)return!1;Ce=J||ge,Oe=Ha(f,y,Ce,C,V),Ve=Qs(Oe,C),Ce===J?(f=Oe,J=Ve):(y=Oe,ge=Ve)}}function Ha(f,y,C,A,V){var J=y.x-f.x,ge=y.y-f.y,Ce=A.min,Oe=A.max,Ve,rt;return C&8?(Ve=f.x+J*(Oe.y-f.y)/ge,rt=Oe.y):C&4?(Ve=f.x+J*(Ce.y-f.y)/ge,rt=Ce.y):C&2?(Ve=Oe.x,rt=f.y+ge*(Oe.x-f.x)/J):C&1&&(Ve=Ce.x,rt=f.y+ge*(Ce.x-f.x)/J),new $(Ve,rt,V)}function Qs(f,y){var C=0;return f.x<y.min.x?C|=1:f.x>y.max.x&&(C|=2),f.y<y.min.y?C|=4:f.y>y.max.y&&(C|=8),C}function pd(f,y){var C=y.x-f.x,A=y.y-f.y;return C*C+A*A}function Xs(f,y,C,A){var V=y.x,J=y.y,ge=C.x-V,Ce=C.y-J,Oe=ge*ge+Ce*Ce,Ve;return Oe>0&&(Ve=((f.x-V)*ge+(f.y-J)*Ce)/Oe,Ve>1?(V=C.x,J=C.y):Ve>0&&(V+=ge*Ve,J+=Ce*Ve)),ge=f.x-V,Ce=f.y-J,A?ge*ge+Ce*Ce:new $(V,J)}function kr(f){return!I(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function Vl(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),kr(f)}function Bl(f,y){var C,A,V,J,ge,Ce,Oe,Ve;if(!f||f.length===0)throw new Error("latlngs not passed");kr(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var rt=me([0,0]),_t=oe(f),zt=_t.getNorthWest().distanceTo(_t.getSouthWest())*_t.getNorthEast().distanceTo(_t.getNorthWest());zt<1700&&(rt=Lo(f));var _r=f.length,ur=[];for(C=0;C<_r;C++){var hs=me(f[C]);ur.push(y.project(me([hs.lat-rt.lat,hs.lng-rt.lng])))}for(C=0,A=0;C<_r-1;C++)A+=ur[C].distanceTo(ur[C+1])/2;if(A===0)Ve=ur[0];else for(C=0,J=0;C<_r-1;C++)if(ge=ur[C],Ce=ur[C+1],V=ge.distanceTo(Ce),J+=V,J>A){Oe=(J-A)/V,Ve=[Ce.x-Oe*(Ce.x-ge.x),Ce.y-Oe*(Ce.y-ge.y)];break}var Zr=y.unproject(se(Ve));return me([Zr.lat+rt.lat,Zr.lng+rt.lng])}var Wl={__proto__:null,simplify:$a,pointToSegmentDistance:zl,closestPointOnSegment:fd,clipSegment:Ul,_getEdgeIntersection:Ha,_getBitCode:Qs,_sqClosestPointOnSegment:Xs,isFlat:kr,_flat:Vl,polylineCenter:Bl},zo={project:function(f){return new $(f.lng,f.lat)},unproject:function(f){return new re(f.y,f.x)},bounds:new W([-180,-90],[180,90])},Uo={R:6378137,R_MINOR:6356752314245179e-9,bounds:new W([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var y=Math.PI/180,C=this.R,A=f.lat*y,V=this.R_MINOR/C,J=Math.sqrt(1-V*V),ge=J*Math.sin(A),Ce=Math.tan(Math.PI/4-A/2)/Math.pow((1-ge)/(1+ge),J/2);return A=-C*Math.log(Math.max(Ce,1e-10)),new $(f.lng*y*C,A)},unproject:function(f){for(var y=180/Math.PI,C=this.R,A=this.R_MINOR/C,V=Math.sqrt(1-A*A),J=Math.exp(-f.y/C),ge=Math.PI/2-2*Math.atan(J),Ce=0,Oe=.1,Ve;Ce<15&&Math.abs(Oe)>1e-7;Ce++)Ve=V*Math.sin(ge),Ve=Math.pow((1-Ve)/(1+Ve),V/2),Oe=Math.PI/2-2*Math.atan(J*Ve)-ge,ge+=Oe;return new re(ge*y,f.x*y/C)}},gd={__proto__:null,LonLat:zo,Mercator:Uo,SphericalMercator:ue},xd=s({},le,{code:"EPSG:3395",projection:Uo,transformation:(function(){var f=.5/(Math.PI*Uo.R);return Se(f,.5,-f,.5)})()}),$l=s({},le,{code:"EPSG:4326",projection:zo,transformation:Se(1/180,1,-1/180,.5)}),yd=s({},_e,{projection:zo,transformation:Se(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,y){var C=y.lng-f.lng,A=y.lat-f.lat;return Math.sqrt(C*C+A*A)},infinite:!0});_e.Earth=le,_e.EPSG3395=xd,_e.EPSG3857=ye,_e.EPSG900913=Ne,_e.EPSG4326=$l,_e.Simple=yd;var qr=ie.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[c(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[c(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var y=f.target;if(y.hasLayer(this)){if(this._map=y,this._zoomAnimated=y._zoomAnimated,this.getEvents){var C=this.getEvents();y.on(C,this),this.once("remove",function(){y.off(C,this)},this)}this.onAdd(y),this.fire("add"),y.fire("layeradd",{layer:this})}}});Ut.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var y=c(f);return this._layers[y]?this:(this._layers[y]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var y=c(f);return this._layers[y]?(this._loaded&&f.onRemove(this),delete this._layers[y],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return c(f)in this._layers},eachLayer:function(f,y){for(var C in this._layers)f.call(y,this._layers[C]);return this},_addLayers:function(f){f=f?I(f)?f:[f]:[];for(var y=0,C=f.length;y<C;y++)this.addLayer(f[y])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[c(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var y=c(f);this._zoomBoundLayers[y]&&(delete this._zoomBoundLayers[y],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,y=-1/0,C=this._getZoomSpan();for(var A in this._zoomBoundLayers){var V=this._zoomBoundLayers[A].options;f=V.minZoom===void 0?f:Math.min(f,V.minZoom),y=V.maxZoom===void 0?y:Math.max(y,V.maxZoom)}this._layersMaxZoom=y===-1/0?void 0:y,this._layersMinZoom=f===1/0?void 0:f,C!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Cs=qr.extend({initialize:function(f,y){w(this,y),this._layers={};var C,A;if(f)for(C=0,A=f.length;C<A;C++)this.addLayer(f[C])},addLayer:function(f){var y=this.getLayerId(f);return this._layers[y]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var y=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[y]&&this._map.removeLayer(this._layers[y]),delete this._layers[y],this},hasLayer:function(f){var y=typeof f=="number"?f:this.getLayerId(f);return y in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var y=Array.prototype.slice.call(arguments,1),C,A;for(C in this._layers)A=this._layers[C],A[f]&&A[f].apply(A,y);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,y){for(var C in this._layers)f.call(y,this._layers[C]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return c(f)}}),ia=function(f,y){return new Cs(f,y)},ds=Cs.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),Cs.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),Cs.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new K;for(var y in this._layers){var C=this._layers[y];f.extend(C.getBounds?C.getBounds():C.getLatLng())}return f}}),Hl=function(f,y){return new ds(f,y)},ei=Y.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){w(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,y){var C=this._getIconUrl(f);if(!C){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var A=this._createImg(C,y&&y.tagName==="IMG"?y:null);return this._setIconStyles(A,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),A},_setIconStyles:function(f,y){var C=this.options,A=C[y+"Size"];typeof A=="number"&&(A=[A,A]);var V=se(A),J=se(y==="shadow"&&C.shadowAnchor||C.iconAnchor||V&&V.divideBy(2,!0));f.className="leaflet-marker-"+y+" "+(C.className||""),J&&(f.style.marginLeft=-J.x+"px",f.style.marginTop=-J.y+"px"),V&&(f.style.width=V.x+"px",f.style.height=V.y+"px")},_createImg:function(f,y){return y=y||document.createElement("img"),y.src=f,y},_getIconUrl:function(f){return dt.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function Yl(f){return new ei(f)}var Ni=ei.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof Ni.imagePath!="string"&&(Ni.imagePath=this._detectIconPath()),(this.options.imagePath||Ni.imagePath)+ei.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var y=function(C,A,V){var J=A.exec(C);return J&&J[V]};return f=y(f,/^url\((['"])?(.+)\1\)$/,2),f&&y(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=Mt("div","leaflet-default-icon-path",document.body),y=Qi(f,"background-image")||Qi(f,"backgroundImage");if(document.body.removeChild(f),y=this._stripUrl(y),y)return y;var C=document.querySelector('link[href$="leaflet.css"]');return C?C.href.substring(0,C.href.length-11-1):""}}),Vo=Mr.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new Fr(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Pt(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&fn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var y=this._marker,C=y._map,A=this._marker.options.autoPanSpeed,V=this._marker.options.autoPanPadding,J=ls(y._icon),ge=C.getPixelBounds(),Ce=C.getPixelOrigin(),Oe=ee(ge.min._subtract(Ce).add(V),ge.max._subtract(Ce).subtract(V));if(!Oe.contains(J)){var Ve=se((Math.max(Oe.max.x,J.x)-Oe.max.x)/(ge.max.x-Oe.max.x)-(Math.min(Oe.min.x,J.x)-Oe.min.x)/(ge.min.x-Oe.min.x),(Math.max(Oe.max.y,J.y)-Oe.max.y)/(ge.max.y-Oe.max.y)-(Math.min(Oe.min.y,J.y)-Oe.min.y)/(ge.min.y-Oe.min.y)).multiplyBy(A);C.panBy(Ve,{animate:!1}),this._draggable._newPos._add(Ve),this._draggable._startPos._add(Ve),En(y._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=G(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(X(this._panRequest),this._panRequest=G(this._adjustPan.bind(this,f)))},_onDrag:function(f){var y=this._marker,C=y._shadow,A=ls(y._icon),V=y._map.layerPointToLatLng(A);C&&En(C,A),y._latlng=V,f.latlng=V,f.oldLatLng=this._oldLatLng,y.fire("move",f).fire("drag",f)},_onDragEnd:function(f){X(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),us=qr.extend({options:{icon:new Ni,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,y){w(this,y),this._latlng=me(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var y=this._latlng;return this._latlng=me(f),this.update(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,y="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),C=f.icon.createIcon(this._icon),A=!1;C!==this._icon&&(this._icon&&this._removeIcon(),A=!0,f.title&&(C.title=f.title),C.tagName==="IMG"&&(C.alt=f.alt||"")),Pt(C,y),f.keyboard&&(C.tabIndex="0",C.setAttribute("role","button")),this._icon=C,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&jt(C,"focus",this._panOnFocus,this);var V=f.icon.createShadow(this._shadow),J=!1;V!==this._shadow&&(this._removeShadow(),J=!0),V&&(Pt(V,y),V.alt=""),this._shadow=V,f.opacity<1&&this._updateOpacity(),A&&this.getPane().appendChild(this._icon),this._initInteraction(),V&&J&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&nn(this._icon,"focus",this._panOnFocus,this),pn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&pn(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&En(this._icon,f),this._shadow&&En(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(y)},_initInteraction:function(){if(this.options.interactive&&(Pt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Vo)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Vo(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&cr(this._icon,f),this._shadow&&cr(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var y=this.options.icon.options,C=y.iconSize?se(y.iconSize):se(0,0),A=y.iconAnchor?se(y.iconAnchor):se(0,0);f.panInside(this._latlng,{paddingTopLeft:A,paddingBottomRight:C.subtract(A)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function vd(f,y){return new us(f,y)}var Ts=qr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return w(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ya=Ts.extend({options:{fill:!0,radius:10},initialize:function(f,y){w(this,y),this._latlng=me(f),this._radius=this.options.radius},setLatLng:function(f){var y=this._latlng;return this._latlng=me(f),this.redraw(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var y=f&&f.radius||this._radius;return Ts.prototype.setStyle.call(this,f),this.setRadius(y),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,y=this._radiusY||f,C=this._clickTolerance(),A=[f+C,y+C];this._pxBounds=new W(this._point.subtract(A),this._point.add(A))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Gl(f,y){return new Ya(f,y)}var Ga=Ya.extend({initialize:function(f,y,C){if(typeof y=="number"&&(y=s({},C,{radius:y})),w(this,y),this._latlng=me(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new K(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:Ts.prototype.setStyle,_project:function(){var f=this._latlng.lng,y=this._latlng.lat,C=this._map,A=C.options.crs;if(A.distance===le.distance){var V=Math.PI/180,J=this._mRadius/le.R/V,ge=C.project([y+J,f]),Ce=C.project([y-J,f]),Oe=ge.add(Ce).divideBy(2),Ve=C.unproject(Oe).lat,rt=Math.acos((Math.cos(J*V)-Math.sin(y*V)*Math.sin(Ve*V))/(Math.cos(y*V)*Math.cos(Ve*V)))/V;(isNaN(rt)||rt===0)&&(rt=J/Math.cos(Math.PI/180*y)),this._point=Oe.subtract(C.getPixelOrigin()),this._radius=isNaN(rt)?0:Oe.x-C.project([Ve,f-rt]).x,this._radiusY=Oe.y-ge.y}else{var _t=A.unproject(A.project(this._latlng).subtract([this._mRadius,0]));this._point=C.latLngToLayerPoint(this._latlng),this._radius=this._point.x-C.latLngToLayerPoint(_t).x}this._updateBounds()}});function aa(f,y,C){return new Ga(f,y,C)}var br=Ts.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,y){w(this,y),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var y=1/0,C=null,A=Xs,V,J,ge=0,Ce=this._parts.length;ge<Ce;ge++)for(var Oe=this._parts[ge],Ve=1,rt=Oe.length;Ve<rt;Ve++){V=Oe[Ve-1],J=Oe[Ve];var _t=A(f,V,J,!0);_t<y&&(y=_t,C=A(f,V,J))}return C&&(C.distance=Math.sqrt(y)),C},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Bl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,y){return y=y||this._defaultShape(),f=me(f),y.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new K,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return kr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var y=[],C=kr(f),A=0,V=f.length;A<V;A++)C?(y[A]=me(f[A]),this._bounds.extend(y[A])):y[A]=this._convertLatLngs(f[A]);return y},_project:function(){var f=new W;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),y=new $(f,f);this._rawPxBounds&&(this._pxBounds=new W([this._rawPxBounds.min.subtract(y),this._rawPxBounds.max.add(y)]))},_projectLatlngs:function(f,y,C){var A=f[0]instanceof re,V=f.length,J,ge;if(A){for(ge=[],J=0;J<V;J++)ge[J]=this._map.latLngToLayerPoint(f[J]),C.extend(ge[J]);y.push(ge)}else for(J=0;J<V;J++)this._projectLatlngs(f[J],y,C)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var y=this._parts,C,A,V,J,ge,Ce,Oe;for(C=0,V=0,J=this._rings.length;C<J;C++)for(Oe=this._rings[C],A=0,ge=Oe.length;A<ge-1;A++)Ce=Ul(Oe[A],Oe[A+1],f,A,!0),Ce&&(y[V]=y[V]||[],y[V].push(Ce[0]),(Ce[1]!==Oe[A+1]||A===ge-2)&&(y[V].push(Ce[1]),V++))}},_simplifyPoints:function(){for(var f=this._parts,y=this.options.smoothFactor,C=0,A=f.length;C<A;C++)f[C]=$a(f[C],y)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,y){var C,A,V,J,ge,Ce,Oe=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(C=0,J=this._parts.length;C<J;C++)for(Ce=this._parts[C],A=0,ge=Ce.length,V=ge-1;A<ge;V=A++)if(!(!y&&A===0)&&zl(f,Ce[V],Ce[A])<=Oe)return!0;return!1}});function bd(f,y){return new br(f,y)}br._flat=Vl;var fs=br.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ql(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var y=br.prototype._convertLatLngs.call(this,f),C=y.length;return C>=2&&y[0]instanceof re&&y[0].equals(y[C-1])&&y.pop(),y},_setLatLngs:function(f){br.prototype._setLatLngs.call(this,f),kr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return kr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,y=this.options.weight,C=new $(y,y);if(f=new W(f.min.subtract(C),f.max.add(C)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var A=0,V=this._rings.length,J;A<V;A++)J=Ro(this._rings[A],f,!0),J.length&&this._parts.push(J)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var y=!1,C,A,V,J,ge,Ce,Oe,Ve;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(J=0,Oe=this._parts.length;J<Oe;J++)for(C=this._parts[J],ge=0,Ve=C.length,Ce=Ve-1;ge<Ve;Ce=ge++)A=C[ge],V=C[Ce],A.y>f.y!=V.y>f.y&&f.x<(V.x-A.x)*(f.y-A.y)/(V.y-A.y)+A.x&&(y=!y);return y||br.prototype._containsPoint.call(this,f,!0)}});function _d(f,y){return new fs(f,y)}var Gr=ds.extend({initialize:function(f,y){w(this,y),this._layers={},f&&this.addData(f)},addData:function(f){var y=I(f)?f:f.features,C,A,V;if(y){for(C=0,A=y.length;C<A;C++)V=y[C],(V.geometries||V.geometry||V.features||V.coordinates)&&this.addData(V);return this}var J=this.options;if(J.filter&&!J.filter(f))return this;var ge=Ci(f,J);return ge?(ge.feature=Xa(f),ge.defaultOptions=ge.options,this.resetStyle(ge),J.onEachFeature&&J.onEachFeature(f,ge),this.addLayer(ge)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=s({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(y){this._setLayerStyle(y,f)},this)},_setLayerStyle:function(f,y){f.setStyle&&(typeof y=="function"&&(y=y(f.feature)),f.setStyle(y))}});function Ci(f,y){var C=f.type==="Feature"?f.geometry:f,A=C?C.coordinates:null,V=[],J=y&&y.pointToLayer,ge=y&&y.coordsToLatLng||Ka,Ce,Oe,Ve,rt;if(!A&&!C)return null;switch(C.type){case"Point":return Ce=ge(A),Za(J,f,Ce,y);case"MultiPoint":for(Ve=0,rt=A.length;Ve<rt;Ve++)Ce=ge(A[Ve]),V.push(Za(J,f,Ce,y));return new ds(V);case"LineString":case"MultiLineString":return Oe=oa(A,C.type==="LineString"?0:1,ge),new br(Oe,y);case"Polygon":case"MultiPolygon":return Oe=oa(A,C.type==="Polygon"?1:2,ge),new fs(Oe,y);case"GeometryCollection":for(Ve=0,rt=C.geometries.length;Ve<rt;Ve++){var _t=Ci({geometry:C.geometries[Ve],type:"Feature",properties:f.properties},y);_t&&V.push(_t)}return new ds(V);case"FeatureCollection":for(Ve=0,rt=C.features.length;Ve<rt;Ve++){var zt=Ci(C.features[Ve],y);zt&&V.push(zt)}return new ds(V);default:throw new Error("Invalid GeoJSON object.")}}function Za(f,y,C,A){return f?f(y,C):new us(C,A&&A.markersInheritOptions&&A)}function Ka(f){return new re(f[1],f[0],f[2])}function oa(f,y,C){for(var A=[],V=0,J=f.length,ge;V<J;V++)ge=y?oa(f[V],y-1,C):(C||Ka)(f[V]),A.push(ge);return A}function Ja(f,y){return f=me(f),f.alt!==void 0?[x(f.lng,y),x(f.lat,y),x(f.alt,y)]:[x(f.lng,y),x(f.lat,y)]}function Qa(f,y,C,A){for(var V=[],J=0,ge=f.length;J<ge;J++)V.push(y?Qa(f[J],kr(f[J])?0:y-1,C,A):Ja(f[J],A));return!y&&C&&V.length>0&&V.push(V[0].slice()),V}function Ti(f,y){return f.feature?s({},f.feature,{geometry:y}):Xa(y)}function Xa(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var Bo={toGeoJSON:function(f){return Ti(this,{type:"Point",coordinates:Ja(this.getLatLng(),f)})}};us.include(Bo),Ga.include(Bo),Ya.include(Bo),br.include({toGeoJSON:function(f){var y=!kr(this._latlngs),C=Qa(this._latlngs,y?1:0,!1,f);return Ti(this,{type:(y?"Multi":"")+"LineString",coordinates:C})}}),fs.include({toGeoJSON:function(f){var y=!kr(this._latlngs),C=y&&!kr(this._latlngs[0]),A=Qa(this._latlngs,C?2:y?1:0,!0,f);return y||(A=[A]),Ti(this,{type:(C?"Multi":"")+"Polygon",coordinates:A})}}),Cs.include({toMultiPoint:function(f){var y=[];return this.eachLayer(function(C){y.push(C.toGeoJSON(f).geometry.coordinates)}),Ti(this,{type:"MultiPoint",coordinates:y})},toGeoJSON:function(f){var y=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(y==="MultiPoint")return this.toMultiPoint(f);var C=y==="GeometryCollection",A=[];return this.eachLayer(function(V){if(V.toGeoJSON){var J=V.toGeoJSON(f);if(C)A.push(J.geometry);else{var ge=Xa(J);ge.type==="FeatureCollection"?A.push.apply(A,ge.features):A.push(ge)}}}),C?Ti(this,{geometries:A,type:"GeometryCollection"}):{type:"FeatureCollection",features:A}}});function Zl(f,y){return new Gr(f,y)}var zr=Zl,Ps=qr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,y,C){this._url=f,this._bounds=oe(y),w(this,C)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Pt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){pn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&xi(this._image),this},bringToBack:function(){return this._map&&os(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=oe(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",y=this._image=f?this._url:Mt("img");if(Pt(y,"leaflet-image-layer"),this._zoomAnimated&&Pt(y,"leaflet-zoom-animated"),this.options.className&&Pt(y,this.options.className),y.onselectstart=p,y.onmousemove=p,y.onload=o(this.fire,this,"load"),y.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=y.src;return}y.src=this._url,y.alt=this.options.alt},_animateZoom:function(f){var y=this._map.getZoomScale(f.zoom),C=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;Ar(this._image,C,y)},_reset:function(){var f=this._image,y=new W(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),C=y.getSize();En(f,y.min),f.style.width=C.x+"px",f.style.height=C.y+"px"},_updateOpacity:function(){cr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),Kl=function(f,y,C){return new Ps(f,y,C)},Wo=Ps.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",y=this._image=f?this._url:Mt("video");if(Pt(y,"leaflet-image-layer"),this._zoomAnimated&&Pt(y,"leaflet-zoom-animated"),this.options.className&&Pt(y,this.options.className),y.onselectstart=p,y.onmousemove=p,y.onloadeddata=o(this.fire,this,"load"),f){for(var C=y.getElementsByTagName("source"),A=[],V=0;V<C.length;V++)A.push(C[V].src);this._url=C.length>0?A:[y.src];return}I(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(y.style,"objectFit")&&(y.style.objectFit="fill"),y.autoplay=!!this.options.autoplay,y.loop=!!this.options.loop,y.muted=!!this.options.muted,y.playsInline=!!this.options.playsInline;for(var J=0;J<this._url.length;J++){var ge=Mt("source");ge.src=this._url[J],y.appendChild(ge)}}});function Jl(f,y,C){return new Wo(f,y,C)}var $o=Ps.extend({_initImage:function(){var f=this._image=this._url;Pt(f,"leaflet-image-layer"),this._zoomAnimated&&Pt(f,"leaflet-zoom-animated"),this.options.className&&Pt(f,this.options.className),f.onselectstart=p,f.onmousemove=p}});function Ho(f,y,C){return new $o(f,y,C)}var g=qr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,y){f&&(f instanceof re||I(f))?(this._latlng=me(f),w(this,y)):(w(this,f),this._source=y),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&cr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&cr(this._container,1),this.bringToFront(),this.options.interactive&&(Pt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(cr(this._container,0),this._removeTimeout=setTimeout(o(pn,void 0,this._container),200)):pn(this._container),this.options.interactive&&(fn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=me(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&xi(this._container),this},bringToBack:function(){return this._map&&os(this._container),this},_prepareOpen:function(f){var y=this._source;if(!y._map)return!1;if(y instanceof ds){y=null;var C=this._source._layers;for(var A in C)if(C[A]._map){y=C[A];break}if(!y)return!1;this._source=y}if(!f)if(y.getCenter)f=y.getCenter();else if(y.getLatLng)f=y.getLatLng();else if(y.getBounds)f=y.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,y=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof y=="string")f.innerHTML=y;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(y)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),y=se(this.options.offset),C=this._getAnchor();this._zoomAnimated?En(this._container,f.add(C)):y=y.add(f).add(C);var A=this._containerBottom=-y.y,V=this._containerLeft=-Math.round(this._containerWidth/2)+y.x;this._container.style.bottom=A+"px",this._container.style.left=V+"px"}},_getAnchor:function(){return[0,0]}});Ut.include({_initOverlay:function(f,y,C,A){var V=y;return V instanceof f||(V=new f(A).setContent(y)),C&&V.setLatLng(C),V}}),qr.include({_initOverlay:function(f,y,C,A){var V=C;return V instanceof f?(w(V,A),V._source=this):(V=y&&!A?y:new f(A,this),V.setContent(C)),V}});var Su=g.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,g.prototype.openOn.call(this,f)},onAdd:function(f){g.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ts||this._source.on("preclick",Yr))},onRemove:function(f){g.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ts||this._source.off("preclick",Yr))},getEvents:function(){var f=g.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",y=this._container=Mt("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),C=this._wrapper=Mt("div",f+"-content-wrapper",y);if(this._contentNode=Mt("div",f+"-content",C),na(y),Ua(this._contentNode),jt(y,"contextmenu",Yr),this._tipContainer=Mt("div",f+"-tip-container",y),this._tip=Mt("div",f+"-tip",this._tipContainer),this.options.closeButton){var A=this._closeButton=Mt("a",f+"-close-button",y);A.setAttribute("role","button"),A.setAttribute("aria-label","Close popup"),A.href="#close",A.innerHTML='<span aria-hidden="true">&#215;</span>',jt(A,"click",function(V){jn(V),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,y=f.style;y.width="",y.whiteSpace="nowrap";var C=f.offsetWidth;C=Math.min(C,this.options.maxWidth),C=Math.max(C,this.options.minWidth),y.width=C+1+"px",y.whiteSpace="",y.height="";var A=f.offsetHeight,V=this.options.maxHeight,J="leaflet-popup-scrolled";V&&A>V?(y.height=V+"px",Pt(f,J)):fn(f,J),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),C=this._getAnchor();En(this._container,y.add(C))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,y=parseInt(Qi(this._container,"marginBottom"),10)||0,C=this._container.offsetHeight+y,A=this._containerWidth,V=new $(this._containerLeft,-C-this._containerBottom);V._add(ls(this._container));var J=f.layerPointToContainerPoint(V),ge=se(this.options.autoPanPadding),Ce=se(this.options.autoPanPaddingTopLeft||ge),Oe=se(this.options.autoPanPaddingBottomRight||ge),Ve=f.getSize(),rt=0,_t=0;J.x+A+Oe.x>Ve.x&&(rt=J.x+A-Ve.x+Oe.x),J.x-rt-Ce.x<0&&(rt=J.x-Ce.x),J.y+C+Oe.y>Ve.y&&(_t=J.y+C-Ve.y+Oe.y),J.y-_t-Ce.y<0&&(_t=J.y-Ce.y),(rt||_t)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([rt,_t]))}},_getAnchor:function(){return se(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ql=function(f,y){return new Su(f,y)};Ut.mergeOptions({closePopupOnClick:!0}),Ut.include({openPopup:function(f,y,C){return this._initOverlay(Su,f,y,C).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),qr.include({bindPopup:function(f,y){return this._popup=this._initOverlay(Su,this._popup,f,y),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof ds||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){Lr(f);var y=f.layer||f.target;if(this._popup._source===y&&!(y instanceof Ts)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=y,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var Xl=g.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){g.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){g.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=g.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",y=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Mt("div",y),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var y,C,A=this._map,V=this._container,J=A.latLngToContainerPoint(A.getCenter()),ge=A.layerPointToContainerPoint(f),Ce=this.options.direction,Oe=V.offsetWidth,Ve=V.offsetHeight,rt=se(this.options.offset),_t=this._getAnchor();Ce==="top"?(y=Oe/2,C=Ve):Ce==="bottom"?(y=Oe/2,C=0):Ce==="center"?(y=Oe/2,C=Ve/2):Ce==="right"?(y=0,C=Ve/2):Ce==="left"?(y=Oe,C=Ve/2):ge.x<J.x?(Ce="right",y=0,C=Ve/2):(Ce="left",y=Oe+(rt.x+_t.x)*2,C=Ve/2),f=f.subtract(se(y,C,!0)).add(rt).add(_t),fn(V,"leaflet-tooltip-right"),fn(V,"leaflet-tooltip-left"),fn(V,"leaflet-tooltip-top"),fn(V,"leaflet-tooltip-bottom"),Pt(V,"leaflet-tooltip-"+Ce),En(V,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&cr(this._container,f)},_animateZoom:function(f){var y=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(y)},_getAnchor:function(){return se(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),wd=function(f,y){return new Xl(f,y)};Ut.include({openTooltip:function(f,y,C){return this._initOverlay(Xl,f,y,C).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),qr.include({bindTooltip:function(f,y){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Xl,this._tooltip,f,y),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var y=f?"off":"on",C={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?C.add=this._openTooltip:(C.mouseover=this._openTooltip,C.mouseout=this.closeTooltip,C.click=this._openTooltip,this._map?this._addFocusListeners():C.add=this._addFocusListeners),this._tooltip.options.sticky&&(C.mousemove=this._moveTooltip),this[y](C),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof ds||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var y=typeof f.getElement=="function"&&f.getElement();y&&(jt(y,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),jt(y,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var y=typeof f.getElement=="function"&&f.getElement();y&&y.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var y=this;this._map.once("moveend",function(){y._openOnceFlag=!1,y._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var y=f.latlng,C,A;this._tooltip.options.sticky&&f.originalEvent&&(C=this._map.mouseEventToContainerPoint(f.originalEvent),A=this._map.containerPointToLayerPoint(C),y=this._map.layerPointToLatLng(A)),this._tooltip.setLatLng(y)}});var ju=ei.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var y=f&&f.tagName==="DIV"?f:document.createElement("div"),C=this.options;if(C.html instanceof Element?(Aa(y),y.appendChild(C.html)):y.innerHTML=C.html!==!1?C.html:"",C.bgPos){var A=se(C.bgPos);y.style.backgroundPosition=-A.x+"px "+-A.y+"px"}return this._setIconStyles(y,"icon"),y},createShadow:function(){return null}});function Cm(f){return new ju(f)}ei.Default=Ni;var eo=qr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:dt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){w(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),pn(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(xi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(os(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof $?f:new $(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var y=this.getPane().children,C=-f(-1/0,1/0),A=0,V=y.length,J;A<V;A++)J=y[A].style.zIndex,y[A]!==this._container&&J&&(C=f(C,+J));isFinite(C)&&(this.options.zIndex=C+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!dt.ielt9){cr(this._container,this.options.opacity);var f=+new Date,y=!1,C=!1;for(var A in this._tiles){var V=this._tiles[A];if(!(!V.current||!V.loaded)){var J=Math.min(1,(f-V.loaded)/200);cr(V.el,J),J<1?y=!0:(V.active?C=!0:this._onOpaqueTile(V),V.active=!0)}}C&&!this._noPrune&&this._pruneTiles(),y&&(X(this._fadeFrame),this._fadeFrame=G(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=Mt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,y=this.options.maxZoom;if(f!==void 0){for(var C in this._levels)C=Number(C),this._levels[C].el.children.length||C===f?(this._levels[C].el.style.zIndex=y-Math.abs(f-C),this._onUpdateLevel(C)):(pn(this._levels[C].el),this._removeTilesAtZoom(C),this._onRemoveLevel(C),delete this._levels[C]);var A=this._levels[f],V=this._map;return A||(A=this._levels[f]={},A.el=Mt("div","leaflet-tile-container leaflet-zoom-animated",this._container),A.el.style.zIndex=y,A.origin=V.project(V.unproject(V.getPixelOrigin()),f).round(),A.zoom=f,this._setZoomTransform(A,V.getCenter(),V.getZoom()),p(A.el.offsetWidth),this._onCreateLevel(A)),this._level=A,A}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var f,y,C=this._map.getZoom();if(C>this.options.maxZoom||C<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)y=this._tiles[f],y.retain=y.current;for(f in this._tiles)if(y=this._tiles[f],y.current&&!y.active){var A=y.coords;this._retainParent(A.x,A.y,A.z,A.z-5)||this._retainChildren(A.x,A.y,A.z,A.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var y in this._tiles)this._tiles[y].coords.z===f&&this._removeTile(y)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)pn(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,y,C,A){var V=Math.floor(f/2),J=Math.floor(y/2),ge=C-1,Ce=new $(+V,+J);Ce.z=+ge;var Oe=this._tileCoordsToKey(Ce),Ve=this._tiles[Oe];return Ve&&Ve.active?(Ve.retain=!0,!0):(Ve&&Ve.loaded&&(Ve.retain=!0),ge>A?this._retainParent(V,J,ge,A):!1)},_retainChildren:function(f,y,C,A){for(var V=2*f;V<2*f+2;V++)for(var J=2*y;J<2*y+2;J++){var ge=new $(V,J);ge.z=C+1;var Ce=this._tileCoordsToKey(ge),Oe=this._tiles[Ce];if(Oe&&Oe.active){Oe.retain=!0;continue}else Oe&&Oe.loaded&&(Oe.retain=!0);C+1<A&&this._retainChildren(V,J,C+1,A)}},_resetView:function(f){var y=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),y,y)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var y=this.options;return y.minNativeZoom!==void 0&&f<y.minNativeZoom?y.minNativeZoom:y.maxNativeZoom!==void 0&&y.maxNativeZoom<f?y.maxNativeZoom:f},_setView:function(f,y,C,A){var V=Math.round(y);this.options.maxZoom!==void 0&&V>this.options.maxZoom||this.options.minZoom!==void 0&&V<this.options.minZoom?V=void 0:V=this._clampZoom(V);var J=this.options.updateWhenZooming&&V!==this._tileZoom;(!A||J)&&(this._tileZoom=V,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),V!==void 0&&this._update(f),C||this._pruneTiles(),this._noPrune=!!C),this._setZoomTransforms(f,y)},_setZoomTransforms:function(f,y){for(var C in this._levels)this._setZoomTransform(this._levels[C],f,y)},_setZoomTransform:function(f,y,C){var A=this._map.getZoomScale(C,f.zoom),V=f.origin.multiplyBy(A).subtract(this._map._getNewPixelOrigin(y,C)).round();dt.any3d?Ar(f.el,V,A):En(f.el,V)},_resetGrid:function(){var f=this._map,y=f.options.crs,C=this._tileSize=this.getTileSize(),A=this._tileZoom,V=this._map.getPixelWorldBounds(this._tileZoom);V&&(this._globalTileRange=this._pxBoundsToTileRange(V)),this._wrapX=y.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,y.wrapLng[0]],A).x/C.x),Math.ceil(f.project([0,y.wrapLng[1]],A).x/C.y)],this._wrapY=y.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([y.wrapLat[0],0],A).y/C.x),Math.ceil(f.project([y.wrapLat[1],0],A).y/C.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var y=this._map,C=y._animatingZoom?Math.max(y._animateToZoom,y.getZoom()):y.getZoom(),A=y.getZoomScale(C,this._tileZoom),V=y.project(f,this._tileZoom).floor(),J=y.getSize().divideBy(A*2);return new W(V.subtract(J),V.add(J))},_update:function(f){var y=this._map;if(y){var C=this._clampZoom(y.getZoom());if(f===void 0&&(f=y.getCenter()),this._tileZoom!==void 0){var A=this._getTiledPixelBounds(f),V=this._pxBoundsToTileRange(A),J=V.getCenter(),ge=[],Ce=this.options.keepBuffer,Oe=new W(V.getBottomLeft().subtract([Ce,-Ce]),V.getTopRight().add([Ce,-Ce]));if(!(isFinite(V.min.x)&&isFinite(V.min.y)&&isFinite(V.max.x)&&isFinite(V.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ve in this._tiles){var rt=this._tiles[Ve].coords;(rt.z!==this._tileZoom||!Oe.contains(new $(rt.x,rt.y)))&&(this._tiles[Ve].current=!1)}if(Math.abs(C-this._tileZoom)>1){this._setView(f,C);return}for(var _t=V.min.y;_t<=V.max.y;_t++)for(var zt=V.min.x;zt<=V.max.x;zt++){var _r=new $(zt,_t);if(_r.z=this._tileZoom,!!this._isValidTile(_r)){var ur=this._tiles[this._tileCoordsToKey(_r)];ur?ur.current=!0:ge.push(_r)}}if(ge.sort(function(Zr,sc){return Zr.distanceTo(J)-sc.distanceTo(J)}),ge.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var hs=document.createDocumentFragment();for(zt=0;zt<ge.length;zt++)this._addTile(ge[zt],hs);this._level.el.appendChild(hs)}}}},_isValidTile:function(f){var y=this._map.options.crs;if(!y.infinite){var C=this._globalTileRange;if(!y.wrapLng&&(f.x<C.min.x||f.x>C.max.x)||!y.wrapLat&&(f.y<C.min.y||f.y>C.max.y))return!1}if(!this.options.bounds)return!0;var A=this._tileCoordsToBounds(f);return oe(this.options.bounds).overlaps(A)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var y=this._map,C=this.getTileSize(),A=f.scaleBy(C),V=A.add(C),J=y.unproject(A,f.z),ge=y.unproject(V,f.z);return[J,ge]},_tileCoordsToBounds:function(f){var y=this._tileCoordsToNwSe(f),C=new K(y[0],y[1]);return this.options.noWrap||(C=this._map.wrapLatLngBounds(C)),C},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var y=f.split(":"),C=new $(+y[0],+y[1]);return C.z=+y[2],C},_removeTile:function(f){var y=this._tiles[f];y&&(pn(y.el),delete this._tiles[f],this.fire("tileunload",{tile:y.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){Pt(f,"leaflet-tile");var y=this.getTileSize();f.style.width=y.x+"px",f.style.height=y.y+"px",f.onselectstart=p,f.onmousemove=p,dt.ielt9&&this.options.opacity<1&&cr(f,this.options.opacity)},_addTile:function(f,y){var C=this._getTilePos(f),A=this._tileCoordsToKey(f),V=this.createTile(this._wrapCoords(f),o(this._tileReady,this,f));this._initTile(V),this.createTile.length<2&&G(o(this._tileReady,this,f,null,V)),En(V,C),this._tiles[A]={el:V,coords:f,current:!0},y.appendChild(V),this.fire("tileloadstart",{tile:V,coords:f})},_tileReady:function(f,y,C){y&&this.fire("tileerror",{error:y,tile:C,coords:f});var A=this._tileCoordsToKey(f);C=this._tiles[A],C&&(C.loaded=+new Date,this._map._fadeAnimated?(cr(C.el,0),X(this._fadeFrame),this._fadeFrame=G(this._updateOpacity,this)):(C.active=!0,this._pruneTiles()),y||(Pt(C.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:C.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),dt.ielt9||!this._map._fadeAnimated?G(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var y=new $(this._wrapX?m(f.x,this._wrapX):f.x,this._wrapY?m(f.y,this._wrapY):f.y);return y.z=f.z,y},_pxBoundsToTileRange:function(f){var y=this.getTileSize();return new W(f.min.unscaleBy(y).floor(),f.max.unscaleBy(y).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function ec(f){return new eo(f)}var to=eo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,y){this._url=f,y=w(this,y),y.detectRetina&&dt.retina&&y.maxZoom>0?(y.tileSize=Math.floor(y.tileSize/2),y.zoomReverse?(y.zoomOffset--,y.minZoom=Math.min(y.maxZoom,y.minZoom+1)):(y.zoomOffset++,y.maxZoom=Math.max(y.minZoom,y.maxZoom-1)),y.minZoom=Math.max(0,y.minZoom)):y.zoomReverse?y.minZoom=Math.min(y.maxZoom,y.minZoom):y.maxZoom=Math.max(y.minZoom,y.maxZoom),typeof y.subdomains=="string"&&(y.subdomains=y.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,y){return this._url===f&&y===void 0&&(y=!0),this._url=f,y||this.redraw(),this},createTile:function(f,y){var C=document.createElement("img");return jt(C,"load",o(this._tileOnLoad,this,y,C)),jt(C,"error",o(this._tileOnError,this,y,C)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(C.referrerPolicy=this.options.referrerPolicy),C.alt="",C.src=this.getTileUrl(f),C},getTileUrl:function(f){var y={r:dt.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var C=this._globalTileRange.max.y-f.y;this.options.tms&&(y.y=C),y["-y"]=C}return k(this._url,s(y,this.options))},_tileOnLoad:function(f,y){dt.ielt9?setTimeout(o(f,this,null,y),0):f(null,y)},_tileOnError:function(f,y,C){var A=this.options.errorTileUrl;A&&y.getAttribute("src")!==A&&(y.src=A),f(C,y)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,y=this.options.maxZoom,C=this.options.zoomReverse,A=this.options.zoomOffset;return C&&(f=y-f),f+A},_getSubdomain:function(f){var y=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[y]},_abortLoading:function(){var f,y;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(y=this._tiles[f].el,y.onload=p,y.onerror=p,!y.complete)){y.src=D;var C=this._tiles[f].coords;pn(y),delete this._tiles[f],this.fire("tileabort",{tile:y,coords:C})}},_removeTile:function(f){var y=this._tiles[f];if(y)return y.el.setAttribute("src",D),eo.prototype._removeTile.call(this,f)},_tileReady:function(f,y,C){if(!(!this._map||C&&C.getAttribute("src")===D))return eo.prototype._tileReady.call(this,f,y,C)}});function Uf(f,y){return new to(f,y)}var Sd=to.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,y){this._url=f;var C=s({},this.defaultWmsParams);for(var A in y)A in this.options||(C[A]=y[A]);y=w(this,y);var V=y.detectRetina&&dt.retina?2:1,J=this.getTileSize();C.width=J.x*V,C.height=J.y*V,this.wmsParams=C},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var y=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[y]=this._crs.code,to.prototype.onAdd.call(this,f)},getTileUrl:function(f){var y=this._tileCoordsToNwSe(f),C=this._crs,A=ee(C.project(y[0]),C.project(y[1])),V=A.min,J=A.max,ge=(this._wmsVersion>=1.3&&this._crs===$l?[V.y,V.x,J.y,J.x]:[V.x,V.y,J.x,J.y]).join(","),Ce=to.prototype.getTileUrl.call(this,f);return Ce+j(this.wmsParams,Ce,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ge},setParams:function(f,y){return s(this.wmsParams,f),y||this.redraw(),this}});function Tm(f,y){return new Sd(f,y)}to.WMS=Sd,Uf.wms=Tm;var Pi=qr.extend({options:{padding:.1},initialize:function(f){w(this,f),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Pt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,y){var C=this._map.getZoomScale(y,this._zoom),A=this._map.getSize().multiplyBy(.5+this.options.padding),V=this._map.project(this._center,y),J=A.multiplyBy(-C).add(V).subtract(this._map._getNewPixelOrigin(f,y));dt.any3d?Ar(this._container,J,C):En(this._container,J)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,y=this._map.getSize(),C=this._map.containerPointToLayerPoint(y.multiplyBy(-f)).round();this._bounds=new W(C,C.add(y.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Vf=Pi.extend({options:{tolerance:0},getEvents:function(){var f=Pi.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Pi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");jt(f,"mousemove",this._onMouseMove,this),jt(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),jt(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){X(this._redrawRequest),delete this._ctx,pn(this._container),nn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var y in this._layers)f=this._layers[y],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Pi.prototype._update.call(this);var f=this._bounds,y=this._container,C=f.getSize(),A=dt.retina?2:1;En(y,f.min),y.width=A*C.x,y.height=A*C.y,y.style.width=C.x+"px",y.style.height=C.y+"px",dt.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){Pi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[c(f)]=f;var y=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=y),this._drawLast=y,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var y=f._order,C=y.next,A=y.prev;C?C.prev=A:this._drawLast=A,A?A.next=C:this._drawFirst=C,delete f._order,delete this._layers[c(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var y=f.options.dashArray.split(/[, ]+/),C=[],A,V;for(V=0;V<y.length;V++){if(A=Number(y[V]),isNaN(A))return;C.push(A)}f.options._dashArray=C}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||G(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var y=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new W,this._redrawBounds.extend(f._pxBounds.min.subtract([y,y])),this._redrawBounds.extend(f._pxBounds.max.add([y,y]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var y=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,y.x,y.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,y=this._redrawBounds;if(this._ctx.save(),y){var C=y.getSize();this._ctx.beginPath(),this._ctx.rect(y.min.x,y.min.y,C.x,C.y),this._ctx.clip()}this._drawing=!0;for(var A=this._drawFirst;A;A=A.next)f=A.layer,(!y||f._pxBounds&&f._pxBounds.intersects(y))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,y){if(this._drawing){var C,A,V,J,ge=f._parts,Ce=ge.length,Oe=this._ctx;if(Ce){for(Oe.beginPath(),C=0;C<Ce;C++){for(A=0,V=ge[C].length;A<V;A++)J=ge[C][A],Oe[A?"lineTo":"moveTo"](J.x,J.y);y&&Oe.closePath()}this._fillStroke(Oe,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var y=f._point,C=this._ctx,A=Math.max(Math.round(f._radius),1),V=(Math.max(Math.round(f._radiusY),1)||A)/A;V!==1&&(C.save(),C.scale(1,V)),C.beginPath(),C.arc(y.x,y.y/V,A,0,Math.PI*2,!1),V!==1&&C.restore(),this._fillStroke(C,f)}},_fillStroke:function(f,y){var C=y.options;C.fill&&(f.globalAlpha=C.fillOpacity,f.fillStyle=C.fillColor||C.color,f.fill(C.fillRule||"evenodd")),C.stroke&&C.weight!==0&&(f.setLineDash&&f.setLineDash(y.options&&y.options._dashArray||[]),f.globalAlpha=C.opacity,f.lineWidth=C.weight,f.strokeStyle=C.color,f.lineCap=C.lineCap,f.lineJoin=C.lineJoin,f.stroke())},_onClick:function(f){for(var y=this._map.mouseEventToLayerPoint(f),C,A,V=this._drawFirst;V;V=V.next)C=V.layer,C.options.interactive&&C._containsPoint(y)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(C))&&(A=C);this._fireEvent(A?[A]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var y=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,y)}},_handleMouseOut:function(f){var y=this._hoveredLayer;y&&(fn(this._container,"leaflet-interactive"),this._fireEvent([y],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,y){if(!this._mouseHoverThrottled){for(var C,A,V=this._drawFirst;V;V=V.next)C=V.layer,C.options.interactive&&C._containsPoint(y)&&(A=C);A!==this._hoveredLayer&&(this._handleMouseOut(f),A&&(Pt(this._container,"leaflet-interactive"),this._fireEvent([A],f,"mouseover"),this._hoveredLayer=A)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,y,C){this._map._fireDOMEvent(y,C||y.type,f)},_bringToFront:function(f){var y=f._order;if(y){var C=y.next,A=y.prev;if(C)C.prev=A;else return;A?A.next=C:C&&(this._drawFirst=C),y.prev=this._drawLast,this._drawLast.next=y,y.next=null,this._drawLast=y,this._requestRedraw(f)}},_bringToBack:function(f){var y=f._order;if(y){var C=y.next,A=y.prev;if(A)A.next=C;else return;C?C.prev=A:A&&(this._drawLast=A),y.prev=null,y.next=this._drawFirst,this._drawFirst.prev=y,this._drawFirst=y,this._requestRedraw(f)}}});function Bf(f){return dt.canvas?new Vf(f):null}var tc=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Pm={_initContainer:function(){this._container=Mt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Pi.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var y=f._container=tc("shape");Pt(y,"leaflet-vml-shape "+(this.options.className||"")),y.coordsize="1 1",f._path=tc("path"),y.appendChild(f._path),this._updateStyle(f),this._layers[c(f)]=f},_addPath:function(f){var y=f._container;this._container.appendChild(y),f.options.interactive&&f.addInteractiveTarget(y)},_removePath:function(f){var y=f._container;pn(y),f.removeInteractiveTarget(y),delete this._layers[c(f)]},_updateStyle:function(f){var y=f._stroke,C=f._fill,A=f.options,V=f._container;V.stroked=!!A.stroke,V.filled=!!A.fill,A.stroke?(y||(y=f._stroke=tc("stroke")),V.appendChild(y),y.weight=A.weight+"px",y.color=A.color,y.opacity=A.opacity,A.dashArray?y.dashStyle=I(A.dashArray)?A.dashArray.join(" "):A.dashArray.replace(/( *, *)/g," "):y.dashStyle="",y.endcap=A.lineCap.replace("butt","flat"),y.joinstyle=A.lineJoin):y&&(V.removeChild(y),f._stroke=null),A.fill?(C||(C=f._fill=tc("fill")),V.appendChild(C),C.color=A.fillColor||A.color,C.opacity=A.fillOpacity):C&&(V.removeChild(C),f._fill=null)},_updateCircle:function(f){var y=f._point.round(),C=Math.round(f._radius),A=Math.round(f._radiusY||C);this._setPath(f,f._empty()?"M0 0":"AL "+y.x+","+y.y+" "+C+","+A+" 0,"+65535*360)},_setPath:function(f,y){f._path.v=y},_bringToFront:function(f){xi(f._container)},_bringToBack:function(f){os(f._container)}},ti=dt.vml?tc:ke,Yo=Pi.extend({_initContainer:function(){this._container=ti("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ti("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){pn(this._container),nn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Pi.prototype._update.call(this);var f=this._bounds,y=f.getSize(),C=this._container;(!this._svgSize||!this._svgSize.equals(y))&&(this._svgSize=y,C.setAttribute("width",y.x),C.setAttribute("height",y.y)),En(C,f.min),C.setAttribute("viewBox",[f.min.x,f.min.y,y.x,y.y].join(" ")),this.fire("update")}},_initPath:function(f){var y=f._path=ti("path");f.options.className&&Pt(y,f.options.className),f.options.interactive&&Pt(y,"leaflet-interactive"),this._updateStyle(f),this._layers[c(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){pn(f._path),f.removeInteractiveTarget(f._path),delete this._layers[c(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var y=f._path,C=f.options;y&&(C.stroke?(y.setAttribute("stroke",C.color),y.setAttribute("stroke-opacity",C.opacity),y.setAttribute("stroke-width",C.weight),y.setAttribute("stroke-linecap",C.lineCap),y.setAttribute("stroke-linejoin",C.lineJoin),C.dashArray?y.setAttribute("stroke-dasharray",C.dashArray):y.removeAttribute("stroke-dasharray"),C.dashOffset?y.setAttribute("stroke-dashoffset",C.dashOffset):y.removeAttribute("stroke-dashoffset")):y.setAttribute("stroke","none"),C.fill?(y.setAttribute("fill",C.fillColor||C.color),y.setAttribute("fill-opacity",C.fillOpacity),y.setAttribute("fill-rule",C.fillRule||"evenodd")):y.setAttribute("fill","none"))},_updatePoly:function(f,y){this._setPath(f,qe(f._parts,y))},_updateCircle:function(f){var y=f._point,C=Math.max(Math.round(f._radius),1),A=Math.max(Math.round(f._radiusY),1)||C,V="a"+C+","+A+" 0 1,0 ",J=f._empty()?"M0 0":"M"+(y.x-C)+","+y.y+V+C*2+",0 "+V+-C*2+",0 ";this._setPath(f,J)},_setPath:function(f,y){f._path.setAttribute("d",y)},_bringToFront:function(f){xi(f._path)},_bringToBack:function(f){os(f._path)}});dt.vml&&Yo.include(Pm);function Nu(f){return dt.svg||dt.vml?new Yo(f):null}Ut.include({getRenderer:function(f){var y=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return y||(y=this._renderer=this._createRenderer()),this.hasLayer(y)||this.addLayer(y),y},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var y=this._paneRenderers[f];return y===void 0&&(y=this._createRenderer({pane:f}),this._paneRenderers[f]=y),y},_createRenderer:function(f){return this.options.preferCanvas&&Bf(f)||Nu(f)}});var Mm=fs.extend({initialize:function(f,y){fs.prototype.initialize.call(this,this._boundsToLatLngs(f),y)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=oe(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function Sy(f,y){return new Mm(f,y)}Yo.create=ti,Yo.pointsToPath=qe,Gr.geometryToLayer=Ci,Gr.coordsToLatLng=Ka,Gr.coordsToLatLngs=oa,Gr.latLngToCoords=Ja,Gr.latLngsToCoords=Qa,Gr.getFeature=Ti,Gr.asFeature=Xa,Ut.mergeOptions({boxZoom:!0});var nc=Mr.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){jt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){nn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){pn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),$t(),Fa(),this._startPoint=this._map.mouseEventToContainerPoint(f),jt(document,{contextmenu:Lr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Mt("div","leaflet-zoom-box",this._container),Pt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var y=new W(this._point,this._startPoint),C=y.getSize();En(this._box,y.min),this._box.style.width=C.x+"px",this._box.style.height=C.y+"px"},_finish:function(){this._moved&&(pn(this._box),fn(this._container,"leaflet-crosshair")),bi(),qa(),nn(document,{contextmenu:Lr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var y=new K(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(y).fire("boxzoomend",{boxZoomBounds:y})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ut.addInitHook("addHandler","boxZoom",nc),Ut.mergeOptions({doubleClickZoom:!0});var km=Mr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var y=this._map,C=y.getZoom(),A=y.options.zoomDelta,V=f.originalEvent.shiftKey?C-A:C+A;y.options.doubleClickZoom==="center"?y.setZoom(V):y.setZoomAround(f.containerPoint,V)}});Ut.addInitHook("addHandler","doubleClickZoom",km),Ut.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Wf=Mr.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new Fr(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}Pt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){fn(this._map._container,"leaflet-grab"),fn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var y=oe(this._map.options.maxBounds);this._offsetLimit=ee(this._map.latLngToContainerPoint(y.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(y.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var y=this._lastTime=+new Date,C=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(C),this._times.push(y),this._prunePositions(y)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),y=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=y.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,y){return f-(f-y)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),y=this._offsetLimit;f.x<y.min.x&&(f.x=this._viscousLimit(f.x,y.min.x)),f.y<y.min.y&&(f.y=this._viscousLimit(f.y,y.min.y)),f.x>y.max.x&&(f.x=this._viscousLimit(f.x,y.max.x)),f.y>y.max.y&&(f.y=this._viscousLimit(f.y,y.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,y=Math.round(f/2),C=this._initialWorldOffset,A=this._draggable._newPos.x,V=(A-y+C)%f+y-C,J=(A+y+C)%f-y-C,ge=Math.abs(V+C)<Math.abs(J+C)?V:J;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ge},_onDragEnd:function(f){var y=this._map,C=y.options,A=!C.inertia||f.noInertia||this._times.length<2;if(y.fire("dragend",f),A)y.fire("moveend");else{this._prunePositions(+new Date);var V=this._lastPos.subtract(this._positions[0]),J=(this._lastTime-this._times[0])/1e3,ge=C.easeLinearity,Ce=V.multiplyBy(ge/J),Oe=Ce.distanceTo([0,0]),Ve=Math.min(C.inertiaMaxSpeed,Oe),rt=Ce.multiplyBy(Ve/Oe),_t=Ve/(C.inertiaDeceleration*ge),zt=rt.multiplyBy(-_t/2).round();!zt.x&&!zt.y?y.fire("moveend"):(zt=y._limitOffset(zt,y.options.maxBounds),G(function(){y.panBy(zt,{duration:_t,easeLinearity:ge,noMoveStart:!0,animate:!0})}))}}});Ut.addInitHook("addHandler","dragging",Wf),Ut.mergeOptions({keyboard:!0,keyboardPanDelta:80});var $f=Mr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),jt(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),nn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,y=document.documentElement,C=f.scrollTop||y.scrollTop,A=f.scrollLeft||y.scrollLeft;this._map._container.focus(),window.scrollTo(A,C)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var y=this._panKeys={},C=this.keyCodes,A,V;for(A=0,V=C.left.length;A<V;A++)y[C.left[A]]=[-1*f,0];for(A=0,V=C.right.length;A<V;A++)y[C.right[A]]=[f,0];for(A=0,V=C.down.length;A<V;A++)y[C.down[A]]=[0,f];for(A=0,V=C.up.length;A<V;A++)y[C.up[A]]=[0,-1*f]},_setZoomDelta:function(f){var y=this._zoomKeys={},C=this.keyCodes,A,V;for(A=0,V=C.zoomIn.length;A<V;A++)y[C.zoomIn[A]]=f;for(A=0,V=C.zoomOut.length;A<V;A++)y[C.zoomOut[A]]=-f},_addHooks:function(){jt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){nn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var y=f.keyCode,C=this._map,A;if(y in this._panKeys){if(!C._panAnim||!C._panAnim._inProgress)if(A=this._panKeys[y],f.shiftKey&&(A=se(A).multiplyBy(3)),C.options.maxBounds&&(A=C._limitOffset(se(A),C.options.maxBounds)),C.options.worldCopyJump){var V=C.wrapLatLng(C.unproject(C.project(C.getCenter()).add(A)));C.panTo(V)}else C.panBy(A)}else if(y in this._zoomKeys)C.setZoom(C.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[y]);else if(y===27&&C._popup&&C._popup.options.closeOnEscapeKey)C.closePopup();else return;Lr(f)}}});Ut.addInitHook("addHandler","keyboard",$f),Ut.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var bn=Mr.extend({addHooks:function(){jt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){nn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var y=Ll(f),C=this._map.options.wheelDebounceTime;this._delta+=y,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var A=Math.max(C-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),A),Lr(f)},_performZoom:function(){var f=this._map,y=f.getZoom(),C=this._map.options.zoomSnap||0;f._stop();var A=this._delta/(this._map.options.wheelPxPerZoomLevel*4),V=4*Math.log(2/(1+Math.exp(-Math.abs(A))))/Math.LN2,J=C?Math.ceil(V/C)*C:V,ge=f._limitZoom(y+(this._delta>0?J:-J))-y;this._delta=0,this._startTime=null,ge&&(f.options.scrollWheelZoom==="center"?f.setZoom(y+ge):f.setZoomAround(this._lastMousePos,y+ge))}});Ut.addInitHook("addHandler","scrollWheelZoom",bn);var Hf=600;Ut.mergeOptions({tapHold:dt.touchNative&&dt.safari&&dt.mobile,tapTolerance:15});var jd=Mr.extend({addHooks:function(){jt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){nn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var y=f.touches[0];this._startPos=this._newPos=new $(y.clientX,y.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(jt(document,"touchend",jn),jt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",y))},this),Hf),jt(document,"touchend touchcancel contextmenu",this._cancel,this),jt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){nn(document,"touchend",jn),nn(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),nn(document,"touchend touchcancel contextmenu",this._cancel,this),nn(document,"touchmove",this._onMove,this)},_onMove:function(f){var y=f.touches[0];this._newPos=new $(y.clientX,y.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,y){var C=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:y.screenX,screenY:y.screenY,clientX:y.clientX,clientY:y.clientY});C._simulated=!0,y.target.dispatchEvent(C)}});Ut.addInitHook("addHandler","tapHold",jd),Ut.mergeOptions({touchZoom:dt.touch,bounceAtZoomLimits:!0});var rc=Mr.extend({addHooks:function(){Pt(this._map._container,"leaflet-touch-zoom"),jt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){fn(this._map._container,"leaflet-touch-zoom"),nn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var y=this._map;if(!(!f.touches||f.touches.length!==2||y._animatingZoom||this._zooming)){var C=y.mouseEventToContainerPoint(f.touches[0]),A=y.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=y.getSize()._divideBy(2),this._startLatLng=y.containerPointToLatLng(this._centerPoint),y.options.touchZoom!=="center"&&(this._pinchStartLatLng=y.containerPointToLatLng(C.add(A)._divideBy(2))),this._startDist=C.distanceTo(A),this._startZoom=y.getZoom(),this._moved=!1,this._zooming=!0,y._stop(),jt(document,"touchmove",this._onTouchMove,this),jt(document,"touchend touchcancel",this._onTouchEnd,this),jn(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var y=this._map,C=y.mouseEventToContainerPoint(f.touches[0]),A=y.mouseEventToContainerPoint(f.touches[1]),V=C.distanceTo(A)/this._startDist;if(this._zoom=y.getScaleZoom(V,this._startZoom),!y.options.bounceAtZoomLimits&&(this._zoom<y.getMinZoom()&&V<1||this._zoom>y.getMaxZoom()&&V>1)&&(this._zoom=y._limitZoom(this._zoom)),y.options.touchZoom==="center"){if(this._center=this._startLatLng,V===1)return}else{var J=C._add(A)._divideBy(2)._subtract(this._centerPoint);if(V===1&&J.x===0&&J.y===0)return;this._center=y.unproject(y.project(this._pinchStartLatLng,this._zoom).subtract(J),this._zoom)}this._moved||(y._moveStart(!0,!1),this._moved=!0),X(this._animRequest);var ge=o(y._move,y,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=G(ge,this,!0),jn(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,X(this._animRequest),nn(document,"touchmove",this._onTouchMove,this),nn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ut.addInitHook("addHandler","touchZoom",rc),Ut.BoxZoom=nc,Ut.DoubleClickZoom=km,Ut.Drag=Wf,Ut.Keyboard=$f,Ut.ScrollWheelZoom=bn,Ut.TapHold=jd,Ut.TouchZoom=rc,t.Bounds=W,t.Browser=dt,t.CRS=_e,t.Canvas=Vf,t.Circle=Ga,t.CircleMarker=Ya,t.Class=Y,t.Control=vr,t.DivIcon=ju,t.DivOverlay=g,t.DomEvent=Va,t.DomUtil=ta,t.Draggable=Fr,t.Evented=ie,t.FeatureGroup=ds,t.GeoJSON=Gr,t.GridLayer=eo,t.Handler=Mr,t.Icon=ei,t.ImageOverlay=Ps,t.LatLng=re,t.LatLngBounds=K,t.Layer=qr,t.LayerGroup=Cs,t.LineUtil=Wl,t.Map=Ut,t.Marker=us,t.Mixin=Ao,t.Path=Ts,t.Point=$,t.PolyUtil=ud,t.Polygon=fs,t.Polyline=br,t.Popup=Su,t.PosAnimation=Ba,t.Projection=gd,t.Rectangle=Mm,t.Renderer=Pi,t.SVG=Yo,t.SVGOverlay=$o,t.TileLayer=to,t.Tooltip=Xl,t.Transformation=ce,t.Util=Q,t.VideoOverlay=Wo,t.bind=o,t.bounds=ee,t.canvas=Bf,t.circle=aa,t.circleMarker=Gl,t.control=Ns,t.divIcon=Cm,t.extend=s,t.featureGroup=Hl,t.geoJSON=Zl,t.geoJson=zr,t.gridLayer=ec,t.icon=Yl,t.imageOverlay=Kl,t.latLng=me,t.latLngBounds=oe,t.layerGroup=ia,t.map=js,t.marker=vd,t.point=se,t.polygon=_d,t.polyline=bd,t.popup=Ql,t.rectangle=Sy,t.setOptions=w,t.stamp=c,t.svg=Nu,t.svgOverlay=Ho,t.tileLayer=Uf,t.tooltip=wd,t.transformation=Se,t.version=r,t.videoOverlay=Jl;var Em=window.L;t.noConflict=function(){return window.L=Em,this},window.L=t}))})(zh,zh.exports)),zh.exports}var hde=fde();const Wd=hu(hde),mde=({events:n,users:e})=>{const t=E.useRef(null),r=E.useRef(null),s=E.useRef(Wd.layerGroup()),a=E.useRef(null),{theme:o}=gu();return E.useEffect(()=>{r.current&&!t.current&&(t.current=Wd.map(r.current,{zoomControl:!1}).setView([12.9716,77.5946],12),s.current.addTo(t.current),Wd.control.zoom({position:"bottomright"}).addTo(t.current)),setTimeout(()=>t.current?.invalidateSize(),100)},[]),E.useEffect(()=>{if(!t.current)return;const l=o==="dark",m=l?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",p=l?'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>':'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';a.current?(a.current.setUrl(m),t.current.attributionControl.setPrefix(p)):a.current=Wd.tileLayer(m,{attribution:p}).addTo(t.current)},[o]),E.useEffect(()=>{s.current.clearLayers();const l=new Map;n.forEach(m=>{if(m.latitude&&m.longitude){const p=l.get(m.userId);(!p||new Date(m.timestamp)>new Date(p.timestamp))&&l.set(m.userId,m)}});const c=new Map(e.map(m=>[m.id,m])),d=[];if(l.forEach(m=>{const p=c.get(m.userId);if(p&&m.latitude&&m.longitude){const x=Wd.divIcon({className:"",html:`<div class="user-marker" style="background-image: url(${p.photoUrl||`https://i.pravatar.cc/150?u=${p.id}`})"></div>`,iconSize:[48,48],iconAnchor:[24,56],popupAnchor:[0,-56]}),v=Wd.marker([m.latitude,m.longitude],{icon:x});v.bindPopup(`
                    <div class="user-marker-popup">
                        <p class="popup-name">${p.name}</p>
                        <p class="popup-time">Last seen: ${Ue(new Date(m.timestamp),"hh:mm a")}</p>
                    </div>
                `),s.current.addLayer(v),d.push(v)}}),d.length>0&&t.current){const m=Wd.featureGroup(d);t.current.fitBounds(m.getBounds().pad(.5))}else t.current&&t.current.setView([12.9716,77.5946],12)},[n,e]),i.jsx("div",{ref:r,style:{height:"600px",width:"100%",borderRadius:"1rem",zIndex:0}})},pde=({event:n})=>i.jsxs("div",{className:"bg-card rounded-2xl border border-border overflow-hidden shadow-sm",children:[i.jsxs("div",{className:"p-3 bg-page flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium text-muted",children:"User"}),i.jsx("span",{className:"font-semibold text-primary-text",children:n.userName})]}),i.jsxs("div",{className:"p-3 space-y-3 text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Event"}),i.jsx("span",{className:"font-semibold capitalize text-primary-text",children:n.type.replace("-"," ")})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Timestamp"}),i.jsx("span",{className:"text-primary-text",children:Ue(new Date(n.timestamp),"dd MMM, yy - hh:mm a")})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Location"}),n.latitude&&n.longitude?i.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${n.latitude},${n.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-accent hover:underline",children:[i.jsx(wl,{className:"h-4 w-4 mr-1"})," View on Map"]}):i.jsx("span",{className:"text-primary-text",children:"-"})]})]})]}),gde=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(!0),[c,d]=E.useState(Ue(new Date,"yyyy-MM-dd")),[m,p]=E.useState(Ue(new Date,"yyyy-MM-dd")),[x,v]=E.useState("all"),_=Jt("(max-width: 767px)"),w=E.useMemo(()=>s.filter(M=>M.role==="field_officer"),[s]),j=E.useCallback(async()=>{l(!0);try{const M=new Date(c);M.setHours(0,0,0,0);const D=new Date(m);D.setHours(23,59,59,999);const[O,q]=await Promise.all([pe.getAllAttendanceEvents(M.toISOString(),D.toISOString()),pe.getUsers()]);r(O),a(q)}catch(M){console.error("Failed to fetch tracking data",M)}finally{l(!1)}},[c,m]);E.useEffect(()=>{j()},[j]);const P=E.useMemo(()=>{let M=t;x!=="all"&&(M=M.filter(O=>O.userId===x));const D=new Map(s.map(O=>[O.id,O]));return M.map(O=>({...O,userName:D.get(O.userId)?.name||"Unknown User"})).sort((O,q)=>new Date(q.timestamp).getTime()-new Date(O.timestamp).getTime())},[t,s,x]),k=E.useMemo(()=>{const M=new Set(P.map(D=>D.userId));return s.filter(D=>M.has(D.id))},[P,s]),I=()=>o?i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):n==="map"?i.jsx(mde,{events:P,users:k}):n==="route"?x==="all"?i.jsx("div",{className:"text-center py-10 text-muted",children:"Please select a specific user to view their route coverage."}):i.jsx(RouteView,{events:P,selectedUser:x}):_?i.jsx("div",{className:"space-y-3",children:P.length===0?i.jsx("div",{className:"text-center py-10 text-muted",children:"No events found."}):P.map(M=>i.jsx(pde,{event:M},M.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"User"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Event"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Timestamp"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Location"})]})}),i.jsx("tbody",{children:P.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No events found."})}):P.map(M=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"User",className:"px-6 py-4 whitespace-nowrap font-medium",children:M.userName}),i.jsx("td",{"data-label":"Event",className:"px-6 py-4 whitespace-nowrap capitalize",children:M.type.replace("-"," ")}),i.jsx("td",{"data-label":"Timestamp",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:Ue(new Date(M.timestamp),"dd MMM, yyyy - hh:mm a")}),i.jsx("td",{"data-label":"Location",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:M.latitude&&M.longitude?i.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${M.latitude},${M.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center md:justify-start justify-end text-accent hover:underline",children:[i.jsx(wl,{className:"h-4 w-4 mr-1"})," View on Map"]}):"-"})]},M.id))})]})});return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text flex-shrink-0",children:"User Activity Tracking"}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto justify-end flex-wrap",children:[i.jsx("div",{className:"w-full sm:w-40",children:i.jsx(Nn,{label:"",id:"start-date",value:c,onChange:d})}),i.jsx("div",{className:"w-full sm:w-40",children:i.jsx(Nn,{label:"",id:"end-date",value:m,onChange:p})}),i.jsx("div",{className:"w-full sm:w-48",children:i.jsxs(Qe,{label:"",id:"user-select",value:x,onChange:M=>v(M.target.value),children:[i.jsx("option",{value:"all",children:"All Users"}),w.map(M=>i.jsx("option",{value:M.id,children:M.name},M.id))]})})]})]}),i.jsx("div",{className:"mt-4",children:i.jsxs("div",{className:"bg-page p-1 rounded-full flex items-center w-fit",children:[i.jsxs("button",{onClick:()=>e("list"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="list"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(eJ,{className:"h-4 w-4"}),"List View"]}),i.jsxs("button",{onClick:()=>e("map"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="map"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(LF,{className:"h-4 w-4"}),"Map View"]}),i.jsxs("button",{onClick:()=>e("route"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="route"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(oJ,{className:"h-4 w-4"}),"Route View"]})]})})]}),i.jsx("div",{className:"mt-6",children:I()})]})},xde=(n,e,t,r)=>{const a=n*Math.PI/180,o=t*Math.PI/180,l=(t-n)*Math.PI/180,c=(r-e)*Math.PI/180,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},yde=()=>{const{user:n}=St(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState(""),[l,c]=E.useState("100"),[d,m]=E.useState(""),[p,x]=E.useState(""),[v,_]=E.useState(""),[w,j]=E.useState(""),[P,k]=E.useState([]),[I,M]=E.useState(!0),[D,O]=E.useState(null),[q,F]=E.useState(null);E.useEffect(()=>{(async()=>{try{const[$,H]=await Promise.all([pe.getLocations(),pe.getUsers()]);t($),s(H)}catch($){console.error($),O({message:"Failed to load locations or users.",type:"error"})}finally{M(!1)}})()},[]);const U=at.useMemo(()=>{const ie=new Map;return r.forEach($=>ie.set($.id,$.name)),ie},[r]),B=async()=>{try{const ie=await pe.getLocations();t(ie)}catch(ie){console.error(ie),O({message:"Failed to refresh locations.",type:"error"})}},G=async()=>{try{const ie=await Bx(),{latitude:$,longitude:H}=ie.coords;m($.toString()),x(H.toString());try{const se=await sm($,H);v||_(se),a||o(se)}catch(se){console.warn("Reverse geocode failed",se)}}catch(ie){console.error(ie),O({message:"Unable to retrieve current location.",type:"error"})}},X=async()=>{const ie=parseFloat(l),$=parseFloat(d),H=parseFloat(p);if(isNaN(ie)||ie<10||ie>1e3){O({message:"Radius must be between 10 and 1000 meters.",type:"error"});return}if(isNaN($)||isNaN(H)){O({message:"Please provide valid latitude and longitude.",type:"error"});return}try{const se=v||await sm($,H);if(!q&&e.some(ee=>xde($,H,ee.latitude,ee.longitude)<10)){O({message:"A location already exists at these coordinates. Please use a different location.",type:"error"});return}q?(await pe.updateLocation(q,{name:a||se,latitude:$,longitude:H,radius:ie,address:se}),O({message:"Location updated successfully.",type:"success"}),F(null)):(await pe.createLocation({name:a||se,latitude:$,longitude:H,radius:ie,address:se,createdBy:n?.id||null}),O({message:"Location created successfully.",type:"success"})),o(""),c("100"),m(""),x(""),_(""),await B()}catch(se){console.error(se);const W=se?.message||(q?"Failed to update location.":"Failed to create location.");O({message:W,type:"error"})}},Q=async()=>{if(!w||P.length===0){O({message:"Please select a user and at least one location.",type:"error"});return}try{await Promise.all(P.map(ie=>pe.assignLocationToUser(w,ie))),O({message:"Location(s) assigned to user.",type:"success"}),j(""),k([])}catch(ie){console.error(ie),O({message:"Failed to assign location(s).",type:"error"})}},Y=ie=>{F(ie.id),o(ie.name||""),c(ie.radius.toString()),m(ie.latitude.toString()),x(ie.longitude.toString()),_(ie.address||""),window.scrollTo({top:0,behavior:"smooth"})},ne=()=>{F(null),o(""),c("100"),m(""),x(""),_("")},te=async ie=>{if(window.confirm("Are you sure you want to delete this location? This will remove it from all users and the database."))try{await pe.deleteLocation(ie),O({message:"Location deleted successfully from all users and database.",type:"success"}),await B()}catch($){console.error($);const H=$?.message||"Failed to delete location.";O({message:H,type:"error"})}};return i.jsxs("div",{className:"p-4 md:p-6 w-full",children:[D&&i.jsx(Gt,{message:D.message,type:D.type,onDismiss:()=>O(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx(Yi,{title:"Location Management"}),i.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Define geofenced locations and assign them to staff. Only checkins within these locations will be accepted."})]}),i.jsxs("div",{className:"mt-6 space-y-6",children:[i.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(wl,{className:"h-5 w-5 mr-2 text-muted"})," ",q?"Edit Location":"Add New Location"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(Me,{label:"Name (optional)",id:"locName",value:a,onChange:ie=>o(ie.target.value),placeholder:"e.g. Office HQ"}),i.jsx(Me,{label:"Radius (meters)",id:"locRadius",type:"number",value:l,onChange:ie=>c(ie.target.value),min:"10",max:"1000"}),i.jsx(Me,{label:"Latitude",id:"locLat",type:"number",value:d,onChange:ie=>m(ie.target.value),placeholder:"12.9716"}),i.jsx(Me,{label:"Longitude",id:"locLng",type:"number",value:p,onChange:ie=>x(ie.target.value),placeholder:"77.5946"}),i.jsx(Me,{label:"Address (optional)",id:"locAddr",value:v,onChange:ie=>_(ie.target.value),placeholder:"Street, City, State"})]}),i.jsxs("div",{className:"flex flex-wrap mt-4 gap-4",children:[i.jsxs(ae,{variant:"secondary",onClick:G,children:[i.jsx(qF,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),q?i.jsxs(i.Fragment,{children:[i.jsxs(ae,{onClick:X,children:[i.jsx(is,{className:"h-4 w-4 mr-2"})," Save Changes"]}),i.jsx(ae,{variant:"secondary",onClick:ne,children:"Cancel"})]}):i.jsxs(ae,{onClick:X,children:[i.jsx(qt,{className:"h-4 w-4 mr-2"})," Add Location"]})]})]}),i.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(mi,{className:"h-5 w-5 mr-2 text-muted"})," Assign Location to User"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs(Qe,{label:"Select User",id:"assignUser",value:w,onChange:ie=>j(ie.target.value),children:[i.jsx("option",{value:"",children:"-- Select User --"}),r.map(ie=>i.jsx("option",{value:ie.id,children:ie.name},ie.id))]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Select Location(s)"}),i.jsx("div",{className:"border border-border rounded-lg p-3 max-h-48 overflow-y-auto bg-page",children:e.length===0?i.jsx("p",{className:"text-muted text-sm",children:"No locations available."}):e.map(ie=>i.jsxs("label",{className:"flex items-center justify-start gap-2 py-1 text-sm",children:[i.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-accent border-gray-300 rounded",checked:P.includes(ie.id),onChange:$=>{k(H=>$.target.checked?[...H,ie.id]:H.filter(se=>se!==ie.id))}}),i.jsx("span",{children:ie.name||ie.address||`${ie.latitude.toFixed(4)}, ${ie.longitude.toFixed(4)}`})]},ie.id))})]})]}),i.jsx("div",{className:"flex justify-end mt-4",children:i.jsxs(ae,{onClick:Q,className:"w-full md:w-auto",children:[i.jsx(is,{className:"h-4 w-4 mr-2"})," Assign"]})})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-xl font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(wl,{className:"h-5 w-5 mr-2 text-muted"})," Existing Locations"]}),I?i.jsx("p",{children:"Loading..."}):e.length===0?i.jsx("p",{className:"text-muted text-center md:text-left",children:"No locations defined yet."}):i.jsxs("div",{className:"space-y-4 md:space-y-0",children:[i.jsx("div",{className:"md:hidden space-y-4",children:e.map(ie=>i.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-primary-text",children:ie.name||"Unnamed Location"}),i.jsx("p",{className:"text-sm text-muted",children:ie.address})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-500 hover:text-blue-700 p-1",title:"Edit",onClick:()=>Y(ie),children:i.jsx(xr,{className:"h-5 w-5"})}),i.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 p-1",title:"Delete",onClick:()=>te(ie.id),children:i.jsx(Xt,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Radius"}),i.jsxs("p",{children:[ie.radius,"m"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Coordinates"}),i.jsxs("p",{children:[ie.latitude.toFixed(4),", ",ie.longitude.toFixed(4)]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Created By"}),i.jsx("p",{children:ie.createdByName||U.get(ie.createdBy||"")||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Created At"}),i.jsx("p",{children:ie.createdAt?new Date(ie.createdAt).toLocaleDateString():"-"})]})]})]},ie.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[i.jsx("thead",{className:"bg-page text-primary-text",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created By"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created At"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),i.jsx("tbody",{children:e.map(ie=>i.jsxs("tr",{className:"border-b border-border",children:[i.jsx("td",{className:"p-3",children:ie.name||"-"}),i.jsx("td",{className:"p-3",children:ie.radius}),i.jsxs("td",{className:"p-3",children:[ie.latitude.toFixed(4),", ",ie.longitude.toFixed(4)]}),i.jsx("td",{className:"p-3",children:ie.address||"-"}),i.jsx("td",{className:"p-3",children:ie.createdByName||U.get(ie.createdBy||"")||"-"}),i.jsx("td",{className:"p-3",children:ie.createdAt?new Date(ie.createdAt).toLocaleString():"-"}),i.jsxs("td",{className:"p-3 whitespace-nowrap",children:[i.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-800 mr-3",title:"Edit",onClick:()=>Y(ie),children:i.jsx(xr,{className:"h-4 w-4"})}),i.jsx("button",{type:"button",className:"text-red-600 hover:text-red-800",title:"Delete",onClick:()=>te(ie.id),children:i.jsx(Xt,{className:"h-4 w-4"})})]})]},ie.id))})]})})]})]})]})]})},vde=({isOpen:n,onClose:e,onOverride:t,employeeName:r,bankName:s,reason:a})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",children:[i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10 flex items-center justify-center rounded-full bg-red-100",children:i.jsx(Ca,{className:"h-6 w-6 text-red-600"})}),i.jsxs("div",{className:"ml-4 flex-1",children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Verification Alert: Name Mismatch Found"}),i.jsxs("div",{className:"mt-2 text-sm text-muted space-y-2",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name on ID:"}),' "',r,'"']}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name on Bank Proof:"}),' "',s,'"']}),a&&i.jsxs("p",{className:"mt-2 p-2 bg-page rounded-md",children:[i.jsx("strong",{children:"AI Analysis:"})," ",i.jsx("em",{children:a})]}),i.jsx("p",{className:"mt-2",children:"Please upload the correct documents. If the names are different for a valid reason (e.g., maiden name), you can override this warning, but it will require manual verification by an administrator."})]})]})]}),i.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[i.jsx(ae,{onClick:t,variant:"danger",children:"Override & Proceed"}),i.jsx(ae,{onClick:e,variant:"secondary",children:"Re-upload Documents"})]})]})}):null,bde={documents:{aadhaar:!0,pan:!0,bankProof:!0,educationCertificate:!0,salarySlip:!0,uanProof:!0,familyAadhaar:!0},verifications:{requireBengaluruAddress:!0,requireDobVerification:!0}},_de=n=>{const e=wt({id:be().required(),relation:be().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),phone:be().when("relation",{is:"Child",then:r=>r.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:r=>r.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:n.documents.familyAadhaar?Ft().nonNullable("Aadhaar proof is required for each family member."):Ft().optional().nullable()}),t=wt({id:be().required(),document:n.documents.educationCertificate?Ft().nonNullable("Education certificate is required."):Ft().optional().nullable()});return wt({photo:Ft().optional().nullable(),aadhaarLinkedMobile:be().required("Aadhaar-linked mobile number is required.").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),alternateMobile:be().optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),idProofType:be().oneOf(["Aadhaar","PAN","Voter ID",""]).required(),idProofFront:Ft().nonNullable("Aadhaar (Front) is required."),idProofBack:Ft().nonNullable("Aadhaar (Back) is required."),bankProof:Ft().nonNullable("Bank proof document is required."),uanProof:Ft().nonNullable("UAN proof document is required."),salarySlip:n.documents.salarySlip?Ft().nonNullable("Salary slip is required."):Ft().optional().nullable(),family:xs().of(e).optional(),education:xs().of(t).optional()}).defined()},$d=n=>new Promise((e,t)=>{const r=new FileReader;r.readAsDataURL(n),r.onload=()=>e({base64:r.result.split(",")[1],type:n.type}),r.onerror=s=>t(s)}),Eh=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",wde=()=>{const n=yn(),e=Wn(),{user:t}=St(),{rulesByDesignation:r}=Zc(),[s,a]=E.useState(!1),[o,l]=E.useState(null),[c,d]=E.useState({isOpen:!1,employeeName:"",bankName:"",reason:""}),[m,p]=E.useState(window.innerWidth<768),x=e.data.organization.designation,v=E.useMemo(()=>x&&r[x]?r[x]:bde,[x,r]),_=E.useMemo(()=>_de(v),[v]);E.useEffect(()=>{const Y=()=>p(window.innerWidth<768);return window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]),t?.role;const{control:w,handleSubmit:j,formState:{errors:P},getValues:k,watch:I}=Zt({resolver:_n(_),defaultValues:{aadhaarLinkedMobile:"",alternateMobile:"",photo:null,idProofType:"Aadhaar",idProofFront:null,idProofBack:null,bankProof:null,salarySlip:null,uanProof:null,family:[],education:[]}}),{fields:M,append:D,remove:O}=ys({control:w,name:"family"}),{fields:q,append:F,remove:U}=ys({control:w,name:"education"});I("idProofType");const B=I("family"),G=async(Y,ne=!1)=>{a(!0),e.setRequiresManualVerification(ne);try{const te={type:Xe.OBJECT,properties:{name:{type:Xe.STRING,description:"The person's full name as written on the card."},dob:{type:Xe.STRING,description:"The person's date of birth in YYYY-MM-DD format. If only year available, return YYYY-01-01."},gender:{type:Xe.STRING,description:"Gender: 'Male', 'Female', or 'Other'."},aadhaarNumber:{type:Xe.STRING,description:"The 12-digit Aadhaar number, if present."},panNumber:{type:Xe.STRING,description:"The 10-character PAN number, if present."},voterIdNumber:{type:Xe.STRING,description:"The Voter ID number, also known as EPIC number."}}},ie={type:Xe.OBJECT,properties:{address:{type:Xe.OBJECT,description:"The full address on the back of an Aadhaar card, parsed into components.",properties:{line1:{type:Xe.STRING,description:"Full address line(s) excluding city, state, pincode. e.g., 'S/O: John Doe, 123 Maple Street, Anytown'"},city:{type:Xe.STRING},state:{type:Xe.STRING},pincode:{type:Xe.STRING}}}}},$={type:Xe.OBJECT,properties:{accountHolderName:{type:Xe.STRING,description:"The account holder's full name."},accountNumber:{type:Xe.STRING,description:"The full bank account number."},ifscCode:{type:Xe.STRING,description:"The bank's IFSC code."},bankName:{type:Xe.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:Xe.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}}},H={type:Xe.OBJECT,properties:{uanNumber:{type:Xe.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:Xe.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:Xe.STRING,description:"The 10 or 17-digit ESI number."}}},se={type:Xe.OBJECT,properties:{uanNumber:{type:Xe.STRING}}},W={type:Xe.OBJECT,properties:{name:{type:Xe.STRING},dob:{type:Xe.STRING}}},ee={type:Xe.OBJECT,properties:{degree:{type:Xe.STRING},institution:{type:Xe.STRING},endYear:{type:Xe.STRING}}},K=[Y.idProofFront?$d(Y.idProofFront.file):Promise.resolve(null),(Y.idProofType==="Aadhaar"||Y.idProofType==="Voter ID")&&Y.idProofBack?$d(Y.idProofBack.file):Promise.resolve(null),Y.bankProof?$d(Y.bankProof.file):Promise.resolve(null),Y.salarySlip?$d(Y.salarySlip.file):Promise.resolve(null),Y.uanProof?$d(Y.uanProof.file):Promise.resolve(null),...Y.family.map(ot=>ot.idProof?$d(ot.idProof.file):Promise.resolve(null)),...Y.education.map(ot=>ot.document?$d(ot.document.file):Promise.resolve(null))],[oe,re,me,_e,le,...fe]=await Promise.all(K),ue=fe.slice(0,Y.family.length),ce=fe.slice(Y.family.length),Se=oe?pe.extractDataFromImage(oe.base64,oe.type,te,Y.idProofType):Promise.resolve({}),ye=re&&Y.idProofType==="Aadhaar"?pe.extractDataFromImage(re.base64,re.type,ie,"Aadhaar"):Promise.resolve({}),Ne=me?pe.extractDataFromImage(me.base64,me.type,$,"Bank"):Promise.resolve({}),ke=_e?pe.extractDataFromImage(_e.base64,_e.type,H,"Salary"):Promise.resolve(null),qe=le?pe.extractDataFromImage(le.base64,le.type,se,"UAN"):Promise.resolve(null),ze=ue.map(ot=>ot?pe.extractDataFromImage(ot.base64,ot.type,W,"Aadhaar"):Promise.resolve({})),He=ce.map(ot=>ot?pe.extractDataFromImage(ot.base64,ot.type,ee):Promise.resolve({})),[Be,de,xe,Pe,Ge,...Fe]=await Promise.all([Se,ye,Ne,ke,qe,...ze,...He]),Le=Fe.slice(0,ue.length),Je=Fe.slice(ue.length),nt={...Be,...de},ct=nt.name||"",Vt=xe.accountHolderName||"";if(!ne&&ct&&Vt){const{isMatch:ot,reason:kn}=await pe.crossVerifyNames(ct,Vt);if(!ot){d({isOpen:!0,employeeName:ct,bankName:Vt,reason:kn}),a(!1);return}}const At={idProofType:Y.idProofType,idProofFront:Y.idProofFront,idProofBack:Y.idProofBack,photo:Y.photo,mobile:Y.aadhaarLinkedMobile,alternateMobile:Y.alternateMobile},vt={};if(nt.name){const ot=nt.name.split(" ");At.firstName=Eh(ot.shift()||""),At.lastName=Eh(ot.pop()||""),At.middleName=Eh(ot.join(" ")),At.preferredName=At.firstName,vt.name=!0}if(nt.dob)try{At.dob=Ue(new Date(nt.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd"),vt.dob=!0}catch{}if(nt.gender){const ot=nt.gender.toLowerCase().trim();ot.includes("male")||ot.includes("purush")||ot==="m"?At.gender="Male":ot.includes("female")||ot.includes("mahila")||ot==="f"?At.gender="Female":ot.includes("transgender")&&(At.gender="Other")}(nt.aadhaarNumber||nt.panNumber||nt.voterIdNumber)&&(At.idProofNumber=(nt.aadhaarNumber||nt.panNumber||nt.voterIdNumber).replace(/\s/g,""),vt.idProofNumber=!0);const wn={bankProof:Y.bankProof},Pn={};if(xe.accountHolderName&&(wn.accountHolderName=Eh(xe.accountHolderName),Pn.accountHolderName=!0),xe.accountNumber){const ot=xe.accountNumber.replace(/\D/g,"");wn.accountNumber=ot,wn.confirmAccountNumber=ot,Pn.accountNumber=!0}xe.ifscCode&&(wn.ifscCode=xe.ifscCode.toUpperCase().replace(/\s/g,""),Pn.ifscCode=!0),xe.bankName&&(wn.bankName=xe.bankName),xe.branchName&&(wn.branchName=xe.branchName);const Ht={salarySlip:Y.salarySlip,document:Y.uanProof},Un={},Mn={},An={},Pr=Ge?.uanNumber||Pe?.uanNumber;if(Pr){const ot=Pr.replace(/\D/g,"");ot.length===12&&(Ht.uanNumber=ot,Ht.hasPreviousPf=!0,Mn.uanNumber=!0)}if(Pe?.pfNumber&&(Ht.pfNumber=Pe.pfNumber,Ht.hasPreviousPf=!0),Pe?.esiNumber){const ot=Pe.esiNumber.replace(/\D/g,"");(ot.length===10||ot.length===17)&&(Un.esiNumber=ot,Un.hasEsi=!0,An.esiNumber=!0)}const $r=Le.map((ot,kn)=>{const Xn=Y.family[kn];let Hs="";if(ot.dob)try{Hs=Ue(new Date(ot.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd")}catch{}return{id:`fam_preupload_${Date.now()}_${kn}`,relation:Xn.relation,name:Eh(ot.name)||"",dob:Hs,gender:"",occupation:"",dependent:!1,idProof:Xn.idProof,phone:Xn.phone}}),un=Je.map((ot,kn)=>{const Xn=Y.education[kn];return{id:`edu_preupload_${Date.now()}_${kn}`,degree:ot.degree||"",institution:ot.institution||"",startYear:"",endYear:ot.endYear||"",document:Xn.document}});nt.address&&e.updateAddress({present:{...nt.address,country:"India",verifiedStatus:{line1:!0,city:!0,state:!0,pincode:!0,country:!0}},permanent:{...nt.address,country:"India"},sameAsPresent:!0}),e.updateBank(wn),e.setBankVerifiedStatus(Pn),e.updateUan(Ht),e.setUanVerifiedStatus(Mn),e.updateEsi(Un),e.setEsiVerifiedStatus(An),e.updateFamily($r),e.updateEducation(un),e.updatePersonal(At),e.setPersonalVerifiedStatus(vt),l({message:"Application auto-filled! Please review.",type:"success"}),n("/onboarding/add/personal")}catch(te){const ie=te instanceof Error?te.message:"An unexpected error occurred.";console.error("Document processing failed:",te),l({message:`Document processing failed: ${ie}`,type:"error"}),a(!1)}},X=Y=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),G(Y,!1)},Q=()=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),G(k(),!0)};return i.jsxs("div",{className:"relative",children:[s&&i.jsxs("div",{className:"absolute inset-0 bg-page/90 backdrop-blur-sm z-10 flex flex-col items-center justify-center rounded-xl animate-fade-in-scale",children:[i.jsx(Tt,{className:"h-12 w-12 animate-spin text-accent"}),i.jsx("p",{className:"mt-4 text-lg font-semibold text-primary-text",children:"Processing Documents..."}),i.jsx("p",{className:"text-muted text-center max-w-xs",children:"Our AI is analyzing your files. This may take a moment."})]}),i.jsxs("div",{className:`bg-card p-8 rounded-xl shadow-card w-full transition-all ${s?"blur-sm pointer-events-none":""}`,children:[i.jsx(vde,{...c,onClose:()=>d({isOpen:!1,employeeName:"",bankName:"",reason:""}),onOverride:Q}),i.jsxs("form",{onSubmit:j(X),children:[i.jsx(Tr,{title:"Document Collection",subtitle:"Upload documents to auto-fill the application."}),i.jsxs("div",{className:"space-y-8 mt-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(je,{name:"photo",control:w,render:({field:Y})=>i.jsx(xt,{label:"Profile Photo",file:Y.value,onFileChange:Y.onChange,allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsx(je,{name:"aadhaarLinkedMobile",control:w,render:({field:Y,fieldState:ne})=>i.jsx(Me,{label:"Aadhaar Linked Mobile Number",type:"tel",...Y,error:ne.error?.message})}),i.jsx(je,{name:"alternateMobile",control:w,render:({field:Y,fieldState:ne})=>i.jsx(Me,{label:"Alternative Mobile Number (Optional)",type:"tel",...Y,error:ne.error?.message})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(je,{name:"idProofFront",control:w,render:({field:Y})=>i.jsx(xt,{label:"Aadhaar (Front Side)",file:Y.value,onFileChange:Y.onChange,error:P.idProofFront?.message,allowCapture:!0,verificationStatus:e.data.personal.verifiedStatus?.idProofNumber})}),i.jsx(je,{name:"idProofBack",control:w,render:({field:Y})=>i.jsx(xt,{label:"Aadhaar (Back Side)",file:Y.value,onFileChange:Y.onChange,error:P.idProofBack?.message,allowCapture:!0,verificationStatus:e.data.personal.verifiedStatus?.idProofNumber})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(je,{name:"bankProof",control:w,render:({field:Y})=>i.jsx(xt,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:Y.value,onFileChange:Y.onChange,error:P.bankProof?.message,allowCapture:!0,verificationStatus:e.data.bank.verifiedStatus?.accountNumber})}),i.jsx(je,{name:"uanProof",control:w,render:({field:Y})=>i.jsx(xt,{label:"UAN Proof Document",file:Y.value,onFileChange:Y.onChange,error:P.uanProof?.message,allowCapture:!0,verificationStatus:e.data.uan.verifiedStatus?.uanNumber})})]}),v.documents.salarySlip&&i.jsx(je,{name:"salarySlip",control:w,render:({field:Y})=>i.jsx(xt,{label:"Latest Salary Slip",file:Y.value,onFileChange:Y.onChange,error:P.salarySlip?.message,allowCapture:!0})}),v.documents.educationCertificate&&i.jsxs("div",{className:"pt-6 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[q.map((Y,ne)=>i.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 relative",children:[i.jsx(je,{name:`education.${ne}.document`,control:w,render:({field:te,fieldState:ie})=>i.jsx(xt,{label:"Certificate",file:te.value,onFileChange:te.onChange,error:ie.error?.message,allowCapture:!0})}),i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>U(ne),className:"!absolute top-2 right-2",children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})]},Y.id)),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>F({id:`edu_upload_${Date.now()}`,document:null}),children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Certificate"]})]})]}),v.documents.familyAadhaar&&i.jsxs("div",{className:"pt-6 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[M.map((Y,ne)=>{const ie=B?.[ne]?.relation==="Child";return i.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 grid grid-cols-1 md:grid-cols-3 gap-4 items-start relative",children:[i.jsx(je,{name:`family.${ne}.relation`,control:w,render:({field:$,fieldState:H})=>i.jsxs(Qe,{label:"Relation",error:H.error?.message,...$,children:[" ",i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})," "]})}),i.jsx(je,{name:`family.${ne}.phone`,control:w,render:({field:$,fieldState:H})=>i.jsx(Me,{label:`Phone Number${ie?" (Optional)":""}`,type:"tel",...$,error:H.error?.message})}),i.jsx("div",{className:"md:col-start-1 md:col-span-3",children:i.jsx(je,{name:`family.${ne}.idProof`,control:w,render:({field:$,fieldState:H})=>i.jsx(xt,{label:"Aadhaar Card",file:$.value,onFileChange:$.onChange,error:H.error?.message,allowCapture:!0})})}),i.jsx(ae,{type:"button",variant:"icon",size:"sm",onClick:()=>O(ne),className:"!absolute top-2 right-2",children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})]},Y.id)}),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>D({id:`fam_upload_${Date.now()}`,relation:"",idProof:null,phone:""}),children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-between items-center gap-4",children:[i.jsxs(ae,{type:"button",variant:"secondary",onClick:()=>n(-1),children:[i.jsx(Hi,{className:"mr-2 h-4 w-4"})," Back"]}),i.jsx(ae,{type:"submit",isLoading:s,children:"Process"})]})]})]})]})},Sde=({count:n=3})=>i.jsx("div",{className:"space-y-2.5",children:Array.from({length:n}).map((e,t)=>i.jsxs("div",{className:"bg-[#243524] p-3 rounded-xl flex gap-4 items-start border border-transparent",children:[i.jsx(Wr,{className:"w-12 h-12 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"flex-grow space-y-2 mt-1",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx(Wr,{className:"h-4 w-1/2"}),i.jsx(Wr,{className:"h-5 w-20 rounded-full"})]}),i.jsx(Wr,{className:"h-3 w-1/3"}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[i.jsx(Wr,{className:"h-3 w-20"}),i.jsx(Wr,{className:"h-3 w-20"}),i.jsx(Wr,{className:"h-3 w-20"}),i.jsx(Wr,{className:"h-3 w-20"})]})]})]},t))}),Ug=({label:n,checked:e})=>i.jsxs("div",{className:"flex items-center gap-1.5",children:[e?i.jsx(xC,{className:"h-4 w-4 text-emerald-400"}):i.jsx(BF,{className:"h-4 w-4 text-gray-500"}),i.jsx("span",{className:e?"text-gray-300":"text-gray-500",children:n})]}),jde=({submission:n})=>{const{esiCtcThreshold:e}=Zc(),t=E.useMemo(()=>{const{personal:r,uan:s,esi:a,gmc:o}=n,l=r.salary!=null&&r.salary<=e;let c=!1;return l?c=!a.hasEsi||a.hasEsi&&!!a.esiNumber:o.isOptedIn===!0?c=!0:o.isOptedIn===!1&&(c=!!o.gmcPolicyCopy&&!!o.declarationAccepted),{aadhaar:!!r.idProofFront,uan:!s.hasPreviousPf||s.hasPreviousPf&&!!s.uanNumber,pf:!s.hasPreviousPf||s.hasPreviousPf&&!!s.uanNumber,esiGmc:c}},[n,e]);return i.jsx(ja,{to:`/onboarding/add/personal?id=${n.id}`,className:"block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#0f1f0f] focus-visible:ring-emerald-400 rounded-xl",children:i.jsxs("div",{className:"bg-[#243524] p-3 rounded-xl flex gap-4 items-start border border-transparent hover:border-emerald-500 transition-colors duration-200",children:[i.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 border-2 border-gray-600",children:i.jsx(Vi,{photoUrl:n.personal.photo?.preview,seed:n.id})}),i.jsxs("div",{className:"flex-grow",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx("p",{className:"font-semibold text-green-400",children:`${n.personal.firstName} ${n.personal.lastName}`}),i.jsx("div",{className:"flex-shrink-0",children:i.jsx(PC,{status:n.status})})]}),i.jsx("p",{className:"text-sm text-gray-400",children:n.personal.mobile}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[i.jsx(Ug,{label:"Aadhaar",checked:t.aadhaar}),i.jsx(Ug,{label:"UAN",checked:t.uan}),i.jsx(Ug,{label:"PF",checked:t.pf}),i.jsx(Ug,{label:"ESI / GMC",checked:t.esiGmc})]})]})]})})},Nde=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState("in-progress"),[o,l]=E.useState(""),[c,d]=E.useState(null),m=yn(),p=E.useRef(null);E.useEffect(()=>{(async()=>{r(!0);try{const P=await pe.getVerificationSubmissions();e(P)}catch{d({message:"Failed to load submissions.",type:"error"})}finally{r(!1)}})()},[]);const x=E.useMemo(()=>{const j={"in-progress":["pending","draft","rejected"],existing:["verified"]};return n.filter(P=>j[s].includes(P.status)).filter(P=>`${P.personal.firstName} ${P.personal.lastName}`.toLowerCase().includes(o.toLowerCase())||P.personal.mobile?.toLowerCase().includes(o.toLowerCase()))},[n,s,o]),v=()=>{m("/onboarding/select-organization")},_=()=>{p.current?.focus()},w=[{key:"in-progress",label:"IN PROGRESS"},{key:"existing",label:"EXISTING"}];return i.jsxs("div",{className:"h-full flex flex-col bg-[#0f1f0f] text-white",children:[c&&i.jsx(Gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header sticky top-0 z-10 bg-[#0f1f0f]/80 backdrop-blur-sm border-b border-[#374151]",children:[i.jsx("button",{onClick:()=>m("/onboarding"),"aria-label":"Go back",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(Hi,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-lg font-semibold",children:"On Boarding"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:_,"aria-label":"Search employee",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(Na,{className:"h-6 w-6"})}),i.jsx("button",{onClick:v,"aria-label":"Add new employee",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(Pf,{className:"h-6 w-6"})}),i.jsx("button",{onClick:()=>m("/profile"),"aria-label":"Exit to profile",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:i.jsx(Ui,{className:"h-6 w-6"})})]})]}),i.jsx("div",{className:"px-4 pt-4 pb-3 flex-shrink-0",children:i.jsx("div",{className:"flex",children:w.map(j=>i.jsx("button",{onClick:()=>a(j.key),className:`flex-1 py-2 text-sm font-semibold uppercase tracking-wider transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#0f1f0f] focus-visible:ring-emerald-400 rounded-sm ${s===j.key?"border-b-2 border-emerald-400 text-emerald-400":"border-b-2 border-transparent text-gray-400 hover:text-white"}`,children:j.label},j.key))})}),i.jsxs("main",{className:"flex-1 overflow-y-auto px-4 space-y-2.5 pb-24",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-500"}),i.jsx("input",{ref:p,type:"text",placeholder:"Search by name or number...",value:o,onChange:j=>l(j.target.value),className:"form-input w-full !pl-10 !h-12 !rounded-md"})]}),t?i.jsx("div",{className:"pt-4",children:i.jsx(Sde,{count:3})}):x.length>0?i.jsx("div",{className:"space-y-2.5",children:x.map(j=>i.jsx(jde,{submission:j},j.id))}):i.jsx("div",{className:"text-center pt-16 text-gray-500",children:i.jsxs("p",{children:["No ",s.replace("-"," ")," submissions found."]})})]})]})},Cde=({status:n})=>{const e={"To Do":"bg-gray-500","In Progress":"bg-blue-500",Done:"bg-green-600"};return i.jsx("span",{className:`fo-status-badge ${e[n]}`,children:n})},Tde=()=>{const{user:n}=St(),[e,t]=E.useState("tasks"),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0);E.useEffect(()=>{if(!n)return;(async()=>{c(!0);try{const[p,x]=await Promise.all([pe.getTasks(),pe.getNotifications(n.id)]),v=p.filter(_=>_.assignedToId===n.id);s(v),o(x)}catch(p){console.error("Failed to load data for tasks page",p)}finally{c(!1)}})()},[n]);const d=m=>{const p=["HR","Admin","Ops Manager","Site Manager"];return p[m.charCodeAt(m.length-1)%p.length]};return i.jsxs("div",{children:[i.jsx("header",{className:"p-4 flex-shrink-0 text-center fo-mobile-header sticky top-0 bg-[#0f1f0f]/80 backdrop-blur-sm z-10 border-b border-[#374151]",children:i.jsx("h1",{children:"Tasks"})}),i.jsx("div",{className:"flex-shrink-0 p-4",children:i.jsxs("div",{className:"fo-tabs-container",children:[i.jsx("button",{onClick:()=>t("tasks"),className:`fo-tab-button ${e==="tasks"?"active":""}`,children:"Tasks"}),i.jsx("button",{onClick:()=>t("notifications"),className:`fo-tab-button ${e==="notifications"?"active":""}`,children:"Notifications"})]})}),i.jsx("main",{className:"p-4",children:l?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-muted"})}):e==="tasks"?r.length>0?i.jsx("div",{className:"space-y-4",children:r.map(m=>i.jsxs("div",{className:"fo-task-card",children:[i.jsxs("div",{className:"fo-task-header",children:[i.jsx("p",{className:"fo-task-title",children:m.name}),i.jsx(Cde,{status:m.status})]}),i.jsx("p",{className:"text-sm text-gray-400 mb-2",children:m.description}),i.jsxs("div",{className:"fo-task-meta flex justify-between items-center",children:[i.jsxs("span",{children:["Due: ",m.dueDate?Ue(new Date(m.dueDate),"dd MMM, yyyy"):"N/A"]}),i.jsxs("span",{children:["Assigned by: ",d(m.id)]})]})]},m.id))}):i.jsxs("div",{className:"text-center text-muted pt-16",children:[i.jsx(mC,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"You have no assigned tasks."})]}):a.length>0?i.jsx("div",{className:"divide-y divide-border",children:a.map(m=>i.jsxs("div",{className:"fo-notification-item",children:[i.jsx(Cf,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("p",{className:"text-sm text-gray-300",children:m.message}),i.jsx("p",{className:"text-xs text-muted mt-1",children:iu(new Date(m.createdAt),{addSuffix:!0})})]})]},m.id))}):i.jsxs("div",{className:"text-center text-muted pt-16",children:[i.jsx(Cf,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"You have no notifications."})]})})]})},Pde=({status:n})=>{const e={Pending:"bg-yellow-900/50 text-yellow-300 border border-yellow-500/50",Approved:"bg-blue-900/50 text-blue-300 border border-blue-500/50",Issued:"bg-green-900/50 text-green-300 border border-green-500/50",Rejected:"bg-red-900/50 text-red-300 border border-red-500/50"};return i.jsx("span",{className:`fo-status-badge ${e[n]}`,children:n})},Vg=({title:n,sizes:e,headers:t,control:r,quantityType:s})=>{const a=Array.from(new Set(e.map(l=>l.fit))),o=Array.from(new Set(e.map(l=>l.size))).sort((l,c)=>{const d=parseInt(String(l)),m=parseInt(String(c));return!isNaN(d)&&!isNaN(m)?d-m:String(l).localeCompare(String(c))});return i.jsxs("div",{className:"border border-border rounded-lg",children:[i.jsx("h4",{className:"p-3 font-semibold bg-accent text-white border-b border-accent",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:"Size"}),t.map(l=>i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:l.label},String(l.key))),i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted w-24",children:"Quantity"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:o.map(l=>i.jsx(at.Fragment,{children:a.map((c,d)=>{const m=e.find(p=>p.size===l&&p.fit===c);return m?i.jsxs("tr",{children:[d===0&&i.jsx("td",{rowSpan:a.filter(p=>e.some(x=>x.size===l&&x.fit===p)).length,className:"px-3 py-2 align-middle font-semibold border-r",children:l}),t.map(p=>i.jsx("td",{className:"px-3 py-2",children:m[p.key]},String(p.key))),i.jsx("td",{className:"px-3 py-2",children:i.jsx(je,{name:`${s}.${m.id}`,control:r,render:({field:p})=>i.jsx(Me,{"aria-label":`Quantity for ${n} size ${l} ${c}`,type:"number",...p,value:p.value||"",onChange:x=>p.onChange(parseInt(x.target.value)||null),className:"!py-1.5"})})})]},m.id):null})},l))})]})})]})},Mde=({onSave:n,onCancel:e,sites:t,masterUniforms:r,initialData:s})=>{const{register:a,control:o,handleSubmit:l,watch:c,reset:d}=Zt({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),{data:m}=Wn(),{user:p}=St(),x=c("gender"),v=c("siteId");E.useEffect(()=>{if(s){const w={},j={};s.items.forEach(P=>{P.category==="Pants"?w[P.sizeId]=P.quantity:j[P.sizeId]=P.quantity}),d({siteId:s.siteId,gender:s.gender,pantsQuantities:w,shirtsQuantities:j})}else{const w=m.organization.organizationId||"",P=m.personal.gender==="Female"?"Ladies":"Gents";d({siteId:w,gender:P,pantsQuantities:{},shirtsQuantities:{}})}},[s,d,m]);const _=w=>{const j=t.find(M=>M.id===w.siteId);if(!j||!p)return;const P=x==="Gents"?[...r.gents.pants,...r.gents.shirts]:[...r.ladies.pants,...r.ladies.shirts],k=[];for(const[M,D]of Object.entries(w.pantsQuantities))if(D&&D>0){const O=P.find(q=>q.id===M);O&&k.push({sizeId:M,quantity:D,category:"Pants",sizeLabel:O.size,fit:O.fit})}for(const[M,D]of Object.entries(w.shirtsQuantities))if(D&&D>0){const O=P.find(q=>q.id===M);O&&k.push({sizeId:M,quantity:D,category:"Shirts",sizeLabel:O.size,fit:O.fit})}const I={id:s?.id||`new_${Date.now()}`,siteId:w.siteId,siteName:j.shortName,gender:w.gender,requestedDate:s?.requestedDate||new Date().toISOString(),status:s?.status||"Pending",items:k,source:"Individual",requestedById:p.id,requestedByName:p.name,employeeDetails:[{employeeName:`${m.personal.firstName} ${m.personal.lastName}`,employeeId:m.personal.employeeId,items:k.map(M=>({itemName:M.category,sizeLabel:M.sizeLabel,fit:M.fit,quantity:M.quantity}))}]};n(I)};return i.jsx("form",{onSubmit:l(_),children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(Qe,{label:"Select Site",value:v,...a("siteId"),required:!0,disabled:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),t.map(w=>i.jsx("option",{value:w.id,children:w.shortName},w.id))]}),i.jsxs(Qe,{label:"Select Uniform Type",value:x,...a("gender"),disabled:!0,children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Vg,{title:"Gents' Pants",sizes:r.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(Vg,{title:"Gents' Shirts",sizes:r.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Vg,{title:"Ladies' Pants",sizes:r.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(Vg,{title:"Ladies' Shirts",sizes:r.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]})}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#374151]",children:[i.jsx(ae,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsxs(ae,{type:"submit",children:[i.jsx(is,{className:"mr-2 h-4 w-4"})," Save Request"]})]})]})})},kde=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(null),[c,d]=E.useState(!0),[m,p]=E.useState(null),[x,v]=E.useState(null),[_,w]=E.useState(null),j=yn(),[P]=$L(),{updateUniforms:k}=Wn(),I=P.get("from")==="onboarding",M=async()=>{d(!0);try{const[B,G,X,Q]=await Promise.all([pe.getUniformRequests(),pe.getOrganizations(),pe.getMasterGentsUniforms(),pe.getMasterLadiesUniforms()]);r(B.sort((Y,ne)=>new Date(ne.requestedDate).getTime()-new Date(Y.requestedDate).getTime())),a(G),l({gents:X,ladies:Q})}catch{p({message:"Failed to load uniform data.",type:"error"})}finally{d(!1)}};E.useEffect(()=>{M()},[]),E.useEffect(()=>{I&&(e("form"),v(null))},[I]);const D=()=>{v(null),e("form")},O=B=>{v(B),e("form")},q=async B=>{if(I&&o){const G=B.gender==="Ladies"?[...o.ladies.pants,...o.ladies.shirts]:[...o.gents.pants,...o.gents.shirts],X=B.items.map(Q=>{const Y=G.find(ie=>ie.id===Q.sizeId),ne=Q.category==="Pants"?`${B.gender}' Pants`:`${B.gender}' Shirts`;return{itemId:`generic_${B.gender.toLowerCase()}_${Q.category==="Pants"?"pants":"shirts"}`,itemName:ne,sizeId:Q.sizeId,sizeLabel:Y?.size||"",fit:Y?.fit||"",quantity:Q.quantity}});k(X),await pe.submitUniformRequest(B),j(-1);return}try{B.id.startsWith("new_")?(await pe.submitUniformRequest(B),p({message:"New request submitted.",type:"success"})):(await pe.updateUniformRequest(B),p({message:"Request updated.",type:"success"})),e("list"),M()}catch{p({message:"Failed to save request.",type:"error"})}},F=async()=>{if(_)try{await pe.deleteUniformRequest(_.id),p({message:"Request deleted.",type:"success"}),w(null),M()}catch{p({message:"Failed to delete request.",type:"error"})}},U=B=>B.reduce((G,X)=>G+X.quantity,0);if(c||!o)return i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-muted"})});if(n==="form"){const B=()=>{I?j(-1):e("list")};return i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header",children:[i.jsx("button",{onClick:B,"aria-label":"Go back",children:i.jsx(Hi,{className:"h-6 w-6"})}),i.jsxs("h1",{children:[x?"Edit":"New"," Request"]})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsx(Mde,{onSave:q,onCancel:B,sites:s,masterUniforms:o,initialData:x})})]})}return i.jsxs("div",{className:"h-full flex flex-col",children:[m&&i.jsx(Gt,{message:m.message,type:m.type,onDismiss:()=>p(null)}),i.jsx(tr,{isOpen:!!_,onClose:()=>w(null),onConfirm:F,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header",children:[i.jsx("h1",{className:"text-lg font-semibold",children:"Uniform Requests"}),i.jsx("button",{onClick:D,"aria-label":"New Uniform Request",children:i.jsx(Pf,{className:"h-6 w-6"})})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:t.length>0?t.map(B=>i.jsxs("div",{className:"bg-[#243524] p-3 rounded-xl border border-[#374151]",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-white",children:B.siteName}),i.jsx("p",{className:"text-xs text-gray-400",children:Ue(new Date(B.requestedDate),"dd MMM, yyyy")})]}),i.jsx(Pde,{status:B.status})]}),i.jsxs("div",{className:"mt-3 flex justify-between items-end",children:[i.jsxs("div",{className:"text-sm text-gray-300",children:[i.jsxs("p",{children:[B.gender," Uniforms"]}),i.jsxs("p",{className:"font-semibold",children:[U(B.items)," Items"]})]}),B.status==="Pending"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>O(B),children:i.jsx(xr,{className:"h-4 w-4 text-gray-400"})}),i.jsx(ae,{variant:"icon",size:"sm",onClick:()=>w(B),children:i.jsx(Xt,{className:"h-4 w-4 text-red-500"})})]})]})]},B.id)):i.jsxs("div",{className:"text-center text-muted pt-16",children:[i.jsx(Hx,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"No uniform requests found."}),i.jsxs(ae,{onClick:D,className:"mt-4",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Create First Request"]})]})})]})},Ede=wt({title:be().required("Title is required"),description:be().required("Description is required"),category:be().oneOf(["Software Developer","Admin","Operational","HR Query","Other"]).required("Category is required"),priority:be().oneOf(["Low","Medium","High","Urgent"]).required("Priority is required"),assignedToId:be().optional().nullable(),attachment:Ft().optional().nullable()}).defined(),Dde=({isOpen:n,onClose:e,onSuccess:t})=>{const{user:r}=St(),[s,a]=E.useState(!1),[o,l]=E.useState([]),c=Jt("(max-width: 767px)"),{register:d,handleSubmit:m,control:p,formState:{errors:x},reset:v}=Zt({resolver:_n(Ede),defaultValues:{category:"Software Developer",priority:"Medium",assignedToId:null,attachment:null}}),_=nu({control:p,name:"category"});E.useEffect(()=>{n&&pe.getUsers().then(l)},[n]);const w=E.useMemo(()=>{if(!o)return[];switch(_){case"Software Developer":return o.filter(I=>I.role==="developer");case"Admin":return o.filter(I=>I.role==="admin");case"HR Query":return o.filter(I=>I.role==="hr");case"Operational":return o.filter(I=>["operation_manager","site_manager"].includes(I.role));default:const k=["admin","hr","developer","operation_manager","site_manager"];return o.filter(I=>k.includes(I.role))}},[o,_]),j=async k=>{if(r){a(!0);try{const I=o.find(D=>D.id===k.assignedToId),M=await pe.createSupportTicket({...k,attachment:k.attachment,status:"Open",raisedById:r.id,raisedByName:r.name,assignedToId:k.assignedToId||null,assignedToName:I?.name||null,resolvedAt:null,closedAt:null,rating:null,feedback:null});t(M),v()}catch(I){console.error(I)}finally{a(!1)}}};if(!n)return null;const P="new-ticket-form";return c?i.jsxs("div",{className:"fixed inset-0 z-[999] flex flex-col bg-[#0f1f0f] animate-fade-in-scale",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 border-b border-[#1f3d2b] bg-[#0d2818]",children:[i.jsx(ae,{variant:"icon",onClick:e,"aria-label":"Close form",children:i.jsx(Hi,{className:"h-6 w-6 text-white"})}),i.jsx("h3",{className:"text-lg font-semibold text-white",children:"Create New Post"})]}),i.jsxs("form",{id:P,onSubmit:m(j),className:"flex-1 overflow-y-auto p-4 space-y-4 bg-[#0f1f0f]",children:[i.jsx(Me,{placeholder:"Title / Subject",...d("title"),error:x.title?.message,className:"form-input"}),i.jsx("textarea",{placeholder:"Description",...d("description"),rows:5,className:`form-input ${x.description?"form-input--error":""}`}),i.jsx(je,{name:"category",control:p,render:({field:k})=>i.jsxs(Qe,{...k,error:x.category?.message,className:"form-input",children:[i.jsx("option",{children:"Software Developer"}),i.jsx("option",{children:"Admin"}),i.jsx("option",{children:"Operational"}),i.jsx("option",{children:"HR Query"}),i.jsx("option",{children:"Other"})]})}),i.jsx(je,{name:"priority",control:p,render:({field:k})=>i.jsxs(Qe,{...k,error:x.priority?.message,className:"form-input",children:[i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})}),i.jsx(je,{name:"assignedToId",control:p,render:({field:k})=>i.jsxs(Qe,{...k,value:k.value??"",error:x.assignedToId?.message,className:"form-input",children:[i.jsx("option",{value:"",children:"Unassigned"}),w.map(I=>i.jsxs("option",{value:I.id,children:[I.name," (",I.role.replace(/_/g," "),")"]},I.id))]})}),i.jsx(je,{name:"attachment",control:p,render:({field:k,fieldState:I})=>i.jsx(xt,{label:"Attach Screenshot or Document (Image only)",file:k.value,onFileChange:k.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:I.error?.message})})]}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center justify-end gap-3 border-t border-[#1f3d2b] bg-[#0d2818]",children:[i.jsx(ae,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ae,{type:"submit",form:P,isLoading:s,children:"Create Post"})]})]}):i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-lg m-4 animate-fade-in-scale flex flex-col max-h-[85vh]",onClick:k=>k.stopPropagation(),children:[i.jsx("div",{className:"p-6 border-b flex-shrink-0",children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Create New Post"})}),i.jsx("form",{id:P,onSubmit:m(j),className:"flex-grow overflow-y-auto",children:i.jsxs("div",{className:"p-6 space-y-4",children:[i.jsx(Me,{label:"Title / Subject",...d("title"),error:x.title?.message}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Description"}),i.jsx("textarea",{...d("description"),rows:5,className:`mt-1 form-input ${x.description?"form-input--error":""}`}),x.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.description.message})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(je,{name:"category",control:p,render:({field:k})=>i.jsxs(Qe,{label:"Category",...k,error:x.category?.message,children:[i.jsx("option",{children:"Software Developer"}),i.jsx("option",{children:"Admin"}),i.jsx("option",{children:"Operational"}),i.jsx("option",{children:"HR Query"}),i.jsx("option",{children:"Other"})]})}),i.jsx(je,{name:"priority",control:p,render:({field:k})=>i.jsxs(Qe,{label:"Priority",...k,error:x.priority?.message,children:[i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})})]}),i.jsx(je,{name:"assignedToId",control:p,render:({field:k})=>i.jsxs(Qe,{label:"Assigned To (Optional)",...k,value:k.value??"",error:x.assignedToId?.message,children:[i.jsx("option",{value:"",children:"Unassigned"}),w.map(I=>i.jsxs("option",{value:I.id,children:[I.name," (",I.role.replace(/_/g," "),")"]},I.id))]})}),i.jsx(je,{name:"attachment",control:p,render:({field:k,fieldState:I})=>i.jsx(xt,{label:"Attach Screenshot or Document (Image only)",file:k.value,onFileChange:k.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:I.error?.message})})]})}),i.jsxs("div",{className:"p-6 mt-auto border-t flex-shrink-0 flex justify-end space-x-3",children:[i.jsx(ae,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ae,{type:"submit",form:P,isLoading:s,children:"Create Post"})]})]})})},Ode=({priority:n})=>{const e={Low:"bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.5)]",Medium:"bg-yellow-500 shadow-[0_0_8px_rgba(234,179,8,0.5)]",High:"bg-orange-500 shadow-[0_0_8px_rgba(249,115,22,0.5)]",Urgent:"bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]"};return i.jsx("span",{className:`w-3 h-3 rounded-full ${e[n]}`,title:`Priority: ${n}`})},Ide=({status:n})=>{const e={Open:"bg-emerald-500/10 text-emerald-500 border-emerald-500/20","In Progress":"bg-blue-500/10 text-blue-500 border-blue-500/20","Pending Requester":"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",Resolved:"bg-purple-500/10 text-purple-500 border-purple-500/20",Closed:"bg-gray-500/10 text-gray-500 border-gray-500/20"};return i.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${e[n]}`,children:n})},Ade=({ticket:n,onClick:e})=>i.jsxs("div",{onClick:e,className:"group bg-card hover:bg-accent/5 p-5 rounded-xl border border-border hover:border-accent cursor-pointer transition-all duration-300 flex flex-col justify-between h-full shadow-sm hover:shadow-md",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-start gap-3 mb-2",children:[i.jsx("h4",{className:"font-bold text-primary-text leading-snug group-hover:text-accent transition-colors line-clamp-2",children:n.title}),i.jsx("div",{className:"flex-shrink-0 mt-1",children:i.jsx(Ode,{priority:n.priority})})]}),i.jsxs("p",{className:"text-xs text-muted font-mono",children:["#",n.ticketNumber]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[i.jsxs("div",{className:"flex justify-between items-center text-xs text-muted mb-3",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-700 flex items-center justify-center text-[10px] text-white font-bold",children:n.raisedByName.charAt(0)}),i.jsx("span",{children:n.raisedByName})]}),i.jsx("span",{children:iu(new Date(n.raisedAt),{addSuffix:!0})})]}),i.jsx("div",{className:"flex justify-between items-center",children:i.jsx(Ide,{status:n.status})})]})]}),NL=({user:n,onAction:e})=>i.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-card border border-border hover:border-accent/50 transition-colors",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Vi,{photoUrl:n.photoUrl,seed:n.id,className:"w-12 h-12 rounded-full shadow-sm"}),i.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ${n.isAvailable?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":"bg-rose-600 shadow-[0_0_6px_rgba(225,29,72,0.6)]"} ring-2 ring-white`})]}),i.jsxs("div",{className:"flex-grow min-w-0",children:[i.jsx("p",{className:"text-sm font-bold text-primary-text truncate",children:n.name}),i.jsx("p",{className:"text-xs text-muted truncate",children:n.role.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ae,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Call",onClick:()=>e(n.phone),children:i.jsx(cu,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Message",onClick:()=>e(n.phone),children:i.jsx(om,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Video",onClick:()=>e(n.phone),children:i.jsx(HF,{className:"h-4 w-4"})})]})]}),Rde=()=>{const{user:n}=St(),e=yn(),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(!0),[c,d]=E.useState(null),[m,p]=E.useState(!1),[x,v]=E.useState(!1),_=Jt("(max-width: 1023px)"),[w,j]=E.useState({status:"all",priority:"all",searchTerm:""});E.useEffect(()=>{(async()=>{if(n){l(!0);try{const[q,F]=await Promise.all([pe.getSupportTickets(),pe.getNearbyUsers()]);r(q),a(F.filter(U=>U.id!==n.id))}catch{d({message:"Failed to load support data.",type:"error"})}finally{l(!1)}}})()},[n]);const P=E.useMemo(()=>t.filter(O=>{const q=w.status==="all"||O.status===w.status,F=w.priority==="all"||O.priority===w.priority,U=w.searchTerm===""||O.title.toLowerCase().includes(w.searchTerm.toLowerCase())||O.ticketNumber.toLowerCase().includes(w.searchTerm.toLowerCase())||O.description.toLowerCase().includes(w.searchTerm.toLowerCase());return q&&F&&U}),[t,w]),k=E.useMemo(()=>{const O=t.filter(q=>q.status==="Resolved"&&q.raisedById===n?.id);return{open:t.filter(q=>q.status==="Open").length,inProgress:t.filter(q=>q.status==="In Progress").length,pendingYourAction:O.length}},[t,n]),I=O=>{r(q=>[O,...q]),p(!1),d({message:"New ticket created successfully!",type:"success"}),e(`/support/ticket/${O.id}`)},M=O=>{if(!O){d({message:"User does not have a phone number.",type:"error"});return}let q=O.replace(/\D/g,"");if(q.length>10&&(q=q.slice(-10)),q.length!==10){d({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${q}`,"_blank")},D=({title:O,value:q,icon:F,colorClass:U})=>i.jsxs("div",{className:"bg-transparent p-5 rounded-2xl flex items-center justify-between transition-all",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted mb-1",children:O}),i.jsx("p",{className:`text-3xl font-bold ${U.replace("bg-","text-").split(" ")[0]}`,children:q})]}),i.jsx("div",{className:`p-3 rounded-full bg-opacity-10 ${U.replace("text-","bg-")} ${U}`,children:F})]});return i.jsxs("div",{className:"w-full p-4 lg:p-8 space-y-8",children:[c&&i.jsx(Gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),m&&i.jsx(Dde,{isOpen:m,onClose:()=>p(!1),onSuccess:I}),i.jsx(tr,{isOpen:x,onClose:()=>v(!1),title:"Nearby Available Support",onConfirm:()=>v(!1),confirmButtonText:"Close",children:i.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:s.length>0?s.map(O=>i.jsx(NL,{user:O,onAction:M},O.id)):i.jsxs("div",{className:"text-center py-8 text-muted",children:[i.jsx(mi,{className:"h-10 w-10 mx-auto mb-2 opacity-20"}),i.jsx("p",{children:"No support staff found nearby."})]})})}),i.jsx("div",{className:"relative overflow-hidden rounded-3xl bg-transparent p-6 lg:p-10 transition-all",children:i.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg backdrop-blur-sm",children:i.jsx(gx,{className:"h-6 w-6 text-emerald-600"})}),i.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-primary-text",children:"Support & Audit"})]}),i.jsx("p",{className:"text-muted max-w-xl text-sm",children:"Track issues, request audits, and connect with support staff in real-time."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 w-full lg:w-auto",children:[_&&i.jsxs(ae,{onClick:()=>v(!0),variant:"secondary",className:"flex-1 lg:flex-none bg-gray-100 text-gray-900 hover:bg-gray-200 border-none shadow-none p-0 text-sm transition-colors",children:[i.jsx(du,{className:"mr-1.5 h-3.5 w-3.5"})," Nearby"]}),i.jsxs(ae,{onClick:()=>p(!0),className:"flex-1 lg:flex-none",children:[i.jsx(qt,{className:"mr-1.5 h-3.5 w-3.5"})," New Ticket"]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 lg:gap-6",children:[i.jsx(D,{title:"Open Tickets",value:k.open,icon:i.jsx(gx,{className:"h-6 w-6"}),colorClass:"text-rose-500"}),i.jsx(D,{title:"In Progress",value:k.inProgress,icon:i.jsx(Tt,{className:"h-6 w-6"}),colorClass:"text-blue-500"}),i.jsx(D,{title:"Pending Your Action",value:k.pendingYourAction,icon:i.jsx(du,{className:"h-6 w-6"}),colorClass:"text-amber-500"})]}),i.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-8",children:[i.jsx("div",{className:"lg:col-span-2 space-y-6",children:i.jsxs("div",{className:"bg-transparent p-5 rounded-2xl",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[i.jsxs("div",{className:"relative flex-grow",children:[i.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(Me,{id:"search",placeholder:"Search tickets...",className:"pl-10 bg-gray-50 border-gray-200",value:w.searchTerm,onChange:O=>j(q=>({...q,searchTerm:O.target.value}))})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:"w-32 sm:w-40",children:i.jsxs(Qe,{value:w.status,onChange:O=>j(q=>({...q,status:O.target.value})),className:"bg-gray-50 border-gray-200",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{children:"Open"}),i.jsx("option",{children:"In Progress"}),i.jsx("option",{value:"Pending Requester",children:"Pending"}),i.jsx("option",{children:"Resolved"}),i.jsx("option",{children:"Closed"})]})}),i.jsx("div",{className:"w-32 sm:w-40",children:i.jsxs(Qe,{value:w.priority,onChange:O=>j(q=>({...q,priority:O.target.value})),className:"bg-gray-50 border-gray-200",children:[i.jsx("option",{value:"all",children:"All Priority"}),i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})})]})]}),o?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:P.length>0?P.map(O=>i.jsx(Ade,{ticket:O,onClick:()=>e(`/support/ticket/${O.id}`)},O.id)):i.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-muted",children:[i.jsx("div",{className:"p-4 bg-accent/5 rounded-full mb-3",children:i.jsx(Na,{className:"h-8 w-8 opacity-50"})}),i.jsx("p",{children:"No tickets match your filters."})]})})]})}),i.jsx("aside",{className:"hidden lg:block space-y-6",children:i.jsxs("div",{className:"bg-card p-6 rounded-2xl border border-border shadow-sm sticky top-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h3",{className:"font-bold text-lg text-primary-text flex items-center gap-2",children:[i.jsx(mi,{className:"h-5 w-5 text-accent"})," Nearby Support"]}),i.jsxs("span",{className:"text-xs font-medium bg-accent/10 text-accent px-2 py-1 rounded-full",children:[s.filter(O=>O.isAvailable).length," Online"]})]}),i.jsx("div",{className:"space-y-3 max-h-[calc(100vh-200px)] overflow-y-auto pr-1 custom-scrollbar",children:s.length>0?s.map(O=>i.jsx(NL,{user:O,onAction:M},O.id)):i.jsx("div",{className:"text-center py-8 text-muted",children:i.jsx("p",{children:"No support staff found nearby."})})})]})})]})]})},Lde=({post:n,ticket:e,setTicket:t})=>{const{user:r}=St(),[s,a]=E.useState(!1),[o,l]=E.useState(""),[c,d]=E.useState(!1),m=r?n.likes.includes(r.id):!1,p=async()=>{if(!r)return;const v=[...n.likes],_=m?n.likes.filter(w=>w!==r.id):[...n.likes,r.id];t(w=>w?{...w,posts:w.posts.map(j=>j.id===n.id?{...j,likes:_}:j)}:null);try{await pe.togglePostLike(n.id,r.id)}catch{t(j=>j?{...j,posts:j.posts.map(P=>P.id===n.id?{...P,likes:v}:P)}:null)}},x=async()=>{if(!(!o.trim()||!r)){d(!0);try{const v=await pe.addPostComment(n.id,{postId:n.id,authorId:r.id,authorName:r.name,content:o});t(_=>_?{..._,posts:_.posts.map(w=>w.id===n.id?{...w,comments:[...w.comments,v]}:w)}:null),l("")}catch{}finally{d(!1)}}};return i.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Vi,{seed:n.authorId,className:"w-10 h-10 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"w-full",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:n.authorName}),i.jsx("span",{className:"text-xs text-muted",children:n.authorRole.replace(/_/g," ")}),i.jsxs("span",{className:"text-xs text-muted",children:[" ",iu(new Date(n.createdAt),{addSuffix:!0})]})]}),i.jsx("p",{className:"text-sm text-muted mt-1 whitespace-pre-wrap",children:n.content}),i.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted",children:[i.jsxs("button",{onClick:p,className:`flex items-center gap-1.5 hover:text-accent transition-colors ${m?"text-accent font-semibold":""}`,children:[i.jsx(uJ,{className:`h-4 w-4 ${m?"fill-current":""}`}),i.jsxs("span",{children:[n.likes.length," Like",n.likes.length!==1&&"s"]})]}),i.jsxs("button",{onClick:()=>a(!s),className:"flex items-center gap-1.5 hover:text-accent transition-colors",children:[i.jsx(om,{className:"h-4 w-4"}),i.jsxs("span",{children:[n.comments.length," Comment",n.comments.length!==1&&"s"]})]})]}),s&&i.jsxs("div",{className:"mt-4 space-y-3 pt-3 border-t border-border animate-fade-in-down",children:[n.comments.map(v=>i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Vi,{seed:v.authorId,className:"w-8 h-8 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"bg-page p-2 rounded-lg flex-grow",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"font-semibold text-sm text-primary-text",children:v.authorName}),i.jsx("span",{className:"text-xs text-muted",children:iu(new Date(v.createdAt),{addSuffix:!0})})]}),i.jsx("p",{className:"text-sm text-muted",children:v.content})]})]},v.id)),i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Vi,{className:"w-8 h-8 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("textarea",{value:o,onChange:v=>l(v.target.value),placeholder:"Write a comment...",rows:2,className:"form-input text-sm"}),i.jsx("div",{className:"text-right mt-1",children:i.jsx(ae,{size:"sm",onClick:x,isLoading:c,children:"Post"})})]})]})]})]})]})})},Fde=wt({rating:rs().min(1,"Please select a rating.").required(),feedback:be().required("Feedback is required to close the ticket.").min(10,"Please provide more detailed feedback.")}).defined(),qde=({value:n,onChange:e})=>{const[t,r]=E.useState(0);return i.jsx("div",{className:"flex items-center justify-center gap-1",onMouseLeave:()=>r(0),children:[1,2,3,4,5].map(s=>i.jsx("button",{type:"button",onMouseEnter:()=>r(s),onClick:()=>e(s),className:"focus:outline-none",children:i.jsx(WF,{className:`h-8 w-8 cursor-pointer transition-colors ${(t||n)>=s?"text-yellow-400 fill-current":"text-gray-400"}`})},s))})},zde=({isOpen:n,onClose:e,onSubmit:t})=>{const[r,s]=E.useState(!1),{register:a,handleSubmit:o,control:l,formState:{errors:c}}=Zt({resolver:_n(Fde),defaultValues:{rating:0,feedback:""}}),d=m=>{s(!0),t(m.rating,m.feedback),s(!1)};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:m=>m.stopPropagation(),children:i.jsxs("form",{onSubmit:o(d),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-2 text-center",children:"Ticket Resolved"}),i.jsx("p",{className:"text-sm text-muted text-center mb-4",children:"Please rate the support you received before closing this ticket."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx(je,{name:"rating",control:l,render:({field:m})=>i.jsx(qde,{value:m.value,onChange:m.onChange})}),c.rating&&i.jsx("p",{className:"mt-2 text-xs text-red-500 text-center",children:c.rating.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted text-center",children:"Your Feedback"}),i.jsx("textarea",{...a("feedback"),rows:4,className:`mt-1 form-input ${c.feedback?"form-input--error":""}`}),c.feedback&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.feedback.message})]})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ae,{type:"button",onClick:e,variant:"secondary",children:"Not Now"}),i.jsx(ae,{type:"submit",isLoading:r,children:"Confirm & Close"})]})]})})}):null},Ude=({priority:n})=>{const e={Low:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",Medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",High:"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300",Urgent:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"};return i.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${e[n]}`,children:n})},Vde=({status:n})=>{const e={Open:"status-chip--pending","In Progress":"sync-chip--pending_sync","Pending Requester":"leave-status-chip--pending_hr_confirmation",Resolved:"leave-status-chip--approved",Closed:"status-chip--draft"};return i.jsx("span",{className:`status-chip ${e[n]}`,children:n})},Bde=()=>{const{id:n}=qL(),e=yn(),{user:t}=St(),[r,s]=E.useState(null),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,m]=E.useState(null),[p,x]=E.useState(""),[v,_]=E.useState(!1),[w,j]=E.useState(!1);Jt("(max-width: 1023px)"),E.useEffect(()=>{if(!n)return;(async()=>{c(!0);try{const[F,U]=await Promise.all([pe.getSupportTicketById(n),pe.getNearbyUsers()]);F?s(F):(m({message:"Ticket not found.",type:"error"}),e("/support")),o(U)}catch{m({message:"Failed to load ticket data.",type:"error"})}finally{c(!1)}})()},[n,e]);const P=async()=>{if(!(!p.trim()||!r||!t)){_(!0);try{const q=await pe.addTicketPost(r.id,{ticketId:r.id,authorId:t.id,authorName:t.name,authorRole:t.role,content:p});s(F=>F?{...F,posts:[...F.posts,q]}:null),x("")}catch{m({message:"Failed to add post.",type:"error"})}finally{_(!1)}}},k=async q=>{if(r)try{const F=await pe.updateSupportTicket(r.id,q);s(F),q.status&&m({message:`Ticket status updated to ${q.status}`,type:"success"})}catch{m({message:"Failed to update ticket.",type:"error"})}},I=async(q,F)=>{await k({status:"Closed",rating:q,feedback:F,closedAt:new Date().toISOString()}),j(!1)},M=q=>{if(!q){m({message:"User does not have a phone number.",type:"error"});return}let F=q.replace(/\D/g,"");if(F.length>10&&(F=F.slice(-10)),F.length!==10){m({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${F}`,"_blank")};if(l)return i.jsx("div",{className:"flex justify-center items-center h-screen",children:i.jsx(Tt,{className:"h-12 w-12 animate-spin text-accent"})});if(!r)return null;const D=t?.id===r.raisedById,O=()=>r.status==="Closed"?null:i.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.status==="Open"&&i.jsx(ae,{onClick:()=>k({status:"In Progress",assignedToId:t?.id,assignedToName:t?.name}),children:"Assign to Me"}),r.status==="In Progress"&&t?.id===r.assignedToId&&i.jsx(ae,{onClick:()=>k({status:"Resolved",resolvedAt:new Date().toISOString()}),children:"Mark as Resolved"}),r.status==="Resolved"&&D&&i.jsx(ae,{onClick:()=>j(!0),children:"Close Ticket"})]});return i.jsxs("div",{className:"p-4",children:[d&&i.jsx(Gt,{message:d.message,type:d.type,onDismiss:()=>m(null)}),w&&i.jsx(zde,{isOpen:w,onClose:()=>j(!1),onSubmit:I}),i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx(ae,{variant:"icon",onClick:()=>e("/support"),children:i.jsx(Hi,{})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl md:text-2xl font-bold text-primary-text",children:r.title}),i.jsxs("p",{className:"text-xs text-muted",children:["#",r.ticketNumber]})]})]}),i.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-6",children:[i.jsxs("main",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card space-y-4",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-start",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(Vde,{status:r.status}),i.jsx(Ude,{priority:r.priority})]}),i.jsxs("div",{className:"text-sm text-muted text-right",children:[i.jsxs("p",{children:["Raised by: ",i.jsx("span",{className:"font-semibold text-primary-text",children:r.raisedByName})]}),i.jsx("p",{children:Ue(new Date(r.raisedAt),"dd MMM, yyyy - hh:mm a")})]})]}),i.jsx("p",{className:"text-sm text-muted whitespace-pre-wrap",children:r.description}),r.attachmentUrl&&i.jsxs("div",{className:"mt-4",children:[i.jsx("h5",{className:"text-sm font-semibold text-primary-text mb-2",children:"Attachment"}),i.jsx("a",{href:r.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"block border rounded-lg overflow-hidden max-w-xs hover:border-accent",children:i.jsx("img",{src:r.attachmentUrl,alt:"Attachment",className:"max-h-64 w-auto"})})]})]}),i.jsx("div",{className:"space-y-4",children:r.posts.map(q=>i.jsx(Lde,{post:q,ticket:r,setTicket:s},q.id))}),r.status!=="Closed"&&i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card flex items-start gap-3",children:[i.jsx(Vi,{className:"w-10 h-10 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"w-full",children:[i.jsx("textarea",{value:p,onChange:q=>x(q.target.value),placeholder:"Add a public reply...",className:"form-input w-full",rows:3}),i.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[i.jsx(ae,{variant:"icon",size:"sm",title:"Attach file",children:i.jsx(iJ,{className:"h-5 w-5"})}),i.jsxs(ae,{onClick:P,isLoading:v,children:[i.jsx(gC,{className:"mr-2 h-4"})," Post"]})]})]})]})]}),i.jsxs("aside",{className:"space-y-6 mt-6 lg:mt-0",children:[i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[i.jsx("h3",{className:"font-semibold text-primary-text mb-3",children:"Ticket Details"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Assigned To:"})," ",i.jsx("span",{className:"font-semibold",children:r.assignedToName||"Unassigned"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Category:"})," ",i.jsx("span",{children:r.category})]}),r.resolvedAt&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Resolved:"})," ",i.jsx("span",{children:Ue(new Date(r.resolvedAt),"dd MMM, yy")})]}),r.closedAt&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Closed:"})," ",i.jsx("span",{children:Ue(new Date(r.closedAt),"dd MMM, yy")})]}),r.rating&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Rating:"})," ",i.jsxs("span",{className:"flex items-center gap-1",children:[r.rating," ",i.jsx(WF,{className:"h-4 w-4 text-yellow-400 fill-current"})]})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:O()})]}),i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[i.jsxs("h3",{className:"font-semibold text-primary-text mb-3 flex items-center gap-2",children:[i.jsx(mi,{className:"h-5 w-5 text-muted"})," Nearby Users"]}),i.jsx("div",{className:"space-y-3",children:a.map(q=>i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Vi,{photoUrl:q.photoUrl,seed:q.id,className:"w-10 h-10 rounded-full"}),i.jsx("span",{className:"absolute bottom-0 right-0 block h-2.5 w-2.5 rounded-full bg-green-400 ring-2 ring-card"})]}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("p",{className:"text-sm font-semibold",children:q.name}),i.jsx("p",{className:"text-xs text-muted",children:q.role.replace(/_/g," ").replace(/\b\w/g,F=>F.toUpperCase())})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ae,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(q.phone),children:i.jsx(cu,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(q.phone),children:i.jsx(om,{className:"h-4 w-4"})}),i.jsx(ae,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(q.phone),children:i.jsx(HF,{className:"h-4 w-4"})})]})]},q.id))})]})]})]})]})},gr=({label:n,isVerified:e,hasValue:t,error:r,registration:s,onManualInput:a,...o})=>{const{theme:l}=gu(),c=l==="dark",m=s?{...s,onChange:async p=>{a&&a(),s?.onChange&&await s.onChange(p)}}:void 0;return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center mb-1",children:[i.jsx("label",{htmlFor:o.id,className:"block text-sm font-medium text-muted",children:n}),t&&(e?i.jsx("span",{className:`ml-2 flex items-center ${c?"text-green-400":"text-green-600"}`,title:"Verified from document",children:i.jsx(Bi,{className:"h-4 w-4"})}):i.jsx("span",{className:`ml-2 flex items-center ${c?"text-yellow-400":"text-yellow-500"}`,title:"Manually entered. Please verify.",children:i.jsx(Ca,{className:"h-4 w-4"})}))]}),i.jsx(Me,{id:o.id,error:r,registration:m,label:"",...o})]})},Wde=wt({employeeId:be().required(),firstName:be().required("First name is required"),middleName:be().optional(),lastName:be().required("Last name is required"),preferredName:be().optional(),dob:be().required("Date of birth is required"),gender:be().oneOf(["Male","Female","Other",""]).required("Gender is required"),maritalStatus:be().oneOf(["Single","Married","Divorced","Widowed",""]).required("Marital status is required"),bloodGroup:be().oneOf(["","A+","A-","B+","B-","AB+","AB-","O+","O-"]).required("Blood group is required"),mobile:be().required("Mobile number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number"),alternateMobile:be().optional().nullable(),email:be().email("Must be a valid email").required("Email is required"),idProofType:be().oneOf(["Aadhaar","PAN","Voter ID",""]).optional(),idProofNumber:be().optional(),photo:Ft().optional().nullable(),idProofFront:Ft().optional().nullable(),idProofBack:Ft().optional().nullable(),emergencyContactName:be().required("Emergency contact name is required"),emergencyContactNumber:be().required("Emergency contact number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),relationship:be().oneOf(["Spouse","Child","Father","Mother","Sibling","Other",""]).required("Relationship is required"),salary:rs().typeError("Salary must be a number").min(0).required("Salary is required").nullable(),verifiedStatus:wt().optional()}).defined(),$de=()=>{const{onValidated:n}=pi(),{data:e,updatePersonal:t,addOrUpdateEmergencyContactAsFamilyMember:r,setPersonalVerifiedStatus:s}=Wn(),{register:a,handleSubmit:o,formState:{errors:l},control:c,reset:d,watch:m}=Zt({resolver:_n(Wde),defaultValues:e.personal}),p=m();E.useEffect(()=>{d(e.personal)},[e.personal,d]),E.useEffect(()=>{let v;const _=m(w=>{clearTimeout(v),v=window.setTimeout(()=>{t(w)},500)});return()=>{_.unsubscribe(),clearTimeout(v)}},[m,t]);const x=async v=>{t(v),r(),await n()};return i.jsxs("form",{onSubmit:o(x),id:"personal-form",children:[i.jsx("div",{className:"text-left",children:i.jsx(Tr,{title:"Personal Details",subtitle:"Please provide your personal information as per your official documents."})}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-8 md:items-start",children:[i.jsx("div",{className:"flex-shrink-0 mx-auto md:mx-0",children:i.jsx(je,{name:"photo",control:c,render:({field:v})=>i.jsx(kN,{file:v.value,onFileChange:_=>v.onChange(_)})})}),i.jsxs("div",{className:"w-full flex-grow grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(Me,{label:"Employee ID",id:"employeeId",registration:a("employeeId"),error:l.employeeId?.message,readOnly:!0,className:"bg-gray-100"})}),i.jsx(gr,{label:"First Name",id:"firstName",registration:a("firstName"),error:l.firstName?.message,isVerified:e.personal.verifiedStatus?.name===!0,hasValue:!!p.firstName,onManualInput:()=>s({name:!1})}),i.jsx(Me,{label:"Middle Name (Optional)",id:"middleName",registration:a("middleName")}),i.jsx(gr,{label:"Last Name",id:"lastName",registration:a("lastName"),error:l.lastName?.message,isVerified:e.personal.verifiedStatus?.name===!0,hasValue:!!p.lastName,onManualInput:()=>s({name:!1})}),i.jsx(Me,{label:"Preferred Name (Optional)",id:"preferredName",registration:a("preferredName")}),i.jsx(je,{name:"dob",control:c,render:({field:v})=>i.jsx(Nn,{label:"Date of Birth",id:"dob",error:l.dob?.message,value:v.value,onChange:_=>{v.onChange(_),s({dob:!1})},maxDate:new Date})}),i.jsxs(Qe,{label:"Gender",id:"gender",registration:a("gender"),error:l.gender?.message,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{children:"Male"}),i.jsx("option",{children:"Female"}),i.jsx("option",{children:"Other"})]}),i.jsxs(Qe,{label:"Marital Status",id:"maritalStatus",registration:a("maritalStatus"),error:l.maritalStatus?.message,children:[i.jsx("option",{value:"",children:"Select Status"}),i.jsx("option",{children:"Single"}),i.jsx("option",{children:"Married"}),i.jsx("option",{children:"Divorced"}),i.jsx("option",{children:"Widowed"})]}),i.jsxs(Qe,{label:"Blood Group",id:"bloodGroup",registration:a("bloodGroup"),error:l.bloodGroup?.message,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"A+"}),i.jsx("option",{children:"A-"}),i.jsx("option",{children:"B+"}),i.jsx("option",{children:"B-"}),i.jsx("option",{children:"AB+"}),i.jsx("option",{children:"AB-"}),i.jsx("option",{children:"O+"}),i.jsx("option",{children:"O-"})]}),i.jsx(Me,{label:"Mobile Number",id:"mobile",type:"tel",registration:a("mobile"),error:l.mobile?.message}),i.jsx(Me,{label:"Alternate Mobile (Optional)",id:"alternateMobile",type:"tel",registration:a("alternateMobile")}),i.jsx(Me,{label:"Email Address",id:"email",type:"email",registration:a("email"),error:l.email?.message}),i.jsx(Me,{label:"Monthly Salary (Gross)",id:"salary",type:"number",registration:a("salary"),error:l.salary?.message}),i.jsxs("div",{className:"md:col-span-3 pt-4 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Emergency Contact"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[i.jsx(Me,{label:"Contact Name",id:"emergencyContactName",registration:a("emergencyContactName"),error:l.emergencyContactName?.message}),i.jsx(Me,{label:"Contact Number",id:"emergencyContactNumber",type:"tel",registration:a("emergencyContactNumber"),error:l.emergencyContactNumber?.message}),i.jsxs(Qe,{label:"Relationship",id:"relationship",registration:a("relationship"),error:l.relationship?.message,children:[i.jsx("option",{value:"",children:"Select Relationship"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"}),i.jsx("option",{children:"Sibling"}),i.jsx("option",{children:"Other"})]})]})]})]})]})]})},CL=wt({line1:be().required("Address line 1 is required"),line2:be().optional(),city:be().required("City is required"),state:be().required("State is required"),country:be().required("Country is required"),pincode:be().required("Pincode is required").matches(/^[1-9][0-9]{5}$/,"Must be a valid 6-digit Indian pincode"),verifiedStatus:wt().optional()}).defined(),Hde=wt({present:CL.required(),permanent:CL.required(),sameAsPresent:ns().required()}).defined(),Yde=()=>{const{onValidated:n}=pi(),{data:e,updateAddress:t,setAddressVerifiedStatus:r}=Wn(),{address:s}=fi(),[a,o]=E.useState(!1),[l,c]=E.useState(""),{register:d,handleSubmit:m,formState:{errors:p},control:x,setValue:v,trigger:_,getValues:w,reset:j,watch:P}=Zt({resolver:_n(Hde),defaultValues:e.address}),k=nu({control:x,name:"sameAsPresent"}),I=nu({control:x,name:"present"}),M=nu({control:x,name:"permanent"});E.useEffect(()=>{j(e.address)},[e.address,j]),E.useEffect(()=>{let F;const U=P(B=>{clearTimeout(F),F=window.setTimeout(()=>{t(B)},500)});return()=>{U.unsubscribe(),clearTimeout(F)}},[P,t]),E.useEffect(()=>{k&&(v("permanent",I),_("permanent"))},[k,I,v,_]);const D=(F,U)=>{r(F,{[U]:!1})},O=async F=>{const U=F.target.value;if(D("present","pincode"),s.enablePincodeVerification&&/^[1-9][0-9]{5}$/.test(U)){o(!0),c("");try{const B=await pe.getPincodeDetails(U);v("present.city",B.city,{shouldValidate:!0}),v("present.state",B.state,{shouldValidate:!0}),r("present",{city:!0,state:!0,pincode:!0})}catch{c("Invalid Pincode. Please check and try again.")}finally{o(!1)}}},q=async F=>{t(F),await n()};return i.jsxs("form",{onSubmit:m(q),id:"address-form",children:[i.jsx(Tr,{title:"Address Details",subtitle:"Your communication and permanent address."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Present Address"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(gr,{label:"Address Line 1",id:"present.line1",isVerified:!!e.address.present.verifiedStatus?.line1,hasValue:!!I?.line1,onManualInput:()=>D("present","line1"),error:p.present?.line1?.message,registration:d("present.line1")})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(Me,{label:"Address Line 2 (Optional)",id:"present.line2",registration:d("present.line2")})}),i.jsx(gr,{label:"Country",id:"present.country",isVerified:!!e.address.present.verifiedStatus?.country,hasValue:!!I?.country,onManualInput:()=>D("present","country"),error:p.present?.country?.message,registration:d("present.country")}),i.jsxs("div",{className:"relative",children:[i.jsx(gr,{label:"Pincode",id:"present.pincode",type:"tel",isVerified:!!e.address.present.verifiedStatus?.pincode,hasValue:!!I?.pincode,error:p.present?.pincode?.message||l,registration:d("present.pincode"),onBlur:O}),a&&i.jsx(Tt,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]}),i.jsx(gr,{label:"City",id:"present.city",isVerified:!!e.address.present.verifiedStatus?.city,hasValue:!!I?.city,onManualInput:()=>D("present","city"),error:p.present?.city?.message,registration:d("present.city")}),i.jsx(gr,{label:"State",id:"present.state",isVerified:!!e.address.present.verifiedStatus?.state,hasValue:!!I?.state,onManualInput:()=>D("present","state"),error:p.present?.state?.message,registration:d("present.state")})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Permanent Address"}),i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("input",{id:"sameAsPresent",type:"checkbox",...d("sameAsPresent"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),i.jsx("label",{htmlFor:"sameAsPresent",className:"ml-2 block text-sm text-muted",children:"Same as Present Address"})]}),!k&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(gr,{label:"Address Line 1",id:"permanent.line1",isVerified:!!e.address.permanent.verifiedStatus?.line1,hasValue:!!M?.line1,onManualInput:()=>D("permanent","line1"),error:p.permanent?.line1?.message,registration:d("permanent.line1")})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(Me,{label:"Address Line 2 (Optional)",id:"permanent.line2",registration:d("permanent.line2")})}),i.jsx(gr,{label:"Country",id:"permanent.country",isVerified:!!e.address.permanent.verifiedStatus?.country,hasValue:!!M?.country,onManualInput:()=>D("permanent","country"),error:p.permanent?.country?.message,registration:d("permanent.country")}),i.jsx(gr,{label:"Pincode",id:"permanent.pincode",type:"tel",isVerified:!!e.address.permanent.verifiedStatus?.pincode,hasValue:!!M?.pincode,onManualInput:()=>D("permanent","pincode"),error:p.permanent?.pincode?.message,registration:d("permanent.pincode")}),i.jsx(gr,{label:"City",id:"permanent.city",isVerified:!!e.address.permanent.verifiedStatus?.city,hasValue:!!M?.city,onManualInput:()=>D("permanent","city"),error:p.permanent?.city?.message,registration:d("permanent.city")}),i.jsx(gr,{label:"State",id:"permanent.state",isVerified:!!e.address.permanent.verifiedStatus?.state,hasValue:!!M?.state,onManualInput:()=>D("permanent","state"),error:p.permanent?.state?.message,registration:d("permanent.state")})]})]})]})]})},Gde=wt({designation:be().required("Designation is required"),department:be().required("Department is required"),reportingManager:be().optional(),organizationId:be().required("Organization is required"),organizationName:be().required(),joiningDate:be().required("Joining date is required"),workType:be().oneOf(["Full-time","Part-time","Contract",""]).required("Work type is required"),site:be().optional(),defaultSalary:rs().nullable().optional()}).defined(),Zde=()=>{const{onValidated:n}=pi(),{user:e}=St(),{data:t,updateOrganization:r}=Wn(),[s,a]=E.useState([]),o=Jt("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:m,watch:p,setValue:x,reset:v}=Zt({resolver:_n(Gde),defaultValues:t.organization}),_=p("organizationId"),w=p("designation"),j=!!t.organization.organizationId;E.useEffect(()=>{pe.getOrganizations().then(a)},[]),E.useEffect(()=>{v(t.organization)},[t.organization,v]),E.useEffect(()=>{let k;const I=p(M=>{clearTimeout(k),k=window.setTimeout(()=>{r(M)},500)});return()=>{I.unsubscribe(),clearTimeout(k)}},[p,r]),E.useEffect(()=>{const k=s.find(I=>I.id===_);k&&x("organizationName",k.shortName)},[_,s,x]),E.useEffect(()=>{w&&pe.suggestDepartmentForDesignation(w).then(k=>{k&&x("department",k,{shouldValidate:!0})})},[w,x]);const P=async k=>{r(k),await n()};return o?i.jsx("form",{onSubmit:c(P),id:"organization-form",children:i.jsxs("div",{className:"space-y-6",children:[i.jsx("p",{className:"text-sm text-gray-400",children:"Provide the employment details for the new employee within the organization."}),i.jsxs("select",{...l("organizationId"),className:"pro-select pro-select-arrow",disabled:j,children:[i.jsx("option",{value:"",children:"Select Organization"}),s.map(k=>i.jsx("option",{value:k.id,children:k.shortName},k.id))]}),d.organizationId&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.organizationId.message}),i.jsx("input",{placeholder:"Designation",...l("designation"),className:"form-input"}),i.jsx("input",{placeholder:"Department",...l("department"),className:"form-input"}),i.jsx("input",{placeholder:"Reporting Manager",...l("reportingManager"),className:"form-input"}),i.jsx(je,{name:"joiningDate",control:m,render:({field:k})=>i.jsx("input",{type:"date",...k,className:"form-input"})}),d.joiningDate&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.joiningDate.message}),i.jsxs("select",{...l("workType"),className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"Select Work Type"}),i.jsx("option",{children:"Full-time"}),i.jsx("option",{children:"Part-time"}),i.jsx("option",{children:"Contract"})]}),d.workType&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.workType.message})]})}):i.jsxs("form",{onSubmit:c(P),id:"organization-form",children:[i.jsx(Tr,{title:"Organization Details",subtitle:"Your employment details within the organization."}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsxs(Qe,{label:"Organization / Client",id:"organizationId",error:d.organizationId?.message,registration:l("organizationId"),disabled:j,children:[i.jsx("option",{value:"",children:"Select Organization"}),s.map(k=>i.jsx("option",{value:k.id,children:k.shortName},k.id))]}),i.jsx(Me,{label:"Designation",id:"designation",error:d.designation?.message,registration:l("designation")}),i.jsx(Me,{label:"Department",id:"department",error:d.department?.message,registration:l("department")}),i.jsx(Me,{label:"Reporting Manager",id:"reportingManager",error:d.reportingManager?.message,registration:l("reportingManager")}),i.jsx(je,{name:"joiningDate",control:m,render:({field:k})=>i.jsx(Nn,{label:"Joining Date",id:"joiningDate",error:d.joiningDate?.message,value:k.value,onChange:k.onChange})}),i.jsxs(Qe,{label:"Work Type",id:"workType",error:d.workType?.message,registration:l("workType"),children:[i.jsx("option",{value:"",children:"Select Work Type"}),i.jsx("option",{children:"Full-time"}),i.jsx("option",{children:"Part-time"}),i.jsx("option",{children:"Contract"})]})]})]})},Kde=()=>{const{onValidated:n,setToast:e}=pi(),{data:t,updateFamily:r}=Wn(),{rulesByDesignation:s}=Zc(),a=Jt("(max-width: 767px)"),o=t.organization.designation,l=E.useMemo(()=>{const X=o&&s[o];return X?X.documents.familyAadhaar:!1},[o,s]),c=wt({id:be().required(),relation:be().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),name:be().required("Name is required"),dob:be().required("Date of birth is required"),gender:be().oneOf(["Male","Female","Other",""]).required("Gender is required"),occupation:be().optional(),dependent:ns().required(),phone:be().when("relation",{is:"Child",then:X=>X.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:X=>X.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:Ft().nullable().when([],{is:()=>l,then:X=>X.test("is-required","Aadhaar proof is required for this designation.",Q=>Q!=null).nullable(),otherwise:X=>X.optional().nullable()})}),d=wt({family:xs().of(c).required()}),{control:m,handleSubmit:p,formState:{errors:x},watch:v,setValue:_}=Zt({resolver:_n(d),defaultValues:{family:t.family}}),{fields:w,append:j,remove:P}=ys({control:m,name:"family"}),[k,I]=E.useState(!1),[M,D]=E.useState(null);E.useEffect(()=>{let X;const Q=v(Y=>{clearTimeout(X),X=window.setTimeout(()=>{r(Y.family)},500)});return()=>{Q.unsubscribe(),clearTimeout(X)}},[v,r]);const O=X=>Q=>{let Y=!1;if(Q.name){const ne=Q.name.toLowerCase().replace(/\b(\w)/g,te=>te.toUpperCase());_(`family.${X}.name`,ne,{shouldValidate:!0}),Y=!0}if(Q.dob)try{const ne=Q.dob.replace(/[/.]/g,"-"),te=["dd-MM-yyyy","yyyy-MM-dd","MM-dd-yyyy","d-M-yyyy"];let ie=null;for(const $ of te){const H=p$(ne,$,new Date);if(!isNaN(H.getTime())){ie=H;break}}if(ie){const $=Ue(ie,"yyyy-MM-dd");_(`family.${X}.dob`,$,{shouldValidate:!0}),Y=!0}}catch{console.error("Could not parse date from OCR:",Q.dob)}if(Q.gender){const ne=Q.gender.toLowerCase().trim();ne.includes("male")||ne.includes("purush")||ne==="m"?(_(`family.${X}.gender`,"Male",{shouldValidate:!0}),Y=!0):(ne.includes("female")||ne.includes("mahila")||ne==="f")&&(_(`family.${X}.gender`,"Female",{shouldValidate:!0}),Y=!0)}Y&&e({message:"Family member details auto-filled.",type:"success"})},q={type:Xe.OBJECT,properties:{name:{type:Xe.STRING},dob:{type:Xe.STRING},gender:{type:Xe.STRING}}},F=()=>{j({id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""})},U=X=>{D(X),I(!0)},B=()=>{M!==null&&(P(M),I(!1),D(null))},G=async X=>{r(X.family),await n()};return a?i.jsxs("form",{onSubmit:p(G),id:"family-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List your immediate family members."}),i.jsx("div",{className:"space-y-4",children:w.map((X,Q)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[i.jsx("button",{type:"button",onClick:()=>U(Q),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove family member",children:i.jsx(Xt,{className:"h-5 w-5"})}),i.jsx(je,{name:`family.${Q}.relation`,control:m,render:({field:Y})=>i.jsxs("select",{...Y,className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"Select Relation"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})]})}),i.jsx(je,{name:`family.${Q}.name`,control:m,render:({field:Y})=>i.jsx("input",{placeholder:"Full Name",...Y,className:"form-input"})}),i.jsx(je,{name:`family.${Q}.dob`,control:m,render:({field:Y})=>i.jsx("input",{type:"date",placeholder:"Date of Birth",...Y,className:"form-input"})}),i.jsx(je,{name:`family.${Q}.phone`,control:m,render:({field:Y})=>i.jsx("input",{placeholder:"Phone Number",type:"tel",...Y,className:"form-input"})})]},X.id))}),i.jsxs(ae,{type:"button",onClick:F,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]}):i.jsxs("form",{onSubmit:p(G),id:"family-form",children:[i.jsx(tr,{isOpen:k,onClose:()=>I(!1),onConfirm:B,title:"Confirm Deletion",children:"Are you sure you want to remove this family member? This action cannot be undone."}),i.jsx(Tr,{title:"Family Details",subtitle:"List your immediate family members."}),i.jsx("div",{className:"space-y-6",children:w.map((X,Q)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[i.jsx("button",{type:"button",onClick:()=>U(Q),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${X.name}`,children:i.jsx(Xt,{className:"h-4 w-4"})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[i.jsx(je,{name:`family.${Q}.relation`,control:m,render:({field:Y})=>i.jsxs(Qe,{label:"Relation",id:Y.name,error:x.family?.[Q]?.relation?.message,...Y,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})]})}),i.jsx(je,{name:`family.${Q}.name`,control:m,render:({field:Y})=>i.jsx(Me,{label:"Full Name",id:Y.name,error:x.family?.[Q]?.name?.message,...Y})}),i.jsx(je,{name:`family.${Q}.dob`,control:m,render:({field:Y})=>i.jsx(Nn,{label:"Date of Birth",id:Y.name,value:Y.value,onChange:Y.onChange,error:x.family?.[Q]?.dob?.message,maxDate:new Date})}),i.jsx(je,{name:`family.${Q}.gender`,control:m,render:({field:Y})=>i.jsxs(Qe,{label:"Gender",id:Y.name,error:x.family?.[Q]?.gender?.message,...Y,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Male"}),i.jsx("option",{children:"Female"}),i.jsx("option",{children:"Other"})]})}),i.jsx(je,{name:`family.${Q}.phone`,control:m,render:({field:Y})=>i.jsx(Me,{label:"Phone Number",id:Y.name,type:"tel",error:x.family?.[Q]?.phone?.message,...Y,value:Y.value??""})}),i.jsx(je,{name:`family.${Q}.occupation`,control:m,render:({field:Y})=>i.jsx(Me,{label:"Occupation (Optional)",id:Y.name,...Y,value:Y.value??""})}),i.jsx("div",{className:"col-span-full md:col-span-1 flex items-center pt-5",children:i.jsx(je,{name:`family.${Q}.dependent`,control:m,render:({field:Y})=>i.jsx(Cn,{id:Y.name,label:"Is a dependent?",checked:Y.value,onChange:Y.onChange})})}),i.jsx("div",{className:"col-span-full",children:i.jsx(je,{name:`family.${Q}.idProof`,control:m,render:({field:Y,fieldState:ne})=>i.jsx(xt,{label:`Aadhaar Proof ${l?"(Mandatory)":"(Optional)"}`,file:Y.value,onFileChange:Y.onChange,onOcrComplete:O(Q),ocrSchema:q,setToast:e,error:ne.error?.message,docType:"Aadhaar"})})})]})]},X.id))}),i.jsxs(ae,{type:"button",onClick:F,variant:"outline",className:"mt-6",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})},Jde=()=>{const{onValidated:n,setToast:e}=pi(),{user:t}=St(),{data:r,updateEducation:s,updateEducationRecord:a}=Wn(),o=Jt("(max-width: 767px)"),l=E.useMemo(()=>/manager|admin|head/i.test(r.organization.designation),[r.organization.designation]),c=E.useMemo(()=>wt({id:be().required(),degree:be().required("Degree is required"),institution:be().required("Institution is required"),startYear:be().required("Start year is required").matches(/^\d{4}$/,"Must be a 4-digit year"),endYear:be().required("End year is required").matches(/^\d{4}$/,"Must be a 4-digit year").test("is-after-start-year","End year must be on or after start year",function(Q){const{startYear:Y}=this.parent;return!Y||!Q||parseInt(Q)>=parseInt(Y)}),percentage:rs().nullable().min(0).max(100).optional(),grade:be().optional(),document:Ft().nullable().when([],{is:()=>l,then:Q=>Q.required("Certificate is mandatory for this role.").nullable(),otherwise:Q=>Q.optional().nullable()})}).defined(),[l]),d=wt({education:xs().of(c).required()}),{control:m,handleSubmit:p,formState:{errors:x},setValue:v,reset:_,watch:w}=Zt({resolver:_n(d),context:{isAdminOrManager:l},mode:"onBlur"}),{fields:j,append:P,remove:k}=ys({control:m,name:"education"}),[I,M]=E.useState(!1),[D,O]=E.useState(null);E.useEffect(()=>{_({education:r.education})},[r.education,_]),E.useEffect(()=>{let Q;const Y=w(ne=>{clearTimeout(Q),Q=window.setTimeout(()=>{s(ne.education)},500)});return()=>{Y.unsubscribe(),clearTimeout(Q)}},[w,s]);const q=()=>{P({id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""})},F=Q=>{O(Q),M(!0)},U=()=>{D!==null&&(k(D),M(!1),O(null))},B=async Q=>{s(Q.education),await n()},G=Q=>Y=>{const ne=j[Q].id,te={};if(Y.degree&&(v(`education.${Q}.degree`,Y.degree,{shouldValidate:!0}),te.degree=Y.degree),Y.institution&&(v(`education.${Q}.institution`,Y.institution,{shouldValidate:!0}),te.institution=Y.institution),Y.endYear){const ie=Y.endYear.toString();v(`education.${Q}.endYear`,ie,{shouldValidate:!0}),te.endYear=ie}Object.keys(te).length>0&&(a(ne,te),e({message:"Education details auto-filled.",type:"success"}))},X={type:Xe.OBJECT,properties:{degree:{type:Xe.STRING,description:"The name of the degree, diploma, or certificate."},institution:{type:Xe.STRING,description:"The name of the university, college, or institution."},endYear:{type:Xe.STRING,description:"The year of completion or graduation as a 4-digit number."}},required:["degree","institution","endYear"]};return o?i.jsxs("form",{onSubmit:p(B),id:"education-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List educational qualifications, starting with the most recent."}),i.jsx("div",{className:"space-y-4",children:j.map((Q,Y)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[i.jsx("button",{type:"button",onClick:()=>F(Y),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove qualification",children:i.jsx(Xt,{className:"h-5 w-5"})}),i.jsx(je,{name:`education.${Y}.degree`,control:m,render:({field:ne})=>i.jsx("input",{placeholder:"Degree / Certificate",...ne,className:"form-input"})}),i.jsx(je,{name:`education.${Y}.institution`,control:m,render:({field:ne})=>i.jsx("input",{placeholder:"Institution / University",...ne,className:"form-input"})}),i.jsx(je,{name:`education.${Y}.endYear`,control:m,render:({field:ne})=>i.jsx("input",{placeholder:"Year of Completion",type:"text",maxLength:4,...ne,className:"form-input"})}),i.jsx(je,{name:`education.${Y}.document`,control:m,render:({field:ne,fieldState:te})=>i.jsx(xt,{label:`Certificate ${l?"(Mandatory)":"(Optional)"}`,file:ne.value,onFileChange:ne.onChange,error:te.error?.message,allowCapture:!0})})]},Q.id))}),i.jsxs(ae,{type:"button",onClick:q,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]}):i.jsxs("form",{onSubmit:p(B),id:"education-form",children:[i.jsx(tr,{isOpen:I,onClose:()=>M(!1),onConfirm:U,title:"Confirm Deletion",children:"Are you sure you want to remove this education record? This action cannot be undone."}),i.jsx(Tr,{title:"Education Details",subtitle:"List your educational qualifications, starting with the most recent."}),i.jsx("div",{className:"space-y-6",children:j.map((Q,Y)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[i.jsx("button",{type:"button",onClick:()=>F(Y),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${Q.degree}`,children:i.jsx(Xt,{className:"h-4 w-4"})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(je,{name:`education.${Y}.degree`,control:m,render:({field:ne})=>i.jsx(Me,{label:"Degree / Certificate",id:ne.name,error:x.education?.[Y]?.degree?.message,...ne})}),i.jsx(je,{name:`education.${Y}.institution`,control:m,render:({field:ne})=>i.jsx(Me,{label:"Institution / University",id:ne.name,error:x.education?.[Y]?.institution?.message,...ne})}),i.jsx(je,{name:`education.${Y}.startYear`,control:m,render:({field:ne})=>i.jsx(Me,{label:"Start Year",id:ne.name,type:"text",maxLength:4,error:x.education?.[Y]?.startYear?.message,...ne})}),i.jsx(je,{name:`education.${Y}.endYear`,control:m,render:({field:ne})=>i.jsx(Me,{label:"End Year",id:ne.name,type:"text",maxLength:4,error:x.education?.[Y]?.endYear?.message,...ne})}),i.jsx(je,{name:`education.${Y}.percentage`,control:m,render:({field:ne})=>i.jsx(Me,{label:"Percentage (Optional)",id:ne.name,type:"number",error:x.education?.[Y]?.percentage?.message,...ne,value:ne.value??""})}),i.jsx(je,{name:`education.${Y}.grade`,control:m,render:({field:ne})=>i.jsx(Me,{label:"Grade (Optional)",id:ne.name,type:"text",error:x.education?.[Y]?.grade?.message,...ne,value:ne.value??""})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(je,{name:`education.${Y}.document`,control:m,render:({field:ne,fieldState:te})=>i.jsx(xt,{label:`Upload Certificate ${l?"(Mandatory)":"(Optional)"}`,file:ne.value,onFileChange:ne.onChange,onOcrComplete:G(Y),ocrSchema:X,setToast:e,error:te.error?.message})})})]})]},Q.id))}),i.jsxs(ae,{type:"button",onClick:q,variant:"outline",className:"mt-6",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})},zN=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",Qde=be().matches(/^[a-zA-Z\s.'-]*$/,"Name can only contain letters and spaces").transform(zN),Xde=wt({accountHolderName:Qde.required("Account holder name is required"),accountNumber:be().required("Account number is required").matches(/^[0-9]+$/,"Must be only digits"),confirmAccountNumber:be().oneOf([CC("accountNumber")],"Account numbers must match").required("Please confirm your account number"),ifscCode:be().required("IFSC code is required").transform(n=>n.toUpperCase()).matches(/^[A-Z]{4}0[A-Z0-9]{6}$/,"Invalid IFSC code format (e.g., SBIN0123456)"),bankName:be().required("Bank name is required"),branchName:be().required("Branch name is required"),bankProof:Ft().optional().nullable(),verifiedStatus:wt().optional()}).defined(),eue=()=>{const{onValidated:n,setToast:e}=pi(),{user:t}=St(),{data:r,updateBank:s,setBankVerifiedStatus:a}=Wn(),o=Jt("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:m,setValue:p,watch:x,reset:v}=Zt({resolver:_n(Xde),defaultValues:r.bank});E.useEffect(()=>{v(r.bank)},[r.bank,v]),E.useEffect(()=>{let M;const D=x(O=>{clearTimeout(M),M=window.setTimeout(()=>{s(O)},500)});return()=>{D.unsubscribe(),clearTimeout(M)}},[x,s]);const _=x(),w=async M=>{s(M),await n()},j=M=>{const D=M.target.value;p("accountHolderName",zN(D),{shouldValidate:!0})},P=M=>{const D={};M.forEach(O=>{D[O]=!1}),a(D)},k=M=>{const D={},O={};if(M.accountHolderName){const q=zN(M.accountHolderName);p("accountHolderName",q,{shouldValidate:!0}),D.accountHolderName=q,O.accountHolderName=!0}if(M.accountNumber){const q=M.accountNumber.replace(/\D/g,"");p("accountNumber",q,{shouldValidate:!0}),p("confirmAccountNumber",q,{shouldValidate:!0}),D.accountNumber=q,D.confirmAccountNumber=q,O.accountNumber=!0}if(M.ifscCode){const q=M.ifscCode.toUpperCase().replace(/\s/g,"");p("ifscCode",q,{shouldValidate:!0}),D.ifscCode=q,O.ifscCode=!0}M.bankName&&(p("bankName",M.bankName,{shouldValidate:!0}),D.bankName=M.bankName),M.branchName&&(p("branchName",M.branchName,{shouldValidate:!0}),D.branchName=M.branchName),Object.keys(D).length>0&&s(D),a(O),e({message:"Bank details extracted. Please review.",type:"success"})},I={type:Xe.OBJECT,properties:{accountHolderName:{type:Xe.STRING,description:"The account holder's full name."},accountNumber:{type:Xe.STRING,description:"The full bank account number."},ifscCode:{type:Xe.STRING,description:"The bank's IFSC code."},bankName:{type:Xe.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:Xe.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}},required:["accountHolderName","accountNumber","ifscCode","bankName","branchName"]};return o?i.jsxs("form",{onSubmit:c(w),id:"bank-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Your salary will be credited to this account."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("input",{placeholder:"Account Holder Name",...l("accountHolderName"),onBlur:j,className:"form-input"}),i.jsx("input",{placeholder:"Bank Name",...l("bankName"),className:"form-input"}),i.jsx("input",{placeholder:"Account Number",...l("accountNumber"),className:"form-input"}),i.jsx("input",{placeholder:"Confirm Account Number",...l("confirmAccountNumber"),className:"form-input"}),i.jsx("input",{placeholder:"IFSC Code",...l("ifscCode"),className:"form-input"}),i.jsx("input",{placeholder:"Branch Name",...l("branchName"),className:"form-input"}),i.jsx(je,{name:"bankProof",control:m,render:({field:M})=>i.jsx(xt,{label:"Upload Bank Proof (Optional)",file:M.value,onFileChange:M.onChange,allowCapture:!0})})]})]}):i.jsxs("form",{onSubmit:c(w),id:"bank-form",children:[i.jsx(Tr,{title:"Bank Details",subtitle:"Your salary will be credited to this account."}),i.jsxs("div",{className:"space-y-6",children:[i.jsx(je,{name:"bankProof",control:m,render:({field:M})=>i.jsx(xt,{label:"Upload Bank Proof (Cancelled Cheque/Passbook)",file:M.value,onFileChange:M.onChange,onOcrComplete:k,ocrSchema:I,setToast:e})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 pt-6 border-t",children:[i.jsx(gr,{label:"Account Holder Name",id:"accountHolderName",hasValue:!!_.accountHolderName,isVerified:r.bank.verifiedStatus?.accountHolderName===!0,onManualInput:()=>P(["accountHolderName"]),error:d.accountHolderName?.message,registration:l("accountHolderName"),onBlur:j}),i.jsx(gr,{label:"Bank Name",id:"bankName",hasValue:!!_.bankName,isVerified:!1,error:d.bankName?.message,registration:l("bankName")}),i.jsx(gr,{label:"Account Number",id:"accountNumber",hasValue:!!_.accountNumber,isVerified:r.bank.verifiedStatus?.accountNumber===!0,onManualInput:()=>P(["accountNumber"]),error:d.accountNumber?.message,registration:l("accountNumber")}),i.jsx(gr,{label:"Confirm Account Number",id:"confirmAccountNumber",hasValue:!!_.confirmAccountNumber,isVerified:r.bank.verifiedStatus?.accountNumber===!0,onManualInput:()=>P(["accountNumber"]),error:d.confirmAccountNumber?.message,registration:l("confirmAccountNumber")}),i.jsx(gr,{label:"IFSC Code",id:"ifscCode",hasValue:!!_.ifscCode,isVerified:r.bank.verifiedStatus?.ifscCode===!0,onManualInput:()=>P(["ifscCode"]),error:d.ifscCode?.message,registration:l("ifscCode")}),i.jsx(gr,{label:"Branch Name",id:"branchName",hasValue:!!_.branchName,isVerified:!1,error:d.branchName?.message,registration:l("branchName")})]})]})]})},tue=wt({hasPreviousPf:ns().required(),uanNumber:be().when("hasPreviousPf",{is:!0,then:n=>n.required("UAN Number is required").matches(/^[0-9]{12}$/,"UAN must be 12 digits"),otherwise:n=>n.optional().nullable()}),pfNumber:be().when("hasPreviousPf",{is:!0,then:n=>n.optional().nullable(),otherwise:n=>n.optional().nullable()}),document:Ft().optional().nullable(),salarySlip:Ft().optional().nullable(),verifiedStatus:wt().optional()}).defined(),nue=()=>{const{onValidated:n,setToast:e}=pi(),{user:t}=St(),{data:r,updateUan:s,setUanVerifiedStatus:a}=Wn(),o=Jt("(max-width: 767px)"),{register:l,control:c,handleSubmit:d,formState:{errors:m},setValue:p,watch:x,reset:v}=Zt({resolver:_n(tue),defaultValues:r.uan});E.useEffect(()=>{v(r.uan)},[r.uan,v]),E.useEffect(()=>{let M;const D=x(O=>{clearTimeout(M),M=window.setTimeout(()=>{s(O)},500)});return()=>{D.unsubscribe(),clearTimeout(M)}},[x,s]);const _=x("hasPreviousPf"),w=x(),j=async M=>{s(M),await n()},P=()=>{a({uanNumber:!1})},k=M=>{if(M.uanNumber){const D=M.uanNumber.replace(/\D/g,"");if(D.length===12){const O={uanNumber:D,hasPreviousPf:!0};p("uanNumber",D,{shouldValidate:!0}),p("hasPreviousPf",!0,{shouldValidate:!0}),s(O),a({uanNumber:!0}),e({message:"UAN extracted successfully.",type:"success"})}}},I={type:Xe.OBJECT,properties:{uanNumber:{type:Xe.STRING,description:"The 12-digit Universal Account Number (UAN)."}},required:["uanNumber"]};return o?i.jsxs("form",{onSubmit:d(j),id:"uan-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Universal Account Number if you have one."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",...l("hasPreviousPf"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"Do you have a previous PF account or UAN?"})]}),_&&i.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[i.jsx("input",{placeholder:"UAN Number",...l("uanNumber"),className:"form-input"}),i.jsx("input",{placeholder:"PF Number (Optional)",...l("pfNumber"),className:"form-input"}),i.jsx(je,{name:"document",control:c,render:({field:M})=>i.jsx(xt,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,allowCapture:!0,costingItemName:"EPF UAN Lookup"})})]})]})]}):i.jsxs("form",{onSubmit:d(j),id:"uan-form",children:[i.jsx(Tr,{title:"UAN / PF Details",subtitle:"Provide your Universal Account Number if you have one."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"hasPreviousPf",type:"checkbox",...l("hasPreviousPf"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),i.jsx("label",{htmlFor:"hasPreviousPf",className:"ml-2 block text-sm text-muted",children:"Do you have a previous PF account or UAN?"})]}),r.uan.salarySlip&&i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-2",children:"Reference Salary Slip"}),i.jsx(xt,{label:"",file:r.uan.salarySlip,onFileChange:()=>{}})]}),_&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx(gr,{label:"UAN Number",id:"uanNumber",hasValue:!!w.uanNumber,isVerified:r.uan.verifiedStatus?.uanNumber===!0,onManualInput:P,registration:l("uanNumber"),error:m.uanNumber?.message}),i.jsx(Me,{label:"PF Number (Optional)",id:"pfNumber",registration:l("pfNumber"),error:m.pfNumber?.message})]}),i.jsx(je,{name:"document",control:c,render:({field:M})=>i.jsx(xt,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,onOcrComplete:k,ocrSchema:I,setToast:e,costingItemName:"EPF UAN Lookup"})})]})]})]})},rue=wt({hasEsi:ns().required(),esiNumber:be().when("hasEsi",{is:!0,then:n=>n.required("ESI Number is required").matches(/^(\d{10}|\d{17})$/,"ESI number must be 10 or 17 digits"),otherwise:n=>n.optional().nullable()}),esiRegistrationDate:be().when("hasEsi",{is:!0,then:n=>n.required("Registration date is required").test("not-in-future","Registration date cannot be in the future",e=>e?new Date(e.replace(/-/g,"/"))<=new Date:!0),otherwise:n=>n.optional().nullable()}),esicBranch:be().when("hasEsi",{is:!0,then:n=>n.required("ESIC Branch is required"),otherwise:n=>n.optional().nullable()}),document:Ft().optional().nullable(),verifiedStatus:wt().optional()}),sue=()=>{const{onValidated:n,setToast:e}=pi(),{user:t}=St(),{data:r,updateEsi:s,setEsiVerifiedStatus:a}=Wn(),{esiCtcThreshold:o,enableEsiRule:l}=Zc(),c=Jt("(max-width: 767px)"),{register:d,control:m,handleSubmit:p,formState:{errors:x},reset:v,setValue:_,watch:w}=Zt({resolver:_n(rue),defaultValues:r.esi}),j=w("hasEsi"),P=w(),k=r.personal.salary!=null&&r.personal.salary<=o;E.useEffect(()=>{v(r.esi)},[r.esi,v]),E.useEffect(()=>{let q;const F=w(U=>{clearTimeout(q),q=window.setTimeout(()=>{s(U)},500)});return()=>{F.unsubscribe(),clearTimeout(q)}},[w,s]),E.useEffect(()=>{k||r.esi.hasEsi&&s({hasEsi:!1,esiNumber:"",esiRegistrationDate:"",esicBranch:""})},[k,r.esi.hasEsi,s]);const I=async q=>{s(q),await n()},M=()=>{a({esiNumber:!1})},D=q=>{if(q.esiNumber){const F=q.esiNumber.replace(/\D/g,"");if(F.length===10||F.length===17){const U={esiNumber:F,hasEsi:!0};_("esiNumber",F,{shouldValidate:!0}),_("hasEsi",!0,{shouldValidate:!0}),s(U),a({esiNumber:!0}),e({message:"ESI Number extracted successfully.",type:"success"})}}},O={type:Xe.OBJECT,properties:{esiNumber:{type:Xe.STRING,description:"The 10 or 17-digit ESI number."}},required:["esiNumber"]};if(c){if(!l||!k){const q=l?`Employee is not eligible for ESI as their gross salary is above the ${o.toLocaleString()} threshold.`:"ESI enrollment is currently disabled by company policy. This step is not applicable.";return i.jsx("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"esi-form",children:i.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-900/40 rounded-lg border border-blue-500/50",children:[i.jsx($h,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),i.jsx("p",{className:"text-sm text-blue-300",children:q})]})})}return i.jsxs("form",{onSubmit:p(I),id:"esi-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Employee's State Insurance number if applicable."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",...d("hasEsi"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"Are you covered under ESI?"})]}),j&&i.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[i.jsx("input",{placeholder:"ESI Number",...d("esiNumber"),className:"form-input"}),i.jsx("input",{type:"date",...d("esiRegistrationDate"),className:"form-input"}),i.jsx("input",{placeholder:"ESIC Branch",...d("esicBranch"),className:"form-input"}),i.jsx(je,{name:"document",control:m,render:({field:q})=>i.jsx(xt,{label:"Upload ESI Card",file:q.value,onFileChange:q.onChange,allowCapture:!0,costingItemName:"ESI Card OCR"})})]})]})]})}return l?k?i.jsxs("form",{onSubmit:p(I),id:"esi-form",children:[i.jsx(Tr,{title:"ESI Details",subtitle:"Provide your Employee's State Insurance number if applicable."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"hasEsi",type:"checkbox",...d("hasEsi"),className:"h-4 w-4 text-accent"}),i.jsx("label",{htmlFor:"hasEsi",className:"ml-2 block text-sm text-muted",children:"Are you covered under ESI?"})]}),j&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx(gr,{label:"ESI Number",id:"esiNumber",hasValue:!!P.esiNumber,isVerified:r.esi.verifiedStatus?.esiNumber===!0,onManualInput:M,registration:d("esiNumber"),error:x.esiNumber?.message}),i.jsx(je,{name:"esiRegistrationDate",control:m,render:({field:q})=>i.jsx(Nn,{label:"ESI Registration Date",id:"esiRegistrationDate",error:x.esiRegistrationDate?.message,value:q.value,onChange:q.onChange,maxDate:new Date})}),i.jsx(Me,{label:"ESIC Branch",id:"esicBranch",registration:d("esicBranch"),error:x.esicBranch?.message})]}),i.jsx(je,{name:"document",control:m,render:({field:q})=>i.jsx(xt,{label:"Upload ESI Card",file:q.value,onFileChange:q.onChange,onOcrComplete:D,ocrSchema:O,setToast:e,costingItemName:"ESI Card OCR"})})]})]})]}):i.jsxs("form",{onSubmit:async q=>{q.preventDefault(),await n()},id:"esi-form",children:[i.jsx(Tr,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),i.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[i.jsx($h,{className:"h-5 w-5 text-blue-500 mr-3"}),i.jsxs("p",{className:"text-sm text-blue-700",children:["Employee is not eligible for ESI as their gross salary is above the $",o.toLocaleString()," threshold."]})]})]}):i.jsxs("form",{onSubmit:async q=>{q.preventDefault(),await n()},id:"esi-form",children:[i.jsx(Tr,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),i.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[i.jsx($h,{className:"h-5 w-5 text-blue-500 mr-3"}),i.jsx("p",{className:"text-sm text-blue-700",children:"ESI enrollment is currently disabled by company policy. This step is not applicable."})]})]})},iue=wt({isOptedIn:ns().nullable().required("Please choose whether you want to avail Group Medical Cover."),selectedSpouseId:be().optional(),selectedChildIds:xs().of(be().required()).optional(),gmcPolicyCopy:Ft().when("isOptedIn",{is:!1,then:n=>n.required("Please upload GMC policy copy (PNG, JPG, PDF up to 5MB)."),otherwise:n=>n.optional().nullable()}),declarationAccepted:ns().when("isOptedIn",{is:!1,then:n=>n.oneOf([!0],"Please accept the declaration to proceed."),otherwise:n=>n.optional()}),policyAmount:be().optional().nullable(),nomineeName:be().optional().nullable(),nomineeRelation:be().optional().nullable(),wantsToAddDependents:ns().optional().nullable(),optOutReason:be().optional().nullable(),alternateInsuranceProvider:be().optional().nullable(),alternateInsuranceStartDate:be().optional().nullable(),alternateInsuranceEndDate:be().optional().nullable(),alternateInsuranceCoverage:be().optional().nullable()}).defined(),aue=()=>{const{onValidated:n}=pi(),{user:e}=St(),{data:t,updateGmc:r}=Wn(),s=Jt("(max-width: 767px)"),{control:a,handleSubmit:o,formState:{errors:l},watch:c,reset:d,setValue:m,getValues:p}=Zt({resolver:_n(iue),defaultValues:t.gmc}),x=c("isOptedIn"),v=c("selectedSpouseId"),_=c("selectedChildIds")||[],w=E.useMemo(()=>t.family.find(M=>M.relation==="Spouse"),[t.family]),j=E.useMemo(()=>t.family.filter(M=>M.relation==="Child"),[t.family]),P=E.useMemo(()=>{const M=[];return w&&M.push(w),M.push(...j),M},[w,j]);E.useEffect(()=>{if(t.gmc.isOptedIn===!0){const M=!t.gmc.selectedSpouseId&&(!t.gmc.selectedChildIds||t.gmc.selectedChildIds.length===0),D=w||j.length>0;M&&D&&(m("selectedSpouseId",w?.id||"",{shouldDirty:!0}),m("selectedChildIds",j.map(O=>O.id),{shouldDirty:!0}))}},[t.gmc.isOptedIn,w,j,m,t.gmc.selectedSpouseId,t.gmc.selectedChildIds]),E.useEffect(()=>{d(t.gmc)},[t.gmc,d]),E.useEffect(()=>{let M;const D=c(O=>{clearTimeout(M),M=window.setTimeout(()=>{r(O)},500)});return()=>{D.unsubscribe(),clearTimeout(M)}},[c,r]);const k=async M=>{const D={...M};M.isOptedIn?(D.gmcPolicyCopy=null,D.declarationAccepted=!1):(D.selectedSpouseId="",D.selectedChildIds=[]),r(D),await n()},I=(M,D)=>{if(M.relation==="Spouse")m("selectedSpouseId",D?M.id:"",{shouldDirty:!0});else{const O=p("selectedChildIds")||[],q=D?[...O,M.id]:O.filter(F=>F!==M.id);m("selectedChildIds",q,{shouldDirty:!0})}};return s?i.jsxs("form",{onSubmit:o(k),id:"gmc-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please choose whether to enroll in the company's insurance plan."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-md font-semibold",children:"Would you like to Avail Group Medical Cover?"}),i.jsx(je,{name:"isOptedIn",control:a,render:({field:M})=>i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!0?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!0),checked:M.value===!0,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!1?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!1),checked:M.value===!1,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),x===!0&&i.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[i.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Select Dependents"}),P.map(M=>{const D=M.relation==="Spouse"?v===M.id:_.includes(M.id);return i.jsx(Cn,{id:`dep-mob-${M.id}`,label:`${M.name} (${M.relation})`,checked:D,onChange:O=>I(M,O)},M.id)})]}),x===!1&&i.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[i.jsx(je,{name:"gmcPolicyCopy",control:a,render:({field:M,fieldState:D})=>i.jsx(xt,{label:"Upload GMC Policy Copy",file:M.value,onFileChange:M.onChange,error:D.error?.message,allowCapture:!0})}),i.jsx(je,{name:"declarationAccepted",control:a,render:({field:M,fieldState:D})=>i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",checked:M.value??!1,onChange:M.onChange,className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"I declare I will not avail company GMC and the uploaded policy is valid."})]})})]})]})]}):i.jsxs("form",{onSubmit:o(k),id:"gmc-form",children:[i.jsx(Tr,{title:"Group Medical Cover (GMC)",subtitle:"Please choose whether to enroll in the company's insurance plan."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Would you like to Avail Group Medical Cover?"}),i.jsx(je,{name:"isOptedIn",control:a,render:({field:M})=>i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!0?"border-accent bg-accent-light":"border-border"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!0),checked:M.value===!0,className:"h-4 w-4 text-accent focus:ring-accent"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!1?"border-accent bg-accent-light":"border-border"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!1),checked:M.value===!1,className:"h-4 w-4 text-accent focus:ring-accent"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),l.isOptedIn&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:l.isOptedIn.message})]}),x===!0&&i.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[i.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Select Dependents for Policy"}),i.jsx("p",{className:"text-sm text-muted -mt-2 mb-2",children:"Spouse and children are included by default. Uncheck any dependents you do not want to include."}),i.jsx("div",{className:"space-y-2 p-4 border rounded-lg bg-page",children:P.length>0?P.map(M=>{const D=M.relation==="Spouse"?v===M.id:_.includes(M.id);return i.jsx(Cn,{id:`dep-${M.id}`,label:`${M.name} (${M.relation})`,checked:D,onChange:O=>I(M,O)},M.id)}):i.jsx("p",{className:"text-sm text-muted",children:'No spouse or children added. Please add them in the "Family Details" section to include them in the policy.'})})]}),x===!1&&i.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[i.jsx(je,{name:"gmcPolicyCopy",control:a,render:({field:M,fieldState:D})=>i.jsx(xt,{label:"Upload GMC Policy Copy",file:M.value,onFileChange:M.onChange,allowedTypes:["image/png","image/jpeg","application/pdf"],error:D.error?.message})}),i.jsx(je,{name:"declarationAccepted",control:a,render:({field:M,fieldState:D})=>i.jsxs("div",{className:"space-y-1",children:[i.jsx(Cn,{id:"declarationAccepted",label:"I declare that I will not avail company GMC and the uploaded policy is valid.",checked:M.value??!1,onChange:M.onChange}),D.error&&i.jsx("p",{className:"text-xs text-red-600",children:D.error.message})]})})]})]})]})},oue=()=>{const{onValidated:n,setToast:e}=pi(),{user:t}=St(),r=yn(),{data:s,updateUniforms:a}=Wn(),o=Jt("(max-width: 767px)"),[l,c]=E.useState(!0),[d,m]=E.useState(null),{gender:p}=s.personal,{organizationId:x,department:v,designation:_}=s.organization,{control:w,handleSubmit:j,reset:P,watch:k}=Zt(),{fields:I,replace:M}=ys({control:w,name:"uniforms"});E.useEffect(()=>{(async()=>{c(!0);try{const[U,B,G]=await Promise.all([pe.getAllSiteUniformDetails(),pe.getMasterGentsUniforms(),pe.getMasterLadiesUniforms()]);m({details:U,gents:B,ladies:G})}catch{e({message:"Failed to load uniform configuration.",type:"error"})}finally{c(!1)}})()},[e]);const D=E.useMemo(()=>{if(!d||!x||!v||!_)return[];const F=d.details[x];if(!F)return[];const U=F.departments.find(G=>G.department===v);return U?U.designations.find(G=>G.designation===_)?.items||[]:[]},[d,x,v,_]);E.useEffect(()=>{const F=D.map(U=>{const B=s.uniforms.find(X=>X.itemId===U.id),G=U.name.toLowerCase().includes("pant")?"Pants":"Shirts";return{itemId:U.id,itemName:U.name,category:G,sizeId:B?.sizeId||"",quantity:B?.quantity||1}});M(F)},[D,s.uniforms,M]),E.useEffect(()=>{let F;const U=k(B=>{clearTimeout(F),F=window.setTimeout(()=>{const G=B,X=p==="Female"?[...d?.ladies.pants||[],...d?.ladies.shirts||[]]:[...d?.gents.pants||[],...d?.gents.shirts||[]],Q=(G.uniforms||[]).filter(Y=>Y.sizeId&&Y.quantity>0).map(Y=>{const ne=X.find(te=>te.id===Y.sizeId);return{itemId:Y.itemId,itemName:Y.itemName,sizeId:Y.sizeId,sizeLabel:ne?.size||"",fit:ne?.fit||"",quantity:Y.quantity}});a(Q)},500)});return()=>{U.unsubscribe(),clearTimeout(F)}},[k,a,p,d]);const O=async F=>{const U=p==="Female"?[...d?.ladies.pants||[],...d?.ladies.shirts||[]]:[...d?.gents.pants||[],...d?.gents.shirts||[]],B=F.uniforms.filter(G=>G.sizeId&&G.quantity>0).map(G=>{const X=U.find(Q=>Q.id===G.sizeId);return{itemId:G.itemId,itemName:G.itemName,sizeId:G.sizeId,sizeLabel:X?.size||"",fit:X?.fit||"",quantity:G.quantity}});a(B),await n()};if(l)return i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(Tt,{className:"h-8 w-8 animate-spin text-accent"})});if(D.length===0&&s.uniforms.length>0)return i.jsxs("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"uniform-form",children:[!o&&i.jsx(Tr,{title:"Uniform Details",subtitle:"The following items have been selected for this employee."}),i.jsxs("div",{className:"space-y-4",children:[s.uniforms.map(F=>i.jsx("div",{className:`p-4 border rounded-lg flex justify-between items-center ${o?"bg-[#243524] border-border":"bg-page"}`,children:i.jsxs("div",{children:[i.jsx("p",{className:`font-semibold ${o?"text-white":"text-primary-text"}`,children:F.itemName}),i.jsxs("p",{className:`text-sm ${o?"text-gray-400":"text-muted"}`,children:["Size: ",F.sizeLabel,", Fit: ",F.fit,", Quantity: ",F.quantity]})]})},F.itemId+F.sizeId)),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>r("/onboarding/uniforms?from=onboarding"),children:[i.jsx(xr,{className:"mr-2 h-4 w-4"}),"Edit Uniform Selection"]})]})]});if(!p||D.length===0){const F=p?"No uniform requirements found for the selected site, department, and designation.":"Please select a gender in 'Personal Details' to view uniform options.",U=p&&D.length===0;return i.jsxs("form",{onSubmit:async B=>{B.preventDefault(),await n()},id:"uniform-form",children:[!o&&i.jsx(Tr,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),i.jsxs("div",{className:`text-center p-8 rounded-lg ${o?"":"bg-page"}`,children:[i.jsx(Hx,{className:`h-12 w-12 mx-auto ${o?"text-gray-500":"text-muted"}`}),i.jsx("p",{className:`mt-4 ${o?"text-gray-400":"text-muted"}`,children:F}),U&&i.jsxs("div",{className:"mt-6",children:[i.jsx("p",{className:`text-sm mb-4 ${o?"text-gray-500":"text-muted"}`,children:"You can proceed to the next step, or create a new site-level request if uniforms are needed."}),i.jsxs(ae,{type:"button",onClick:()=>r("/onboarding/uniforms?from=onboarding"),children:[i.jsx(qt,{className:"mr-2 h-4 w-4"}),"Create Site Uniform Request"]})]})]})]})}const q=p==="Female"?d?.ladies:d?.gents;return o?i.jsxs("form",{onSubmit:j(O),id:"uniform-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide uniform measurements for the employee."}),i.jsx("div",{className:"space-y-4",children:I.map((F,U)=>{const B=F.category==="Pants"?q?.pants:q?.shirts;return i.jsxs("div",{className:"p-4 border border-border rounded-xl space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:F.itemName}),i.jsx(je,{name:`uniforms.${U}.sizeId`,control:w,render:({field:G})=>i.jsxs("select",{...G,className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"-- Select Size --"}),B?.map(X=>i.jsxs("option",{value:X.id,children:["Size: ",X.size," - ",X.fit]},X.id))]})}),i.jsx(je,{name:`uniforms.${U}.quantity`,control:w,render:({field:G})=>i.jsx("input",{type:"number",min:"1",...G,className:"form-input"})})]},F.id)})})]}):i.jsxs("form",{onSubmit:j(O),id:"uniform-form",children:[i.jsx(Tr,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),i.jsx("div",{className:"space-y-6",children:I.map((F,U)=>{const B=F.category==="Pants"?q?.pants:q?.shirts;return i.jsxs("div",{className:"p-4 border border-border rounded-xl bg-page/50",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:F.itemName}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(je,{name:`uniforms.${U}.sizeId`,control:w,rules:{required:"Please select a size"},render:({field:G,fieldState:X})=>i.jsxs(Qe,{label:"Size & Fit",error:X.error?.message,...G,children:[i.jsx("option",{value:"",children:"-- Select Size --"}),B?.map(Q=>i.jsxs("option",{value:Q.id,children:["Size: ",Q.size," - ",Q.fit]},Q.id))]})}),i.jsx(je,{name:`uniforms.${U}.quantity`,control:w,rules:{required:!0,min:1},render:({field:G})=>i.jsx(Me,{label:"Quantity",type:"number",min:"1",...G})})]})]},F.id)})})]})},Dh=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",lue=()=>{const{onValidated:n,setToast:e}=pi(),{user:t}=St(),r=yn(),{data:s,updatePersonal:a,updateBank:o,addEducationRecord:l,updateFamilyMember:c,updateEducationRecord:d,updateUan:m,updateEsi:p,updateGmc:x}=Wn(),v=Jt("(max-width: 767px)"),_=B=>{const G={};if(B.name){const X=B.name.split(" ");G.firstName=Dh(X.shift()||""),G.lastName=Dh(X.pop()||""),G.middleName=Dh(X.join(" "))}if(B.dob)try{const X=new Date(B.dob);isNaN(X.getTime())||(G.dob=Ue(X,"yyyy-MM-dd"))}catch{}B.aadhaarNumber&&(G.idProofNumber=B.aadhaarNumber.replace(/\s/g,""),G.idProofType="Aadhaar"),a(G)},w=B=>{const G={};if(B.accountHolderName&&(G.accountHolderName=Dh(B.accountHolderName)),B.accountNumber){const X=B.accountNumber.replace(/\D/g,"");G.accountNumber=X,G.confirmAccountNumber=X}B.ifscCode&&(G.ifscCode=B.ifscCode.toUpperCase().replace(/\s/g,"")),o(G)},j=B=>{const G={};B.uanNumber&&(G.uanNumber=B.uanNumber.replace(/\D/g,""),G.hasPreviousPf=!0),m(G)},P=B=>{const G={};B.esiNumber&&(G.esiNumber=B.esiNumber.replace(/\D/g,""),G.hasEsi=!0),p(G)},k=B=>G=>{const X={};if(G.name&&(X.name=Dh(G.name)),G.dob)try{const Q=new Date(G.dob);isNaN(Q.getTime())||(X.dob=Ue(Q,"yyyy-MM-dd"))}catch{}c(B,X)},I=B=>G=>{const X={};G.degree&&(X.degree=G.degree),G.institution&&(X.institution=G.institution),G.endYear&&(X.endYear=G.endYear.toString()),d(B,X)},M={type:Xe.OBJECT,properties:{name:{type:Xe.STRING},dob:{type:Xe.STRING},aadhaarNumber:{type:Xe.STRING}}},D={type:Xe.OBJECT,properties:{accountHolderName:{type:Xe.STRING},accountNumber:{type:Xe.STRING},ifscCode:{type:Xe.STRING}}},O={type:Xe.OBJECT,properties:{uanNumber:{type:Xe.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:Xe.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:Xe.STRING,description:"The 10 or 17-digit ESI number."}}},q={type:Xe.OBJECT,properties:{uanNumber:{type:Xe.STRING}}},F={type:Xe.OBJECT,properties:{esiNumber:{type:Xe.STRING}}},U={type:Xe.OBJECT,properties:{degree:{type:Xe.STRING},institution:{type:Xe.STRING},endYear:{type:Xe.STRING}}};return v?i.jsxs("form",{onSubmit:async B=>{B.preventDefault(),await n()},id:"documents-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Upload supporting documents. You can also do this within each relevant section."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(xt,{label:"ID Proof (Front Side)",file:s.personal.idProofFront,onFileChange:B=>a({idProofFront:B}),onOcrComplete:_,ocrSchema:M,setToast:e,allowCapture:!0,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(xt,{label:"ID Proof (Back Side)",file:s.personal.idProofBack,onFileChange:B=>a({idProofBack:B}),onOcrComplete:_,ocrSchema:M,setToast:e,allowCapture:!0,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(xt,{label:"Profile Photo",file:s.personal.photo,onFileChange:B=>a({photo:B}),allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]}),i.jsx(xt,{label:"Bank Proof",file:s.bank.bankProof,onFileChange:B=>o({bankProof:B}),onOcrComplete:w,ocrSchema:D,setToast:e,allowCapture:!0,docType:"Bank"}),i.jsx(xt,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:s.uan.salarySlip,onFileChange:B=>m({salarySlip:B}),onOcrComplete:B=>{j(B),P(B)},ocrSchema:O,setToast:e,allowCapture:!0,docType:"Salary"}),s.uan.hasPreviousPf&&i.jsx(xt,{label:"UAN Document",file:s.uan.document,onFileChange:B=>m({document:B}),onOcrComplete:j,ocrSchema:q,setToast:e,allowCapture:!0,docType:"UAN"}),s.esi.hasEsi&&i.jsx(xt,{label:"ESI Document",file:s.esi.document,onFileChange:B=>p({document:B}),onOcrComplete:P,ocrSchema:F,setToast:e,allowCapture:!0}),s.gmc.isOptedIn===!1&&i.jsx(xt,{label:"GMC Policy Copy",file:s.gmc.gmcPolicyCopy,onFileChange:B=>x({gmcPolicyCopy:B}),allowCapture:!0}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[i.jsx("h4",{className:"form-header-title mb-4",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[s.education.map(B=>i.jsx(xt,{label:`Certificate for ${B.degree||"Qualification"}`,file:B.document,onFileChange:G=>d(B.id,{document:G}),onOcrComplete:I(B.id),ocrSchema:U,setToast:e,allowCapture:!0},B.id)),i.jsxs(ae,{type:"button",onClick:()=>r("/onboarding/add/education"),variant:"secondary",className:"w-full flex items-center justify-center",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Add / Edit Qualifications"})]})]})]}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[i.jsx("h4",{className:"form-header-title mb-4",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[s.family.map(B=>i.jsx(xt,{label:`ID Proof for ${B.name||"Family Member"}`,file:B.idProof,onFileChange:G=>c(B.id,{idProof:G}),onOcrComplete:k(B.id),ocrSchema:M,setToast:e,allowCapture:!0,docType:"Aadhaar"},B.id)),s.family.length===0&&i.jsx("p",{className:"text-sm text-gray-400",children:"No family members added."}),i.jsxs(ae,{type:"button",onClick:()=>r("/onboarding/add/family"),variant:"secondary",className:"w-full flex items-center justify-center",children:[i.jsx(qt,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Add/Edit on Family Page"})]})]})]})]})]}):i.jsxs("form",{onSubmit:async B=>{B.preventDefault(),await n()},id:"documents-form",children:[i.jsx(Tr,{title:"Document Collection",subtitle:"Upload supporting documents. You can also do this within each relevant section."}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("section",{children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx(xt,{label:"Employee ID Proof (Aadhaar/PAN) - Front Side",file:s.personal.idProofFront,onFileChange:B=>a({idProofFront:B}),onOcrComplete:_,ocrSchema:M,setToast:e,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(xt,{label:"Employee ID Proof (Aadhaar/PAN) - Back Side",file:s.personal.idProofBack,onFileChange:B=>a({idProofBack:B}),onOcrComplete:_,ocrSchema:M,setToast:e,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(xt,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:s.bank.bankProof,onFileChange:B=>o({bankProof:B}),onOcrComplete:w,ocrSchema:D,setToast:e,docType:"Bank"}),i.jsx(xt,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:s.uan.salarySlip,onFileChange:B=>m({salarySlip:B}),onOcrComplete:B=>{j(B),P(B)},ocrSchema:O,setToast:e,docType:"Salary"})]})}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[s.education.map(B=>i.jsx(xt,{label:`Certificate for ${B.degree||"New Qualification"}`,file:B.document,onFileChange:G=>d(B.id,{document:G}),onOcrComplete:I(B.id),ocrSchema:U,setToast:e},B.id)),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>l(),children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[s.family.map(B=>i.jsx(xt,{label:`ID Proof for ${B.name||`(${B.relation})`}`,file:B.idProof,onFileChange:G=>c(B.id,{idProof:G}),onOcrComplete:k(B.id),ocrSchema:M,setToast:e,docType:"Aadhaar"},B.id)),s.family.length===0&&i.jsx("p",{className:"text-sm text-muted",children:"No family members added yet."}),i.jsxs(ae,{type:"button",variant:"outline",onClick:()=>r("/onboarding/add/family"),children:[i.jsx(qt,{className:"mr-2 h-4 w-4"})," Go to Family Page to Add/Edit"]})]})]})]})]})},cue=wt({signatureImage:Ft().required("A signature image is mandatory.").nullable(),fingerprints:wt().shape({leftThumb:Ft().optional().nullable(),leftIndex:Ft().optional().nullable(),leftMiddle:Ft().optional().nullable(),leftRing:Ft().optional().nullable(),leftLittle:Ft().optional().nullable(),rightThumb:Ft().optional().nullable(),rightIndex:Ft().optional().nullable(),rightMiddle:Ft().optional().nullable(),rightRing:Ft().optional().nullable(),rightLittle:Ft().optional().nullable()})}).defined(),due=[{hand:"Left",key:"leftThumb",name:"Thumb"},{hand:"Left",key:"leftIndex",name:"Index"},{hand:"Left",key:"leftMiddle",name:"Middle"},{hand:"Left",key:"leftRing",name:"Ring"},{hand:"Left",key:"leftLittle",name:"Little"},{hand:"Right",key:"rightThumb",name:"Thumb"},{hand:"Right",key:"rightIndex",name:"Index"},{hand:"Right",key:"rightMiddle",name:"Middle"},{hand:"Right",key:"rightRing",name:"Ring"},{hand:"Right",key:"rightLittle",name:"Little"}],uue=()=>{const{onValidated:n}=pi(),{data:e,updateBiometrics:t}=Wn(),{user:r}=St(),s=Jt("(max-width: 767px)"),{control:a,handleSubmit:o,formState:{errors:l},reset:c,watch:d}=Zt({resolver:_n(cue),defaultValues:e.biometrics});E.useEffect(()=>{c(e.biometrics)},[e.biometrics,c]),E.useEffect(()=>{const v=d(_=>{t(_)});return()=>v.unsubscribe()},[d,t]);const m=async(v,_)=>{try{const w=await pe.verifyFingerprintImage(v,_);return w.containsFingerprints?{success:!0,reason:""}:{success:!1,reason:w.reason||"Image does not appear to contain fingerprints. Please upload a clear scan."}}catch(w){return{success:!1,reason:w.message||"AI verification failed."}}},p=async v=>{t(v),await n()},x=v=>due.filter(_=>_.hand===v).map(_=>i.jsx(je,{name:`fingerprints.${_.key}`,control:a,render:({field:w})=>i.jsx(xt,{label:`${v} ${_.name}`,file:w.value,onFileChange:w.onChange,onVerification:m,allowCapture:!0})},_.key));return i.jsxs("form",{onSubmit:o(p),id:"biometrics-form",children:[!s&&i.jsx(Tr,{title:"Biometrics",subtitle:"Please provide fingerprint scans and a mandatory signature."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:`text-lg font-semibold text-center mb-4 ${s?"form-header-title":"text-primary-text"}`,children:["Signature ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("div",{className:"w-full",children:i.jsx(je,{name:"signatureImage",control:a,render:({field:v,fieldState:_})=>i.jsx(xt,{label:"Upload or capture a signature",file:v.value,onFileChange:v.onChange,allowCapture:!0,error:_.error?.message})})})]}),i.jsx("div",{className:s?"":"my-8 border-t border-border"}),i.jsxs("div",{children:[i.jsx("h4",{className:`text-lg font-semibold text-center mb-4 ${s?"form-header-title":"text-primary-text"}`,children:"Fingerprints (Optional)"}),i.jsx("p",{className:`text-center mb-6 ${s?"text-gray-400":"text-muted"}`,children:"Upload scans for all 10 fingerprints, one image per finger."}),i.jsxs("div",{className:"w-full grid grid-cols-2 md:grid-cols-5 gap-4",children:[x("Left"),x("Right")]})]})]})]})},jc=({label:n,value:e})=>i.jsxs("div",{children:[i.jsx("dt",{className:"text-sm font-medium text-muted",children:n}),i.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),Nc=({label:n,value:e,status:t,isVerifying:r})=>i.jsxs("div",{children:[i.jsxs("dt",{className:"text-sm font-medium text-muted flex items-center",children:[n,r&&i.jsx(Tt,{className:"h-4 w-4 text-muted animate-spin ml-2"}),!r&&t===!0&&i.jsx("span",{title:"Verified from document",className:"ml-2",children:i.jsx(Bi,{className:"h-4 w-4 text-green-500"})}),!r&&t===!1&&i.jsx("span",{title:"Verification Failed",className:"ml-2",children:i.jsx(am,{className:"h-4 w-4 text-red-500"})})]}),i.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),Fi=({label:n,value:e})=>i.jsxs("div",{className:"flex justify-between items-start py-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:n}),i.jsx("span",{className:"text-sm text-white font-medium text-right max-w-[60%]",children:e||"-"})]}),fue=()=>{const{onSubmit:n,isSubmitting:e}=pi(),{user:t}=St(),{data:r,logVerificationUsage:s,setPersonalVerifiedStatus:a,setBankVerifiedStatus:o,setUanVerifiedStatus:l}=Wn(),{perfiosApi:c}=fi(),d=yn(),[m,p]=E.useState(window.innerWidth<768);E.useEffect(()=>{const D=()=>p(window.innerWidth<768);return window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)},[]);const x=t?.role==="field_officer"&&m,[v,_]=E.useState("idle"),[w,j]=E.useState(""),P=E.useMemo(()=>Object.entries(r.biometrics.fingerprints).filter(([,D])=>D!==null).map(([D])=>D.replace(/([A-Z])/g," $1").replace(/^./,O=>O.toUpperCase())),[r.biometrics.fingerprints]),k=async()=>{_("verifying"),j("");let D=!0;const O=[];try{s("Bank AC Verification Advanced");const q=await pe.verifyBankAccountWithPerfios({name:r.bank.accountHolderName,dob:r.personal.dob,aadhaar:r.personal.idProofNumber||null,pan:null,bank:{accountNumber:r.bank.accountNumber,ifsc:r.bank.ifscCode},uan:r.uan.uanNumber||null,esi:r.esi.esiNumber||null});if(O.push(`Bank: ${q.message}`),o({accountNumber:q.verifiedFields.accountNumber,accountHolderName:q.verifiedFields.accountHolderName}),q.success||(D=!1),r.personal.idProofType==="Aadhaar"&&r.personal.idProofNumber){s("Aadhaar Verification");const F=await pe.verifyAadhaar(r.personal.idProofNumber);O.push(`Aadhaar: ${F.message}`),a({idProofNumber:F.success}),F.success||(D=!1)}if(r.uan.hasPreviousPf&&r.uan.uanNumber){s("EPF UAN Lookup");const F=await pe.lookupUan(r.uan.uanNumber);O.push(`UAN: ${F.message}`),l({uanNumber:F.verifiedFields.uan}),F.success||(D=!1)}await pe.updateOnboarding(Wn.getState().data),j(O.join(`
`)),_(D?"success":"failed")}catch(q){_("failed"),j(q.message||"An unexpected error occurred during verification.")}},I=()=>{d(`/onboarding/pdf/${r.id||"draft"}`)},M=(v==="success"||!c.enabled)&&r.formsGenerated;return x?i.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"review-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please review all your details carefully before submitting."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Personal Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Fi,{label:"Full Name",value:`${r.personal.firstName} ${r.personal.lastName}`}),i.jsx(Fi,{label:"Email",value:r.personal.email}),i.jsx(Fi,{label:"Mobile",value:r.personal.mobile}),i.jsx(Fi,{label:"Date of Birth",value:r.personal.dob})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Organization Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Fi,{label:"Site",value:r.organization.organizationName}),i.jsx(Fi,{label:"Designation",value:r.organization.designation}),i.jsx(Fi,{label:"Department",value:r.organization.department})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Bank Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Fi,{label:"Account Holder",value:r.bank.accountHolderName}),i.jsx(Fi,{label:"Account Number",value:"*".repeat(Math.max(0,r.bank.accountNumber.length-4))+r.bank.accountNumber.slice(-4)}),i.jsx(Fi,{label:"IFSC Code",value:r.bank.ifscCode})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Uniform Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx(Fi,{label:"Uniform Required",value:r.uniforms.length>0?"Yes":"No"}),r.uniforms.map(D=>i.jsx(Fi,{label:D.itemName,value:`${D.quantity} x Size ${D.sizeLabel} (${D.fit})`},D.itemId))]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Biometrics"}),r.biometrics.signatureImage&&i.jsxs("div",{className:"mb-4",children:[i.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Signature"}),i.jsx("img",{src:r.biometrics.signatureImage.preview,alt:"Signature",className:"h-24 bg-white border rounded-md mx-auto"})]}),P.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Fingerprints"}),i.jsx("ul",{className:"text-sm text-center text-gray-400 list-disc list-inside",children:P.map(D=>i.jsx("li",{children:D},D))})]})]})]})]}):i.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"review-form",children:[i.jsx(Tr,{title:"Review & Submit",subtitle:"Please review all your details carefully before submitting."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Personal Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Nc,{label:"Full Name",value:`${r.personal.firstName} ${r.personal.lastName}`,status:r.personal.verifiedStatus?.name,isVerifying:!1}),i.jsx(jc,{label:"Email",value:r.personal.email}),i.jsx(jc,{label:"Mobile",value:r.personal.mobile}),i.jsx(Nc,{label:"Date of Birth",value:r.personal.dob,status:r.personal.verifiedStatus?.dob,isVerifying:!1}),i.jsx(jc,{label:"Gender",value:r.personal.gender}),i.jsx(Nc,{label:"Aadhaar Number",value:r.personal.idProofNumber,status:r.personal.verifiedStatus?.idProofNumber,isVerifying:v==="verifying"})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Organization Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(jc,{label:"Site / Client",value:r.organization.organizationName}),i.jsx(jc,{label:"Designation",value:r.organization.designation}),i.jsx(jc,{label:"Department",value:r.organization.department}),i.jsx(jc,{label:"Joining Date",value:r.organization.joiningDate})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Bank & Statutory Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Nc,{label:"Account Holder",value:r.bank.accountHolderName,status:r.bank.verifiedStatus?.accountHolderName,isVerifying:v==="verifying"}),i.jsx(Nc,{label:"Account Number",value:"*".repeat(Math.max(0,r.bank.accountNumber.length-4))+r.bank.accountNumber.slice(-4),status:r.bank.verifiedStatus?.accountNumber,isVerifying:v==="verifying"}),i.jsx(Nc,{label:"IFSC Code",value:r.bank.ifscCode,status:r.bank.verifiedStatus?.ifscCode,isVerifying:v==="verifying"}),i.jsx(jc,{label:"Bank Name",value:r.bank.bankName}),r.uan.hasPreviousPf&&i.jsx(Nc,{label:"UAN",value:r.uan.uanNumber,status:r.uan.verifiedStatus?.uanNumber,isVerifying:v==="verifying"}),r.esi.hasEsi&&i.jsx(Nc,{label:"ESI Number",value:r.esi.esiNumber,status:r.esi.verifiedStatus?.esiNumber,isVerifying:v==="verifying"})]})]}),r.uniforms.length>0&&i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Uniform Details"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.uniforms.map(D=>i.jsxs("div",{className:"bg-page p-3 rounded-md",children:[i.jsx("p",{className:"font-semibold text-sm",children:D.itemName}),i.jsxs("p",{className:"text-xs text-muted",children:["Size: ",D.sizeLabel," (",D.fit,")"]}),i.jsxs("p",{className:"text-xs text-muted",children:["Qty: ",D.quantity]})]},D.itemId))})]}),r.biometrics.signatureImage&&i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Biometrics"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-primary-text",children:"Signature"}),i.jsx("div",{className:"mt-2 p-2 border rounded-lg inline-block bg-page",children:i.jsx("img",{src:r.biometrics.signatureImage.preview,alt:"Signature",className:"h-24"})})]}),P.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-primary-text",children:"Fingerprints Uploaded"}),i.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-muted columns-2",children:P.map(D=>i.jsx("li",{children:D},D))})]})]})]})]}),c.enabled&&i.jsxs("div",{className:"mt-8 pt-6 border-t",children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Third-Party Verification"}),i.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:"Run a background check against official records."}),i.jsx("p",{className:"text-sm text-muted",children:"This step is required before you can submit the application."}),v==="failed"&&i.jsx("p",{className:"text-sm text-red-600 mt-2",children:w}),v==="success"&&i.jsx("p",{className:"text-sm text-green-600 mt-2",children:w})]}),i.jsxs(ae,{onClick:k,isLoading:v==="verifying",disabled:v==="success",children:[v==="idle"&&i.jsxs(i.Fragment,{children:[i.jsx($x,{className:"mr-2 h-4 w-4"})," Verify Details"]}),v==="verifying"&&"Verifying...",v==="failed"&&"Retry Verification",v==="success"&&i.jsxs(i.Fragment,{children:[i.jsx(Bi,{className:"mr-2 h-4 w-4"})," Verified"]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t",children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Generate Official Forms"}),i.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:"Generate and review the official PDF documents."}),i.jsx("p",{className:"text-sm text-muted",children:"This step is mandatory before final submission."})]}),r.formsGenerated?i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-green-600",children:[i.jsx(Bi,{className:"h-5 w-5"}),i.jsx("span",{children:"Forms Generated & Confirmed"})]}):i.jsxs(ae,{onClick:I,children:[i.jsx(Vs,{className:"mr-2 h-4 w-4"})," Generate & Review Forms"]})]})]}),i.jsx("div",{className:"mt-8 pt-6 border-t",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex items-center h-5",children:i.jsx("input",{id:"confirmation",name:"confirmation",type:"checkbox",required:!0,className:"focus:ring-accent h-4 w-4 text-accent border-gray-300 rounded",disabled:!M})}),i.jsxs("div",{className:"ml-3 text-sm",children:[i.jsx("label",{htmlFor:"confirmation",className:`font-medium ${M?"text-gray-700":"text-gray-400"}`,children:"Declaration"}),i.jsx("p",{className:`${M?"text-muted":"text-gray-400"}`,children:"I hereby declare that the information provided is true and correct to the best of my knowledge."})]})]})})]})},Bn=({requiredPermission:n,children:e})=>{const{user:t,isInitialized:r}=St(),{permissions:s}=ka();return r?t?(s[t.role]||[]).includes(n)?e?i.jsx(i.Fragment,{children:e}):i.jsx(gf,{}):i.jsx(ml,{to:"/forbidden",replace:!0}):i.jsx(ml,{to:"/auth/login",replace:!0}):null},hue=({onIdle:n,idleTimeout:e,promptTimeout:t,disabled:r=!1})=>{const[s,a]=E.useState(!1),[o,l]=E.useState(t),c=E.useRef(null),d=E.useRef(null),m=E.useRef(null),p=["mousemove","keydown","mousedown","scroll","touchstart"],x=E.useCallback(()=>{r||(a(!1),l(t),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),m.current&&clearInterval(m.current),c.current=window.setTimeout(()=>{a(!0)},e))},[e,t,r]);return E.useEffect(()=>{if(!r)return s&&(d.current=window.setTimeout(n,t),m.current=window.setInterval(()=>{l(v=>Math.max(0,v-1e3))},1e3)),()=>{d.current&&clearTimeout(d.current),m.current&&clearInterval(m.current)}},[s,n,t,r]),E.useEffect(()=>{if(r)return;const v=()=>x();return p.forEach(_=>{window.addEventListener(_,v)}),x(),()=>{p.forEach(_=>{window.removeEventListener(_,v)}),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),m.current&&clearInterval(m.current)}},[x,r]),{isIdle:s,countdown:o,reset:x}},mue=1800*1e3,pue=120*1e3,gue=()=>{const{logout:n}=St(),e=yn(),t=()=>{n(),e("/auth/login",{replace:!0})},r=Jt("(max-width: 768px)"),{isIdle:s,countdown:a,reset:o}=hue({onIdle:t,idleTimeout:mue,promptTimeout:pue,disabled:r});return s?i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-70 backdrop-blur-sm","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 text-center animate-fade-in-scale",children:[i.jsx(zF,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Are you still there?"}),i.jsx("p",{className:"mt-2 text-muted",children:"For your security, you will be logged out due to inactivity."}),i.jsx("div",{className:"my-6 text-4xl font-bold text-accent",children:Math.ceil(a/1e3)}),i.jsx("p",{className:"text-sm text-muted mb-6",children:"Click the button below to stay logged in."}),i.jsx("div",{className:"flex justify-center gap-4",children:i.jsx(ae,{onClick:o,variant:"primary",size:"lg",children:"Stay Logged In"})})]})}):null},xue=()=>{const{pathname:n}=bs();return E.useEffect(()=>{window.scrollTo(0,0);const e=document.querySelector("main");e&&e.scrollTo(0,0);const t=document.getElementById("root");t&&t.scrollTo(0,0)},[n]),null},yue=()=>{const{theme:n,isAutomatic:e,_setThemeInternal:t}=gu(),r=Jt("(max-width: 767px)");return E.useEffect(()=>{const s=document.body;let a="light";e?a=r?"dark":"light":a=n,t(a),a==="dark"?s.classList.add("pro-dark-theme"):s.classList.remove("pro-dark-theme")},[n,e,r,t]),null},ex="app:lastPath",vue=["/auth","/splash","/pending-approval","/forbidden"],UN=n=>n==="/"||n==="/#"||n==="/index.html"?!1:!vue.some(e=>n.startsWith(e)),bue=()=>{const{user:n,isInitialized:e}=St(),t=bs();return e?n?n.role==="unverified"?i.jsx(ml,{to:"/pending-approval",replace:!0}):Jt("(max-width: 767px)")?i.jsx(bJ,{}):i.jsx(yJ,{}):(UN(t.pathname+t.search)&&localStorage.setItem(ex,t.pathname+t.search),i.jsx(ml,{to:"/auth/login",replace:!0})):null},_ue=()=>{const{user:n,isInitialized:e,setUser:t,setInitialized:r,resetAttendance:s,setLoading:a,isLoginAnimationPending:o}=St(),{init:l}=Zc(),{initRoles:c}=ka(),{initSettings:d}=fi(),m=yn(),p=bs();return E.useEffect(()=>{n&&UN(p.pathname+p.search)&&localStorage.setItem(ex,p.pathname+p.search)},[n,p.pathname,p.search]),E.useEffect(()=>{let x=!0;const v=setTimeout(()=>{x&&(console.warn("App initialization is taking too long. Proceeding without a session."),a(!1),r(!0))},3e4);(async()=>{a(!0);try{let{data:{session:j},error:P}=await De.auth.getSession();if(P&&console.error("Error fetching initial session:",P.message),!j){const k=localStorage.getItem("supabase.auth.rememberMe");if(k){console.log("Attempting to restore session from long-term token...");try{const{data:I,error:M}=await De.auth.setSession({refresh_token:k});M?(console.error("Failed to restore session from long-term token:",M.message),localStorage.removeItem("supabase.auth.rememberMe")):j=I.session}catch(I){console.error("Exception while restoring session from long-term token:",I)}}}if(j)try{const k=await xa.getAppUserProfile(j.user);x&&t(k)}catch(k){console.error("Failed to fetch user profile during initialization:",k),x&&(t(null),s())}else x&&(t(null),s())}catch(j){console.error("Error during app initialization:",j),x&&(t(null),s())}finally{clearTimeout(v),x&&(a(!1),r(!0))}})();const{data:{subscription:w}}=De.auth.onAuthStateChange((j,P)=>{if(j==="PASSWORD_RECOVERY"){m("/auth/update-password",{replace:!0});return}P?.user?setTimeout(async()=>{try{const k=await xa.getAppUserProfile(P.user);if(x&&(t(k),k))try{const I=`greetingSent_${k.id}`;localStorage.getItem(I)||(await pe.createNotification({userId:k.id,message:`Good morning, ${k.name||"there"}! Welcome to Paradigm Services.`,type:"greeting"}),localStorage.setItem(I,"1"))}catch(I){console.error("Failed to send login greeting notification",I)}}catch(k){console.error("Failed to fetch user profile after auth change:",k),x&&(t(null),s(),Wn.getState().reset())}},0):x&&(t(null),s(),Wn.getState().reset())});return()=>{x=!1,w?.unsubscribe(),clearTimeout(v)}},[t,r,s,a]),E.useEffect(()=>{n&&e&&((async()=>{try{const{settings:v,roles:_,holidays:w}=await pe.getInitialAppData(),j=await pe.getRecurringHolidays();v.enrollmentRules&&l(v.enrollmentRules),_&&c(_),v.attendanceSettings&&w&&d({holidays:w,attendanceSettings:v.attendanceSettings,recurringHolidays:j||[]})}catch(v){console.error("Failed to load initial application data:",v)}})(),St.getState().checkAttendanceStatus())},[n,e,l,c,d]),E.useEffect(()=>{if(e&&p.pathname!=="/auth/update-password"&&n&&!o&&(p.pathname.startsWith("/auth")||p.pathname==="/"||p.pathname==="/splash")){const x=localStorage.getItem(ex);x&&UN(x)&&x!=="/"&&x!=="/#"?(localStorage.removeItem(ex),m(x,{replace:!0})):n.role==="unverified"?m("/pending-approval",{replace:!0}):m("/profile",{replace:!0})}},[e,n,p.pathname,m,o]),e?i.jsxs(i.Fragment,{children:[i.jsx(xue,{}),i.jsx(yue,{}),n&&i.jsx(gue,{}),i.jsxs(az,{children:[i.jsxs(et,{path:"/auth",element:i.jsx(wJ,{}),children:[i.jsx(et,{index:!0,element:i.jsx(ml,{to:"login",replace:!0})}),i.jsx(et,{path:"login",element:i.jsx(DQ,{})}),i.jsx(et,{path:"signup",element:i.jsx(IQ,{})}),i.jsx(et,{path:"forgot-password",element:i.jsx(RQ,{})}),i.jsx(et,{path:"update-password",element:i.jsx(qQ,{})})]}),i.jsx(et,{path:"/pending-approval",element:n&&n.role==="unverified"?i.jsx(zQ,{}):i.jsx(ml,{to:"/auth/login",replace:!0})}),i.jsx(et,{path:"/forbidden",element:i.jsx(UQ,{})}),i.jsxs(et,{path:"/",element:i.jsx(NJ,{children:i.jsx(bue,{})}),children:[i.jsx(et,{index:!0,element:i.jsx(ml,{to:"/profile",replace:!0})}),i.jsx(et,{path:"profile",element:i.jsx(Lre,{})}),i.jsx(et,{path:"mobile-home",element:i.jsx(PJ,{})}),i.jsxs(et,{element:i.jsx(Bn,{requiredPermission:"create_enrollment"}),children:[i.jsx(et,{path:"onboarding",element:i.jsx(VQ,{})}),i.jsx(et,{path:"onboarding/select-organization",element:i.jsx(BQ,{})}),i.jsx(et,{path:"onboarding/pre-upload",element:i.jsx(wde,{})}),i.jsx(et,{path:"onboarding/submissions",element:i.jsx(Nde,{})}),i.jsx(et,{path:"onboarding/tasks",element:i.jsx(Tde,{})}),i.jsx(et,{path:"onboarding/uniforms",element:i.jsx(kde,{})}),i.jsxs(et,{path:"onboarding/add",element:i.jsx(WQ,{}),children:[i.jsx(et,{path:"personal",element:i.jsx($de,{})}),i.jsx(et,{path:"address",element:i.jsx(Yde,{})}),i.jsx(et,{path:"organization",element:i.jsx(Zde,{})}),i.jsx(et,{path:"family",element:i.jsx(Kde,{})}),i.jsx(et,{path:"education",element:i.jsx(Jde,{})}),i.jsx(et,{path:"bank",element:i.jsx(eue,{})}),i.jsx(et,{path:"uan",element:i.jsx(nue,{})}),i.jsx(et,{path:"esi",element:i.jsx(sue,{})}),i.jsx(et,{path:"gmc",element:i.jsx(aue,{})}),i.jsx(et,{path:"uniform",element:i.jsx(oue,{})}),i.jsx(et,{path:"documents",element:i.jsx(lue,{})}),i.jsx(et,{path:"biometrics",element:i.jsx(uue,{})}),i.jsx(et,{path:"review",element:i.jsx(fue,{})})]}),i.jsx(et,{path:"onboarding/pdf/:id",element:i.jsx(ede,{})})]}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"view_all_submissions"}),children:i.jsx(et,{path:"verification/dashboard",element:i.jsx(GQ,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_users"}),children:i.jsx(et,{path:"admin/users",element:i.jsx(XQ,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_sites"}),children:i.jsx(et,{path:"admin/sites",element:i.jsx(wre,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_roles_and_permissions"}),children:i.jsx(et,{path:"admin/roles",element:i.jsx(jre,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_modules"}),children:i.jsx(et,{path:"admin/modules",element:i.jsx(Pre,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_approval_workflow"}),children:i.jsx(et,{path:"admin/approval-workflow",element:i.jsx(Jle,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"view_developer_settings"}),children:i.jsx(et,{path:"developer/api",element:i.jsx(kre,{})})}),i.jsxs(et,{element:i.jsx(Bn,{requiredPermission:"view_operations_dashboard"}),children:[i.jsx(et,{path:"operations/dashboard",element:i.jsx(Dre,{})}),i.jsx(et,{path:"operations/team-activity",element:i.jsx(Ore,{})})]}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"view_site_dashboard"}),children:i.jsx(et,{path:"site/dashboard",element:i.jsx(Are,{})})}),i.jsxs(et,{element:i.jsx(Bn,{requiredPermission:"view_own_attendance"}),children:[i.jsx(et,{path:"attendance/dashboard",element:i.jsx(kle,{})}),i.jsx(et,{path:"attendance/locations",element:i.jsx(Ole,{})})]}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"apply_for_leave"}),children:i.jsx(et,{path:"leaves/dashboard",element:i.jsx(Vle,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_attendance_rules"}),children:i.jsx(et,{path:"hr/attendance-settings",element:i.jsx(Ile,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_leave_requests"}),children:i.jsx(et,{path:"hr/leave-management",element:i.jsx(Gle,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"view_entity_management"}),children:i.jsx(et,{path:"hr/entities",element:i.jsx(Hce,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_policies"}),children:i.jsx(et,{path:"hr/policies-and-insurance",element:i.jsx(Qce,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_enrollment_rules"}),children:i.jsx(et,{path:"hr/enrollment-rules",element:i.jsx(Xce,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"view_field_officer_tracking"}),children:i.jsx(et,{path:"hr/field-officer-tracking",element:i.jsx(gde,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_attendance_rules"}),children:i.jsx(et,{path:"hr/locations",element:i.jsx(yde,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_uniforms"}),children:i.jsx(et,{path:"uniforms",element:i.jsx(sde,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"view_verification_costing"}),children:i.jsx(et,{path:"billing/cost-analysis",element:i.jsx(ode,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"view_invoice_summary"}),children:i.jsx(et,{path:"billing/summary",element:i.jsx(dde,{})})}),i.jsx(et,{element:i.jsx(Bn,{requiredPermission:"manage_tasks"}),children:i.jsx(et,{path:"tasks",element:i.jsx(rce,{})})}),i.jsxs(et,{element:i.jsx(Bn,{requiredPermission:"access_support_desk"}),children:[i.jsx(et,{path:"support",element:i.jsx(Rde,{})}),i.jsx(et,{path:"support/ticket/:id",element:i.jsx(Bde,{})})]})]}),i.jsx(et,{path:"*",element:i.jsx(ml,{to:"/",replace:!0})})]})]}):i.jsx(TJ,{})},N6=document.getElementById("root");if(!N6)throw new Error("Could not find root element to mount to");const wue=pq.createRoot(N6);wue.render(i.jsx(at.StrictMode,{children:i.jsx(pz,{children:i.jsx(_ue,{})})}));export{UP as _,hu as a,Sue as c,PL as g};
